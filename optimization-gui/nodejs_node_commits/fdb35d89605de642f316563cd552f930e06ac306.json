{
    "author": "not-an-aardvark",
    "message": "assert: ensure .rejects() disallows sync throws\n\nThis updates `assert.rejects()` to disallow any errors that are thrown\nsynchronously from the given function. Previously, throwing an error\nwould cause the same behavior as returning a rejected Promise.\n\nFixes: https://github.com/nodejs/node/issues/19646\nPR-URL: https://github.com/nodejs/node/pull/19650\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "fdb35d89605de642f316563cd552f930e06ac306",
    "files": [
        {
            "sha": "9c900fcaf32055b688cff2940089d8fda384b3a3",
            "filename": "lib/assert.js",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/fdb35d89605de642f316563cd552f930e06ac306/lib%2Fassert.js",
            "raw_url": "https://github.com/nodejs/node/raw/fdb35d89605de642f316563cd552f930e06ac306/lib%2Fassert.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fassert.js?ref=fdb35d89605de642f316563cd552f930e06ac306",
            "patch": "@@ -451,8 +451,11 @@ async function waitForActual(block) {\n   if (typeof block !== 'function') {\n     throw new ERR_INVALID_ARG_TYPE('block', 'Function', block);\n   }\n+\n+  // Return a rejected promise if `block` throws synchronously.\n+  const resultPromise = block();\n   try {\n-    await block();\n+    await resultPromise;\n   } catch (e) {\n     return e;\n   }"
        },
        {
            "sha": "b6b744c9b1e3aeba87235b45bd19bef7696aa8bb",
            "filename": "test/parallel/test-assert-async.js",
            "status": "modified",
            "additions": 14,
            "deletions": 1,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/fdb35d89605de642f316563cd552f930e06ac306/test%2Fparallel%2Ftest-assert-async.js",
            "raw_url": "https://github.com/nodejs/node/raw/fdb35d89605de642f316563cd552f930e06ac306/test%2Fparallel%2Ftest-assert-async.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-assert-async.js?ref=fdb35d89605de642f316563cd552f930e06ac306",
            "patch": "@@ -13,7 +13,7 @@ common.crashOnUnhandledRejection();\n \n (async () => {\n   await assert.rejects(\n-    () => assert.fail(),\n+    async () => assert.fail(),\n     common.expectsError({\n       code: 'ERR_ASSERTION',\n       type: assert.AssertionError,\n@@ -57,4 +57,17 @@ common.crashOnUnhandledRejection();\n       }\n     );\n   }\n+\n+  {\n+    const THROWN_ERROR = new Error();\n+\n+    await assert.rejects(() => {\n+      throw THROWN_ERROR;\n+    }).then(common.mustNotCall())\n+      .catch(\n+        common.mustCall((err) => {\n+          assert.strictEqual(err, THROWN_ERROR);\n+        })\n+      );\n+  }\n })().then(common.mustCall());"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 18,
        "deletions": 2
    }
}