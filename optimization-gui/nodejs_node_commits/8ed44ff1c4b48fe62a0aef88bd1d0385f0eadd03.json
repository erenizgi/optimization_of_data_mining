{
    "author": "ChALkeR",
    "message": "test,benchmark: use new Buffer API where appropriate\n\nFor tests / benchmarks that are creating Buffer instances for\nany reason other than to test Buffer constructor, use the new\nBuffer.alloc/Buffer.from API instead of the deprecated API.\n\nPR-URL: https://github.com/nodejs/node/pull/18980\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Daijiro Wachi <daijiro.wachi@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>\nReviewed-By: Tobias Nießen <tniessen@tnie.de>",
    "sha": "8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
    "files": [
        {
            "sha": "4baeeb2d2e770665d7f577b736daa9de0a12d526",
            "filename": "benchmark/streams/pipe.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Fpipe.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Fpipe.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fstreams%2Fpipe.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -8,7 +8,7 @@ const bench = common.createBenchmark(main, {\n });\n \n function main({ n }) {\n-  const b = new Buffer(1024);\n+  const b = Buffer.alloc(1024);\n   const r = new Readable();\n   const w = new Writable();\n "
        },
        {
            "sha": "62d1af874fb22afd558ad8efb829cef437004ffd",
            "filename": "benchmark/streams/readable-bigread.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Freadable-bigread.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Freadable-bigread.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fstreams%2Freadable-bigread.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -8,7 +8,7 @@ const bench = common.createBenchmark(main, {\n });\n \n function main({ n }) {\n-  const b = new Buffer(32);\n+  const b = Buffer.alloc(32);\n   const s = new Readable();\n   function noop() {}\n   s._read = noop;"
        },
        {
            "sha": "e13769189a69daa7b8d8d19ebed2260be451e7ab",
            "filename": "benchmark/streams/readable-bigunevenread.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Freadable-bigunevenread.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Freadable-bigunevenread.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fstreams%2Freadable-bigunevenread.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -8,7 +8,7 @@ const bench = common.createBenchmark(main, {\n });\n \n function main({ n }) {\n-  const b = new Buffer(32);\n+  const b = Buffer.alloc(32);\n   const s = new Readable();\n   function noop() {}\n   s._read = noop;"
        },
        {
            "sha": "3c177ec4c399883e7ef355b47e7ceb9a61713d7e",
            "filename": "benchmark/streams/readable-readall.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Freadable-readall.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Freadable-readall.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fstreams%2Freadable-readall.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -8,7 +8,7 @@ const bench = common.createBenchmark(main, {\n });\n \n function main({ n }) {\n-  const b = new Buffer(32);\n+  const b = Buffer.alloc(32);\n   const s = new Readable();\n   function noop() {}\n   s._read = noop;"
        },
        {
            "sha": "f8b501ab4729eca0081ef4f30b67d4ad3ae058d7",
            "filename": "benchmark/streams/readable-unevenread.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Freadable-unevenread.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/benchmark%2Fstreams%2Freadable-unevenread.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fstreams%2Freadable-unevenread.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -8,7 +8,7 @@ const bench = common.createBenchmark(main, {\n });\n \n function main({ n }) {\n-  const b = new Buffer(32);\n+  const b = Buffer.alloc(32);\n   const s = new Readable();\n   function noop() {}\n   s._read = noop;"
        },
        {
            "sha": "d8ab77730f49210b687f0cb4ebf123ba9262ecec",
            "filename": "test/async-hooks/test-udpsendwrap.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fasync-hooks%2Ftest-udpsendwrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fasync-hooks%2Ftest-udpsendwrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fasync-hooks%2Ftest-udpsendwrap.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -18,7 +18,7 @@ const sock = dgram\n \n function onlistening() {\n   sock.send(\n-    new Buffer(2), 0, 2, sock.address().port,\n+    Buffer.alloc(2), 0, 2, sock.address().port,\n     undefined, common.mustCall(onsent));\n \n   // init not called synchronously because dns lookup always wraps"
        },
        {
            "sha": "61086659fa7b6ebbaa85cd73d3a9cf654cfd2aee",
            "filename": "test/parallel/test-buffer-badhex.js",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-buffer-badhex.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-buffer-badhex.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-buffer-badhex.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -6,12 +6,12 @@ const assert = require('assert');\n {\n   const buf = Buffer.alloc(4);\n   assert.strictEqual(buf.length, 4);\n-  assert.deepStrictEqual(buf, new Buffer([0, 0, 0, 0]));\n+  assert.deepStrictEqual(buf, Buffer.from([0, 0, 0, 0]));\n   assert.strictEqual(buf.write('abcdxx', 0, 'hex'), 2);\n-  assert.deepStrictEqual(buf, new Buffer([0xab, 0xcd, 0x00, 0x00]));\n+  assert.deepStrictEqual(buf, Buffer.from([0xab, 0xcd, 0x00, 0x00]));\n   assert.strictEqual(buf.toString('hex'), 'abcd0000');\n   assert.strictEqual(buf.write('abcdef01', 0, 'hex'), 4);\n-  assert.deepStrictEqual(buf, new Buffer([0xab, 0xcd, 0xef, 0x01]));\n+  assert.deepStrictEqual(buf, Buffer.from([0xab, 0xcd, 0xef, 0x01]));\n   assert.strictEqual(buf.toString('hex'), 'abcdef01');\n \n   const copy = Buffer.from(buf.toString('hex'), 'hex');\n@@ -26,13 +26,13 @@ const assert = require('assert');\n \n {\n   const buf = Buffer.alloc(4);\n-  assert.deepStrictEqual(buf, new Buffer([0, 0, 0, 0]));\n+  assert.deepStrictEqual(buf, Buffer.from([0, 0, 0, 0]));\n   assert.strictEqual(buf.write('xxabcd', 0, 'hex'), 0);\n-  assert.deepStrictEqual(buf, new Buffer([0, 0, 0, 0]));\n+  assert.deepStrictEqual(buf, Buffer.from([0, 0, 0, 0]));\n   assert.strictEqual(buf.write('xxab', 1, 'hex'), 0);\n-  assert.deepStrictEqual(buf, new Buffer([0, 0, 0, 0]));\n+  assert.deepStrictEqual(buf, Buffer.from([0, 0, 0, 0]));\n   assert.strictEqual(buf.write('cdxxab', 0, 'hex'), 1);\n-  assert.deepStrictEqual(buf, new Buffer([0xcd, 0, 0, 0]));\n+  assert.deepStrictEqual(buf, Buffer.from([0xcd, 0, 0, 0]));\n }\n \n {"
        },
        {
            "sha": "b2f14c3e428e55d121956b72ee0760a08723c200",
            "filename": "test/parallel/test-buffer-fill.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-buffer-fill.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-buffer-fill.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-buffer-fill.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -368,7 +368,7 @@ assert.strictEqual(\n \n // Test that bypassing 'length' won't cause an abort.\n common.expectsError(() => {\n-  const buf = new Buffer('w00t');\n+  const buf = Buffer.from('w00t');\n   Object.defineProperty(buf, 'length', {\n     value: 1337,\n     enumerable: true"
        },
        {
            "sha": "357558c74d2edce023f16a63a928882792a833bb",
            "filename": "test/parallel/test-buffer-indexof.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-buffer-indexof.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-buffer-indexof.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-buffer-indexof.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -504,7 +504,7 @@ assert.strictEqual(buf_bc.lastIndexOf('你好', 5, 'binary'), -1);\n assert.strictEqual(buf_bc.lastIndexOf(Buffer.from('你好'), 7), -1);\n \n // Test lastIndexOf on a longer buffer:\n-const bufferString = new Buffer('a man a plan a canal panama');\n+const bufferString = Buffer.from('a man a plan a canal panama');\n assert.strictEqual(15, bufferString.lastIndexOf('canal'));\n assert.strictEqual(21, bufferString.lastIndexOf('panama'));\n assert.strictEqual(0, bufferString.lastIndexOf('a man a plan a canal panama'));\n@@ -566,7 +566,7 @@ const parts = [];\n for (let i = 0; i < 1000000; i++) {\n   parts.push((countBits(i) % 2 === 0) ? 'yolo' : 'swag');\n }\n-const reallyLong = new Buffer(parts.join(' '));\n+const reallyLong = Buffer.from(parts.join(' '));\n assert.strictEqual('yolo swag swag yolo', reallyLong.slice(0, 19).toString());\n \n // Expensive reverse searches. Stress test lastIndexOf:"
        },
        {
            "sha": "7a9f0c125004811cca81a4c845f98ce7c9b8270d",
            "filename": "test/parallel/test-buffer-zero-fill.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-buffer-zero-fill.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-buffer-zero-fill.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-buffer-zero-fill.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -3,6 +3,7 @@\n require('../common');\n const assert = require('assert');\n \n+// Tests deprecated Buffer API on purpose\n const buf1 = Buffer(100);\n const buf2 = new Buffer(100);\n "
        },
        {
            "sha": "b7b7af89e215db50acf6fd8adbc68d4e44b29305",
            "filename": "test/parallel/test-net-socket-byteswritten.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-net-socket-byteswritten.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-net-socket-byteswritten.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-net-socket-byteswritten.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -16,7 +16,7 @@ server.listen(0, common.mustCall(function() {\n   socket.cork();\n \n   socket.write('one');\n-  socket.write(new Buffer('twø', 'utf8'));\n+  socket.write(Buffer.from('twø', 'utf8'));\n \n   socket.uncork();\n "
        },
        {
            "sha": "8b299f8728282dc4d911e705b0dbc05ae3a9dee7",
            "filename": "test/parallel/test-zlib-empty-buffer.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-zlib-empty-buffer.js",
            "raw_url": "https://github.com/nodejs/node/raw/8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03/test%2Fparallel%2Ftest-zlib-empty-buffer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-zlib-empty-buffer.js?ref=8ed44ff1c4b48fe62a0aef88bd1d0385f0eadd03",
            "patch": "@@ -3,7 +3,7 @@ const common = require('../common');\n const zlib = require('zlib');\n const { inspect, promisify } = require('util');\n const assert = require('assert');\n-const emptyBuffer = new Buffer(0);\n+const emptyBuffer = Buffer.alloc(0);\n \n common.crashOnUnhandledRejection();\n "
        }
    ],
    "stats": {
        "total": 37,
        "additions": 19,
        "deletions": 18
    }
}