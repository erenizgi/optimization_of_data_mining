{
    "author": "BridgeAR",
    "message": "Revert \"src: make process.env.TZ setter clear tz cache\"\n\nThis reverts commit 1d1ab76e1737da4229b3a0774c60a8fbead89040.\n\nPR-URL: https://github.com/nodejs/node/pull/20228\nFixes: https://github.com/nodejs/node/issues/20227\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "e767aa1a2e5e9b7445dc0974ab21d33941f100ff",
    "files": [
        {
            "sha": "032963bff41a6962b8da599f1921866c3bb229a7",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 10,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/e767aa1a2e5e9b7445dc0974ab21d33941f100ff/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/e767aa1a2e5e9b7445dc0974ab21d33941f100ff/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=e767aa1a2e5e9b7445dc0974ab21d33941f100ff",
            "patch": "@@ -80,7 +80,6 @@\n #include <stdlib.h>\n #include <string.h>\n #include <sys/types.h>\n-#include <time.h>  // tzset(), _tzset()\n \n #include <string>\n #include <vector>\n@@ -136,7 +135,6 @@ using v8::Array;\n using v8::ArrayBuffer;\n using v8::Boolean;\n using v8::Context;\n-using v8::Date;\n using v8::EscapableHandleScope;\n using v8::Exception;\n using v8::Float64Array;\n@@ -2690,10 +2688,6 @@ static void EnvSetter(Local<Name> property,\n   node::Utf8Value key(info.GetIsolate(), property);\n   node::Utf8Value val(info.GetIsolate(), value);\n   setenv(*key, *val, 1);\n-  if (key.length() == 2 && key[0] == 'T' && key[1] == 'Z') {\n-    tzset();\n-    Date::DateTimeConfigurationChangeNotification(info.GetIsolate());\n-  }\n #else  // _WIN32\n   node::TwoByteValue key(info.GetIsolate(), property);\n   node::TwoByteValue val(info.GetIsolate(), value);\n@@ -2702,10 +2696,6 @@ static void EnvSetter(Local<Name> property,\n   if (key_ptr[0] != L'=') {\n     SetEnvironmentVariableW(key_ptr, reinterpret_cast<WCHAR*>(*val));\n   }\n-  if (key.length() == 2 && key[0] == L'T' && key[1] == L'Z') {\n-    _tzset();\n-    Date::DateTimeConfigurationChangeNotification(info.GetIsolate());\n-  }\n #endif\n   // Whether it worked or not, always return value.\n   info.GetReturnValue().Set(value);"
        },
        {
            "sha": "7e077588d46e642280ad9fbe1e9f04dd3e1fc353",
            "filename": "test/parallel/test-process-env-tz.js",
            "status": "removed",
            "additions": 0,
            "deletions": 23,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/0f8caf23bed91cbbb19121a3c97bb21c703258ac/test%2Fparallel%2Ftest-process-env-tz.js",
            "raw_url": "https://github.com/nodejs/node/raw/0f8caf23bed91cbbb19121a3c97bb21c703258ac/test%2Fparallel%2Ftest-process-env-tz.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-env-tz.js?ref=0f8caf23bed91cbbb19121a3c97bb21c703258ac",
            "patch": "@@ -1,23 +0,0 @@\n-'use strict';\n-\n-const common = require('../common');\n-const assert = require('assert');\n-\n-if (common.isWindows)  // Using a different TZ format.\n-  common.skip('todo: test on Windows');\n-\n-if (common.isAIX || common.isSunOS)  // Reports 2018 CEST as CET.\n-  common.skip('tzdata too old');\n-\n-const date = new Date('2018-04-14T12:34:56.789Z');\n-\n-process.env.TZ = 'Europe/Amsterdam';\n-if (/\\(Europe\\)/.test(date.toString()))\n-  common.skip('not using bundled ICU');  // Shared library or --with-intl=none.\n-assert.strictEqual(date.toString(), 'Sat Apr 14 2018 14:34:56 GMT+0200 (CEST)');\n-\n-process.env.TZ = 'Europe/London';\n-assert.strictEqual(date.toString(), 'Sat Apr 14 2018 13:34:56 GMT+0100 (BST)');\n-\n-process.env.TZ = 'Etc/UTC';\n-assert.strictEqual(date.toString(), 'Sat Apr 14 2018 12:34:56 GMT+0000 (UTC)');"
        }
    ],
    "stats": {
        "total": 33,
        "additions": 0,
        "deletions": 33
    }
}