{
    "author": "danbev",
    "message": "async_hooks: add copyHooks function\n\nThis commit introduces a copyHooks function that can be used by\nstoreActiveHooks and restoreActiveHooks to remove some code duplication.\n\nPR-URL: https://github.com/nodejs/node/pull/19391\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>",
    "sha": "5a4a1cba2445d71aadf4ebf4350090dfdb32d871",
    "files": [
        {
            "sha": "90155fa3c773dc91ede68db240f6ab2b10ba103e",
            "filename": "lib/internal/async_hooks.js",
            "status": "modified",
            "additions": 10,
            "deletions": 10,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/5a4a1cba2445d71aadf4ebf4350090dfdb32d871/lib%2Finternal%2Fasync_hooks.js",
            "raw_url": "https://github.com/nodejs/node/raw/5a4a1cba2445d71aadf4ebf4350090dfdb32d871/lib%2Finternal%2Fasync_hooks.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fasync_hooks.js?ref=5a4a1cba2445d71aadf4ebf4350090dfdb32d871",
            "patch": "@@ -213,23 +213,23 @@ function storeActiveHooks() {\n   // Don't want to make the assumption that kInit to kDestroy are indexes 0 to\n   // 4. So do this the long way.\n   active_hooks.tmp_fields = [];\n-  active_hooks.tmp_fields[kInit] = async_hook_fields[kInit];\n-  active_hooks.tmp_fields[kBefore] = async_hook_fields[kBefore];\n-  active_hooks.tmp_fields[kAfter] = async_hook_fields[kAfter];\n-  active_hooks.tmp_fields[kDestroy] = async_hook_fields[kDestroy];\n-  active_hooks.tmp_fields[kPromiseResolve] = async_hook_fields[kPromiseResolve];\n+  copyHooks(active_hooks.tmp_fields, async_hook_fields);\n+}\n+\n+function copyHooks(destination, source) {\n+  destination[kInit] = source[kInit];\n+  destination[kBefore] = source[kBefore];\n+  destination[kAfter] = source[kAfter];\n+  destination[kDestroy] = source[kDestroy];\n+  destination[kPromiseResolve] = source[kPromiseResolve];\n }\n \n \n // Then restore the correct hooks array in case any hooks were added/removed\n // during hook callback execution.\n function restoreActiveHooks() {\n   active_hooks.array = active_hooks.tmp_array;\n-  async_hook_fields[kInit] = active_hooks.tmp_fields[kInit];\n-  async_hook_fields[kBefore] = active_hooks.tmp_fields[kBefore];\n-  async_hook_fields[kAfter] = active_hooks.tmp_fields[kAfter];\n-  async_hook_fields[kDestroy] = active_hooks.tmp_fields[kDestroy];\n-  async_hook_fields[kPromiseResolve] = active_hooks.tmp_fields[kPromiseResolve];\n+  copyHooks(async_hook_fields, active_hooks.tmp_fields);\n \n   active_hooks.tmp_array = null;\n   active_hooks.tmp_fields = null;"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 10,
        "deletions": 10
    }
}