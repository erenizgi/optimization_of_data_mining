{
    "author": "unknown",
    "message": "fs: make process.binding('fs') internal\n\nRefs: https://github.com/nodejs/node/issues/22160\n\nPR-URL: https://github.com/nodejs/node/pull/22478\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Denys Otrishko <shishugi@gmail.com>",
    "sha": "1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
    "files": [
        {
            "sha": "a57c5b71f576dda30191519d994fcf566f789470",
            "filename": "lib/fs.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -42,7 +42,7 @@ const {\n const { _extend } = require('util');\n const pathModule = require('path');\n const { isArrayBufferView } = require('internal/util/types');\n-const binding = process.binding('fs');\n+const binding = internalBinding('fs');\n const { Buffer, kMaxLength } = require('buffer');\n const errors = require('internal/errors');\n const {"
        },
        {
            "sha": "941db67e02e314665bdc98f913b17d0dba0b5b04",
            "filename": "lib/internal/bootstrap/loaders.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Fbootstrap%2Floaders.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Fbootstrap%2Floaders.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Floaders.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -81,6 +81,7 @@\n     'constants',\n     'contextify',\n     'crypto',\n+    'fs',\n     'fs_event_wrap',\n     'http_parser',\n     'icu',"
        },
        {
            "sha": "33c510ed5ca70283e3b4c377ab4819daa4f193bd",
            "filename": "lib/internal/fs/promises.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Ffs%2Fpromises.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Ffs%2Fpromises.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ffs%2Fpromises.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -7,7 +7,7 @@ const {\n   S_IFMT,\n   S_IFREG\n } = internalBinding('constants').fs;\n-const binding = process.binding('fs');\n+const binding = internalBinding('fs');\n const { Buffer, kMaxLength } = require('buffer');\n const {\n   ERR_FS_FILE_TOO_LARGE,"
        },
        {
            "sha": "d7543ffa5aafede23aad2bcd14b70411f0a63a4c",
            "filename": "lib/internal/fs/read_file_context.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Ffs%2Fread_file_context.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Ffs%2Fread_file_context.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ffs%2Fread_file_context.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -1,7 +1,8 @@\n 'use strict';\n \n const { Buffer } = require('buffer');\n-const { FSReqCallback, close, read } = process.binding('fs');\n+\n+const { FSReqCallback, close, read } = internalBinding('fs');\n \n const kReadFileBufferLength = 8 * 1024;\n "
        },
        {
            "sha": "5b23c3b472e37cb5f50cbca8c1d61bb88419fe80",
            "filename": "lib/internal/fs/streams.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Ffs%2Fstreams.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Ffs%2Fstreams.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ffs%2Fstreams.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -3,7 +3,7 @@\n const {\n   FSReqCallback,\n   writeBuffers\n-} = process.binding('fs');\n+} = internalBinding('fs');\n const {\n   ERR_INVALID_ARG_TYPE,\n   ERR_OUT_OF_RANGE"
        },
        {
            "sha": "e026aa8192c3cf0be2b8fd7e6877c0a13ce6d95c",
            "filename": "lib/internal/fs/watchers.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Ffs%2Fwatchers.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Ffs%2Fwatchers.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ffs%2Fwatchers.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -4,7 +4,7 @@ const errors = require('internal/errors');\n const {\n   kFsStatsFieldsNumber,\n   StatWatcher: _StatWatcher\n-} = process.binding('fs');\n+} = internalBinding('fs');\n const { FSEvent } = internalBinding('fs_event_wrap');\n const { UV_ENOSPC } = internalBinding('uv');\n const { EventEmitter } = require('events');"
        },
        {
            "sha": "9c17f8077b333171460bcbdaaf30ae27bf1163f9",
            "filename": "lib/internal/http2/core.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Fhttp2%2Fcore.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Fhttp2%2Fcore.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fhttp2%2Fcore.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -118,7 +118,7 @@ const {\n } = require('internal/timers');\n const { isArrayBufferView } = require('internal/util/types');\n \n-const { FileHandle } = process.binding('fs');\n+const { FileHandle } = internalBinding('fs');\n const binding = internalBinding('http2');\n const {\n   ShutdownWrap,"
        },
        {
            "sha": "df270db69d81db3fdb76f5d8309adec7625bf2c6",
            "filename": "lib/internal/modules/cjs/loader.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Fmodules%2Fcjs%2Floader.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Fmodules%2Fcjs%2Floader.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fmodules%2Fcjs%2Floader.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -33,7 +33,7 @@ const { URL } = require('url');\n const {\n   internalModuleReadJSON,\n   internalModuleStat\n-} = process.binding('fs');\n+} = internalBinding('fs');\n const { safeGetenv } = internalBinding('util');\n const {\n   makeRequireFunction,"
        },
        {
            "sha": "e8b67ed0fd397a0a5bdf5ab98d7701831e10464c",
            "filename": "lib/internal/net.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Fnet.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/lib%2Finternal%2Fnet.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fnet.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -1,7 +1,7 @@\n 'use strict';\n \n const Buffer = require('buffer').Buffer;\n-const { writeBuffer } = process.binding('fs');\n+const { writeBuffer } = internalBinding('fs');\n const errors = require('internal/errors');\n \n // IPv4 Segment"
        },
        {
            "sha": "49d316729485b641354fae462b9a533264f349a9",
            "filename": "src/node_file.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/src%2Fnode_file.cc",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/src%2Fnode_file.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_file.cc?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -2236,4 +2236,4 @@ void Initialize(Local<Object> target,\n \n }  // end namespace node\n \n-NODE_BUILTIN_MODULE_CONTEXT_AWARE(fs, node::fs::Initialize)\n+NODE_MODULE_CONTEXT_AWARE_INTERNAL(fs, node::fs::Initialize)"
        },
        {
            "sha": "9028d9ae30702e6765958cc70542e089edeec36a",
            "filename": "test/parallel/test-assert.js",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-assert.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-assert.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-assert.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -1,3 +1,4 @@\n+// Flags: --expose-internals\n // Copyright Joyent, Inc. and other Node contributors.\n //\n // Permission is hereby granted, free of charge, to any person obtaining a\n@@ -26,6 +27,7 @@\n const common = require('../common');\n const assert = require('assert');\n const { inspect } = require('util');\n+const { internalBinding } = require('internal/test/binding');\n const a = assert;\n \n // Disable colored output to prevent color codes from breaking assertion\n@@ -658,7 +660,7 @@ common.expectsError(\n \n {\n   // Test caching.\n-  const fs = process.binding('fs');\n+  const fs = internalBinding('fs');\n   const tmp = fs.close;\n   fs.close = common.mustCall(tmp, 1);\n   function throwErr() {"
        },
        {
            "sha": "6b069ddc51b7223fd092703c51472a420aced5b0",
            "filename": "test/parallel/test-fs-filehandle.js",
            "status": "modified",
            "additions": 13,
            "deletions": 6,
            "changes": 19,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-fs-filehandle.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-fs-filehandle.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-filehandle.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -4,7 +4,8 @@\n const common = require('../common');\n const assert = require('assert');\n const path = require('path');\n-const fs = process.binding('fs');\n+const { internalBinding } = require('internal/test/binding');\n+const fs = internalBinding('fs');\n const { stringToFlags } = require('internal/fs/utils');\n \n // Verifies that the FileHandle object is garbage collected and that a\n@@ -18,11 +19,17 @@ let fdnum;\n   assert.strictEqual(ctx.errno, undefined);\n }\n \n-common.expectWarning(\n-  'Warning',\n-  `Closing file descriptor ${fdnum} on garbage collection`,\n-  common.noWarnCode\n-);\n+common.expectWarning({\n+  'internal/test/binding': [\n+    'These APIs are exposed only for testing ' +\n+    'and are not tracked by any versioning system or deprecation process.',\n+    common.noWarnCode\n+  ],\n+  'Warning': [\n+    `Closing file descriptor ${fdnum} on garbage collection`,\n+    common.noWarnCode\n+  ]\n+});\n \n gc();  // eslint-disable-line no-undef\n "
        },
        {
            "sha": "118d78c1211a9e525401949b3a603c6e16f13847",
            "filename": "test/parallel/test-fs-sync-fd-leak.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-fs-sync-fd-leak.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-fs-sync-fd-leak.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-sync-fd-leak.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -42,7 +42,7 @@ fs.writeSync = function() {\n   throw new Error('BAM');\n };\n \n-process.binding('fs').fstat = function(fd, bigint, _, ctx) {\n+internalBinding('fs').fstat = function(fd, bigint, _, ctx) {\n   ctx.errno = UV_EBADF;\n   ctx.syscall = 'fstat';\n };"
        },
        {
            "sha": "07c4965f2204f3777a94ddc18259169e031f60a1",
            "filename": "test/parallel/test-module-binding.js",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-module-binding.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-module-binding.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-module-binding.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -1,7 +1,9 @@\n+// Flags: --expose-internals\n 'use strict';\n require('../common');\n const fixtures = require('../common/fixtures');\n-const { internalModuleReadJSON } = process.binding('fs');\n+const { internalBinding } = require('internal/test/binding');\n+const { internalModuleReadJSON } = internalBinding('fs');\n const { readFileSync } = require('fs');\n const { strictEqual } = require('assert');\n "
        },
        {
            "sha": "3eb87e2f0fac7c8508f05fd44f8102e64a5f1d65",
            "filename": "test/parallel/test-process-binding-internalbinding-whitelist.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-process-binding-internalbinding-whitelist.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fparallel%2Ftest-process-binding-internalbinding-whitelist.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-binding-internalbinding-whitelist.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -16,3 +16,4 @@ assert(process.binding('url'));\n assert(process.binding('spawn_sync'));\n assert(process.binding('js_stream'));\n assert(process.binding('buffer'));\n+assert(process.binding('fs'));"
        },
        {
            "sha": "16868de5585d1df74898f044f465ec77b9f835c6",
            "filename": "test/sequential/test-async-wrap-getasyncid.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e23e3ceb3217f2b0e076864fdbbe874a8603e2f/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-async-wrap-getasyncid.js?ref=1e23e3ceb3217f2b0e076864fdbbe874a8603e2f",
            "patch": "@@ -132,7 +132,7 @@ if (common.hasCrypto) { // eslint-disable-line node-core/crypto-check\n \n \n {\n-  const binding = process.binding('fs');\n+  const binding = internalBinding('fs');\n   const path = require('path');\n \n   const FSReqCallback = binding.FSReqCallback;"
        }
    ],
    "stats": {
        "total": 52,
        "additions": 33,
        "deletions": 19
    }
}