{
    "author": "sam-github",
    "message": "doc: fix echo example programs\n\nAdjust to work with self-signed certificates, and certificates that do\nnot name \"localhost\" as their host name.\nRemoved duplicate examples, they differed only by using `pfx`. Its not\nnecessary to show every option, and we don't, and the example wouldn't\nwork with most pfx anyway, since it didn't specify a password.\n\nPR-URL: https://github.com/nodejs/node/pull/24235\nReviewed-By: Vse Mozhet Byt <vsemozhetbyt@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ujjwal Sharma <usharma1998@gmail.com>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>",
    "sha": "05a11d1b647f6e7ce964eda6aef63427e51f96ea",
    "files": [
        {
            "sha": "7440dfa76223dc444b2d4527c494b2fc1b52e523",
            "filename": "doc/api/tls.md",
            "status": "modified",
            "additions": 12,
            "deletions": 65,
            "changes": 77,
            "blob_url": "https://github.com/nodejs/node/blob/05a11d1b647f6e7ce964eda6aef63427e51f96ea/doc%2Fapi%2Ftls.md",
            "raw_url": "https://github.com/nodejs/node/raw/05a11d1b647f6e7ce964eda6aef63427e51f96ea/doc%2Fapi%2Ftls.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Ftls.md?ref=05a11d1b647f6e7ce964eda6aef63427e51f96ea",
            "patch": "@@ -938,49 +938,24 @@ The `callback` function, if specified, will be added as a listener for the\n \n `tls.connect()` returns a [`tls.TLSSocket`][] object.\n \n-Here is an example of a client of echo server as described in\n+The following illustrates a client for the echo server example from\n [`tls.createServer()`][]:\n \n ```js\n-// This example assumes that you have created an echo server that is\n-// listening on port 8000.\n+// Assumes an echo server that is listening on port 8000.\n const tls = require('tls');\n const fs = require('fs');\n \n const options = {\n-  // Necessary only if using the client certificate authentication\n+  // Necessary only if the server requires client certificate authentication.\n   key: fs.readFileSync('client-key.pem'),\n   cert: fs.readFileSync('client-cert.pem'),\n \n-  // Necessary only if the server uses the self-signed certificate\n-  ca: [ fs.readFileSync('server-cert.pem') ]\n-};\n+  // Necessary only if the server uses a self-signed certificate.\n+  ca: [ fs.readFileSync('server-cert.pem') ],\n \n-const socket = tls.connect(8000, options, () => {\n-  console.log('client connected',\n-              socket.authorized ? 'authorized' : 'unauthorized');\n-  process.stdin.pipe(socket);\n-  process.stdin.resume();\n-});\n-socket.setEncoding('utf8');\n-socket.on('data', (data) => {\n-  console.log(data);\n-});\n-socket.on('end', () => {\n-  console.log('client ends');\n-});\n-```\n-\n-Or\n-\n-```js\n-// This example assumes that you have created an echo server that is\n-// listening on port 8000.\n-const tls = require('tls');\n-const fs = require('fs');\n-\n-const options = {\n-  pfx: fs.readFileSync('client.pfx')\n+  // Necessary only if the server's cert isn't for \"localhost\".\n+  checkServerIdentity: () => { return null; },\n };\n \n const socket = tls.connect(8000, options, () => {\n@@ -994,7 +969,7 @@ socket.on('data', (data) => {\n   console.log(data);\n });\n socket.on('end', () => {\n-  console.log('client ends');\n+  console.log('server ends connection');\n });\n ```\n \n@@ -1217,10 +1192,10 @@ const options = {\n   key: fs.readFileSync('server-key.pem'),\n   cert: fs.readFileSync('server-cert.pem'),\n \n-  // This is necessary only if using the client certificate authentication.\n+  // This is necessary only if using client certificate authentication.\n   requestCert: true,\n \n-  // This is necessary only if the client uses the self-signed certificate.\n+  // This is necessary only if the client uses a self-signed certificate.\n   ca: [ fs.readFileSync('client-cert.pem') ]\n };\n \n@@ -1236,36 +1211,8 @@ server.listen(8000, () => {\n });\n ```\n \n-Or\n-\n-```js\n-const tls = require('tls');\n-const fs = require('fs');\n-\n-const options = {\n-  pfx: fs.readFileSync('server.pfx'),\n-\n-  // This is necessary only if using the client certificate authentication.\n-  requestCert: true,\n-};\n-\n-const server = tls.createServer(options, (socket) => {\n-  console.log('server connected',\n-              socket.authorized ? 'authorized' : 'unauthorized');\n-  socket.write('welcome!\\n');\n-  socket.setEncoding('utf8');\n-  socket.pipe(socket);\n-});\n-server.listen(8000, () => {\n-  console.log('server bound');\n-});\n-```\n-\n-This server can be tested by connecting to it using `openssl s_client`:\n-\n-```sh\n-openssl s_client -connect 127.0.0.1:8000\n-```\n+The server can be tested by connecting to it using the example client from\n+[`tls.connect()`][].\n \n ## tls.getCiphers()\n <!-- YAML"
        }
    ],
    "stats": {
        "total": 77,
        "additions": 12,
        "deletions": 65
    }
}