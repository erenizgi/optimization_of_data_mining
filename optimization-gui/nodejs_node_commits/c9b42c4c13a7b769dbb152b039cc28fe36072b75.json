{
    "author": "juggernaut451",
    "message": "test: refactor parallel/test-tls-pause\n\nUse arrow functions and common.mustCall() and add a description.\n\nPR-URL: https://github.com/nodejs/node/pull/18714\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Weijia Wang <starkwang@126.com>\nReviewed-By: Yuta Hiroto <hello@about-hiroppy.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>",
    "sha": "c9b42c4c13a7b769dbb152b039cc28fe36072b75",
    "files": [
        {
            "sha": "a6130cd4331f62dd9f48eb32ba0493b8b972b8bf",
            "filename": "test/parallel/test-tls-pause.js",
            "status": "modified",
            "additions": 15,
            "deletions": 13,
            "changes": 28,
            "blob_url": "https://github.com/nodejs/node/blob/c9b42c4c13a7b769dbb152b039cc28fe36072b75/test%2Fparallel%2Ftest-tls-pause.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9b42c4c13a7b769dbb152b039cc28fe36072b75/test%2Fparallel%2Ftest-tls-pause.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tls-pause.js?ref=c9b42c4c13a7b769dbb152b039cc28fe36072b75",
            "patch": "@@ -24,6 +24,9 @@ const common = require('../common');\n if (!common.hasCrypto)\n   common.skip('missing crypto');\n \n+// This test ensures that the data received over tls-server after pause\n+// is same as what it was sent\n+\n const assert = require('assert');\n const tls = require('tls');\n const fixtures = require('../common/fixtures');\n@@ -37,24 +40,23 @@ const bufSize = 1024 * 1024;\n let sent = 0;\n let received = 0;\n \n-const server = tls.Server(options, function(socket) {\n+const server = tls.Server(options, common.mustCall((socket) => {\n   socket.pipe(socket);\n-  socket.on('data', function(c) {\n+  socket.on('data', (c) => {\n     console.error('data', c.length);\n   });\n-});\n+}));\n \n-server.listen(0, function() {\n+server.listen(0, common.mustCall(() => {\n   let resumed = false;\n   const client = tls.connect({\n-    port: this.address().port,\n+    port: server.address().port,\n     rejectUnauthorized: false\n-  }, function() {\n+  }, common.mustCall(() => {\n     console.error('connected');\n     client.pause();\n     console.error('paused');\n-    send();\n-    function send() {\n+    const send = (() => {\n       console.error('sending');\n       const ret = client.write(Buffer.allocUnsafe(bufSize));\n       console.error(`write => ${ret}`);\n@@ -69,9 +71,9 @@ server.listen(0, function() {\n       resumed = true;\n       client.resume();\n       console.error('resumed', client);\n-    }\n-  });\n-  client.on('data', function(data) {\n+    })();\n+  }));\n+  client.on('data', (data) => {\n     console.error('data');\n     assert.ok(resumed);\n     received += data.length;\n@@ -83,8 +85,8 @@ server.listen(0, function() {\n       server.close();\n     }\n   });\n-});\n+}));\n \n-process.on('exit', function() {\n+process.on('exit', () => {\n   assert.strictEqual(sent, received);\n });"
        }
    ],
    "stats": {
        "total": 28,
        "additions": 15,
        "deletions": 13
    }
}