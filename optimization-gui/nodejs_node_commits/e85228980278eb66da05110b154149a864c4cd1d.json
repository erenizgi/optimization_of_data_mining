{
    "author": "BridgeAR",
    "message": "util: fix inspected stack indentation\n\nError stacks and multiline error messages were not correct indented.\nThis is fixed by this patch.\n\nPR-URL: https://github.com/nodejs/node/pull/20802\nRefs: https://github.com/nodejs/node/issues/20253\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "e85228980278eb66da05110b154149a864c4cd1d",
    "files": [
        {
            "sha": "10c48d804b36e900d59805ea98f85efdd4e0f06f",
            "filename": "lib/util.js",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/e85228980278eb66da05110b154149a864c4cd1d/lib%2Futil.js",
            "raw_url": "https://github.com/nodejs/node/raw/e85228980278eb66da05110b154149a864c4cd1d/lib%2Futil.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Futil.js?ref=e85228980278eb66da05110b154149a864c4cd1d",
            "patch": "@@ -590,6 +590,11 @@ function formatValue(ctx, value, recurseTimes) {\n       if (base.indexOf('\\n    at') === -1) {\n         base = `[${base}]`;\n       }\n+      // The message and the stack have to be indented as well!\n+      if (ctx.indentationLvl !== 0) {\n+        const indentation = ' '.repeat(ctx.indentationLvl);\n+        base = formatError(value).replace(/\\n/g, `\\n${indentation}`);\n+      }\n       if (keyLength === 0)\n         return base;\n     } else if (isAnyArrayBuffer(value)) {"
        },
        {
            "sha": "20affd6c711fd8ac4ffc16572a1bdddd936ab529",
            "filename": "test/message/util_inspect_error.js",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/e85228980278eb66da05110b154149a864c4cd1d/test%2Fmessage%2Futil_inspect_error.js",
            "raw_url": "https://github.com/nodejs/node/raw/e85228980278eb66da05110b154149a864c4cd1d/test%2Fmessage%2Futil_inspect_error.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Futil_inspect_error.js?ref=e85228980278eb66da05110b154149a864c4cd1d",
            "patch": "@@ -0,0 +1,12 @@\n+'use strict';\n+\n+require('../common');\n+const util = require('util');\n+\n+const err = new Error('foo\\nbar');\n+\n+console.log(util.inspect({ err, nested: { err } }, { compact: true }));\n+console.log(util.inspect({ err, nested: { err } }, { compact: false }));\n+\n+err.foo = 'bar';\n+console.log(util.inspect(err, { compact: true, breakLength: 5 }));"
        },
        {
            "sha": "406d8112ce2599645a4703a6238e6631d6658656",
            "filename": "test/message/util_inspect_error.out",
            "status": "added",
            "additions": 63,
            "deletions": 0,
            "changes": 63,
            "blob_url": "https://github.com/nodejs/node/blob/e85228980278eb66da05110b154149a864c4cd1d/test%2Fmessage%2Futil_inspect_error.out",
            "raw_url": "https://github.com/nodejs/node/raw/e85228980278eb66da05110b154149a864c4cd1d/test%2Fmessage%2Futil_inspect_error.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fmessage%2Futil_inspect_error.out?ref=e85228980278eb66da05110b154149a864c4cd1d",
            "patch": "@@ -0,0 +1,63 @@\n+{ err:\n+   Error: foo\n+   bar\n+       at *util_inspect_error*\n+       at *\n+       at *\n+       at *\n+       at *\n+       at *\n+       at *\n+       at *\n+       at *\n+  nested:\n+   { err:\n+      Error: foo\n+      bar\n+          at *util_inspect_error*\n+          at *\n+          at *\n+          at *\n+          at *\n+          at *\n+          at *\n+          at *\n+          at * } }\n+{\n+  err: Error: foo\n+  bar\n+      at *util_inspect_error*\n+      at *\n+      at *\n+      at *\n+      at *\n+      at *\n+      at *\n+      at *\n+      at *,\n+  nested: {\n+    err: Error: foo\n+    bar\n+        at *util_inspect_error*\n+        at *\n+        at *\n+        at *\n+        at *\n+        at *\n+        at *\n+        at *\n+        at *\n+  }\n+}\n+{ Error: foo\n+bar\n+    at *util_inspect_error*\n+    at *\n+    at *\n+    at *\n+    at *\n+    at *\n+    at *\n+    at *\n+    at *\n+  foo: 'bar' }"
        }
    ],
    "stats": {
        "total": 80,
        "additions": 80,
        "deletions": 0
    }
}