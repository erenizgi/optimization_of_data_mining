{
    "author": "ofrobots",
    "message": "deps: cherry-pick bf5ea81 from upstream V8\n\nOriginal commit message:\n\n    [tracing] allow dynamic control of tracing\n\n    If the trace_buffer_ was null, we were returning a pointer to a static\n    flag back that permanently disabled that particular trace point.\n\n    This implied an assumption that tracing will be statically enabled at\n    process startup, and once it is disabled, it will never be enabled\n    again. On Node.js side we want to dynamically enable/disable tracing as per\n    programmer intent.\n\n    Change-Id: Ic7a7839b8450ab5c356d85e8e0826f42824907f4\n    Reviewed-on: https://chromium-review.googlesource.com/1161518\n    Reviewed-by: Yang Guo <yangguo@chromium.org>\n    Commit-Queue: Ali Ijaz Sheikh <ofrobots@google.com>\n    Cr-Commit-Position: refs/heads/master@{#54903}\n\nRefs: https://github.com/v8/v8/commit/bf5ea8138c0726613c9d722a3ccb552a8f477992\n\nPR-URL: https://github.com/nodejs/node/pull/22114\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "ec285c8c6697e2b415addd81fddafd81980f8b2c",
    "files": [
        {
            "sha": "5b744ad8799087c9867a29ba10b8c975a1555fad",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/ec285c8c6697e2b415addd81fddafd81980f8b2c/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/ec285c8c6697e2b415addd81fddafd81980f8b2c/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=ec285c8c6697e2b415addd81fddafd81980f8b2c",
            "patch": "@@ -29,7 +29,7 @@\n \n     # Reset this number to 0 on major V8 upgrades.\n     # Increment by one for each non-official patch applied to deps/v8.\n-    'v8_embedder_string': '-node.23',\n+    'v8_embedder_string': '-node.24',\n \n     # Enable disassembler for `--print-code` v8 options\n     'v8_enable_disassembler': 1,"
        },
        {
            "sha": "b4aa7baf724d4f29b4df08f3b57fdc018f6a32a7",
            "filename": "deps/v8/src/libplatform/tracing/tracing-controller.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 9,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/ec285c8c6697e2b415addd81fddafd81980f8b2c/deps%2Fv8%2Fsrc%2Flibplatform%2Ftracing%2Ftracing-controller.cc",
            "raw_url": "https://github.com/nodejs/node/raw/ec285c8c6697e2b415addd81fddafd81980f8b2c/deps%2Fv8%2Fsrc%2Flibplatform%2Ftracing%2Ftracing-controller.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Flibplatform%2Ftracing%2Ftracing-controller.cc?ref=ec285c8c6697e2b415addd81fddafd81980f8b2c",
            "patch": "@@ -24,18 +24,17 @@ namespace tracing {\n // convert internally to determine the category name from the char enabled\n // pointer.\n const char* g_category_groups[MAX_CATEGORY_GROUPS] = {\n-    \"toplevel\", \"tracing already shutdown\",\n+    \"toplevel\",\n     \"tracing categories exhausted; must increase MAX_CATEGORY_GROUPS\",\n     \"__metadata\"};\n \n // The enabled flag is char instead of bool so that the API can be used from C.\n unsigned char g_category_group_enabled[MAX_CATEGORY_GROUPS] = {0};\n // Indexes here have to match the g_category_groups array indexes above.\n-const int g_category_already_shutdown = 1;\n-const int g_category_categories_exhausted = 2;\n+const int g_category_categories_exhausted = 1;\n // Metadata category not used in V8.\n-// const int g_category_metadata = 3;\n-const int g_num_builtin_categories = 4;\n+// const int g_category_metadata = 2;\n+const int g_num_builtin_categories = 3;\n \n // Skip default categories.\n v8::base::AtomicWord g_category_index = g_num_builtin_categories;\n@@ -103,10 +102,6 @@ void TracingController::UpdateTraceEventDuration(\n \n const uint8_t* TracingController::GetCategoryGroupEnabled(\n     const char* category_group) {\n-  if (!trace_buffer_) {\n-    DCHECK(!g_category_group_enabled[g_category_already_shutdown]);\n-    return &g_category_group_enabled[g_category_already_shutdown];\n-  }\n   return GetCategoryGroupEnabledInternal(category_group);\n }\n "
        }
    ],
    "stats": {
        "total": 15,
        "additions": 5,
        "deletions": 10
    }
}