{
    "author": "bcoe",
    "message": "test: allow coverage threshold to be enforced\n\nIf COV_ENFORCE_THRESHOLD is set, tests run in coverage mode will\nexit with an error, if line coverage is below the percentage\nthreshold.\n\nPR-URL: https://github.com/nodejs/node/pull/25675\nReviewed-By: Refael Ackermann <refack@gmail.com>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>",
    "sha": "a861adde3bc22dec07e67f199be5f2c2aa226b44",
    "files": [
        {
            "sha": "fc88d632c94afa327c7dcc57fa16ea25071edc48",
            "filename": "Makefile",
            "status": "modified",
            "additions": 10,
            "deletions": 5,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/a861adde3bc22dec07e67f199be5f2c2aa226b44/Makefile",
            "raw_url": "https://github.com/nodejs/node/raw/a861adde3bc22dec07e67f199be5f2c2aa226b44/Makefile",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/Makefile?ref=a861adde3bc22dec07e67f199be5f2c2aa226b44",
            "patch": "@@ -215,7 +215,7 @@ coverage-build: all\n coverage-build-js:\n \tmkdir -p node_modules\n \tif [ ! -d node_modules/c8 ]; then \\\n-\t\t$(NODE) ./deps/npm install c8@next --no-save --no-package-lock;\\\n+\t\t$(NODE) ./deps/npm install c8 --no-save --no-package-lock;\\\n \tfi\n \n .PHONY: coverage-test\n@@ -240,12 +240,17 @@ coverage-test: coverage-build\n \t@grep -A3 Lines coverage/cxxcoverage.html | grep style  \\\n \t\t| sed 's/<[^>]*>//g'| sed 's/ //g'\n \n+COV_REPORT_OPTIONS = --reporter=html \\\n+\t--temp-directory=out/$(BUILDTYPE)/.coverage --omit-relative=false \\\n+\t--resolve=./lib --exclude=\"deps/\" --exclude=\"test/\" --exclude=\"tools/\" \\\n+\t--wrapper-length=0\n+ifdef COV_ENFORCE_THRESHOLD\n+  COV_REPORT_OPTIONS += --check-coverage --lines=$(COV_ENFORCE_THRESHOLD)\n+endif\n+\n .PHONY: coverage-report-js\n coverage-report-js:\n-\t$(NODE) ./node_modules/.bin/c8 report --reporter=html \\\n-\t\t--temp-directory=out/$(BUILDTYPE)/.coverage --omit-relative=false \\\n-\t\t--resolve=./lib --exclude=\"deps/\" --exclude=\"test/\" --exclude=\"tools/\" \\\n-\t\t--wrapper-length=0\n+\t$(NODE) ./node_modules/.bin/c8 report $(COV_REPORT_OPTIONS)\n \n .PHONY: cctest\n # Runs the C++ tests using the built `cctest` executable."
        }
    ],
    "stats": {
        "total": 15,
        "additions": 10,
        "deletions": 5
    }
}