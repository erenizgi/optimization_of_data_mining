{
    "author": "refack",
    "message": "build: don't change locale on smartos\n\nPR-URL: https://github.com/nodejs/node/pull/21220\nFixes: https://github.com/nodejs/build/issues/1327\nRefs: https://github.com/nodejs/node/pull/20394\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Rich Trott <rtrott@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>",
    "sha": "be8cfc7f7e49ac3e42a4c65e83002eb6a907e04b",
    "files": [
        {
            "sha": "db9c45a868fad476671c93ffb94e2d6b577888bc",
            "filename": "configure",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/be8cfc7f7e49ac3e42a4c65e83002eb6a907e04b/configure",
            "raw_url": "https://github.com/nodejs/node/raw/be8cfc7f7e49ac3e42a4c65e83002eb6a907e04b/configure",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/configure?ref=be8cfc7f7e49ac3e42a4c65e83002eb6a907e04b",
            "patch": "@@ -672,7 +672,10 @@ def get_xcode_version(cc):\n def get_gas_version(cc):\n   try:\n     custom_env = os.environ.copy()\n-    custom_env[\"LC_ALL\"] = \"en_US\"\n+    # smartos (a.k.a. sunos5) does not have the en_US locale, and will give:\n+    # `setlocale: LC_ALL: cannot change locale (en_US): Invalid argument`\n+    if 'sunos' not in sys.platform:\n+      custom_env[\"LC_ALL\"] = \"en_US\"\n     proc = subprocess.Popen(shlex.split(cc) + ['-Wa,-v', '-c', '-o',\n                                                '/dev/null', '-x',\n                                                'assembler',  '/dev/null'],\n@@ -685,12 +688,13 @@ def get_gas_version(cc):\n        consider adjusting the CC environment variable if you installed\n        it in a non-standard prefix.''')\n \n-  match = re.match(r\"GNU assembler version ([2-9]\\.[0-9]+)\",\n-                   proc.communicate()[1])\n+  gas_ret = proc.communicate()[1]\n+  match = re.match(r\"GNU assembler version ([2-9]\\.[0-9]+)\", gas_ret)\n \n   if match:\n     return match.group(1)\n   else:\n+    warn('Could not recognize `gas`: ' + gas_ret)\n     return '0'\n \n # Note: Apple clang self-reports as clang 4.2.0 and gcc 4.2.1.  It passes"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 7,
        "deletions": 3
    }
}