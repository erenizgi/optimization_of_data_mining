{
    "author": "BridgeAR",
    "message": "test: reduce runtime\n\nThis refactors some tests to reduce the runtime of those.\n\nPR-URL: https://github.com/nodejs/node/pull/20688\nRefs: https://github.com/nodejs/node/issues/20128\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Yang Guo <yangguo@chromium.org>",
    "sha": "352ae2397434ddde058c14cd357e3bdd1d029cb6",
    "files": [
        {
            "sha": "4cf1ef472b60376e26b0531b80bc058bcb7f3c8c",
            "filename": "test/parallel/test-async-wrap-pop-id-during-load.js",
            "status": "modified",
            "additions": 8,
            "deletions": 6,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/352ae2397434ddde058c14cd357e3bdd1d029cb6/test%2Fparallel%2Ftest-async-wrap-pop-id-during-load.js",
            "raw_url": "https://github.com/nodejs/node/raw/352ae2397434ddde058c14cd357e3bdd1d029cb6/test%2Fparallel%2Ftest-async-wrap-pop-id-during-load.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-async-wrap-pop-id-during-load.js?ref=352ae2397434ddde058c14cd357e3bdd1d029cb6",
            "patch": "@@ -7,15 +7,17 @@ if (process.argv[2] === 'async') {\n     fn();\n     throw new Error();\n   }\n-  (async function() { await fn(); })();\n-  // While the above should error, just in case it doesn't the script shouldn't\n-  // fork itself indefinitely so return early.\n-  return;\n+  return (async function() { await fn(); })();\n }\n \n const assert = require('assert');\n const { spawnSync } = require('child_process');\n \n-const ret = spawnSync(process.execPath, [__filename, 'async']);\n+const ret = spawnSync(\n+  process.execPath,\n+  ['--stack_size=50', __filename, 'async']\n+);\n assert.strictEqual(ret.status, 0);\n-assert.ok(!/async.*hook/i.test(ret.stderr.toString('utf8', 0, 1024)));\n+const stderr = ret.stderr.toString('utf8', 0, 2048);\n+assert.ok(!/async.*hook/i.test(stderr));\n+assert.ok(stderr.includes('UnhandledPromiseRejectionWarning: Error'), stderr);"
        },
        {
            "sha": "d7c059a65ab4d81908db9813a20cec07056cf31f",
            "filename": "test/parallel/test-child-process-exec-encoding.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/352ae2397434ddde058c14cd357e3bdd1d029cb6/test%2Fparallel%2Ftest-child-process-exec-encoding.js",
            "raw_url": "https://github.com/nodejs/node/raw/352ae2397434ddde058c14cd357e3bdd1d029cb6/test%2Fparallel%2Ftest-child-process-exec-encoding.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-child-process-exec-encoding.js?ref=352ae2397434ddde058c14cd357e3bdd1d029cb6",
            "patch": "@@ -1,17 +1,17 @@\n 'use strict';\n const common = require('../common');\n-const assert = require('assert');\n-const cp = require('child_process');\n const stdoutData = 'foo';\n const stderrData = 'bar';\n-const expectedStdout = `${stdoutData}\\n`;\n-const expectedStderr = `${stderrData}\\n`;\n \n if (process.argv[2] === 'child') {\n   // The following console calls are part of the test.\n   console.log(stdoutData);\n   console.error(stderrData);\n } else {\n+  const assert = require('assert');\n+  const cp = require('child_process');\n+  const expectedStdout = `${stdoutData}\\n`;\n+  const expectedStderr = `${stderrData}\\n`;\n   function run(options, callback) {\n     const cmd = `\"${process.execPath}\" \"${__filename}\" child`;\n "
        }
    ],
    "stats": {
        "total": 22,
        "additions": 12,
        "deletions": 10
    }
}