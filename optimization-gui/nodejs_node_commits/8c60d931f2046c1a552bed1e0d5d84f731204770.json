{
    "author": "joyeecheung",
    "message": "process: remove pushValueToArray in GetActiveHandles\n\nInstead of calling into JS from C++ to push values into an array,\nuse the new Array::New API that takes a pointer and a length\ndirectly.\n\nPR-URL: https://github.com/nodejs/node/pull/24264\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Refael Ackermann <refack@gmail.com>",
    "sha": "8c60d931f2046c1a552bed1e0d5d84f731204770",
    "files": [
        {
            "sha": "161833ebbd384312e1bb4ee139e10c6b2f40b058",
            "filename": "src/node_process.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 16,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/8c60d931f2046c1a552bed1e0d5d84f731204770/src%2Fnode_process.cc",
            "raw_url": "https://github.com/nodejs/node/raw/8c60d931f2046c1a552bed1e0d5d84f731204770/src%2Fnode_process.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_process.cc?ref=8c60d931f2046c1a552bed1e0d5d84f731204770",
            "patch": "@@ -813,26 +813,14 @@ void GetActiveRequests(const FunctionCallbackInfo<Value>& args) {\n void GetActiveHandles(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n \n-  Local<Array> ary = Array::New(env->isolate());\n-  Local<Context> ctx = env->context();\n-  Local<Function> fn = env->push_values_to_array_function();\n-  Local<Value> argv[NODE_PUSH_VAL_TO_ARRAY_MAX];\n-  size_t idx = 0;\n-\n+  std::vector<Local<Value>> handle_v;\n   for (auto w : *env->handle_wrap_queue()) {\n     if (!HandleWrap::HasRef(w))\n       continue;\n-    argv[idx] = w->GetOwner();\n-    if (++idx >= arraysize(argv)) {\n-      fn->Call(ctx, ary, idx, argv).ToLocalChecked();\n-      idx = 0;\n-    }\n-  }\n-  if (idx > 0) {\n-    fn->Call(ctx, ary, idx, argv).ToLocalChecked();\n+    handle_v.push_back(w->GetOwner());\n   }\n-\n-  args.GetReturnValue().Set(ary);\n+  args.GetReturnValue().Set(\n+      Array::New(env->isolate(), handle_v.data(), handle_v.size()));\n }\n \n void DebugPortGetter(Local<Name> property,"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 4,
        "deletions": 16
    }
}