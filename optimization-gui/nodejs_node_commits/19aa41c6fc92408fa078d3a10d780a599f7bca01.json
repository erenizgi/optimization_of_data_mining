{
    "author": "rubys",
    "message": "https: allow url and options to be passed to https.request\n\nPR-URL: https://github.com/nodejs/node/pull/22003\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "19aa41c6fc92408fa078d3a10d780a599f7bca01",
    "files": [
        {
            "sha": "12db2f452c17fabb962174b1f90a8f4f4d177ef3",
            "filename": "lib/https.js",
            "status": "modified",
            "additions": 18,
            "deletions": 11,
            "changes": 29,
            "blob_url": "https://github.com/nodejs/node/blob/19aa41c6fc92408fa078d3a10d780a599f7bca01/lib%2Fhttps.js",
            "raw_url": "https://github.com/nodejs/node/raw/19aa41c6fc92408fa078d3a10d780a599f7bca01/lib%2Fhttps.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fhttps.js?ref=19aa41c6fc92408fa078d3a10d780a599f7bca01",
            "patch": "@@ -255,9 +255,11 @@ Agent.prototype._evictSession = function _evictSession(key) {\n const globalAgent = new Agent();\n \n let urlWarningEmitted = false;\n-function request(options, cb) {\n-  if (typeof options === 'string') {\n-    const urlStr = options;\n+function request(...args) {\n+  let options = {};\n+\n+  if (typeof args[0] === 'string') {\n+    const urlStr = args.shift();\n     try {\n       options = urlToOptions(new URL(urlStr));\n     } catch (err) {\n@@ -273,19 +275,24 @@ function request(options, cb) {\n           'DeprecationWarning', 'DEP0109');\n       }\n     }\n-  } else if (options && options[searchParamsSymbol] &&\n-             options[searchParamsSymbol][searchParamsSymbol]) {\n+  } else if (args[0] && args[0][searchParamsSymbol] &&\n+             args[0][searchParamsSymbol][searchParamsSymbol]) {\n     // url.URL instance\n-    options = urlToOptions(options);\n-  } else {\n-    options = util._extend({}, options);\n+    options = urlToOptions(args.shift());\n+  }\n+\n+  if (args[0] && typeof args[0] !== 'function') {\n+    options = util._extend(options, args.shift());\n   }\n+\n   options._defaultAgent = globalAgent;\n-  return new ClientRequest(options, cb);\n+  args.unshift(options);\n+\n+  return new ClientRequest(...args);\n }\n \n-function get(options, cb) {\n-  const req = request(options, cb);\n+function get(input, options, cb) {\n+  const req = request(input, options, cb);\n   req.end();\n   return req;\n }"
        },
        {
            "sha": "44037ddd6de90b2cf185690da075ce2e59f8f9fc",
            "filename": "test/parallel/test-https-request-arguments.js",
            "status": "added",
            "additions": 46,
            "deletions": 0,
            "changes": 46,
            "blob_url": "https://github.com/nodejs/node/blob/19aa41c6fc92408fa078d3a10d780a599f7bca01/test%2Fparallel%2Ftest-https-request-arguments.js",
            "raw_url": "https://github.com/nodejs/node/raw/19aa41c6fc92408fa078d3a10d780a599f7bca01/test%2Fparallel%2Ftest-https-request-arguments.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-https-request-arguments.js?ref=19aa41c6fc92408fa078d3a10d780a599f7bca01",
            "patch": "@@ -0,0 +1,46 @@\n+'use strict';\n+const common = require('../common');\n+const assert = require('assert');\n+const https = require('https');\n+const fixtures = require('../common/fixtures');\n+\n+if (!common.hasCrypto)\n+  common.skip('missing crypto');\n+\n+const options = {\n+  key: fixtures.readKey('agent1-key.pem'),\n+  cert: fixtures.readKey('agent1-cert.pem'),\n+  ca: fixtures.readKey('ca1-cert.pem')\n+};\n+\n+// Test providing both a url and options, with the options partially\n+// replacing address and port portions of the URL provided.\n+{\n+  const server = https.createServer(\n+    options,\n+    common.mustCall((req, res) => {\n+      assert.strictEqual(req.url, '/testpath');\n+      res.end();\n+      server.close();\n+    })\n+  );\n+\n+  server.listen(\n+    0,\n+    common.mustCall(() => {\n+      https.get(\n+        'https://example.com/testpath',\n+\n+        {\n+          hostname: 'localhost',\n+          port: server.address().port,\n+          rejectUnauthorized: false\n+        },\n+\n+        common.mustCall((res) => {\n+          res.resume();\n+        })\n+      );\n+    })\n+  );\n+}"
        }
    ],
    "stats": {
        "total": 75,
        "additions": 64,
        "deletions": 11
    }
}