{
    "author": "danbev",
    "message": "crypto: add addCipherPrototypeFunctions function\n\nThis commit adds a function named addCipherPrototypeFunctions to avoid\ncode duplication.\n\nPR-URL: https://github.com/nodejs/node/pull/20164\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "d024c2cda11fd3db79c4846d871c596d41b9998d",
    "files": [
        {
            "sha": "75d4af717f27ddbc64508fc00772cc178a0f03be",
            "filename": "lib/internal/crypto/cipher.js",
            "status": "modified",
            "additions": 14,
            "deletions": 29,
            "changes": 43,
            "blob_url": "https://github.com/nodejs/node/blob/d024c2cda11fd3db79c4846d871c596d41b9998d/lib%2Finternal%2Fcrypto%2Fcipher.js",
            "raw_url": "https://github.com/nodejs/node/raw/d024c2cda11fd3db79c4846d871c596d41b9998d/lib%2Finternal%2Fcrypto%2Fcipher.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fcrypto%2Fcipher.js?ref=d024c2cda11fd3db79c4846d871c596d41b9998d",
            "patch": "@@ -236,17 +236,19 @@ function Cipheriv(cipher, key, iv, options) {\n   createCipherWithIV.call(this, cipher, key, options, true, iv);\n }\n \n-inherits(Cipheriv, LazyTransform);\n-\n-Cipheriv.prototype._transform = Cipher.prototype._transform;\n-Cipheriv.prototype._flush = Cipher.prototype._flush;\n-Cipheriv.prototype.update = Cipher.prototype.update;\n-Cipheriv.prototype.final = Cipher.prototype.final;\n-Cipheriv.prototype.setAutoPadding = Cipher.prototype.setAutoPadding;\n-Cipheriv.prototype.getAuthTag = Cipher.prototype.getAuthTag;\n-Cipheriv.prototype.setAuthTag = Cipher.prototype.setAuthTag;\n-Cipheriv.prototype.setAAD = Cipher.prototype.setAAD;\n+function addCipherPrototypeFunctions(constructor) {\n+  constructor.prototype._transform = Cipher.prototype._transform;\n+  constructor.prototype._flush = Cipher.prototype._flush;\n+  constructor.prototype.update = Cipher.prototype.update;\n+  constructor.prototype.final = Cipher.prototype.final;\n+  constructor.prototype.setAutoPadding = Cipher.prototype.setAutoPadding;\n+  constructor.prototype.getAuthTag = Cipher.prototype.getAuthTag;\n+  constructor.prototype.setAuthTag = Cipher.prototype.setAuthTag;\n+  constructor.prototype.setAAD = Cipher.prototype.setAAD;\n+}\n \n+inherits(Cipheriv, LazyTransform);\n+addCipherPrototypeFunctions(Cipheriv);\n \n function Decipher(cipher, password, options) {\n   if (!(this instanceof Decipher))\n@@ -256,15 +258,7 @@ function Decipher(cipher, password, options) {\n }\n \n inherits(Decipher, LazyTransform);\n-\n-Decipher.prototype._transform = Cipher.prototype._transform;\n-Decipher.prototype._flush = Cipher.prototype._flush;\n-Decipher.prototype.update = Cipher.prototype.update;\n-Decipher.prototype.final = Cipher.prototype.final;\n-Decipher.prototype.setAutoPadding = Cipher.prototype.setAutoPadding;\n-Decipher.prototype.getAuthTag = Cipher.prototype.getAuthTag;\n-Decipher.prototype.setAuthTag = Cipher.prototype.setAuthTag;\n-Decipher.prototype.setAAD = Cipher.prototype.setAAD;\n+addCipherPrototypeFunctions(Decipher);\n \n \n function Decipheriv(cipher, key, iv, options) {\n@@ -275,16 +269,7 @@ function Decipheriv(cipher, key, iv, options) {\n }\n \n inherits(Decipheriv, LazyTransform);\n-\n-Decipheriv.prototype._transform = Cipher.prototype._transform;\n-Decipheriv.prototype._flush = Cipher.prototype._flush;\n-Decipheriv.prototype.update = Cipher.prototype.update;\n-Decipheriv.prototype.final = Cipher.prototype.final;\n-Decipheriv.prototype.setAutoPadding = Cipher.prototype.setAutoPadding;\n-Decipheriv.prototype.getAuthTag = Cipher.prototype.getAuthTag;\n-Decipheriv.prototype.setAuthTag = Cipher.prototype.setAuthTag;\n-Decipheriv.prototype.setAAD = Cipher.prototype.setAAD;\n-\n+addCipherPrototypeFunctions(Decipheriv);\n \n module.exports = {\n   Cipher,"
        }
    ],
    "stats": {
        "total": 43,
        "additions": 14,
        "deletions": 29
    }
}