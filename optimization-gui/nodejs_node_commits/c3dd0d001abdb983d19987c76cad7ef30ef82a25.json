{
    "author": "richardlau",
    "message": "build: fix compiler version detection\n\nCompiler version tuples should be numeric for tuple comparisons\nto work.\n\nAlso correct check for AIX where the minimum supported GCC is 6.3.0\n\nPR-URL: https://github.com/nodejs/node/pull/24879\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>",
    "sha": "c3dd0d001abdb983d19987c76cad7ef30ef82a25",
    "files": [
        {
            "sha": "ca87082424853229b43b3738b42ef2d624bad123",
            "filename": "configure.py",
            "status": "modified",
            "additions": 5,
            "deletions": 4,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/c3dd0d001abdb983d19987c76cad7ef30ef82a25/configure.py",
            "raw_url": "https://github.com/nodejs/node/raw/c3dd0d001abdb983d19987c76cad7ef30ef82a25/configure.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/configure.py?ref=c3dd0d001abdb983d19987c76cad7ef30ef82a25",
            "patch": "@@ -655,8 +655,8 @@ def try_check_compiler(cc, lang):\n \n   values = (proc.communicate()[0].split() + ['0'] * 7)[0:7]\n   is_clang = values[0] == '1'\n-  gcc_version = tuple(values[1:1+3])\n-  clang_version = tuple(values[4:4+3])\n+  gcc_version = tuple(map(int, values[1:1+3]))\n+  clang_version = tuple(map(int, values[4:4+3])) if is_clang else None\n \n   return (True, is_clang, clang_version, gcc_version)\n \n@@ -753,6 +753,8 @@ def check_compiler(o):\n   ok, is_clang, clang_version, gcc_version = try_check_compiler(CXX, 'c++')\n   if not ok:\n     warn('failed to autodetect C++ compiler version (CXX=%s)' % CXX)\n+  elif sys.platform.startswith('aix') and gcc_version < (6, 3, 0):\n+    warn('C++ compiler too old, need g++ 6.3.0 (CXX=%s)' % CXX)\n   elif clang_version < (3, 4, 2) if is_clang else gcc_version < (4, 9, 4):\n     warn('C++ compiler too old, need g++ 4.9.4 or clang++ 3.4.2 (CXX=%s)' % CXX)\n \n@@ -921,8 +923,7 @@ def gcc_version_ge(version_checked):\n   for compiler in [(CC, 'c'), (CXX, 'c++')]:\n     ok, is_clang, clang_version, compiler_version = \\\n       try_check_compiler(compiler[0], compiler[1])\n-    compiler_version_num = tuple(map(int, compiler_version))\n-    if is_clang or compiler_version_num < version_checked:\n+    if is_clang or compiler_version < version_checked:\n       return False\n   return True\n "
        }
    ],
    "stats": {
        "total": 9,
        "additions": 5,
        "deletions": 4
    }
}