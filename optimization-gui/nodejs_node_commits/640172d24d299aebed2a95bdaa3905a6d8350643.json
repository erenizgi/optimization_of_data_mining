{
    "author": "tniessen",
    "message": "crypto: replace gotos\n\nPR-URL: https://github.com/nodejs/node/pull/23132\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Denys Otrishko <shishugi@gmail.com>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Sakthipriyan Vairamani <thechargingvolcano@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Gireesh Punathil <gpunathi@in.ibm.com>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "640172d24d299aebed2a95bdaa3905a6d8350643",
    "files": [
        {
            "sha": "cbe1be32737058a6518091942e78ae604cf5ce18",
            "filename": "src/node_crypto_clienthello.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 12,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/640172d24d299aebed2a95bdaa3905a6d8350643/src%2Fnode_crypto_clienthello.cc",
            "raw_url": "https://github.com/nodejs/node/raw/640172d24d299aebed2a95bdaa3905a6d8350643/src%2Fnode_crypto_clienthello.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto_clienthello.cc?ref=640172d24d299aebed2a95bdaa3905a6d8350643",
            "patch": "@@ -74,12 +74,6 @@ bool ClientHelloParser::ParseRecordHeader(const uint8_t* data, size_t avail) {\n \n void ClientHelloParser::ParseHeader(const uint8_t* data, size_t avail) {\n   ClientHello hello;\n-  bool failed = true;\n-\n-  OnScopeLeave cleanup([&]() {\n-    if (failed)\n-      End();\n-  });\n \n   // >= 5 + frame size bytes for frame parsing\n   if (body_offset_ + frame_len_ > avail)\n@@ -94,23 +88,23 @@ void ClientHelloParser::ParseHeader(const uint8_t* data, size_t avail) {\n   if (data[body_offset_ + 4] != 0x03 ||\n       data[body_offset_ + 5] < 0x01 ||\n       data[body_offset_ + 5] > 0x03) {\n-    return;\n+    return End();\n   }\n \n   if (data[body_offset_] == kClientHello) {\n     if (state_ == kTLSHeader) {\n       if (!ParseTLSClientHello(data, avail))\n-        return;\n+        return End();\n     } else {\n       // We couldn't get here, but whatever\n-      return;\n+      return End();\n     }\n \n     // Check if we overflowed (do not reply with any private data)\n     if (session_id_ == nullptr ||\n         session_size_ > 32 ||\n         session_id_ + session_size_ > data + avail) {\n-      return;\n+      return End();\n     }\n   }\n \n@@ -122,8 +116,6 @@ void ClientHelloParser::ParseHeader(const uint8_t* data, size_t avail) {\n   hello.servername_ = servername_;\n   hello.servername_size_ = static_cast<uint8_t>(servername_size_);\n   onhello_cb_(cb_arg_, hello);\n-  failed = false;\n-  return;\n }\n \n "
        }
    ],
    "stats": {
        "total": 16,
        "additions": 4,
        "deletions": 12
    }
}