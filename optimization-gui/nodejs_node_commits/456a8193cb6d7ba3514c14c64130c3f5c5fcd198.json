{
    "author": "jasnell",
    "message": "perf_hooks: always set bootstrapComplete\n\nPR-URL: https://github.com/nodejs/node/pull/20768\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "456a8193cb6d7ba3514c14c64130c3f5c5fcd198",
    "files": [
        {
            "sha": "d6fd67fe5d2c85f227c0494fb0f5de3c2fe5fff8",
            "filename": "lib/internal/bootstrap/node.js",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/456a8193cb6d7ba3514c14c64130c3f5c5fcd198/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "raw_url": "https://github.com/nodejs/node/raw/456a8193cb6d7ba3514c14c64130c3f5c5fcd198/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fnode.js?ref=456a8193cb6d7ba3514c14c64130c3f5c5fcd198",
            "patch": "@@ -158,12 +158,12 @@\n       // To allow people to extend Node in different ways, this hook allows\n       // one to drop a file lib/_third_party_main.js into the build\n       // directory which will be executed instead of Node's normal loading.\n+      perf.markMilestone(NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE);\n       process.nextTick(function() {\n         perf.markMilestone(NODE_PERFORMANCE_MILESTONE_THIRD_PARTY_MAIN_START);\n         NativeModule.require('_third_party_main');\n         perf.markMilestone(NODE_PERFORMANCE_MILESTONE_THIRD_PARTY_MAIN_END);\n       });\n-\n     } else if (process.argv[1] === 'inspect' || process.argv[1] === 'debug') {\n       if (process.argv[1] === 'debug') {\n         process.emitWarning(\n@@ -172,13 +172,14 @@\n       }\n \n       // Start the debugger agent.\n+      perf.markMilestone(NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE);\n       process.nextTick(function() {\n         NativeModule.require('internal/deps/node-inspect/lib/_inspect').start();\n       });\n \n     } else if (process.profProcess) {\n+      perf.markMilestone(NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE);\n       NativeModule.require('internal/v8_prof_processor');\n-\n     } else {\n       // There is user code to be run.\n \n@@ -209,6 +210,7 @@\n           addBuiltinLibsToObject\n         } = NativeModule.require('internal/modules/cjs/helpers');\n         addBuiltinLibsToObject(global);\n+        perf.markMilestone(NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE);\n         evalScript('[eval]');\n       } else if (process.argv[1] && process.argv[1] !== '-') {\n         perf.markMilestone(NODE_PERFORMANCE_MILESTONE_MODULE_LOAD_START);\n@@ -233,6 +235,7 @@\n           checkScriptSyntax(source, filename);\n           process.exit(0);\n         }\n+        perf.markMilestone(NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE);\n         CJSModule.runMain();\n       } else {\n         perf.markMilestone(NODE_PERFORMANCE_MILESTONE_MODULE_LOAD_START);\n@@ -263,6 +266,7 @@\n \n           if (process._eval != null) {\n             // User passed '-e' or '--eval'\n+            perf.markMilestone(NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE);\n             evalScript('[eval]');\n           }\n         } else {\n@@ -279,6 +283,7 @@\n               checkScriptSyntax(code, '[stdin]');\n             } else {\n               process._eval = code;\n+              perf.markMilestone(NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE);\n               evalScript('[stdin]');\n             }\n           });"
        },
        {
            "sha": "c5065227a6a410d522f9824441fcaa886d37b8e3",
            "filename": "test/sequential/test-performance.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/456a8193cb6d7ba3514c14c64130c3f5c5fcd198/test%2Fsequential%2Ftest-performance.js",
            "raw_url": "https://github.com/nodejs/node/raw/456a8193cb6d7ba3514c14c64130c3f5c5fcd198/test%2Fsequential%2Ftest-performance.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-performance.js?ref=456a8193cb6d7ba3514c14c64130c3f5c5fcd198",
            "patch": "@@ -74,7 +74,7 @@ checkNodeTiming({\n   duration: { around: performance.now() },\n   nodeStart: { around: 0 },\n   v8Start: { around: 0 },\n-  bootstrapComplete: -1,\n+  bootstrapComplete: { around: inited },\n   environment: { around: 0 },\n   loopStart: -1,\n   loopExit: -1,"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 8,
        "deletions": 3
    }
}