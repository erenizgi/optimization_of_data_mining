{
    "author": "addaleax",
    "message": "net: always invoke after-write callback\n\nThis is part of the streams API contract, and aligns\nnetwork sockets with other streams in this respect.\n\nPR-URL: https://github.com/nodejs/node/pull/24291\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Weijia Wang <starkwang@126.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "c347e77647ed7c25d2eba4860ce62dbddaa46307",
    "files": [
        {
            "sha": "503946047d1e4fe91e745247515c679ff175f8b3",
            "filename": "lib/net.js",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/c347e77647ed7c25d2eba4860ce62dbddaa46307/lib%2Fnet.js",
            "raw_url": "https://github.com/nodejs/node/raw/c347e77647ed7c25d2eba4860ce62dbddaa46307/lib%2Fnet.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fnet.js?ref=c347e77647ed7c25d2eba4860ce62dbddaa46307",
            "patch": "@@ -790,6 +790,8 @@ function afterWrite(status, handle, err) {\n   // callback may come after call to destroy.\n   if (self.destroyed) {\n     debug('afterWrite destroyed');\n+    if (this.callback)\n+      this.callback(null);\n     return;\n   }\n "
        },
        {
            "sha": "482ab8473527932b02493163f64c6d5eaecfc736",
            "filename": "test/parallel/test-tls-invoke-queued.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/c347e77647ed7c25d2eba4860ce62dbddaa46307/test%2Fparallel%2Ftest-tls-invoke-queued.js",
            "raw_url": "https://github.com/nodejs/node/raw/c347e77647ed7c25d2eba4860ce62dbddaa46307/test%2Fparallel%2Ftest-tls-invoke-queued.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tls-invoke-queued.js?ref=c347e77647ed7c25d2eba4860ce62dbddaa46307",
            "patch": "@@ -40,8 +40,8 @@ const server = tls.createServer({\n     c.write('world!', null, common.mustCall(function() {\n       c.destroy();\n     }));\n-    // Data on next _write() will be written but callback will not be invoked\n-    c.write(' gosh', null, common.mustNotCall());\n+    // Data on next _write() will be written, and the cb will still be invoked\n+    c.write(' gosh', null, common.mustCall());\n   }));\n \n   server.close();"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
    }
}