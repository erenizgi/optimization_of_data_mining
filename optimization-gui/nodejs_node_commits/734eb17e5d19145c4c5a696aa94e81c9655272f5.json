{
    "author": "apapirovski",
    "message": "timers: fix subsequent enroll calls not working\n\nA bug was introduced in #17704 which meant that subsequent\ncalls to enroll would unset the new _idleTimeout and the\nenrolled object could never again function as a timer.\n\nPR-URL: https://github.com/nodejs/node/pull/19936\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Rich Trott <rtrott@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Jeremiah Senkpiel <fishrock123@rocketmail.com>",
    "sha": "734eb17e5d19145c4c5a696aa94e81c9655272f5",
    "files": [
        {
            "sha": "7d3e7b5030956e914b3f2d69e2f9d833e9b24225",
            "filename": "lib/timers.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/734eb17e5d19145c4c5a696aa94e81c9655272f5/lib%2Ftimers.js",
            "raw_url": "https://github.com/nodejs/node/raw/734eb17e5d19145c4c5a696aa94e81c9655272f5/lib%2Ftimers.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ftimers.js?ref=734eb17e5d19145c4c5a696aa94e81c9655272f5",
            "patch": "@@ -353,13 +353,14 @@ exports.unenroll = util.deprecate(unenroll,\n // This function does not start the timer, see `active()`.\n // Using existing objects as timers slightly reduces object overhead.\n function enroll(item, msecs) {\n-  item._idleTimeout = validateTimerDuration(msecs);\n+  msecs = validateTimerDuration(msecs);\n \n   // if this item was already in a list somewhere\n   // then we should unenroll it from that\n   if (item._idleNext) unenroll(item);\n \n   L.init(item);\n+  item._idleTimeout = msecs;\n }\n \n exports.enroll = util.deprecate(enroll,"
        },
        {
            "sha": "a914e6c4a18a9802aceea8b4927083e9a16dead7",
            "filename": "test/parallel/test-timers-enroll-second-time.js",
            "status": "added",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/734eb17e5d19145c4c5a696aa94e81c9655272f5/test%2Fparallel%2Ftest-timers-enroll-second-time.js",
            "raw_url": "https://github.com/nodejs/node/raw/734eb17e5d19145c4c5a696aa94e81c9655272f5/test%2Fparallel%2Ftest-timers-enroll-second-time.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-timers-enroll-second-time.js?ref=734eb17e5d19145c4c5a696aa94e81c9655272f5",
            "patch": "@@ -0,0 +1,16 @@\n+'use strict';\n+\n+const common = require('../common');\n+\n+const assert = require('assert');\n+const timers = require('timers');\n+\n+const enrollObj = {\n+  _onTimeout: common.mustCall(),\n+};\n+\n+timers.enroll(enrollObj, 1);\n+assert.strictEqual(enrollObj._idleTimeout, 1);\n+timers.enroll(enrollObj, 10);\n+assert.strictEqual(enrollObj._idleTimeout, 10);\n+timers.active(enrollObj);"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 18,
        "deletions": 1
    }
}