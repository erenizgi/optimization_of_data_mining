{
    "author": "joaocgreis",
    "message": "win: do not use Boxstarter to install tools\n\nUse Chocolatey directly in the tools installation script.\n\nPR-URL: https://github.com/nodejs/node/pull/24677\nFixes: https://github.com/nodejs/node/issues/23838\nReviewed-By: Bartosz Sosnowski <bartosz@janeasystems.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>",
    "sha": "76afdffdf4aed0ce944867d32545505d25b77118",
    "files": [
        {
            "sha": "da927ed4829409d064fd5eb9f88927f694792d00",
            "filename": "tools/msvs/install_tools/install_tools.bat",
            "status": "modified",
            "additions": 15,
            "deletions": 44,
            "changes": 59,
            "blob_url": "https://github.com/nodejs/node/blob/76afdffdf4aed0ce944867d32545505d25b77118/tools%2Fmsvs%2Finstall_tools%2Finstall_tools.bat",
            "raw_url": "https://github.com/nodejs/node/raw/76afdffdf4aed0ce944867d32545505d25b77118/tools%2Fmsvs%2Finstall_tools%2Finstall_tools.bat",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Finstall_tools%2Finstall_tools.bat?ref=76afdffdf4aed0ce944867d32545505d25b77118",
            "patch": "@@ -1,31 +1,33 @@\n @echo off\n \n setlocal\n+title Install Additional Tools for Node.js\n \n cls\n+\n echo ====================================================\n echo Tools for Node.js Native Modules Installation Script\n echo ====================================================\n echo.\n-echo This Boxstarter script will install Python and the Visual Studio Build Tools,\n-echo necessary to compile Node.js native modules. Note that Boxstarter,\n-echo Chocolatey and required Windows updates will also be installed.\n+echo This script will install Python and the Visual Studio Build Tools, necessary\n+echo to compile Node.js native modules. Note that Chocolatey and required Windows\n+echo updates will also be installed.\n echo.\n echo This will require about 3 Gb of free disk space, plus any space necessary to\n-echo install Windows updates.\n-echo.\n-echo This will take a while to run. Your computer may reboot during the\n-echo installation, and will resume automatically.\n+echo install Windows updates. This will take a while to run.\n echo.\n-echo Please close all open programs for the duration of the installation.\n+echo Please close all open programs for the duration of the installation. If the\n+echo installation fails, please ensure Windows is fully updated, reboot your\n+echo computer and try to run this again. This script can be found in the\n+echo Start menu under Node.js.\n echo.\n-echo You can close this window to stop now. This script can be invoked from the\n-echo Start menu. Detailed instructions to install these tools manually are\n-echo available at https://github.com/nodejs/node-gyp#on-windows\n+echo You can close this window to stop now. Detailed instructions to install these\n+echo tools manually are available at https://github.com/nodejs/node-gyp#on-windows\n echo.\n pause\n \n cls\n+\n REM Adapted from https://github.com/Microsoft/windows-dev-box-setup-scripts/blob/79bbe5bdc4867088b3e074f9610932f8e4e192c2/README.md#legal\n echo Using this script downloads third party software\n echo ------------------------------------------------\n@@ -36,49 +38,18 @@ echo result of a Chocolatey install. This acceptance occurs whether you know the\n echo license terms or not. Read and understand the license terms of the packages\n echo being installed and their dependencies prior to installation:\n echo - https://chocolatey.org/packages/chocolatey\n-echo - https://chocolatey.org/packages/boxstarter\n echo - https://chocolatey.org/packages/python2\n-echo - https://chocolatey.org/packages/visualstudio2017buildtools\n echo - https://chocolatey.org/packages/visualstudio2017-workload-vctools\n echo.\n echo This script is provided AS-IS without any warranties of any kind\n echo ----------------------------------------------------------------\n echo Chocolatey has implemented security safeguards in their process to help\n echo protect the community from malicious or pirated software, but any use of this\n echo script is at your own risk. Please read the Chocolatey's legal terms of use\n-echo and the Boxstarter project license as well as how the community repository\n-echo for Chocolatey.org is maintained.\n+echo as well as how the community repository for Chocolatey.org is maintained.\n echo.\n pause\n \n cls\n-echo !!!!!WARNING!!!!!\n-echo -----------------\n-echo This script should make installing the tools as easy as possible. Hence, it\n-echo WILL NOT OFFER ANY CUSTOMIZATION. If there's any parameter you'd like to\n-echo customize (like installation directory or features), or if there's any\n-echo special rule or policy that your computer should comply to (like not being\n-echo able to log in as the user with administrative privileges), please follow the\n-echo instructions to download and execute the installers directly:\n-echo https://github.com/nodejs/node-gyp#on-windows\n-echo.\n-echo Use of Boxstarter may reboot your computer automatically multiple times.\n-echo When performing a reboot, Boxstarter will need to disable User Account\n-echo Control (UAC) to allow the script to run immediately after the reboot. When\n-echo the scripts have completed, Boxstarter will re-enable UAC. If you prematurely\n-echo stop the process, UAC will need to be re-enabled manually.\n-echo.\n-echo Sometimes the scripts may install all necessary Windows Updates which\n-echo could cause a high number of reboots that appear to be a reboot loop when\n-echo in fact it is just a normal Windows Updates reboot cycle.\n-:acceptretry\n-echo.\n-echo Your computer may REBOOT SEVERAL TIMES WITHOUT FURTHER WARNING.\n-echo Please type YES followed by enter to confirm that you have saved all your\n-set /p \"ACCEPT_PROMPT=work and closed all open programs: \"\n-if /i not \"%ACCEPT_PROMPT%\"==\"yes\" (\n-  echo Please type YES to confirm, or close the window to exit.\n-  goto acceptretry\n-)\n \n-\"%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command Start-Process '%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe' -ArgumentList '-NoProfile -InputFormat None -ExecutionPolicy Bypass -Command iex ((New-Object System.Net.WebClient).DownloadString(''https://boxstarter.org/bootstrapper.ps1'')); get-boxstarter -Force; Install-BoxstarterPackage -PackageName ''%~dp0\\install_tools.txt''; Read-Host ''Type ENTER to exit'' ' -Verb RunAs\n+\"%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command Start-Process '%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe' -ArgumentList '-NoProfile -InputFormat None -ExecutionPolicy Bypass -Command iex ((New-Object System.Net.WebClient).DownloadString(''https://chocolatey.org/install.ps1'')); choco upgrade -y python2 visualstudio2017-workload-vctools; Read-Host ''Type ENTER to exit'' ' -Verb RunAs"
        },
        {
            "sha": "baf530a774759ba7f9810d385a1e11556c0dd81e",
            "filename": "tools/msvs/install_tools/install_tools.txt",
            "status": "removed",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/bb01597a7706c9378c280b628e64e68558969d8f/tools%2Fmsvs%2Finstall_tools%2Finstall_tools.txt",
            "raw_url": "https://github.com/nodejs/node/raw/bb01597a7706c9378c280b628e64e68558969d8f/tools%2Fmsvs%2Finstall_tools%2Finstall_tools.txt",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Finstall_tools%2Finstall_tools.txt?ref=bb01597a7706c9378c280b628e64e68558969d8f",
            "patch": "@@ -1,3 +0,0 @@\n-choco upgrade -y python2\n-choco upgrade -y visualstudio2017buildtools\n-choco upgrade -y visualstudio2017-workload-vctools"
        },
        {
            "sha": "16d79173d6b05c2c632ca2b6c5926f8b0dbea889",
            "filename": "tools/msvs/msi/i18n/en-us.wxl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/76afdffdf4aed0ce944867d32545505d25b77118/tools%2Fmsvs%2Fmsi%2Fi18n%2Fen-us.wxl",
            "raw_url": "https://github.com/nodejs/node/raw/76afdffdf4aed0ce944867d32545505d25b77118/tools%2Fmsvs%2Fmsi%2Fi18n%2Fen-us.wxl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Fmsi%2Fi18n%2Fen-us.wxl?ref=76afdffdf4aed0ce944867d32545505d25b77118",
            "patch": "@@ -13,7 +13,7 @@\n     <String Id=\"NativeToolsDlgDescription\">Optionally install the tools necessary to compile native modules.</String>\n     <String Id=\"NativeToolsDlgBannerBitmap\">WixUI_Bmp_Banner</String>\n     <String Id=\"NativeToolsDlgIntro\">Some npm modules need to be compiled from C/C++ when installing. If you want to be able to install such modules, some tools (Python 2 and Visual Studio Build Tools) need to be installed.</String>\n-    <String Id=\"NativeToolsDlgInstallCheckbox\">Automatically install the necessary tools. Note that this will also install Boxstarter and Chocolatey. The script will pop-up in a new window after the installation completes.</String>\n+    <String Id=\"NativeToolsDlgInstallCheckbox\">Automatically install the necessary tools. Note that this will also install Chocolatey. The script will pop-up in a new window after the installation completes.</String>\n     <String Id=\"NativeToolsDlgManualDetails\">Alternatively, follow the instructions at <![CDATA[<a href=\"https://github.com/nodejs/node-gyp#on-windows\">https://github.com/nodejs/node-gyp#on-windows</a>]]> to install the dependencies yourself.</String>\n \n     <!-- References like [ProductName] or $(var.ProductName) don't seem to work in Title attributes -->"
        },
        {
            "sha": "b4457e43658d5721343101852b9d6a1a2a904e44",
            "filename": "tools/msvs/msi/product.wxs",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/76afdffdf4aed0ce944867d32545505d25b77118/tools%2Fmsvs%2Fmsi%2Fproduct.wxs",
            "raw_url": "https://github.com/nodejs/node/raw/76afdffdf4aed0ce944867d32545505d25b77118/tools%2Fmsvs%2Fmsi%2Fproduct.wxs",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Fmsi%2Fproduct.wxs?ref=76afdffdf4aed0ce944867d32545505d25b77118",
            "patch": "@@ -73,7 +73,6 @@\n       <ComponentRef Id=\"NodeStartMenu\"/>\n       <ComponentRef Id=\"AppData\" />\n       <ComponentRef Id=\"InstallToolsBat\" />\n-      <ComponentRef Id=\"InstallToolsTxt\" />\n       <ComponentGroupRef Id=\"Product.Generated\"/>\n \n       <Feature Id=\"NodeEtwSupport\"\n@@ -161,10 +160,6 @@\n         <File Id=\"InstallToolsBat\" KeyPath=\"yes\" Source=\"$(var.RepoDir)\\tools\\msvs\\install_tools\\install_tools.bat\"/>\n       </Component>\n \n-      <Component Id=\"InstallToolsTxt\">\n-        <File Id=\"InstallToolsTxt\" Source=\"$(var.RepoDir)\\tools\\msvs\\install_tools\\install_tools.txt\"/>\n-      </Component>\n-\n       <?if $(var.NoETW) != 1 ?>\n       <Component Id=\"NodeEtwSupport\">\n         <File Id=\"node_etw_provider.man\" Source=\"$(var.RepoDir)\\src\\res\\node_etw_provider.man\">"
        }
    ],
    "stats": {
        "total": 69,
        "additions": 16,
        "deletions": 53
    }
}