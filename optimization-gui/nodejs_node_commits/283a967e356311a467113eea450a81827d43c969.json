{
    "author": "addaleax",
    "message": "src: avoid `std::make_unique`\n\nWork around https://github.com/nodejs/build/issues/1254, which\neffectively breaks stress test CI and CITGM, by avoiding\n`std::make_unique` for now.\n\nThis workaround should be reverted once that issue is resolved.\n\nRefs: https://github.com/nodejs/build/issues/1254\n\nPR-URL: https://github.com/nodejs/node/pull/20386\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Matheus Marchini <matheus@sthima.com>",
    "sha": "283a967e356311a467113eea450a81827d43c969",
    "files": [
        {
            "sha": "4e0c04a7b95527b4c98ccb0b03b083eeccd62485",
            "filename": "src/inspector_agent.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/283a967e356311a467113eea450a81827d43c969/src%2Finspector_agent.cc",
            "raw_url": "https://github.com/nodejs/node/raw/283a967e356311a467113eea450a81827d43c969/src%2Finspector_agent.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector_agent.cc?ref=283a967e356311a467113eea450a81827d43c969",
            "patch": "@@ -367,8 +367,9 @@ class NodeInspectorClient : public V8InspectorClient {\n   int connectFrontend(std::unique_ptr<InspectorSessionDelegate> delegate) {\n     events_dispatched_ = true;\n     int session_id = next_session_id_++;\n-    channels_[session_id] =\n-        std::make_unique<ChannelImpl>(client_, std::move(delegate));\n+    // TODO(addaleax): Revert back to using make_unique once we get issues\n+    // with CI resolved (i.e. revert the patch that added this comment).\n+    channels_[session_id].reset(new ChannelImpl(client_, std::move(delegate)));\n     return session_id;\n   }\n \n@@ -569,7 +570,8 @@ void Agent::Stop() {\n std::unique_ptr<InspectorSession> Agent::Connect(\n     std::unique_ptr<InspectorSessionDelegate> delegate) {\n   int session_id = client_->connectFrontend(std::move(delegate));\n-  return std::make_unique<InspectorSession>(session_id, client_);\n+  return std::unique_ptr<InspectorSession>(\n+      new InspectorSession(session_id, client_));\n }\n \n void Agent::WaitForDisconnect() {"
        },
        {
            "sha": "38d88d7ab890c9ef5a66c0e01c45bf725891c8c2",
            "filename": "src/inspector_io.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/283a967e356311a467113eea450a81827d43c969/src%2Finspector_io.cc",
            "raw_url": "https://github.com/nodejs/node/raw/283a967e356311a467113eea450a81827d43c969/src%2Finspector_io.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector_io.cc?ref=283a967e356311a467113eea450a81827d43c969",
            "patch": "@@ -357,8 +357,8 @@ std::vector<std::string> InspectorIo::GetTargetIds() const {\n TransportAction InspectorIo::Attach(int session_id) {\n   Agent* agent = parent_env_->inspector_agent();\n   fprintf(stderr, \"Debugger attached.\\n\");\n-  sessions_[session_id] =\n-      agent->Connect(std::make_unique<IoSessionDelegate>(this, session_id));\n+  sessions_[session_id] = agent->Connect(std::unique_ptr<IoSessionDelegate>(\n+      new IoSessionDelegate(this, session_id)));\n   return TransportAction::kAcceptSession;\n }\n "
        },
        {
            "sha": "37cdcecd61dabbd51826630f6812aef4cf7aae4e",
            "filename": "src/inspector_js_api.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/283a967e356311a467113eea450a81827d43c969/src%2Finspector_js_api.cc",
            "raw_url": "https://github.com/nodejs/node/raw/283a967e356311a467113eea450a81827d43c969/src%2Finspector_js_api.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector_js_api.cc?ref=283a967e356311a467113eea450a81827d43c969",
            "patch": "@@ -66,8 +66,8 @@ class JSBindingsConnection : public AsyncWrap {\n                          callback_(env->isolate(), callback) {\n     Wrap(wrap, this);\n     Agent* inspector = env->inspector_agent();\n-    session_ = inspector->Connect(\n-        std::make_unique<JSBindingsSessionDelegate>(env, this));\n+    session_ = inspector->Connect(std::unique_ptr<JSBindingsSessionDelegate>(\n+        new JSBindingsSessionDelegate(env, this)));\n   }\n \n   void OnMessage(Local<Value> value) {"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 9,
        "deletions": 7
    }
}