{
    "author": "shigeki",
    "message": "tls: workaround handshakedone in renegotiation\n\n`SSL_CB_HANDSHAKE_START` and `SSL_CB_HANDSHAKE_DONE` are called\nsending HelloRequest in OpenSSL-1.1.1.\nWe need to check whether this is in a renegotiation state or not.\n\nPR-URL: https://github.com/nodejs/node/pull/25381\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Shigeki Ohtsu <ohtsu@ohtsu.org>",
    "sha": "bbed92ca85bfbd78d2af7af7b5bc56952fe0fa1a",
    "files": [
        {
            "sha": "f55f8ca3179ff48b39d75381c2a3a3439ee55bc2",
            "filename": "src/tls_wrap.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/bbed92ca85bfbd78d2af7af7b5bc56952fe0fa1a/src%2Ftls_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/bbed92ca85bfbd78d2af7af7b5bc56952fe0fa1a/src%2Ftls_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftls_wrap.cc?ref=bbed92ca85bfbd78d2af7af7b5bc56952fe0fa1a",
            "patch": "@@ -222,7 +222,10 @@ void TLSWrap::SSLInfoCallback(const SSL* ssl_, int where, int ret) {\n     }\n   }\n \n-  if (where & SSL_CB_HANDSHAKE_DONE) {\n+  // SSL_CB_HANDSHAKE_START and SSL_CB_HANDSHAKE_DONE are called\n+  // sending HelloRequest in OpenSSL-1.1.1.\n+  // We need to check whether this is in a renegotiation state or not.\n+  if (where & SSL_CB_HANDSHAKE_DONE && !SSL_renegotiate_pending(ssl)) {\n     Local<Value> callback;\n \n     c->established_ = true;"
        }
    ],
    "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
    }
}