{
    "author": "leeight",
    "message": "src: use arraysize instead of hardcode number\n\nPR-URL: https://github.com/nodejs/node/pull/24473\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Refael Ackermann <refack@gmail.com>",
    "sha": "adbf9477eb244b0f83a705b06269705967194f03",
    "files": [
        {
            "sha": "fa38040e3af64a7234340334fa3595cb21c860c8",
            "filename": "src/node_os.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/adbf9477eb244b0f83a705b06269705967194f03/src%2Fnode_os.cc",
            "raw_url": "https://github.com/nodejs/node/raw/adbf9477eb244b0f83a705b06269705967194f03/src%2Fnode_os.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_os.cc?ref=adbf9477eb244b0f83a705b06269705967194f03",
            "patch": "@@ -22,6 +22,7 @@\n #include \"node_internals.h\"\n #include \"string_bytes.h\"\n \n+#include <array>\n #include <errno.h>\n #include <string.h>\n \n@@ -219,7 +220,7 @@ static void GetInterfaceAddresses(const FunctionCallbackInfo<Value>& args) {\n   int count, i;\n   char ip[INET6_ADDRSTRLEN];\n   char netmask[INET6_ADDRSTRLEN];\n-  char mac[18];\n+  std::array<char, 18> mac;\n   Local<Object> ret, o;\n   Local<String> name, family;\n   Local<Array> ifarr;\n@@ -256,8 +257,8 @@ static void GetInterfaceAddresses(const FunctionCallbackInfo<Value>& args) {\n       ret->Set(env->context(), name, ifarr).FromJust();\n     }\n \n-    snprintf(mac,\n-             18,\n+    snprintf(mac.data(),\n+             mac.size(),\n              \"%02x:%02x:%02x:%02x:%02x:%02x\",\n              static_cast<unsigned char>(interfaces[i].phys_addr[0]),\n              static_cast<unsigned char>(interfaces[i].phys_addr[1]),"
        },
        {
            "sha": "b9fda6cf43e5217eb70a10a40100141bc1f4b462",
            "filename": "src/node_url.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/adbf9477eb244b0f83a705b06269705967194f03/src%2Fnode_url.cc",
            "raw_url": "https://github.com/nodejs/node/raw/adbf9477eb244b0f83a705b06269705967194f03/src%2Fnode_url.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_url.cc?ref=adbf9477eb244b0f83a705b06269705967194f03",
            "patch": "@@ -787,10 +787,11 @@ inline bool ToASCII(const std::string& input, std::string* output) {\n \n void URLHost::ParseIPv6Host(const char* input, size_t length) {\n   CHECK_EQ(type_, HostType::H_FAILED);\n-  for (unsigned n = 0; n < 8; n++)\n+  unsigned size = arraysize(value_.ipv6);\n+  for (unsigned n = 0; n < size; n++)\n     value_.ipv6[n] = 0;\n   uint16_t* piece_pointer = &value_.ipv6[0];\n-  uint16_t* const buffer_end = piece_pointer + 8;\n+  uint16_t* const buffer_end = piece_pointer + size;\n   uint16_t* compress_pointer = nullptr;\n   const char* pointer = input;\n   const char* end = pointer + length;\n@@ -952,7 +953,7 @@ void URLHost::ParseIPv4Host(const char* input, size_t length, bool* is_ipv4) {\n     const char ch = pointer < end ? pointer[0] : kEOL;\n     const int remaining = end - pointer - 1;\n     if (ch == '.' || ch == kEOL) {\n-      if (++parts > 4)\n+      if (++parts > static_cast<int>(arraysize(numbers)))\n         return;\n       if (pointer == mark)\n         return;"
        },
        {
            "sha": "9dd39fe1860b8e0a88c739ef6c98990e502a703e",
            "filename": "src/util.h",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/adbf9477eb244b0f83a705b06269705967194f03/src%2Futil.h",
            "raw_url": "https://github.com/nodejs/node/raw/adbf9477eb244b0f83a705b06269705967194f03/src%2Futil.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Futil.h?ref=adbf9477eb244b0f83a705b06269705967194f03",
            "patch": "@@ -37,6 +37,7 @@\n #include <functional>  // std::function\n #include <set>\n #include <string>\n+#include <array>\n #include <unordered_map>\n \n namespace node {\n@@ -223,6 +224,14 @@ inline v8::Local<v8::String> FIXED_ONE_BYTE_STRING(\n   return OneByteString(isolate, data, N - 1);\n }\n \n+template <std::size_t N>\n+inline v8::Local<v8::String> FIXED_ONE_BYTE_STRING(\n+    v8::Isolate* isolate,\n+    const std::array<char, N>& arr) {\n+  return OneByteString(isolate, arr.data(), N - 1);\n+}\n+\n+\n \n // Swaps bytes in place. nbytes is the number of bytes to swap and must be a\n // multiple of the word size (checked by function)."
        }
    ],
    "stats": {
        "total": 23,
        "additions": 17,
        "deletions": 6
    }
}