{
    "author": "cjihrig",
    "message": "deps: cherry-pick http_parser_set_max_header_size\n\nThis commit adds http_parser_set_max_header_size() to the\nhttp-parser for overriding the compile time maximum HTTP\nheader size.\n\nPR-URL: https://github.com/nodejs/node/pull/24811\nFixes: https://github.com/nodejs/node/issues/24692\nRefs: https://github.com/nodejs/http-parser/pull/453\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Myles Borins <myles.borins@gmail.com>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>\nReviewed-By: Сковорода Никита Андреевич <chalkerx@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Jeremiah Senkpiel <fishrock123@rocketmail.com>",
    "sha": "cdcb1b77379f780b7b187d711c44181dbd0a6e24",
    "files": [
        {
            "sha": "46764bced0947877273713361e02cbedccb676d4",
            "filename": "deps/http_parser/http_parser.c",
            "status": "modified",
            "additions": 11,
            "deletions": 4,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/cdcb1b77379f780b7b187d711c44181dbd0a6e24/deps%2Fhttp_parser%2Fhttp_parser.c",
            "raw_url": "https://github.com/nodejs/node/raw/cdcb1b77379f780b7b187d711c44181dbd0a6e24/deps%2Fhttp_parser%2Fhttp_parser.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2Fhttp_parser.c?ref=cdcb1b77379f780b7b187d711c44181dbd0a6e24",
            "patch": "@@ -25,6 +25,8 @@\n #include <string.h>\n #include <limits.h>\n \n+static uint32_t max_header_size = HTTP_MAX_HEADER_SIZE;\n+\n #ifndef ULLONG_MAX\n # define ULLONG_MAX ((uint64_t) -1) /* 2^64-1 */\n #endif\n@@ -137,20 +139,20 @@ do {                                                                 \\\n } while (0)\n \n /* Don't allow the total size of the HTTP headers (including the status\n- * line) to exceed HTTP_MAX_HEADER_SIZE.  This check is here to protect\n+ * line) to exceed max_header_size.  This check is here to protect\n  * embedders against denial-of-service attacks where the attacker feeds\n  * us a never-ending header that the embedder keeps buffering.\n  *\n  * This check is arguably the responsibility of embedders but we're doing\n  * it on the embedder's behalf because most won't bother and this way we\n- * make the web a little safer.  HTTP_MAX_HEADER_SIZE is still far bigger\n+ * make the web a little safer.  max_header_size is still far bigger\n  * than any reasonable request or response so this should never affect\n  * day-to-day operation.\n  */\n #define COUNT_HEADER_SIZE(V)                                         \\\n do {                                                                 \\\n   parser->nread += (V);                                              \\\n-  if (UNLIKELY(parser->nread > (HTTP_MAX_HEADER_SIZE))) {            \\\n+  if (UNLIKELY(parser->nread > max_header_size)) {                   \\\n     SET_ERRNO(HPE_HEADER_OVERFLOW);                                  \\\n     goto error;                                                      \\\n   }                                                                  \\\n@@ -1471,7 +1473,7 @@ size_t http_parser_execute (http_parser *parser,\n               const char* p_lf;\n               size_t limit = data + len - p;\n \n-              limit = MIN(limit, HTTP_MAX_HEADER_SIZE);\n+              limit = MIN(limit, max_header_size);\n \n               p_cr = (const char*) memchr(p, CR, limit);\n               p_lf = (const char*) memchr(p, LF, limit);\n@@ -2437,3 +2439,8 @@ http_parser_version(void) {\n          HTTP_PARSER_VERSION_MINOR * 0x00100 |\n          HTTP_PARSER_VERSION_PATCH * 0x00001;\n }\n+\n+void\n+http_parser_set_max_header_size(uint32_t size) {\n+  max_header_size = size;\n+}"
        },
        {
            "sha": "ea7bafef2c3178506f55d64623a7899472cee0b0",
            "filename": "deps/http_parser/http_parser.h",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/cdcb1b77379f780b7b187d711c44181dbd0a6e24/deps%2Fhttp_parser%2Fhttp_parser.h",
            "raw_url": "https://github.com/nodejs/node/raw/cdcb1b77379f780b7b187d711c44181dbd0a6e24/deps%2Fhttp_parser%2Fhttp_parser.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fhttp_parser%2Fhttp_parser.h?ref=cdcb1b77379f780b7b187d711c44181dbd0a6e24",
            "patch": "@@ -427,6 +427,9 @@ void http_parser_pause(http_parser *parser, int paused);\n /* Checks if this is the final chunk of the body. */\n int http_body_is_final(const http_parser *parser);\n \n+/* Change the maximum header size provided at compile time. */\n+void http_parser_set_max_header_size(uint32_t size);\n+\n #ifdef __cplusplus\n }\n #endif"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 14,
        "deletions": 4
    }
}