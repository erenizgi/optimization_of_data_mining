{
    "author": "jasnell",
    "message": "src: move DebugPortGetter/Setter to node_process.cc\n\nPR-URL: https://github.com/nodejs/node/pull/22758\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Refael Ackermann <refack@gmail.com>",
    "sha": "eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4",
    "files": [
        {
            "sha": "6baf2222e82ec2c15d6d85dfd28209dd04ad6fb2",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 27,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4",
            "patch": "@@ -160,7 +160,6 @@ using v8::Object;\n using v8::ObjectTemplate;\n using v8::Promise;\n using v8::PropertyAttribute;\n-using v8::PropertyCallbackInfo;\n using v8::ReadOnly;\n using v8::Script;\n using v8::ScriptCompiler;\n@@ -1672,32 +1671,6 @@ static Local<Object> GetFeatures(Environment* env) {\n   return scope.Escape(obj);\n }\n \n-\n-static void DebugPortGetter(Local<Name> property,\n-                            const PropertyCallbackInfo<Value>& info) {\n-  Environment* env = Environment::GetCurrent(info);\n-  Mutex::ScopedLock lock(process_mutex);\n-  int port = env->options()->debug_options->port();\n-#if HAVE_INSPECTOR\n-  if (port == 0) {\n-    if (auto io = env->inspector_agent()->io())\n-      port = io->port();\n-  }\n-#endif  // HAVE_INSPECTOR\n-  info.GetReturnValue().Set(port);\n-}\n-\n-\n-static void DebugPortSetter(Local<Name> property,\n-                            Local<Value> value,\n-                            const PropertyCallbackInfo<void>& info) {\n-  Environment* env = Environment::GetCurrent(info);\n-  Mutex::ScopedLock lock(process_mutex);\n-  env->options()->debug_options->host_port.port =\n-      value->Int32Value(env->context()).FromMaybe(0);\n-}\n-\n-\n static void DebugProcess(const FunctionCallbackInfo<Value>& args);\n static void DebugEnd(const FunctionCallbackInfo<Value>& args);\n "
        },
        {
            "sha": "c7a4299c89ec4e5c8a5a0ddaac3bbf7edc5b149a",
            "filename": "src/node_internals.h",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4/src%2Fnode_internals.h",
            "raw_url": "https://github.com/nodejs/node/raw/eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4/src%2Fnode_internals.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_internals.h?ref=eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4",
            "patch": "@@ -905,6 +905,11 @@ void EnvSetter(v8::Local<v8::Name> property,\n void EnvQuery(v8::Local<v8::Name> property,\n               const v8::PropertyCallbackInfo<v8::Integer>& info);\n void EnvEnumerator(const v8::PropertyCallbackInfo<v8::Array>& info);\n+void DebugPortGetter(v8::Local<v8::Name> property,\n+                     const v8::PropertyCallbackInfo<v8::Value>& info);\n+void DebugPortSetter(v8::Local<v8::Name> property,\n+                     v8::Local<v8::Value> value,\n+                     const v8::PropertyCallbackInfo<void>& info);\n \n void GetParentProcessId(v8::Local<v8::Name> property,\n                         const v8::PropertyCallbackInfo<v8::Value>& info);"
        },
        {
            "sha": "c223b482cf4dbdacb92fb79c813732f717f36b0a",
            "filename": "src/node_process.cc",
            "status": "modified",
            "additions": 29,
            "deletions": 0,
            "changes": 29,
            "blob_url": "https://github.com/nodejs/node/blob/eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4/src%2Fnode_process.cc",
            "raw_url": "https://github.com/nodejs/node/raw/eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4/src%2Fnode_process.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_process.cc?ref=eaaee92d9b0be82d7f40b2abb67f30ce525d4bc4",
            "patch": "@@ -7,6 +7,10 @@\n #include \"uv.h\"\n #include \"v8.h\"\n \n+#if HAVE_INSPECTOR\n+#include \"inspector_io.h\"\n+#endif\n+\n #include <limits.h>  // PATH_MAX\n #include <stdio.h>\n \n@@ -842,4 +846,29 @@ void GetActiveHandles(const FunctionCallbackInfo<Value>& args) {\n   args.GetReturnValue().Set(ary);\n }\n \n+void DebugPortGetter(Local<Name> property,\n+                     const PropertyCallbackInfo<Value>& info) {\n+  Environment* env = Environment::GetCurrent(info);\n+  Mutex::ScopedLock lock(process_mutex);\n+  int port = env->options()->debug_options->port();\n+#if HAVE_INSPECTOR\n+  if (port == 0) {\n+    if (auto io = env->inspector_agent()->io())\n+      port = io->port();\n+  }\n+#endif  // HAVE_INSPECTOR\n+  info.GetReturnValue().Set(port);\n+}\n+\n+\n+void DebugPortSetter(Local<Name> property,\n+                     Local<Value> value,\n+                     const PropertyCallbackInfo<void>& info) {\n+  Environment* env = Environment::GetCurrent(info);\n+  Mutex::ScopedLock lock(process_mutex);\n+  env->options()->debug_options->host_port.port =\n+      value->Int32Value(env->context()).FromMaybe(0);\n+}\n+\n+\n }  // namespace node"
        }
    ],
    "stats": {
        "total": 61,
        "additions": 34,
        "deletions": 27
    }
}