{
    "author": "backes",
    "message": "src: ensure no more platform foreground tasks after Deinit\n\nNode first calls `Isolate::Dispose`, then\n`NodePlatform::UnregisterIsolate`.\nThis again calls `PerIsolatePlatformData::Shutdown`, which (before this\npatch) called `FlushForegroundTasksInternal`, which might call\n`RunForegroundTask` if it finds foreground tasks to be executed. This\nwill fail however, since `Isolate::GetCurrent` was already reset during\n`Isolate::Dispose`.\nHence remove the check to `FlushForegroundTasksInternal` and add checks\ninstead that no more foreground tasks are scheduled.\n\nRefs: https://github.com/v8/node/pull/86\n\nPR-URL: https://github.com/nodejs/node/pull/25653\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "bafd80883ce2b7ac8f92f31119243af1473269f3",
    "files": [
        {
            "sha": "797d4d9cbb0dac99d855da903b2d2177d8eed30c",
            "filename": "src/node_platform.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/bafd80883ce2b7ac8f92f31119243af1473269f3/src%2Fnode_platform.cc",
            "raw_url": "https://github.com/nodejs/node/raw/bafd80883ce2b7ac8f92f31119243af1473269f3/src%2Fnode_platform.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_platform.cc?ref=bafd80883ce2b7ac8f92f31119243af1473269f3",
            "patch": "@@ -265,7 +265,8 @@ void PerIsolatePlatformData::Shutdown() {\n   if (flush_tasks_ == nullptr)\n     return;\n \n-  while (FlushForegroundTasksInternal()) {}\n+  CHECK_NULL(foreground_delayed_tasks_.Pop());\n+  CHECK_NULL(foreground_tasks_.Pop());\n   CancelPendingDelayedTasks();\n \n   uv_close(reinterpret_cast<uv_handle_t*>(flush_tasks_),"
        }
    ],
    "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
    }
}