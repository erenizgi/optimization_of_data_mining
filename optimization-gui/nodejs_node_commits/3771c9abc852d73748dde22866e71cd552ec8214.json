{
    "author": "psmarshall",
    "message": "deps: backport detailed line info for CPU profiler\n\n[cpu-profiler] Add flag to always generate accurate line info.\nhttps://chromium.googlesource.com/v8/v8/+/\n56baf56790de439b3f69e887e94beb3b301ed77c\n\n[cpu-profiler] Turn on detailed line info for optimized code\nhttps://chromium.googlesource.com/v8/v8/+/\n84894ce6d2af7feb9e1f5574409355120887326c\n\n[cpu-profiler] Separate the flags for generating extra line information\nhttps://chromium.googlesource.com/v8/v8/+/\n30ff6719db441cc7ef220d449970cc169067e256\n\nPR-URL: https://github.com/nodejs/node/pull/22688\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "3771c9abc852d73748dde22866e71cd552ec8214",
    "files": [
        {
            "sha": "65a3ff119103d31f039e0cb50cc6236b8240b54a",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/3771c9abc852d73748dde22866e71cd552ec8214/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/3771c9abc852d73748dde22866e71cd552ec8214/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=3771c9abc852d73748dde22866e71cd552ec8214",
            "patch": "@@ -29,7 +29,7 @@\n \n     # Reset this number to 0 on major V8 upgrades.\n     # Increment by one for each non-official patch applied to deps/v8.\n-    'v8_embedder_string': '-node.8',\n+    'v8_embedder_string': '-node.9',\n \n     # Enable disassembler for `--print-code` v8 options\n     'v8_enable_disassembler': 1,"
        },
        {
            "sha": "4d5aa6f885465865e0b29c0cd26bcca41571f0bd",
            "filename": "deps/v8/src/flag-definitions.h",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/3771c9abc852d73748dde22866e71cd552ec8214/deps%2Fv8%2Fsrc%2Fflag-definitions.h",
            "raw_url": "https://github.com/nodejs/node/raw/3771c9abc852d73748dde22866e71cd552ec8214/deps%2Fv8%2Fsrc%2Fflag-definitions.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fflag-definitions.h?ref=3771c9abc852d73748dde22866e71cd552ec8214",
            "patch": "@@ -1243,6 +1243,9 @@ DEFINE_BOOL(log_function_events, false,\n DEFINE_BOOL(prof, false,\n             \"Log statistical profiling information (implies --log-code).\")\n \n+DEFINE_BOOL(detailed_line_info, true,\n+            \"Always generate detailed line information for CPU profiling.\")\n+\n #if defined(ANDROID)\n // Phones and tablets have processors that are much slower than desktop\n // and laptop computers for which current heuristics are tuned."
        },
        {
            "sha": "b33b713672a6d471652a1b9c1fc508f15278e1cb",
            "filename": "deps/v8/src/isolate.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/3771c9abc852d73748dde22866e71cd552ec8214/deps%2Fv8%2Fsrc%2Fisolate.cc",
            "raw_url": "https://github.com/nodejs/node/raw/3771c9abc852d73748dde22866e71cd552ec8214/deps%2Fv8%2Fsrc%2Fisolate.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fisolate.cc?ref=3771c9abc852d73748dde22866e71cd552ec8214",
            "patch": "@@ -3247,6 +3247,10 @@ bool Isolate::use_optimizer() {\n          !is_precise_count_code_coverage() && !is_block_count_code_coverage();\n }\n \n+bool Isolate::NeedsDetailedOptimizedCodeLineInfo() const {\n+  return NeedsSourcePositionsForProfiling() || FLAG_detailed_line_info;\n+}\n+\n bool Isolate::NeedsSourcePositionsForProfiling() const {\n   return FLAG_trace_deopt || FLAG_trace_turbo || FLAG_trace_turbo_graph ||\n          FLAG_turbo_profiling || FLAG_perf_prof || is_profiling() ||"
        },
        {
            "sha": "d94c0fde147f50764171c5a2896921c9811fd0b3",
            "filename": "deps/v8/src/isolate.h",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/3771c9abc852d73748dde22866e71cd552ec8214/deps%2Fv8%2Fsrc%2Fisolate.h",
            "raw_url": "https://github.com/nodejs/node/raw/3771c9abc852d73748dde22866e71cd552ec8214/deps%2Fv8%2Fsrc%2Fisolate.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fisolate.h?ref=3771c9abc852d73748dde22866e71cd552ec8214",
            "patch": "@@ -1044,6 +1044,8 @@ class Isolate : private HiddenFactory {\n \n   bool NeedsSourcePositionsForProfiling() const;\n \n+  bool NeedsDetailedOptimizedCodeLineInfo() const;\n+\n   bool is_best_effort_code_coverage() const {\n     return code_coverage_mode() == debug::Coverage::kBestEffort;\n   }"
        },
        {
            "sha": "77730919f14dc2545b88d140478d7ac05e6db0b0",
            "filename": "deps/v8/src/optimized-compilation-info.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/3771c9abc852d73748dde22866e71cd552ec8214/deps%2Fv8%2Fsrc%2Foptimized-compilation-info.cc",
            "raw_url": "https://github.com/nodejs/node/raw/3771c9abc852d73748dde22866e71cd552ec8214/deps%2Fv8%2Fsrc%2Foptimized-compilation-info.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Foptimized-compilation-info.cc?ref=3771c9abc852d73748dde22866e71cd552ec8214",
            "patch": "@@ -38,7 +38,7 @@ OptimizedCompilationInfo::OptimizedCompilationInfo(\n   // Collect source positions for optimized code when profiling or if debugger\n   // is active, to be able to get more precise source positions at the price of\n   // more memory consumption.\n-  if (isolate->NeedsSourcePositionsForProfiling()) {\n+  if (isolate->NeedsDetailedOptimizedCodeLineInfo()) {\n     MarkAsSourcePositionsEnabled();\n   }\n "
        }
    ],
    "stats": {
        "total": 13,
        "additions": 11,
        "deletions": 2
    }
}