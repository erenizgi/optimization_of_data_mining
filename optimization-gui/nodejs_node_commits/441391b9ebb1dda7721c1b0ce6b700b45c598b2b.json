{
    "author": "rubys",
    "message": "tools: add [src] links to async_hooks.html\n\nhandle ES2015 Class, contructor, and instance methods\n\nunrelated: update Makefile so that generated HTML is out of date whenever\ntools/doc/apilinks.js is updated.\n\nPR-URL: https://github.com/nodejs/node/pull/22656\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "441391b9ebb1dda7721c1b0ce6b700b45c598b2b",
    "files": [
        {
            "sha": "7f9a57804b77606a3bec03f6be707969d71d3562",
            "filename": "Makefile",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/441391b9ebb1dda7721c1b0ce6b700b45c598b2b/Makefile",
            "raw_url": "https://github.com/nodejs/node/raw/441391b9ebb1dda7721c1b0ce6b700b45c598b2b/Makefile",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/Makefile?ref=441391b9ebb1dda7721c1b0ce6b700b45c598b2b",
            "patch": "@@ -653,10 +653,12 @@ out/apilinks.json: $(wildcard lib/*.js) tools/doc/apilinks.js\n \t$(call available-node, $(gen-apilink))\n \n out/doc/api/%.json out/doc/api/%.html: doc/api/%.md tools/doc/generate.js \\\n-\ttools/doc/html.js tools/doc/json.js | out/apilinks.json\n+\ttools/doc/html.js tools/doc/json.js tools/doc/apilinks.js | \\\n+\tout/apilinks.json\n \t$(call available-node, $(gen-api))\n \n-out/doc/api/all.html: $(apidocs_html) tools/doc/allhtml.js\n+out/doc/api/all.html: $(apidocs_html) tools/doc/allhtml.js \\\n+\ttools/doc/apilinks.js\n \t$(call available-node, tools/doc/allhtml.js)\n \n out/doc/api/all.json: $(apidocs_json) tools/doc/alljson.js"
        },
        {
            "sha": "7db5c008e623f139a82c64d5224e80aa4892d2f2",
            "filename": "test/fixtures/apilinks/class.js",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/441391b9ebb1dda7721c1b0ce6b700b45c598b2b/test%2Ffixtures%2Fapilinks%2Fclass.js",
            "raw_url": "https://github.com/nodejs/node/raw/441391b9ebb1dda7721c1b0ce6b700b45c598b2b/test%2Ffixtures%2Fapilinks%2Fclass.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fapilinks%2Fclass.js?ref=441391b9ebb1dda7721c1b0ce6b700b45c598b2b",
            "patch": "@@ -0,0 +1,12 @@\n+'use strict';\n+\n+// An exported class using ES2015 class syntax.\n+\n+class Class {\n+  constructor() {};\n+  method() {};\n+}\n+\n+module.exports = {\n+  Class\n+};"
        },
        {
            "sha": "091a041510188e0c29bc450ef2254b1d600a8935",
            "filename": "test/fixtures/apilinks/class.json",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/441391b9ebb1dda7721c1b0ce6b700b45c598b2b/test%2Ffixtures%2Fapilinks%2Fclass.json",
            "raw_url": "https://github.com/nodejs/node/raw/441391b9ebb1dda7721c1b0ce6b700b45c598b2b/test%2Ffixtures%2Fapilinks%2Fclass.json",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fapilinks%2Fclass.json?ref=441391b9ebb1dda7721c1b0ce6b700b45c598b2b",
            "patch": "@@ -0,0 +1,5 @@\n+{\n+  \"Class\": \"class.js#L5\",\n+  \"new Class\": \"class.js#L6\",\n+  \"class.method\": \"class.js#L7\"\n+}"
        },
        {
            "sha": "b0a221cf014179d6a897d630a006d2f2dfda858b",
            "filename": "tools/doc/apilinks.js",
            "status": "modified",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/nodejs/node/blob/441391b9ebb1dda7721c1b0ce6b700b45c598b2b/tools%2Fdoc%2Fapilinks.js",
            "raw_url": "https://github.com/nodejs/node/raw/441391b9ebb1dda7721c1b0ce6b700b45c598b2b/tools%2Fdoc%2Fapilinks.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fdoc%2Fapilinks.js?ref=441391b9ebb1dda7721c1b0ce6b700b45c598b2b",
            "patch": "@@ -107,6 +107,7 @@ process.argv.slice(2).forEach((file) => {\n   //   ClassName.foo = ...;\n   //   ClassName.prototype.foo = ...;\n   //   function Identifier(...) {...};\n+  //   class Foo {...}\n   //\n   const indirect = {};\n \n@@ -153,6 +154,24 @@ process.argv.slice(2).forEach((file) => {\n       if (basename.startsWith('_')) return;\n       definition[`${basename}.${name}`] =\n         `${link}#L${statement.loc.start.line}`;\n+\n+    } else if (statement.type === 'ClassDeclaration') {\n+      if (!exported.constructors.includes(statement.id.name)) return;\n+      definition[statement.id.name] = `${link}#L${statement.loc.start.line}`;\n+\n+      const name = statement.id.name.slice(0, 1).toLowerCase() +\n+                  statement.id.name.slice(1);\n+\n+      statement.body.body.forEach((defn) => {\n+        if (defn.type !== 'MethodDefinition') return;\n+        if (defn.kind === 'method') {\n+          definition[`${name}.${defn.key.name}`] =\n+            `${link}#L${defn.loc.start.line}`;\n+        } else if (defn.kind === 'constructor') {\n+          definition[`new ${statement.id.name}`] =\n+            `${link}#L${defn.loc.start.line}`;\n+        }\n+      });\n     }\n   });\n "
        }
    ],
    "stats": {
        "total": 42,
        "additions": 40,
        "deletions": 2
    }
}