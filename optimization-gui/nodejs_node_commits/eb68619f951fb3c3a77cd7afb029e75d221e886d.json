{
    "author": "joyeecheung",
    "message": "src: move process.reallyExit impl into node_process_methods.cc\n\nBecause the part that is shared by `process.reallyExit` and the\nNode.js teardown is `WaitForInspectorDisconnect()`, move that\ninto node_internals.h instead, and move the C++ binding code\ninto `node_process_methods.cc` since that's the only place\nit's needed.\n\nPR-URL: https://github.com/nodejs/node/pull/25860\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Minwoo Jung <minwoo@nodesource.com>\nReviewed-By: Jeremiah Senkpiel <fishrock123@rocketmail.com>",
    "sha": "eb68619f951fb3c3a77cd7afb029e75d221e886d",
    "files": [
        {
            "sha": "dfd691facdb569c6bb03c72a43bd3fa363060034",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 9,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/eb68619f951fb3c3a77cd7afb029e75d221e886d/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/eb68619f951fb3c3a77cd7afb029e75d221e886d/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=eb68619f951fb3c3a77cd7afb029e75d221e886d",
            "patch": "@@ -118,7 +118,6 @@ using v8::Exception;\n using v8::Function;\n using v8::FunctionCallbackInfo;\n using v8::HandleScope;\n-using v8::Int32;\n using v8::Isolate;\n using v8::Just;\n using v8::Local;\n@@ -158,7 +157,7 @@ struct V8Platform v8_platform;\n static const unsigned kMaxSignal = 32;\n #endif\n \n-static void WaitForInspectorDisconnect(Environment* env) {\n+void WaitForInspectorDisconnect(Environment* env) {\n #if HAVE_INSPECTOR\n   if (env->inspector_agent()->IsActive()) {\n     // Restore signal dispositions, the app is done and is no longer\n@@ -178,13 +177,6 @@ static void WaitForInspectorDisconnect(Environment* env) {\n #endif\n }\n \n-void Exit(const FunctionCallbackInfo<Value>& args) {\n-  Environment* env = Environment::GetCurrent(args);\n-  WaitForInspectorDisconnect(env);\n-  int code = args[0]->Int32Value(env->context()).FromMaybe(0);\n-  env->Exit(code);\n-}\n-\n void SignalExit(int signo) {\n   uv_tty_reset_mode();\n #ifdef __FreeBSD__"
        },
        {
            "sha": "c94be6ebe9155d002f4c90cc2a01cd0e817fed38",
            "filename": "src/node_internals.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/eb68619f951fb3c3a77cd7afb029e75d221e886d/src%2Fnode_internals.h",
            "raw_url": "https://github.com/nodejs/node/raw/eb68619f951fb3c3a77cd7afb029e75d221e886d/src%2Fnode_internals.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_internals.h?ref=eb68619f951fb3c3a77cd7afb029e75d221e886d",
            "patch": "@@ -86,7 +86,7 @@ void GetSockOrPeerName(const v8::FunctionCallbackInfo<v8::Value>& args) {\n   args.GetReturnValue().Set(err);\n }\n \n-void Exit(const v8::FunctionCallbackInfo<v8::Value>& args);\n+void WaitForInspectorDisconnect(Environment* env);\n void SignalExit(int signo);\n #ifdef __POSIX__\n void RegisterSignalHandler(int signal,"
        },
        {
            "sha": "be91a11f566baa46c3f16183f0980450afcf0c1a",
            "filename": "src/node_process_methods.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/eb68619f951fb3c3a77cd7afb029e75d221e886d/src%2Fnode_process_methods.cc",
            "raw_url": "https://github.com/nodejs/node/raw/eb68619f951fb3c3a77cd7afb029e75d221e886d/src%2Fnode_process_methods.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_process_methods.cc?ref=eb68619f951fb3c3a77cd7afb029e75d221e886d",
            "patch": "@@ -385,6 +385,13 @@ static void DebugEnd(const FunctionCallbackInfo<Value>& args) {\n #endif\n }\n \n+static void ReallyExit(const FunctionCallbackInfo<Value>& args) {\n+  Environment* env = Environment::GetCurrent(args);\n+  WaitForInspectorDisconnect(env);\n+  int code = args[0]->Int32Value(env->context()).FromMaybe(0);\n+  env->Exit(code);\n+}\n+\n static void InitializeProcessMethods(Local<Object> target,\n                                      Local<Value> unused,\n                                      Local<Context> context,\n@@ -416,7 +423,7 @@ static void InitializeProcessMethods(Local<Object> target,\n \n   env->SetMethodNoSideEffect(target, \"cwd\", Cwd);\n   env->SetMethod(target, \"dlopen\", binding::DLOpen);\n-  env->SetMethod(target, \"reallyExit\", Exit);\n+  env->SetMethod(target, \"reallyExit\", ReallyExit);\n   env->SetMethodNoSideEffect(target, \"uptime\", Uptime);\n }\n "
        }
    ],
    "stats": {
        "total": 21,
        "additions": 10,
        "deletions": 11
    }
}