{
    "author": "GlenTiki",
    "message": "src: Remove lttng support.\n\nThis cleans up and removes lttng support completely. Recent discussion\non a PR to deprecate lttng suggested that we remove it completely\npending feedback from the TSC.\n\nThis should be considered a non breaking change, as a recent PR reveals\nthat compiling with this system has been broken for nearly two years.\n\nRefs: https://github.com/nodejs/node/issues/18971\nRefs: https://github.com/nodejs/node/pull/18975\nRefs: https://github.com/nodejs/node/pull/18945\n\nPR-URL: https://github.com/nodejs/node/pull/18982\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Jackson Tian <shyvo1987@gmail.com>\nReviewed-By: Evan Lucas <evanlucas@me.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
    "files": [
        {
            "sha": "f020dce888c458e0dc935aa39b97632773ccf848",
            "filename": ".eslintrc.js",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/.eslintrc.js",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/.eslintrc.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/.eslintrc.js?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -263,12 +263,6 @@ module.exports = {\n     DTRACE_HTTP_SERVER_RESPONSE: false,\n     DTRACE_NET_SERVER_CONNECTION: false,\n     DTRACE_NET_STREAM_END: false,\n-    LTTNG_HTTP_CLIENT_REQUEST: false,\n-    LTTNG_HTTP_CLIENT_RESPONSE: false,\n-    LTTNG_HTTP_SERVER_REQUEST: false,\n-    LTTNG_HTTP_SERVER_RESPONSE: false,\n-    LTTNG_NET_SERVER_CONNECTION: false,\n-    LTTNG_NET_STREAM_END: false,\n     internalBinding: false,\n   },\n };"
        },
        {
            "sha": "5d2e800015f72c93e2847354972ac60bf4514a0f",
            "filename": "configure",
            "status": "modified",
            "additions": 0,
            "deletions": 14,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/configure",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/configure",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/configure?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -383,11 +383,6 @@ parser.add_option('--with-dtrace',\n     dest='with_dtrace',\n     help='build with DTrace (default is true on sunos and darwin)')\n \n-parser.add_option('--with-lttng',\n-    action='store_true',\n-    dest='with_lttng',\n-    help='build with Lttng (Only supported on Linux)')\n-\n parser.add_option('--with-etw',\n     action='store_true',\n     dest='with_etw',\n@@ -908,15 +903,6 @@ def configure_node(o):\n   else:\n     o['variables']['node_use_dtrace'] = 'false'\n \n-  # Enable Lttng if --with-lttng was defined. Use logic similar to\n-  # ETW for windows. Lttng is only available on the Linux platform.\n-  if flavor == 'linux':\n-    o['variables']['node_use_lttng'] = b(options.with_lttng)\n-  elif options.with_lttng:\n-    raise Exception('lttng is only supported on Linux.')\n-  else:\n-    o['variables']['node_use_lttng'] = 'false'\n-\n   if options.no_ifaddrs:\n     o['defines'] += ['SUNOS_NO_IFADDRS']\n "
        },
        {
            "sha": "de2b4fb28bc6cf69badb85312dca195f9b4251d0",
            "filename": "deps/node-inspect/.eslintrc",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/deps%2Fnode-inspect%2F.eslintrc",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/deps%2Fnode-inspect%2F.eslintrc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fnode-inspect%2F.eslintrc?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -139,9 +139,3 @@ globals:\n   DTRACE_HTTP_SERVER_RESPONSE: false\n   DTRACE_NET_SERVER_CONNECTION: false\n   DTRACE_NET_STREAM_END: false\n-  LTTNG_HTTP_CLIENT_REQUEST: false\n-  LTTNG_HTTP_CLIENT_RESPONSE: false\n-  LTTNG_HTTP_SERVER_REQUEST: false\n-  LTTNG_HTTP_SERVER_RESPONSE: false\n-  LTTNG_NET_SERVER_CONNECTION: false\n-  LTTNG_NET_STREAM_END: false"
        },
        {
            "sha": "b80fe687ef5f008b6483971070ef68883d9ab111",
            "filename": "doc/guides/contributing/pull-requests.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/doc%2Fguides%2Fcontributing%2Fpull-requests.md",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/doc%2Fguides%2Fcontributing%2Fpull-requests.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fguides%2Fcontributing%2Fpull-requests.md?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -146,7 +146,7 @@ A good commit message should describe what changed and why.\n \n    Examples:\n    - `net: add localAddress and localPort to Socket`\n-   - `src: fix typos in node_lttng_provider.h`\n+   - `src: fix typos in async_wrap.h`\n \n \n 2. Keep the second line blank."
        },
        {
            "sha": "727dc649c016aed0d249bca2f25e8647f87513f1",
            "filename": "lib/_http_client.js",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/lib%2F_http_client.js",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/lib%2F_http_client.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_client.js?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -254,7 +254,6 @@ util.inherits(ClientRequest, OutgoingMessage);\n \n ClientRequest.prototype._finish = function _finish() {\n   DTRACE_HTTP_CLIENT_REQUEST(this, this.connection);\n-  LTTNG_HTTP_CLIENT_REQUEST(this, this.connection);\n   COUNTER_HTTP_CLIENT_REQUEST();\n   OutgoingMessage.prototype._finish.call(this);\n };\n@@ -511,7 +510,6 @@ function parserOnIncomingClient(res, shouldKeepAlive) {\n   }\n \n   DTRACE_HTTP_CLIENT_RESPONSE(socket, req);\n-  LTTNG_HTTP_CLIENT_RESPONSE(socket, req);\n   COUNTER_HTTP_CLIENT_RESPONSE();\n   req.res = res;\n   res.req = req;"
        },
        {
            "sha": "1b9b4677d50ba2849377d8392f4638fb82c190ef",
            "filename": "lib/_http_server.js",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/lib%2F_http_server.js",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/lib%2F_http_server.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_server.js?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -135,7 +135,6 @@ util.inherits(ServerResponse, OutgoingMessage);\n \n ServerResponse.prototype._finish = function _finish() {\n   DTRACE_HTTP_SERVER_RESPONSE(this.connection);\n-  LTTNG_HTTP_SERVER_RESPONSE(this.connection);\n   COUNTER_HTTP_SERVER_RESPONSE();\n   OutgoingMessage.prototype._finish.call(this);\n };\n@@ -611,7 +610,6 @@ function parserOnIncoming(server, socket, state, req, keepAlive) {\n \n   res.shouldKeepAlive = keepAlive;\n   DTRACE_HTTP_SERVER_REQUEST(req, socket);\n-  LTTNG_HTTP_SERVER_REQUEST(req, socket);\n   COUNTER_HTTP_SERVER_REQUEST();\n \n   if (socket._httpMessage) {"
        },
        {
            "sha": "9ff26c74515eaae0a3474fe022ced6adce8d0eb4",
            "filename": "lib/net.js",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/lib%2Fnet.js",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/lib%2Fnet.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fnet.js?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -506,7 +506,6 @@ Socket.prototype._read = function(n) {\n Socket.prototype.end = function(data, encoding, callback) {\n   stream.Duplex.prototype.end.call(this, data, encoding, callback);\n   DTRACE_NET_STREAM_END(this);\n-  LTTNG_NET_STREAM_END(this);\n   return this;\n };\n \n@@ -1579,7 +1578,6 @@ function onconnection(err, clientHandle) {\n   socket._server = self;\n \n   DTRACE_NET_SERVER_CONNECTION(socket);\n-  LTTNG_NET_SERVER_CONNECTION(socket);\n   COUNTER_NET_SERVER_CONNECTION(socket);\n   self.emit('connection', socket);\n }"
        },
        {
            "sha": "cbf0542965ca831102c2efee27c97247b2513c4d",
            "filename": "node.gyp",
            "status": "modified",
            "additions": 0,
            "deletions": 17,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/node.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/node.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/node.gyp?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -3,7 +3,6 @@\n     'v8_use_snapshot%': 'false',\n     'v8_trace_maps%': 0,\n     'node_use_dtrace%': 'false',\n-    'node_use_lttng%': 'false',\n     'node_use_etw%': 'false',\n     'node_use_perfctr%': 'false',\n     'node_no_browser_globals%': 'false',\n@@ -530,19 +529,6 @@\n             }],\n           ],\n         }],\n-        [ 'node_use_lttng==\"true\"', {\n-          'defines': [ 'HAVE_LTTNG=1' ],\n-          'include_dirs': [ '<(SHARED_INTERMEDIATE_DIR)' ],\n-          'libraries': [ '-llttng-ust' ],\n-          'include_dirs': [\n-            'src',\n-            'tools/msvs/genfiles',\n-            '<(SHARED_INTERMEDIATE_DIR)' # for node_natives.h\n-          ],\n-          'sources': [\n-            'src/node_lttng.cc'\n-          ],\n-        }],\n         [ 'node_use_dtrace==\"true\"', {\n           'defines': [ 'HAVE_DTRACE=1' ],\n           'dependencies': [\n@@ -736,9 +722,6 @@\n             [ 'node_use_dtrace==\"false\" and node_use_etw==\"false\"', {\n               'inputs': [ 'src/notrace_macros.py' ]\n             }],\n-            [ 'node_use_lttng==\"false\"', {\n-              'inputs': [ 'src/nolttng_macros.py' ]\n-            }],\n             [ 'node_use_perfctr==\"false\"', {\n               'inputs': [ 'src/noperfctr_macros.py' ]\n             }]"
        },
        {
            "sha": "d3749b9cc129376a99c6bdc907d8498f33472fff",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 8,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -49,10 +49,6 @@\n #include \"node_dtrace.h\"\n #endif\n \n-#if defined HAVE_LTTNG\n-#include \"node_lttng.h\"\n-#endif\n-\n #include \"ares.h\"\n #include \"async_wrap-inl.h\"\n #include \"env-inl.h\"\n@@ -3340,10 +3336,6 @@ void LoadEnvironment(Environment* env) {\n   InitDTrace(env, global);\n #endif\n \n-#if defined HAVE_LTTNG\n-  InitLTTNG(env, global);\n-#endif\n-\n #if defined HAVE_PERFCTR\n   InitPerfCounters(env, global);\n #endif"
        },
        {
            "sha": "1f6f4322a5fe79880df0f694d29f5acb70872950",
            "filename": "src/node_lttng.cc",
            "status": "removed",
            "additions": 0,
            "deletions": 262,
            "changes": 262,
            "blob_url": "https://github.com/nodejs/node/blob/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnode_lttng.cc",
            "raw_url": "https://github.com/nodejs/node/raw/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnode_lttng.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_lttng.cc?ref=38eb0fa7372052433520ea2e1575072892bc5eec",
            "patch": "@@ -1,262 +0,0 @@\n-#include \"util.h\"\n-\n-#ifdef HAVE_LTTNG\n-#include \"node_lttng.h\"\n-#include \"node_lttng_provider.h\"\n-#include <string.h>\n-#else\n-#define NODE_HTTP_SERVER_REQUEST(arg0, arg1)\n-#define NODE_HTTP_SERVER_REQUEST_ENABLED() (0)\n-#define NODE_HTTP_SERVER_RESPONSE(arg0)\n-#define NODE_HTTP_SERVER_RESPONSE_ENABLED() (0)\n-#define NODE_HTTP_CLIENT_REQUEST(arg0, arg1)\n-#define NODE_HTTP_CLIENT_REQUEST_ENABLED() (0)\n-#define NODE_HTTP_CLIENT_RESPONSE(arg0)\n-#define NODE_HTTP_CLIENT_RESPONSE_ENABLED() (0)\n-#define NODE_NET_SERVER_CONNECTION(arg0)\n-#define NODE_NET_SERVER_CONNECTION_ENABLED() (0)\n-#define NODE_NET_STREAM_END(arg0)\n-#define NODE_NET_STREAM_END_ENABLED() (0)\n-#define NODE_GC_START(arg0, arg1, arg2)\n-#define NODE_GC_DONE(arg0, arg1, arg2)\n-#endif\n-\n-#include \"env-inl.h\"\n-\n-namespace node {\n-\n-using v8::FunctionCallbackInfo;\n-using v8::FunctionTemplate;\n-using v8::GCCallbackFlags;\n-using v8::GCType;\n-using v8::HandleScope;\n-using v8::Isolate;\n-using v8::Local;\n-using v8::Object;\n-using v8::String;\n-using v8::Value;\n-\n-#define SLURP_STRING(obj, member, valp) \\\n-  if (!(obj)->IsObject()) { \\\n-    return env->ThrowError( \\\n-        \"expected object for \" #obj \" to contain string member \" #member); \\\n-  } \\\n-  node::Utf8Value _##member(env->isolate(), \\\n-      obj->Get(OneByteString(env->isolate(), #member))); \\\n-  if ((*(const char **)valp = *_##member) == nullptr) \\\n-    *(const char **)valp = \"<unknown>\";\n-\n-#define SLURP_INT(obj, member, valp) \\\n-  if (!(obj)->IsObject()) { \\\n-    return env->ThrowError( \\\n-      \"expected object for \" #obj \" to contain integer member \" #member); \\\n-  } \\\n-  *valp = obj->Get(OneByteString(env->isolate(), #member)) \\\n-      ->ToInteger(env->isolate())->Value();\n-\n-#define SLURP_OBJECT(obj, member, valp) \\\n-  if (!(obj)->IsObject()) { \\\n-    return env->ThrowError( \\\n-      \"expected object for \" #obj \" to contain object member \" #member); \\\n-  } \\\n-  *valp = Local<Object>::Cast(obj->Get(OneByteString(env->isolate(), #member)));\n-\n-#define SLURP_CONNECTION(arg, conn) \\\n-  if (!(arg)->IsObject()) { \\\n-    return env->ThrowError( \\\n-      \"expected argument \" #arg \" to be a connection object\"); \\\n-  } \\\n-  node_lttng_connection_t conn; \\\n-  Local<Object> _##conn = Local<Object>::Cast(arg); \\\n-  Local<Value> _handle = \\\n-      (_##conn)->Get(FIXED_ONE_BYTE_STRING(env->isolate(), \"_handle\")); \\\n-  if (_handle->IsObject()) { \\\n-    SLURP_INT(_handle.As<Object>(), fd, &conn.fd); \\\n-  } else { \\\n-    conn.fd = -1; \\\n-  } \\\n-  SLURP_STRING(_##conn, remoteAddress, &conn.remote); \\\n-  SLURP_INT(_##conn, remotePort, &conn.port); \\\n-  SLURP_INT(_##conn, bufferSize, &conn.buffered);\n-\n-#define SLURP_CONNECTION_HTTP_CLIENT(arg, conn) \\\n-  if (!(arg)->IsObject()) { \\\n-    return env->ThrowError( \\\n-      \"expected argument \" #arg \" to be a connection object\"); \\\n-  } \\\n-  node_lttng_connection_t conn; \\\n-  Local<Object> _##conn = Local<Object>::Cast(arg); \\\n-  SLURP_INT(_##conn, fd, &conn.fd); \\\n-  SLURP_STRING(_##conn, host, &conn.remote); \\\n-  SLURP_INT(_##conn, port, &conn.port); \\\n-  SLURP_INT(_##conn, bufferSize, &conn.buffered);\n-\n-#define SLURP_CONNECTION_HTTP_CLIENT_RESPONSE(arg0, arg1, conn) \\\n-  if (!(arg0)->IsObject()) { \\\n-    return env->ThrowError( \\\n-      \"expected argument \" #arg0 \" to be a connection object\"); \\\n-  } \\\n-  if (!(arg1)->IsObject()) { \\\n-    return env->ThrowError( \\\n-      \"expected argument \" #arg1 \" to be a connection object\"); \\\n-  } \\\n-  node_lttng_connection_t conn; \\\n-  Local<Object> _##conn = Local<Object>::Cast(arg0); \\\n-  SLURP_INT(_##conn, fd, &conn.fd); \\\n-  SLURP_INT(_##conn, bufferSize, &conn.buffered); \\\n-  _##conn = Local<Object>::Cast(arg1); \\\n-  SLURP_STRING(_##conn, host, &conn.remote); \\\n-  SLURP_INT(_##conn, port, &conn.port);\n-\n-\n-void LTTNG_NET_SERVER_CONNECTION(const FunctionCallbackInfo<Value>& args) {\n-  if (!NODE_NET_SERVER_CONNECTION_ENABLED())\n-    return;\n-  Environment* env = Environment::GetCurrent(args);\n-  SLURP_CONNECTION(args[0], conn);\n-  NODE_NET_SERVER_CONNECTION(&conn, conn.remote, conn.port, conn.fd);\n-}\n-\n-\n-void LTTNG_NET_STREAM_END(const FunctionCallbackInfo<Value>& args) {\n-  if (!NODE_NET_STREAM_END_ENABLED())\n-    return;\n-  Environment* env = Environment::GetCurrent(args);\n-  SLURP_CONNECTION(args[0], conn);\n-  NODE_NET_STREAM_END(&conn, conn.remote, conn.port, conn.fd);\n-}\n-\n-\n-void LTTNG_HTTP_SERVER_REQUEST(const FunctionCallbackInfo<Value>& args) {\n-  node_lttng_http_server_request_t req;\n-\n-  if (!NODE_HTTP_SERVER_REQUEST_ENABLED())\n-    return;\n-\n-  if (!args[0]->IsObject())\n-    return;\n-\n-  Environment* env = Environment::GetCurrent(args);\n-  Local<Object> arg0 = args[0].As<Object>();\n-  Local<Object> headers;\n-\n-  memset(&req, 0, sizeof(req));\n-  req._un.version = 1;\n-  SLURP_STRING(arg0, url, &req.url);\n-  SLURP_STRING(arg0, method, &req.method);\n-  SLURP_OBJECT(arg0, headers, &headers);\n-\n-  if (!(headers)->IsObject()) {\n-    return env->ThrowError(\n-      \"expected object for request to contain string member headers\");\n-  }\n-\n-  Local<Value> strfwdfor = headers->Get(env->x_forwarded_string());\n-  node::Utf8Value fwdfor(env->isolate(), strfwdfor);\n-  req.forwarded_for = *fwdfor;\n-\n-  if (!strfwdfor->IsString() || req.forwarded_for == nullptr)\n-    req.forwarded_for = \"\";\n-\n-  SLURP_CONNECTION(args[1], conn);\n-  NODE_HTTP_SERVER_REQUEST(&req, &conn, conn.remote, conn.port, req.method, \\\n-                           req.url, conn.fd);\n-}\n-\n-\n-void LTTNG_HTTP_SERVER_RESPONSE(const FunctionCallbackInfo<Value>& args) {\n-  if (!NODE_HTTP_SERVER_RESPONSE_ENABLED())\n-    return;\n-  Environment* env = Environment::GetCurrent(args);\n-  SLURP_CONNECTION(args[0], conn);\n-  NODE_HTTP_SERVER_RESPONSE(&conn, conn.remote, conn.port, conn.fd);\n-}\n-\n-\n-void LTTNG_HTTP_CLIENT_REQUEST(const FunctionCallbackInfo<Value>& args) {\n-  node_lttng_http_client_request_t req;\n-  char* header;\n-\n-  if (!NODE_HTTP_CLIENT_REQUEST_ENABLED())\n-    return;\n-\n-  Environment* env = Environment::GetCurrent(args);\n-\n-  /*\n-   * For the method and URL, we're going to dig them out of the header.  This\n-   * is not as efficient as it could be, but we would rather not force the\n-   * caller here to retain their method and URL until the time at which\n-   * LTTNG_HTTP_CLIENT_REQUEST can be called.\n-   */\n-  Local<Object> arg0 = args[0].As<Object>();\n-  SLURP_STRING(arg0, _header, &header);\n-\n-  req.method = header;\n-\n-  while (*header != '\\0' && *header != ' ')\n-    header++;\n-\n-  if (*header != '\\0')\n-    *header++ = '\\0';\n-\n-  req.url = header;\n-\n-  while (*header != '\\0' && *header != ' ')\n-    header++;\n-\n-  *header = '\\0';\n-\n-  SLURP_CONNECTION_HTTP_CLIENT(args[1], conn);\n-  NODE_HTTP_CLIENT_REQUEST(&req, &conn, conn.remote, conn.port, req.method, \\\n-                           req.url, conn.fd);\n-}\n-\n-\n-void LTTNG_HTTP_CLIENT_RESPONSE(const FunctionCallbackInfo<Value>& args) {\n-  if (!NODE_HTTP_CLIENT_RESPONSE_ENABLED())\n-    return;\n-  Environment* env = Environment::GetCurrent(args);\n-  SLURP_CONNECTION_HTTP_CLIENT_RESPONSE(args[0], args[1], conn);\n-  NODE_HTTP_CLIENT_RESPONSE(&conn, conn.remote, conn.port, conn.fd);\n-}\n-\n-\n-void lttng_gc_start(Isolate* isolate, GCType type, GCCallbackFlags flags) {\n-  NODE_GC_START(type, flags, isolate);\n-}\n-\n-\n-void lttng_gc_done(Isolate* isolate, GCType type, GCCallbackFlags flags) {\n-  NODE_GC_DONE(type, flags, isolate);\n-}\n-\n-void InitLTTNG(Environment* env, Local<Object> target) {\n-  HandleScope scope(env->isolate());\n-\n-  static struct {\n-    const char *name;\n-    void (*func)(const FunctionCallbackInfo<Value>&);\n-  } tab[] = {\n-#define NODE_PROBE(name) #name, name\n-    { NODE_PROBE(LTTNG_NET_SERVER_CONNECTION) },\n-    { NODE_PROBE(LTTNG_NET_STREAM_END) },\n-    { NODE_PROBE(LTTNG_HTTP_SERVER_REQUEST) },\n-    { NODE_PROBE(LTTNG_HTTP_SERVER_RESPONSE) },\n-    { NODE_PROBE(LTTNG_HTTP_CLIENT_REQUEST) },\n-    { NODE_PROBE(LTTNG_HTTP_CLIENT_RESPONSE) }\n-#undef NODE_PROBE\n-  };\n-\n-  for (size_t i = 0; i < arraysize(tab); i++) {\n-    Local<String> key = OneByteString(env->isolate(), tab[i].name);\n-    Local<Value> val = env->NewFunctionTemplate(tab[i].func)->GetFunction();\n-    target->Set(key, val);\n-  }\n-\n-#if defined HAVE_LTTNG\n-  env->isolate()->AddGCPrologueCallback(lttng_gc_start);\n-  env->isolate()->AddGCEpilogueCallback(lttng_gc_done);\n-#endif\n-}\n-\n-}  // namespace node"
        },
        {
            "sha": "edd802eb6e49f7a740c079c5b38598287b80c2cd",
            "filename": "src/node_lttng.h",
            "status": "removed",
            "additions": 0,
            "deletions": 44,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnode_lttng.h",
            "raw_url": "https://github.com/nodejs/node/raw/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnode_lttng.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_lttng.h?ref=38eb0fa7372052433520ea2e1575072892bc5eec",
            "patch": "@@ -1,44 +0,0 @@\n-#ifndef SRC_NODE_LTTNG_H_\n-#define SRC_NODE_LTTNG_H_\n-\n-#if defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#include \"node.h\"\n-#include \"v8.h\"\n-#include \"env.h\"\n-\n-extern \"C\" {\n-typedef struct {\n-  int32_t fd;\n-  int32_t port;\n-  const char* remote;\n-  int32_t buffered;\n-} node_lttng_connection_t;\n-\n-typedef struct {\n-  const char* url;\n-  const char* method;\n-} node_lttng_http_client_request_t;\n-\n-typedef struct {\n-  union {\n-    uint32_t version;\n-    uintptr_t unused;  /* for compat. with old 64-bit struct */\n-  } _un;\n-  const char* url;\n-  const char* method;\n-  const char* forwarded_for;\n-  const char* _pad[8];\n-} node_lttng_http_server_request_t;\n-\n-}  // extern \"C\"\n-\n-namespace node {\n-\n-void InitLTTNG(Environment* env, v8::Local<v8::Object> target);\n-\n-}  // namespace node\n-\n-#endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#endif  // SRC_NODE_LTTNG_H_"
        },
        {
            "sha": "fc4576b47806d352b7b21c4cc60cad17814c72e1",
            "filename": "src/node_lttng_provider.h",
            "status": "removed",
            "additions": 0,
            "deletions": 106,
            "changes": 106,
            "blob_url": "https://github.com/nodejs/node/blob/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnode_lttng_provider.h",
            "raw_url": "https://github.com/nodejs/node/raw/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnode_lttng_provider.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_lttng_provider.h?ref=38eb0fa7372052433520ea2e1575072892bc5eec",
            "patch": "@@ -1,106 +0,0 @@\n-#ifndef SRC_NODE_LTTNG_PROVIDER_H_\n-#define SRC_NODE_LTTNG_PROVIDER_H_\n-\n-#if defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#define TRACEPOINT_CREATE_PROBES\n-#define TRACEPOINT_DEFINE\n-#include \"node_lttng_tp.h\"\n-\n-namespace node {\n-\n-#define FOR_ALL_GC_TYPES(APPLY) \\\n-  APPLY(kGCTypeScavenge) \\\n-  APPLY(kGCTypeMarkSweepCompact) \\\n-  APPLY(kGCTypeAll)\n-\n-#define FOR_ALL_GC_CALLBACK_FLAGS(APPLY) \\\n-  APPLY(kNoGCCallbackFlags) \\\n-  APPLY(kGCCallbackFlagConstructRetainedObjectInfos) \\\n-  APPLY(kGCCallbackFlagForced) \\\n-  APPLY(kGCCallbackFlagSynchronousPhantomCallbackProcessing)\n-\n-void NODE_HTTP_SERVER_REQUEST(node_lttng_http_server_request_t* req,\n-                              node_lttng_connection_t* conn,\n-                              const char *remote, int port,\n-                              const char *method, const char *url,\n-                              int fd) {\n-  tracepoint(node, http_server_request, req->url, req->method, \\\n-             req->forwarded_for);\n-}\n-\n-void NODE_HTTP_SERVER_RESPONSE(node_lttng_connection_t* conn,\n-                              const char *remote, int port, int fd) {\n-  tracepoint(node, http_server_response, port, conn->remote, fd);\n-}\n-\n-void NODE_HTTP_CLIENT_REQUEST(node_lttng_http_client_request_t* req,\n-                              node_lttng_connection_t* conn,\n-                              const char *remote, int port,\n-                              const char *method, const char *url,\n-                              int fd) {\n-  tracepoint(node, http_client_request, req->url, req->method);\n-}\n-\n-void NODE_HTTP_CLIENT_RESPONSE(node_lttng_connection_t* conn,\n-                               const char *remote, int port, int fd) {\n-  tracepoint(node, http_client_response, port, conn->remote, fd);\n-}\n-\n-void NODE_NET_SERVER_CONNECTION(node_lttng_connection_t* conn,\n-                                const char *remote, int port, int fd) {\n-  tracepoint(node, net_server_connection, conn->remote, port, fd, \\\n-             conn->buffered);\n-}\n-\n-void NODE_NET_STREAM_END(node_lttng_connection_t* conn,\n-                        const char *remote, int port, int fd) {\n-  tracepoint(node, net_stream_end, conn->remote, port, fd);\n-}\n-\n-void NODE_GC_START(v8::GCType type,\n-                   v8::GCCallbackFlags flags,\n-                   v8::Isolate* isolate) {\n-  const char* typeStr = \"Unknown GC Type\";\n-  const char* flagsStr = \"Unknown GC Flag\";\n-\n-#define BUILD_IF(f) if (type == v8::GCType::f) { typeStr = #f; }\n-  FOR_ALL_GC_TYPES(BUILD_IF);\n-#undef BUILD_IF\n-\n-#define BUILD_IF(f) if (flags == v8::GCCallbackFlags::f) { flagsStr = #f; }\n-  FOR_ALL_GC_CALLBACK_FLAGS(BUILD_IF);\n-#undef BUILD_IF\n-\n-  tracepoint(node, gc_start, typeStr, flagsStr);\n-}\n-\n-void NODE_GC_DONE(v8::GCType type,\n-                  v8::GCCallbackFlags flags,\n-                  v8::Isolate* isolate) {\n-  const char* typeStr = \"Unknown GC Type\";\n-  const char* flagsStr = \"Unknown GC Flag\";\n-\n-#define BUILD_IF(f) if (type == v8::GCType::f) { typeStr = #f; }\n-  FOR_ALL_GC_TYPES(BUILD_IF);\n-#undef BUILD_IF\n-\n-#define BUILD_IF(f) if (flags == v8::GCCallbackFlags::f) { flagsStr = #f; }\n-  FOR_ALL_GC_CALLBACK_FLAGS(BUILD_IF);\n-#undef BUILD_IF\n-\n-  tracepoint(node, gc_done, typeStr, flagsStr);\n-}\n-\n-bool NODE_HTTP_SERVER_REQUEST_ENABLED() { return true; }\n-bool NODE_HTTP_SERVER_RESPONSE_ENABLED() { return true; }\n-bool NODE_HTTP_CLIENT_REQUEST_ENABLED() { return true; }\n-bool NODE_HTTP_CLIENT_RESPONSE_ENABLED() { return true; }\n-bool NODE_NET_SERVER_CONNECTION_ENABLED() { return true; }\n-bool NODE_NET_STREAM_END_ENABLED() { return true; }\n-\n-}  // namespace node\n-\n-#endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#endif  // SRC_NODE_LTTNG_PROVIDER_H_"
        },
        {
            "sha": "b529bfad5e4b585afb14364008c31a6e62309f85",
            "filename": "src/node_lttng_tp.h",
            "status": "removed",
            "additions": 0,
            "deletions": 116,
            "changes": 116,
            "blob_url": "https://github.com/nodejs/node/blob/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnode_lttng_tp.h",
            "raw_url": "https://github.com/nodejs/node/raw/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnode_lttng_tp.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_lttng_tp.h?ref=38eb0fa7372052433520ea2e1575072892bc5eec",
            "patch": "@@ -1,116 +0,0 @@\n-#ifndef SRC_NODE_LTTNG_TP_H_\n-#define SRC_NODE_LTTNG_TP_H_\n-\n-#if defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#undef TRACEPOINT_PROVIDER\n-#define TRACEPOINT_PROVIDER node\n-\n-#undef TRACEPOINT_INCLUDE\n-#define TRACEPOINT_INCLUDE \"./node_lttng_tp.h\"\n-\n-#if !defined(__NODE_LTTNG_TP_H) || defined(TRACEPOINT_HEADER_MULTI_READ)\n-#define __NODE_LTTNG_TP_H\n-\n-#include <lttng/tracepoint.h>\n-\n-TRACEPOINT_EVENT(\n-  node,\n-  http_server_request,\n-  TP_ARGS(\n-    const char*, url,\n-    const char*, method,\n-    const char*, forwardedFor),\n-  TP_FIELDS(\n-    ctf_string(url, url)\n-    ctf_string(method, method)\n-    ctf_string(forwardedFor, forwardedFor))\n-\n-TRACEPOINT_EVENT(\n-  node,\n-  http_server_response,\n-  TP_ARGS(\n-    int, port,\n-    const char*, remote,\n-    int, fd),\n-  TP_FIELDS(\n-    ctf_integer(int, port, port)\n-    ctf_string(remote, remote)\n-    ctf_integer(int, fd, fd))\n-\n-TRACEPOINT_EVENT(\n-  node,\n-  http_client_request,\n-  TP_ARGS(\n-    const char*, url,\n-    const char*, method),\n-  TP_FIELDS(\n-    ctf_string(url, url)\n-    ctf_string(method, method))\n-\n-TRACEPOINT_EVENT(\n-  node,\n-  http_client_response,\n-  TP_ARGS(\n-    int, port,\n-    const char*, remote,\n-    int, fd),\n-  TP_FIELDS(\n-    ctf_integer(int, port, port)\n-    ctf_string(remote, remote)\n-    ctf_integer(int, fd, fd))\n-\n-TRACEPOINT_EVENT(\n-  node,\n-  net_server_connection,\n-  TP_ARGS(\n-    const char*, remote,\n-    int, port,\n-    int, fd,\n-    int, buffered),\n-  TP_FIELDS(\n-    ctf_string(remote, remote)\n-    ctf_integer(int, port, port)\n-    ctf_integer(int, fd, fd)\n-    ctf_integer(int, buffered, buffered))\n-\n-TRACEPOINT_EVENT(\n-  node,\n-  net_stream_end,\n-  TP_ARGS(\n-    const char*, remote,\n-    int, port,\n-    int, fd),\n-  TP_FIELDS(\n-    ctf_string(remote, remote)\n-    ctf_integer(int, port, port)\n-    ctf_integer(int, fd, fd))\n-\n-TRACEPOINT_EVENT(\n-  node,\n-  gc_start,\n-  TP_ARGS(\n-    const char*, gctype,\n-    const char*, gcflags),\n-  TP_FIELDS(\n-    ctf_string(gctype, gctype)\n-    ctf_string(gcflags, gcflags))\n-)\n-\n-TRACEPOINT_EVENT(\n-  node,\n-  gc_done,\n-  TP_ARGS(\n-    const char*, gctype,\n-    const char*, gcflags),\n-  TP_FIELDS(\n-    ctf_string(gctype, gctype)\n-    ctf_string(gcflags, gcflags))\n-\n-#endif /* __NODE_LTTNG_TP_H */\n-\n-#include <lttng/tracepoint-event.h>\n-\n-#endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#endif  // SRC_NODE_LTTNG_TP_H_"
        },
        {
            "sha": "cefd80507e102679186842c89c6b25f5b5f9f095",
            "filename": "src/nolttng_macros.py",
            "status": "removed",
            "additions": 0,
            "deletions": 9,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnolttng_macros.py",
            "raw_url": "https://github.com/nodejs/node/raw/38eb0fa7372052433520ea2e1575072892bc5eec/src%2Fnolttng_macros.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnolttng_macros.py?ref=38eb0fa7372052433520ea2e1575072892bc5eec",
            "patch": "@@ -1,9 +0,0 @@\n-# This file is used by tools/js2c.py to preprocess out the LTTNG symbols in\n-# builds that don't support LTTNG. This is not used in builds that support\n-# LTTNG.\n-macro LTTNG_HTTP_CLIENT_REQUEST(x) = ;\n-macro LTTNG_HTTP_CLIENT_RESPONSE(x) = ;\n-macro LTTNG_HTTP_SERVER_REQUEST(x) = ;\n-macro LTTNG_HTTP_SERVER_RESPONSE(x) = ;\n-macro LTTNG_NET_SERVER_CONNECTION(x) = ;\n-macro LTTNG_NET_STREAM_END(x) = ;"
        },
        {
            "sha": "ff1dc0ce261bd022b97ebe9d3cc4035015bdeed2",
            "filename": "test/common/index.js",
            "status": "modified",
            "additions": 0,
            "deletions": 9,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/test%2Fcommon%2Findex.js",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/test%2Fcommon%2Findex.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Findex.js?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -334,15 +334,6 @@ if (global.COUNTER_NET_SERVER_CONNECTION) {\n   knownGlobals.push(COUNTER_HTTP_CLIENT_RESPONSE);\n }\n \n-if (global.LTTNG_HTTP_SERVER_RESPONSE) {\n-  knownGlobals.push(LTTNG_HTTP_SERVER_RESPONSE);\n-  knownGlobals.push(LTTNG_HTTP_SERVER_REQUEST);\n-  knownGlobals.push(LTTNG_HTTP_CLIENT_RESPONSE);\n-  knownGlobals.push(LTTNG_HTTP_CLIENT_REQUEST);\n-  knownGlobals.push(LTTNG_NET_STREAM_END);\n-  knownGlobals.push(LTTNG_NET_SERVER_CONNECTION);\n-}\n-\n if (global.ArrayBuffer) {\n   knownGlobals.push(ArrayBuffer);\n   knownGlobals.push(Int8Array);"
        },
        {
            "sha": "52cbd7636372114289ab8d6f0c19f4971b28847d",
            "filename": "test/common/index.mjs",
            "status": "modified",
            "additions": 0,
            "deletions": 9,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/test%2Fcommon%2Findex.mjs",
            "raw_url": "https://github.com/nodejs/node/raw/30fd3d25dfa0cb759da77e9725e6cec4af1415b9/test%2Fcommon%2Findex.mjs",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Findex.mjs?ref=30fd3d25dfa0cb759da77e9725e6cec4af1415b9",
            "patch": "@@ -50,15 +50,6 @@ export function leakedGlobals() {\n     knownGlobals.push(COUNTER_HTTP_CLIENT_RESPONSE);\n   }\n \n-  if (global.LTTNG_HTTP_SERVER_RESPONSE) {\n-    knownGlobals.push(LTTNG_HTTP_SERVER_RESPONSE);\n-    knownGlobals.push(LTTNG_HTTP_SERVER_REQUEST);\n-    knownGlobals.push(LTTNG_HTTP_CLIENT_RESPONSE);\n-    knownGlobals.push(LTTNG_HTTP_CLIENT_REQUEST);\n-    knownGlobals.push(LTTNG_NET_STREAM_END);\n-    knownGlobals.push(LTTNG_NET_SERVER_CONNECTION);\n-  }\n-\n   if (global.ArrayBuffer) {\n     knownGlobals.push(ArrayBuffer);\n     knownGlobals.push(Int8Array);"
        }
    ],
    "stats": {
        "total": 614,
        "additions": 1,
        "deletions": 613
    }
}