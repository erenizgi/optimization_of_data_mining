{
    "author": "unknown",
    "message": "openssl: fix keypress requirement in apps on win32\n\nReapply b910613792dac946b295855963869933a9089044 .\n\nBackport-PR-URL: https://github.com/nodejs/node/pull/19638\nFixes: https://github.com/iojs/io.js/issues/589\nPR-URL: https://github.com/iojs/io.js/pull/1389\nReviewed-By: Fedor Indutny <fedor@indutny.com>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>",
    "sha": "5aa53cbf404f2886a95f44c1204baf2885b1ef11",
    "files": [
        {
            "sha": "fbf5899e4b5ddb1ddfe795f72b016989fcd9e0e9",
            "filename": "deps/openssl/openssl/apps/s_client.c",
            "status": "modified",
            "additions": 13,
            "deletions": 7,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/5aa53cbf404f2886a95f44c1204baf2885b1ef11/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_client.c",
            "raw_url": "https://github.com/nodejs/node/raw/5aa53cbf404f2886a95f44c1204baf2885b1ef11/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_client.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fopenssl%2Fopenssl%2Fapps%2Fs_client.c?ref=5aa53cbf404f2886a95f44c1204baf2885b1ef11",
            "patch": "@@ -180,6 +180,13 @@ typedef unsigned int u_int;\n # include <fcntl.h>\n #endif\n \n+/* Use Windows API with STD_INPUT_HANDLE when checking for input?\n+   Don't look at OPENSSL_SYS_MSDOS for this, since it is always defined if\n+   OPENSSL_SYS_WINDOWS is defined */\n+#if defined(OPENSSL_SYS_WINDOWS) && !defined(OPENSSL_SYS_WINCE) && defined(STD_INPUT_HANDLE)\n+#define OPENSSL_USE_STD_INPUT_HANDLE\n+#endif\n+\n #undef PROG\n #define PROG    s_client_main\n \n@@ -1793,17 +1800,16 @@ int MAIN(int argc, char **argv)\n                     tv.tv_usec = 0;\n                     i = select(width, (void *)&readfds, (void *)&writefds,\n                                NULL, &tv);\n-# if defined(OPENSSL_SYS_WINCE) || defined(OPENSSL_SYS_MSDOS)\n-                    if (!i && (!_kbhit() || !read_tty))\n-                        continue;\n-# else\n+#if defined(OPENSSL_USE_STD_INPUT_HANDLE)\n                     if (!i && (!((_kbhit())\n                                  || (WAIT_OBJECT_0 ==\n                                      WaitForSingleObject(GetStdHandle\n                                                          (STD_INPUT_HANDLE),\n                                                          0)))\n                                || !read_tty))\n                         continue;\n+#else\n+                    if(!i && (!_kbhit() || !read_tty) ) continue;\n # endif\n                 } else\n                     i = select(width, (void *)&readfds, (void *)&writefds,\n@@ -2005,12 +2011,12 @@ int MAIN(int argc, char **argv)\n             }\n         }\n #if defined(OPENSSL_SYS_WINDOWS) || defined(OPENSSL_SYS_MSDOS)\n-# if defined(OPENSSL_SYS_WINCE) || defined(OPENSSL_SYS_MSDOS)\n-        else if (_kbhit())\n-# else\n+#if defined(OPENSSL_USE_STD_INPUT_HANDLE)\n         else if ((_kbhit())\n                  || (WAIT_OBJECT_0 ==\n                      WaitForSingleObject(GetStdHandle(STD_INPUT_HANDLE), 0)))\n+#else\n+        else if (_kbhit())\n # endif\n #elif defined (OPENSSL_SYS_NETWARE)\n         else if (_kbhit())"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 13,
        "deletions": 7
    }
}