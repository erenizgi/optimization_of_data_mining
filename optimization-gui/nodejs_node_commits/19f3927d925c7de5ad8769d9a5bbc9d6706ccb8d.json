{
    "author": "tniessen",
    "message": "crypto: deprecate Decipher.finaltol\n\nPR-URL: https://github.com/nodejs/node/pull/19353\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Сковорода Никита Андреевич <chalkerx@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d",
    "files": [
        {
            "sha": "7e520412c0db728c606d65927539d95f8a7f6d76",
            "filename": "doc/api/deprecations.md",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d/doc%2Fapi%2Fdeprecations.md",
            "raw_url": "https://github.com/nodejs/node/raw/19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d/doc%2Fapi%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fdeprecations.md?ref=19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d",
            "patch": "@@ -950,6 +950,15 @@ deprecated if the assigned value is not a string, boolean, or number. In the\n future, such assignment may result in a thrown error. Please convert the\n property to a string before assigning it to `process.env`.\n \n+<a id=\"DEP0105\"></a>\n+### DEP0105: decipher.finaltol\n+\n+Type: Runtime\n+\n+`decipher.finaltol()` has never been documented and is currently an alias for\n+[`decipher.final()`][]. In the future, this API will likely be removed, and it\n+is recommended to use [`decipher.final()`][] instead.\n+\n [`--pending-deprecation`]: cli.html#cli_pending_deprecation\n [`Buffer.allocUnsafeSlow(size)`]: buffer.html#buffer_class_method_buffer_allocunsafeslow_size\n [`Buffer.from(array)`]: buffer.html#buffer_class_method_buffer_from_array\n@@ -971,6 +980,7 @@ property to a string before assigning it to `process.env`.\n [`crypto.DEFAULT_ENCODING`]: crypto.html#crypto_crypto_default_encoding\n [`crypto.fips`]: crypto.html#crypto_crypto_fips\n [`crypto.pbkdf2()`]: crypto.html#crypto_crypto_pbkdf2_password_salt_iterations_keylen_digest_callback\n+[`decipher.final()`]: crypto.html#crypto_decipher_final_outputencoding\n [`decipher.setAuthTag()`]: crypto.html#crypto_decipher_setauthtag_buffer\n [`domain`]: domain.html\n [`ecdh.setPublicKey()`]: crypto.html#crypto_ecdh_setpublickey_publickey_encoding"
        },
        {
            "sha": "73118ffebb025649170b69b2f62dff32d87492de",
            "filename": "lib/internal/crypto/cipher.js",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d/lib%2Finternal%2Fcrypto%2Fcipher.js",
            "raw_url": "https://github.com/nodejs/node/raw/19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d/lib%2Finternal%2Fcrypto%2Fcipher.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fcrypto%2Fcipher.js?ref=19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d",
            "patch": "@@ -30,7 +30,7 @@ const LazyTransform = require('internal/streams/lazy_transform');\n const { StringDecoder } = require('string_decoder');\n \n const { inherits } = require('util');\n-const { normalizeEncoding } = require('internal/util');\n+const { deprecate, normalizeEncoding } = require('internal/util');\n \n function rsaPublic(method, defaultPadding) {\n   return function(options, buffer) {\n@@ -217,6 +217,10 @@ Cipheriv.prototype.setAuthTag = Cipher.prototype.setAuthTag;\n Cipheriv.prototype.setAAD = Cipher.prototype.setAAD;\n \n \n+const finaltol = deprecate(Cipher.prototype.final,\n+                           'crypto.Decipher.finaltol is deprecated. Use ' +\n+                           'crypto.Decipher.final instead.', 'DEP0105');\n+\n function Decipher(cipher, password, options) {\n   if (!(this instanceof Decipher))\n     return new Decipher(cipher, password, options);\n@@ -245,7 +249,7 @@ Decipher.prototype._transform = Cipher.prototype._transform;\n Decipher.prototype._flush = Cipher.prototype._flush;\n Decipher.prototype.update = Cipher.prototype.update;\n Decipher.prototype.final = Cipher.prototype.final;\n-Decipher.prototype.finaltol = Cipher.prototype.final;\n+Decipher.prototype.finaltol = finaltol;\n Decipher.prototype.setAutoPadding = Cipher.prototype.setAutoPadding;\n Decipher.prototype.getAuthTag = Cipher.prototype.getAuthTag;\n Decipher.prototype.setAuthTag = Cipher.prototype.setAuthTag;\n@@ -288,7 +292,7 @@ Decipheriv.prototype._transform = Cipher.prototype._transform;\n Decipheriv.prototype._flush = Cipher.prototype._flush;\n Decipheriv.prototype.update = Cipher.prototype.update;\n Decipheriv.prototype.final = Cipher.prototype.final;\n-Decipheriv.prototype.finaltol = Cipher.prototype.final;\n+Decipheriv.prototype.finaltol = finaltol;\n Decipheriv.prototype.setAutoPadding = Cipher.prototype.setAutoPadding;\n Decipheriv.prototype.getAuthTag = Cipher.prototype.getAuthTag;\n Decipheriv.prototype.setAuthTag = Cipher.prototype.setAuthTag;"
        },
        {
            "sha": "d8f2be43693121910c9a2f309a3e43ee4cb06311",
            "filename": "test/parallel/test-crypto-deprecated.js",
            "status": "modified",
            "additions": 15,
            "deletions": 1,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d/test%2Fparallel%2Ftest-crypto-deprecated.js",
            "raw_url": "https://github.com/nodejs/node/raw/19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d/test%2Fparallel%2Ftest-crypto-deprecated.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-deprecated.js?ref=19f3927d925c7de5ad8769d9a5bbc9d6706ccb8d",
            "patch": "@@ -9,7 +9,9 @@ const tls = require('tls');\n \n common.expectWarning('DeprecationWarning', [\n   'crypto.Credentials is deprecated. Use tls.SecureContext instead.',\n-  'crypto.createCredentials is deprecated. Use tls.createSecureContext instead.'\n+  'crypto.createCredentials is deprecated. Use tls.createSecureContext ' +\n+  'instead.',\n+  'crypto.Decipher.finaltol is deprecated. Use crypto.Decipher.final instead.'\n ]);\n \n // Accessing the deprecated function is enough to trigger the warning event.\n@@ -18,3 +20,15 @@ common.expectWarning('DeprecationWarning', [\n // mapped to the correct non-deprecated function.\n assert.strictEqual(crypto.Credentials, tls.SecureContext);\n assert.strictEqual(crypto.createCredentials, tls.createSecureContext);\n+\n+{\n+  const cipher = crypto.createCipheriv('aes-128-cbc', '0000000000000000',\n+                                       '0000000000000000');\n+  const ciphertext = cipher.update('Node.js', 'utf8', 'hex') +\n+                     cipher.final('hex');\n+  const decipher = crypto.createDecipheriv('aes-128-cbc', '0000000000000000',\n+                                           '0000000000000000');\n+  const plaintext = decipher.update(ciphertext, 'hex', 'utf8') +\n+                    decipher.finaltol('utf8');\n+  assert.strictEqual(plaintext, 'Node.js');\n+}"
        }
    ],
    "stats": {
        "total": 36,
        "additions": 32,
        "deletions": 4
    }
}