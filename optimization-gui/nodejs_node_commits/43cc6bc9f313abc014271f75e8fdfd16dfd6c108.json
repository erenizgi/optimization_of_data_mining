{
    "author": "tniessen",
    "message": "crypto: prevent Sign::SignFinal from crashing\n\nThe validation logic could be tricked into assuming an option was\nvalid using malicious getters, leading to an invalid value being\npassed to the C++ layer, thus crashing the process.\n\nPR-URL: https://github.com/nodejs/node/pull/21815\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Ujjwal Sharma <usharma1998@gmail.com>",
    "sha": "43cc6bc9f313abc014271f75e8fdfd16dfd6c108",
    "files": [
        {
            "sha": "8aff735473540482f6372bd515839648eb7f6218",
            "filename": "lib/internal/crypto/sig.js",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/43cc6bc9f313abc014271f75e8fdfd16dfd6c108/lib%2Finternal%2Fcrypto%2Fsig.js",
            "raw_url": "https://github.com/nodejs/node/raw/43cc6bc9f313abc014271f75e8fdfd16dfd6c108/lib%2Finternal%2Fcrypto%2Fsig.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fcrypto%2Fsig.js?ref=43cc6bc9f313abc014271f75e8fdfd16dfd6c108",
            "patch": "@@ -57,10 +57,11 @@ function getSaltLength(options) {\n \n function getIntOption(name, defaultValue, options) {\n   if (options.hasOwnProperty(name)) {\n-    if (options[name] === options[name] >> 0) {\n-      return options[name];\n+    const value = options[name];\n+    if (value === value >> 0) {\n+      return value;\n     } else {\n-      throw new ERR_INVALID_OPT_VALUE(name, options[name]);\n+      throw new ERR_INVALID_OPT_VALUE(name, value);\n     }\n   }\n   return defaultValue;"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
    }
}