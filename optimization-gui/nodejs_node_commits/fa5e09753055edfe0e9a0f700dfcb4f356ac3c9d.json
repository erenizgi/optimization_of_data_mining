{
    "author": "joyeecheung",
    "message": "process: move DEP0062 (node --debug) to end-of-life\n\nThis has already been practically end-of-life since `node --debug`\nalone would exit the process. This patch drops support of\n`node --inspect --debug-brk` as well.\n\n`node --inspect --debug-brk` has been deprecated since v8,\nit has been maintained so that vendors can target Node.js\nv6 and above without detecting versions.\nThe support of `--inspect`, which starts from v6, will reach\nend-of-life in April 2019, it should be safe to drop the support\nof `--inspect --debug-brk` altogether in v12.\n\nAlso removes `process._deprecatedDebugBrk`\n\nPR-URL: https://github.com/nodejs/node/pull/25828\nRefs: https://github.com/nodejs/node/pull/12949\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Eugene Ostroukhov <eostroukhov@google.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>",
    "sha": "fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d",
    "files": [
        {
            "sha": "169b5a513154655220703e68cef58caf0705e695",
            "filename": "doc/api/deprecations.md",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/doc%2Fapi%2Fdeprecations.md",
            "raw_url": "https://github.com/nodejs/node/raw/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/doc%2Fapi%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fdeprecations.md?ref=fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d",
            "patch": "@@ -1279,9 +1279,12 @@ changes:\n   - version: v8.0.0\n     pr-url: https://github.com/nodejs/node/pull/10970\n     description: Runtime deprecation.\n+  - version: REPLACEME\n+    pr-url: https://github.com/nodejs/node/pull/25828\n+    description: End-of-Life.\n -->\n \n-Type: Runtime\n+Type: End-Of-Life\n \n `--debug` activates the legacy V8 debugger interface, which was removed as\n of V8 5.8. It is replaced by Inspector which is activated with `--inspect`"
        },
        {
            "sha": "915d07d83dd3c950f6b42c19d9ccf310e4cafca8",
            "filename": "lib/internal/bootstrap/node.js",
            "status": "modified",
            "additions": 0,
            "deletions": 8,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "raw_url": "https://github.com/nodejs/node/raw/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fnode.js?ref=fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d",
            "patch": "@@ -203,14 +203,6 @@ Object.defineProperty(process, 'argv0', {\n });\n process.argv[0] = process.execPath;\n \n-// Handle `--debug*` deprecation and invalidation.\n-if (process._deprecatedDebugBrk) {\n-  process.emitWarning(\n-    '`node --inspect --debug-brk` is deprecated. ' +\n-    'Please use `node --inspect-brk` instead.',\n-    'DeprecationWarning', 'DEP0062', undefined, true);\n-}\n-\n const { deprecate } = NativeModule.require('internal/util');\n {\n   // Install legacy getters on the `util` binding for typechecking."
        },
        {
            "sha": "86a986521c54b2390942da16103f3501225bdfd7",
            "filename": "src/node_options.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/src%2Fnode_options.cc",
            "raw_url": "https://github.com/nodejs/node/raw/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/src%2Fnode_options.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_options.cc?ref=fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d",
            "patch": "@@ -36,6 +36,11 @@ void DebugOptions::CheckOptions(std::vector<std::string>* errors) {\n                       \"are invalid. Please use `node --inspect` or \"\n                       \"`node --inspect-brk` instead.\");\n   }\n+\n+  if (deprecated_debug && inspector_enabled && break_first_line) {\n+    errors->push_back(\"[DEP0062]: `node --inspect --debug-brk` is deprecated. \"\n+                      \"Please use `node --inspect-brk` instead.\");\n+  }\n }\n \n void PerProcessOptions::CheckOptions(std::vector<std::string>* errors) {"
        },
        {
            "sha": "e68e1cdfd734cabdcfc1f5cd9d28d586efc0454f",
            "filename": "src/node_options.h",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/src%2Fnode_options.h",
            "raw_url": "https://github.com/nodejs/node/raw/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/src%2Fnode_options.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_options.h?ref=fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d",
            "patch": "@@ -75,12 +75,6 @@ class DebugOptions : public Options {\n \n   HostPort host_port{\"127.0.0.1\", kDefaultInspectorPort};\n \n-  bool deprecated_invocation() const {\n-    return deprecated_debug &&\n-      inspector_enabled &&\n-      break_first_line;\n-  }\n-\n   bool wait_for_connect() const {\n     return break_first_line || break_node_first_line;\n   }"
        },
        {
            "sha": "f83f553c997b661a6e41e2e9211133e44932d419",
            "filename": "src/node_process_object.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/src%2Fnode_process_object.cc",
            "raw_url": "https://github.com/nodejs/node/raw/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/src%2Fnode_process_object.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_process_object.cc?ref=fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d",
            "patch": "@@ -259,12 +259,6 @@ MaybeLocal<Object> CreateProcessObject(\n                                 \"_breakNodeFirstLine\", True(env->isolate()));\n   }\n \n-  // --inspect --debug-brk\n-  if (env->options()->debug_options().deprecated_invocation()) {\n-    READONLY_DONT_ENUM_PROPERTY(process,\n-                                \"_deprecatedDebugBrk\", True(env->isolate()));\n-  }\n-\n   // --security-revert flags\n #define V(code, _, __)                                                        \\\n   do {                                                                        \\"
        },
        {
            "sha": "7a13572a06a2a50ad3acd9430ceda072d2d55706",
            "filename": "test/sequential/test-debugger-debug-brk.js",
            "status": "modified",
            "additions": 7,
            "deletions": 20,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/test%2Fsequential%2Ftest-debugger-debug-brk.js",
            "raw_url": "https://github.com/nodejs/node/raw/fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d/test%2Fsequential%2Ftest-debugger-debug-brk.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-debugger-debug-brk.js?ref=fa5e09753055edfe0e9a0f700dfcb4f356ac3c9d",
            "patch": "@@ -2,32 +2,19 @@\n const common = require('../common');\n common.skipIfInspectorDisabled();\n \n-// This test ensures that the debug-brk flag will spin up a new process and\n-// wait, rather than exit.\n-\n+// This test ensures that the --debug-brk flag will exit the process\n const assert = require('assert');\n const fixtures = require('../common/fixtures');\n-const spawn = require('child_process').spawn;\n+const { spawnSync } = require('child_process');\n \n-// file name here doesn't actually matter since\n-// debugger will connect regardless of file name arg\n+// File name here doesn't actually matter the process will exit on start.\n const script = fixtures.path('empty.js');\n \n function test(arg) {\n-  const child = spawn(process.execPath, ['--inspect', arg, script]);\n-  const argStr = child.spawnargs.join(' ');\n-  const fail = () => assert.fail(true, false, `'${argStr}' should not quit`);\n-  child.on('exit', fail);\n-\n-  // give node time to start up the debugger\n-  setTimeout(function() {\n-    child.removeListener('exit', fail);\n-    child.kill();\n-  }, 2000);\n-\n-  process.on('exit', function() {\n-    assert(child.killed);\n-  });\n+  const child = spawnSync(process.execPath, ['--inspect', arg, script]);\n+  const stderr = child.stderr.toString();\n+  assert(stderr.includes('DEP0062'));\n+  assert.strictEqual(child.status, 9);\n }\n \n test('--debug-brk');"
        }
    ],
    "stats": {
        "total": 57,
        "additions": 16,
        "deletions": 41
    }
}