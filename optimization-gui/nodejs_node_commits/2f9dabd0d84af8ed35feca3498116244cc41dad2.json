{
    "author": "TimothyGu",
    "message": "deps: cherry-pick 9eb96bb from upstream V8\n\nOriginal commit message:\n\n    [api] Avoid needlessly calling descriptor interceptors\n\n    Reland part of https://chromium-review.googlesource.com/c/v8/v8/+/816515.\n\n    Change-Id: I72ad85ffd162fc0563fc25cdf35189e894f9dc82\n    Reviewed-on: https://chromium-review.googlesource.com/1138808\n    Commit-Queue: Timothy Gu <timothygu@chromium.org>\n    Reviewed-by: Jakob Kummerow <jkummerow@chromium.org>\n    Reviewed-by: Benedikt Meurer <bmeurer@chromium.org>\n    Cr-Commit-Position: refs/heads/master@{#54492}\n\nPR-URL: https://github.com/nodejs/node/pull/22390\nFixes: https://github.com/nodejs/node/issues/17480\nFixes: https://github.com/nodejs/node/issues/17481\nRefs: https://github.com/v8/v8/commit/9eb96bb431a52568c4964dee03569eef431a4dfa\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "2f9dabd0d84af8ed35feca3498116244cc41dad2",
    "files": [
        {
            "sha": "326563728f0d3131901d1cbcf4dc74ee83514a7f",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/2f9dabd0d84af8ed35feca3498116244cc41dad2/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/2f9dabd0d84af8ed35feca3498116244cc41dad2/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=2f9dabd0d84af8ed35feca3498116244cc41dad2",
            "patch": "@@ -29,7 +29,7 @@\n \n     # Reset this number to 0 on major V8 upgrades.\n     # Increment by one for each non-official patch applied to deps/v8.\n-    'v8_embedder_string': '-node.16',\n+    'v8_embedder_string': '-node.17',\n \n     # Enable disassembler for `--print-code` v8 options\n     'v8_enable_disassembler': 1,"
        },
        {
            "sha": "5c43a911a9f12abb261203e8e55e1bb1860325f6",
            "filename": "deps/v8/src/objects.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/2f9dabd0d84af8ed35feca3498116244cc41dad2/deps%2Fv8%2Fsrc%2Fobjects.cc",
            "raw_url": "https://github.com/nodejs/node/raw/2f9dabd0d84af8ed35feca3498116244cc41dad2/deps%2Fv8%2Fsrc%2Fobjects.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fobjects.cc?ref=2f9dabd0d84af8ed35feca3498116244cc41dad2",
            "patch": "@@ -7662,13 +7662,17 @@ namespace {\n \n Maybe<bool> GetPropertyDescriptorWithInterceptor(LookupIterator* it,\n                                                  PropertyDescriptor* desc) {\n-  bool has_access = true;\n   if (it->state() == LookupIterator::ACCESS_CHECK) {\n-    has_access = it->HasAccess() || JSObject::AllCanRead(it);\n-    it->Next();\n+    if (it->HasAccess()) {\n+      it->Next();\n+    } else if (!JSObject::AllCanRead(it) ||\n+               it->state() != LookupIterator::INTERCEPTOR) {\n+      it->Restart();\n+      return Just(false);\n+    }\n   }\n \n-  if (has_access && it->state() == LookupIterator::INTERCEPTOR) {\n+  if (it->state() == LookupIterator::INTERCEPTOR) {\n     Isolate* isolate = it->isolate();\n     Handle<InterceptorInfo> interceptor = it->GetInterceptor();\n     if (!interceptor->descriptor()->IsUndefined(isolate)) {\n@@ -7700,9 +7704,9 @@ Maybe<bool> GetPropertyDescriptorWithInterceptor(LookupIterator* it,\n \n         return Just(true);\n       }\n+      it->Next();\n     }\n   }\n-  it->Restart();\n   return Just(false);\n }\n }  // namespace"
        },
        {
            "sha": "f1dba643fc08f2a9819c839dfe48fc9e0f64b2d0",
            "filename": "deps/v8/test/cctest/test-api-interceptors.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/2f9dabd0d84af8ed35feca3498116244cc41dad2/deps%2Fv8%2Ftest%2Fcctest%2Ftest-api-interceptors.cc",
            "raw_url": "https://github.com/nodejs/node/raw/2f9dabd0d84af8ed35feca3498116244cc41dad2/deps%2Fv8%2Ftest%2Fcctest%2Ftest-api-interceptors.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fcctest%2Ftest-api-interceptors.cc?ref=2f9dabd0d84af8ed35feca3498116244cc41dad2",
            "patch": "@@ -4768,7 +4768,7 @@ TEST(NamedAllCanReadInterceptor) {\n   ExpectInt32(\"checked.whatever\", 17);\n   CHECK(!CompileRun(\"Object.getOwnPropertyDescriptor(checked, 'whatever')\")\n              ->IsUndefined());\n-  CHECK_EQ(6, access_check_data.count);\n+  CHECK_EQ(5, access_check_data.count);\n \n   access_check_data.result = false;\n   ExpectInt32(\"checked.whatever\", intercept_data_0.value);\n@@ -4777,7 +4777,7 @@ TEST(NamedAllCanReadInterceptor) {\n     CompileRun(\"Object.getOwnPropertyDescriptor(checked, 'whatever')\");\n     CHECK(try_catch.HasCaught());\n   }\n-  CHECK_EQ(9, access_check_data.count);\n+  CHECK_EQ(8, access_check_data.count);\n \n   intercept_data_1.should_intercept = true;\n   ExpectInt32(\"checked.whatever\", intercept_data_1.value);\n@@ -4786,7 +4786,7 @@ TEST(NamedAllCanReadInterceptor) {\n     CompileRun(\"Object.getOwnPropertyDescriptor(checked, 'whatever')\");\n     CHECK(try_catch.HasCaught());\n   }\n-  CHECK_EQ(12, access_check_data.count);\n+  CHECK_EQ(11, access_check_data.count);\n   g_access_check_data = nullptr;\n }\n \n@@ -4855,7 +4855,7 @@ TEST(IndexedAllCanReadInterceptor) {\n   ExpectInt32(\"checked[15]\", 17);\n   CHECK(!CompileRun(\"Object.getOwnPropertyDescriptor(checked, '15')\")\n              ->IsUndefined());\n-  CHECK_EQ(6, access_check_data.count);\n+  CHECK_EQ(5, access_check_data.count);\n \n   access_check_data.result = false;\n   ExpectInt32(\"checked[15]\", intercept_data_0.value);\n@@ -4864,7 +4864,7 @@ TEST(IndexedAllCanReadInterceptor) {\n     CompileRun(\"Object.getOwnPropertyDescriptor(checked, '15')\");\n     CHECK(try_catch.HasCaught());\n   }\n-  CHECK_EQ(9, access_check_data.count);\n+  CHECK_EQ(8, access_check_data.count);\n \n   intercept_data_1.should_intercept = true;\n   ExpectInt32(\"checked[15]\", intercept_data_1.value);\n@@ -4873,7 +4873,7 @@ TEST(IndexedAllCanReadInterceptor) {\n     CompileRun(\"Object.getOwnPropertyDescriptor(checked, '15')\");\n     CHECK(try_catch.HasCaught());\n   }\n-  CHECK_EQ(12, access_check_data.count);\n+  CHECK_EQ(11, access_check_data.count);\n \n   g_access_check_data = nullptr;\n }"
        }
    ],
    "stats": {
        "total": 28,
        "additions": 16,
        "deletions": 12
    }
}