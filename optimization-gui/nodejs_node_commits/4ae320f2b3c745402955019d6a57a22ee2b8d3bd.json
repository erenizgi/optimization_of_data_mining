{
    "author": "daynin",
    "message": "path: remove redundant function\n\nPR-URL: https://github.com/nodejs/node/pull/19237\nReviewed-By: Weijia Wang <starkwang@126.com>\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>",
    "sha": "4ae320f2b3c745402955019d6a57a22ee2b8d3bd",
    "files": [
        {
            "sha": "7a4868852698dba8343ac31a33456bda90d09ea8",
            "filename": "lib/path.js",
            "status": "modified",
            "additions": 9,
            "deletions": 77,
            "changes": 86,
            "blob_url": "https://github.com/nodejs/node/blob/4ae320f2b3c745402955019d6a57a22ee2b8d3bd/lib%2Fpath.js",
            "raw_url": "https://github.com/nodejs/node/raw/4ae320f2b3c745402955019d6a57a22ee2b8d3bd/lib%2Fpath.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fpath.js?ref=4ae320f2b3c745402955019d6a57a22ee2b8d3bd",
            "patch": "@@ -50,7 +50,7 @@ function isWindowsDeviceRoot(code) {\n }\n \n // Resolves . and .. elements in a path with directory names\n-function normalizeStringWin32(path, allowAboveRoot) {\n+function normalizeString(path, allowAboveRoot, separator) {\n   var res = '';\n   var lastSegmentLength = 0;\n   var lastSlash = -1;\n@@ -72,14 +72,14 @@ function normalizeStringWin32(path, allowAboveRoot) {\n             res.charCodeAt(res.length - 1) !== CHAR_DOT ||\n             res.charCodeAt(res.length - 2) !== CHAR_DOT) {\n           if (res.length > 2) {\n-            const lastSlashIndex = res.lastIndexOf('\\\\');\n+            const lastSlashIndex = res.lastIndexOf(separator);\n             if (lastSlashIndex !== res.length - 1) {\n               if (lastSlashIndex === -1) {\n                 res = '';\n                 lastSegmentLength = 0;\n               } else {\n                 res = res.slice(0, lastSlashIndex);\n-                lastSegmentLength = res.length - 1 - res.lastIndexOf('\\\\');\n+                lastSegmentLength = res.length - 1 - res.lastIndexOf(separator);\n               }\n               lastSlash = i;\n               dots = 0;\n@@ -95,82 +95,14 @@ function normalizeStringWin32(path, allowAboveRoot) {\n         }\n         if (allowAboveRoot) {\n           if (res.length > 0)\n-            res += '\\\\..';\n+            res += `${separator}..`;\n           else\n             res = '..';\n           lastSegmentLength = 2;\n         }\n       } else {\n         if (res.length > 0)\n-          res += '\\\\' + path.slice(lastSlash + 1, i);\n-        else\n-          res = path.slice(lastSlash + 1, i);\n-        lastSegmentLength = i - lastSlash - 1;\n-      }\n-      lastSlash = i;\n-      dots = 0;\n-    } else if (code === CHAR_DOT && dots !== -1) {\n-      ++dots;\n-    } else {\n-      dots = -1;\n-    }\n-  }\n-  return res;\n-}\n-\n-// Resolves . and .. elements in a path with directory names\n-function normalizeStringPosix(path, allowAboveRoot) {\n-  var res = '';\n-  var lastSegmentLength = 0;\n-  var lastSlash = -1;\n-  var dots = 0;\n-  var code;\n-  for (var i = 0; i <= path.length; ++i) {\n-    if (i < path.length)\n-      code = path.charCodeAt(i);\n-    else if (code === CHAR_FORWARD_SLASH)\n-      break;\n-    else\n-      code = CHAR_FORWARD_SLASH;\n-    if (code === CHAR_FORWARD_SLASH) {\n-      if (lastSlash === i - 1 || dots === 1) {\n-        // NOOP\n-      } else if (lastSlash !== i - 1 && dots === 2) {\n-        if (res.length < 2 || lastSegmentLength !== 2 ||\n-            res.charCodeAt(res.length - 1) !== CHAR_DOT ||\n-            res.charCodeAt(res.length - 2) !== CHAR_DOT) {\n-          if (res.length > 2) {\n-            const lastSlashIndex = res.lastIndexOf('/');\n-            if (lastSlashIndex !== res.length - 1) {\n-              if (lastSlashIndex === -1) {\n-                res = '';\n-                lastSegmentLength = 0;\n-              } else {\n-                res = res.slice(0, lastSlashIndex);\n-                lastSegmentLength = res.length - 1 - res.lastIndexOf('/');\n-              }\n-              lastSlash = i;\n-              dots = 0;\n-              continue;\n-            }\n-          } else if (res.length === 2 || res.length === 1) {\n-            res = '';\n-            lastSegmentLength = 0;\n-            lastSlash = i;\n-            dots = 0;\n-            continue;\n-          }\n-        }\n-        if (allowAboveRoot) {\n-          if (res.length > 0)\n-            res += '/..';\n-          else\n-            res = '..';\n-          lastSegmentLength = 2;\n-        }\n-      } else {\n-        if (res.length > 0)\n-          res += '/' + path.slice(lastSlash + 1, i);\n+          res += separator + path.slice(lastSlash + 1, i);\n         else\n           res = path.slice(lastSlash + 1, i);\n         lastSegmentLength = i - lastSlash - 1;\n@@ -340,7 +272,7 @@ const win32 = {\n     // fails)\n \n     // Normalize the tail path\n-    resolvedTail = normalizeStringWin32(resolvedTail, !resolvedAbsolute);\n+    resolvedTail = normalizeString(resolvedTail, !resolvedAbsolute, '\\\\');\n \n     return (resolvedDevice + (resolvedAbsolute ? '\\\\' : '') + resolvedTail) ||\n            '.';\n@@ -432,7 +364,7 @@ const win32 = {\n \n     var tail;\n     if (rootEnd < len)\n-      tail = normalizeStringWin32(path.slice(rootEnd), !isAbsolute);\n+      tail = normalizeString(path.slice(rootEnd), !isAbsolute, '\\\\');\n     else\n       tail = '';\n     if (tail.length === 0 && !isAbsolute)\n@@ -1163,7 +1095,7 @@ const posix = {\n     // handle relative paths to be safe (might happen when process.cwd() fails)\n \n     // Normalize the path\n-    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n+    resolvedPath = normalizeString(resolvedPath, !resolvedAbsolute, '/');\n \n     if (resolvedAbsolute) {\n       if (resolvedPath.length > 0)\n@@ -1189,7 +1121,7 @@ const posix = {\n       path.charCodeAt(path.length - 1) === CHAR_FORWARD_SLASH;\n \n     // Normalize the path\n-    path = normalizeStringPosix(path, !isAbsolute);\n+    path = normalizeString(path, !isAbsolute, '/');\n \n     if (path.length === 0 && !isAbsolute)\n       path = '.';"
        }
    ],
    "stats": {
        "total": 86,
        "additions": 9,
        "deletions": 77
    }
}