{
    "author": "apapirovski",
    "message": "http: use switch in matchHeader\n\nUsing a switch improves clarity of the code but also performance for\nall but a few edge cases which remain on par with the old code.\n\nPR-URL: https://github.com/nodejs/node/pull/20131\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Yuta Hiroto <hello@hiroppy.me>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "54caeae38a66841b7f7119649dc78ce55c8a7c52",
    "files": [
        {
            "sha": "8406c9cd8b04942fc75aa7d72349aa410b6e9213",
            "filename": "lib/_http_outgoing.js",
            "status": "modified",
            "additions": 20,
            "deletions": 23,
            "changes": 43,
            "blob_url": "https://github.com/nodejs/node/blob/54caeae38a66841b7f7119649dc78ce55c8a7c52/lib%2F_http_outgoing.js",
            "raw_url": "https://github.com/nodejs/node/raw/54caeae38a66841b7f7119649dc78ce55c8a7c52/lib%2F_http_outgoing.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_outgoing.js?ref=54caeae38a66841b7f7119649dc78ce55c8a7c52",
            "patch": "@@ -52,8 +52,6 @@ const { utcDate } = internalHttp;\n \n const kIsCorked = Symbol('isCorked');\n \n-var RE_FIELDS =\n-  /^(?:Connection|Transfer-Encoding|Content-Length|Date|Expect|Trailer|Upgrade)$/i;\n var RE_CONN_VALUES = /(?:^|\\W)close|upgrade(?:$|\\W)/ig;\n var RE_TE_CHUNKED = common.chunkExpression;\n \n@@ -449,28 +447,27 @@ function matchConnValue(self, state, value) {\n }\n \n function matchHeader(self, state, field, value) {\n-  var m = RE_FIELDS.exec(field);\n-  if (!m)\n+  if (field.length < 4 || field.length > 17)\n     return;\n-  var len = m[0].length;\n-  if (len === 10) {\n-    state.connection = true;\n-    matchConnValue(self, state, value);\n-  } else if (len === 17) {\n-    state.te = true;\n-    if (RE_TE_CHUNKED.test(value)) self.chunkedEncoding = true;\n-  } else if (len === 14) {\n-    state.contLen = true;\n-  } else if (len === 4) {\n-    state.date = true;\n-  } else if (len === 6) {\n-    state.expect = true;\n-  } else if (len === 7) {\n-    var ch = m[0].charCodeAt(0);\n-    if (ch === 85 || ch === 117)\n-      state.upgrade = true;\n-    else\n-      state.trailer = true;\n+  field = field.toLowerCase();\n+  switch (field) {\n+    case 'connection':\n+      state.connection = true;\n+      matchConnValue(self, state, value);\n+      break;\n+    case 'transfer-encoding':\n+      state.te = true;\n+      if (RE_TE_CHUNKED.test(value)) self.chunkedEncoding = true;\n+      break;\n+    case 'content-length':\n+      state.contLen = true;\n+      break;\n+    case 'date':\n+    case 'expect':\n+    case 'trailer':\n+    case 'upgrade':\n+      state[field] = true;\n+      break;\n   }\n }\n "
        }
    ],
    "stats": {
        "total": 43,
        "additions": 20,
        "deletions": 23
    }
}