{
    "author": "ryzokuken",
    "message": "fs: make ReadStream throw TypeError on NaN\n\nMake ReadStream (and thus createReadStream) throw a TypeError signalling\ntowards an invalid argument type when either options.start or\noptions.end (or obviously, both) are set to NaN.\nAlso add regression tests for the same.\n\nPR-URL: https://github.com/nodejs/node/pull/19775\nFixes: https://github.com/nodejs/node/issues/19715\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "38a692963f000e3bd0f8413617d3b5774039dff8",
    "files": [
        {
            "sha": "f0a9b676b34992091803e93926bcf21a8d7ac2fd",
            "filename": "lib/fs.js",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/38a692963f000e3bd0f8413617d3b5774039dff8/lib%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/38a692963f000e3bd0f8413617d3b5774039dff8/lib%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs.js?ref=38a692963f000e3bd0f8413617d3b5774039dff8",
            "patch": "@@ -2009,12 +2009,12 @@ function ReadStream(path, options) {\n   this.closed = false;\n \n   if (this.start !== undefined) {\n-    if (typeof this.start !== 'number') {\n+    if (typeof this.start !== 'number' || Number.isNaN(this.start)) {\n       throw new ERR_INVALID_ARG_TYPE('start', 'number', this.start);\n     }\n     if (this.end === undefined) {\n       this.end = Infinity;\n-    } else if (typeof this.end !== 'number') {\n+    } else if (typeof this.end !== 'number' || Number.isNaN(this.end)) {\n       throw new ERR_INVALID_ARG_TYPE('end', 'number', this.end);\n     }\n \n@@ -2031,6 +2031,8 @@ function ReadStream(path, options) {\n   // (That is a semver-major change).\n   if (typeof this.end !== 'number')\n     this.end = Infinity;\n+  else if (Number.isNaN(this.end))\n+    throw new ERR_INVALID_ARG_TYPE('end', 'number', this.end);\n \n   if (typeof this.fd !== 'number')\n     this.open();"
        },
        {
            "sha": "5cba76fa394636d8f33c2beb7f5ec07d9e1452f1",
            "filename": "test/parallel/test-fs-read-stream-throw-type-error.js",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/38a692963f000e3bd0f8413617d3b5774039dff8/test%2Fparallel%2Ftest-fs-read-stream-throw-type-error.js",
            "raw_url": "https://github.com/nodejs/node/raw/38a692963f000e3bd0f8413617d3b5774039dff8/test%2Fparallel%2Ftest-fs-read-stream-throw-type-error.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-read-stream-throw-type-error.js?ref=38a692963f000e3bd0f8413617d3b5774039dff8",
            "patch": "@@ -3,6 +3,9 @@ const common = require('../common');\n const fixtures = require('../common/fixtures');\n const fs = require('fs');\n \n+// This test ensures that appropriate TypeError is thrown by createReadStream\n+// when an argument with invalid type is passed\n+\n const example = fixtures.path('x.txt');\n // Should not throw.\n fs.createReadStream(example, undefined);\n@@ -25,3 +28,8 @@ createReadStreamErr(example, 123);\n createReadStreamErr(example, 0);\n createReadStreamErr(example, true);\n createReadStreamErr(example, false);\n+\n+// createReadSteam _should_ throw on NaN\n+createReadStreamErr(example, { start: NaN });\n+createReadStreamErr(example, { end: NaN });\n+createReadStreamErr(example, { start: NaN, end: NaN });"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
    }
}