{
    "author": "apapirovski",
    "message": "fs: fix promisified fs.readdir withFileTypes\n\nPR-URL: https://github.com/nodejs/node/pull/22832\nReviewed-By: Bryan English <bryan@bryanenglish.com>\nReviewed-By: Rich Trott <rtrott@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "16210cad093519b756f2ce8025b29eb9f8d2d046",
    "files": [
        {
            "sha": "6cae7d1a21ff8da048d85412084d23f8d88b773e",
            "filename": "lib/internal/fs/promises.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/16210cad093519b756f2ce8025b29eb9f8d2d046/lib%2Finternal%2Ffs%2Fpromises.js",
            "raw_url": "https://github.com/nodejs/node/raw/16210cad093519b756f2ce8025b29eb9f8d2d046/lib%2Finternal%2Ffs%2Fpromises.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ffs%2Fpromises.js?ref=16210cad093519b756f2ce8025b29eb9f8d2d046",
            "patch": "@@ -317,7 +317,8 @@ async function readdir(path, options) {\n   path = toPathIfFileURL(path);\n   validatePath(path);\n   const result = await binding.readdir(pathModule.toNamespacedPath(path),\n-                                       options.encoding, !!options.withTypes,\n+                                       options.encoding,\n+                                       !!options.withFileTypes,\n                                        kUsePromises);\n   return options.withFileTypes ?\n     getDirectoryEntriesPromise(path, result) :"
        },
        {
            "sha": "0faaeb00dadeb186d4af95e035da6621dac341f2",
            "filename": "test/parallel/test-fs-readdir-types.js",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/16210cad093519b756f2ce8025b29eb9f8d2d046/test%2Fparallel%2Ftest-fs-readdir-types.js",
            "raw_url": "https://github.com/nodejs/node/raw/16210cad093519b756f2ce8025b29eb9f8d2d046/test%2Fparallel%2Ftest-fs-readdir-types.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-readdir-types.js?ref=16210cad093519b756f2ce8025b29eb9f8d2d046",
            "patch": "@@ -57,6 +57,14 @@ fs.readdir(readdirDir, {\n   assertDirents(dirents);\n }));\n \n+// Check the promisified version\n+assert.doesNotReject(async () => {\n+  const dirents = await fs.promises.readdir(readdirDir, {\n+    withFileTypes: true\n+  });\n+  assertDirents(dirents);\n+});\n+\n // Check for correct types when the binding returns unknowns\n const UNKNOWN = constants.UV_DIRENT_UNKNOWN;\n const oldReaddir = binding.readdir;"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 10,
        "deletions": 1
    }
}