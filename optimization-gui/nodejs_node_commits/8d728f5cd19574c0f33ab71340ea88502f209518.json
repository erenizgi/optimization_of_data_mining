{
    "author": "AdamMajer",
    "message": "test: fix zlib-brotli output assumptions\n\nOn different architectures, it's possible for the compression algorithm\nto produce slightly different outputs. So, don't assume we will\nalways get the same compressed output on all architectures. Instead,\nverify that the decompressing pre-compressed string functions\ncorrectly.\n\nFixes: https://github.com/nodejs/node/issues/25568\n\nPR-URL: https://github.com/nodejs/node/pull/25697\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "8d728f5cd19574c0f33ab71340ea88502f209518",
    "files": [
        {
            "sha": "30be44517a0bf76cecfe6ad1e9cf3aef2f029025",
            "filename": "test/parallel/test-zlib-brotli-from-string.js",
            "status": "modified",
            "additions": 15,
            "deletions": 11,
            "changes": 26,
            "blob_url": "https://github.com/nodejs/node/blob/8d728f5cd19574c0f33ab71340ea88502f209518/test%2Fparallel%2Ftest-zlib-brotli-from-string.js",
            "raw_url": "https://github.com/nodejs/node/raw/8d728f5cd19574c0f33ab71340ea88502f209518/test%2Fparallel%2Ftest-zlib-brotli-from-string.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-zlib-brotli-from-string.js?ref=8d728f5cd19574c0f33ab71340ea88502f209518",
            "patch": "@@ -14,21 +14,25 @@ const inputString = 'ΩΩLorem ipsum dolor sit amet, consectetur adipiscing eli'\n                     ' diam ipsum. Suspendisse nec ullamcorper odio. Vestibulu' +\n                     'm arcu mi, sodales non suscipit id, ultrices ut massa. S' +\n                     'ed ac sem sit amet arcu malesuada fermentum. Nunc sed. ';\n-const expectedBase64Compress = 'G/gBQBwHdky2aHV5KK9Snf05//1pPdmNw/7232fnIm1IB' +\n-                               'K1AA8RsN8OB8Nb7Lpgk3UWWUlzQXZyHQeBBbXMTQXC1j7' +\n-                               'wg3LJs9LqOGHRH2bj/a2iCTLLx8hBOyTqgoVuD1e+Qqdn' +\n-                               'f1rkUNyrWq6LtOhWgxP3QUwdhKGdZm3rJWaDDBV7+pDk1' +\n-                               'MIkrmjp4ma2xVi5MsgJScA3tP1I7mXeby6MELozrwoBQD' +\n-                               'mVTnEAicZNj4lkGqntJe2qSnGyeMmcFgraK94vCg/4iLu' +\n-                               'Tw5RhKhnVY++dZ6niUBmRqIutsjf5TzwF5iAg8a9UkjF5' +\n-                               '2eZ0tB2vo6v8SqVfNMkBmmhxr0NT9LkYF69aEjlYzj7IE' +\n-                               'KmEUQf1HBogRYhFIt4ymRNEgHAIzOyNEsQM=';\n+const compressedString = 'G/gBQBwHdky2aHV5KK9Snf05//1pPdmNw/7232fnIm1IB' +\n+                         'K1AA8RsN8OB8Nb7Lpgk3UWWUlzQXZyHQeBBbXMTQXC1j7' +\n+                         'wg3LJs9LqOGHRH2bj/a2iCTLLx8hBOyTqgoVuD1e+Qqdn' +\n+                         'f1rkUNyrWq6LtOhWgxP3QUwdhKGdZm3rJWaDDBV7+pDk1' +\n+                         'MIkrmjp4ma2xVi5MsgJScA3tP1I7mXeby6MELozrwoBQD' +\n+                         'mVTnEAicZNj4lkGqntJe2qSnGyeMmcFgraK94vCg/4iLu' +\n+                         'Tw5RhKhnVY++dZ6niUBmRqIutsjf5TzwF5iAg8a9UkjF5' +\n+                         '2eZ0tB2vo6v8SqVfNMkBmmhxr0NT9LkYF69aEjlYzj7IE' +\n+                         'KmEUQf1HBogRYhFIt4ymRNEgHAIzOyNEsQM=';\n \n zlib.brotliCompress(inputString, common.mustCall((err, buffer) => {\n-  assert.strictEqual(buffer.toString('base64'), expectedBase64Compress);\n+  assert(inputString.length > buffer.length);\n+\n+  zlib.brotliDecompress(buffer, common.mustCall((err, buffer) => {\n+    assert.strictEqual(buffer.toString(), inputString);\n+  }));\n }));\n \n-const buffer = Buffer.from(expectedBase64Compress, 'base64');\n+const buffer = Buffer.from(compressedString, 'base64');\n zlib.brotliDecompress(buffer, common.mustCall((err, buffer) => {\n   assert.strictEqual(buffer.toString(), inputString);\n }));"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 15,
        "deletions": 11
    }
}