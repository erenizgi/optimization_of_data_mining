{
    "author": "Trott",
    "message": "test: add check for wrk to test-keep-alive\n\ntest/pummel/test-keep-alive.js requires `wrk` to be installed. Check if\nit is, and skip the test if it isn't.\n\nThis is yet another step in preparation for running pummel tests in CI\ndaily.\n\nPR-URL: https://github.com/nodejs/node/pull/25516\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "5fdd55473047b8e4fca79dae42b9ca2d0d5b08ae",
    "files": [
        {
            "sha": "896f0a1f68d28f4c6886071ba54c003362c8d126",
            "filename": "test/pummel/test-keep-alive.js",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/5fdd55473047b8e4fca79dae42b9ca2d0d5b08ae/test%2Fpummel%2Ftest-keep-alive.js",
            "raw_url": "https://github.com/nodejs/node/raw/5fdd55473047b8e4fca79dae42b9ca2d0d5b08ae/test%2Fpummel%2Ftest-keep-alive.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fpummel%2Ftest-keep-alive.js?ref=5fdd55473047b8e4fca79dae42b9ca2d0d5b08ae",
            "patch": "@@ -23,11 +23,13 @@\n \n // This test requires the program 'wrk'.\n const common = require('../common');\n-if (common.isWindows)\n-  common.skip('no `wrk` on windows');\n+\n+const child_process = require('child_process');\n+const result = child_process.spawnSync('wrk', ['-h']);\n+if (result.error && result.error.code === 'ENOENT')\n+  common.skip('test requires `wrk` to be installed first');\n \n const assert = require('assert');\n-const spawn = require('child_process').spawn;\n const http = require('http');\n const url = require('url');\n \n@@ -60,7 +62,7 @@ const runAb = (opts, callback) => {\n   args.push(url.format({ hostname: '127.0.0.1',\n                          port: opts.port, protocol: 'http' }));\n \n-  const child = spawn('wrk', args);\n+  const child = child_process.spawn('wrk', args);\n   child.stderr.pipe(process.stderr);\n   child.stdout.setEncoding('utf8');\n "
        }
    ],
    "stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
    }
}