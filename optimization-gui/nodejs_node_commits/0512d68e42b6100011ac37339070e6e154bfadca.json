{
    "author": "sam-github",
    "message": "tls: include RSA bit size in X.509 public key info\n\nFor symmetricality with the EC public key info, and because its useful.\n\nPR-URL: https://github.com/nodejs/node/pull/24358\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>",
    "sha": "0512d68e42b6100011ac37339070e6e154bfadca",
    "files": [
        {
            "sha": "69cfae438b4470c52de10c7046b47ce0e78df60d",
            "filename": "doc/api/tls.md",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0512d68e42b6100011ac37339070e6e154bfadca/doc%2Fapi%2Ftls.md",
            "raw_url": "https://github.com/nodejs/node/raw/0512d68e42b6100011ac37339070e6e154bfadca/doc%2Fapi%2Ftls.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Ftls.md?ref=0512d68e42b6100011ac37339070e6e154bfadca",
            "patch": "@@ -688,6 +688,7 @@ The certificate may contain information about the public key, depending on\n the key type.\n \n For RSA keys, the following properties may be defined:\n+* `bits` {number} The RSA bit size. Example: `1024`.\n * `exponent` {string} The RSA exponent, as a string in hexadecimal number\n   notation.  Example: `'0x010001'`.\n * `modulus` {string} The RSA modulus, as a hexadecimal string. Example:"
        },
        {
            "sha": "7e168c6fa4272b23f93b8283cb6180a24ae69bf7",
            "filename": "src/node_crypto.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/0512d68e42b6100011ac37339070e6e154bfadca/src%2Fnode_crypto.cc",
            "raw_url": "https://github.com/nodejs/node/raw/0512d68e42b6100011ac37339070e6e154bfadca/src%2Fnode_crypto.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto.cc?ref=0512d68e42b6100011ac37339070e6e154bfadca",
            "patch": "@@ -1685,6 +1685,10 @@ static Local<Object> X509ToObject(Environment* env, X509* cert) {\n                                   mem->length).ToLocalChecked()).FromJust();\n     USE(BIO_reset(bio.get()));\n \n+    int bits = BN_num_bits(n);\n+    info->Set(context, env->bits_string(),\n+              Integer::New(env->isolate(), bits)).FromJust();\n+\n     uint64_t exponent_word = static_cast<uint64_t>(BN_get_word(e));\n     uint32_t lo = static_cast<uint32_t>(exponent_word);\n     uint32_t hi = static_cast<uint32_t>(exponent_word >> 32);"
        },
        {
            "sha": "523638d4a39649ba53b77768f28c82a6fcb30145",
            "filename": "test/parallel/test-tls-peer-certificate.js",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/0512d68e42b6100011ac37339070e6e154bfadca/test%2Fparallel%2Ftest-tls-peer-certificate.js",
            "raw_url": "https://github.com/nodejs/node/raw/0512d68e42b6100011ac37339070e6e154bfadca/test%2Fparallel%2Ftest-tls-peer-certificate.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tls-peer-certificate.js?ref=0512d68e42b6100011ac37339070e6e154bfadca",
            "patch": "@@ -55,6 +55,11 @@ connect({\n   assert.strictEqual(peerCert.subject.emailAddress, 'ry@tinyclouds.org');\n   assert.strictEqual(peerCert.serialNumber, 'ECC9B856270DA9A8');\n   assert.strictEqual(peerCert.exponent, '0x10001');\n+  assert.strictEqual(peerCert.bits, 1024);\n+  // The conversion to bits is odd because modulus isn't a buffer, its a hex\n+  // string. There are two hex chars for every byte of modulus, and 8 bits per\n+  // byte.\n+  assert.strictEqual(peerCert.modulus.length / 2 * 8, peerCert.bits);\n   assert.strictEqual(\n     peerCert.fingerprint,\n     'D7:FD:F6:42:92:A8:83:51:8E:80:48:62:66:DA:85:C2:EE:A6:A1:CD'"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 10,
        "deletions": 0
    }
}