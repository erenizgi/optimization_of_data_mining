{
    "author": "ratracegrad",
    "message": "test: increase test coverage for fs.promises read\n\nPR-URL: https://github.com/nodejs/node/pull/22800\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ben Coe <bencoe@gmail.com>\nReviewed-By: Yuta Hiroto <hello@hiroppy.me>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>",
    "sha": "27f3d9a64976ac4a7a726dde024ca9e2ea9cef7a",
    "files": [
        {
            "sha": "797f8e4ea269f857506aa038a6416a4be680a83c",
            "filename": "test/parallel/test-fs-promises.js",
            "status": "modified",
            "additions": 36,
            "deletions": 7,
            "changes": 43,
            "blob_url": "https://github.com/nodejs/node/blob/27f3d9a64976ac4a7a726dde024ca9e2ea9cef7a/test%2Fparallel%2Ftest-fs-promises.js",
            "raw_url": "https://github.com/nodejs/node/raw/27f3d9a64976ac4a7a726dde024ca9e2ea9cef7a/test%2Fparallel%2Ftest-fs-promises.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-promises.js?ref=27f3d9a64976ac4a7a726dde024ca9e2ea9cef7a",
            "patch": "@@ -64,6 +64,13 @@ function verifyStatObject(stat) {\n   assert.strictEqual(typeof stat.mode, 'number');\n }\n \n+async function getHandle(dest) {\n+  await copyFile(fixtures.path('baz.js'), dest);\n+  await access(dest, 'r');\n+\n+  return open(dest, 'r+');\n+}\n+\n {\n   async function doTest() {\n     tmpdir.refresh();\n@@ -93,6 +100,19 @@ function verifyStatObject(stat) {\n     await handle.datasync();\n     await handle.sync();\n \n+    // test fs.read promises when length to read is zero bytes\n+    {\n+      const dest = path.resolve(tmpDir, 'test1.js');\n+      const handle = await getHandle(dest);\n+      const buf = Buffer.from('DAWGS WIN');\n+      const bufLen = buf.length;\n+      await handle.write(buf);\n+      const ret = await handle.read(Buffer.alloc(bufLen), 0, 0, 0);\n+      assert.strictEqual(ret.bytesRead, 0);\n+\n+      await unlink(dest);\n+    }\n+\n     const buf = Buffer.from('hello fsPromises');\n     const bufLen = buf.length;\n     await handle.write(buf);\n@@ -203,13 +223,22 @@ function verifyStatObject(stat) {\n \n     await unlink(newLink2);\n \n-    const newdir = path.resolve(tmpDir, 'dir');\n-    await mkdir(newdir);\n-    stats = await stat(newdir);\n-    assert(stats.isDirectory());\n-    const list = await readdir(tmpDir);\n-    assert.deepStrictEqual(list, ['baz2.js', 'dir']);\n-    await rmdir(newdir);\n+    // testing readdir lists both files and directories\n+    {\n+      const newDir = path.resolve(tmpDir, 'dir');\n+      const newFile = path.resolve(tmpDir, 'foo.js');\n+\n+      await mkdir(newDir);\n+      await writeFile(newFile, 'DAWGS WIN!', 'utf8');\n+\n+      stats = await stat(newDir);\n+      assert(stats.isDirectory());\n+      const list = await readdir(tmpDir);\n+      assert.notStrictEqual(list.indexOf('dir'), -1);\n+      assert.notStrictEqual(list.indexOf('foo.js'), -1);\n+      await rmdir(newDir);\n+      await unlink(newFile);\n+    }\n \n     // mkdir when options is number.\n     {"
        }
    ],
    "stats": {
        "total": 43,
        "additions": 36,
        "deletions": 7
    }
}