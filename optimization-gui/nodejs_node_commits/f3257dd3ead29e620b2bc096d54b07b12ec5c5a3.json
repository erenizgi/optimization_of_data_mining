{
    "author": "daynin",
    "message": "benchmark: fix benchmark for url\n\nRename different parameters with the same names to make it possible\nto run tests for url benchmarks.\n\nPR-URL: https://github.com/nodejs/node/pull/19084\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Khaidi Chu <i@2333.moe>\nReviewed-By: Shingo Inoue <leko.noor@gmail.com>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "f3257dd3ead29e620b2bc096d54b07b12ec5c5a3",
    "files": [
        {
            "sha": "6b054d0b2a1f1a0bc7765c5afb9452e27dbc66ca",
            "filename": "benchmark/url/legacy-vs-whatwg-url-searchparams-parse.js",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/nodejs/node/blob/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Flegacy-vs-whatwg-url-searchparams-parse.js",
            "raw_url": "https://github.com/nodejs/node/raw/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Flegacy-vs-whatwg-url-searchparams-parse.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Furl%2Flegacy-vs-whatwg-url-searchparams-parse.js?ref=f3257dd3ead29e620b2bc096d54b07b12ec5c5a3",
            "patch": "@@ -2,10 +2,10 @@\n const common = require('../common.js');\n const { URLSearchParams } = require('url');\n const querystring = require('querystring');\n-const inputs = require('../fixtures/url-inputs.js').searchParams;\n+const searchParams = require('../fixtures/url-inputs.js').searchParams;\n \n const bench = common.createBenchmark(main, {\n-  type: Object.keys(inputs),\n+  searchParam: Object.keys(searchParams),\n   method: ['legacy', 'whatwg'],\n   n: [1e6]\n });\n@@ -19,27 +19,27 @@ function useLegacy(n, input) {\n   bench.end(n);\n }\n \n-function useWHATWG(n, input) {\n-  new URLSearchParams(input);\n+function useWHATWG(n, param) {\n+  new URLSearchParams(param);\n   bench.start();\n   for (var i = 0; i < n; i += 1) {\n-    new URLSearchParams(input);\n+    new URLSearchParams(param);\n   }\n   bench.end(n);\n }\n \n-function main({ type, n, method }) {\n-  const input = inputs[type];\n-  if (!input) {\n-    throw new Error(`Unknown input type \"${type}\"`);\n+function main({ searchParam, n, method }) {\n+  const param = searchParams[searchParam];\n+  if (!param) {\n+    throw new Error(`Unknown search parameter type \"${searchParam}\"`);\n   }\n \n   switch (method) {\n     case 'legacy':\n-      useLegacy(n, input);\n+      useLegacy(n, param);\n       break;\n     case 'whatwg':\n-      useWHATWG(n, input);\n+      useWHATWG(n, param);\n       break;\n     default:\n       throw new Error(`Unknown method ${method}`);"
        },
        {
            "sha": "54fdd95654488678a9342816fdcd26e93667cf37",
            "filename": "benchmark/url/legacy-vs-whatwg-url-searchparams-serialize.js",
            "status": "modified",
            "additions": 10,
            "deletions": 10,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Flegacy-vs-whatwg-url-searchparams-serialize.js",
            "raw_url": "https://github.com/nodejs/node/raw/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Flegacy-vs-whatwg-url-searchparams-serialize.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Furl%2Flegacy-vs-whatwg-url-searchparams-serialize.js?ref=f3257dd3ead29e620b2bc096d54b07b12ec5c5a3",
            "patch": "@@ -2,10 +2,10 @@\n const common = require('../common.js');\n const { URLSearchParams } = require('url');\n const querystring = require('querystring');\n-const inputs = require('../fixtures/url-inputs.js').searchParams;\n+const searchParams = require('../fixtures/url-inputs.js').searchParams;\n \n const bench = common.createBenchmark(main, {\n-  type: Object.keys(inputs),\n+  searchParam: Object.keys(searchParams),\n   method: ['legacy', 'whatwg'],\n   n: [1e6]\n });\n@@ -20,8 +20,8 @@ function useLegacy(n, input, prop) {\n   bench.end(n);\n }\n \n-function useWHATWG(n, input, prop) {\n-  const obj = new URLSearchParams(input);\n+function useWHATWG(n, param, prop) {\n+  const obj = new URLSearchParams(param);\n   obj.toString();\n   bench.start();\n   for (var i = 0; i < n; i += 1) {\n@@ -30,18 +30,18 @@ function useWHATWG(n, input, prop) {\n   bench.end(n);\n }\n \n-function main({ type, n, method }) {\n-  const input = inputs[type];\n-  if (!input) {\n-    throw new Error(`Unknown input type \"${type}\"`);\n+function main({ searchParam, n, method }) {\n+  const param = searchParams[searchParam];\n+  if (!param) {\n+    throw new Error(`Unknown search parameter type \"${searchParam}\"`);\n   }\n \n   switch (method) {\n     case 'legacy':\n-      useLegacy(n, input);\n+      useLegacy(n, param);\n       break;\n     case 'whatwg':\n-      useWHATWG(n, input);\n+      useWHATWG(n, param);\n       break;\n     default:\n       throw new Error(`Unknown method ${method}`);"
        },
        {
            "sha": "244c95502bfffb160851d777e45733848e714c17",
            "filename": "benchmark/url/url-searchparams-iteration.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Furl-searchparams-iteration.js",
            "raw_url": "https://github.com/nodejs/node/raw/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Furl-searchparams-iteration.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Furl%2Furl-searchparams-iteration.js?ref=f3257dd3ead29e620b2bc096d54b07b12ec5c5a3",
            "patch": "@@ -4,7 +4,7 @@ const assert = require('assert');\n const { URLSearchParams } = require('url');\n \n const bench = common.createBenchmark(main, {\n-  method: ['forEach', 'iterator'],\n+  loopMethod: ['forEach', 'iterator'],\n   n: [1e6]\n });\n \n@@ -44,15 +44,15 @@ function iterator(n) {\n   assert.strictEqual(noDead[1], '3rd');\n }\n \n-function main({ method, n }) {\n-  switch (method) {\n+function main({ loopMethod, n }) {\n+  switch (loopMethod) {\n     case 'forEach':\n       forEach(n);\n       break;\n     case 'iterator':\n       iterator(n);\n       break;\n     default:\n-      throw new Error(`Unknown method ${method}`);\n+      throw new Error(`Unknown method ${loopMethod}`);\n   }\n }"
        },
        {
            "sha": "2eb0a4f21350dc8eeabff1c0b54f03fdda500228",
            "filename": "benchmark/url/url-searchparams-read.js",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Furl-searchparams-read.js",
            "raw_url": "https://github.com/nodejs/node/raw/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Furl-searchparams-read.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Furl%2Furl-searchparams-read.js?ref=f3257dd3ead29e620b2bc096d54b07b12ec5c5a3",
            "patch": "@@ -3,21 +3,20 @@ const common = require('../common.js');\n const { URLSearchParams } = require('url');\n \n const bench = common.createBenchmark(main, {\n-  method: ['get', 'getAll', 'has'],\n+  accessMethod: ['get', 'getAll', 'has'],\n   param: ['one', 'two', 'three', 'nonexistent'],\n   n: [2e7]\n });\n \n const str = 'one=single&two=first&three=first&two=2nd&three=2nd&three=3rd';\n \n-function main({ method, param, n }) {\n+function main({ accessMethod, param, n }) {\n   const params = new URLSearchParams(str);\n-  const fn = params[method];\n-  if (!fn)\n-    throw new Error(`Unknown method ${method}`);\n+  if (!params[accessMethod])\n+    throw new Error(`Unknown method ${accessMethod}`);\n \n   bench.start();\n   for (var i = 0; i < n; i += 1)\n-    fn(param);\n+    params[accessMethod](param);\n   bench.end(n);\n }"
        },
        {
            "sha": "b67a08da7a88e0e6c496337c6ccc85e04b909aed",
            "filename": "benchmark/url/whatwg-url-idna.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Fwhatwg-url-idna.js",
            "raw_url": "https://github.com/nodejs/node/raw/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/benchmark%2Furl%2Fwhatwg-url-idna.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Furl%2Fwhatwg-url-idna.js?ref=f3257dd3ead29e620b2bc096d54b07b12ec5c5a3",
            "patch": "@@ -2,7 +2,7 @@\n const common = require('../common.js');\n const { domainToASCII, domainToUnicode } = require('url');\n \n-const inputs = {\n+const domains = {\n   empty: {\n     ascii: '',\n     unicode: ''\n@@ -26,13 +26,13 @@ const inputs = {\n };\n \n const bench = common.createBenchmark(main, {\n-  input: Object.keys(inputs),\n+  domain: Object.keys(domains),\n   to: ['ascii', 'unicode'],\n   n: [5e6]\n });\n \n-function main({ n, to, input }) {\n-  const value = inputs[input][to];\n+function main({ n, to, domain }) {\n+  const value = domains[domain][to];\n   const method = to === 'ascii' ? domainToASCII : domainToUnicode;\n \n   bench.start();"
        },
        {
            "sha": "e4bcf5017004f4edd546a09ec08d4a0759cba10e",
            "filename": "test/parallel/test-benchmark-url.js",
            "status": "added",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/nodejs/node/blob/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/test%2Fparallel%2Ftest-benchmark-url.js",
            "raw_url": "https://github.com/nodejs/node/raw/f3257dd3ead29e620b2bc096d54b07b12ec5c5a3/test%2Fparallel%2Ftest-benchmark-url.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-benchmark-url.js?ref=f3257dd3ead29e620b2bc096d54b07b12ec5c5a3",
            "patch": "@@ -0,0 +1,22 @@\n+'use strict';\n+\n+require('../common');\n+\n+const runBenchmark = require('../common/benchmark');\n+\n+runBenchmark('url',\n+             [\n+               'method=legacy',\n+               'loopMethod=forEach',\n+               'accessMethod=get',\n+               'type=short',\n+               'searchParam=noencode',\n+               'href=short',\n+               'input=short',\n+               'domain=empty',\n+               'path=up',\n+               'to=ascii',\n+               'prop=href',\n+               'n=1',\n+             ],\n+             { NODEJS_BENCHMARK_ZERO_ALLOWED: 1 });"
        }
    ],
    "stats": {
        "total": 91,
        "additions": 56,
        "deletions": 35
    }
}