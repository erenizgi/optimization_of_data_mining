{
    "author": "bzoz",
    "message": "fs: use fs.access in fs.exists\n\nUses fs.access to implement fs.exists functionality. Fixes a issue,\nwhen a file exists but user does not have privileges to do stat on the\nfile.\n\nFixes: https://github.com/nodejs/node/issues/17921\n\nPR-URL: https://github.com/nodejs/node/pull/18618\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Weijia Wang <starkwang@126.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Evan Lucas <evanlucas@me.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "d3955d15ff5c68acf91f35177d290ff068068a05",
    "files": [
        {
            "sha": "0287d81c942cda5d16f5fa81d3df71986b065701",
            "filename": "lib/fs.js",
            "status": "modified",
            "additions": 2,
            "deletions": 12,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/d3955d15ff5c68acf91f35177d290ff068068a05/lib%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/d3955d15ff5c68acf91f35177d290ff068068a05/lib%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs.js?ref=d3955d15ff5c68acf91f35177d290ff068068a05",
            "patch": "@@ -234,14 +234,10 @@ fs.exists = function(path, callback) {\n   }\n \n   try {\n-    path = getPathFromURL(path);\n-    validatePath(path);\n+    fs.access(path, fs.FS_OK, suppressedCallback);\n   } catch (err) {\n     return callback(false);\n   }\n-  var req = new FSReqWrap();\n-  req.oncomplete = suppressedCallback;\n-  binding.stat(pathModule.toNamespacedPath(path), req);\n };\n \n Object.defineProperty(fs.exists, internalUtil.promisify.custom, {\n@@ -260,13 +256,7 @@ Object.defineProperty(fs.exists, internalUtil.promisify.custom, {\n // TODO(joyeecheung): deprecate the never-throw-on-invalid-arguments behavior\n fs.existsSync = function(path) {\n   try {\n-    path = getPathFromURL(path);\n-    validatePath(path);\n-    const ctx = { path };\n-    binding.stat(pathModule.toNamespacedPath(path), undefined, ctx);\n-    if (ctx.errno !== undefined) {\n-      return false;\n-    }\n+    fs.accessSync(path, fs.FS_OK);\n     return true;\n   } catch (e) {\n     return false;"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 2,
        "deletions": 12
    }
}