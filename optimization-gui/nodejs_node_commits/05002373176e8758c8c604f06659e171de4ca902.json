{
    "author": "BeniCheni",
    "message": "inspector: move process.binding to internalBinding\n\nIn places of process.binding('inspector'), migrate code to adapt\ninternalBinding.\n\nPR-URL: https://github.com/nodejs/node/pull/24931\nRefs: https://github.com/nodejs/node/issues/22160\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "05002373176e8758c8c604f06659e171de4ca902",
    "files": [
        {
            "sha": "aac864901c92bc38ea5bd231f3dceeb00a9ce45d",
            "filename": "lib/inspector.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/lib%2Finspector.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/lib%2Finspector.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finspector.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -11,7 +11,7 @@ const {\n } = require('internal/errors').codes;\n const { validateString } = require('internal/validators');\n const util = require('util');\n-const { Connection, open, url } = process.binding('inspector');\n+const { Connection, open, url } = internalBinding('inspector');\n \n if (!Connection)\n   throw new ERR_INSPECTOR_NOT_AVAILABLE();"
        },
        {
            "sha": "c33072560adab51a066c6b48b9b97d565523b3eb",
            "filename": "lib/internal/bootstrap/loaders.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fbootstrap%2Floaders.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fbootstrap%2Floaders.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Floaders.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -90,6 +90,7 @@ const internalBindingWhitelist = [\n   'fs_event_wrap',\n   'http_parser',\n   'icu',\n+  'inspector',\n   'js_stream',\n   'natives',\n   'pipe_wrap',"
        },
        {
            "sha": "d481896e8af4dc03fb741bc385d7a29a90d49059",
            "filename": "lib/internal/console/inspector.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fconsole%2Finspector.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fconsole%2Finspector.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fconsole%2Finspector.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -4,7 +4,7 @@ const path = require('path');\n const CJSModule = require('internal/modules/cjs/loader');\n const { makeRequireFunction } = require('internal/modules/cjs/helpers');\n const { tryGetCwd } = require('internal/util');\n-const { addCommandLineAPI, consoleCall } = process.binding('inspector');\n+const { addCommandLineAPI, consoleCall } = internalBinding('inspector');\n \n // Wrap a console implemented by Node.js with features from the VM inspector\n function addInspectorApis(consoleFromNode, consoleFromVM) {"
        },
        {
            "sha": "4a3d31fc2ab7ded2ccd3d7acbc5f8d365d86729d",
            "filename": "lib/internal/inspector_async_hook.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Finspector_async_hook.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Finspector_async_hook.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Finspector_async_hook.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -1,6 +1,6 @@\n 'use strict';\n \n-const inspector = process.binding('inspector');\n+const inspector = internalBinding('inspector');\n \n if (!inspector || !inspector.asyncTaskScheduled) {\n   exports.setup = function() {};"
        },
        {
            "sha": "fcb536c3df373886be4aedd8446cc75cc24d60b3",
            "filename": "lib/internal/modules/cjs/helpers.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fmodules%2Fcjs%2Fhelpers.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fmodules%2Fcjs%2Fhelpers.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fmodules%2Fcjs%2Fhelpers.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -108,7 +108,7 @@ if (getOptionValue('--experimental-worker')) {\n   builtinLibs.sort();\n }\n \n-if (typeof process.binding('inspector').open === 'function') {\n+if (typeof internalBinding('inspector').open === 'function') {\n   builtinLibs.push('inspector');\n   builtinLibs.sort();\n }"
        },
        {
            "sha": "ee4fffa64ae432c9e6f1a6f78347c4c2fb329ee7",
            "filename": "lib/internal/modules/cjs/loader.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fmodules%2Fcjs%2Floader.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fmodules%2Fcjs%2Floader.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fmodules%2Fcjs%2Floader.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -703,7 +703,7 @@ Module.prototype._compile = function(content, filename) {\n     // Set breakpoint on module start\n     if (filename === resolvedArgv) {\n       delete process._breakFirstLine;\n-      inspectorWrapper = process.binding('inspector').callAndPauseOnStart;\n+      inspectorWrapper = internalBinding('inspector').callAndPauseOnStart;\n     }\n   }\n   var dirname = path.dirname(filename);"
        },
        {
            "sha": "fbb29aef783006e7b73b7fd71eac626a6f207206",
            "filename": "lib/internal/modules/esm/module_job.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fmodules%2Fesm%2Fmodule_job.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fmodules%2Fesm%2Fmodule_job.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fmodules%2Fesm%2Fmodule_job.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -73,7 +73,7 @@ class ModuleJob {\n     try {\n       if (this.isMain && process._breakFirstLine) {\n         delete process._breakFirstLine;\n-        const initWrapper = process.binding('inspector').callAndPauseOnStart;\n+        const initWrapper = internalBinding('inspector').callAndPauseOnStart;\n         initWrapper(this.module.instantiate, this.module);\n       } else {\n         this.module.instantiate();"
        },
        {
            "sha": "5c5d0c2b6171f33362bec4c2c74194a89c198409",
            "filename": "lib/internal/process/coverage.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fprocess%2Fcoverage.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/lib%2Finternal%2Fprocess%2Fcoverage.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fprocess%2Fcoverage.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -51,7 +51,7 @@ function disableAllAsyncHooks() {\n exports.writeCoverage = writeCoverage;\n \n function setup() {\n-  const { Connection } = process.binding('inspector');\n+  const { Connection } = internalBinding('inspector');\n   if (!Connection) {\n     console.warn('inspector not enabled');\n     return;"
        },
        {
            "sha": "0bf43c6fbb1a81b7666308c5b7f0ce1250994638",
            "filename": "src/inspector_js_api.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/src%2Finspector_js_api.cc",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/src%2Finspector_js_api.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector_js_api.cc?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -315,5 +315,5 @@ void Initialize(Local<Object> target, Local<Value> unused,\n }  // namespace inspector\n }  // namespace node\n \n-NODE_BUILTIN_MODULE_CONTEXT_AWARE(inspector,\n+NODE_MODULE_CONTEXT_AWARE_INTERNAL(inspector,\n                                   node::inspector::Initialize);"
        },
        {
            "sha": "7e1a904e52740d22c44430eb5d6f8fa211b8e2d1",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -2145,5 +2145,5 @@ int Start(int argc, char** argv) {\n #if !HAVE_INSPECTOR\n void Initialize() {}\n \n-NODE_BUILTIN_MODULE_CONTEXT_AWARE(inspector, Initialize)\n+NODE_MODULE_CONTEXT_AWARE_INTERNAL(inspector, Initialize)\n #endif  // !HAVE_INSPECTOR"
        },
        {
            "sha": "dafac9476922ab444eb2865f09d3785ab32d0805",
            "filename": "test/parallel/test-process-binding-internalbinding-whitelist.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/test%2Fparallel%2Ftest-process-binding-internalbinding-whitelist.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/test%2Fparallel%2Ftest-process-binding-internalbinding-whitelist.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-binding-internalbinding-whitelist.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -17,3 +17,4 @@ assert(process.binding('spawn_sync'));\n assert(process.binding('js_stream'));\n assert(process.binding('buffer'));\n assert(process.binding('fs'));\n+assert(process.binding('inspector'));"
        },
        {
            "sha": "6a6bf1b407e50f9f13f611e117891ec038eaea26",
            "filename": "test/sequential/test-async-wrap-getasyncid.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/05002373176e8758c8c604f06659e171de4ca902/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "raw_url": "https://github.com/nodejs/node/raw/05002373176e8758c8c604f06659e171de4ca902/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-async-wrap-getasyncid.js?ref=05002373176e8758c8c604f06659e171de4ca902",
            "patch": "@@ -291,7 +291,7 @@ if (common.hasCrypto) { // eslint-disable-line node-core/crypto-check\n \n if (process.config.variables.v8_enable_inspector !== 0 &&\n     common.isMainThread) {\n-  const binding = process.binding('inspector');\n+  const binding = internalBinding('inspector');\n   const handle = new binding.Connection(() => {});\n   testInitialized(handle, 'Connection');\n   handle.disconnect();"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 12,
        "deletions": 10
    }
}