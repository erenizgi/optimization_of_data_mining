{
    "author": "starkwang",
    "message": "repl: fix tab completion for object properties with special char\n\nThe old RegExp will pass property names like `\"hello world!\"`\nwhen filtering the results of tab complete. This change is to\nfix it.\n\nFixes: https://github.com/nodejs/node/issues/21201\n\nPR-URL: https://github.com/nodejs/node/pull/21556\nFixes: https://github.com/nodejs/node/issues/21201\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: John-David Dalton <john.david.dalton@gmail.com>",
    "sha": "4f151228472d80a4583f90aeeaaec1bdc4446fe0",
    "files": [
        {
            "sha": "6345c742f68f334321f40538b36f2f1af6bc595e",
            "filename": "lib/repl.js",
            "status": "modified",
            "additions": 24,
            "deletions": 4,
            "changes": 28,
            "blob_url": "https://github.com/nodejs/node/blob/4f151228472d80a4583f90aeeaaec1bdc4446fe0/lib%2Frepl.js",
            "raw_url": "https://github.com/nodejs/node/raw/4f151228472d80a4583f90aeeaaec1bdc4446fe0/lib%2Frepl.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Frepl.js?ref=4f151228472d80a4583f90aeeaaec1bdc4446fe0",
            "patch": "@@ -47,6 +47,10 @@ const {\n   makeRequireFunction,\n   addBuiltinLibsToObject\n } = require('internal/modules/cjs/helpers');\n+const {\n+  isIdentifierStart,\n+  isIdentifierChar\n+} = require('internal/deps/acorn/dist/acorn');\n const internalUtil = require('internal/util');\n const { isTypedArray } = require('internal/util/types');\n const util = require('util');\n@@ -900,9 +904,25 @@ const requireRE = /\\brequire\\s*\\(['\"](([\\w@./-]+\\/)?(?:[\\w@./-]*))/;\n const simpleExpressionRE =\n     /(?:[a-zA-Z_$](?:\\w|\\$)*\\.)*[a-zA-Z_$](?:\\w|\\$)*\\.?$/;\n \n-function intFilter(item) {\n-  // filters out anything not starting with A-Z, a-z, $ or _\n-  return /^[A-Za-z_$]/.test(item);\n+function isIdentifier(str) {\n+  if (str === '') {\n+    return false;\n+  }\n+  const first = str.codePointAt(0);\n+  if (!isIdentifierStart(first)) {\n+    return false;\n+  }\n+  const firstLen = first > 0xffff ? 2 : 1;\n+  for (var i = firstLen; i < str.length; i += 1) {\n+    const cp = str.codePointAt(i);\n+    if (!isIdentifierChar(cp)) {\n+      return false;\n+    }\n+    if (cp > 0xffff) {\n+      i += 1;\n+    }\n+  }\n+  return true;\n }\n \n const ARRAY_LENGTH_THRESHOLD = 1e6;\n@@ -932,7 +952,7 @@ function filteredOwnPropertyNames(obj) {\n \n     return fakeProperties;\n   }\n-  return Object.getOwnPropertyNames(obj).filter(intFilter);\n+  return Object.getOwnPropertyNames(obj).filter(isIdentifier);\n }\n \n function getGlobalLexicalScopeNames(contextId) {"
        },
        {
            "sha": "0e6c4bb654910ed5c87af35adf21194fd7d6df44",
            "filename": "test/parallel/test-repl-tab-complete.js",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/4f151228472d80a4583f90aeeaaec1bdc4446fe0/test%2Fparallel%2Ftest-repl-tab-complete.js",
            "raw_url": "https://github.com/nodejs/node/raw/4f151228472d80a4583f90aeeaaec1bdc4446fe0/test%2Fparallel%2Ftest-repl-tab-complete.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-repl-tab-complete.js?ref=4f151228472d80a4583f90aeeaaec1bdc4446fe0",
            "patch": "@@ -369,6 +369,12 @@ putIn.run(['.clear']);\n testMe.complete('.b', common.mustCall((error, data) => {\n   assert.deepStrictEqual(data, [['break'], 'b']);\n }));\n+putIn.run(['.clear']);\n+putIn.run(['var obj = {\"hello, world!\": \"some string\", \"key\": 123}']);\n+testMe.complete('obj.', common.mustCall((error, data) => {\n+  assert.strictEqual(data[0].includes('obj.hello, world!'), false);\n+  assert(data[0].includes('obj.key'));\n+}));\n \n // tab completion for large buffer\n const warningRegEx = new RegExp("
        }
    ],
    "stats": {
        "total": 34,
        "additions": 30,
        "deletions": 4
    }
}