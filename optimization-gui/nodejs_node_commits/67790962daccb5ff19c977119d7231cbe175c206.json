{
    "author": "darai0512",
    "message": "https: defines maxHeadersCount in the constructor\n\nIn Refs, http.Server's maxHeadersCount field was defined in the\nconstructor to make hidden class stable and so on. Also in https.Server,\nwe can use maxHeadersCount the same as http via connectionListener. So,\ndefines it in the constructor and documentation.\n\nRefs: https://github.com/nodejs/node/pull/9116\n\nPR-URL: https://github.com/nodejs/node/pull/20359\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "67790962daccb5ff19c977119d7231cbe175c206",
    "files": [
        {
            "sha": "4fdd2fe7bc8111fd2f88c5d4402f7dfdd157c960",
            "filename": "doc/api/https.md",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/67790962daccb5ff19c977119d7231cbe175c206/doc%2Fapi%2Fhttps.md",
            "raw_url": "https://github.com/nodejs/node/raw/67790962daccb5ff19c977119d7231cbe175c206/doc%2Fapi%2Fhttps.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fhttps.md?ref=67790962daccb5ff19c977119d7231cbe175c206",
            "patch": "@@ -36,6 +36,13 @@ See [`server.close()`][`http.close()`] from the HTTP module for details.\n Starts the HTTPS server listening for encrypted connections.\n This method is identical to [`server.listen()`][] from [`net.Server`][].\n \n+\n+### server.maxHeadersCount\n+\n+- {number} **Default:** `2000`\n+\n+See [`http.Server#maxHeadersCount`][].\n+\n ### server.setTimeout([msecs][, callback])\n <!-- YAML\n added: v0.11.2\n@@ -348,6 +355,7 @@ headers: max-age=0; pin-sha256=\"WoiWRyIOVNa9ihaBciRSC7XHjliYS9VwUGOIud4PB18=\"; p\n [`URL`]: url.html#url_the_whatwg_url_api\n [`http.Agent`]: http.html#http_class_http_agent\n [`http.Server#keepAliveTimeout`]: http.html#http_server_keepalivetimeout\n+[`http.Server#maxHeadersCount`]: http.html#http_server_maxheaderscount\n [`http.Server#setTimeout()`]: http.html#http_server_settimeout_msecs_callback\n [`http.Server#timeout`]: http.html#http_server_timeout\n [`http.Server`]: http.html#http_class_http_server"
        },
        {
            "sha": "169c61900cff1cf3f8707de9420da19159c46805",
            "filename": "lib/https.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/67790962daccb5ff19c977119d7231cbe175c206/lib%2Fhttps.js",
            "raw_url": "https://github.com/nodejs/node/raw/67790962daccb5ff19c977119d7231cbe175c206/lib%2Fhttps.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fhttps.js?ref=67790962daccb5ff19c977119d7231cbe175c206",
            "patch": "@@ -73,6 +73,7 @@ function Server(opts, requestListener) {\n \n   this.timeout = 2 * 60 * 1000;\n   this.keepAliveTimeout = 5000;\n+  this.maxHeadersCount = null;\n }\n inherits(Server, tls.Server);\n "
        },
        {
            "sha": "8c099d1e5fb8412adef237f5c9a2a88122f3d6a7",
            "filename": "test/parallel/test-https-max-headers-count.js",
            "status": "added",
            "additions": 73,
            "deletions": 0,
            "changes": 73,
            "blob_url": "https://github.com/nodejs/node/blob/67790962daccb5ff19c977119d7231cbe175c206/test%2Fparallel%2Ftest-https-max-headers-count.js",
            "raw_url": "https://github.com/nodejs/node/raw/67790962daccb5ff19c977119d7231cbe175c206/test%2Fparallel%2Ftest-https-max-headers-count.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-https-max-headers-count.js?ref=67790962daccb5ff19c977119d7231cbe175c206",
            "patch": "@@ -0,0 +1,73 @@\n+'use strict';\n+const common = require('../common');\n+const fixtures = require('../common/fixtures');\n+\n+if (!common.hasCrypto)\n+  common.skip('missing crypto');\n+\n+const assert = require('assert');\n+const https = require('https');\n+\n+const serverOptions = {\n+  key: fixtures.readKey('agent1-key.pem'),\n+  cert: fixtures.readKey('agent1-cert.pem')\n+};\n+\n+let requests = 0;\n+let responses = 0;\n+\n+const headers = {};\n+const N = 2000;\n+for (let i = 0; i < N; ++i) {\n+  headers[`key${i}`] = i;\n+}\n+\n+const maxAndExpected = [ // for server\n+  [50, 50],\n+  [1500, 1500],\n+  [0, N + 2] // Host and Connection\n+];\n+let max = maxAndExpected[requests][0];\n+let expected = maxAndExpected[requests][1];\n+\n+const server = https.createServer(serverOptions, common.mustCall((req, res) => {\n+  assert.strictEqual(Object.keys(req.headers).length, expected);\n+  if (++requests < maxAndExpected.length) {\n+    max = maxAndExpected[requests][0];\n+    expected = maxAndExpected[requests][1];\n+    server.maxHeadersCount = max;\n+  }\n+  res.writeHead(200, headers);\n+  res.end();\n+}, 3));\n+server.maxHeadersCount = max;\n+\n+server.listen(0, common.mustCall(() => {\n+  const maxAndExpected = [ // for client\n+    [20, 20],\n+    [1200, 1200],\n+    [0, N + 3] // Connection, Date and Transfer-Encoding\n+  ];\n+  const doRequest = common.mustCall(() => {\n+    const max = maxAndExpected[responses][0];\n+    const expected = maxAndExpected[responses][1];\n+    const req = https.request({\n+      port: server.address().port,\n+      headers: headers,\n+      rejectUnauthorized: false\n+    }, (res) => {\n+      assert.strictEqual(Object.keys(res.headers).length, expected);\n+      res.on('end', () => {\n+        if (++responses < maxAndExpected.length) {\n+          doRequest();\n+        } else {\n+          server.close();\n+        }\n+      });\n+      res.resume();\n+    });\n+    req.maxHeadersCount = max;\n+    req.end();\n+  }, 3);\n+  doRequest();\n+}));"
        }
    ],
    "stats": {
        "total": 82,
        "additions": 82,
        "deletions": 0
    }
}