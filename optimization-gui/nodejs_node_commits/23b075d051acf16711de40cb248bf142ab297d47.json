{
    "author": "addaleax",
    "message": "deps: V8: cherry-pick d3308d0\n\nOriginal commit message:\n\n    [api] Add `Isolate::GetArrayBufferAllocator()`\n\n    This allows non-monolithic embedders to always allocate memory\n    for ArrayBuffer instances using the right allocation method.\n\n    This is based on a patch that Electron is currently using.\n\n    Refs: https://github.com/electron/electron/blob/1898f9162073910c05958295c612deec6121a892/patches/common/v8/array_buffer.patch\n    Change-Id: I39a614343118a0594aab48699a99cc2aad5b7ba9\n    Reviewed-on: https://chromium-review.googlesource.com/c/1462003\n    Reviewed-by: Yang Guo <yangguo@chromium.org>\n    Commit-Queue: Yang Guo <yangguo@chromium.org>\n    Cr-Commit-Position: refs/heads/master@{#59697}\n\nRefs: https://github.com/v8/v8/commit/d3308d042c9637958491333831c33335ab9fc734\n\nPR-URL: https://github.com/nodejs/node/pull/26207\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "23b075d051acf16711de40cb248bf142ab297d47",
    "files": [
        {
            "sha": "0f0eb2e739a9818f61e4894b1cd01cce152f5274",
            "filename": "deps/v8/include/v8.h",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/23b075d051acf16711de40cb248bf142ab297d47/deps%2Fv8%2Finclude%2Fv8.h",
            "raw_url": "https://github.com/nodejs/node/raw/23b075d051acf16711de40cb248bf142ab297d47/deps%2Fv8%2Finclude%2Fv8.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Finclude%2Fv8.h?ref=23b075d051acf16711de40cb248bf142ab297d47",
            "patch": "@@ -7642,6 +7642,9 @@ class V8_EXPORT Isolate {\n    */\n   void SetIdle(bool is_idle);\n \n+  /** Returns the ArrayBuffer::Allocator used in this isolate. */\n+  ArrayBuffer::Allocator* GetArrayBufferAllocator();\n+\n   /** Returns true if this isolate has a current context. */\n   bool InContext();\n "
        },
        {
            "sha": "40e8b41e69cce5f5167721ebba54a55f8a863308",
            "filename": "deps/v8/src/api.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/23b075d051acf16711de40cb248bf142ab297d47/deps%2Fv8%2Fsrc%2Fapi.cc",
            "raw_url": "https://github.com/nodejs/node/raw/23b075d051acf16711de40cb248bf142ab297d47/deps%2Fv8%2Fsrc%2Fapi.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fapi.cc?ref=23b075d051acf16711de40cb248bf142ab297d47",
            "patch": "@@ -8007,6 +8007,11 @@ void Isolate::SetIdle(bool is_idle) {\n   isolate->SetIdle(is_idle);\n }\n \n+ArrayBuffer::Allocator* Isolate::GetArrayBufferAllocator() {\n+  i::Isolate* isolate = reinterpret_cast<i::Isolate*>(this);\n+  return isolate->array_buffer_allocator();\n+}\n+\n bool Isolate::InContext() {\n   i::Isolate* isolate = reinterpret_cast<i::Isolate*>(this);\n   return isolate->context() != nullptr;"
        },
        {
            "sha": "70763547ea86ae53113be70086911219e4b591a7",
            "filename": "deps/v8/test/cctest/test-api.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/23b075d051acf16711de40cb248bf142ab297d47/deps%2Fv8%2Ftest%2Fcctest%2Ftest-api.cc",
            "raw_url": "https://github.com/nodejs/node/raw/23b075d051acf16711de40cb248bf142ab297d47/deps%2Fv8%2Ftest%2Fcctest%2Ftest-api.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fcctest%2Ftest-api.cc?ref=23b075d051acf16711de40cb248bf142ab297d47",
            "patch": "@@ -20881,6 +20881,7 @@ TEST(IsolateNewDispose) {\n   CHECK_NOT_NULL(isolate);\n   CHECK(current_isolate != isolate);\n   CHECK(current_isolate == CcTest::isolate());\n+  CHECK(isolate->GetArrayBufferAllocator() == CcTest::array_buffer_allocator());\n \n   isolate->SetFatalErrorHandler(StoringErrorCallback);\n   last_location = last_message = nullptr;"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 9,
        "deletions": 0
    }
}