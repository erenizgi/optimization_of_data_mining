{
    "author": "jasnell",
    "message": "fs: lazy load the promises impl\n\nPR-URL: https://github.com/nodejs/node/pull/20766\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Minwoo Jung <minwoo@nodesource.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "11aea015efc6b7fb9d10cb4e17e48a282ec0cab8",
    "files": [
        {
            "sha": "0d9387598edc4dcbe02d502c2226f72e30c676f8",
            "filename": "lib/fs.js",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/11aea015efc6b7fb9d10cb4e17e48a282ec0cab8/lib%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/11aea015efc6b7fb9d10cb4e17e48a282ec0cab8/lib%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs.js?ref=11aea015efc6b7fb9d10cb4e17e48a282ec0cab8",
            "patch": "@@ -60,7 +60,6 @@ const { Readable, Writable } = require('stream');\n const EventEmitter = require('events');\n const { FSReqWrap, statValues, kFsStatsFieldsLength } = binding;\n const { FSEvent } = process.binding('fs_event_wrap');\n-const promises = require('internal/fs/promises');\n const internalFS = require('internal/fs/utils');\n const { getPathFromURL } = require('internal/url');\n const internalUtil = require('internal/util');\n@@ -91,14 +90,18 @@ const {\n   validateUint32\n } = require('internal/validators');\n \n-let warn = true;\n+// Lazy loaded\n+let promises;\n+\n+let promisesWarn = true;\n \n Object.defineProperty(fs, 'promises', {\n   configurable: true,\n   enumerable: false,\n   get() {\n-    if (warn) {\n-      warn = false;\n+    if (promisesWarn) {\n+      promises = require('internal/fs/promises');\n+      promisesWarn = false;\n       process.emitWarning('The fs.promises API is experimental',\n                           'ExperimentalWarning');\n     }"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 7,
        "deletions": 4
    }
}