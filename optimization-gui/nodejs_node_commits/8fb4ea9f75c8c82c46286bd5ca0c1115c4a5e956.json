{
    "author": "danbev",
    "message": "test: add deprecation code to expectWarning\n\nThis commit adds a deprecation code to expectWarning and updates the\nfunction to check the passed code against the code property on the\nwarning object.\n\nNot all warnings have a deprecation code so for those that don't an\nexplicit code of common.noWarnCode is required. Passing this skips the\nassertion of the code.\n\nPR-URL: https://github.com/nodejs/node/pull/19474\nReviewed-By: Michaël Zasso <targos@protonmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Tobias Nießen <tniessen@tnie.de>",
    "sha": "8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
    "files": [
        {
            "sha": "765ebe01231a72dad6164d672b640d409de259a9",
            "filename": "test/common/README.md",
            "status": "modified",
            "additions": 8,
            "deletions": 2,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fcommon%2FREADME.md",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fcommon%2FREADME.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2FREADME.md?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -108,11 +108,17 @@ Indicates if there is more than 1gb of total memory.\n   returned function has not been called exactly `exact` number of times when the\n   test is complete, then the test will fail.\n \n-### expectWarning(name, expected)\n+### expectWarning(name, expected, code)\n * `name` [&lt;string>]\n * `expected` [&lt;string>] | [&lt;Array>]\n+* `code` [&lt;string>]\n \n-Tests whether `name` and `expected` are part of a raised warning.\n+Tests whether `name`, `expected`, and `code` are part of a raised warning. If\n+an expected warning does not have a code then `common.noWarnCode` can be used\n+to indicate this.\n+\n+### noWarnCode\n+See `common.expectWarning()` for usage.\n \n ### fileExists(pathname)\n * pathname [&lt;string>]"
        },
        {
            "sha": "f13e61df8c8f81621402c64041745b0be7a8251e",
            "filename": "test/common/index.js",
            "status": "modified",
            "additions": 29,
            "deletions": 10,
            "changes": 39,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fcommon%2Findex.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fcommon%2Findex.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Findex.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -611,20 +611,32 @@ exports.isAlive = function isAlive(pid) {\n   }\n };\n \n-function expectWarning(name, expectedMessages) {\n+exports.noWarnCode = 'no_expected_warning_code';\n+\n+function expectWarning(name, expected) {\n+  const map = new Map(expected);\n   return exports.mustCall((warning) => {\n     assert.strictEqual(warning.name, name);\n-    assert.ok(expectedMessages.includes(warning.message),\n+    assert.ok(map.has(warning.message),\n               `unexpected error message: \"${warning.message}\"`);\n+    const code = map.get(warning.message);\n+    if (code === undefined) {\n+      throw new Error('An error code must be specified or use ' +\n+      'common.noWarnCode if there is no error code. The error  ' +\n+      `code for this warning was ${warning.code}`);\n+    }\n+    if (code !== exports.noWarnCode) {\n+      assert.strictEqual(warning.code, code);\n+    }\n     // Remove a warning message after it is seen so that we guarantee that we\n     // get each message only once.\n-    expectedMessages.splice(expectedMessages.indexOf(warning.message), 1);\n-  }, expectedMessages.length);\n+    map.delete(expected);\n+  }, map.size);\n }\n \n-function expectWarningByName(name, expected) {\n+function expectWarningByName(name, expected, code) {\n   if (typeof expected === 'string') {\n-    expected = [expected];\n+    expected = [[expected, code]];\n   }\n   process.on('warning', expectWarning(name, expected));\n }\n@@ -633,8 +645,15 @@ function expectWarningByMap(warningMap) {\n   const catchWarning = {};\n   Object.keys(warningMap).forEach((name) => {\n     let expected = warningMap[name];\n-    if (typeof expected === 'string') {\n-      expected = [expected];\n+    if (!Array.isArray(expected)) {\n+      throw new Error('warningMap entries must be arrays consisting of two ' +\n+      'entries: [message, warningCode]');\n+    }\n+    if (!(Array.isArray(expected[0]))) {\n+      if (expected.length === 0) {\n+        return;\n+      }\n+      expected = [[expected[0], expected[1]]];\n     }\n     catchWarning[name] = expectWarning(name, expected);\n   });\n@@ -644,9 +663,9 @@ function expectWarningByMap(warningMap) {\n // accepts a warning name and description or array of descriptions or a map\n // of warning names to description(s)\n // ensures a warning is generated for each name/description pair\n-exports.expectWarning = function(nameOrMap, expected) {\n+exports.expectWarning = function(nameOrMap, expected, code) {\n   if (typeof nameOrMap === 'string') {\n-    expectWarningByName(nameOrMap, expected);\n+    expectWarningByName(nameOrMap, expected, code);\n   } else {\n     expectWarningByMap(nameOrMap);\n   }"
        },
        {
            "sha": "68ebcd612d31df7112e5cde29fe5609fc58d9a91",
            "filename": "test/parallel/test-assert-fail-deprecation.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-assert-fail-deprecation.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-assert-fail-deprecation.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-assert-fail-deprecation.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -6,7 +6,8 @@ const assert = require('assert');\n common.expectWarning(\n   'DeprecationWarning',\n   'assert.fail() with more than one argument is deprecated. ' +\n-    'Please use assert.strictEqual() instead or only pass a message.'\n+    'Please use assert.strictEqual() instead or only pass a message.',\n+  'DEP0094'\n );\n \n // Two args only, operator defaults to '!='"
        },
        {
            "sha": "15b5a5140e184aeb99eb3acf065066a1f94f39f2",
            "filename": "test/parallel/test-buffer-pending-deprecation.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-buffer-pending-deprecation.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-buffer-pending-deprecation.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-buffer-pending-deprecation.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -9,7 +9,7 @@ const bufferWarning = 'The Buffer() and new Buffer() constructors are not ' +\n                       'Buffer.allocUnsafe(), or Buffer.from() construction ' +\n                       'methods instead.';\n \n-common.expectWarning('DeprecationWarning', bufferWarning);\n+common.expectWarning('DeprecationWarning', bufferWarning, 'DEP0005');\n \n // This is used to make sure that a warning is only emitted once even though\n // `new Buffer()` is called twice."
        },
        {
            "sha": "fbfc8776a3777747d6cab1686c61afd63b78db3a",
            "filename": "test/parallel/test-child-process-custom-fds.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-child-process-custom-fds.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-child-process-custom-fds.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-child-process-custom-fds.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -9,7 +9,7 @@ const oldSpawnSync = internalCp.spawnSync;\n {\n   const msg = 'child_process: options.customFds option is deprecated. ' +\n               'Use options.stdio instead.';\n-  common.expectWarning('DeprecationWarning', msg);\n+  common.expectWarning('DeprecationWarning', msg, 'DEP0006');\n \n   const customFds = [-1, process.stdout.fd, process.stderr.fd];\n   internalCp.spawnSync = common.mustCall(function(opts) {"
        },
        {
            "sha": "9979a1b861d7fcc58ad0e84ffd7ecfa46cf9dbc3",
            "filename": "test/parallel/test-crypto-authenticated.js",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-crypto-authenticated.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-crypto-authenticated.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-authenticated.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -336,13 +336,16 @@ const errMessages = {\n const ciphers = crypto.getCiphers();\n \n const expectedWarnings = common.hasFipsCrypto ?\n-  [] : ['Use Cipheriv for counter mode of aes-192-gcm'];\n+  [] : [['Use Cipheriv for counter mode of aes-192-gcm',\n+         common.noWarnCode]];\n \n const expectedDeprecationWarnings = [0, 1, 2, 6, 9, 10, 11, 17]\n-  .map((i) => `Permitting authentication tag lengths of ${i} bytes is ` +\n-            'deprecated. Valid GCM tag lengths are 4, 8, 12, 13, 14, 15, 16.');\n+  .map((i) => [`Permitting authentication tag lengths of ${i} bytes is ` +\n+            'deprecated. Valid GCM tag lengths are 4, 8, 12, 13, 14, 15, 16.',\n+               'DEP0090']);\n \n-expectedDeprecationWarnings.push('crypto.DEFAULT_ENCODING is deprecated.');\n+expectedDeprecationWarnings.push(['crypto.DEFAULT_ENCODING is deprecated.',\n+                                  'DEP0091']);\n \n common.expectWarning({\n   Warning: expectedWarnings,"
        },
        {
            "sha": "89d070aaa8255aa4fa8bfa4e7d6b4c74e8bb5ddc",
            "filename": "test/parallel/test-crypto-cipher-decipher.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-crypto-cipher-decipher.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-crypto-cipher-decipher.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-cipher-decipher.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -236,7 +236,8 @@ testCipher2(Buffer.from('0123456789abcdef'));\n   const data = Buffer.from('test-crypto-cipher-decipher');\n \n   common.expectWarning('Warning',\n-                       'Use Cipheriv for counter mode of aes-256-gcm');\n+                       'Use Cipheriv for counter mode of aes-256-gcm',\n+                       common.noWarnCode);\n \n   const cipher = crypto.createCipher('aes-256-gcm', key);\n   cipher.setAAD(aadbuf);"
        },
        {
            "sha": "2a9246a2e0bb4c9a5adcaca64258cfe6155d1ac9",
            "filename": "test/parallel/test-crypto-deprecated.js",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-crypto-deprecated.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-crypto-deprecated.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-deprecated.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -8,10 +8,12 @@ const crypto = require('crypto');\n const tls = require('tls');\n \n common.expectWarning('DeprecationWarning', [\n-  'crypto.Credentials is deprecated. Use tls.SecureContext instead.',\n-  'crypto.createCredentials is deprecated. Use tls.createSecureContext ' +\n-  'instead.',\n-  'crypto.Decipher.finaltol is deprecated. Use crypto.Decipher.final instead.'\n+  ['crypto.Credentials is deprecated. Use tls.SecureContext instead.',\n+   'DEP0011'],\n+  ['crypto.createCredentials is deprecated. Use tls.createSecureContext ' +\n+  'instead.', 'DEP0010'],\n+  ['crypto.Decipher.finaltol is deprecated. Use crypto.Decipher.final instead.',\n+   'DEP0105']\n ]);\n \n // Accessing the deprecated function is enough to trigger the warning event."
        },
        {
            "sha": "8ddc11ec3e0e076d7359fe112ec529787adfce24",
            "filename": "test/parallel/test-fs-filehandle.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-fs-filehandle.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-fs-filehandle.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-filehandle.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -20,7 +20,8 @@ let fdnum;\n \n common.expectWarning(\n   'Warning',\n-  `Closing file descriptor ${fdnum} on garbage collection`\n+  `Closing file descriptor ${fdnum} on garbage collection`,\n+  common.noWarnCode\n );\n \n gc();  // eslint-disable-line no-undef"
        },
        {
            "sha": "62634aed1d91a7c2e4a7e23b9a1084a6fb6c8f65",
            "filename": "test/parallel/test-fs-truncate-fd.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-fs-truncate-fd.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-fs-truncate-fd.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-truncate-fd.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -15,7 +15,7 @@ const msg = 'Using fs.truncate with a file descriptor is deprecated.' +\n ' Please use fs.ftruncate with a file descriptor instead.';\n \n \n-common.expectWarning('DeprecationWarning', msg);\n+common.expectWarning('DeprecationWarning', msg, 'DEP0081');\n fs.truncate(fd, 5, common.mustCall(function(err) {\n   assert.ok(!err);\n   assert.strictEqual(fs.readFileSync(filename, 'utf8'), 'hello');"
        },
        {
            "sha": "62da52b38e1dc3e2fc6d7611640fcb69731a33bf",
            "filename": "test/parallel/test-fs-truncate.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-fs-truncate.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-fs-truncate.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-truncate.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -64,8 +64,8 @@ fs.ftruncateSync(fd);\n stat = fs.statSync(filename);\n assert.strictEqual(stat.size, 0);\n \n-// Check truncateSync\n-common.expectWarning('DeprecationWarning', msg);\n+// truncateSync\n+common.expectWarning('DeprecationWarning', msg, 'DEP0081');\n fs.truncateSync(fd);\n \n fs.closeSync(fd);"
        },
        {
            "sha": "9e1213ada558c3b74efe1b8d9cf2cca04f9a6a7b",
            "filename": "test/parallel/test-net-server-connections.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-net-server-connections.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-net-server-connections.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-net-server-connections.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -30,7 +30,7 @@ const server = new net.Server();\n const expectedWarning = 'Server.connections property is deprecated. ' +\n                         'Use Server.getConnections method instead.';\n \n-common.expectWarning('DeprecationWarning', expectedWarning);\n+common.expectWarning('DeprecationWarning', expectedWarning, 'DEP0020');\n \n // test that server.connections property is no longer enumerable now that it\n // has been marked as deprecated"
        },
        {
            "sha": "6a7d6f7b944cf63c091e6374dce2fa9fc072ceac",
            "filename": "test/parallel/test-performance-warning.js",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-performance-warning.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-performance-warning.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-performance-warning.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -20,10 +20,10 @@ performance.maxEntries = 1;\n   );\n });\n \n-common.expectWarning('Warning', [\n-  'Possible perf_hooks memory leak detected. There are 2 entries in the ' +\n+common.expectWarning('Warning', 'Possible perf_hooks memory leak detected. ' +\n+  'There are 2 entries in the ' +\n   'Performance Timeline. Use the clear methods to remove entries that are no ' +\n   'longer needed or set performance.maxEntries equal to a higher value ' +\n-  '(currently the maxEntries is 1).']);\n+  '(currently the maxEntries is 1).', common.noWarnCode);\n \n performance.mark('test');"
        },
        {
            "sha": "74792eebb7bd2f20bc9af65bace2bf2240d5c087",
            "filename": "test/parallel/test-process-assert.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-process-assert.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-process-assert.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-assert.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -4,7 +4,8 @@ const assert = require('assert');\n \n common.expectWarning(\n   'DeprecationWarning',\n-  'process.assert() is deprecated. Please use the `assert` module instead.'\n+  'process.assert() is deprecated. Please use the `assert` module instead.',\n+  'DEP0100'\n );\n \n assert.strictEqual(process.assert(1, 'error'), undefined);"
        },
        {
            "sha": "d3e2454ada3f09b6752f8e1e2a711f541b2ab175",
            "filename": "test/parallel/test-process-emit-warning-from-native.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-process-emit-warning-from-native.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-process-emit-warning-from-native.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-emit-warning-from-native.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -12,7 +12,8 @@ const key = '0123456789';\n \n {\n   common.expectWarning('Warning',\n-                       'Use Cipheriv for counter mode of aes-256-gcm');\n+                       'Use Cipheriv for counter mode of aes-256-gcm',\n+                       common.noWarnCode);\n \n   // Emits regular warning expected by expectWarning()\n   crypto.createCipher('aes-256-gcm', key);"
        },
        {
            "sha": "68817b320b4717d8d4e7349477e6303d2c0e029b",
            "filename": "test/parallel/test-process-env-deprecation.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-process-env-deprecation.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-process-env-deprecation.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-env-deprecation.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -8,7 +8,8 @@ common.expectWarning(\n   'DeprecationWarning',\n   'Assigning any value other than a string, number, or boolean to a ' +\n   'process.env property is deprecated. Please make sure to convert the value ' +\n-  'to a string before setting process.env with it.'\n+  'to a string before setting process.env with it.',\n+  'DEP0104'\n );\n \n process.env.ABC = undefined;"
        },
        {
            "sha": "dfd1ee322a64438ff47b313312215a7204ba44aa",
            "filename": "test/parallel/test-promises-unhandled-proxy-rejections.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-promises-unhandled-proxy-rejections.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-promises-unhandled-proxy-rejections.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-promises-unhandled-proxy-rejections.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -1,16 +1,16 @@\n 'use strict';\n const common = require('../common');\n \n-const expectedDeprecationWarning = 'Unhandled promise rejections are ' +\n+const expectedDeprecationWarning = ['Unhandled promise rejections are ' +\n                                    'deprecated. In the future, promise ' +\n                                    'rejections that are not handled will ' +\n                                    'terminate the Node.js process with a ' +\n-                                   'non-zero exit code.';\n-const expectedPromiseWarning = 'Unhandled promise rejection. ' +\n+                                   'non-zero exit code.', 'DEP0018'];\n+const expectedPromiseWarning = ['Unhandled promise rejection. ' +\n   'This error originated either by throwing ' +\n   'inside of an async function without a catch ' +\n   'block, or by rejecting a promise which was ' +\n-  'not handled with .catch(). (rejection id: 1)';\n+  'not handled with .catch(). (rejection id: 1)', common.noWarnCode];\n \n function throwErr() {\n   throw new Error('Error from proxy');"
        },
        {
            "sha": "5c028a74c24e903d93ff4230de93b7e0d88ad31c",
            "filename": "test/parallel/test-promises-unhandled-symbol-rejections.js",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-promises-unhandled-symbol-rejections.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-promises-unhandled-symbol-rejections.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-promises-unhandled-symbol-rejections.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -1,17 +1,17 @@\n 'use strict';\n const common = require('../common');\n \n-const expectedValueWarning = 'Symbol()';\n-const expectedDeprecationWarning = 'Unhandled promise rejections are ' +\n+const expectedValueWarning = ['Symbol()', common.noWarnCode];\n+const expectedDeprecationWarning = ['Unhandled promise rejections are ' +\n                                    'deprecated. In the future, promise ' +\n                                    'rejections that are not handled will ' +\n                                    'terminate the Node.js process with a ' +\n-                                   'non-zero exit code.';\n-const expectedPromiseWarning = 'Unhandled promise rejection. ' +\n+                                   'non-zero exit code.', common.noWarnCode];\n+const expectedPromiseWarning = ['Unhandled promise rejection. ' +\n   'This error originated either by throwing ' +\n   'inside of an async function without a catch ' +\n   'block, or by rejecting a promise which was ' +\n-  'not handled with .catch(). (rejection id: 1)';\n+  'not handled with .catch(). (rejection id: 1)', common.noWarnCode];\n \n common.expectWarning({\n   DeprecationWarning: expectedDeprecationWarning,"
        },
        {
            "sha": "dbd50eb469f15ad1d193a698c077833a787d8504",
            "filename": "test/parallel/test-repl-deprecations.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-repl-deprecations.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-repl-deprecations.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-repl-deprecations.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -9,7 +9,7 @@ function testParseREPLKeyword() {\n   const server = repl.start({ prompt: '> ' });\n   const warn = 'REPLServer.parseREPLKeyword() is deprecated';\n \n-  common.expectWarning('DeprecationWarning', warn);\n+  common.expectWarning('DeprecationWarning', warn, 'DEP0075');\n   assert.ok(server.parseREPLKeyword('clear'));\n   assert.ok(!server.parseREPLKeyword('tacos'));\n   server.close();"
        },
        {
            "sha": "07d377d8fbf9fcee72afd8192b8eda1bffa44537",
            "filename": "test/parallel/test-repl-memory-deprecation.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-repl-memory-deprecation.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-repl-memory-deprecation.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-repl-memory-deprecation.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -9,7 +9,7 @@ function testMemory() {\n   const server = repl.start({ prompt: '> ' });\n   const warn = 'REPLServer.memory() is deprecated';\n \n-  common.expectWarning('DeprecationWarning', warn);\n+  common.expectWarning('DeprecationWarning', warn, 'DEP0082');\n   assert.strictEqual(server.memory(), undefined);\n   server.close();\n }"
        },
        {
            "sha": "a966899b2c63910fb95a8f0213816478b4522bfb",
            "filename": "test/parallel/test-repl-turn-off-editor-mode.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-repl-turn-off-editor-mode.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-repl-turn-off-editor-mode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-repl-turn-off-editor-mode.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -8,7 +8,7 @@ function testTurnOffEditorMode() {\n   const server = repl.start({ prompt: '> ' });\n   const warn = 'REPLServer.turnOffEditorMode() is deprecated';\n \n-  common.expectWarning('DeprecationWarning', warn);\n+  common.expectWarning('DeprecationWarning', warn, 'DEP0078');\n   server.turnOffEditorMode();\n   server.close();\n }"
        },
        {
            "sha": "24a2e86e6a42ee3846b6b689b8eb1bde430b62e0",
            "filename": "test/parallel/test-require-deps-deprecation.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-require-deps-deprecation.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-require-deps-deprecation.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-require-deps-deprecation.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -29,8 +29,8 @@ const deps = [\n ];\n \n common.expectWarning('DeprecationWarning', deprecatedModules.map((m) => {\n-  return `Requiring Node.js-bundled '${m}' module is deprecated. ` +\n-         'Please install the necessary module locally.';\n+  return [`Requiring Node.js-bundled '${m}' module is deprecated. ` +\n+         'Please install the necessary module locally.', 'DEP0084'];\n }));\n \n for (const m of deprecatedModules) {"
        },
        {
            "sha": "9fbd8d980c2faccc3a249c1de940bcb5663e2148",
            "filename": "test/parallel/test-tls-dhe.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-tls-dhe.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-tls-dhe.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tls-dhe.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -41,7 +41,8 @@ const ciphers = 'DHE-RSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';\n \n // Test will emit a warning because the DH parameter size is < 2048 bits\n common.expectWarning('SecurityWarning',\n-                     'DH parameter is less than 2048 bits');\n+                     'DH parameter is less than 2048 bits',\n+                     common.noWarnCode);\n \n function loadDHParam(n) {\n   const params = [`dh${n}.pem`];"
        },
        {
            "sha": "1109b71dbe288c2953289d2a0b8754e06cb11462",
            "filename": "test/parallel/test-tls-ecdh-disable.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-tls-ecdh-disable.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-tls-ecdh-disable.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tls-ecdh-disable.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -48,7 +48,8 @@ const options = {\n };\n \n common.expectWarning('DeprecationWarning',\n-                     '{ ecdhCurve: false } is deprecated.');\n+                     '{ ecdhCurve: false } is deprecated.',\n+                     'DEP0083');\n \n const server = tls.createServer(options, common.mustNotCall());\n "
        },
        {
            "sha": "8aa8fd31d2e255093545df36b2e4f369e78173ae",
            "filename": "test/parallel/test-tls-legacy-deprecated.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-tls-legacy-deprecated.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-tls-legacy-deprecated.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tls-legacy-deprecated.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -8,7 +8,8 @@ const tls = require('tls');\n \n common.expectWarning(\n   'DeprecationWarning',\n-  'tls.createSecurePair() is deprecated. Please use tls.TLSSocket instead.'\n+  'tls.createSecurePair() is deprecated. Please use tls.TLSSocket instead.',\n+  'DEP0064'\n );\n \n tls.createSecurePair();"
        },
        {
            "sha": "a0bafe9c52877428f2b8121cf458546e9bcc2f50",
            "filename": "test/parallel/test-tls-parse-cert-string.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-tls-parse-cert-string.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-tls-parse-cert-string.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tls-parse-cert-string.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -59,7 +59,8 @@ common.restoreStderr();\n {\n   common.expectWarning('DeprecationWarning',\n                        'tls.parseCertString() is deprecated. ' +\n-                       'Please use querystring.parse() instead.');\n+                       'Please use querystring.parse() instead.',\n+                       'DEP0076');\n \n   const ret = tls.parseCertString('foo=bar');\n   assert.deepStrictEqual(ret, { __proto__: null, foo: 'bar' });"
        },
        {
            "sha": "476bda4daa7af4fe386a36695a947d3dffde9d23",
            "filename": "test/parallel/test-util-inspect-deprecated.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-util-inspect-deprecated.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-util-inspect-deprecated.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-util-inspect-deprecated.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -11,7 +11,8 @@ const util = require('util');\n   // `common.expectWarning` will expect the warning exactly one time only\n   common.expectWarning(\n     'DeprecationWarning',\n-    'Custom inspection function on Objects via .inspect() is deprecated'\n+    'Custom inspection function on Objects via .inspect() is deprecated',\n+    'DEP0079'\n   );\n   util.inspect(target);  // should emit deprecation warning\n   util.inspect(target);  // should not emit deprecation warning"
        },
        {
            "sha": "ee2fe917f3e5103fd8cf4f1a342dfd251ff94328",
            "filename": "test/parallel/test-util.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-util.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-util.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-util.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -142,10 +142,10 @@ assert.strictEqual(util.isFunction(), false);\n assert.strictEqual(util.isFunction('string'), false);\n \n common.expectWarning('DeprecationWarning', [\n-  'util.print is deprecated. Use console.log instead.',\n-  'util.puts is deprecated. Use console.log instead.',\n-  'util.debug is deprecated. Use console.error instead.',\n-  'util.error is deprecated. Use console.error instead.'\n+  ['util.print is deprecated. Use console.log instead.', common.noWarnCode],\n+  ['util.puts is deprecated. Use console.log instead.', common.noWarnCode],\n+  ['util.debug is deprecated. Use console.error instead.', common.noWarnCode],\n+  ['util.error is deprecated. Use console.error instead.', common.noWarnCode]\n ]);\n \n util.print('test');"
        },
        {
            "sha": "71ac25443bc266a645149ad04cb460a784e0b3c6",
            "filename": "test/parallel/test-warn-sigprof.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-warn-sigprof.js",
            "raw_url": "https://github.com/nodejs/node/raw/8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956/test%2Fparallel%2Ftest-warn-sigprof.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-warn-sigprof.js?ref=8fb4ea9f75c8c82c46286bd5ca0c1115c4a5e956",
            "patch": "@@ -10,6 +10,7 @@ if (common.isWindows)\n   common.skip('test does not apply to Windows');\n \n common.expectWarning('Warning',\n-                     'process.on(SIGPROF) is reserved while debugging');\n+                     'process.on(SIGPROF) is reserved while debugging',\n+                     common.noWarnCode);\n \n process.on('SIGPROF', () => {});"
        }
    ],
    "stats": {
        "total": 160,
        "additions": 101,
        "deletions": 59
    }
}