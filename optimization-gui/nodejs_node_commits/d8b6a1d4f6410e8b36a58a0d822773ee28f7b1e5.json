{
    "author": "srl295",
    "message": "doc: document and warn if the ICU version is too old\n\nFixes: https://github.com/nodejs/node/issues/19657\n\nPR-URL: https://github.com/nodejs/node/pull/23766\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Refael Ackermann <refack@gmail.com>\nReviewed-By: Ujjwal Sharma <usharma1998@gmail.com>",
    "sha": "d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5",
    "files": [
        {
            "sha": "81157a91a615fd961f942ee7e7a386611291d45d",
            "filename": "BUILDING.md",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5/BUILDING.md",
            "raw_url": "https://github.com/nodejs/node/raw/d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5/BUILDING.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/BUILDING.md?ref=d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5",
            "patch": "@@ -470,6 +470,10 @@ You can find other ICU releases at\n Download the file named something like `icu4c-**##.#**-src.tgz` (or\n `.zip`).\n \n+To check the minimum recommended ICU, run `./configure --help` and see\n+the help for the `--with-icu-source` option. A warning will be printed\n+during configuration if the ICU version is too old.\n+\n ##### Unix/macOS\n \n From an already-unpacked ICU:"
        },
        {
            "sha": "37f6058c6e92ae08989d49d1b9dab8412447be31",
            "filename": "configure.py",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5/configure.py",
            "raw_url": "https://github.com/nodejs/node/raw/d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5/configure.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/configure.py?ref=d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5",
            "patch": "@@ -51,6 +51,8 @@\n valid_mips_fpu = ('fp32', 'fp64', 'fpxx')\n valid_mips_float_abi = ('soft', 'hard')\n valid_intl_modes = ('none', 'small-icu', 'full-icu', 'system-icu')\n+with open ('tools/icu/icu_versions.json') as f:\n+  icu_versions = json.load(f)\n \n # create option groups\n shared_optgroup = optparse.OptionGroup(parser, \"Shared libraries\",\n@@ -425,7 +427,9 @@\n intl_optgroup.add_option('--with-icu-source',\n     action='store',\n     dest='with_icu_source',\n-    help='Intl mode: optional local path to icu/ dir, or path/URL of icu source archive.')\n+    help='Intl mode: optional local path to icu/ dir, or path/URL of '\n+        'the icu4c source archive. '\n+        'v%d.x or later recommended.' % icu_versions[\"minimum_icu\"])\n \n parser.add_option('--with-ltcg',\n     action='store_true',\n@@ -1452,6 +1456,9 @@ def write_config(data, name):\n       icu_ver_major = m.group(1)\n   if not icu_ver_major:\n     error('Could not read U_ICU_VERSION_SHORT version from %s' % uvernum_h)\n+  elif int(icu_ver_major) < icu_versions[\"minimum_icu\"]:\n+    error('icu4c v%d.x is too old, v%d.x or later is required.' % (int(icu_ver_major),\n+                                                                  icu_versions[\"minimum_icu\"]))\n   icu_endianness = sys.byteorder[0];\n   o['variables']['icu_ver_major'] = icu_ver_major\n   o['variables']['icu_endianness'] = icu_endianness"
        },
        {
            "sha": "e17ee8beee6a5c3b30163b9f52827ce879608eaf",
            "filename": "tools/icu/icu_versions.json",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5/tools%2Ficu%2Ficu_versions.json",
            "raw_url": "https://github.com/nodejs/node/raw/d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5/tools%2Ficu%2Ficu_versions.json",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Ficu%2Ficu_versions.json?ref=d8b6a1d4f6410e8b36a58a0d822773ee28f7b1e5",
            "patch": "@@ -0,0 +1,3 @@\n+{\n+    \"minimum_icu\": 57\n+}\n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 15,
        "deletions": 1
    }
}