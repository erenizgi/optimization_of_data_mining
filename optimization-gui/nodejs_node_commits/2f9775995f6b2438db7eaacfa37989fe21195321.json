{
    "author": "tniessen",
    "message": "crypto: move Decipher.finaltol to End-of-Life\n\nRefs: https://github.com/nodejs/node/pull/19353\n\nPR-URL: https://github.com/nodejs/node/pull/19941\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Sakthipriyan Vairamani <thechargingvolcano@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: Gibson Fahnestock <gibfahn@gmail.com>\nReviewed-By: Сковорода Никита Андреевич <chalkerx@gmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>",
    "sha": "2f9775995f6b2438db7eaacfa37989fe21195321",
    "files": [
        {
            "sha": "0e91514cfd240e285f2ef822ad790b186f7bab19",
            "filename": "doc/api/deprecations.md",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/2f9775995f6b2438db7eaacfa37989fe21195321/doc%2Fapi%2Fdeprecations.md",
            "raw_url": "https://github.com/nodejs/node/raw/2f9775995f6b2438db7eaacfa37989fe21195321/doc%2Fapi%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fdeprecations.md?ref=2f9775995f6b2438db7eaacfa37989fe21195321",
            "patch": "@@ -959,11 +959,11 @@ property to a string before assigning it to `process.env`.\n <a id=\"DEP0105\"></a>\n ### DEP0105: decipher.finaltol\n \n-Type: Runtime\n+Type: End-of-Life\n \n-`decipher.finaltol()` has never been documented and is currently an alias for\n-[`decipher.final()`][]. In the future, this API will likely be removed, and it\n-is recommended to use [`decipher.final()`][] instead.\n+`decipher.finaltol()` has never been documented and was an alias for\n+[`decipher.final()`][]. This API has been removed, and it is recommended to use\n+[`decipher.final()`][] instead.\n \n <a id=\"DEP0106\"></a>\n ### DEP0106: crypto.createCipher and crypto.createDecipher"
        },
        {
            "sha": "118fc1da5b7c2c560983d7b76a8e67f22de26cdb",
            "filename": "lib/internal/crypto/cipher.js",
            "status": "modified",
            "additions": 1,
            "deletions": 7,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/2f9775995f6b2438db7eaacfa37989fe21195321/lib%2Finternal%2Fcrypto%2Fcipher.js",
            "raw_url": "https://github.com/nodejs/node/raw/2f9775995f6b2438db7eaacfa37989fe21195321/lib%2Finternal%2Fcrypto%2Fcipher.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fcrypto%2Fcipher.js?ref=2f9775995f6b2438db7eaacfa37989fe21195321",
            "patch": "@@ -31,7 +31,7 @@ const LazyTransform = require('internal/streams/lazy_transform');\n const { StringDecoder } = require('string_decoder');\n \n const { inherits } = require('util');\n-const { deprecate, normalizeEncoding } = require('internal/util');\n+const { normalizeEncoding } = require('internal/util');\n \n function rsaPublic(method, defaultPadding) {\n   return function(options, buffer) {\n@@ -240,10 +240,6 @@ Cipheriv.prototype.setAuthTag = Cipher.prototype.setAuthTag;\n Cipheriv.prototype.setAAD = Cipher.prototype.setAAD;\n \n \n-const finaltol = deprecate(Cipher.prototype.final,\n-                           'crypto.Decipher.finaltol is deprecated. Use ' +\n-                           'crypto.Decipher.final instead.', 'DEP0105');\n-\n function Decipher(cipher, password, options) {\n   if (!(this instanceof Decipher))\n     return new Decipher(cipher, password, options);\n@@ -275,7 +271,6 @@ Decipher.prototype._transform = Cipher.prototype._transform;\n Decipher.prototype._flush = Cipher.prototype._flush;\n Decipher.prototype.update = Cipher.prototype.update;\n Decipher.prototype.final = Cipher.prototype.final;\n-Decipher.prototype.finaltol = finaltol;\n Decipher.prototype.setAutoPadding = Cipher.prototype.setAutoPadding;\n Decipher.prototype.getAuthTag = Cipher.prototype.getAuthTag;\n Decipher.prototype.setAuthTag = Cipher.prototype.setAuthTag;\n@@ -322,7 +317,6 @@ Decipheriv.prototype._transform = Cipher.prototype._transform;\n Decipheriv.prototype._flush = Cipher.prototype._flush;\n Decipheriv.prototype.update = Cipher.prototype.update;\n Decipheriv.prototype.final = Cipher.prototype.final;\n-Decipheriv.prototype.finaltol = finaltol;\n Decipheriv.prototype.setAutoPadding = Cipher.prototype.setAutoPadding;\n Decipheriv.prototype.getAuthTag = Cipher.prototype.getAuthTag;\n Decipheriv.prototype.setAuthTag = Cipher.prototype.setAuthTag;"
        },
        {
            "sha": "9ebdafbf8f4918cb3edafb9fc801064903277578",
            "filename": "test/parallel/test-crypto-deprecated.js",
            "status": "modified",
            "additions": 1,
            "deletions": 15,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/2f9775995f6b2438db7eaacfa37989fe21195321/test%2Fparallel%2Ftest-crypto-deprecated.js",
            "raw_url": "https://github.com/nodejs/node/raw/2f9775995f6b2438db7eaacfa37989fe21195321/test%2Fparallel%2Ftest-crypto-deprecated.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-deprecated.js?ref=2f9775995f6b2438db7eaacfa37989fe21195321",
            "patch": "@@ -11,9 +11,7 @@ common.expectWarning('DeprecationWarning', [\n   ['crypto.Credentials is deprecated. Use tls.SecureContext instead.',\n    'DEP0011'],\n   ['crypto.createCredentials is deprecated. Use tls.createSecureContext ' +\n-  'instead.', 'DEP0010'],\n-  ['crypto.Decipher.finaltol is deprecated. Use crypto.Decipher.final instead.',\n-   'DEP0105']\n+  'instead.', 'DEP0010']\n ]);\n \n // Accessing the deprecated function is enough to trigger the warning event.\n@@ -22,15 +20,3 @@ common.expectWarning('DeprecationWarning', [\n // mapped to the correct non-deprecated function.\n assert.strictEqual(crypto.Credentials, tls.SecureContext);\n assert.strictEqual(crypto.createCredentials, tls.createSecureContext);\n-\n-{\n-  const cipher = crypto.createCipheriv('aes-128-cbc', '0000000000000000',\n-                                       '0000000000000000');\n-  const ciphertext = cipher.update('Node.js', 'utf8', 'hex') +\n-                     cipher.final('hex');\n-  const decipher = crypto.createDecipheriv('aes-128-cbc', '0000000000000000',\n-                                           '0000000000000000');\n-  const plaintext = decipher.update(ciphertext, 'hex', 'utf8') +\n-                    decipher.finaltol('utf8');\n-  assert.strictEqual(plaintext, 'Node.js');\n-}"
        },
        {
            "sha": "ea31c7e894ee5371c2652a1f47d9f93c18bf1bd3",
            "filename": "test/parallel/test-crypto-padding-aes256.js",
            "status": "modified",
            "additions": 28,
            "deletions": 33,
            "changes": 61,
            "blob_url": "https://github.com/nodejs/node/blob/2f9775995f6b2438db7eaacfa37989fe21195321/test%2Fparallel%2Ftest-crypto-padding-aes256.js",
            "raw_url": "https://github.com/nodejs/node/raw/2f9775995f6b2438db7eaacfa37989fe21195321/test%2Fparallel%2Ftest-crypto-padding-aes256.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-padding-aes256.js?ref=2f9775995f6b2438db7eaacfa37989fe21195321",
            "patch": "@@ -29,39 +29,34 @@ const crypto = require('crypto');\n \n crypto.DEFAULT_ENCODING = 'buffer';\n \n-function aes256(decipherFinal) {\n-  const iv = Buffer.from('00000000000000000000000000000000', 'hex');\n-  const key = Buffer.from('0123456789abcdef0123456789abcdef' +\n-                          '0123456789abcdef0123456789abcdef', 'hex');\n-\n-  function encrypt(val, pad) {\n-    const c = crypto.createCipheriv('aes256', key, iv);\n-    c.setAutoPadding(pad);\n-    return c.update(val, 'utf8', 'latin1') + c.final('latin1');\n-  }\n-\n-  function decrypt(val, pad) {\n-    const c = crypto.createDecipheriv('aes256', key, iv);\n-    c.setAutoPadding(pad);\n-    return c.update(val, 'latin1', 'utf8') + c[decipherFinal]('utf8');\n-  }\n-\n-  // echo 0123456789abcdef0123456789abcdef \\\n-  // | openssl enc -e -aes256 -nopad -K <key> -iv <iv> \\\n-  // | openssl enc -d -aes256 -nopad -K <key> -iv <iv>\n-  let plaintext = '0123456789abcdef0123456789abcdef'; // multiple of block size\n-  let encrypted = encrypt(plaintext, false);\n-  let decrypted = decrypt(encrypted, false);\n-  assert.strictEqual(decrypted, plaintext);\n+const iv = Buffer.from('00000000000000000000000000000000', 'hex');\n+const key = Buffer.from('0123456789abcdef0123456789abcdef' +\n+                        '0123456789abcdef0123456789abcdef', 'hex');\n+\n+function encrypt(val, pad) {\n+  const c = crypto.createCipheriv('aes256', key, iv);\n+  c.setAutoPadding(pad);\n+  return c.update(val, 'utf8', 'latin1') + c.final('latin1');\n+}\n \n-  // echo 0123456789abcdef0123456789abcde \\\n-  // | openssl enc -e -aes256 -K <key> -iv <iv> \\\n-  // | openssl enc -d -aes256 -K <key> -iv <iv>\n-  plaintext = '0123456789abcdef0123456789abcde'; // not a multiple\n-  encrypted = encrypt(plaintext, true);\n-  decrypted = decrypt(encrypted, true);\n-  assert.strictEqual(decrypted, plaintext);\n+function decrypt(val, pad) {\n+  const c = crypto.createDecipheriv('aes256', key, iv);\n+  c.setAutoPadding(pad);\n+  return c.update(val, 'latin1', 'utf8') + c.final('utf8');\n }\n \n-aes256('final');\n-aes256('finaltol');\n+// echo 0123456789abcdef0123456789abcdef \\\n+// | openssl enc -e -aes256 -nopad -K <key> -iv <iv> \\\n+// | openssl enc -d -aes256 -nopad -K <key> -iv <iv>\n+let plaintext = '0123456789abcdef0123456789abcdef'; // multiple of block size\n+let encrypted = encrypt(plaintext, false);\n+let decrypted = decrypt(encrypted, false);\n+assert.strictEqual(decrypted, plaintext);\n+\n+// echo 0123456789abcdef0123456789abcde \\\n+// | openssl enc -e -aes256 -K <key> -iv <iv> \\\n+// | openssl enc -d -aes256 -K <key> -iv <iv>\n+plaintext = '0123456789abcdef0123456789abcde'; // not a multiple\n+encrypted = encrypt(plaintext, true);\n+decrypted = decrypt(encrypted, true);\n+assert.strictEqual(decrypted, plaintext);"
        }
    ],
    "stats": {
        "total": 93,
        "additions": 34,
        "deletions": 59
    }
}