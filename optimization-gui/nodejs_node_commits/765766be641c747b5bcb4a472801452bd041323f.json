{
    "author": "refack",
    "message": "build: add common `defines`\n\n* `V8_DEPRECATION_WARNINGS` is here for explicity. It is already defined\n  in `node.gypi`, and `addon.gypi`.\n* `V8_IMMINENT_DEPRECATION_WARNINGS` added to warn addons authors.\n* `OPENSSL_THREADS` apears in the openSSL `.h` files, and was only\n  defined via GYP for the node build.\n\nPR-URL: https://github.com/nodejs/node/pull/23426\nFixes: https://github.com/nodejs/node/issues/23167\nRefs: https://github.com/nodejs/node/issues/23122\nReviewed-By: Sakthipriyan Vairamani <thechargingvolcano@gmail.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "765766be641c747b5bcb4a472801452bd041323f",
    "files": [
        {
            "sha": "0ba7c8e816746ac5913ddc1ed9b97e8064358d44",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 22,
            "deletions": 1,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/765766be641c747b5bcb4a472801452bd041323f/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/765766be641c747b5bcb4a472801452bd041323f/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=765766be641c747b5bcb4a472801452bd041323f",
            "patch": "@@ -20,12 +20,14 @@\n     'node_module_version%': '',\n     'node_with_ltcg%': '',\n     'node_use_pch%': 'false',\n+    'node_shared_openssl%': 'false',\n \n     'node_tag%': '',\n     'uv_library%': 'static_library',\n \n     'clang%': 0,\n \n+    'openssl_no_asm%': 0,\n     'openssl_fips%': '',\n \n     # Reset this number to 0 on major V8 upgrades.\n@@ -261,6 +263,14 @@\n         }\n       }\n     },\n+\n+    # Defines these mostly for node-gyp to pickup, and warn addon authors of\n+    # imminent V8 deprecations, also to sync how dependencies are configured.\n+    'defines': [\n+      'V8_DEPRECATION_WARNINGS',\n+      'V8_IMMINENT_DEPRECATION_WARNINGS',\n+    ],\n+\n     # Forcibly disable -Werror.  We support a wide range of compilers, it's\n     # simply not feasible to squelch all warnings, never mind that the\n     # libraries in deps/ are not under our control.\n@@ -503,7 +513,18 @@\n         'ldflags': [\n           '-Wl,--export-dynamic',\n         ],\n-      }]\n+      }],\n+      ['node_shared_openssl!=\"true\"', {\n+        # `OPENSSL_THREADS` is defined via GYP for openSSL for all architectures.\n+        'defines': [\n+          'OPENSSL_THREADS',\n+        ],\n+      }],\n+      ['node_shared_openssl!=\"true\" and openssl_no_asm==1', {\n+        'defines': [\n+          'OPENSSL_NO_ASM',\n+        ],\n+      }],\n     ],\n   }\n }"
        }
    ],
    "stats": {
        "total": 23,
        "additions": 22,
        "deletions": 1
    }
}