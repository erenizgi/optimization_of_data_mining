{
    "author": "lpinca",
    "message": "http: remove default 'error' listener on upgrade\n\nRemove the default `'error'` listener when the socket is freed. This\nis consistent with the client and prevents spurious `'clientError'`\nevents from being emitted on the server.\n\nPR-URL: https://github.com/nodejs/node/pull/18868\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "51be03cd577fe8b5a73dd9558bd6a2727f9c3c0b",
    "files": [
        {
            "sha": "e83eeae85856e1bbde6b04aac0d459fa3e91b707",
            "filename": "lib/_http_server.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/51be03cd577fe8b5a73dd9558bd6a2727f9c3c0b/lib%2F_http_server.js",
            "raw_url": "https://github.com/nodejs/node/raw/51be03cd577fe8b5a73dd9558bd6a2727f9c3c0b/lib%2F_http_server.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_server.js?ref=51be03cd577fe8b5a73dd9558bd6a2727f9c3c0b",
            "patch": "@@ -521,6 +521,7 @@ function onParserExecuteCommon(server, socket, parser, state, ret, d) {\n     socket.removeListener('close', state.onClose);\n     socket.removeListener('drain', state.onDrain);\n     socket.removeListener('drain', ondrain);\n+    socket.removeListener('error', socketOnError);\n     unconsume(parser, socket);\n     parser.finish();\n     freeParser(parser, req, null);"
        },
        {
            "sha": "e7fb116de93267d3365e6be9b55c2e9e7bab69ec",
            "filename": "test/parallel/test-http-connect.js",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/51be03cd577fe8b5a73dd9558bd6a2727f9c3c0b/test%2Fparallel%2Ftest-http-connect.js",
            "raw_url": "https://github.com/nodejs/node/raw/51be03cd577fe8b5a73dd9558bd6a2727f9c3c0b/test%2Fparallel%2Ftest-http-connect.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http-connect.js?ref=51be03cd577fe8b5a73dd9558bd6a2727f9c3c0b",
            "patch": "@@ -30,6 +30,13 @@ server.on('connect', common.mustCall((req, socket, firstBodyChunk) => {\n   assert.strictEqual(req.method, 'CONNECT');\n   assert.strictEqual(req.url, 'google.com:443');\n \n+  // Make sure this socket has detached.\n+  assert.strictEqual(socket.listeners('close').length, 0);\n+  assert.strictEqual(socket.listeners('drain').length, 0);\n+  assert.strictEqual(socket.listeners('data').length, 0);\n+  assert.strictEqual(socket.listeners('end').length, 1);\n+  assert.strictEqual(socket.listeners('error').length, 0);\n+\n   socket.write('HTTP/1.1 200 Connection established\\r\\n\\r\\n');\n \n   let data = firstBodyChunk.toString();"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 8,
        "deletions": 0
    }
}