{
    "author": "lundibundi",
    "message": "benchmark: add lines to scatter plots\n\nAdds lines between the points of the same category in scatter.R plots.\n\nPR-URL: https://github.com/nodejs/node/pull/22074\nReviewed-By: Andreas Madsen <amwebdk@gmail.com>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>",
    "sha": "7aac70607df723a1218577d5f0d7a4b6bd94d993",
    "files": [
        {
            "sha": "1574987aebe7420c9dfb3283d2535e7d9e938b94",
            "filename": "benchmark/scatter.R",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/7aac70607df723a1218577d5f0d7a4b6bd94d993/benchmark%2Fscatter.R",
            "raw_url": "https://github.com/nodejs/node/raw/7aac70607df723a1218577d5f0d7a4b6bd94d993/benchmark%2Fscatter.R",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fscatter.R?ref=7aac70607df723a1218577d5f0d7a4b6bd94d993",
            "patch": "@@ -79,6 +79,7 @@ if (!is.null(plot.filename)) {\n     width=.1, na.rm=TRUE\n   );\n   p = p + geom_point();\n+  p = p + geom_line();\n   p = p + ylab(\"rate of operations (higher is better)\");\n   p = p + ggtitle(dat[1, 1]);\n   ggsave(plot.filename, p);"
        },
        {
            "sha": "726129e6334e9241469ac902fef7bafe67a74707",
            "filename": "doc/guides/doc_img/scatter-plot.png",
            "status": "modified",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/nodejs/node/blob/7aac70607df723a1218577d5f0d7a4b6bd94d993/doc%2Fguides%2Fdoc_img%2Fscatter-plot.png",
            "raw_url": "https://github.com/nodejs/node/raw/7aac70607df723a1218577d5f0d7a4b6bd94d993/doc%2Fguides%2Fdoc_img%2Fscatter-plot.png",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fguides%2Fdoc_img%2Fscatter-plot.png?ref=7aac70607df723a1218577d5f0d7a4b6bd94d993"
        },
        {
            "sha": "b6f8984afff02994463f21767777c0c59be89fd5",
            "filename": "doc/guides/writing-and-running-benchmarks.md",
            "status": "modified",
            "additions": 50,
            "deletions": 42,
            "changes": 92,
            "blob_url": "https://github.com/nodejs/node/blob/7aac70607df723a1218577d5f0d7a4b6bd94d993/doc%2Fguides%2Fwriting-and-running-benchmarks.md",
            "raw_url": "https://github.com/nodejs/node/raw/7aac70607df723a1218577d5f0d7a4b6bd94d993/doc%2Fguides%2Fwriting-and-running-benchmarks.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fguides%2Fwriting-and-running-benchmarks.md?ref=7aac70607df723a1218577d5f0d7a4b6bd94d993",
            "patch": "@@ -270,56 +270,64 @@ After generating the csv, a comparison table can be created using the\n the `--plot filename` option.\n \n ```console\n-$ cat scatter.csv | Rscript benchmark/scatter.R --xaxis chunk --category encoding --plot scatter-plot.png --log\n-\n-aggregating variable: inlen\n-\n-chunk     encoding      mean confidence.interval\n-   16        ascii 1111933.3           221502.48\n-   16 base64-ascii  167508.4            33116.09\n-   16  base64-utf8  122666.6            25037.65\n-   16         utf8  783254.8           159601.79\n-   64        ascii 2623462.9           399791.36\n-   64 base64-ascii  462008.3            85369.45\n-   64  base64-utf8  420108.4            85612.05\n-   64         utf8 1358327.5           235152.03\n-  256        ascii 3730343.4           371530.47\n-  256 base64-ascii  663281.2            80302.73\n-  256  base64-utf8  632911.7            81393.07\n-  256         utf8 1554216.9           236066.53\n- 1024        ascii 4399282.0           186436.46\n- 1024 base64-ascii  730426.6            63806.12\n- 1024  base64-utf8  680954.3            68076.33\n- 1024         utf8 1554832.5           237532.07\n+$ cat scatter.csv | Rscript benchmark/scatter.R --xaxis chunkLen --category encoding --plot scatter-plot.png --log\n+\n+aggregating variable: inLen\n+\n+chunkLen     encoding      rate confidence.interval\n+      16        ascii 1515855.1           334492.68\n+      16 base64-ascii  403527.2            89677.70\n+      16  base64-utf8  322352.8            70792.93\n+      16      utf16le 1714567.5           388439.81\n+      16         utf8 1100181.6           254141.32\n+      64        ascii 3550402.0           661277.65\n+      64 base64-ascii 1093660.3           229976.34\n+      64  base64-utf8  997804.8           227238.04\n+      64      utf16le 3372234.0           647274.88\n+      64         utf8 1731941.2           360854.04\n+     256        ascii 5033793.9           723354.30\n+     256 base64-ascii 1447962.1           236625.96\n+     256  base64-utf8 1357269.2           231045.70\n+     256      utf16le 4039581.5           655483.16\n+     256         utf8 1828672.9           360311.55\n+    1024        ascii 5677592.7           624771.56\n+    1024 base64-ascii 1494171.7           227302.34\n+    1024  base64-utf8 1399218.9           224584.79\n+    1024      utf16le 4157452.0           630416.28\n+    1024         utf8 1824266.6           359628.52\n ```\n \n-Because the scatter plot can only show two variables (in this case _chunk_ and\n-_encoding_) the rest is aggregated. Sometimes aggregating is a problem, this\n+Because the scatter plot can only show two variables (in this case _chunkLen_\n+and _encoding_) the rest is aggregated. Sometimes aggregating is a problem, this\n can be solved by filtering. This can be done while benchmarking using the\n `--set` parameter (e.g. `--set encoding=ascii`) or by filtering results\n afterwards using tools such as `sed` or `grep`. In the `sed` case be\n sure to keep the first line since that contains the header information.\n \n ```console\n-$ cat scatter.csv | sed -E '1p;/([^,]+, ){3}128,/!d' | Rscript benchmark/scatter.R --xaxis chunk --category encoding --plot scatter-plot.png --log\n-\n-chunk     encoding       mean confidence.interval\n-   16        ascii  701285.96           21233.982\n-   16 base64-ascii  107719.07            3339.439\n-   16  base64-utf8   72966.95            2438.448\n-   16         utf8  475340.84           17685.450\n-   64        ascii 2554105.08           87067.132\n-   64 base64-ascii  330120.32            8551.707\n-   64  base64-utf8  249693.19            8990.493\n-   64         utf8 1128671.90           48433.862\n-  256        ascii 4841070.04          181620.768\n-  256 base64-ascii  849545.53           29931.656\n-  256  base64-utf8  809629.89           33773.496\n-  256         utf8 1489525.15           49616.334\n- 1024        ascii 4931512.12          165402.805\n- 1024 base64-ascii  863933.22           27766.982\n- 1024  base64-utf8  827093.97           24376.522\n- 1024         utf8 1487176.43           50128.721\n+$ cat scatter.csv | sed -E '1p;/([^,]+, ){3}128,/!d' | Rscript benchmark/scatter.R --xaxis chunkLen --category encoding --plot scatter-plot.png --log\n+\n+chunkLen     encoding      rate confidence.interval\n+      16        ascii 1302078.5            71692.27\n+      16 base64-ascii  338669.1            15159.54\n+      16  base64-utf8  281904.2            20326.75\n+      16      utf16le 1381515.5            58533.61\n+      16         utf8  831183.2            33631.01\n+      64        ascii 4363402.8           224030.00\n+      64 base64-ascii 1036825.9            48644.72\n+      64  base64-utf8  780059.3            60994.98\n+      64      utf16le 3900749.5           158366.84\n+      64         utf8 1723710.6            80665.65\n+     256        ascii 8472896.1           511822.51\n+     256 base64-ascii 2215884.6           104347.53\n+     256  base64-utf8 1996230.3           131778.47\n+     256      utf16le 5824147.6           234550.82\n+     256         utf8 2019428.8           100913.36\n+    1024        ascii 8340189.4           598855.08\n+    1024 base64-ascii 2201316.2           111777.68\n+    1024  base64-utf8 2002272.9           128843.11\n+    1024      utf16le 5789281.7           240642.77\n+    1024         utf8 2025551.2            81770.69\n ```\n \n ![compare tool boxplot](doc_img/scatter-plot.png)"
        }
    ],
    "stats": {
        "total": 93,
        "additions": 51,
        "deletions": 42
    }
}