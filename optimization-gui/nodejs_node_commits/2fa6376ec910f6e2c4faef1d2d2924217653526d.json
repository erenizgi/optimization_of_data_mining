{
    "author": "gengjiawen",
    "message": "src: refactor macro to std::min in node_buffer.cc\n\nPR-URL: https://github.com/nodejs/node/pull/25919\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Refael Ackermann <refack@gmail.com>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Сковорода Никита Андреевич <chalkerx@gmail.com>",
    "sha": "2fa6376ec910f6e2c4faef1d2d2924217653526d",
    "files": [
        {
            "sha": "39727fcdd1417922b19fd0c4092c604bcb19e862",
            "filename": "src/node_buffer.cc",
            "status": "modified",
            "additions": 12,
            "deletions": 13,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/2fa6376ec910f6e2c4faef1d2d2924217653526d/src%2Fnode_buffer.cc",
            "raw_url": "https://github.com/nodejs/node/raw/2fa6376ec910f6e2c4faef1d2d2924217653526d/src%2Fnode_buffer.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_buffer.cc?ref=2fa6376ec910f6e2c4faef1d2d2924217653526d",
            "patch": "@@ -34,8 +34,6 @@\n #include <string.h>\n #include <limits.h>\n \n-#define MIN(a, b) ((a) < (b) ? (a) : (b))\n-\n #define THROW_AND_RETURN_UNLESS_BUFFER(env, obj)                            \\\n   THROW_AND_RETURN_IF_NOT_BUFFER(env, obj, \"argument\")                      \\\n \n@@ -518,9 +516,9 @@ void Copy(const FunctionCallbackInfo<Value> &args) {\n   if (source_end - source_start > target_length - target_start)\n     source_end = source_start + target_length - target_start;\n \n-  uint32_t to_copy = MIN(MIN(source_end - source_start,\n-                             target_length - target_start),\n-                             ts_obj_length - source_start);\n+  uint32_t to_copy = std::min(\n+      std::min(source_end - source_start, target_length - target_start),\n+      ts_obj_length - source_start);\n \n   memmove(target_data + target_start, ts_obj_data + source_start, to_copy);\n   args.GetReturnValue().Set(to_copy);\n@@ -551,7 +549,8 @@ void Fill(const FunctionCallbackInfo<Value>& args) {\n   if (Buffer::HasInstance(args[1])) {\n     SPREAD_BUFFER_ARG(args[1], fill_obj);\n     str_length = fill_obj_length;\n-    memcpy(ts_obj_data + start, fill_obj_data, MIN(str_length, fill_length));\n+    memcpy(\n+        ts_obj_data + start, fill_obj_data, std::min(str_length, fill_length));\n     goto start_fill;\n   }\n \n@@ -572,15 +571,15 @@ void Fill(const FunctionCallbackInfo<Value>& args) {\n   if (enc == UTF8) {\n     str_length = str_obj->Utf8Length(env->isolate());\n     node::Utf8Value str(env->isolate(), args[1]);\n-    memcpy(ts_obj_data + start, *str, MIN(str_length, fill_length));\n+    memcpy(ts_obj_data + start, *str, std::min(str_length, fill_length));\n \n   } else if (enc == UCS2) {\n     str_length = str_obj->Length() * sizeof(uint16_t);\n     node::TwoByteValue str(env->isolate(), args[1]);\n     if (IsBigEndian())\n       SwapBytes16(reinterpret_cast<char*>(&str[0]), str_length);\n \n-    memcpy(ts_obj_data + start, *str, MIN(str_length, fill_length));\n+    memcpy(ts_obj_data + start, *str, std::min(str_length, fill_length));\n \n   } else {\n     // Write initial String to Buffer, then use that memory to copy remainder\n@@ -645,7 +644,7 @@ void StringWrite(const FunctionCallbackInfo<Value>& args) {\n   THROW_AND_RETURN_IF_OOB(ParseArrayIndex(env, args[2], ts_obj_length - offset,\n                                           &max_length));\n \n-  max_length = MIN(ts_obj_length - offset, max_length);\n+  max_length = std::min(ts_obj_length - offset, max_length);\n \n   if (max_length == 0)\n     return args.GetReturnValue().Set(0);\n@@ -714,9 +713,9 @@ void CompareOffset(const FunctionCallbackInfo<Value> &args) {\n   CHECK_LE(source_start, source_end);\n   CHECK_LE(target_start, target_end);\n \n-  size_t to_cmp = MIN(MIN(source_end - source_start,\n-                      target_end - target_start),\n-                      ts_obj_length - source_start);\n+  size_t to_cmp =\n+      std::min(std::min(source_end - source_start, target_end - target_start),\n+               ts_obj_length - source_start);\n \n   int val = normalizeCompareVal(to_cmp > 0 ?\n                                   memcmp(ts_obj_data + source_start,\n@@ -736,7 +735,7 @@ void Compare(const FunctionCallbackInfo<Value> &args) {\n   SPREAD_BUFFER_ARG(args[0], obj_a);\n   SPREAD_BUFFER_ARG(args[1], obj_b);\n \n-  size_t cmp_length = MIN(obj_a_length, obj_b_length);\n+  size_t cmp_length = std::min(obj_a_length, obj_b_length);\n \n   int val = normalizeCompareVal(cmp_length > 0 ?\n                                 memcmp(obj_a_data, obj_b_data, cmp_length) : 0,"
        }
    ],
    "stats": {
        "total": 25,
        "additions": 12,
        "deletions": 13
    }
}