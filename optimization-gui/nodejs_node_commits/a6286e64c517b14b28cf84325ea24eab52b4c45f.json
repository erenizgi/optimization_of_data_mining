{
    "author": "bcoe",
    "message": "process: fix call process.reallyExit, vs., binding\n\nSome user-land modules, e.g., nyc, mocha, currently rely on patching\nprocess.reallyExit.\n\nPR-URL: https://github.com/nodejs/node/pull/25655\nFixes: https://github.com/nodejs/node/issues/25650\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "a6286e64c517b14b28cf84325ea24eab52b4c45f",
    "files": [
        {
            "sha": "28b9afe1cf9404267d70c70f8e0287080558b66a",
            "filename": "lib/internal/process/per_thread.js",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/a6286e64c517b14b28cf84325ea24eab52b4c45f/lib%2Finternal%2Fprocess%2Fper_thread.js",
            "raw_url": "https://github.com/nodejs/node/raw/a6286e64c517b14b28cf84325ea24eab52b4c45f/lib%2Finternal%2Fprocess%2Fper_thread.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fprocess%2Fper_thread.js?ref=a6286e64c517b14b28cf84325ea24eab52b4c45f",
            "patch": "@@ -149,7 +149,10 @@ function wrapProcessMethods(binding) {\n       process._exiting = true;\n       process.emit('exit', process.exitCode || 0);\n     }\n-    binding.reallyExit(process.exitCode || 0);\n+    // FIXME(joyeecheung): This is an undocumented API that gets monkey-patched\n+    // in the user land. Either document it, or deprecate it in favor of a\n+    // better public alternative.\n+    process.reallyExit(process.exitCode || 0);\n   }\n \n   function kill(pid, sig) {"
        },
        {
            "sha": "c806d6c4aa480830e8fecf0c2ce6a8720303a966",
            "filename": "test/parallel/test-process-really-exit.js",
            "status": "added",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/a6286e64c517b14b28cf84325ea24eab52b4c45f/test%2Fparallel%2Ftest-process-really-exit.js",
            "raw_url": "https://github.com/nodejs/node/raw/a6286e64c517b14b28cf84325ea24eab52b4c45f/test%2Fparallel%2Ftest-process-really-exit.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-really-exit.js?ref=a6286e64c517b14b28cf84325ea24eab52b4c45f",
            "patch": "@@ -0,0 +1,17 @@\n+'use strict';\n+require('../common');\n+const assert = require('assert');\n+\n+// ensure that the reallyExit hook is executed.\n+// see: https://github.com/nodejs/node/issues/25650\n+if (process.argv[2] === 'subprocess') {\n+  process.reallyExit = function() {\n+    console.info('really exited');\n+  };\n+  process.exit();\n+} else {\n+  const { spawnSync } = require('child_process');\n+  const out = spawnSync(process.execPath, [__filename, 'subprocess']);\n+  const observed = out.output[1].toString('utf8').trim();\n+  assert.strictEqual(observed, 'really exited');\n+}"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 21,
        "deletions": 1
    }
}