{
    "author": "joyeecheung",
    "message": "fs: throw rmdirSync errors in JS\n\nPR-URL: https://github.com/nodejs/node/pull/18871\nRefs: https://github.com/nodejs/node/issues/18106\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "46164ba2126095d4a788062003e3096699565efe",
    "files": [
        {
            "sha": "72770f371a9cc74e2dd4f01499dc26d0fd6222e4",
            "filename": "lib/fs.js",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/46164ba2126095d4a788062003e3096699565efe/lib%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/46164ba2126095d4a788062003e3096699565efe/lib%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs.js?ref=46164ba2126095d4a788062003e3096699565efe",
            "patch": "@@ -748,7 +748,9 @@ fs.rmdir = function(path, callback) {\n fs.rmdirSync = function(path) {\n   path = getPathFromURL(path);\n   validatePath(path);\n-  return binding.rmdir(pathModule.toNamespacedPath(path));\n+  const ctx = { path };\n+  binding.rmdir(pathModule.toNamespacedPath(path), undefined, ctx);\n+  handleErrorFromBinding(ctx);\n };\n \n fs.fdatasync = function(fd, callback) {"
        },
        {
            "sha": "5aa82a6a90c7bd237baa099f72dbd25d5fb234b8",
            "filename": "src/node_file.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/46164ba2126095d4a788062003e3096699565efe/src%2Fnode_file.cc",
            "raw_url": "https://github.com/nodejs/node/raw/46164ba2126095d4a788062003e3096699565efe/src%2Fnode_file.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_file.cc?ref=46164ba2126095d4a788062003e3096699565efe",
            "patch": "@@ -1004,17 +1004,21 @@ static void Unlink(const FunctionCallbackInfo<Value>& args) {\n static void RMDir(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = Environment::GetCurrent(args);\n \n-  CHECK_GE(args.Length(), 1);\n+  const int argc = args.Length();\n+  CHECK_GE(argc, 2);\n \n   BufferValue path(env->isolate(), args[0]);\n   CHECK_NE(*path, nullptr);\n \n-  FSReqBase* req_wrap = GetReqWrap(env, args[1]);\n+  FSReqBase* req_wrap = GetReqWrap(env, args[1]);  // rmdir(path, req)\n   if (req_wrap != nullptr) {\n     AsyncCall(env, req_wrap, args, \"rmdir\", UTF8, AfterNoArgs,\n               uv_fs_rmdir, *path);\n-  } else {\n-    SYNC_CALL(rmdir, *path, *path)\n+  } else {  // rmdir(path, undefined, ctx)\n+    CHECK_EQ(argc, 3);\n+    fs_req_wrap req_wrap;\n+    SyncCall(env, args[2], &req_wrap, \"rmdir\",\n+             uv_fs_rmdir, *path);\n   }\n }\n "
        }
    ],
    "stats": {
        "total": 16,
        "additions": 11,
        "deletions": 5
    }
}