{
    "author": "billywhizz",
    "message": "http: prevent aborted event when already completed\n\nWhen socket is closed on a response for a request that is being piped to\na stream there is a condition where aborted event will be fired to http\nclient when socket is closing and the incomingMessage stream is still\nset to readable.\n\nWe need a check for request being complete and to only raise the\n'aborted' event on the http client if we have not yet completed reading\nthe response from the server.\n\nFixes: https://github.com/nodejs/node/issues/18756\n\nPR-URL: https://github.com/nodejs/node/pull/18999\nReviewed-By: Shingo Inoue <leko.noor@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "1980a36dd45997e9dee03fe11688319c2f5c3644",
    "files": [
        {
            "sha": "db7a01055ad301bed6f8aa319167f347648bfb0d",
            "filename": "lib/_http_client.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1980a36dd45997e9dee03fe11688319c2f5c3644/lib%2F_http_client.js",
            "raw_url": "https://github.com/nodejs/node/raw/1980a36dd45997e9dee03fe11688319c2f5c3644/lib%2F_http_client.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_client.js?ref=1980a36dd45997e9dee03fe11688319c2f5c3644",
            "patch": "@@ -321,7 +321,7 @@ function socketCloseListener() {\n   var parser = socket.parser;\n   if (req.res && req.res.readable) {\n     // Socket closed before we emitted 'end' below.\n-    req.res.emit('aborted');\n+    if (!req.res.complete) req.res.emit('aborted');\n     var res = req.res;\n     res.on('end', function() {\n       res.emit('close');"
        }
    ],
    "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    }
}