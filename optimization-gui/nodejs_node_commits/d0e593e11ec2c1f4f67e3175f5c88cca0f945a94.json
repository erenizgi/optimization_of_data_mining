{
    "author": "refack",
    "message": "build,tools: update make-v8.sh for s390x\n\nPR-URL: https://github.com/nodejs/node/pull/23839\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "d0e593e11ec2c1f4f67e3175f5c88cca0f945a94",
    "files": [
        {
            "sha": "1bbf472aae7df29f1d9917c30905450d9f11c9eb",
            "filename": "tools/make-v8.sh",
            "status": "modified",
            "additions": 21,
            "deletions": 3,
            "changes": 24,
            "blob_url": "https://github.com/nodejs/node/blob/d0e593e11ec2c1f4f67e3175f5c88cca0f945a94/tools%2Fmake-v8.sh",
            "raw_url": "https://github.com/nodejs/node/raw/d0e593e11ec2c1f4f67e3175f5c88cca0f945a94/tools%2Fmake-v8.sh",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmake-v8.sh?ref=d0e593e11ec2c1f4f67e3175f5c88cca0f945a94",
            "patch": "@@ -1,9 +1,27 @@\n-#!/bin/bash\n+#!/bin/bash -xe\n \n BUILD_ARCH_TYPE=$1\n V8_BUILD_OPTIONS=$2\n \n cd deps/v8\n tools/node/fetch_deps.py .\n-PATH=~/_depot_tools:$PATH tools/dev/v8gen.py $BUILD_ARCH_TYPE --no-goma $V8_BUILD_OPTIONS\n-PATH=~/_depot_tools:$PATH ninja -C out.gn/$BUILD_ARCH_TYPE/ d8 cctest inspector-test\n+\n+if [ \"`arch`\" == \"s390x\" ]\n+then\n+  # set paths manually for now to use locally installed gn\n+  export BUILD_TOOLS=/home/iojs/build-tools\n+  export LD_LIBRARY_PATH=$BUILD_TOOLS:$LD_LIBRARY_PATH\n+  export PATH=$BUILD_TOOLS:$PATH\n+  CXX_PATH=`which $CXX |grep g++`\n+  rm -f \"$BUILD_TOOLS/g++\"\n+  rm -f \"$BUILD_TOOLS/gcc\"\n+  ln -s $CXX_PATH \"$BUILD_TOOLS/g++\"\n+  ln -s $CXX_PATH \"$BUILD_TOOLS/gcc\"\n+  g++ --version\n+  export PKG_CONFIG_PATH=$BUILD_TOOLS/pkg-config\n+  gn gen -v out.gn/$BUILD_ARCH_TYPE --args='is_component_build=false is_debug=false use_goma=false goma_dir=\"None\" use_custom_libcxx=false v8_target_cpu=\"s390x\" target_cpu=\"s390x\"'\n+  ninja -v -C out.gn/$BUILD_ARCH_TYPE d8 cctest inspector-test\n+else\n+  PATH=~/_depot_tools:$PATH tools/dev/v8gen.py $BUILD_ARCH_TYPE --no-goma $V8_BUILD_OPTIONS\n+  PATH=~/_depot_tools:$PATH ninja -C out.gn/$BUILD_ARCH_TYPE/ d8 cctest inspector-test\n+fi"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 21,
        "deletions": 3
    }
}