{
    "author": "apapirovski",
    "message": "test: remove outdated, non-functioning test\n\nThe timers directory test, utilizing FakeTime, has not worked in\nquite a while and is not truly testing Node.js behaviour. If a\nsimilar test is necessary it would be better suited to libuv\non which Node.js relies for timers functionality.\n\nPR-URL: https://github.com/nodejs/node/pull/20894\nFixes: https://github.com/nodejs/node/issues/10154\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Jeremiah Senkpiel <fishrock123@rocketmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>",
    "sha": "6f63f8d730c8c3b19de7a591c35d376d428a4d56",
    "files": [
        {
            "sha": "60f084d2c10f92c6960c3cad769fbdd012fd642d",
            "filename": ".gitignore",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/6f63f8d730c8c3b19de7a591c35d376d428a4d56/.gitignore",
            "raw_url": "https://github.com/nodejs/node/raw/6f63f8d730c8c3b19de7a591c35d376d428a4d56/.gitignore",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/.gitignore?ref=6f63f8d730c8c3b19de7a591c35d376d428a4d56",
            "patch": "@@ -106,7 +106,6 @@ deps/npm/node_modules/.bin/\n /SHASUMS*.txt*\n \n # test artifacts\n-tools/faketime\n tools/remark-cli/node_modules\n tools/remark-preset-lint-node/node_modules\n icu_config.gypi"
        },
        {
            "sha": "025cb164c9f732058090bbbe7021d7f23d7b2af4",
            "filename": "Makefile",
            "status": "modified",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/6f63f8d730c8c3b19de7a591c35d376d428a4d56/Makefile",
            "raw_url": "https://github.com/nodejs/node/raw/6f63f8d730c8c3b19de7a591c35d376d428a4d56/Makefile",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/Makefile?ref=6f63f8d730c8c3b19de7a591c35d376d428a4d56",
            "patch": "@@ -516,13 +516,6 @@ test-addons-clean:\n \t$(RM) test/addons/.buildstamp test/addons/.docbuildstamp\n \t$(MAKE) test-addons-napi-clean\n \n-test-timers:\n-\t$(MAKE) --directory=tools faketime\n-\t$(PYTHON) tools/test.py $(PARALLEL_ARGS) --mode=$(BUILDTYPE_LOWER) timers\n-\n-test-timers-clean:\n-\t$(MAKE) --directory=tools clean\n-\n test-async-hooks:\n \t$(PYTHON) tools/test.py $(PARALLEL_ARGS) --mode=$(BUILDTYPE_LOWER) async-hooks\n "
        },
        {
            "sha": "96986a74a6313c07af7180b6e402f0c0c69794c3",
            "filename": "test/timers/test-timers-reliability.js",
            "status": "removed",
            "additions": 0,
            "deletions": 54,
            "changes": 54,
            "blob_url": "https://github.com/nodejs/node/blob/1e7ff81e47bed3275728eee1a676ba95e4f2b41d/test%2Ftimers%2Ftest-timers-reliability.js",
            "raw_url": "https://github.com/nodejs/node/raw/1e7ff81e47bed3275728eee1a676ba95e4f2b41d/test%2Ftimers%2Ftest-timers-reliability.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ftimers%2Ftest-timers-reliability.js?ref=1e7ff81e47bed3275728eee1a676ba95e4f2b41d",
            "patch": "@@ -1,54 +0,0 @@\n-'use strict';\n-// FaketimeFlags: --exclude-monotonic -f '2014-07-21 09:00:00'\n-\n-require('../common');\n-\n-const Timer = process.binding('timer_wrap').Timer;\n-const assert = require('assert');\n-\n-let timerFired = false;\n-let intervalFired = false;\n-\n-/*\n- * This test case aims at making sure that timing utilities such\n- * as setTimeout and setInterval are not vulnerable to time\n- * drifting or inconsistent time changes (such as ntp time sync\n- * in the past, etc.).\n- *\n- * It is run using faketime so that we change how\n- * non-monotonic clocks perceive time movement. We freeze\n- * non-monotonic time, and check if setTimeout and setInterval\n- * work properly in that situation.\n- *\n- * We check this by setting a timer based on a monotonic clock\n- * to fire after setTimeout's callback is supposed to be called.\n- * This monotonic timer, by definition, is not subject to time drifting\n- * and inconsistent time changes, so it can be considered as a solid\n- * reference.\n- *\n- * When the monotonic timer fires, if the setTimeout's callback\n- * hasn't been called yet, it means that setTimeout's underlying timer\n- * is vulnerable to time drift or inconsistent time changes.\n- */\n-\n-const monoTimer = new Timer();\n-monoTimer[Timer.kOnTimeout] = function() {\n-  /*\n-     * Make sure that setTimeout's and setInterval's callbacks have\n-     * already fired, otherwise it means that they are vulnerable to\n-     * time drifting or inconsistent time changes.\n-     */\n-  assert(timerFired);\n-  assert(intervalFired);\n-};\n-\n-monoTimer.start(300);\n-\n-setTimeout(function() {\n-  timerFired = true;\n-}, 200);\n-\n-const interval = setInterval(function() {\n-  intervalFired = true;\n-  clearInterval(interval);\n-}, 200);"
        },
        {
            "sha": "b766db16910cc5438a734a614db997afe578ccc2",
            "filename": "test/timers/testcfg.py",
            "status": "removed",
            "additions": 0,
            "deletions": 100,
            "changes": 100,
            "blob_url": "https://github.com/nodejs/node/blob/1e7ff81e47bed3275728eee1a676ba95e4f2b41d/test%2Ftimers%2Ftestcfg.py",
            "raw_url": "https://github.com/nodejs/node/raw/1e7ff81e47bed3275728eee1a676ba95e4f2b41d/test%2Ftimers%2Ftestcfg.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ftimers%2Ftestcfg.py?ref=1e7ff81e47bed3275728eee1a676ba95e4f2b41d",
            "patch": "@@ -1,100 +0,0 @@\n-# Copyright 2008 the V8 project authors. All rights reserved.\n-# Redistribution and use in source and binary forms, with or without\n-# modification, are permitted provided that the following conditions are\n-# met:\n-#\n-#     * Redistributions of source code must retain the above copyright\n-#       notice, this list of conditions and the following disclaimer.\n-#     * Redistributions in binary form must reproduce the above\n-#       copyright notice, this list of conditions and the following\n-#       disclaimer in the documentation and/or other materials provided\n-#       with the distribution.\n-#     * Neither the name of Google Inc. nor the names of its\n-#       contributors may be used to endorse or promote products derived\n-#       from this software without specific prior written permission.\n-#\n-# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n-# \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n-# LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n-# A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n-# OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n-# SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n-# LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n-# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n-# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n-# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n-# OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n-\n-import test\n-import os\n-from os.path import join, exists\n-import re\n-import shlex\n-\n-FAKETIME_FLAGS_PATTERN = re.compile(r\"//\\s+FaketimeFlags:(.*)\")\n-FAKETIME_BIN_PATH = os.path.join(\"tools\", \"faketime\", \"src\", \"faketime\")\n-\n-class TimersTestCase(test.TestCase):\n-\n-  def __init__(self, path, file, arch, mode, context, config):\n-    super(TimersTestCase, self).__init__(context, path, arch, mode)\n-    self.file = file\n-    self.config = config\n-    self.arch = arch\n-    self.mode = mode\n-\n-  def GetLabel(self):\n-    return \"%s %s\" % (self.mode, self.GetName())\n-\n-  def GetName(self):\n-    return self.path[-1]\n-\n-  def GetCommand(self):\n-    result = [FAKETIME_BIN_PATH];\n-\n-    source = open(self.file).read()\n-    faketime_flags_match = FAKETIME_FLAGS_PATTERN.search(source)\n-    if faketime_flags_match:\n-      result += shlex.split(faketime_flags_match.group(1).strip())\n-\n-    result += [self.config.context.GetVm(self.arch, self.mode)]\n-    result += [self.file]\n-\n-    return result\n-\n-  def GetSource(self):\n-    return open(self.file).read()\n-\n-\n-class TimersTestConfiguration(test.TestConfiguration):\n-\n-  def __init__(self, context, root):\n-    super(TimersTestConfiguration, self).__init__(context, root)\n-\n-  def Ls(self, path):\n-    def SelectTest(name):\n-      return name.startswith('test-') and name.endswith('.js')\n-    return [f[:-3] for f in os.listdir(path) if SelectTest(f)]\n-\n-  def ListTests(self, current_path, path, arch, mode):\n-    all_tests = [current_path + [t] for t in self.Ls(join(self.root))]\n-    result = []\n-    for test in all_tests:\n-      if self.Contains(path, test):\n-        file_path = join(self.root, reduce(join, test[1:], \"\") + \".js\")\n-        result.append(TimersTestCase(test, file_path, arch, mode,\n-                                     self.context, self))\n-    return result\n-\n-  def GetBuildRequirements(self):\n-    return ['sample', 'sample=shell']\n-\n-  def GetTestStatus(self, sections, defs):\n-    status_file = join(self.root, 'simple.status')\n-    if exists(status_file):\n-      test.ReadConfigurationInto(status_file, sections, defs)\n-\n-\n-\n-def GetConfiguration(context, root):\n-  return TimersTestConfiguration(context, root)"
        },
        {
            "sha": "d627c149d6748e2df397f9095e00afbd3f861957",
            "filename": "tools/Makefile",
            "status": "removed",
            "additions": 0,
            "deletions": 20,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/1e7ff81e47bed3275728eee1a676ba95e4f2b41d/tools%2FMakefile",
            "raw_url": "https://github.com/nodejs/node/raw/1e7ff81e47bed3275728eee1a676ba95e4f2b41d/tools%2FMakefile",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2FMakefile?ref=1e7ff81e47bed3275728eee1a676ba95e4f2b41d",
            "patch": "@@ -1,20 +0,0 @@\n-FAKETIME_REPO       := git://github.com/wolfcw/libfaketime.git\n-FAKETIME_LOCAL_REPO := $(CURDIR)/faketime\n-FAKETIME_BRANCH     := master\n-FAKETIME_BINARY     := $(FAKETIME_PREFIX)/bin/faketime\n-\n-.PHONY: faketime\n-\n-faketime: $(FAKETIME_BINARY)\n-\n-clean:\n-\t$(RM) -r $(FAKETIME_LOCAL_REPO)\n-\n-$(FAKETIME_BINARY): $(FAKETIME_LOCAL_REPO)\n-\tcd $(FAKETIME_LOCAL_REPO) && \\\n-\tgit checkout $(FAKETIME_BRANCH) && \\\n-\tPREFIX=$(FAKETIME_LOCAL_REPO)/src make\n-\n-$(FAKETIME_LOCAL_REPO):\n-\tgit clone $(FAKETIME_REPO) $(FAKETIME_LOCAL_REPO)\n-"
        }
    ],
    "stats": {
        "total": 182,
        "additions": 0,
        "deletions": 182
    }
}