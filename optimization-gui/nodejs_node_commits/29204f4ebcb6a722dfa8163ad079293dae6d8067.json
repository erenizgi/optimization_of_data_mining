{
    "author": "unknown",
    "message": "tools: prepare tools/test.py for Python 3\n\nPR-URL: https://github.com/nodejs/node/pull/24799\nReviewed-By: Rich Trott <rtrott@gmail.com>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>",
    "sha": "29204f4ebcb6a722dfa8163ad079293dae6d8067",
    "files": [
        {
            "sha": "be2179e6fb74103d2bd5dcc688d6fbdc6a9f7f36",
            "filename": "tools/test.py",
            "status": "modified",
            "additions": 21,
            "deletions": 11,
            "changes": 32,
            "blob_url": "https://github.com/nodejs/node/blob/29204f4ebcb6a722dfa8163ad079293dae6d8067/tools%2Ftest.py",
            "raw_url": "https://github.com/nodejs/node/raw/29204f4ebcb6a722dfa8163ad079293dae6d8067/tools%2Ftest.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Ftest.py?ref=29204f4ebcb6a722dfa8163ad079293dae6d8067",
            "patch": "@@ -50,6 +50,16 @@\n from datetime import datetime\n from Queue import Queue, Empty\n \n+try:\n+  reduce          # Python 2\n+except NameError:   # Python 3\n+  from functools import reduce\n+\n+try:\n+  xrange          # Python 2\n+except NameError:\n+  xrange = range  # Python 3\n+\n logger = logging.getLogger('testrunner')\n skip_regex = re.compile(r'# SKIP\\S*\\s+(.*)', re.IGNORECASE)\n \n@@ -110,9 +120,9 @@ def Run(self, tasks):\n       for thread in threads:\n         # Use a timeout so that signals (ctrl-c) will be processed.\n         thread.join(timeout=10000000)\n-    except (KeyboardInterrupt, SystemExit), e:\n+    except (KeyboardInterrupt, SystemExit) as e:\n       self.shutdown_event.set()\n-    except Exception, e:\n+    except Exception as e:\n       # If there's an exception we schedule an interruption for any\n       # remaining threads.\n       self.shutdown_event.set()\n@@ -149,7 +159,7 @@ def RunSingle(self, parallel, thread_id):\n             output = case.Run()\n             output.diagnostic.append('ECONNREFUSED received, test retried')\n         case.duration = (datetime.now() - start)\n-      except IOError, e:\n+      except IOError as e:\n         return\n       if self.shutdown_event.is_set():\n         return\n@@ -600,7 +610,7 @@ def Win32SetErrorMode(mode):\n   prev_error_mode = SEM_INVALID_VALUE\n   try:\n     import ctypes\n-    prev_error_mode = ctypes.windll.kernel32.SetErrorMode(mode);\n+    prev_error_mode = ctypes.windll.kernel32.SetErrorMode(mode)\n   except ImportError:\n     pass\n   return prev_error_mode\n@@ -619,15 +629,15 @@ def KillTimedOutProcess(context, pid):\n def RunProcess(context, timeout, args, **rest):\n   if context.verbose: print(\"#\", \" \".join(args))\n   popen_args = args\n-  prev_error_mode = SEM_INVALID_VALUE;\n+  prev_error_mode = SEM_INVALID_VALUE\n   if utils.IsWindows():\n     if context.suppress_dialogs:\n       # Try to change the error mode to avoid dialogs on fatal errors. Don't\n       # touch any existing error mode flags by merging the existing error mode.\n       # See http://blogs.msdn.com/oldnewthing/archive/2004/07/27/198410.aspx.\n-      error_mode = SEM_NOGPFAULTERRORBOX;\n-      prev_error_mode = Win32SetErrorMode(error_mode);\n-      Win32SetErrorMode(error_mode | prev_error_mode);\n+      error_mode = SEM_NOGPFAULTERRORBOX\n+      prev_error_mode = Win32SetErrorMode(error_mode)\n+      Win32SetErrorMode(error_mode | prev_error_mode)\n \n   faketty = rest.pop('faketty', False)\n   pty_out = rest.pop('pty_out')\n@@ -696,7 +706,7 @@ def CheckedUnlink(name):\n   while True:\n     try:\n       os.unlink(name)\n-    except OSError, e:\n+    except OSError as e:\n       # On Windows unlink() fails if another process (typically a virus scanner\n       # or the indexing service) has the file open. Those processes keep a\n       # file open for a short time only, so yield and try again; it'll succeed.\n@@ -765,8 +775,8 @@ def disableCoreFiles():\n   else:\n     os.close(fd_out)\n     os.close(fd_err)\n-    output = file(outname).read()\n-    errors = file(errname).read()\n+    output = open(outname).read()\n+    errors = open(errname).read()\n     CheckedUnlink(outname)\n     CheckedUnlink(errname)\n "
        }
    ],
    "stats": {
        "total": 32,
        "additions": 21,
        "deletions": 11
    }
}