{
    "author": "danbev",
    "message": "crypto: add getIntOption function to reduce dupl\n\nThis commit adds a getIntOption function to reduce the code duplicated\nfor getting the padding, and saltLength options.\n\nPR-URL: https://github.com/nodejs/node/pull/20247\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "d4726d2f3f7a411b2d22d2ef04fe42f8d5e22fcf",
    "files": [
        {
            "sha": "92b42412a82e92d4081cb54679a5ae8a841b4838",
            "filename": "lib/internal/crypto/sig.js",
            "status": "modified",
            "additions": 23,
            "deletions": 32,
            "changes": 55,
            "blob_url": "https://github.com/nodejs/node/blob/d4726d2f3f7a411b2d22d2ef04fe42f8d5e22fcf/lib%2Finternal%2Fcrypto%2Fsig.js",
            "raw_url": "https://github.com/nodejs/node/raw/d4726d2f3f7a411b2d22d2ef04fe42f8d5e22fcf/lib%2Finternal%2Fcrypto%2Fsig.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fcrypto%2Fsig.js?ref=d4726d2f3f7a411b2d22d2ef04fe42f8d5e22fcf",
            "patch": "@@ -53,6 +53,25 @@ Sign.prototype.update = function update(data, encoding) {\n   return this;\n };\n \n+function getPadding(options) {\n+  return getIntOption('padding', RSA_PKCS1_PADDING, options);\n+}\n+\n+function getSaltLength(options) {\n+  return getIntOption('saltLength', RSA_PSS_SALTLEN_AUTO, options);\n+}\n+\n+function getIntOption(name, defaultValue, options) {\n+  if (options.hasOwnProperty(name)) {\n+    if (options[name] === options[name] >> 0) {\n+      return options[name];\n+    } else {\n+      throw new ERR_INVALID_OPT_VALUE(name, options[name]);\n+    }\n+  }\n+  return defaultValue;\n+}\n+\n Sign.prototype.sign = function sign(options, encoding) {\n   if (!options)\n     throw new ERR_CRYPTO_SIGN_KEY_REQUIRED();\n@@ -61,23 +80,9 @@ Sign.prototype.sign = function sign(options, encoding) {\n   var passphrase = options.passphrase || null;\n \n   // Options specific to RSA\n-  var rsaPadding = RSA_PKCS1_PADDING;\n-  if (options.hasOwnProperty('padding')) {\n-    if (options.padding === options.padding >> 0) {\n-      rsaPadding = options.padding;\n-    } else {\n-      throw new ERR_INVALID_OPT_VALUE('padding', options.padding);\n-    }\n-  }\n+  var rsaPadding = getPadding(options);\n \n-  var pssSaltLength = RSA_PSS_SALTLEN_AUTO;\n-  if (options.hasOwnProperty('saltLength')) {\n-    if (options.saltLength === options.saltLength >> 0) {\n-      pssSaltLength = options.saltLength;\n-    } else {\n-      throw new ERR_INVALID_OPT_VALUE('saltLength', options.saltLength);\n-    }\n-  }\n+  var pssSaltLength = getSaltLength(options);\n \n   key = toBuf(key);\n   if (!isArrayBufferView(key)) {\n@@ -119,23 +124,9 @@ Verify.prototype.verify = function verify(options, signature, sigEncoding) {\n   sigEncoding = sigEncoding || getDefaultEncoding();\n \n   // Options specific to RSA\n-  var rsaPadding = RSA_PKCS1_PADDING;\n-  if (options.hasOwnProperty('padding')) {\n-    if (options.padding === options.padding >> 0) {\n-      rsaPadding = options.padding;\n-    } else {\n-      throw new ERR_INVALID_OPT_VALUE('padding', options.padding);\n-    }\n-  }\n+  var rsaPadding = getPadding(options);\n \n-  var pssSaltLength = RSA_PSS_SALTLEN_AUTO;\n-  if (options.hasOwnProperty('saltLength')) {\n-    if (options.saltLength === options.saltLength >> 0) {\n-      pssSaltLength = options.saltLength;\n-    } else {\n-      throw new ERR_INVALID_OPT_VALUE('saltLength', options.saltLength);\n-    }\n-  }\n+  var pssSaltLength = getSaltLength(options);\n \n   key = toBuf(key);\n   if (!isArrayBufferView(key)) {"
        }
    ],
    "stats": {
        "total": 55,
        "additions": 23,
        "deletions": 32
    }
}