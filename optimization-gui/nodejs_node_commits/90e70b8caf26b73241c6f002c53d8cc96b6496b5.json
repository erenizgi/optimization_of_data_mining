{
    "author": "addaleax",
    "message": "http2: simplify timeout tracking\n\nThereâ€™s no need to reset the chunk counter for every write.\n\nPR-URL: https://github.com/nodejs/node/pull/19206\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "90e70b8caf26b73241c6f002c53d8cc96b6496b5",
    "files": [
        {
            "sha": "d683b075bc2ed3e6bfba09b17b18726dacc50b07",
            "filename": "src/node_http2.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/90e70b8caf26b73241c6f002c53d8cc96b6496b5/src%2Fnode_http2.cc",
            "raw_url": "https://github.com/nodejs/node/raw/90e70b8caf26b73241c6f002c53d8cc96b6496b5/src%2Fnode_http2.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_http2.cc?ref=90e70b8caf26b73241c6f002c53d8cc96b6496b5",
            "patch": "@@ -1630,10 +1630,6 @@ inline Http2Stream* Http2Session::SubmitRequest(\n   return stream;\n }\n \n-inline void Http2Session::SetChunksSinceLastWrite(size_t n) {\n-  chunks_sent_since_last_write_ = n;\n-}\n-\n // Callback used to receive inbound data from the i/o stream\n void Http2Session::OnStreamRead(ssize_t nread, const uv_buf_t& buf) {\n   Http2Scope h2scope(this);\n@@ -2016,7 +2012,6 @@ inline int Http2Stream::DoWrite(WriteWrap* req_wrap,\n   CHECK(!this->IsDestroyed());\n   CHECK_EQ(send_handle, nullptr);\n   Http2Scope h2scope(this);\n-  session_->SetChunksSinceLastWrite();\n   if (!IsWritable()) {\n     req_wrap->Done(UV_EOF);\n     return 0;\n@@ -2519,8 +2514,6 @@ void Http2Stream::RespondFD(const FunctionCallbackInfo<Value>& args) {\n   int64_t length = args[3]->IntegerValue(context).ToChecked();\n   int options = args[4]->IntegerValue(context).ToChecked();\n \n-  stream->session()->SetChunksSinceLastWrite();\n-\n   Headers list(isolate, context, headers);\n   args.GetReturnValue().Set(stream->SubmitFile(fd, *list, list.length(),\n                                                offset, length, options));"
        },
        {
            "sha": "08109dcf046ba4ed6acaa5539dcb640259a007a2",
            "filename": "src/node_http2.h",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/90e70b8caf26b73241c6f002c53d8cc96b6496b5/src%2Fnode_http2.h",
            "raw_url": "https://github.com/nodejs/node/raw/90e70b8caf26b73241c6f002c53d8cc96b6496b5/src%2Fnode_http2.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_http2.h?ref=90e70b8caf26b73241c6f002c53d8cc96b6496b5",
            "patch": "@@ -884,8 +884,6 @@ class Http2Session : public AsyncWrap, public StreamListener {\n   // Write data to the session\n   inline ssize_t Write(const uv_buf_t* bufs, size_t nbufs);\n \n-  inline void SetChunksSinceLastWrite(size_t n = 0);\n-\n   size_t self_size() const override { return sizeof(*this); }\n \n   inline void GetTrailers(Http2Stream* stream, uint32_t* flags);"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 0,
        "deletions": 9
    }
}