{
    "author": "mroderick",
    "message": "http: change DEP0066 to a runtime deprecation\n\nChange doc-only deprecation for _headers and _headerNames accessors to a\nruntime deprecation.\n\nPR-URL: https://github.com/nodejs/node/pull/24167\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: Sakthipriyan Vairamani <thechargingvolcano@gmail.com>",
    "sha": "91748dd89c652939d52f38b94afe9eae4eb8fd5d",
    "files": [
        {
            "sha": "910606e4f79f5140fb89b11e3732b569b1031d77",
            "filename": "doc/api/deprecations.md",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/91748dd89c652939d52f38b94afe9eae4eb8fd5d/doc%2Fapi%2Fdeprecations.md",
            "raw_url": "https://github.com/nodejs/node/raw/91748dd89c652939d52f38b94afe9eae4eb8fd5d/doc%2Fapi%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fdeprecations.md?ref=91748dd89c652939d52f38b94afe9eae4eb8fd5d",
            "patch": "@@ -1344,12 +1344,15 @@ removed. Please use `sloppy` instead.\n ### DEP0066: outgoingMessage.\\_headers, outgoingMessage.\\_headerNames\n <!-- YAML\n changes:\n+  - version: REPLACEME\n+    pr-url: https://github.com/nodejs/node/pull/24167\n+    description: Runtime deprecation.\n   - version: v8.0.0\n     pr-url: https://github.com/nodejs/node/pull/10941\n     description: Documentation-only deprecation.\n -->\n \n-Type: Documentation-only\n+Type: Runtime\n \n The `http` module `outgoingMessage._headers` and `outgoingMessage._headerNames`\n properties are deprecated. Use one of the public methods"
        },
        {
            "sha": "3bedce9d515b38ed06d1f94611043dcd653ae7bb",
            "filename": "lib/_http_outgoing.js",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/91748dd89c652939d52f38b94afe9eae4eb8fd5d/lib%2F_http_outgoing.js",
            "raw_url": "https://github.com/nodejs/node/raw/91748dd89c652939d52f38b94afe9eae4eb8fd5d/lib%2F_http_outgoing.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_outgoing.js?ref=91748dd89c652939d52f38b94afe9eae4eb8fd5d",
            "patch": "@@ -110,10 +110,10 @@ util.inherits(OutgoingMessage, Stream);\n \n \n Object.defineProperty(OutgoingMessage.prototype, '_headers', {\n-  get: function() {\n+  get: util.deprecate(function() {\n     return this.getHeaders();\n-  },\n-  set: function(val) {\n+  }, 'OutgoingMessage.prototype._headers is deprecated', 'DEP0066'),\n+  set: util.deprecate(function(val) {\n     if (val == null) {\n       this[outHeadersKey] = null;\n     } else if (typeof val === 'object') {\n@@ -124,11 +124,11 @@ Object.defineProperty(OutgoingMessage.prototype, '_headers', {\n         headers[name.toLowerCase()] = [name, val[name]];\n       }\n     }\n-  }\n+  }, 'OutgoingMessage.prototype._headers is deprecated', 'DEP0066')\n });\n \n Object.defineProperty(OutgoingMessage.prototype, '_headerNames', {\n-  get: function() {\n+  get: util.deprecate(function() {\n     const headers = this[outHeadersKey];\n     if (headers !== null) {\n       const out = Object.create(null);\n@@ -141,8 +141,8 @@ Object.defineProperty(OutgoingMessage.prototype, '_headerNames', {\n       return out;\n     }\n     return null;\n-  },\n-  set: function(val) {\n+  }, 'OutgoingMessage.prototype._headerNames is deprecated', 'DEP0066'),\n+  set: util.deprecate(function(val) {\n     if (typeof val === 'object' && val !== null) {\n       const headers = this[outHeadersKey];\n       if (!headers)\n@@ -154,7 +154,7 @@ Object.defineProperty(OutgoingMessage.prototype, '_headerNames', {\n           header[0] = val[keys[i]];\n       }\n     }\n-  }\n+  }, 'OutgoingMessage.prototype._headerNames is deprecated', 'DEP0066')\n });\n \n "
        },
        {
            "sha": "c8bd1f13d5c6e5536d66bdce02f9126c1765e0c8",
            "filename": "test/parallel/test-http-outgoing-internal-headernames-getter.js",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/91748dd89c652939d52f38b94afe9eae4eb8fd5d/test%2Fparallel%2Ftest-http-outgoing-internal-headernames-getter.js",
            "raw_url": "https://github.com/nodejs/node/raw/91748dd89c652939d52f38b94afe9eae4eb8fd5d/test%2Fparallel%2Ftest-http-outgoing-internal-headernames-getter.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http-outgoing-internal-headernames-getter.js?ref=91748dd89c652939d52f38b94afe9eae4eb8fd5d",
            "patch": "@@ -0,0 +1,13 @@\n+'use strict';\n+const common = require('../common');\n+\n+const { OutgoingMessage } = require('http');\n+\n+const warn = 'OutgoingMessage.prototype._headerNames is deprecated';\n+common.expectWarning('DeprecationWarning', warn, 'DEP0066');\n+\n+{\n+  // tests for _headerNames get method\n+  const outgoingMessage = new OutgoingMessage();\n+  outgoingMessage._headerNames;\n+}"
        },
        {
            "sha": "732907669833688147fa991ca6c0eeecaaf21e60",
            "filename": "test/parallel/test-http-outgoing-internal-headernames-setter.js",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/91748dd89c652939d52f38b94afe9eae4eb8fd5d/test%2Fparallel%2Ftest-http-outgoing-internal-headernames-setter.js",
            "raw_url": "https://github.com/nodejs/node/raw/91748dd89c652939d52f38b94afe9eae4eb8fd5d/test%2Fparallel%2Ftest-http-outgoing-internal-headernames-setter.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http-outgoing-internal-headernames-setter.js?ref=91748dd89c652939d52f38b94afe9eae4eb8fd5d",
            "patch": "@@ -0,0 +1,15 @@\n+'use strict';\n+const common = require('../common');\n+\n+const { OutgoingMessage } = require('http');\n+\n+const warn = 'OutgoingMessage.prototype._headerNames is deprecated';\n+common.expectWarning('DeprecationWarning', warn, 'DEP0066');\n+\n+{\n+  // tests for _headerNames set method\n+  const outgoingMessage = new OutgoingMessage();\n+  outgoingMessage._headerNames = {\n+    'x-flow-id': '61bba6c5-28a3-4eab-9241-2ecaa6b6a1fd'\n+  };\n+}"
        },
        {
            "sha": "2cebfe9e2b966af4126bb77fdd13564d9029e781",
            "filename": "test/parallel/test-http-outgoing-internal-headers.js",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/91748dd89c652939d52f38b94afe9eae4eb8fd5d/test%2Fparallel%2Ftest-http-outgoing-internal-headers.js",
            "raw_url": "https://github.com/nodejs/node/raw/91748dd89c652939d52f38b94afe9eae4eb8fd5d/test%2Fparallel%2Ftest-http-outgoing-internal-headers.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http-outgoing-internal-headers.js?ref=91748dd89c652939d52f38b94afe9eae4eb8fd5d",
            "patch": "@@ -6,6 +6,9 @@ const assert = require('assert');\n const { outHeadersKey } = require('internal/http');\n const { OutgoingMessage } = require('http');\n \n+const warn = 'OutgoingMessage.prototype._headers is deprecated';\n+common.expectWarning('DeprecationWarning', warn, 'DEP0066');\n+\n {\n   // tests for _headers get method\n   const outgoingMessage = new OutgoingMessage();"
        }
    ],
    "stats": {
        "total": 52,
        "additions": 43,
        "deletions": 9
    }
}