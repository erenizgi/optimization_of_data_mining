{
    "author": "addaleax",
    "message": "src: slightly simplify `FSEventWrap`\n\nWe donâ€™t need to track `initialized_`, `HandleWrap` already does\nthat for us.\n\nPR-URL: https://github.com/nodejs/node/pull/21533\nReviewed-By: Eugene Ostroukhov <eostroukhov@google.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "bf360d2e151f9025a990e671147117139e596bfe",
    "files": [
        {
            "sha": "164614ae81145f5e64c390deb288a73370911c1a",
            "filename": "src/fs_event_wrap.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 15,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/bf360d2e151f9025a990e671147117139e596bfe/src%2Ffs_event_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/bf360d2e151f9025a990e671147117139e596bfe/src%2Ffs_event_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ffs_event_wrap.cc?ref=bf360d2e151f9025a990e671147117139e596bfe",
            "patch": "@@ -55,7 +55,6 @@ class FSEventWrap: public HandleWrap {\n                          Local<Context> context);\n   static void New(const FunctionCallbackInfo<Value>& args);\n   static void Start(const FunctionCallbackInfo<Value>& args);\n-  static void Close(const FunctionCallbackInfo<Value>& args);\n   static void GetInitialized(const FunctionCallbackInfo<Value>& args);\n   size_t self_size() const override { return sizeof(*this); }\n \n@@ -69,7 +68,6 @@ class FSEventWrap: public HandleWrap {\n     int status);\n \n   uv_fs_event_t handle_;\n-  bool initialized_ = false;\n   enum encoding encoding_ = kDefaultEncoding;\n };\n \n@@ -89,7 +87,7 @@ FSEventWrap::~FSEventWrap() {\n void FSEventWrap::GetInitialized(const FunctionCallbackInfo<Value>& args) {\n   FSEventWrap* wrap = Unwrap<FSEventWrap>(args.This());\n   CHECK_NOT_NULL(wrap);\n-  args.GetReturnValue().Set(wrap->initialized_);\n+  args.GetReturnValue().Set(!wrap->IsHandleClosing());\n }\n \n void FSEventWrap::Initialize(Local<Object> target,\n@@ -134,7 +132,7 @@ void FSEventWrap::Start(const FunctionCallbackInfo<Value>& args) {\n \n   FSEventWrap* wrap = Unwrap<FSEventWrap>(args.This());\n   CHECK_NOT_NULL(wrap);\n-  CHECK(!wrap->initialized_);\n+  CHECK(wrap->IsHandleClosing());  // Check that Start() has not been called.\n \n   const int argc = args.Length();\n   CHECK_GE(argc, 4);\n@@ -155,7 +153,6 @@ void FSEventWrap::Start(const FunctionCallbackInfo<Value>& args) {\n \n   err = uv_fs_event_start(&wrap->handle_, OnEvent, *path, flags);\n   wrap->MarkAsInitialized();\n-  wrap->initialized_ = true;\n \n   if (err != 0) {\n     FSEventWrap::Close(args);\n@@ -230,16 +227,6 @@ void FSEventWrap::OnEvent(uv_fs_event_t* handle, const char* filename,\n   wrap->MakeCallback(env->onchange_string(), arraysize(argv), argv);\n }\n \n-\n-void FSEventWrap::Close(const FunctionCallbackInfo<Value>& args) {\n-  FSEventWrap* wrap = Unwrap<FSEventWrap>(args.Holder());\n-  CHECK_NOT_NULL(wrap);\n-  CHECK(wrap->initialized_);\n-\n-  wrap->initialized_ = false;\n-  HandleWrap::Close(args);\n-}\n-\n }  // anonymous namespace\n }  // namespace node\n "
        }
    ],
    "stats": {
        "total": 17,
        "additions": 2,
        "deletions": 15
    }
}