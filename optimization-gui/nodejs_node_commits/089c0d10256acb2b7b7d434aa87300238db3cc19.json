{
    "author": "addaleax",
    "message": "cli: more flexible width when printing `--help`\n\nPR-URL: https://github.com/nodejs/node/pull/22637\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "089c0d10256acb2b7b7d434aa87300238db3cc19",
    "files": [
        {
            "sha": "00c8330daaaa140cd4c931d63dc248528addd000",
            "filename": "lib/internal/print_help.js",
            "status": "modified",
            "additions": 16,
            "deletions": 4,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/089c0d10256acb2b7b7d434aa87300238db3cc19/lib%2Finternal%2Fprint_help.js",
            "raw_url": "https://github.com/nodejs/node/raw/089c0d10256acb2b7b7d434aa87300238db3cc19/lib%2Finternal%2Fprint_help.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fprint_help.js?ref=089c0d10256acb2b7b7d434aa87300238db3cc19",
            "patch": "@@ -69,6 +69,7 @@ function getArgDescription(type) {\n \n function format({ options, aliases = new Map(), firstColumn, secondColumn }) {\n   let text = '';\n+  let maxFirstColumnUsed = 0;\n \n   for (const [\n     name, { helpText, type, value }\n@@ -106,6 +107,7 @@ function format({ options, aliases = new Map(), firstColumn, secondColumn }) {\n     }\n \n     text += displayName;\n+    maxFirstColumnUsed = Math.max(maxFirstColumnUsed, displayName.length);\n     if (displayName.length >= firstColumn)\n       text += '\\n' + ' '.repeat(firstColumn);\n     else\n@@ -115,16 +117,26 @@ function format({ options, aliases = new Map(), firstColumn, secondColumn }) {\n                    firstColumn).trimLeft() + '\\n';\n   }\n \n+  if (maxFirstColumnUsed < firstColumn - 4) {\n+    // If we have more than 4 blank gap spaces, reduce first column width.\n+    return format({\n+      options,\n+      aliases,\n+      firstColumn: maxFirstColumnUsed + 2,\n+      secondColumn\n+    });\n+  }\n+\n   return text;\n }\n \n function print(stream) {\n   const { options, aliases } = getOptions();\n \n-  // TODO(addaleax): Allow a bit of expansion depending on `stream.columns`\n-  // if it is set.\n-  const firstColumn = 28;\n-  const secondColumn = 40;\n+  // Use 75 % of the available width, and at least 70 characters.\n+  const width = Math.max(70, (stream.columns || 0) * 0.75);\n+  const firstColumn = Math.floor(width * 0.4);\n+  const secondColumn = Math.floor(width * 0.57);\n \n   options.set('-', { helpText: 'script read from stdin (default; ' +\n                                'interactive mode if a tty)' });"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 16,
        "deletions": 4
    }
}