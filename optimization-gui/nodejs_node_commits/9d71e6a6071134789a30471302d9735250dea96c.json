{
    "author": "jasnell",
    "message": "src: deprecate global COUNTER_* and remove perfctr\n\nTo support Performance Counters on Windows, a number of\nglobal `COUNTER_` methods were added that are undocumented\nand really only intended to be used internally by Node.js.\n\nUnfortunately, the perfctr support apparently hasn't even\nworked for quite a while and no one has even complained.\n\nThis removes the perfctr support and replaces the global\nfunctions with deprecated non-ops for now, with the intent\nof removing those outright in the next major release cycle.\n\nPR-URL: https://github.com/nodejs/node/pull/22485\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Jo√£o Reis <reis@janeasystems.com>",
    "sha": "9d71e6a6071134789a30471302d9735250dea96c",
    "files": [
        {
            "sha": "349dca827e81c77e96ed1838d385e9a72e8da0a2",
            "filename": "configure.py",
            "status": "modified",
            "additions": 0,
            "deletions": 18,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/configure.py",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/configure.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/configure.py?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -455,11 +455,6 @@\n \n parser.add_option_group(http2_optgroup)\n \n-parser.add_option('--with-perfctr',\n-    action='store_true',\n-    dest='with_perfctr',\n-    help='build with performance counters (default is true on Windows)')\n-\n parser.add_option('--without-dtrace',\n     action='store_true',\n     dest='without_dtrace',\n@@ -475,11 +470,6 @@\n     dest='without_npm',\n     help='do not install the bundled npm (package manager)')\n \n-parser.add_option('--without-perfctr',\n-    action='store_true',\n-    dest='without_perfctr',\n-    help='build without performance counters')\n-\n # Dummy option for backwards compatibility\n parser.add_option('--with-snapshot',\n     action='store_true',\n@@ -1018,14 +1008,6 @@ def configure_node(o):\n   else:\n     o['variables']['node_use_etw'] = 'false'\n \n-  # By default, enable Performance counters on Windows.\n-  if flavor == 'win':\n-    o['variables']['node_use_perfctr'] = b(not options.without_perfctr)\n-  elif options.with_perfctr:\n-    raise Exception('Performance counter is only supported on Windows.')\n-  else:\n-    o['variables']['node_use_perfctr'] = 'false'\n-\n   o['variables']['node_with_ltcg'] = b(options.with_ltcg)\n   if flavor != 'win' and options.with_ltcg:\n     raise Exception('Link Time Code Generation is only supported on Windows.')"
        },
        {
            "sha": "cbc77744894bd9f7afef9ad3c05aa8e54814ea83",
            "filename": "lib/_http_client.js",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/lib%2F_http_client.js",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/lib%2F_http_client.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_client.js?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -285,7 +285,6 @@ util.inherits(ClientRequest, OutgoingMessage);\n \n ClientRequest.prototype._finish = function _finish() {\n   DTRACE_HTTP_CLIENT_REQUEST(this, this.connection);\n-  COUNTER_HTTP_CLIENT_REQUEST();\n   OutgoingMessage.prototype._finish.call(this);\n };\n \n@@ -554,7 +553,6 @@ function parserOnIncomingClient(res, shouldKeepAlive) {\n   }\n \n   DTRACE_HTTP_CLIENT_RESPONSE(socket, req);\n-  COUNTER_HTTP_CLIENT_RESPONSE();\n   req.res = res;\n   res.req = req;\n "
        },
        {
            "sha": "b216eab32a3542efefc5b38cbf1b3e0f21d5e0b5",
            "filename": "lib/_http_server.js",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/lib%2F_http_server.js",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/lib%2F_http_server.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_server.js?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -140,7 +140,6 @@ util.inherits(ServerResponse, OutgoingMessage);\n \n ServerResponse.prototype._finish = function _finish() {\n   DTRACE_HTTP_SERVER_RESPONSE(this.connection);\n-  COUNTER_HTTP_SERVER_RESPONSE();\n   OutgoingMessage.prototype._finish.call(this);\n };\n \n@@ -624,7 +623,6 @@ function parserOnIncoming(server, socket, state, req, keepAlive) {\n \n   res.shouldKeepAlive = keepAlive;\n   DTRACE_HTTP_SERVER_REQUEST(req, socket);\n-  COUNTER_HTTP_SERVER_REQUEST();\n \n   if (socket._httpMessage) {\n     // There are already pending outgoing res, append."
        },
        {
            "sha": "997323d810978e1125bc1841c84e024c7a9be8ca",
            "filename": "lib/internal/bootstrap/node.js",
            "status": "modified",
            "additions": 26,
            "deletions": 1,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fnode.js?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -172,11 +172,11 @@\n       NativeModule.require('internal/process/esm_loader').setup();\n     }\n \n+    const { deprecate } = NativeModule.require('internal/util');\n     {\n       // Install legacy getters on the `util` binding for typechecking.\n       // TODO(addaleax): Turn into a full runtime deprecation.\n       const { pendingDeprecation } = process.binding('config');\n-      const { deprecate } = NativeModule.require('internal/util');\n       const utilBinding = internalBinding('util');\n       const types = internalBinding('types');\n       for (const name of [\n@@ -195,6 +195,31 @@\n       }\n     }\n \n+    // TODO(jasnell): The following have been globals since around 2012.\n+    // That's just silly. The underlying perfctr support has been removed\n+    // so these are now deprecated non-ops that can be removed after one\n+    // major release cycle.\n+    if (process.platform === 'win32') {\n+      function noop() {}\n+      const names = [\n+        'NET_SERVER_CONNECTION',\n+        'NET_SERVER_CONNECTION_CLOSE',\n+        'HTTP_SERVER_REQUEST',\n+        'HTTP_SERVER_RESPONSE',\n+        'HTTP_CLIENT_REQUEST',\n+        'HTTP_CLIENT_RESPONSE'\n+      ];\n+      for (var n = 0; n < names.length; n++) {\n+        Object.defineProperty(global, `COUNTER_${names[n]}`, {\n+          configurable: true,\n+          enumerable: false,\n+          value: deprecate(noop,\n+                           `COUNTER_${names[n]}() is deprecated.`,\n+                           'DEP00XX')\n+        });\n+      }\n+    }\n+\n     perf.markMilestone(NODE_PERFORMANCE_MILESTONE_BOOTSTRAP_COMPLETE);\n \n     setupAllowedFlags();"
        },
        {
            "sha": "fdf7e8a1d0f910854442c4d15d1b8e5b40c81a18",
            "filename": "lib/net.js",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/lib%2Fnet.js",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/lib%2Fnet.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fnet.js?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -615,7 +615,6 @@ Socket.prototype._destroy = function(exception, cb) {\n   cb(exception);\n \n   if (this._server) {\n-    COUNTER_NET_SERVER_CONNECTION_CLOSE(this);\n     debug('has server');\n     this._server._connections--;\n     if (this._server._emitCloseIfDrained) {\n@@ -1522,7 +1521,6 @@ function onconnection(err, clientHandle) {\n   socket._server = self;\n \n   DTRACE_NET_SERVER_CONNECTION(socket);\n-  COUNTER_NET_SERVER_CONNECTION(socket);\n   self.emit('connection', socket);\n }\n "
        },
        {
            "sha": "77d24d142e331db8313ec22ec50558d53aa672b1",
            "filename": "node.gyp",
            "status": "modified",
            "additions": 0,
            "deletions": 58,
            "changes": 58,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/node.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/node.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/node.gyp?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -4,7 +4,6 @@\n     'v8_trace_maps%': 0,\n     'node_use_dtrace%': 'false',\n     'node_use_etw%': 'false',\n-    'node_use_perfctr%': 'false',\n     'node_no_browser_globals%': 'false',\n     'node_code_cache_path%': '',\n     'node_use_v8_platform%': 'true',\n@@ -285,11 +284,6 @@\n                   'sources': [\n                     'tools/msvs/genfiles/node_etw_provider.rc'\n                   ],\n-                }],\n-                [ 'node_use_perfctr==\"true\"', {\n-                  'sources': [\n-                    'tools/msvs/genfiles/node_perfctr_provider.rc',\n-                   ],\n                 }]\n               ],\n             }],\n@@ -569,28 +563,6 @@\n             }],\n           ],\n         }],\n-        [ 'node_use_perfctr==\"true\"', {\n-          'defines': [ 'HAVE_PERFCTR=1' ],\n-          'dependencies': [ 'node_perfctr' ],\n-          'include_dirs': [\n-            'src',\n-            'tools/msvs/genfiles',\n-            '<(SHARED_INTERMEDIATE_DIR)' # for node_natives.h\n-          ],\n-          'sources': [\n-            'src/node_win32_perfctr_provider.h',\n-            'src/node_win32_perfctr_provider.cc',\n-            'src/node_counters.cc',\n-            'src/node_counters.h',\n-          ],\n-          'conditions': [\n-            ['node_intermediate_lib_type != \"static_library\"', {\n-              'sources': [\n-                'tools/msvs/genfiles/node_perfctr_provider.rc',\n-              ],\n-            }],\n-          ],\n-        }],\n         [ 'node_use_dtrace==\"true\"', {\n           'defines': [ 'HAVE_DTRACE=1' ],\n           'dependencies': [\n@@ -714,30 +686,6 @@\n         } ]\n       ]\n     },\n-    # generate perf counter header and resource files\n-    {\n-      'target_name': 'node_perfctr',\n-      'type': 'none',\n-      'conditions': [\n-        [ 'node_use_perfctr==\"true\"', {\n-          'actions': [\n-            {\n-              'action_name': 'node_perfctr_man',\n-              'inputs': [ 'src/res/node_perfctr_provider.man' ],\n-              'outputs': [\n-                'tools/msvs/genfiles/node_perfctr_provider.h',\n-                'tools/msvs/genfiles/node_perfctr_provider.rc',\n-                'tools/msvs/genfiles/MSG00001.BIN',\n-              ],\n-              'action': [ 'ctrpp <@(_inputs) '\n-                          '-o tools/msvs/genfiles/node_perfctr_provider.h '\n-                          '-rc tools/msvs/genfiles/node_perfctr_provider.rc'\n-              ]\n-            },\n-          ],\n-        } ]\n-      ]\n-    },\n     {\n       'target_name': 'node_js2c',\n       'type': 'none',\n@@ -758,9 +706,6 @@\n             [ 'node_use_dtrace==\"false\" and node_use_etw==\"false\"', {\n               'inputs': [ 'src/notrace_macros.py' ]\n             }],\n-            [ 'node_use_perfctr==\"false\"', {\n-              'inputs': [ 'src/noperfctr_macros.py' ]\n-            }],\n             [ 'node_debug_lib==\"false\"', {\n               'inputs': [ 'tools/nodcheck_macros.py' ]\n             }],\n@@ -989,9 +934,6 @@\n             'HAVE_OPENSSL=1',\n           ],\n         }],\n-        [ 'node_use_perfctr==\"true\"', {\n-          'defines': [ 'HAVE_PERFCTR=1' ],\n-        }],\n         ['v8_enable_inspector==1', {\n           'sources': [\n             'test/cctest/test_inspector_socket.cc',"
        },
        {
            "sha": "5e433619235b3294c5fd1c93eeee151261890963",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 8,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -31,10 +31,6 @@\n #include \"node_context_data.h\"\n #include \"tracing/traced_value.h\"\n \n-#if defined HAVE_PERFCTR\n-#include \"node_counters.h\"\n-#endif\n-\n #if HAVE_OPENSSL\n #include \"node_crypto.h\"\n #endif\n@@ -2152,10 +2148,6 @@ void LoadEnvironment(Environment* env) {\n   InitDTrace(env, global);\n #endif\n \n-#if defined HAVE_PERFCTR\n-  InitPerfCounters(env, global);\n-#endif\n-\n   // Enable handling of uncaught exceptions\n   // (FatalException(), break on uncaught exception in debugger)\n   //"
        },
        {
            "sha": "99b3b8fd8ba1ace65e33358b5d148fa810a3f79d",
            "filename": "src/node_counters.cc",
            "status": "removed",
            "additions": 0,
            "deletions": 145,
            "changes": 145,
            "blob_url": "https://github.com/nodejs/node/blob/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnode_counters.cc",
            "raw_url": "https://github.com/nodejs/node/raw/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnode_counters.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_counters.cc?ref=6e746f1a55e5d94f1a8330d3436a64ed8d6f639b",
            "patch": "@@ -1,145 +0,0 @@\n-// Copyright Joyent, Inc. and other Node contributors.\n-//\n-// Permission is hereby granted, free of charge, to any person obtaining a\n-// copy of this software and associated documentation files (the\n-// \"Software\"), to deal in the Software without restriction, including\n-// without limitation the rights to use, copy, modify, merge, publish,\n-// distribute, sublicense, and/or sell copies of the Software, and to permit\n-// persons to whom the Software is furnished to do so, subject to the\n-// following conditions:\n-//\n-// The above copyright notice and this permission notice shall be included\n-// in all copies or substantial portions of the Software.\n-//\n-// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n-// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n-// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n-// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n-// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n-// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n-// USE OR OTHER DEALINGS IN THE SOFTWARE.\n-\n-#include \"node_counters.h\"\n-#include \"node_internals.h\"\n-#include \"uv.h\"\n-#include \"env-inl.h\"\n-\n-#include <string.h>\n-\n-\n-namespace node {\n-\n-using v8::FunctionCallbackInfo;\n-using v8::FunctionTemplate;\n-using v8::GCCallbackFlags;\n-using v8::GCType;\n-using v8::HandleScope;\n-using v8::Isolate;\n-using v8::Local;\n-using v8::Object;\n-using v8::String;\n-using v8::Value;\n-\n-static uint64_t counter_gc_start_time;\n-static uint64_t counter_gc_end_time;\n-\n-\n-void COUNTER_NET_SERVER_CONNECTION(const FunctionCallbackInfo<Value>&) {\n-  NODE_COUNT_SERVER_CONN_OPEN();\n-}\n-\n-\n-void COUNTER_NET_SERVER_CONNECTION_CLOSE(const FunctionCallbackInfo<Value>&) {\n-  NODE_COUNT_SERVER_CONN_CLOSE();\n-}\n-\n-\n-void COUNTER_HTTP_SERVER_REQUEST(const FunctionCallbackInfo<Value>&) {\n-  NODE_COUNT_HTTP_SERVER_REQUEST();\n-}\n-\n-\n-void COUNTER_HTTP_SERVER_RESPONSE(const FunctionCallbackInfo<Value>&) {\n-  NODE_COUNT_HTTP_SERVER_RESPONSE();\n-}\n-\n-\n-void COUNTER_HTTP_CLIENT_REQUEST(const FunctionCallbackInfo<Value>&) {\n-  NODE_COUNT_HTTP_CLIENT_REQUEST();\n-}\n-\n-\n-void COUNTER_HTTP_CLIENT_RESPONSE(const FunctionCallbackInfo<Value>&) {\n-  NODE_COUNT_HTTP_CLIENT_RESPONSE();\n-}\n-\n-\n-static void counter_gc_start(Isolate* isolate,\n-                             GCType type,\n-                             GCCallbackFlags flags) {\n-  counter_gc_start_time = NODE_COUNT_GET_GC_RAWTIME();\n-}\n-\n-\n-static void counter_gc_done(Isolate* isolate,\n-                            GCType type,\n-                            GCCallbackFlags flags) {\n-  uint64_t endgc = NODE_COUNT_GET_GC_RAWTIME();\n-  if (endgc != 0) {\n-    uint64_t totalperiod = endgc - counter_gc_end_time;\n-    uint64_t gcperiod = endgc - counter_gc_start_time;\n-\n-    if (totalperiod > 0) {\n-      unsigned int percent = static_cast<unsigned int>(\n-          (gcperiod * 100) / totalperiod);\n-\n-      NODE_COUNT_GC_PERCENTTIME(percent);\n-      counter_gc_end_time = endgc;\n-    }\n-  }\n-}\n-\n-\n-void InitPerfCounters(Environment* env, Local<Object> target) {\n-  HandleScope scope(env->isolate());\n-\n-  static struct {\n-    const char* name;\n-    void (*func)(const FunctionCallbackInfo<Value>&);\n-  } tab[] = {\n-#define NODE_PROBE(name) #name, name\n-    { NODE_PROBE(COUNTER_NET_SERVER_CONNECTION) },\n-    { NODE_PROBE(COUNTER_NET_SERVER_CONNECTION_CLOSE) },\n-    { NODE_PROBE(COUNTER_HTTP_SERVER_REQUEST) },\n-    { NODE_PROBE(COUNTER_HTTP_SERVER_RESPONSE) },\n-    { NODE_PROBE(COUNTER_HTTP_CLIENT_REQUEST) },\n-    { NODE_PROBE(COUNTER_HTTP_CLIENT_RESPONSE) }\n-#undef NODE_PROBE\n-  };\n-\n-  for (size_t i = 0; i < arraysize(tab); i++) {\n-    Local<String> key = OneByteString(env->isolate(), tab[i].name);\n-    Local<Value> val = env->NewFunctionTemplate(tab[i].func)->GetFunction();\n-    target->Set(key, val);\n-  }\n-\n-  // Only Windows performance counters supported\n-  // To enable other OS, use conditional compilation here\n-  InitPerfCountersWin32();\n-\n-  // init times for GC percent calculation and hook callbacks\n-  counter_gc_start_time = NODE_COUNT_GET_GC_RAWTIME();\n-  counter_gc_end_time = counter_gc_start_time;\n-\n-  env->isolate()->AddGCPrologueCallback(counter_gc_start);\n-  env->isolate()->AddGCEpilogueCallback(counter_gc_done);\n-}\n-\n-\n-void TermPerfCounters(Local<Object> target) {\n-  // Only Windows performance counters supported\n-  // To enable other OS, use conditional compilation here\n-  TermPerfCountersWin32();\n-}\n-\n-}  // namespace node"
        },
        {
            "sha": "c8a1a88f0b25e0a17d45b690f559fe23997e753e",
            "filename": "src/node_counters.h",
            "status": "removed",
            "additions": 0,
            "deletions": 59,
            "changes": 59,
            "blob_url": "https://github.com/nodejs/node/blob/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnode_counters.h",
            "raw_url": "https://github.com/nodejs/node/raw/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnode_counters.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_counters.h?ref=6e746f1a55e5d94f1a8330d3436a64ed8d6f639b",
            "patch": "@@ -1,59 +0,0 @@\n-// Copyright Joyent, Inc. and other Node contributors.\n-//\n-// Permission is hereby granted, free of charge, to any person obtaining a\n-// copy of this software and associated documentation files (the\n-// \"Software\"), to deal in the Software without restriction, including\n-// without limitation the rights to use, copy, modify, merge, publish,\n-// distribute, sublicense, and/or sell copies of the Software, and to permit\n-// persons to whom the Software is furnished to do so, subject to the\n-// following conditions:\n-//\n-// The above copyright notice and this permission notice shall be included\n-// in all copies or substantial portions of the Software.\n-//\n-// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n-// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n-// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n-// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n-// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n-// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n-// USE OR OTHER DEALINGS IN THE SOFTWARE.\n-\n-#ifndef SRC_NODE_COUNTERS_H_\n-#define SRC_NODE_COUNTERS_H_\n-\n-#if defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#include \"node_internals.h\"\n-\n-#ifdef HAVE_PERFCTR\n-#include \"node_win32_perfctr_provider.h\"\n-#else\n-#define NODE_COUNTER_ENABLED() (false)\n-#define NODE_COUNT_GC_PERCENTTIME(percent) do { } while (false)\n-#define NODE_COUNT_GET_GC_RAWTIME() do { } while (false)\n-#define NODE_COUNT_HTTP_CLIENT_REQUEST() do { } while (false)\n-#define NODE_COUNT_HTTP_CLIENT_RESPONSE() do { } while (false)\n-#define NODE_COUNT_HTTP_SERVER_REQUEST() do { } while (false)\n-#define NODE_COUNT_HTTP_SERVER_RESPONSE() do { } while (false)\n-#define NODE_COUNT_NET_BYTES_RECV(bytes) do { } while (false)\n-#define NODE_COUNT_NET_BYTES_SENT(bytes) do { } while (false)\n-#define NODE_COUNT_PIPE_BYTES_RECV(bytes) do { } while (false)\n-#define NODE_COUNT_PIPE_BYTES_SENT(bytes) do { } while (false)\n-#define NODE_COUNT_SERVER_CONN_CLOSE() do { } while (false)\n-#define NODE_COUNT_SERVER_CONN_OPEN() do { } while (false)\n-#endif\n-\n-#include \"v8.h\"\n-#include \"env.h\"\n-\n-namespace node {\n-\n-void InitPerfCounters(Environment* env, v8::Local<v8::Object> target);\n-void TermPerfCounters(v8::Local<v8::Object> target);\n-\n-}  // namespace node\n-\n-#endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#endif  // SRC_NODE_COUNTERS_H_"
        },
        {
            "sha": "9a34825b1e6df01a2bb3362954af1154f31277d8",
            "filename": "src/node_internals.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/src%2Fnode_internals.h",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/src%2Fnode_internals.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_internals.h?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -132,7 +132,7 @@ struct sockaddr;\n     V(string_decoder)                                                         \\\n     V(symbols)                                                                \\\n     V(tcp_wrap)                                                               \\\n-    V(timers)                                                             \\\n+    V(timers)                                                                 \\\n     V(trace_events)                                                           \\\n     V(tty_wrap)                                                               \\\n     V(types)                                                                  \\"
        },
        {
            "sha": "7e94db9fed97ea6d676fce7bbe9f73edca3c7559",
            "filename": "src/node_win32_perfctr_provider.cc",
            "status": "removed",
            "additions": 0,
            "deletions": 345,
            "changes": 345,
            "blob_url": "https://github.com/nodejs/node/blob/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnode_win32_perfctr_provider.cc",
            "raw_url": "https://github.com/nodejs/node/raw/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnode_win32_perfctr_provider.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_win32_perfctr_provider.cc?ref=6e746f1a55e5d94f1a8330d3436a64ed8d6f639b",
            "patch": "@@ -1,345 +0,0 @@\n-// Copyright Joyent, Inc. and other Node contributors.\n-//\n-// Permission is hereby granted, free of charge, to any person obtaining a\n-// copy of this software and associated documentation files (the\n-// \"Software\"), to deal in the Software without restriction, including\n-// without limitation the rights to use, copy, modify, merge, publish,\n-// distribute, sublicense, and/or sell copies of the Software, and to permit\n-// persons to whom the Software is furnished to do so, subject to the\n-// following conditions:\n-//\n-// The above copyright notice and this permission notice shall be included\n-// in all copies or substantial portions of the Software.\n-//\n-// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n-// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n-// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n-// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n-// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n-// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n-// USE OR OTHER DEALINGS IN THE SOFTWARE.\n-\n-#define __INIT_node_perfctr_provider_IMP\n-#include \"node_counters.h\"\n-#include \"node_win32_perfctr_provider.h\"\n-\n-#include <perflib.h>\n-\n-#include \"node_perfctr_provider.h\"\n-\n-\n-typedef ULONG (WINAPI* PerfStartProviderExFunc)(\n-    __in LPGUID ProviderGuid,\n-    __in_opt PPERF_PROVIDER_CONTEXT ProviderContext,\n-    __out PHANDLE Provider);\n-\n-typedef ULONG (WINAPI* PerfStopProviderFunc)(\n-    __in HANDLE ProviderHandle);\n-\n-typedef ULONG (WINAPI* PerfSetCounterSetInfoFunc)(\n-    __in HANDLE ProviderHandle,\n-    __inout_bcount(TemplateSize) PPERF_COUNTERSET_INFO Template,\n-    __in ULONG TemplateSize);\n-\n-typedef PPERF_COUNTERSET_INSTANCE (WINAPI* PerfCreateInstanceFunc)(\n-    __in HANDLE ProviderHandle,\n-    __in LPCGUID CounterSetGuid,\n-    __in PCWSTR Name,\n-    __in ULONG Id);\n-\n-typedef ULONG (WINAPI* PerfDeleteInstanceFunc)(\n-    __in HANDLE Provider,\n-    __in PPERF_COUNTERSET_INSTANCE InstanceBlock);\n-\n-typedef ULONG (WINAPI* PerfSetULongCounterValueFunc)(\n-    __in HANDLE Provider,\n-    __inout PPERF_COUNTERSET_INSTANCE Instance,\n-    __in ULONG CounterId,\n-    __in ULONG Value);\n-\n-typedef ULONG (WINAPI* PerfSetULongLongCounterValueFunc)(\n-    __in HANDLE Provider,\n-    __inout PPERF_COUNTERSET_INSTANCE Instance,\n-    __in ULONG CounterId,\n-    __in ULONGLONG Value);\n-\n-typedef ULONG (WINAPI* PerfIncrementULongCounterValueFunc)(\n-    __in HANDLE Provider,\n-    __inout PPERF_COUNTERSET_INSTANCE Instance,\n-    __in ULONG CounterId,\n-    __in ULONG Value);\n-\n-typedef ULONG (WINAPI* PerfIncrementULongLongCounterValueFunc)(\n-    __in HANDLE Provider,\n-    __inout PPERF_COUNTERSET_INSTANCE Instance,\n-    __in ULONG CounterId,\n-    __in ULONGLONG Value);\n-\n-typedef ULONG (WINAPI* PerfDecrementULongCounterValueFunc)(\n-    __in HANDLE Provider,\n-    __inout PPERF_COUNTERSET_INSTANCE Instance,\n-    __in ULONG CounterId,\n-    __in ULONG Value);\n-\n-typedef ULONG (WINAPI* PerfDecrementULongLongCounterValueFunc)(\n-    __in HANDLE Provider,\n-    __inout PPERF_COUNTERSET_INSTANCE Instance,\n-    __in ULONG CounterId,\n-    __in ULONGLONG Value);\n-\n-\n-HMODULE advapimod;\n-PerfStartProviderExFunc perfctr_startProvider;\n-PerfStopProviderFunc perfctr_stopProvider;\n-PerfSetCounterSetInfoFunc perfctr_setCounterSetInfo;\n-PerfCreateInstanceFunc perfctr_createInstance;\n-PerfDeleteInstanceFunc perfctr_deleteInstance;\n-PerfSetULongCounterValueFunc perfctr_setULongValue;\n-PerfSetULongLongCounterValueFunc perfctr_setULongLongValue;\n-PerfIncrementULongCounterValueFunc perfctr_incrementULongValue;\n-PerfIncrementULongLongCounterValueFunc perfctr_incrementULongLongValue;\n-PerfDecrementULongCounterValueFunc perfctr_decrementULongValue;\n-PerfDecrementULongLongCounterValueFunc perfctr_decrementULongLongValue;\n-\n-PPERF_COUNTERSET_INSTANCE perfctr_instance;\n-\n-\n-#define NODE_COUNTER_HTTP_SERVER_REQUEST     1\n-#define NODE_COUNTER_HTTP_SERVER_RESPONSE    2\n-#define NODE_COUNTER_HTTP_CLIENT_REQUEST     3\n-#define NODE_COUNTER_HTTP_CLIENT_RESPONSE    4\n-#define NODE_COUNTER_SERVER_CONNS            5\n-#define NODE_COUNTER_NET_BYTES_SENT          6\n-#define NODE_COUNTER_NET_BYTES_RECV          7\n-#define NODE_COUNTER_GC_PERCENTTIME          8\n-#define NODE_COUNTER_PIPE_BYTES_SENT         9\n-#define NODE_COUNTER_PIPE_BYTES_RECV         10\n-\n-\n-namespace node {\n-\n-\n-HANDLE NodeCounterProvider = nullptr;\n-\n-void InitPerfCountersWin32() {\n-  ULONG status;\n-  PERF_PROVIDER_CONTEXT providerContext;\n-\n-  // create instance name using pid\n-#define INST_MAX_LEN       32\n-#define INST_PREFIX_LEN    5\n-#define INST_PREFIX        L\"node_\"\n-\n-  wchar_t Inst[INST_MAX_LEN];\n-  DWORD pid = GetCurrentProcessId();\n-  wcscpy_s(Inst, INST_MAX_LEN, INST_PREFIX);\n-  _itow_s(pid, Inst + INST_PREFIX_LEN, INST_MAX_LEN - INST_PREFIX_LEN, 10);\n-\n-  advapimod = LoadLibraryW(L\"advapi32.dll\");\n-  if (advapimod) {\n-    perfctr_startProvider = (PerfStartProviderExFunc)\n-      GetProcAddress(advapimod, \"PerfStartProviderEx\");\n-    perfctr_stopProvider = (PerfStopProviderFunc)\n-      GetProcAddress(advapimod, \"PerfStopProvider\");\n-    perfctr_setCounterSetInfo = (PerfSetCounterSetInfoFunc)\n-      GetProcAddress(advapimod, \"PerfSetCounterSetInfo\");\n-    perfctr_createInstance = (PerfCreateInstanceFunc)\n-      GetProcAddress(advapimod, \"PerfCreateInstance\");\n-    perfctr_deleteInstance = (PerfDeleteInstanceFunc)\n-      GetProcAddress(advapimod, \"PerfDeleteInstance\");\n-    perfctr_setULongValue = (PerfSetULongCounterValueFunc)\n-      GetProcAddress(advapimod, \"PerfSetULongCounterValue\");\n-    perfctr_setULongLongValue = (PerfSetULongLongCounterValueFunc)\n-      GetProcAddress(advapimod, \"PerfSetULongLongCounterValue\");\n-    perfctr_incrementULongValue = (PerfIncrementULongCounterValueFunc)\n-      GetProcAddress(advapimod, \"PerfIncrementULongCounterValue\");\n-    perfctr_incrementULongLongValue = (PerfIncrementULongLongCounterValueFunc)\n-      GetProcAddress(advapimod, \"PerfIncrementULongLongCounterValue\");\n-    perfctr_decrementULongValue = (PerfDecrementULongCounterValueFunc)\n-      GetProcAddress(advapimod, \"PerfDecrementULongCounterValue\");\n-    perfctr_decrementULongLongValue = (PerfDecrementULongLongCounterValueFunc)\n-      GetProcAddress(advapimod, \"PerfDecrementULongLongCounterValue\");\n-\n-    ZeroMemory(&providerContext, sizeof(providerContext));\n-    providerContext.ContextSize = sizeof(providerContext);\n-\n-    if (!perfctr_startProvider ||\n-        !perfctr_setCounterSetInfo ||\n-        !perfctr_createInstance) {\n-      NodeCounterProvider = nullptr;\n-      return;\n-    }\n-\n-    status = perfctr_startProvider(&NodeCounterSetGuid,\n-                                   &providerContext,\n-                                   &NodeCounterProvider);\n-    if (status != ERROR_SUCCESS) {\n-      NodeCounterProvider = nullptr;\n-      return;\n-    }\n-\n-    status = perfctr_setCounterSetInfo(NodeCounterProvider,\n-                                       &NodeCounterSetInfo.CounterSet,\n-                                       sizeof(NodeCounterSetInfo.CounterSet));\n-    if (status != ERROR_SUCCESS) {\n-      perfctr_stopProvider(NodeCounterProvider);\n-      NodeCounterProvider = nullptr;\n-      return;\n-    }\n-\n-    perfctr_instance = perfctr_createInstance(NodeCounterProvider,\n-                                              &NodeCounterSetGuid,\n-                                              Inst,\n-                                              1);\n-    if (perfctr_instance == nullptr) {\n-      perfctr_stopProvider(NodeCounterProvider);\n-      NodeCounterProvider = nullptr;\n-    }\n-  }\n-}\n-\n-\n-void TermPerfCountersWin32() {\n-  if (NodeCounterProvider != nullptr &&\n-    perfctr_stopProvider != nullptr) {\n-    perfctr_stopProvider(NodeCounterProvider);\n-    NodeCounterProvider = nullptr;\n-  }\n-\n-  if (advapimod) {\n-    FreeLibrary(advapimod);\n-    advapimod = nullptr;\n-  }\n-}\n-\n-\n-void NODE_COUNT_HTTP_SERVER_REQUEST() {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_incrementULongValue != nullptr) {\n-    perfctr_incrementULongValue(NodeCounterProvider,\n-                                perfctr_instance,\n-                                NODE_COUNTER_HTTP_SERVER_REQUEST,\n-                                1);\n-  }\n-}\n-\n-\n-void NODE_COUNT_HTTP_SERVER_RESPONSE() {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_incrementULongValue != nullptr) {\n-    perfctr_incrementULongValue(NodeCounterProvider,\n-                                perfctr_instance,\n-                                NODE_COUNTER_HTTP_SERVER_RESPONSE,\n-                                1);\n-  }\n-}\n-\n-\n-void NODE_COUNT_HTTP_CLIENT_REQUEST() {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_incrementULongValue != nullptr) {\n-    perfctr_incrementULongValue(NodeCounterProvider,\n-                                perfctr_instance,\n-                                NODE_COUNTER_HTTP_CLIENT_REQUEST,\n-                                1);\n-  }\n-}\n-\n-\n-void NODE_COUNT_HTTP_CLIENT_RESPONSE() {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_incrementULongValue != nullptr) {\n-    perfctr_incrementULongValue(NodeCounterProvider,\n-                                perfctr_instance,\n-                                NODE_COUNTER_HTTP_CLIENT_RESPONSE,\n-                                1);\n-  }\n-}\n-\n-\n-void NODE_COUNT_SERVER_CONN_OPEN() {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_incrementULongValue != nullptr) {\n-    perfctr_incrementULongValue(NodeCounterProvider,\n-                                perfctr_instance,\n-                                NODE_COUNTER_SERVER_CONNS,\n-                                1);\n-  }\n-}\n-\n-\n-void NODE_COUNT_SERVER_CONN_CLOSE() {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_decrementULongValue != nullptr) {\n-    perfctr_decrementULongValue(NodeCounterProvider,\n-                                perfctr_instance,\n-                                NODE_COUNTER_SERVER_CONNS,\n-                                1);\n-  }\n-}\n-\n-\n-void NODE_COUNT_NET_BYTES_SENT(int bytes) {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_incrementULongLongValue != nullptr) {\n-    perfctr_incrementULongLongValue(NodeCounterProvider,\n-                                    perfctr_instance,\n-                                    NODE_COUNTER_NET_BYTES_SENT,\n-                                    static_cast<ULONGLONG>(bytes));\n-  }\n-}\n-\n-\n-void NODE_COUNT_NET_BYTES_RECV(int bytes) {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_incrementULongLongValue != nullptr) {\n-    perfctr_incrementULongLongValue(NodeCounterProvider,\n-                                    perfctr_instance,\n-                                    NODE_COUNTER_NET_BYTES_RECV,\n-                                    static_cast<ULONGLONG>(bytes));\n-  }\n-}\n-\n-\n-uint64_t NODE_COUNT_GET_GC_RAWTIME() {\n-  LARGE_INTEGER timegc;\n-  if (QueryPerformanceCounter(&timegc)) {\n-    return timegc.QuadPart;\n-  } else {\n-    return static_cast<uint64_t>(GetTickCount());\n-  }\n-}\n-\n-\n-void NODE_COUNT_GC_PERCENTTIME(unsigned int percent) {\n-  if (NodeCounterProvider != nullptr && perfctr_setULongValue != nullptr) {\n-    perfctr_setULongValue(NodeCounterProvider,\n-                          perfctr_instance,\n-                          NODE_COUNTER_GC_PERCENTTIME,\n-                          percent);\n-  }\n-}\n-\n-\n-void NODE_COUNT_PIPE_BYTES_SENT(int bytes) {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_incrementULongLongValue != nullptr) {\n-    perfctr_incrementULongLongValue(NodeCounterProvider,\n-                                    perfctr_instance,\n-                                    NODE_COUNTER_PIPE_BYTES_SENT,\n-                                    static_cast<ULONGLONG>(bytes));\n-  }\n-}\n-\n-\n-void NODE_COUNT_PIPE_BYTES_RECV(int bytes) {\n-  if (NodeCounterProvider != nullptr &&\n-      perfctr_incrementULongLongValue != nullptr) {\n-    perfctr_incrementULongLongValue(NodeCounterProvider,\n-                                    perfctr_instance,\n-                                    NODE_COUNTER_PIPE_BYTES_RECV,\n-                                    static_cast<ULONGLONG>(bytes));\n-  }\n-}\n-\n-}  // namespace node"
        },
        {
            "sha": "35185aa187e1f8ce40f36ecf57aad988b06ab4b0",
            "filename": "src/node_win32_perfctr_provider.h",
            "status": "removed",
            "additions": 0,
            "deletions": 58,
            "changes": 58,
            "blob_url": "https://github.com/nodejs/node/blob/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnode_win32_perfctr_provider.h",
            "raw_url": "https://github.com/nodejs/node/raw/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnode_win32_perfctr_provider.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_win32_perfctr_provider.h?ref=6e746f1a55e5d94f1a8330d3436a64ed8d6f639b",
            "patch": "@@ -1,58 +0,0 @@\n-// Copyright Joyent, Inc. and other Node contributors.\n-//\n-// Permission is hereby granted, free of charge, to any person obtaining a\n-// copy of this software and associated documentation files (the\n-// \"Software\"), to deal in the Software without restriction, including\n-// without limitation the rights to use, copy, modify, merge, publish,\n-// distribute, sublicense, and/or sell copies of the Software, and to permit\n-// persons to whom the Software is furnished to do so, subject to the\n-// following conditions:\n-//\n-// The above copyright notice and this permission notice shall be included\n-// in all copies or substantial portions of the Software.\n-//\n-// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n-// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n-// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n-// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n-// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n-// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n-// USE OR OTHER DEALINGS IN THE SOFTWARE.\n-\n-#ifndef SRC_NODE_WIN32_PERFCTR_PROVIDER_H_\n-#define SRC_NODE_WIN32_PERFCTR_PROVIDER_H_\n-\n-#if defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#if defined(_MSC_VER)\n-# define INLINE __forceinline\n-#else\n-# define INLINE inline\n-#endif\n-\n-namespace node {\n-\n-extern HANDLE NodeCounterProvider;\n-\n-INLINE bool NODE_COUNTER_ENABLED() { return NodeCounterProvider != nullptr; }\n-void NODE_COUNT_HTTP_SERVER_REQUEST();\n-void NODE_COUNT_HTTP_SERVER_RESPONSE();\n-void NODE_COUNT_HTTP_CLIENT_REQUEST();\n-void NODE_COUNT_HTTP_CLIENT_RESPONSE();\n-void NODE_COUNT_SERVER_CONN_OPEN();\n-void NODE_COUNT_SERVER_CONN_CLOSE();\n-void NODE_COUNT_NET_BYTES_SENT(int bytes);\n-void NODE_COUNT_NET_BYTES_RECV(int bytes);\n-uint64_t NODE_COUNT_GET_GC_RAWTIME();\n-void NODE_COUNT_GC_PERCENTTIME(unsigned int percent);\n-void NODE_COUNT_PIPE_BYTES_SENT(int bytes);\n-void NODE_COUNT_PIPE_BYTES_RECV(int bytes);\n-\n-void InitPerfCountersWin32();\n-void TermPerfCountersWin32();\n-\n-}  // namespace node\n-\n-#endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n-\n-#endif  // SRC_NODE_WIN32_PERFCTR_PROVIDER_H_"
        },
        {
            "sha": "2f7e3cbf82993f48e8720155b91d96dc5c83f086",
            "filename": "src/noperfctr_macros.py",
            "status": "removed",
            "additions": 0,
            "deletions": 9,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnoperfctr_macros.py",
            "raw_url": "https://github.com/nodejs/node/raw/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fnoperfctr_macros.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnoperfctr_macros.py?ref=6e746f1a55e5d94f1a8330d3436a64ed8d6f639b",
            "patch": "@@ -1,9 +0,0 @@\n-# This file is used by tools/js2c.py to preprocess out the performance counters\n-# symbols in builds that don't support counters. This is not used in builds\n-# that support performance counters.\n-macro COUNTER_NET_SERVER_CONNECTION(x) = ;\n-macro COUNTER_NET_SERVER_CONNECTION_CLOSE(x) = ;\n-macro COUNTER_HTTP_SERVER_REQUEST(x) = ;\n-macro COUNTER_HTTP_SERVER_RESPONSE(x) = ;\n-macro COUNTER_HTTP_CLIENT_REQUEST(x) = ;\n-macro COUNTER_HTTP_CLIENT_RESPONSE(x) = ;"
        },
        {
            "sha": "2f77e332f7f157778e8c338f9fdab1b7cb9c2cff",
            "filename": "src/res/node_perfctr_provider.man",
            "status": "removed",
            "additions": 0,
            "deletions": 107,
            "changes": 107,
            "blob_url": "https://github.com/nodejs/node/blob/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fres%2Fnode_perfctr_provider.man",
            "raw_url": "https://github.com/nodejs/node/raw/6e746f1a55e5d94f1a8330d3436a64ed8d6f639b/src%2Fres%2Fnode_perfctr_provider.man",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fres%2Fnode_perfctr_provider.man?ref=6e746f1a55e5d94f1a8330d3436a64ed8d6f639b",
            "patch": "@@ -1,107 +0,0 @@\n-<instrumentationManifest\n-    xmlns=\"http://schemas.microsoft.com/win/2004/08/events\"\n-    xmlns:win=\"http://manifests.microsoft.com/win/2004/08/windows/events\"\n-    xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\n-    <instrumentation>\n-      <counters xmlns=\"http://schemas.microsoft.com/win/2005/12/counters\"\n-                schemaVersion=\"1.1\">\n-        <provider symbol=\"NodeCounterProvider\"\n-                  applicationIdentity=\"node.exe\"\n-                  providerType=\"userMode\"\n-                  providerGuid=\"{793C9B44-3D6B-4F57-B5D7-4FF80ADCF9A2}\">\n-          <counterSet symbol=\"NodeCounterSet\"\n-                      guid=\"{3A22A8EC-297C-48AC-AB15-33EC93033FD8}\"\n-                      uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet\"\n-                      name=\"Node.js\"\n-                      description=\"Node.js performance counters\"\n-                      instances=\"multipleAggregate\">\n-\n-            <counter id=\"1\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.httpsrvreq\"\n-                     name=\"HTTP server requests\"\n-                     description=\"Number of HTTP server requests\"\n-                     type=\"perf_counter_counter\"\n-                     detailLevel=\"standard\"\n-                     aggregate=\"sum\" />\n-\n-            <counter id=\"2\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.httpsrvrsp\"\n-                     name=\"HTTP server responses\"\n-                     description=\"Number of HTTP server responses\"\n-                     type=\"perf_counter_counter\"\n-                     detailLevel=\"standard\"\n-                     aggregate=\"sum\" />\n-\n-            <counter id=\"3\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.httpclireq\"\n-                     name=\"HTTP client requests\"\n-                     description=\"Number of HTTP client requests\"\n-                     type=\"perf_counter_counter\"\n-                     detailLevel=\"standard\"\n-                     aggregate=\"sum\" />\n-\n-            <counter id=\"4\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.httpclirsp\"\n-                     name=\"HTTP client responses\"\n-                     description=\"Number of HTTP client responses\"\n-                     type=\"perf_counter_counter\"\n-                     detailLevel=\"standard\"\n-                     aggregate=\"sum\" />\n-\n-            <counter id=\"5\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.netsrvconn\"\n-                     name=\"Active server connections\"\n-                     description=\"Number of server connections\"\n-                     type=\"perf_counter_rawcount\"\n-                     detailLevel=\"standard\"\n-                     aggregate=\"sum\" />\n-\n-            <counter id=\"6\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.netbytesent\"\n-                     name=\"Network bytes sent\"\n-                     description=\"Number of bytes sent using TCP\"\n-                     type=\"perf_counter_bulk_count\"\n-                     detailLevel=\"standard\"\n-                     defaultScale=\"-3\"\n-                     aggregate=\"sum\" />\n-\n-            <counter id=\"7\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.netbyterecv\"\n-                     name=\"Network bytes received\"\n-                     description=\"Number of bytes received using TCP\"\n-                     type=\"perf_counter_bulk_count\"\n-                     detailLevel=\"standard\"\n-                     defaultScale=\"-3\"\n-                     aggregate=\"sum\" />\n-\n-            <counter id=\"8\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.gctime\"\n-                     name=\"%Time in GC\"\n-                     description=\"Percent of time for last GC\"\n-                     type=\"perf_counter_rawcount\"\n-                     detailLevel=\"standard\"\n-                     aggregate=\"avg\" />\n-\n-            <counter id=\"9\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.pipebytesent\"\n-                     name=\"Pipe bytes sent\"\n-                     description=\"Number of bytes sent using pipe\"\n-                     type=\"perf_counter_bulk_count\"\n-                     detailLevel=\"standard\"\n-                     defaultScale=\"-3\"\n-                     aggregate=\"sum\" />\n-\n-            <counter id=\"10\"\n-                     uri=\"Microsoft.Windows.System.PerfCounters.NodeCounterSet.pipebyterecv\"\n-                     name=\"Pipe bytes received\"\n-                     description=\"Number of bytes received using pipe\"\n-                     type=\"perf_counter_bulk_count\"\n-                     detailLevel=\"standard\"\n-                     defaultScale=\"-3\"\n-                     aggregate=\"sum\" />\n-\n-          </counterSet>\n-        </provider>\n-      </counters>\n-    </instrumentation>\n-</instrumentationManifest>"
        },
        {
            "sha": "350aae335ae67a69a6524a2ddca0d23fa5575f3d",
            "filename": "src/stream_wrap.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 12,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/src%2Fstream_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/src%2Fstream_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fstream_wrap.cc?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -25,7 +25,6 @@\n #include \"env-inl.h\"\n #include \"handle_wrap.h\"\n #include \"node_buffer.h\"\n-#include \"node_counters.h\"\n #include \"pipe_wrap.h\"\n #include \"req_wrap-inl.h\"\n #include \"tcp_wrap.h\"\n@@ -206,12 +205,6 @@ void LibuvStreamWrap::OnUvRead(ssize_t nread, const uv_buf_t* buf) {\n   CHECK_EQ(persistent().IsEmpty(), false);\n \n   if (nread > 0) {\n-    if (is_tcp()) {\n-      NODE_COUNT_NET_BYTES_RECV(nread);\n-    } else if (is_named_pipe()) {\n-      NODE_COUNT_PIPE_BYTES_RECV(nread);\n-    }\n-\n     Local<Object> pending_obj;\n \n     if (type == UV_TCP) {\n@@ -351,11 +344,6 @@ int LibuvStreamWrap::DoWrite(WriteWrap* req_wrap,\n     size_t bytes = 0;\n     for (size_t i = 0; i < count; i++)\n       bytes += bufs[i].len;\n-    if (stream()->type == UV_TCP) {\n-      NODE_COUNT_NET_BYTES_SENT(bytes);\n-    } else if (stream()->type == UV_NAMED_PIPE) {\n-      NODE_COUNT_PIPE_BYTES_SENT(bytes);\n-    }\n   }\n \n   return r;"
        },
        {
            "sha": "7ff8b068ebc88f20033039d312f53f03a374e946",
            "filename": "src/tls_wrap.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/src%2Ftls_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/src%2Ftls_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftls_wrap.cc?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -26,7 +26,6 @@\n #include \"node_crypto_bio.h\"  // NodeBIO\n // ClientHelloParser\n #include \"node_crypto_clienthello-inl.h\"\n-#include \"node_counters.h\"\n #include \"node_internals.h\"\n #include \"stream_base-inl.h\"\n #include \"util-inl.h\"\n@@ -283,8 +282,6 @@ void TLSWrap::EncOut() {\n     return;\n   }\n \n-  NODE_COUNT_NET_BYTES_SENT(write_size_);\n-\n   if (!res.async) {\n     HandleScope handle_scope(env()->isolate());\n "
        },
        {
            "sha": "9983168a01c66e4a2bc8a3ab8242fcb14fed930f",
            "filename": "tools/msvs/msi/i18n/de-de.wxl",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fi18n%2Fde-de.wxl",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fi18n%2Fde-de.wxl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Fmsi%2Fi18n%2Fde-de.wxl?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -12,9 +12,6 @@\n     <String Id=\"NodeRuntime_Title\">Node.js-Laufzeitumgebung</String>\n     <String Id=\"NodeRuntime_Description\">Installation der [ProductName]-Laufzeitumgebung (node.exe).</String>\n \n-    <String Id=\"NodePerfCtrSupport_Title\">Performance Counter</String>\n-    <String Id=\"NodePerfCtrSupport_Description\">Installiert Unterst√ºtzung f√ºr [ProductName]-spezifische Performance Counter.</String>\n-\n     <String Id=\"NodeEtwSupport_Title\">Event Tracing (ETW)</String>\n     <String Id=\"NodeEtwSupport_Description\">Installiert Unterst√ºtzung f√ºr Event Tracing (ETW)-Events, generiert von [ProductName].</String>\n "
        },
        {
            "sha": "e69ea7bbece8309d8cd9251514334916ee183faf",
            "filename": "tools/msvs/msi/i18n/en-us.wxl",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fi18n%2Fen-us.wxl",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fi18n%2Fen-us.wxl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Fmsi%2Fi18n%2Fen-us.wxl?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -20,9 +20,6 @@\n     <String Id=\"NodeRuntime_Title\">Node.js runtime</String>\n     <String Id=\"NodeRuntime_Description\">Install the core [ProductName] runtime (node.exe).</String>\n \n-    <String Id=\"NodePerfCtrSupport_Title\">Performance counters</String>\n-    <String Id=\"NodePerfCtrSupport_Description\">Installs support for [ProductName]-specific performance counters.</String>\n-\n     <String Id=\"NodeEtwSupport_Title\">Event tracing (ETW)</String>\n     <String Id=\"NodeEtwSupport_Description\">Installs support for event tracing (ETW) events generated by [ProductName].</String>\n "
        },
        {
            "sha": "e3a5a5dcba0881f8cdc0862d5a99e163d0303284",
            "filename": "tools/msvs/msi/i18n/it-it.wxl",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fi18n%2Fit-it.wxl",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fi18n%2Fit-it.wxl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Fmsi%2Fi18n%2Fit-it.wxl?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -12,9 +12,6 @@\n     <String Id=\"NodeRuntime_Title\">Node.js runtime</String>\n     <String Id=\"NodeRuntime_Description\">Installa [ProductName] runtime (node.exe).</String>\n \n-    <String Id=\"NodePerfCtrSupport_Title\">Performance counters</String>\n-    <String Id=\"NodePerfCtrSupport_Description\">Installa il supporto per i performance counters specifici di [ProductName].</String>\n-\n     <String Id=\"NodeEtwSupport_Title\">Event tracing (ETW)</String>\n     <String Id=\"NodeEtwSupport_Description\">Installa il supporto per gli eventi \"event tracing\" (ETW) generati da [ProductName].</String>\n "
        },
        {
            "sha": "e351436d05e6538b31c77fb8b3a81661af792839",
            "filename": "tools/msvs/msi/i18n/zh-cn.wxl",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fi18n%2Fzh-cn.wxl",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fi18n%2Fzh-cn.wxl",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Fmsi%2Fi18n%2Fzh-cn.wxl?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -12,9 +12,6 @@\n     <String Id=\"NodeRuntime_Title\">Node.js ËøêË°åÊó∂</String>\n     <String Id=\"NodeRuntime_Description\">ÂÆâË£ÖÊ†∏ÂøÉ [ProductName] ËøêË°åÊó∂Ôºànode.exeÔºâ„ÄÇ</String>\n \n-    <String Id=\"NodePerfCtrSupport_Title\">ÊÄßËÉΩËÆ°Êï∞Âô®</String>\n-    <String Id=\"NodePerfCtrSupport_Description\">‰∏∫ [ProductName] ÂÆâË£ÖÁâπÂÆöÁöÑÊÄßËÉΩËÆ°Êï∞Âô®ÊîØÊåÅ„ÄÇ</String>\n-\n     <String Id=\"NodeEtwSupport_Title\">‰∫ã‰ª∂ËøΩË∏™ÔºàETWÔºâ</String>\n     <String Id=\"NodeEtwSupport_Description\">‰∏∫ [ProductName] ÁîüÊàêÁöÑ‰∫ã‰ª∂ÂÆâË£Ö‰∫ã‰ª∂ËøΩË∏™ÔºàETWÔºâÁöÑÊîØÊåÅ„ÄÇ</String>\n "
        },
        {
            "sha": "6c23c1650baed3c8f0b5b8082a397c85a1805d16",
            "filename": "tools/msvs/msi/nodemsi.wixproj",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fnodemsi.wixproj",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fnodemsi.wixproj",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Fmsi%2Fnodemsi.wixproj?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -16,23 +16,23 @@\n   <PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Debug|x86' \">\n     <OutputPath>..\\..\\..\\</OutputPath>\n     <IntermediateOutputPath>obj\\$(Configuration)\\</IntermediateOutputPath>\n-    <DefineConstants>Debug;ProductVersion=$(NodeVersion);FullVersion=$(FullVersion);DistTypeDir=$(DistTypeDir);NoETW=$(NoETW);NoPerfCtr=$(NoPerfCtr);NpmSourceDir=..\\..\\..\\deps\\npm\\;ProgramFilesFolderId=ProgramFilesFolder</DefineConstants>\n+    <DefineConstants>Debug;ProductVersion=$(NodeVersion);FullVersion=$(FullVersion);DistTypeDir=$(DistTypeDir);NoETW=$(NoETW);NpmSourceDir=..\\..\\..\\deps\\npm\\;ProgramFilesFolderId=ProgramFilesFolder</DefineConstants>\n   </PropertyGroup>\n   <PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Release|x86' \">\n     <OutputPath>..\\..\\..\\</OutputPath>\n     <IntermediateOutputPath>obj\\$(Configuration)\\</IntermediateOutputPath>\n-    <DefineConstants>Debug;ProductVersion=$(NodeVersion);FullVersion=$(FullVersion);DistTypeDir=$(DistTypeDir);NoETW=$(NoETW);NoPerfCtr=$(NoPerfCtr);NpmSourceDir=..\\..\\..\\deps\\npm\\;ProgramFilesFolderId=ProgramFilesFolder</DefineConstants>\n+    <DefineConstants>Debug;ProductVersion=$(NodeVersion);FullVersion=$(FullVersion);DistTypeDir=$(DistTypeDir);NoETW=$(NoETW);NpmSourceDir=..\\..\\..\\deps\\npm\\;ProgramFilesFolderId=ProgramFilesFolder</DefineConstants>\n   </PropertyGroup>\n   <PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Debug|x64' \">\n     <OutputPath>..\\..\\..\\</OutputPath>\n     <IntermediateOutputPath>obj\\$(Configuration)\\</IntermediateOutputPath>\n-    <DefineConstants>Debug;ProductVersion=$(NodeVersion);FullVersion=$(FullVersion);DistTypeDir=$(DistTypeDir);NoETW=$(NoETW);NoPerfCtr=$(NoPerfCtr);NpmSourceDir=..\\..\\..\\deps\\npm\\;ProgramFilesFolderId=ProgramFiles64Folder</DefineConstants>\n+    <DefineConstants>Debug;ProductVersion=$(NodeVersion);FullVersion=$(FullVersion);DistTypeDir=$(DistTypeDir);NoETW=$(NoETW);NpmSourceDir=..\\..\\..\\deps\\npm\\;ProgramFilesFolderId=ProgramFiles64Folder</DefineConstants>\n     <Cultures>en-US</Cultures>\n   </PropertyGroup>\n   <PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Release|x64' \">\n     <OutputPath>..\\..\\..\\</OutputPath>\n     <IntermediateOutputPath>obj\\$(Configuration)\\</IntermediateOutputPath>\n-    <DefineConstants>Debug;ProductVersion=$(NodeVersion);FullVersion=$(FullVersion);DistTypeDir=$(DistTypeDir);NoETW=$(NoETW);NoPerfCtr=$(NoPerfCtr);NpmSourceDir=..\\..\\..\\deps\\npm\\;ProgramFilesFolderId=ProgramFiles64Folder</DefineConstants>\n+    <DefineConstants>Debug;ProductVersion=$(NodeVersion);FullVersion=$(FullVersion);DistTypeDir=$(DistTypeDir);NoETW=$(NoETW);NpmSourceDir=..\\..\\..\\deps\\npm\\;ProgramFilesFolderId=ProgramFiles64Folder</DefineConstants>\n   </PropertyGroup>\n   <PropertyGroup>\n     <EnableProjectHarvesting>True</EnableProjectHarvesting>"
        },
        {
            "sha": "b21e86fc7c7a0b4eacc480a97f9aa668ef725a7e",
            "filename": "tools/msvs/msi/product.wxs",
            "status": "modified",
            "additions": 0,
            "deletions": 15,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fproduct.wxs",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/tools%2Fmsvs%2Fmsi%2Fproduct.wxs",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Fmsi%2Fproduct.wxs?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -76,13 +76,6 @@\n       <ComponentRef Id=\"InstallToolsTxt\" />\n       <ComponentGroupRef Id=\"Product.Generated\"/>\n \n-      <Feature Id=\"NodePerfCtrSupport\"\n-               Level=\"1\"\n-               Title=\"!(loc.NodePerfCtrSupport_Title)\"\n-               Description=\"!(loc.NodePerfCtrSupport_Description)\">\n-        <ComponentRef Id=\"NodePerfCtrSupport\"/>\n-      </Feature>\n-\n       <Feature Id=\"NodeEtwSupport\"\n                Level=\"1\"\n                Title=\"!(loc.NodeEtwSupport_Title)\"\n@@ -172,14 +165,6 @@\n         <File Id=\"InstallToolsTxt\" Source=\"$(var.RepoDir)\\tools\\msvs\\install_tools\\install_tools.txt\"/>\n       </Component>\n \n-      <?if $(var.NoPerfCtr) != 1 ?>\n-      <Component Id=\"NodePerfCtrSupport\">\n-        <File Id=\"node_perfctr_provider_man\" Name=\"node_perfctr_provider.man\" Source=\"$(var.RepoDir)\\src\\res\\node_perfctr_provider.man\">\n-          <util:PerfCounterManifest ResourceFileDirectory=\"[INSTALLDIR]\"/>\n-        </File>\n-      </Component>\n-      <?endif?>\n-\n       <?if $(var.NoETW) != 1 ?>\n       <Component Id=\"NodeEtwSupport\">\n         <File Id=\"node_etw_provider.man\" Source=\"$(var.RepoDir)\\src\\res\\node_etw_provider.man\">"
        },
        {
            "sha": "81c2b2c380d63e71307cef804bd1b5abe3bff49f",
            "filename": "vcbuild.bat",
            "status": "modified",
            "additions": 2,
            "deletions": 10,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/9d71e6a6071134789a30471302d9735250dea96c/vcbuild.bat",
            "raw_url": "https://github.com/nodejs/node/raw/9d71e6a6071134789a30471302d9735250dea96c/vcbuild.bat",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/vcbuild.bat?ref=9d71e6a6071134789a30471302d9735250dea96c",
            "patch": "@@ -35,8 +35,6 @@ set lint_md=\n set lint_md_build=\n set noetw=\n set noetw_msi_arg=\n-set noperfctr=\n-set noperfctr_msi_arg=\n set i18n_arg=\n set download_arg=\n set build_release=\n@@ -75,7 +73,6 @@ if /i \"%1\"==\"nosign\"        set \"sign=\"&echo Note: vcbuild no longer signs by de\n if /i \"%1\"==\"sign\"          set sign=1&goto arg-ok\n if /i \"%1\"==\"nosnapshot\"    set nosnapshot=1&goto arg-ok\n if /i \"%1\"==\"noetw\"         set noetw=1&goto arg-ok\n-if /i \"%1\"==\"noperfctr\"     set noperfctr=1&goto arg-ok\n if /i \"%1\"==\"ltcg\"          set ltcg=1&goto arg-ok\n if /i \"%1\"==\"nopch\"         set \"pch=\"&goto arg-ok\n if /i \"%1\"==\"licensertf\"    set licensertf=1&goto arg-ok\n@@ -165,7 +162,6 @@ if \"%target_env%\"==\"vs2017\" set \"node_gyp_exe=%node_gyp_exe% --msvs_version=2017\n if \"%config%\"==\"Debug\"      set configure_flags=%configure_flags% --debug\n if defined nosnapshot       set configure_flags=%configure_flags% --without-snapshot\n if defined noetw            set configure_flags=%configure_flags% --without-etw& set noetw_msi_arg=/p:NoETW=1\n-if defined noperfctr        set configure_flags=%configure_flags% --without-perfctr& set noperfctr_msi_arg=/p:NoPerfCtr=1\n if defined ltcg             set configure_flags=%configure_flags% --with-ltcg\n if defined pch              set configure_flags=%configure_flags% --with-pch\n if defined release_urlbase  set configure_flags=%configure_flags% --release-urlbase=%release_urlbase%\n@@ -352,10 +348,6 @@ if not defined noetw (\n     copy /Y ..\\src\\res\\node_etw_provider.man node-v%FULLVERSION%-win-%target_arch%\\ > nul\n     if errorlevel 1 echo Cannot copy node_etw_provider.man && goto package_error\n )\n-if not defined noperfctr (\n-    copy /Y ..\\src\\res\\node_perfctr_provider.man node-v%FULLVERSION%-win-%target_arch%\\ > nul\n-    if errorlevel 1 echo Cannot copy node_perfctr_provider.man && goto package_error\n-)\n \n echo Creating node-v%FULLVERSION%-win-%target_arch%.7z\n del node-v%FULLVERSION%-win-%target_arch%.7z > nul 2> nul\n@@ -391,7 +383,7 @@ if not defined msi goto install-doctools\n echo Building node-v%FULLVERSION%-%target_arch%.msi\n set \"msbsdk=\"\n if defined WindowsSDKVersion set \"msbsdk=/p:WindowsTargetPlatformVersion=%WindowsSDKVersion:~0,-1%\"\n-msbuild \"%~dp0tools\\msvs\\msi\\nodemsi.sln\" /m /t:Clean,Build %msbsdk% /p:PlatformToolset=%PLATFORM_TOOLSET% /p:GypMsvsVersion=%GYP_MSVS_VERSION% /p:Configuration=%config% /p:Platform=%target_arch% /p:NodeVersion=%NODE_VERSION% /p:FullVersion=%FULLVERSION% /p:DistTypeDir=%DISTTYPEDIR% %noetw_msi_arg% %noperfctr_msi_arg% /clp:NoSummary;NoItemAndPropertyList;Verbosity=minimal /nologo\n+msbuild \"%~dp0tools\\msvs\\msi\\nodemsi.sln\" /m /t:Clean,Build %msbsdk% /p:PlatformToolset=%PLATFORM_TOOLSET% /p:GypMsvsVersion=%GYP_MSVS_VERSION% /p:Configuration=%config% /p:Platform=%target_arch% /p:NodeVersion=%NODE_VERSION% /p:FullVersion=%FULLVERSION% /p:DistTypeDir=%DISTTYPEDIR% %noetw_msi_arg% /clp:NoSummary;NoItemAndPropertyList;Verbosity=minimal /nologo\n if errorlevel 1 goto exit\n \n if not defined sign goto upload\n@@ -631,7 +623,7 @@ del .used_configure_flags\n goto exit\n \n :help\n-echo vcbuild.bat [debug/release] [msi] [doc] [test/test-ci/test-all/test-addons/test-addons-napi/test-internet/test-pummel/test-simple/test-message/test-tick-processor/test-known-issues/test-node-inspect/test-check-deopts/test-npm/test-async-hooks/test-v8/test-v8-intl/test-v8-benchmarks/test-v8-all] [ignore-flaky] [static/dll] [noprojgen] [projgen] [small-icu/full-icu/without-intl] [nobuild] [nosnapshot] [noetw] [noperfctr] [ltcg] [nopch] [licensetf] [sign] [ia32/x86/x64] [vs2017] [download-all] [enable-vtune] [lint/lint-ci/lint-js/lint-js-ci/lint-md] [lint-md-build] [package] [build-release] [upload] [no-NODE-OPTIONS] [link-module path-to-module] [debug-http2] [debug-nghttp2] [clean] [no-cctest] [openssl-no-asm]\n+echo vcbuild.bat [debug/release] [msi] [doc] [test/test-ci/test-all/test-addons/test-addons-napi/test-internet/test-pummel/test-simple/test-message/test-tick-processor/test-known-issues/test-node-inspect/test-check-deopts/test-npm/test-async-hooks/test-v8/test-v8-intl/test-v8-benchmarks/test-v8-all] [ignore-flaky] [static/dll] [noprojgen] [projgen] [small-icu/full-icu/without-intl] [nobuild] [nosnapshot] [noetw] [ltcg] [nopch] [licensetf] [sign] [ia32/x86/x64] [vs2017] [download-all] [enable-vtune] [lint/lint-ci/lint-js/lint-js-ci/lint-md] [lint-md-build] [package] [build-release] [upload] [no-NODE-OPTIONS] [link-module path-to-module] [debug-http2] [debug-nghttp2] [clean] [no-cctest] [openssl-no-asm]\n echo Examples:\n echo   vcbuild.bat                          : builds release build\n echo   vcbuild.bat debug                    : builds debug build"
        }
    ],
    "stats": {
        "total": 904,
        "additions": 33,
        "deletions": 871
    }
}