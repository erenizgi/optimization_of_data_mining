{
    "author": "addaleax",
    "message": "src: add lock to inspector `MainThreadHandle` dtor\n\nOtherwise, the `CHECK` is reported to be a race condition\nby automated tooling. Itâ€™s not easy to tell from looking at\nthe source code whether that is actually the case or not,\nbut adding this lock should be a safe way to resolve it.\n\nPR-URL: https://github.com/nodejs/node/pull/26010\nReviewed-By: Eugene Ostroukhov <eostroukhov@google.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "82c4e170e5775ac0f3b4d14eba56a56f0c9126b4",
    "files": [
        {
            "sha": "a7d9f8a3c939d86578c53ddb0dab6dd878320f90",
            "filename": "src/inspector/main_thread_interface.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/82c4e170e5775ac0f3b4d14eba56a56f0c9126b4/src%2Finspector%2Fmain_thread_interface.h",
            "raw_url": "https://github.com/nodejs/node/raw/82c4e170e5775ac0f3b4d14eba56a56f0c9126b4/src%2Finspector%2Fmain_thread_interface.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector%2Fmain_thread_interface.h?ref=82c4e170e5775ac0f3b4d14eba56a56f0c9126b4",
            "patch": "@@ -45,6 +45,7 @@ class MainThreadHandle : public std::enable_shared_from_this<MainThreadHandle> {\n                             : main_thread_(main_thread) {\n   }\n   ~MainThreadHandle() {\n+    Mutex::ScopedLock scoped_lock(block_lock_);\n     CHECK_NULL(main_thread_);  // main_thread_ should have called Reset\n   }\n   std::unique_ptr<InspectorSession> Connect("
        }
    ],
    "stats": {
        "total": 1,
        "additions": 1,
        "deletions": 0
    }
}