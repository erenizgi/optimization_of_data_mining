{
    "author": "cjihrig",
    "message": "src: remove use of CallOnForegroundThread()\n\nThe V8 platform's CallOnForegroundThread() method is deprecated.\nThis commit replaces its use with GetForegroundTaskRunner()\nfunctionality instead.\n\nPR-URL: https://github.com/nodejs/node/pull/24925\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Franziska Hinkelmann <franziska.hinkelmann@gmail.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "40767a60706bb182280867f0180abacf34ede3d3",
    "files": [
        {
            "sha": "2ed6362df53fda745fc557455f41bf4c5f69cff0",
            "filename": "src/inspector/main_thread_interface.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/40767a60706bb182280867f0180abacf34ede3d3/src%2Finspector%2Fmain_thread_interface.cc",
            "raw_url": "https://github.com/nodejs/node/raw/40767a60706bb182280867f0180abacf34ede3d3/src%2Finspector%2Fmain_thread_interface.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector%2Fmain_thread_interface.cc?ref=40767a60706bb182280867f0180abacf34ede3d3",
            "patch": "@@ -255,8 +255,9 @@ void MainThreadInterface::Post(std::unique_ptr<Request> request) {\n   if (needs_notify) {\n     CHECK_EQ(0, uv_async_send(&main_thread_request_->first));\n     if (isolate_ != nullptr && platform_ != nullptr) {\n-      platform_->CallOnForegroundThread(isolate_,\n-                                        new DispatchMessagesTask(this));\n+      std::shared_ptr<v8::TaskRunner> taskrunner =\n+        platform_->GetForegroundTaskRunner(isolate_);\n+      taskrunner->PostTask(std::make_unique<DispatchMessagesTask>(this));\n       isolate_->RequestInterrupt([](v8::Isolate* isolate, void* thread) {\n         static_cast<MainThreadInterface*>(thread)->DispatchMessages();\n       }, this);"
        },
        {
            "sha": "2ef964276177be57ae7747c7372987d955b39ddc",
            "filename": "src/inspector_agent.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/40767a60706bb182280867f0180abacf34ede3d3/src%2Finspector_agent.cc",
            "raw_url": "https://github.com/nodejs/node/raw/40767a60706bb182280867f0180abacf34ede3d3/src%2Finspector_agent.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector_agent.cc?ref=40767a60706bb182280867f0180abacf34ede3d3",
            "patch": "@@ -40,6 +40,8 @@ using v8::Local;\n using v8::Message;\n using v8::Object;\n using v8::String;\n+using v8::Task;\n+using v8::TaskRunner;\n using v8::Value;\n \n using v8_inspector::StringBuffer;\n@@ -50,7 +52,7 @@ using v8_inspector::V8InspectorClient;\n static uv_sem_t start_io_thread_semaphore;\n static uv_async_t start_io_thread_async;\n \n-class StartIoTask : public v8::Task {\n+class StartIoTask : public Task {\n  public:\n   explicit StartIoTask(Agent* agent) : agent(agent) {}\n \n@@ -861,7 +863,9 @@ void Agent::RequestIoThreadStart() {\n   uv_async_send(&start_io_thread_async);\n   Isolate* isolate = parent_env_->isolate();\n   v8::Platform* platform = parent_env_->isolate_data()->platform();\n-  platform->CallOnForegroundThread(isolate, new StartIoTask(this));\n+  std::shared_ptr<TaskRunner> taskrunner =\n+    platform->GetForegroundTaskRunner(isolate);\n+  taskrunner->PostTask(std::make_unique<StartIoTask>(this));\n   isolate->RequestInterrupt(StartIoInterrupt, this);\n   uv_async_send(&start_io_thread_async);\n }"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 9,
        "deletions": 4
    }
}