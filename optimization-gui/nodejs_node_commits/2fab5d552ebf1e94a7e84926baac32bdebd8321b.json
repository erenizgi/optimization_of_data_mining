{
    "author": "refack",
    "message": "build,win: pack the install-tools scripts for dist\n\nPR-URL: https://github.com/nodejs/node/pull/24233\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Jo√£o Reis <reis@janeasystems.com>",
    "sha": "2fab5d552ebf1e94a7e84926baac32bdebd8321b",
    "files": [
        {
            "sha": "f008ea7f9adff75c416a4eab06aaad50475f5ee4",
            "filename": "tools/msvs/msi/product.wxs",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/2fab5d552ebf1e94a7e84926baac32bdebd8321b/tools%2Fmsvs%2Fmsi%2Fproduct.wxs",
            "raw_url": "https://github.com/nodejs/node/raw/2fab5d552ebf1e94a7e84926baac32bdebd8321b/tools%2Fmsvs%2Fmsi%2Fproduct.wxs",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Fmsvs%2Fmsi%2Fproduct.wxs?ref=2fab5d552ebf1e94a7e84926baac32bdebd8321b",
            "patch": "@@ -387,8 +387,8 @@\n \n     <UIRef Id=\"WixUI_Common\"/>\n     <UIRef Id=\"WixUI_ErrorProgressText\"/>\n-    <WixVariable Id=\"WixUIBannerBmp\" Value=\"..\\..\\..\\doc\\thin-white-stripe.jpg\"/>\n-    <WixVariable Id=\"WixUIDialogBmp\" Value=\"..\\..\\..\\doc\\full-white-stripe.jpg\"/>\n+    <WixVariable Id=\"WixUIBannerBmp\" Value=\"$(var.RepoDir)\\doc\\thin-white-stripe.jpg\"/>\n+    <WixVariable Id=\"WixUIDialogBmp\" Value=\"$(var.RepoDir)\\doc\\full-white-stripe.jpg\"/>\n     <WixVariable Id=\"WixUILicenseRtf\" Value=\"$(var.SourceDir)\\LICENSE.rtf\"/>\n   </Product>\n "
        },
        {
            "sha": "a63b2dfb33c825bd83729555bd028f08783c0779",
            "filename": "vcbuild.bat",
            "status": "modified",
            "additions": 29,
            "deletions": 26,
            "changes": 55,
            "blob_url": "https://github.com/nodejs/node/blob/2fab5d552ebf1e94a7e84926baac32bdebd8321b/vcbuild.bat",
            "raw_url": "https://github.com/nodejs/node/raw/2fab5d552ebf1e94a7e84926baac32bdebd8321b/vcbuild.bat",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/vcbuild.bat?ref=2fab5d552ebf1e94a7e84926baac32bdebd8321b",
            "patch": "@@ -204,7 +204,7 @@ call :getnodeversion || exit /b 1\n if defined TAG set configure_flags=%configure_flags% --tag=%TAG%\n \n if not \"%target%\"==\"Clean\" goto skip-clean\n-rmdir /Q /S \"%~dp0%config%\\node-v%FULLVERSION%-win-%target_arch%\" > nul 2> nul\n+rmdir /Q /S \"%~dp0%config%\\%TARGET_NAME%\" > nul 2> nul\n :skip-clean\n \n if defined noprojgen if defined nobuild if not defined sign if not defined msi goto licensertf\n@@ -339,48 +339,50 @@ if not defined stage_package goto install-doctools\n \n echo Creating package...\n cd Release\n-rmdir /S /Q node-v%FULLVERSION%-win-%target_arch% > nul 2> nul\n-mkdir node-v%FULLVERSION%-win-%target_arch% > nul 2> nul\n-mkdir node-v%FULLVERSION%-win-%target_arch%\\node_modules > nul 2>nul\n+rmdir /S /Q %TARGET_NAME% > nul 2> nul\n+mkdir %TARGET_NAME% > nul 2> nul\n+mkdir %TARGET_NAME%\\node_modules > nul 2>nul\n \n-copy /Y node.exe node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+copy /Y node.exe %TARGET_NAME%\\ > nul\n if errorlevel 1 echo Cannot copy node.exe && goto package_error\n-copy /Y ..\\LICENSE node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+copy /Y ..\\LICENSE %TARGET_NAME%\\ > nul\n if errorlevel 1 echo Cannot copy LICENSE && goto package_error\n-copy /Y ..\\README.md node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+copy /Y ..\\README.md %TARGET_NAME%\\ > nul\n if errorlevel 1 echo Cannot copy README.md && goto package_error\n-copy /Y ..\\CHANGELOG.md node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+copy /Y ..\\CHANGELOG.md %TARGET_NAME%\\ > nul\n if errorlevel 1 echo Cannot copy CHANGELOG.md && goto package_error\n-robocopy ..\\deps\\npm node-v%FULLVERSION%-win-%target_arch%\\node_modules\\npm /e /xd test > nul\n+robocopy ..\\deps\\npm %TARGET_NAME%\\node_modules\\npm /e /xd test > nul\n if errorlevel 8 echo Cannot copy npm package && goto package_error\n-copy /Y ..\\deps\\npm\\bin\\npm node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+copy /Y ..\\deps\\npm\\bin\\npm %TARGET_NAME%\\ > nul\n if errorlevel 1 echo Cannot copy npm && goto package_error\n-copy /Y ..\\deps\\npm\\bin\\npm.cmd node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+copy /Y ..\\deps\\npm\\bin\\npm.cmd %TARGET_NAME%\\ > nul\n if errorlevel 1 echo Cannot copy npm.cmd && goto package_error\n-copy /Y ..\\deps\\npm\\bin\\npx node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+copy /Y ..\\deps\\npm\\bin\\npx %TARGET_NAME%\\ > nul\n if errorlevel 1 echo Cannot copy npx && goto package_error\n-copy /Y ..\\deps\\npm\\bin\\npx.cmd node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+copy /Y ..\\deps\\npm\\bin\\npx.cmd %TARGET_NAME%\\ > nul\n if errorlevel 1 echo Cannot copy npx.cmd && goto package_error\n-copy /Y ..\\tools\\msvs\\nodevars.bat node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+copy /Y ..\\tools\\msvs\\nodevars.bat %TARGET_NAME%\\ > nul\n if errorlevel 1 echo Cannot copy nodevars.bat && goto package_error\n+copy /Y ..\\tools\\msvs\\install_tools\\*.* %TARGET_NAME%\\ > nul\n+if errorlevel 1 echo Cannot copy install_tools scripts && goto package_error\n if not defined noetw (\n-    copy /Y ..\\src\\res\\node_etw_provider.man node-v%FULLVERSION%-win-%target_arch%\\ > nul\n+    copy /Y ..\\src\\res\\node_etw_provider.man %TARGET_NAME%\\ > nul\n     if errorlevel 1 echo Cannot copy node_etw_provider.man && goto package_error\n )\n cd ..\n \n :package\n if not defined package goto msi\n cd Release\n-echo Creating node-v%FULLVERSION%-win-%target_arch%.7z\n-del node-v%FULLVERSION%-win-%target_arch%.7z > nul 2> nul\n-7z a -r -mx9 -t7z node-v%FULLVERSION%-win-%target_arch%.7z node-v%FULLVERSION%-win-%target_arch% > nul\n-if errorlevel 1 echo Cannot create node-v%FULLVERSION%-win-%target_arch%.7z && goto package_error\n+echo Creating %TARGET_NAME%.7z\n+del %TARGET_NAME%.7z > nul 2> nul\n+7z a -r -mx9 -t7z %TARGET_NAME%.7z %TARGET_NAME% > nul\n+if errorlevel 1 echo Cannot create %TARGET_NAME%.7z && goto package_error\n \n-echo Creating node-v%FULLVERSION%-win-%target_arch%.zip\n-del node-v%FULLVERSION%-win-%target_arch%.zip > nul 2> nul\n-7z a -r -mx9 -tzip node-v%FULLVERSION%-win-%target_arch%.zip node-v%FULLVERSION%-win-%target_arch% > nul\n-if errorlevel 1 echo Cannot create node-v%FULLVERSION%-win-%target_arch%.zip && goto package_error\n+echo Creating %TARGET_NAME%.zip\n+del %TARGET_NAME%.zip > nul 2> nul\n+7z a -r -mx9 -tzip %TARGET_NAME%.zip %TARGET_NAME% > nul\n+if errorlevel 1 echo Cannot create %TARGET_NAME%.zip && goto package_error\n \n echo Creating node_pdb.7z\n del node_pdb.7z > nul 2> nul\n@@ -433,13 +435,13 @@ scp -F %SSHCONFIG% Release\\node_pdb.zip %STAGINGSERVER%:nodejs/%DISTTYPEDIR%/v%F\n if errorlevel 1 goto exit\n scp -F %SSHCONFIG% Release\\node_pdb.7z %STAGINGSERVER%:nodejs/%DISTTYPEDIR%/v%FULLVERSION%/win-%target_arch%/node_pdb.7z\n if errorlevel 1 goto exit\n-scp -F %SSHCONFIG% Release\\node-v%FULLVERSION%-win-%target_arch%.7z %STAGINGSERVER%:nodejs/%DISTTYPEDIR%/v%FULLVERSION%/node-v%FULLVERSION%-win-%target_arch%.7z\n+scp -F %SSHCONFIG% Release\\%TARGET_NAME%.7z %STAGINGSERVER%:nodejs/%DISTTYPEDIR%/v%FULLVERSION%/%TARGET_NAME%.7z\n if errorlevel 1 goto exit\n-scp -F %SSHCONFIG% Release\\node-v%FULLVERSION%-win-%target_arch%.zip %STAGINGSERVER%:nodejs/%DISTTYPEDIR%/v%FULLVERSION%/node-v%FULLVERSION%-win-%target_arch%.zip\n+scp -F %SSHCONFIG% Release\\%TARGET_NAME%.zip %STAGINGSERVER%:nodejs/%DISTTYPEDIR%/v%FULLVERSION%/%TARGET_NAME%.zip\n if errorlevel 1 goto exit\n scp -F %SSHCONFIG% node-v%FULLVERSION%-%target_arch%.msi %STAGINGSERVER%:nodejs/%DISTTYPEDIR%/v%FULLVERSION%/\n if errorlevel 1 goto exit\n-ssh -F %SSHCONFIG% %STAGINGSERVER% \"touch nodejs/%DISTTYPEDIR%/v%FULLVERSION%/node-v%FULLVERSION%-%target_arch%.msi.done nodejs/%DISTTYPEDIR%/v%FULLVERSION%/node-v%FULLVERSION%-win-%target_arch%.zip.done nodejs/%DISTTYPEDIR%/v%FULLVERSION%/node-v%FULLVERSION%-win-%target_arch%.7z.done nodejs/%DISTTYPEDIR%/v%FULLVERSION%/win-%target_arch%.done && chmod -R ug=rw-x+X,o=r+X nodejs/%DISTTYPEDIR%/v%FULLVERSION%/node-v%FULLVERSION%-%target_arch%.* nodejs/%DISTTYPEDIR%/v%FULLVERSION%/win-%target_arch%*\"\n+ssh -F %SSHCONFIG% %STAGINGSERVER% \"touch nodejs/%DISTTYPEDIR%/v%FULLVERSION%/node-v%FULLVERSION%-%target_arch%.msi.done nodejs/%DISTTYPEDIR%/v%FULLVERSION%/%TARGET_NAME%.zip.done nodejs/%DISTTYPEDIR%/v%FULLVERSION%/%TARGET_NAME%.7z.done nodejs/%DISTTYPEDIR%/v%FULLVERSION%/win-%target_arch%.done && chmod -R ug=rw-x+X,o=r+X nodejs/%DISTTYPEDIR%/v%FULLVERSION%/node-v%FULLVERSION%-%target_arch%.* nodejs/%DISTTYPEDIR%/v%FULLVERSION%/win-%target_arch%*\"\n if errorlevel 1 goto exit\n \n \n@@ -733,4 +735,5 @@ set FULLVERSION=%NODE_VERSION%-%TAG%\n \n :distexit\n if not defined DISTTYPEDIR set DISTTYPEDIR=%DISTTYPE%\n+set TARGET_NAME=node-v%FULLVERSION%-win-%target_arch%\n goto :EOF"
        }
    ],
    "stats": {
        "total": 59,
        "additions": 31,
        "deletions": 28
    }
}