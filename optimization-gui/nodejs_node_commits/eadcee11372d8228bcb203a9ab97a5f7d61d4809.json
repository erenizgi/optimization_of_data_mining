{
    "author": "Trott",
    "message": "tls: throw if SNICallback is not a function\n\nIf a value is passed for SNICallback and it is not a function,\ncreateServer() will now throw.\n\nPR-URL: https://github.com/nodejs/node/pull/20969\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Ujjwal Sharma <usharma1998@gmail.com>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "eadcee11372d8228bcb203a9ab97a5f7d61d4809",
    "files": [
        {
            "sha": "77b37c54f0aee04bf0bc9a38d9ea2e6645bd4d38",
            "filename": "lib/_tls_wrap.js",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/eadcee11372d8228bcb203a9ab97a5f7d61d4809/lib%2F_tls_wrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/eadcee11372d8228bcb203a9ab97a5f7d61d4809/lib%2F_tls_wrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_tls_wrap.js?ref=eadcee11372d8228bcb203a9ab97a5f7d61d4809",
            "patch": "@@ -896,6 +896,11 @@ function Server(options, listener) {\n       'options.handshakeTimeout', 'number', options.handshakeTimeout);\n   }\n \n+  if (this[kSNICallback] && typeof this[kSNICallback] !== 'function') {\n+    throw new ERR_INVALID_ARG_TYPE(\n+      'options.SNICallback', 'function', options.SNICallback);\n+  }\n+\n   if (this.sessionTimeout) {\n     this._sharedCreds.context.setSessionTimeout(this.sessionTimeout);\n   }"
        },
        {
            "sha": "307a359ebb2ab1dcdbcdc7d7759a70fcfc705807",
            "filename": "test/parallel/test-tls-snicallback-error.js",
            "status": "added",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/eadcee11372d8228bcb203a9ab97a5f7d61d4809/test%2Fparallel%2Ftest-tls-snicallback-error.js",
            "raw_url": "https://github.com/nodejs/node/raw/eadcee11372d8228bcb203a9ab97a5f7d61d4809/test%2Fparallel%2Ftest-tls-snicallback-error.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tls-snicallback-error.js?ref=eadcee11372d8228bcb203a9ab97a5f7d61d4809",
            "patch": "@@ -0,0 +1,17 @@\n+'use strict';\n+const common = require('../common');\n+if (!common.hasCrypto)\n+  common.skip('missing crypto');\n+\n+if (!process.features.tls_sni)\n+  common.skip('compiled without OpenSSL or with old OpenSSL version');\n+\n+const assert = require('assert');\n+const tls = require('tls');\n+\n+['fhqwhgads', 42, {}, []].forEach((testValue) => {\n+  assert.throws(\n+    () => { tls.createServer({ SNICallback: testValue }); },\n+    { code: 'ERR_INVALID_ARG_TYPE', message: /\\boptions\\.SNICallback\\b/ }\n+  );\n+});"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 22,
        "deletions": 0
    }
}