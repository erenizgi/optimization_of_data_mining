{
    "author": "shigeki",
    "message": "build, win: opt-in openssl_no_asm if no nasm found\n\nInstead of automatically falling back to openssl_no_asm with warning\nif no nasm is found during build on Windows, this stops vcbuild.bat\nand requires users to specify openssl_no_asm option explicitly.\n\nFixes: https://github.com/nodejs/node/issues/19918\nPR-URL: https://github.com/nodejs/node/pull/19943\nRefs: https://github.com/nodejs/node/pull/19930\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Rod Vagg <rod@vagg.org>\nReviewed-By: Bartosz Sosnowski <bartosz@janeasystems.com>",
    "sha": "f3f129898056244a52aed33b89d0edffc128637a",
    "files": [
        {
            "sha": "da832c9c245132b677a53e8736f6a2186f790f80",
            "filename": "BUILDING.md",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/f3f129898056244a52aed33b89d0edffc128637a/BUILDING.md",
            "raw_url": "https://github.com/nodejs/node/raw/f3f129898056244a52aed33b89d0edffc128637a/BUILDING.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/BUILDING.md?ref=f3f129898056244a52aed33b89d0edffc128637a",
            "patch": "@@ -258,9 +258,9 @@ Prerequisites:\n * Basic Unix tools required for some tests,\n   [Git for Windows](http://git-scm.com/download/win) includes Git Bash\n   and tools which can be included in the global `PATH`.\n-* **Optional** (for OpenSSL assembler modules): the [NetWide Assembler](http://www.nasm.us/),\n-  if not installed in the default location it needs to be manually added\n-  to `PATH`.\n+* The [NetWide Assembler](http://www.nasm.us/), for OpenSSL assembler modules.\n+  If not installed in the default location, it needs to be manually added\n+  to `PATH`. Build with `openssl-no-asm` option does not require this.\n * **Optional** (to build the MSI): the [WiX Toolset v3.11](http://wixtoolset.org/releases/)\n   and the [Wix Toolset Visual Studio 2017 Extension](https://marketplace.visualstudio.com/items?itemName=RobMensching.WixToolsetVisualStudio2017Extension).\n "
        },
        {
            "sha": "37df2c2531b2d5ba310c738229baae7f3ec7fc01",
            "filename": "vcbuild.bat",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/f3f129898056244a52aed33b89d0edffc128637a/vcbuild.bat",
            "raw_url": "https://github.com/nodejs/node/raw/f3f129898056244a52aed33b89d0edffc128637a/vcbuild.bat",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/vcbuild.bat?ref=f3f129898056244a52aed33b89d0edffc128637a",
            "patch": "@@ -52,6 +52,7 @@ set http2_debug=\n set nghttp2_debug=\n set link_module=\n set no_cctest=\n+set openssl_no_asm=\n \n :next-arg\n if \"%1\"==\"\" goto args-done\n@@ -117,6 +118,7 @@ if /i \"%1\"==\"debug-http2\"   set debug_http2=1&goto arg-ok\n if /i \"%1\"==\"debug-nghttp2\" set debug_nghttp2=1&goto arg-ok\n if /i \"%1\"==\"link-module\"   set \"link_module= --link-module=%2%link_module%\"&goto arg-ok-2\n if /i \"%1\"==\"no-cctest\"     set no_cctest=1&goto arg-ok\n+if /i \"%1\"==\"openssl-no-asm\"   set openssl_no_asm=1&goto arg-ok\n \n echo Error: invalid command line option `%1`.\n exit /b 1\n@@ -161,6 +163,7 @@ if defined link_module      set configure_flags=%configure_flags% %link_module%\n if defined i18n_arg         set configure_flags=%configure_flags% --with-intl=%i18n_arg%\n if defined config_flags     set configure_flags=%configure_flags% %config_flags%\n if defined target_arch      set configure_flags=%configure_flags% --dest-cpu=%target_arch%\n+if defined openssl_no_asm   set configure_flags=%configure_flags% --openssl-no-asm\n \n if not exist \"%~dp0deps\\icu\" goto no-depsicu\n if \"%target%\"==\"Clean\" echo deleting %~dp0deps\\icu\n@@ -170,8 +173,8 @@ if \"%target%\"==\"Clean\" rmdir /S /Q %~dp0deps\\icu\n call tools\\msvs\\find_python.cmd\n if errorlevel 1 goto :exit\n \n-call tools\\msvs\\find_nasm.cmd\n-if errorlevel 1 echo Could not find NASM, it will not be used.\n+if not defined openssl_no_asm call tools\\msvs\\find_nasm.cmd\n+if errorlevel 1 echo Could not find NASM, install it or build with openssl-no-asm. See BUILDING.md.\n \n call :getnodeversion || exit /b 1\n \n@@ -547,7 +550,7 @@ echo Failed to create vc project files.\n goto exit\n \n :help\n-echo vcbuild.bat [debug/release] [msi] [test/test-ci/test-all/test-addons/test-addons-napi/test-internet/test-pummel/test-simple/test-message/test-gc/test-tick-processor/test-known-issues/test-node-inspect/test-check-deopts/test-npm/test-async-hooks/test-v8/test-v8-intl/test-v8-benchmarks/test-v8-all] [ignore-flaky] [static/dll] [noprojgen] [small-icu/full-icu/without-intl] [nobuild] [nosnapshot] [noetw] [noperfctr] [licensetf] [sign] [ia32/x86/x64] [vs2017] [download-all] [enable-vtune] [lint/lint-ci/lint-js/lint-js-ci] [package] [build-release] [upload] [no-NODE-OPTIONS] [link-module path-to-module] [debug-http2] [debug-nghttp2] [clean] [no-cctest]\n+echo vcbuild.bat [debug/release] [msi] [test/test-ci/test-all/test-addons/test-addons-napi/test-internet/test-pummel/test-simple/test-message/test-gc/test-tick-processor/test-known-issues/test-node-inspect/test-check-deopts/test-npm/test-async-hooks/test-v8/test-v8-intl/test-v8-benchmarks/test-v8-all] [ignore-flaky] [static/dll] [noprojgen] [small-icu/full-icu/without-intl] [nobuild] [nosnapshot] [noetw] [noperfctr] [licensetf] [sign] [ia32/x86/x64] [vs2017] [download-all] [enable-vtune] [lint/lint-ci/lint-js/lint-js-ci] [package] [build-release] [upload] [no-NODE-OPTIONS] [link-module path-to-module] [debug-http2] [debug-nghttp2] [clean] [no-cctest] [openssl-no-asm]\n echo Examples:\n echo   vcbuild.bat                          : builds release build\n echo   vcbuild.bat debug                    : builds debug build"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 9,
        "deletions": 6
    }
}