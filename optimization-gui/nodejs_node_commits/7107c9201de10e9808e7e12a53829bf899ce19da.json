{
    "author": "BridgeAR",
    "message": "tools: fix custom eslint rule errors\n\nThis fixes a few rules by making sure the input is actually ready\nto be checked. Otherwise those can throw TypeErrors or result in\nfaulty error messages.\n\nPR-URL: https://github.com/nodejs/node/pull/18853\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "7107c9201de10e9808e7e12a53829bf899ce19da",
    "files": [
        {
            "sha": "b2dcacbb86681614bf09f9b8c17022e1f0d67d64",
            "filename": "tools/eslint-rules/alphabetize-errors.js",
            "status": "modified",
            "additions": 2,
            "deletions": 7,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/7107c9201de10e9808e7e12a53829bf899ce19da/tools%2Feslint-rules%2Falphabetize-errors.js",
            "raw_url": "https://github.com/nodejs/node/raw/7107c9201de10e9808e7e12a53829bf899ce19da/tools%2Feslint-rules%2Falphabetize-errors.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Feslint-rules%2Falphabetize-errors.js?ref=7107c9201de10e9808e7e12a53829bf899ce19da",
            "patch": "@@ -1,19 +1,14 @@\n 'use strict';\n \n+const { isDefiningError } = require('./rules-utils.js');\n+\n const prefix = 'Out of ASCIIbetical order - ';\n const opStr = ' >= ';\n \n function errorForNode(node) {\n   return node.expression.arguments[0].value;\n }\n \n-function isDefiningError(node) {\n-  return node.expression &&\n-         node.expression.type === 'CallExpression' &&\n-         node.expression.callee &&\n-         node.expression.callee.name === 'E';\n-}\n-\n module.exports = {\n   create: function(context) {\n     let previousNode;"
        },
        {
            "sha": "0dbabb0673aa4b3383184947880aeeaceb4c3c77",
            "filename": "tools/eslint-rules/documented-errors.js",
            "status": "modified",
            "additions": 2,
            "deletions": 8,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/7107c9201de10e9808e7e12a53829bf899ce19da/tools%2Feslint-rules%2Fdocumented-errors.js",
            "raw_url": "https://github.com/nodejs/node/raw/7107c9201de10e9808e7e12a53829bf899ce19da/tools%2Feslint-rules%2Fdocumented-errors.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Feslint-rules%2Fdocumented-errors.js?ref=7107c9201de10e9808e7e12a53829bf899ce19da",
            "patch": "@@ -2,6 +2,7 @@\n \n const fs = require('fs');\n const path = require('path');\n+const { isDefiningError } = require('./rules-utils.js');\n \n const doc = fs.readFileSync(path.resolve(__dirname, '../../doc/api/errors.md'),\n                             'utf8');\n@@ -18,18 +19,11 @@ function errorForNode(node) {\n   return node.expression.arguments[0].value;\n }\n \n-function isDefiningError(node) {\n-  return node.expression &&\n-         node.expression.type === 'CallExpression' &&\n-         node.expression.callee &&\n-         node.expression.callee.name === 'E';\n-}\n-\n module.exports = {\n   create: function(context) {\n     return {\n       ExpressionStatement: function(node) {\n-        if (!isDefiningError(node)) return;\n+        if (!isDefiningError(node) || !errorForNode(node)) return;\n         const code = errorForNode(node);\n         if (!isInDoc(code)) {\n           const message = `\"${code}\" is not documented in doc/api/errors.md`;"
        },
        {
            "sha": "407b6e20dd23eade91fcc4236d40df04219164b6",
            "filename": "tools/eslint-rules/prefer-util-format-errors.js",
            "status": "modified",
            "additions": 3,
            "deletions": 8,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/7107c9201de10e9808e7e12a53829bf899ce19da/tools%2Feslint-rules%2Fprefer-util-format-errors.js",
            "raw_url": "https://github.com/nodejs/node/raw/7107c9201de10e9808e7e12a53829bf899ce19da/tools%2Feslint-rules%2Fprefer-util-format-errors.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Feslint-rules%2Fprefer-util-format-errors.js?ref=7107c9201de10e9808e7e12a53829bf899ce19da",
            "patch": "@@ -1,5 +1,7 @@\n 'use strict';\n \n+const { isDefiningError } = require('./rules-utils.js');\n+\n const errMsg = 'Please use a printf-like formatted string that util.format' +\n                ' can consume.';\n \n@@ -8,18 +10,11 @@ function isArrowFunctionWithTemplateLiteral(node) {\n          node.body.type === 'TemplateLiteral';\n }\n \n-function isDefiningError(node) {\n-  return node.expression &&\n-         node.expression.type === 'CallExpression' &&\n-         node.expression.callee &&\n-         node.expression.callee.name === 'E';\n-}\n-\n module.exports = {\n   create: function(context) {\n     return {\n       ExpressionStatement: function(node) {\n-        if (!isDefiningError(node))\n+        if (!isDefiningError(node) || node.expression.arguments.length < 2)\n           return;\n \n         const msg = node.expression.arguments[1];"
        },
        {
            "sha": "0e89a715450edbfa97900f7e06f84275070d5df9",
            "filename": "tools/eslint-rules/rules-utils.js",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/7107c9201de10e9808e7e12a53829bf899ce19da/tools%2Feslint-rules%2Frules-utils.js",
            "raw_url": "https://github.com/nodejs/node/raw/7107c9201de10e9808e7e12a53829bf899ce19da/tools%2Feslint-rules%2Frules-utils.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Feslint-rules%2Frules-utils.js?ref=7107c9201de10e9808e7e12a53829bf899ce19da",
            "patch": "@@ -3,6 +3,14 @@\n  */\n 'use strict';\n \n+module.exports.isDefiningError = function(node) {\n+  return node.expression &&\n+         node.expression.type === 'CallExpression' &&\n+         node.expression.callee &&\n+         node.expression.callee.name === 'E' &&\n+         node.expression.arguments.length !== 0;\n+};\n+\n /**\n  * Returns true if any of the passed in modules are used in\n  * require calls."
        }
    ],
    "stats": {
        "total": 38,
        "additions": 15,
        "deletions": 23
    }
}