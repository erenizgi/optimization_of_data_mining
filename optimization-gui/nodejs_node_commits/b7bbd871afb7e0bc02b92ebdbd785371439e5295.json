{
    "author": "bcoe",
    "message": "deps: v8, cherry-pick 9365d09, aac2f8c, 47d34a3\n\n    Original commit message 9365d09:\n\n        [coverage] Rework continuation counter handling\n\n        This changes a few bits about how continuation counters are handled.\n\n        It introduces a new mechanism that allows removal of a continuation\n        range after it has been created. If coverage is enabled, we run a first\n        post-processing pass on the AST immediately after parsing, which\n        removes problematic continuation ranges in two situations:\n\n        1. nested continuation counters - only the outermost stays alive.\n        2. trailing continuation counters within a block-like structure are\n           removed if the containing structure itself has a continuation.\n\n        R=bmeurer@chromium.org, jgruber@chromium.org, yangguo@chromium.org\n\n        Bug: v8:8381, v8:8539\n        Change-Id: I6bcaea5060d8c481d7bae099f6db9f993cc30ee3\n        Reviewed-on: https://chromium-review.googlesource.com/c/1339119\n        Reviewed-by: Yang Guo <yangguo@chromium.org>\n        Reviewed-by: Leszek Swirski <leszeks@chromium.org>\n        Reviewed-by: Georg Neis <neis@chromium.org>\n        Commit-Queue: Jakob Gruber <jgruber@chromium.org>\n        Cr-Commit-Position: refs/heads/master@{#58443}\n\n    Refs: v8/v8@9365d09\n\n    Original commit message aac2f8c:\n\n        [coverage] Filter out singleton ranges that alias full ranges\n\n        Block coverage is based on a system of ranges that can either have\n        both a start and end position, or only a start position (so-called\n        singleton ranges). When formatting coverage information, singletons\n        are expanded until the end of the immediate full parent range. E.g.\n        in:\n\n        {0, 10}  // Full range.\n        {5, -1}  // Singleton range.\n\n        the singleton range is expanded to {5, 10}.\n\n        Singletons are produced mostly for continuation counters that track\n        whether we execute past a specific language construct.\n\n        Unfortunately, continuation counters can turn up in spots that confuse\n        our post-processing. For example:\n\n        if (true) { ... block1 ... } else { ... block2 ... }\n\n        If block1 produces a continuation counter, it could end up with the\n        same start position as the else-branch counter. Since we merge\n        identical blocks, the else-branch could incorrectly end up with an\n        execution count of one.\n\n        We need to avoid merging such cases. A full range should always take\n        precedence over a singleton range; a singleton range should never\n        expand to completely fill a full range. An additional post-processing\n        pass ensures this.\n\n        Bug: v8:8237\n        Change-Id: Idb3ec7b2feddc0585313810b9c8be1e9f4ec64bf\n        Reviewed-on: https://chromium-review.googlesource.com/c/1273095\n        Reviewed-by: Georg Neis <neis@chromium.org>\n        Reviewed-by: Yang Guo <yangguo@chromium.org>\n        Commit-Queue: Jakob Gruber <jgruber@chromium.org>\n        Cr-Commit-Position: refs/heads/master@{#56531}\n\n    Refs: v8/v8@aac2f8c\n\n    deps: V8: backport 47d34a3\n\n    Original commit message:\n\n        Revert \"[coverage] change block range to avoid ambiguity.\"\n\n        This reverts commit 471fef0469d04d7c487f3a08e81f3d77566a2f50.\n\n        Reason for revert: A more general fix incoming at https://crrev.com/c/1273095.\n\n        Original change's description:\n        > [coverage] change block range to avoid ambiguity.\n        >\n        > By moving the block range end to left of closing bracket,\n        > we can avoid ambiguity where an open-ended singleton range\n        > could be both interpreted as inside the parent range, or\n        > next to it.\n        >\n        > R=<U+200B>verwaest@chromium.org\n        >\n        > Bug: v8:8237\n        > Change-Id: Ibc9412b31efe900b6d8bff0d8fa8c52ddfbf460a\n        > Reviewed-on: https://chromium-review.googlesource.com/1254127\n        > Reviewed-by: Georg Neis <neis@chromium.org>\n        > Commit-Queue: Yang Guo <yangguo@chromium.org>\n        > Cr-Commit-Position: refs/heads/master@{#56347}\n\n        TBR=yangguo@chromium.org,neis@chromium.org,verwaest@chromium.org\n\n        # Not skipping CQ checks because original CL landed > 1 day ago.\n\n        Bug: v8:8237\n        Change-Id: I39310cf3c2f06a0d98ff314740aaeefbfffc0834\n        Reviewed-on: https://chromium-review.googlesource.com/c/1273096\n        Reviewed-by: Jakob Gruber <jgruber@chromium.org>\n        Reviewed-by: Toon Verwaest <verwaest@chromium.org>\n        Reviewed-by: Yang Guo <yangguo@chromium.org>\n        Commit-Queue: Jakob Gruber <jgruber@chromium.org>\n        Cr-Commit-Position: refs/heads/master@{#56513}\n\n    Refs: https://github.com/v8/v8/commit/47d34a317e47bad86b68326607cd2e6de3901f3e\n\nPR-URL: https://github.com/nodejs/node/pull/25429\nReviewed-By: Yang Guo <yangguo@chromium.org>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>",
    "sha": "b7bbd871afb7e0bc02b92ebdbd785371439e5295",
    "files": [
        {
            "sha": "e683760a4a918861f378555b353dc83e0173dec5",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -38,7 +38,7 @@\n \n     # Reset this number to 0 on major V8 upgrades.\n     # Increment by one for each non-official patch applied to deps/v8.\n-    'v8_embedder_string': '-node.9',\n+    'v8_embedder_string': '-node.10',\n \n     ##### V8 defaults for Node.js #####\n "
        },
        {
            "sha": "6bb77db7ea96d5ea8b67e09fbd4d3b0a5208c5ff",
            "filename": "deps/v8/BUILD.gn",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2FBUILD.gn",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2FBUILD.gn",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2FBUILD.gn?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -1589,6 +1589,8 @@ v8_source_set(\"v8_base\") {\n     \"src/ast/scopes-inl.h\",\n     \"src/ast/scopes.cc\",\n     \"src/ast/scopes.h\",\n+    \"src/ast/source-range-ast-visitor.cc\",\n+    \"src/ast/source-range-ast-visitor.h\",\n     \"src/ast/variables.cc\",\n     \"src/ast/variables.h\",\n     \"src/bailout-reason.cc\","
        },
        {
            "sha": "dd0f6799d5ae90a13c7d9181544243b3a166ad92",
            "filename": "deps/v8/gypfiles/v8.gyp",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fgypfiles%2Fv8.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fgypfiles%2Fv8.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fgypfiles%2Fv8.gyp?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -611,6 +611,8 @@\n         '../src/ast/scopes-inl.h',\n         '../src/ast/scopes.cc',\n         '../src/ast/scopes.h',\n+        '../src/ast/source-range-ast-visitor.cc',\n+        '../src/ast/source-range-ast-visitor.h',\n         '../src/ast/variables.cc',\n         '../src/ast/variables.h',\n         '../src/bailout-reason.cc',"
        },
        {
            "sha": "a04e68fa2f651d3df3781e24d672babb498c8ba6",
            "filename": "deps/v8/src/ast/ast-source-ranges.h",
            "status": "modified",
            "additions": 80,
            "deletions": 3,
            "changes": 83,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fast%2Fast-source-ranges.h",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fast%2Fast-source-ranges.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fast%2Fast-source-ranges.h?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -59,6 +59,8 @@ class AstNodeSourceRanges : public ZoneObject {\n  public:\n   virtual ~AstNodeSourceRanges() = default;\n   virtual SourceRange GetRange(SourceRangeKind kind) = 0;\n+  virtual bool HasRange(SourceRangeKind kind) = 0;\n+  virtual void RemoveContinuationRange() { UNREACHABLE(); }\n };\n \n class BinaryOperationSourceRanges final : public AstNodeSourceRanges {\n@@ -67,10 +69,14 @@ class BinaryOperationSourceRanges final : public AstNodeSourceRanges {\n       : right_range_(right_range) {}\n \n   SourceRange GetRange(SourceRangeKind kind) override {\n-    DCHECK_EQ(kind, SourceRangeKind::kRight);\n+    DCHECK(HasRange(kind));\n     return right_range_;\n   }\n \n+  bool HasRange(SourceRangeKind kind) override {\n+    return kind == SourceRangeKind::kRight;\n+  }\n+\n  private:\n   SourceRange right_range_;\n };\n@@ -81,10 +87,19 @@ class ContinuationSourceRanges : public AstNodeSourceRanges {\n       : continuation_position_(continuation_position) {}\n \n   SourceRange GetRange(SourceRangeKind kind) override {\n-    DCHECK_EQ(kind, SourceRangeKind::kContinuation);\n+    DCHECK(HasRange(kind));\n     return SourceRange::OpenEnded(continuation_position_);\n   }\n \n+  bool HasRange(SourceRangeKind kind) override {\n+    return kind == SourceRangeKind::kContinuation;\n+  }\n+\n+  void RemoveContinuationRange() override {\n+    DCHECK(HasRange(SourceRangeKind::kContinuation));\n+    continuation_position_ = kNoSourcePosition;\n+  }\n+\n  private:\n   int32_t continuation_position_;\n };\n@@ -101,10 +116,14 @@ class CaseClauseSourceRanges final : public AstNodeSourceRanges {\n       : body_range_(body_range) {}\n \n   SourceRange GetRange(SourceRangeKind kind) override {\n-    DCHECK_EQ(kind, SourceRangeKind::kBody);\n+    DCHECK(HasRange(kind));\n     return body_range_;\n   }\n \n+  bool HasRange(SourceRangeKind kind) override {\n+    return kind == SourceRangeKind::kBody;\n+  }\n+\n  private:\n   SourceRange body_range_;\n };\n@@ -116,6 +135,7 @@ class ConditionalSourceRanges final : public AstNodeSourceRanges {\n       : then_range_(then_range), else_range_(else_range) {}\n \n   SourceRange GetRange(SourceRangeKind kind) override {\n+    DCHECK(HasRange(kind));\n     switch (kind) {\n       case SourceRangeKind::kThen:\n         return then_range_;\n@@ -126,6 +146,10 @@ class ConditionalSourceRanges final : public AstNodeSourceRanges {\n     }\n   }\n \n+  bool HasRange(SourceRangeKind kind) override {\n+    return kind == SourceRangeKind::kThen || kind == SourceRangeKind::kElse;\n+  }\n+\n  private:\n   SourceRange then_range_;\n   SourceRange else_range_;\n@@ -138,12 +162,14 @@ class IfStatementSourceRanges final : public AstNodeSourceRanges {\n       : then_range_(then_range), else_range_(else_range) {}\n \n   SourceRange GetRange(SourceRangeKind kind) override {\n+    DCHECK(HasRange(kind));\n     switch (kind) {\n       case SourceRangeKind::kElse:\n         return else_range_;\n       case SourceRangeKind::kThen:\n         return then_range_;\n       case SourceRangeKind::kContinuation: {\n+        if (!has_continuation_) return SourceRange::Empty();\n         const SourceRange& trailing_range =\n             else_range_.IsEmpty() ? then_range_ : else_range_;\n         return SourceRange::ContinuationOf(trailing_range);\n@@ -153,9 +179,20 @@ class IfStatementSourceRanges final : public AstNodeSourceRanges {\n     }\n   }\n \n+  bool HasRange(SourceRangeKind kind) override {\n+    return kind == SourceRangeKind::kThen || kind == SourceRangeKind::kElse ||\n+           kind == SourceRangeKind::kContinuation;\n+  }\n+\n+  void RemoveContinuationRange() override {\n+    DCHECK(HasRange(SourceRangeKind::kContinuation));\n+    has_continuation_ = false;\n+  }\n+\n  private:\n   SourceRange then_range_;\n   SourceRange else_range_;\n+  bool has_continuation_ = true;\n };\n \n class IterationStatementSourceRanges final : public AstNodeSourceRanges {\n@@ -164,18 +201,31 @@ class IterationStatementSourceRanges final : public AstNodeSourceRanges {\n       : body_range_(body_range) {}\n \n   SourceRange GetRange(SourceRangeKind kind) override {\n+    DCHECK(HasRange(kind));\n     switch (kind) {\n       case SourceRangeKind::kBody:\n         return body_range_;\n       case SourceRangeKind::kContinuation:\n+        if (!has_continuation_) return SourceRange::Empty();\n         return SourceRange::ContinuationOf(body_range_);\n       default:\n         UNREACHABLE();\n     }\n   }\n \n+  bool HasRange(SourceRangeKind kind) override {\n+    return kind == SourceRangeKind::kBody ||\n+           kind == SourceRangeKind::kContinuation;\n+  }\n+\n+  void RemoveContinuationRange() override {\n+    DCHECK(HasRange(SourceRangeKind::kContinuation));\n+    has_continuation_ = false;\n+  }\n+\n  private:\n   SourceRange body_range_;\n+  bool has_continuation_ = true;\n };\n \n class JumpStatementSourceRanges final : public ContinuationSourceRanges {\n@@ -200,6 +250,7 @@ class NaryOperationSourceRanges final : public AstNodeSourceRanges {\n   size_t RangeCount() const { return ranges_.size(); }\n \n   SourceRange GetRange(SourceRangeKind kind) override { UNREACHABLE(); }\n+  bool HasRange(SourceRangeKind kind) override { return false; }\n \n  private:\n   ZoneVector<SourceRange> ranges_;\n@@ -229,18 +280,31 @@ class TryCatchStatementSourceRanges final : public AstNodeSourceRanges {\n       : catch_range_(catch_range) {}\n \n   SourceRange GetRange(SourceRangeKind kind) override {\n+    DCHECK(HasRange(kind));\n     switch (kind) {\n       case SourceRangeKind::kCatch:\n         return catch_range_;\n       case SourceRangeKind::kContinuation:\n+        if (!has_continuation_) return SourceRange::Empty();\n         return SourceRange::ContinuationOf(catch_range_);\n       default:\n         UNREACHABLE();\n     }\n   }\n \n+  bool HasRange(SourceRangeKind kind) override {\n+    return kind == SourceRangeKind::kCatch ||\n+           kind == SourceRangeKind::kContinuation;\n+  }\n+\n+  void RemoveContinuationRange() override {\n+    DCHECK(HasRange(SourceRangeKind::kContinuation));\n+    has_continuation_ = false;\n+  }\n+\n  private:\n   SourceRange catch_range_;\n+  bool has_continuation_ = true;\n };\n \n class TryFinallyStatementSourceRanges final : public AstNodeSourceRanges {\n@@ -249,18 +313,31 @@ class TryFinallyStatementSourceRanges final : public AstNodeSourceRanges {\n       : finally_range_(finally_range) {}\n \n   SourceRange GetRange(SourceRangeKind kind) override {\n+    DCHECK(HasRange(kind));\n     switch (kind) {\n       case SourceRangeKind::kFinally:\n         return finally_range_;\n       case SourceRangeKind::kContinuation:\n+        if (!has_continuation_) return SourceRange::Empty();\n         return SourceRange::ContinuationOf(finally_range_);\n       default:\n         UNREACHABLE();\n     }\n   }\n \n+  bool HasRange(SourceRangeKind kind) override {\n+    return kind == SourceRangeKind::kFinally ||\n+           kind == SourceRangeKind::kContinuation;\n+  }\n+\n+  void RemoveContinuationRange() override {\n+    DCHECK(HasRange(SourceRangeKind::kContinuation));\n+    has_continuation_ = false;\n+  }\n+\n  private:\n   SourceRange finally_range_;\n+  bool has_continuation_ = true;\n };\n \n // Maps ast node pointers to associated source ranges. The parser creates these"
        },
        {
            "sha": "b6acbddf0a6a5a2f5bf2e333e5231b99f916c24c",
            "filename": "deps/v8/src/ast/source-range-ast-visitor.cc",
            "status": "added",
            "additions": 68,
            "deletions": 0,
            "changes": 68,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fast%2Fsource-range-ast-visitor.cc",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fast%2Fsource-range-ast-visitor.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fast%2Fsource-range-ast-visitor.cc?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -0,0 +1,68 @@\n+// Copyright 2018 the V8 project authors. All rights reserved.\n+// Use of this source code is governed by a BSD-style license that can be\n+// found in the LICENSE file.\n+\n+#include \"src/ast/source-range-ast-visitor.h\"\n+\n+#include \"src/ast/ast-source-ranges.h\"\n+\n+namespace v8 {\n+namespace internal {\n+\n+SourceRangeAstVisitor::SourceRangeAstVisitor(uintptr_t stack_limit,\n+                                             Expression* root,\n+                                             SourceRangeMap* source_range_map)\n+    : AstTraversalVisitor(stack_limit, root),\n+      source_range_map_(source_range_map) {}\n+\n+void SourceRangeAstVisitor::VisitBlock(Block* stmt) {\n+  AstTraversalVisitor::VisitBlock(stmt);\n+  ZonePtrList<Statement>* stmts = stmt->statements();\n+  AstNodeSourceRanges* enclosingSourceRanges = source_range_map_->Find(stmt);\n+  if (enclosingSourceRanges != nullptr) {\n+    CHECK(enclosingSourceRanges->HasRange(SourceRangeKind::kContinuation));\n+    MaybeRemoveLastContinuationRange(stmts);\n+  }\n+}\n+\n+void SourceRangeAstVisitor::VisitFunctionLiteral(FunctionLiteral* expr) {\n+  AstTraversalVisitor::VisitFunctionLiteral(expr);\n+  ZonePtrList<Statement>* stmts = expr->body();\n+  MaybeRemoveLastContinuationRange(stmts);\n+}\n+\n+bool SourceRangeAstVisitor::VisitNode(AstNode* node) {\n+  AstNodeSourceRanges* range = source_range_map_->Find(node);\n+\n+  if (range == nullptr) return true;\n+  if (!range->HasRange(SourceRangeKind::kContinuation)) return true;\n+\n+  // Called in pre-order. In case of conflicting continuation ranges, only the\n+  // outermost range may survive.\n+\n+  SourceRange continuation = range->GetRange(SourceRangeKind::kContinuation);\n+  if (continuation_positions_.find(continuation.start) !=\n+      continuation_positions_.end()) {\n+    range->RemoveContinuationRange();\n+  } else {\n+    continuation_positions_.emplace(continuation.start);\n+  }\n+\n+  return true;\n+}\n+\n+void SourceRangeAstVisitor::MaybeRemoveLastContinuationRange(\n+    ZonePtrList<Statement>* statements) {\n+  if (statements == nullptr || statements->is_empty()) return;\n+\n+  Statement* last_statement = statements->last();\n+  AstNodeSourceRanges* last_range = source_range_map_->Find(last_statement);\n+  if (last_range == nullptr) return;\n+\n+  if (last_range->HasRange(SourceRangeKind::kContinuation)) {\n+    last_range->RemoveContinuationRange();\n+  }\n+}\n+\n+}  // namespace internal\n+}  // namespace v8"
        },
        {
            "sha": "4ea36a947f58e6ac40586d3ad3c7b4f9e6a923a9",
            "filename": "deps/v8/src/ast/source-range-ast-visitor.h",
            "status": "added",
            "additions": 49,
            "deletions": 0,
            "changes": 49,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fast%2Fsource-range-ast-visitor.h",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fast%2Fsource-range-ast-visitor.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fast%2Fsource-range-ast-visitor.h?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -0,0 +1,49 @@\n+// Copyright 2018 the V8 project authors. All rights reserved.\n+// Use of this source code is governed by a BSD-style license that can be\n+// found in the LICENSE file.\n+\n+#ifndef V8_AST_SOURCE_RANGE_AST_VISITOR_H_\n+#define V8_AST_SOURCE_RANGE_AST_VISITOR_H_\n+\n+#include <unordered_set>\n+\n+#include \"src/ast/ast-traversal-visitor.h\"\n+\n+namespace v8 {\n+namespace internal {\n+\n+class SourceRangeMap;\n+\n+// Post-processes generated source ranges while the AST structure still exists.\n+//\n+// In particular, SourceRangeAstVisitor\n+//\n+// 1. deduplicates continuation source ranges, only keeping the outermost one.\n+// See also: https://crbug.com/v8/8539.\n+//\n+// 2. removes the source range associated with the final statement in a block\n+// or function body if the parent itself has a source range associated with it.\n+// See also: https://crbug.com/v8/8381.\n+class SourceRangeAstVisitor final\n+    : public AstTraversalVisitor<SourceRangeAstVisitor> {\n+ public:\n+  SourceRangeAstVisitor(uintptr_t stack_limit, Expression* root,\n+                        SourceRangeMap* source_range_map);\n+\n+ private:\n+  friend class AstTraversalVisitor<SourceRangeAstVisitor>;\n+\n+  void VisitBlock(Block* stmt);\n+  void VisitFunctionLiteral(FunctionLiteral* expr);\n+  bool VisitNode(AstNode* node);\n+\n+  void MaybeRemoveLastContinuationRange(ZonePtrList<Statement>* stmts);\n+\n+  SourceRangeMap* source_range_map_ = nullptr;\n+  std::unordered_set<int> continuation_positions_;\n+};\n+\n+}  // namespace internal\n+}  // namespace v8\n+\n+#endif  // V8_AST_SOURCE_RANGE_AST_VISITOR_H_"
        },
        {
            "sha": "9e0791babc2e3026a279c2a7837e948ca657ef46",
            "filename": "deps/v8/src/debug/debug-coverage.cc",
            "status": "modified",
            "additions": 38,
            "deletions": 26,
            "changes": 64,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fdebug%2Fdebug-coverage.cc",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fdebug%2Fdebug-coverage.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fdebug%2Fdebug-coverage.cc?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -81,11 +81,6 @@ std::vector<CoverageBlock> GetSortedBlockData(SharedFunctionInfo* shared) {\n   std::vector<CoverageBlock> result;\n   if (coverage_info->SlotCount() == 0) return result;\n \n-  if (FLAG_trace_block_coverage) {\n-    PrintF(\"Collecting coverage data\\n\");\n-    coverage_info->Print(shared->DebugName()->ToCString());\n-  }\n-\n   for (int i = 0; i < coverage_info->SlotCount(); i++) {\n     const int start_pos = coverage_info->StartSourcePosition(i);\n     const int until_pos = coverage_info->EndSourcePosition(i);\n@@ -176,6 +171,12 @@ class CoverageBlockIterator final {\n     return function_->blocks[read_index_ + 1];\n   }\n \n+  CoverageBlock& GetPreviousBlock() {\n+    DCHECK(IsActive());\n+    DCHECK_GT(read_index_, 0);\n+    return function_->blocks[read_index_ - 1];\n+  }\n+\n   CoverageBlock& GetParent() {\n     DCHECK(IsActive());\n     return nesting_stack_.back();\n@@ -232,25 +233,6 @@ bool HaveSameSourceRange(const CoverageBlock& lhs, const CoverageBlock& rhs) {\n   return lhs.start == rhs.start && lhs.end == rhs.end;\n }\n \n-void MergeDuplicateSingletons(CoverageFunction* function) {\n-  CoverageBlockIterator iter(function);\n-\n-  while (iter.Next() && iter.HasNext()) {\n-    CoverageBlock& block = iter.GetBlock();\n-    CoverageBlock& next_block = iter.GetNextBlock();\n-\n-    // Identical ranges should only occur through singleton ranges. Consider the\n-    // ranges for `for (.) break;`: continuation ranges for both the `break` and\n-    // `for` statements begin after the trailing semicolon.\n-    // Such ranges are merged and keep the maximal execution count.\n-    if (!HaveSameSourceRange(block, next_block)) continue;\n-\n-    DCHECK_EQ(kNoSourcePosition, block.end);  // Singleton range.\n-    next_block.count = std::max(block.count, next_block.count);\n-    iter.DeleteBlock();\n-  }\n-}\n-\n void MergeDuplicateRanges(CoverageFunction* function) {\n   CoverageBlockIterator iter(function);\n \n@@ -330,6 +312,30 @@ void MergeNestedRanges(CoverageFunction* function) {\n   }\n }\n \n+void FilterAliasedSingletons(CoverageFunction* function) {\n+  CoverageBlockIterator iter(function);\n+\n+  iter.Next();  // Advance once since we reference the previous block later.\n+\n+  while (iter.Next()) {\n+    CoverageBlock& previous_block = iter.GetPreviousBlock();\n+    CoverageBlock& block = iter.GetBlock();\n+\n+    bool is_singleton = block.end == kNoSourcePosition;\n+    bool aliases_start = block.start == previous_block.start;\n+\n+    if (is_singleton && aliases_start) {\n+      // The previous block must have a full range since duplicate singletons\n+      // have already been merged.\n+      DCHECK_NE(previous_block.end, kNoSourcePosition);\n+      // Likewise, the next block must have another start position since\n+      // singletons are sorted to the end.\n+      DCHECK_IMPLIES(iter.HasNext(), iter.GetNextBlock().start != block.start);\n+      iter.DeleteBlock();\n+    }\n+  }\n+}\n+\n void FilterUncoveredRanges(CoverageFunction* function) {\n   CoverageBlockIterator iter(function);\n \n@@ -399,8 +405,14 @@ void CollectBlockCoverage(CoverageFunction* function, SharedFunctionInfo* info,\n   // If in binary mode, only report counts of 0/1.\n   if (mode == debug::Coverage::kBlockBinary) ClampToBinary(function);\n \n-  // Remove duplicate singleton ranges, keeping the max count.\n-  MergeDuplicateSingletons(function);\n+  // Remove singleton ranges with the same start position as a full range and\n+  // throw away their counts.\n+  // Singleton ranges are only intended to split existing full ranges and should\n+  // never expand into a full range. Consider 'if (cond) { ... } else { ... }'\n+  // as a problematic example; if the then-block produces a continuation\n+  // singleton, it would incorrectly expand into the else range.\n+  // For more context, see https://crbug.com/v8/8237.\n+  FilterAliasedSingletons(function);\n \n   // Rewrite all singletons (created e.g. by continuations and unconditional\n   // control flow) to ranges."
        },
        {
            "sha": "48682439fb186295457f76134f986924487917c6",
            "filename": "deps/v8/src/interpreter/bytecode-generator.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Finterpreter%2Fbytecode-generator.cc",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Finterpreter%2Fbytecode-generator.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Finterpreter%2Fbytecode-generator.cc?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -368,7 +368,6 @@ class BytecodeGenerator::ControlScopeForBreakable final\n  protected:\n   bool Execute(Command command, Statement* statement,\n                int source_position) override {\n-    control_builder_->set_needs_continuation_counter();\n     if (statement != statement_) return false;\n     switch (command) {\n       case CMD_BREAK:"
        },
        {
            "sha": "6b1bdc34240d83381949affbabe0ecd619190621",
            "filename": "deps/v8/src/interpreter/control-flow-builders.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Finterpreter%2Fcontrol-flow-builders.cc",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Finterpreter%2Fcontrol-flow-builders.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Finterpreter%2Fcontrol-flow-builders.cc?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -13,7 +13,7 @@ namespace interpreter {\n BreakableControlFlowBuilder::~BreakableControlFlowBuilder() {\n   BindBreakTarget();\n   DCHECK(break_labels_.empty() || break_labels_.is_bound());\n-  if (block_coverage_builder_ != nullptr && needs_continuation_counter()) {\n+  if (block_coverage_builder_ != nullptr) {\n     block_coverage_builder_->IncrementBlockCounter(\n         node_, SourceRangeKind::kContinuation);\n   }"
        },
        {
            "sha": "8359f0d1ee303b3e67cbe4b5ed9397cf8125c050",
            "filename": "deps/v8/src/interpreter/control-flow-builders.h",
            "status": "modified",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Finterpreter%2Fcontrol-flow-builders.h",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Finterpreter%2Fcontrol-flow-builders.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Finterpreter%2Fcontrol-flow-builders.h?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -58,11 +58,6 @@ class V8_EXPORT_PRIVATE BreakableControlFlowBuilder\n \n   BytecodeLabels* break_labels() { return &break_labels_; }\n \n-  void set_needs_continuation_counter() { needs_continuation_counter_ = true; }\n-  bool needs_continuation_counter() const {\n-    return needs_continuation_counter_;\n-  }\n-\n  protected:\n   void EmitJump(BytecodeLabels* labels);\n   void EmitJumpIfTrue(BytecodeArrayBuilder::ToBooleanMode mode,\n@@ -81,7 +76,6 @@ class V8_EXPORT_PRIVATE BreakableControlFlowBuilder\n   // A continuation counter (for block coverage) is needed e.g. when\n   // encountering a break statement.\n   AstNode* node_;\n-  bool needs_continuation_counter_ = false;\n   BlockCoverageBuilder* block_coverage_builder_;\n };\n \n@@ -107,7 +101,6 @@ class V8_EXPORT_PRIVATE LoopBuilder final : public BreakableControlFlowBuilder {\n       : BreakableControlFlowBuilder(builder, block_coverage_builder, node),\n         continue_labels_(builder->zone()) {\n     if (block_coverage_builder_ != nullptr) {\n-      set_needs_continuation_counter();\n       block_coverage_body_slot_ =\n           block_coverage_builder_->AllocateBlockCoverageSlot(\n               node, SourceRangeKind::kBody);"
        },
        {
            "sha": "b77b6e136e53d5c83ee9529ef062d11b03d593ff",
            "filename": "deps/v8/src/objects/debug-objects.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fobjects%2Fdebug-objects.cc",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fobjects%2Fdebug-objects.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fobjects%2Fdebug-objects.cc?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -375,7 +375,7 @@ void CoverageInfo::Print(std::unique_ptr<char[]> function_name) {\n \n   for (int i = 0; i < SlotCount(); i++) {\n     os << \"{\" << StartSourcePosition(i) << \",\" << EndSourcePosition(i) << \"}\"\n-       << \": \" << BlockCount(i) << std::endl;\n+       << std::endl;\n   }\n }\n "
        },
        {
            "sha": "bfb056e0c8c797fe072fa13c3c0a30c59a2a4919",
            "filename": "deps/v8/src/parsing/parser-base.h",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fparsing%2Fparser-base.h",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fparsing%2Fparser-base.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fparsing%2Fparser-base.h?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -5116,7 +5116,6 @@ typename ParserBase<Impl>::BlockT ParserBase<Impl>::ParseBlock(\n   Expect(Token::LBRACE, CHECK_OK_CUSTOM(NullStatement));\n   {\n     BlockState block_state(zone(), &scope_);\n-    // Scope starts before opening brace.\n     scope()->set_start_position(scanner()->location().beg_pos);\n     typename Types::Target target(this, body);\n \n@@ -5128,10 +5127,9 @@ typename ParserBase<Impl>::BlockT ParserBase<Impl>::ParseBlock(\n     }\n \n     Expect(Token::RBRACE, CHECK_OK_CUSTOM(NullStatement));\n-    // Scope ends after closing brace.\n-    scope()->set_end_position(scanner()->location().end_pos);\n-    // Coverage range uses position before closing brace.\n-    impl()->RecordBlockSourceRange(body, scanner()->location().beg_pos);\n+    int end_pos = end_position();\n+    scope()->set_end_position(end_pos);\n+    impl()->RecordBlockSourceRange(body, end_pos);\n     body->set_scope(scope()->FinalizeBlockScope());\n   }\n   return body;"
        },
        {
            "sha": "5687633f2f0e8979c1772433415160183b1e8cb4",
            "filename": "deps/v8/src/parsing/parser.cc",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fparsing%2Fparser.cc",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Fsrc%2Fparsing%2Fparser.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fparsing%2Fparser.cc?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -10,6 +10,7 @@\n #include \"src/ast/ast-function-literal-id-reindexer.h\"\n #include \"src/ast/ast-traversal-visitor.h\"\n #include \"src/ast/ast.h\"\n+#include \"src/ast/source-range-ast-visitor.h\"\n #include \"src/bailout-reason.h\"\n #include \"src/base/platform/platform.h\"\n #include \"src/char-predicates-inl.h\"\n@@ -441,6 +442,15 @@ void MaybeResetCharacterStream(ParseInfo* info, FunctionLiteral* literal) {\n   }\n }\n \n+void MaybeProcessSourceRanges(ParseInfo* parse_info, Expression* root,\n+                              uintptr_t stack_limit_) {\n+  if (root != nullptr && parse_info->source_range_map() != nullptr) {\n+    SourceRangeAstVisitor visitor(stack_limit_, root,\n+                                  parse_info->source_range_map());\n+    visitor.Run();\n+  }\n+}\n+\n }  // namespace\n \n FunctionLiteral* Parser::ParseProgram(Isolate* isolate, ParseInfo* info) {\n@@ -464,6 +474,7 @@ FunctionLiteral* Parser::ParseProgram(Isolate* isolate, ParseInfo* info) {\n   scanner_.Initialize();\n   FunctionLiteral* result = DoParseProgram(isolate, info);\n   MaybeResetCharacterStream(info, result);\n+  MaybeProcessSourceRanges(info, result, stack_limit_);\n \n   HandleSourceURLComments(isolate, info->script());\n \n@@ -660,6 +671,7 @@ FunctionLiteral* Parser::ParseFunction(Isolate* isolate, ParseInfo* info,\n   FunctionLiteral* result =\n       DoParseFunction(isolate, info, info->function_name());\n   MaybeResetCharacterStream(info, result);\n+  MaybeProcessSourceRanges(info, result, stack_limit_);\n   if (result != nullptr) {\n     Handle<String> inferred_name(shared_info->inferred_name(), isolate);\n     result->set_inferred_name(inferred_name);"
        },
        {
            "sha": "cc48cfa85b320f405701c32d6a8b114e9c2d8d4f",
            "filename": "deps/v8/test/inspector/cpu-profiler/coverage-block-expected.txt",
            "status": "modified",
            "additions": 34,
            "deletions": 104,
            "changes": 138,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Ftest%2Finspector%2Fcpu-profiler%2Fcoverage-block-expected.txt",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Ftest%2Finspector%2Fcpu-profiler%2Fcoverage-block-expected.txt",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Finspector%2Fcpu-profiler%2Fcoverage-block-expected.txt?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -34,7 +34,7 @@ Running test: testPreciseCountCoverage\n             [0] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -60,13 +60,8 @@ Running test: testPreciseCountCoverage\n                             }\n                             [2] : {\n                                 count : 7\n-                                endOffset : 71\n-                                startOffset : 41\n-                            }\n-                            [3] : {\n-                                count : 0\n                                 endOffset : 72\n-                                startOffset : 71\n+                                startOffset : 41\n                             }\n                         ]\n                     }\n@@ -90,11 +85,6 @@ Running test: testPreciseCountCoverage\n                                 endOffset : 208\n                                 startOffset : 177\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 207\n-                                startOffset : 206\n-                            }\n                         ]\n                     }\n                 ]\n@@ -104,7 +94,7 @@ Running test: testPreciseCountCoverage\n             [1] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -116,7 +106,7 @@ Running test: testPreciseCountCoverage\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n         ]\n     }\n@@ -147,7 +137,7 @@ Running test: testPreciseCountCoverageIncremental\n             [0] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -173,13 +163,8 @@ Running test: testPreciseCountCoverageIncremental\n                             }\n                             [2] : {\n                                 count : 7\n-                                endOffset : 71\n-                                startOffset : 41\n-                            }\n-                            [3] : {\n-                                count : 0\n                                 endOffset : 72\n-                                startOffset : 71\n+                                startOffset : 41\n                             }\n                         ]\n                     }\n@@ -203,11 +188,6 @@ Running test: testPreciseCountCoverageIncremental\n                                 endOffset : 208\n                                 startOffset : 177\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 207\n-                                startOffset : 206\n-                            }\n                         ]\n                     }\n                 ]\n@@ -267,13 +247,8 @@ Running test: testPreciseCountCoverageIncremental\n                             }\n                             [2] : {\n                                 count : 10945\n-                                endOffset : 71\n-                                startOffset : 41\n-                            }\n-                            [3] : {\n-                                count : 0\n                                 endOffset : 72\n-                                startOffset : 71\n+                                startOffset : 41\n                             }\n                         ]\n                     }\n@@ -291,11 +266,6 @@ Running test: testPreciseCountCoverageIncremental\n                                 endOffset : 156\n                                 startOffset : 143\n                             }\n-                            [2] : {\n-                                count : 0\n-                                endOffset : 174\n-                                startOffset : 173\n-                            }\n                         ]\n                     }\n                 ]\n@@ -305,7 +275,7 @@ Running test: testPreciseCountCoverageIncremental\n             [1] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -317,12 +287,12 @@ Running test: testPreciseCountCoverageIncremental\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n             [2] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -334,7 +304,7 @@ Running test: testPreciseCountCoverageIncremental\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n         ]\n     }\n@@ -403,7 +373,7 @@ Running test: testBestEffortCoverageWithPreciseBinaryEnabled\n             [0] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : false\n                         ranges : [\n                             [0] : {\n@@ -453,7 +423,7 @@ Running test: testBestEffortCoverageWithPreciseBinaryEnabled\n             [1] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : false\n                         ranges : [\n                             [0] : {\n@@ -465,7 +435,7 @@ Running test: testBestEffortCoverageWithPreciseBinaryEnabled\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n         ]\n     }\n@@ -477,7 +447,7 @@ Running test: testBestEffortCoverageWithPreciseBinaryEnabled\n             [0] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : false\n                         ranges : [\n                             [0] : {\n@@ -527,7 +497,7 @@ Running test: testBestEffortCoverageWithPreciseBinaryEnabled\n             [1] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : false\n                         ranges : [\n                             [0] : {\n@@ -539,7 +509,7 @@ Running test: testBestEffortCoverageWithPreciseBinaryEnabled\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n         ]\n     }\n@@ -563,7 +533,7 @@ Running test: testBestEffortCoverageWithPreciseCountEnabled\n             [0] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : false\n                         ranges : [\n                             [0] : {\n@@ -613,7 +583,7 @@ Running test: testBestEffortCoverageWithPreciseCountEnabled\n             [1] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : false\n                         ranges : [\n                             [0] : {\n@@ -625,7 +595,7 @@ Running test: testBestEffortCoverageWithPreciseCountEnabled\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n         ]\n     }\n@@ -637,7 +607,7 @@ Running test: testBestEffortCoverageWithPreciseCountEnabled\n             [0] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : false\n                         ranges : [\n                             [0] : {\n@@ -687,7 +657,7 @@ Running test: testBestEffortCoverageWithPreciseCountEnabled\n             [1] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : false\n                         ranges : [\n                             [0] : {\n@@ -699,7 +669,7 @@ Running test: testBestEffortCoverageWithPreciseCountEnabled\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n         ]\n     }\n@@ -721,7 +691,7 @@ Running test: testEnablePreciseCountCoverageAtPause\n             [0] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -733,7 +703,7 @@ Running test: testEnablePreciseCountCoverageAtPause\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n         ]\n     }\n@@ -757,7 +727,7 @@ Running test: testPreciseBinaryCoverage\n             [0] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -776,11 +746,6 @@ Running test: testPreciseBinaryCoverage\n                                 endOffset : 73\n                                 startOffset : 1\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 72\n-                                startOffset : 71\n-                            }\n                         ]\n                     }\n                     [2] : {\n@@ -803,11 +768,6 @@ Running test: testPreciseBinaryCoverage\n                                 endOffset : 208\n                                 startOffset : 177\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 207\n-                                startOffset : 206\n-                            }\n                         ]\n                     }\n                 ]\n@@ -862,7 +822,7 @@ Running test: testPreciseBinaryCoverage\n                             }\n                             [1] : {\n                                 count : 1\n-                                endOffset : 71\n+                                endOffset : 72\n                                 startOffset : 32\n                             }\n                         ]\n@@ -876,11 +836,6 @@ Running test: testPreciseBinaryCoverage\n                                 endOffset : 175\n                                 startOffset : 74\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 174\n-                                startOffset : 173\n-                            }\n                         ]\n                     }\n                 ]\n@@ -890,7 +845,7 @@ Running test: testPreciseBinaryCoverage\n             [1] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -902,12 +857,12 @@ Running test: testPreciseBinaryCoverage\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n             [2] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -919,7 +874,7 @@ Running test: testPreciseBinaryCoverage\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n         ]\n     }\n@@ -950,7 +905,7 @@ Running test: testPreciseCountCoveragePartial\n             [0] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -969,11 +924,6 @@ Running test: testPreciseCountCoveragePartial\n                                 endOffset : 224\n                                 startOffset : 10\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 223\n-                                startOffset : 222\n-                            }\n                         ]\n                     }\n                     [2] : {\n@@ -985,11 +935,6 @@ Running test: testPreciseCountCoveragePartial\n                                 endOffset : 176\n                                 startOffset : 31\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 175\n-                                startOffset : 172\n-                            }\n                         ]\n                     }\n                     [3] : {\n@@ -1001,11 +946,6 @@ Running test: testPreciseCountCoveragePartial\n                                 endOffset : 172\n                                 startOffset : 64\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 171\n-                                startOffset : 166\n-                            }\n                         ]\n                     }\n                     [4] : {\n@@ -1017,11 +957,6 @@ Running test: testPreciseCountCoveragePartial\n                                 endOffset : 166\n                                 startOffset : 99\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 165\n-                                startOffset : 158\n-                            }\n                         ]\n                     }\n                     [5] : {\n@@ -1068,11 +1003,6 @@ Running test: testPreciseCountCoveragePartial\n                                 endOffset : 172\n                                 startOffset : 64\n                             }\n-                            [1] : {\n-                                count : 0\n-                                endOffset : 171\n-                                startOffset : 166\n-                            }\n                         ]\n                     }\n                     [1] : {\n@@ -1093,7 +1023,7 @@ Running test: testPreciseCountCoveragePartial\n             [1] : {\n                 functions : [\n                     [0] : {\n-                        functionName : \n+                        functionName :\n                         isBlockCoverage : true\n                         ranges : [\n                             [0] : {\n@@ -1105,7 +1035,7 @@ Running test: testPreciseCountCoveragePartial\n                     }\n                 ]\n                 scriptId : <scriptId>\n-                url : \n+                url :\n             }\n         ]\n     }"
        },
        {
            "sha": "5477a18dd5eac137aed7d5279571d5d24d1160b2",
            "filename": "deps/v8/test/mjsunit/code-coverage-block-opt.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Ftest%2Fmjsunit%2Fcode-coverage-block-opt.js",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Ftest%2Fmjsunit%2Fcode-coverage-block-opt.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fmjsunit%2Fcode-coverage-block-opt.js?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -17,7 +17,7 @@ f(); f(); f(); f(); f(); f();             // 0150\n `,\n [{\"start\":0,\"end\":199,\"count\":1},\n  {\"start\":0,\"end\":33,\"count\":4},   // TODO(jgruber): Invocation count is off.\n- {\"start\":25,\"end\":32,\"count\":16},\n+ {\"start\":25,\"end\":31,\"count\":16},\n  {\"start\":50,\"end\":76,\"count\":2}]  // TODO(jgruber): Invocation count is off.\n );\n \n@@ -39,7 +39,7 @@ TestCoverage(\"Partial coverage collection\",\n }();                                      // 0400\n `,\n [{\"start\":52,\"end\":153,\"count\":0},\n- {\"start\":121,\"end\":152,\"count\":1}]\n+ {\"start\":121,\"end\":137,\"count\":1}]\n );\n \n %DebugToggleBlockCoverage(false);"
        },
        {
            "sha": "1291a50d978ceb46d90bb98481926ad451a379b9",
            "filename": "deps/v8/test/mjsunit/code-coverage-block.js",
            "status": "modified",
            "additions": 174,
            "deletions": 20,
            "changes": 194,
            "blob_url": "https://github.com/nodejs/node/blob/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Ftest%2Fmjsunit%2Fcode-coverage-block.js",
            "raw_url": "https://github.com/nodejs/node/raw/b7bbd871afb7e0bc02b92ebdbd785371439e5295/deps%2Fv8%2Ftest%2Fmjsunit%2Fcode-coverage-block.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fmjsunit%2Fcode-coverage-block.js?ref=b7bbd871afb7e0bc02b92ebdbd785371439e5295",
            "patch": "@@ -246,8 +246,7 @@ function g() {}                           // 0000\n  {\"start\":224,\"end\":237,\"count\":12},\n  {\"start\":273,\"end\":277,\"count\":0},\n  {\"start\":412,\"end\":416,\"count\":12},\n- {\"start\":462,\"end\":475,\"count\":12},\n- {\"start\":620,\"end\":622,\"count\":0}]\n+ {\"start\":462,\"end\":475,\"count\":12}]\n );\n \n TestCoverage(\n@@ -357,7 +356,7 @@ TestCoverage(\n  {\"start\":219,\"end\":222,\"count\":0},\n  {\"start\":254,\"end\":274,\"count\":0},\n  {\"start\":369,\"end\":372,\"count\":0},\n- {\"start\":390,\"end\":404,\"count\":0},\n+ {\"start\":403,\"end\":404,\"count\":0},\n  {\"start\":513,\"end\":554,\"count\":0}]\n );\n \n@@ -376,10 +375,10 @@ TestCoverage(\"try/catch/finally statements with early return\",\n [{\"start\":0,\"end\":449,\"count\":1},\n  {\"start\":1,\"end\":151,\"count\":1},\n  {\"start\":67,\"end\":70,\"count\":0},\n- {\"start\":89,\"end\":150,\"count\":0},\n+ {\"start\":91,\"end\":150,\"count\":0},\n  {\"start\":201,\"end\":401,\"count\":1},\n  {\"start\":267,\"end\":270,\"count\":0},\n- {\"start\":319,\"end\":400,\"count\":0}]\n+ {\"start\":321,\"end\":400,\"count\":0}]\n );\n \n TestCoverage(\n@@ -411,11 +410,11 @@ TestCoverage(\n [{\"start\":0,\"end\":1099,\"count\":1},\n  {\"start\":1,\"end\":151,\"count\":1},\n  {\"start\":67,\"end\":70,\"count\":0},\n- {\"start\":89,\"end\":150,\"count\":0},\n+ {\"start\":91,\"end\":150,\"count\":0},\n  {\"start\":201,\"end\":351,\"count\":1},\n- {\"start\":284,\"end\":350,\"count\":0},\n+ {\"start\":286,\"end\":350,\"count\":0},\n  {\"start\":401,\"end\":701,\"count\":1},\n- {\"start\":569,\"end\":700,\"count\":0},\n+ {\"start\":603,\"end\":700,\"count\":0},\n  {\"start\":561,\"end\":568,\"count\":0},  // TODO(jgruber): Sorting.\n  {\"start\":751,\"end\":1051,\"count\":1},\n  {\"start\":817,\"end\":820,\"count\":0},\n@@ -437,7 +436,7 @@ TestCoverage(\n [{\"start\":0,\"end\":399,\"count\":1},\n  {\"start\":1,\"end\":351,\"count\":1},\n  {\"start\":154,\"end\":204,\"count\":0},\n- {\"start\":226,\"end\":303,\"count\":0}]\n+ {\"start\":226,\"end\":350,\"count\":0}]\n );\n \n TestCoverage(\n@@ -467,11 +466,7 @@ TestCoverage(\n [{\"start\":0,\"end\":999,\"count\":1},\n  {\"start\":1,\"end\":951,\"count\":1},\n  {\"start\":152,\"end\":202,\"count\":0},\n- {\"start\":285,\"end\":353,\"count\":0},\n- {\"start\":472,\"end\":503,\"count\":0},\n- {\"start\":626,\"end\":653,\"count\":0},\n- {\"start\":768,\"end\":803,\"count\":0},\n- {\"start\":867,\"end\":868,\"count\":0}]\n+ {\"start\":285,\"end\":353,\"count\":0}]\n );\n \n TestCoverage(\n@@ -496,11 +491,8 @@ TestCoverage(\n [{\"start\":0,\"end\":749,\"count\":1},\n  {\"start\":1,\"end\":701,\"count\":1},\n  {\"start\":87,\"end\":153,\"count\":2},\n- {\"start\":125,\"end\":153,\"count\":0},\n  {\"start\":271,\"end\":403,\"count\":2},\n- {\"start\":379,\"end\":403,\"count\":0},\n- {\"start\":509,\"end\":653,\"count\":2},\n- {\"start\":621,\"end\":653,\"count\":0}]\n+ {\"start\":509,\"end\":653,\"count\":2}]\n );\n \n TestCoverage(\n@@ -570,6 +562,7 @@ try {                                     // 0200\n } catch (e) {}                            // 0450\n `,\n [{\"start\":0,\"end\":499,\"count\":1},\n+ {\"start\":451,\"end\":452,\"count\":0},\n  {\"start\":12,\"end\":101,\"count\":3},\n  {\"start\":60,\"end\":100,\"count\":0},\n  {\"start\":264,\"end\":353,\"count\":3},\n@@ -648,6 +641,7 @@ try {                                     // 0200\n } catch (e) {}                            // 0450\n `,\n [{\"start\":0,\"end\":499,\"count\":1},\n+ {\"start\":451,\"end\":452,\"count\":0},\n  {\"start\":12,\"end\":101,\"count\":3},\n  {\"start\":65,\"end\":100,\"count\":0},\n  {\"start\":264,\"end\":353,\"count\":3},\n@@ -846,8 +840,168 @@ Util.escape(\"foo.bar\");                   // 0400\n `,\n [{\"start\":0,\"end\":449,\"count\":1},\n  {\"start\":64,\"end\":351,\"count\":1},\n- {\"start\":112,\"end\":203,\"count\":0},\n- {\"start\":268,\"end\":350,\"count\":0}]\n+ {\"start\":112,\"end\":203,\"count\":0}]\n+);\n+\n+TestCoverage(\n+\"https://crbug.com/v8/8237\",\n+`\n+!function() {                             // 0000\n+  if (true)                               // 0050\n+    while (false) return; else nop();     // 0100\n+}();                                      // 0150\n+!function() {                             // 0200\n+  if (true) l0: { break l0; } else        // 0250\n+    if (nop()) { }                        // 0300\n+}();                                      // 0350\n+!function() {                             // 0400\n+  if (true) { if (false) { return; }      // 0450\n+  } else if (nop()) { } }();              // 0500\n+!function(){                              // 0550\n+  if(true)while(false)return;else nop()   // 0600\n+}();                                      // 0650\n+!function(){                              // 0700\n+  if(true) l0:{break l0}else if (nop()){} // 0750\n+}();                                      // 0800\n+!function(){                              // 0850\n+  if(true){if(false){return}}else         // 0900\n+    if(nop()){}                           // 0950\n+}();                                      // 1000\n+`,\n+[{\"start\":0,\"end\":1049,\"count\":1},\n+ {\"start\":1,\"end\":151,\"count\":1},\n+ {\"start\":118,\"end\":137,\"count\":0},\n+ {\"start\":201,\"end\":351,\"count\":1},\n+ {\"start\":279,\"end\":318,\"count\":0},\n+ {\"start\":401,\"end\":525,\"count\":1},\n+ {\"start\":475,\"end\":486,\"count\":0},\n+ {\"start\":503,\"end\":523,\"count\":0},\n+ {\"start\":551,\"end\":651,\"count\":1},\n+ {\"start\":622,\"end\":639,\"count\":0},\n+ {\"start\":701,\"end\":801,\"count\":1},\n+ {\"start\":774,\"end\":791,\"count\":0},\n+ {\"start\":851,\"end\":1001,\"count\":1},\n+ {\"start\":920,\"end\":928,\"count\":0},\n+ {\"start\":929,\"end\":965,\"count\":0}]\n+);\n+\n+TestCoverage(\n+\"terminal break statement\",\n+`\n+while (true) {                            // 0000\n+  const b = false                         // 0050\n+  break                                   // 0100\n+}                                         // 0150\n+let stop = false                          // 0200\n+while (true) {                            // 0250\n+  if (stop) {                             // 0300\n+    break                                 // 0350\n+  }                                       // 0400\n+  stop = true                             // 0450\n+}                                         // 0500\n+`,\n+[{\"start\":0,\"end\":549,\"count\":1},\n+ {\"start\":263,\"end\":501,\"count\":2},\n+ {\"start\":312,\"end\":501,\"count\":1}]\n+);\n+\n+TestCoverage(\n+\"terminal return statement\",\n+`\n+function a () {                           // 0000\n+  const b = false                         // 0050\n+  return 1                                // 0100\n+}                                         // 0150\n+const b = (early) => {                    // 0200\n+  if (early) {                            // 0250\n+    return 2                              // 0300\n+  }                                       // 0350\n+  return 3                                // 0400\n+}                                         // 0450\n+const c = () => {                         // 0500\n+  if (true) {                             // 0550\n+    return                                // 0600\n+  }                                       // 0650\n+}                                         // 0700\n+a(); b(false); b(true); c()               // 0750\n+`,\n+[{\"start\":0,\"end\":799,\"count\":1},\n+ {\"start\":0,\"end\":151,\"count\":1},\n+ {\"start\":210,\"end\":451,\"count\":2},\n+ {\"start\":263,\"end\":450,\"count\":1},\n+ {\"start\":510,\"end\":701,\"count\":1}]\n+);\n+\n+TestCoverage(\n+\"terminal blocks\",\n+`\n+function a () {                           // 0000\n+  {                                       // 0050\n+    return 'a'                            // 0100\n+  }                                       // 0150\n+}                                         // 0200\n+function b () {                           // 0250\n+  {                                       // 0300\n+    {                                     // 0350\n+      return 'b'                          // 0400\n+    }                                     // 0450\n+  }                                       // 0500\n+}                                         // 0550\n+a(); b()                                  // 0600\n+`,\n+[{\"start\":0,\"end\":649,\"count\":1},\n+ {\"start\":0,\"end\":201,\"count\":1},\n+ {\"start\":250,\"end\":551,\"count\":1}]\n+);\n+\n+TestCoverage(\n+\"terminal if statements\",\n+`\n+function a (branch) {                     // 0000\n+  if (branch) {                           // 0050\n+    return 'a'                            // 0100\n+  } else {                                // 0150\n+    return 'b'                            // 0200\n+  }                                       // 0250\n+}                                         // 0300\n+function b (branch) {                     // 0350\n+  if (branch) {                           // 0400\n+    if (branch) {                         // 0450\n+      return 'c'                          // 0500\n+    }                                     // 0550\n+  }                                       // 0600\n+}                                         // 0650\n+function c (branch) {                     // 0700\n+  if (branch) {                           // 0750\n+    return 'c'                            // 0800\n+  } else {                                // 0850\n+    return 'd'                            // 0900\n+  }                                       // 0950\n+}                                         // 1000\n+function d (branch) {                     // 1050\n+  if (branch) {                           // 1100\n+    if (!branch) {                        // 1150\n+      return 'e'                          // 1200\n+    } else {                              // 1250\n+      return 'f'                          // 1300\n+    }                                     // 1350\n+  } else {                                // 1400\n+    // noop                               // 1450\n+  }                                       // 1500\n+}                                         // 1550\n+a(true); a(false); b(true); b(false)      // 1600\n+c(true); d(true);                         // 1650\n+`,\n+[{\"start\":0,\"end\":1699,\"count\":1},\n+ {\"start\":0,\"end\":301,\"count\":2},\n+ {\"start\":64,\"end\":253,\"count\":1},\n+ {\"start\":350,\"end\":651,\"count\":2},\n+ {\"start\":414,\"end\":603,\"count\":1},\n+ {\"start\":700,\"end\":1001,\"count\":1},\n+ {\"start\":853,\"end\":953,\"count\":0},\n+ {\"start\":1050,\"end\":1551,\"count\":1},\n+ {\"start\":1167,\"end\":1255,\"count\":0},\n+ {\"start\":1403,\"end\":1503,\"count\":0}]\n );\n \n %DebugToggleBlockCoverage(false);"
        },
        {
            "sha": "c3abd17e8a9646abfcbc85da9a1bade94b4599a3",
            "filename": "deps/v8/test/mjsunit/regress/regress-8237.js",
            "status": "removed",
            "additions": 0,
            "deletions": 57,
            "changes": 57,
            "blob_url": "https://github.com/nodejs/node/blob/8528c21188d748c0caebd22bd4673bad53476866/deps%2Fv8%2Ftest%2Fmjsunit%2Fregress%2Fregress-8237.js",
            "raw_url": "https://github.com/nodejs/node/raw/8528c21188d748c0caebd22bd4673bad53476866/deps%2Fv8%2Ftest%2Fmjsunit%2Fregress%2Fregress-8237.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fmjsunit%2Fregress%2Fregress-8237.js?ref=8528c21188d748c0caebd22bd4673bad53476866",
            "patch": "@@ -1,57 +0,0 @@\n-// Copyright 2018 the V8 project authors. All rights reserved.\n-// Use of this source code is governed by a BSD-style license that can be\n-// found in the LICENSE file.\n-\n-// Flags: --allow-natives-syntax --no-always-opt\n-// Files: test/mjsunit/code-coverage-utils.js\n-\n-%DebugToggleBlockCoverage(true);\n-\n-TestCoverage(\n-\"Repro for the bug\",\n-`\n-function lib (n) {                        // 0000\n-  if (n >= 0) {                           // 0050\n-    if (n < 0) {                          // 0100\n-      return;                             // 0150\n-    }                                     // 0200\n-  } else if (foo()) {                     // 0250\n-  }                                       // 0300\n-}                                         // 0350\n-function foo () {                         // 0400\n-  console.log('foo')                      // 0450\n-  return false                            // 0500\n-}                                         // 0550\n-lib(1)                                    // 0600\n-`,\n-[{\"start\":0,\"end\":649,\"count\":1},\n-{\"start\":0,\"end\":351,\"count\":1},\n-{\"start\":115,\"end\":205,\"count\":0},\n-{\"start\":253,\"end\":303,\"count\":0},\n-{\"start\":400,\"end\":551,\"count\":0}]\n-);\n-\n-TestCoverage(\n-\"Variant with omitted brackets\",\n-`\n-function lib (n) {                        // 0000\n-  if (n >= 0) {                           // 0050\n-    if (n < 0)                            // 0100\n-      return;                             // 0150\n-  }                                       // 0200\n-  else if (foo());                        // 0250\n-}                                         // 0300\n-function foo () {                         // 0350\n-  console.log('foo')                      // 0400\n-  return false                            // 0450\n-}                                         // 0500\n-lib(1)                                    // 0550\n-`,\n-[{\"start\":0,\"end\":599,\"count\":1},\n-{\"start\":0,\"end\":301,\"count\":1},\n-{\"start\":156,\"end\":163,\"count\":0},\n-{\"start\":203,\"end\":268,\"count\":0},\n-{\"start\":350,\"end\":501,\"count\":0}]\n-);\n-\n-%DebugToggleBlockCoverage(false);"
        }
    ],
    "stats": {
        "total": 695,
        "additions": 467,
        "deletions": 228
    }
}