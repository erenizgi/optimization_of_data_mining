{
    "author": "yanivfriedensohn",
    "message": "test: add test for internalConnect() when address type is IPv6\n\nPR-URL: https://github.com/nodejs/node/pull/22444\nReviewed-By: Refael Ackermann <refack@gmail.com>",
    "sha": "e03f9c55f20fbcf89252b9d5ac024c191c072aae",
    "files": [
        {
            "sha": "18f102c5c3a63772b843bb83741ab78e83839557",
            "filename": "test/common/index.js",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/e03f9c55f20fbcf89252b9d5ac024c191c072aae/test%2Fcommon%2Findex.js",
            "raw_url": "https://github.com/nodejs/node/raw/e03f9c55f20fbcf89252b9d5ac024c191c072aae/test%2Fcommon%2Findex.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcommon%2Findex.js?ref=e03f9c55f20fbcf89252b9d5ac024c191c072aae",
            "patch": "@@ -180,6 +180,10 @@ Object.defineProperty(exports, 'localhostIPv4', {\n   }\n });\n \n+Object.defineProperty(exports, 'localhostIPv6', {\n+  get: () => '::1'\n+});\n+\n // opensslCli defined lazily to reduce overhead of spawnSync\n Object.defineProperty(exports, 'opensslCli', { get: function() {\n   if (opensslCli !== null) return opensslCli;"
        },
        {
            "sha": "6f5139aefb226d08163d4298ed68346e70460fe6",
            "filename": "test/sequential/test-net-connect-local-error.js",
            "status": "modified",
            "additions": 25,
            "deletions": 6,
            "changes": 31,
            "blob_url": "https://github.com/nodejs/node/blob/e03f9c55f20fbcf89252b9d5ac024c191c072aae/test%2Fsequential%2Ftest-net-connect-local-error.js",
            "raw_url": "https://github.com/nodejs/node/raw/e03f9c55f20fbcf89252b9d5ac024c191c072aae/test%2Fsequential%2Ftest-net-connect-local-error.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-net-connect-local-error.js?ref=e03f9c55f20fbcf89252b9d5ac024c191c072aae",
            "patch": "@@ -6,20 +6,39 @@ const net = require('net');\n // EADDRINUSE is expected to occur on FreeBSD\n // Ref: https://github.com/nodejs/node/issues/13055\n const expectedErrorCodes = ['ECONNREFUSED', 'EADDRINUSE'];\n-const client = net.connect({\n+\n+const optionsIPv4 = {\n   port: common.PORT,\n   localPort: common.PORT + 1,\n   localAddress: common.localhostIPv4\n-});\n+};\n+\n+const optionsIPv6 = {\n+  host: common.localhostIPv6,\n+  port: common.PORT + 2,\n+  localPort: common.PORT + 3,\n+  localAddress: common.localhostIPv6\n+};\n \n-client.on('error', common.mustCall(function onError(err) {\n+function onError(err, options) {\n   assert.ok(expectedErrorCodes.includes(err.code));\n   assert.strictEqual(err.syscall, 'connect');\n-  assert.strictEqual(err.localPort, common.PORT + 1);\n-  assert.strictEqual(err.localAddress, common.localhostIPv4);\n+  assert.strictEqual(err.localPort, options.localPort);\n+  assert.strictEqual(err.localAddress, options.localAddress);\n   assert.strictEqual(\n     err.message,\n     `connect ${err.code} ${err.address}:${err.port} ` +\n     `- Local (${err.localAddress}:${err.localPort})`\n   );\n-}));\n+}\n+\n+const clientIPv4 = net.connect(optionsIPv4);\n+clientIPv4.on('error', common.mustCall((err) => onError(err, optionsIPv4)));\n+\n+if (!common.hasIPv6) {\n+  common.printSkipMessage('ipv6 part of test, no IPv6 support');\n+  return;\n+}\n+\n+const clientIPv6 = net.connect(optionsIPv6);\n+clientIPv6.on('error', common.mustCall((err) => onError(err, optionsIPv6)));"
        }
    ],
    "stats": {
        "total": 35,
        "additions": 29,
        "deletions": 6
    }
}