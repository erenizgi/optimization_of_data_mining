{
    "author": "BridgeAR",
    "message": "errors: validate input arguments\n\nThis makes sure the input arguments get validated so implementation\nerrors will be caught early. It also improves a couple of error\nmessages by providing more detailed information and fixes errors\ndetected by the new functionality. Besides that a error type got\nsimplified and tests got refactored.\n\nPR-URL: https://github.com/nodejs/node/pull/19924\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "dca7fb2225ea5bd8452c51d4167962f2838389f8",
    "files": [
        {
            "sha": "061ff7ebe440dad2c50e4947b66eda0eab1f8292",
            "filename": "lib/buffer.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Fbuffer.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Fbuffer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fbuffer.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -920,7 +920,7 @@ Buffer.prototype.write = function write(string, offset, length, encoding) {\n       length = remaining;\n \n     if (string.length > 0 && (length < 0 || offset < 0))\n-      throw new ERR_BUFFER_OUT_OF_BOUNDS('length', true);\n+      throw new ERR_BUFFER_OUT_OF_BOUNDS();\n   } else {\n     // if someone is still calling the obsolete form of write(), tell them.\n     // we don't want eg buf.write(\"foo\", \"utf8\", 10) to silently turn into"
        },
        {
            "sha": "6b80af3b63443e74b127a1f6b2cc678f8b50f97a",
            "filename": "lib/fs.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -1019,7 +1019,7 @@ fs.fchmod = function(fd, mode, callback) {\n   validateUint32(mode, 'mode');\n   // Values for mode < 0 are already checked via the validateUint32 function\n   if (mode > 0o777)\n-    throw new ERR_OUT_OF_RANGE('mode');\n+    throw new ERR_OUT_OF_RANGE('mode', undefined, mode);\n \n   const req = new FSReqWrap();\n   req.oncomplete = makeCallback(callback);\n@@ -1032,7 +1032,7 @@ fs.fchmodSync = function(fd, mode) {\n   validateUint32(mode, 'mode');\n   // Values for mode < 0 are already checked via the validateUint32 function\n   if (mode > 0o777)\n-    throw new ERR_OUT_OF_RANGE('mode');\n+    throw new ERR_OUT_OF_RANGE('mode', undefined, mode);\n   const ctx = {};\n   binding.fchmod(fd, mode, undefined, ctx);\n   handleErrorFromBinding(ctx);"
        },
        {
            "sha": "a1d805803ae78962b90e4b17e84bfa8ecfb7bb5f",
            "filename": "lib/fs/promises.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Ffs%2Fpromises.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Ffs%2Fpromises.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs%2Fpromises.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -373,7 +373,7 @@ async function fchmod(handle, mode) {\n   validateFileHandle(handle);\n   validateUint32(mode, 'mode');\n   if (mode > 0o777)\n-    throw new ERR_OUT_OF_RANGE('mode');\n+    throw new ERR_OUT_OF_RANGE('mode', undefined, mode);\n   return binding.fchmod(handle.fd, mode, kUsePromises);\n }\n "
        },
        {
            "sha": "085a82265a95dec91b680c9f3a6c3e264f51e812",
            "filename": "lib/internal/buffer.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Fbuffer.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Fbuffer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbuffer.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -50,7 +50,7 @@ function boundsError(value, length, type) {\n   }\n \n   if (length < 0)\n-    throw new ERR_BUFFER_OUT_OF_BOUNDS(null, true);\n+    throw new ERR_BUFFER_OUT_OF_BOUNDS();\n \n   throw new ERR_OUT_OF_RANGE(type || 'offset',\n                              `>= ${type ? 1 : 0} and <= ${length}`,"
        },
        {
            "sha": "4a7f26b509b521c7fed0e96c1c3f564dda6d574d",
            "filename": "lib/internal/crypto/pbkdf2.js",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Fcrypto%2Fpbkdf2.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Fcrypto%2Fpbkdf2.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fcrypto%2Fpbkdf2.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -64,11 +64,8 @@ function _pbkdf2(password, salt, iterations, keylen, digest, callback) {\n   if (typeof keylen !== 'number')\n     throw new ERR_INVALID_ARG_TYPE('keylen', 'number', keylen);\n \n-  if (keylen < 0 ||\n-      !Number.isFinite(keylen) ||\n-      keylen > INT_MAX) {\n-    throw new ERR_OUT_OF_RANGE('keylen');\n-  }\n+  if (keylen < 0 || !Number.isInteger(keylen) || keylen > INT_MAX)\n+    throw new ERR_OUT_OF_RANGE('keylen', `>= 0 && <= ${INT_MAX}`, keylen);\n \n   const encoding = getDefaultEncoding();\n "
        },
        {
            "sha": "f09bf973efc02a6568ad236ac20d412781d68776",
            "filename": "lib/internal/errors.js",
            "status": "modified",
            "additions": 37,
            "deletions": 24,
            "changes": 61,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Ferrors.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Ferrors.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ferrors.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -416,20 +416,30 @@ function internalAssert(condition, message) {\n   }\n }\n \n-function message(key, args) {\n+function message(key, args = []) {\n   const msg = messages.get(key);\n-  internalAssert(msg, `An invalid error message key was used: ${key}.`);\n-  let fmt;\n   if (util === undefined) util = require('util');\n+\n   if (typeof msg === 'function') {\n-    fmt = msg;\n-  } else {\n-    fmt = util.format;\n-    if (args === undefined || args.length === 0)\n-      return msg;\n-    args.unshift(msg);\n+    internalAssert(\n+      msg.length <= args.length, // Default options do not count.\n+      `Code: ${key}; The provided arguments length (${args.length}) does not ` +\n+        `match the required ones (${msg.length}).`\n+    );\n+    return msg.apply(null, args);\n   }\n-  return String(fmt.apply(null, args));\n+\n+  const expectedLength = (msg.match(/%[dfijoOs]/g) || []).length;\n+  internalAssert(\n+    expectedLength === args.length,\n+    `Code: ${key}; The provided arguments length (${args.length}) does not ` +\n+      `match the required ones (${expectedLength}).`\n+  );\n+  if (args.length === 0)\n+    return msg;\n+\n+  args.unshift(msg);\n+  return util.format.apply(null, args);\n }\n \n /**\n@@ -740,7 +750,7 @@ E('ERR_HTTP2_INVALID_SETTING_VALUE',\n   'Invalid value for setting \"%s\": %s', TypeError, RangeError);\n E('ERR_HTTP2_INVALID_STREAM', 'The stream has been destroyed', Error);\n E('ERR_HTTP2_MAX_PENDING_SETTINGS_ACK',\n-  'Maximum number of pending settings acknowledgements (%s)', Error);\n+  'Maximum number of pending settings acknowledgements', Error);\n E('ERR_HTTP2_NO_SOCKET_MANIPULATION',\n   'HTTP/2 sockets should not be directly manipulated (e.g. read and written)',\n   Error);\n@@ -793,7 +803,7 @@ E('ERR_INVALID_ARG_VALUE', (name, value, reason = 'is invalid') => {\n }, TypeError, RangeError);\n E('ERR_INVALID_ARRAY_LENGTH',\n   (name, len, actual) => {\n-    internalAssert(typeof actual === 'number', 'actual must be a number');\n+    internalAssert(typeof actual === 'number', 'actual must be of type number');\n     return `The array \"${name}\" (length ${actual}) must be of length ${len}.`;\n   }, TypeError);\n E('ERR_INVALID_ASYNC_ID', 'Invalid %s value: %s', RangeError);\n@@ -925,7 +935,9 @@ E('ERR_UNCAUGHT_EXCEPTION_CAPTURE_ALREADY_SET',\n   Error);\n E('ERR_UNESCAPED_CHARACTERS', '%s contains unescaped characters', TypeError);\n E('ERR_UNHANDLED_ERROR',\n-  (err) => {\n+  // Using a default argument here is important so the argument is not counted\n+  // towards `Function#length`.\n+  (err = undefined) => {\n     const msg = 'Unhandled error.';\n     if (err === undefined) return msg;\n     return `${msg} (${err})`;\n@@ -960,7 +972,6 @@ E('ERR_VM_MODULE_STATUS', 'Module status %s', Error);\n E('ERR_ZLIB_INITIALIZATION_FAILED', 'Initialization failed', Error);\n \n function invalidArgType(name, expected, actual) {\n-  internalAssert(arguments.length === 3, 'Exactly 3 arguments are required');\n   internalAssert(typeof name === 'string', 'name must be a string');\n \n   // determiner: 'must be' or 'must not be'\n@@ -1007,8 +1018,7 @@ function missingArgs(...args) {\n }\n \n function oneOf(expected, thing) {\n-  internalAssert(expected, 'expected is required');\n-  internalAssert(typeof thing === 'string', 'thing is required');\n+  internalAssert(typeof thing === 'string', '`thing` has to be of type string');\n   if (Array.isArray(expected)) {\n     const len = expected.length;\n     internalAssert(len > 0,\n@@ -1027,25 +1037,28 @@ function oneOf(expected, thing) {\n   }\n }\n \n-function bufferOutOfBounds(name, isWriting) {\n-  if (isWriting) {\n-    return 'Attempt to write outside buffer bounds';\n-  } else {\n+// Using a default argument here is important so the argument is not counted\n+// towards `Function#length`.\n+function bufferOutOfBounds(name = undefined) {\n+  if (name) {\n     return `\"${name}\" is outside of buffer bounds`;\n   }\n+  return 'Attempt to write outside buffer bounds';\n }\n \n-function invalidChar(name, field) {\n+// Using a default argument here is important so the argument is not counted\n+// towards `Function#length`.\n+function invalidChar(name, field = undefined) {\n   let msg = `Invalid character in ${name}`;\n-  if (field) {\n+  if (field !== undefined) {\n     msg += ` [\"${field}\"]`;\n   }\n   return msg;\n }\n \n function outOfRange(name, range, value) {\n   let msg = `The value of \"${name}\" is out of range.`;\n-  if (range) msg += ` It must be ${range}.`;\n-  if (value !== undefined) msg += ` Received ${value}`;\n+  if (range !== undefined) msg += ` It must be ${range}.`;\n+  msg += ` Received ${value}`;\n   return msg;\n }"
        },
        {
            "sha": "02ba4bbf72baf9ad6b60dd2943ddca18929ada35",
            "filename": "lib/internal/fs.js",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ffs.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -368,9 +368,10 @@ function validateOffsetLengthRead(offset, length, bufferLength) {\n   let err;\n \n   if (offset < 0 || offset >= bufferLength) {\n-    err = new ERR_OUT_OF_RANGE('offset');\n+    err = new ERR_OUT_OF_RANGE('offset', `>= 0 && <= ${bufferLength}`, offset);\n   } else if (length < 0 || offset + length > bufferLength) {\n-    err = new ERR_OUT_OF_RANGE('length');\n+    err = new ERR_OUT_OF_RANGE('length',\n+                               `>= 0 && <= ${bufferLength - offset}`, length);\n   }\n \n   if (err !== undefined) {\n@@ -383,9 +384,12 @@ function validateOffsetLengthWrite(offset, length, byteLength) {\n   let err;\n \n   if (offset > byteLength) {\n-    err = new ERR_OUT_OF_RANGE('offset');\n-  } else if (offset + length > byteLength || offset + length > kMaxLength) {\n-    err = new ERR_OUT_OF_RANGE('length');\n+    err = new ERR_OUT_OF_RANGE('offset', `<= ${byteLength}`, offset);\n+  } else {\n+    const max = byteLength > kMaxLength ? kMaxLength : byteLength;\n+    if (length > max - offset) {\n+      err = new ERR_OUT_OF_RANGE('length', `<= ${max - offset}`, length);\n+    }\n   }\n \n   if (err !== undefined) {"
        },
        {
            "sha": "8d0ceffc67253bbcb4a4a5cd3a171ae7b5cbc2a1",
            "filename": "lib/internal/http2/core.js",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Fhttp2%2Fcore.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/lib%2Finternal%2Fhttp2%2Fcore.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fhttp2%2Fcore.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -1312,8 +1312,10 @@ class ServerHttp2Session extends Http2Session {\n       if (origin === 'null')\n         throw new ERR_HTTP2_ALTSVC_INVALID_ORIGIN();\n     } else if (typeof originOrStream === 'number') {\n-      if (originOrStream >>> 0 !== originOrStream || originOrStream === 0)\n-        throw new ERR_OUT_OF_RANGE('originOrStream');\n+      if (originOrStream >>> 0 !== originOrStream || originOrStream === 0) {\n+        throw new ERR_OUT_OF_RANGE('originOrStream',\n+                                   `> 0 && < ${2 ** 32}`, originOrStream);\n+      }\n       stream = originOrStream;\n     } else if (originOrStream !== undefined) {\n       // Allow origin to be passed a URL or object with origin property\n@@ -1764,7 +1766,7 @@ class Http2Stream extends Duplex {\n     if (typeof code !== 'number')\n       throw new ERR_INVALID_ARG_TYPE('code', 'number', code);\n     if (code < 0 || code > kMaxInt)\n-      throw new ERR_OUT_OF_RANGE('code');\n+      throw new ERR_OUT_OF_RANGE('code', `>= 0 && <= ${kMaxInt}`, code);\n     if (callback !== undefined && typeof callback !== 'function')\n       throw new ERR_INVALID_CALLBACK();\n "
        },
        {
            "sha": "8d26f983f2b4dd654fc2afd51a22275da8519f83",
            "filename": "test/parallel/test-buffer-arraybuffer.js",
            "status": "modified",
            "additions": 13,
            "deletions": 13,
            "changes": 26,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-buffer-arraybuffer.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-buffer-arraybuffer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-buffer-arraybuffer.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -1,6 +1,6 @@\n 'use strict';\n \n-const common = require('../common');\n+require('../common');\n const assert = require('assert');\n \n const LENGTH = 16;\n@@ -58,14 +58,14 @@ assert.throws(function() {\n   buf[0] = 9;\n   assert.strictEqual(ab[1], 9);\n \n-  common.expectsError(() => Buffer.from(ab.buffer, 6), {\n+  assert.throws(() => Buffer.from(ab.buffer, 6), {\n     code: 'ERR_BUFFER_OUT_OF_BOUNDS',\n-    type: RangeError,\n+    name: 'RangeError [ERR_BUFFER_OUT_OF_BOUNDS]',\n     message: '\"offset\" is outside of buffer bounds'\n   });\n-  common.expectsError(() => Buffer.from(ab.buffer, 3, 6), {\n+  assert.throws(() => Buffer.from(ab.buffer, 3, 6), {\n     code: 'ERR_BUFFER_OUT_OF_BOUNDS',\n-    type: RangeError,\n+    name: 'RangeError [ERR_BUFFER_OUT_OF_BOUNDS]',\n     message: '\"length\" is outside of buffer bounds'\n   });\n }\n@@ -86,14 +86,14 @@ assert.throws(function() {\n   buf[0] = 9;\n   assert.strictEqual(ab[1], 9);\n \n-  common.expectsError(() => Buffer(ab.buffer, 6), {\n+  assert.throws(() => Buffer(ab.buffer, 6), {\n     code: 'ERR_BUFFER_OUT_OF_BOUNDS',\n-    type: RangeError,\n+    name: 'RangeError [ERR_BUFFER_OUT_OF_BOUNDS]',\n     message: '\"offset\" is outside of buffer bounds'\n   });\n-  common.expectsError(() => Buffer(ab.buffer, 3, 6), {\n+  assert.throws(() => Buffer(ab.buffer, 3, 6), {\n     code: 'ERR_BUFFER_OUT_OF_BOUNDS',\n-    type: RangeError,\n+    name: 'RangeError [ERR_BUFFER_OUT_OF_BOUNDS]',\n     message: '\"length\" is outside of buffer bounds'\n   });\n }\n@@ -111,11 +111,11 @@ assert.throws(function() {\n   assert.deepStrictEqual(Buffer.from(ab, [1]), Buffer.from(ab, 1));\n \n   // If byteOffset is Infinity, throw.\n-  common.expectsError(() => {\n+  assert.throws(() => {\n     Buffer.from(ab, Infinity);\n   }, {\n     code: 'ERR_BUFFER_OUT_OF_BOUNDS',\n-    type: RangeError,\n+    name: 'RangeError [ERR_BUFFER_OUT_OF_BOUNDS]',\n     message: '\"offset\" is outside of buffer bounds'\n   });\n }\n@@ -133,11 +133,11 @@ assert.throws(function() {\n   assert.deepStrictEqual(Buffer.from(ab, 0, [1]), Buffer.from(ab, 0, 1));\n \n   // If length is Infinity, throw.\n-  common.expectsError(() => {\n+  assert.throws(() => {\n     Buffer.from(ab, 0, Infinity);\n   }, {\n     code: 'ERR_BUFFER_OUT_OF_BOUNDS',\n-    type: RangeError,\n+    name: 'RangeError [ERR_BUFFER_OUT_OF_BOUNDS]',\n     message: '\"length\" is outside of buffer bounds'\n   });\n }"
        },
        {
            "sha": "6cfeeefb51952d1068ad96f628810293f3b61123",
            "filename": "test/parallel/test-child-process-fork.js",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-child-process-fork.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-child-process-fork.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-child-process-fork.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -31,18 +31,26 @@ const n = fork(fixtures.path('child-process-spawn-node.js'), args);\n assert.strictEqual(n.channel, n._channel);\n assert.deepStrictEqual(args, ['foo', 'bar']);\n \n-n.on('message', function(m) {\n+n.on('message', (m) => {\n   console.log('PARENT got message:', m);\n   assert.ok(m.foo);\n });\n \n // https://github.com/joyent/node/issues/2355 - JSON.stringify(undefined)\n // returns \"undefined\" but JSON.parse() cannot parse that...\n-assert.throws(function() { n.send(undefined); }, TypeError);\n-assert.throws(function() { n.send(); }, TypeError);\n+assert.throws(() => n.send(undefined), {\n+  name: 'TypeError [ERR_MISSING_ARGS]',\n+  message: 'The \"message\" argument must be specified',\n+  code: 'ERR_MISSING_ARGS'\n+});\n+assert.throws(() => n.send(), {\n+  name: 'TypeError [ERR_MISSING_ARGS]',\n+  message: 'The \"message\" argument must be specified',\n+  code: 'ERR_MISSING_ARGS'\n+});\n \n n.send({ hello: 'world' });\n \n-n.on('exit', common.mustCall(function(c) {\n+n.on('exit', common.mustCall((c) => {\n   assert.strictEqual(c, 0);\n }));"
        },
        {
            "sha": "b4ecd3c6061158f2a05d8c83bb8508dbbab10ceb",
            "filename": "test/parallel/test-crypto-pbkdf2.js",
            "status": "modified",
            "additions": 32,
            "deletions": 31,
            "changes": 63,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-crypto-pbkdf2.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-crypto-pbkdf2.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-pbkdf2.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -57,125 +57,126 @@ function ondone(err, key) {\n }\n \n // Error path should not leak memory (check with valgrind).\n-common.expectsError(\n+assert.throws(\n   () => crypto.pbkdf2('password', 'salt', 1, 20, null),\n   {\n     code: 'ERR_INVALID_CALLBACK',\n-    type: TypeError\n+    name: 'TypeError [ERR_INVALID_CALLBACK]'\n   }\n );\n \n-common.expectsError(\n+assert.throws(\n   () => crypto.pbkdf2Sync('password', 'salt', -1, 20, null),\n   {\n     code: 'ERR_OUT_OF_RANGE',\n-    type: RangeError,\n+    name: 'RangeError [ERR_OUT_OF_RANGE]',\n     message: 'The value of \"iterations\" is out of range. ' +\n              'It must be a non-negative number. Received -1'\n   }\n );\n \n ['str', null, undefined, [], {}].forEach((notNumber) => {\n-  common.expectsError(\n+  assert.throws(\n     () => {\n       crypto.pbkdf2Sync('password', 'salt', 1, notNumber, 'sha256');\n     }, {\n       code: 'ERR_INVALID_ARG_TYPE',\n-      type: TypeError,\n+      name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n       message: 'The \"keylen\" argument must be of type number. ' +\n                `Received type ${typeof notNumber}`\n     });\n });\n \n-[Infinity, -Infinity, NaN, -1, 4073741824, INT_MAX + 1].forEach((i) => {\n-  common.expectsError(\n+[Infinity, -Infinity, NaN, -1, 4073741824, INT_MAX + 1].forEach((input) => {\n+  assert.throws(\n     () => {\n-      crypto.pbkdf2('password', 'salt', 1, i, 'sha256',\n+      crypto.pbkdf2('password', 'salt', 1, input, 'sha256',\n                     common.mustNotCall());\n     }, {\n       code: 'ERR_OUT_OF_RANGE',\n-      type: RangeError,\n-      message: 'The value of \"keylen\" is out of range.'\n+      name: 'RangeError [ERR_OUT_OF_RANGE]',\n+      message: 'The value of \"keylen\" is out of range. It ' +\n+               `must be >= 0 && <= 2147483647. Received ${input}`\n     });\n });\n \n // Should not get FATAL ERROR with empty password and salt\n // https://github.com/nodejs/node/issues/8571\n crypto.pbkdf2('', '', 1, 32, 'sha256', common.mustCall(assert.ifError));\n \n-common.expectsError(\n+assert.throws(\n   () => crypto.pbkdf2('password', 'salt', 8, 8, common.mustNotCall()),\n   {\n     code: 'ERR_INVALID_ARG_TYPE',\n-    type: TypeError,\n+    name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n     message: 'The \"digest\" argument must be one of type string or null. ' +\n              'Received type undefined'\n   });\n \n-common.expectsError(\n+assert.throws(\n   () => crypto.pbkdf2Sync('password', 'salt', 8, 8),\n   {\n     code: 'ERR_INVALID_ARG_TYPE',\n-    type: TypeError,\n+    name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n     message: 'The \"digest\" argument must be one of type string or null. ' +\n              'Received type undefined'\n   });\n \n [1, {}, [], true, undefined, null].forEach((input) => {\n   const msgPart2 = `Buffer, or TypedArray. Received type ${typeof input}`;\n-  common.expectsError(\n+  assert.throws(\n     () => crypto.pbkdf2(input, 'salt', 8, 8, 'sha256', common.mustNotCall()),\n     {\n       code: 'ERR_INVALID_ARG_TYPE',\n-      type: TypeError,\n+      name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n       message: `The \"password\" argument must be one of type string, ${msgPart2}`\n     }\n   );\n \n-  common.expectsError(\n+  assert.throws(\n     () => crypto.pbkdf2('pass', input, 8, 8, 'sha256', common.mustNotCall()),\n     {\n       code: 'ERR_INVALID_ARG_TYPE',\n-      type: TypeError,\n+      name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n       message: `The \"salt\" argument must be one of type string, ${msgPart2}`\n     }\n   );\n \n-  common.expectsError(\n+  assert.throws(\n     () => crypto.pbkdf2Sync(input, 'salt', 8, 8, 'sha256'),\n     {\n       code: 'ERR_INVALID_ARG_TYPE',\n-      type: TypeError,\n+      name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n       message: `The \"password\" argument must be one of type string, ${msgPart2}`\n     }\n   );\n \n-  common.expectsError(\n+  assert.throws(\n     () => crypto.pbkdf2Sync('pass', input, 8, 8, 'sha256'),\n     {\n       code: 'ERR_INVALID_ARG_TYPE',\n-      type: TypeError,\n+      name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n       message: `The \"salt\" argument must be one of type string, ${msgPart2}`\n     }\n   );\n });\n \n ['test', {}, [], true, undefined, null].forEach((i) => {\n   const received = `Received type ${typeof i}`;\n-  common.expectsError(\n+  assert.throws(\n     () => crypto.pbkdf2('pass', 'salt', i, 8, 'sha256', common.mustNotCall()),\n     {\n       code: 'ERR_INVALID_ARG_TYPE',\n-      type: TypeError,\n+      name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n       message: `The \"iterations\" argument must be of type number. ${received}`\n     }\n   );\n \n-  common.expectsError(\n+  assert.throws(\n     () => crypto.pbkdf2Sync('pass', 'salt', i, 8, 'sha256'),\n     {\n       code: 'ERR_INVALID_ARG_TYPE',\n-      type: TypeError,\n+      name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n       message: `The \"iterations\" argument must be of type number. ${received}`\n     }\n   );\n@@ -204,20 +205,20 @@ crypto.pbkdf2Sync('pass', new Float32Array(10), 8, 8, 'sha256');\n crypto.pbkdf2Sync(new Float64Array(10), 'salt', 8, 8, 'sha256');\n crypto.pbkdf2Sync('pass', new Float64Array(10), 8, 8, 'sha256');\n \n-common.expectsError(\n+assert.throws(\n   () => crypto.pbkdf2('pass', 'salt', 8, 8, 'md55', common.mustNotCall()),\n   {\n     code: 'ERR_CRYPTO_INVALID_DIGEST',\n-    type: TypeError,\n+    name: 'TypeError [ERR_CRYPTO_INVALID_DIGEST]',\n     message: 'Invalid digest: md55'\n   }\n );\n \n-common.expectsError(\n+assert.throws(\n   () => crypto.pbkdf2Sync('pass', 'salt', 8, 8, 'md55'),\n   {\n     code: 'ERR_CRYPTO_INVALID_DIGEST',\n-    type: TypeError,\n+    name: 'TypeError [ERR_CRYPTO_INVALID_DIGEST]',\n     message: 'Invalid digest: md55'\n   }\n );"
        },
        {
            "sha": "a74d7b3846f59df58e9467c214b2e96a5c05f8ef",
            "filename": "test/parallel/test-errors-systemerror.js",
            "status": "modified",
            "additions": 10,
            "deletions": 12,
            "changes": 22,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-errors-systemerror.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-errors-systemerror.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-errors-systemerror.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -1,19 +1,17 @@\n // Flags: --expose-internals\n 'use strict';\n \n-const common = require('../common');\n+require('../common');\n const assert = require('assert');\n const errors = require('internal/errors');\n-const { AssertionError } = require('assert');\n \n const { E, SystemError } = errors;\n \n-common.expectsError(\n+assert.throws(\n   () => { throw new errors.SystemError(); },\n   {\n-    code: 'ERR_ASSERTION',\n-    type: AssertionError,\n-    message: 'An invalid error message key was used: undefined.'\n+    name: 'TypeError',\n+    message: 'Cannot read property \\'match\\' of undefined'\n   }\n );\n \n@@ -29,11 +27,11 @@ const { ERR_TEST } = errors.codes;\n     dest: '/str2'\n   };\n \n-  common.expectsError(\n+  assert.throws(\n     () => { throw new ERR_TEST(ctx); },\n     {\n       code: 'ERR_TEST',\n-      type: SystemError,\n+      name: 'SystemError [ERR_TEST]',\n       message: 'custom message: syscall_test returned ETEST (code message)' +\n                ' /str => /str2',\n       info: ctx\n@@ -49,11 +47,11 @@ const { ERR_TEST } = errors.codes;\n     path: Buffer.from('/buf'),\n     dest: '/str2'\n   };\n-  common.expectsError(\n+  assert.throws(\n     () => { throw new ERR_TEST(ctx); },\n     {\n       code: 'ERR_TEST',\n-      type: SystemError,\n+      name: 'SystemError [ERR_TEST]',\n       message: 'custom message: syscall_test returned ETEST (code message)' +\n                ' /buf => /str2',\n       info: ctx\n@@ -69,11 +67,11 @@ const { ERR_TEST } = errors.codes;\n     path: Buffer.from('/buf'),\n     dest: Buffer.from('/buf2')\n   };\n-  common.expectsError(\n+  assert.throws(\n     () => { throw new ERR_TEST(ctx); },\n     {\n       code: 'ERR_TEST',\n-      type: SystemError,\n+      name: 'SystemError [ERR_TEST]',\n       message: 'custom message: syscall_test returned ETEST (code message)' +\n                ' /buf => /buf2',\n       info: ctx"
        },
        {
            "sha": "63d780a57dfc66710b4c55a43a291f63578c85f5",
            "filename": "test/parallel/test-fs-fchmod.js",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-fs-fchmod.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-fs-fchmod.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-fchmod.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -70,19 +70,19 @@ fs.fchmodSync(1, modeUpperBoundaryValue);\n \n // umask of 0o777 is equal to 775\n const modeOutsideUpperBoundValue = 776;\n-common.expectsError(\n+assert.throws(\n   () => fs.fchmod(1, modeOutsideUpperBoundValue),\n   {\n     code: 'ERR_OUT_OF_RANGE',\n-    type: RangeError,\n-    message: 'The value of \"mode\" is out of range.'\n+    name: 'RangeError [ERR_OUT_OF_RANGE]',\n+    message: 'The value of \"mode\" is out of range. Received 776'\n   }\n );\n-common.expectsError(\n+assert.throws(\n   () => fs.fchmodSync(1, modeOutsideUpperBoundValue),\n   {\n     code: 'ERR_OUT_OF_RANGE',\n-    type: RangeError,\n-    message: 'The value of \"mode\" is out of range.'\n+    name: 'RangeError [ERR_OUT_OF_RANGE]',\n+    message: 'The value of \"mode\" is out of range. Received 776'\n   }\n );"
        },
        {
            "sha": "2980bca7d2038e58619c03d35da9cbda7d615068",
            "filename": "test/parallel/test-fs-read-type.js",
            "status": "modified",
            "additions": 37,
            "deletions": 20,
            "changes": 57,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-fs-read-type.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-fs-read-type.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-read-type.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -1,6 +1,7 @@\n 'use strict';\n const common = require('../common');\n const fs = require('fs');\n+const assert = require('assert');\n const fixtures = require('../common/fixtures');\n \n const filepath = fixtures.path('x.txt');\n@@ -9,18 +10,18 @@ const expected = 'xyz\\n';\n \n \n // Error must be thrown with string\n-common.expectsError(\n+assert.throws(\n   () => fs.read(fd, expected.length, 0, 'utf-8', common.mustNotCall()),\n   {\n     code: 'ERR_INVALID_ARG_TYPE',\n-    type: TypeError,\n+    name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n     message: 'The \"buffer\" argument must be one of type Buffer or Uint8Array.' +\n              ' Received type number'\n   }\n );\n \n [true, null, undefined, () => {}, {}].forEach((value) => {\n-  common.expectsError(() => {\n+  assert.throws(() => {\n     fs.read(value,\n             Buffer.allocUnsafe(expected.length),\n             0,\n@@ -29,72 +30,88 @@ common.expectsError(\n             common.mustNotCall());\n   }, {\n     code: 'ERR_INVALID_ARG_TYPE',\n-    type: TypeError,\n+    name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n     message: 'The \"fd\" argument must be of type number. ' +\n              `Received type ${typeof value}`\n   });\n });\n \n-common.expectsError(() => {\n+assert.throws(() => {\n   fs.read(fd,\n           Buffer.allocUnsafe(expected.length),\n           -1,\n           expected.length,\n           0,\n           common.mustNotCall());\n-}, { code: 'ERR_OUT_OF_RANGE', type: RangeError,\n-     message: 'The value of \"offset\" is out of range.' });\n+}, {\n+  code: 'ERR_OUT_OF_RANGE',\n+  name: 'RangeError [ERR_OUT_OF_RANGE]',\n+  message: 'The value of \"offset\" is out of range. It must be >= 0 && <= 4. ' +\n+           'Received -1'\n+});\n \n-common.expectsError(() => {\n+assert.throws(() => {\n   fs.read(fd,\n           Buffer.allocUnsafe(expected.length),\n           0,\n           -1,\n           0,\n           common.mustNotCall());\n-}, { code: 'ERR_OUT_OF_RANGE', type: RangeError,\n-     message: 'The value of \"length\" is out of range.' });\n+}, {\n+  code: 'ERR_OUT_OF_RANGE',\n+  name: 'RangeError [ERR_OUT_OF_RANGE]',\n+  message: 'The value of \"length\" is out of range. ' +\n+           'It must be >= 0 && <= 4. Received -1'\n+});\n \n \n-common.expectsError(\n+assert.throws(\n   () => fs.readSync(fd, expected.length, 0, 'utf-8'),\n   {\n     code: 'ERR_INVALID_ARG_TYPE',\n-    type: TypeError,\n+    name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n     message: 'The \"buffer\" argument must be one of type Buffer or Uint8Array.' +\n              ' Received type number'\n   }\n );\n \n [true, null, undefined, () => {}, {}].forEach((value) => {\n-  common.expectsError(() => {\n+  assert.throws(() => {\n     fs.readSync(value,\n                 Buffer.allocUnsafe(expected.length),\n                 0,\n                 expected.length,\n                 0);\n   }, {\n     code: 'ERR_INVALID_ARG_TYPE',\n-    type: TypeError,\n+    name: 'TypeError [ERR_INVALID_ARG_TYPE]',\n     message: 'The \"fd\" argument must be of type number. ' +\n              `Received type ${typeof value}`\n   });\n });\n \n-common.expectsError(() => {\n+assert.throws(() => {\n   fs.readSync(fd,\n               Buffer.allocUnsafe(expected.length),\n               -1,\n               expected.length,\n               0);\n-}, { code: 'ERR_OUT_OF_RANGE', type: RangeError,\n-     message: 'The value of \"offset\" is out of range.' });\n+}, {\n+  code: 'ERR_OUT_OF_RANGE',\n+  name: 'RangeError [ERR_OUT_OF_RANGE]',\n+  message: 'The value of \"offset\" is out of range. ' +\n+           'It must be >= 0 && <= 4. Received -1'\n+});\n \n-common.expectsError(() => {\n+assert.throws(() => {\n   fs.readSync(fd,\n               Buffer.allocUnsafe(expected.length),\n               0,\n               -1,\n               0);\n-}, { code: 'ERR_OUT_OF_RANGE', type: RangeError,\n-     message: 'The value of \"length\" is out of range.' });\n+}, {\n+  code: 'ERR_OUT_OF_RANGE',\n+  name: 'RangeError [ERR_OUT_OF_RANGE]',\n+  message: 'The value of \"length\" is out of range. ' +\n+           'It must be >= 0 && <= 4. Received -1'\n+});"
        },
        {
            "sha": "d4216e973df3cab5ce04fcd5e4c46bd24e2bc9db",
            "filename": "test/parallel/test-http2-altsvc.js",
            "status": "modified",
            "additions": 27,
            "deletions": 22,
            "changes": 49,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-http2-altsvc.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-http2-altsvc.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http2-altsvc.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -28,43 +28,46 @@ server.on('session', common.mustCall((session) => {\n   session.altsvc('h2=\":8000\"', 3);\n \n   // Will error because the numeric stream id is out of valid range\n-  [0, -1, 1.1, 0xFFFFFFFF + 1, Infinity, -Infinity].forEach((i) => {\n-    common.expectsError(\n-      () => session.altsvc('h2=\":8000\"', i),\n+  [0, -1, 1.1, 0xFFFFFFFF + 1, Infinity, -Infinity].forEach((input) => {\n+    assert.throws(\n+      () => session.altsvc('h2=\":8000\"', input),\n       {\n         code: 'ERR_OUT_OF_RANGE',\n-        type: RangeError\n+        name: 'RangeError [ERR_OUT_OF_RANGE]',\n+        message: 'The value of \"originOrStream\" is out of ' +\n+                 `range. It must be > 0 && < 4294967296. Received ${input}`\n       }\n     );\n   });\n \n   // First argument must be a string\n-  [0, {}, [], null, Infinity].forEach((i) => {\n-    common.expectsError(\n-      () => session.altsvc(i),\n+  [0, {}, [], null, Infinity].forEach((input) => {\n+    assert.throws(\n+      () => session.altsvc(input),\n       {\n         code: 'ERR_INVALID_ARG_TYPE',\n-        type: TypeError\n+        name: 'TypeError [ERR_INVALID_ARG_TYPE]'\n       }\n     );\n   });\n \n-  ['\\u0001', 'h2=\"\\uff20\"', 'ðŸ‘€'].forEach((i) => {\n-    common.expectsError(\n-      () => session.altsvc(i),\n+  ['\\u0001', 'h2=\"\\uff20\"', 'ðŸ‘€'].forEach((input) => {\n+    assert.throws(\n+      () => session.altsvc(input),\n       {\n         code: 'ERR_INVALID_CHAR',\n-        type: TypeError\n+        name: 'TypeError [ERR_INVALID_CHAR]',\n+        message: 'Invalid character in alt'\n       }\n     );\n   });\n \n-  [{}, [], true].forEach((i) => {\n-    common.expectsError(\n-      () => session.altsvc('clear', i),\n+  [{}, [], true].forEach((input) => {\n+    assert.throws(\n+      () => session.altsvc('clear', input),\n       {\n         code: 'ERR_INVALID_ARG_TYPE',\n-        type: TypeError\n+        name: 'TypeError [ERR_INVALID_ARG_TYPE]'\n       }\n     );\n   });\n@@ -74,25 +77,27 @@ server.on('session', common.mustCall((session) => {\n     new URL('abc:'),\n     { origin: 'null' },\n     { origin: '' }\n-  ].forEach((i) => {\n-    common.expectsError(\n-      () => session.altsvc('h2=\":8000', i),\n+  ].forEach((input) => {\n+    assert.throws(\n+      () => session.altsvc('h2=\":8000', input),\n       {\n         code: 'ERR_HTTP2_ALTSVC_INVALID_ORIGIN',\n-        type: TypeError\n+        name: 'TypeError [ERR_HTTP2_ALTSVC_INVALID_ORIGIN]',\n+        message: 'HTTP/2 ALTSVC frames require a valid origin'\n       }\n     );\n   });\n \n   // arguments + origin are too long for an ALTSVC frame\n-  common.expectsError(\n+  assert.throws(\n     () => {\n       session.altsvc('h2=\":8000\"',\n                      `http://example.${'a'.repeat(17000)}.org:8000`);\n     },\n     {\n       code: 'ERR_HTTP2_ALTSVC_LENGTH',\n-      type: TypeError\n+      name: 'TypeError [ERR_HTTP2_ALTSVC_LENGTH]',\n+      message: 'HTTP/2 ALTSVC frames are limited to 16382 bytes'\n     }\n   );\n }));"
        },
        {
            "sha": "7bace941d1a0afbf8c4948ce7085e8b8db4737df",
            "filename": "test/parallel/test-http2-client-rststream-before-connect.js",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-http2-client-rststream-before-connect.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-http2-client-rststream-before-connect.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http2-client-rststream-before-connect.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -18,12 +18,13 @@ server.listen(0, common.mustCall(() => {\n   const req = client.request();\n   const closeCode = 1;\n \n-  common.expectsError(\n+  assert.throws(\n     () => req.close(2 ** 32),\n     {\n-      type: RangeError,\n+      name: 'RangeError [ERR_OUT_OF_RANGE]',\n       code: 'ERR_OUT_OF_RANGE',\n-      message: 'The value of \"code\" is out of range.'\n+      message: 'The value of \"code\" is out of range. It must be ' +\n+               '>= 0 && <= 4294967295. Received 4294967296'\n     }\n   );\n   assert.strictEqual(req.closed, false);"
        },
        {
            "sha": "a161a1db69e66d1dfcecd93e42244643d0174a69",
            "filename": "test/parallel/test-internal-errors.js",
            "status": "modified",
            "additions": 7,
            "deletions": 15,
            "changes": 22,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-internal-errors.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-internal-errors.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-internal-errors.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -42,11 +42,13 @@ errors.E('TEST_ERROR_2', (a, b) => `${a} ${b}`, Error);\n }\n \n {\n-  const err = new errors.codes.TEST_ERROR_1();\n-  assert(err instanceof Error);\n-  assert.strictEqual(err.name, 'Error [TEST_ERROR_1]');\n-  assert.strictEqual(err.message, 'Error for testing purposes: %s');\n-  assert.strictEqual(err.code, 'TEST_ERROR_1');\n+  assert.throws(\n+    () => new errors.codes.TEST_ERROR_1(),\n+    {\n+      message: 'Code: TEST_ERROR_1; The provided arguments ' +\n+               'length (0) does not match the required ones (1).'\n+    }\n+  );\n }\n \n // Tests for common.expectsError\n@@ -156,16 +158,6 @@ assert.strictEqual(\n   'Method must be a valid HTTP token [\"foo\"]'\n );\n \n-assert.strictEqual(\n-  errors.message('ERR_OUT_OF_RANGE', ['A']),\n-  'The value of \"A\" is out of range.'\n-);\n-\n-assert.strictEqual(\n-  errors.message('ERR_OUT_OF_RANGE', ['A', 'some values']),\n-  'The value of \"A\" is out of range. It must be some values.'\n-);\n-\n assert.strictEqual(\n   errors.message('ERR_OUT_OF_RANGE', ['A', 'some values', 'B']),\n   'The value of \"A\" is out of range. It must be some values. Received B'"
        },
        {
            "sha": "0a0f8c5c4e1a3afbacde5f945f99c645baf01173",
            "filename": "test/parallel/test-ttywrap-invalid-fd.js",
            "status": "modified",
            "additions": 9,
            "deletions": 10,
            "changes": 19,
            "blob_url": "https://github.com/nodejs/node/blob/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-ttywrap-invalid-fd.js",
            "raw_url": "https://github.com/nodejs/node/raw/dca7fb2225ea5bd8452c51d4167962f2838389f8/test%2Fparallel%2Ftest-ttywrap-invalid-fd.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-ttywrap-invalid-fd.js?ref=dca7fb2225ea5bd8452c51d4167962f2838389f8",
            "patch": "@@ -1,16 +1,15 @@\n 'use strict';\n-// Flags: --expose-internals\n \n const common = require('../common');\n const tty = require('tty');\n-const { SystemError } = require('internal/errors');\n const uv = process.binding('uv');\n+const assert = require('assert');\n \n-common.expectsError(\n+assert.throws(\n   () => new tty.WriteStream(-1),\n   {\n     code: 'ERR_INVALID_FD',\n-    type: RangeError,\n+    name: 'RangeError [ERR_INVALID_FD]',\n     message: '\"fd\" must be a positive integer: -1'\n   }\n );\n@@ -27,37 +26,37 @@ common.expectsError(\n     'EBADF (bad file descriptor)' : 'EINVAL (invalid argument)';\n   const message = `TTY initialization failed: uv_tty_init returned ${suffix}`;\n \n-  common.expectsError(\n+  assert.throws(\n     () => {\n       common.runWithInvalidFD((fd) => {\n         new tty.WriteStream(fd);\n       });\n     }, {\n       code: 'ERR_TTY_INIT_FAILED',\n-      type: SystemError,\n+      name: 'SystemError [ERR_TTY_INIT_FAILED]',\n       message,\n       info\n     }\n   );\n \n-  common.expectsError(\n+  assert.throws(\n     () => {\n       common.runWithInvalidFD((fd) => {\n         new tty.ReadStream(fd);\n       });\n     }, {\n       code: 'ERR_TTY_INIT_FAILED',\n-      type: SystemError,\n+      name: 'SystemError [ERR_TTY_INIT_FAILED]',\n       message,\n       info\n     });\n }\n \n-common.expectsError(\n+assert.throws(\n   () => new tty.ReadStream(-1),\n   {\n     code: 'ERR_INVALID_FD',\n-    type: RangeError,\n+    name: 'RangeError [ERR_INVALID_FD]',\n     message: '\"fd\" must be a positive integer: -1'\n   }\n );"
        }
    ],
    "stats": {
        "total": 393,
        "additions": 215,
        "deletions": 178
    }
}