{
    "author": "addaleax",
    "message": "test: remove test/gc, integrate into parallel\n\nThereâ€™s no reason to have a separate addon just for\ntesting GC anymore.\n\nPR-URL: https://github.com/nodejs/node/pull/22001\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Refael Ackermann <refack@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Jon Moss <me@jonathanmoss.me>\nReviewed-By: Benjamin Gruenbaum <benjamingr@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>",
    "sha": "02badc424f92f71de66adf945e51fd07a914aaf1",
    "files": [
        {
            "sha": "b228cbbf7a0562aaf38e18c7e07d24faaaef9b5a",
            "filename": "Makefile",
            "status": "modified",
            "additions": 1,
            "deletions": 19,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/02badc424f92f71de66adf945e51fd07a914aaf1/Makefile",
            "raw_url": "https://github.com/nodejs/node/raw/02badc424f92f71de66adf945e51fd07a914aaf1/Makefile",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/Makefile?ref=02badc424f92f71de66adf945e51fd07a914aaf1",
            "patch": "@@ -314,15 +314,6 @@ benchmark/napi/function_args/build/Release/binding.node: all \\\n \t\t--directory=\"$(shell pwd)/benchmark/napi/function_args\" \\\n \t\t--nodedir=\"$(shell pwd)\"\n \n-# Implicitly depends on $(NODE_EXE).  We don't depend on it explicitly because\n-# it always triggers a rebuild due to it being a .PHONY rule.  See the comment\n-# near the build-addons rule for more background.\n-test/gc/build/Release/binding.node: test/gc/binding.cc test/gc/binding.gyp\n-\t$(NODE) deps/npm/node_modules/node-gyp/bin/node-gyp rebuild \\\n-\t\t--python=\"$(PYTHON)\" \\\n-\t\t--directory=\"$(shell pwd)/test/gc\" \\\n-\t\t--nodedir=\"$(shell pwd)\"\n-\n DOCBUILDSTAMP_PREREQS = tools/doc/addon-verify.js doc/api/addons.md\n \n ifeq ($(OSTYPE),aix)\n@@ -405,20 +396,12 @@ clear-stalled:\n \t\techo $${PS_OUT} | xargs kill -9; \\\n \tfi\n \n-.PHONY: test-gc\n-test-gc: all test/gc/build/Release/binding.node\n-\t$(PYTHON) tools/test.py $(PARALLEL_ARGS) --mode=$(BUILDTYPE_LOWER) gc\n-\n-.PHONY: test-gc-clean\n-test-gc-clean:\n-\t$(RM) -r test/gc/build\n-\n test-build: | all build-addons build-addons-napi\n \n test-build-addons-napi: all build-addons-napi\n \n .PHONY: test-all\n-test-all: test-build test/gc/build/Release/binding.node ## Run everything in test/.\n+test-all: test-build ## Run everything in test/.\n \t$(PYTHON) tools/test.py $(PARALLEL_ARGS) --mode=debug,release\n \n test-all-valgrind: test-build\n@@ -1178,7 +1161,6 @@ LINT_CPP_FILES = $(filter-out $(LINT_CPP_EXCLUDE), $(wildcard \\\n \ttest/cctest/*.h \\\n \ttest/addons-napi/*/*.cc \\\n \ttest/addons-napi/*/*.h \\\n-\ttest/gc/binding.cc \\\n \ttools/icu/*.cc \\\n \ttools/icu/*.h \\\n \t))"
        },
        {
            "sha": "582e5c58367c6fa82a1568feed526ac3c7428f5e",
            "filename": "test/README.md",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/02badc424f92f71de66adf945e51fd07a914aaf1/test%2FREADME.md",
            "raw_url": "https://github.com/nodejs/node/raw/02badc424f92f71de66adf945e51fd07a914aaf1/test%2FREADME.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2FREADME.md?ref=02badc424f92f71de66adf945e51fd07a914aaf1",
            "patch": "@@ -25,7 +25,6 @@ GitHub with the `autocrlf` git config flag set to true.\n |doctool            |Yes            |Tests for the documentation generator.|\n |es-module          |Yes            |Test ESM module loading.|\n |fixtures           |               |Test fixtures used in various tests throughout the test suite.|\n-|gc                 |No             |Tests for garbage collection related functionality.|\n |internet           |No             |Tests that make real outbound connections (mainly networking related modules). Tests for networking related modules may also be present in        other directories, but those tests do not make outbound connections.|\n |known_issues       |Yes            |Tests reproducing known issues within the system. All tests inside of this directory are expected to fail consistently. If a test doesn't fail on certain platforms, those should be skipped via `known_issues.status`.|\n |message            |Yes            |Tests for messages that are output for various conditions (```console.log```, error messages etc.)|"
        },
        {
            "sha": "567609b1234a9b8806c5a05da6c866e480aa148d",
            "filename": "test/gc/.gitignore",
            "status": "removed",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5/test%2Fgc%2F.gitignore",
            "raw_url": "https://github.com/nodejs/node/raw/dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5/test%2Fgc%2F.gitignore",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fgc%2F.gitignore?ref=dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5",
            "patch": "@@ -1 +0,0 @@\n-build/"
        },
        {
            "sha": "8bde3b8505cf37255740807fbb98fd446c93bd8c",
            "filename": "test/gc/binding.cc",
            "status": "removed",
            "additions": 0,
            "deletions": 80,
            "changes": 80,
            "blob_url": "https://github.com/nodejs/node/blob/dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5/test%2Fgc%2Fbinding.cc",
            "raw_url": "https://github.com/nodejs/node/raw/dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5/test%2Fgc%2Fbinding.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fgc%2Fbinding.cc?ref=dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5",
            "patch": "@@ -1,80 +0,0 @@\n-#include \"node.h\"\n-#include \"uv.h\"\n-\n-#include <assert.h>\n-#include <stdlib.h>\n-\n-#include <vector>\n-\n-#ifdef NDEBUG\n-#define CHECK(x) do { if (!(x)) abort(); } while (false)\n-#else\n-#define CHECK assert\n-#endif\n-\n-#define CHECK_EQ(a, b) CHECK((a) == (b))\n-\n-namespace {\n-\n-struct Callback {\n-  inline Callback(v8::Isolate* isolate,\n-                  v8::Local<v8::Object> object,\n-                  v8::Local<v8::Function> function)\n-      : object(isolate, object), function(isolate, function) {}\n-\n-  v8::Persistent<v8::Object> object;\n-  v8::Persistent<v8::Function> function;\n-};\n-\n-static uv_async_t async_handle;\n-static std::vector<Callback*> callbacks;\n-\n-inline void Prime() {\n-  uv_ref(reinterpret_cast<uv_handle_t*>(&async_handle));\n-  CHECK_EQ(0, uv_async_send(&async_handle));\n-}\n-\n-inline void AsyncCallback(uv_async_t*) {\n-  auto isolate = v8::Isolate::GetCurrent();\n-  v8::HandleScope handle_scope(isolate);\n-  auto context = isolate->GetCurrentContext();\n-  auto global = context->Global();\n-  while (!callbacks.empty()) {\n-    v8::HandleScope handle_scope(isolate);\n-    auto callback = callbacks.back();\n-    callbacks.pop_back();\n-    auto function = v8::Local<v8::Function>::New(isolate, callback->function);\n-    delete callback;\n-    if (node::MakeCallback(isolate, global, function, 0, nullptr).IsEmpty())\n-      return Prime();  // Have exception, flush remainder on next loop tick.\n-  }\n-  uv_unref(reinterpret_cast<uv_handle_t*>(&async_handle));\n-}\n-\n-inline void OnGC(const v8::FunctionCallbackInfo<v8::Value>& info) {\n-  CHECK(info[0]->IsObject());\n-  CHECK(info[1]->IsFunction());\n-  auto object = info[0].As<v8::Object>();\n-  auto function = info[1].As<v8::Function>();\n-  auto callback = new Callback(info.GetIsolate(), object, function);\n-  auto on_callback = [] (const v8::WeakCallbackInfo<Callback>& data) {\n-    auto callback = data.GetParameter();\n-    callbacks.push_back(callback);\n-    callback->object.Reset();\n-    Prime();\n-  };\n-  callback->object.SetWeak(callback, on_callback,\n-                           v8::WeakCallbackType::kParameter);\n-}\n-\n-inline void Initialize(v8::Local<v8::Object> exports,\n-                       v8::Local<v8::Value> module,\n-                       v8::Local<v8::Context> context) {\n-  NODE_SET_METHOD(module->ToObject(context).ToLocalChecked(), \"exports\", OnGC);\n-  CHECK_EQ(0, uv_async_init(uv_default_loop(), &async_handle, AsyncCallback));\n-  uv_unref(reinterpret_cast<uv_handle_t*>(&async_handle));\n-}\n-\n-}  // anonymous namespace\n-\n-NODE_MODULE_CONTEXT_AWARE(NODE_GYP_MODULE_NAME, Initialize)"
        },
        {
            "sha": "dc89633601723fabe91fb7921e57575da43cbab5",
            "filename": "test/gc/binding.gyp",
            "status": "removed",
            "additions": 0,
            "deletions": 9,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5/test%2Fgc%2Fbinding.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5/test%2Fgc%2Fbinding.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fgc%2Fbinding.gyp?ref=dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5",
            "patch": "@@ -1,9 +0,0 @@\n-{\n-  'targets': [\n-    {\n-      'target_name': 'binding',\n-      'defines': [ 'V8_DEPRECATION_WARNINGS=1' ],\n-      'sources': [ 'binding.cc' ],\n-    },\n-  ],\n-}"
        },
        {
            "sha": "d6bbcd60fff199e5098c419eaf01cbaacfa2706c",
            "filename": "test/gc/testcfg.py",
            "status": "removed",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5/test%2Fgc%2Ftestcfg.py",
            "raw_url": "https://github.com/nodejs/node/raw/dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5/test%2Fgc%2Ftestcfg.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fgc%2Ftestcfg.py?ref=dcfbedb36518b1ca505149e135dc3ffc4d9ed2d5",
            "patch": "@@ -1,6 +0,0 @@\n-import sys, os\n-sys.path.append(os.path.join(os.path.dirname(__file__), '..'))\n-import testpy\n-\n-def GetConfiguration(context, root):\n-  return testpy.SimpleTestConfiguration(context, root, 'gc', ['--expose-gc'])"
        },
        {
            "sha": "3218c054ed4a2aab97221e7274104e2d35d09f2a",
            "filename": "test/parallel/test-gc-http-client-connaborted.js",
            "status": "renamed",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-http-client-connaborted.js",
            "raw_url": "https://github.com/nodejs/node/raw/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-http-client-connaborted.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-gc-http-client-connaborted.js?ref=02badc424f92f71de66adf945e51fd07a914aaf1",
            "patch": "@@ -1,5 +1,6 @@\n 'use strict';\n-// just like test/gc/http-client.js,\n+// Flags: --expose-gc\n+// just like test-gc-http-client.js,\n // but aborting every connection that comes in.\n \n const common = require('../common');\n@@ -9,7 +10,6 @@ function serverHandler(req, res) {\n }\n \n const http = require('http');\n-const weak = require(`./build/${common.buildType}/binding`);\n const todo = 500;\n let done = 0;\n let count = 0;\n@@ -36,7 +36,7 @@ function getall() {\n     }, cb).on('error', cb);\n \n     count++;\n-    weak(req, afterGC);\n+    common.onGC(req, { ongc });\n   })();\n \n   setImmediate(getall);\n@@ -45,7 +45,7 @@ function getall() {\n for (let i = 0; i < 10; i++)\n   getall();\n \n-function afterGC() {\n+function ongc() {\n   countGC++;\n }\n ",
            "previous_filename": "test/gc/test-http-client-connaborted.js"
        },
        {
            "sha": "8842da93c30dcf1bf36afac01eab7b3eca6104e3",
            "filename": "test/parallel/test-gc-http-client-onerror.js",
            "status": "renamed",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-http-client-onerror.js",
            "raw_url": "https://github.com/nodejs/node/raw/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-http-client-onerror.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-gc-http-client-onerror.js?ref=02badc424f92f71de66adf945e51fd07a914aaf1",
            "patch": "@@ -1,5 +1,6 @@\n 'use strict';\n-// just like test/gc/http-client.js,\n+// Flags: --expose-gc\n+// just like test-gc-http-client.js,\n // but with an on('error') handler that does nothing.\n \n const common = require('../common');\n@@ -11,7 +12,6 @@ function serverHandler(req, res) {\n }\n \n const http = require('http');\n-const weak = require(`./build/${common.buildType}/binding`);\n const todo = 500;\n let done = 0;\n let count = 0;\n@@ -42,7 +42,7 @@ function getall() {\n     }, cb).on('error', onerror);\n \n     count++;\n-    weak(req, afterGC);\n+    common.onGC(req, { ongc });\n   })();\n \n   setImmediate(getall);\n@@ -53,7 +53,7 @@ function runTest() {\n     getall();\n }\n \n-function afterGC() {\n+function ongc() {\n   countGC++;\n }\n ",
            "previous_filename": "test/gc/test-http-client-onerror.js"
        },
        {
            "sha": "e6878021ef9b899a2d6361d11077ae1f1998a8b9",
            "filename": "test/parallel/test-gc-http-client-timeout.js",
            "status": "renamed",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-http-client-timeout.js",
            "raw_url": "https://github.com/nodejs/node/raw/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-http-client-timeout.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-gc-http-client-timeout.js?ref=02badc424f92f71de66adf945e51fd07a914aaf1",
            "patch": "@@ -1,5 +1,6 @@\n 'use strict';\n-// just like test/gc/http-client.js,\n+// Flags: --expose-gc\n+// just like test-gc-http-client.js,\n // but with a timeout set\n \n const common = require('../common');\n@@ -13,7 +14,6 @@ function serverHandler(req, res) {\n }\n \n const http = require('http');\n-const weak = require(`./build/${common.buildType}/binding`);\n const todo = 550;\n let done = 0;\n let count = 0;\n@@ -45,7 +45,7 @@ function getall() {\n     });\n \n     count++;\n-    weak(req, afterGC);\n+    common.onGC(req, { ongc });\n   })();\n \n   setImmediate(getall);\n@@ -54,7 +54,7 @@ function getall() {\n for (let i = 0; i < 10; i++)\n   getall();\n \n-function afterGC() {\n+function ongc() {\n   countGC++;\n }\n ",
            "previous_filename": "test/gc/test-http-client-timeout.js"
        },
        {
            "sha": "d31874fa1666c71ec7c38614be8e41944848c842",
            "filename": "test/parallel/test-gc-http-client.js",
            "status": "renamed",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-http-client.js",
            "raw_url": "https://github.com/nodejs/node/raw/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-http-client.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-gc-http-client.js?ref=02badc424f92f71de66adf945e51fd07a914aaf1",
            "patch": "@@ -1,4 +1,5 @@\n 'use strict';\n+// Flags: --expose-gc\n // just a simple http server and client.\n \n const common = require('../common');\n@@ -9,7 +10,6 @@ function serverHandler(req, res) {\n }\n \n const http = require('http');\n-const weak = require(`./build/${common.buildType}/binding`);\n const todo = 500;\n let done = 0;\n let count = 0;\n@@ -40,7 +40,7 @@ function getall() {\n     }, cb);\n \n     count++;\n-    weak(req, afterGC);\n+    common.onGC(req, { ongc });\n   })();\n \n   setImmediate(getall);\n@@ -49,7 +49,7 @@ function getall() {\n for (let i = 0; i < 10; i++)\n   getall();\n \n-function afterGC() {\n+function ongc() {\n   countGC++;\n }\n ",
            "previous_filename": "test/gc/test-http-client.js"
        },
        {
            "sha": "236980efa3d682b20b627a5afcda77e176e5bfff",
            "filename": "test/parallel/test-gc-net-timeout.js",
            "status": "renamed",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-net-timeout.js",
            "raw_url": "https://github.com/nodejs/node/raw/02badc424f92f71de66adf945e51fd07a914aaf1/test%2Fparallel%2Ftest-gc-net-timeout.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-gc-net-timeout.js?ref=02badc424f92f71de66adf945e51fd07a914aaf1",
            "patch": "@@ -1,5 +1,6 @@\n 'use strict';\n-// just like test/gc/http-client-timeout.js,\n+// Flags: --expose-gc\n+// just like test-gc-http-client-timeout.js,\n // but using a net server/client instead\n \n const common = require('../common');\n@@ -19,7 +20,6 @@ function serverHandler(sock) {\n }\n \n const net = require('net');\n-const weak = require(`./build/${common.buildType}/binding`);\n const assert = require('assert');\n const todo = 500;\n let done = 0;\n@@ -44,15 +44,15 @@ function getall() {\n   });\n \n   count++;\n-  weak(req, afterGC);\n+  common.onGC(req, { ongc });\n \n   setImmediate(getall);\n }\n \n for (let i = 0; i < 10; i++)\n   getall();\n \n-function afterGC() {\n+function ongc() {\n   countGC++;\n }\n ",
            "previous_filename": "test/gc/test-net-timeout.js"
        },
        {
            "sha": "b6f91aa1ebdf5937350413594e65c5d000ec2548",
            "filename": "tools/test.py",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/02badc424f92f71de66adf945e51fd07a914aaf1/tools%2Ftest.py",
            "raw_url": "https://github.com/nodejs/node/raw/02badc424f92f71de66adf945e51fd07a914aaf1/tools%2Ftest.py",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Ftest.py?ref=02badc424f92f71de66adf945e51fd07a914aaf1",
            "patch": "@@ -1538,7 +1538,6 @@ def PrintCrashed(code):\n   'addons-napi',\n   'code-cache',\n   'doctool',\n-  'gc',\n   'internet',\n   'pummel',\n   'tick-processor',"
        },
        {
            "sha": "e2f6cfe180c863a09c22db58fa0d966b64825637",
            "filename": "vcbuild.bat",
            "status": "modified",
            "additions": 3,
            "deletions": 16,
            "changes": 19,
            "blob_url": "https://github.com/nodejs/node/blob/02badc424f92f71de66adf945e51fd07a914aaf1/vcbuild.bat",
            "raw_url": "https://github.com/nodejs/node/raw/02badc424f92f71de66adf945e51fd07a914aaf1/vcbuild.bat",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/vcbuild.bat?ref=02badc424f92f71de66adf945e51fd07a914aaf1",
            "patch": "@@ -33,7 +33,6 @@ set lint_js=\n set lint_cpp=\n set lint_md=\n set lint_md_build=\n-set build_testgc_addon=\n set noetw=\n set noetw_msi_arg=\n set noperfctr=\n@@ -88,13 +87,12 @@ if /i \"%1\"==\"test-addons\"   set test_args=%test_args% addons&set build_addons=1&\n if /i \"%1\"==\"test-addons-napi\"   set test_args=%test_args% addons-napi&set build_addons_napi=1&goto arg-ok\n if /i \"%1\"==\"test-simple\"   set test_args=%test_args% sequential parallel -J&goto arg-ok\n if /i \"%1\"==\"test-message\"  set test_args=%test_args% message&goto arg-ok\n-if /i \"%1\"==\"test-gc\"       set test_args=%test_args% gc&set build_testgc_addon=1&goto arg-ok\n if /i \"%1\"==\"test-tick-processor\" set test_args=%test_args% tick-processor&goto arg-ok\n if /i \"%1\"==\"test-internet\" set test_args=%test_args% internet&goto arg-ok\n if /i \"%1\"==\"test-pummel\"   set test_args=%test_args% pummel&goto arg-ok\n if /i \"%1\"==\"test-known-issues\" set test_args=%test_args% known_issues&goto arg-ok\n if /i \"%1\"==\"test-async-hooks\"  set test_args=%test_args% async-hooks&goto arg-ok\n-if /i \"%1\"==\"test-all\"      set test_args=%test_args% gc internet pummel %common_test_suites%&set build_testgc_addon=1&set lint_cpp=1&set lint_js=1&goto arg-ok\n+if /i \"%1\"==\"test-all\"      set test_args=%test_args% gc internet pummel %common_test_suites%&set lint_cpp=1&set lint_js=1&goto arg-ok\n if /i \"%1\"==\"test-node-inspect\" set test_node_inspect=1&goto arg-ok\n if /i \"%1\"==\"test-check-deopts\" set test_check_deopts=1&goto arg-ok\n if /i \"%1\"==\"test-npm\"      set test_npm=1&goto arg-ok\n@@ -467,17 +465,6 @@ for %%F in (%config%\\doc\\api\\*.md) do (\n :run\n @rem Run tests if requested.\n \n-@rem Build test/gc add-on if required.\n-if \"%build_testgc_addon%\"==\"\" goto build-addons\n-%node_gyp_exe% rebuild --directory=\"%~dp0test\\gc\" --nodedir=\"%~dp0.\"\n-if errorlevel 1 goto build-testgc-addon-failed\n-goto build-addons\n-\n-:build-testgc-addon-failed\n-echo Failed to build test/gc add-on.\"\n-goto exit\n-\n-:build-addons\n if not defined build_addons goto build-addons-napi\n if not exist \"%node_exe%\" (\n   echo Failed to find node.exe\n@@ -560,7 +547,7 @@ goto lint-cpp\n \n :lint-cpp\n if not defined lint_cpp goto lint-js\n-call :run-lint-cpp src\\*.c src\\*.cc src\\*.h test\\addons\\*.cc test\\addons\\*.h test\\addons-napi\\*.cc test\\addons-napi\\*.h test\\cctest\\*.cc test\\cctest\\*.h test\\gc\\binding.cc tools\\icu\\*.cc tools\\icu\\*.h\n+call :run-lint-cpp src\\*.c src\\*.cc src\\*.h test\\addons\\*.cc test\\addons\\*.h test\\addons-napi\\*.cc test\\addons-napi\\*.h test\\cctest\\*.cc test\\cctest\\*.h tools\\icu\\*.cc tools\\icu\\*.h\n python tools/check-imports.py\n goto lint-js\n \n@@ -672,7 +659,7 @@ del .used_configure_flags\n goto exit\n \n :help\n-echo vcbuild.bat [debug/release] [msi] [doc] [test/test-ci/test-all/test-addons/test-addons-napi/test-internet/test-pummel/test-simple/test-message/test-gc/test-tick-processor/test-known-issues/test-node-inspect/test-check-deopts/test-npm/test-async-hooks/test-v8/test-v8-intl/test-v8-benchmarks/test-v8-all] [ignore-flaky] [static/dll] [noprojgen] [projgen] [small-icu/full-icu/without-intl] [nobuild] [nosnapshot] [noetw] [noperfctr] [ltcg] [nopch] [licensetf] [sign] [ia32/x86/x64] [vs2017] [download-all] [enable-vtune] [lint/lint-ci/lint-js/lint-js-ci/lint-md] [lint-md-build] [package] [build-release] [upload] [no-NODE-OPTIONS] [link-module path-to-module] [debug-http2] [debug-nghttp2] [clean] [no-cctest] [openssl-no-asm]\n+echo vcbuild.bat [debug/release] [msi] [doc] [test/test-ci/test-all/test-addons/test-addons-napi/test-internet/test-pummel/test-simple/test-message/test-tick-processor/test-known-issues/test-node-inspect/test-check-deopts/test-npm/test-async-hooks/test-v8/test-v8-intl/test-v8-benchmarks/test-v8-all] [ignore-flaky] [static/dll] [noprojgen] [projgen] [small-icu/full-icu/without-intl] [nobuild] [nosnapshot] [noetw] [noperfctr] [ltcg] [nopch] [licensetf] [sign] [ia32/x86/x64] [vs2017] [download-all] [enable-vtune] [lint/lint-ci/lint-js/lint-js-ci/lint-md] [lint-md-build] [package] [build-release] [upload] [no-NODE-OPTIONS] [link-module path-to-module] [debug-http2] [debug-nghttp2] [clean] [no-cctest] [openssl-no-asm]\n echo Examples:\n echo   vcbuild.bat                          : builds release build\n echo   vcbuild.bat debug                    : builds debug build"
        }
    ],
    "stats": {
        "total": 175,
        "additions": 23,
        "deletions": 152
    }
}