{
    "author": "joyeecheung",
    "message": "src: call CleanupHandles in FreeEnvironment\n\nCleanupHandles() has not been called in our own code base anymore\nafter the v8 debug agent has been removed. It used to be in the\n~Environment() destructor but then removed to avoid firing other\nevents after the exit event, given that we were not going to\nclean up handles for the one environment per process setup.\nCall it in FreeEnvironment so that embedders can clean up\nthe handles in the loop when creating multiple environments.\n\nPR-URL: https://github.com/nodejs/node/pull/19319\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Jackson Tian <shyvo1987@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "855dabd675f3d1b06130bd1b92a131dca89f5eda",
    "files": [
        {
            "sha": "4833ef0fd152e599ece5b9ea529481f2786e0db3",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/855dabd675f3d1b06130bd1b92a131dca89f5eda/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/855dabd675f3d1b06130bd1b92a131dca89f5eda/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=855dabd675f3d1b06130bd1b92a131dca89f5eda",
            "patch": "@@ -4405,6 +4405,7 @@ Environment* CreateEnvironment(IsolateData* isolate_data,\n \n \n void FreeEnvironment(Environment* env) {\n+  env->CleanupHandles();\n   delete env;\n }\n "
        },
        {
            "sha": "e0740a47096460516c0341f7c07f5a2c818d0a46",
            "filename": "test/cctest/node_test_fixture.h",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/855dabd675f3d1b06130bd1b92a131dca89f5eda/test%2Fcctest%2Fnode_test_fixture.h",
            "raw_url": "https://github.com/nodejs/node/raw/855dabd675f3d1b06130bd1b92a131dca89f5eda/test%2Fcctest%2Fnode_test_fixture.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fcctest%2Fnode_test_fixture.h?ref=855dabd675f3d1b06130bd1b92a131dca89f5eda",
            "patch": "@@ -118,7 +118,6 @@ class EnvironmentTestFixture : public NodeTestFixture {\n     }\n \n     ~Env() {\n-      environment_->CleanupHandles();\n       node::FreeEnvironment(environment_);\n       node::FreeIsolateData(isolate_data_);\n       context_->Exit();"
        }
    ],
    "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    }
}