{
    "author": "cjihrig",
    "message": "deps: upgrade to libuv 1.23.1\n\nPR-URL: https://github.com/nodejs/node/pull/22997\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "2790db5e3d74c4f7521cc27a1115228700dd4049",
    "files": [
        {
            "sha": "65048007663a03ac9d8ac1e20394c6b8f22651f9",
            "filename": "deps/uv/AUTHORS",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2FAUTHORS",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2FAUTHORS",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2FAUTHORS?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -346,3 +346,8 @@ Paolo Greppi <paolo.greppi@libpf.com>\n Shelley Vohr <shelley.vohr@gmail.com>\n Ujjwal Sharma <usharma1998@gmail.com>\n Micha≈Ç Kozakiewicz <michalkozakiewicz3@gmail.com>\n+Emil Bay <github@tixz.dk>\n+Jeremiah Senkpiel <fishrock123@rocketmail.com>\n+Andy Zhang <zhangyong232@gmail.com>\n+dmabupt <dmabupt@gmail.com>\n+Ryan Liptak <squeek502@hotmail.com>"
        },
        {
            "sha": "d01b06f08aaefc21f9549e24ed12702673eae72d",
            "filename": "deps/uv/ChangeLog",
            "status": "modified",
            "additions": 46,
            "deletions": 0,
            "changes": 46,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2FChangeLog",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2FChangeLog",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2FChangeLog?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -1,3 +1,49 @@\n+2018.09.22, Version 1.23.1 (Stable), d2282b3d67821dc53c907c2155fa8c5c6ce25180\n+\n+Changes since version 1.23.0:\n+\n+* unix,win: limit concurrent DNS calls to nthreads/2 (Anna Henningsen)\n+\n+* doc: add addaleax to maintainers (Anna Henningsen)\n+\n+* doc: add missing slash in stream.rst (Emil Bay)\n+\n+* unix,fs: use utimes & friends for uv_fs_utime (Jeremiah Senkpiel)\n+\n+* unix,fs: remove linux fallback from utimesat() (Jeremiah Senkpiel)\n+\n+* unix,fs: remove uv__utimesat() syscall fallback (Jeremiah Senkpiel)\n+\n+* doc: fix argument name in tcp.rts (Emil Bay)\n+\n+* doc: notes on running tests, benchmarks, tools (Jamie Davis)\n+\n+* linux: remove epoll syscall wrappers (Ben Noordhuis)\n+\n+* linux: drop code path for epoll_pwait-less kernels (Ben Noordhuis)\n+\n+* Partially revert \"win,code: remove GetQueuedCompletionStatus-based poller\"\n+  (Jameson Nash)\n+\n+* build: add compile for android arm64/x86/x86-64 (Andy Zhang)\n+\n+* doc: clarify that some remarks apply to windows (Bert Belder)\n+\n+* test: fix compiler warnings (Jamie Davis)\n+\n+* ibmi: return 0 from uv_resident_set_memory() (dmabupt)\n+\n+* win: fix uv_udp_recv_start() error translation (Ryan Liptak)\n+\n+* win,doc: improve uv_os_setpriority() documentation (Bartosz Sosnowski)\n+\n+* test: increase upper bound in condvar_5 (Jamie Davis)\n+\n+* win,tty: remove deadcode (Jameson Nash)\n+\n+* stream: autodetect direction (Jameson Nash)\n+\n+\n 2018.08.18, Version 1.23.0 (Stable), 7ebb26225f2eaae6db22f4ef34ce76fa16ff89ec\n \n Changes since version 1.22.0:"
        },
        {
            "sha": "543dc3cda7bce25300c06f401e6a6d892e76b20a",
            "filename": "deps/uv/MAINTAINERS.md",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2FMAINTAINERS.md",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2FMAINTAINERS.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2FMAINTAINERS.md?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -3,6 +3,7 @@\n \n libuv is currently managed by the following individuals:\n \n+* **Anna Henningsen** ([@addaleax](https://github.com/addaleax))\n * **Bartosz Sosnowski** ([@bzoz](https://github.com/bzoz))\n * **Ben Noordhuis** ([@bnoordhuis](https://github.com/bnoordhuis))\n   - GPG key: D77B 1E34 243F BAF0 5F8E  9CC3 4F55 C8C8 46AB 89B9 (pubkey-bnoordhuis)"
        },
        {
            "sha": "b24b722612edf34ec7e84a76833199bd06beb45a",
            "filename": "deps/uv/README.md",
            "status": "modified",
            "additions": 77,
            "deletions": 2,
            "changes": 79,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2FREADME.md",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2FREADME.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2FREADME.md?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -282,8 +282,31 @@ Make sure that you specify the architecture you wish to build for in the\n \n Run:\n \n+For arm\n+\n+```bash\n+$ source ./android-configure-arm NDK_PATH gyp [API_LEVEL]\n+$ make -C out\n+```\n+\n+or for arm64\n+\n+```bash\n+$ source ./android-configure-arm64 NDK_PATH gyp [API_LEVEL]\n+$ make -C out\n+```\n+\n+or for x86\n+\n+```bash\n+$ source ./android-configure-x86 NDK_PATH gyp [API_LEVEL]\n+$ make -C out\n+```\n+\n+or for x86_64\n+\n ```bash\n-$ source ./android-configure NDK_PATH gyp [API_LEVEL]\n+$ source ./android-configure-x86_64 NDK_PATH gyp [API_LEVEL]\n $ make -C out\n ```\n \n@@ -310,14 +333,66 @@ $ ninja -C out/Release\n \n ### Running tests\n \n-Run:\n+#### Build\n+\n+Build (includes tests):\n \n ```bash\n $ ./gyp_uv.py -f make\n $ make -C out\n+```\n+\n+#### Run all tests\n+\n+```bash\n $ ./out/Debug/run-tests\n ```\n \n+#### Run one test\n+\n+The list of all tests is in `test/test-list.h`.\n+\n+This invocation will cause the `run-tests` driver to fork and execute `TEST_NAME` in a child process:\n+\n+```bash\n+$ ./out/Debug/run-tests TEST_NAME\n+```\n+\n+This invocation will cause the `run-tests` driver to execute the test within the `run-tests` process:\n+\n+```bash\n+$ ./out/Debug/run-tests TEST_NAME TEST_NAME\n+```\n+\n+#### Debugging tools\n+\n+When running the test from within the `run-tests` process (`run-tests TEST_NAME TEST_NAME`), tools like gdb and valgrind work normally.\n+When running the test from a child of the `run-tests` process (`run-tests TEST_NAME`), use these tools in a fork-aware manner.\n+\n+##### Fork-aware gdb\n+\n+Use the [follow-fork-mode](https://sourceware.org/gdb/onlinedocs/gdb/Forks.html) setting:\n+\n+```\n+$ gdb --args out/Debug/run-tests TEST_NAME\n+\n+(gdb) set follow-fork-mode child\n+...\n+```\n+\n+##### Fork-aware valgrind\n+\n+Use the `--trace-children=yes` parameter:\n+\n+```bash\n+$ valgrind --trace-children=yes -v --tool=memcheck --leak-check=full --track-origins=yes --leak-resolution=high --show-reachable=yes --log-file=memcheck.log out/Debug/run-tests TEST_NAME\n+```\n+\n+### Running benchmarks\n+\n+See the section on running tests.\n+The benchmark driver is `out/Debug/run-benchmarks` and the benchmarks are listed in `test/benchmark-list.h`.\n+\n ## Supported Platforms\n \n Check the [SUPPORTED_PLATFORMS file](SUPPORTED_PLATFORMS.md)."
        },
        {
            "sha": "331fdd9ebcf9f92463c391ce7eb7dbce5ddd3b60",
            "filename": "deps/uv/android-configure-arm",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fandroid-configure-arm",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fandroid-configure-arm",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fandroid-configure-arm?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -1,6 +1,6 @@\n #!/bin/bash\n \n-export TOOLCHAIN=$PWD/android-toolchain\n+export TOOLCHAIN=$PWD/android-toolchain-arm\n mkdir -p $TOOLCHAIN\n API=${3:-24}\n $1/build/tools/make-standalone-toolchain.sh \\",
            "previous_filename": "deps/uv/android-configure"
        },
        {
            "sha": "1acd905d775fd925a1deb70140dd527412b7eb3d",
            "filename": "deps/uv/android-configure-arm64",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fandroid-configure-arm64",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fandroid-configure-arm64",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fandroid-configure-arm64?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -0,0 +1,23 @@\n+#!/bin/bash\n+\n+export TOOLCHAIN=$PWD/android-toolchain-arm64\n+mkdir -p $TOOLCHAIN\n+API=${3:-24}\n+$1/build/tools/make-standalone-toolchain.sh \\\n+    --toolchain=aarch64-linux-android-4.9 \\\n+    --arch=arm64 \\\n+    --install-dir=$TOOLCHAIN \\\n+    --platform=android-$API \\\n+    --force\n+export PATH=$TOOLCHAIN/bin:$PATH\n+export AR=aarch64-linux-android-ar\n+export CC=aarch64-linux-android-gcc\n+export CXX=aarch64-linux-android-g++\n+export LINK=aarch64-linux-android-g++\n+export PLATFORM=android\n+export CFLAGS=\"-D__ANDROID_API__=$API\"\n+\n+if [[ $2 == 'gyp' ]]\n+  then\n+    ./gyp_uv.py -Dtarget_arch=arm64 -DOS=android -f make-android\n+fi"
        },
        {
            "sha": "a149715f37547f03829614e3ca6c1f42795a7737",
            "filename": "deps/uv/android-configure-x86",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fandroid-configure-x86",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fandroid-configure-x86",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fandroid-configure-x86?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -0,0 +1,23 @@\n+#!/bin/bash\n+\n+export TOOLCHAIN=$PWD/android-toolchain-x86\n+mkdir -p $TOOLCHAIN\n+API=${3:-24}\n+$1/build/tools/make-standalone-toolchain.sh \\\n+    --toolchain=x86-4.9 \\\n+    --arch=x86 \\\n+    --install-dir=$TOOLCHAIN \\\n+    --platform=android-$API \\\n+    --force\n+export PATH=$TOOLCHAIN/bin:$PATH\n+export AR=i686-linux-android-ar\n+export CC=i686-linux-android-gcc\n+export CXX=i686-linux-android-g++\n+export LINK=i686-linux-android-g++\n+export PLATFORM=android\n+export CFLAGS=\"-D__ANDROID_API__=$API\"\n+\n+if [[ $2 == 'gyp' ]]\n+  then\n+    ./gyp_uv.py -Dtarget_arch=x86 -DOS=android -f make-android\n+fi"
        },
        {
            "sha": "ff045957f7138db2f62c4d717a7293bcc9cbcbe5",
            "filename": "deps/uv/android-configure-x86_64",
            "status": "added",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fandroid-configure-x86_64",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fandroid-configure-x86_64",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fandroid-configure-x86_64?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -0,0 +1,25 @@\n+#!/bin/bash\n+\n+export TOOLCHAIN=$PWD/android-toolchain-x86_64\n+mkdir -p $TOOLCHAIN\n+API=${3:-24}\n+$1/build/tools/make-standalone-toolchain.sh \\\n+    --toolchain=x86_64-4.9 \\\n+    --arch=x86_64 \\\n+    --install-dir=$TOOLCHAIN \\\n+    --platform=android-$API \\\n+    --force\n+export PATH=$TOOLCHAIN/bin:$PATH\n+export AR=x86_64-linux-android-ar\n+export CC=x86_64-linux-android-gcc\n+export CXX=x86_64-linux-android-g++\n+export LINK=x86_64-linux-android-g++\n+export PLATFORM=android\n+export CFLAGS=\"-D__ANDROID_API__=$API -fPIC\"\n+export CXXFLAGS=\"-D__ANDROID_API__=$API -fPIC\"\n+export LDFLAGS=\"-fPIC\"\n+\n+if [[ $2 == 'gyp' ]]\n+  then\n+    ./gyp_uv.py -Dtarget_arch=x86_64 -DOS=android -f make-android\n+fi"
        },
        {
            "sha": "ce307b1d70677cdc4eb3731caf61a4a214fe7c54",
            "filename": "deps/uv/configure.ac",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fconfigure.ac",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fconfigure.ac",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fconfigure.ac?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -13,7 +13,7 @@\n # OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n \n AC_PREREQ(2.57)\n-AC_INIT([libuv], [1.23.0], [https://github.com/libuv/libuv/issues])\n+AC_INIT([libuv], [1.23.1], [https://github.com/libuv/libuv/issues])\n AC_CONFIG_MACRO_DIR([m4])\n m4_include([m4/libuv-extra-automake-flags.m4])\n m4_include([m4/as_case.m4])"
        },
        {
            "sha": "cf4a7895cd147b51f382a8ba4649ad13408b26b5",
            "filename": "deps/uv/docs/src/misc.rst",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Fmisc.rst",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Fmisc.rst",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fdocs%2Fsrc%2Fmisc.rst?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -544,4 +544,8 @@ API\n         process priority, the result will equal one of the `UV_PRIORITY`\n         constants, and not necessarily the exact value of `priority`.\n \n+    .. note::\n+        On Windows, setting `PRIORITY_HIGHEST` will only work for elevated user,\n+        for others it will be silently reduced to `PRIORITY_HIGH`.\n+\n     .. versionadded:: 1.23.0"
        },
        {
            "sha": "f52b64706ab89011d0ea5bc978f265f3f67aa875",
            "filename": "deps/uv/docs/src/signal.rst",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Fsignal.rst",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Fsignal.rst",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fdocs%2Fsrc%2Fsignal.rst?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -17,12 +17,12 @@ Reception of some signals is emulated on Windows:\n   program is given approximately 10 seconds to perform cleanup. After that\n   Windows will unconditionally terminate it.\n \n-Watchers for other signals can be successfully created, but these signals\n-are never received. These signals are: `SIGILL`, `SIGABRT`, `SIGFPE`, `SIGSEGV`,\n-`SIGTERM` and `SIGKILL.`\n+* Watchers for other signals can be successfully created, but these signals\n+  are never received. These signals are: `SIGILL`, `SIGABRT`, `SIGFPE`, `SIGSEGV`,\n+  `SIGTERM` and `SIGKILL.`\n \n-Calls to raise() or abort() to programmatically raise a signal are\n-not detected by libuv; these will not trigger a signal watcher.\n+* Calls to raise() or abort() to programmatically raise a signal are\n+  not detected by libuv; these will not trigger a signal watcher.\n \n .. note::\n     On Linux SIGRT0 and SIGRT1 (signals 32 and 33) are used by the NPTL pthreads library to"
        },
        {
            "sha": "6a704367b1b36161beccfb6c1e5486d5589162d9",
            "filename": "deps/uv/docs/src/stream.rst",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Fstream.rst",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Fstream.rst",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fdocs%2Fsrc%2Fstream.rst?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -45,7 +45,7 @@ Data types\n         `nread` might be 0, which does *not* indicate an error or EOF. This\n         is equivalent to ``EAGAIN`` or ``EWOULDBLOCK`` under ``read(2)``.\n \n-    The callee is responsible for stopping closing the stream when an error happens\n+    The callee is responsible for stopping/closing the stream when an error happens\n     by calling :c:func:`uv_read_stop` or :c:func:`uv_close`. Trying to read\n     from the stream again is undefined.\n "
        },
        {
            "sha": "d20a6362af94d522c35cb3941cb440eeb117e70d",
            "filename": "deps/uv/docs/src/tcp.rst",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Ftcp.rst",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Ftcp.rst",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fdocs%2Fsrc%2Ftcp.rst?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -86,13 +86,13 @@ API\n \n .. c:function:: int uv_tcp_getsockname(const uv_tcp_t* handle, struct sockaddr* name, int* namelen)\n \n-    Get the current address to which the handle is bound. `addr` must point to\n+    Get the current address to which the handle is bound. `name` must point to\n     a valid and big enough chunk of memory, ``struct sockaddr_storage`` is\n     recommended for IPv4 and IPv6 support.\n \n .. c:function:: int uv_tcp_getpeername(const uv_tcp_t* handle, struct sockaddr* name, int* namelen)\n \n-    Get the address of the peer connected to the handle. `addr` must point to\n+    Get the address of the peer connected to the handle. `name` must point to\n     a valid and big enough chunk of memory, ``struct sockaddr_storage`` is\n     recommended for IPv4 and IPv6 support.\n "
        },
        {
            "sha": "9889a0a0b6465b3e53e34246cfe865be6f2e5c6b",
            "filename": "deps/uv/docs/src/tty.rst",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Ftty.rst",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fdocs%2Fsrc%2Ftty.rst",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fdocs%2Fsrc%2Ftty.rst?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -46,7 +46,7 @@ N/A\n API\n ---\n \n-.. c:function:: int uv_tty_init(uv_loop_t* loop, uv_tty_t* handle, uv_file fd, int readable)\n+.. c:function:: int uv_tty_init(uv_loop_t* loop, uv_tty_t* handle, uv_file fd, int unused)\n \n     Initialize a new TTY stream with the given file descriptor. Usually the\n     file descriptor will be:\n@@ -55,9 +55,6 @@ API\n     * 1 = stdout\n     * 2 = stderr\n \n-    `readable`, specifies if you plan on calling :c:func:`uv_read_start` with\n-    this stream. stdin is readable, stdout is not.\n-\n     On Unix this function will determine the path of the fd of the terminal\n     using :man:`ttyname_r(3)`, open it, and use it if the passed file descriptor\n     refers to a TTY. This lets libuv put the tty in non-blocking mode without\n@@ -67,8 +64,10 @@ API\n     ioctl TIOCGPTN or TIOCPTYGNAME, for instance OpenBSD and Solaris.\n \n     .. note::\n-        If reopening the TTY fails, libuv falls back to blocking writes for\n-        non-readable TTY streams.\n+        If reopening the TTY fails, libuv falls back to blocking writes.\n+\n+    .. versionchanged:: 1.23.1: the `readable` parameter is now unused and ignored.\n+                        The correct value will now be auto-detected from the kernel.\n \n     .. versionchanged:: 1.9.0: the path of the TTY is determined by\n                         :man:`ttyname_r(3)`. In earlier versions libuv opened"
        },
        {
            "sha": "9db3d130cd6ce0476b1514ae021e5ed1494f9804",
            "filename": "deps/uv/include/uv/version.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Finclude%2Fuv%2Fversion.h",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Finclude%2Fuv%2Fversion.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Finclude%2Fuv%2Fversion.h?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -32,7 +32,7 @@\n \n #define UV_VERSION_MAJOR 1\n #define UV_VERSION_MINOR 23\n-#define UV_VERSION_PATCH 0\n+#define UV_VERSION_PATCH 1\n #define UV_VERSION_IS_RELEASE 1\n #define UV_VERSION_SUFFIX \"\"\n "
        },
        {
            "sha": "4875f27beb9dd6718a986d6fccf53c16b3e86edc",
            "filename": "deps/uv/src/threadpool.c",
            "status": "modified",
            "additions": 73,
            "deletions": 13,
            "changes": 86,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fthreadpool.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fthreadpool.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fthreadpool.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -33,12 +33,18 @@ static uv_once_t once = UV_ONCE_INIT;\n static uv_cond_t cond;\n static uv_mutex_t mutex;\n static unsigned int idle_threads;\n+static unsigned int slow_io_work_running;\n static unsigned int nthreads;\n static uv_thread_t* threads;\n static uv_thread_t default_threads[4];\n static QUEUE exit_message;\n static QUEUE wq;\n+static QUEUE run_slow_work_message;\n+static QUEUE slow_io_pending_wq;\n \n+static unsigned int slow_work_thread_threshold(void) {\n+  return (nthreads + 1) / 2;\n+}\n \n static void uv__cancelled(struct uv__work* w) {\n   abort();\n@@ -51,38 +57,73 @@ static void uv__cancelled(struct uv__work* w) {\n static void worker(void* arg) {\n   struct uv__work* w;\n   QUEUE* q;\n+  int is_slow_work;\n \n   uv_sem_post((uv_sem_t*) arg);\n   arg = NULL;\n \n   for (;;) {\n     uv_mutex_lock(&mutex);\n \n-    while (QUEUE_EMPTY(&wq)) {\n+  wait_for_work:\n+    /* Keep waiting while either no work is present or only slow I/O\n+       and we're at the threshold for that. */\n+    while (QUEUE_EMPTY(&wq) ||\n+           (QUEUE_HEAD(&wq) == &run_slow_work_message &&\n+            QUEUE_NEXT(&run_slow_work_message) == &wq &&\n+            slow_io_work_running >= slow_work_thread_threshold())) {\n       idle_threads += 1;\n       uv_cond_wait(&cond, &mutex);\n       idle_threads -= 1;\n     }\n \n     q = QUEUE_HEAD(&wq);\n-\n-    if (q == &exit_message)\n+    if (q == &exit_message) {\n       uv_cond_signal(&cond);\n-    else {\n+      uv_mutex_unlock(&mutex);\n+      break;\n+    }\n+\n+    QUEUE_REMOVE(q);\n+    QUEUE_INIT(q);  /* Signal uv_cancel() that the work req is executing. */\n+\n+    is_slow_work = 0;\n+    if (q == &run_slow_work_message) {\n+      /* If we're at the slow I/O threshold, re-schedule until after all\n+         other work in the queue is done. */\n+      if (slow_io_work_running >= slow_work_thread_threshold()) {\n+        QUEUE_INSERT_TAIL(&wq, q);\n+        goto wait_for_work;\n+      }\n+\n+      /* If we encountered a request to run slow I/O work but there is none\n+         to run, that means it's cancelled => Start over. */\n+      if (QUEUE_EMPTY(&slow_io_pending_wq))\n+        goto wait_for_work;\n+\n+      is_slow_work = 1;\n+      slow_io_work_running++;\n+\n+      q = QUEUE_HEAD(&slow_io_pending_wq);\n       QUEUE_REMOVE(q);\n-      QUEUE_INIT(q);  /* Signal uv_cancel() that the work req is\n-                             executing. */\n+      QUEUE_INIT(q);\n+\n+      /* If there is more slow I/O work, schedule it to be run as well. */\n+      if (!QUEUE_EMPTY(&slow_io_pending_wq)) {\n+        QUEUE_INSERT_TAIL(&wq, &run_slow_work_message);\n+        if (idle_threads > 0)\n+          uv_cond_signal(&cond);\n+      }\n     }\n \n     uv_mutex_unlock(&mutex);\n \n-    if (q == &exit_message)\n-      break;\n-\n     w = QUEUE_DATA(q, struct uv__work, wq);\n     w->work(w);\n \n     uv_mutex_lock(&w->loop->wq_mutex);\n+    if (is_slow_work)\n+      slow_io_work_running--;\n     w->work = NULL;  /* Signal uv_cancel() that the work req is done\n                         executing. */\n     QUEUE_INSERT_TAIL(&w->loop->wq, &w->wq);\n@@ -92,8 +133,20 @@ static void worker(void* arg) {\n }\n \n \n-static void post(QUEUE* q) {\n+static void post(QUEUE* q, enum uv__work_kind kind) {\n   uv_mutex_lock(&mutex);\n+  if (kind == UV__WORK_SLOW_IO) {\n+    /* Insert into a separate queue. */\n+    QUEUE_INSERT_TAIL(&slow_io_pending_wq, q);\n+    if (!QUEUE_EMPTY(&run_slow_work_message)) {\n+      /* Running slow I/O tasks is already scheduled => Nothing to do here.\n+         The worker that runs said other task will schedule this one as well. */\n+      uv_mutex_unlock(&mutex);\n+      return;\n+    }\n+    q = &run_slow_work_message;\n+  }\n+\n   QUEUE_INSERT_TAIL(&wq, q);\n   if (idle_threads > 0)\n     uv_cond_signal(&cond);\n@@ -108,7 +161,7 @@ UV_DESTRUCTOR(static void cleanup(void)) {\n   if (nthreads == 0)\n     return;\n \n-  post(&exit_message);\n+  post(&exit_message, UV__WORK_CPU);\n \n   for (i = 0; i < nthreads; i++)\n     if (uv_thread_join(threads + i))\n@@ -156,6 +209,8 @@ static void init_threads(void) {\n     abort();\n \n   QUEUE_INIT(&wq);\n+  QUEUE_INIT(&slow_io_pending_wq);\n+  QUEUE_INIT(&run_slow_work_message);\n \n   if (uv_sem_init(&sem, 0))\n     abort();\n@@ -194,13 +249,14 @@ static void init_once(void) {\n \n void uv__work_submit(uv_loop_t* loop,\n                      struct uv__work* w,\n+                     enum uv__work_kind kind,\n                      void (*work)(struct uv__work* w),\n                      void (*done)(struct uv__work* w, int status)) {\n   uv_once(&once, init_once);\n   w->loop = loop;\n   w->work = work;\n   w->done = done;\n-  post(&w->wq);\n+  post(&w->wq, kind);\n }\n \n \n@@ -284,7 +340,11 @@ int uv_queue_work(uv_loop_t* loop,\n   req->loop = loop;\n   req->work_cb = work_cb;\n   req->after_work_cb = after_work_cb;\n-  uv__work_submit(loop, &req->work_req, uv__queue_work, uv__queue_done);\n+  uv__work_submit(loop,\n+                  &req->work_req,\n+                  UV__WORK_CPU,\n+                  uv__queue_work,\n+                  uv__queue_done);\n   return 0;\n }\n "
        },
        {
            "sha": "c3f7951f11bf01c7498fa3995183c211193f513a",
            "filename": "deps/uv/src/unix/fs.c",
            "status": "modified",
            "additions": 51,
            "deletions": 55,
            "changes": 106,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Ffs.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Ffs.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Ffs.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -43,7 +43,6 @@\n #include <pthread.h>\n #include <unistd.h>\n #include <fcntl.h>\n-#include <utime.h>\n #include <poll.h>\n \n #if defined(__DragonFly__)        ||                                      \\\n@@ -67,6 +66,10 @@\n # define FICLONE _IOW(0x94, 9, int)\n #endif\n \n+#if defined(_AIX) && !defined(_AIX71)\n+# include <utime.h>\n+#endif\n+\n #define INIT(subtype)                                                         \\\n   do {                                                                        \\\n     if (req == NULL)                                                          \\\n@@ -120,7 +123,11 @@\n   do {                                                                        \\\n     if (cb != NULL) {                                                         \\\n       uv__req_register(loop, req);                                            \\\n-      uv__work_submit(loop, &req->work_req, uv__fs_work, uv__fs_done);        \\\n+      uv__work_submit(loop,                                                   \\\n+                      &req->work_req,                                         \\\n+                      UV__WORK_FAST_IO,                                       \\\n+                      uv__fs_work,                                            \\\n+                      uv__fs_done);                                           \\\n       return 0;                                                               \\\n     }                                                                         \\\n     else {                                                                    \\\n@@ -165,59 +172,17 @@ static ssize_t uv__fs_fdatasync(uv_fs_t* req) {\n \n \n static ssize_t uv__fs_futime(uv_fs_t* req) {\n-#if defined(__linux__)\n+#if defined(__linux__)                                                        \\\n+    || defined(_AIX71)\n   /* utimesat() has nanosecond resolution but we stick to microseconds\n    * for the sake of consistency with other platforms.\n    */\n-  static int no_utimesat;\n   struct timespec ts[2];\n-  struct timeval tv[2];\n-  char path[sizeof(\"/proc/self/fd/\") + 3 * sizeof(int)];\n-  int r;\n-\n-  if (no_utimesat)\n-    goto skip;\n-\n   ts[0].tv_sec  = req->atime;\n   ts[0].tv_nsec = (uint64_t)(req->atime * 1000000) % 1000000 * 1000;\n   ts[1].tv_sec  = req->mtime;\n   ts[1].tv_nsec = (uint64_t)(req->mtime * 1000000) % 1000000 * 1000;\n-\n-  r = uv__utimesat(req->file, NULL, ts, 0);\n-  if (r == 0)\n-    return r;\n-\n-  if (errno != ENOSYS)\n-    return r;\n-\n-  no_utimesat = 1;\n-\n-skip:\n-\n-  tv[0].tv_sec  = req->atime;\n-  tv[0].tv_usec = (uint64_t)(req->atime * 1000000) % 1000000;\n-  tv[1].tv_sec  = req->mtime;\n-  tv[1].tv_usec = (uint64_t)(req->mtime * 1000000) % 1000000;\n-  snprintf(path, sizeof(path), \"/proc/self/fd/%d\", (int) req->file);\n-\n-  r = utimes(path, tv);\n-  if (r == 0)\n-    return r;\n-\n-  switch (errno) {\n-  case ENOENT:\n-    if (fcntl(req->file, F_GETFL) == -1 && errno == EBADF)\n-      break;\n-    /* Fall through. */\n-\n-  case EACCES:\n-  case ENOTDIR:\n-    errno = ENOSYS;\n-    break;\n-  }\n-\n-  return r;\n-\n+  return futimens(req->file, ts);\n #elif defined(__APPLE__)                                                      \\\n     || defined(__DragonFly__)                                                 \\\n     || defined(__FreeBSD__)                                                   \\\n@@ -235,13 +200,6 @@ static ssize_t uv__fs_futime(uv_fs_t* req) {\n # else\n   return futimes(req->file, tv);\n # endif\n-#elif defined(_AIX71)\n-  struct timespec ts[2];\n-  ts[0].tv_sec  = req->atime;\n-  ts[0].tv_nsec = (uint64_t)(req->atime * 1000000) % 1000000 * 1000;\n-  ts[1].tv_sec  = req->mtime;\n-  ts[1].tv_nsec = (uint64_t)(req->mtime * 1000000) % 1000000 * 1000;\n-  return futimens(req->file, ts);\n #elif defined(__MVS__)\n   attrib_t atr;\n   memset(&atr, 0, sizeof(atr));\n@@ -698,10 +656,48 @@ static ssize_t uv__fs_sendfile(uv_fs_t* req) {\n \n \n static ssize_t uv__fs_utime(uv_fs_t* req) {\n+#if defined(__linux__)                                                         \\\n+    || defined(_AIX71)                                                         \\\n+    || defined(__sun)\n+  /* utimesat() has nanosecond resolution but we stick to microseconds\n+   * for the sake of consistency with other platforms.\n+   */\n+  struct timespec ts[2];\n+  ts[0].tv_sec  = req->atime;\n+  ts[0].tv_nsec = (uint64_t)(req->atime * 1000000) % 1000000 * 1000;\n+  ts[1].tv_sec  = req->mtime;\n+  ts[1].tv_nsec = (uint64_t)(req->mtime * 1000000) % 1000000 * 1000;\n+  return utimensat(AT_FDCWD, req->path, ts, 0);\n+#elif defined(__APPLE__)                                                      \\\n+    || defined(__DragonFly__)                                                 \\\n+    || defined(__FreeBSD__)                                                   \\\n+    || defined(__FreeBSD_kernel__)                                            \\\n+    || defined(__NetBSD__)                                                    \\\n+    || defined(__OpenBSD__)\n+  struct timeval tv[2];\n+  tv[0].tv_sec  = req->atime;\n+  tv[0].tv_usec = (uint64_t)(req->atime * 1000000) % 1000000;\n+  tv[1].tv_sec  = req->mtime;\n+  tv[1].tv_usec = (uint64_t)(req->mtime * 1000000) % 1000000;\n+  return utimes(req->path, tv);\n+#elif defined(_AIX)                                                           \\\n+    && !defined(_AIX71)\n   struct utimbuf buf;\n   buf.actime = req->atime;\n   buf.modtime = req->mtime;\n-  return utime(req->path, &buf); /* TODO use utimes() where available */\n+  return utime(req->path, &buf);\n+#elif defined(__MVS__)\n+  attrib_t atr;\n+  memset(&atr, 0, sizeof(atr));\n+  atr.att_mtimechg = 1;\n+  atr.att_atimechg = 1;\n+  atr.att_mtime = req->mtime;\n+  atr.att_atime = req->atime;\n+  return __lchattr(req->path, &atr, sizeof(atr));\n+#else\n+  errno = ENOSYS;\n+  return -1;\n+#endif\n }\n \n "
        },
        {
            "sha": "25827c1feeb6b380561a0c1e52ee749fdd4b39d3",
            "filename": "deps/uv/src/unix/getaddrinfo.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fgetaddrinfo.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fgetaddrinfo.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fgetaddrinfo.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -186,6 +186,7 @@ int uv_getaddrinfo(uv_loop_t* loop,\n   if (cb) {\n     uv__work_submit(loop,\n                     &req->work_req,\n+                    UV__WORK_SLOW_IO,\n                     uv__getaddrinfo_work,\n                     uv__getaddrinfo_done);\n     return 0;"
        },
        {
            "sha": "991002a67d70727ac3184a2629a00156ed57ff20",
            "filename": "deps/uv/src/unix/getnameinfo.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fgetnameinfo.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fgetnameinfo.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fgetnameinfo.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -109,6 +109,7 @@ int uv_getnameinfo(uv_loop_t* loop,\n   if (getnameinfo_cb) {\n     uv__work_submit(loop,\n                     &req->work_req,\n+                    UV__WORK_SLOW_IO,\n                     uv__getnameinfo_work,\n                     uv__getnameinfo_done);\n     return 0;"
        },
        {
            "sha": "b1ab549c23f4b91527cf17d8cb13cff70aefe263",
            "filename": "deps/uv/src/unix/ibmi.c",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fibmi.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fibmi.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fibmi.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -72,7 +72,8 @@ void uv_loadavg(double avg[3]) {\n \n \n int uv_resident_set_memory(size_t* rss) {\n-  return UV_ENOSYS;\n+  *rss = 0;\n+  return 0;\n }\n \n "
        },
        {
            "sha": "124a0a57f4b882a7ba338a8e7a2d9a6b409a1971",
            "filename": "deps/uv/src/unix/linux-core.c",
            "status": "modified",
            "additions": 33,
            "deletions": 59,
            "changes": 92,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Flinux-core.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Flinux-core.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Flinux-core.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -20,7 +20,7 @@\n \n /* We lean on the fact that POLL{IN,OUT,ERR,HUP} correspond with their\n  * EPOLL* counterparts.  We use the POLL* variants in this file because that\n- * is what libuv uses elsewhere and it avoids a dependency on <sys/epoll.h>.\n+ * is what libuv uses elsewhere.\n  */\n \n #include \"uv.h\"\n@@ -34,6 +34,7 @@\n #include <errno.h>\n \n #include <net/if.h>\n+#include <sys/epoll.h>\n #include <sys/param.h>\n #include <sys/prctl.h>\n #include <sys/sysinfo.h>\n@@ -84,13 +85,13 @@ static unsigned long read_cpufreq(unsigned int cpunum);\n int uv__platform_loop_init(uv_loop_t* loop) {\n   int fd;\n \n-  fd = uv__epoll_create1(UV__EPOLL_CLOEXEC);\n+  fd = epoll_create1(EPOLL_CLOEXEC);\n \n   /* epoll_create1() can fail either because it's not implemented (old kernel)\n    * or because it doesn't understand the EPOLL_CLOEXEC flag.\n    */\n   if (fd == -1 && (errno == ENOSYS || errno == EINVAL)) {\n-    fd = uv__epoll_create(256);\n+    fd = epoll_create(256);\n \n     if (fd != -1)\n       uv__cloexec(fd, 1);\n@@ -134,20 +135,20 @@ void uv__platform_loop_delete(uv_loop_t* loop) {\n \n \n void uv__platform_invalidate_fd(uv_loop_t* loop, int fd) {\n-  struct uv__epoll_event* events;\n-  struct uv__epoll_event dummy;\n+  struct epoll_event* events;\n+  struct epoll_event dummy;\n   uintptr_t i;\n   uintptr_t nfds;\n \n   assert(loop->watchers != NULL);\n \n-  events = (struct uv__epoll_event*) loop->watchers[loop->nwatchers];\n+  events = (struct epoll_event*) loop->watchers[loop->nwatchers];\n   nfds = (uintptr_t) loop->watchers[loop->nwatchers + 1];\n   if (events != NULL)\n     /* Invalidate events with same file descriptor */\n     for (i = 0; i < nfds; i++)\n-      if ((int) events[i].data == fd)\n-        events[i].data = -1;\n+      if (events[i].data.fd == fd)\n+        events[i].data.fd = -1;\n \n   /* Remove the file descriptor from the epoll.\n    * This avoids a problem where the same file description remains open\n@@ -160,25 +161,25 @@ void uv__platform_invalidate_fd(uv_loop_t* loop, int fd) {\n      * has the EPOLLWAKEUP flag set generates spurious audit syslog warnings.\n      */\n     memset(&dummy, 0, sizeof(dummy));\n-    uv__epoll_ctl(loop->backend_fd, UV__EPOLL_CTL_DEL, fd, &dummy);\n+    epoll_ctl(loop->backend_fd, EPOLL_CTL_DEL, fd, &dummy);\n   }\n }\n \n \n int uv__io_check_fd(uv_loop_t* loop, int fd) {\n-  struct uv__epoll_event e;\n+  struct epoll_event e;\n   int rc;\n \n   e.events = POLLIN;\n-  e.data = -1;\n+  e.data.fd = -1;\n \n   rc = 0;\n-  if (uv__epoll_ctl(loop->backend_fd, UV__EPOLL_CTL_ADD, fd, &e))\n+  if (epoll_ctl(loop->backend_fd, EPOLL_CTL_ADD, fd, &e))\n     if (errno != EEXIST)\n       rc = UV__ERR(errno);\n \n   if (rc == 0)\n-    if (uv__epoll_ctl(loop->backend_fd, UV__EPOLL_CTL_DEL, fd, &e))\n+    if (epoll_ctl(loop->backend_fd, EPOLL_CTL_DEL, fd, &e))\n       abort();\n \n   return rc;\n@@ -195,16 +196,14 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n    * that being the largest value I have seen in the wild (and only once.)\n    */\n   static const int max_safe_timeout = 1789569;\n-  static int no_epoll_pwait;\n-  static int no_epoll_wait;\n-  struct uv__epoll_event events[1024];\n-  struct uv__epoll_event* pe;\n-  struct uv__epoll_event e;\n+  struct epoll_event events[1024];\n+  struct epoll_event* pe;\n+  struct epoll_event e;\n   int real_timeout;\n   QUEUE* q;\n   uv__io_t* w;\n   sigset_t sigset;\n-  uint64_t sigmask;\n+  sigset_t* psigset;\n   uint64_t base;\n   int have_signals;\n   int nevents;\n@@ -230,35 +229,35 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n     assert(w->fd < (int) loop->nwatchers);\n \n     e.events = w->pevents;\n-    e.data = w->fd;\n+    e.data.fd = w->fd;\n \n     if (w->events == 0)\n-      op = UV__EPOLL_CTL_ADD;\n+      op = EPOLL_CTL_ADD;\n     else\n-      op = UV__EPOLL_CTL_MOD;\n+      op = EPOLL_CTL_MOD;\n \n     /* XXX Future optimization: do EPOLL_CTL_MOD lazily if we stop watching\n      * events, skip the syscall and squelch the events after epoll_wait().\n      */\n-    if (uv__epoll_ctl(loop->backend_fd, op, w->fd, &e)) {\n+    if (epoll_ctl(loop->backend_fd, op, w->fd, &e)) {\n       if (errno != EEXIST)\n         abort();\n \n-      assert(op == UV__EPOLL_CTL_ADD);\n+      assert(op == EPOLL_CTL_ADD);\n \n       /* We've reactivated a file descriptor that's been watched before. */\n-      if (uv__epoll_ctl(loop->backend_fd, UV__EPOLL_CTL_MOD, w->fd, &e))\n+      if (epoll_ctl(loop->backend_fd, EPOLL_CTL_MOD, w->fd, &e))\n         abort();\n     }\n \n     w->events = w->pevents;\n   }\n \n-  sigmask = 0;\n+  psigset = NULL;\n   if (loop->flags & UV_LOOP_BLOCK_SIGPROF) {\n     sigemptyset(&sigset);\n     sigaddset(&sigset, SIGPROF);\n-    sigmask |= 1 << (SIGPROF - 1);\n+    psigset = &sigset;\n   }\n \n   assert(timeout >= -1);\n@@ -273,30 +272,11 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n     if (sizeof(int32_t) == sizeof(long) && timeout >= max_safe_timeout)\n       timeout = max_safe_timeout;\n \n-    if (sigmask != 0 && no_epoll_pwait != 0)\n-      if (pthread_sigmask(SIG_BLOCK, &sigset, NULL))\n-        abort();\n-\n-    if (no_epoll_wait != 0 || (sigmask != 0 && no_epoll_pwait == 0)) {\n-      nfds = uv__epoll_pwait(loop->backend_fd,\n-                             events,\n-                             ARRAY_SIZE(events),\n-                             timeout,\n-                             sigmask);\n-      if (nfds == -1 && errno == ENOSYS)\n-        no_epoll_pwait = 1;\n-    } else {\n-      nfds = uv__epoll_wait(loop->backend_fd,\n-                            events,\n-                            ARRAY_SIZE(events),\n-                            timeout);\n-      if (nfds == -1 && errno == ENOSYS)\n-        no_epoll_wait = 1;\n-    }\n-\n-    if (sigmask != 0 && no_epoll_pwait != 0)\n-      if (pthread_sigmask(SIG_UNBLOCK, &sigset, NULL))\n-        abort();\n+    nfds = epoll_pwait(loop->backend_fd,\n+                       events,\n+                       ARRAY_SIZE(events),\n+                       timeout,\n+                       psigset);\n \n     /* Update loop->time unconditionally. It's tempting to skip the update when\n      * timeout == 0 (i.e. non-blocking poll) but there is no guarantee that the\n@@ -317,12 +297,6 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n     }\n \n     if (nfds == -1) {\n-      if (errno == ENOSYS) {\n-        /* epoll_wait() or epoll_pwait() failed, try the other system call. */\n-        assert(no_epoll_wait == 0 || no_epoll_pwait == 0);\n-        continue;\n-      }\n-\n       if (errno != EINTR)\n         abort();\n \n@@ -344,7 +318,7 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n     loop->watchers[loop->nwatchers + 1] = (void*) (uintptr_t) nfds;\n     for (i = 0; i < nfds; i++) {\n       pe = events + i;\n-      fd = pe->data;\n+      fd = pe->data.fd;\n \n       /* Skip invalidated events, see uv__platform_invalidate_fd */\n       if (fd == -1)\n@@ -361,7 +335,7 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n          * Ignore all errors because we may be racing with another thread\n          * when the file descriptor is closed.\n          */\n-        uv__epoll_ctl(loop->backend_fd, UV__EPOLL_CTL_DEL, fd, pe);\n+        epoll_ctl(loop->backend_fd, EPOLL_CTL_DEL, fd, pe);\n         continue;\n       }\n "
        },
        {
            "sha": "bfd7544879338852b4473161760482c5b30470fd",
            "filename": "deps/uv/src/unix/linux-syscalls.c",
            "status": "modified",
            "additions": 0,
            "deletions": 133,
            "changes": 133,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Flinux-syscalls.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Flinux-syscalls.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Flinux-syscalls.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -77,56 +77,6 @@\n # endif\n #endif /* __NR_eventfd2 */\n \n-#ifndef __NR_epoll_create\n-# if defined(__x86_64__)\n-#  define __NR_epoll_create 213\n-# elif defined(__i386__)\n-#  define __NR_epoll_create 254\n-# elif defined(__arm__)\n-#  define __NR_epoll_create (UV_SYSCALL_BASE + 250)\n-# endif\n-#endif /* __NR_epoll_create */\n-\n-#ifndef __NR_epoll_create1\n-# if defined(__x86_64__)\n-#  define __NR_epoll_create1 291\n-# elif defined(__i386__)\n-#  define __NR_epoll_create1 329\n-# elif defined(__arm__)\n-#  define __NR_epoll_create1 (UV_SYSCALL_BASE + 357)\n-# endif\n-#endif /* __NR_epoll_create1 */\n-\n-#ifndef __NR_epoll_ctl\n-# if defined(__x86_64__)\n-#  define __NR_epoll_ctl 233 /* used to be 214 */\n-# elif defined(__i386__)\n-#  define __NR_epoll_ctl 255\n-# elif defined(__arm__)\n-#  define __NR_epoll_ctl (UV_SYSCALL_BASE + 251)\n-# endif\n-#endif /* __NR_epoll_ctl */\n-\n-#ifndef __NR_epoll_wait\n-# if defined(__x86_64__)\n-#  define __NR_epoll_wait 232 /* used to be 215 */\n-# elif defined(__i386__)\n-#  define __NR_epoll_wait 256\n-# elif defined(__arm__)\n-#  define __NR_epoll_wait (UV_SYSCALL_BASE + 252)\n-# endif\n-#endif /* __NR_epoll_wait */\n-\n-#ifndef __NR_epoll_pwait\n-# if defined(__x86_64__)\n-#  define __NR_epoll_pwait 281\n-# elif defined(__i386__)\n-#  define __NR_epoll_pwait 319\n-# elif defined(__arm__)\n-#  define __NR_epoll_pwait (UV_SYSCALL_BASE + 346)\n-# endif\n-#endif /* __NR_epoll_pwait */\n-\n #ifndef __NR_inotify_init\n # if defined(__x86_64__)\n #  define __NR_inotify_init 253\n@@ -285,76 +235,6 @@ int uv__eventfd2(unsigned int count, int flags) {\n }\n \n \n-int uv__epoll_create(int size) {\n-#if defined(__NR_epoll_create)\n-  return syscall(__NR_epoll_create, size);\n-#else\n-  return errno = ENOSYS, -1;\n-#endif\n-}\n-\n-\n-int uv__epoll_create1(int flags) {\n-#if defined(__NR_epoll_create1)\n-  return syscall(__NR_epoll_create1, flags);\n-#else\n-  return errno = ENOSYS, -1;\n-#endif\n-}\n-\n-\n-int uv__epoll_ctl(int epfd, int op, int fd, struct uv__epoll_event* events) {\n-#if defined(__NR_epoll_ctl)\n-  return syscall(__NR_epoll_ctl, epfd, op, fd, events);\n-#else\n-  return errno = ENOSYS, -1;\n-#endif\n-}\n-\n-\n-int uv__epoll_wait(int epfd,\n-                   struct uv__epoll_event* events,\n-                   int nevents,\n-                   int timeout) {\n-#if defined(__NR_epoll_wait)\n-  int result;\n-  result = syscall(__NR_epoll_wait, epfd, events, nevents, timeout);\n-#if MSAN_ACTIVE\n-  if (result > 0)\n-    __msan_unpoison(events, sizeof(events[0]) * result);\n-#endif\n-  return result;\n-#else\n-  return errno = ENOSYS, -1;\n-#endif\n-}\n-\n-\n-int uv__epoll_pwait(int epfd,\n-                    struct uv__epoll_event* events,\n-                    int nevents,\n-                    int timeout,\n-                    uint64_t sigmask) {\n-#if defined(__NR_epoll_pwait)\n-  int result;\n-  result = syscall(__NR_epoll_pwait,\n-                   epfd,\n-                   events,\n-                   nevents,\n-                   timeout,\n-                   &sigmask,\n-                   sizeof(sigmask));\n-#if MSAN_ACTIVE\n-  if (result > 0)\n-    __msan_unpoison(events, sizeof(events[0]) * result);\n-#endif\n-  return result;\n-#else\n-  return errno = ENOSYS, -1;\n-#endif\n-}\n-\n-\n int uv__inotify_init(void) {\n #if defined(__NR_inotify_init)\n   return syscall(__NR_inotify_init);\n@@ -431,19 +311,6 @@ int uv__recvmmsg(int fd,\n }\n \n \n-int uv__utimesat(int dirfd,\n-                 const char* path,\n-                 const struct timespec times[2],\n-                 int flags)\n-{\n-#if defined(__NR_utimensat)\n-  return syscall(__NR_utimensat, dirfd, path, times, flags);\n-#else\n-  return errno = ENOSYS, -1;\n-#endif\n-}\n-\n-\n ssize_t uv__preadv(int fd, const struct iovec *iov, int iovcnt, int64_t offset) {\n #if defined(__NR_preadv)\n   return syscall(__NR_preadv, fd, iov, iovcnt, (long)offset, (long)(offset >> 32));"
        },
        {
            "sha": "3dfd329d6c84b564cbd82903481d343011aeb5a2",
            "filename": "deps/uv/src/unix/linux-syscalls.h",
            "status": "modified",
            "additions": 0,
            "deletions": 34,
            "changes": 34,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Flinux-syscalls.h",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Flinux-syscalls.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Flinux-syscalls.h?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -66,12 +66,6 @@\n # define UV__SOCK_NONBLOCK    UV__O_NONBLOCK\n #endif\n \n-/* epoll flags */\n-#define UV__EPOLL_CLOEXEC     UV__O_CLOEXEC\n-#define UV__EPOLL_CTL_ADD     1\n-#define UV__EPOLL_CTL_DEL     2\n-#define UV__EPOLL_CTL_MOD     3\n-\n /* inotify flags */\n #define UV__IN_ACCESS         0x001\n #define UV__IN_MODIFY         0x002\n@@ -86,18 +80,6 @@\n #define UV__IN_DELETE_SELF    0x400\n #define UV__IN_MOVE_SELF      0x800\n \n-#if defined(__x86_64__)\n-struct uv__epoll_event {\n-  uint32_t events;\n-  uint64_t data;\n-} __attribute__((packed));\n-#else\n-struct uv__epoll_event {\n-  uint32_t events;\n-  uint64_t data;\n-};\n-#endif\n-\n struct uv__inotify_event {\n   int32_t wd;\n   uint32_t mask;\n@@ -113,18 +95,6 @@ struct uv__mmsghdr {\n \n int uv__accept4(int fd, struct sockaddr* addr, socklen_t* addrlen, int flags);\n int uv__eventfd(unsigned int count);\n-int uv__epoll_create(int size);\n-int uv__epoll_create1(int flags);\n-int uv__epoll_ctl(int epfd, int op, int fd, struct uv__epoll_event *ev);\n-int uv__epoll_wait(int epfd,\n-                   struct uv__epoll_event* events,\n-                   int nevents,\n-                   int timeout);\n-int uv__epoll_pwait(int epfd,\n-                    struct uv__epoll_event* events,\n-                    int nevents,\n-                    int timeout,\n-                    uint64_t sigmask);\n int uv__eventfd2(unsigned int count, int flags);\n int uv__inotify_init(void);\n int uv__inotify_init1(int flags);\n@@ -140,10 +110,6 @@ int uv__sendmmsg(int fd,\n                  struct uv__mmsghdr* mmsg,\n                  unsigned int vlen,\n                  unsigned int flags);\n-int uv__utimesat(int dirfd,\n-                 const char* path,\n-                 const struct timespec times[2],\n-                 int flags);\n ssize_t uv__preadv(int fd, const struct iovec *iov, int iovcnt, int64_t offset);\n ssize_t uv__pwritev(int fd, const struct iovec *iov, int iovcnt, int64_t offset);\n int uv__dup3(int oldfd, int newfd, int flags);"
        },
        {
            "sha": "ea599107b30281084918ce2bda9613318c6ae47c",
            "filename": "deps/uv/src/unix/os390-syscalls.h",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fos390-syscalls.h",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fos390-syscalls.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fos390-syscalls.h?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -36,10 +36,6 @@\n #define MAX_ITEMS_PER_EPOLL       1024\n \n #define UV__O_CLOEXEC             0x80000\n-#define UV__EPOLL_CLOEXEC         UV__O_CLOEXEC\n-#define UV__EPOLL_CTL_ADD         EPOLL_CTL_ADD\n-#define UV__EPOLL_CTL_DEL         EPOLL_CTL_DEL\n-#define UV__EPOLL_CTL_MOD         EPOLL_CTL_MOD\n \n struct epoll_event {\n   int events;"
        },
        {
            "sha": "5e93178f6f9addc26ef0a731a91aa4f4f5567eaa",
            "filename": "deps/uv/src/unix/os390.c",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fos390.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fos390.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fos390.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -662,7 +662,7 @@ void uv__platform_invalidate_fd(uv_loop_t* loop, int fd) {\n \n   /* Remove the file descriptor from the epoll. */\n   if (loop->ep != NULL)\n-    epoll_ctl(loop->ep, UV__EPOLL_CTL_DEL, fd, &dummy);\n+    epoll_ctl(loop->ep, EPOLL_CTL_DEL, fd, &dummy);\n }\n \n \n@@ -838,9 +838,9 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n     e.fd = w->fd;\n \n     if (w->events == 0)\n-      op = UV__EPOLL_CTL_ADD;\n+      op = EPOLL_CTL_ADD;\n     else\n-      op = UV__EPOLL_CTL_MOD;\n+      op = EPOLL_CTL_MOD;\n \n     /* XXX Future optimization: do EPOLL_CTL_MOD lazily if we stop watching\n      * events, skip the syscall and squelch the events after epoll_wait().\n@@ -849,10 +849,10 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n       if (errno != EEXIST)\n         abort();\n \n-      assert(op == UV__EPOLL_CTL_ADD);\n+      assert(op == EPOLL_CTL_ADD);\n \n       /* We've reactivated a file descriptor that's been watched before. */\n-      if (epoll_ctl(loop->ep, UV__EPOLL_CTL_MOD, w->fd, &e))\n+      if (epoll_ctl(loop->ep, EPOLL_CTL_MOD, w->fd, &e))\n         abort();\n     }\n \n@@ -934,7 +934,7 @@ void uv__io_poll(uv_loop_t* loop, int timeout) {\n          * Ignore all errors because we may be racing with another thread\n          * when the file descriptor is closed.\n          */\n-        epoll_ctl(loop->ep, UV__EPOLL_CTL_DEL, fd, pe);\n+        epoll_ctl(loop->ep, EPOLL_CTL_DEL, fd, pe);\n         continue;\n       }\n "
        },
        {
            "sha": "e450a30e9c7e0ccdf33d477a1213bc8fb3712423",
            "filename": "deps/uv/src/unix/pipe.c",
            "status": "modified",
            "additions": 17,
            "deletions": 3,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fpipe.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fpipe.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fpipe.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -132,11 +132,21 @@ void uv__pipe_close(uv_pipe_t* handle) {\n \n \n int uv_pipe_open(uv_pipe_t* handle, uv_file fd) {\n+  int flags;\n+  int mode;\n   int err;\n+  flags = 0;\n \n   if (uv__fd_exists(handle->loop, fd))\n     return UV_EEXIST;\n \n+  do\n+    mode = fcntl(fd, F_GETFL);\n+  while (mode == -1 && errno == EINTR);\n+\n+  if (mode == -1)\n+    return UV__ERR(errno); /* according to docs, must be EBADF */\n+\n   err = uv__nonblock(fd, 1);\n   if (err)\n     return err;\n@@ -147,9 +157,13 @@ int uv_pipe_open(uv_pipe_t* handle, uv_file fd) {\n     return err;\n #endif /* defined(__APPLE__) */\n \n-  return uv__stream_open((uv_stream_t*)handle,\n-                         fd,\n-                         UV_HANDLE_READABLE | UV_HANDLE_WRITABLE);\n+  mode &= O_ACCMODE;\n+  if (mode != O_WRONLY)\n+    flags |= UV_HANDLE_READABLE;\n+  if (mode != O_RDONLY)\n+    flags |= UV_HANDLE_WRITABLE;\n+\n+  return uv__stream_open((uv_stream_t*)handle, fd, flags);\n }\n \n "
        },
        {
            "sha": "2e84eeeb82877e3f915c8222bf83844cd1ce35e1",
            "filename": "deps/uv/src/unix/stream.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fstream.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Fstream.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Fstream.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -1676,6 +1676,7 @@ void uv__stream_close(uv_stream_t* handle) {\n   uv__io_close(handle->loop, &handle->io_watcher);\n   uv_read_stop(handle);\n   uv__handle_stop(handle);\n+  handle->flags &= ~(UV_HANDLE_READABLE | UV_HANDLE_WRITABLE);\n \n   if (handle->io_watcher.fd != -1) {\n     /* Don't close stdio file descriptors.  Nothing good comes from it. */"
        },
        {
            "sha": "74d3d75d7615d95fa373599aad5d02b499e53db2",
            "filename": "deps/uv/src/unix/tty.c",
            "status": "modified",
            "additions": 16,
            "deletions": 21,
            "changes": 37,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Ftty.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Funix%2Ftty.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Funix%2Ftty.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -92,13 +92,15 @@ static int uv__tty_is_slave(const int fd) {\n   return result;\n }\n \n-int uv_tty_init(uv_loop_t* loop, uv_tty_t* tty, int fd, int readable) {\n+int uv_tty_init(uv_loop_t* loop, uv_tty_t* tty, int fd, int unused) {\n   uv_handle_type type;\n   int flags;\n   int newfd;\n   int r;\n   int saved_flags;\n+  int mode;\n   char path[256];\n+  (void)unused; /* deprecated parameter is no longer needed */\n \n   /* File descriptors that refer to files cannot be monitored with epoll.\n    * That restriction also applies to character devices like /dev/random\n@@ -111,6 +113,15 @@ int uv_tty_init(uv_loop_t* loop, uv_tty_t* tty, int fd, int readable) {\n   flags = 0;\n   newfd = -1;\n \n+  /* Save the fd flags in case we need to restore them due to an error. */\n+  do\n+    saved_flags = fcntl(fd, F_GETFL);\n+  while (saved_flags == -1 && errno == EINTR);\n+\n+  if (saved_flags == -1)\n+    return UV__ERR(errno);\n+  mode = saved_flags & O_ACCMODE;\n+\n   /* Reopen the file descriptor when it refers to a tty. This lets us put the\n    * tty in non-blocking mode without affecting other processes that share it\n    * with us.\n@@ -128,13 +139,13 @@ int uv_tty_init(uv_loop_t* loop, uv_tty_t* tty, int fd, int readable) {\n      * slave device.\n      */\n     if (uv__tty_is_slave(fd) && ttyname_r(fd, path, sizeof(path)) == 0)\n-      r = uv__open_cloexec(path, O_RDWR);\n+      r = uv__open_cloexec(path, mode);\n     else\n       r = -1;\n \n     if (r < 0) {\n       /* fallback to using blocking writes */\n-      if (!readable)\n+      if (mode != O_RDONLY)\n         flags |= UV_HANDLE_BLOCKING_WRITES;\n       goto skip;\n     }\n@@ -154,22 +165,6 @@ int uv_tty_init(uv_loop_t* loop, uv_tty_t* tty, int fd, int readable) {\n     fd = newfd;\n   }\n \n-#if defined(__APPLE__)\n-  /* Save the fd flags in case we need to restore them due to an error. */\n-  do\n-    saved_flags = fcntl(fd, F_GETFL);\n-  while (saved_flags == -1 && errno == EINTR);\n-\n-  if (saved_flags == -1) {\n-    if (newfd != -1)\n-      uv__close(newfd);\n-    return UV__ERR(errno);\n-  }\n-#endif\n-\n-  /* Pacify the compiler. */\n-  (void) &saved_flags;\n-\n skip:\n   uv__stream_init(loop, (uv_stream_t*) tty, UV_TTY);\n \n@@ -194,9 +189,9 @@ int uv_tty_init(uv_loop_t* loop, uv_tty_t* tty, int fd, int readable) {\n   }\n #endif\n \n-  if (readable)\n+  if (mode != O_WRONLY)\n     flags |= UV_HANDLE_READABLE;\n-  else\n+  if (mode != O_RDONLY)\n     flags |= UV_HANDLE_WRITABLE;\n \n   uv__stream_open((uv_stream_t*) tty, fd, flags);"
        },
        {
            "sha": "5555f83aee486490827d34d729f8252551118709",
            "filename": "deps/uv/src/uv-common.h",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fuv-common.h",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fuv-common.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fuv-common.h?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -164,8 +164,15 @@ void uv__fs_poll_close(uv_fs_poll_t* handle);\n \n int uv__getaddrinfo_translate_error(int sys_err);    /* EAI_* error. */\n \n+enum uv__work_kind {\n+  UV__WORK_CPU,\n+  UV__WORK_FAST_IO,\n+  UV__WORK_SLOW_IO\n+};\n+\n void uv__work_submit(uv_loop_t* loop,\n                      struct uv__work *w,\n+                     enum uv__work_kind kind,\n                      void (*work)(struct uv__work *w),\n                      void (*done)(struct uv__work *w, int status));\n "
        },
        {
            "sha": "bf80d77e273920d96a481a957bc7f6ed2c2d0ad4",
            "filename": "deps/uv/src/win/core.c",
            "status": "modified",
            "additions": 56,
            "deletions": 1,
            "changes": 57,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fcore.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fcore.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Fcore.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -381,6 +381,57 @@ int uv_backend_timeout(const uv_loop_t* loop) {\n }\n \n \n+static void uv__poll_wine(uv_loop_t* loop, DWORD timeout) {\n+  DWORD bytes;\n+  ULONG_PTR key;\n+  OVERLAPPED* overlapped;\n+  uv_req_t* req;\n+  int repeat;\n+  uint64_t timeout_time;\n+\n+  timeout_time = loop->time + timeout;\n+\n+  for (repeat = 0; ; repeat++) {\n+    GetQueuedCompletionStatus(loop->iocp,\n+                              &bytes,\n+                              &key,\n+                              &overlapped,\n+                              timeout);\n+\n+    if (overlapped) {\n+      /* Package was dequeued */\n+      req = uv_overlapped_to_req(overlapped);\n+      uv_insert_pending_req(loop, req);\n+\n+      /* Some time might have passed waiting for I/O,\n+       * so update the loop time here.\n+       */\n+      uv_update_time(loop);\n+    } else if (GetLastError() != WAIT_TIMEOUT) {\n+      /* Serious error */\n+      uv_fatal_error(GetLastError(), \"GetQueuedCompletionStatus\");\n+    } else if (timeout > 0) {\n+      /* GetQueuedCompletionStatus can occasionally return a little early.\n+       * Make sure that the desired timeout target time is reached.\n+       */\n+      uv_update_time(loop);\n+      if (timeout_time > loop->time) {\n+        timeout = (DWORD)(timeout_time - loop->time);\n+        /* The first call to GetQueuedCompletionStatus should return very\n+         * close to the target time and the second should reach it, but\n+         * this is not stated in the documentation. To make sure a busy\n+         * loop cannot happen, the timeout is increased exponentially\n+         * starting on the third round.\n+         */\n+        timeout += repeat ? (1 << (repeat - 1)) : 0;\n+        continue;\n+      }\n+    }\n+    break;\n+  }\n+}\n+\n+\n static void uv__poll(uv_loop_t* loop, DWORD timeout) {\n   BOOL success;\n   uv_req_t* req;\n@@ -473,7 +524,11 @@ int uv_run(uv_loop_t *loop, uv_run_mode mode) {\n     if ((mode == UV_RUN_ONCE && !ran_pending) || mode == UV_RUN_DEFAULT)\n       timeout = uv_backend_timeout(loop);\n \n-    uv__poll(loop, timeout);\n+    if (pGetQueuedCompletionStatusEx)\n+      uv__poll(loop, timeout);\n+    else\n+      uv__poll_wine(loop, timeout);\n+\n \n     uv_check_invoke(loop);\n     uv_process_endgames(loop);"
        },
        {
            "sha": "0886d799826374911cafa064c358255baffb433e",
            "filename": "deps/uv/src/win/fs.c",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Ffs.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Ffs.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Ffs.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -55,7 +55,11 @@\n   do {                                                                        \\\n     if (cb != NULL) {                                                         \\\n       uv__req_register(loop, req);                                            \\\n-      uv__work_submit(loop, &req->work_req, uv__fs_work, uv__fs_done);        \\\n+      uv__work_submit(loop,                                                   \\\n+                      &req->work_req,                                         \\\n+                      UV__WORK_FAST_IO,                                       \\\n+                      uv__fs_work,                                            \\\n+                      uv__fs_done);                                           \\\n       return 0;                                                               \\\n     } else {                                                                  \\\n       uv__fs_work(&req->work_req);                                            \\"
        },
        {
            "sha": "614ea8e376e8af661adcdfb1c703c08ed3e6421e",
            "filename": "deps/uv/src/win/getaddrinfo.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fgetaddrinfo.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fgetaddrinfo.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Fgetaddrinfo.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -368,6 +368,7 @@ int uv_getaddrinfo(uv_loop_t* loop,\n   if (getaddrinfo_cb) {\n     uv__work_submit(loop,\n                     &req->work_req,\n+                    UV__WORK_SLOW_IO,\n                     uv__getaddrinfo_work,\n                     uv__getaddrinfo_done);\n     return 0;"
        },
        {
            "sha": "b3773380c21d7032287d64477c89f9b839b8d289",
            "filename": "deps/uv/src/win/getnameinfo.c",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fgetnameinfo.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fgetnameinfo.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Fgetnameinfo.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -145,6 +145,7 @@ int uv_getnameinfo(uv_loop_t* loop,\n   if (getnameinfo_cb) {\n     uv__work_submit(loop,\n                     &req->work_req,\n+                    UV__WORK_SLOW_IO,\n                     uv__getnameinfo_work,\n                     uv__getnameinfo_done);\n     return 0;"
        },
        {
            "sha": "7045b11540d1ac2f5640b54fc43d9aab6a695946",
            "filename": "deps/uv/src/win/tty.c",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Ftty.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Ftty.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Ftty.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -172,9 +172,12 @@ void uv_console_init(void) {\n }\n \n \n-int uv_tty_init(uv_loop_t* loop, uv_tty_t* tty, uv_file fd, int readable) {\n+int uv_tty_init(uv_loop_t* loop, uv_tty_t* tty, uv_file fd, int unused) {\n+  BOOL readable;\n+  DWORD NumberOfEvents;\n   HANDLE handle;\n   CONSOLE_SCREEN_BUFFER_INFO screen_buffer_info;\n+  (void)unused;\n \n   uv__once_init();\n   handle = (HANDLE) uv__get_osfhandle(fd);\n@@ -199,6 +202,7 @@ int uv_tty_init(uv_loop_t* loop, uv_tty_t* tty, uv_file fd, int readable) {\n     fd = -1;\n   }\n \n+  readable = GetNumberOfConsoleInputEvents(handle, &NumberOfEvents);\n   if (!readable) {\n     /* Obtain the screen buffer info with the output handle. */\n     if (!GetConsoleScreenBufferInfo(handle, &screen_buffer_info)) {\n@@ -382,12 +386,6 @@ int uv_tty_set_mode(uv_tty_t* tty, uv_tty_mode_t mode) {\n }\n \n \n-int uv_is_tty(uv_file file) {\n-  DWORD result;\n-  return GetConsoleMode((HANDLE) _get_osfhandle(file), &result) != 0;\n-}\n-\n-\n int uv_tty_get_winsize(uv_tty_t* tty, int* width, int* height) {\n   CONSOLE_SCREEN_BUFFER_INFO info;\n "
        },
        {
            "sha": "37df849f8faf207a49fb1ea50d4b3a8d9c050f38",
            "filename": "deps/uv/src/win/udp.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fudp.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fudp.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Fudp.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -366,15 +366,15 @@ int uv__udp_recv_start(uv_udp_t* handle, uv_alloc_cb alloc_cb,\n   int err;\n \n   if (handle->flags & UV_HANDLE_READING) {\n-    return WSAEALREADY;\n+    return UV_EALREADY;\n   }\n \n   err = uv_udp_maybe_bind(handle,\n                           (const struct sockaddr*) &uv_addr_ip4_any_,\n                           sizeof(uv_addr_ip4_any_),\n                           0);\n   if (err)\n-    return err;\n+    return uv_translate_sys_error(err);\n \n   handle->flags |= UV_HANDLE_READING;\n   INCREASE_ACTIVE_COUNT(loop, handle);"
        },
        {
            "sha": "2c09b448a95c013f902fcc30ec22e72a3681ceaa",
            "filename": "deps/uv/src/win/winapi.c",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fwinapi.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fwinapi.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Fwinapi.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -34,6 +34,9 @@ sNtQueryVolumeInformationFile pNtQueryVolumeInformationFile;\n sNtQueryDirectoryFile pNtQueryDirectoryFile;\n sNtQuerySystemInformation pNtQuerySystemInformation;\n \n+/* Kernel32 function pointers */\n+sGetQueuedCompletionStatusEx pGetQueuedCompletionStatusEx;\n+\n /* Powrprof.dll function pointer */\n sPowerRegisterSuspendResumeNotification pPowerRegisterSuspendResumeNotification;\n \n@@ -45,6 +48,7 @@ void uv_winapi_init(void) {\n   HMODULE ntdll_module;\n   HMODULE powrprof_module;\n   HMODULE user32_module;\n+  HMODULE kernel32_module;\n \n   ntdll_module = GetModuleHandleA(\"ntdll.dll\");\n   if (ntdll_module == NULL) {\n@@ -98,6 +102,15 @@ void uv_winapi_init(void) {\n     uv_fatal_error(GetLastError(), \"GetProcAddress\");\n   }\n \n+  kernel32_module = GetModuleHandleA(\"kernel32.dll\");\n+  if (kernel32_module == NULL) {\n+    uv_fatal_error(GetLastError(), \"GetModuleHandleA\");\n+  }\n+\n+  pGetQueuedCompletionStatusEx = (sGetQueuedCompletionStatusEx) GetProcAddress(\n+      kernel32_module,\n+      \"GetQueuedCompletionStatusEx\");\n+\n   powrprof_module = LoadLibraryA(\"powrprof.dll\");\n   if (powrprof_module != NULL) {\n     pPowerRegisterSuspendResumeNotification = (sPowerRegisterSuspendResumeNotification)"
        },
        {
            "sha": "cfbac52eb1d6f4c707620b0d498a18252eae098f",
            "filename": "deps/uv/src/win/winapi.h",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fwinapi.h",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Fsrc%2Fwin%2Fwinapi.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Fsrc%2Fwin%2Fwinapi.h?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -4642,6 +4642,14 @@ typedef NTSTATUS (NTAPI *sNtQueryDirectoryFile)\n # define ERROR_MUI_FILE_NOT_LOADED 15105\n #endif\n \n+typedef BOOL (WINAPI *sGetQueuedCompletionStatusEx)\n+             (HANDLE CompletionPort,\n+              LPOVERLAPPED_ENTRY lpCompletionPortEntries,\n+              ULONG ulCount,\n+              PULONG ulNumEntriesRemoved,\n+              DWORD dwMilliseconds,\n+              BOOL fAlertable);\n+\n /* from powerbase.h */\n #ifndef DEVICE_NOTIFY_CALLBACK\n # define DEVICE_NOTIFY_CALLBACK 2\n@@ -4704,6 +4712,9 @@ extern sNtQueryVolumeInformationFile pNtQueryVolumeInformationFile;\n extern sNtQueryDirectoryFile pNtQueryDirectoryFile;\n extern sNtQuerySystemInformation pNtQuerySystemInformation;\n \n+/* Kernel32 function pointers */\n+extern sGetQueuedCompletionStatusEx pGetQueuedCompletionStatusEx;\n+\n /* Powrprof.dll function pointer */\n extern sPowerRegisterSuspendResumeNotification pPowerRegisterSuspendResumeNotification;\n "
        },
        {
            "sha": "50f3c047c00cd260cef2edacc15940f42733eaaa",
            "filename": "deps/uv/test/test-condvar.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-condvar.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-condvar.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-condvar.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -259,7 +259,7 @@ TEST_IMPL(condvar_5) {\n    * https://msdn.microsoft.com/en-us/library/ms687069(VS.85).aspx */\n   elapsed = after - before;\n   ASSERT(0.75 * timeout <= elapsed); /* 1.0 too large for Windows. */\n-  ASSERT(elapsed <= 1.5 * timeout); /* 1.1 too small for OSX. */\n+  ASSERT(elapsed <= 5.0 * timeout); /* MacOS has reported failures up to 1.75. */\n \n   worker_config_destroy(&wc);\n "
        },
        {
            "sha": "f47ae3e656299e4588f169291f0a336758ab6f29",
            "filename": "deps/uv/test/test-fork.c",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-fork.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-fork.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-fork.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -283,6 +283,7 @@ TEST_IMPL(fork_signal_to_child_closed) {\n   int sync_pipe[2];\n   int sync_pipe2[2];\n   char sync_buf[1];\n+  int r;\n \n   fork_signal_cb_called = 0;    /* reset */\n \n@@ -326,9 +327,10 @@ TEST_IMPL(fork_signal_to_child_closed) {\n     /* Don't run the loop. Wait for the parent to call us */\n     printf(\"Waiting on parent in child\\n\");\n     /* Wait for parent. read may fail if the parent tripped an ASSERT\n-       and exited, so this isn't in an ASSERT.\n+       and exited, so this ASSERT is generous.\n     */\n-    read(sync_pipe2[0], sync_buf, 1);\n+    r = read(sync_pipe2[0], sync_buf, 1);\n+    ASSERT(-1 <= r && r <= 1);\n     ASSERT(0 == fork_signal_cb_called);\n     printf(\"Exiting child \\n\");\n     /* Note that we're deliberately not running the loop"
        },
        {
            "sha": "8a093e2ea46e2cb99be10da19f677b45dae979ab",
            "filename": "deps/uv/test/test-handle-fileno.c",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-handle-fileno.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-handle-fileno.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-handle-fileno.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -27,7 +27,7 @@ static int get_tty_fd(void) {\n   /* Make sure we have an FD that refers to a tty */\n #ifdef _WIN32\n   HANDLE handle;\n-  handle = CreateFileA(\"conout$\",\n+  handle = CreateFileA(\"conin$\",\n                        GENERIC_READ | GENERIC_WRITE,\n                        FILE_SHARE_READ | FILE_SHARE_WRITE,\n                        NULL,\n@@ -107,11 +107,15 @@ TEST_IMPL(handle_fileno) {\n   } else {\n     r = uv_tty_init(loop, &tty, tty_fd, 0);\n     ASSERT(r == 0);\n+    ASSERT(uv_is_readable((uv_stream_t*) &tty));\n+    ASSERT(!uv_is_writable((uv_stream_t*) &tty));\n     r = uv_fileno((uv_handle_t*) &tty, &fd);\n     ASSERT(r == 0);\n     uv_close((uv_handle_t*) &tty, NULL);\n     r = uv_fileno((uv_handle_t*) &tty, &fd);\n     ASSERT(r == UV_EBADF);\n+    ASSERT(!uv_is_readable((uv_stream_t*) &tty));\n+    ASSERT(!uv_is_writable((uv_stream_t*) &tty));\n   }\n \n   uv_run(loop, UV_RUN_DEFAULT);"
        },
        {
            "sha": "c8804b0e1892496afae25d8d927f8a8ead52c7a9",
            "filename": "deps/uv/test/test-pipe-close-stdout-read-stdin.c",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-pipe-close-stdout-read-stdin.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-pipe-close-stdout-read-stdin.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-pipe-close-stdout-read-stdin.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -66,7 +66,8 @@ TEST_IMPL(pipe_close_stdout_read_stdin) {\n     */\n     close(fd[1]);\n     /* block until write end of pipe is closed */\n-    read(fd[0], &buf, 1);\n+    r = read(fd[0], &buf, 1);\n+    ASSERT(-1 <= r && r <= 1);\n     close(0);\n     r = dup(fd[0]);\n     ASSERT(r != -1);"
        },
        {
            "sha": "4fcd905eed75007da1714b84b83a08a95f03dcf4",
            "filename": "deps/uv/test/test-spawn.c",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-spawn.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-spawn.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-spawn.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -1733,6 +1733,7 @@ TEST_IMPL(spawn_inherit_streams) {\n   uv_buf_t buf;\n   unsigned int i;\n   int r;\n+  int bidir;\n   uv_write_t write_req;\n   uv_loop_t* loop;\n \n@@ -1751,6 +1752,15 @@ TEST_IMPL(spawn_inherit_streams) {\n   ASSERT(uv_pipe_open(&pipe_stdout_child, fds_stdout[1]) == 0);\n   ASSERT(uv_pipe_open(&pipe_stdin_parent, fds_stdin[1]) == 0);\n   ASSERT(uv_pipe_open(&pipe_stdout_parent, fds_stdout[0]) == 0);\n+  ASSERT(uv_is_readable((uv_stream_t*) &pipe_stdin_child));\n+  ASSERT(uv_is_writable((uv_stream_t*) &pipe_stdout_child));\n+  ASSERT(uv_is_writable((uv_stream_t*) &pipe_stdin_parent));\n+  ASSERT(uv_is_readable((uv_stream_t*) &pipe_stdout_parent));\n+  /* Some systems (SVR4) open a bidirectional pipe, most don't. */\n+  bidir = uv_is_writable((uv_stream_t*) &pipe_stdin_child);\n+  ASSERT(uv_is_readable((uv_stream_t*) &pipe_stdout_child) == bidir);\n+  ASSERT(uv_is_readable((uv_stream_t*) &pipe_stdin_parent) == bidir);\n+  ASSERT(uv_is_writable((uv_stream_t*) &pipe_stdout_parent) == bidir);\n \n   child_stdio[0].flags = UV_INHERIT_STREAM;\n   child_stdio[0].data.stream = (uv_stream_t *)&pipe_stdin_child;"
        },
        {
            "sha": "3bbdfad7803f37af1c15c88e67461ab8ba741a0f",
            "filename": "deps/uv/test/test-tty.c",
            "status": "modified",
            "additions": 43,
            "deletions": 2,
            "changes": 45,
            "blob_url": "https://github.com/nodejs/node/blob/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-tty.c",
            "raw_url": "https://github.com/nodejs/node/raw/2790db5e3d74c4f7521cc27a1115228700dd4049/deps%2Fuv%2Ftest%2Ftest-tty.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fuv%2Ftest%2Ftest-tty.c?ref=2790db5e3d74c4f7521cc27a1115228700dd4049",
            "patch": "@@ -96,9 +96,13 @@ TEST_IMPL(tty) {\n \n   r = uv_tty_init(uv_default_loop(), &tty_in, ttyin_fd, 1);  /* Readable. */\n   ASSERT(r == 0);\n+  ASSERT(uv_is_readable((uv_stream_t*) &tty_in));\n+  ASSERT(!uv_is_writable((uv_stream_t*) &tty_in));\n \n   r = uv_tty_init(uv_default_loop(), &tty_out, ttyout_fd, 0);  /* Writable. */\n   ASSERT(r == 0);\n+  ASSERT(!uv_is_readable((uv_stream_t*) &tty_out));\n+  ASSERT(uv_is_writable((uv_stream_t*) &tty_out));\n \n   r = uv_tty_get_winsize(&tty_out, &width, &height);\n   ASSERT(r == 0);\n@@ -186,6 +190,8 @@ TEST_IMPL(tty_raw) {\n \n   r = uv_tty_init(uv_default_loop(), &tty_in, ttyin_fd, 1);  /* Readable. */\n   ASSERT(r == 0);\n+  ASSERT(uv_is_readable((uv_stream_t*) &tty_in));\n+  ASSERT(!uv_is_writable((uv_stream_t*) &tty_in));\n \n   r = uv_read_start((uv_stream_t*)&tty_in, tty_raw_alloc, tty_raw_read);\n   ASSERT(r == 0);\n@@ -242,6 +248,8 @@ TEST_IMPL(tty_empty_write) {\n \n   r = uv_tty_init(uv_default_loop(), &tty_out, ttyout_fd, 0);  /* Writable. */\n   ASSERT(r == 0);\n+  ASSERT(!uv_is_readable((uv_stream_t*) &tty_out));\n+  ASSERT(uv_is_writable((uv_stream_t*) &tty_out));\n \n   bufs[0].len = 0;\n   bufs[0].base = &dummy[0];\n@@ -309,6 +317,8 @@ TEST_IMPL(tty_file) {\n #ifndef _WIN32\n   uv_loop_t loop;\n   uv_tty_t tty;\n+  uv_tty_t tty_ro;\n+  uv_tty_t tty_wo;\n   int fd;\n \n   ASSERT(0 == uv_loop_init(&loop));\n@@ -334,13 +344,40 @@ TEST_IMPL(tty_file) {\n     ASSERT(0 == close(fd));\n   }\n \n-  fd = open(\"/dev/tty\", O_RDONLY);\n+  fd = open(\"/dev/tty\", O_RDWR);\n   if (fd != -1) {\n     ASSERT(0 == uv_tty_init(&loop, &tty, fd, 1));\n-    ASSERT(0 == close(fd));\n+    ASSERT(0 == close(fd)); /* TODO: it's indeterminate who owns fd now */\n+    ASSERT(uv_is_readable((uv_stream_t*) &tty));\n+    ASSERT(uv_is_writable((uv_stream_t*) &tty));\n     uv_close((uv_handle_t*) &tty, NULL);\n+    ASSERT(!uv_is_readable((uv_stream_t*) &tty));\n+    ASSERT(!uv_is_writable((uv_stream_t*) &tty));\n+  }\n+\n+  fd = open(\"/dev/tty\", O_RDONLY);\n+  if (fd != -1) {\n+    ASSERT(0 == uv_tty_init(&loop, &tty_ro, fd, 1));\n+    ASSERT(0 == close(fd)); /* TODO: it's indeterminate who owns fd now */\n+    ASSERT(uv_is_readable((uv_stream_t*) &tty_ro));\n+    ASSERT(!uv_is_writable((uv_stream_t*) &tty_ro));\n+    uv_close((uv_handle_t*) &tty_ro, NULL);\n+    ASSERT(!uv_is_readable((uv_stream_t*) &tty_ro));\n+    ASSERT(!uv_is_writable((uv_stream_t*) &tty_ro));\n   }\n \n+  fd = open(\"/dev/tty\", O_WRONLY);\n+  if (fd != -1) {\n+    ASSERT(0 == uv_tty_init(&loop, &tty_wo, fd, 0));\n+    ASSERT(0 == close(fd)); /* TODO: it's indeterminate who owns fd now */\n+    ASSERT(!uv_is_readable((uv_stream_t*) &tty_wo));\n+    ASSERT(uv_is_writable((uv_stream_t*) &tty_wo));\n+    uv_close((uv_handle_t*) &tty_wo, NULL);\n+    ASSERT(!uv_is_readable((uv_stream_t*) &tty_wo));\n+    ASSERT(!uv_is_writable((uv_stream_t*) &tty_wo));\n+  }\n+\n+\n   ASSERT(0 == uv_run(&loop, UV_RUN_DEFAULT));\n   ASSERT(0 == uv_loop_close(&loop));\n \n@@ -370,6 +407,10 @@ TEST_IMPL(tty_pty) {\n \n   ASSERT(0 == uv_tty_init(&loop, &slave_tty, slave_fd, 0));\n   ASSERT(0 == uv_tty_init(&loop, &master_tty, master_fd, 0));\n+  ASSERT(uv_is_readable((uv_stream_t*) &slave_tty));\n+  ASSERT(uv_is_writable((uv_stream_t*) &slave_tty));\n+  ASSERT(uv_is_readable((uv_stream_t*) &master_tty));\n+  ASSERT(uv_is_writable((uv_stream_t*) &master_tty));\n   /* Check if the file descriptor was reopened. If it is,\n    * UV_HANDLE_BLOCKING_WRITES (value 0x100000) isn't set on flags.\n    */"
        }
    ],
    "stats": {
        "total": 953,
        "additions": 587,
        "deletions": 366
    }
}