{
    "author": "addaleax",
    "message": "test,worker: verify that `.terminate()` breaks microtask queue\n\nPR-URL: https://github.com/nodejs/node/pull/25480\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "2c9e12e49656fa194376cf01356bc964e0d9161b",
    "files": [
        {
            "sha": "b2351c5d0bb0511f4d7f89554fd2f535a5d7657b",
            "filename": "test/parallel/test-worker-terminate-microtask-loop.js",
            "status": "added",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/nodejs/node/blob/2c9e12e49656fa194376cf01356bc964e0d9161b/test%2Fparallel%2Ftest-worker-terminate-microtask-loop.js",
            "raw_url": "https://github.com/nodejs/node/raw/2c9e12e49656fa194376cf01356bc964e0d9161b/test%2Fparallel%2Ftest-worker-terminate-microtask-loop.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-worker-terminate-microtask-loop.js?ref=2c9e12e49656fa194376cf01356bc964e0d9161b",
            "patch": "@@ -0,0 +1,19 @@\n+'use strict';\n+const common = require('../common');\n+const assert = require('assert');\n+const { Worker } = require('worker_threads');\n+\n+// Verify that `.terminate()` interrupts the microtask queue.\n+\n+const worker = new Worker(`\n+function loop() { Promise.resolve().then(loop); } loop();\n+require('worker_threads').parentPort.postMessage('up');\n+`, { eval: true });\n+\n+worker.once('message', common.mustCall(() => {\n+  setImmediate(() => worker.terminate());\n+}));\n+\n+worker.once('exit', common.mustCall((code) => {\n+  assert.strictEqual(code, 1);\n+}));"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 19,
        "deletions": 0
    }
}