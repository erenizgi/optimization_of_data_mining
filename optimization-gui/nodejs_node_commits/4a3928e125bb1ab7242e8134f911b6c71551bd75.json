{
    "author": "gireeshpunathil",
    "message": "test: eliminate port collision\n\nIn test test-cluster-net-listen-ipv6only-rr, the cluster member that\nlistens to `any` port actually has the potential to `grab` any port\nfrom the environment which when passed onto the master causes\ncollision when it tries to listen on.\n\nMoving the test to sequential alone is not sufficient as the cluster\nmember can in theory catch on to the admin ports on the host.\n\nAssigning static port alone is also not sufficient, as it can interfere\nwith other running tests in the parallel category which would be mostly\nrunning with `port: any` fashion.\n\nSo move to sequential, and use a static port.\n\nFixes: https://github.com/nodejs/node/issues/25813\nPR-URL: https://github.com/nodejs/node/pull/26298\nReviewed-By: Rich Trott <rtrott@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Beth Griggs <Bethany.Griggs@uk.ibm.com>",
    "sha": "4a3928e125bb1ab7242e8134f911b6c71551bd75",
    "files": [
        {
            "sha": "a42be88ddf17f0c2df43df34fffce2e4801f5d3d",
            "filename": "test/sequential/test-cluster-net-listen-ipv6only-rr.js",
            "status": "renamed",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/4a3928e125bb1ab7242e8134f911b6c71551bd75/test%2Fsequential%2Ftest-cluster-net-listen-ipv6only-rr.js",
            "raw_url": "https://github.com/nodejs/node/raw/4a3928e125bb1ab7242e8134f911b6c71551bd75/test%2Fsequential%2Ftest-cluster-net-listen-ipv6only-rr.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-cluster-net-listen-ipv6only-rr.js?ref=4a3928e125bb1ab7242e8134f911b6c71551bd75",
            "patch": "@@ -48,9 +48,14 @@ if (cluster.isMaster) {\n     workers.set(i, worker);\n   }\n } else {\n+  // As the cluster member has the potential to grab any port\n+  // from the environment, this can cause collision when master\n+  // obtains the port from cluster member and tries to listen on.\n+  // So move this to sequential, and provide a static port.\n+  // Refs: https://github.com/nodejs/node/issues/25813\n   net.createServer().listen({\n-    host,\n-    port: 0,\n+    host: host,\n+    port: common.PORT,\n     ipv6Only: true,\n   }, common.mustCall());\n }",
            "previous_filename": "test/parallel/test-cluster-net-listen-ipv6only-rr.js"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 7,
        "deletions": 2
    }
}