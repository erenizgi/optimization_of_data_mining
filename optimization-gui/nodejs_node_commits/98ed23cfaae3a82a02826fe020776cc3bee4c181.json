{
    "author": "ZYSzys",
    "message": "fs: extract start and end check into checkPosition\n\nPR-URL: https://github.com/nodejs/node/pull/25264\nReviewed-By: Weijia Wang <starkwang@126.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "98ed23cfaae3a82a02826fe020776cc3bee4c181",
    "files": [
        {
            "sha": "501c9ee4d22dd9432ac9eec52d5694a73c1b7aef",
            "filename": "lib/internal/fs/streams.js",
            "status": "modified",
            "additions": 15,
            "deletions": 28,
            "changes": 43,
            "blob_url": "https://github.com/nodejs/node/blob/98ed23cfaae3a82a02826fe020776cc3bee4c181/lib%2Finternal%2Ffs%2Fstreams.js",
            "raw_url": "https://github.com/nodejs/node/raw/98ed23cfaae3a82a02826fe020776cc3bee4c181/lib%2Finternal%2Ffs%2Fstreams.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Ffs%2Fstreams.js?ref=98ed23cfaae3a82a02826fe020776cc3bee4c181",
            "patch": "@@ -36,6 +36,19 @@ function allocNewPool(poolSize) {\n   pool.used = 0;\n }\n \n+// Check the `this.start` and `this.end` of stream.\n+function checkPosition(pos, name) {\n+  if (!Number.isSafeInteger(pos)) {\n+    validateNumber(pos, name);\n+    if (!Number.isInteger(pos))\n+      throw new ERR_OUT_OF_RANGE(name, 'an integer', pos);\n+    throw new ERR_OUT_OF_RANGE(name, '>= 0 and <= 2 ** 53 - 1', pos);\n+  }\n+  if (pos < 0) {\n+    throw new ERR_OUT_OF_RANGE(name, '>= 0 and <= 2 ** 53 - 1', pos);\n+  }\n+}\n+\n function ReadStream(path, options) {\n   if (!(this instanceof ReadStream))\n     return new ReadStream(path, options);\n@@ -64,41 +77,15 @@ function ReadStream(path, options) {\n   this.closed = false;\n \n   if (this.start !== undefined) {\n-    if (!Number.isSafeInteger(this.start)) {\n-      validateNumber(this.start, 'start');\n-      if (!Number.isInteger(this.start))\n-        throw new ERR_OUT_OF_RANGE('start', 'an integer', this.start);\n-      throw new ERR_OUT_OF_RANGE(\n-        'start',\n-        '>= 0 and <= 2 ** 53 - 1',\n-        this.start\n-      );\n-    }\n-    if (this.start < 0) {\n-      throw new ERR_OUT_OF_RANGE(\n-        'start',\n-        '>= 0 and <= 2 ** 53 - 1',\n-        this.start\n-      );\n-    }\n+    checkPosition(this.start, 'start');\n \n     this.pos = this.start;\n   }\n \n   if (this.end === undefined) {\n     this.end = Infinity;\n   } else if (this.end !== Infinity) {\n-    if (!Number.isSafeInteger(this.end)) {\n-      if (typeof this.end !== 'number')\n-        throw new ERR_INVALID_ARG_TYPE('end', 'number', this.end);\n-      if (!Number.isInteger(this.end))\n-        throw new ERR_OUT_OF_RANGE('end', 'an integer', this.end);\n-      throw new ERR_OUT_OF_RANGE('end', '>= 0 and <= 2 ** 53 - 1', this.end);\n-    }\n-\n-    if (this.end < 0) {\n-      throw new ERR_OUT_OF_RANGE('end', '>= 0 and <= 2 ** 53 - 1', this.end);\n-    }\n+    checkPosition(this.end, 'end');\n \n     if (this.start !== undefined && this.start > this.end) {\n       throw new ERR_OUT_OF_RANGE("
        }
    ],
    "stats": {
        "total": 43,
        "additions": 15,
        "deletions": 28
    }
}