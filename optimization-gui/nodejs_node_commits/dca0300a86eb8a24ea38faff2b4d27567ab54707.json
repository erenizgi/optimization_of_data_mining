{
    "author": "targos",
    "message": "deps: cherry-pick 2363cdf from upstream V8\n\nOriginal commit message:\n\n    [tracing] do not add traces when disabled\n\n    https://github.com/nodejs/node/issues/21038\n\n    Change-Id: Ic4c9f403b5e54a97d3170b2311dd5aab8c8357c8\n    Reviewed-on: https://chromium-review.googlesource.com/1217726\n    Commit-Queue: Ali Ijaz Sheikh <ofrobots@google.com>\n    Reviewed-by: Yang Guo <yangguo@chromium.org>\n    Cr-Commit-Position: refs/heads/master@{#55809}\n\nRefs: https://github.com/v8/v8/commit/2363cdfefeb643285cbe8593b7c17d80e5d06cd9\n\nPR-URL: https://github.com/nodejs/node/pull/22754\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Refael Ackermann <refack@gmail.com>\nReviewed-By: Ali Ijaz Sheikh <ofrobots@google.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "dca0300a86eb8a24ea38faff2b4d27567ab54707",
    "files": [
        {
            "sha": "46711ac76dbb63940cc8ddb07039efbe72d305f3",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/dca0300a86eb8a24ea38faff2b4d27567ab54707/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/dca0300a86eb8a24ea38faff2b4d27567ab54707/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=dca0300a86eb8a24ea38faff2b4d27567ab54707",
            "patch": "@@ -29,7 +29,7 @@\n \n     # Reset this number to 0 on major V8 upgrades.\n     # Increment by one for each non-official patch applied to deps/v8.\n-    'v8_embedder_string': '-node.1',\n+    'v8_embedder_string': '-node.2',\n \n     # Enable disassembler for `--print-code` v8 options\n     'v8_enable_disassembler': 1,"
        },
        {
            "sha": "aa8789fa07c167ecce97dd787782ce684d3a7c38",
            "filename": "deps/v8/src/libplatform/tracing/tracing-controller.cc",
            "status": "modified",
            "additions": 18,
            "deletions": 14,
            "changes": 32,
            "blob_url": "https://github.com/nodejs/node/blob/dca0300a86eb8a24ea38faff2b4d27567ab54707/deps%2Fv8%2Fsrc%2Flibplatform%2Ftracing%2Ftracing-controller.cc",
            "raw_url": "https://github.com/nodejs/node/raw/dca0300a86eb8a24ea38faff2b4d27567ab54707/deps%2Fv8%2Fsrc%2Flibplatform%2Ftracing%2Ftracing-controller.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Flibplatform%2Ftracing%2Ftracing-controller.cc?ref=dca0300a86eb8a24ea38faff2b4d27567ab54707",
            "patch": "@@ -77,13 +77,15 @@ uint64_t TracingController::AddTraceEvent(\n     const uint64_t* arg_values,\n     std::unique_ptr<v8::ConvertableToTraceFormat>* arg_convertables,\n     unsigned int flags) {\n-  uint64_t handle;\n-  TraceObject* trace_object = trace_buffer_->AddTraceEvent(&handle);\n-  if (trace_object) {\n-    trace_object->Initialize(\n-        phase, category_enabled_flag, name, scope, id, bind_id, num_args,\n-        arg_names, arg_types, arg_values, arg_convertables, flags,\n-        CurrentTimestampMicroseconds(), CurrentCpuTimestampMicroseconds());\n+  uint64_t handle = 0;\n+  if (mode_ != DISABLED) {\n+    TraceObject* trace_object = trace_buffer_->AddTraceEvent(&handle);\n+    if (trace_object) {\n+      trace_object->Initialize(\n+          phase, category_enabled_flag, name, scope, id, bind_id, num_args,\n+          arg_names, arg_types, arg_values, arg_convertables, flags,\n+          CurrentTimestampMicroseconds(), CurrentCpuTimestampMicroseconds());\n+    }\n   }\n   return handle;\n }\n@@ -95,13 +97,15 @@ uint64_t TracingController::AddTraceEventWithTimestamp(\n     const uint64_t* arg_values,\n     std::unique_ptr<v8::ConvertableToTraceFormat>* arg_convertables,\n     unsigned int flags, int64_t timestamp) {\n-  uint64_t handle;\n-  TraceObject* trace_object = trace_buffer_->AddTraceEvent(&handle);\n-  if (trace_object) {\n-    trace_object->Initialize(phase, category_enabled_flag, name, scope, id,\n-                             bind_id, num_args, arg_names, arg_types,\n-                             arg_values, arg_convertables, flags, timestamp,\n-                             CurrentCpuTimestampMicroseconds());\n+  uint64_t handle = 0;\n+  if (mode_ != DISABLED) {\n+    TraceObject* trace_object = trace_buffer_->AddTraceEvent(&handle);\n+    if (trace_object) {\n+      trace_object->Initialize(phase, category_enabled_flag, name, scope, id,\n+                               bind_id, num_args, arg_names, arg_types,\n+                               arg_values, arg_convertables, flags, timestamp,\n+                               CurrentCpuTimestampMicroseconds());\n+    }\n   }\n   return handle;\n }"
        }
    ],
    "stats": {
        "total": 34,
        "additions": 19,
        "deletions": 15
    }
}