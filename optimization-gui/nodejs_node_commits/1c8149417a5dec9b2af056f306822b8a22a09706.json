{
    "author": "sameer-coder",
    "message": "fs,net: emit 'ready' for fs streams and sockets\n\n... in addition to the event names they currently use.\n\nCurrently, various internal streams have different events that\nindicate that the underlying resource has successfully been\nestablished. This commit adds ready event for fs and net\nsockets to standardize on emitting ready for all of these streams.\n\nPR-URL: https://github.com/nodejs/node/pull/19408\nFixes: https://github.com/nodejs/node/issues/19304\nReviewed-By: Anna Henningsen <anna@addaleax.net>",
    "sha": "1c8149417a5dec9b2af056f306822b8a22a09706",
    "files": [
        {
            "sha": "3cdf498f6b0f998b09aff23aac1dc25c643e131b",
            "filename": "lib/fs.js",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1c8149417a5dec9b2af056f306822b8a22a09706/lib%2Ffs.js",
            "raw_url": "https://github.com/nodejs/node/raw/1c8149417a5dec9b2af056f306822b8a22a09706/lib%2Ffs.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ffs.js?ref=1c8149417a5dec9b2af056f306822b8a22a09706",
            "patch": "@@ -2051,6 +2051,7 @@ ReadStream.prototype.open = function() {\n \n     self.fd = fd;\n     self.emit('open', fd);\n+    self.emit('ready');\n     // start the flow of data.\n     self.read();\n   });\n@@ -2207,6 +2208,7 @@ WriteStream.prototype.open = function() {\n \n     this.fd = fd;\n     this.emit('open', fd);\n+    this.emit('ready');\n   });\n };\n "
        },
        {
            "sha": "e3cd8559b98e90f0c88385099f9ca01428c6eca4",
            "filename": "lib/net.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/1c8149417a5dec9b2af056f306822b8a22a09706/lib%2Fnet.js",
            "raw_url": "https://github.com/nodejs/node/raw/1c8149417a5dec9b2af056f306822b8a22a09706/lib%2Fnet.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fnet.js?ref=1c8149417a5dec9b2af056f306822b8a22a09706",
            "patch": "@@ -1188,6 +1188,7 @@ function afterConnect(status, handle, req, readable, writable) {\n     self._unrefTimer();\n \n     self.emit('connect');\n+    self.emit('ready');\n \n     // start the first read, or get an immediate EOF.\n     // this doesn't actually consume any bytes, because len=0."
        },
        {
            "sha": "71f7aa76e36c76cbdff5c82093100b1aeec9df19",
            "filename": "test/parallel/test-fs-ready-event-stream.js",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/1c8149417a5dec9b2af056f306822b8a22a09706/test%2Fparallel%2Ftest-fs-ready-event-stream.js",
            "raw_url": "https://github.com/nodejs/node/raw/1c8149417a5dec9b2af056f306822b8a22a09706/test%2Fparallel%2Ftest-fs-ready-event-stream.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-ready-event-stream.js?ref=1c8149417a5dec9b2af056f306822b8a22a09706",
            "patch": "@@ -0,0 +1,13 @@\n+'use strict';\n+const common = require('../common');\n+const fs = require('fs');\n+const path = require('path');\n+const tmpdir = require('../common/tmpdir');\n+\n+const readStream = fs.createReadStream(__filename);\n+readStream.on('ready', common.mustCall(() => {}, 1));\n+\n+const writeFile = path.join(tmpdir.path, 'write-fsreadyevent.txt');\n+tmpdir.refresh();\n+const writeStream = fs.createWriteStream(writeFile, { autoClose: true });\n+writeStream.on('ready', common.mustCall(() => {}, 1));"
        },
        {
            "sha": "1ad5db4760dc1eeacdc3e5e4889d88a58fed24be",
            "filename": "test/parallel/test-net-socket-ready-without-cb.js",
            "status": "added",
            "additions": 20,
            "deletions": 0,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/1c8149417a5dec9b2af056f306822b8a22a09706/test%2Fparallel%2Ftest-net-socket-ready-without-cb.js",
            "raw_url": "https://github.com/nodejs/node/raw/1c8149417a5dec9b2af056f306822b8a22a09706/test%2Fparallel%2Ftest-net-socket-ready-without-cb.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-net-socket-ready-without-cb.js?ref=1c8149417a5dec9b2af056f306822b8a22a09706",
            "patch": "@@ -0,0 +1,20 @@\n+'use strict';\n+const common = require('../common');\n+\n+// This test ensures that socket.connect can be called without callback\n+// which is optional.\n+\n+const net = require('net');\n+\n+const server = net.createServer(common.mustCall(function(conn) {\n+  conn.end();\n+  server.close();\n+})).listen(0, common.mustCall(function() {\n+  const client = new net.Socket();\n+\n+  client.on('ready', common.mustCall(function() {\n+    client.end();\n+  }));\n+\n+  client.connect(server.address());\n+}));"
        }
    ],
    "stats": {
        "total": 36,
        "additions": 36,
        "deletions": 0
    }
}