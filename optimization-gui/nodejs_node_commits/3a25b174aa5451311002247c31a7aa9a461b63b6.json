{
    "author": "bnoordhuis",
    "message": "deps: upgrade to c-ares v1.15.0\n\nOur out-of-tree patch from 2b6bb9f588 (\"deps: c-ares float, win ipv6 bad\nfec0 prefix\") should no longer be necessary, c-ares now blacklists such\naddresses itself.\n\nPR-URL: https://github.com/nodejs/node/pull/23854\nReviewed-By: Refael Ackermann <refack@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "3a25b174aa5451311002247c31a7aa9a461b63b6",
    "files": [
        {
            "sha": "ad6bb52b729ed4634c9f728ea04040eaf5adf098",
            "filename": "deps/cares/LICENSE.md",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2FLICENSE.md",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2FLICENSE.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2FLICENSE.md?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -1,6 +1,6 @@\n # c-ares license\n \n-Copyright (c) 2007 - 2016, Daniel Stenberg with many contributors, see AUTHORS\n+Copyright (c) 2007 - 2018, Daniel Stenberg with many contributors, see AUTHORS\n file.\n \n Copyright 1998 by the Massachusetts Institute of Technology."
        },
        {
            "sha": "be7931f7743db16e7ea955e1433b0933752da8e8",
            "filename": "deps/cares/cares.gyp",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fcares.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fcares.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fcares.gyp?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -92,6 +92,7 @@\n         'src/ares_strdup.c',\n         'src/ares_strdup.h',\n         'src/ares_strerror.c',\n+        'src/ares_strsplit.c',\n         'src/ares_timeout.c',\n         'src/ares__timeval.c',\n         'src/ares_version.c',"
        },
        {
            "sha": "06f60b33304b806c57f1b155f54b4273f36bf9d1",
            "filename": "deps/cares/include/ares.h",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Finclude%2Fares.h",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Finclude%2Fares.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Finclude%2Fares.h?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -164,6 +164,7 @@ extern \"C\" {\n #define ARES_OPT_ROTATE         (1 << 14)\n #define ARES_OPT_EDNSPSZ        (1 << 15)\n #define ARES_OPT_NOROTATE       (1 << 16)\n+#define ARES_OPT_RESOLVCONF     (1 << 17)\n \n /* Nameinfo flag values */\n #define ARES_NI_NOFQDN                  (1 << 0)\n@@ -270,6 +271,7 @@ struct ares_options {\n   struct apattern *sortlist;\n   int nsort;\n   int ednspsz;\n+  char *resolvconf_path;\n };\n \n struct hostent;"
        },
        {
            "sha": "5e3ba9f0d8cb0cc0516f4f55a858203b4f0f4c2f",
            "filename": "deps/cares/include/ares_build.h",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Finclude%2Fares_build.h",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Finclude%2Fares_build.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Finclude%2Fares_build.h?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -194,16 +194,14 @@\n /* Data type definition of ares_ssize_t. */\n #ifdef _WIN32\n #  ifdef _WIN64\n-     typedef __int64 ares_ssize_t;\n+#    define CARES_TYPEOF_ARES_SSIZE_T __int64\n #  else\n-     typedef long ares_ssize_t;\n+#    define CARES_TYPEOF_ARES_SSIZE_T long\n #  endif\n #else\n-#  ifdef CARES_TYPEOF_ARES_SSIZE_T\n-     typedef CARES_TYPEOF_ARES_SSIZE_T ares_ssize_t;\n-#  else\n-     typedef ssize_t ares_ssize_t;\n-#  endif\n+#  define CARES_TYPEOF_ARES_SSIZE_T ssize_t\n #endif\n \n+typedef CARES_TYPEOF_ARES_SSIZE_T ares_ssize_t;\n+\n #endif /* __CARES_BUILD_H */"
        },
        {
            "sha": "cac23cf2e32db3430347102e8bd9cab35da53b8e",
            "filename": "deps/cares/include/ares_rules.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Finclude%2Fares_rules.h",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Finclude%2Fares_rules.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Finclude%2Fares_rules.h?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -83,7 +83,7 @@\n \n /*\n  * Verify that the size previously defined and expected for\n- * ares_socklen_t is actually the the same as the one reported\n+ * ares_socklen_t is actually the same as the one reported\n  * by sizeof() at compile time.\n  */\n "
        },
        {
            "sha": "62276fdf4e38c691248c803d5e668bd0b9c7b580",
            "filename": "deps/cares/src/RELEASE-NOTES",
            "status": "modified",
            "additions": 34,
            "deletions": 38,
            "changes": 72,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2FRELEASE-NOTES",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2FRELEASE-NOTES",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2FRELEASE-NOTES?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -1,47 +1,43 @@\n-c-ares version 1.14.0\n+c-ares version 1.15.0\n \n Changes:\n- o android: Introduce new ares_library_init_android() call for Oreo support. [5]\n+ o Add ares_init_options() configurability for path to resolv.conf file [1]\n+ o Ability to exclude building of tools (adig, ahost, acountry) in CMake [3]\n+ o Android: Support for domain search suffix [4]\n+ o Report ARES_ENOTFOUND for .onion domain names as per RFC7686. [13]\n \n Bug fixes:\n-\n- o Fix patch for CVE-2017-1000381 to not be overly aggressive. [1]\n- o win32: Preserve DNS server order returned by Windows when sorting and exclude\n-   DNS servers in legacy subnets. [2] [4]\n- o win32: Support most recent Visual Studio 2017\n- o gethostbyaddr should fail with ECANCELLED not ENOTFOUND when ares_cancel\n-   is called. [3]\n- o win32: Exclude legacy ipv6 subnets [4]\n- o android: Applications compiled for Oreo can no longer use\n-   __system_property_get and must use Java calls to retrieve DNS servers.\n-   [5] [7]\n- o win32: Force use of ANSI functions [6]\n- o CMake minimum version is now 3.1\n- o ares_gethostbyname.3: fix callback status values [8]\n- o docs: Document WSAStartup requirement [9]\n- o Fix a typo in init_by_resolv_conf [10]\n- o Android JNI code leaks local references in some cases [11]\n- o Force using the ANSI versions of WinAPI functions [12]\n+ o AIX build fix for trying to include both nameser_compat.h and\n+   onameser_compat.h [2]\n+ o Windows: Improve DNS suffixes extracting from WinNT registry [5]\n+ o Fix modern GCC warnings [6]\n+ o Apply the IPv6 server blacklist to all nameserver sources, not just Windows\n+   [7]\n+ o Fix warnings emitted by MSVC when using -W4 [8]\n+ o Prevent changing name servers while queries are outstanding [9]\n+ o Harden and rationalize c-ares timeout computation [10]\n+ o Distribute ares_android.h [11]\n+ o ares_set_servers_csv() on failure should not leave channel in a bad state\n+   [12]\n+ o Add missing docs to distribution\n \n Thanks go to these friendly people for their efforts and contributions:\n-\n-  AC Thompson, Anna Henningsen, Antonio Tajuelo, Brad House, Brad Spencer,\n-  Christian Ammer, Daniel Stenberg, David Drysdale, David Hotham, Felix Yan,\n-  Gergely Nagy, Gregor Jasny, Jakub Hrozek, John Schember,\n-  Konstantinos Sofokleous, Roman Teterin, Sergey Kolomenkin, Sheel Bedi,\n-  (18 contributors)\n+  @afalin, Andi Schnebinger, Ben Noordhuis, Brad House, Brad Spencer,\n+  David Hotham, @flyingdutchman23, John Schember, Ruslan Baratov,\n+  Sarat Addepalli, Tobias NieÃŸen (11 contributors)\n \n References to bug reports and discussions on issues:\n+ [1] = https://github.com/c-ares/c-ares/issues/220\n+ [2] = https://github.com/c-ares/c-ares/issues/224\n+ [3] = https://github.com/c-ares/c-ares/issues/200\n+ [4] = https://github.com/c-ares/c-ares/issues/207\n+ [5] = https://github.com/c-ares/c-ares/pull/202\n+ [6] = https://github.com/c-ares/c-ares/pull/201\n+ [7] = https://github.com/c-ares/c-ares/pull/193\n+ [8] = https://github.com/c-ares/c-ares/pull/192\n+ [9] = https://github.com/c-ares/c-ares/pull/191\n+ [10] = https://github.com/c-ares/c-ares/pull/187\n+ [11] = https://c-ares.haxx.se/mail/c-ares-archive-2018-04/0000.shtml\n+ [12] = https://c-ares.haxx.se/mail/c-ares-archive-2018-03/0000.shtml\n+ [13] = https://github.com/c-ares/c-ares/issues/196\n \n- [1] = https://github.com/c-ares/c-ares/commit/18ea99\n- [2] = https://github.com/c-ares/c-ares/issues/150\n- [3] = https://github.com/c-ares/c-ares/pull/138\n- [4] = https://github.com/c-ares/c-ares/pull/144\n- [5] = https://github.com/c-ares/c-ares/pull/148\n- [6] = https://github.com/c-ares/c-ares/pull/142\n- [7] = https://github.com/c-ares/c-ares/pull/175\n- [8] = https://c-ares.haxx.se/mail/c-ares-archive-2011-06/0012.shtml\n- [9] = https://github.com/c-ares/c-ares/pull/180\n- [10] = https://github.com/c-ares/c-ares/pull/160\n- [11] = https://github.com/c-ares/c-ares/pull/175\n- [12] = https://github.com/c-ares/c-ares/pull/142"
        },
        {
            "sha": "bf77131b58cf84c434b2d19b98ccd2a968ccb9bf",
            "filename": "deps/cares/src/ares_android.c",
            "status": "modified",
            "additions": 99,
            "deletions": 0,
            "changes": 99,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_android.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_android.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_android.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -30,6 +30,8 @@ static jmethodID android_cm_active_net_mid = NULL;\n static jmethodID android_cm_link_props_mid = NULL;\n /* LinkProperties.getDnsServers */\n static jmethodID android_lp_dns_servers_mid = NULL;\n+/* LinkProperties.getDomains */\n+static jmethodID android_lp_domains_mid = NULL;\n /* List.size */\n static jmethodID android_list_size_mid = NULL;\n /* List.get */\n@@ -139,6 +141,12 @@ int ares_library_init_android(jobject connectivity_manager)\n   if (android_lp_dns_servers_mid == NULL)\n     goto cleanup;\n \n+  /* getDomains in API 21. */\n+  android_lp_domains_mid = jni_get_method_id(env, obj_cls, \"getDomains\",\n+                                                 \"()Ljava/lang/String;\");\n+  if (android_lp_domains_mid == NULL)\n+    goto cleanup;\n+\n   (*env)->DeleteLocalRef(env, obj_cls);\n   obj_cls = jni_get_class(env, \"java/util/List\");\n   if (obj_cls == NULL)\n@@ -173,6 +181,7 @@ int ares_library_init_android(jobject connectivity_manager)\n   android_cm_active_net_mid = NULL;\n   android_cm_link_props_mid = NULL;\n   android_lp_dns_servers_mid = NULL;\n+  android_lp_domains_mid = NULL;\n   android_list_size_mid = NULL;\n   android_list_get_mid = NULL;\n   android_ia_host_addr_mid = NULL;\n@@ -213,6 +222,7 @@ void ares_library_cleanup_android(void)\n   android_cm_active_net_mid = NULL;\n   android_cm_link_props_mid = NULL;\n   android_lp_dns_servers_mid = NULL;\n+  android_lp_domains_mid = NULL;\n   android_list_size_mid = NULL;\n   android_list_get_mid = NULL;\n   android_ia_host_addr_mid = NULL;\n@@ -341,6 +351,95 @@ char **ares_get_android_server_list(size_t max_servers,\n     (*android_jvm)->DetachCurrentThread(android_jvm);\n   return dns_list;\n }\n+\n+char *ares_get_android_search_domains_list(void)\n+{\n+  JNIEnv *env = NULL;\n+  jobject active_network = NULL;\n+  jobject link_properties = NULL;\n+  jstring domains = NULL;\n+  const char *domain;\n+  int res;\n+  size_t i;\n+  size_t cnt = 0;\n+  char *domain_list = NULL;\n+  int need_detatch = 0;\n+\n+  if (android_jvm == NULL || android_connectivity_manager == NULL)\n+  {\n+    return NULL;\n+  }\n+\n+  if (android_cm_active_net_mid == NULL || android_cm_link_props_mid == NULL ||\n+      android_lp_domains_mid == NULL)\n+  {\n+    return NULL;\n+  }\n+\n+  res = (*android_jvm)->GetEnv(android_jvm, (void **)&env, JNI_VERSION_1_6);\n+  if (res == JNI_EDETACHED)\n+  {\n+    env = NULL;\n+    res = (*android_jvm)->AttachCurrentThread(android_jvm, &env, NULL);\n+    need_detatch = 1;\n+  }\n+  if (res != JNI_OK || env == NULL)\n+    goto done;\n+\n+  /* JNI below is equivalent to this Java code.\n+     import android.content.Context;\n+     import android.net.ConnectivityManager;\n+     import android.net.LinkProperties;\n+\n+     ConnectivityManager cm = (ConnectivityManager)this.getApplicationContext()\n+       .getSystemService(Context.CONNECTIVITY_SERVICE);\n+     Network an = cm.getActiveNetwork();\n+     LinkProperties lp = cm.getLinkProperties(an);\n+\t String domains = lp.getDomains();\n+     for (String domain: domains.split(\",\")) {\n+       String d = domain;\n+     }\n+\n+     Note: The JNI ConnectivityManager object and all method IDs were previously\n+           initialized in ares_library_init_android.\n+   */\n+\n+  active_network = (*env)->CallObjectMethod(env, android_connectivity_manager,\n+                                            android_cm_active_net_mid);\n+  if (active_network == NULL)\n+    goto done;\n+\n+  link_properties =\n+      (*env)->CallObjectMethod(env, android_connectivity_manager,\n+                               android_cm_link_props_mid, active_network);\n+  if (link_properties == NULL)\n+    goto done;\n+\n+  /* Get the domains. It is a common separated list of domains to search. */\n+  domains = (*env)->CallObjectMethod(env, link_properties,\n+                                         android_lp_domains_mid);\n+  if (domains == NULL)\n+    goto done;\n+\n+  /* Split on , */\n+  domain = (*env)->GetStringUTFChars(env, domains, 0);\n+  domain_list = ares_strdup(domain);\n+  (*env)->ReleaseStringUTFChars(env, domains, domain);\n+  (*env)->DeleteLocalRef(env, domains);\n+\n+done:\n+  if ((*env)->ExceptionOccurred(env))\n+    (*env)->ExceptionClear(env);\n+\n+  if (link_properties != NULL)\n+    (*env)->DeleteLocalRef(env, link_properties);\n+  if (active_network != NULL)\n+    (*env)->DeleteLocalRef(env, active_network);\n+\n+  if (need_detatch)\n+    (*android_jvm)->DetachCurrentThread(android_jvm);\n+  return domain_list;\n+}\n #else\n /* warning: ISO C forbids an empty translation unit */\n typedef int dummy_make_iso_compilers_happy;"
        },
        {
            "sha": "93fb75f585057e72487c806be864af6f834ef6d7",
            "filename": "deps/cares/src/ares_android.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_android.h",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_android.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_android.h?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -19,6 +19,7 @@\n #if defined(ANDROID) || defined(__ANDROID__)\n \n char **ares_get_android_server_list(size_t max_servers, size_t *num_servers);\n+char *ares_get_android_search_domains_list(void);\n void ares_library_cleanup_android(void);\n \n #endif"
        },
        {
            "sha": "1606b1a10047063498715201fbed8fa318cec1a9",
            "filename": "deps/cares/src/ares_create_query.c",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_create_query.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_create_query.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_create_query.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -94,6 +94,10 @@ int ares_create_query(const char *name, int dnsclass, int type,\n   size_t buflen;\n   unsigned char *buf;\n \n+  /* Per RFC 7686, reject queries for \".onion\" domain names with NXDOMAIN. */\n+  if (ares__is_onion_domain(name))\n+    return ARES_ENOTFOUND;\n+\n   /* Set our results early, in case we bail out early with an error. */\n   *buflenp = 0;\n   *bufp = NULL;\n@@ -188,7 +192,7 @@ int ares_create_query(const char *name, int dnsclass, int type,\n    * specified in RFC 1035 (\"To simplify implementations, the total length of\n    * a domain name (i.e., label octets and label length octets) is restricted\n    * to 255 octets or less.\"). */\n-  if (buflen > (MAXCDNAME + HFIXEDSZ + QFIXEDSZ +\n+  if (buflen > (size_t)(MAXCDNAME + HFIXEDSZ + QFIXEDSZ +\n                 (max_udp_size ? EDNSFIXEDSZ : 0))) {\n     ares_free (buf);\n     return ARES_EBADNAME;"
        },
        {
            "sha": "fed2009ab324ff9557548c7588683083be6ec66d",
            "filename": "deps/cares/src/ares_destroy.c",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_destroy.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_destroy.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_destroy.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -36,6 +36,8 @@ void ares_destroy_options(struct ares_options *options)\n     ares_free(options->sortlist);\n   if(options->lookups)\n     ares_free(options->lookups);\n+  if(options->resolvconf_path)\n+    ares_free(options->resolvconf_path);\n }\n \n void ares_destroy(ares_channel channel)\n@@ -44,7 +46,7 @@ void ares_destroy(ares_channel channel)\n   struct query *query;\n   struct list_node* list_head;\n   struct list_node* list_node;\n-  \n+\n   if (!channel)\n     return;\n \n@@ -85,6 +87,9 @@ void ares_destroy(ares_channel channel)\n   if (channel->lookups)\n     ares_free(channel->lookups);\n \n+  if (channel->resolvconf_path)\n+    ares_free(channel->resolvconf_path);\n+\n   ares_free(channel);\n }\n "
        },
        {
            "sha": "8187746bb14c7f6a8398d22004cb6319c7e5ef14",
            "filename": "deps/cares/src/ares_gethostbyname.c",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_gethostbyname.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_gethostbyname.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_gethostbyname.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -95,6 +95,13 @@ void ares_gethostbyname(ares_channel channel, const char *name, int family,\n     return;\n   }\n \n+  /* Per RFC 7686, reject queries for \".onion\" domain names with NXDOMAIN. */\n+  if (ares__is_onion_domain(name))\n+    {\n+      callback(arg, ARES_ENOTFOUND, 0, NULL);\n+      return;\n+    }\n+\n   if (fake_hostent(name, family, callback, arg))\n     return;\n \n@@ -339,6 +346,10 @@ static int file_lookup(const char *name, int family, struct hostent **host)\n   int status;\n   int error;\n \n+  /* Per RFC 7686, reject queries for \".onion\" domain names with NXDOMAIN. */\n+  if (ares__is_onion_domain(name))\n+    return ARES_ENOTFOUND;\n+\n #ifdef WIN32\n   char PATH_HOSTS[MAX_PATH];\n   win_platform platform;"
        },
        {
            "sha": "aa089417060fec5cc037283d1d7295437ca53e60",
            "filename": "deps/cares/src/ares_getnameinfo.c",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_getnameinfo.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_getnameinfo.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_getnameinfo.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -440,3 +440,14 @@ STATIC_TESTABLE char *ares_striendstr(const char *s1, const char *s2)\n     }\n   return (char *)c1_begin;\n }\n+\n+int ares__is_onion_domain(const char *name)\n+{\n+  if (ares_striendstr(name, \".onion\"))\n+    return 1;\n+\n+  if (ares_striendstr(name, \".onion.\"))\n+    return 1;\n+\n+  return 0;\n+}"
        },
        {
            "sha": "c2c00d65237072d8e3b5d572b8510c536a05a0a6",
            "filename": "deps/cares/src/ares_init.c",
            "status": "modified",
            "additions": 186,
            "deletions": 214,
            "changes": 400,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_init.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_init.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_init.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -169,6 +169,7 @@ int ares_init_options(ares_channel *channelptr, struct ares_options *options,\n   channel->sock_config_cb_data = NULL;\n   channel->sock_funcs = NULL;\n   channel->sock_func_cb_data = NULL;\n+  channel->resolvconf_path = NULL;\n \n   channel->last_server = 0;\n   channel->last_timeout_processed = (time_t)now.tv_sec;\n@@ -236,16 +237,14 @@ int ares_init_options(ares_channel *channelptr, struct ares_options *options,\n       /* Something failed; clean up memory we may have allocated. */\n       if (channel->servers)\n         ares_free(channel->servers);\n-      if (channel->domains)\n-        {\n-          for (i = 0; i < channel->ndomains; i++)\n-            ares_free(channel->domains[i]);\n-          ares_free(channel->domains);\n-        }\n+      if (channel->ndomains != -1)\n+        ares_strsplit_free(channel->domains, channel->ndomains);\n       if (channel->sortlist)\n         ares_free(channel->sortlist);\n       if(channel->lookups)\n         ares_free(channel->lookups);\n+      if(channel->resolvconf_path)\n+        ares_free(channel->resolvconf_path);\n       ares_free(channel);\n       return status;\n     }\n@@ -299,7 +298,7 @@ int ares_dup(ares_channel *dest, ares_channel src)\n   (*dest)->sock_func_cb_data   = src->sock_func_cb_data;\n \n   strncpy((*dest)->local_dev_name, src->local_dev_name,\n-          sizeof(src->local_dev_name));\n+          sizeof((*dest)->local_dev_name));\n   (*dest)->local_ip4 = src->local_ip4;\n   memcpy((*dest)->local_ip6, src->local_ip6, sizeof(src->local_ip6));\n \n@@ -354,6 +353,9 @@ int ares_save_options(ares_channel channel, struct ares_options *options,\n                 ARES_OPT_SORTLIST|ARES_OPT_TIMEOUTMS);\n   (*optmask) |= (channel->rotate ? ARES_OPT_ROTATE : ARES_OPT_NOROTATE);\n \n+  if (channel->resolvconf_path)\n+    (*optmask) |= ARES_OPT_RESOLVCONF;\n+\n   /* Copy easy stuff */\n   options->flags   = channel->flags;\n \n@@ -426,6 +428,13 @@ int ares_save_options(ares_channel channel, struct ares_options *options,\n   }\n   options->nsort = channel->nsort;\n \n+  /* copy path for resolv.conf file */\n+  if (channel->resolvconf_path) {\n+    options->resolvconf_path = ares_strdup(channel->resolvconf_path);\n+    if (!options->resolvconf_path)\n+      return ARES_ENOMEM;\n+  }\n+\n   return ARES_SUCCESS;\n }\n \n@@ -534,6 +543,14 @@ static int init_by_options(ares_channel channel,\n     channel->nsort = options->nsort;\n   }\n \n+  /* Set path for resolv.conf file, if given. */\n+  if ((optmask & ARES_OPT_RESOLVCONF) && !channel->resolvconf_path)\n+    {\n+      channel->resolvconf_path = ares_strdup(options->resolvconf_path);\n+      if (!channel->resolvconf_path && options->resolvconf_path)\n+        return ARES_ENOMEM;\n+    }\n+\n   channel->optmask = optmask;\n \n   return ARES_SUCCESS;\n@@ -997,63 +1014,6 @@ static int compareAddresses(const void *arg1,\n   return 0;\n }\n \n-/* Validate that the ip address matches the subnet (network base and network\n- * mask) specified. Addresses are specified in standard Network Byte Order as\n- * 16 bytes, and the netmask is 0 to 128 (bits).\n- */\n-static int ares_ipv6_subnet_matches(const unsigned char netbase[16],\n-                                    unsigned char netmask,\n-                                    const unsigned char ipaddr[16])\n-{\n-  unsigned char mask[16] = { 0 };\n-  unsigned char i;\n-\n-  /* Misuse */\n-  if (netmask > 128)\n-    return 0;\n-\n-  /* Quickly set whole bytes */\n-  memset(mask, 0xFF, netmask / 8);\n-\n-  /* Set remaining bits */\n-  if(netmask % 8) {\n-    mask[netmask / 8] = (unsigned char)(0xff << (8 - (netmask % 8)));\n-  }\n-\n-  for (i=0; i<16; i++) {\n-    if ((netbase[i] & mask[i]) != (ipaddr[i] & mask[i]))\n-      return 0;\n-  }\n-\n-  return 1;\n-}\n-\n-static int ares_ipv6_server_blacklisted(const unsigned char ipaddr[16])\n-{\n-  const struct {\n-    const char   *netbase;\n-    unsigned char netmask;\n-  } blacklist[] = {\n-    /* Deprecated by [RFC3879] in September 2004. Formerly a Site-Local scoped\n-     * address prefix. Causes known issues on Windows as these are not valid DNS\n-     * servers. */\n-    { \"fec0::\", 10 },\n-    { NULL,     0  }\n-  };\n-  size_t i;\n-\n-  for (i=0; blacklist[i].netbase != NULL; i++) {\n-    unsigned char netbase[16];\n-\n-    if (ares_inet_pton(AF_INET6, blacklist[i].netbase, netbase) != 1)\n-      continue;\n-\n-    if (ares_ipv6_subnet_matches(netbase, blacklist[i].netmask, ipaddr))\n-      return 1;\n-  }\n-  return 0;\n-}\n-\n /* There can be multiple routes to \"the Internet\".  And there can be different\n  * DNS servers associated with each of the interfaces that offer those routes.\n  * We have to assume that any DNS server can serve any request.  But, some DNS\n@@ -1257,7 +1217,7 @@ static int get_DNS_AdaptersAddresses(char **outptr)\n         }\n         else\n         {\n-          addresses[addressesIndex].metric = -1;\n+          addresses[addressesIndex].metric = (ULONG)-1;\n         }\n \n         /* Record insertion index to make qsort stable */\n@@ -1272,20 +1232,10 @@ static int get_DNS_AdaptersAddresses(char **outptr)\n       }\n       else if (namesrvr.sa->sa_family == AF_INET6)\n       {\n-        /* Windows apparently always reports some IPv6 DNS servers that\n-         * prefixed with fec0:0:0:ffff. These ususally do not point to\n-         * working DNS servers, so we ignore them. */\n-        if (strncmp(addresses[addressesIndex].text, \"fec0:0:0:ffff:\", 14) == 0)\n-          continue;\n         if (memcmp(&namesrvr.sa6->sin6_addr, &ares_in6addr_any,\n                    sizeof(namesrvr.sa6->sin6_addr)) == 0)\n           continue;\n \n-        if (ares_ipv6_server_blacklisted(\n-              (const unsigned char *)&namesrvr.sa6->sin6_addr)\n-           )\n-          continue;\n-\n         /* Allocate room for another address, if necessary, else skip. */\n         if(addressesIndex == addressesSize) {\n           const size_t newSize = addressesSize + 4;\n@@ -1309,7 +1259,7 @@ static int get_DNS_AdaptersAddresses(char **outptr)\n         }\n         else\n         {\n-          addresses[addressesIndex].metric = -1;\n+          addresses[addressesIndex].metric = (ULONG)-1;\n         }\n \n         /* Record insertion index to make qsort stable */\n@@ -1394,59 +1344,6 @@ static int get_DNS_Windows(char **outptr)\n   return get_DNS_Registry(outptr);\n }\n \n-static void replace_comma_by_space(char* str)\n-{\n-  /* replace ',' by ' ' to coincide with resolv.conf search parameter */\n-  char *p;\n-  for (p = str; *p != '\\0'; p++)\n-  {\n-    if (*p == ',')\n-      *p = ' ';\n-  }\n-}\n-\n-/* Search if 'suffix' is containted in the 'searchlist'. Returns true if yes,\n- * otherwise false. 'searchlist' is a comma separated list of domain suffixes,\n- * 'suffix' is one domain suffix, 'len' is the length of 'suffix'.\n- * The search ignores case. E.g.:\n- * contains_suffix(\"abc.def,ghi.jkl\", \"ghi.JKL\") returns true  */\n-static bool contains_suffix(const char* const searchlist,\n-                            const char* const suffix, const size_t len)\n-{\n-  const char* beg = searchlist;\n-  const char* end;\n-  if (!*suffix)\n-    return true;\n-  for (;;)\n-  {\n-    while (*beg && (ISSPACE(*beg) || (*beg == ',')))\n-      ++beg;\n-    if (!*beg)\n-      return false;\n-    end = beg;\n-    while (*end && !ISSPACE(*end) && (*end != ','))\n-      ++end;\n-    if (len == (end - beg) && !strnicmp(beg, suffix, len))\n-      return true;\n-    beg = end;\n-  }\n-}\n-\n-/* advances list to the next suffix within a comma separated search list.\n- * len is the length of the next suffix. */\n-static size_t next_suffix(const char** list, const size_t advance)\n-{\n-  const char* beg = *list + advance;\n-  const char* end;\n-  while (*beg && (ISSPACE(*beg) || (*beg == ',')))\n-    ++beg;\n-  end = beg;\n-  while (*end && !ISSPACE(*end) && (*end != ','))\n-    ++end;\n-  *list = beg;\n-  return end - beg;\n-}\n-\n /*\n  * get_SuffixList_Windows()\n  *\n@@ -1467,8 +1364,6 @@ static int get_SuffixList_Windows(char **outptr)\n   DWORD keyNameBuffSize;\n   DWORD keyIdx = 0;\n   char *p = NULL;\n-  const char *pp;\n-  size_t len = 0;\n \n   *outptr = NULL;\n \n@@ -1479,57 +1374,80 @@ static int get_SuffixList_Windows(char **outptr)\n   if (RegOpenKeyExA(HKEY_LOCAL_MACHINE, WIN_NS_NT_KEY, 0,\n       KEY_READ, &hKey) == ERROR_SUCCESS)\n   {\n-    if (get_REG_SZ(hKey, SEARCHLIST_KEY, outptr))\n-      replace_comma_by_space(*outptr);\n+    get_REG_SZ(hKey, SEARCHLIST_KEY, outptr);\n+    if (get_REG_SZ(hKey, DOMAIN_KEY, &p))\n+    {\n+      commajoin(outptr, p);\n+      ares_free(p);\n+      p = NULL;\n+    }\n+    RegCloseKey(hKey);\n+  }\n+\n+  if (RegOpenKeyExA(HKEY_LOCAL_MACHINE, WIN_NT_DNSCLIENT, 0,\n+      KEY_READ, &hKey) == ERROR_SUCCESS)\n+  {\n+    if (get_REG_SZ(hKey, SEARCHLIST_KEY, &p))\n+    {\n+      commajoin(outptr, p);\n+      ares_free(p);\n+      p = NULL;\n+    }\n     RegCloseKey(hKey);\n-    if (*outptr)\n-      return 1;\n   }\n \n   /* 2. Connection Specific Search List composed of:\n    *  a. Primary DNS Suffix */\n   if (RegOpenKeyExA(HKEY_LOCAL_MACHINE, WIN_DNSCLIENT, 0,\n       KEY_READ, &hKey) == ERROR_SUCCESS)\n   {\n-    get_REG_SZ(hKey, PRIMARYDNSSUFFIX_KEY, outptr);\n+    if (get_REG_SZ(hKey, PRIMARYDNSSUFFIX_KEY, &p))\n+    {\n+      commajoin(outptr, p);\n+      ares_free(p);\n+      p = NULL;\n+    }\n     RegCloseKey(hKey);\n   }\n-  if (!*outptr)\n-    return 0;\n \n   /*  b. Interface SearchList, Domain, DhcpDomain */\n-  if (!RegOpenKeyExA(HKEY_LOCAL_MACHINE, WIN_NS_NT_KEY \"\\\\\" INTERFACES_KEY, 0,\n+  if (RegOpenKeyExA(HKEY_LOCAL_MACHINE, WIN_NS_NT_KEY \"\\\\\" INTERFACES_KEY, 0,\n       KEY_READ, &hKey) == ERROR_SUCCESS)\n-    return 0;\n-  for(;;)\n   {\n-    keyNameBuffSize = sizeof(keyName);\n-    if (RegEnumKeyExA(hKey, keyIdx++, keyName, &keyNameBuffSize,\n-        0, NULL, NULL, NULL)\n-        != ERROR_SUCCESS)\n-      break;\n-    if (RegOpenKeyExA(hKey, keyName, 0, KEY_QUERY_VALUE, &hKeyEnum)\n-        != ERROR_SUCCESS)\n-      continue;\n-    if (get_REG_SZ(hKeyEnum, SEARCHLIST_KEY, &p) ||\n-        get_REG_SZ(hKeyEnum, DOMAIN_KEY, &p) ||\n-        get_REG_SZ(hKeyEnum, DHCPDOMAIN_KEY, &p))\n+    for(;;)\n     {\n+      keyNameBuffSize = sizeof(keyName);\n+      if (RegEnumKeyExA(hKey, keyIdx++, keyName, &keyNameBuffSize,\n+          0, NULL, NULL, NULL)\n+          != ERROR_SUCCESS)\n+        break;\n+      if (RegOpenKeyExA(hKey, keyName, 0, KEY_QUERY_VALUE, &hKeyEnum)\n+          != ERROR_SUCCESS)\n+        continue;\n       /* p can be comma separated (SearchList) */\n-      pp = p;\n-      while ((len = next_suffix(&pp, len)) != 0)\n+      if (get_REG_SZ(hKeyEnum, SEARCHLIST_KEY, &p))\n       {\n-        if (!contains_suffix(*outptr, pp, len))\n-          commanjoin(outptr, pp, len);\n+        commajoin(outptr, p);\n+        ares_free(p);\n+        p = NULL;\n       }\n-      ares_free(p);\n-      p = NULL;\n+      if (get_REG_SZ(hKeyEnum, DOMAIN_KEY, &p))\n+      {\n+        commajoin(outptr, p);\n+        ares_free(p);\n+        p = NULL;\n+      }\n+      if (get_REG_SZ(hKeyEnum, DHCPDOMAIN_KEY, &p))\n+      {\n+        commajoin(outptr, p);\n+        ares_free(p);\n+        p = NULL;\n+      }\n+      RegCloseKey(hKeyEnum);\n     }\n-    RegCloseKey(hKeyEnum);\n+    RegCloseKey(hKey);\n   }\n-  RegCloseKey(hKey);\n-  if (*outptr)\n-    replace_comma_by_space(*outptr);\n+\n   return *outptr != NULL;\n }\n \n@@ -1628,6 +1546,7 @@ static int init_by_resolv_conf(ares_channel channel)\n   char propname[PROP_NAME_MAX];\n   char propvalue[PROP_VALUE_MAX]=\"\";\n   char **dns_servers;\n+  char *domains;\n   size_t num_servers;\n \n   /* Use the Android connectivity manager to get a list\n@@ -1652,6 +1571,12 @@ static int init_by_resolv_conf(ares_channel channel)\n     }\n     ares_free(dns_servers);\n   }\n+  if (channel->ndomains == -1)\n+  {\n+    domains = ares_get_android_search_domains_list();\n+    set_search(channel, domains);\n+    ares_free(domains);\n+  }\n \n #  ifdef HAVE___SYSTEM_PROPERTY_GET\n   /* Old way using the system property still in place as\n@@ -1740,6 +1665,7 @@ static int init_by_resolv_conf(ares_channel channel)\n     size_t linesize;\n     int error;\n     int update_domains;\n+    const char *resolvconf_path;\n \n     /* Don't read resolv.conf and friends if we don't have to */\n     if (ARES_CONFIG_CHECK(channel))\n@@ -1748,7 +1674,14 @@ static int init_by_resolv_conf(ares_channel channel)\n     /* Only update search domains if they're not already specified */\n     update_domains = (channel->ndomains == -1);\n \n-    fp = fopen(PATH_RESOLV_CONF, \"r\");\n+    /* Support path for resolvconf filename set by ares_init_options */\n+    if(channel->resolvconf_path) {\n+      resolvconf_path = channel->resolvconf_path;\n+    } else {\n+      resolvconf_path = PATH_RESOLV_CONF;\n+    }\n+\n+    fp = fopen(resolvconf_path, \"r\");\n     if (fp) {\n       while ((status = ares__read_line(fp, &line, &linesize)) == ARES_SUCCESS)\n       {\n@@ -1759,10 +1692,10 @@ static int init_by_resolv_conf(ares_channel channel)\n         else if ((p = try_config(line, \"search\", ';')) && update_domains)\n           status = set_search(channel, p);\n         else if ((p = try_config(line, \"nameserver\", ';')) &&\n-                 channel->nservers == -1)\n+                channel->nservers == -1)\n           status = config_nameserver(&servers, &nservers, p);\n         else if ((p = try_config(line, \"sortlist\", ';')) &&\n-                 channel->nsort == -1)\n+                channel->nsort == -1)\n           status = config_sortlist(&sortlist, &nsort, p);\n         else if ((p = try_config(line, \"options\", ';')))\n           status = set_options(channel, p);\n@@ -1782,7 +1715,7 @@ static int init_by_resolv_conf(ares_channel channel)\n         break;\n       default:\n         DEBUGF(fprintf(stderr, \"fopen() failed with error: %d %s\\n\",\n-                       error, strerror(error)));\n+                      error, strerror(error)));\n         DEBUGF(fprintf(stderr, \"Error opening file: %s\\n\", PATH_RESOLV_CONF));\n         status = ARES_EFILE;\n       }\n@@ -2050,6 +1983,11 @@ static int init_by_defaults(ares_channel channel)\n       ares_free(channel->lookups);\n       channel->lookups = NULL;\n     }\n+\n+    if(channel->resolvconf_path) {\n+      ares_free(channel->resolvconf_path);\n+      channel->resolvconf_path = NULL;\n+    }\n   }\n \n   if(hostname)\n@@ -2114,6 +2052,76 @@ static int config_lookup(ares_channel channel, const char *str,\n #endif  /* !WIN32 & !WATT32 & !ANDROID & !__ANDROID__ & !CARES_USE_LIBRESOLV */\n \n #ifndef WATT32\n+/* Validate that the ip address matches the subnet (network base and network\n+ * mask) specified. Addresses are specified in standard Network Byte Order as\n+ * 16 bytes, and the netmask is 0 to 128 (bits).\n+ */\n+static int ares_ipv6_subnet_matches(const unsigned char netbase[16],\n+                                    unsigned char netmask,\n+                                    const unsigned char ipaddr[16])\n+{\n+  unsigned char mask[16] = { 0 };\n+  unsigned char i;\n+\n+  /* Misuse */\n+  if (netmask > 128)\n+    return 0;\n+\n+  /* Quickly set whole bytes */\n+  memset(mask, 0xFF, netmask / 8);\n+\n+  /* Set remaining bits */\n+  if(netmask % 8) {\n+    mask[netmask / 8] = (unsigned char)(0xff << (8 - (netmask % 8)));\n+  }\n+\n+  for (i=0; i<16; i++) {\n+    if ((netbase[i] & mask[i]) != (ipaddr[i] & mask[i]))\n+      return 0;\n+  }\n+\n+  return 1;\n+}\n+\n+/* Return true iff the IPv6 ipaddr is blacklisted. */\n+static int ares_ipv6_server_blacklisted(const unsigned char ipaddr[16])\n+{\n+  /* A list of blacklisted IPv6 subnets. */\n+  const struct {\n+    const unsigned char netbase[16];\n+    unsigned char netmask;\n+  } blacklist[] = {\n+    /* fec0::/10 was deprecated by [RFC3879] in September 2004. Formerly a\n+     * Site-Local scoped address prefix.  These are never valid DNS servers,\n+     * but are known to be returned at least sometimes on Windows and Android.\n+     */\n+    {\n+      {\n+        0xfe, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n+        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00\n+      },\n+      10\n+    }\n+  };\n+  size_t i;\n+\n+  /* See if ipaddr matches any of the entries in the blacklist. */\n+  for (i = 0; i < sizeof(blacklist) / sizeof(blacklist[0]); ++i) {\n+    if (ares_ipv6_subnet_matches(\n+          blacklist[i].netbase, blacklist[i].netmask, ipaddr))\n+      return 1;\n+  }\n+  return 0;\n+}\n+\n+/* Add the IPv4 or IPv6 nameservers in str (separated by commas) to the\n+ * servers list, updating servers and nservers as required.\n+ *\n+ * This will silently ignore blacklisted IPv6 nameservers as detected by\n+ * ares_ipv6_server_blacklisted().\n+ *\n+ * Returns an error code on failure, else ARES_SUCCESS.\n+ */\n static int config_nameserver(struct server_state **servers, int *nservers,\n                              char *str)\n {\n@@ -2148,7 +2156,10 @@ static int config_nameserver(struct server_state **servers, int *nservers,\n       /* Convert textual address to binary format. */\n       if (ares_inet_pton(AF_INET, txtaddr, &host.addrV4) == 1)\n         host.family = AF_INET;\n-      else if (ares_inet_pton(AF_INET6, txtaddr, &host.addrV6) == 1)\n+      else if (ares_inet_pton(AF_INET6, txtaddr, &host.addrV6) == 1\n+               /* Silently skip blacklisted IPv6 servers. */\n+               && !ares_ipv6_server_blacklisted(\n+                    (const unsigned char *)&host.addrV6))\n         host.family = AF_INET6;\n       else\n         continue;\n@@ -2271,61 +2282,22 @@ static int config_sortlist(struct apattern **sortlist, int *nsort,\n \n static int set_search(ares_channel channel, const char *str)\n {\n-  int n;\n-  const char *p, *q;\n+  size_t cnt;\n \n   if(channel->ndomains != -1) {\n     /* LCOV_EXCL_START: all callers check ndomains == -1 */\n     /* if we already have some domains present, free them first */\n-    for(n=0; n < channel->ndomains; n++)\n-      ares_free(channel->domains[n]);\n-    ares_free(channel->domains);\n+    ares_strsplit_free(channel->domains, channel->ndomains);\n     channel->domains = NULL;\n     channel->ndomains = -1;\n   } /* LCOV_EXCL_STOP */\n \n-  /* Count the domains given. */\n-  n = 0;\n-  p = str;\n-  while (*p)\n-    {\n-      while (*p && !ISSPACE(*p))\n-        p++;\n-      while (ISSPACE(*p))\n-        p++;\n-      n++;\n-    }\n-\n-  if (!n)\n-    {\n-      channel->ndomains = 0;\n-      return ARES_SUCCESS;\n-    }\n-\n-  channel->domains = ares_malloc(n * sizeof(char *));\n-  if (!channel->domains)\n-    return ARES_ENOMEM;\n-\n-  /* Now copy the domains. */\n-  n = 0;\n-  p = str;\n-  while (*p)\n-    {\n-      channel->ndomains = n;\n-      q = p;\n-      while (*q && !ISSPACE(*q))\n-        q++;\n-      channel->domains[n] = ares_malloc(q - p + 1);\n-      if (!channel->domains[n])\n-        return ARES_ENOMEM;\n-      memcpy(channel->domains[n], p, q - p);\n-      channel->domains[n][q - p] = 0;\n-      p = q;\n-      while (ISSPACE(*p))\n-        p++;\n-      n++;\n-    }\n-  channel->ndomains = n;\n+  channel->domains  = ares_strsplit(str, \", \", 1, &cnt);\n+  channel->ndomains = (int)cnt;\n+  if (channel->domains == NULL || channel->ndomains == 0) {\n+    channel->domains  = NULL;\n+    channel->ndomains = -1;\n+  }\n \n   return ARES_SUCCESS;\n }"
        },
        {
            "sha": "67563499bec27609e154b45d4e9aff0f5fd37a3a",
            "filename": "deps/cares/src/ares_library_init.c",
            "status": "modified",
            "additions": 13,
            "deletions": 3,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_library_init.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_library_init.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_library_init.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -40,9 +40,19 @@ static unsigned int ares_initialized;\n static int          ares_init_flags;\n \n /* library-private global vars with visibility across the whole library */\n-void *(*ares_malloc)(size_t size) = malloc;\n-void *(*ares_realloc)(void *ptr, size_t size) = realloc;\n-void (*ares_free)(void *ptr) = free;\n+#if defined(WIN32)\n+/* We need indirections to handle Windows DLL rules. */\n+static void *default_malloc(size_t size) { return malloc(size); }\n+static void *default_realloc(void *p, size_t size) { return realloc(p, size); }\n+static void default_free(void *p) { free(p); }\n+#else\n+# define default_malloc malloc\n+# define default_realloc realloc\n+# define default_free free\n+#endif\n+void *(*ares_malloc)(size_t size) = default_malloc;\n+void *(*ares_realloc)(void *ptr, size_t size) = default_realloc;\n+void (*ares_free)(void *ptr) = default_free;\n \n #ifdef USE_WINSOCK\n static HMODULE hnd_iphlpapi;"
        },
        {
            "sha": "de49de4625996f5269c82511e89ad075f482dbfd",
            "filename": "deps/cares/src/ares_options.c",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_options.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_options.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_options.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -153,6 +153,9 @@ int ares_set_servers(ares_channel channel,\n   if (!channel)\n     return ARES_ENODATA;\n \n+  if (!ares__is_list_empty(&channel->all_queries))\n+    return ARES_ENOTIMP;\n+\n   ares__destroy_servers_state(channel);\n \n   for (srvr = servers; srvr; srvr = srvr->next)\n@@ -202,6 +205,9 @@ int ares_set_servers_ports(ares_channel channel,\n   if (!channel)\n     return ARES_ENODATA;\n \n+  if (!ares__is_list_empty(&channel->all_queries))\n+    return ARES_ENOTIMP;\n+\n   ares__destroy_servers_state(channel);\n \n   for (srvr = servers; srvr; srvr = srvr->next)\n@@ -258,8 +264,6 @@ static int set_servers_csv(ares_channel channel,\n   if (!channel)\n     return ARES_ENODATA;\n \n-  ares__destroy_servers_state(channel);\n-\n   i = strlen(_csv);\n   if (i == 0)\n      return ARES_SUCCESS; /* blank all servers */"
        },
        {
            "sha": "29e22cb17b6bd676236afb56f80adacd9e57af5f",
            "filename": "deps/cares/src/ares_parse_ptr_reply.c",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_parse_ptr_reply.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_parse_ptr_reply.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_parse_ptr_reply.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -52,6 +52,7 @@ int ares_parse_ptr_reply(const unsigned char *abuf, int alen, const void *addr,\n   int aliascnt = 0;\n   int alias_alloc = 8;\n   char ** aliases;\n+  size_t rr_data_len;\n \n   /* Set *host to NULL for all failure cases. */\n   *host = NULL;\n@@ -124,14 +125,15 @@ int ares_parse_ptr_reply(const unsigned char *abuf, int alen, const void *addr,\n           if (hostname)\n             ares_free(hostname);\n           hostname = rr_data;\n-          aliases[aliascnt] = ares_malloc((strlen(rr_data)+1) * sizeof(char));\n+          rr_data_len = strlen(rr_data)+1;\n+          aliases[aliascnt] = ares_malloc(rr_data_len * sizeof(char));\n           if (!aliases[aliascnt])\n             {\n               ares_free(rr_name);\n               status = ARES_ENOMEM;\n               break;\n             }\n-          strncpy(aliases[aliascnt], rr_data, strlen(rr_data)+1);\n+          strncpy(aliases[aliascnt], rr_data, rr_data_len);\n           aliascnt++;\n           if (aliascnt >= alias_alloc) {\n             char **ptr;"
        },
        {
            "sha": "1990f6902fc75edf8de89870c8206f38c6d3c7f9",
            "filename": "deps/cares/src/ares_private.h",
            "status": "modified",
            "additions": 19,
            "deletions": 11,
            "changes": 30,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_private.h",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_private.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_private.h?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -52,18 +52,19 @@\n \n #if defined(WIN32) && !defined(WATT32)\n \n-#define WIN_NS_9X      \"System\\\\CurrentControlSet\\\\Services\\\\VxD\\\\MSTCP\"\n-#define WIN_NS_NT_KEY  \"System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters\"\n-#define WIN_DNSCLIENT  \"Software\\\\Policies\\\\Microsoft\\\\System\\\\DNSClient\"\n-#define NAMESERVER     \"NameServer\"\n-#define DHCPNAMESERVER \"DhcpNameServer\"\n-#define DATABASEPATH   \"DatabasePath\"\n-#define WIN_PATH_HOSTS  \"\\\\hosts\"\n-#define SEARCHLIST_KEY \"SearchList\"\n+#define WIN_NS_9X            \"System\\\\CurrentControlSet\\\\Services\\\\VxD\\\\MSTCP\"\n+#define WIN_NS_NT_KEY        \"System\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters\"\n+#define WIN_DNSCLIENT        \"Software\\\\Policies\\\\Microsoft\\\\System\\\\DNSClient\"\n+#define WIN_NT_DNSCLIENT     \"Software\\\\Policies\\\\Microsoft\\\\Windows NT\\\\DNSClient\"\n+#define NAMESERVER           \"NameServer\"\n+#define DHCPNAMESERVER       \"DhcpNameServer\"\n+#define DATABASEPATH         \"DatabasePath\"\n+#define WIN_PATH_HOSTS       \"\\\\hosts\"\n+#define SEARCHLIST_KEY       \"SearchList\"\n #define PRIMARYDNSSUFFIX_KEY \"PrimaryDNSSuffix\"\n-#define INTERFACES_KEY \"Interfaces\"\n-#define DOMAIN_KEY     \"Domain\"\n-#define DHCPDOMAIN_KEY \"DhcpDomain\"\n+#define INTERFACES_KEY       \"Interfaces\"\n+#define DOMAIN_KEY           \"Domain\"\n+#define DHCPDOMAIN_KEY       \"DhcpDomain\"\n \n #elif defined(WATT32)\n \n@@ -100,6 +101,7 @@\n #endif\n \n #include \"ares_strdup.h\"\n+#include \"ares_strsplit.h\"\n \n #ifndef HAVE_STRCASECMP\n #  include \"ares_strcasecmp.h\"\n@@ -323,8 +325,14 @@ struct ares_channeldata {\n \n   const struct ares_socket_functions * sock_funcs;\n   void *sock_func_cb_data;\n+\n+  /* Path for resolv.conf file, configurable via ares_options */\n+  char *resolvconf_path;\n };\n \n+/* Does the domain end in \".onion\" or \".onion.\"? Case-insensitive. */\n+int ares__is_onion_domain(const char *name);\n+\n /* Memory management functions */\n extern void *(*ares_malloc)(size_t size);\n extern void *(*ares_realloc)(void *ptr, size_t size);"
        },
        {
            "sha": "df9f290bb133a6c9417fd723ac1049e568a989ad",
            "filename": "deps/cares/src/ares_process.c",
            "status": "modified",
            "additions": 27,
            "deletions": 2,
            "changes": 29,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_process.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_process.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_process.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -53,6 +53,7 @@\n \n #include <assert.h>\n #include <fcntl.h>\n+#include <limits.h>\n \n #include \"ares.h\"\n #include \"ares_dns.h\"\n@@ -871,8 +872,32 @@ void ares__send_query(ares_channel channel, struct query *query,\n           return;\n         }\n     }\n-    timeplus = channel->timeout << (query->try_count / channel->nservers);\n-    timeplus = (timeplus * (9 + (rand () & 7))) / 16;\n+\n+    /* For each trip through the entire server list, double the channel's\n+     * assigned timeout, avoiding overflow.  If channel->timeout is negative,\n+     * leave it as-is, even though that should be impossible here.\n+     */\n+    timeplus = channel->timeout;\n+    {\n+      /* How many times do we want to double it?  Presume sane values here. */\n+      const int shift = query->try_count / channel->nservers;\n+\n+      /* Is there enough room to shift timeplus left that many times?\n+       *\n+       * To find out, confirm that all of the bits we'll shift away are zero.\n+       * Stop considering a shift if we get to the point where we could shift\n+       * a 1 into the sign bit (i.e. when shift is within two of the bit\n+       * count).\n+       *\n+       * This has the side benefit of leaving negative numbers unchanged.\n+       */\n+      if(shift <= (int)(sizeof(int) * CHAR_BIT - 1)\n+         && (timeplus >> (sizeof(int) * CHAR_BIT - 1 - shift)) == 0)\n+      {\n+        timeplus <<= shift;\n+      }\n+    }\n+\n     query->timeout = *now;\n     timeadd(&query->timeout, timeplus);\n     /* Keep track of queries bucketed by timeout, so we can process"
        },
        {
            "sha": "001c3482a7dd5d96e0c49f8a7753c50c3493f39c",
            "filename": "deps/cares/src/ares_search.c",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_search.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_search.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_search.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -54,6 +54,13 @@ void ares_search(ares_channel channel, const char *name, int dnsclass,\n   const char *p;\n   int status, ndots;\n \n+  /* Per RFC 7686, reject queries for \".onion\" domain names with NXDOMAIN. */\n+  if (ares__is_onion_domain(name))\n+    {\n+      callback(arg, ARES_ENOTFOUND, 0, NULL, 0);\n+      return;\n+    }\n+\n   /* If name only yields one domain to search, then we don't have\n    * to keep extra state, so just do an ares_query().\n    */"
        },
        {
            "sha": "f4f1f951197de892ddc031d5a50c5bc6885009c7",
            "filename": "deps/cares/src/ares_send.c",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_send.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_send.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_send.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -60,6 +60,12 @@ void ares_send(ares_channel channel, const unsigned char *qbuf, int qlen,\n       callback(arg, ARES_ENOMEM, 0, NULL, 0);\n       return;\n     }\n+  if (channel->nservers < 1)\n+    {\n+      ares_free(query);\n+      callback(arg, ARES_ESERVFAIL, 0, NULL, 0);\n+      return;\n+    }\n   query->server_info = ares_malloc(channel->nservers *\n                                    sizeof(query->server_info[0]));\n   if (!query->server_info)"
        },
        {
            "sha": "b57a30f2a99c35a3ff40972f136ba8f50aaac88b",
            "filename": "deps/cares/src/ares_strsplit.c",
            "status": "added",
            "additions": 174,
            "deletions": 0,
            "changes": 174,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_strsplit.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_strsplit.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_strsplit.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -0,0 +1,174 @@\n+/* Copyright (C) 2018 by John Schember <john@nachtimwald.com>\n+ *\n+ * Permission to use, copy, modify, and distribute this\n+ * software and its documentation for any purpose and without\n+ * fee is hereby granted, provided that the above copyright\n+ * notice appear in all copies and that both that copyright\n+ * notice and this permission notice appear in supporting\n+ * documentation, and that the name of M.I.T. not be used in\n+ * advertising or publicity pertaining to distribution of the\n+ * software without specific, written prior permission.\n+ * M.I.T. makes no representations about the suitability of\n+ * this software for any purpose.  It is provided \"as is\"\n+ * without express or implied warranty.\n+ */\n+\n+#include \"ares_setup.h\"\n+#include \"ares_strsplit.h\"\n+#include \"ares.h\"\n+#include \"ares_private.h\"\n+\n+static int list_contains(char * const *list, size_t num_elem, const char *str, int insensitive)\n+{\n+  size_t len;\n+  size_t i;\n+\n+  len = strlen(str);\n+  for (i=0; i<num_elem; i++)\n+  {\n+    if (insensitive)\n+    {\n+#ifdef WIN32\n+      if (strnicmp(list[i], str, len) == 0)\n+#else\n+      if (strncasecmp(list[i], str, len) == 0)\n+#endif\n+        return 1;\n+    }\n+    else\n+    {\n+      if (strncmp(list[i], str, len) == 0)\n+        return 1;\n+    }\n+  }\n+\n+  return 0;\n+}\n+\n+static int is_delim(char c, const char *delims, size_t num_delims)\n+{\n+  size_t i;\n+\n+  for (i=0; i<num_delims; i++)\n+  {\n+    if (c == delims[i])\n+      return 1;\n+  }\n+  return 0;\n+}\n+\n+\n+void ares_strsplit_free(char **elms, size_t num_elm)\n+{\n+  size_t i;\n+\n+  if (elms == NULL)\n+    return;\n+\n+  for (i=0; i<num_elm; i++)\n+    ares_free(elms[i]);\n+  ares_free(elms);\n+}\n+\n+\n+char **ares_strsplit(const char *in, const char *delms, int make_set, size_t *num_elm)\n+{\n+  char *parsestr;\n+  char **temp;\n+  char **out;\n+  size_t cnt;\n+  size_t nelms;\n+  size_t in_len;\n+  size_t num_delims;\n+  size_t i;\n+\n+  if (in == NULL || delms == NULL || num_elm == NULL)\n+    return NULL;\n+\n+  *num_elm = 0;\n+\n+  in_len = strlen(in);\n+  num_delims = strlen(delms);\n+\n+  /* Figure out how many elements. */\n+  nelms = 1;\n+  for (i=0; i<in_len; i++)\n+  {\n+    if (is_delim(in[i], delms, num_delims))\n+    {\n+      nelms++;\n+    }\n+  }\n+\n+  /* Copy of input so we can cut it up. */\n+  parsestr = ares_strdup(in);\n+  if (parsestr == NULL)\n+    return NULL;\n+\n+  /* Temporary array to store locations of start of each element\n+   * within parsestr. */\n+  temp = ares_malloc(nelms * sizeof(*temp));\n+  if (temp == NULL)\n+  {\n+    ares_free(parsestr);\n+    return NULL;\n+  }\n+  temp[0] = parsestr;\n+  cnt = 1;\n+  for (i=0; i<in_len && cnt<nelms; i++)\n+  {\n+    if (!is_delim(parsestr[i], delms, num_delims))\n+      continue;\n+\n+    /* Replace sep with NULL. */\n+    parsestr[i] = '\\0';\n+    /* Add the pointer to the array of elements */\n+    temp[cnt] = parsestr+i+1;\n+    cnt++;\n+  }\n+\n+  /* Copy each element to our output array. */\n+  out = ares_malloc(nelms * sizeof(*out));\n+  if (out == NULL)\n+  {\n+    ares_free(parsestr);\n+    ares_free(temp);\n+    return NULL;\n+  }\n+\n+  nelms = 0;\n+  for (i=0; i<cnt; i++)\n+  {\n+    if (temp[i][0] == '\\0')\n+      continue;\n+\n+    if (make_set && list_contains(out, nelms, temp[i], 1))\n+      continue;\n+\n+    out[nelms] = ares_strdup(temp[i]);\n+    if (out[nelms] == NULL)\n+    {\n+      ares_strsplit_free(out, nelms);\n+      ares_free(parsestr);\n+      ares_free(temp);\n+      return NULL;\n+    }\n+    nelms++;\n+  }\n+\n+\n+  /* If there are no elements don't return an empty allocated\n+   * array. */\n+  if (nelms == 0)\n+  {\n+    ares_strsplit_free(out, nelms);\n+    out = NULL;\n+  }\n+\n+  /* Get the true number of elements (recalculated because of make_set) */\n+  *num_elm = nelms;\n+\n+  ares_free(parsestr);\n+  ares_free(temp);\n+  return out;\n+}"
        },
        {
            "sha": "da286a9aef6b51256e4a2851e3b4a24f51a55148",
            "filename": "deps/cares/src/ares_strsplit.h",
            "status": "added",
            "additions": 42,
            "deletions": 0,
            "changes": 42,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_strsplit.h",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Fares_strsplit.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Fares_strsplit.h?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -0,0 +1,42 @@\n+#ifndef HEADER_CARES_STRSPLIT_H\n+#define HEADER_CARES_STRSPLIT_H\n+\n+/* Copyright (C) 2018 by John Schember <john@nachtimwald.com>\n+ *\n+ * Permission to use, copy, modify, and distribute this\n+ * software and its documentation for any purpose and without\n+ * fee is hereby granted, provided that the above copyright\n+ * notice appear in all copies and that both that copyright\n+ * notice and this permission notice appear in supporting\n+ * documentation, and that the name of M.I.T. not be used in\n+ * advertising or publicity pertaining to distribution of the\n+ * software without specific, written prior permission.\n+ * M.I.T. makes no representations about the suitability of\n+ * this software for any purpose.  It is provided \"as is\"\n+ * without express or implied warranty.\n+ */\n+\n+#include \"ares_setup.h\"\n+\n+/* Split a string on delem skipping empty elements.\n+ *\n+ * param in String to split.\n+ * param delims String of characters to treat as a delimitor.\n+ *              Each character in the string is a delimitor so\n+ *              there can be multiple delimitors to split on.\n+ *              E.g. \", \" will split on all comma's and spaces.\n+ * param make_set Have the list be a Set where there are no\n+ *                duplicate entries. 1 for true, 0 or false.\n+ * param num_elm Return parameter of the number of elements\n+ *               in the result array.\n+ *\n+ * returns an allocated array of allocated string elements.\n+ *\n+ */\n+char **ares_strsplit(const char *in, const char *delms, int make_set, size_t *num_elm);\n+\n+/* Frees the result returned from ares_strsplit(). */\n+void ares_strsplit_free(char **elms, size_t num_elm);\n+\n+\n+#endif /* HEADER_CARES_STRSPLIT_H */"
        },
        {
            "sha": "1935a871cede6dcad010a10765860442d95ac170",
            "filename": "deps/cares/src/inet_ntop.c",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Finet_ntop.c",
            "raw_url": "https://github.com/nodejs/node/raw/3a25b174aa5451311002247c31a7aa9a461b63b6/deps%2Fcares%2Fsrc%2Finet_ntop.c",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fcares%2Fsrc%2Finet_ntop.c?ref=3a25b174aa5451311002247c31a7aa9a461b63b6",
            "patch": "@@ -180,8 +180,7 @@ inet_ntop6(const unsigned char *src, char *dst, size_t size)\n     tp += sprintf(tp, \"%x\", words[i]);\n   }\n   /* Was it a trailing run of 0x00's? */\n-  if (best.base != -1 && (best.base + best.len) == \n-      (NS_IN6ADDRSZ / NS_INT16SZ))\n+  if (best.base != -1 && (best.base + best.len) == (NS_IN6ADDRSZ / NS_INT16SZ))\n     *tp++ = ':';\n   *tp++ = '\\0';\n "
        }
    ],
    "stats": {
        "total": 947,
        "additions": 662,
        "deletions": 285
    }
}