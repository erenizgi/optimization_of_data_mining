{
    "author": "sam-github",
    "message": "src: check curve ID existence instead of asn flags\n\nSimplify the code. The flag check was in the OpenSSL source, but reading\nthrough the docs and source, it is not necessary.\n\nRefs: https://github.com/nodejs/node/pull/24358/files#r243099693\nPR-URL: https://github.com/nodejs/node/pull/25345\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>",
    "sha": "4a6ec3bd05e2e2d3f121e0d3dea281a6ef7fa32a",
    "files": [
        {
            "sha": "75a687801fbec71e17ce74230b9269f3e499b8dd",
            "filename": "src/node_crypto.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 12,
            "changes": 21,
            "blob_url": "https://github.com/nodejs/node/blob/4a6ec3bd05e2e2d3f121e0d3dea281a6ef7fa32a/src%2Fnode_crypto.cc",
            "raw_url": "https://github.com/nodejs/node/raw/4a6ec3bd05e2e2d3f121e0d3dea281a6ef7fa32a/src%2Fnode_crypto.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto.cc?ref=4a6ec3bd05e2e2d3f121e0d3dea281a6ef7fa32a",
            "patch": "@@ -1738,21 +1738,18 @@ static Local<Object> X509ToObject(Environment* env, X509* cert) {\n       CHECK_NULL(pub);\n     }\n \n-    if (EC_GROUP_get_asn1_flag(group) != 0) {\n+    const int nid = EC_GROUP_get_curve_name(group);\n+    if (nid != 0) {\n       // Curve is well-known, get its OID and NIST nick-name (if it has one).\n \n-      int nid = EC_GROUP_get_curve_name(group);\n-      if (nid != 0) {\n-        if (const char* sn = OBJ_nid2sn(nid)) {\n-          info->Set(context, env->asn1curve_string(),\n-                    OneByteString(env->isolate(), sn)).FromJust();\n-        }\n+      if (const char* sn = OBJ_nid2sn(nid)) {\n+        info->Set(context, env->asn1curve_string(),\n+                  OneByteString(env->isolate(), sn)).FromJust();\n       }\n-      if (nid != 0) {\n-        if (const char* nist = EC_curve_nid2nist(nid)) {\n-          info->Set(context, env->nistcurve_string(),\n-                    OneByteString(env->isolate(), nist)).FromJust();\n-        }\n+\n+      if (const char* nist = EC_curve_nid2nist(nid)) {\n+        info->Set(context, env->nistcurve_string(),\n+                  OneByteString(env->isolate(), nist)).FromJust();\n       }\n     } else {\n       // Unnamed curves can be described by their mathematical properties,"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 9,
        "deletions": 12
    }
}