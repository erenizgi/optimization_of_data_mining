{
    "author": "danbev",
    "message": "build: move available-node variable to top\n\nCurrently node_use_openssl uses the available-node variable before it is\ndefined causing the conditions that use it before that point to\nevaluate incorrectly. As an example running the target\ntest/addons/.docbuildstamp will currently be skipped:\n\n$ make test/addons/.docbuildstamp\nSkipping .docbuildstamp (no crypto)\n\nWith this commit the target will only be skipped if configured --without-ssl.\n\nPR-URL: https://github.com/nodejs/node/pull/22356\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "28675b66d2e2fae839b64cf0b06ebb5df8cde025",
    "files": [
        {
            "sha": "3ca83bfed85ead088bd66568556d543c6a8d4602",
            "filename": "Makefile",
            "status": "modified",
            "additions": 12,
            "deletions": 11,
            "changes": 23,
            "blob_url": "https://github.com/nodejs/node/blob/28675b66d2e2fae839b64cf0b06ebb5df8cde025/Makefile",
            "raw_url": "https://github.com/nodejs/node/raw/28675b66d2e2fae839b64cf0b06ebb5df8cde025/Makefile",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/Makefile?ref=28675b66d2e2fae839b64cf0b06ebb5df8cde025",
            "patch": "@@ -58,6 +58,18 @@ BUILD_RELEASE_FLAGS ?= $(BUILD_DOWNLOAD_FLAGS) $(BUILD_INTL_FLAGS)\n # or set the V environment variable to an empty string.\n V ?= 1\n \n+# Use -e to double check in case it's a broken link\n+# Use $(PWD) so we can cd to anywhere before calling this\n+available-node = \\\n+  if [ -x $(PWD)/$(NODE) ] && [ -e $(PWD)/$(NODE) ]; then \\\n+\t\t$(PWD)/$(NODE) $(1); \\\n+\telif [ -x `which node` ] && [ -e `which node` ] && [ `which node` ]; then \\\n+\t\t`which node` $(1); \\\n+\telse \\\n+\t\techo \"No available node, cannot run \\\"node $(1)\\\"\"; \\\n+\t\texit 1; \\\n+\tfi;\n+\n .PHONY: all\n # BUILDTYPE=Debug builds both release and debug builds. If you want to compile\n # just the debug build, run `make -C out BUILDTYPE=Debug` instead.\n@@ -629,17 +641,6 @@ out/doc/api/assets:\n out/doc/api/assets/%: doc/api_assets/% out/doc/api/assets\n \t@cp $< $@\n \n-# Use -e to double check in case it's a broken link\n-# Use $(PWD) so we can cd to anywhere before calling this\n-available-node = \\\n-  if [ -x $(PWD)/$(NODE) ] && [ -e $(PWD)/$(NODE) ]; then \\\n-\t\t$(PWD)/$(NODE) $(1); \\\n-\telif [ -x `which node` ] && [ -e `which node` ] && [ `which node` ]; then \\\n-\t\t`which node` $(1); \\\n-\telse \\\n-\t\techo \"No available node, cannot run \\\"node $(1)\\\"\"; \\\n-\t\texit 1; \\\n-\tfi;\n \n run-npm-install = $(PWD)/$(NPM) install --production --no-package-lock\n run-npm-ci = $(PWD)/$(NPM) ci"
        }
    ],
    "stats": {
        "total": 23,
        "additions": 12,
        "deletions": 11
    }
}