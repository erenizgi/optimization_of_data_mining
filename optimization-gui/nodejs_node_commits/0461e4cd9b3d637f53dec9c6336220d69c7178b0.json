{
    "author": "addaleax",
    "message": "src: use std::vector for setting up process.execPath\n\nUse `std::vector` as an RAII-style alternative to allocating\nand deleting raw memory storage.\n\nPR-URL: https://github.com/nodejs/node/pull/25069\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "0461e4cd9b3d637f53dec9c6336220d69c7178b0",
    "files": [
        {
            "sha": "2564b83ef9e62e3641eec4b6aac621a280a75b16",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 16,
            "deletions": 15,
            "changes": 31,
            "blob_url": "https://github.com/nodejs/node/blob/0461e4cd9b3d637f53dec9c6336220d69c7178b0/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/0461e4cd9b3d637f53dec9c6336220d69c7178b0/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=0461e4cd9b3d637f53dec9c6336220d69c7178b0",
            "patch": "@@ -1086,22 +1086,23 @@ void SetupProcessObject(Environment* env,\n   SECURITY_REVERSIONS(V)\n #undef V\n \n-  size_t exec_path_len = 2 * PATH_MAX;\n-  char* exec_path = new char[exec_path_len];\n-  Local<String> exec_path_value;\n-  if (uv_exepath(exec_path, &exec_path_len) == 0) {\n-    exec_path_value = String::NewFromUtf8(env->isolate(),\n-                                          exec_path,\n-                                          NewStringType::kInternalized,\n-                                          exec_path_len).ToLocalChecked();\n-  } else {\n-    exec_path_value = String::NewFromUtf8(env->isolate(), args[0].c_str(),\n-        NewStringType::kInternalized).ToLocalChecked();\n+  {\n+    size_t exec_path_len = 2 * PATH_MAX;\n+    std::vector<char> exec_path(exec_path_len);\n+    Local<String> exec_path_value;\n+    if (uv_exepath(exec_path.data(), &exec_path_len) == 0) {\n+      exec_path_value = String::NewFromUtf8(env->isolate(),\n+                                            exec_path.data(),\n+                                            NewStringType::kInternalized,\n+                                            exec_path_len).ToLocalChecked();\n+    } else {\n+      exec_path_value = String::NewFromUtf8(env->isolate(), args[0].c_str(),\n+          NewStringType::kInternalized).ToLocalChecked();\n+    }\n+    process->Set(env->context(),\n+                 FIXED_ONE_BYTE_STRING(env->isolate(), \"execPath\"),\n+                 exec_path_value).FromJust();\n   }\n-  process->Set(env->context(),\n-               FIXED_ONE_BYTE_STRING(env->isolate(), \"execPath\"),\n-               exec_path_value).FromJust();\n-  delete[] exec_path;\n \n   auto debug_port_string = FIXED_ONE_BYTE_STRING(env->isolate(), \"debugPort\");\n   CHECK(process->SetAccessor(env->context(),"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 16,
        "deletions": 15
    }
}