{
    "author": "sam-github",
    "message": "doc: describe root cert update process\n\nPR-URL: https://github.com/nodejs/node/pull/25113\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "845fdd02f40b529a47c51f88b723ebccbff9f095",
    "files": [
        {
            "sha": "f25f74a3e7ba8c196d3b42457fc02ef5a797b36d",
            "filename": "doc/guides/updating-root-certs.md",
            "status": "added",
            "additions": 122,
            "deletions": 0,
            "changes": 122,
            "blob_url": "https://github.com/nodejs/node/blob/845fdd02f40b529a47c51f88b723ebccbff9f095/doc%2Fguides%2Fupdating-root-certs.md",
            "raw_url": "https://github.com/nodejs/node/raw/845fdd02f40b529a47c51f88b723ebccbff9f095/doc%2Fguides%2Fupdating-root-certs.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fguides%2Fupdating-root-certs.md?ref=845fdd02f40b529a47c51f88b723ebccbff9f095",
            "patch": "@@ -0,0 +1,122 @@\n+# Updating the Root Certificates\n+\n+Node.js contains a compiled-in set of root certificates used as trust anchors\n+for TLS certificate validation.\n+\n+The certificates come from Mozilla, specifically NSS's `certdata.txt` file.\n+\n+The PEM encodings of the certificates are converted to C strings, and committed\n+in `src/node_root_certs.h`.\n+\n+## When to update\n+\n+Root certificates should be updated sometime after Mozilla makes an NSS release,\n+check the [NSS release schedule][].\n+\n+## Process\n+\n+Commands assume that the current working directory is the root of a checkout of\n+the nodejs/node repository.\n+\n+1. Find NSS metadata for update.\n+\n+The latest released NSS version, release date, Firefox version, and Firefox\n+release date can be found in the [NSS release schedule][].\n+\n+The tag to fetch `certdata.txt` from is found by looking for the release\n+version in the [tag list][].\n+\n+2. Update `certdata.txt` from the NSS release tag.\n+\n+Update the tag in the commands below, and run:\n+```shell\n+cd tools/\n+./mk-ca-bundle -v 2>_before\n+curl -O https://hg.mozilla.org/projects/nss/raw-file/NSS_3_41_RTM/lib/ckfw/builtins/certdata.txt\n+```\n+\n+The `_before` file will be used later. Verify that running `mk-ca-bundle` made\n+no changes to `src/node_root_certs.h`. If it did, something went wrong with the\n+previous update. Seek help!\n+\n+Update metadata in the message below, and commit `certdata.txt`:\n+\n+```text\n+tools: update certdata.txt\n+\n+This is the certdata.txt[0] from NSS 3.41, released on 2018-12-03.\n+\n+This is the version of NSS that will ship in Firefox 65 on\n+2018-12-11.\n+\n+[0] https://hg.mozilla.org/projects/nss/raw-file/NSS_3_41_RTM/lib/ckfw/builtins/certdata.txt\n+```\n+\n+3. Update `node_root_certs.h` from `certdata.txt`.\n+\n+Run the command below:\n+\n+```shell\n+./mk-ca-bundle.pl -v 2>_after\n+```\n+\n+Confirm that `../src/node_root_certs.h` was updated.\n+\n+Determine what changes were made by diffing the before and after files:\n+```shell\n+% diff _before _after\n+11d10\n+< Parsing: Visa eCommerce Root\n+106d104\n+< Parsing: TÜRKTRUST Elektronik Sertifika Hizmet Sağlayıcısı H5\n+113,117d110\n+< Parsing: Certplus Root CA G1\n+< Parsing: Certplus Root CA G2\n+< Parsing: OpenTrust Root CA G1\n+< Parsing: OpenTrust Root CA G2\n+< Parsing: OpenTrust Root CA G3\n+134c127,136\n+< Done (133 CA certs processed, 20 skipped).\n+---\n+> Parsing: GlobalSign Root CA - R6\n+> Parsing: OISTE WISeKey Global Root GC CA\n+> Parsing: GTS Root R1\n+> Parsing: GTS Root R2\n+> Parsing: GTS Root R3\n+> Parsing: GTS Root R4\n+> Parsing: UCA Global G2 Root\n+> Parsing: UCA Extended Validation Root\n+> Parsing: Certigna Root CA\n+> Done (135 CA certs processed, 16 skipped).\n+```\n+\n+Use the diff to update the message below, and commit `src/node_root_certs.h`:\n+```text\n+crypto: update root certificates\n+\n+Update the list of root certificates in src/node_root_certs.h with\n+tools/mk-ca-bundle.pl.\n+\n+Certificates added:\n+- GlobalSign Root CA - R6\n+- OISTE WISeKey Global Root GC CA\n+- GTS Root R1\n+- GTS Root R2\n+- GTS Root R3\n+- GTS Root R4\n+- UCA Global G2 Root\n+- UCA Extended Validation Root\n+- Certigna Root CA\n+\n+Certificates removed:\n+- Visa eCommerce Root\n+- TÜRKTRUST Elektronik Sertifika Hizmet Sağlayıcısı H5\n+- Certplus Root CA G1\n+- Certplus Root CA G2\n+- OpenTrust Root CA G1\n+- OpenTrust Root CA G2\n+- OpenTrust Root CA G3\n+```\n+\n+[NSS release schedule]: https://wiki.mozilla.org/NSS:Release_Versions\n+[tag list]: https://hg.mozilla.org/projects/nss/tags"
        }
    ],
    "stats": {
        "total": 122,
        "additions": 122,
        "deletions": 0
    }
}