{
    "author": "BridgeAR",
    "message": "assert: add default operator to `assert.fail()`\n\nThis makes sure `assert.fail()` contains an operator instead of being\nundefined.\n\nOn top of that it also fixes the `err.generatedMessage` property.\nBefore, it was not always set correct.\n\nPR-URL: https://github.com/nodejs/node/pull/22694\nReviewed-By: John-David Dalton <john.david.dalton@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>",
    "sha": "eee5adfab5af5f7eb672cbc3cbbad141c455c54d",
    "files": [
        {
            "sha": "0f3d770358f7c6bd78e23d06f01fccfe3ca6f191",
            "filename": "lib/assert.js",
            "status": "modified",
            "additions": 16,
            "deletions": 5,
            "changes": 21,
            "blob_url": "https://github.com/nodejs/node/blob/eee5adfab5af5f7eb672cbc3cbbad141c455c54d/lib%2Fassert.js",
            "raw_url": "https://github.com/nodejs/node/raw/eee5adfab5af5f7eb672cbc3cbbad141c455c54d/lib%2Fassert.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fassert.js?ref=eee5adfab5af5f7eb672cbc3cbbad141c455c54d",
            "patch": "@@ -87,8 +87,9 @@ function innerFail(obj) {\n function fail(actual, expected, message, operator, stackStartFn) {\n   const argsLen = arguments.length;\n \n+  let internalMessage;\n   if (argsLen === 0) {\n-    message = 'Failed';\n+    internalMessage = 'Failed';\n   } else if (argsLen === 1) {\n     message = actual;\n     actual = undefined;\n@@ -106,13 +107,23 @@ function fail(actual, expected, message, operator, stackStartFn) {\n       operator = '!=';\n   }\n \n-  innerFail({\n+  if (message instanceof Error) throw message;\n+\n+  const errArgs = {\n     actual,\n     expected,\n-    message,\n-    operator,\n+    operator: operator === undefined ? 'fail' : operator,\n     stackStartFn: stackStartFn || fail\n-  });\n+  };\n+  if (message !== undefined) {\n+    errArgs.message = message;\n+  }\n+  const err = new AssertionError(errArgs);\n+  if (internalMessage) {\n+    err.message = internalMessage;\n+    err.generatedMessage = true;\n+  }\n+  throw err;\n }\n \n assert.fail = fail;"
        },
        {
            "sha": "97cba760e03836a4a7157dbbbcd1152c6d2ae7bb",
            "filename": "test/parallel/test-assert-fail-deprecation.js",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/eee5adfab5af5f7eb672cbc3cbbad141c455c54d/test%2Fparallel%2Ftest-assert-fail-deprecation.js",
            "raw_url": "https://github.com/nodejs/node/raw/eee5adfab5af5f7eb672cbc3cbbad141c455c54d/test%2Fparallel%2Ftest-assert-fail-deprecation.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-assert-fail-deprecation.js?ref=eee5adfab5af5f7eb672cbc3cbbad141c455c54d",
            "patch": "@@ -19,7 +19,8 @@ assert.throws(() => {\n   message: '\\'first\\' != \\'second\\'',\n   operator: '!=',\n   actual: 'first',\n-  expected: 'second'\n+  expected: 'second',\n+  generatedMessage: true\n });\n \n // Three args\n@@ -29,9 +30,10 @@ assert.throws(() => {\n   code: 'ERR_ASSERTION',\n   name: 'AssertionError [ERR_ASSERTION]',\n   message: 'another custom message',\n-  operator: undefined,\n+  operator: 'fail',\n   actual: 'ignored',\n-  expected: 'ignored'\n+  expected: 'ignored',\n+  generatedMessage: false\n });\n \n // Three args with custom Error"
        },
        {
            "sha": "4410cc8544270723a9b5d361953d2e0f98496c33",
            "filename": "test/parallel/test-assert-fail.js",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/eee5adfab5af5f7eb672cbc3cbbad141c455c54d/test%2Fparallel%2Ftest-assert-fail.js",
            "raw_url": "https://github.com/nodejs/node/raw/eee5adfab5af5f7eb672cbc3cbbad141c455c54d/test%2Fparallel%2Ftest-assert-fail.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-assert-fail.js?ref=eee5adfab5af5f7eb672cbc3cbbad141c455c54d",
            "patch": "@@ -10,9 +10,10 @@ assert.throws(\n     code: 'ERR_ASSERTION',\n     name: 'AssertionError [ERR_ASSERTION]',\n     message: 'Failed',\n-    operator: undefined,\n+    operator: 'fail',\n     actual: undefined,\n-    expected: undefined\n+    expected: undefined,\n+    generatedMessage: true\n   }\n );\n \n@@ -23,9 +24,10 @@ assert.throws(() => {\n   code: 'ERR_ASSERTION',\n   name: 'AssertionError [ERR_ASSERTION]',\n   message: 'custom message',\n-  operator: undefined,\n+  operator: 'fail',\n   actual: undefined,\n-  expected: undefined\n+  expected: undefined,\n+  generatedMessage: false\n });\n \n // One arg = Error"
        }
    ],
    "stats": {
        "total": 39,
        "additions": 27,
        "deletions": 12
    }
}