{
    "author": "sam-github",
    "message": "doc: improve Sign/Verify examples and docs\n\n- Use complete examples that can be pasted and run as-is\n- Move note about algorithm to the functions it applies to\n- Uncapitalize inconsistence use of \"Class\"\n- Use both EC and RSA keys in the examples\n- Note that hash and digest are two names for the same algorithms\n\nPR-URL: https://github.com/nodejs/node/pull/25452\nReviewed-By: Vse Mozhet Byt <vsemozhetbyt@gmail.com>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "273d7dd8b85239c26256f2fbd1510bb5555e4075",
    "files": [
        {
            "sha": "b387c2684239a92ce3a2bdd6873299c2238ed650",
            "filename": "doc/api/crypto.md",
            "status": "modified",
            "additions": 45,
            "deletions": 64,
            "changes": 109,
            "blob_url": "https://github.com/nodejs/node/blob/273d7dd8b85239c26256f2fbd1510bb5555e4075/doc%2Fapi%2Fcrypto.md",
            "raw_url": "https://github.com/nodejs/node/raw/273d7dd8b85239c26256f2fbd1510bb5555e4075/doc%2Fapi%2Fcrypto.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fcrypto.md?ref=273d7dd8b85239c26256f2fbd1510bb5555e4075",
            "patch": "@@ -1018,7 +1018,7 @@ This can be called many times with new data as it is streamed.\n added: v0.1.94\n -->\n \n-The `Hmac` Class is a utility for creating cryptographic HMAC digests. It can\n+The `Hmac` class is a utility for creating cryptographic HMAC digests. It can\n be used in one of two ways:\n \n - As a [stream][] that is both readable and writable, where data is written\n@@ -1196,7 +1196,7 @@ or `'private'` for private (asymmetric) keys.\n added: v0.1.92\n -->\n \n-The `Sign` Class is a utility for generating signatures. It can be used in one\n+The `Sign` class is a utility for generating signatures. It can be used in one\n of two ways:\n \n - As a writable [stream][], where data to be signed is written and the\n@@ -1208,51 +1208,46 @@ The [`crypto.createSign()`][] method is used to create `Sign` instances. The\n argument is the string name of the hash function to use. `Sign` objects are not\n to be created directly using the `new` keyword.\n \n-Example: Using `Sign` objects as streams:\n+Example: Using `Sign` and [`Verify`][] objects as streams:\n \n ```js\n const crypto = require('crypto');\n-const sign = crypto.createSign('SHA256');\n \n+const { privateKey, publicKey } = crypto.generateKeyPairSync('ec', {\n+  namedCurve: 'sect239k1'\n+});\n+\n+const sign = crypto.createSign('SHA256');\n sign.write('some data to sign');\n sign.end();\n+const signature = sign.sign(privateKey, 'hex');\n \n-const privateKey = getPrivateKeySomehow();\n-console.log(sign.sign(privateKey, 'hex'));\n-// Prints: the calculated signature using the specified private key and\n-// SHA-256. For RSA keys, the algorithm is RSASSA-PKCS1-v1_5 (see padding\n-// parameter below for RSASSA-PSS). For EC keys, the algorithm is ECDSA.\n+const verify = crypto.createVerify('SHA256');\n+verify.write('some data to sign');\n+verify.end();\n+console.log(verify.verify(publicKey, signature));\n+// Prints: true or false\n ```\n \n-Example: Using the [`sign.update()`][] and [`sign.sign()`][] methods:\n+Example: Using the [`sign.update()`][] and [`verify.update()`][] methods:\n \n ```js\n const crypto = require('crypto');\n-const sign = crypto.createSign('SHA256');\n-\n-sign.update('some data to sign');\n-\n-const privateKey = getPrivateKeySomehow();\n-console.log(sign.sign(privateKey, 'hex'));\n-// Prints: the calculated signature\n-```\n-\n-In some cases, a `Sign` instance can also be created by passing in a signature\n-algorithm name, such as 'RSA-SHA256'. This will use the corresponding digest\n-algorithm. This does not work for all signature algorithms, such as\n-'ecdsa-with-SHA256'. Use digest names instead.\n \n-Example: signing using legacy signature algorithm name\n-\n-```js\n-const crypto = require('crypto');\n-const sign = crypto.createSign('RSA-SHA256');\n+const { privateKey, publicKey } = crypto.generateKeyPairSync('rsa', {\n+  modulusLength: 2048,\n+});\n \n+const sign = crypto.createSign('SHA256');\n sign.update('some data to sign');\n+sign.end();\n+const signature = sign.sign(privateKey);\n \n-const privateKey = getPrivateKeySomehow();\n-console.log(sign.sign(privateKey, 'hex'));\n-// Prints: the calculated signature\n+const verify = crypto.createVerify('SHA256');\n+verify.update('some data to sign');\n+verify.end();\n+console.log(verify.verify(publicKey, signature));\n+// Prints: true\n ```\n \n ### sign.sign(privateKey[, outputEncoding])\n@@ -1332,34 +1327,7 @@ of two ways:\n The [`crypto.createVerify()`][] method is used to create `Verify` instances.\n `Verify` objects are not to be created directly using the `new` keyword.\n \n-Example: Using `Verify` objects as streams:\n-\n-```js\n-const crypto = require('crypto');\n-const verify = crypto.createVerify('SHA256');\n-\n-verify.write('some data to sign');\n-verify.end();\n-\n-const publicKey = getPublicKeySomehow();\n-const signature = getSignatureToVerify();\n-console.log(verify.verify(publicKey, signature));\n-// Prints: true or false\n-```\n-\n-Example: Using the [`verify.update()`][] and [`verify.verify()`][] methods:\n-\n-```js\n-const crypto = require('crypto');\n-const verify = crypto.createVerify('SHA256');\n-\n-verify.update('some data to sign');\n-\n-const publicKey = getPublicKeySomehow();\n-const signature = getSignatureToVerify();\n-console.log(verify.verify(publicKey, signature));\n-// Prints: true or false\n-```\n+See [`Sign`][] for examples.\n \n ### verify.update(data[, inputEncoding])\n <!-- YAML\n@@ -1886,10 +1854,15 @@ added: v0.1.92\n * `options` {Object} [`stream.Writable` options][]\n * Returns: {Sign}\n \n-Creates and returns a `Sign` object that uses the given `algorithm`.\n-Use [`crypto.getHashes()`][] to obtain an array of names of the available\n-signing algorithms. Optional `options` argument controls the\n-`stream.Writable` behavior.\n+Creates and returns a `Sign` object that uses the given `algorithm`.  Use\n+[`crypto.getHashes()`][] to obtain the names of the available digest algorithms.\n+Optional `options` argument controls the `stream.Writable` behavior.\n+\n+In some cases, a `Sign` instance can be created using the name of a signature\n+algorithm, such as `'RSA-SHA256'`, instead of a digest algorithm. This will use\n+the corresponding digest algorithm. This does not work for all signature\n+algorithms, such as `'ecdsa-with-SHA256'`, so it is best to always use digest\n+algorithm names.\n \n ### crypto.createVerify(algorithm[, options])\n <!-- YAML\n@@ -1904,6 +1877,12 @@ Use [`crypto.getHashes()`][] to obtain an array of names of the available\n signing algorithms. Optional `options` argument controls the\n `stream.Writable` behavior.\n \n+In some cases, a `Verify` instance can be created using the name of a signature\n+algorithm, such as `'RSA-SHA256'`, instead of a digest algorithm. This will use\n+the corresponding digest algorithm. This does not work for all signature\n+algorithms, such as `'ecdsa-with-SHA256'`, so it is best to always use digest\n+algorithm names.\n+\n ### crypto.generateKeyPair(type, options, callback)\n <!-- YAML\n added: v10.12.0\n@@ -2084,7 +2063,7 @@ added: v10.0.0\n added: v0.9.3\n -->\n * Returns: {string[]} An array of the names of the supported hash algorithms,\n-  such as `'RSA-SHA256'`.\n+  such as `'RSA-SHA256'`. Hash algorithms are also called \"digest\" algorithms.\n \n ```js\n const hashes = crypto.getHashes();\n@@ -3103,7 +3082,9 @@ the `crypto`, `tls`, and `https` modules and are generally specific to OpenSSL.\n [`Buffer`]: buffer.html\n [`EVP_BytesToKey`]: https://www.openssl.org/docs/man1.1.0/crypto/EVP_BytesToKey.html\n [`KeyObject`]: #crypto_class_keyobject\n+[`Sign`]: #crypto_class_sign\n [`UV_THREADPOOL_SIZE`]: cli.html#cli_uv_threadpool_size_size\n+[`Verify`]: #crypto_class_verify\n [`cipher.final()`]: #crypto_cipher_final_outputencoding\n [`cipher.update()`]: #crypto_cipher_update_data_inputencoding_outputencoding\n [`crypto.createCipher()`]: #crypto_crypto_createcipher_algorithm_password_options"
        }
    ],
    "stats": {
        "total": 109,
        "additions": 45,
        "deletions": 64
    }
}