{
    "author": "ronag",
    "message": "http: make client `.aborted` boolean\n\nPR-URL: https://github.com/nodejs/node/pull/20230\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "4b00c4fafaa2ae8c41c1f78823c0feb810ae4723",
    "files": [
        {
            "sha": "8f2c531713b4f5847c099a80838244d02c304c6b",
            "filename": "doc/api/http.md",
            "status": "modified",
            "additions": 8,
            "deletions": 2,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/4b00c4fafaa2ae8c41c1f78823c0feb810ae4723/doc%2Fapi%2Fhttp.md",
            "raw_url": "https://github.com/nodejs/node/raw/4b00c4fafaa2ae8c41c1f78823c0feb810ae4723/doc%2Fapi%2Fhttp.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fhttp.md?ref=4b00c4fafaa2ae8c41c1f78823c0feb810ae4723",
            "patch": "@@ -529,10 +529,16 @@ in the response to be dropped and the socket to be destroyed.\n ### request.aborted\n <!-- YAML\n added: v0.11.14\n+changes:\n+  - version: REPLACEME\n+    pr-url: https://github.com/nodejs/node/pull/20230\n+    description: The `aborted` property is no longer a timestamp number.\n -->\n \n-If a request has been aborted, this value is the time when the request was\n-aborted, in milliseconds since 1 January 1970 00:00:00 UTC.\n+* {boolean}\n+\n+The `request.aborted` property will be `true` if the request has\n+been aborted.\n \n ### request.connection\n <!-- YAML"
        },
        {
            "sha": "4b21cee745b3ceb7435b22b72580e9717475e158",
            "filename": "lib/_http_client.js",
            "status": "modified",
            "additions": 2,
            "deletions": 6,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4b00c4fafaa2ae8c41c1f78823c0feb810ae4723/lib%2F_http_client.js",
            "raw_url": "https://github.com/nodejs/node/raw/4b00c4fafaa2ae8c41c1f78823c0feb810ae4723/lib%2F_http_client.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_http_client.js?ref=4b00c4fafaa2ae8c41c1f78823c0feb810ae4723",
            "patch": "@@ -165,7 +165,7 @@ function ClientRequest(options, cb) {\n \n   this._ended = false;\n   this.res = null;\n-  this.aborted = undefined;\n+  this.aborted = false;\n   this.timeoutCb = null;\n   this.upgradeOrConnect = false;\n   this.parser = null;\n@@ -291,11 +291,7 @@ ClientRequest.prototype.abort = function abort() {\n   if (!this.aborted) {\n     process.nextTick(emitAbortNT.bind(this));\n   }\n-\n-  // Mark as aborting so we can avoid sending queued request data\n-  // This is used as a truthy flag elsewhere. The use of Date.now is for\n-  // debugging purposes only.\n-  this.aborted = Date.now();\n+  this.aborted = true;\n \n   // If we're aborting, we don't care about any more response data.\n   if (this.res) {"
        },
        {
            "sha": "04c4062faa2ea9cfddb2a33fadec589906ecba7b",
            "filename": "test/parallel/test-http-abort-stream-end.js",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/4b00c4fafaa2ae8c41c1f78823c0feb810ae4723/test%2Fparallel%2Ftest-http-abort-stream-end.js",
            "raw_url": "https://github.com/nodejs/node/raw/4b00c4fafaa2ae8c41c1f78823c0feb810ae4723/test%2Fparallel%2Ftest-http-abort-stream-end.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http-abort-stream-end.js?ref=4b00c4fafaa2ae8c41c1f78823c0feb810ae4723",
            "patch": "@@ -38,21 +38,20 @@ const server = http.createServer(common.mustCall((req, res) => {\n   res.end();\n }));\n \n-let aborted = false;\n server.listen(0, () => {\n-\n   const res = common.mustCall((res) => {\n     res.on('data', (chunk) => {\n       size += chunk.length;\n-      assert(!aborted, 'got data after abort');\n+      assert(!req.aborted, 'got data after abort');\n       if (size > maxSize) {\n-        aborted = true;\n         req.abort();\n+        assert.strictEqual(req.aborted, true);\n         size = maxSize;\n       }\n     });\n \n     req.on('abort', common.mustCall(() => assert.strictEqual(size, maxSize)));\n+    assert.strictEqual(req.aborted, false);\n   });\n \n   const req = http.get(`http://localhost:${server.address().port}`, res);"
        }
    ],
    "stats": {
        "total": 25,
        "additions": 13,
        "deletions": 12
    }
}