{
    "author": "aeisenberg",
    "message": "test: augment tests for SourceTextModule\n\nAdds tests for a few error conditions. Also, adds tests to make sure\nthe dynamically generated url is correct.\n\nPR-URL: https://github.com/nodejs/node/pull/23573\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\n\nPR-URL: https://github.com/nodejs/node/pull/23572\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>",
    "sha": "cac4909bf31f9eeb1071830cbb5cd6c77748b642",
    "files": [
        {
            "sha": "8cf687c2bb23a89cbb71e4376bcfbfc429f04008",
            "filename": "test/parallel/test-vm-module-basic.js",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/cac4909bf31f9eeb1071830cbb5cd6c77748b642/test%2Fparallel%2Ftest-vm-module-basic.js",
            "raw_url": "https://github.com/nodejs/node/raw/cac4909bf31f9eeb1071830cbb5cd6c77748b642/test%2Fparallel%2Ftest-vm-module-basic.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-basic.js?ref=cac4909bf31f9eeb1071830cbb5cd6c77748b642",
            "patch": "@@ -50,3 +50,16 @@ const { SourceTextModule, createContext } = require('vm');\n   await m.evaluate({ timeout: 500 })\n     .then(() => assert(false), () => {});\n })();\n+\n+// Check the generated url for each module\n+(async () => {\n+  const context1 = createContext({ });\n+  const context2 = createContext({ });\n+\n+  const m1 = new SourceTextModule('1', { context: context1 });\n+  assert.strictEqual(m1.url, 'vm:module(0)');\n+  const m2 = new SourceTextModule('2', { context: context1 });\n+  assert.strictEqual(m2.url, 'vm:module(1)');\n+  const m3 = new SourceTextModule('3', { context: context2 });\n+  assert.strictEqual(m3.url, 'vm:module(0)');\n+})();"
        },
        {
            "sha": "05022160832a539fe7fccb9d9f8c76a4da284a3a",
            "filename": "test/parallel/test-vm-module-errors.js",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/cac4909bf31f9eeb1071830cbb5cd6c77748b642/test%2Fparallel%2Ftest-vm-module-errors.js",
            "raw_url": "https://github.com/nodejs/node/raw/cac4909bf31f9eeb1071830cbb5cd6c77748b642/test%2Fparallel%2Ftest-vm-module-errors.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-vm-module-errors.js?ref=cac4909bf31f9eeb1071830cbb5cd6c77748b642",
            "patch": "@@ -43,7 +43,8 @@ async function checkArgType() {\n   });\n \n   for (const invalidOptions of [\n-    0, 1, null, true, 'str', () => {}, { url: 0 }, Symbol.iterator\n+    0, 1, null, true, 'str', () => {}, { url: 0 }, Symbol.iterator,\n+    { context: null }, { context: 'hucairz' }, { context: {} }\n   ]) {\n     common.expectsError(() => {\n       new SourceTextModule('', invalidOptions);\n@@ -231,6 +232,17 @@ async function checkLinking() {\n   });\n }\n \n+common.expectsError(() => {\n+  new SourceTextModule('', {\n+    importModuleDynamically: 'hucairz'\n+  });\n+}, {\n+  code: 'ERR_INVALID_ARG_TYPE',\n+  type: TypeError,\n+  message: 'The \"options.importModuleDynamically\"' +\n+    ' property must be of type function. Received type string'\n+});\n+\n // Check the JavaScript engine deals with exceptions correctly\n async function checkExecution() {\n   await (async () => {"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 26,
        "deletions": 1
    }
}