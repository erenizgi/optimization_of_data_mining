{
    "author": "BridgeAR",
    "message": "benchmark: (http(2)) refactor\n\nPR-URL: https://github.com/nodejs/node/pull/18320\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "1178670cca16a268162aaf39afeb933779988d22",
    "files": [
        {
            "sha": "d629fe67e59e76fe2694b621c962e1488deec538",
            "filename": "benchmark/http/bench-parser.js",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp%2Fbench-parser.js",
            "raw_url": "https://github.com/nodejs/node/raw/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp%2Fbench-parser.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fhttp%2Fbench-parser.js?ref=1178670cca16a268162aaf39afeb933779988d22",
            "patch": "@@ -14,7 +14,6 @@ const bench = common.createBenchmark(main, {\n   n: [1e5],\n });\n \n-\n function main({ len, n }) {\n   var header = `GET /hello HTTP/1.1${CRLF}Content-Type: text/plain${CRLF}`;\n \n@@ -26,7 +25,6 @@ function main({ len, n }) {\n   processHeader(Buffer.from(header), n);\n }\n \n-\n function processHeader(header, n) {\n   const parser = newParser(REQUEST);\n \n@@ -38,7 +36,6 @@ function processHeader(header, n) {\n   bench.end(n);\n }\n \n-\n function newParser(type) {\n   const parser = new HTTPParser(type);\n "
        },
        {
            "sha": "bbc59a341d15ba6e67091fc6835cc240c783673f",
            "filename": "benchmark/http/simple.js",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp%2Fsimple.js",
            "raw_url": "https://github.com/nodejs/node/raw/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp%2Fsimple.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fhttp%2Fsimple.js?ref=1178670cca16a268162aaf39afeb933779988d22",
            "patch": "@@ -1,6 +1,5 @@\n 'use strict';\n const common = require('../common.js');\n-const PORT = common.PORT;\n \n const bench = common.createBenchmark(main, {\n   // unicode confuses ab on os x.\n@@ -13,9 +12,8 @@ const bench = common.createBenchmark(main, {\n });\n \n function main({ type, len, chunks, c, chunkedEnc, res }) {\n-  process.env.PORT = PORT;\n   var server = require('../fixtures/simple-http-server.js')\n-  .listen(PORT)\n+  .listen(common.PORT)\n   .on('listening', function() {\n     const path = `/${type}/${len}/${chunks}/${res}/${chunkedEnc}`;\n "
        },
        {
            "sha": "6b39323396a2e38a96eb2bc49783b9d0baed15f3",
            "filename": "benchmark/http/upgrade.js",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp%2Fupgrade.js",
            "raw_url": "https://github.com/nodejs/node/raw/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp%2Fupgrade.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fhttp%2Fupgrade.js?ref=1178670cca16a268162aaf39afeb933779988d22",
            "patch": "@@ -1,7 +1,6 @@\n 'use strict';\n \n const common = require('../common.js');\n-const PORT = common.PORT;\n const net = require('net');\n \n const bench = common.createBenchmark(main, {\n@@ -20,7 +19,6 @@ const resData = 'HTTP/1.1 101 Web Socket Protocol Handshake\\r\\n' +\n                 '\\r\\n\\r\\n';\n \n function main({ n }) {\n-  process.env.PORT = PORT;\n   var server = require('../fixtures/simple-http-server.js')\n     .listen(common.PORT)\n     .on('listening', function() {"
        },
        {
            "sha": "fa7b2fbd16b3e6dad94d6b8497ee311d03bf38b8",
            "filename": "benchmark/http2/respond-with-fd.js",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp2%2Frespond-with-fd.js",
            "raw_url": "https://github.com/nodejs/node/raw/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp2%2Frespond-with-fd.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fhttp2%2Frespond-with-fd.js?ref=1178670cca16a268162aaf39afeb933779988d22",
            "patch": "@@ -1,7 +1,6 @@\n 'use strict';\n \n const common = require('../common.js');\n-const PORT = common.PORT;\n const path = require('path');\n const fs = require('fs');\n \n@@ -25,7 +24,7 @@ function main({ requests, streams, clients }) {\n       stream.respondWithFD(fd);\n       stream.on('error', (err) => {});\n     });\n-    server.listen(PORT, () => {\n+    server.listen(common.PORT, () => {\n       bench.http({\n         path: '/',\n         requests,"
        },
        {
            "sha": "cf017e6735411e0755d531cff0b367a545a8616a",
            "filename": "benchmark/http2/simple.js",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp2%2Fsimple.js",
            "raw_url": "https://github.com/nodejs/node/raw/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp2%2Fsimple.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fhttp2%2Fsimple.js?ref=1178670cca16a268162aaf39afeb933779988d22",
            "patch": "@@ -1,11 +1,8 @@\n 'use strict';\n \n const common = require('../common.js');\n-const PORT = common.PORT;\n-\n const path = require('path');\n const fs = require('fs');\n-\n const file = path.join(path.resolve(__dirname, '../fixtures'), 'alice.html');\n \n const bench = common.createBenchmark(main, {\n@@ -24,7 +21,7 @@ function main({ requests, streams, clients }) {\n     out.pipe(stream);\n     stream.on('error', (err) => {});\n   });\n-  server.listen(PORT, () => {\n+  server.listen(common.PORT, () => {\n     bench.http({\n       path: '/',\n       requests,"
        },
        {
            "sha": "6fcb1254ca3f057ac113f4f6d277c33ae39b09d8",
            "filename": "benchmark/http2/write.js",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp2%2Fwrite.js",
            "raw_url": "https://github.com/nodejs/node/raw/1178670cca16a268162aaf39afeb933779988d22/benchmark%2Fhttp2%2Fwrite.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fhttp2%2Fwrite.js?ref=1178670cca16a268162aaf39afeb933779988d22",
            "patch": "@@ -1,7 +1,6 @@\n 'use strict';\n \n const common = require('../common.js');\n-const PORT = common.PORT;\n \n const bench = common.createBenchmark(main, {\n   streams: [100, 200, 1000],\n@@ -26,7 +25,7 @@ function main({ streams, length, size }) {\n     }\n     write();\n   });\n-  server.listen(PORT, () => {\n+  server.listen(common.PORT, () => {\n     bench.http({\n       path: '/',\n       requests: 10000,"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 4,
        "deletions": 16
    }
}