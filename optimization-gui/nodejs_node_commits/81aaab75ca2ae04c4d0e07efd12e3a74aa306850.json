{
    "author": "BridgeAR",
    "message": "benchmark: remove noAssert argument\n\nThis removes the `noAssert` argument and also adds some more tests.\n\nPR-URL: https://github.com/nodejs/node/pull/18395\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Anatoli Papirovski <apapirovski@mac.com>\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>",
    "sha": "81aaab75ca2ae04c4d0e07efd12e3a74aa306850",
    "files": [
        {
            "sha": "e105642972d857c77631f00527b07eff963b9103",
            "filename": "benchmark/buffers/buffer-read-float.js",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/benchmark%2Fbuffers%2Fbuffer-read-float.js",
            "raw_url": "https://github.com/nodejs/node/raw/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/benchmark%2Fbuffers%2Fbuffer-read-float.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fbuffers%2Fbuffer-read-float.js?ref=81aaab75ca2ae04c4d0e07efd12e3a74aa306850",
            "patch": "@@ -2,15 +2,13 @@\n const common = require('../common.js');\n \n const bench = common.createBenchmark(main, {\n-  noAssert: ['false', 'true'],\n   type: ['Double', 'Float'],\n   endian: ['BE', 'LE'],\n   value: ['zero', 'big', 'small', 'inf', 'nan'],\n   millions: [1]\n });\n \n-function main({ noAssert, millions, type, endian, value }) {\n-  noAssert = noAssert === 'true';\n+function main({ millions, type, endian, value }) {\n   type = type || 'Double';\n   const buff = Buffer.alloc(8);\n   const fn = `read${type}${endian}`;\n@@ -31,11 +29,11 @@ function main({ noAssert, millions, type, endian, value }) {\n     },\n   };\n \n-  buff[`write${type}${endian}`](values[type][value], 0, noAssert);\n+  buff[`write${type}${endian}`](values[type][value], 0);\n \n   bench.start();\n   for (var i = 0; i !== millions * 1e6; i++) {\n-    buff[fn](0, noAssert);\n+    buff[fn](0);\n   }\n   bench.end(millions);\n }"
        },
        {
            "sha": "1858c4fd965e26c963c6b751a04a0009822c4c2b",
            "filename": "benchmark/buffers/buffer-read-with-byteLength.js",
            "status": "modified",
            "additions": 5,
            "deletions": 8,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/benchmark%2Fbuffers%2Fbuffer-read-with-byteLength.js",
            "raw_url": "https://github.com/nodejs/node/raw/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/benchmark%2Fbuffers%2Fbuffer-read-with-byteLength.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fbuffers%2Fbuffer-read-with-byteLength.js?ref=81aaab75ca2ae04c4d0e07efd12e3a74aa306850",
            "patch": "@@ -9,24 +9,21 @@ const types = [\n ];\n \n const bench = common.createBenchmark(main, {\n-  noAssert: ['false', 'true'],\n   buffer: ['fast', 'slow'],\n   type: types,\n   millions: [1],\n-  byteLength: [1, 2, 4, 6]\n+  byteLength: [1, 2, 3, 4, 5, 6]\n });\n \n-function main({ millions, noAssert, buf, type, byteLength }) {\n-  noAssert = noAssert === 'true';\n-  type = type || 'UInt8';\n+function main({ millions, buf, type, byteLength }) {\n   const clazz = buf === 'fast' ? Buffer : require('buffer').SlowBuffer;\n   const buff = new clazz(8);\n-  const fn = `read${type}`;\n+  const fn = `read${type || 'IntBE'}`;\n \n-  buff.writeDoubleLE(0, 0, noAssert);\n+  buff.writeDoubleLE(0, 0);\n   bench.start();\n   for (var i = 0; i !== millions * 1e6; i++) {\n-    buff[fn](0, byteLength, noAssert);\n+    buff[fn](0, byteLength);\n   }\n   bench.end(millions);\n }"
        },
        {
            "sha": "88a46cb29079f6f12b03bccd29e41eaaa777da5b",
            "filename": "benchmark/buffers/buffer-read.js",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/benchmark%2Fbuffers%2Fbuffer-read.js",
            "raw_url": "https://github.com/nodejs/node/raw/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/benchmark%2Fbuffers%2Fbuffer-read.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fbuffers%2Fbuffer-read.js?ref=81aaab75ca2ae04c4d0e07efd12e3a74aa306850",
            "patch": "@@ -19,22 +19,20 @@ const types = [\n ];\n \n const bench = common.createBenchmark(main, {\n-  noAssert: ['false', 'true'],\n   buffer: ['fast', 'slow'],\n   type: types,\n   millions: [1]\n });\n \n-function main({ noAssert, millions, buf, type }) {\n-  noAssert = noAssert === 'true';\n+function main({ millions, buf, type }) {\n   const clazz = buf === 'fast' ? Buffer : require('buffer').SlowBuffer;\n   const buff = new clazz(8);\n   const fn = `read${type || 'UInt8'}`;\n \n-  buff.writeDoubleLE(0, 0, noAssert);\n+  buff.writeDoubleLE(0, 0);\n   bench.start();\n   for (var i = 0; i !== millions * 1e6; i++) {\n-    buff[fn](0, noAssert);\n+    buff[fn](0);\n   }\n   bench.end(millions);\n }"
        },
        {
            "sha": "42ea9aa093cb886ebfd26f2e1f5f9bcbe66dac5c",
            "filename": "benchmark/buffers/buffer-write.js",
            "status": "modified",
            "additions": 40,
            "deletions": 14,
            "changes": 54,
            "blob_url": "https://github.com/nodejs/node/blob/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/benchmark%2Fbuffers%2Fbuffer-write.js",
            "raw_url": "https://github.com/nodejs/node/raw/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/benchmark%2Fbuffers%2Fbuffer-write.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/benchmark%2Fbuffers%2Fbuffer-write.js?ref=81aaab75ca2ae04c4d0e07efd12e3a74aa306850",
            "patch": "@@ -7,19 +7,22 @@ const types = [\n   'UInt16BE',\n   'UInt32LE',\n   'UInt32BE',\n+  'UIntLE',\n+  'UIntBE',\n   'Int8',\n   'Int16LE',\n   'Int16BE',\n   'Int32LE',\n   'Int32BE',\n+  'IntLE',\n+  'IntBE',\n   'FloatLE',\n   'FloatBE',\n   'DoubleLE',\n   'DoubleBE'\n ];\n \n const bench = common.createBenchmark(main, {\n-  noAssert: ['false', 'true'],\n   buffer: ['fast', 'slow'],\n   type: types,\n   millions: [1]\n@@ -28,9 +31,9 @@ const bench = common.createBenchmark(main, {\n const INT8 = 0x7f;\n const INT16 = 0x7fff;\n const INT32 = 0x7fffffff;\n-const UINT8 = (INT8 * 2) + 1;\n-const UINT16 = (INT16 * 2) + 1;\n-const UINT32 = INT32;\n+const INT48 = 0x7fffffffffff;\n+const UINT8 = 0xff;\n+const UINT16 = 0xffff;\n \n const mod = {\n   writeInt8: INT8,\n@@ -41,34 +44,57 @@ const mod = {\n   writeUInt8: UINT8,\n   writeUInt16BE: UINT16,\n   writeUInt16LE: UINT16,\n-  writeUInt32BE: UINT32,\n-  writeUInt32LE: UINT32\n+  writeUInt32BE: INT32,\n+  writeUInt32LE: INT32,\n+  writeUIntLE: INT8,\n+  writeUIntBE: INT16,\n+  writeIntLE: INT32,\n+  writeIntBE: INT48\n };\n \n-function main({ noAssert, millions, buf, type }) {\n+const byteLength = {\n+  writeUIntLE: 1,\n+  writeUIntBE: 2,\n+  writeIntLE: 4,\n+  writeIntBE: 6\n+};\n+\n+function main({ millions, buf, type }) {\n   const clazz = buf === 'fast' ? Buffer : require('buffer').SlowBuffer;\n   const buff = new clazz(8);\n   const fn = `write${type || 'UInt8'}`;\n \n-  if (/Int/.test(fn))\n-    benchInt(buff, fn, millions, noAssert);\n+  if (!/\\d/.test(fn))\n+    benchSpecialInt(buff, fn, millions);\n+  else if (/Int/.test(fn))\n+    benchInt(buff, fn, millions);\n   else\n-    benchFloat(buff, fn, millions, noAssert);\n+    benchFloat(buff, fn, millions);\n+}\n+\n+function benchInt(buff, fn, millions) {\n+  const m = mod[fn];\n+  bench.start();\n+  for (var i = 0; i !== millions * 1e6; i++) {\n+    buff[fn](i & m, 0);\n+  }\n+  bench.end(millions);\n }\n \n-function benchInt(buff, fn, millions, noAssert) {\n+function benchSpecialInt(buff, fn, millions) {\n   const m = mod[fn];\n+  const byte = byteLength[fn];\n   bench.start();\n   for (var i = 0; i !== millions * 1e6; i++) {\n-    buff[fn](i & m, 0, noAssert);\n+    buff[fn](i & m, 0, byte);\n   }\n   bench.end(millions);\n }\n \n-function benchFloat(buff, fn, millions, noAssert) {\n+function benchFloat(buff, fn, millions) {\n   bench.start();\n   for (var i = 0; i !== millions * 1e6; i++) {\n-    buff[fn](i, 0, noAssert);\n+    buff[fn](i, 0);\n   }\n   bench.end(millions);\n }"
        },
        {
            "sha": "4eb4415a61dd7f5a52fd69c19050554222c40996",
            "filename": "test/sequential/test-benchmark-buffer.js",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/test%2Fsequential%2Ftest-benchmark-buffer.js",
            "raw_url": "https://github.com/nodejs/node/raw/81aaab75ca2ae04c4d0e07efd12e3a74aa306850/test%2Fsequential%2Ftest-benchmark-buffer.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-benchmark-buffer.js?ref=81aaab75ca2ae04c4d0e07efd12e3a74aa306850",
            "patch": "@@ -16,7 +16,6 @@ runBenchmark('buffers',\n                'millions=0.000001',\n                'method=',\n                'n=1',\n-               'noAssert=true',\n                'pieces=1',\n                'pieceSize=1',\n                'search=@',"
        }
    ],
    "stats": {
        "total": 84,
        "additions": 51,
        "deletions": 33
    }
}