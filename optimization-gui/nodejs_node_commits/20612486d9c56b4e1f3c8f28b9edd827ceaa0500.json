{
    "author": "danbev",
    "message": "crypto: make pbkdf2 use checkIsArrayBufferView\n\nThis commit updates pbkdf2 to use checkIsArrayBufferView from\ninternal/crypto/util.\n\nPR-URL: https://github.com/nodejs/node/pull/20251\nReviewed-By: Ben Noordhuis <info@bnoordhuis.nl>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>",
    "sha": "20612486d9c56b4e1f3c8f28b9edd827ceaa0500",
    "files": [
        {
            "sha": "82ea9feb852649e6a284f0de11e6a625fee432d8",
            "filename": "lib/internal/crypto/pbkdf2.js",
            "status": "modified",
            "additions": 3,
            "deletions": 14,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/20612486d9c56b4e1f3c8f28b9edd827ceaa0500/lib%2Finternal%2Fcrypto%2Fpbkdf2.js",
            "raw_url": "https://github.com/nodejs/node/raw/20612486d9c56b4e1f3c8f28b9edd827ceaa0500/lib%2Finternal%2Fcrypto%2Fpbkdf2.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fcrypto%2Fpbkdf2.js?ref=20612486d9c56b4e1f3c8f28b9edd827ceaa0500",
            "patch": "@@ -7,10 +7,10 @@ const {\n   ERR_OUT_OF_RANGE\n } = require('internal/errors').codes;\n const {\n+  checkIsArrayBufferView,\n   getDefaultEncoding,\n   toBuf\n } = require('internal/crypto/util');\n-const { isArrayBufferView } = require('internal/util/types');\n const {\n   PBKDF2\n } = process.binding('crypto');\n@@ -39,19 +39,8 @@ function _pbkdf2(password, salt, iterations, keylen, digest, callback) {\n   if (digest !== null && typeof digest !== 'string')\n     throw new ERR_INVALID_ARG_TYPE('digest', ['string', 'null'], digest);\n \n-  password = toBuf(password);\n-  salt = toBuf(salt);\n-\n-  if (!isArrayBufferView(password)) {\n-    throw new ERR_INVALID_ARG_TYPE('password',\n-                                   ['string', 'Buffer', 'TypedArray'],\n-                                   password);\n-  }\n-\n-  if (!isArrayBufferView(salt)) {\n-    throw new ERR_INVALID_ARG_TYPE('salt',\n-                                   ['string', 'Buffer', 'TypedArray'], salt);\n-  }\n+  password = checkIsArrayBufferView('password', toBuf(password));\n+  salt = checkIsArrayBufferView('salt', toBuf(salt));\n \n   if (typeof iterations !== 'number')\n     throw new ERR_INVALID_ARG_TYPE('iterations', 'number', iterations);"
        },
        {
            "sha": "f65176132ae5c49991db4b1c9f6ac275ebb5fda2",
            "filename": "test/parallel/test-crypto-pbkdf2.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/20612486d9c56b4e1f3c8f28b9edd827ceaa0500/test%2Fparallel%2Ftest-crypto-pbkdf2.js",
            "raw_url": "https://github.com/nodejs/node/raw/20612486d9c56b4e1f3c8f28b9edd827ceaa0500/test%2Fparallel%2Ftest-crypto-pbkdf2.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-crypto-pbkdf2.js?ref=20612486d9c56b4e1f3c8f28b9edd827ceaa0500",
            "patch": "@@ -123,7 +123,8 @@ assert.throws(\n   });\n \n [1, {}, [], true, undefined, null].forEach((input) => {\n-  const msgPart2 = `Buffer, or TypedArray. Received type ${typeof input}`;\n+  const msgPart2 = 'Buffer, TypedArray, or DataView.' +\n+                   ` Received type ${typeof input}`;\n   assert.throws(\n     () => crypto.pbkdf2(input, 'salt', 8, 8, 'sha256', common.mustNotCall()),\n     {"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 5,
        "deletions": 15
    }
}