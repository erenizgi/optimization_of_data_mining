{
    "author": "bnoordhuis",
    "message": "src: remove unnecessary Reset() calls\n\nThe previous commit made persistent handles auto-reset on destruction.\nThis commit removes the Reset() calls that are now no longer necessary.\n\nPR-URL: https://github.com/nodejs/node/pull/18656\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
    "files": [
        {
            "sha": "57f61d94923309867c5291fe060ff90464c2eb25",
            "filename": "src/async_wrap.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fasync_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fasync_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fasync_wrap.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -425,8 +425,6 @@ void AsyncWrap::WeakCallback(const v8::WeakCallbackInfo<DestroyParam>& info) {\n   if (val->IsFalse()) {\n     AsyncWrap::EmitDestroy(env, p->asyncId);\n   }\n-  p->target.Reset();\n-  p->propBag.Reset();\n   delete p;\n }\n "
        },
        {
            "sha": "51ef46599667df7d1a7128a30010887376ff1127",
            "filename": "src/base_object-inl.h",
            "status": "modified",
            "additions": 1,
            "deletions": 7,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fbase_object-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fbase_object-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fbase_object-inl.h?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -42,11 +42,6 @@ inline BaseObject::BaseObject(Environment* env, v8::Local<v8::Object> handle)\n }\n \n \n-inline BaseObject::~BaseObject() {\n-  CHECK(persistent_handle_.IsEmpty());\n-}\n-\n-\n inline Persistent<v8::Object>& BaseObject::persistent() {\n   return persistent_handle_;\n }\n@@ -65,8 +60,7 @@ inline Environment* BaseObject::env() const {\n template <typename Type>\n inline void BaseObject::WeakCallback(\n     const v8::WeakCallbackInfo<Type>& data) {\n-  std::unique_ptr<Type> self(data.GetParameter());\n-  self->persistent().Reset();\n+  delete data.GetParameter();\n }\n \n "
        },
        {
            "sha": "478499bbfeb5b20dad5e189d919a125bbb35e17f",
            "filename": "src/base_object.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fbase_object.h",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fbase_object.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fbase_object.h?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -34,7 +34,7 @@ class Environment;\n class BaseObject {\n  public:\n   inline BaseObject(Environment* env, v8::Local<v8::Object> handle);\n-  inline virtual ~BaseObject();\n+  virtual ~BaseObject() = default;\n \n   // Returns the wrapped object.  Returns an empty handle when\n   // persistent.IsEmpty() is true."
        },
        {
            "sha": "a06f4f407cdd5c6c2913e1fae6000849ac7538f5",
            "filename": "src/cares_wrap.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fcares_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fcares_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fcares_wrap.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -598,7 +598,6 @@ class QueryWrap : public AsyncWrap {\n   ~QueryWrap() override {\n     CHECK_EQ(false, persistent().IsEmpty());\n     ClearWrap(object());\n-    persistent().Reset();\n   }\n \n   // Subclasses should implement the appropriate Send method."
        },
        {
            "sha": "365ace55784837f13948f9eee90874a0bf092a8b",
            "filename": "src/env-inl.h",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fenv-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fenv-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv-inl.h?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -370,9 +370,6 @@ inline Environment::~Environment() {\n \n   context()->SetAlignedPointerInEmbedderData(kContextEmbedderDataIndex,\n                                              nullptr);\n-#define V(PropertyName, TypeName) PropertyName ## _.Reset();\n-  ENVIRONMENT_STRONG_PERSISTENT_PROPERTIES(V)\n-#undef V\n \n   delete[] heap_statistics_buffer_;\n   delete[] heap_space_statistics_buffer_;"
        },
        {
            "sha": "f02cb36fe53f1ea639660c37358b736ee5a6adb3",
            "filename": "src/env.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fenv.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fenv.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -314,8 +314,6 @@ void Environment::RunAndClearNativeImmediates() {\n       v8::TryCatch try_catch(isolate());\n       for (auto it = list.begin(); it != list.end(); ++it) {\n         it->cb_(this, it->data_);\n-        if (it->keep_alive_)\n-          it->keep_alive_->Reset();\n         if (it->refed_)\n           ref_count++;\n         if (UNLIKELY(try_catch.HasCaught())) {"
        },
        {
            "sha": "a3b0209eb3121f2d726a34b457ee57eb974c5d57",
            "filename": "src/handle_wrap.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fhandle_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fhandle_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fhandle_wrap.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -98,11 +98,6 @@ HandleWrap::HandleWrap(Environment* env,\n }\n \n \n-HandleWrap::~HandleWrap() {\n-  CHECK(persistent().IsEmpty());\n-}\n-\n-\n void HandleWrap::OnClose(uv_handle_t* handle) {\n   HandleWrap* wrap = static_cast<HandleWrap*>(handle->data);\n   Environment* env = wrap->env();\n@@ -120,7 +115,6 @@ void HandleWrap::OnClose(uv_handle_t* handle) {\n     wrap->MakeCallback(env->onclose_string(), 0, nullptr);\n \n   ClearWrap(wrap->object());\n-  wrap->persistent().Reset();\n   delete wrap;\n }\n "
        },
        {
            "sha": "e7a335f5140253eb963142fcc11cc8afb606e227",
            "filename": "src/handle_wrap.h",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fhandle_wrap.h",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fhandle_wrap.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fhandle_wrap.h?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -75,7 +75,6 @@ class HandleWrap : public AsyncWrap {\n              v8::Local<v8::Object> object,\n              uv_handle_t* handle,\n              AsyncWrap::ProviderType provider);\n-  ~HandleWrap() override;\n \n  private:\n   friend class Environment;"
        },
        {
            "sha": "1cced9420aea6c0a19115a364e009b250e9b116b",
            "filename": "src/inspector_js_api.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Finspector_js_api.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Finspector_js_api.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Finspector_js_api.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -84,10 +84,6 @@ class JSBindingsConnection : public AsyncWrap {\n     inspector->Connect(&delegate_);\n   }\n \n-  ~JSBindingsConnection() override {\n-    callback_.Reset();\n-  }\n-\n   void OnMessage(Local<Value> value) {\n     MakeCallback(callback_.Get(env()->isolate()), 1, &value);\n   }\n@@ -111,7 +107,6 @@ class JSBindingsConnection : public AsyncWrap {\n     delegate_.Disconnect();\n     if (!persistent().IsEmpty()) {\n       ClearWrap(object());\n-      persistent().Reset();\n     }\n     delete this;\n   }"
        },
        {
            "sha": "617bae8b60e3e0f463d31dab7e941de37b2bf19f",
            "filename": "src/module_wrap.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fmodule_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fmodule_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fmodule_wrap.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -60,9 +60,6 @@ ModuleWrap::~ModuleWrap() {\n       break;\n     }\n   }\n-\n-  module_.Reset();\n-  context_.Reset();\n }\n \n ModuleWrap* ModuleWrap::GetFromModule(Environment* env,\n@@ -227,8 +224,6 @@ void ModuleWrap::Instantiate(const FunctionCallbackInfo<Value>& args) {\n       module->InstantiateModule(context, ModuleWrap::ResolveCallback);\n \n   // clear resolve cache on instantiate\n-  for (auto& entry : obj->resolve_cache_)\n-    entry.second.Reset();\n   obj->resolve_cache_.clear();\n \n   if (!ok.FromMaybe(false)) {"
        },
        {
            "sha": "63ce1d8e86955efd69435fe5fa352f9e45894452",
            "filename": "src/node_api.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 17,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_api.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_api.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_api.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -31,12 +31,6 @@ struct napi_env__ {\n       : isolate(_isolate),\n         last_error(),\n         loop(_loop) {}\n-  ~napi_env__() {\n-    last_exception.Reset();\n-    wrap_template.Reset();\n-    function_data_template.Reset();\n-    accessor_data_template.Reset();\n-  }\n   v8::Isolate* isolate;\n   node::Persistent<v8::Value> last_exception;\n   node::Persistent<v8::ObjectTemplate> wrap_template;\n@@ -381,16 +375,6 @@ class Reference : private Finalizer {\n     }\n   }\n \n-  ~Reference() {\n-    // The V8 Persistent class currently does not reset in its destructor:\n-    // see NonCopyablePersistentTraits::kResetInDestructor = false.\n-    // (Comments there claim that might change in the future.)\n-    // To avoid memory leaks, it is better to reset at this time, however\n-    // care must be taken to avoid attempting this after the Isolate has\n-    // shut down, for example via a static (atexit) destructor.\n-    _persistent.Reset();\n-  }\n-\n  public:\n   void* Data() {\n     return _finalize_data;\n@@ -857,7 +841,6 @@ napi_status ConcludeDeferred(napi_env env,\n       v8_resolver->Resolve(context, v8impl::V8LocalValueFromJsValue(result)) :\n       v8_resolver->Reject(context, v8impl::V8LocalValueFromJsValue(result));\n \n-  deferred_ref->Reset();\n   delete deferred_ref;\n \n   RETURN_STATUS_IF_FALSE(env, success.FromMaybe(false), napi_generic_failure);"
        },
        {
            "sha": "2b90d01b7de9493788335259e8d5a476dc497642",
            "filename": "src/node_buffer.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_buffer.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_buffer.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_buffer.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -102,7 +102,6 @@ class CallbackInfo {\n                       FreeCallback callback,\n                       char* data,\n                       void* hint);\n-  ~CallbackInfo();\n   Persistent<ArrayBuffer> persistent_;\n   FreeCallback const callback_;\n   char* const data_;\n@@ -146,11 +145,6 @@ CallbackInfo::CallbackInfo(Isolate* isolate,\n }\n \n \n-CallbackInfo::~CallbackInfo() {\n-  persistent_.Reset();\n-}\n-\n-\n void CallbackInfo::WeakCallback(\n     const WeakCallbackInfo<CallbackInfo>& data) {\n   CallbackInfo* self = data.GetParameter();"
        },
        {
            "sha": "21e48e6338a609090f5557947a7994442a4bd6a1",
            "filename": "src/node_contextify.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 10,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_contextify.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_contextify.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_contextify.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -107,11 +107,6 @@ ContextifyContext::ContextifyContext(\n }\n \n \n-ContextifyContext::~ContextifyContext() {\n-  context_.Reset();\n-}\n-\n-\n // This is an object that just keeps an internal pointer to this\n // ContextifyContext.  It's passed to the NamedPropertyHandler.  If we\n // pass the main JavaScript context object we're embedded in, then the\n@@ -1123,11 +1118,6 @@ class ContextifyScript : public BaseObject {\n       : BaseObject(env, object) {\n     MakeWeak<ContextifyScript>(this);\n   }\n-\n-\n-  ~ContextifyScript() override {\n-    script_.Reset();\n-  }\n };\n \n "
        },
        {
            "sha": "9f83740e43c73d20f10f201932f6480ecc72f859",
            "filename": "src/node_contextify.h",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_contextify.h",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_contextify.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_contextify.h?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -21,7 +21,6 @@ class ContextifyContext {\n   ContextifyContext(Environment* env,\n                     v8::Local<v8::Object> sandbox_obj,\n                     v8::Local<v8::Object> options_obj);\n-  ~ContextifyContext();\n \n   v8::Local<v8::Value> CreateDataWrapper(Environment* env);\n   v8::Local<v8::Context> CreateV8Context(Environment* env,"
        },
        {
            "sha": "211b142f383aad912aaf1f78b52e3b44900f8878",
            "filename": "src/node_crypto.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_crypto.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_crypto.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -2771,7 +2771,6 @@ void SSLWrap<Base>::CertCbDone(const FunctionCallbackInfo<Value>& args) {\n   if (cons->HasInstance(ctx)) {\n     SecureContext* sc;\n     ASSIGN_OR_RETURN_UNWRAP(&sc, ctx.As<Object>());\n-    w->sni_context_.Reset();\n     w->sni_context_.Reset(env->isolate(), ctx);\n \n     int rv;\n@@ -4912,7 +4911,6 @@ class PBKDF2Request : public AsyncWrap {\n     keylen_ = 0;\n \n     ClearWrap(object());\n-    persistent().Reset();\n   }\n \n   uv_work_t* work_req() {\n@@ -5079,7 +5077,6 @@ class RandomBytesRequest : public AsyncWrap {\n \n   ~RandomBytesRequest() override {\n     ClearWrap(object());\n-    persistent().Reset();\n   }\n \n   uv_work_t* work_req() {"
        },
        {
            "sha": "05ea79f71f056520ddd32b99fabc8b9b06644183",
            "filename": "src/node_crypto.h",
            "status": "modified",
            "additions": 0,
            "deletions": 8,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_crypto.h",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_crypto.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto.h?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -225,14 +225,6 @@ class SSLWrap {\n       SSL_SESSION_free(next_sess_);\n       next_sess_ = nullptr;\n     }\n-\n-#ifdef SSL_CTRL_SET_TLSEXT_SERVERNAME_CB\n-    sni_context_.Reset();\n-#endif\n-\n-#ifdef NODE__HAVE_TLSEXT_STATUS_CB\n-    ocsp_response_.Reset();\n-#endif  // NODE__HAVE_TLSEXT_STATUS_CB\n   }\n \n   inline SSL* ssl() const { return ssl_; }"
        },
        {
            "sha": "1ef95134f3933695d98ad5263de38961d517a285",
            "filename": "src/node_file.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_file.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_file.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_file.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -132,7 +132,6 @@ FileHandle::~FileHandle() {\n   CHECK(!closing_);  // We should not be deleting while explicitly closing!\n   Close();           // Close synchronously and emit warning\n   CHECK(closed_);    // We have to be closed at the point\n-  CHECK(persistent().IsEmpty());\n }\n \n "
        },
        {
            "sha": "8c9103885c7be716c2d8a74ab85c87a57afd8774",
            "filename": "src/node_http2.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 8,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_http2.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_http2.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_http2.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -278,8 +278,6 @@ Http2Session::Http2Settings::Http2Settings(\n Http2Session::Http2Settings::~Http2Settings() {\n   if (!object().IsEmpty())\n     ClearWrap(object());\n-  persistent().Reset();\n-  CHECK(persistent().IsEmpty());\n }\n \n // Generates a Buffer that contains the serialized payload of a SETTINGS\n@@ -535,8 +533,6 @@ Http2Session::~Http2Session() {\n   CHECK_EQ(flags_ & SESSION_STATE_HAS_SCOPE, 0);\n   if (!object().IsEmpty())\n     ClearWrap(object());\n-  persistent().Reset();\n-  CHECK(persistent().IsEmpty());\n   DEBUG_HTTP2SESSION(this, \"freeing nghttp2 session\");\n   nghttp2_session_del(session_);\n }\n@@ -1766,8 +1762,6 @@ Http2Stream::~Http2Stream() {\n \n   if (!object().IsEmpty())\n     ClearWrap(object());\n-  persistent().Reset();\n-  CHECK(persistent().IsEmpty());\n }\n \n // Notify the Http2Stream that a new block of HEADERS is being processed.\n@@ -2772,8 +2766,6 @@ Http2Session::Http2Ping::Http2Ping(\n Http2Session::Http2Ping::~Http2Ping() {\n   if (!object().IsEmpty())\n     ClearWrap(object());\n-  persistent().Reset();\n-  CHECK(persistent().IsEmpty());\n }\n \n void Http2Session::Http2Ping::Send(uint8_t* payload) {"
        },
        {
            "sha": "207310f4068f4314b4e3fa63ead7dc7dc0750da1",
            "filename": "src/node_http_parser.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_http_parser.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Fnode_http_parser.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_http_parser.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -157,7 +157,6 @@ class Parser : public AsyncWrap, public StreamListener {\n \n   ~Parser() override {\n     ClearWrap(object());\n-    persistent().Reset();\n   }\n \n "
        },
        {
            "sha": "11b1389fa0e771934ff3d0410e5ed469cb11c9da",
            "filename": "src/req_wrap-inl.h",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Freq_wrap-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Freq_wrap-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Freq_wrap-inl.h?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -25,7 +25,6 @@ template <typename T>\n ReqWrap<T>::~ReqWrap() {\n   CHECK_EQ(req_.data, this);  // Assert that someone has called Dispatched().\n   CHECK_EQ(false, persistent().IsEmpty());\n-  persistent().Reset();\n }\n \n template <typename T>"
        },
        {
            "sha": "61b08217b8f1292cd67ef801697b9736754ba579",
            "filename": "src/tcp_wrap.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Ftcp_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Ftcp_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftcp_wrap.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -174,11 +174,6 @@ TCPWrap::TCPWrap(Environment* env, Local<Object> object, ProviderType provider)\n }\n \n \n-TCPWrap::~TCPWrap() {\n-  CHECK(persistent().IsEmpty());\n-}\n-\n-\n void TCPWrap::SetNoDelay(const FunctionCallbackInfo<Value>& args) {\n   TCPWrap* wrap;\n   ASSIGN_OR_RETURN_UNWRAP(&wrap,"
        },
        {
            "sha": "2ab50f1fdcdfab9d39ed596a4266cfcdcb37cef5",
            "filename": "src/tcp_wrap.h",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Ftcp_wrap.h",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Ftcp_wrap.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftcp_wrap.h?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -55,7 +55,6 @@ class TCPWrap : public ConnectionWrap<TCPWrap, uv_tcp_t> {\n \n   TCPWrap(Environment* env, v8::Local<v8::Object> object,\n           ProviderType provider);\n-  ~TCPWrap();\n \n   static void New(const v8::FunctionCallbackInfo<v8::Value>& args);\n   static void SetNoDelay(const v8::FunctionCallbackInfo<v8::Value>& args);"
        },
        {
            "sha": "7e0962ee9e6056124750a48a5e178b0da410e59a",
            "filename": "src/tls_wrap.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Ftls_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/d4024815b7d55005c3ec25c74cf647f7eba1d5cc/src%2Ftls_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftls_wrap.cc?ref=d4024815b7d55005c3ec25c74cf647f7eba1d5cc",
            "patch": "@@ -86,12 +86,7 @@ TLSWrap::TLSWrap(Environment* env,\n TLSWrap::~TLSWrap() {\n   enc_in_ = nullptr;\n   enc_out_ = nullptr;\n-\n   sc_ = nullptr;\n-\n-#ifdef SSL_CTRL_SET_TLSEXT_SERVERNAME_CB\n-  sni_context_.Reset();\n-#endif  // SSL_CTRL_SET_TLSEXT_SERVERNAME_CB\n }\n \n \n@@ -835,7 +830,6 @@ int TLSWrap::SelectSNIContextCallback(SSL* s, int* ad, void* arg) {\n     return SSL_TLSEXT_ERR_NOACK;\n   }\n \n-  p->sni_context_.Reset();\n   p->sni_context_.Reset(env->isolate(), ctx);\n \n   SecureContext* sc = Unwrap<SecureContext>(ctx.As<Object>());"
        }
    ],
    "stats": {
        "total": 103,
        "additions": 2,
        "deletions": 101
    }
}