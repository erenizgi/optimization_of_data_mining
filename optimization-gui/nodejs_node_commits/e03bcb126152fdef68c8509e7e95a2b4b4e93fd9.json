{
    "author": "MylesBorins",
    "message": "test: verify order of error in h2 server stream\n\nCurrently the order of error / closing of an h2 stream is consistent\nin 10.x, 11.x, and master. There appears to be an unexpected behavior\ndifference in 8.x. This test will be used to bisect the commit that will\nfix this behavior change and ensure there are no future regressions.\n\nPR-URL: https://github.com/nodejs/node/pull/24685\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "e03bcb126152fdef68c8509e7e95a2b4b4e93fd9",
    "files": [
        {
            "sha": "8bf0f03dba8ea34310bf5cbe718c2ccac2830b41",
            "filename": "test/parallel/test-http2-error-order.js",
            "status": "added",
            "additions": 43,
            "deletions": 0,
            "changes": 43,
            "blob_url": "https://github.com/nodejs/node/blob/e03bcb126152fdef68c8509e7e95a2b4b4e93fd9/test%2Fparallel%2Ftest-http2-error-order.js",
            "raw_url": "https://github.com/nodejs/node/raw/e03bcb126152fdef68c8509e7e95a2b4b4e93fd9/test%2Fparallel%2Ftest-http2-error-order.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-http2-error-order.js?ref=e03bcb126152fdef68c8509e7e95a2b4b4e93fd9",
            "patch": "@@ -0,0 +1,43 @@\n+'use strict';\n+\n+const common = require('../common');\n+if (!common.hasCrypto)\n+  common.skip('missing crypto');\n+\n+const assert = require('assert');\n+const { createServer, connect } = require('http2');\n+\n+const messages = [];\n+const expected = [\n+  'Stream:created',\n+  'Stream:error',\n+  'Stream:close',\n+  'Request:error'\n+];\n+\n+const server = createServer();\n+\n+server.on('stream', (stream) => {\n+  messages.push('Stream:created');\n+  stream\n+    .on('close', () => messages.push('Stream:close'))\n+    .on('error', (err) => messages.push('Stream:error'))\n+    .respondWithFile('dont exist');\n+});\n+\n+server.listen(0);\n+\n+const client = connect(`http://localhost:${server.address().port}`);\n+const req = client.request();\n+\n+req.on('response', common.mustNotCall());\n+\n+req.on('error', () => {\n+  messages.push('Request:error');\n+  client.close();\n+});\n+\n+client.on('close', common.mustCall(() => {\n+  assert.deepStrictEqual(messages, expected);\n+  server.close();\n+}));"
        }
    ],
    "stats": {
        "total": 43,
        "additions": 43,
        "deletions": 0
    }
}