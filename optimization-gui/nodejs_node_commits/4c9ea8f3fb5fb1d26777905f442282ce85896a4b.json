{
    "author": "cjihrig",
    "message": "tools: update crypo check rule\n\nThis commit updates the custom crypto-check ESLint rule to\ndetect require() calls that come before any hasCrypto\nchecks.\n\nPR-URL: https://github.com/nodejs/node/pull/25399\nRefs: https://github.com/nodejs/node/pull/25388\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>",
    "sha": "4c9ea8f3fb5fb1d26777905f442282ce85896a4b",
    "files": [
        {
            "sha": "1829e86b020313117e63e887a0cf2d4d64541b7d",
            "filename": "test/parallel/test-eslint-crypto-check.js",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/4c9ea8f3fb5fb1d26777905f442282ce85896a4b/test%2Fparallel%2Ftest-eslint-crypto-check.js",
            "raw_url": "https://github.com/nodejs/node/raw/4c9ea8f3fb5fb1d26777905f442282ce85896a4b/test%2Fparallel%2Ftest-eslint-crypto-check.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-eslint-crypto-check.js?ref=4c9ea8f3fb5fb1d26777905f442282ce85896a4b",
            "patch": "@@ -22,6 +22,14 @@ new RuleTester().run('crypto-check', rule, {\n     `\n   ],\n   invalid: [\n+    {\n+      code: 'require(\"common\")\\n' +\n+            'require(\"crypto\")\\n' +\n+            'if (!common.hasCrypto) {\\n' +\n+            '  common.skip(\"missing crypto\");\\n' +\n+            '}',\n+      errors: [{ message }]\n+    },\n     {\n       code: 'require(\"common\")\\n' +\n             'require(\"crypto\")',"
        },
        {
            "sha": "fbc319f964c69660d57c5a02516fb1acfc790b55",
            "filename": "tools/eslint-rules/crypto-check.js",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/nodejs/node/blob/4c9ea8f3fb5fb1d26777905f442282ce85896a4b/tools%2Feslint-rules%2Fcrypto-check.js",
            "raw_url": "https://github.com/nodejs/node/raw/4c9ea8f3fb5fb1d26777905f442282ce85896a4b/tools%2Feslint-rules%2Fcrypto-check.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/tools%2Feslint-rules%2Fcrypto-check.js?ref=4c9ea8f3fb5fb1d26777905f442282ce85896a4b",
            "patch": "@@ -66,6 +66,22 @@ module.exports = function(context) {\n \n   function reportIfMissingCheck() {\n     if (hasSkipCall) {\n+      // There is a skip, which is good, but verify that the require() calls\n+      // in question come after at least one check.\n+      if (missingCheckNodes.length > 0) {\n+        requireNodes.forEach((requireNode) => {\n+          const beforeAllChecks = missingCheckNodes.every((checkNode) => {\n+            return requireNode.start < checkNode.start;\n+          });\n+\n+          if (beforeAllChecks) {\n+            context.report({\n+              node: requireNode,\n+              message: msg\n+            });\n+          }\n+        });\n+      }\n       return;\n     }\n "
        }
    ],
    "stats": {
        "total": 24,
        "additions": 24,
        "deletions": 0
    }
}