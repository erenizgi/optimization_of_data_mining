{
    "author": "danbev",
    "message": "test: add hasCrypto to worker-cleanexit-with-moduleload\n\nCurrently, this test fails when configured --without-ssl:\n\n=== release test-worker-cleanexit-with-moduleload ===\nPath: parallel/test-worker-cleanexit-with-moduleload\nevents.js:173\n      throw er; // Unhandled 'error' event\n      ^\ninternal/util.js:101\n    throw new ERR_NO_CRYPTO();\n    ^\n\nError [ERR_NO_CRYPTO]:\nNode.js is not compiled with OpenSSL crypto support\n\nThis commit as a check for crypto so that this test is skipped if there\nis no crypto support.\n\nPR-URL: https://github.com/nodejs/node/pull/25811\nReviewed-By: Gireesh Punathil <gpunathi@in.ibm.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "d6a32cfe7ca32b8382d195a1dee460d78f749562",
    "files": [
        {
            "sha": "d4316cfe237157a4958ceb7bd713155d326fdbf1",
            "filename": "test/parallel/test-worker-cleanexit-with-moduleload.js",
            "status": "modified",
            "additions": 9,
            "deletions": 4,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/d6a32cfe7ca32b8382d195a1dee460d78f749562/test%2Fparallel%2Ftest-worker-cleanexit-with-moduleload.js",
            "raw_url": "https://github.com/nodejs/node/raw/d6a32cfe7ca32b8382d195a1dee460d78f749562/test%2Fparallel%2Ftest-worker-cleanexit-with-moduleload.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-worker-cleanexit-with-moduleload.js?ref=d6a32cfe7ca32b8382d195a1dee460d78f749562",
            "patch": "@@ -1,5 +1,5 @@\n 'use strict';\n-require('../common');\n+const common = require('../common');\n \n // Harden the thread interactions on the exit path.\n // Ensure workers are able to bail out safe at\n@@ -9,10 +9,15 @@ require('../common');\n // preferrably in the C++ land.\n \n const { Worker } = require('worker_threads');\n+const modules = [ 'fs', 'assert', 'async_hooks', 'buffer', 'child_process',\n+                  'net', 'http', 'os', 'path', 'v8', 'vm'\n+];\n+if (common.hasCrypto) {\n+  modules.push('https');\n+}\n+\n for (let i = 0; i < 10; i++) {\n-  new Worker(\"const modules = ['fs', 'assert', 'async_hooks',\" +\n-    \"'buffer', 'child_process', 'net', 'http', 'https', 'os',\" +\n-    \"'path', 'v8', 'vm'];\" +\n+  new Worker(`const modules = [${modules.map((m) => `'${m}'`)}];` +\n     'modules.forEach((module) => {' +\n     'const m = require(module);' +\n     '});', { eval: true });"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 9,
        "deletions": 4
    }
}