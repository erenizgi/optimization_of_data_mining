{
    "author": "cjihrig",
    "message": "dgram: make process.binding('udp_wrap') internal\n\nPR-URL: https://github.com/nodejs/node/pull/22475\nRefs: https://github.com/nodejs/node/issues/22160\nReviewed-By: Tobias Nießen <tniessen@tnie.de>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Michaël Zasso <targos@protonmail.com>",
    "sha": "c8950cdabc2f8cd0b146797f2045a67974687d5a",
    "files": [
        {
            "sha": "cfaea69abd9cf30bfc848eab88aa7f1f88ae4259",
            "filename": "lib/dgram.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/lib%2Fdgram.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/lib%2Fdgram.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fdgram.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -52,9 +52,10 @@ const {\n   defaultTriggerAsyncIdScope,\n   symbols: { async_id_symbol, owner_symbol }\n } = require('internal/async_hooks');\n+const { internalBinding } = require('internal/bootstrap/loaders');\n const { UV_UDP_REUSEADDR } = process.binding('constants').os;\n \n-const { UDP, SendWrap } = process.binding('udp_wrap');\n+const { UDP, SendWrap } = internalBinding('udp_wrap');\n \n const BIND_STATE_UNBOUND = 0;\n const BIND_STATE_BINDING = 1;"
        },
        {
            "sha": "30b177c5a4557cdb05522c518a817e921d98cdea",
            "filename": "lib/internal/bootstrap/node.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fnode.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -350,6 +350,7 @@\n       new SafeSet([\n         'cares_wrap',\n         'fs_event_wrap',\n+        'udp_wrap',\n         'uv',\n         'pipe_wrap',\n         'http_parser',"
        },
        {
            "sha": "a4850f0238d11989c0c2195995a6afb3d39a38ab",
            "filename": "lib/internal/child_process.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/lib%2Finternal%2Fchild_process.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/lib%2Finternal%2Fchild_process.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fchild_process.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -28,7 +28,7 @@ const { WriteWrap } = internalBinding('stream_wrap');\n const { Pipe, constants: PipeConstants } = internalBinding('pipe_wrap');\n const { TCP } = internalBinding('tcp_wrap');\n const { TTY } = internalBinding('tty_wrap');\n-const { UDP } = process.binding('udp_wrap');\n+const { UDP } = internalBinding('udp_wrap');\n const SocketList = require('internal/socket_list');\n const { owner_symbol } = require('internal/async_hooks').symbols;\n const { convertToValidSignal } = require('internal/util');"
        },
        {
            "sha": "829b11bf68706a72905d086b34f75fc5abc83f29",
            "filename": "lib/internal/dgram.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/lib%2Finternal%2Fdgram.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/lib%2Finternal%2Fdgram.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fdgram.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -1,7 +1,7 @@\n 'use strict';\n const { codes } = require('internal/errors');\n const { internalBinding } = require('internal/bootstrap/loaders');\n-const { UDP } = process.binding('udp_wrap');\n+const { UDP } = internalBinding('udp_wrap');\n const { isInt32 } = require('internal/validators');\n const TTYWrap = internalBinding('tty_wrap');\n const { UV_EINVAL } = internalBinding('uv');"
        },
        {
            "sha": "d23c62c14ecea111d11cc11de704715c3ae02c9f",
            "filename": "src/udp_wrap.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/src%2Fudp_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/src%2Fudp_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fudp_wrap.cc?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -527,4 +527,4 @@ uv_udp_t* UDPWrap::UVHandle() {\n \n }  // namespace node\n \n-NODE_BUILTIN_MODULE_CONTEXT_AWARE(udp_wrap, node::UDPWrap::Initialize)\n+NODE_MODULE_CONTEXT_AWARE_INTERNAL(udp_wrap, node::UDPWrap::Initialize)"
        },
        {
            "sha": "ce026313d0928323d00c747fb001dfb0fd416ed3",
            "filename": "test/parallel/test-accessor-properties.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-accessor-properties.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-accessor-properties.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-accessor-properties.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -12,7 +12,7 @@ const assert = require('assert');\n // their prototype\n const { internalBinding } = require('internal/test/binding');\n const TTY = internalBinding('tty_wrap').TTY;\n-const UDP = process.binding('udp_wrap').UDP;\n+const UDP = internalBinding('udp_wrap').UDP;\n \n {\n   // Should throw instead of raise assertions"
        },
        {
            "sha": "7b6fb89501fae1cf782903cb94b5de425299f8a1",
            "filename": "test/parallel/test-cluster-dgram-bind-fd.js",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-cluster-dgram-bind-fd.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-cluster-dgram-bind-fd.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-cluster-dgram-bind-fd.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -1,3 +1,4 @@\n+// Flags: --expose-internals\n 'use strict';\n const common = require('../common');\n if (common.isWindows)\n@@ -9,7 +10,6 @@ const PACKETS_PER_WORKER = 10;\n const assert = require('assert');\n const cluster = require('cluster');\n const dgram = require('dgram');\n-const { UDP } = process.binding('udp_wrap');\n \n if (cluster.isMaster)\n   master();\n@@ -18,6 +18,9 @@ else\n \n \n function master() {\n+  const { internalBinding } = require('internal/test/binding');\n+  const { UDP } = internalBinding('udp_wrap');\n+\n   // Create a handle and use its fd.\n   const rawHandle = new UDP();\n   const err = rawHandle.bind(common.localhostIPv4, 0, 0);"
        },
        {
            "sha": "8c81cb118c1001a8134c80a6926f13fc23a8e802",
            "filename": "test/parallel/test-dgram-bind-fd.js",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-dgram-bind-fd.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-dgram-bind-fd.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-dgram-bind-fd.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -1,11 +1,13 @@\n+// Flags: --expose-internals\n 'use strict';\n const common = require('../common');\n if (common.isWindows)\n   common.skip('Does not support binding fd on Windows');\n \n const assert = require('assert');\n const dgram = require('dgram');\n-const { UDP } = process.binding('udp_wrap');\n+const { internalBinding } = require('internal/test/binding');\n+const { UDP } = internalBinding('udp_wrap');\n const { UV_UDP_REUSEADDR } = process.binding('constants').os;\n \n const BUFFER_SIZE = 4096;"
        },
        {
            "sha": "93175859c196ea179e3cd9b7a98a949393c01fbf",
            "filename": "test/parallel/test-dgram-create-socket-handle-fd.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-dgram-create-socket-handle-fd.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-dgram-create-socket-handle-fd.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-dgram-create-socket-handle-fd.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -6,8 +6,8 @@ if (common.isWindows)\n \n const assert = require('assert');\n const dgram = require('dgram');\n-const { UDP } = process.binding('udp_wrap');\n const { internalBinding } = require('internal/test/binding');\n+const { UDP } = internalBinding('udp_wrap');\n const { TCP, constants } = internalBinding('tcp_wrap');\n const _createSocketHandle = dgram._createSocketHandle;\n "
        },
        {
            "sha": "6875448474ab8feba94bc0e5182002945f45abc6",
            "filename": "test/parallel/test-dgram-create-socket-handle.js",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-dgram-create-socket-handle.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-dgram-create-socket-handle.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-dgram-create-socket-handle.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -3,7 +3,8 @@\n const common = require('../common');\n const assert = require('assert');\n const { _createSocketHandle } = require('internal/dgram');\n-const UDP = process.binding('udp_wrap').UDP;\n+const { internalBinding } = require('internal/test/binding');\n+const UDP = internalBinding('udp_wrap').UDP;\n \n {\n   // Create a handle that is not bound."
        },
        {
            "sha": "a2e2dabab0ffb2ed8828933cadcea95e3a87a38e",
            "filename": "test/parallel/test-env-newprotomethod-remove-unnecessary-prototypes.js",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-env-newprotomethod-remove-unnecessary-prototypes.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fparallel%2Ftest-env-newprotomethod-remove-unnecessary-prototypes.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-env-newprotomethod-remove-unnecessary-prototypes.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -7,13 +7,12 @@ require('../common');\n \n const assert = require('assert');\n const { internalBinding } = require('internal/test/binding');\n-\n [\n-  process.binding('udp_wrap').UDP.prototype.bind6,\n+  internalBinding('udp_wrap').UDP.prototype.bind6,\n   internalBinding('tcp_wrap').TCP.prototype.bind6,\n-  process.binding('udp_wrap').UDP.prototype.send6,\n+  internalBinding('udp_wrap').UDP.prototype.send6,\n   internalBinding('tcp_wrap').TCP.prototype.bind,\n-  process.binding('udp_wrap').UDP.prototype.close,\n+  internalBinding('udp_wrap').UDP.prototype.close,\n   internalBinding('tcp_wrap').TCP.prototype.open\n ].forEach((binding, i) => {\n   assert.strictEqual('prototype' in binding, false, `Test ${i} failed`);"
        },
        {
            "sha": "a3acda54a1ca9a0c98dc13367768c88a926770ca",
            "filename": "test/sequential/test-async-wrap-getasyncid.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "raw_url": "https://github.com/nodejs/node/raw/c8950cdabc2f8cd0b146797f2045a67974687d5a/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-async-wrap-getasyncid.js?ref=c8950cdabc2f8cd0b146797f2045a67974687d5a",
            "patch": "@@ -272,7 +272,7 @@ if (common.hasCrypto) { // eslint-disable-line node-core/crypto-check\n }\n \n {\n-  const binding = process.binding('udp_wrap');\n+  const binding = internalBinding('udp_wrap');\n   const handle = new binding.UDP();\n   const req = new binding.SendWrap();\n   testInitialized(handle, 'UDP');"
        }
    ],
    "stats": {
        "total": 35,
        "additions": 21,
        "deletions": 14
    }
}