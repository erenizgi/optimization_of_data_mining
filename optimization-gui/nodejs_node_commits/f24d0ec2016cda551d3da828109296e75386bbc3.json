{
    "author": "unknown",
    "message": "n-api: separate out async_hooks test\n\nPlace the test_make_callback async_hooks-related test into its own file.\n\nPR-URL: https://github.com/nodejs/node/pull/19392\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Michael Dawson <michael_dawson@ca.ibm.com>",
    "sha": "f24d0ec2016cda551d3da828109296e75386bbc3",
    "files": [
        {
            "sha": "755a2389c6859147dcbb604a475ffd25b9f70e15",
            "filename": "test/addons-napi/test_make_callback/test-async-hooks.js",
            "status": "added",
            "additions": 44,
            "deletions": 0,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/f24d0ec2016cda551d3da828109296e75386bbc3/test%2Faddons-napi%2Ftest_make_callback%2Ftest-async-hooks.js",
            "raw_url": "https://github.com/nodejs/node/raw/f24d0ec2016cda551d3da828109296e75386bbc3/test%2Faddons-napi%2Ftest_make_callback%2Ftest-async-hooks.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Faddons-napi%2Ftest_make_callback%2Ftest-async-hooks.js?ref=f24d0ec2016cda551d3da828109296e75386bbc3",
            "patch": "@@ -0,0 +1,44 @@\n+'use strict';\n+\n+const common = require('../../common');\n+const assert = require('assert');\n+const async_hooks = require('async_hooks');\n+const binding = require(`./build/${common.buildType}/binding`);\n+const makeCallback = binding.makeCallback;\n+\n+// Check async hooks integration using async context.\n+const hook_result = {\n+  id: null,\n+  init_called: false,\n+  before_called: false,\n+  after_called: false,\n+  destroy_called: false,\n+};\n+const test_hook = async_hooks.createHook({\n+  init: (id, type) => {\n+    if (type === 'test') {\n+      hook_result.id = id;\n+      hook_result.init_called = true;\n+    }\n+  },\n+  before: (id) => {\n+    if (id === hook_result.id) hook_result.before_called = true;\n+  },\n+  after: (id) => {\n+    if (id === hook_result.id) hook_result.after_called = true;\n+  },\n+  destroy: (id) => {\n+    if (id === hook_result.id) hook_result.destroy_called = true;\n+  },\n+});\n+\n+test_hook.enable();\n+makeCallback(process, function() {});\n+\n+assert.strictEqual(hook_result.init_called, true);\n+assert.strictEqual(hook_result.before_called, true);\n+assert.strictEqual(hook_result.after_called, true);\n+setImmediate(() => {\n+  assert.strictEqual(hook_result.destroy_called, true);\n+  test_hook.disable();\n+});"
        },
        {
            "sha": "56e2b3f4e2b6c65566c1f0d4bdecefd9622ba1e1",
            "filename": "test/addons-napi/test_make_callback/test.js",
            "status": "modified",
            "additions": 0,
            "deletions": 38,
            "changes": 38,
            "blob_url": "https://github.com/nodejs/node/blob/f24d0ec2016cda551d3da828109296e75386bbc3/test%2Faddons-napi%2Ftest_make_callback%2Ftest.js",
            "raw_url": "https://github.com/nodejs/node/raw/f24d0ec2016cda551d3da828109296e75386bbc3/test%2Faddons-napi%2Ftest_make_callback%2Ftest.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Faddons-napi%2Ftest_make_callback%2Ftest.js?ref=f24d0ec2016cda551d3da828109296e75386bbc3",
            "patch": "@@ -2,7 +2,6 @@\n \n const common = require('../../common');\n const assert = require('assert');\n-const async_hooks = require('async_hooks');\n const vm = require('vm');\n const binding = require(`./build/${common.buildType}/binding`);\n const makeCallback = binding.makeCallback;\n@@ -81,40 +80,3 @@ function endpoint($Object) {\n }\n \n assert.strictEqual(Object, makeCallback(process, forward, endpoint));\n-\n-// Check async hooks integration using async context.\n-const hook_result = {\n-  id: null,\n-  init_called: false,\n-  before_called: false,\n-  after_called: false,\n-  destroy_called: false,\n-};\n-const test_hook = async_hooks.createHook({\n-  init: (id, type) => {\n-    if (type === 'test') {\n-      hook_result.id = id;\n-      hook_result.init_called = true;\n-    }\n-  },\n-  before: (id) => {\n-    if (id === hook_result.id) hook_result.before_called = true;\n-  },\n-  after: (id) => {\n-    if (id === hook_result.id) hook_result.after_called = true;\n-  },\n-  destroy: (id) => {\n-    if (id === hook_result.id) hook_result.destroy_called = true;\n-  },\n-});\n-\n-test_hook.enable();\n-makeCallback(process, function() {});\n-\n-assert.strictEqual(hook_result.init_called, true);\n-assert.strictEqual(hook_result.before_called, true);\n-assert.strictEqual(hook_result.after_called, true);\n-setImmediate(() => {\n-  assert.strictEqual(hook_result.destroy_called, true);\n-  test_hook.disable();\n-});"
        }
    ],
    "stats": {
        "total": 82,
        "additions": 44,
        "deletions": 38
    }
}