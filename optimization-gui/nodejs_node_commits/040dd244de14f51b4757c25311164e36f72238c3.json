{
    "author": "MylesBorins",
    "message": "deps: patch V8 to 6.5.254.38\n\nPR-URL: https://github.com/nodejs/node/pull/19303\nRefs: https://github.com/v8/v8/compare/6.5.254.31...6.5.254.38\nReviewed-By: Michaël Zasso <targos@protonmail.com>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "040dd244de14f51b4757c25311164e36f72238c3",
    "files": [
        {
            "sha": "dfd3eef878c09774328ccba632c32105fe329eef",
            "filename": "deps/v8/AUTHORS",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2FAUTHORS",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2FAUTHORS",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2FAUTHORS?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -136,7 +136,6 @@ Sanjoy Das <sanjoy@playingwithpointers.com>\n Seo Sanghyeon <sanxiyn@gmail.com>\n Stefan Penner <stefan.penner@gmail.com>\n Sylvestre Ledru <sledru@mozilla.com>\n-Taketoshi Aono <brn@b6n.ch>\n Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\n Tobias Burnus <burnus@net-b.de>\n Victor Costan <costan@gmail.com>"
        },
        {
            "sha": "ee6ccec7cec19546487d8ca610b264b71409e385",
            "filename": "deps/v8/include/v8-version.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Finclude%2Fv8-version.h",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Finclude%2Fv8-version.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Finclude%2Fv8-version.h?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -11,7 +11,7 @@\n #define V8_MAJOR_VERSION 6\n #define V8_MINOR_VERSION 5\n #define V8_BUILD_NUMBER 254\n-#define V8_PATCH_LEVEL 31\n+#define V8_PATCH_LEVEL 38\n \n // Use 1 for candidates and 0 otherwise.\n // (Boolean macro values are not supported by all preprocessors.)"
        },
        {
            "sha": "2bc833fe2962765247a9aafe556b4f1fae8e5719",
            "filename": "deps/v8/src/bootstrapper.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fbootstrapper.cc",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fbootstrapper.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fbootstrapper.cc?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -1508,9 +1508,9 @@ void Genesis::InitializeGlobal(Handle<JSGlobalObject> global_object,\n         object_function, \"keys\", Builtins::kObjectKeys, 1, true);\n     native_context()->set_object_keys(*object_keys);\n     SimpleInstallFunction(object_function, factory->entries_string(),\n-                          Builtins::kObjectEntries, 1, true);\n+                          Builtins::kObjectEntries, 1, false);\n     SimpleInstallFunction(object_function, factory->values_string(),\n-                          Builtins::kObjectValues, 1, true);\n+                          Builtins::kObjectValues, 1, false);\n \n     SimpleInstallFunction(isolate->initial_object_prototype(),\n                           \"__defineGetter__\", Builtins::kObjectDefineGetter, 2,"
        },
        {
            "sha": "a4a0bb9e2cb1921d60d0d58b986cd3827233b13a",
            "filename": "deps/v8/src/builtins/builtins-definitions.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-definitions.h",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-definitions.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-definitions.h?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -755,7 +755,7 @@ namespace internal {\n   CPP(ObjectDefineProperties)                                                  \\\n   CPP(ObjectDefineProperty)                                                    \\\n   CPP(ObjectDefineSetter)                                                      \\\n-  TFJ(ObjectEntries, 1, kObject)                                               \\\n+  CPP(ObjectEntries)                                                           \\\n   CPP(ObjectFreeze)                                                            \\\n   TFJ(ObjectGetOwnPropertyDescriptor,                                          \\\n       SharedFunctionInfo::kDontAdaptArgumentsSentinel)                         \\\n@@ -785,7 +785,7 @@ namespace internal {\n   /* ES #sec-object.prototype.tolocalestring */                                \\\n   TFJ(ObjectPrototypeToLocaleString, 0)                                        \\\n   CPP(ObjectSeal)                                                              \\\n-  TFJ(ObjectValues, 1, kObject)                                                \\\n+  CPP(ObjectValues)                                                            \\\n                                                                                \\\n   /* instanceof */                                                             \\\n   TFC(OrdinaryHasInstance, Compare, 1)                                         \\"
        },
        {
            "sha": "4cd012e6f01b20b1234f91ef2b93d5b9472802cc",
            "filename": "deps/v8/src/builtins/builtins-object-gen.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 301,
            "changes": 301,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-object-gen.cc",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-object-gen.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-object-gen.cc?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -16,8 +16,6 @@ namespace internal {\n // ES6 section 19.1 Object Objects\n \n typedef compiler::Node Node;\n-template <class T>\n-using TNode = CodeStubAssembler::TNode<T>;\n \n class ObjectBuiltinsAssembler : public CodeStubAssembler {\n  public:\n@@ -36,46 +34,6 @@ class ObjectBuiltinsAssembler : public CodeStubAssembler {\n   Node* ConstructDataDescriptor(Node* context, Node* value, Node* writable,\n                                 Node* enumerable, Node* configurable);\n   Node* GetAccessorOrUndefined(Node* accessor, Label* if_bailout);\n-\n-  Node* IsSpecialReceiverMap(SloppyTNode<Map> map);\n-};\n-\n-class ObjectEntriesValuesBuiltinsAssembler : public ObjectBuiltinsAssembler {\n- public:\n-  explicit ObjectEntriesValuesBuiltinsAssembler(\n-      compiler::CodeAssemblerState* state)\n-      : ObjectBuiltinsAssembler(state) {}\n-\n- protected:\n-  enum CollectType { kEntries, kValues };\n-\n-  TNode<Word32T> IsStringWrapperElementsKind(TNode<Map> map);\n-\n-  TNode<BoolT> IsPropertyEnumerable(TNode<Uint32T> details);\n-\n-  TNode<BoolT> IsPropertyKindAccessor(TNode<Uint32T> kind);\n-\n-  TNode<BoolT> IsPropertyKindData(TNode<Uint32T> kind);\n-\n-  TNode<Uint32T> HasHiddenPrototype(TNode<Map> map);\n-\n-  TNode<Uint32T> LoadPropertyKind(TNode<Uint32T> details) {\n-    return DecodeWord32<PropertyDetails::KindField>(details);\n-  }\n-\n-  void GetOwnValuesOrEntries(TNode<Context> context, TNode<Object> maybe_object,\n-                             CollectType collect_type);\n-\n-  void GotoIfMapHasSlowProperties(TNode<Map> map, Label* if_slow);\n-\n-  TNode<JSArray> FastGetOwnValuesOrEntries(\n-      TNode<Context> context, TNode<JSObject> object,\n-      Label* if_call_runtime_with_fast_path, Label* if_no_properties,\n-      CollectType collect_type);\n-\n-  TNode<JSArray> FinalizeValuesOrEntriesJSArray(\n-      TNode<Context> context, TNode<FixedArray> values_or_entries,\n-      TNode<IntPtrT> size, TNode<Map> array_map, Label* if_empty);\n };\n \n void ObjectBuiltinsAssembler::ReturnToStringFormat(Node* context,\n@@ -139,249 +97,6 @@ Node* ObjectBuiltinsAssembler::ConstructDataDescriptor(Node* context,\n   return js_desc;\n }\n \n-Node* ObjectBuiltinsAssembler::IsSpecialReceiverMap(SloppyTNode<Map> map) {\n-  CSA_SLOW_ASSERT(this, IsMap(map));\n-  Node* is_special = IsSpecialReceiverInstanceType(LoadMapInstanceType(map));\n-  uint32_t mask =\n-      Map::HasNamedInterceptorBit::kMask | Map::IsAccessCheckNeededBit::kMask;\n-  USE(mask);\n-  // Interceptors or access checks imply special receiver.\n-  CSA_ASSERT(this,\n-             SelectConstant(IsSetWord32(LoadMapBitField(map), mask), is_special,\n-                            Int32Constant(1), MachineRepresentation::kWord32));\n-  return is_special;\n-}\n-\n-TNode<Word32T>\n-ObjectEntriesValuesBuiltinsAssembler::IsStringWrapperElementsKind(\n-    TNode<Map> map) {\n-  Node* kind = LoadMapElementsKind(map);\n-  return Word32Or(\n-      Word32Equal(kind, Int32Constant(FAST_STRING_WRAPPER_ELEMENTS)),\n-      Word32Equal(kind, Int32Constant(SLOW_STRING_WRAPPER_ELEMENTS)));\n-}\n-\n-TNode<BoolT> ObjectEntriesValuesBuiltinsAssembler::IsPropertyEnumerable(\n-    TNode<Uint32T> details) {\n-  TNode<Uint32T> attributes =\n-      DecodeWord32<PropertyDetails::AttributesField>(details);\n-  return IsNotSetWord32(attributes, PropertyAttributes::DONT_ENUM);\n-}\n-\n-TNode<BoolT> ObjectEntriesValuesBuiltinsAssembler::IsPropertyKindAccessor(\n-    TNode<Uint32T> kind) {\n-  return Word32Equal(kind, Int32Constant(PropertyKind::kAccessor));\n-}\n-\n-TNode<BoolT> ObjectEntriesValuesBuiltinsAssembler::IsPropertyKindData(\n-    TNode<Uint32T> kind) {\n-  return Word32Equal(kind, Int32Constant(PropertyKind::kData));\n-}\n-\n-TNode<Uint32T> ObjectEntriesValuesBuiltinsAssembler::HasHiddenPrototype(\n-    TNode<Map> map) {\n-  TNode<Uint32T> bit_field3 = LoadMapBitField3(map);\n-  return DecodeWord32<Map::HasHiddenPrototypeBit>(bit_field3);\n-}\n-\n-void ObjectEntriesValuesBuiltinsAssembler::GetOwnValuesOrEntries(\n-    TNode<Context> context, TNode<Object> maybe_object,\n-    CollectType collect_type) {\n-  TNode<JSObject> object = TNode<JSObject>::UncheckedCast(\n-      CallBuiltin(Builtins::kToObject, context, maybe_object));\n-\n-  Label if_call_runtime_with_fast_path(this, Label::kDeferred),\n-      if_call_runtime(this, Label::kDeferred),\n-      if_no_properties(this, Label::kDeferred);\n-\n-  TNode<Map> map = LoadMap(object);\n-  GotoIfNot(IsJSObjectMap(map), &if_call_runtime);\n-  GotoIfMapHasSlowProperties(map, &if_call_runtime);\n-\n-  TNode<FixedArrayBase> elements = LoadElements(object);\n-  // If the object has elements, we treat it as slow case.\n-  // So, we go to runtime call.\n-  GotoIfNot(IsEmptyFixedArray(elements), &if_call_runtime_with_fast_path);\n-\n-  TNode<JSArray> result = FastGetOwnValuesOrEntries(\n-      context, object, &if_call_runtime_with_fast_path, &if_no_properties,\n-      collect_type);\n-  Return(result);\n-\n-  BIND(&if_no_properties);\n-  {\n-    Node* native_context = LoadNativeContext(context);\n-    Node* array_map = LoadJSArrayElementsMap(PACKED_ELEMENTS, native_context);\n-    Node* empty_array = AllocateJSArray(PACKED_ELEMENTS, array_map,\n-                                        IntPtrConstant(0), SmiConstant(0));\n-    Return(empty_array);\n-  }\n-\n-  BIND(&if_call_runtime_with_fast_path);\n-  {\n-    // In slow case, we simply call runtime.\n-    if (collect_type == CollectType::kEntries) {\n-      Return(CallRuntime(Runtime::kObjectEntries, context, object));\n-    } else {\n-      DCHECK(collect_type == CollectType::kValues);\n-      Return(CallRuntime(Runtime::kObjectValues, context, object));\n-    }\n-  }\n-\n-  BIND(&if_call_runtime);\n-  {\n-    // In slow case, we simply call runtime.\n-    if (collect_type == CollectType::kEntries) {\n-      Return(CallRuntime(Runtime::kObjectEntriesSkipFastPath, context, object));\n-    } else {\n-      DCHECK(collect_type == CollectType::kValues);\n-      Return(CallRuntime(Runtime::kObjectValuesSkipFastPath, context, object));\n-    }\n-  }\n-}\n-\n-void ObjectEntriesValuesBuiltinsAssembler::GotoIfMapHasSlowProperties(\n-    TNode<Map> map, Label* if_slow) {\n-  GotoIf(IsStringWrapperElementsKind(map), if_slow);\n-  GotoIf(IsSpecialReceiverMap(map), if_slow);\n-  GotoIf(HasHiddenPrototype(map), if_slow);\n-  GotoIf(IsDictionaryMap(map), if_slow);\n-}\n-\n-TNode<JSArray> ObjectEntriesValuesBuiltinsAssembler::FastGetOwnValuesOrEntries(\n-    TNode<Context> context, TNode<JSObject> object,\n-    Label* if_call_runtime_with_fast_path, Label* if_no_properties,\n-    CollectType collect_type) {\n-  Node* native_context = LoadNativeContext(context);\n-  TNode<Map> array_map =\n-      LoadJSArrayElementsMap(PACKED_ELEMENTS, native_context);\n-  TNode<Map> map = LoadMap(object);\n-  TNode<Uint32T> bit_field3 = LoadMapBitField3(map);\n-\n-  Label if_has_enum_cache(this), if_not_has_enum_cache(this),\n-      collect_entries(this);\n-  Node* object_enum_length =\n-      DecodeWordFromWord32<Map::EnumLengthBits>(bit_field3);\n-  Node* has_enum_cache = WordNotEqual(\n-      object_enum_length, IntPtrConstant(kInvalidEnumCacheSentinel));\n-\n-  // In case, we found enum_cache in object,\n-  // we use it as array_length becuase it has same size for\n-  // Object.(entries/values) result array object length.\n-  // So object_enum_length use less memory space than\n-  // NumberOfOwnDescriptorsBits value.\n-  // And in case, if enum_cache_not_found,\n-  // we call runtime and initialize enum_cache for subsequent call of\n-  // CSA fast path.\n-  Branch(has_enum_cache, &if_has_enum_cache, if_call_runtime_with_fast_path);\n-\n-  BIND(&if_has_enum_cache);\n-  {\n-    GotoIf(WordEqual(object_enum_length, IntPtrConstant(0)), if_no_properties);\n-    TNode<FixedArray> values_or_entries = TNode<FixedArray>::UncheckedCast(\n-        AllocateFixedArray(PACKED_ELEMENTS, object_enum_length,\n-                           INTPTR_PARAMETERS, kAllowLargeObjectAllocation));\n-\n-    // If in case we have enum_cache,\n-    // we can't detect accessor of object until loop through descritpros.\n-    // So if object might have accessor,\n-    // we will remain invalid addresses of FixedArray.\n-    // Because in that case, we need to jump to runtime call.\n-    // So the array filled by the-hole even if enum_cache exists.\n-    FillFixedArrayWithValue(PACKED_ELEMENTS, values_or_entries,\n-                            IntPtrConstant(0), object_enum_length,\n-                            Heap::kTheHoleValueRootIndex);\n-\n-    TVARIABLE(IntPtrT, var_result_index, IntPtrConstant(0));\n-    TVARIABLE(IntPtrT, var_descriptor_index, IntPtrConstant(0));\n-    Variable* vars[] = {&var_descriptor_index, &var_result_index};\n-    // Let desc be ? O.[[GetOwnProperty]](key).\n-    TNode<DescriptorArray> descriptors = LoadMapDescriptors(map);\n-    Label loop(this, 2, vars), after_loop(this), loop_condition(this);\n-    Branch(IntPtrEqual(var_descriptor_index, object_enum_length), &after_loop,\n-           &loop);\n-\n-    // We dont use BuildFastLoop.\n-    // Instead, we use hand-written loop\n-    // because of we need to use 'continue' functionality.\n-    BIND(&loop);\n-    {\n-      // Currently, we will not invoke getters,\n-      // so, map will not be changed.\n-      CSA_ASSERT(this, WordEqual(map, LoadMap(object)));\n-      TNode<Uint32T> descriptor_index = TNode<Uint32T>::UncheckedCast(\n-          TruncateWordToWord32(var_descriptor_index));\n-      Node* next_key = DescriptorArrayGetKey(descriptors, descriptor_index);\n-\n-      // Skip Symbols.\n-      GotoIf(IsSymbol(next_key), &loop_condition);\n-\n-      TNode<Uint32T> details = TNode<Uint32T>::UncheckedCast(\n-          DescriptorArrayGetDetails(descriptors, descriptor_index));\n-      TNode<Uint32T> kind = LoadPropertyKind(details);\n-\n-      // If property is accessor, we escape fast path and call runtime.\n-      GotoIf(IsPropertyKindAccessor(kind), if_call_runtime_with_fast_path);\n-      CSA_ASSERT(this, IsPropertyKindData(kind));\n-\n-      // If desc is not undefined and desc.[[Enumerable]] is true, then\n-      GotoIfNot(IsPropertyEnumerable(details), &loop_condition);\n-\n-      VARIABLE(var_property_value, MachineRepresentation::kTagged,\n-               UndefinedConstant());\n-      Node* descriptor_name_index = DescriptorNumberToIndex(descriptor_index);\n-\n-      // Let value be ? Get(O, key).\n-      LoadPropertyFromFastObject(object, map, descriptors,\n-                                 descriptor_name_index, details,\n-                                 &var_property_value);\n-\n-      // If kind is \"value\", append value to properties.\n-      Node* value = var_property_value.value();\n-\n-      if (collect_type == CollectType::kEntries) {\n-        // Let entry be CreateArrayFromList(« key, value »).\n-        Node* array = nullptr;\n-        Node* elements = nullptr;\n-        std::tie(array, elements) = AllocateUninitializedJSArrayWithElements(\n-            PACKED_ELEMENTS, array_map, SmiConstant(2), nullptr,\n-            IntPtrConstant(2));\n-        StoreFixedArrayElement(elements, 0, next_key, SKIP_WRITE_BARRIER);\n-        StoreFixedArrayElement(elements, 1, value, SKIP_WRITE_BARRIER);\n-        value = array;\n-      }\n-\n-      StoreFixedArrayElement(values_or_entries, var_result_index, value);\n-      Increment(&var_result_index, 1);\n-      Goto(&loop_condition);\n-\n-      BIND(&loop_condition);\n-      {\n-        Increment(&var_descriptor_index, 1);\n-        Branch(IntPtrEqual(var_descriptor_index, object_enum_length),\n-               &after_loop, &loop);\n-      }\n-    }\n-    BIND(&after_loop);\n-    return FinalizeValuesOrEntriesJSArray(context, values_or_entries,\n-                                          var_result_index, array_map,\n-                                          if_no_properties);\n-  }\n-}\n-\n-TNode<JSArray>\n-ObjectEntriesValuesBuiltinsAssembler::FinalizeValuesOrEntriesJSArray(\n-    TNode<Context> context, TNode<FixedArray> result, TNode<IntPtrT> size,\n-    TNode<Map> array_map, Label* if_empty) {\n-  CSA_ASSERT(this, IsJSArrayMap(array_map));\n-\n-  GotoIf(IntPtrEqual(size, IntPtrConstant(0)), if_empty);\n-  Node* array = AllocateUninitializedJSArrayWithoutElements(\n-      array_map, SmiTag(size), nullptr);\n-  StoreObjectField(array, JSArray::kElementsOffset, result);\n-  return TNode<JSArray>::UncheckedCast(array);\n-}\n-\n TF_BUILTIN(ObjectPrototypeToLocaleString, CodeStubAssembler) {\n   TNode<Context> context = CAST(Parameter(Descriptor::kContext));\n   TNode<Object> receiver = CAST(Parameter(Descriptor::kReceiver));\n@@ -551,22 +266,6 @@ TF_BUILTIN(ObjectKeys, ObjectBuiltinsAssembler) {\n   }\n }\n \n-TF_BUILTIN(ObjectValues, ObjectEntriesValuesBuiltinsAssembler) {\n-  TNode<JSObject> object =\n-      TNode<JSObject>::UncheckedCast(Parameter(Descriptor::kObject));\n-  TNode<Context> context =\n-      TNode<Context>::UncheckedCast(Parameter(Descriptor::kContext));\n-  GetOwnValuesOrEntries(context, object, CollectType::kValues);\n-}\n-\n-TF_BUILTIN(ObjectEntries, ObjectEntriesValuesBuiltinsAssembler) {\n-  TNode<JSObject> object =\n-      TNode<JSObject>::UncheckedCast(Parameter(Descriptor::kObject));\n-  TNode<Context> context =\n-      TNode<Context>::UncheckedCast(Parameter(Descriptor::kContext));\n-  GetOwnValuesOrEntries(context, object, CollectType::kEntries);\n-}\n-\n // ES #sec-object.prototype.isprototypeof\n TF_BUILTIN(ObjectPrototypeIsPrototypeOf, ObjectBuiltinsAssembler) {\n   Node* receiver = Parameter(Descriptor::kReceiver);"
        },
        {
            "sha": "36f7ebfc0a87cb44d39ed8fbb5c9d385abe84692",
            "filename": "deps/v8/src/builtins/builtins-object.cc",
            "status": "modified",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-object.cc",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-object.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fbuiltins%2Fbuiltins-object.cc?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -395,6 +395,31 @@ BUILTIN(ObjectIsSealed) {\n   return isolate->heap()->ToBoolean(result.FromJust());\n }\n \n+BUILTIN(ObjectValues) {\n+  HandleScope scope(isolate);\n+  Handle<Object> object = args.atOrUndefined(isolate, 1);\n+  Handle<JSReceiver> receiver;\n+  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(isolate, receiver,\n+                                     Object::ToObject(isolate, object));\n+  Handle<FixedArray> values;\n+  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(\n+      isolate, values, JSReceiver::GetOwnValues(receiver, ENUMERABLE_STRINGS));\n+  return *isolate->factory()->NewJSArrayWithElements(values);\n+}\n+\n+BUILTIN(ObjectEntries) {\n+  HandleScope scope(isolate);\n+  Handle<Object> object = args.atOrUndefined(isolate, 1);\n+  Handle<JSReceiver> receiver;\n+  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(isolate, receiver,\n+                                     Object::ToObject(isolate, object));\n+  Handle<FixedArray> entries;\n+  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(\n+      isolate, entries,\n+      JSReceiver::GetOwnEntries(receiver, ENUMERABLE_STRINGS));\n+  return *isolate->factory()->NewJSArrayWithElements(entries);\n+}\n+\n BUILTIN(ObjectGetOwnPropertyDescriptors) {\n   HandleScope scope(isolate);\n   Handle<Object> object = args.atOrUndefined(isolate, 1);"
        },
        {
            "sha": "2027d208abc1d88999db0a1aef1c3bf62e8d0342",
            "filename": "deps/v8/src/code-stub-assembler.cc",
            "status": "modified",
            "additions": 30,
            "deletions": 29,
            "changes": 59,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.cc",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.cc?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -4019,6 +4019,19 @@ Node* CodeStubAssembler::InstanceTypeEqual(Node* instance_type, int type) {\n   return Word32Equal(instance_type, Int32Constant(type));\n }\n \n+Node* CodeStubAssembler::IsSpecialReceiverMap(Node* map) {\n+  CSA_SLOW_ASSERT(this, IsMap(map));\n+  Node* is_special = IsSpecialReceiverInstanceType(LoadMapInstanceType(map));\n+  uint32_t mask =\n+      Map::HasNamedInterceptorBit::kMask | Map::IsAccessCheckNeededBit::kMask;\n+  USE(mask);\n+  // Interceptors or access checks imply special receiver.\n+  CSA_ASSERT(this,\n+             SelectConstant(IsSetWord32(LoadMapBitField(map), mask), is_special,\n+                            Int32Constant(1), MachineRepresentation::kWord32));\n+  return is_special;\n+}\n+\n TNode<BoolT> CodeStubAssembler::IsDictionaryMap(SloppyTNode<Map> map) {\n   CSA_SLOW_ASSERT(this, IsMap(map));\n   Node* bit_field3 = LoadMapBitField3(map);\n@@ -6369,38 +6382,36 @@ Node* CodeStubAssembler::DescriptorArrayNumberOfEntries(Node* descriptors) {\n       descriptors, IntPtrConstant(DescriptorArray::kDescriptorLengthIndex));\n }\n \n-Node* CodeStubAssembler::DescriptorNumberToIndex(\n-    SloppyTNode<Uint32T> descriptor_number) {\n-  Node* descriptor_size = Int32Constant(DescriptorArray::kEntrySize);\n-  Node* index = Int32Mul(descriptor_number, descriptor_size);\n-  return ChangeInt32ToIntPtr(index);\n+namespace {\n+\n+Node* DescriptorNumberToIndex(CodeStubAssembler* a, Node* descriptor_number) {\n+  Node* descriptor_size = a->Int32Constant(DescriptorArray::kEntrySize);\n+  Node* index = a->Int32Mul(descriptor_number, descriptor_size);\n+  return a->ChangeInt32ToIntPtr(index);\n }\n \n+}  // namespace\n+\n Node* CodeStubAssembler::DescriptorArrayToKeyIndex(Node* descriptor_number) {\n   return IntPtrAdd(IntPtrConstant(DescriptorArray::ToKeyIndex(0)),\n-                   DescriptorNumberToIndex(descriptor_number));\n+                   DescriptorNumberToIndex(this, descriptor_number));\n }\n \n Node* CodeStubAssembler::DescriptorArrayGetSortedKeyIndex(\n     Node* descriptors, Node* descriptor_number) {\n-  Node* details = DescriptorArrayGetDetails(\n-      TNode<DescriptorArray>::UncheckedCast(descriptors),\n-      TNode<Uint32T>::UncheckedCast(descriptor_number));\n+  const int details_offset = DescriptorArray::ToDetailsIndex(0) * kPointerSize;\n+  Node* details = LoadAndUntagToWord32FixedArrayElement(\n+      descriptors, DescriptorNumberToIndex(this, descriptor_number),\n+      details_offset);\n   return DecodeWord32<PropertyDetails::DescriptorPointer>(details);\n }\n \n Node* CodeStubAssembler::DescriptorArrayGetKey(Node* descriptors,\n                                                Node* descriptor_number) {\n   const int key_offset = DescriptorArray::ToKeyIndex(0) * kPointerSize;\n-  return LoadFixedArrayElement(\n-      descriptors, DescriptorNumberToIndex(descriptor_number), key_offset);\n-}\n-\n-TNode<Uint32T> CodeStubAssembler::DescriptorArrayGetDetails(\n-    TNode<DescriptorArray> descriptors, TNode<Uint32T> descriptor_number) {\n-  const int details_offset = DescriptorArray::ToDetailsIndex(0) * kPointerSize;\n-  return TNode<Uint32T>::UncheckedCast(LoadAndUntagToWord32FixedArrayElement(\n-      descriptors, DescriptorNumberToIndex(descriptor_number), details_offset));\n+  return LoadFixedArrayElement(descriptors,\n+                               DescriptorNumberToIndex(this, descriptor_number),\n+                               key_offset);\n }\n \n void CodeStubAssembler::DescriptorLookupBinary(Node* unique_name,\n@@ -6599,22 +6610,12 @@ void CodeStubAssembler::LoadPropertyFromFastObject(Node* object, Node* map,\n                                                    Variable* var_value) {\n   DCHECK_EQ(MachineRepresentation::kWord32, var_details->rep());\n   DCHECK_EQ(MachineRepresentation::kTagged, var_value->rep());\n+  Comment(\"[ LoadPropertyFromFastObject\");\n \n   Node* details =\n       LoadDetailsByKeyIndex<DescriptorArray>(descriptors, name_index);\n   var_details->Bind(details);\n \n-  LoadPropertyFromFastObject(object, map, descriptors, name_index, details,\n-                             var_value);\n-}\n-\n-void CodeStubAssembler::LoadPropertyFromFastObject(Node* object, Node* map,\n-                                                   Node* descriptors,\n-                                                   Node* name_index,\n-                                                   Node* details,\n-                                                   Variable* var_value) {\n-  Comment(\"[ LoadPropertyFromFastObject\");\n-\n   Node* location = DecodeWord32<PropertyDetails::LocationField>(details);\n \n   Label if_in_field(this), if_in_descriptor(this), done(this);"
        },
        {
            "sha": "0dd7a35c4a057ad72a02fef5a782fc27eb331f8c",
            "filename": "deps/v8/src/code-stub-assembler.h",
            "status": "modified",
            "additions": 1,
            "deletions": 8,
            "changes": 9,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.h",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fcode-stub-assembler.h?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -1125,6 +1125,7 @@ class V8_EXPORT_PRIVATE CodeStubAssembler : public compiler::CodeAssembler {\n   Node* IsSequentialStringInstanceType(Node* instance_type);\n   Node* IsShortExternalStringInstanceType(Node* instance_type);\n   Node* IsSpecialReceiverInstanceType(Node* instance_type);\n+  Node* IsSpecialReceiverMap(Node* map);\n   Node* IsSpeciesProtectorCellInvalid();\n   Node* IsStringInstanceType(Node* instance_type);\n   Node* IsString(Node* object);\n@@ -1583,10 +1584,6 @@ class V8_EXPORT_PRIVATE CodeStubAssembler : public compiler::CodeAssembler {\n                                   Node* name_index, Variable* var_details,\n                                   Variable* var_value);\n \n-  void LoadPropertyFromFastObject(Node* object, Node* map, Node* descriptors,\n-                                  Node* name_index, Node* details,\n-                                  Variable* var_value);\n-\n   void LoadPropertyFromNameDictionary(Node* dictionary, Node* entry,\n                                       Variable* var_details,\n                                       Variable* var_value);\n@@ -1909,15 +1906,11 @@ class V8_EXPORT_PRIVATE CodeStubAssembler : public compiler::CodeAssembler {\n   void DescriptorLookupBinary(Node* unique_name, Node* descriptors, Node* nof,\n                               Label* if_found, Variable* var_name_index,\n                               Label* if_not_found);\n-  Node* DescriptorNumberToIndex(SloppyTNode<Uint32T> descriptor_number);\n   // Implements DescriptorArray::ToKeyIndex.\n   // Returns an untagged IntPtr.\n   Node* DescriptorArrayToKeyIndex(Node* descriptor_number);\n   // Implements DescriptorArray::GetKey.\n   Node* DescriptorArrayGetKey(Node* descriptors, Node* descriptor_number);\n-  // Implements DescriptorArray::GetKey.\n-  TNode<Uint32T> DescriptorArrayGetDetails(TNode<DescriptorArray> descriptors,\n-                                           TNode<Uint32T> descriptor_number);\n \n   Node* CallGetterIfAccessor(Node* value, Node* details, Node* context,\n                              Node* receiver, Label* if_bailout,"
        },
        {
            "sha": "e5865e639c3028a7d9693821e8163c6225c79d38",
            "filename": "deps/v8/src/debug/debug-evaluate.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fdebug%2Fdebug-evaluate.cc",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fdebug%2Fdebug-evaluate.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fdebug%2Fdebug-evaluate.cc?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -343,11 +343,7 @@ bool IntrinsicHasNoSideEffect(Runtime::FunctionId id) {\n   V(AllocateSeqOneByteString)            \\\n   V(AllocateSeqTwoByteString)            \\\n   V(ObjectCreate)                        \\\n-  V(ObjectEntries)                       \\\n-  V(ObjectEntriesSkipFastPath)           \\\n   V(ObjectHasOwnProperty)                \\\n-  V(ObjectValues)                        \\\n-  V(ObjectValuesSkipFastPath)            \\\n   V(ArrayIndexOf)                        \\\n   V(ArrayIncludes_Slow)                  \\\n   V(ArrayIsArray)                        \\"
        },
        {
            "sha": "9e390e3d4658e457e2f473bbd426f3f506e8033e",
            "filename": "deps/v8/src/field-index.h",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Ffield-index.h",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Ffield-index.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Ffield-index.h?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -123,7 +123,8 @@ class FieldIndex final {\n   };\n   // Offset of first inobject property from beginning of object.\n   class FirstInobjectPropertyOffsetBits\n-      : public BitField64<int, InObjectPropertyBits::kNext, 7> {};\n+      : public BitField64<int, InObjectPropertyBits::kNext,\n+                          kFirstInobjectPropertyOffsetBitCount> {};\n   class IsHiddenField\n       : public BitField64<bool, FirstInobjectPropertyOffsetBits::kNext, 1> {};\n   STATIC_ASSERT(IsHiddenField::kNext <= 64);"
        },
        {
            "sha": "1cbc2ca418ea7a886066c0eebb200a260c46c5dd",
            "filename": "deps/v8/src/objects-inl.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fobjects-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fobjects-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fobjects-inl.h?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -2431,6 +2431,7 @@ int ObjectTemplateInfo::embedder_field_count() const {\n }\n \n void ObjectTemplateInfo::set_embedder_field_count(int count) {\n+  DCHECK_LE(count, JSObject::kMaxEmbedderFields);\n   return set_data(\n       Smi::FromInt(EmbedderFieldCount::update(Smi::ToInt(data()), count)));\n }"
        },
        {
            "sha": "af2e3eccb370045a67946a70675e970dd69a2255",
            "filename": "deps/v8/src/objects.cc",
            "status": "modified",
            "additions": 13,
            "deletions": 12,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fobjects.cc",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fobjects.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fobjects.cc?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -8791,10 +8791,9 @@ MUST_USE_RESULT Maybe<bool> FastGetOwnValuesOrEntries(\n MaybeHandle<FixedArray> GetOwnValuesOrEntries(Isolate* isolate,\n                                               Handle<JSReceiver> object,\n                                               PropertyFilter filter,\n-                                              bool try_fast_path,\n                                               bool get_entries) {\n   Handle<FixedArray> values_or_entries;\n-  if (try_fast_path && filter == ENUMERABLE_STRINGS) {\n+  if (filter == ENUMERABLE_STRINGS) {\n     Maybe<bool> fast_values_or_entries = FastGetOwnValuesOrEntries(\n         isolate, object, get_entries, &values_or_entries);\n     if (fast_values_or_entries.IsNothing()) return MaybeHandle<FixedArray>();\n@@ -8847,17 +8846,13 @@ MaybeHandle<FixedArray> GetOwnValuesOrEntries(Isolate* isolate,\n }\n \n MaybeHandle<FixedArray> JSReceiver::GetOwnValues(Handle<JSReceiver> object,\n-                                                 PropertyFilter filter,\n-                                                 bool try_fast_path) {\n-  return GetOwnValuesOrEntries(object->GetIsolate(), object, filter,\n-                               try_fast_path, false);\n+                                                 PropertyFilter filter) {\n+  return GetOwnValuesOrEntries(object->GetIsolate(), object, filter, false);\n }\n \n MaybeHandle<FixedArray> JSReceiver::GetOwnEntries(Handle<JSReceiver> object,\n-                                                  PropertyFilter filter,\n-                                                  bool try_fast_path) {\n-  return GetOwnValuesOrEntries(object->GetIsolate(), object, filter,\n-                               try_fast_path, true);\n+                                                  PropertyFilter filter) {\n+  return GetOwnValuesOrEntries(object->GetIsolate(), object, filter, true);\n }\n \n bool Map::DictionaryElementsInPrototypeChainOnly() {\n@@ -13783,18 +13778,24 @@ void JSFunction::CalculateInstanceSizeHelper(InstanceType instance_type,\n                                              int requested_in_object_properties,\n                                              int* instance_size,\n                                              int* in_object_properties) {\n+  DCHECK_LE(static_cast<unsigned>(requested_embedder_fields),\n+            JSObject::kMaxEmbedderFields);\n   int header_size = JSObject::GetHeaderSize(instance_type, has_prototype_slot);\n   int max_nof_fields =\n       (JSObject::kMaxInstanceSize - header_size) >> kPointerSizeLog2;\n   CHECK_LE(max_nof_fields, JSObject::kMaxInObjectProperties);\n-  *in_object_properties = Min(requested_in_object_properties, max_nof_fields);\n-  CHECK_LE(requested_embedder_fields, max_nof_fields - *in_object_properties);\n+  CHECK_LE(static_cast<unsigned>(requested_embedder_fields),\n+           static_cast<unsigned>(max_nof_fields));\n+  *in_object_properties = Min(requested_in_object_properties,\n+                              max_nof_fields - requested_embedder_fields);\n   *instance_size =\n       header_size +\n       ((requested_embedder_fields + *in_object_properties) << kPointerSizeLog2);\n   CHECK_EQ(*in_object_properties,\n            ((*instance_size - header_size) >> kPointerSizeLog2) -\n                requested_embedder_fields);\n+  CHECK_LE(static_cast<unsigned>(*instance_size),\n+           static_cast<unsigned>(JSObject::kMaxInstanceSize));\n }\n \n // static"
        },
        {
            "sha": "c4e3d972e111a9caa039bf1f22f5c4cdf8e4c0c2",
            "filename": "deps/v8/src/objects.h",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fobjects.h",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fobjects.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fobjects.h?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -2182,12 +2182,10 @@ class JSReceiver: public HeapObject {\n       Handle<JSReceiver> object);\n \n   MUST_USE_RESULT static MaybeHandle<FixedArray> GetOwnValues(\n-      Handle<JSReceiver> object, PropertyFilter filter,\n-      bool try_fast_path = true);\n+      Handle<JSReceiver> object, PropertyFilter filter);\n \n   MUST_USE_RESULT static MaybeHandle<FixedArray> GetOwnEntries(\n-      Handle<JSReceiver> object, PropertyFilter filter,\n-      bool try_fast_path = true);\n+      Handle<JSReceiver> object, PropertyFilter filter);\n \n   static const int kHashMask = PropertyArray::HashField::kMask;\n \n@@ -2673,6 +2671,11 @@ class JSObject: public JSReceiver {\n   static const int kMaxInObjectProperties =\n       (kMaxInstanceSize - kHeaderSize) >> kPointerSizeLog2;\n   STATIC_ASSERT(kMaxInObjectProperties <= kMaxNumberOfDescriptors);\n+  // TODO(cbruni): Revisit calculation of the max supported embedder fields.\n+  static const int kMaxEmbedderFields =\n+      ((1 << kFirstInobjectPropertyOffsetBitCount) - 1 - kHeaderSize) >>\n+      kPointerSizeLog2;\n+  STATIC_ASSERT(kMaxEmbedderFields <= kMaxInObjectProperties);\n \n   class BodyDescriptor;\n   // No weak fields."
        },
        {
            "sha": "a915ebd5119e561f22bb0498211925bc286e3dcc",
            "filename": "deps/v8/src/profiler/cpu-profiler.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 6,
            "changes": 15,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler.cc",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler.cc?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -165,13 +165,16 @@ void ProfilerEventsProcessor::Run() {\n \n     if (nextSampleTime > now) {\n #if V8_OS_WIN\n-      // Do not use Sleep on Windows as it is very imprecise.\n-      // Could be up to 16ms jitter, which is unacceptable for the purpose.\n-      while (base::TimeTicks::HighResolutionNow() < nextSampleTime) {\n-      }\n-#else\n-      base::OS::Sleep(nextSampleTime - now);\n+      if (nextSampleTime - now < base::TimeDelta::FromMilliseconds(100)) {\n+        // Do not use Sleep on Windows as it is very imprecise, with up to 16ms\n+        // jitter, which is unacceptable for short profile intervals.\n+        while (base::TimeTicks::HighResolutionNow() < nextSampleTime) {\n+        }\n+      } else  // NOLINT\n #endif\n+      {\n+        base::OS::Sleep(nextSampleTime - now);\n+      }\n     }\n \n     // Schedule next sample. sampler_ is nullptr in tests."
        },
        {
            "sha": "dbd4f93acd282f30ccb8c5850b2ecbb96216d8b5",
            "filename": "deps/v8/src/property-details.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fproperty-details.h",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fproperty-details.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fproperty-details.h?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -197,6 +197,7 @@ class Representation {\n \n \n static const int kDescriptorIndexBitCount = 10;\n+static const int kFirstInobjectPropertyOffsetBitCount = 7;\n // The maximum number of descriptors we want in a descriptor array.  It should\n // fit in a page and also the following should hold:\n // kMaxNumberOfDescriptors + kFieldsAdded <= PropertyArray::kMaxLength."
        },
        {
            "sha": "057ead9407835930d955b712ff6ac7f8284adff4",
            "filename": "deps/v8/src/runtime/runtime-object.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 55,
            "changes": 55,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fruntime%2Fruntime-object.cc",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fruntime%2Fruntime-object.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fruntime%2Fruntime-object.cc?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -439,61 +439,6 @@ RUNTIME_FUNCTION(Runtime_OptimizeObjectForAddingMultipleProperties) {\n   return *object;\n }\n \n-RUNTIME_FUNCTION(Runtime_ObjectValues) {\n-  HandleScope scope(isolate);\n-  DCHECK_EQ(1, args.length());\n-\n-  CONVERT_ARG_HANDLE_CHECKED(JSReceiver, receiver, 0);\n-\n-  Handle<FixedArray> values;\n-  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(\n-      isolate, values,\n-      JSReceiver::GetOwnValues(receiver, PropertyFilter::ENUMERABLE_STRINGS,\n-                               true));\n-  return *isolate->factory()->NewJSArrayWithElements(values);\n-}\n-\n-RUNTIME_FUNCTION(Runtime_ObjectValuesSkipFastPath) {\n-  HandleScope scope(isolate);\n-  DCHECK_EQ(1, args.length());\n-\n-  CONVERT_ARG_HANDLE_CHECKED(JSReceiver, receiver, 0);\n-\n-  Handle<FixedArray> value;\n-  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(\n-      isolate, value,\n-      JSReceiver::GetOwnValues(receiver, PropertyFilter::ENUMERABLE_STRINGS,\n-                               false));\n-  return *isolate->factory()->NewJSArrayWithElements(value);\n-}\n-\n-RUNTIME_FUNCTION(Runtime_ObjectEntries) {\n-  HandleScope scope(isolate);\n-  DCHECK_EQ(1, args.length());\n-\n-  CONVERT_ARG_HANDLE_CHECKED(JSReceiver, receiver, 0);\n-\n-  Handle<FixedArray> entries;\n-  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(\n-      isolate, entries,\n-      JSReceiver::GetOwnEntries(receiver, PropertyFilter::ENUMERABLE_STRINGS,\n-                                true));\n-  return *isolate->factory()->NewJSArrayWithElements(entries);\n-}\n-\n-RUNTIME_FUNCTION(Runtime_ObjectEntriesSkipFastPath) {\n-  HandleScope scope(isolate);\n-  DCHECK_EQ(1, args.length());\n-\n-  CONVERT_ARG_HANDLE_CHECKED(JSReceiver, receiver, 0);\n-\n-  Handle<FixedArray> entries;\n-  ASSIGN_RETURN_FAILURE_ON_EXCEPTION(\n-      isolate, entries,\n-      JSReceiver::GetOwnEntries(receiver, PropertyFilter::ENUMERABLE_STRINGS,\n-                                false));\n-  return *isolate->factory()->NewJSArrayWithElements(entries);\n-}\n \n RUNTIME_FUNCTION(Runtime_GetProperty) {\n   HandleScope scope(isolate);"
        },
        {
            "sha": "d05f4984c6af7a9f1f934fdefcc1e4412028245e",
            "filename": "deps/v8/src/runtime/runtime.h",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fruntime%2Fruntime.h",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fruntime%2Fruntime.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fruntime%2Fruntime.h?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -391,10 +391,6 @@ namespace internal {\n   F(ObjectCreate, 2, 1)                                         \\\n   F(InternalSetPrototype, 2, 1)                                 \\\n   F(OptimizeObjectForAddingMultipleProperties, 2, 1)            \\\n-  F(ObjectValues, 1, 1)                                         \\\n-  F(ObjectValuesSkipFastPath, 1, 1)                             \\\n-  F(ObjectEntries, 1, 1)                                        \\\n-  F(ObjectEntriesSkipFastPath, 1, 1)                            \\\n   F(GetProperty, 2, 1)                                          \\\n   F(KeyedGetProperty, 2, 1)                                     \\\n   F(AddNamedProperty, 4, 1)                                     \\"
        },
        {
            "sha": "84c1f2fd5b876ed3801d200388bf0de09966723b",
            "filename": "deps/v8/src/simulator-base.h",
            "status": "modified",
            "additions": 20,
            "deletions": 20,
            "changes": 40,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fsimulator-base.h",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Fsrc%2Fsimulator-base.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fsimulator-base.h?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -43,6 +43,26 @@ class SimulatorBase {\n     return ConvertReturn<Return>(ret);\n   }\n \n+  // Convert back integral return types.\n+  template <typename T>\n+  static typename std::enable_if<std::is_integral<T>::value, T>::type\n+  ConvertReturn(intptr_t ret) {\n+    static_assert(sizeof(T) <= sizeof(intptr_t), \"type bigger than ptrsize\");\n+    return static_cast<T>(ret);\n+  }\n+\n+  // Convert back pointer-typed return types.\n+  template <typename T>\n+  static typename std::enable_if<std::is_pointer<T>::value, T>::type\n+  ConvertReturn(intptr_t ret) {\n+    return reinterpret_cast<T>(ret);\n+  }\n+\n+  // Convert back void return type (i.e. no return).\n+  template <typename T>\n+  static typename std::enable_if<std::is_void<T>::value, T>::type ConvertReturn(\n+      intptr_t ret) {}\n+\n  private:\n   // Runtime call support. Uses the isolate in a thread-safe way.\n   static void* RedirectExternalReference(Isolate* isolate,\n@@ -69,26 +89,6 @@ class SimulatorBase {\n   ConvertArg(T arg) {\n     return reinterpret_cast<intptr_t>(arg);\n   }\n-\n-  // Convert back integral return types.\n-  template <typename T>\n-  static typename std::enable_if<std::is_integral<T>::value, T>::type\n-  ConvertReturn(intptr_t ret) {\n-    static_assert(sizeof(T) <= sizeof(intptr_t), \"type bigger than ptrsize\");\n-    return static_cast<T>(ret);\n-  }\n-\n-  // Convert back pointer-typed return types.\n-  template <typename T>\n-  static typename std::enable_if<std::is_pointer<T>::value, T>::type\n-  ConvertReturn(intptr_t ret) {\n-    return reinterpret_cast<T>(ret);\n-  }\n-\n-  // Convert back void return type (i.e. no return).\n-  template <typename T>\n-  static typename std::enable_if<std::is_void<T>::value, T>::type ConvertReturn(\n-      intptr_t ret) {}\n };\n \n // When the generated code calls an external reference we need to catch that in"
        },
        {
            "sha": "b3937382da0841b0637a68791369395b2dd5adc9",
            "filename": "deps/v8/test/cctest/test-api.cc",
            "status": "modified",
            "additions": 104,
            "deletions": 0,
            "changes": 104,
            "blob_url": "https://github.com/nodejs/node/blob/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Ftest%2Fcctest%2Ftest-api.cc",
            "raw_url": "https://github.com/nodejs/node/raw/040dd244de14f51b4757c25311164e36f72238c3/deps%2Fv8%2Ftest%2Fcctest%2Ftest-api.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fcctest%2Ftest-api.cc?ref=040dd244de14f51b4757c25311164e36f72238c3",
            "patch": "@@ -2699,6 +2699,110 @@ THREADED_TEST(InternalFields) {\n   CHECK_EQ(17, obj->GetInternalField(0)->Int32Value(env.local()).FromJust());\n }\n \n+TEST(InternalFieldsSubclassing) {\n+  LocalContext env;\n+  v8::Isolate* isolate = env->GetIsolate();\n+  v8::HandleScope scope(isolate);\n+  for (int nof_embedder_fields = 0;\n+       nof_embedder_fields < i::JSObject::kMaxEmbedderFields;\n+       nof_embedder_fields++) {\n+    Local<v8::FunctionTemplate> templ = v8::FunctionTemplate::New(isolate);\n+    Local<v8::ObjectTemplate> instance_templ = templ->InstanceTemplate();\n+    instance_templ->SetInternalFieldCount(nof_embedder_fields);\n+    Local<Function> constructor =\n+        templ->GetFunction(env.local()).ToLocalChecked();\n+    // Check that instances have the correct NOF properties.\n+    Local<v8::Object> obj =\n+        constructor->NewInstance(env.local()).ToLocalChecked();\n+\n+    i::Handle<i::JSObject> i_obj =\n+        i::Handle<i::JSObject>::cast(v8::Utils::OpenHandle(*obj));\n+    CHECK_EQ(nof_embedder_fields, obj->InternalFieldCount());\n+    CHECK_EQ(0, i_obj->map()->GetInObjectProperties());\n+    // Check writing and reading internal fields.\n+    for (int j = 0; j < nof_embedder_fields; j++) {\n+      CHECK(obj->GetInternalField(j)->IsUndefined());\n+      int value = 17 + j;\n+      obj->SetInternalField(j, v8_num(value));\n+    }\n+    for (int j = 0; j < nof_embedder_fields; j++) {\n+      int value = 17 + j;\n+      CHECK_EQ(value,\n+               obj->GetInternalField(j)->Int32Value(env.local()).FromJust());\n+    }\n+    CHECK(env->Global()\n+              ->Set(env.local(), v8_str(\"BaseClass\"), constructor)\n+              .FromJust());\n+    // Create various levels of subclasses to stress instance size calculation.\n+    const int kMaxNofProperties =\n+        i::JSObject::kMaxInObjectProperties - nof_embedder_fields;\n+    // Select only a few values to speed up the test.\n+    int sizes[] = {0,\n+                   1,\n+                   2,\n+                   3,\n+                   4,\n+                   5,\n+                   6,\n+                   kMaxNofProperties / 4,\n+                   kMaxNofProperties / 2,\n+                   kMaxNofProperties - 2,\n+                   kMaxNofProperties - 1,\n+                   kMaxNofProperties + 1,\n+                   kMaxNofProperties + 2,\n+                   kMaxNofProperties * 2,\n+                   kMaxNofProperties * 2};\n+    for (size_t i = 0; i < arraysize(sizes); i++) {\n+      int nof_properties = sizes[i];\n+      bool in_object_only = nof_properties <= kMaxNofProperties;\n+      std::ostringstream src;\n+      // Assembler source string for a subclass with {nof_properties}\n+      // in-object properties.\n+      src << \"(function() {\\n\"\n+          << \"  class SubClass extends BaseClass {\\n\"\n+          << \"    constructor() {\\n\"\n+          << \"      super();\\n\";\n+      // Set {nof_properties} instance properties in the constructor.\n+      for (int j = 0; j < nof_properties; j++) {\n+        src << \"      this.property\" << j << \" = \" << j << \";\\n\";\n+      }\n+      src << \"    }\\n\"\n+          << \"  };\\n\"\n+          << \"  let instance;\\n\"\n+          << \"  for (let i = 0; i < 3; i++) {\\n\"\n+          << \"    instance = new SubClass();\\n\"\n+          << \"  }\"\n+          << \"  return instance;\\n\"\n+          << \"})();\";\n+      Local<v8::Object> value = CompileRun(src.str().c_str()).As<v8::Object>();\n+\n+      i::Handle<i::JSObject> i_value =\n+          i::Handle<i::JSObject>::cast(v8::Utils::OpenHandle(*value));\n+#ifdef VERIFY_HEAP\n+      i_value->HeapObjectVerify();\n+      i_value->map()->HeapObjectVerify();\n+      i_value->map()->FindRootMap()->HeapObjectVerify();\n+#endif\n+      CHECK_EQ(nof_embedder_fields, value->InternalFieldCount());\n+      if (in_object_only) {\n+        CHECK_LE(nof_properties, i_value->map()->GetInObjectProperties());\n+      } else {\n+        CHECK_LE(kMaxNofProperties, i_value->map()->GetInObjectProperties());\n+      }\n+\n+      // Make Sure we get the precise property count.\n+      i_value->map()->FindRootMap()->CompleteInobjectSlackTracking();\n+      // TODO(cbruni): fix accounting to make this condition true.\n+      // CHECK_EQ(0, i_value->map()->UnusedPropertyFields());\n+      if (in_object_only) {\n+        CHECK_EQ(nof_properties, i_value->map()->GetInObjectProperties());\n+      } else {\n+        CHECK_LE(kMaxNofProperties, i_value->map()->GetInObjectProperties());\n+      }\n+    }\n+  }\n+}\n+\n THREADED_TEST(InternalFieldsOfRegularObjects) {\n   LocalContext env;\n   v8::Isolate* isolate = env->GetIsolate();"
        }
    ],
    "stats": {
        "total": 668,
        "additions": 218,
        "deletions": 450
    }
}