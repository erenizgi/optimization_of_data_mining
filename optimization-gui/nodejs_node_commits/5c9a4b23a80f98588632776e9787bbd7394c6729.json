{
    "author": "cjihrig",
    "message": "src: fix Get() usage in tls_wrap.cc\n\nPR-URL: https://github.com/nodejs/node/pull/24060\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>",
    "sha": "5c9a4b23a80f98588632776e9787bbd7394c6729",
    "files": [
        {
            "sha": "1d982db28e2558d5365b632776aa877b949a18ac",
            "filename": "src/tls_wrap.cc",
            "status": "modified",
            "additions": 13,
            "deletions": 5,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/5c9a4b23a80f98588632776e9787bbd7394c6729/src%2Ftls_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/5c9a4b23a80f98588632776e9787bbd7394c6729/src%2Ftls_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Ftls_wrap.cc?ref=5c9a4b23a80f98588632776e9787bbd7394c6729",
            "patch": "@@ -213,17 +213,22 @@ void TLSWrap::SSLInfoCallback(const SSL* ssl_, int where, int ret) {\n   Local<Object> object = c->object();\n \n   if (where & SSL_CB_HANDSHAKE_START) {\n-    Local<Value> callback = object->Get(env->onhandshakestart_string());\n-    if (callback->IsFunction()) {\n+    Local<Value> callback;\n+\n+    if (object->Get(env->context(), env->onhandshakestart_string())\n+          .ToLocal(&callback) && callback->IsFunction()) {\n       Local<Value> argv[] = { env->GetNow() };\n       c->MakeCallback(callback.As<Function>(), arraysize(argv), argv);\n     }\n   }\n \n   if (where & SSL_CB_HANDSHAKE_DONE) {\n+    Local<Value> callback;\n+\n     c->established_ = true;\n-    Local<Value> callback = object->Get(env->onhandshakedone_string());\n-    if (callback->IsFunction()) {\n+\n+    if (object->Get(env->context(), env->onhandshakedone_string())\n+          .ToLocal(&callback) && callback->IsFunction()) {\n       c->MakeCallback(callback.As<Function>(), 0, nullptr);\n     }\n   }\n@@ -814,7 +819,10 @@ int TLSWrap::SelectSNIContextCallback(SSL* s, int* ad, void* arg) {\n \n   // Call the SNI callback and use its return value as context\n   Local<Object> object = p->object();\n-  Local<Value> ctx = object->Get(env->sni_context_string());\n+  Local<Value> ctx;\n+\n+  if (!object->Get(env->context(), env->sni_context_string()).ToLocal(&ctx))\n+    return SSL_TLSEXT_ERR_NOACK;\n \n   // Not an object, probably undefined or null\n   if (!ctx->IsObject())"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 13,
        "deletions": 5
    }
}