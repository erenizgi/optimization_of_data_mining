{
    "author": "Fishrock123",
    "message": "timers: runtime-deprecate {un}enroll()\n\nThis was never a Very Good API, and generally just left so many open\nends for inconsistent behavior. The \"optimization\" benefit of this API\nis little to none. Makes a starting step towards removing it so that in\nthe future timers, especially in their async_hooks interactions, can be\nsimplified.\n\nPR-URL: https://github.com/nodejs/node/pull/18066\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>\nReviewed-By: Сковорода Никита Андреевич <chalkerx@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "68783ae0b823c584f625c045a134bfff63f4d1b3",
    "files": [
        {
            "sha": "ec7a79a295559347fa0033234859fd6d175d470d",
            "filename": "doc/api/deprecations.md",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/68783ae0b823c584f625c045a134bfff63f4d1b3/doc%2Fapi%2Fdeprecations.md",
            "raw_url": "https://github.com/nodejs/node/raw/68783ae0b823c584f625c045a134bfff63f4d1b3/doc%2Fapi%2Fdeprecations.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fdeprecations.md?ref=68783ae0b823c584f625c045a134bfff63f4d1b3",
            "patch": "@@ -856,11 +856,27 @@ Using `assert.fail()` with more than one argument has no benefit over writing an\n individual error message. Either use `assert.fail()` with one argument or switch\n to one of the other assert methods.\n \n+<a id=\"DEP00XX\"></a>\n+### DEP00XX: timers.enroll()\n+\n+Type: Runtime\n+\n+`timers.enroll()` is deprecated. Please use the publicly documented [`setTimeout()`][] or [`setInterval()`][] instead.\n+\n+<a id=\"DEP00XX\"></a>\n+### DEP00XX: timers.unenroll()\n+\n+Type: Runtime\n+\n+`timers.unenroll()` is deprecated. Please use the publicly documented [`clearTimeout()`][] or [`clearInterval()`][] instead.\n+\n [`--pending-deprecation`]: cli.html#cli_pending_deprecation\n [`Buffer.allocUnsafeSlow(size)`]: buffer.html#buffer_class_method_buffer_allocunsafeslow_size\n [`Buffer.from(array)`]: buffer.html#buffer_class_method_buffer_from_array\n [`Buffer.from(buffer)`]: buffer.html#buffer_class_method_buffer_from_buffer\n [`Buffer.isBuffer()`]: buffer.html#buffer_class_method_buffer_isbuffer_obj\n+[`clearInterval()`]: timers.html#timers_clearinterval_timeout\n+[`clearTimeout()`]: timers.html#timers_cleartimeout_timeout\n [`EventEmitter.listenerCount(emitter, eventName)`]: events.html#events_eventemitter_listenercount_emitter_eventname\n [`Server.connections`]: net.html#net_server_connections\n [`Server.getConnections()`]: net.html#net_server_getconnections_callback\n@@ -890,6 +906,8 @@ to one of the other assert methods.\n [`os.tmpdir()`]: os.html#os_os_tmpdir\n [`punycode`]: punycode.html\n [`require.extensions`]: modules.html#modules_require_extensions\n+[`setInterval()`]: timers.html#timers_setinterval_callback_delay_args\n+[`setTimeout()`]: timers.html#timers_settimeout_callback_delay_args\n [`tls.CryptoStream`]: tls.html#tls_class_cryptostream\n [`tls.SecureContext`]: tls.html#tls_tls_createsecurecontext_options\n [`tls.SecurePair`]: tls.html#tls_class_securepair"
        },
        {
            "sha": "6e5fda0e5eff2d726c8b718d36aba19da3cf8171",
            "filename": "lib/timers.js",
            "status": "modified",
            "additions": 14,
            "deletions": 4,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/68783ae0b823c584f625c045a134bfff63f4d1b3/lib%2Ftimers.js",
            "raw_url": "https://github.com/nodejs/node/raw/68783ae0b823c584f625c045a134bfff63f4d1b3/lib%2Ftimers.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Ftimers.js?ref=68783ae0b823c584f625c045a134bfff63f4d1b3",
            "patch": "@@ -367,7 +367,7 @@ function reuse(item) {\n \n \n // Remove a timer. Cancels the timeout and resets the relevant timer properties.\n-const unenroll = exports.unenroll = function(item) {\n+function unenroll(item) {\n   // Fewer checks may be possible, but these cover everything.\n   if (async_hook_fields[kDestroy] > 0 &&\n       item &&\n@@ -384,21 +384,31 @@ const unenroll = exports.unenroll = function(item) {\n   }\n   // if active is called later, then we want to make sure not to insert again\n   item._idleTimeout = -1;\n-};\n+}\n+\n+exports.unenroll = util.deprecate(unenroll,\n+                                  'timers.unenroll() is deprecated. ' +\n+                                  'Please use clearTimeout instead.',\n+                                  'DEP00XX');\n \n \n // Make a regular object able to act as a timer by setting some properties.\n // This function does not start the timer, see `active()`.\n // Using existing objects as timers slightly reduces object overhead.\n-exports.enroll = function(item, msecs) {\n+function enroll(item, msecs) {\n   item._idleTimeout = timerInternals.validateTimerDuration(msecs);\n \n   // if this item was already in a list somewhere\n   // then we should unenroll it from that\n   if (item._idleNext) unenroll(item);\n \n   L.init(item);\n-};\n+}\n+\n+exports.enroll = util.deprecate(enroll,\n+                                'timers.unenroll() is deprecated. ' +\n+                                'Please use clearTimeout instead.',\n+                                'DEP00XX');\n \n \n /*"
        },
        {
            "sha": "1fc17b974191938e4f931f4fc2e5afdd92e1f3f4",
            "filename": "test/parallel/test-timers-max-duration-warning.js",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/68783ae0b823c584f625c045a134bfff63f4d1b3/test%2Fparallel%2Ftest-timers-max-duration-warning.js",
            "raw_url": "https://github.com/nodejs/node/raw/68783ae0b823c584f625c045a134bfff63f4d1b3/test%2Fparallel%2Ftest-timers-max-duration-warning.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-timers-max-duration-warning.js?ref=68783ae0b823c584f625c045a134bfff63f4d1b3",
            "patch": "@@ -11,13 +11,15 @@ function timerNotCanceled() {\n }\n \n process.on('warning', common.mustCall((warning) => {\n+  if (warning.name === 'DeprecationWarning') return;\n+\n   const lines = warning.message.split('\\n');\n \n   assert.strictEqual(warning.name, 'TimeoutOverflowWarning');\n   assert.strictEqual(lines[0], `${OVERFLOW} does not fit into a 32-bit signed` +\n                                ' integer.');\n   assert.strictEqual(lines.length, 2);\n-}, 3));\n+}, 4));\n \n \n {"
        }
    ],
    "stats": {
        "total": 40,
        "additions": 35,
        "deletions": 5
    }
}