{
    "author": "targos",
    "message": "path: fix regression in posix.normalize\n\nFixes a regression introduced in [1].\nThe posix version of normalize should not treat backslash as a path\nseparator.\n\n[1] https://github.com/nodejs/node/commit/4ae320f2\n\nPR-URL: https://github.com/nodejs/node/pull/19520\nFixes: https://github.com/nodejs/node/issues/19519\nReviewed-By: Rich Trott <rtrott@gmail.com>\nReviewed-By: Tobias Nie√üen <tniessen@tnie.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "a0adf56855f59a301d9a1f69b4267ced4fd4cf03",
    "files": [
        {
            "sha": "427d158e7a78344306dc716c860bf4499d7c8513",
            "filename": "lib/path.js",
            "status": "modified",
            "additions": 15,
            "deletions": 7,
            "changes": 22,
            "blob_url": "https://github.com/nodejs/node/blob/a0adf56855f59a301d9a1f69b4267ced4fd4cf03/lib%2Fpath.js",
            "raw_url": "https://github.com/nodejs/node/raw/a0adf56855f59a301d9a1f69b4267ced4fd4cf03/lib%2Fpath.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fpath.js?ref=a0adf56855f59a301d9a1f69b4267ced4fd4cf03",
            "patch": "@@ -44,13 +44,17 @@ function isPathSeparator(code) {\n   return code === CHAR_FORWARD_SLASH || code === CHAR_BACKWARD_SLASH;\n }\n \n+function isPosixPathSeparator(code) {\n+  return code === CHAR_FORWARD_SLASH;\n+}\n+\n function isWindowsDeviceRoot(code) {\n   return code >= CHAR_UPPERCASE_A && code <= CHAR_UPPERCASE_Z ||\n          code >= CHAR_LOWERCASE_A && code <= CHAR_LOWERCASE_Z;\n }\n \n // Resolves . and .. elements in a path with directory names\n-function normalizeString(path, allowAboveRoot, separator) {\n+function normalizeString(path, allowAboveRoot, separator, isPathSeparator) {\n   var res = '';\n   var lastSegmentLength = 0;\n   var lastSlash = -1;\n@@ -272,7 +276,8 @@ const win32 = {\n     // fails)\n \n     // Normalize the tail path\n-    resolvedTail = normalizeString(resolvedTail, !resolvedAbsolute, '\\\\');\n+    resolvedTail = normalizeString(resolvedTail, !resolvedAbsolute, '\\\\',\n+                                   isPathSeparator);\n \n     return (resolvedDevice + (resolvedAbsolute ? '\\\\' : '') + resolvedTail) ||\n            '.';\n@@ -363,10 +368,12 @@ const win32 = {\n     }\n \n     var tail;\n-    if (rootEnd < len)\n-      tail = normalizeString(path.slice(rootEnd), !isAbsolute, '\\\\');\n-    else\n+    if (rootEnd < len) {\n+      tail = normalizeString(path.slice(rootEnd), !isAbsolute, '\\\\',\n+                             isPathSeparator);\n+    } else {\n       tail = '';\n+    }\n     if (tail.length === 0 && !isAbsolute)\n       tail = '.';\n     if (tail.length > 0 && isPathSeparator(path.charCodeAt(len - 1)))\n@@ -1095,7 +1102,8 @@ const posix = {\n     // handle relative paths to be safe (might happen when process.cwd() fails)\n \n     // Normalize the path\n-    resolvedPath = normalizeString(resolvedPath, !resolvedAbsolute, '/');\n+    resolvedPath = normalizeString(resolvedPath, !resolvedAbsolute, '/',\n+                                   isPosixPathSeparator);\n \n     if (resolvedAbsolute) {\n       if (resolvedPath.length > 0)\n@@ -1121,7 +1129,7 @@ const posix = {\n       path.charCodeAt(path.length - 1) === CHAR_FORWARD_SLASH;\n \n     // Normalize the path\n-    path = normalizeString(path, !isAbsolute, '/');\n+    path = normalizeString(path, !isAbsolute, '/', isPosixPathSeparator);\n \n     if (path.length === 0 && !isAbsolute)\n       path = '.';"
        },
        {
            "sha": "e1d3b9ce1e6c02cd221e01378e5c963d4b39cb95",
            "filename": "test/parallel/test-path-normalize.js",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/a0adf56855f59a301d9a1f69b4267ced4fd4cf03/test%2Fparallel%2Ftest-path-normalize.js",
            "raw_url": "https://github.com/nodejs/node/raw/a0adf56855f59a301d9a1f69b4267ced4fd4cf03/test%2Fparallel%2Ftest-path-normalize.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-path-normalize.js?ref=a0adf56855f59a301d9a1f69b4267ced4fd4cf03",
            "patch": "@@ -39,6 +39,7 @@ assert.strictEqual(\n   path.win32.normalize('../.../../foobar/../../../bar/../../baz'),\n   '..\\\\..\\\\..\\\\..\\\\baz'\n );\n+assert.strictEqual(path.win32.normalize('foo/bar\\\\baz'), 'foo\\\\bar\\\\baz');\n \n assert.strictEqual(path.posix.normalize('./fixtures///b/../b/c.js'),\n                    'fixtures/b/c.js');\n@@ -68,3 +69,4 @@ assert.strictEqual(\n   path.posix.normalize('../.../../foobar/../../../bar/../../baz'),\n   '../../../../baz'\n );\n+assert.strictEqual(path.posix.normalize('foo/bar\\\\baz'), 'foo/bar\\\\baz');"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 17,
        "deletions": 7
    }
}