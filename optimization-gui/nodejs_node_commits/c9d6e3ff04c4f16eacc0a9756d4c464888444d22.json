{
    "author": "unknown",
    "message": "coverage: expose native V8 coverage\n\nnative V8 coverage reports can now be written to disk by setting the\nvariable NODE_V8_COVERAGE=dir\n\nPR-URL: https://github.com/nodejs/node/pull/22527\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Yang Guo <yangguo@chromium.org>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Evan Lucas <evanlucas@me.com>\nReviewed-By: Rod Vagg <rod@vagg.org>",
    "sha": "c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
    "files": [
        {
            "sha": "6b7d451d682d1cab90ad82bf5eb6deb24e036d86",
            "filename": "doc/api/cli.md",
            "status": "modified",
            "additions": 28,
            "deletions": 0,
            "changes": 28,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/doc%2Fapi%2Fcli.md",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/doc%2Fapi%2Fcli.md",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/doc%2Fapi%2Fcli.md?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -625,6 +625,32 @@ Path to the file used to store the persistent REPL history. The default path is\n `~/.node_repl_history`, which is overridden by this variable. Setting the value\n to an empty string (`''` or `' '`) disables persistent REPL history.\n \n+### `NODE_V8_COVERAGE=dir`\n+\n+When set, Node.js will begin outputting [V8 JavaScript code coverage][] to the\n+directory provided as an argument. Coverage is output as an array of\n+[ScriptCoverage][] objects:\n+\n+```json\n+{\n+  \"result\": [\n+    {\n+      \"scriptId\": \"67\",\n+      \"url\": \"internal/tty.js\",\n+      \"functions\": []\n+    }\n+  ]\n+}\n+```\n+\n+`NODE_V8_COVERAGE` will automatically propagate to subprocesses, making it\n+easier to instrument applications that call the `child_process.spawn()` family\n+of functions. `NODE_V8_COVERAGE` can be set to an empty string, to prevent\n+propagation.\n+\n+At this time coverage is only collected in the main thread and will not be\n+output for code executed by worker threads.\n+\n ### `OPENSSL_CONF=file`\n <!-- YAML\n added: v6.11.0\n@@ -691,6 +717,8 @@ greater than `4` (its current default value). For more information, see the\n [`process.setUncaughtExceptionCaptureCallback()`]: process.html#process_process_setuncaughtexceptioncapturecallback_fn\n [Chrome DevTools Protocol]: https://chromedevtools.github.io/devtools-protocol/\n [REPL]: repl.html\n+[ScriptCoverage]: https://chromedevtools.github.io/devtools-protocol/tot/Profiler#type-ScriptCoverage\n+[V8 JavaScript code coverage]: https://v8project.blogspot.com/2017/12/javascript-code-coverage.html\n [debugger]: debugger.html\n [emit_warning]: process.html#process_process_emitwarning_warning_type_code_ctor\n [experimental ECMAScript Module]: esm.html#esm_loader_hooks"
        },
        {
            "sha": "2e9c71c1ef0a5e17048e564146542af7438036a8",
            "filename": "lib/child_process.js",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Fchild_process.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Fchild_process.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Fchild_process.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -497,6 +497,14 @@ function normalizeSpawnArguments(file, args, options) {\n   var env = options.env || process.env;\n   var envPairs = [];\n \n+  // process.env.NODE_V8_COVERAGE always propagates, making it possible to\n+  // collect coverage for programs that spawn with white-listed environment.\n+  if (process.env.NODE_V8_COVERAGE &&\n+      !Object.prototype.hasOwnProperty.call(options.env || {},\n+                                            'NODE_V8_COVERAGE')) {\n+    env.NODE_V8_COVERAGE = process.env.NODE_V8_COVERAGE;\n+  }\n+\n   // Prototype values are intentionally included.\n   for (var key in env) {\n     const value = env[key];"
        },
        {
            "sha": "de9fd21e77effece9494c3e856e5a5094736c7ca",
            "filename": "lib/internal/bootstrap/node.js",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fnode.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -101,6 +101,12 @@\n     if (global.__coverage__)\n       NativeModule.require('internal/process/write-coverage').setup();\n \n+    if (process.env.NODE_V8_COVERAGE) {\n+      const { resolve } = NativeModule.require('path');\n+      process.env.NODE_V8_COVERAGE = resolve(process.env.NODE_V8_COVERAGE);\n+      NativeModule.require('internal/process/coverage').setup();\n+    }\n+\n     if (process.config.variables.v8_enable_inspector) {\n       NativeModule.require('internal/inspector_async_hook').setup();\n     }"
        },
        {
            "sha": "221af2547b239d4a3beafcca8acd31d543089c79",
            "filename": "lib/internal/print_help.js",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Finternal%2Fprint_help.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Finternal%2Fprint_help.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fprint_help.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -29,6 +29,8 @@ const envVars = new Map([\n     'of stderr' }],\n   ['NODE_REPL_HISTORY', { helpText: 'path to the persistent REPL ' +\n     'history file' }],\n+  ['NODE_V8_COVERAGE', { helpText: 'directory to output v8 coverage JSON ' +\n+    'to' }],\n   ['OPENSSL_CONF', { helpText: 'load OpenSSL configuration from file' }]\n ].concat(hasIntl ? [\n   ['NODE_ICU_DATA', { helpText: 'data path for ICU (Intl object) data' +"
        },
        {
            "sha": "c2349d4ce0e24e6255d041e00238c9385d85b78b",
            "filename": "lib/internal/process/coverage.js",
            "status": "added",
            "additions": 71,
            "deletions": 0,
            "changes": 71,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Finternal%2Fprocess%2Fcoverage.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Finternal%2Fprocess%2Fcoverage.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fprocess%2Fcoverage.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -0,0 +1,71 @@\n+'use strict';\n+const path = require('path');\n+const { mkdirSync, writeFileSync } = require('fs');\n+// TODO(addaleax): add support for coverage to worker threads.\n+const hasInspector = process.config.variables.v8_enable_inspector === 1 &&\n+  require('internal/worker').isMainThread;\n+let inspector = null;\n+if (hasInspector) inspector = require('inspector');\n+\n+let session;\n+\n+function writeCoverage() {\n+  if (!session) {\n+    return;\n+  }\n+\n+  const filename = `coverage-${process.pid}-${Date.now()}.json`;\n+  try {\n+    // TODO(bcoe): switch to mkdirp once #22302 is addressed.\n+    mkdirSync(process.env.NODE_V8_COVERAGE);\n+  } catch (err) {\n+    if (err.code !== 'EEXIST') {\n+      console.error(err);\n+      return;\n+    }\n+  }\n+\n+  const target = path.join(process.env.NODE_V8_COVERAGE, filename);\n+\n+  try {\n+    session.post('Profiler.takePreciseCoverage', (err, coverageInfo) => {\n+      if (err) return console.error(err);\n+      try {\n+        writeFileSync(target, JSON.stringify(coverageInfo));\n+      } catch (err) {\n+        console.error(err);\n+      }\n+    });\n+  } catch (err) {\n+    console.error(err);\n+  } finally {\n+    session.disconnect();\n+    session = null;\n+  }\n+}\n+\n+exports.writeCoverage = writeCoverage;\n+\n+function setup() {\n+  if (!hasInspector) {\n+    console.warn('coverage currently only supported in main thread');\n+    return;\n+  }\n+\n+  session = new inspector.Session();\n+  session.connect();\n+  session.post('Profiler.enable');\n+  session.post('Profiler.startPreciseCoverage', { callCount: true,\n+                                                  detailed: true });\n+\n+  const reallyReallyExit = process.reallyExit;\n+\n+  process.reallyExit = function(code) {\n+    writeCoverage();\n+    reallyReallyExit(code);\n+  };\n+\n+  process.on('exit', writeCoverage);\n+}\n+\n+exports.setup = setup;"
        },
        {
            "sha": "9397ce3f591ecdab58195f81ebb17eddd7f7b1f9",
            "filename": "lib/internal/process/per_thread.js",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Finternal%2Fprocess%2Fper_thread.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/lib%2Finternal%2Fprocess%2Fper_thread.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fprocess%2Fper_thread.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -172,6 +172,10 @@ function setupKillAndExit() {\n \n   process.kill = function(pid, sig) {\n     var err;\n+    if (process.env.NODE_V8_COVERAGE) {\n+      const { writeCoverage } = require('internal/process/coverage');\n+      writeCoverage();\n+    }\n \n     // eslint-disable-next-line eqeqeq\n     if (pid != (pid | 0)) {"
        },
        {
            "sha": "64ed3df538f74f8c849757efaeb64eb0c4e55ad0",
            "filename": "node.gyp",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/node.gyp",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/node.gyp",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/node.gyp?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -144,6 +144,7 @@\n       'lib/internal/process/worker_thread_only.js',\n       'lib/internal/querystring.js',\n       'lib/internal/process/write-coverage.js',\n+      'lib/internal/process/coverage.js',\n       'lib/internal/readline.js',\n       'lib/internal/repl.js',\n       'lib/internal/repl/await.js',"
        },
        {
            "sha": "7d0e71b0c6ecd90320b97a30a7eab4f8e1a7edee",
            "filename": "test/fixtures/v8-coverage/basic.js",
            "status": "added",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fbasic.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fbasic.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fv8-coverage%2Fbasic.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -0,0 +1,6 @@\n+const a = 99;\n+if (true) {\n+  const b = 101;\n+} else {\n+  const c = 102;\n+}"
        },
        {
            "sha": "5c35d0a2fc92f452797a55c34a906a500b9fedae",
            "filename": "test/fixtures/v8-coverage/exit-1.js",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fexit-1.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fexit-1.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fv8-coverage%2Fexit-1.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -0,0 +1,7 @@\n+const a = 99;\n+if (true) {\n+  const b = 101;\n+} else {\n+  const c = 102;\n+}\n+process.exit(1);"
        },
        {
            "sha": "78efc9719254461a94b9d144681410d6d9c1a99f",
            "filename": "test/fixtures/v8-coverage/sigint.js",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fsigint.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fsigint.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fv8-coverage%2Fsigint.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -0,0 +1,7 @@\n+const a = 99;\n+if (true) {\n+  const b = 101;\n+} else {\n+  const c = 102;\n+}\n+process.kill(process.pid, \"SIGINT\");"
        },
        {
            "sha": "5baf179e5f1cdf8dc18c27775e798f2073f3b114",
            "filename": "test/fixtures/v8-coverage/spawn-subprocess-no-cov.js",
            "status": "added",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fspawn-subprocess-no-cov.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fspawn-subprocess-no-cov.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fv8-coverage%2Fspawn-subprocess-no-cov.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -0,0 +1,5 @@\n+const { spawnSync } = require('child_process');\n+const env = Object.assign({}, process.env, { NODE_V8_COVERAGE: '' });\n+spawnSync(process.execPath, [require.resolve('./subprocess')], {\n+  env: env\n+});"
        },
        {
            "sha": "53ef7b995506f9c731c9ff2829544cb94ac4c643",
            "filename": "test/fixtures/v8-coverage/spawn-subprocess.js",
            "status": "added",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fspawn-subprocess.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fspawn-subprocess.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fv8-coverage%2Fspawn-subprocess.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -0,0 +1,6 @@\n+const { spawnSync } = require('child_process');\n+const env = Object.assign({}, process.env);\n+delete env.NODE_V8_COVERAGE\n+spawnSync(process.execPath, [require.resolve('./subprocess')], {\n+  env: env\n+});"
        },
        {
            "sha": "e363c7614e7f731675cc612587f6dd73cb4ef158",
            "filename": "test/fixtures/v8-coverage/subprocess.js",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fsubprocess.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Ffixtures%2Fv8-coverage%2Fsubprocess.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Ffixtures%2Fv8-coverage%2Fsubprocess.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -0,0 +1,8 @@\n+const a = 99;\n+setTimeout(() => {\n+  if (false) {\n+    const b = 101;\n+  } else if (false) {\n+    const c = 102;\n+  }\n+}, 10);"
        },
        {
            "sha": "ad5100b42ea8d94fa33f98b4a9a4e449e93afb86",
            "filename": "test/parallel/test-v8-coverage.js",
            "status": "added",
            "additions": 105,
            "deletions": 0,
            "changes": 105,
            "blob_url": "https://github.com/nodejs/node/blob/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Fparallel%2Ftest-v8-coverage.js",
            "raw_url": "https://github.com/nodejs/node/raw/c9d6e3ff04c4f16eacc0a9756d4c464888444d22/test%2Fparallel%2Ftest-v8-coverage.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-v8-coverage.js?ref=c9d6e3ff04c4f16eacc0a9756d4c464888444d22",
            "patch": "@@ -0,0 +1,105 @@\n+'use strict';\n+\n+if (!process.config.variables.v8_enable_inspector) return;\n+\n+const common = require('../common');\n+const assert = require('assert');\n+const fs = require('fs');\n+const path = require('path');\n+const { spawnSync } = require('child_process');\n+\n+const tmpdir = require('../common/tmpdir');\n+tmpdir.refresh();\n+\n+let dirc = 0;\n+function nextdir() {\n+  return `cov_${++dirc}`;\n+}\n+\n+// outputs coverage when event loop is drained, with no async logic.\n+{\n+  const coverageDirectory = path.join(tmpdir.path, nextdir());\n+  const output = spawnSync(process.execPath, [\n+    require.resolve('../fixtures/v8-coverage/basic')\n+  ], { env: { ...process.env, NODE_V8_COVERAGE: coverageDirectory } });\n+  assert.strictEqual(output.status, 0);\n+  const fixtureCoverage = getFixtureCoverage('basic.js', coverageDirectory);\n+  assert.ok(fixtureCoverage);\n+  // first branch executed.\n+  assert.strictEqual(fixtureCoverage.functions[1].ranges[0].count, 1);\n+  // second branch did not execute.\n+  assert.strictEqual(fixtureCoverage.functions[1].ranges[1].count, 0);\n+}\n+\n+// outputs coverage when process.exit(1) exits process.\n+{\n+  const coverageDirectory = path.join(tmpdir.path, nextdir());\n+  const output = spawnSync(process.execPath, [\n+    require.resolve('../fixtures/v8-coverage/exit-1')\n+  ], { env: { ...process.env, NODE_V8_COVERAGE: coverageDirectory } });\n+  assert.strictEqual(output.status, 1);\n+  const fixtureCoverage = getFixtureCoverage('exit-1.js', coverageDirectory);\n+  assert.ok(fixtureCoverage, 'coverage not found for file');\n+  // first branch executed.\n+  assert.strictEqual(fixtureCoverage.functions[1].ranges[0].count, 1);\n+  // second branch did not execute.\n+  assert.strictEqual(fixtureCoverage.functions[1].ranges[1].count, 0);\n+}\n+\n+// outputs coverage when process.kill(process.pid, \"SIGINT\"); exits process.\n+{\n+  const coverageDirectory = path.join(tmpdir.path, nextdir());\n+  const output = spawnSync(process.execPath, [\n+    require.resolve('../fixtures/v8-coverage/sigint')\n+  ], { env: { ...process.env, NODE_V8_COVERAGE: coverageDirectory } });\n+  if (!common.isWindows) {\n+    assert.strictEqual(output.signal, 'SIGINT');\n+  }\n+  const fixtureCoverage = getFixtureCoverage('sigint.js', coverageDirectory);\n+  assert.ok(fixtureCoverage);\n+  // first branch executed.\n+  assert.strictEqual(fixtureCoverage.functions[1].ranges[0].count, 1);\n+  // second branch did not execute.\n+  assert.strictEqual(fixtureCoverage.functions[1].ranges[1].count, 0);\n+}\n+\n+// outputs coverage from subprocess.\n+{\n+  const coverageDirectory = path.join(tmpdir.path, nextdir());\n+  const output = spawnSync(process.execPath, [\n+    require.resolve('../fixtures/v8-coverage/spawn-subprocess')\n+  ], { env: { ...process.env, NODE_V8_COVERAGE: coverageDirectory } });\n+  assert.strictEqual(output.status, 0);\n+  const fixtureCoverage = getFixtureCoverage('subprocess.js',\n+                                             coverageDirectory);\n+  assert.ok(fixtureCoverage);\n+  // first branch executed.\n+  assert.strictEqual(fixtureCoverage.functions[2].ranges[0].count, 1);\n+  // second branch did not execute.\n+  assert.strictEqual(fixtureCoverage.functions[2].ranges[1].count, 0);\n+}\n+\n+// does not output coverage if NODE_V8_COVERAGE is empty.\n+{\n+  const coverageDirectory = path.join(tmpdir.path, nextdir());\n+  const output = spawnSync(process.execPath, [\n+    require.resolve('../fixtures/v8-coverage/spawn-subprocess-no-cov')\n+  ], { env: { ...process.env, NODE_V8_COVERAGE: coverageDirectory } });\n+  assert.strictEqual(output.status, 0);\n+  const fixtureCoverage = getFixtureCoverage('subprocess.js',\n+                                             coverageDirectory);\n+  assert.strictEqual(fixtureCoverage, undefined);\n+}\n+\n+// extracts the coverage object for a given fixture name.\n+function getFixtureCoverage(fixtureFile, coverageDirectory) {\n+  const coverageFiles = fs.readdirSync(coverageDirectory);\n+  for (const coverageFile of coverageFiles) {\n+    const coverage = require(path.join(coverageDirectory, coverageFile));\n+    for (const fixtureCoverage of coverage.result) {\n+      if (fixtureCoverage.url.indexOf(`${path.sep}${fixtureFile}`) !== -1) {\n+        return fixtureCoverage;\n+      }\n+    }\n+  }\n+}"
        }
    ],
    "stats": {
        "total": 264,
        "additions": 264,
        "deletions": 0
    }
}