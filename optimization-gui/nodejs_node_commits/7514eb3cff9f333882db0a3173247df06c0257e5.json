{
    "author": "Fishrock123",
    "message": "test: actually test tty `getColorDepth()`\n\nTTY tests should almost never be placed in `/parallel/`. Skipping TTY\ntests there due to missing tty fds just means they will never be run,\never, on any system.\n\nThis moves the tty-get-color-depth test to `/pseudo-tty/` where the test\nrunner will actually make a pty fd.\n\nRefs: https://github.com/nodejs/node/pull/17615\nPR-URL: https://github.com/nodejs/node/pull/18800\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>",
    "sha": "7514eb3cff9f333882db0a3173247df06c0257e5",
    "files": [
        {
            "sha": "e68846017175c9f860e12a83c0133399b8aeb3f1",
            "filename": "test/parallel/test-tty-get-color-depth.js",
            "status": "removed",
            "additions": 0,
            "deletions": 35,
            "changes": 35,
            "blob_url": "https://github.com/nodejs/node/blob/92bf2492cd6b78b1ab26765660d912ee34bb90c6/test%2Fparallel%2Ftest-tty-get-color-depth.js",
            "raw_url": "https://github.com/nodejs/node/raw/92bf2492cd6b78b1ab26765660d912ee34bb90c6/test%2Fparallel%2Ftest-tty-get-color-depth.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tty-get-color-depth.js?ref=92bf2492cd6b78b1ab26765660d912ee34bb90c6",
            "patch": "@@ -1,35 +0,0 @@\n-'use strict';\n-\n-const common = require('../common');\n-const assert = require('assert').strict;\n-/* eslint-disable no-restricted-properties */\n-const { WriteStream } = require('tty');\n-\n-const fd = common.getTTYfd();\n-\n-// Give up if we did not find a tty\n-if (fd === -1)\n-  common.skip();\n-\n-const writeStream = new WriteStream(fd);\n-\n-let depth = writeStream.getColorDepth();\n-\n-assert.equal(typeof depth, 'number');\n-assert(depth >= 1 && depth <= 24);\n-\n-// If the terminal does not support colors, skip the rest\n-if (depth === 1)\n-  common.skip();\n-\n-assert.notEqual(writeStream.getColorDepth({ TERM: 'dumb' }), depth);\n-\n-// Deactivate colors\n-const tmp = process.env.NODE_DISABLE_COLORS;\n-process.env.NODE_DISABLE_COLORS = 1;\n-\n-depth = writeStream.getColorDepth();\n-\n-assert.equal(depth, 1);\n-\n-process.env.NODE_DISABLE_COLORS = tmp;"
        },
        {
            "sha": "7641290c057d2eec8cc5bda952333afab3be6e15",
            "filename": "test/pseudo-tty/test-tty-get-color-depth.js",
            "status": "added",
            "additions": 36,
            "deletions": 0,
            "changes": 36,
            "blob_url": "https://github.com/nodejs/node/blob/7514eb3cff9f333882db0a3173247df06c0257e5/test%2Fpseudo-tty%2Ftest-tty-get-color-depth.js",
            "raw_url": "https://github.com/nodejs/node/raw/7514eb3cff9f333882db0a3173247df06c0257e5/test%2Fpseudo-tty%2Ftest-tty-get-color-depth.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fpseudo-tty%2Ftest-tty-get-color-depth.js?ref=7514eb3cff9f333882db0a3173247df06c0257e5",
            "patch": "@@ -0,0 +1,36 @@\n+'use strict';\n+\n+const common = require('../common');\n+const assert = require('assert').strict;\n+/* eslint-disable no-restricted-properties */\n+const { WriteStream } = require('tty');\n+\n+const fd = common.getTTYfd();\n+const writeStream = new WriteStream(fd);\n+\n+{\n+  const depth = writeStream.getColorDepth();\n+\n+  assert.equal(typeof depth, 'number');\n+  assert(depth >= 1 && depth <= 24);\n+\n+  if (depth === 1) {\n+    // Terminal does not support colors, compare to a value that would.\n+    assert.notEqual(writeStream.getColorDepth({ COLORTERM: '1' }), depth);\n+  } else {\n+    // Terminal supports colors, compare to a value that would not.\n+    assert.notEqual(writeStream.getColorDepth({ TERM: 'dumb' }), depth);\n+  }\n+}\n+\n+// Deactivate colors\n+{\n+  const tmp = process.env.NODE_DISABLE_COLORS;\n+  process.env.NODE_DISABLE_COLORS = 1;\n+\n+  const depth = writeStream.getColorDepth();\n+\n+  assert.equal(depth, 1);\n+\n+  process.env.NODE_DISABLE_COLORS = tmp;\n+}"
        },
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "test/pseudo-tty/test-tty-get-color-depth.out",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/nodejs/node/blob/7514eb3cff9f333882db0a3173247df06c0257e5/test%2Fpseudo-tty%2Ftest-tty-get-color-depth.out",
            "raw_url": "https://github.com/nodejs/node/raw/7514eb3cff9f333882db0a3173247df06c0257e5/test%2Fpseudo-tty%2Ftest-tty-get-color-depth.out",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fpseudo-tty%2Ftest-tty-get-color-depth.out?ref=7514eb3cff9f333882db0a3173247df06c0257e5"
        }
    ],
    "stats": {
        "total": 71,
        "additions": 36,
        "deletions": 35
    }
}