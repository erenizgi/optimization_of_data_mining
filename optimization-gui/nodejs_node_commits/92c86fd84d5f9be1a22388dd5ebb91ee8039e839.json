{
    "author": "cjihrig",
    "message": "test: add multiline repl input regression test\n\nThis commit adds a regression test for\nde848ac1e0483327a2ce8716c3f8567eaeacb660, which broke\nmultiline input in the REPL.\n\nPR-URL: https://github.com/nodejs/node/pull/18718\nRefs: https://github.com/nodejs/node/pull/17828\nRefs: https://github.com/nodejs/node/pull/18715\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "92c86fd84d5f9be1a22388dd5ebb91ee8039e839",
    "files": [
        {
            "sha": "54048bf31f2f6f4ddc3d3d4230737a7bd6ed6120",
            "filename": "test/parallel/test-repl-multiline.js",
            "status": "added",
            "additions": 35,
            "deletions": 0,
            "changes": 35,
            "blob_url": "https://github.com/nodejs/node/blob/92c86fd84d5f9be1a22388dd5ebb91ee8039e839/test%2Fparallel%2Ftest-repl-multiline.js",
            "raw_url": "https://github.com/nodejs/node/raw/92c86fd84d5f9be1a22388dd5ebb91ee8039e839/test%2Fparallel%2Ftest-repl-multiline.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-repl-multiline.js?ref=92c86fd84d5f9be1a22388dd5ebb91ee8039e839",
            "patch": "@@ -0,0 +1,35 @@\n+'use strict';\n+const common = require('../common');\n+const assert = require('assert');\n+const repl = require('repl');\n+const inputStream = new common.ArrayStream();\n+const outputStream = new common.ArrayStream();\n+const input = ['var foo = {', '};', 'foo;'];\n+let output = '';\n+\n+outputStream.write = (data) => { output += data.replace('\\r', ''); };\n+\n+const r = repl.start({\n+  prompt: '',\n+  input: inputStream,\n+  output: outputStream,\n+  terminal: true,\n+  useColors: false\n+});\n+\n+r.on('exit', common.mustCall(() => {\n+  const actual = output.split('\\n');\n+\n+  // Validate the output, which contains terminal escape codes.\n+  assert.strictEqual(actual.length, 6);\n+  assert.ok(actual[0].endsWith(input[0]));\n+  assert.ok(actual[1].includes('... '));\n+  assert.ok(actual[1].endsWith(input[1]));\n+  assert.strictEqual(actual[2], 'undefined');\n+  assert.ok(actual[3].endsWith(input[2]));\n+  assert.strictEqual(actual[4], '{}');\n+  // Ignore the last line, which is nothing but escape codes.\n+}));\n+\n+inputStream.run(input);\n+r.close();"
        }
    ],
    "stats": {
        "total": 35,
        "additions": 35,
        "deletions": 0
    }
}