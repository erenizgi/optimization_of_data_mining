{
    "author": "jasnell",
    "message": "src: move process.binding('signal_wrap') to internalBinding\n\nPR-URL: https://github.com/nodejs/node/pull/22290\nRefs: https://github.com/nodejs/node/issues/22160\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: John-David Dalton <john.david.dalton@gmail.com>\nReviewed-By: Jon Moss <me@jonathanmoss.me>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "0bdb95f4cffa7d672c23c60cdb6b779451d2ea33",
    "files": [
        {
            "sha": "e087a10844ce35a51af58cac87796c9b518425bf",
            "filename": "lib/internal/bootstrap/node.js",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/nodejs/node/blob/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "raw_url": "https://github.com/nodejs/node/raw/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/lib%2Finternal%2Fbootstrap%2Fnode.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fbootstrap%2Fnode.js?ref=0bdb95f4cffa7d672c23c60cdb6b779451d2ea33",
            "patch": "@@ -67,7 +67,7 @@\n     perThreadSetup.setupConfig(NativeModule._source);\n \n     if (isMainThread) {\n-      mainThreadSetup.setupSignalHandlers();\n+      mainThreadSetup.setupSignalHandlers(internalBinding);\n     }\n \n     perThreadSetup.setupUncaughtExceptionCapture(exceptionHandlerState,\n@@ -349,7 +349,8 @@\n         'uv',\n         'http_parser',\n         'v8',\n-        'stream_wrap']);\n+        'stream_wrap',\n+        'signal_wrap']);\n     process.binding = function binding(name) {\n       return internalBindingWhitelist.has(name) ?\n         internalBinding(name) :"
        },
        {
            "sha": "49910fafd7ebee067ba612d838bac1e0b4f337fb",
            "filename": "lib/internal/process/main_thread_only.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/lib%2Finternal%2Fprocess%2Fmain_thread_only.js",
            "raw_url": "https://github.com/nodejs/node/raw/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/lib%2Finternal%2Fprocess%2Fmain_thread_only.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finternal%2Fprocess%2Fmain_thread_only.js?ref=0bdb95f4cffa7d672c23c60cdb6b779451d2ea33",
            "patch": "@@ -117,7 +117,7 @@ function setupPosixMethods(_initgroups, _setegid, _seteuid,\n }\n \n // Worker threads don't receive signals.\n-function setupSignalHandlers() {\n+function setupSignalHandlers(internalBinding) {\n   const constants = process.binding('constants').os.signals;\n   const signalWraps = Object.create(null);\n   let Signal;\n@@ -130,7 +130,7 @@ function setupSignalHandlers() {\n   process.on('newListener', function(type) {\n     if (isSignal(type) && signalWraps[type] === undefined) {\n       if (Signal === undefined)\n-        Signal = process.binding('signal_wrap').Signal;\n+        Signal = internalBinding('signal_wrap').Signal;\n       const wrap = new Signal();\n \n       wrap.unref();"
        },
        {
            "sha": "0ba3fb3ceb7990c21bebfe1b6437f4298a858b58",
            "filename": "src/signal_wrap.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/src%2Fsignal_wrap.cc",
            "raw_url": "https://github.com/nodejs/node/raw/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/src%2Fsignal_wrap.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fsignal_wrap.cc?ref=0bdb95f4cffa7d672c23c60cdb6b779451d2ea33",
            "patch": "@@ -128,4 +128,4 @@ class SignalWrap : public HandleWrap {\n }  // namespace node\n \n \n-NODE_BUILTIN_MODULE_CONTEXT_AWARE(signal_wrap, node::SignalWrap::Initialize)\n+NODE_MODULE_CONTEXT_AWARE_INTERNAL(signal_wrap, node::SignalWrap::Initialize)"
        },
        {
            "sha": "5c74a29b735a47932c499bfecfed33eaa2fd50db",
            "filename": "test/parallel/test-process-binding-internalbinding-whitelist.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/test%2Fparallel%2Ftest-process-binding-internalbinding-whitelist.js",
            "raw_url": "https://github.com/nodejs/node/raw/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/test%2Fparallel%2Ftest-process-binding-internalbinding-whitelist.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-process-binding-internalbinding-whitelist.js?ref=0bdb95f4cffa7d672c23c60cdb6b779451d2ea33",
            "patch": "@@ -10,3 +10,4 @@ assert(process.binding('uv'));\n assert(process.binding('http_parser'));\n assert(process.binding('v8'));\n assert(process.binding('stream_wrap'));\n+assert(process.binding('signal_wrap'));"
        },
        {
            "sha": "917e7c2cfac2a3090f245a661c6e6d53a8e5c147",
            "filename": "test/parallel/test-signal-safety.js",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/test%2Fparallel%2Ftest-signal-safety.js",
            "raw_url": "https://github.com/nodejs/node/raw/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/test%2Fparallel%2Ftest-signal-safety.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-signal-safety.js?ref=0bdb95f4cffa7d672c23c60cdb6b779451d2ea33",
            "patch": "@@ -1,7 +1,9 @@\n+// Flags: --expose-internals\n 'use strict';\n require('../common');\n const assert = require('assert');\n-const Signal = process.binding('signal_wrap').Signal;\n+const { internalBinding } = require('internal/test/binding');\n+const { Signal } = internalBinding('signal_wrap');\n \n // Test Signal `this` safety\n // https://github.com/joyent/node/issues/6690"
        },
        {
            "sha": "c510405341ffed512a6aa25d20663a69650ddce8",
            "filename": "test/sequential/test-async-wrap-getasyncid.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "raw_url": "https://github.com/nodejs/node/raw/0bdb95f4cffa7d672c23c60cdb6b779451d2ea33/test%2Fsequential%2Ftest-async-wrap-getasyncid.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-async-wrap-getasyncid.js?ref=0bdb95f4cffa7d672c23c60cdb6b779451d2ea33",
            "patch": "@@ -1,5 +1,5 @@\n 'use strict';\n-// Flags: --expose-gc --expose-internals\n+// Flags: --expose-gc --expose-internals --no-warnings\n \n const common = require('../common');\n const { internalBinding } = require('internal/test/binding');\n@@ -187,7 +187,7 @@ if (common.hasCrypto) { // eslint-disable-line node-core/crypto-check\n }\n \n {\n-  const Signal = process.binding('signal_wrap').Signal;\n+  const { Signal } = internalBinding('signal_wrap');\n   testInitialized(new Signal(), 'Signal');\n }\n "
        }
    ],
    "stats": {
        "total": 20,
        "additions": 12,
        "deletions": 8
    }
}