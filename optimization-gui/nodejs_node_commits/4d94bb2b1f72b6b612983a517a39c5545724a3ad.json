{
    "author": "unknown",
    "message": "test: fix unreliable test-fs-stat-bigint\n\nRemove side-effects between testcases by creating a new file everytime.\n\nFixes: https://github.com/nodejs/node/issues/21948\nPR-URL: https://github.com/nodejs/node/pull/21949\nReviewed-By: Rich Trott <rtrott@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Luigi Pinca <luigipinca@gmail.com>",
    "sha": "4d94bb2b1f72b6b612983a517a39c5545724a3ad",
    "files": [
        {
            "sha": "4691b2dd9d267e853ae2001033aed4d33a57a112",
            "filename": "test/parallel/test-fs-stat-bigint.js",
            "status": "modified",
            "additions": 29,
            "deletions": 15,
            "changes": 44,
            "blob_url": "https://github.com/nodejs/node/blob/4d94bb2b1f72b6b612983a517a39c5545724a3ad/test%2Fparallel%2Ftest-fs-stat-bigint.js",
            "raw_url": "https://github.com/nodejs/node/raw/4d94bb2b1f72b6b612983a517a39c5545724a3ad/test%2Fparallel%2Ftest-fs-stat-bigint.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-stat-bigint.js?ref=4d94bb2b1f72b6b612983a517a39c5545724a3ad",
            "patch": "@@ -10,13 +10,12 @@ const { isDate } = require('util').types;\n \n tmpdir.refresh();\n \n-const fn = path.join(tmpdir.path, 'test-file');\n-fs.writeFileSync(fn, 'test');\n+let testIndex = 0;\n \n-let link;\n-if (!common.isWindows) {\n-  link = path.join(tmpdir.path, 'symbolic-link');\n-  fs.symlinkSync(fn, link);\n+function getFilename() {\n+  const filename = path.join(tmpdir.path, `test-file-${++testIndex}`);\n+  fs.writeFileSync(filename, 'test');\n+  return filename;\n }\n \n function verifyStats(bigintStats, numStats) {\n@@ -74,34 +73,43 @@ function verifyStats(bigintStats, numStats) {\n }\n \n {\n-  const bigintStats = fs.statSync(fn, { bigint: true });\n-  const numStats = fs.statSync(fn);\n+  const filename = getFilename();\n+  const bigintStats = fs.statSync(filename, { bigint: true });\n+  const numStats = fs.statSync(filename);\n   verifyStats(bigintStats, numStats);\n }\n \n if (!common.isWindows) {\n+  const filename = getFilename();\n+  const link = `${filename}-link`;\n+  fs.symlinkSync(filename, link);\n   const bigintStats = fs.lstatSync(link, { bigint: true });\n   const numStats = fs.lstatSync(link);\n   verifyStats(bigintStats, numStats);\n }\n \n {\n-  const fd = fs.openSync(fn, 'r');\n+  const filename = getFilename();\n+  const fd = fs.openSync(filename, 'r');\n   const bigintStats = fs.fstatSync(fd, { bigint: true });\n   const numStats = fs.fstatSync(fd);\n   verifyStats(bigintStats, numStats);\n   fs.closeSync(fd);\n }\n \n {\n-  fs.stat(fn, { bigint: true }, (err, bigintStats) => {\n-    fs.stat(fn, (err, numStats) => {\n+  const filename = getFilename();\n+  fs.stat(filename, { bigint: true }, (err, bigintStats) => {\n+    fs.stat(filename, (err, numStats) => {\n       verifyStats(bigintStats, numStats);\n     });\n   });\n }\n \n if (!common.isWindows) {\n+  const filename = getFilename();\n+  const link = `${filename}-link`;\n+  fs.symlinkSync(filename, link);\n   fs.lstat(link, { bigint: true }, (err, bigintStats) => {\n     fs.lstat(link, (err, numStats) => {\n       verifyStats(bigintStats, numStats);\n@@ -110,7 +118,8 @@ if (!common.isWindows) {\n }\n \n {\n-  const fd = fs.openSync(fn, 'r');\n+  const filename = getFilename();\n+  const fd = fs.openSync(filename, 'r');\n   fs.fstat(fd, { bigint: true }, (err, bigintStats) => {\n     fs.fstat(fd, (err, numStats) => {\n       verifyStats(bigintStats, numStats);\n@@ -120,21 +129,26 @@ if (!common.isWindows) {\n }\n \n (async function() {\n-  const bigintStats = await promiseFs.stat(fn, { bigint: true });\n-  const numStats = await promiseFs.stat(fn);\n+  const filename = getFilename();\n+  const bigintStats = await promiseFs.stat(filename, { bigint: true });\n+  const numStats = await promiseFs.stat(filename);\n   verifyStats(bigintStats, numStats);\n })();\n \n if (!common.isWindows) {\n   (async function() {\n+    const filename = getFilename();\n+    const link = `${filename}-link`;\n+    fs.symlinkSync(filename, link);\n     const bigintStats = await promiseFs.lstat(link, { bigint: true });\n     const numStats = await promiseFs.lstat(link);\n     verifyStats(bigintStats, numStats);\n   })();\n }\n \n (async function() {\n-  const handle = await promiseFs.open(fn, 'r');\n+  const filename = getFilename();\n+  const handle = await promiseFs.open(filename, 'r');\n   const bigintStats = await handle.stat({ bigint: true });\n   const numStats = await handle.stat();\n   verifyStats(bigintStats, numStats);"
        }
    ],
    "stats": {
        "total": 44,
        "additions": 29,
        "deletions": 15
    }
}