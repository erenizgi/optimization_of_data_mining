{
    "author": "addaleax",
    "message": "src: make CLI options programatically accesible\n\nProvide `internalBinding('options')` with some utilities\naround making the options parser and current options values\nprogramatically accessible.\n\nPR-URL: https://github.com/nodejs/node/pull/22490\nReviewed-By: MichaÃ«l Zasso <targos@protonmail.com>",
    "sha": "e812be4a55915575fc1afce739848026a48b781e",
    "files": [
        {
            "sha": "fa802e4016dfdbe572ae91484b65bd50fec0f062",
            "filename": "src/env.h",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/e812be4a55915575fc1afce739848026a48b781e/src%2Fenv.h",
            "raw_url": "https://github.com/nodejs/node/raw/e812be4a55915575fc1afce739848026a48b781e/src%2Fenv.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fenv.h?ref=e812be4a55915575fc1afce739848026a48b781e",
            "patch": "@@ -118,6 +118,7 @@ struct PackageConfig {\n // for the sake of convenience.  Strings should be ASCII-only.\n #define PER_ISOLATE_STRING_PROPERTIES(V)                                      \\\n   V(address_string, \"address\")                                                \\\n+  V(aliases_string, \"aliases\")                                                \\\n   V(args_string, \"args\")                                                      \\\n   V(async, \"async\")                                                           \\\n   V(async_ids_stack_string, \"async_ids_stack\")                                \\\n@@ -156,6 +157,7 @@ struct PackageConfig {\n   V(entries_string, \"entries\")                                                \\\n   V(entry_type_string, \"entryType\")                                           \\\n   V(env_pairs_string, \"envPairs\")                                             \\\n+  V(env_var_settings_string, \"envVarSettings\")                                \\\n   V(errno_string, \"errno\")                                                    \\\n   V(error_string, \"error\")                                                    \\\n   V(exit_code_string, \"exitCode\")                                             \\\n@@ -176,6 +178,7 @@ struct PackageConfig {\n   V(get_shared_array_buffer_id_string, \"_getSharedArrayBufferId\")             \\\n   V(gid_string, \"gid\")                                                        \\\n   V(handle_string, \"handle\")                                                  \\\n+  V(help_text_string, \"helpText\")                                             \\\n   V(homedir_string, \"homedir\")                                                \\\n   V(host_string, \"host\")                                                      \\\n   V(hostmaster_string, \"hostmaster\")                                          \\\n@@ -233,6 +236,7 @@ struct PackageConfig {\n   V(onunpipe_string, \"onunpipe\")                                              \\\n   V(onwrite_string, \"onwrite\")                                                \\\n   V(openssl_error_stack, \"opensslErrorStack\")                                 \\\n+  V(options_string, \"options\")                                                \\\n   V(output_string, \"output\")                                                  \\\n   V(order_string, \"order\")                                                    \\\n   V(parse_error_string, \"Parse Error\")                                        \\"
        },
        {
            "sha": "1336cdecb6c651c53438a0b32ae9f7e8bfb94e00",
            "filename": "src/node.cc",
            "status": "modified",
            "additions": 17,
            "deletions": 9,
            "changes": 26,
            "blob_url": "https://github.com/nodejs/node/blob/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode.cc",
            "raw_url": "https://github.com/nodejs/node/raw/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode.cc?ref=e812be4a55915575fc1afce739848026a48b781e",
            "patch": "@@ -126,6 +126,8 @@ typedef int mode_t;\n \n namespace node {\n \n+using options_parser::kAllowedInEnvironment;\n+using options_parser::kDisallowedInEnvironment;\n using v8::Array;\n using v8::ArrayBuffer;\n using v8::Boolean;\n@@ -183,6 +185,7 @@ bool linux_at_secure = false;\n // process-relative uptime base, initialized at start-up\n double prog_start_time;\n \n+Mutex per_process_opts_mutex;\n std::shared_ptr<PerProcessOptions> per_process_opts {\n     new PerProcessOptions() };\n \n@@ -2346,8 +2349,6 @@ void LoadEnvironment(Environment* env) {\n }\n \n static void PrintHelp() {\n-  // XXX: If you add an option here, please also add it to doc/node.1 and\n-  // doc/api/cli.md\n   printf(\"Usage: node [options] [ -e script | script.js | - ] [arguments]\\n\"\n          \"       node inspect script.js [arguments]\\n\"\n          \"\\n\"\n@@ -2747,13 +2748,20 @@ void ProcessArgv(std::vector<std::string>* args,\n   // Parse a few arguments which are specific to Node.\n   std::vector<std::string> v8_args;\n   std::string error;\n-  PerProcessOptionsParser::instance.Parse(\n-      args,\n-      exec_args,\n-      &v8_args,\n-      per_process_opts.get(),\n-      is_env ? kAllowedInEnvironment : kDisallowedInEnvironment,\n-      &error);\n+\n+  {\n+    // TODO(addaleax): The mutex here should ideally be held during the\n+    // entire function, but that doesn't play well with the exit() calls below.\n+    Mutex::ScopedLock lock(per_process_opts_mutex);\n+    options_parser::PerProcessOptionsParser::instance.Parse(\n+        args,\n+        exec_args,\n+        &v8_args,\n+        per_process_opts.get(),\n+        is_env ? kAllowedInEnvironment : kDisallowedInEnvironment,\n+        &error);\n+  }\n+\n   if (!error.empty()) {\n     fprintf(stderr, \"%s: %s\\n\", args->at(0).c_str(), error.c_str());\n     exit(9);"
        },
        {
            "sha": "2fa95024669eb1466cc0f34bf0515072ade54f6f",
            "filename": "src/node_internals.h",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode_internals.h",
            "raw_url": "https://github.com/nodejs/node/raw/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode_internals.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_internals.h?ref=e812be4a55915575fc1afce739848026a48b781e",
            "patch": "@@ -119,6 +119,7 @@ struct sockaddr;\n     V(js_stream)                                                              \\\n     V(messaging)                                                              \\\n     V(module_wrap)                                                            \\\n+    V(options)                                                                \\\n     V(os)                                                                     \\\n     V(performance)                                                            \\\n     V(pipe_wrap)                                                              \\\n@@ -176,6 +177,7 @@ extern Mutex environ_mutex;\n // Tells whether it is safe to call v8::Isolate::GetCurrent().\n extern bool v8_initialized;\n \n+extern Mutex per_process_opts_mutex;\n extern std::shared_ptr<PerProcessOptions> per_process_opts;\n \n extern const char* const environment_flags[];"
        },
        {
            "sha": "ba18e7c19b03c7beca9fc3aabf67d2f1374252ee",
            "filename": "src/node_options-inl.h",
            "status": "modified",
            "additions": 51,
            "deletions": 39,
            "changes": 90,
            "blob_url": "https://github.com/nodejs/node/blob/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode_options-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode_options-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_options-inl.h?ref=e812be4a55915575fc1afce739848026a48b781e",
            "patch": "@@ -21,73 +21,88 @@ EnvironmentOptions* PerIsolateOptions::get_per_env_options() {\n   return per_env.get();\n }\n \n+namespace options_parser {\n+\n template <typename Options>\n void OptionsParser<Options>::AddOption(const std::string& name,\n+                                       const std::string& help_text,\n                                        bool Options::* field,\n                                        OptionEnvvarSettings env_setting) {\n-  options_.emplace(name, OptionInfo {\n-    kBoolean,\n-    std::make_shared<SimpleOptionField<bool>>(field),\n-    env_setting\n-  });\n+  options_.emplace(name,\n+                   OptionInfo{kBoolean,\n+                              std::make_shared<SimpleOptionField<bool>>(field),\n+                              env_setting,\n+                              help_text});\n }\n \n template <typename Options>\n void OptionsParser<Options>::AddOption(const std::string& name,\n+                                       const std::string& help_text,\n                                        int64_t Options::* field,\n                                        OptionEnvvarSettings env_setting) {\n-  options_.emplace(name, OptionInfo {\n-    kInteger,\n-    std::make_shared<SimpleOptionField<int64_t>>(field),\n-    env_setting\n-  });\n+  options_.emplace(\n+      name,\n+      OptionInfo{kInteger,\n+                 std::make_shared<SimpleOptionField<int64_t>>(field),\n+                 env_setting,\n+                 help_text});\n }\n \n template <typename Options>\n void OptionsParser<Options>::AddOption(const std::string& name,\n+                                       const std::string& help_text,\n                                        std::string Options::* field,\n                                        OptionEnvvarSettings env_setting) {\n-  options_.emplace(name, OptionInfo {\n-    kString,\n-    std::make_shared<SimpleOptionField<std::string>>(field),\n-    env_setting\n-  });\n+  options_.emplace(\n+      name,\n+      OptionInfo{kString,\n+                 std::make_shared<SimpleOptionField<std::string>>(field),\n+                 env_setting,\n+                 help_text});\n }\n \n template <typename Options>\n void OptionsParser<Options>::AddOption(\n     const std::string& name,\n+    const std::string& help_text,\n     std::vector<std::string> Options::* field,\n     OptionEnvvarSettings env_setting) {\n   options_.emplace(name, OptionInfo {\n     kStringList,\n     std::make_shared<SimpleOptionField<std::vector<std::string>>>(field),\n-    env_setting\n+    env_setting,\n+    help_text\n   });\n }\n \n template <typename Options>\n void OptionsParser<Options>::AddOption(const std::string& name,\n+                                       const std::string& help_text,\n                                        HostPort Options::* field,\n                                        OptionEnvvarSettings env_setting) {\n-  options_.emplace(name, OptionInfo {\n-    kHostPort,\n-    std::make_shared<SimpleOptionField<HostPort>>(field),\n-    env_setting\n-  });\n+  options_.emplace(\n+      name,\n+      OptionInfo{kHostPort,\n+                 std::make_shared<SimpleOptionField<HostPort>>(field),\n+                 env_setting,\n+                 help_text});\n }\n \n template <typename Options>\n-void OptionsParser<Options>::AddOption(const std::string& name, NoOp no_op_tag,\n+void OptionsParser<Options>::AddOption(const std::string& name,\n+                                       const std::string& help_text,\n+                                       NoOp no_op_tag,\n                                        OptionEnvvarSettings env_setting) {\n-  options_.emplace(name, OptionInfo { kNoOp, nullptr, env_setting });\n+  options_.emplace(name, OptionInfo{kNoOp, nullptr, env_setting, help_text});\n }\n \n template <typename Options>\n void OptionsParser<Options>::AddOption(const std::string& name,\n+                                       const std::string& help_text,\n                                        V8Option v8_option_tag,\n                                        OptionEnvvarSettings env_setting) {\n-  options_.emplace(name, OptionInfo { kV8Option, nullptr, env_setting });\n+  options_.emplace(name,\n+                   OptionInfo{kV8Option, nullptr, env_setting, help_text});\n }\n \n template <typename Options>\n@@ -161,11 +176,10 @@ template <typename ChildOptions>\n auto OptionsParser<Options>::Convert(\n     typename OptionsParser<ChildOptions>::OptionInfo original,\n     ChildOptions* (Options::* get_child)()) {\n-  return OptionInfo {\n-    original.type,\n-    Convert(original.field, get_child),\n-    original.env_setting\n-  };\n+  return OptionInfo{original.type,\n+                    Convert(original.field, get_child),\n+                    original.env_setting,\n+                    original.help_text};\n }\n \n template <typename Options>\n@@ -385,24 +399,21 @@ void OptionsParser<Options>::Parse(\n \n     switch (info.type) {\n       case kBoolean:\n-        *std::static_pointer_cast<OptionField<bool>>(info.field)\n-            ->Lookup(options) = true;\n+        *Lookup<bool>(info.field, options) = true;\n         break;\n       case kInteger:\n-        *std::static_pointer_cast<OptionField<int64_t>>(info.field)\n-            ->Lookup(options) = std::atoll(value.c_str());\n+        *Lookup<int64_t>(info.field, options) = std::atoll(value.c_str());\n         break;\n       case kString:\n-        *std::static_pointer_cast<OptionField<std::string>>(info.field)\n-            ->Lookup(options) = value;\n+        *Lookup<std::string>(info.field, options) = value;\n         break;\n       case kStringList:\n-        std::static_pointer_cast<OptionField<std::vector<std::string>>>(\n-            info.field)->Lookup(options)->emplace_back(std::move(value));\n+        Lookup<std::vector<std::string>>(info.field, options)\n+            ->emplace_back(std::move(value));\n         break;\n       case kHostPort:\n-        std::static_pointer_cast<OptionField<HostPort>>(info.field)\n-            ->Lookup(options)->Update(SplitHostPort(value, error));\n+        Lookup<HostPort>(info.field, options)\n+            ->Update(SplitHostPort(value, error));\n         break;\n       case kNoOp:\n         break;\n@@ -415,6 +426,7 @@ void OptionsParser<Options>::Parse(\n   }\n }\n \n+}  // namespace options_parser\n }  // namespace node\n \n #endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS"
        },
        {
            "sha": "88fac6a01f1affd3db5022caddc48a3f0458c2b3",
            "filename": "src/node_options.cc",
            "status": "modified",
            "additions": 305,
            "deletions": 48,
            "changes": 353,
            "blob_url": "https://github.com/nodejs/node/blob/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode_options.cc",
            "raw_url": "https://github.com/nodejs/node/raw/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode_options.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_options.cc?ref=e812be4a55915575fc1afce739848026a48b781e",
            "patch": "@@ -1,99 +1,165 @@\n-#include \"node_options-inl.h\"\n #include <errno.h>\n+#include \"node_internals.h\"\n+#include \"node_options-inl.h\"\n+\n+using v8::Boolean;\n+using v8::Context;\n+using v8::FunctionCallbackInfo;\n+using v8::Integer;\n+using v8::Isolate;\n+using v8::Local;\n+using v8::Map;\n+using v8::Number;\n+using v8::Object;\n+using v8::String;\n+using v8::Undefined;\n+using v8::Value;\n \n namespace node {\n+namespace options_parser {\n+\n+// XXX: If you add an option here, please also add it to doc/node.1 and\n+// doc/api/cli.md\n+// TODO(addaleax): Make that unnecessary.\n \n DebugOptionsParser::DebugOptionsParser() {\n-  AddOption(\"--inspect-port\", &DebugOptions::host_port,\n+  AddOption(\"--inspect-port\",\n+            \"set host:port for inspector\",\n+            &DebugOptions::host_port,\n             kAllowedInEnvironment);\n   AddAlias(\"--debug-port\", \"--inspect-port\");\n \n-  AddOption(\"--inspect\", &DebugOptions::inspector_enabled,\n+  AddOption(\"--inspect\",\n+            \"activate inspector on host:port (default: 127.0.0.1:9229)\",\n+            &DebugOptions::inspector_enabled,\n             kAllowedInEnvironment);\n   AddAlias(\"--inspect=\", { \"--inspect-port\", \"--inspect\" });\n \n-  AddOption(\"--debug\", &DebugOptions::deprecated_debug);\n+  AddOption(\"--debug\", \"\", &DebugOptions::deprecated_debug);\n   AddAlias(\"--debug=\", { \"--inspect-port\", \"--debug\" });\n \n-  AddOption(\"--inspect-brk\", &DebugOptions::break_first_line,\n+  AddOption(\"--inspect-brk\",\n+            \"activate inspector on host:port and break at start of user script\",\n+            &DebugOptions::break_first_line,\n             kAllowedInEnvironment);\n   Implies(\"--inspect-brk\", \"--inspect\");\n   AddAlias(\"--inspect-brk=\", { \"--inspect-port\", \"--inspect-brk\" });\n \n-  AddOption(\"--inspect-brk-node\", &DebugOptions::break_node_first_line);\n+  AddOption(\"--inspect-brk-node\", \"\", &DebugOptions::break_node_first_line);\n   Implies(\"--inspect-brk-node\", \"--inspect\");\n   AddAlias(\"--inspect-brk-node=\", { \"--inspect-port\", \"--inspect-brk-node\" });\n \n-  AddOption(\"--debug-brk\", &DebugOptions::break_first_line);\n+  AddOption(\"--debug-brk\", \"\", &DebugOptions::break_first_line);\n   Implies(\"--debug-brk\", \"--debug\");\n   AddAlias(\"--debug-brk=\", { \"--inspect-port\", \"--debug-brk\" });\n }\n \n DebugOptionsParser DebugOptionsParser::instance;\n \n EnvironmentOptionsParser::EnvironmentOptionsParser() {\n-  AddOption(\"--experimental-modules\", &EnvironmentOptions::experimental_modules,\n+  AddOption(\"--experimental-modules\",\n+            \"experimental ES Module support and caching modules\",\n+            &EnvironmentOptions::experimental_modules,\n             kAllowedInEnvironment);\n   AddOption(\"--experimental-repl-await\",\n+            \"experimental await keyword support in REPL\",\n             &EnvironmentOptions::experimental_repl_await,\n             kAllowedInEnvironment);\n   AddOption(\"--experimental-vm-modules\",\n+            \"experimental ES Module support in vm module\",\n             &EnvironmentOptions::experimental_vm_modules,\n             kAllowedInEnvironment);\n-  AddOption(\"--experimental-worker\", &EnvironmentOptions::experimental_worker,\n+  AddOption(\"--experimental-worker\",\n+            \"experimental threaded Worker support\",\n+            &EnvironmentOptions::experimental_worker,\n             kAllowedInEnvironment);\n-  AddOption(\"--expose-internals\", &EnvironmentOptions::expose_internals);\n+  AddOption(\"--expose-internals\", \"\", &EnvironmentOptions::expose_internals);\n   // TODO(addaleax): Remove this when adding -/_ canonicalization to the parser.\n   AddAlias(\"--expose_internals\", \"--expose-internals\");\n-  AddOption(\"--loader\", &EnvironmentOptions::userland_loader,\n+  AddOption(\"--loader\",\n+            \"(with --experimental-modules) use the specified file as a \"\n+            \"custom loader\",\n+            &EnvironmentOptions::userland_loader,\n             kAllowedInEnvironment);\n-  AddOption(\"--no-deprecation\", &EnvironmentOptions::no_deprecation,\n+  AddOption(\"--no-deprecation\",\n+            \"silence deprecation warnings\",\n+            &EnvironmentOptions::no_deprecation,\n             kAllowedInEnvironment);\n   AddOption(\"--no-force-async-hooks-checks\",\n+            \"disable checks for async_hooks\",\n             &EnvironmentOptions::no_force_async_hooks_checks,\n             kAllowedInEnvironment);\n-  AddOption(\"--no-warnings\", &EnvironmentOptions::no_warnings,\n+  AddOption(\"--no-warnings\",\n+            \"silence all process warnings\",\n+            &EnvironmentOptions::no_warnings,\n             kAllowedInEnvironment);\n-  AddOption(\"--pending-deprecation\", &EnvironmentOptions::pending_deprecation,\n+  AddOption(\"--pending-deprecation\",\n+            \"emit pending deprecation warnings\",\n+            &EnvironmentOptions::pending_deprecation,\n             kAllowedInEnvironment);\n-  AddOption(\"--preserve-symlinks\", &EnvironmentOptions::preserve_symlinks);\n+  AddOption(\"--preserve-symlinks\",\n+            \"preserve symbolic links when resolving\",\n+            &EnvironmentOptions::preserve_symlinks);\n   AddOption(\"--preserve-symlinks-main\",\n+            \"preserve symbolic links when resolving the main module\",\n             &EnvironmentOptions::preserve_symlinks_main);\n-  AddOption(\"--prof-process\", &EnvironmentOptions::prof_process);\n-  AddOption(\"--redirect-warnings\", &EnvironmentOptions::redirect_warnings,\n+  AddOption(\"--prof-process\",\n+            \"process V8 profiler output generated using --prof\",\n+            &EnvironmentOptions::prof_process);\n+  AddOption(\"--redirect-warnings\",\n+            \"write warnings to file instead of stderr\",\n+            &EnvironmentOptions::redirect_warnings,\n             kAllowedInEnvironment);\n-  AddOption(\"--throw-deprecation\", &EnvironmentOptions::throw_deprecation,\n+  AddOption(\"--throw-deprecation\",\n+            \"throw an exception on deprecations\",\n+            &EnvironmentOptions::throw_deprecation,\n             kAllowedInEnvironment);\n-  AddOption(\"--trace-deprecation\", &EnvironmentOptions::trace_deprecation,\n+  AddOption(\"--trace-deprecation\",\n+            \"show stack traces on deprecations\",\n+            &EnvironmentOptions::trace_deprecation,\n             kAllowedInEnvironment);\n-  AddOption(\"--trace-sync-io\", &EnvironmentOptions::trace_sync_io,\n+  AddOption(\"--trace-sync-io\",\n+            \"show stack trace when use of sync IO is detected after the \"\n+            \"first tick\",\n+            &EnvironmentOptions::trace_sync_io,\n             kAllowedInEnvironment);\n-  AddOption(\"--trace-warnings\", &EnvironmentOptions::trace_warnings,\n+  AddOption(\"--trace-warnings\",\n+            \"show stack traces on process warnings\",\n+            &EnvironmentOptions::trace_warnings,\n             kAllowedInEnvironment);\n \n-  AddOption(\"--check\", &EnvironmentOptions::syntax_check_only);\n+  AddOption(\"--check\",\n+            \"syntax check script without executing\",\n+            &EnvironmentOptions::syntax_check_only);\n   AddAlias(\"-c\", \"--check\");\n   // This option is only so that we can tell --eval with an empty string from\n   // no eval at all. Having it not start with a dash makes it inaccessible\n   // from the parser itself, but available for using Implies().\n   // TODO(addaleax): When moving --help over to something generated from the\n   // programmatic descriptions, this will need some special care.\n   // (See also [ssl_openssl_cert_store] below.)\n-  AddOption(\"[has_eval_string]\", &EnvironmentOptions::has_eval_string);\n-  AddOption(\"--eval\", &EnvironmentOptions::eval_string);\n+  AddOption(\"[has_eval_string]\", \"\", &EnvironmentOptions::has_eval_string);\n+  AddOption(\"--eval\", \"evaluate script\", &EnvironmentOptions::eval_string);\n   Implies(\"--eval\", \"[has_eval_string]\");\n-  AddOption(\"--print\", &EnvironmentOptions::print_eval);\n+  AddOption(\"--print\",\n+            \"evaluate script and print result\",\n+            &EnvironmentOptions::print_eval);\n   AddAlias(\"-e\", \"--eval\");\n   AddAlias(\"--print <arg>\", \"-pe\");\n   AddAlias(\"-pe\", { \"--print\", \"--eval\" });\n   AddAlias(\"-p\", \"--print\");\n-  AddOption(\"--require\", &EnvironmentOptions::preload_modules,\n+  AddOption(\"--require\",\n+            \"module to preload (option can be repeated)\",\n+            &EnvironmentOptions::preload_modules,\n             kAllowedInEnvironment);\n   AddAlias(\"-r\", \"--require\");\n-  AddOption(\"--interactive\", &EnvironmentOptions::force_repl);\n+  AddOption(\"--interactive\",\n+            \"always enter the REPL even if stdin does not appear \"\n+            \"to be a terminal\",\n+            &EnvironmentOptions::force_repl);\n   AddAlias(\"-i\", \"--interactive\");\n \n-  AddOption(\"--napi-modules\", NoOp {}, kAllowedInEnvironment);\n+  AddOption(\"--napi-modules\", \"\", NoOp{}, kAllowedInEnvironment);\n \n   Insert(&DebugOptionsParser::instance,\n          &EnvironmentOptions::get_debug_options);\n@@ -102,16 +168,21 @@ EnvironmentOptionsParser::EnvironmentOptionsParser() {\n EnvironmentOptionsParser EnvironmentOptionsParser::instance;\n \n PerIsolateOptionsParser::PerIsolateOptionsParser() {\n-  AddOption(\"--track-heap-objects\", &PerIsolateOptions::track_heap_objects,\n+  AddOption(\"--track-heap-objects\",\n+            \"track heap object allocations for heap snapshots\",\n+            &PerIsolateOptions::track_heap_objects,\n             kAllowedInEnvironment);\n \n   // Explicitly add some V8 flags to mark them as allowed in NODE_OPTIONS.\n-  AddOption(\"--abort_on_uncaught_exception\", V8Option {},\n+  AddOption(\"--abort_on_uncaught_exception\",\n+            \"aborting instead of exiting causes a core file to be generated \"\n+            \"for analysis\",\n+            V8Option{},\n             kAllowedInEnvironment);\n-  AddOption(\"--max_old_space_size\", V8Option {}, kAllowedInEnvironment);\n-  AddOption(\"--perf_basic_prof\", V8Option {}, kAllowedInEnvironment);\n-  AddOption(\"--perf_prof\", V8Option {}, kAllowedInEnvironment);\n-  AddOption(\"--stack_trace_limit\", V8Option {}, kAllowedInEnvironment);\n+  AddOption(\"--max_old_space_size\", \"\", V8Option{}, kAllowedInEnvironment);\n+  AddOption(\"--perf_basic_prof\", \"\", V8Option{}, kAllowedInEnvironment);\n+  AddOption(\"--perf_prof\", \"\", V8Option{}, kAllowedInEnvironment);\n+  AddOption(\"--stack_trace_limit\", \"\", V8Option{}, kAllowedInEnvironment);\n \n   Insert(&EnvironmentOptionsParser::instance,\n          &PerIsolateOptions::get_per_env_options);\n@@ -120,52 +191,89 @@ PerIsolateOptionsParser::PerIsolateOptionsParser() {\n PerIsolateOptionsParser PerIsolateOptionsParser::instance;\n \n PerProcessOptionsParser::PerProcessOptionsParser() {\n-  AddOption(\"--title\", &PerProcessOptions::title, kAllowedInEnvironment);\n+  AddOption(\"--title\",\n+            \"the process title to use on startup\",\n+            &PerProcessOptions::title,\n+            kAllowedInEnvironment);\n   AddOption(\"--trace-event-categories\",\n+            \"comma separated list of trace event categories to record\",\n             &PerProcessOptions::trace_event_categories,\n             kAllowedInEnvironment);\n   AddOption(\"--trace-event-file-pattern\",\n+            \"Template string specifying the filepath for the trace-events \"\n+            \"data, it supports ${rotation} and ${pid} log-rotation id. %2$u \"\n+            \"is the pid.\",\n             &PerProcessOptions::trace_event_file_pattern,\n             kAllowedInEnvironment);\n   AddAlias(\"--trace-events-enabled\", {\n     \"--trace-event-categories\", \"v8,node,node.async_hooks\" });\n-  AddOption(\"--v8-pool-size\", &PerProcessOptions::v8_thread_pool_size,\n+  AddOption(\"--v8-pool-size\",\n+            \"set V8's thread pool size\",\n+            &PerProcessOptions::v8_thread_pool_size,\n             kAllowedInEnvironment);\n-  AddOption(\"--zero-fill-buffers\", &PerProcessOptions::zero_fill_all_buffers,\n+  AddOption(\"--zero-fill-buffers\",\n+            \"automatically zero-fill all newly allocated Buffer and \"\n+            \"SlowBuffer instances\",\n+            &PerProcessOptions::zero_fill_all_buffers,\n             kAllowedInEnvironment);\n \n-  AddOption(\"--security-reverts\", &PerProcessOptions::security_reverts);\n-  AddOption(\"--help\", &PerProcessOptions::print_help);\n+  AddOption(\"--security-reverts\", \"\", &PerProcessOptions::security_reverts);\n+  AddOption(\"--help\",\n+            \"print node command line options\",\n+            &PerProcessOptions::print_help);\n   AddAlias(\"-h\", \"--help\");\n-  AddOption(\"--version\", &PerProcessOptions::print_version);\n+  AddOption(\n+      \"--version\", \"print Node.js version\", &PerProcessOptions::print_version);\n   AddAlias(\"-v\", \"--version\");\n-  AddOption(\"--v8-options\", &PerProcessOptions::print_v8_help);\n+  AddOption(\"--v8-options\",\n+            \"print V8 command line options\",\n+            &PerProcessOptions::print_v8_help);\n \n #ifdef NODE_HAVE_I18N_SUPPORT\n-  AddOption(\"--icu-data-dir\", &PerProcessOptions::icu_data_dir,\n+  AddOption(\"--icu-data-dir\",\n+            \"set ICU data load path to dir (overrides NODE_ICU_DATA)\"\n+#ifndef NODE_HAVE_SMALL_ICU\n+            \" (note: linked-in ICU data is present)\\n\"\n+#endif\n+            ,\n+            &PerProcessOptions::icu_data_dir,\n             kAllowedInEnvironment);\n #endif\n \n #if HAVE_OPENSSL\n-  AddOption(\"--openssl-config\", &PerProcessOptions::openssl_config,\n+  AddOption(\"--openssl-config\",\n+            \"load OpenSSL configuration from the specified file \"\n+            \"(overrides OPENSSL_CONF)\",\n+            &PerProcessOptions::openssl_config,\n             kAllowedInEnvironment);\n-  AddOption(\"--tls-cipher-list\", &PerProcessOptions::tls_cipher_list,\n+  AddOption(\"--tls-cipher-list\",\n+            \"use an alternative default TLS cipher list\",\n+            &PerProcessOptions::tls_cipher_list,\n             kAllowedInEnvironment);\n-  AddOption(\"--use-openssl-ca\", &PerProcessOptions::use_openssl_ca,\n+  AddOption(\"--use-openssl-ca\",\n+            \"use OpenSSL's default CA store\",\n+            &PerProcessOptions::use_openssl_ca,\n             kAllowedInEnvironment);\n-  AddOption(\"--use-bundled-ca\", &PerProcessOptions::use_bundled_ca,\n+  AddOption(\"--use-bundled-ca\",\n+            \"use bundled CA store\",\n+            &PerProcessOptions::use_bundled_ca,\n             kAllowedInEnvironment);\n   // Similar to [has_eval_string] above, except that the separation between\n   // this and use_openssl_ca only exists for option validation after parsing.\n   // This is not ideal.\n   AddOption(\"[ssl_openssl_cert_store]\",\n+            \"\",\n             &PerProcessOptions::ssl_openssl_cert_store);\n   Implies(\"--use-openssl-ca\", \"[ssl_openssl_cert_store]\");\n   ImpliesNot(\"--use-bundled-ca\", \"[ssl_openssl_cert_store]\");\n #if NODE_FIPS_MODE\n-  AddOption(\"--enable-fips\", &PerProcessOptions::enable_fips_crypto,\n+  AddOption(\"--enable-fips\",\n+            \"enable FIPS crypto at startup\",\n+            &PerProcessOptions::enable_fips_crypto,\n             kAllowedInEnvironment);\n-  AddOption(\"--force-fips\", &PerProcessOptions::force_fips_crypto,\n+  AddOption(\"--force-fips\",\n+            \"force FIPS crypto (cannot be disabled)\",\n+            &PerProcessOptions::force_fips_crypto,\n             kAllowedInEnvironment);\n #endif\n #endif\n@@ -216,4 +324,153 @@ HostPort SplitHostPort(const std::string& arg, std::string* error) {\n   return HostPort { RemoveBrackets(arg.substr(0, colon)),\n                     ParseAndValidatePort(arg.substr(colon + 1), error) };\n }\n+\n+// Usage: Either:\n+// - getOptions() to get all options + metadata or\n+// - getOptions(string) to get the value of a particular option\n+void GetOptions(const FunctionCallbackInfo<Value>& args) {\n+  Mutex::ScopedLock lock(per_process_opts_mutex);\n+  Environment* env = Environment::GetCurrent(args);\n+  Isolate* isolate = env->isolate();\n+  Local<Context> context = env->context();\n+\n+  // Temporarily act as if the current Environment's/IsolateData's options were\n+  // the default options, i.e. like they are the ones we'd access for global\n+  // options parsing, so that all options are available from the main parser.\n+  auto original_per_isolate = per_process_opts->per_isolate;\n+  per_process_opts->per_isolate = env->isolate_data()->options();\n+  auto original_per_env = per_process_opts->per_isolate->per_env;\n+  per_process_opts->per_isolate->per_env = env->options();\n+  OnScopeLeave on_scope_leave([&]() {\n+    per_process_opts->per_isolate->per_env = original_per_env;\n+    per_process_opts->per_isolate = original_per_isolate;\n+  });\n+\n+  const auto& parser = PerProcessOptionsParser::instance;\n+\n+  std::string filter;\n+  if (args[0]->IsString()) filter = *node::Utf8Value(isolate, args[0]);\n+\n+  Local<Map> options = Map::New(isolate);\n+  for (const auto& item : parser.options_) {\n+    if (!filter.empty() && item.first != filter) continue;\n+\n+    Local<Value> value;\n+    const auto& option_info = item.second;\n+    auto field = option_info.field;\n+    PerProcessOptions* opts = per_process_opts.get();\n+    switch (option_info.type) {\n+      case kNoOp:\n+      case kV8Option:\n+        value = Undefined(isolate);\n+        break;\n+      case kBoolean:\n+        value = Boolean::New(isolate, *parser.Lookup<bool>(field, opts));\n+        break;\n+      case kInteger:\n+        value = Number::New(isolate, *parser.Lookup<int64_t>(field, opts));\n+        break;\n+      case kString:\n+        if (!ToV8Value(context, *parser.Lookup<std::string>(field, opts))\n+                 .ToLocal(&value)) {\n+          return;\n+        }\n+        break;\n+      case kStringList:\n+        if (!ToV8Value(context,\n+                       *parser.Lookup<std::vector<std::string>>(field, opts))\n+                 .ToLocal(&value)) {\n+          return;\n+        }\n+        break;\n+      case kHostPort: {\n+        const HostPort& host_port = *parser.Lookup<HostPort>(field, opts);\n+        Local<Object> obj = Object::New(isolate);\n+        Local<Value> host;\n+        if (!ToV8Value(context, host_port.host_name).ToLocal(&host) ||\n+            obj->Set(context, env->host_string(), host).IsNothing() ||\n+            obj->Set(context,\n+                     env->port_string(),\n+                     Integer::New(isolate, host_port.port))\n+                .IsNothing()) {\n+          return;\n+        }\n+        value = obj;\n+        break;\n+      }\n+      default:\n+        UNREACHABLE();\n+    }\n+    CHECK(!value.IsEmpty());\n+\n+    if (!filter.empty()) {\n+      args.GetReturnValue().Set(value);\n+      return;\n+    }\n+\n+    Local<Value> name = ToV8Value(context, item.first).ToLocalChecked();\n+    Local<Object> info = Object::New(isolate);\n+    Local<Value> help_text;\n+    if (!ToV8Value(context, option_info.help_text).ToLocal(&help_text) ||\n+        !info->Set(context, env->help_text_string(), help_text)\n+             .FromMaybe(false) ||\n+        !info->Set(context,\n+                   env->env_var_settings_string(),\n+                   Integer::New(isolate,\n+                                static_cast<int>(option_info.env_setting)))\n+             .FromMaybe(false) ||\n+        !info->Set(context,\n+                   env->type_string(),\n+                   Integer::New(isolate, static_cast<int>(option_info.type)))\n+             .FromMaybe(false) ||\n+        info->Set(context, env->value_string(), value).IsNothing() ||\n+        options->Set(context, name, info).IsEmpty()) {\n+      return;\n+    }\n+  }\n+\n+  if (!filter.empty()) return;\n+\n+  Local<Value> aliases;\n+  if (!ToV8Value(context, parser.aliases_).ToLocal(&aliases)) return;\n+\n+  Local<Object> ret = Object::New(isolate);\n+  if (ret->Set(context, env->options_string(), options).IsNothing() ||\n+      ret->Set(context, env->aliases_string(), aliases).IsNothing()) {\n+    return;\n+  }\n+\n+  args.GetReturnValue().Set(ret);\n+}\n+\n+void Initialize(Local<Object> target,\n+                Local<Value> unused,\n+                Local<Context> context) {\n+  Environment* env = Environment::GetCurrent(context);\n+  Isolate* isolate = env->isolate();\n+  env->SetMethodNoSideEffect(target, \"getOptions\", GetOptions);\n+\n+  Local<Object> env_settings = Object::New(isolate);\n+  NODE_DEFINE_CONSTANT(env_settings, kAllowedInEnvironment);\n+  NODE_DEFINE_CONSTANT(env_settings, kDisallowedInEnvironment);\n+  target\n+      ->Set(\n+          context, FIXED_ONE_BYTE_STRING(isolate, \"envSettings\"), env_settings)\n+      .FromJust();\n+\n+  Local<Object> types = Object::New(isolate);\n+  NODE_DEFINE_CONSTANT(types, kNoOp);\n+  NODE_DEFINE_CONSTANT(types, kV8Option);\n+  NODE_DEFINE_CONSTANT(types, kBoolean);\n+  NODE_DEFINE_CONSTANT(types, kInteger);\n+  NODE_DEFINE_CONSTANT(types, kString);\n+  NODE_DEFINE_CONSTANT(types, kHostPort);\n+  NODE_DEFINE_CONSTANT(types, kStringList);\n+  target->Set(context, FIXED_ONE_BYTE_STRING(isolate, \"types\"), types)\n+      .FromJust();\n+}\n+\n+}  // namespace options_parser\n }  // namespace node\n+\n+NODE_MODULE_CONTEXT_AWARE_INTERNAL(options, node::options_parser::Initialize)"
        },
        {
            "sha": "7891d550ae3dadbd47c4e5a72a12affdd189ca58",
            "filename": "src/node_options.h",
            "status": "modified",
            "additions": 20,
            "deletions": 0,
            "changes": 20,
            "blob_url": "https://github.com/nodejs/node/blob/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode_options.h",
            "raw_url": "https://github.com/nodejs/node/raw/e812be4a55915575fc1afce739848026a48b781e/src%2Fnode_options.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_options.h?ref=e812be4a55915575fc1afce739848026a48b781e",
            "patch": "@@ -141,7 +141,10 @@ class PerProcessOptions {\n \n // The actual options parser, as opposed to the structs containing them:\n \n+namespace options_parser {\n+\n HostPort SplitHostPort(const std::string& arg, std::string* error);\n+void GetOptions(const v8::FunctionCallbackInfo<v8::Value>& args);\n \n enum OptionEnvvarSettings {\n   kAllowedInEnvironment,\n@@ -176,24 +179,31 @@ class OptionsParser {\n   // specified whether the option should be allowed from environment variable\n   // sources (i.e. NODE_OPTIONS).\n   void AddOption(const std::string& name,\n+                 const std::string& help_text,\n                  bool Options::* field,\n                  OptionEnvvarSettings env_setting = kDisallowedInEnvironment);\n   void AddOption(const std::string& name,\n+                 const std::string& help_text,\n                  int64_t Options::* field,\n                  OptionEnvvarSettings env_setting = kDisallowedInEnvironment);\n   void AddOption(const std::string& name,\n+                 const std::string& help_text,\n                  std::string Options::* field,\n                  OptionEnvvarSettings env_setting = kDisallowedInEnvironment);\n   void AddOption(const std::string& name,\n+                 const std::string& help_text,\n                  std::vector<std::string> Options::* field,\n                  OptionEnvvarSettings env_setting = kDisallowedInEnvironment);\n   void AddOption(const std::string& name,\n+                 const std::string& help_text,\n                  HostPort Options::* field,\n                  OptionEnvvarSettings env_setting = kDisallowedInEnvironment);\n   void AddOption(const std::string& name,\n+                 const std::string& help_text,\n                  NoOp no_op_tag,\n                  OptionEnvvarSettings env_setting = kDisallowedInEnvironment);\n   void AddOption(const std::string& name,\n+                 const std::string& help_text,\n                  V8Option v8_option_tag,\n                  OptionEnvvarSettings env_setting = kDisallowedInEnvironment);\n \n@@ -281,6 +291,12 @@ class OptionsParser {\n     T Options::* field_;\n   };\n \n+  template <typename T>\n+  inline T* Lookup(std::shared_ptr<BaseOptionField> field,\n+                   Options* options) const {\n+    return std::static_pointer_cast<OptionField<T>>(field)->Lookup(options);\n+  }\n+\n   // An option consists of:\n   // - A type.\n   // - A way to store/access the property value.\n@@ -289,6 +305,7 @@ class OptionsParser {\n     OptionType type;\n     std::shared_ptr<BaseOptionField> field;\n     OptionEnvvarSettings env_setting;\n+    std::string help_text;\n   };\n \n   // An implied option is composed of the information on where to store a\n@@ -319,6 +336,8 @@ class OptionsParser {\n \n   template <typename OtherOptions>\n   friend class OptionsParser;\n+\n+  friend void GetOptions(const v8::FunctionCallbackInfo<v8::Value>& args);\n };\n \n class DebugOptionsParser : public OptionsParser<DebugOptions> {\n@@ -349,6 +368,7 @@ class PerProcessOptionsParser : public OptionsParser<PerProcessOptions> {\n   static PerProcessOptionsParser instance;\n };\n \n+}  // namespace options_parser\n }  // namespace node\n \n #endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS"
        },
        {
            "sha": "bbee32615ff729db598508681f50c697c561aaa1",
            "filename": "src/util-inl.h",
            "status": "modified",
            "additions": 58,
            "deletions": 1,
            "changes": 59,
            "blob_url": "https://github.com/nodejs/node/blob/e812be4a55915575fc1afce739848026a48b781e/src%2Futil-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/e812be4a55915575fc1afce739848026a48b781e/src%2Futil-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Futil-inl.h?ref=e812be4a55915575fc1afce739848026a48b781e",
            "patch": "@@ -24,8 +24,9 @@\n \n #if defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS\n \n-#include \"util.h\"\n+#include <limits.h>  // INT_MAX\n #include <cstring>\n+#include \"util.h\"\n \n #if defined(_MSC_VER)\n #include <intrin.h>\n@@ -397,6 +398,62 @@ inline char* Calloc(size_t n) { return Calloc<char>(n); }\n inline char* UncheckedMalloc(size_t n) { return UncheckedMalloc<char>(n); }\n inline char* UncheckedCalloc(size_t n) { return UncheckedCalloc<char>(n); }\n \n+// This is a helper in the .cc file so including util-inl.h doesn't include more\n+// headers than we really need to.\n+void ThrowErrStringTooLong(v8::Isolate* isolate);\n+\n+v8::MaybeLocal<v8::Value> ToV8Value(v8::Local<v8::Context> context,\n+                                    const std::string& str) {\n+  v8::Isolate* isolate = context->GetIsolate();\n+  if (UNLIKELY(str.size() >= static_cast<size_t>(v8::String::kMaxLength))) {\n+    // V8 only has a TODO comment about adding an exception when the maximum\n+    // string size is exceeded.\n+    ThrowErrStringTooLong(isolate);\n+    return v8::MaybeLocal<v8::Value>();\n+  }\n+\n+  return v8::String::NewFromUtf8(\n+             isolate, str.data(), v8::NewStringType::kNormal, str.size())\n+      .FromMaybe(v8::Local<v8::String>());\n+}\n+\n+template <typename T>\n+v8::MaybeLocal<v8::Value> ToV8Value(v8::Local<v8::Context> context,\n+                                    const std::vector<T>& vec) {\n+  v8::Isolate* isolate = context->GetIsolate();\n+  v8::EscapableHandleScope handle_scope(isolate);\n+\n+  v8::Local<v8::Array> arr = v8::Array::New(isolate, vec.size());\n+  for (size_t i = 0; i < vec.size(); ++i) {\n+    v8::Local<v8::Value> val;\n+    if (!ToV8Value(context, vec[i]).ToLocal(&val) ||\n+        arr->Set(context, i, val).IsNothing()) {\n+      return v8::MaybeLocal<v8::Value>();\n+    }\n+  }\n+\n+  return handle_scope.Escape(arr);\n+}\n+\n+template <typename T, typename U>\n+v8::MaybeLocal<v8::Value> ToV8Value(v8::Local<v8::Context> context,\n+                                    const std::unordered_map<T, U>& map) {\n+  v8::Isolate* isolate = context->GetIsolate();\n+  v8::EscapableHandleScope handle_scope(isolate);\n+\n+  v8::Local<v8::Map> ret = v8::Map::New(isolate);\n+  for (const auto& item : map) {\n+    v8::Local<v8::Value> first, second;\n+    if (!ToV8Value(context, item.first).ToLocal(&first) ||\n+        !ToV8Value(context, item.second).ToLocal(&second) ||\n+        ret->Set(context, first, second).IsEmpty()) {\n+      return v8::MaybeLocal<v8::Value>();\n+    }\n+  }\n+\n+  return handle_scope.Escape(ret);\n+}\n+\n }  // namespace node\n \n #endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS"
        },
        {
            "sha": "e1a846f74dc1b317a1c492ba1a871a59abb305ce",
            "filename": "src/util.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 3,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/e812be4a55915575fc1afce739848026a48b781e/src%2Futil.cc",
            "raw_url": "https://github.com/nodejs/node/raw/e812be4a55915575fc1afce739848026a48b781e/src%2Futil.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Futil.cc?ref=e812be4a55915575fc1afce739848026a48b781e",
            "patch": "@@ -19,12 +19,13 @@\n // OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n // USE OR OTHER DEALINGS IN THE SOFTWARE.\n \n-#include \"string_bytes.h\"\n+#include <stdio.h>\n+#include <sstream>\n #include \"node_buffer.h\"\n+#include \"node_errors.h\"\n #include \"node_internals.h\"\n+#include \"string_bytes.h\"\n #include \"uv.h\"\n-#include <stdio.h>\n-#include <sstream>\n \n namespace node {\n \n@@ -133,4 +134,8 @@ std::set<std::string> ParseCommaSeparatedSet(const std::string& in) {\n   return out;\n }\n \n+void ThrowErrStringTooLong(v8::Isolate* isolate) {\n+  isolate->ThrowException(ERR_STRING_TOO_LONG(isolate));\n+}\n+\n }  // namespace node"
        },
        {
            "sha": "057346a2d04fca392a1d8d9a564595f0c3b03859",
            "filename": "src/util.h",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/nodejs/node/blob/e812be4a55915575fc1afce739848026a48b781e/src%2Futil.h",
            "raw_url": "https://github.com/nodejs/node/raw/e812be4a55915575fc1afce739848026a48b781e/src%2Futil.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Futil.h?ref=e812be4a55915575fc1afce739848026a48b781e",
            "patch": "@@ -34,9 +34,10 @@\n #include <stdlib.h>\n #include <string.h>\n \n-#include <string>\n #include <functional>  // std::function\n #include <set>\n+#include <string>\n+#include <unordered_map>\n \n namespace node {\n \n@@ -479,6 +480,15 @@ using DeleteFnPtr = typename FunctionDeleter<T, function>::Pointer;\n \n std::set<std::string> ParseCommaSeparatedSet(const std::string& in);\n \n+inline v8::MaybeLocal<v8::Value> ToV8Value(v8::Local<v8::Context> context,\n+                                           const std::string& str);\n+template <typename T>\n+inline v8::MaybeLocal<v8::Value> ToV8Value(v8::Local<v8::Context> context,\n+                                           const std::vector<T>& vec);\n+template <typename T, typename U>\n+inline v8::MaybeLocal<v8::Value> ToV8Value(v8::Local<v8::Context> context,\n+                                           const std::unordered_map<T, U>& map);\n+\n }  // namespace node\n \n #endif  // defined(NODE_WANT_INTERNALS) && NODE_WANT_INTERNALS"
        }
    ],
    "stats": {
        "total": 577,
        "additions": 476,
        "deletions": 101
    }
}