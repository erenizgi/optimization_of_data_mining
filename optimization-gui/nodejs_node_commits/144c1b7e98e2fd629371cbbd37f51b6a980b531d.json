{
    "author": "maclover7",
    "message": "zlib: instance-ify two methods\n\nBoth `Params` and `SetDictionary` take `ZCtx` as an arg, so just make\nthem both instance methods on `ZCtx`.\n\nPR-URL: https://github.com/nodejs/node/pull/21702\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Tiancheng \"Timothy\" Gu <timothygu99@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Franziska Hinkelmann <franziska.hinkelmann@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "144c1b7e98e2fd629371cbbd37f51b6a980b531d",
    "files": [
        {
            "sha": "169816d16f48b634b8bf87ef1e47cef48e0bbfa5",
            "filename": "src/node_zlib.cc",
            "status": "modified",
            "additions": 18,
            "deletions": 22,
            "changes": 40,
            "blob_url": "https://github.com/nodejs/node/blob/144c1b7e98e2fd629371cbbd37f51b6a980b531d/src%2Fnode_zlib.cc",
            "raw_url": "https://github.com/nodejs/node/raw/144c1b7e98e2fd629371cbbd37f51b6a980b531d/src%2Fnode_zlib.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_zlib.cc?ref=144c1b7e98e2fd629371cbbd37f51b6a980b531d",
            "patch": "@@ -486,7 +486,7 @@ class ZCtx : public AsyncWrap, public ThreadPoolWork {\n                     write_js_callback, dictionary, dictionary_len);\n     if (!ret) goto end;\n \n-    SetDictionary(ctx);\n+    ctx->SetDictionary();\n \n    end:\n     return args.GetReturnValue().Set(ret);\n@@ -496,14 +496,14 @@ class ZCtx : public AsyncWrap, public ThreadPoolWork {\n     CHECK(args.Length() == 2 && \"params(level, strategy)\");\n     ZCtx* ctx;\n     ASSIGN_OR_RETURN_UNWRAP(&ctx, args.Holder());\n-    Params(ctx, args[0]->Int32Value(), args[1]->Int32Value());\n+    ctx->Params(args[0]->Int32Value(), args[1]->Int32Value());\n   }\n \n   static void Reset(const FunctionCallbackInfo<Value> &args) {\n     ZCtx* ctx;\n     ASSIGN_OR_RETURN_UNWRAP(&ctx, args.Holder());\n     ctx->Reset();\n-    SetDictionary(ctx);\n+    ctx->SetDictionary();\n   }\n \n   static bool Init(ZCtx* ctx, int level, int windowBits, int memLevel,\n@@ -577,51 +577,47 @@ class ZCtx : public AsyncWrap, public ThreadPoolWork {\n     return true;\n   }\n \n-  static void SetDictionary(ZCtx* ctx) {\n-    if (ctx->dictionary_ == nullptr)\n+  void SetDictionary() {\n+    if (dictionary_ == nullptr)\n       return;\n \n-    ctx->err_ = Z_OK;\n+    err_ = Z_OK;\n \n-    switch (ctx->mode_) {\n+    switch (mode_) {\n       case DEFLATE:\n       case DEFLATERAW:\n-        ctx->err_ = deflateSetDictionary(&ctx->strm_,\n-                                         ctx->dictionary_,\n-                                         ctx->dictionary_len_);\n+        err_ = deflateSetDictionary(&strm_, dictionary_, dictionary_len_);\n         break;\n       case INFLATERAW:\n         // The other inflate cases will have the dictionary set when inflate()\n         // returns Z_NEED_DICT in Process()\n-        ctx->err_ = inflateSetDictionary(&ctx->strm_,\n-                                         ctx->dictionary_,\n-                                         ctx->dictionary_len_);\n+        err_ = inflateSetDictionary(&strm_, dictionary_, dictionary_len_);\n         break;\n       default:\n         break;\n     }\n \n-    if (ctx->err_ != Z_OK) {\n-      ctx->Error(\"Failed to set dictionary\");\n+    if (err_ != Z_OK) {\n+      Error(\"Failed to set dictionary\");\n     }\n   }\n \n-  static void Params(ZCtx* ctx, int level, int strategy) {\n-    AllocScope alloc_scope(ctx);\n+  void Params(int level, int strategy) {\n+    AllocScope alloc_scope(this);\n \n-    ctx->err_ = Z_OK;\n+    err_ = Z_OK;\n \n-    switch (ctx->mode_) {\n+    switch (mode_) {\n       case DEFLATE:\n       case DEFLATERAW:\n-        ctx->err_ = deflateParams(&ctx->strm_, level, strategy);\n+        err_ = deflateParams(&strm_, level, strategy);\n         break;\n       default:\n         break;\n     }\n \n-    if (ctx->err_ != Z_OK && ctx->err_ != Z_BUF_ERROR) {\n-      ctx->Error(\"Failed to set parameters\");\n+    if (err_ != Z_OK && err_ != Z_BUF_ERROR) {\n+      Error(\"Failed to set parameters\");\n     }\n   }\n "
        }
    ],
    "stats": {
        "total": 40,
        "additions": 18,
        "deletions": 22
    }
}