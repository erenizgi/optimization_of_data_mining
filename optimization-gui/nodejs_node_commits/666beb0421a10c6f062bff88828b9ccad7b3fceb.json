{
    "author": "sam-github",
    "message": "tls: renegotiate should take care of its own state\n\nIn the initial version of this test there were two zero-length writes to\nforce tls state to cycle. The second is not necessary, at least not now,\nbut the first was. The renegotiate() API should ensure that packet\nexchange takes place, not its users, so move the zero-length write into\ntls.\n\nSee: https://github.com/nodejs/node/pull/14239\nSee: https://github.com/nodejs/node/commit/b1909d3a70f9\n\nPR-URL: https://github.com/nodejs/node/pull/25997\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "666beb0421a10c6f062bff88828b9ccad7b3fceb",
    "files": [
        {
            "sha": "eaf937640ed08881792e11a930fdd7cb4a4707e7",
            "filename": "lib/_tls_wrap.js",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/666beb0421a10c6f062bff88828b9ccad7b3fceb/lib%2F_tls_wrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/666beb0421a10c6f062bff88828b9ccad7b3fceb/lib%2F_tls_wrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_tls_wrap.js?ref=666beb0421a10c6f062bff88828b9ccad7b3fceb",
            "patch": "@@ -621,6 +621,9 @@ TLSSocket.prototype.renegotiate = function(options, callback) {\n     this._requestCert = requestCert;\n     this._rejectUnauthorized = rejectUnauthorized;\n   }\n+  // Ensure that we'll cycle through internal openssl's state\n+  this.write('');\n+\n   if (!this._handle.renegotiate()) {\n     if (callback) {\n       process.nextTick(callback, new ERR_TLS_RENEGOTIATE());"
        },
        {
            "sha": "13e08112e596d66a60225fc810af1ff6b60aed9f",
            "filename": "test/parallel/test-tls-disable-renegotiation.js",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/666beb0421a10c6f062bff88828b9ccad7b3fceb/test%2Fparallel%2Ftest-tls-disable-renegotiation.js",
            "raw_url": "https://github.com/nodejs/node/raw/666beb0421a10c6f062bff88828b9ccad7b3fceb/test%2Fparallel%2Ftest-tls-disable-renegotiation.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-tls-disable-renegotiation.js?ref=666beb0421a10c6f062bff88828b9ccad7b3fceb",
            "patch": "@@ -46,7 +46,6 @@ server.listen(0, common.mustCall(() => {\n     port\n   };\n   const client = tls.connect(options, common.mustCall(() => {\n-    client.write('');\n \n     common.expectsError(() => client.renegotiate(), {\n       code: 'ERR_INVALID_ARG_TYPE',\n@@ -78,7 +77,6 @@ server.listen(0, common.mustCall(() => {\n       // data event on the server. After that data\n       // is received, disableRenegotiation is called.\n       client.write('data', common.mustCall(() => {\n-        client.write('');\n         // This second renegotiation attempt should fail\n         // and the callback should never be invoked. The\n         // server will simply drop the connection after"
        }
    ],
    "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
    }
}