{
    "author": "cjihrig",
    "message": "inspector: return Error objects on error\n\nThe inspector communicates errors via POJOs. This commit\nwraps the error information in an actual Error object.\n\nPR-URL: https://github.com/nodejs/node/pull/26255\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Eugene Ostroukhov <eostroukhov@google.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "e3d4a7d9994ff7d1bd144779f8b91d8302112bc0",
    "files": [
        {
            "sha": "43cdd53bf0a4b891396dcb058d249c6e2f436bfb",
            "filename": "lib/inspector.js",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/nodejs/node/blob/e3d4a7d9994ff7d1bd144779f8b91d8302112bc0/lib%2Finspector.js",
            "raw_url": "https://github.com/nodejs/node/raw/e3d4a7d9994ff7d1bd144779f8b91d8302112bc0/lib%2Finspector.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2Finspector.js?ref=e3d4a7d9994ff7d1bd144779f8b91d8302112bc0",
            "patch": "@@ -3,6 +3,7 @@\n const {\n   ERR_INSPECTOR_ALREADY_CONNECTED,\n   ERR_INSPECTOR_CLOSED,\n+  ERR_INSPECTOR_COMMAND,\n   ERR_INSPECTOR_NOT_AVAILABLE,\n   ERR_INSPECTOR_NOT_CONNECTED,\n   ERR_INVALID_ARG_TYPE,\n@@ -48,8 +49,14 @@ class Session extends EventEmitter {\n       if (parsed.id) {\n         const callback = this[messageCallbacksSymbol].get(parsed.id);\n         this[messageCallbacksSymbol].delete(parsed.id);\n-        if (callback)\n-          callback(parsed.error || null, parsed.result || null);\n+        if (callback) {\n+          if (parsed.error) {\n+            return callback(new ERR_INSPECTOR_COMMAND(parsed.error.code,\n+                                                      parsed.error.message));\n+          }\n+\n+          callback(null, parsed.result);\n+        }\n       } else {\n         this.emit(parsed.method, parsed);\n         this.emit('inspectorNotification', parsed);"
        },
        {
            "sha": "79c746540bda5bde3ce32dc33ccd7d6bc52902ed",
            "filename": "test/sequential/test-inspector-runtime-evaluate-with-timeout.js",
            "status": "modified",
            "additions": 11,
            "deletions": 6,
            "changes": 17,
            "blob_url": "https://github.com/nodejs/node/blob/e3d4a7d9994ff7d1bd144779f8b91d8302112bc0/test%2Fsequential%2Ftest-inspector-runtime-evaluate-with-timeout.js",
            "raw_url": "https://github.com/nodejs/node/raw/e3d4a7d9994ff7d1bd144779f8b91d8302112bc0/test%2Fsequential%2Ftest-inspector-runtime-evaluate-with-timeout.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fsequential%2Ftest-inspector-runtime-evaluate-with-timeout.js?ref=e3d4a7d9994ff7d1bd144779f8b91d8302112bc0",
            "patch": "@@ -5,17 +5,22 @@ const common = require('../common');\n common.skipIfInspectorDisabled();\n \n (async function test() {\n-  const { strictEqual } = require('assert');\n+  const assert = require('assert');\n   const { Session } = require('inspector');\n   const { promisify } = require('util');\n \n   const session = new Session();\n   session.connect();\n   session.post = promisify(session.post);\n-  const result = await session.post('Runtime.evaluate', {\n-    expression: 'for(;;);',\n-    timeout: 0\n-  }).catch((e) => e);\n-  strictEqual(result.message, 'Execution was terminated');\n+  await assert.rejects(\n+    session.post('Runtime.evaluate', {\n+      expression: 'for(;;);',\n+      timeout: 0\n+    }),\n+    {\n+      code: 'ERR_INSPECTOR_COMMAND',\n+      message: 'Inspector error -32000: Execution was terminated'\n+    }\n+  );\n   session.disconnect();\n })();"
        }
    ],
    "stats": {
        "total": 28,
        "additions": 20,
        "deletions": 8
    }
}