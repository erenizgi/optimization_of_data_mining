{
    "author": "targos",
    "message": "deps: cherry-pick ba752ea from upstream V8\n\nOriginal commit message:\n\n    [cpu-profiler] Use instruction start as the key for the CodeMap\n\n    Previously we used the start address of the AbstractCode object. This\n    doesn't make sense for off-heap builtins, where the code isn't contained\n    in the object itself. It also hides other potential problems - sometimes\n    the sample.pc is inside the AbstractCode object header - this is\n    never valid.\n\n    There were a few changes necessary to make this happen:\n      - Change the interface of CodeMoveEvent. Now 'to' and 'from' are both\n        AbstractCode objects, which is nice because many users were taking\n        'to' and adding the header offset to it to try and find the\n        instruction start address. This isn't valid for off-heap builtins.\n      - Fix a bug in CodeMap::MoveCode where we didn't update the CodeEntry\n        object to reflect the new instruction_start.\n      - Rename the 'start' field in all of the CodeEventRecord sub-classes\n        to make it clear that this is the address of the first instruction.\n      - Fix the confusion in RecordTickSample between 'tos' and 'pc' which\n        caused pc_offset to be calculated incorrectly.\n\n    Bug: v8:7983\n    Change-Id: I3e9dddf74e4b2e96a5f031d216ef7008d6f184d1\n    Reviewed-on: https://chromium-review.googlesource.com/1148457\n    Commit-Queue: Peter Marshall <petermarshall@chromium.org>\n    Reviewed-by: Jakob Gruber <jgruber@chromium.org>\n    Reviewed-by: Michael Lippautz <mlippautz@chromium.org>\n    Cr-Commit-Position: refs/heads/master@{#54749}\n\nRefs: https://github.com/v8/v8/commit/ba752ea4c50713dff1e94f45a79db3ba968a8d66\n\nPR-URL: https://github.com/nodejs/node/pull/21983\nReviewed-By: Refael Ackermann <refack@gmail.com>\nReviewed-By: Gus Caplan <me@gus.host>\nReviewed-By: Ujjwal Sharma <usharma1998@gmail.com>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>",
    "sha": "7766baf943a61843eaf706f349dd663218639e8c",
    "files": [
        {
            "sha": "8f91c9e0663d49e476347542f41cb1abf009b03e",
            "filename": "common.gypi",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/common.gypi",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/common.gypi",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/common.gypi?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -29,7 +29,7 @@\n \n     # Reset this number to 0 on major V8 upgrades.\n     # Increment by one for each non-official patch applied to deps/v8.\n-    'v8_embedder_string': '-node.5',\n+    'v8_embedder_string': '-node.6',\n \n     # Enable disassembler for `--print-code` v8 options\n     'v8_enable_disassembler': 1,"
        },
        {
            "sha": "ec07a2e107917bce4a3ea3d1f9973ef54f28a2f0",
            "filename": "deps/v8/src/code-events.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fcode-events.h",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fcode-events.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fcode-events.h?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -83,7 +83,7 @@ class CodeEventListener {\n   virtual void GetterCallbackEvent(Name* name, Address entry_point) = 0;\n   virtual void SetterCallbackEvent(Name* name, Address entry_point) = 0;\n   virtual void RegExpCodeCreateEvent(AbstractCode* code, String* source) = 0;\n-  virtual void CodeMoveEvent(AbstractCode* from, Address to) = 0;\n+  virtual void CodeMoveEvent(AbstractCode* from, AbstractCode* to) = 0;\n   virtual void SharedFunctionInfoMoveEvent(Address from, Address to) = 0;\n   virtual void CodeMovingGCEvent() = 0;\n   virtual void CodeDisableOptEvent(AbstractCode* code,\n@@ -154,7 +154,7 @@ class CodeEventDispatcher {\n   void RegExpCodeCreateEvent(AbstractCode* code, String* source) {\n     CODE_EVENT_DISPATCH(RegExpCodeCreateEvent(code, source));\n   }\n-  void CodeMoveEvent(AbstractCode* from, Address to) {\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to) {\n     CODE_EVENT_DISPATCH(CodeMoveEvent(from, to));\n   }\n   void SharedFunctionInfoMoveEvent(Address from, Address to) {"
        },
        {
            "sha": "af56c72418cf8064955b6789447c5818f2ccf4be",
            "filename": "deps/v8/src/heap/mark-compact.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fheap%2Fmark-compact.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fheap%2Fmark-compact.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fheap%2Fmark-compact.cc?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -1149,7 +1149,7 @@ class ProfilingMigrationObserver final : public MigrationObserver {\n                    int size) final {\n     if (dest == CODE_SPACE || (dest == OLD_SPACE && dst->IsBytecodeArray())) {\n       PROFILE(heap_->isolate(),\n-              CodeMoveEvent(AbstractCode::cast(src), dst->address()));\n+              CodeMoveEvent(AbstractCode::cast(src), AbstractCode::cast(dst)));\n     }\n     heap_->OnMoveEvent(dst, src, size);\n   }"
        },
        {
            "sha": "f19897b27b14e3cd96e4b8e91d729981cd09113d",
            "filename": "deps/v8/src/log.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 15,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Flog.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Flog.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Flog.cc?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -270,7 +270,7 @@ class PerfBasicLogger : public CodeEventLogger {\n   explicit PerfBasicLogger(Isolate* isolate);\n   ~PerfBasicLogger() override;\n \n-  void CodeMoveEvent(AbstractCode* from, Address to) override {}\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to) override {}\n   void CodeDisableOptEvent(AbstractCode* code,\n                            SharedFunctionInfo* shared) override {}\n \n@@ -496,7 +496,7 @@ class LowLevelLogger : public CodeEventLogger {\n   LowLevelLogger(Isolate* isolate, const char* file_name);\n   ~LowLevelLogger() override;\n \n-  void CodeMoveEvent(AbstractCode* from, Address to) override;\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to) override;\n   void CodeDisableOptEvent(AbstractCode* code,\n                            SharedFunctionInfo* shared) override {}\n   void SnapshotPositionEvent(HeapObject* obj, int pos);\n@@ -615,11 +615,10 @@ void LowLevelLogger::LogRecordedBuffer(const wasm::WasmCode* code,\n                 code->instructions().length());\n }\n \n-void LowLevelLogger::CodeMoveEvent(AbstractCode* from, Address to) {\n+void LowLevelLogger::CodeMoveEvent(AbstractCode* from, AbstractCode* to) {\n   CodeMoveStruct event;\n   event.from_address = from->InstructionStart();\n-  size_t header_size = from->InstructionStart() - from->address();\n-  event.to_address = to + header_size;\n+  event.to_address = to->InstructionStart();\n   LogWriteStruct(event);\n }\n \n@@ -641,7 +640,7 @@ class JitLogger : public CodeEventLogger {\n  public:\n   JitLogger(Isolate* isolate, JitCodeEventHandler code_event_handler);\n \n-  void CodeMoveEvent(AbstractCode* from, Address to) override;\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to) override;\n   void CodeDisableOptEvent(AbstractCode* code,\n                            SharedFunctionInfo* shared) override {}\n   void AddCodeLinePosInfoEvent(void* jit_handler_data, int pc_offset,\n@@ -700,7 +699,7 @@ void JitLogger::LogRecordedBuffer(const wasm::WasmCode* code, const char* name,\n   code_event_handler_(&event);\n }\n \n-void JitLogger::CodeMoveEvent(AbstractCode* from, Address to) {\n+void JitLogger::CodeMoveEvent(AbstractCode* from, AbstractCode* to) {\n   base::LockGuard<base::Mutex> guard(&logger_mutex_);\n \n   JitCodeEvent event;\n@@ -709,12 +708,7 @@ void JitLogger::CodeMoveEvent(AbstractCode* from, Address to) {\n       from->IsCode() ? JitCodeEvent::JIT_CODE : JitCodeEvent::BYTE_CODE;\n   event.code_start = reinterpret_cast<void*>(from->InstructionStart());\n   event.code_len = from->InstructionSize();\n-\n-  // Calculate the header size.\n-  const size_t header_size = from->InstructionStart() - from->address();\n-\n-  // Calculate the new start address of the instructions.\n-  event.new_code_start = reinterpret_cast<void*>(to + header_size);\n+  event.new_code_start = reinterpret_cast<void*>(to->InstructionStart());\n   event.isolate = reinterpret_cast<v8::Isolate*>(isolate_);\n \n   code_event_handler_(&event);\n@@ -1431,9 +1425,10 @@ void Logger::RegExpCodeCreateEvent(AbstractCode* code, String* source) {\n   msg.WriteToLogFile();\n }\n \n-void Logger::CodeMoveEvent(AbstractCode* from, Address to) {\n+void Logger::CodeMoveEvent(AbstractCode* from, AbstractCode* to) {\n   if (!is_listening_to_code_events()) return;\n-  MoveEventInternal(CodeEventListener::CODE_MOVE_EVENT, from->address(), to);\n+  MoveEventInternal(CodeEventListener::CODE_MOVE_EVENT, from->address(),\n+                    to->address());\n }\n \n namespace {"
        },
        {
            "sha": "3bc54a5926d35cca6b1544c4f7fce52ae96bca95",
            "filename": "deps/v8/src/log.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Flog.h",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Flog.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Flog.h?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -222,7 +222,7 @@ class Logger : public CodeEventListener {\n   // Emits a code create event for a RegExp.\n   void RegExpCodeCreateEvent(AbstractCode* code, String* source);\n   // Emits a code move event.\n-  void CodeMoveEvent(AbstractCode* from, Address to);\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to);\n   // Emits a code line info record event.\n   void CodeLinePosInfoRecordEvent(Address code_start,\n                                   ByteArray* source_position_table);\n@@ -486,7 +486,7 @@ class ExternalCodeEventListener : public CodeEventListener {\n   void GetterCallbackEvent(Name* name, Address entry_point) override {}\n   void SetterCallbackEvent(Name* name, Address entry_point) override {}\n   void SharedFunctionInfoMoveEvent(Address from, Address to) override {}\n-  void CodeMoveEvent(AbstractCode* from, Address to) override {}\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to) override {}\n   void CodeDisableOptEvent(AbstractCode* code,\n                            SharedFunctionInfo* shared) override {}\n   void CodeMovingGCEvent() override {}"
        },
        {
            "sha": "f6b2cf401a719fd1696f1ac327bcf04b0800092a",
            "filename": "deps/v8/src/perf-jit.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fperf-jit.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fperf-jit.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fperf-jit.cc?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -420,7 +420,7 @@ void PerfJitLogger::LogWriteUnwindingInfo(Code* code) {\n   LogWriteBytes(padding_bytes, static_cast<int>(padding_size));\n }\n \n-void PerfJitLogger::CodeMoveEvent(AbstractCode* from, Address to) {\n+void PerfJitLogger::CodeMoveEvent(AbstractCode* from, AbstractCode* to) {\n   // We may receive a CodeMove event if a BytecodeArray object moves. Otherwise\n   // code relocation is not supported.\n   CHECK(from->IsBytecodeArray());"
        },
        {
            "sha": "3b11cf30c23a7027f356c4ab299f88a5efb8dcc9",
            "filename": "deps/v8/src/perf-jit.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fperf-jit.h",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fperf-jit.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fperf-jit.h?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -41,7 +41,7 @@ class PerfJitLogger : public CodeEventLogger {\n   explicit PerfJitLogger(Isolate* isolate);\n   virtual ~PerfJitLogger();\n \n-  void CodeMoveEvent(AbstractCode* from, Address to) override;\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to) override;\n   void CodeDisableOptEvent(AbstractCode* code,\n                            SharedFunctionInfo* shared) override {}\n \n@@ -120,7 +120,7 @@ class PerfJitLogger : public CodeEventLogger {\n  public:\n   explicit PerfJitLogger(Isolate* isolate) : CodeEventLogger(isolate) {}\n \n-  void CodeMoveEvent(AbstractCode* from, Address to) override {\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to) override {\n     UNIMPLEMENTED();\n   }\n "
        },
        {
            "sha": "9274bc03c66d860bb0754bf46f4692622861ed0c",
            "filename": "deps/v8/src/profiler/cpu-profiler-inl.h",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler-inl.h",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler-inl.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler-inl.h?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -16,25 +16,25 @@ namespace v8 {\n namespace internal {\n \n void CodeCreateEventRecord::UpdateCodeMap(CodeMap* code_map) {\n-  code_map->AddCode(start, entry, size);\n+  code_map->AddCode(instruction_start, entry, instruction_size);\n }\n \n \n void CodeMoveEventRecord::UpdateCodeMap(CodeMap* code_map) {\n-  code_map->MoveCode(from, to);\n+  code_map->MoveCode(from_instruction_start, to_instruction_start);\n }\n \n \n void CodeDisableOptEventRecord::UpdateCodeMap(CodeMap* code_map) {\n-  CodeEntry* entry = code_map->FindEntry(start);\n+  CodeEntry* entry = code_map->FindEntry(instruction_start);\n   if (entry != nullptr) {\n     entry->set_bailout_reason(bailout_reason);\n   }\n }\n \n \n void CodeDeoptEventRecord::UpdateCodeMap(CodeMap* code_map) {\n-  CodeEntry* entry = code_map->FindEntry(start);\n+  CodeEntry* entry = code_map->FindEntry(instruction_start);\n   if (entry == nullptr) return;\n   std::vector<CpuProfileDeoptFrame> frames_vector(\n       deopt_frames, deopt_frames + deopt_frame_count);\n@@ -44,7 +44,7 @@ void CodeDeoptEventRecord::UpdateCodeMap(CodeMap* code_map) {\n \n \n void ReportBuiltinEventRecord::UpdateCodeMap(CodeMap* code_map) {\n-  CodeEntry* entry = code_map->FindEntry(start);\n+  CodeEntry* entry = code_map->FindEntry(instruction_start);\n   if (!entry) {\n     // Code objects for builtins should already have been added to the map but\n     // some of them have been filtered out by CpuProfiler."
        },
        {
            "sha": "555c47f2f4e418b2511c6352b2ef639bee1305f6",
            "filename": "deps/v8/src/profiler/cpu-profiler.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler.cc?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -426,7 +426,7 @@ void CpuProfiler::LogBuiltins() {\n     CodeEventsContainer evt_rec(CodeEventRecord::REPORT_BUILTIN);\n     ReportBuiltinEventRecord* rec = &evt_rec.ReportBuiltinEventRecord_;\n     Builtins::Name id = static_cast<Builtins::Name>(i);\n-    rec->start = builtins->builtin(id)->address();\n+    rec->instruction_start = builtins->builtin(id)->InstructionStart();\n     rec->builtin_id = id;\n     processor_->Enqueue(evt_rec);\n   }"
        },
        {
            "sha": "78bb3b4a25f4807dbefe22c7a226969b476a21ba",
            "filename": "deps/v8/src/profiler/cpu-profiler.h",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler.h",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fcpu-profiler.h?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -53,26 +53,26 @@ class CodeEventRecord {\n \n class CodeCreateEventRecord : public CodeEventRecord {\n  public:\n-  Address start;\n+  Address instruction_start;\n   CodeEntry* entry;\n-  unsigned size;\n+  unsigned instruction_size;\n \n   V8_INLINE void UpdateCodeMap(CodeMap* code_map);\n };\n \n \n class CodeMoveEventRecord : public CodeEventRecord {\n  public:\n-  Address from;\n-  Address to;\n+  Address from_instruction_start;\n+  Address to_instruction_start;\n \n   V8_INLINE void UpdateCodeMap(CodeMap* code_map);\n };\n \n \n class CodeDisableOptEventRecord : public CodeEventRecord {\n  public:\n-  Address start;\n+  Address instruction_start;\n   const char* bailout_reason;\n \n   V8_INLINE void UpdateCodeMap(CodeMap* code_map);\n@@ -81,7 +81,7 @@ class CodeDisableOptEventRecord : public CodeEventRecord {\n \n class CodeDeoptEventRecord : public CodeEventRecord {\n  public:\n-  Address start;\n+  Address instruction_start;\n   const char* deopt_reason;\n   int deopt_id;\n   Address pc;\n@@ -95,7 +95,7 @@ class CodeDeoptEventRecord : public CodeEventRecord {\n \n class ReportBuiltinEventRecord : public CodeEventRecord {\n  public:\n-  Address start;\n+  Address instruction_start;\n   Builtins::Name builtin_id;\n \n   V8_INLINE void UpdateCodeMap(CodeMap* code_map);"
        },
        {
            "sha": "845fe97b6473f2b7d3009964e01f81ff042780e0",
            "filename": "deps/v8/src/profiler/profile-generator.cc",
            "status": "modified",
            "additions": 28,
            "deletions": 13,
            "changes": 41,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.cc?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -529,6 +529,8 @@ void CodeMap::AddCode(Address addr, CodeEntry* entry, unsigned size) {\n   ClearCodesInRange(addr, addr + size);\n   unsigned index = AddCodeEntry(addr, entry);\n   code_map_.emplace(addr, CodeEntryMapInfo{index, size});\n+  DCHECK(entry->instruction_start() == kNullAddress ||\n+         addr == entry->instruction_start());\n }\n \n void CodeMap::ClearCodesInRange(Address start, Address end) {\n@@ -550,8 +552,14 @@ CodeEntry* CodeMap::FindEntry(Address addr) {\n   auto it = code_map_.upper_bound(addr);\n   if (it == code_map_.begin()) return nullptr;\n   --it;\n-  Address end_address = it->first + it->second.size;\n-  return addr < end_address ? entry(it->second.index) : nullptr;\n+  Address start_address = it->first;\n+  Address end_address = start_address + it->second.size;\n+  CodeEntry* ret = addr < end_address ? entry(it->second.index) : nullptr;\n+  if (ret && ret->instruction_start() != kNullAddress) {\n+    DCHECK_EQ(start_address, ret->instruction_start());\n+    DCHECK(addr >= start_address && addr < end_address);\n+  }\n+  return ret;\n }\n \n void CodeMap::MoveCode(Address from, Address to) {\n@@ -563,6 +571,9 @@ void CodeMap::MoveCode(Address from, Address to) {\n   DCHECK(from + info.size <= to || to + info.size <= from);\n   ClearCodesInRange(to, to + info.size);\n   code_map_.emplace(to, info);\n+\n+  CodeEntry* entry = code_entries_[info.index].entry;\n+  entry->set_instruction_start(to);\n }\n \n unsigned CodeMap::AddCodeEntry(Address start, CodeEntry* entry) {\n@@ -693,26 +704,29 @@ void ProfileGenerator::RecordTickSample(const TickSample& sample) {\n   if (sample.pc != nullptr) {\n     if (sample.has_external_callback && sample.state == EXTERNAL) {\n       // Don't use PC when in external callback code, as it can point\n-      // inside callback's code, and we will erroneously report\n+      // inside a callback's code, and we will erroneously report\n       // that a callback calls itself.\n       stack_trace.push_back(\n           {FindEntry(reinterpret_cast<Address>(sample.external_callback_entry)),\n            no_line_info});\n     } else {\n-      CodeEntry* pc_entry = FindEntry(reinterpret_cast<Address>(sample.pc));\n-      // If there is no pc_entry we're likely in native code.\n-      // Find out, if top of stack was pointing inside a JS function\n-      // meaning that we have encountered a frameless invocation.\n+      Address attributed_pc = reinterpret_cast<Address>(sample.pc);\n+      CodeEntry* pc_entry = FindEntry(attributed_pc);\n+      // If there is no pc_entry, we're likely in native code. Find out if the\n+      // top of the stack (the return address) was pointing inside a JS\n+      // function, meaning that we have encountered a frameless invocation.\n       if (!pc_entry && !sample.has_external_callback) {\n-        pc_entry = FindEntry(reinterpret_cast<Address>(sample.tos));\n+        attributed_pc = reinterpret_cast<Address>(sample.tos);\n+        pc_entry = FindEntry(attributed_pc);\n       }\n       // If pc is in the function code before it set up stack frame or after the\n-      // frame was destroyed SafeStackFrameIterator incorrectly thinks that\n-      // ebp contains return address of the current function and skips caller's\n-      // frame. Check for this case and just skip such samples.\n+      // frame was destroyed, SafeStackFrameIterator incorrectly thinks that\n+      // ebp contains the return address of the current function and skips the\n+      // caller's frame. Check for this case and just skip such samples.\n       if (pc_entry) {\n-        int pc_offset = static_cast<int>(reinterpret_cast<Address>(sample.pc) -\n-                                         pc_entry->instruction_start());\n+        int pc_offset =\n+            static_cast<int>(attributed_pc - pc_entry->instruction_start());\n+        DCHECK_GE(pc_offset, 0);\n         src_line = pc_entry->GetSourceLine(pc_offset);\n         if (src_line == v8::CpuProfileNode::kNoLineNumberInfo) {\n           src_line = pc_entry->line_number();\n@@ -744,6 +758,7 @@ void ProfileGenerator::RecordTickSample(const TickSample& sample) {\n         // Find out if the entry has an inlining stack associated.\n         int pc_offset =\n             static_cast<int>(stack_pos - entry->instruction_start());\n+        DCHECK_GE(pc_offset, 0);\n         const std::vector<std::unique_ptr<CodeEntry>>* inline_stack =\n             entry->GetInlineStack(pc_offset);\n         if (inline_stack) {"
        },
        {
            "sha": "8eef05bcdb382600e987608bdcb9270e3307e998",
            "filename": "deps/v8/src/profiler/profile-generator.h",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.h",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofile-generator.h?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -108,7 +108,9 @@ class CodeEntry {\n   const std::vector<std::unique_ptr<CodeEntry>>* GetInlineStack(\n       int pc_offset) const;\n \n+  void set_instruction_start(Address start) { instruction_start_ = start; }\n   Address instruction_start() const { return instruction_start_; }\n+\n   CodeEventListener::LogEventsAndTags tag() const {\n     return TagField::decode(bit_field_);\n   }"
        },
        {
            "sha": "f90a2e11d3f3a247fdec39abbb1a04e4d86204e5",
            "filename": "deps/v8/src/profiler/profiler-listener.cc",
            "status": "modified",
            "additions": 24,
            "deletions": 25,
            "changes": 49,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofiler-listener.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofiler-listener.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofiler-listener.cc?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -24,37 +24,37 @@ ProfilerListener::~ProfilerListener() = default;\n void ProfilerListener::CallbackEvent(Name* name, Address entry_point) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_CREATION);\n   CodeCreateEventRecord* rec = &evt_rec.CodeCreateEventRecord_;\n-  rec->start = entry_point;\n+  rec->instruction_start = entry_point;\n   rec->entry = NewCodeEntry(CodeEventListener::CALLBACK_TAG, GetName(name));\n-  rec->size = 1;\n+  rec->instruction_size = 1;\n   DispatchCodeEvent(evt_rec);\n }\n \n void ProfilerListener::CodeCreateEvent(CodeEventListener::LogEventsAndTags tag,\n                                        AbstractCode* code, const char* name) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_CREATION);\n   CodeCreateEventRecord* rec = &evt_rec.CodeCreateEventRecord_;\n-  rec->start = code->address();\n+  rec->instruction_start = code->InstructionStart();\n   rec->entry = NewCodeEntry(tag, GetName(name), CodeEntry::kEmptyResourceName,\n                             CpuProfileNode::kNoLineNumberInfo,\n                             CpuProfileNode::kNoColumnNumberInfo, nullptr,\n                             code->InstructionStart());\n   RecordInliningInfo(rec->entry, code);\n-  rec->size = code->ExecutableSize();\n+  rec->instruction_size = code->InstructionSize();\n   DispatchCodeEvent(evt_rec);\n }\n \n void ProfilerListener::CodeCreateEvent(CodeEventListener::LogEventsAndTags tag,\n                                        AbstractCode* code, Name* name) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_CREATION);\n   CodeCreateEventRecord* rec = &evt_rec.CodeCreateEventRecord_;\n-  rec->start = code->address();\n+  rec->instruction_start = code->InstructionStart();\n   rec->entry = NewCodeEntry(tag, GetName(name), CodeEntry::kEmptyResourceName,\n                             CpuProfileNode::kNoLineNumberInfo,\n                             CpuProfileNode::kNoColumnNumberInfo, nullptr,\n                             code->InstructionStart());\n   RecordInliningInfo(rec->entry, code);\n-  rec->size = code->ExecutableSize();\n+  rec->instruction_size = code->InstructionSize();\n   DispatchCodeEvent(evt_rec);\n }\n \n@@ -64,15 +64,15 @@ void ProfilerListener::CodeCreateEvent(CodeEventListener::LogEventsAndTags tag,\n                                        Name* script_name) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_CREATION);\n   CodeCreateEventRecord* rec = &evt_rec.CodeCreateEventRecord_;\n-  rec->start = code->address();\n+  rec->instruction_start = code->InstructionStart();\n   rec->entry = NewCodeEntry(tag, GetName(shared->DebugName()),\n                             GetName(InferScriptName(script_name, shared)),\n                             CpuProfileNode::kNoLineNumberInfo,\n                             CpuProfileNode::kNoColumnNumberInfo, nullptr,\n                             code->InstructionStart());\n   RecordInliningInfo(rec->entry, code);\n   rec->entry->FillFunctionInfo(shared);\n-  rec->size = code->ExecutableSize();\n+  rec->instruction_size = code->InstructionSize();\n   DispatchCodeEvent(evt_rec);\n }\n \n@@ -83,7 +83,7 @@ void ProfilerListener::CodeCreateEvent(CodeEventListener::LogEventsAndTags tag,\n                                        int column) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_CREATION);\n   CodeCreateEventRecord* rec = &evt_rec.CodeCreateEventRecord_;\n-  rec->start = abstract_code->address();\n+  rec->instruction_start = abstract_code->InstructionStart();\n   std::unique_ptr<SourcePositionTable> line_table;\n   if (shared->script()->IsScript()) {\n     Script* script = Script::cast(shared->script());\n@@ -105,7 +105,7 @@ void ProfilerListener::CodeCreateEvent(CodeEventListener::LogEventsAndTags tag,\n                    std::move(line_table), abstract_code->InstructionStart());\n   RecordInliningInfo(rec->entry, abstract_code);\n   rec->entry->FillFunctionInfo(shared);\n-  rec->size = abstract_code->ExecutableSize();\n+  rec->instruction_size = abstract_code->InstructionSize();\n   DispatchCodeEvent(evt_rec);\n }\n \n@@ -114,28 +114,28 @@ void ProfilerListener::CodeCreateEvent(CodeEventListener::LogEventsAndTags tag,\n                                        wasm::WasmName name) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_CREATION);\n   CodeCreateEventRecord* rec = &evt_rec.CodeCreateEventRecord_;\n-  rec->start = code->instruction_start();\n+  rec->instruction_start = code->instruction_start();\n   rec->entry = NewCodeEntry(\n       tag, GetName(name.start()), CodeEntry::kWasmResourceNamePrefix,\n       CpuProfileNode::kNoLineNumberInfo, CpuProfileNode::kNoColumnNumberInfo,\n       nullptr, code->instruction_start());\n-  rec->size = code->instructions().length();\n+  rec->instruction_size = code->instructions().length();\n   DispatchCodeEvent(evt_rec);\n }\n \n-void ProfilerListener::CodeMoveEvent(AbstractCode* from, Address to) {\n+void ProfilerListener::CodeMoveEvent(AbstractCode* from, AbstractCode* to) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_MOVE);\n   CodeMoveEventRecord* rec = &evt_rec.CodeMoveEventRecord_;\n-  rec->from = from->address();\n-  rec->to = to;\n+  rec->from_instruction_start = from->InstructionStart();\n+  rec->to_instruction_start = to->InstructionStart();\n   DispatchCodeEvent(evt_rec);\n }\n \n void ProfilerListener::CodeDisableOptEvent(AbstractCode* code,\n                                            SharedFunctionInfo* shared) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_DISABLE_OPT);\n   CodeDisableOptEventRecord* rec = &evt_rec.CodeDisableOptEventRecord_;\n-  rec->start = code->address();\n+  rec->instruction_start = code->InstructionStart();\n   rec->bailout_reason = GetBailoutReason(shared->disable_optimization_reason());\n   DispatchCodeEvent(evt_rec);\n }\n@@ -145,7 +145,7 @@ void ProfilerListener::CodeDeoptEvent(Code* code, DeoptimizeKind kind,\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_DEOPT);\n   CodeDeoptEventRecord* rec = &evt_rec.CodeDeoptEventRecord_;\n   Deoptimizer::DeoptInfo info = Deoptimizer::GetDeoptInfo(code, pc);\n-  rec->start = code->address();\n+  rec->instruction_start = code->InstructionStart();\n   rec->deopt_reason = DeoptimizeReasonToString(info.deopt_reason);\n   rec->deopt_id = info.deopt_id;\n   rec->pc = pc;\n@@ -160,34 +160,33 @@ void ProfilerListener::CodeDeoptEvent(Code* code, DeoptimizeKind kind,\n void ProfilerListener::GetterCallbackEvent(Name* name, Address entry_point) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_CREATION);\n   CodeCreateEventRecord* rec = &evt_rec.CodeCreateEventRecord_;\n-  rec->start = entry_point;\n+  rec->instruction_start = entry_point;\n   rec->entry =\n       NewCodeEntry(CodeEventListener::CALLBACK_TAG, GetConsName(\"get \", name));\n-  rec->size = 1;\n+  rec->instruction_size = 1;\n   DispatchCodeEvent(evt_rec);\n }\n \n void ProfilerListener::RegExpCodeCreateEvent(AbstractCode* code,\n                                              String* source) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_CREATION);\n   CodeCreateEventRecord* rec = &evt_rec.CodeCreateEventRecord_;\n-  rec->start = code->address();\n+  rec->instruction_start = code->InstructionStart();\n   rec->entry = NewCodeEntry(\n       CodeEventListener::REG_EXP_TAG, GetConsName(\"RegExp: \", source),\n       CodeEntry::kEmptyResourceName, CpuProfileNode::kNoLineNumberInfo,\n-      CpuProfileNode::kNoColumnNumberInfo, nullptr,\n-      code->raw_instruction_start());\n-  rec->size = code->ExecutableSize();\n+      CpuProfileNode::kNoColumnNumberInfo, nullptr, code->InstructionStart());\n+  rec->instruction_size = code->InstructionSize();\n   DispatchCodeEvent(evt_rec);\n }\n \n void ProfilerListener::SetterCallbackEvent(Name* name, Address entry_point) {\n   CodeEventsContainer evt_rec(CodeEventRecord::CODE_CREATION);\n   CodeCreateEventRecord* rec = &evt_rec.CodeCreateEventRecord_;\n-  rec->start = entry_point;\n+  rec->instruction_start = entry_point;\n   rec->entry =\n       NewCodeEntry(CodeEventListener::CALLBACK_TAG, GetConsName(\"set \", name));\n-  rec->size = 1;\n+  rec->instruction_size = 1;\n   DispatchCodeEvent(evt_rec);\n }\n "
        },
        {
            "sha": "51fba18a60960f8a65115516401952b46ebb5d71",
            "filename": "deps/v8/src/profiler/profiler-listener.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofiler-listener.h",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofiler-listener.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fprofiler%2Fprofiler-listener.h?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -44,7 +44,7 @@ class ProfilerListener : public CodeEventListener {\n                        wasm::WasmName name) override;\n \n   void CodeMovingGCEvent() override {}\n-  void CodeMoveEvent(AbstractCode* from, Address to) override;\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to) override;\n   void CodeDisableOptEvent(AbstractCode* code,\n                            SharedFunctionInfo* shared) override;\n   void CodeDeoptEvent(Code* code, DeoptimizeKind kind, Address pc,"
        },
        {
            "sha": "658d37f286c5a103738ebfe22c84d68ea6c7b222",
            "filename": "deps/v8/src/snapshot/serializer.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fsnapshot%2Fserializer.h",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Fsrc%2Fsnapshot%2Fserializer.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Fsrc%2Fsnapshot%2Fserializer.h?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -28,8 +28,8 @@ class CodeAddressMap : public CodeEventLogger {\n     isolate_->logger()->RemoveCodeEventListener(this);\n   }\n \n-  void CodeMoveEvent(AbstractCode* from, Address to) override {\n-    address_to_name_map_.Move(from->address(), to);\n+  void CodeMoveEvent(AbstractCode* from, AbstractCode* to) override {\n+    address_to_name_map_.Move(from->address(), to->address());\n   }\n \n   void CodeDisableOptEvent(AbstractCode* code,"
        },
        {
            "sha": "f74bdf1ede87f53b4f396bb85f0a792895f8a40a",
            "filename": "deps/v8/test/cctest/test-cpu-profiler.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 8,
            "changes": 18,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Ftest%2Fcctest%2Ftest-cpu-profiler.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Ftest%2Fcctest%2Ftest-cpu-profiler.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fcctest%2Ftest-cpu-profiler.cc?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -176,27 +176,29 @@ TEST(CodeEvents) {\n                                     \"comment\");\n   profiler_listener.CodeCreateEvent(i::Logger::BUILTIN_TAG, comment2_code,\n                                     \"comment2\");\n-  profiler_listener.CodeMoveEvent(comment2_code, moved_code->address());\n+  profiler_listener.CodeMoveEvent(comment2_code, moved_code);\n \n   // Enqueue a tick event to enable code events processing.\n-  EnqueueTickSampleEvent(processor, aaa_code->address());\n+  EnqueueTickSampleEvent(processor, aaa_code->InstructionStart());\n \n   isolate->logger()->RemoveCodeEventListener(&profiler_listener);\n   processor->StopSynchronously();\n \n   // Check the state of profile generator.\n-  CodeEntry* aaa = generator->code_map()->FindEntry(aaa_code->address());\n+  CodeEntry* aaa =\n+      generator->code_map()->FindEntry(aaa_code->InstructionStart());\n   CHECK(aaa);\n   CHECK_EQ(0, strcmp(aaa_str, aaa->name()));\n \n   CodeEntry* comment =\n-      generator->code_map()->FindEntry(comment_code->address());\n+      generator->code_map()->FindEntry(comment_code->InstructionStart());\n   CHECK(comment);\n   CHECK_EQ(0, strcmp(\"comment\", comment->name()));\n \n-  CHECK(!generator->code_map()->FindEntry(comment2_code->address()));\n+  CHECK(!generator->code_map()->FindEntry(comment2_code->InstructionStart()));\n \n-  CodeEntry* comment2 = generator->code_map()->FindEntry(moved_code->address());\n+  CodeEntry* comment2 =\n+      generator->code_map()->FindEntry(moved_code->InstructionStart());\n   CHECK(comment2);\n   CHECK_EQ(0, strcmp(\"comment2\", comment2->name()));\n }\n@@ -298,11 +300,11 @@ TEST(Issue1398) {\n   profiler_listener.CodeCreateEvent(i::Logger::BUILTIN_TAG, code, \"bbb\");\n \n   v8::TickSample* sample = processor->StartTickSample();\n-  sample->pc = reinterpret_cast<void*>(code->address());\n+  sample->pc = reinterpret_cast<void*>(code->InstructionStart());\n   sample->tos = nullptr;\n   sample->frames_count = v8::TickSample::kMaxFramesCount;\n   for (unsigned i = 0; i < sample->frames_count; ++i) {\n-    sample->stack[i] = reinterpret_cast<void*>(code->address());\n+    sample->stack[i] = reinterpret_cast<void*>(code->InstructionStart());\n   }\n   processor->FinishTickSample();\n "
        },
        {
            "sha": "1dfa22b4cc6f53972b18f14346a9703fe48bf8a0",
            "filename": "deps/v8/test/cctest/test-log.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Ftest%2Fcctest%2Ftest-log.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Ftest%2Fcctest%2Ftest-log.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fcctest%2Ftest-log.cc?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -751,7 +751,7 @@ TEST(Issue539892) {\n     explicit FakeCodeEventLogger(i::Isolate* isolate)\n         : CodeEventLogger(isolate) {}\n \n-    void CodeMoveEvent(i::AbstractCode* from, Address to) override {}\n+    void CodeMoveEvent(i::AbstractCode* from, i::AbstractCode* to) override {}\n     void CodeDisableOptEvent(i::AbstractCode* code,\n                              i::SharedFunctionInfo* shared) override {}\n "
        },
        {
            "sha": "b53bf148e615e45581a653438af77d9d3af93909",
            "filename": "deps/v8/test/cctest/test-profile-generator.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/nodejs/node/blob/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Ftest%2Fcctest%2Ftest-profile-generator.cc",
            "raw_url": "https://github.com/nodejs/node/raw/7766baf943a61843eaf706f349dd663218639e8c/deps%2Fv8%2Ftest%2Fcctest%2Ftest-profile-generator.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/deps%2Fv8%2Ftest%2Fcctest%2Ftest-profile-generator.cc?ref=7766baf943a61843eaf706f349dd663218639e8c",
            "patch": "@@ -676,7 +676,8 @@ int GetFunctionLineNumber(CpuProfiler& profiler, LocalContext& env,\n   i::Handle<i::JSFunction> func = i::Handle<i::JSFunction>::cast(\n       v8::Utils::OpenHandle(*v8::Local<v8::Function>::Cast(\n           env->Global()->Get(env.local(), v8_str(name)).ToLocalChecked())));\n-  CodeEntry* func_entry = code_map->FindEntry(func->abstract_code()->address());\n+  CodeEntry* func_entry =\n+      code_map->FindEntry(func->abstract_code()->InstructionStart());\n   if (!func_entry) FATAL(\"%s\", name);\n   return func_entry->line_number();\n }"
        }
    ],
    "stats": {
        "total": 190,
        "additions": 102,
        "deletions": 88
    }
}