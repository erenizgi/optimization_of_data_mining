{
    "author": "danbev",
    "message": "http2: make Http2Settings constructors delegate\n\nThis commit extracts the common code in the existing Http2Settings\nconstructors into a private constructor, allowing the existing ones to\ndelegate to the private constructor it and avoid code duplication.\n\nPR-URL: https://github.com/nodejs/node/pull/23326\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Sakthipriyan Vairamani <thechargingvolcano@gmail.com>",
    "sha": "972d0beb591859a1a0df59a3d1818493a6132bf5",
    "files": [
        {
            "sha": "633d2389c7cf35d8e626efea92aa8e4e4e53fa68",
            "filename": "src/node_http2.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 16,
            "changes": 27,
            "blob_url": "https://github.com/nodejs/node/blob/972d0beb591859a1a0df59a3d1818493a6132bf5/src%2Fnode_http2.cc",
            "raw_url": "https://github.com/nodejs/node/raw/972d0beb591859a1a0df59a3d1818493a6132bf5/src%2Fnode_http2.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_http2.cc?ref=972d0beb591859a1a0df59a3d1818493a6132bf5",
            "patch": "@@ -226,32 +226,27 @@ void Http2Session::Http2Settings::Init() {\n   count_ = n;\n }\n \n-Http2Session::Http2Settings::Http2Settings(\n-    Environment* env)\n+Http2Session::Http2Settings::Http2Settings(Environment* env,\n+    Http2Session* session, uint64_t start_time)\n         : AsyncWrap(env,\n                     env->http2settings_constructor_template()\n                         ->NewInstance(env->context())\n                             .ToLocalChecked(),\n-                    AsyncWrap::PROVIDER_HTTP2SETTINGS),\n-          session_(nullptr),\n-          startTime_(0) {\n+                    PROVIDER_HTTP2SETTINGS),\n+          session_(session),\n+          startTime_(start_time) {\n   Init();\n }\n \n+\n+Http2Session::Http2Settings::Http2Settings(Environment* env)\n+  : Http2Settings(env, nullptr, 0) {}\n+\n // The Http2Settings class is used to configure a SETTINGS frame that is\n // to be sent to the connected peer. The settings are set using a TypedArray\n // that is shared with the JavaScript side.\n-Http2Session::Http2Settings::Http2Settings(\n-    Http2Session* session)\n-        : AsyncWrap(session->env(),\n-                    session->env()->http2settings_constructor_template()\n-                        ->NewInstance(session->env()->context())\n-                            .ToLocalChecked(),\n-                    AsyncWrap::PROVIDER_HTTP2SETTINGS),\n-          session_(session),\n-          startTime_(uv_hrtime()) {\n-  Init();\n-}\n+Http2Session::Http2Settings::Http2Settings(Http2Session* session)\n+  : Http2Settings(session->env(), session, uv_hrtime()) {}\n \n // Generates a Buffer that contains the serialized payload of a SETTINGS\n // frame. This can be used, for instance, to create the Base64-encoded"
        },
        {
            "sha": "4dc33d84c2af61a79274c889775dbf7f696e6867",
            "filename": "src/node_http2.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/972d0beb591859a1a0df59a3d1818493a6132bf5/src%2Fnode_http2.h",
            "raw_url": "https://github.com/nodejs/node/raw/972d0beb591859a1a0df59a3d1818493a6132bf5/src%2Fnode_http2.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_http2.h?ref=972d0beb591859a1a0df59a3d1818493a6132bf5",
            "patch": "@@ -1136,6 +1136,7 @@ class Http2Session::Http2Settings : public AsyncWrap {\n                      get_setting fn);\n \n  private:\n+  Http2Settings(Environment* env, Http2Session* session, uint64_t start_time);\n   void Init();\n   Http2Session* session_;\n   uint64_t startTime_;"
        }
    ],
    "stats": {
        "total": 28,
        "additions": 12,
        "deletions": 16
    }
}