{
    "author": "cjihrig",
    "message": "tls: warn on NODE_TLS_REJECT_UNAUTHORIZED = '0'\n\nWarn on the first request that sets the\nNODE_TLS_REJECT_UNAUTHORIZED environment variable to '0'.\n\nPR-URL: https://github.com/nodejs/node/pull/21900\nRefs: https://github.com/nodejs/node/issues/21774\nReviewed-By: James M Snell <jasnell@gmail.com>",
    "sha": "3095eecc4748da4ce7ac70e2b352ddba6c4c4deb",
    "files": [
        {
            "sha": "225d65fee3dd3d92d1f56ce7e444ea2b77dde373",
            "filename": "lib/_tls_wrap.js",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/nodejs/node/blob/3095eecc4748da4ce7ac70e2b352ddba6c4c4deb/lib%2F_tls_wrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/3095eecc4748da4ce7ac70e2b352ddba6c4c4deb/lib%2F_tls_wrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_tls_wrap.js?ref=3095eecc4748da4ce7ac70e2b352ddba6c4c4deb",
            "patch": "@@ -1098,14 +1098,25 @@ function onConnectEnd() {\n   }\n }\n \n+let warnOnAllowUnauthorized = true;\n+\n // Arguments: [port,] [host,] [options,] [cb]\n exports.connect = function connect(...args) {\n   args = normalizeConnectArgs(args);\n   var options = args[0];\n   var cb = args[1];\n+  const allowUnauthorized = process.env.NODE_TLS_REJECT_UNAUTHORIZED === '0';\n+\n+  if (allowUnauthorized && warnOnAllowUnauthorized) {\n+    warnOnAllowUnauthorized = false;\n+    process.emitWarning('Setting the NODE_TLS_REJECT_UNAUTHORIZED ' +\n+                        'environment variable to \\'0\\' makes TLS connections ' +\n+                        'and HTTPS requests insecure by disabling ' +\n+                        'certificate verification.');\n+  }\n \n   var defaults = {\n-    rejectUnauthorized: '0' !== process.env.NODE_TLS_REJECT_UNAUTHORIZED,\n+    rejectUnauthorized: !allowUnauthorized,\n     ciphers: tls.DEFAULT_CIPHERS,\n     checkServerIdentity: tls.checkServerIdentity,\n     minDHSize: 1024"
        },
        {
            "sha": "0e8f725a5db2ac23889fe5e16034b5b4e05fbf4c",
            "filename": "test/parallel/test-https-strict.js",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/nodejs/node/blob/3095eecc4748da4ce7ac70e2b352ddba6c4c4deb/test%2Fparallel%2Ftest-https-strict.js",
            "raw_url": "https://github.com/nodejs/node/raw/3095eecc4748da4ce7ac70e2b352ddba6c4c4deb/test%2Fparallel%2Ftest-https-strict.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-https-strict.js?ref=3095eecc4748da4ce7ac70e2b352ddba6c4c4deb",
            "patch": "@@ -28,6 +28,14 @@ if (!common.hasCrypto)\n // disable strict server certificate validation by the client\n process.env.NODE_TLS_REJECT_UNAUTHORIZED = '0';\n \n+common.expectWarning(\n+  'Warning',\n+  'Setting the NODE_TLS_REJECT_UNAUTHORIZED environment variable to \\'0\\' ' +\n+  'makes TLS connections and HTTPS requests insecure by disabling ' +\n+  'certificate verification.',\n+  common.noWarnCode\n+);\n+\n const assert = require('assert');\n const https = require('https');\n "
        }
    ],
    "stats": {
        "total": 21,
        "additions": 20,
        "deletions": 1
    }
}