{
    "author": "joyeecheung",
    "message": "src: throw ERR_MISSING_ARGS in node_crypto.cc\n\nPR-URL: https://github.com/nodejs/node/pull/20121\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: Matteo Collina <matteo.collina@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Jeremiah Senkpiel <fishrock123@rocketmail.com>",
    "sha": "fb58cae1e2d5685751f2ed9c32fddfd60ecb2aeb",
    "files": [
        {
            "sha": "b37b7e62c2730bfeb2b6ec29bd18c87fff496277",
            "filename": "src/node_crypto.cc",
            "status": "modified",
            "additions": 17,
            "deletions": 15,
            "changes": 32,
            "blob_url": "https://github.com/nodejs/node/blob/fb58cae1e2d5685751f2ed9c32fddfd60ecb2aeb/src%2Fnode_crypto.cc",
            "raw_url": "https://github.com/nodejs/node/raw/fb58cae1e2d5685751f2ed9c32fddfd60ecb2aeb/src%2Fnode_crypto.cc",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_crypto.cc?ref=fb58cae1e2d5685751f2ed9c32fddfd60ecb2aeb",
            "patch": "@@ -494,7 +494,7 @@ void SecureContext::SetKey(const FunctionCallbackInfo<Value>& args) {\n \n   unsigned int len = args.Length();\n   if (len < 1) {\n-    return env->ThrowError(\"Private key argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"Private key argument is mandatory\");\n   }\n \n   if (len > 2) {\n@@ -692,7 +692,7 @@ void SecureContext::SetCert(const FunctionCallbackInfo<Value>& args) {\n   ASSIGN_OR_RETURN_UNWRAP(&sc, args.Holder());\n \n   if (args.Length() != 1) {\n-    return env->ThrowTypeError(\"Certificate argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"Certificate argument is mandatory\");\n   }\n \n   BIO* bio = LoadBIO(env, args[0]);\n@@ -766,7 +766,7 @@ void SecureContext::AddCACert(const FunctionCallbackInfo<Value>& args) {\n   ClearErrorOnReturn clear_error_on_return;\n \n   if (args.Length() != 1) {\n-    return env->ThrowTypeError(\"CA certificate argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"CA certificate argument is mandatory\");\n   }\n \n   BIO* bio = LoadBIO(env, args[0]);\n@@ -797,7 +797,7 @@ void SecureContext::AddCRL(const FunctionCallbackInfo<Value>& args) {\n   ASSIGN_OR_RETURN_UNWRAP(&sc, args.Holder());\n \n   if (args.Length() != 1) {\n-    return env->ThrowTypeError(\"CRL argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"CRL argument is mandatory\");\n   }\n \n   ClearErrorOnReturn clear_error_on_return;\n@@ -900,7 +900,7 @@ void SecureContext::SetCiphers(const FunctionCallbackInfo<Value>& args) {\n   ClearErrorOnReturn clear_error_on_return;\n \n   if (args.Length() != 1) {\n-    return env->ThrowTypeError(\"Ciphers argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"Ciphers argument is mandatory\");\n   }\n \n   THROW_AND_RETURN_IF_NOT_STRING(env, args[0], \"Ciphers\");\n@@ -916,7 +916,7 @@ void SecureContext::SetECDHCurve(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = sc->env();\n \n   if (args.Length() != 1)\n-    return env->ThrowTypeError(\"ECDH curve name argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"ECDH curve name argument is mandatory\");\n \n   THROW_AND_RETURN_IF_NOT_STRING(env, args[0], \"ECDH curve name\");\n \n@@ -939,7 +939,7 @@ void SecureContext::SetDHParam(const FunctionCallbackInfo<Value>& args) {\n   // Auto DH is not supported in openssl 1.0.1, so dhparam needs\n   // to be specified explicitly\n   if (args.Length() != 1)\n-    return env->ThrowTypeError(\"DH argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"DH argument is mandatory\");\n \n   // Invalid dhparam is silently discarded and DHE is no longer used.\n   BIO* bio = LoadBIO(env, args[0]);\n@@ -994,7 +994,8 @@ void SecureContext::SetSessionIdContext(\n   Environment* env = sc->env();\n \n   if (args.Length() != 1) {\n-    return env->ThrowTypeError(\"Session ID context argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(\n+        env, \"Session ID context argument is mandatory\");\n   }\n \n   THROW_AND_RETURN_IF_NOT_STRING(env, args[0], \"Session ID context\");\n@@ -1065,7 +1066,7 @@ void SecureContext::LoadPKCS12(const FunctionCallbackInfo<Value>& args) {\n   ClearErrorOnReturn clear_error_on_return;\n \n   if (args.Length() < 1) {\n-    return env->ThrowTypeError(\"PFX certificate argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"PFX certificate argument is mandatory\");\n   }\n \n   in = LoadBIO(env, args[0]);\n@@ -1198,7 +1199,7 @@ void SecureContext::SetTicketKeys(const FunctionCallbackInfo<Value>& args) {\n   Environment* env = wrap->env();\n \n   if (args.Length() < 1) {\n-    return env->ThrowTypeError(\"Ticket keys argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"Ticket keys argument is mandatory\");\n   }\n \n   THROW_AND_RETURN_IF_NOT_BUFFER(env, args[0], \"Ticket keys\");\n@@ -1951,7 +1952,7 @@ void SSLWrap<Base>::SetSession(const FunctionCallbackInfo<Value>& args) {\n   ASSIGN_OR_RETURN_UNWRAP(&w, args.Holder());\n \n   if (args.Length() < 1) {\n-    return env->ThrowError(\"Session argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"Session argument is mandatory\");\n   }\n \n   THROW_AND_RETURN_IF_NOT_BUFFER(env, args[0], \"Session\");\n@@ -2076,7 +2077,7 @@ void SSLWrap<Base>::SetOCSPResponse(\n   Environment* env = w->env();\n \n   if (args.Length() < 1)\n-    return env->ThrowTypeError(\"OCSP response argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"OCSP response argument is mandatory\");\n \n   THROW_AND_RETURN_IF_NOT_BUFFER(env, args[0], \"OCSP response\");\n \n@@ -4084,7 +4085,7 @@ void DiffieHellman::DiffieHellmanGroup(\n   DiffieHellman* diffieHellman = new DiffieHellman(env, args.This());\n \n   if (args.Length() != 1) {\n-    return env->ThrowError(\"Group name argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(env, \"Group name argument is mandatory\");\n   }\n \n   THROW_AND_RETURN_IF_NOT_STRING(env, args[0], \"Group name\");\n@@ -4234,7 +4235,8 @@ void DiffieHellman::ComputeSecret(const FunctionCallbackInfo<Value>& args) {\n   BIGNUM* key = nullptr;\n \n   if (args.Length() == 0) {\n-    return env->ThrowError(\"Other party's public key argument is mandatory\");\n+    return THROW_ERR_MISSING_ARGS(\n+        env, \"Other party's public key argument is mandatory\");\n   } else {\n     THROW_AND_RETURN_IF_NOT_BUFFER(env, args[0], \"Other party's public key\");\n     key = BN_bin2bn(\n@@ -4304,7 +4306,7 @@ void DiffieHellman::SetKey(const v8::FunctionCallbackInfo<v8::Value>& args,\n \n   if (args.Length() == 0) {\n     snprintf(errmsg, sizeof(errmsg), \"%s argument is mandatory\", what);\n-    return env->ThrowError(errmsg);\n+    return THROW_ERR_MISSING_ARGS(env, errmsg);\n   }\n \n   if (!Buffer::HasInstance(args[0])) {"
        },
        {
            "sha": "0f91872474148d6ea5b81bcca6e1dac3150e9e42",
            "filename": "src/node_errors.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/nodejs/node/blob/fb58cae1e2d5685751f2ed9c32fddfd60ecb2aeb/src%2Fnode_errors.h",
            "raw_url": "https://github.com/nodejs/node/raw/fb58cae1e2d5685751f2ed9c32fddfd60ecb2aeb/src%2Fnode_errors.h",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/src%2Fnode_errors.h?ref=fb58cae1e2d5685751f2ed9c32fddfd60ecb2aeb",
            "patch": "@@ -22,6 +22,7 @@ namespace node {\n   V(ERR_INVALID_ARG_VALUE, TypeError)                                        \\\n   V(ERR_INVALID_ARG_TYPE, TypeError)                                         \\\n   V(ERR_MEMORY_ALLOCATION_FAILED, Error)                                     \\\n+  V(ERR_MISSING_ARGS, TypeError)                                             \\\n   V(ERR_MISSING_MODULE, Error)                                               \\\n   V(ERR_STRING_TOO_LONG, Error)                                              \\\n   V(ERR_BUFFER_TOO_LARGE, Error)"
        }
    ],
    "stats": {
        "total": 33,
        "additions": 18,
        "deletions": 15
    }
}