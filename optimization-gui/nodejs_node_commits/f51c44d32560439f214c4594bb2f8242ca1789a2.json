{
    "author": "unknown",
    "message": "test: improve coverage for readline.Interface\n\nAdd tests in parallel/test-readline-interface to increase coverage\n\nPR-URL: https://github.com/nodejs/node/pull/20704\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>\nReviewed-By: Trivikram Kamat <trivikr.dev@gmail.com>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>",
    "sha": "f51c44d32560439f214c4594bb2f8242ca1789a2",
    "files": [
        {
            "sha": "0550019e64f46f33c494fabb645fbe9ddfcda0a3",
            "filename": "test/parallel/test-readline-interface.js",
            "status": "modified",
            "additions": 171,
            "deletions": 0,
            "changes": 171,
            "blob_url": "https://github.com/nodejs/node/blob/f51c44d32560439f214c4594bb2f8242ca1789a2/test%2Fparallel%2Ftest-readline-interface.js",
            "raw_url": "https://github.com/nodejs/node/raw/f51c44d32560439f214c4594bb2f8242ca1789a2/test%2Fparallel%2Ftest-readline-interface.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-readline-interface.js?ref=f51c44d32560439f214c4594bb2f8242ca1789a2",
            "patch": "@@ -613,6 +613,43 @@ function isWarned(emitter) {\n       rli.close();\n     }\n \n+    {\n+      // Back and Forward one character\n+      const fi = new FakeInput();\n+      const rli = new readline.Interface({\n+        input: fi,\n+        output: fi,\n+        prompt: '',\n+        terminal: terminal\n+      });\n+      fi.emit('data', 'the quick brown fox');\n+      let cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 19);\n+\n+      // Back one character\n+      fi.emit('keypress', '.', { ctrl: true, name: 'b' });\n+      cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 18);\n+      // Back one character\n+      fi.emit('keypress', '.', { ctrl: true, name: 'b' });\n+      cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 17);\n+      // Forward one character\n+      fi.emit('keypress', '.', { ctrl: true, name: 'f' });\n+      cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 18);\n+      // Forward one character\n+      fi.emit('keypress', '.', { ctrl: true, name: 'f' });\n+      cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 19);\n+      rli.close();\n+    }\n+\n     {\n       // `wordLeft` and `wordRight`\n       const fi = new FakeInput();\n@@ -728,6 +765,117 @@ function isWarned(emitter) {\n         });\n     }\n \n+    // deleteLeft\n+    {\n+      const fi = new FakeInput();\n+      const rli = new readline.Interface({\n+        input: fi,\n+        output: fi,\n+        prompt: '',\n+        terminal: terminal\n+      });\n+      fi.emit('data', 'the quick brown fox');\n+      let cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 19);\n+\n+      // Delete left character\n+      fi.emit('keypress', '.', { ctrl: true, name: 'h' });\n+      cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 18);\n+      rli.on('line', common.mustCall((line) => {\n+        assert.strictEqual(line, 'the quick brown fo');\n+      }));\n+      fi.emit('data', '\\n');\n+      rli.close();\n+    }\n+\n+    // deleteRight\n+    {\n+      const fi = new FakeInput();\n+      const rli = new readline.Interface({\n+        input: fi,\n+        output: fi,\n+        prompt: '',\n+        terminal: terminal\n+      });\n+      fi.emit('data', 'the quick brown fox');\n+\n+      // Go to the start of the line\n+      fi.emit('keypress', '.', { ctrl: true, name: 'a' });\n+      let cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 0);\n+\n+      // Delete right character\n+      fi.emit('keypress', '.', { ctrl: true, name: 'd' });\n+      cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 0);\n+      rli.on('line', common.mustCall((line) => {\n+        assert.strictEqual(line, 'he quick brown fox');\n+      }));\n+      fi.emit('data', '\\n');\n+      rli.close();\n+    }\n+\n+\n+    // deleteLineLeft\n+    {\n+      const fi = new FakeInput();\n+      const rli = new readline.Interface({\n+        input: fi,\n+        output: fi,\n+        prompt: '',\n+        terminal: terminal\n+      });\n+      fi.emit('data', 'the quick brown fox');\n+      let cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 19);\n+\n+      // Delete from current to start of line\n+      fi.emit('keypress', '.', { ctrl: true, shift: true, name: 'backspace' });\n+      cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 0);\n+      rli.on('line', common.mustCall((line) => {\n+        assert.strictEqual(line, '');\n+      }));\n+      fi.emit('data', '\\n');\n+      rli.close();\n+    }\n+\n+    // deleteLineRight\n+    {\n+      const fi = new FakeInput();\n+      const rli = new readline.Interface({\n+        input: fi,\n+        output: fi,\n+        prompt: '',\n+        terminal: terminal\n+      });\n+      fi.emit('data', 'the quick brown fox');\n+\n+      // Go to the start of the line\n+      fi.emit('keypress', '.', { ctrl: true, name: 'a' });\n+      let cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 0);\n+\n+      // Delete from current to end of line\n+      fi.emit('keypress', '.', { ctrl: true, shift: true, name: 'delete' });\n+      cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 0);\n+      rli.on('line', common.mustCall((line) => {\n+        assert.strictEqual(line, '');\n+      }));\n+      fi.emit('data', '\\n');\n+      rli.close();\n+    }\n+\n     // multi-line cursor position\n     {\n       const fi = new FakeInput();\n@@ -742,6 +890,29 @@ function isWarned(emitter) {\n       const cursorPos = rli._getCursorPos();\n       assert.strictEqual(cursorPos.rows, 1);\n       assert.strictEqual(cursorPos.cols, 5);\n+      rli.close();\n+    }\n+\n+    // Clear the whole screen\n+    {\n+      const fi = new FakeInput();\n+      const rli = new readline.Interface({\n+        input: fi,\n+        output: fi,\n+        prompt: '',\n+        terminal: terminal\n+      });\n+      const lines = ['line 1', 'line 2', 'line 3'];\n+      fi.emit('data', lines.join('\\n'));\n+      fi.emit('keypress', '.', { ctrl: true, name: 'l' });\n+      const cursorPos = rli._getCursorPos();\n+      assert.strictEqual(cursorPos.rows, 0);\n+      assert.strictEqual(cursorPos.cols, 6);\n+      rli.on('line', common.mustCall((line) => {\n+        assert.strictEqual(line, 'line 3');\n+      }));\n+      fi.emit('data', '\\n');\n+      rli.close();\n     }\n   }\n "
        }
    ],
    "stats": {
        "total": 171,
        "additions": 171,
        "deletions": 0
    }
}