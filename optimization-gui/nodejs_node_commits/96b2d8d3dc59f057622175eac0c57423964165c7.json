{
    "author": "sethbrenith",
    "message": "fs: check for symlink support in fs-promises test\n\nAttempting to make symlinks as a non-administrator user in Windows\ncauses a permission error. We need to update test-fs-promises to avoid\nmaking symlinks if the platform does not support it.\n\nPR-URL: https://github.com/nodejs/node/pull/19018\nReviewed-By: Anna Henningsen <anna@addaleax.net>\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Joyee Cheung <joyeec9h3@gmail.com>\nReviewed-By: Richard Lau <riclau@uk.ibm.com>\nReviewed-By: Shingo Inoue <leko.noor@gmail.com>\nReviewed-By: Ruben Bridgewater <ruben@bridgewater.de>\nReviewed-By: Colin Ihrig <cjihrig@gmail.com>",
    "sha": "96b2d8d3dc59f057622175eac0c57423964165c7",
    "files": [
        {
            "sha": "ba3a91d5b39f8aadb0b6af62ffe2b23e03a52e1f",
            "filename": "test/parallel/test-fs-promises.js",
            "status": "modified",
            "additions": 14,
            "deletions": 11,
            "changes": 25,
            "blob_url": "https://github.com/nodejs/node/blob/96b2d8d3dc59f057622175eac0c57423964165c7/test%2Fparallel%2Ftest-fs-promises.js",
            "raw_url": "https://github.com/nodejs/node/raw/96b2d8d3dc59f057622175eac0c57423964165c7/test%2Fparallel%2Ftest-fs-promises.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/test%2Fparallel%2Ftest-fs-promises.js?ref=96b2d8d3dc59f057622175eac0c57423964165c7",
            "patch": "@@ -116,21 +116,24 @@ function verifyStatObject(stat) {\n     stats = await stat(newPath);\n     verifyStatObject(stats);\n \n-    const newLink = path.resolve(tmpDir, 'baz3.js');\n-    await symlink(newPath, newLink);\n+    if (common.canCreateSymLink()) {\n+      const newLink = path.resolve(tmpDir, 'baz3.js');\n+      await symlink(newPath, newLink);\n \n-    const newLink2 = path.resolve(tmpDir, 'baz4.js');\n-    await link(newPath, newLink2);\n+      stats = await lstat(newLink);\n+      verifyStatObject(stats);\n \n-    stats = await lstat(newLink);\n-    verifyStatObject(stats);\n+      assert.strictEqual(newPath.toLowerCase(),\n+                         (await realpath(newLink)).toLowerCase());\n+      assert.strictEqual(newPath.toLowerCase(),\n+                         (await readlink(newLink)).toLowerCase());\n \n-    assert.strictEqual(newPath.toLowerCase(),\n-                       (await realpath(newLink)).toLowerCase());\n-    assert.strictEqual(newPath.toLowerCase(),\n-                       (await readlink(newLink)).toLowerCase());\n+      await unlink(newLink);\n+    }\n+\n+    const newLink2 = path.resolve(tmpDir, 'baz4.js');\n+    await link(newPath, newLink2);\n \n-    await unlink(newLink);\n     await unlink(newLink2);\n \n     const newdir = path.resolve(tmpDir, 'dir');"
        }
    ],
    "stats": {
        "total": 25,
        "additions": 14,
        "deletions": 11
    }
}