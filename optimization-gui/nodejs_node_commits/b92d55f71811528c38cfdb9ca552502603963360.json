{
    "author": "addaleax",
    "message": "tls: destroy TLS socket if StreamWrap is destroyed\n\nPreviously, there was no mechanism in place that would\nhave destroyed the TLS socket once the underlying socket\nhad been closed.\n\nPR-URL: https://github.com/nodejs/node/pull/24290\nRefs: https://github.com/nodejs/node/pull/24288\nRefs: https://github.com/nodejs/node/pull/24075\nReviewed-By: James M Snell <jasnell@gmail.com>\nReviewed-By: Daniel Bevenius <daniel.bevenius@gmail.com>\nReviewed-By: Ouyang Yadong <oyydoibh@gmail.com>",
    "sha": "b92d55f71811528c38cfdb9ca552502603963360",
    "files": [
        {
            "sha": "9931691464ec1453ff5164f329ca4909c3e76900",
            "filename": "lib/_tls_wrap.js",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/nodejs/node/blob/b92d55f71811528c38cfdb9ca552502603963360/lib%2F_tls_wrap.js",
            "raw_url": "https://github.com/nodejs/node/raw/b92d55f71811528c38cfdb9ca552502603963360/lib%2F_tls_wrap.js",
            "contents_url": "https://api.github.com/repos/nodejs/node/contents/lib%2F_tls_wrap.js?ref=b92d55f71811528c38cfdb9ca552502603963360",
            "patch": "@@ -310,10 +310,12 @@ function TLSSocket(socket, opts) {\n \n   // Wrap plain JS Stream into StreamWrap\n   var wrap;\n-  if ((socket instanceof net.Socket && socket._handle) || !socket)\n+  if ((socket instanceof net.Socket && socket._handle) || !socket) {\n     wrap = socket;\n-  else\n+  } else {\n     wrap = new StreamWrap(socket);\n+    wrap.once('close', () => this.destroy());\n+  }\n \n   // Just a documented property to make secure sockets\n   // distinguishable from regular ones."
        }
    ],
    "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
    }
}