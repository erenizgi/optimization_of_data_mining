{
    "author": "chsigg",
    "message": "Increase the maximum HLO op chain length for profiling from 8192 to 16384.\n\nThis prevents max chains of trivial ops (e.g. add.fp32) to run faster than copying the data, which results in 'too fast to measure' error.\n\nPiperOrigin-RevId: 826079017",
    "sha": "3943b533260a623ee41b62ffa6ed1cd32d6bd9e0",
    "files": [
        {
            "sha": "1cfc21ee390f7e1ad4d3ba5fd7818ddf770e2a4a",
            "filename": "third_party/xla/xla/service/gpu/model/hlo_op_profiler.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3943b533260a623ee41b62ffa6ed1cd32d6bd9e0/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3943b533260a623ee41b62ffa6ed1cd32d6bd9e0/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiler.cc?ref=3943b533260a623ee41b62ffa6ed1cd32d6bd9e0",
            "patch": "@@ -397,7 +397,9 @@ absl::StatusOr<HloInstructionProfile> HloOpProfiler::MeasureClockCyclesPerOp(\n \n   // Longer chains are too slow to compile.\n   constexpr int kMinOpChainLength = 16;\n-  constexpr int kMaxOpChainLength = 8192;\n+  // If you get \"too fast to measure\" errors on faster GPUs, try increasing\n+  // kMaxOpChainLength.\n+  constexpr int kMaxOpChainLength = 16 * 1024;\n \n   absl::Duration duration = absl::ZeroDuration();\n   int chain_length = kMinOpChainLength;"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 3,
        "deletions": 1
    }
}