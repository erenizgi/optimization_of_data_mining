{
    "author": "jakeharmon8",
    "message": "Add ARM64 support for PJRT wheels\n\nSet the wheel platform to `manylinux2014_aarch64` when building on ARM64. The wheel version is also factored out, since they'll be released together.\n\nPiperOrigin-RevId: 811531360",
    "sha": "2cf044e391ca84e016fd7c3e404bad73d177f696",
    "files": [
        {
            "sha": "c6460f86595eff3b0c080aa8c719cf51a53a9268",
            "filename": "third_party/xla/build_tools/pjrt_wheels/BUILD.bazel",
            "status": "modified",
            "additions": 11,
            "deletions": 4,
            "changes": 15,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2cf044e391ca84e016fd7c3e404bad73d177f696/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2cf044e391ca84e016fd7c3e404bad73d177f696/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel?ref=2cf044e391ca84e016fd7c3e404bad73d177f696",
            "patch": "@@ -4,6 +4,13 @@ load(\"@rules_python//python:packaging.bzl\", \"py_wheel\")\n # This ensures we can only build plugins for selected CUDA versions.\n cuda_label = \"cuda\" + cuda_major_version if cuda_major_version else \"null\"\n \n+wheel_version = \"0.0.0.dev0\"\n+\n+wheel_platform = select({\n+    \"//conditions:default\": \"manylinux2014_x86_64\",\n+    \"//xla/tsl:linux_aarch64\": \"manylinux2014_aarch64\",\n+})\n+\n # Aliases and filegroups don't move files within bazel-out, so we need to use genrules to place them\n # in the correct directory structure for the wheel.\n genrule(\n@@ -44,11 +51,11 @@ py_wheel(\n             \"xla_\" + cuda_label + \"_pjrt = xla_plugins.xla_\" + cuda_label + \"_pjrt\\n\",\n         ],\n     },\n-    platform = \"manylinux2014_x86_64\",\n+    platform = wheel_platform,\n     python_tag = \"py3\",\n     strip_path_prefixes = [\"build_tools/pjrt_wheels\"],\n     summary = \"XLA PJRT Plugin\",\n-    version = \"0.0.0.dev0\",\n+    version = wheel_version,\n     deps = [\n         \":xla_plugins/xla_\" + cuda_label + \"_pjrt/xla_gpu_pjrt.so\",\n         \":init_file_\" + cuda_label,\n@@ -84,11 +91,11 @@ py_wheel(\n             \"xla_cpu_pjrt = xla_plugins.xla_cpu_pjrt\\n\",\n         ],\n     },\n-    platform = \"manylinux2014_x86_64\",\n+    platform = wheel_platform,\n     python_tag = \"py3\",\n     strip_path_prefixes = [\"build_tools/pjrt_wheels\"],\n     summary = \"XLA PJRT Plugin\",\n-    version = \"0.0.0.dev0\",\n+    version = wheel_version,\n     deps = [\n         \":init_file_cpu\",\n         \":xla_plugins/xla_cpu_pjrt/xla_cpu_pjrt.so\","
        }
    ],
    "stats": {
        "total": 15,
        "additions": 11,
        "deletions": 4
    }
}