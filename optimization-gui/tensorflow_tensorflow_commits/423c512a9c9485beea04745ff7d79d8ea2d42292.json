{
    "author": "beckerhe",
    "message": "Update compilation provider tests to use sm_80 and improve spilling test.\n\nThis change updates the default compute capability used in `compilation_provider_test.cc` from sm_52 to sm_80.\n\nAdditionally, the test for the spilling detection now uses a more elaborate kernel.\n\nBoth changes were necessary to support CUDA 13 which requires at least compute capability 8.0 and only allows setting the maximum register count to 24 (before 16 was allowed). So this required a more elaborate data shuffling logic to push the usage of 24 registers and trigger spilling.\n\nPiperOrigin-RevId: 798991435",
    "sha": "423c512a9c9485beea04745ff7d79d8ea2d42292",
    "files": [
        {
            "sha": "9e0e5fd8c840b75643a281bb87e2c581b3d996f2",
            "filename": "third_party/xla/xla/stream_executor/cuda/compilation_provider_test.cc",
            "status": "modified",
            "additions": 336,
            "deletions": 18,
            "changes": 354,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/423c512a9c9485beea04745ff7d79d8ea2d42292/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcompilation_provider_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/423c512a9c9485beea04745ff7d79d8ea2d42292/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcompilation_provider_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcompilation_provider_test.cc?ref=423c512a9c9485beea04745ff7d79d8ea2d42292",
            "patch": "@@ -27,7 +27,6 @@ limitations under the License.\n #include \"absl/status/status_matchers.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/str_cat.h\"\n-#include \"absl/strings/str_replace.h\"\n #include \"absl/strings/string_view.h\"\n #include \"xla/stream_executor/cuda/compilation_options.h\"\n #include \"xla/stream_executor/cuda/compilation_provider_test.h\"\n@@ -127,7 +126,7 @@ TEST_P(CompilationProviderTest, NameIsNotEmpty) {\n //\n constexpr const char kDependeePtx[] = R\"(\n .version 8.0\n-.target sm_52\n+.target sm_80\n .address_size 64\n \n         // .globl       _Z5magicv\n@@ -148,7 +147,7 @@ constexpr const char kDependeePtx[] = R\"(\n //\n constexpr const char kDependentPtx[] = R\"(\n .version 8.0\n-.target sm_52\n+.target sm_80\n .address_size 64\n \n         // .globl       _Z6kernelPi\n@@ -159,7 +158,6 @@ constexpr const char kDependentPtx[] = R\"(\n .visible .entry _Z6kernelPi(\n         .param .u64 _Z6kernelPi_param_0\n )\n-// Insert .maxnreg directive here!\n {\n         .reg .b32       %r<2>;\n         .reg .b64       %rd<3>;\n@@ -186,7 +184,7 @@ constexpr const char kDependentPtx[] = R\"(\n //\n constexpr const char kStandalonePtx[] = R\"(\n .version 8.0\n-.target sm_52\n+.target sm_80\n .address_size 64\n \n         // .globl       _Z6kernelPi\n@@ -207,8 +205,331 @@ constexpr const char kStandalonePtx[] = R\"(\n \n })\";\n \n-constexpr stream_executor::CudaComputeCapability kDefaultComputeCapability{5,\n-                                                                           2};\n+// This has been generated from the following snippet:\n+/*\n+#include <cstring>\n+\n+__global__ void spilling_kernel(float* out) {\n+    constexpr int kSize = 20;\n+    float local[kSize];\n+    std::memcpy(local, out, sizeof(local));\n+    for(int i = 0; i < kSize; i += 4) {\n+\n+        float a = local[i+0];\n+        float b = local[i+1];\n+        float c = local[i+2];\n+        float d = local[i+3];\n+        local[i+0] = b;\n+        local[i+1] = c;\n+        local[i+2] = d;\n+        local[i+3] = a;\n+    }\n+    std::memcpy(out, local, sizeof(local));\n+}\n+*/\n+// Generated by `cat kernel.cu | nvcc -o - --ptx --x cu -\n+// and .maxnreg directive added by hand\n+constexpr const char kSpillingKernelPrefix[] = R\"(\n+.version 8.0\n+.target sm_80\n+.address_size 64\n+\n+\t// .globl\t_Z15spilling_kernelPf\n+\n+.visible .entry _Z15spilling_kernelPf(\n+\t.param .u64 _Z15spilling_kernelPf_param_0\n+) .maxnreg 24\n+{\n+\t.reg .b32 \t%r<201>;\n+\t.reg .b64 \t%rd<3>;\n+\tld.param.u64 \t%rd1, [_Z15spilling_kernelPf_param_0];\n+\tcvta.to.global.u64 \t%rd2, %rd1;\n+\tld.global.u8 \t%r1, [%rd2];\n+\tld.global.u8 \t%r2, [%rd2+1];\n+\tprmt.b32 \t%r3, %r2, %r1, 30212;\n+\tld.global.u8 \t%r4, [%rd2+2];\n+\tld.global.u8 \t%r5, [%rd2+3];\n+\tprmt.b32 \t%r6, %r5, %r4, 30212;\n+\tld.global.u8 \t%r7, [%rd2+4];\n+\tld.global.u8 \t%r8, [%rd2+5];\n+\tprmt.b32 \t%r9, %r8, %r7, 30212;\n+\tld.global.u8 \t%r10, [%rd2+6];\n+\tld.global.u8 \t%r11, [%rd2+7];\n+\tprmt.b32 \t%r12, %r11, %r10, 30212;\n+\tld.global.u8 \t%r13, [%rd2+8];\n+\tld.global.u8 \t%r14, [%rd2+9];\n+\tprmt.b32 \t%r15, %r14, %r13, 30212;\n+\tld.global.u8 \t%r16, [%rd2+10];\n+\tld.global.u8 \t%r17, [%rd2+11];\n+\tprmt.b32 \t%r18, %r17, %r16, 30212;\n+\tld.global.u8 \t%r19, [%rd2+12];\n+\tld.global.u8 \t%r20, [%rd2+13];\n+\tprmt.b32 \t%r21, %r20, %r19, 30212;\n+\tld.global.u8 \t%r22, [%rd2+14];\n+\tld.global.u8 \t%r23, [%rd2+15];\n+\tprmt.b32 \t%r24, %r23, %r22, 30212;\n+\tld.global.u8 \t%r25, [%rd2+16];\n+\tld.global.u8 \t%r26, [%rd2+17];\n+\tprmt.b32 \t%r27, %r26, %r25, 30212;\n+\tld.global.u8 \t%r28, [%rd2+18];\n+\tld.global.u8 \t%r29, [%rd2+19];\n+\tprmt.b32 \t%r30, %r29, %r28, 30212;\n+\tld.global.u8 \t%r31, [%rd2+20];\n+\tld.global.u8 \t%r32, [%rd2+21];\n+\tprmt.b32 \t%r33, %r32, %r31, 30212;\n+\tld.global.u8 \t%r34, [%rd2+22];\n+\tld.global.u8 \t%r35, [%rd2+23];\n+\tprmt.b32 \t%r36, %r35, %r34, 30212;\n+\tld.global.u8 \t%r37, [%rd2+24];\n+\tld.global.u8 \t%r38, [%rd2+25];\n+\tprmt.b32 \t%r39, %r38, %r37, 30212;\n+\tld.global.u8 \t%r40, [%rd2+26];\n+\tld.global.u8 \t%r41, [%rd2+27];\n+\tprmt.b32 \t%r42, %r41, %r40, 30212;\n+\tld.global.u8 \t%r43, [%rd2+28];\n+\tld.global.u8 \t%r44, [%rd2+29];\n+\tprmt.b32 \t%r45, %r44, %r43, 30212;\n+\tld.global.u8 \t%r46, [%rd2+30];\n+\tld.global.u8 \t%r47, [%rd2+31];\n+\tprmt.b32 \t%r48, %r47, %r46, 30212;\n+\tld.global.u8 \t%r49, [%rd2+32];\n+\tld.global.u8 \t%r50, [%rd2+33];\n+\tprmt.b32 \t%r51, %r50, %r49, 30212;\n+\tld.global.u8 \t%r52, [%rd2+34];\n+\tld.global.u8 \t%r53, [%rd2+35];\n+\tprmt.b32 \t%r54, %r53, %r52, 30212;\n+\tld.global.u8 \t%r55, [%rd2+36];\n+\tld.global.u8 \t%r56, [%rd2+37];\n+\tprmt.b32 \t%r57, %r56, %r55, 30212;\n+\tld.global.u8 \t%r58, [%rd2+38];\n+\tld.global.u8 \t%r59, [%rd2+39];\n+\tprmt.b32 \t%r60, %r59, %r58, 30212;\n+\tld.global.u8 \t%r61, [%rd2+40];\n+\tld.global.u8 \t%r62, [%rd2+41];\n+\tprmt.b32 \t%r63, %r62, %r61, 30212;\n+\tld.global.u8 \t%r64, [%rd2+42];\n+\tld.global.u8 \t%r65, [%rd2+43];\n+\tprmt.b32 \t%r66, %r65, %r64, 30212;\n+\tld.global.u8 \t%r67, [%rd2+44];\n+\tld.global.u8 \t%r68, [%rd2+45];\n+\tprmt.b32 \t%r69, %r68, %r67, 30212;\n+\tld.global.u8 \t%r70, [%rd2+46];\n+\tld.global.u8 \t%r71, [%rd2+47];\n+\tprmt.b32 \t%r72, %r71, %r70, 30212;\n+\tld.global.u8 \t%r73, [%rd2+48];\n+\tld.global.u8 \t%r74, [%rd2+49];\n+\tprmt.b32 \t%r75, %r74, %r73, 30212;\n+\tld.global.u8 \t%r76, [%rd2+50];\n+\tld.global.u8 \t%r77, [%rd2+51];\n+\tprmt.b32 \t%r78, %r77, %r76, 30212;\n+\tld.global.u8 \t%r79, [%rd2+52];\n+\tld.global.u8 \t%r80, [%rd2+53];\n+\tprmt.b32 \t%r81, %r80, %r79, 30212;\n+\tld.global.u8 \t%r82, [%rd2+54];\n+\tld.global.u8 \t%r83, [%rd2+55];\n+\tprmt.b32 \t%r84, %r83, %r82, 30212;\n+\tld.global.u8 \t%r85, [%rd2+56];\n+\tld.global.u8 \t%r86, [%rd2+57];\n+\tprmt.b32 \t%r87, %r86, %r85, 30212;\n+\tld.global.u8 \t%r88, [%rd2+58];\n+\tld.global.u8 \t%r89, [%rd2+59];\n+\tprmt.b32 \t%r90, %r89, %r88, 30212;\n+\tld.global.u8 \t%r91, [%rd2+60];\n+\tld.global.u8 \t%r92, [%rd2+61];\n+\tprmt.b32 \t%r93, %r92, %r91, 30212;\n+\tld.global.u8 \t%r94, [%rd2+62];\n+\tld.global.u8 \t%r95, [%rd2+63];\n+\tprmt.b32 \t%r96, %r95, %r94, 30212;\n+\tld.global.u8 \t%r97, [%rd2+64];\n+\tld.global.u8 \t%r98, [%rd2+65];\n+\tprmt.b32 \t%r99, %r98, %r97, 30212;\n+\tld.global.u8 \t%r100, [%rd2+66];\n+\tld.global.u8 \t%r101, [%rd2+67];\n+\tprmt.b32 \t%r102, %r101, %r100, 30212;\n+\tld.global.u8 \t%r103, [%rd2+68];\n+\tld.global.u8 \t%r104, [%rd2+69];\n+\tprmt.b32 \t%r105, %r104, %r103, 30212;\n+\tld.global.u8 \t%r106, [%rd2+70];\n+\tld.global.u8 \t%r107, [%rd2+71];\n+\tprmt.b32 \t%r108, %r107, %r106, 30212;\n+\tld.global.u8 \t%r109, [%rd2+72];\n+\tld.global.u8 \t%r110, [%rd2+73];\n+\tprmt.b32 \t%r111, %r110, %r109, 30212;\n+\tld.global.u8 \t%r112, [%rd2+74];\n+\tld.global.u8 \t%r113, [%rd2+75];\n+\tprmt.b32 \t%r114, %r113, %r112, 30212;\n+\tld.global.u8 \t%r115, [%rd2+76];\n+\tld.global.u8 \t%r116, [%rd2+77];\n+\tprmt.b32 \t%r117, %r116, %r115, 30212;\n+\tld.global.u8 \t%r118, [%rd2+78];\n+\tld.global.u8 \t%r119, [%rd2+79];\n+\tprmt.b32 \t%r120, %r119, %r118, 30212;\n+\tprmt.b32 \t%r121, %r12, %r9, 4180;\n+\tst.global.u8 \t[%rd2], %r121;\n+\tshr.u32 \t%r122, %r121, 24;\n+\tst.global.u8 \t[%rd2+3], %r122;\n+\tshr.u32 \t%r123, %r121, 16;\n+\tst.global.u8 \t[%rd2+2], %r123;\n+\tshr.u32 \t%r124, %r121, 8;\n+\tst.global.u8 \t[%rd2+1], %r124;\n+\tprmt.b32 \t%r125, %r18, %r15, 4180;\n+\tst.global.u8 \t[%rd2+4], %r125;\n+\tshr.u32 \t%r126, %r125, 24;\n+\tst.global.u8 \t[%rd2+7], %r126;\n+\tshr.u32 \t%r127, %r125, 16;\n+\tst.global.u8 \t[%rd2+6], %r127;\n+\tshr.u32 \t%r128, %r125, 8;\n+\tst.global.u8 \t[%rd2+5], %r128;\n+\tprmt.b32 \t%r129, %r24, %r21, 4180;\n+\tst.global.u8 \t[%rd2+8], %r129;\n+\tshr.u32 \t%r130, %r129, 24;\n+\tst.global.u8 \t[%rd2+11], %r130;\n+\tshr.u32 \t%r131, %r129, 16;\n+\tst.global.u8 \t[%rd2+10], %r131;\n+\tshr.u32 \t%r132, %r129, 8;\n+\tst.global.u8 \t[%rd2+9], %r132;\n+\tprmt.b32 \t%r133, %r6, %r3, 4180;\n+\tst.global.u8 \t[%rd2+12], %r133;\n+\tshr.u32 \t%r134, %r133, 24;\n+\tst.global.u8 \t[%rd2+15], %r134;\n+\tshr.u32 \t%r135, %r133, 16;\n+\tst.global.u8 \t[%rd2+14], %r135;\n+\tshr.u32 \t%r136, %r133, 8;\n+\tst.global.u8 \t[%rd2+13], %r136;\n+\tprmt.b32 \t%r137, %r36, %r33, 4180;\n+\tst.global.u8 \t[%rd2+16], %r137;\n+\tshr.u32 \t%r138, %r137, 24;\n+\tst.global.u8 \t[%rd2+19], %r138;\n+\tshr.u32 \t%r139, %r137, 16;\n+\tst.global.u8 \t[%rd2+18], %r139;\n+\tshr.u32 \t%r140, %r137, 8;\n+\tst.global.u8 \t[%rd2+17], %r140;\n+\tprmt.b32 \t%r141, %r42, %r39, 4180;\n+\tst.global.u8 \t[%rd2+20], %r141;\n+\tshr.u32 \t%r142, %r141, 24;\n+\tst.global.u8 \t[%rd2+23], %r142;\n+\tshr.u32 \t%r143, %r141, 16;\n+\tst.global.u8 \t[%rd2+22], %r143;\n+\tshr.u32 \t%r144, %r141, 8;\n+\tst.global.u8 \t[%rd2+21], %r144;\n+\tprmt.b32 \t%r145, %r48, %r45, 4180;\n+\tst.global.u8 \t[%rd2+24], %r145;\n+\tshr.u32 \t%r146, %r145, 24;\n+\tst.global.u8 \t[%rd2+27], %r146;\n+\tshr.u32 \t%r147, %r145, 16;\n+\tst.global.u8 \t[%rd2+26], %r147;\n+\tshr.u32 \t%r148, %r145, 8;\n+\tst.global.u8 \t[%rd2+25], %r148;\n+\tprmt.b32 \t%r149, %r30, %r27, 4180;\n+\tst.global.u8 \t[%rd2+28], %r149;\n+\tshr.u32 \t%r150, %r149, 24;\n+\tst.global.u8 \t[%rd2+31], %r150;\n+\tshr.u32 \t%r151, %r149, 16;\n+\tst.global.u8 \t[%rd2+30], %r151;\n+\tshr.u32 \t%r152, %r149, 8;\n+\tst.global.u8 \t[%rd2+29], %r152;\n+\tprmt.b32 \t%r153, %r60, %r57, 4180;\n+\tst.global.u8 \t[%rd2+32], %r153;\n+\tshr.u32 \t%r154, %r153, 24;\n+\tst.global.u8 \t[%rd2+35], %r154;\n+\tshr.u32 \t%r155, %r153, 16;\n+\tst.global.u8 \t[%rd2+34], %r155;\n+\tshr.u32 \t%r156, %r153, 8;\n+\tst.global.u8 \t[%rd2+33], %r156;\n+\tprmt.b32 \t%r157, %r66, %r63, 4180;\n+\tst.global.u8 \t[%rd2+36], %r157;\n+\tshr.u32 \t%r158, %r157, 24;\n+\tst.global.u8 \t[%rd2+39], %r158;\n+\tshr.u32 \t%r159, %r157, 16;\n+\tst.global.u8 \t[%rd2+38], %r159;\n+\tshr.u32 \t%r160, %r157, 8;\n+\tst.global.u8 \t[%rd2+37], %r160;\n+\tprmt.b32 \t%r161, %r72, %r69, 4180;\n+\tst.global.u8 \t[%rd2+40], %r161;\n+\tshr.u32 \t%r162, %r161, 24;\n+\tst.global.u8 \t[%rd2+43], %r162;\n+\tshr.u32 \t%r163, %r161, 16;\n+\tst.global.u8 \t[%rd2+42], %r163;\n+\tshr.u32 \t%r164, %r161, 8;\n+\tst.global.u8 \t[%rd2+41], %r164;\n+\tprmt.b32 \t%r165, %r54, %r51, 4180;\n+\tst.global.u8 \t[%rd2+44], %r165;\n+\tshr.u32 \t%r166, %r165, 24;\n+\tst.global.u8 \t[%rd2+47], %r166;\n+\tshr.u32 \t%r167, %r165, 16;\n+\tst.global.u8 \t[%rd2+46], %r167;\n+\tshr.u32 \t%r168, %r165, 8;\n+\tst.global.u8 \t[%rd2+45], %r168;\n+\tprmt.b32 \t%r169, %r84, %r81, 4180;\n+\tst.global.u8 \t[%rd2+48], %r169;\n+\tshr.u32 \t%r170, %r169, 24;\n+\tst.global.u8 \t[%rd2+51], %r170;\n+\tshr.u32 \t%r171, %r169, 16;\n+\tst.global.u8 \t[%rd2+50], %r171;\n+\tshr.u32 \t%r172, %r169, 8;\n+\tst.global.u8 \t[%rd2+49], %r172;\n+\tprmt.b32 \t%r173, %r90, %r87, 4180;\n+\tst.global.u8 \t[%rd2+52], %r173;\n+\tshr.u32 \t%r174, %r173, 24;\n+\tst.global.u8 \t[%rd2+55], %r174;\n+\tshr.u32 \t%r175, %r173, 16;\n+\tst.global.u8 \t[%rd2+54], %r175;\n+\tshr.u32 \t%r176, %r173, 8;\n+\tst.global.u8 \t[%rd2+53], %r176;\n+\tprmt.b32 \t%r177, %r96, %r93, 4180;\n+\tst.global.u8 \t[%rd2+56], %r177;\n+\tshr.u32 \t%r178, %r177, 24;\n+\tst.global.u8 \t[%rd2+59], %r178;\n+\tshr.u32 \t%r179, %r177, 16;\n+\tst.global.u8 \t[%rd2+58], %r179;\n+\tshr.u32 \t%r180, %r177, 8;\n+\tst.global.u8 \t[%rd2+57], %r180;\n+\tprmt.b32 \t%r181, %r78, %r75, 4180;\n+\tst.global.u8 \t[%rd2+60], %r181;\n+\tshr.u32 \t%r182, %r181, 24;\n+\tst.global.u8 \t[%rd2+63], %r182;\n+\tshr.u32 \t%r183, %r181, 16;\n+\tst.global.u8 \t[%rd2+62], %r183;\n+\tshr.u32 \t%r184, %r181, 8;\n+\tst.global.u8 \t[%rd2+61], %r184;\n+\tprmt.b32 \t%r185, %r108, %r105, 4180;\n+\tst.global.u8 \t[%rd2+64], %r185;\n+\tshr.u32 \t%r186, %r185, 24;\n+\tst.global.u8 \t[%rd2+67], %r186;\n+\tshr.u32 \t%r187, %r185, 16;\n+\tst.global.u8 \t[%rd2+66], %r187;\n+\tshr.u32 \t%r188, %r185, 8;\n+\tst.global.u8 \t[%rd2+65], %r188;\n+\tprmt.b32 \t%r189, %r114, %r111, 4180;\n+\tst.global.u8 \t[%rd2+68], %r189;\n+\tshr.u32 \t%r190, %r189, 24;\n+\tst.global.u8 \t[%rd2+71], %r190;\n+\tshr.u32 \t%r191, %r189, 16;\n+\tst.global.u8 \t[%rd2+70], %r191;\n+\tshr.u32 \t%r192, %r189, 8;\n+\tst.global.u8 \t[%rd2+69], %r192;\n+\tprmt.b32 \t%r193, %r120, %r117, 4180;\n+\tst.global.u8 \t[%rd2+72], %r193;\n+\tshr.u32 \t%r194, %r193, 24;\n+\tst.global.u8 \t[%rd2+75], %r194;\n+\tshr.u32 \t%r195, %r193, 16;\n+\tst.global.u8 \t[%rd2+74], %r195;\n+\tshr.u32 \t%r196, %r193, 8;\n+\tst.global.u8 \t[%rd2+73], %r196;\n+\tprmt.b32 \t%r197, %r102, %r99, 4180;\n+\tshr.u32 \t%r198, %r197, 24;\n+\tst.global.u8 \t[%rd2+79], %r198;\n+\tshr.u32 \t%r199, %r197, 16;\n+\tst.global.u8 \t[%rd2+78], %r199;\n+\tshr.u32 \t%r200, %r197, 8;\n+\tst.global.u8 \t[%rd2+77], %r200;\n+\tst.global.u8 \t[%rd2+76], %r197;\n+\tret;\n+}\n+)\";\n+\n+constexpr stream_executor::CudaComputeCapability kDefaultComputeCapability{8,\n+                                                                           0};\n \n TEST_P(CompilationProviderTest, CompileStandaloneModuleSucceeds) {\n   CompilationOptions options;\n@@ -384,27 +705,24 @@ TEST_P(CompilationProviderTest, CancelsOnRegSpill) {\n     GTEST_SKIP() << \"Driver compilation doesn't support cancel_if_reg_spill\";\n   }\n \n-  std::string dependent_ptx = absl::StrReplaceAll(\n-      kDependentPtx, {{\"// Insert .maxnreg directive here!\", \".maxnreg 16\"}});\n-\n   // We have to disable optimization here, otherwise PTXAS will optimize our\n   // trivial register usages away and we don't spill as intended.\n   CompilationOptions options;\n   options.cancel_if_reg_spill = true;\n   options.disable_optimizations = true;\n \n-  EXPECT_THAT(compilation_provider()->CompileAndLink(\n-                  kDefaultComputeCapability,\n-                  {Ptx{dependent_ptx}, Ptx{kDependeePtx}}, options),\n-              absl_testing::StatusIs(absl::StatusCode::kCancelled));\n+  EXPECT_THAT(\n+      compilation_provider()->CompileAndLink(\n+          kDefaultComputeCapability, {Ptx{kSpillingKernelPrefix}}, options),\n+      absl_testing::StatusIs(absl::StatusCode::kCancelled));\n \n   // This is to make sure we didn't break the PTX and that's why it was failing\n   // in the previous assertion.\n   options.cancel_if_reg_spill = false;\n-  EXPECT_THAT(compilation_provider()->CompileAndLink(\n-                  kDefaultComputeCapability,\n-                  {Ptx{dependent_ptx}, Ptx{kDependeePtx}}, options),\n-              absl_testing::IsOk());\n+  EXPECT_THAT(\n+      compilation_provider()->CompileAndLink(\n+          kDefaultComputeCapability, {Ptx{kSpillingKernelPrefix}}, options),\n+      absl_testing::IsOk());\n }\n \n TEST_P(CompilationProviderTest,"
        }
    ],
    "stats": {
        "total": 354,
        "additions": 336,
        "deletions": 18
    }
}