{
    "author": "beckerhe",
    "message": "Remove HloGraphDumper dependency from xla::Executable\n\nThis dependency is not used in xla::Executable.\n\nTwo files from xla/tools were relying on this include transitively,\nso I've fixed that as well.\n\nPiperOrigin-RevId: 801758522",
    "sha": "a7b43d6293fb7477cdef16e028f2029356b36094",
    "files": [
        {
            "sha": "21f39b6b359561b0b3dd0c670753a0f29350d643",
            "filename": "third_party/xla/xla/service/BUILD",
            "status": "modified",
            "additions": 9,
            "deletions": 4,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2FBUILD?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -18,7 +18,7 @@ load(\"//xla/service:xla_compile.bzl\", \"xla_aot_compile_cpu\", \"xla_aot_compile_gp\n load(\"//xla/stream_executor:build_defs.bzl\", \"if_cuda_or_rocm_is_configured\", \"if_gpu_is_configured\")\n load(\"//xla/tests:build_defs.bzl\", \"xla_test\")\n load(\"//xla/tsl:tsl.bzl\", \"if_google\", \"if_libtpu\", \"internal_visibility\", \"tsl_copts\")\n-load(\"//xla/tsl:tsl.default.bzl\", \"filegroup\", \"get_compatible_with_portable\", \"internal_hlo_deps\")\n+load(\"//xla/tsl:tsl.default.bzl\", \"filegroup\", \"get_compatible_with_portable\")\n load(\n     \"//xla/tsl/platform:build_config.bzl\",\n     \"tf_proto_library\",\n@@ -1504,13 +1504,11 @@ cc_library(\n         \":computation_layout\",\n         \":dump\",\n         \":hlo_execution_profile\",\n-        \":hlo_graph_dumper\",\n         \":hlo_module_config\",\n         \":hlo_proto_cc\",\n         \":maybe_owning_device_memory\",\n         \":shaped_buffer\",\n         \":stream_pool\",\n-        \"//xla:debug_options_flags\",\n         \"//xla:executable_run_options\",\n         \"//xla:shape_tree\",\n         \"//xla:shape_util\",\n@@ -1519,16 +1517,23 @@ cc_library(\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/stream_executor:device_description\",\n+        \"//xla/stream_executor:device_memory\",\n         \"//xla/stream_executor:device_memory_allocator\",\n+        \"//xla/stream_executor:platform\",\n+        \"//xla/stream_executor:stream\",\n         \"//xla/stream_executor:stream_executor_h\",\n         \"//xla/tsl/lib/strings:proto_serialization\",\n+        \"//xla/tsl/platform:errors\",\n+        \"//xla/tsl/platform:statusor\",\n         \"@com_google_absl//absl/base:core_headers\",\n         \"@com_google_absl//absl/container:flat_hash_set\",\n+        \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/memory\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings:str_format\",\n+        \"@com_google_absl//absl/strings:string_view\",\n         \"@com_google_absl//absl/synchronization\",\n         \"@com_google_absl//absl/types:span\",\n         \"@com_google_absl//absl/types:variant\",\n@@ -1537,7 +1542,7 @@ cc_library(\n         \"@local_tsl//tsl/platform:logging\",\n         \"@local_tsl//tsl/platform:status\",\n         \"@local_tsl//tsl/platform:statusor\",\n-    ] + internal_hlo_deps(),\n+    ],\n )\n \n xla_cc_test("
        },
        {
            "sha": "71a6fc8f258d05a645e0dca146eeef641b3f6cd3",
            "filename": "third_party/xla/xla/service/executable.cc",
            "status": "modified",
            "additions": 14,
            "deletions": 8,
            "changes": 22,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Fservice%2Fexecutable.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Fservice%2Fexecutable.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fexecutable.cc?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -15,22 +15,28 @@ limitations under the License.\n \n #include \"xla/service/executable.h\"\n \n+#include <cstddef>\n+#include <cstdint>\n #include <memory>\n+#include <optional>\n #include <utility>\n+#include <vector>\n \n+#include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n-#include \"absl/strings/str_format.h\"\n+#include \"absl/status/statusor.h\"\n #include \"absl/types/span.h\"\n-#include \"xla/debug_options_flags.h\"\n-#include \"xla/service/dump.h\"\n-#include \"xla/service/hlo_graph_dumper.h\"\n #include \"xla/service/maybe_owning_device_memory.h\"\n+#include \"xla/service/service_executable_run_options.h\"\n #include \"xla/service/shaped_buffer.h\"\n+#include \"xla/shape.h\"\n+#include \"xla/shape_util.h\"\n #include \"xla/status_macros.h\"\n-#include \"xla/stream_executor/device_description.h\"\n-#include \"tsl/platform/env.h\"\n-#include \"tsl/platform/errors.h\"\n-#include \"tsl/platform/status.h\"\n+#include \"xla/stream_executor/device_memory.h\"\n+#include \"xla/stream_executor/device_memory_allocator.h\"\n+#include \"xla/stream_executor/stream.h\"\n+#include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n \n namespace xla {\n "
        },
        {
            "sha": "53424c5ccbc511eda3fa4d369e904cfbb4672399",
            "filename": "third_party/xla/xla/service/executable.h",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Fservice%2Fexecutable.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Fservice%2Fexecutable.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fexecutable.h?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -28,13 +28,11 @@ limitations under the License.\n #include \"absl/status/statusor.h\"\n #include \"absl/synchronization/mutex.h\"\n #include \"absl/types/span.h\"\n-#include \"xla/debug_options_flags.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/service/buffer_assignment.h\"\n #include \"xla/service/computation_layout.h\"\n #include \"xla/service/hlo.pb.h\"\n #include \"xla/service/hlo_execution_profile.h\"\n-#include \"xla/service/hlo_graph_dumper.h\"\n #include \"xla/service/hlo_module_config.h\"\n #include \"xla/service/maybe_owning_device_memory.h\"\n #include \"xla/service/service_executable_run_options.h\""
        },
        {
            "sha": "4a3e82b5726ce709d1e928e1ea15a78fdb1641a0",
            "filename": "third_party/xla/xla/service/service_executable_run_options.h",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Fservice%2Fservice_executable_run_options.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Fservice%2Fservice_executable_run_options.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fservice_executable_run_options.h?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -20,11 +20,12 @@ limitations under the License.\n #include <utility>\n #include <vector>\n \n+#include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n #include \"xla/executable_run_options.h\"\n #include \"xla/service/stream_pool.h\"\n-#include \"xla/stream_executor/stream_executor.h\"\n-#include \"tsl/platform/statusor.h\"\n+#include \"xla/stream_executor/platform.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n \n namespace xla {\n "
        },
        {
            "sha": "c1f5004b7eac9946c2613e7ec04be9bdc19e45b2",
            "filename": "third_party/xla/xla/tools/BUILD",
            "status": "modified",
            "additions": 14,
            "deletions": 1,
            "changes": 15,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftools%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftools%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftools%2FBUILD?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -305,20 +305,34 @@ xla_cc_binary(\n     srcs = [\"interactive_graphviz.cc\"],\n     deps = [\n         \":hlo_extractor\",\n+        \"//xla:debug_options_flags\",\n+        \"//xla:shape_util\",\n         \"//xla/client:client_library\",\n         \"//xla/client:local_client\",\n+        \"//xla/hlo/ir:hlo\",\n+        \"//xla/hlo/parser:hlo_parser\",\n         \"//xla/service:compiler\",\n         \"//xla/service:cpu_plugin\",\n+        \"//xla/service:hlo_graph_dumper\",\n         \"//xla/service:hlo_module_util\",\n         \"//xla/service:hlo_proto_cc\",\n         \"//xla/service:local_service\",\n         \"//xla/service:platform_util\",\n+        \"//xla/stream_executor:platform\",\n+        \"//xla/stream_executor:stream_executor_h\",\n+        \"//xla/tsl/platform:env\",\n+        \"//xla/tsl/platform:errors\",\n+        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:subprocess\",\n         \"//xla/tsl/protobuf:error_codes_proto_impl_cc\",\n         \"//xla/tsl/util:command_line_flags\",\n         \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/container:flat_hash_set\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/strings:str_format\",\n+        \"@com_google_absl//absl/types:span\",\n         \"@local_tsl//tsl/platform:logging\",\n         \"@local_tsl//tsl/platform:path\",\n         \"@local_tsl//tsl/platform:platform_port\",\n@@ -334,7 +348,6 @@ xla_cc_binary(\n         \"//xla/stream_executor:rocm_platform\",\n     ]) + xla_internal(\n         [\"service:hlo_graph_dumper_google\"],\n-        otherwise = [\"//xla/service:hlo_graph_dumper\"],\n     ),\n )\n "
        },
        {
            "sha": "b66ed0de60d137f417b21a6bae969fa8abe37d01",
            "filename": "third_party/xla/xla/tools/hlo_opt/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftools%2Fhlo_opt%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftools%2Fhlo_opt%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftools%2Fhlo_opt%2FBUILD?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -46,6 +46,7 @@ cc_library(\n         \"//xla/service:conditional_to_select\",\n         \"//xla/service:executable\",\n         \"//xla/service:gather_expander\",\n+        \"//xla/service:hlo_graph_dumper\",\n         \"//xla/service:map_inliner\",\n         \"//xla/service:platform_util\",\n         \"//xla/service:reduce_scatter_reassociate\","
        },
        {
            "sha": "eac111f6e420125268d518ef99215eef4707a0fb",
            "filename": "third_party/xla/xla/tools/hlo_opt/compiled_opt_lib.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftools%2Fhlo_opt%2Fcompiled_opt_lib.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftools%2Fhlo_opt%2Fcompiled_opt_lib.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftools%2Fhlo_opt%2Fcompiled_opt_lib.cc?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -40,6 +40,7 @@ limitations under the License.\n #include \"xla/service/gpu/transforms/collectives/all_reduce_splitter.h\"\n #include \"xla/service/gpu/transforms/scatter_expander.h\"\n #include \"xla/service/gpu/transforms/scatter_slice_simplifier.h\"\n+#include \"xla/service/hlo_graph_dumper.h\"\n #include \"xla/service/map_inliner.h\"\n #include \"xla/service/platform_util.h\"\n #include \"xla/service/reduce_scatter_reassociate.h\""
        },
        {
            "sha": "dffd0ca7a7c9cfc2814f8fb1754a5b73af7914a6",
            "filename": "third_party/xla/xla/tools/interactive_graphviz.cc",
            "status": "modified",
            "additions": 23,
            "deletions": 5,
            "changes": 28,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftools%2Finteractive_graphviz.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftools%2Finteractive_graphviz.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftools%2Finteractive_graphviz.cc?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -27,29 +27,47 @@ limitations under the License.\n \n #include <stdio.h>\n \n-#include <functional>\n+#include <cstdint>\n+#include <iostream>\n+#include <memory>\n+#include <ostream>\n #include <string>\n #include <utility>\n+#include <vector>\n \n #include \"absl/algorithm/container.h\"\n #include \"absl/container/flat_hash_set.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/statusor.h\"\n #include \"absl/strings/match.h\"\n #include \"absl/strings/numbers.h\"\n #include \"absl/strings/str_cat.h\"\n+#include \"absl/strings/str_format.h\"\n #include \"absl/strings/str_split.h\"\n-#include \"xla/client/client_library.h\"\n-#include \"xla/client/local_client.h\"\n+#include \"absl/strings/string_view.h\"\n+#include \"absl/types/span.h\"\n+#include \"xla/debug_options_flags.h\"\n+#include \"xla/hlo/ir/hlo_computation.h\"\n+#include \"xla/hlo/ir/hlo_instruction.h\"\n+#include \"xla/hlo/ir/hlo_module.h\"\n+#include \"xla/hlo/ir/hlo_opcode.h\"\n+#include \"xla/hlo/ir/hlo_print_options.h\"\n #include \"xla/service/compiler.h\"\n #include \"xla/service/hlo.pb.h\"\n+#include \"xla/service/hlo_graph_dumper.h\"\n #include \"xla/service/hlo_module_util.h\"\n-#include \"xla/service/local_service.h\"\n #include \"xla/service/platform_util.h\"\n+#include \"xla/shape_util.h\"\n+#include \"xla/stream_executor/platform.h\"\n+#include \"xla/stream_executor/stream_executor.h\"\n #include \"xla/tools/hlo_extractor.h\"\n+#include \"xla/tsl/platform/env.h\"\n+#include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/subprocess.h\"\n #include \"xla/tsl/protobuf/error_codes.pb.h\"\n #include \"xla/tsl/util/command_line_flags.h\"\n #include \"tsl/platform/init_main.h\"\n-#include \"tsl/platform/logging.h\"\n #include \"tsl/platform/path.h\"\n #if defined(PLATFORM_GOOGLE)\n #include \"util/readline/readline.h\""
        },
        {
            "sha": "b35b6789697c41fb96c7492b6fe7c666538ed14a",
            "filename": "third_party/xla/xla/tsl/tsl.bzl",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftsl%2Ftsl.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftsl%2Ftsl.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Ftsl.bzl?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -500,9 +500,6 @@ def get_compatible_with_libtpu_portable():\n def filegroup(**kwargs):\n     native.filegroup(**kwargs)\n \n-def internal_hlo_deps():\n-    return []\n-\n # Config setting selector used when building for products\n # which requires restricted licenses to be avoided.\n def if_not_mobile_or_arm_or_macos_or_lgpl_restricted(a):"
        },
        {
            "sha": "5a2547c001eaeb8fd73fb0a2cc53b4f239bc0fc3",
            "filename": "third_party/xla/xla/tsl/tsl.default.bzl",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftsl%2Ftsl.default.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7b43d6293fb7477cdef16e028f2029356b36094/third_party%2Fxla%2Fxla%2Ftsl%2Ftsl.default.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Ftsl.default.bzl?ref=a7b43d6293fb7477cdef16e028f2029356b36094",
            "patch": "@@ -7,7 +7,6 @@ load(\n     _get_compatible_with_libtpu_portable = \"get_compatible_with_libtpu_portable\",\n     _get_compatible_with_portable = \"get_compatible_with_portable\",\n     _if_not_mobile_or_arm_or_macos_or_lgpl_restricted = \"if_not_mobile_or_arm_or_macos_or_lgpl_restricted\",\n-    _internal_hlo_deps = \"internal_hlo_deps\",\n     _tsl_extra_config_settings = \"tsl_extra_config_settings\",\n     _tsl_extra_config_settings_targets = \"tsl_extra_config_settings_targets\",\n     _tsl_google_bzl_deps = \"tsl_google_bzl_deps\",\n@@ -21,7 +20,6 @@ get_compatible_with_portable = _get_compatible_with_portable\n get_compatible_with_libtpu_portable = _get_compatible_with_libtpu_portable\n filegroup = _filegroup\n if_not_mobile_or_arm_or_macos_or_lgpl_restricted = _if_not_mobile_or_arm_or_macos_or_lgpl_restricted\n-internal_hlo_deps = _internal_hlo_deps\n tsl_grpc_cc_dependencies = _tsl_grpc_cc_dependencies\n tsl_pybind_extension = _tsl_pybind_extension\n tsl_google_bzl_deps = _tsl_google_bzl_deps"
        }
    ],
    "stats": {
        "total": 92,
        "additions": 65,
        "deletions": 27
    }
}