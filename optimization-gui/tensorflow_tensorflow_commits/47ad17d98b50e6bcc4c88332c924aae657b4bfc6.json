{
    "author": "smit-hinsu",
    "message": "Replace std::unordered_set with absl::flat_hash_set in RangeSampler.\n\nabsl::flat_hash_set is a more performant and modern alternative to std::unordered_set. This change also includes reserving space in the set to potentially improve performance by reducing reallocations.\nPiperOrigin-RevId: 823256979",
    "sha": "47ad17d98b50e6bcc4c88332c924aae657b4bfc6",
    "files": [
        {
            "sha": "f59d8df511ecc527a1d9d9d0155e03c293522570",
            "filename": "tensorflow/core/kernels/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/47ad17d98b50e6bcc4c88332c924aae657b4bfc6/tensorflow%2Fcore%2Fkernels%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/47ad17d98b50e6bcc4c88332c924aae657b4bfc6/tensorflow%2Fcore%2Fkernels%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2FBUILD?ref=47ad17d98b50e6bcc4c88332c924aae657b4bfc6",
            "patch": "@@ -2451,6 +2451,7 @@ cc_library(\n     deps = [\n         \"//tensorflow/core:lib\",\n         \"//tensorflow/core:lib_internal\",\n+        \"@com_google_absl//absl/container:flat_hash_set\",\n     ],\n )\n "
        },
        {
            "sha": "6cc2966a78a9a21a26707d9a39a64981757f03f6",
            "filename": "tensorflow/core/kernels/range_sampler.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/47ad17d98b50e6bcc4c88332c924aae657b4bfc6/tensorflow%2Fcore%2Fkernels%2Frange_sampler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/47ad17d98b50e6bcc4c88332c924aae657b4bfc6/tensorflow%2Fcore%2Fkernels%2Frange_sampler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2Frange_sampler.cc?ref=47ad17d98b50e6bcc4c88332c924aae657b4bfc6",
            "patch": "@@ -16,9 +16,9 @@ limitations under the License.\n #include \"tensorflow/core/kernels/range_sampler.h\"\n \n #include <cmath>\n-#include <unordered_set>\n #include <vector>\n \n+#include \"absl/container/flat_hash_set.h\"\n #include \"tensorflow/core/lib/core/errors.h\"\n #include \"tensorflow/core/lib/gtl/map_util.h\"\n #include \"tensorflow/core/lib/io/inputbuffer.h\"\n@@ -83,7 +83,8 @@ void RangeSampler::SampleBatchGetExpectedCountAvoid(\n \n   if (unique) {\n     CHECK_LE(static_cast<int64_t>(batch_size + avoided_values.size()), range_);\n-    std::unordered_set<int64_t> used(batch_size);\n+    absl::flat_hash_set<int64_t> used;\n+    used.reserve(batch_size + avoided_values.size());\n     used.insert(avoided_values.begin(), avoided_values.end());\n     int num_picked = 0;\n     num_tries = 0;"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
    }
}