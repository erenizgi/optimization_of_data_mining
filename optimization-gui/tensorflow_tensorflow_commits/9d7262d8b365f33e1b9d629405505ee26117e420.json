{
    "author": "tensorflower-gardener",
    "message": "Reverts 2de5219a6d433df522a69cbd822c6b8e782b1f4b\n\nPiperOrigin-RevId: 810883024",
    "sha": "9d7262d8b365f33e1b9d629405505ee26117e420",
    "files": [
        {
            "sha": "91c495bb2c8c1cd48cf338f0fbad55f93da02c35",
            "filename": "tensorflow/core/framework/node_properties.h",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9d7262d8b365f33e1b9d629405505ee26117e420/tensorflow%2Fcore%2Fframework%2Fnode_properties.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9d7262d8b365f33e1b9d629405505ee26117e420/tensorflow%2Fcore%2Fframework%2Fnode_properties.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fframework%2Fnode_properties.h?ref=9d7262d8b365f33e1b9d629405505ee26117e420",
            "patch": "@@ -36,12 +36,12 @@ struct NodeProperties {\n \n   NodeProperties(const OpDef* _op_def, NodeDef&& _node_def,\n                  DataTypeVector inputs, DataTypeVector outputs)\n-      : output_types(std::move(outputs)),\n+      : op_def(_op_def),\n+        node_def(std::move(_node_def)),\n         input_types(std::move(inputs)),\n-        output_types_slice(output_types),\n         input_types_slice(input_types),\n-        node_def(std::move(_node_def)),\n-        op_def(_op_def) {}\n+        output_types(std::move(outputs)),\n+        output_types_slice(output_types) {}\n \n   // Resets the 'props' shared pointer to point to a new NodeProperties created\n   // from the given NodeDef. 'op_registry' is used to look up the OpDef\n@@ -51,12 +51,12 @@ struct NodeProperties {\n       NodeDef node_def, const OpRegistryInterface* op_registry,\n       std::shared_ptr<const NodeProperties>* props);\n \n-  DataTypeVector output_types;\n+  const OpDef* op_def;  // not owned.\n+  NodeDef node_def;\n   DataTypeVector input_types;\n-  DataTypeSlice output_types_slice;\n   DataTypeSlice input_types_slice;\n-  NodeDef node_def;\n-  const OpDef* op_def;  // not owned.\n+  DataTypeVector output_types;\n+  DataTypeSlice output_types_slice;\n };\n \n }  // namespace tensorflow"
        },
        {
            "sha": "b36c8e99a65bcb4404976b0818e249b07b6e6d21",
            "filename": "tensorflow/core/tfrt/fallback/op_kernel_runner.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9d7262d8b365f33e1b9d629405505ee26117e420/tensorflow%2Fcore%2Ftfrt%2Ffallback%2Fop_kernel_runner.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9d7262d8b365f33e1b9d629405505ee26117e420/tensorflow%2Fcore%2Ftfrt%2Ffallback%2Fop_kernel_runner.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftfrt%2Ffallback%2Fop_kernel_runner.cc?ref=9d7262d8b365f33e1b9d629405505ee26117e420",
            "patch": "@@ -148,14 +148,17 @@ absl::StatusOr<OpKernelRunner> OpKernelRunner::Create(\n     return absl::InternalError(\n         absl::StrCat(\"Failed to create OpKernel for op: \", op_name));\n   }\n-  return OpKernelRunner(device, function_library_runtime, std::move(op_kernel));\n+  return OpKernelRunner(op_name, device, function_library_runtime,\n+                        std::move(op_kernel));\n }\n \n OpKernelRunner::OpKernelRunner(\n-    tensorflow::Device* device,\n+    absl::string_view op_name, tensorflow::Device* device,\n     tensorflow::FunctionLibraryRuntime* function_library_runtime,\n     std::unique_ptr<tensorflow::OpKernel> op_kernel)\n-    : op_kernel_(std::move(op_kernel)), info_(std::make_unique<Info>()) {\n+    : op_kernel_(std::move(op_kernel)),\n+      op_name_(op_name),\n+      info_(std::make_unique<Info>()) {\n   DCHECK(device);\n   DCHECK(function_library_runtime);\n "
        },
        {
            "sha": "4b0987cf984f513da205534e7239c1aa7743e1da",
            "filename": "tensorflow/core/tfrt/fallback/op_kernel_runner.h",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9d7262d8b365f33e1b9d629405505ee26117e420/tensorflow%2Fcore%2Ftfrt%2Ffallback%2Fop_kernel_runner.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9d7262d8b365f33e1b9d629405505ee26117e420/tensorflow%2Fcore%2Ftfrt%2Ffallback%2Fop_kernel_runner.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftfrt%2Ffallback%2Fop_kernel_runner.h?ref=9d7262d8b365f33e1b9d629405505ee26117e420",
            "patch": "@@ -129,10 +129,15 @@ class OpKernelRunner {\n \n  private:\n   explicit OpKernelRunner(\n-      tensorflow::Device* device,\n+      absl::string_view op_name, tensorflow::Device* device,\n       tensorflow::FunctionLibraryRuntime* function_library_runtime,\n       std::unique_ptr<OpKernel> op_kernel);\n \n+  std::unique_ptr<OpKernel> op_kernel_;\n+  std::string op_name_;\n+  absl::Span<const AllocatorAttributes> input_alloc_attrs_;\n+  absl::Span<const AllocatorAttributes> output_alloc_attrs_;\n+\n   struct Info {\n     tensorflow::Device* device = nullptr;\n     tensorflow::FunctionLibraryRuntime* function_library_runtime = nullptr;\n@@ -141,11 +146,7 @@ class OpKernelRunner {\n     absl::InlinedVector<AllocatorAttributes, 4UL> input_alloc_attrs;\n     absl::InlinedVector<AllocatorAttributes, 1UL> output_alloc_attrs;\n   };\n-\n-  std::unique_ptr<OpKernel> op_kernel_;\n-  absl::Span<const AllocatorAttributes> input_alloc_attrs_;\n   std::unique_ptr<Info> info_;\n-  absl::Span<const AllocatorAttributes> output_alloc_attrs_;\n };\n \n // OpKernelRunState keeps the states needed for per-kernel execution."
        }
    ],
    "stats": {
        "total": 36,
        "additions": 20,
        "deletions": 16
    }
}