{
    "author": "d4n1elchen",
    "message": "[XLA:HLO Diff] Change HLO diff copy-to-clipboard to use element ID.\n\nThis can cut the HTML size in half.\n\nPiperOrigin-RevId: 805131847",
    "sha": "476cfbed2d853f7b41577afac68021dd62b896a7",
    "files": [
        {
            "sha": "674bf3c8d755e4007e1e26e7ffe33c567f54f430",
            "filename": "third_party/xla/xla/hlo/tools/hlo_diff/render/hlo_gumgraph_html_renderer.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/476cfbed2d853f7b41577afac68021dd62b896a7/third_party%2Fxla%2Fxla%2Fhlo%2Ftools%2Fhlo_diff%2Frender%2Fhlo_gumgraph_html_renderer.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/476cfbed2d853f7b41577afac68021dd62b896a7/third_party%2Fxla%2Fxla%2Fhlo%2Ftools%2Fhlo_diff%2Frender%2Fhlo_gumgraph_html_renderer.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Ftools%2Fhlo_diff%2Frender%2Fhlo_gumgraph_html_renderer.cc?ref=476cfbed2d853f7b41577afac68021dd62b896a7",
            "patch": "@@ -316,7 +316,8 @@ std::string PrintCss() {\n std::string PrintJavascript() {\n   return R\"html(\n   <script defer>\n-  function CopyToClipboard(text) {\n+  function CopyToClipboard(id) {\n+    const text = document.getElementById(id).textContent;\n     navigator.clipboard.writeText(text);\n     const tooltip = event.srcElement.querySelector('.tooltiptext');\n     tooltip.textContent = 'Copied to clipboard';\n@@ -611,11 +612,10 @@ std::string PrintTooltip(absl::string_view text, absl::string_view tooltip_text,\n \n // Print click to copy button.\n std::string PrintClickToCopyButton(absl::string_view text,\n-                                   absl::string_view content) {\n+                                   absl::string_view pre_id) {\n   return absl::StrFormat(\n-      R\"html(<span class=\"click-to-copy\" onclick=\"CopyToClipboard(`%s`)\">%s</span>)html\",\n-      EscapeStringForHtmlAttribute(content),\n-      PrintTooltip(text, \"Click to copy\", TooltipPosition::kLeft));\n+      R\"html(<span class=\"click-to-copy\" onclick=\"CopyToClipboard('%s')\">%s</span>)html\",\n+      pre_id, PrintTooltip(text, \"Click to copy\", TooltipPosition::kLeft));\n }\n \n // Print textbox with click to copy button.\n@@ -625,7 +625,7 @@ std::string PrintTextbox(absl::string_view title, absl::string_view content,\n       PrintDiv(title, {\"title\"}),\n       PrintDiv(absl::StrCat(absl::StrFormat(R\"html(<pre id=\"%s\">%s</pre>)html\",\n                                             id, content),\n-                            PrintClickToCopyButton(\"ðŸ“‹\", content)),\n+                            PrintClickToCopyButton(\"ðŸ“‹\", id)),\n                {\"textbox\"}));\n }\n "
        }
    ],
    "stats": {
        "total": 12,
        "additions": 6,
        "deletions": 6
    }
}