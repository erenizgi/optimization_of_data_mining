{
    "author": "tensorflower-gardener",
    "message": "Add option to omit channel id values when printing HLO instructions\n\nPiperOrigin-RevId: 807177632",
    "sha": "b8b05aba7b17b2f017a828af66afd5d10fd3946e",
    "files": [
        {
            "sha": "878dc048525baebebda0b2f67182f8b4c563b7b5",
            "filename": "third_party/xla/xla/hlo/ir/hlo_instructions.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 3,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b8b05aba7b17b2f017a828af66afd5d10fd3946e/third_party%2Fxla%2Fxla%2Fhlo%2Fir%2Fhlo_instructions.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b8b05aba7b17b2f017a828af66afd5d10fd3946e/third_party%2Fxla%2Fxla%2Fhlo%2Fir%2Fhlo_instructions.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fir%2Fhlo_instructions.cc?ref=b8b05aba7b17b2f017a828af66afd5d10fd3946e",
            "patch": "@@ -707,12 +707,17 @@ HloInstructionProto HloChannelInstruction::ToProto() const {\n }\n \n void HloChannelInstruction::PrintExtraAttributesImpl(\n-    AttributePrinter& printer, const HloPrintOptions& /*options*/) const {\n+    AttributePrinter& printer, const HloPrintOptions& options) const {\n   if (!channel_id_) {\n     return;\n   }\n-  printer.Next([this](Printer* printer) {\n-    AppendCat(printer, \"channel_id=\", *channel_id_);\n+  printer.Next([this, &options](Printer* printer) {\n+    printer->Append(\"channel_id=\");\n+    if (options.print_channel_id()) {\n+      printer->Append(*channel_id_);\n+    } else {\n+      printer->Append(\"_\");\n+    }\n   });\n }\n "
        },
        {
            "sha": "cd4a72bb176dd806a34a282f913691137c4d92fe",
            "filename": "third_party/xla/xla/hlo/ir/hlo_print_options.h",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b8b05aba7b17b2f017a828af66afd5d10fd3946e/third_party%2Fxla%2Fxla%2Fhlo%2Fir%2Fhlo_print_options.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b8b05aba7b17b2f017a828af66afd5d10fd3946e/third_party%2Fxla%2Fxla%2Fhlo%2Fir%2Fhlo_print_options.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fir%2Fhlo_print_options.h?ref=b8b05aba7b17b2f017a828af66afd5d10fd3946e",
            "patch": "@@ -82,7 +82,8 @@ class HloPrintOptions {\n         syntax_sugar_async_ops_(true),\n         print_name_after_closing_brace_(false),\n         print_full_replica_group_list_(false),\n-        print_parameter_number_(true) {}\n+        print_parameter_number_(true),\n+        print_channel_id_(true) {}\n   // Static reference to a default construction HloPrintOptions, to avoid\n   // constructing a new one each time default is needed.\n   static const HloPrintOptions& Default() {\n@@ -375,6 +376,13 @@ class HloPrintOptions {\n     return *this;\n   }\n \n+  // If false, the presence of a channel id will still be printed but the\n+  // actual value will not be printed.\n+  HloPrintOptions& set_print_channel_id(bool value) {\n+    print_channel_id_ = value;\n+    return *this;\n+  }\n+\n   bool print_large_constants() const { return print_large_constants_; }\n   bool print_only_essential_constants() const {\n     return print_only_essential_constants_;\n@@ -424,6 +432,7 @@ class HloPrintOptions {\n     return print_full_replica_group_list_;\n   }\n   bool print_parameter_number() const { return print_parameter_number_; }\n+  bool print_channel_id() const { return print_channel_id_; }\n \n  private:\n   // The interval between the /*index=*/ annotated operands. 0 means never print\n@@ -457,6 +466,7 @@ class HloPrintOptions {\n   bool print_name_after_closing_brace_;\n   bool print_full_replica_group_list_;\n   bool print_parameter_number_;\n+  bool print_channel_id_;\n };\n \n // For canonical string output, we need to have a canonical way to rename"
        }
    ],
    "stats": {
        "total": 23,
        "additions": 19,
        "deletions": 4
    }
}