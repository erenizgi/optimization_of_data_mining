{
    "author": "WillFroom",
    "message": "[XLA:CPU][XTile] Increase number of iterations in fuse elementwise.\n\nPiperOrigin-RevId: 840829146",
    "sha": "208689ad5114ca5729c279fe591456d4246e1e06",
    "files": [
        {
            "sha": "0989cf3c59b5add49a5dd28ad33ee8c41da50929",
            "filename": "third_party/xla/xla/backends/cpu/codegen/tiled/transforms/fuse_elementwise_pass.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/208689ad5114ca5729c279fe591456d4246e1e06/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftransforms%2Ffuse_elementwise_pass.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/208689ad5114ca5729c279fe591456d4246e1e06/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftransforms%2Ffuse_elementwise_pass.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftransforms%2Ffuse_elementwise_pass.cc?ref=208689ad5114ca5729c279fe591456d4246e1e06",
            "patch": "@@ -56,8 +56,12 @@ class FuseElementwisePass\n     mlir::linalg::populateElementwiseOpsFusionPatterns(patterns,\n                                                        fuse_control_fn);\n \n-    if (mlir::failed(\n-            mlir::applyPatternsGreedily(getOperation(), std::move(patterns)))) {\n+    // Long chains of elementwise ops can require many iterations, so we have to\n+    // increase the limit from the default 10.\n+    mlir::GreedyRewriteConfig config;\n+    config.setMaxIterations(1000);\n+    if (mlir::failed(mlir::applyPatternsGreedily(\n+            getOperation(), std::move(patterns), config))) {\n       signalPassFailure();\n       return;\n     }"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
    }
}