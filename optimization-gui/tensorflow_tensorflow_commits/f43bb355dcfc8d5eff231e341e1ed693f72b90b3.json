{
    "author": "tensorflower-gardener",
    "message": "[SymbolicMap] Replace `std::vector` with `llvm::SmallVector`\n\nPiperOrigin-RevId: 801739398",
    "sha": "f43bb355dcfc8d5eff231e341e1ed693f72b90b3",
    "files": [
        {
            "sha": "749636bbf48ee575477553bb6501115f7441818f",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_map.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 8,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f43bb355dcfc8d5eff231e341e1ed693f72b90b3/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f43bb355dcfc8d5eff231e341e1ed693f72b90b3/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.cc?ref=f43bb355dcfc8d5eff231e341e1ed693f72b90b3",
            "patch": "@@ -18,7 +18,6 @@ limitations under the License.\n #include <cstdint>\n #include <iterator>\n #include <utility>\n-#include <vector>\n \n #include \"absl/algorithm/container.h\"\n #include \"absl/log/check.h\"\n@@ -31,9 +30,10 @@ namespace gpu {\n \n namespace {\n \n-std::vector<SymbolicExpr> CreateVariableRange(SymbolicExprContext* ctx,\n-                                              int64_t n, int64_t offset = 0) {\n-  std::vector<SymbolicExpr> replacements;\n+llvm::SmallVector<SymbolicExpr> CreateVariableRange(SymbolicExprContext* ctx,\n+                                                    int64_t n,\n+                                                    int64_t offset = 0) {\n+  llvm::SmallVector<SymbolicExpr> replacements;\n   replacements.reserve(n);\n   for (int64_t i = 0; i < n; ++i) {\n     replacements.push_back(ctx->CreateVariable(offset + i));\n@@ -44,7 +44,8 @@ std::vector<SymbolicExpr> CreateVariableRange(SymbolicExprContext* ctx,\n }  // namespace\n \n SymbolicMap::SymbolicMap(SymbolicExprContext* ctx, int64_t num_dimensions,\n-                         int64_t num_symbols, std::vector<SymbolicExpr> exprs)\n+                         int64_t num_symbols,\n+                         llvm::SmallVector<SymbolicExpr> exprs)\n     : ctx_(ctx),\n       num_dimensions_(num_dimensions),\n       num_symbols_(num_symbols),\n@@ -53,7 +54,7 @@ SymbolicMap::SymbolicMap(SymbolicExprContext* ctx, int64_t num_dimensions,\n /*static*/ SymbolicMap SymbolicMap::Get(SymbolicExprContext* ctx,\n                                         int64_t num_dimensions,\n                                         int64_t num_symbols,\n-                                        std::vector<SymbolicExpr> exprs) {\n+                                        llvm::SmallVector<SymbolicExpr> exprs) {\n   return SymbolicMap(ctx, num_dimensions, num_symbols, std::move(exprs));\n }\n \n@@ -101,7 +102,7 @@ SymbolicMap SymbolicMap::ReplaceDimsAndSymbols(\n   absl::c_copy(dim_replacements, std::back_inserter(all_replacements));\n   absl::c_copy(sym_replacements, std::back_inserter(all_replacements));\n \n-  std::vector<SymbolicExpr> new_exprs;\n+  llvm::SmallVector<SymbolicExpr> new_exprs;\n   new_exprs.reserve(exprs_.size());\n   for (const auto& expr : exprs_) {\n     new_exprs.push_back(expr.ReplaceVariables(all_replacements));\n@@ -137,7 +138,7 @@ SymbolicMap SymbolicMap::Compose(const SymbolicMap& other) const {\n \n SymbolicMap SymbolicMap::Replace(SymbolicExpr expr,\n                                  SymbolicExpr replacement) const {\n-  std::vector<SymbolicExpr> new_exprs;\n+  llvm::SmallVector<SymbolicExpr> new_exprs;\n   new_exprs.reserve(exprs_.size());\n   bool changed = false;\n   for (const auto& e : exprs_) {"
        },
        {
            "sha": "a2a818c2f5c72db86298caf667d417660971b947",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_map.h",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f43bb355dcfc8d5eff231e341e1ed693f72b90b3/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f43bb355dcfc8d5eff231e341e1ed693f72b90b3/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h?ref=f43bb355dcfc8d5eff231e341e1ed693f72b90b3",
            "patch": "@@ -17,7 +17,6 @@ limitations under the License.\n #define XLA_SERVICE_GPU_MODEL_EXPERIMENTAL_SYMBOLIC_MAP_H_\n \n #include <cstdint>\n-#include <vector>\n \n #include \"absl/types/span.h\"\n #include \"llvm/ADT/SmallVector.h\"\n@@ -32,13 +31,14 @@ class SymbolicExprContext;\n class SymbolicMap {\n  public:\n   static SymbolicMap Get(SymbolicExprContext* ctx, int64_t num_dimensions,\n-                         int64_t num_symbols, std::vector<SymbolicExpr> exprs);\n+                         int64_t num_symbols,\n+                         llvm::SmallVector<SymbolicExpr> exprs);\n \n   SymbolicExprContext* GetContext() const { return ctx_; }\n   int64_t GetNumDims() const { return num_dimensions_; }\n   int64_t GetNumSymbols() const { return num_symbols_; }\n   int64_t GetNumResults() const { return exprs_.size(); }\n-  const std::vector<SymbolicExpr>& GetResults() const { return exprs_; }\n+  const llvm::SmallVector<SymbolicExpr>& GetResults() const { return exprs_; }\n   SymbolicExpr GetResult(unsigned idx) const { return exprs_[idx]; }\n \n   bool IsEmpty() const { return exprs_.empty(); }\n@@ -86,12 +86,12 @@ class SymbolicMap {\n \n  private:\n   SymbolicMap(SymbolicExprContext* ctx, int64_t num_dimensions,\n-              int64_t num_symbols, std::vector<SymbolicExpr> exprs);\n+              int64_t num_symbols, llvm::SmallVector<SymbolicExpr> exprs);\n \n   SymbolicExprContext* ctx_;\n   int64_t num_dimensions_;\n   int64_t num_symbols_;\n-  std::vector<SymbolicExpr> exprs_;\n+  llvm::SmallVector<SymbolicExpr> exprs_;\n };\n \n }  // namespace gpu"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 14,
        "deletions": 13
    }
}