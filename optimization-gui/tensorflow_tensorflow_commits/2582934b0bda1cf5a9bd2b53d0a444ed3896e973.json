{
    "author": "frgossen",
    "message": "[XLA:GPU] Add verbose tracing for BlockHostUntilDone and stream synchronization\n\nPiperOrigin-RevId: 819914599",
    "sha": "2582934b0bda1cf5a9bd2b53d0a444ed3896e973",
    "files": [
        {
            "sha": "ad9a078ed73c4e2e9069760205e23222f5fb876a",
            "filename": "third_party/xla/xla/stream_executor/cuda/cuda_stream.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2582934b0bda1cf5a9bd2b53d0a444ed3896e973/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_stream.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2582934b0bda1cf5a9bd2b53d0a444ed3896e973/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_stream.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_stream.cc?ref=2582934b0bda1cf5a9bd2b53d0a444ed3896e973",
            "patch": "@@ -250,6 +250,9 @@ void DestroyStream(StreamExecutor* executor, CUstream stream) {\n }\n \n absl::Status SynchronizeStream(StreamExecutor* executor, CUstream stream) {\n+  TraceMe trace(\n+      [] { return TraceMeEncode(\"CudaStream::SynchronizeStream\", {}); },\n+      /*level=*/TraceMeLevel::kVerbose);\n   std::unique_ptr<ActivateContext> activation = executor->Activate();\n   CHECK(stream != nullptr);\n   return cuda::ToStatus(cuStreamSynchronize(stream),\n@@ -265,6 +268,9 @@ CudaStream::~CudaStream() {\n }\n \n absl::Status CudaStream::BlockHostUntilDone() {\n+  TraceMe trace(\n+      [] { return TraceMeEncode(\"CudaStream::BlockHostUntilDone\", {}); },\n+      /*level=*/TraceMeLevel::kVerbose);\n   TF_RETURN_IF_ERROR(SynchronizeStream(executor_, stream_handle_));\n   absl::MutexLock lock(mutex_);\n   mutex_.Await(absl::Condition(&no_pending_host_callbacks_));"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
    }
}