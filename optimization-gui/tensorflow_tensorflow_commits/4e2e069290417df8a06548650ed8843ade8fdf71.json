{
    "author": "KanishAnand",
    "message": "Add `BuildHloModule` from `XlaBuilder` helper\n\nPiperOrigin-RevId: 810915540",
    "sha": "4e2e069290417df8a06548650ed8843ade8fdf71",
    "files": [
        {
            "sha": "8983d40eda3b486fe0799106bfcc8104d47f1049",
            "filename": "third_party/xla/xla/tests/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4e2e069290417df8a06548650ed8843ade8fdf71/third_party%2Fxla%2Fxla%2Ftests%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4e2e069290417df8a06548650ed8843ade8fdf71/third_party%2Fxla%2Fxla%2Ftests%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2FBUILD?ref=4e2e069290417df8a06548650ed8843ade8fdf71",
            "patch": "@@ -213,6 +213,8 @@ cc_library(\n         \"//xla:shape_util\",\n         \"//xla:util\",\n         \"//xla:xla_data_proto_cc\",\n+        \"//xla/hlo/builder:xla_builder\",\n+        \"//xla/hlo/builder:xla_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/parser:hlo_parser\",\n         \"//xla/hlo/testlib:hlo_hardware_independent_test_base\","
        },
        {
            "sha": "62be9d21cd60a9a6e50ec19bc41e50e218831138",
            "filename": "third_party/xla/xla/tests/hlo_runner_agnostic_test_base.cc",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4e2e069290417df8a06548650ed8843ade8fdf71/third_party%2Fxla%2Fxla%2Ftests%2Fhlo_runner_agnostic_test_base.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4e2e069290417df8a06548650ed8843ade8fdf71/third_party%2Fxla%2Fxla%2Ftests%2Fhlo_runner_agnostic_test_base.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fhlo_runner_agnostic_test_base.cc?ref=4e2e069290417df8a06548650ed8843ade8fdf71",
            "patch": "@@ -34,6 +34,8 @@ limitations under the License.\n #include \"absl/types/span.h\"\n #include \"llvm/ADT/STLExtras.h\"\n #include \"xla/error_spec.h\"\n+#include \"xla/hlo/builder/xla_builder.h\"\n+#include \"xla/hlo/builder/xla_computation.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/parser/hlo_parser.h\"\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n@@ -103,6 +105,22 @@ HloRunnerAgnosticTestBase::ParseAndReturnVerifiedModule(\n       hlo_text, config, parser_options, device_shape_size_fn_);\n }\n \n+absl::StatusOr<std::unique_ptr<HloModule>>\n+HloRunnerAgnosticTestBase::HloModuleFromXlaBuilder(\n+    XlaBuilder* builder, const ExecutionOptions& execution_options) const {\n+  TF_ASSIGN_OR_RETURN(XlaComputation computation, builder->Build());\n+  TF_ASSIGN_OR_RETURN(\n+      HloModuleConfig module_config,\n+      HloModule::CreateModuleConfigFromProto(computation.proto(),\n+                                             execution_options.debug_options(),\n+                                             &execution_options));\n+  TF_ASSIGN_OR_RETURN(\n+      std::unique_ptr<HloModule> module,\n+      HloModule::CreateFromProto(computation.proto(), module_config));\n+  TF_RETURN_IF_ERROR(verifier().Run(module.get()).status());\n+  return module;\n+}\n+\n HloComputation*\n HloRunnerAgnosticTestBase::AddEntryComputationAndUpdateEntryComputationLayout(\n     HloModule* const module, std::unique_ptr<HloComputation> computation) {"
        },
        {
            "sha": "b00eb38fbd773828c32c4d159a3b7e95737d2b5a",
            "filename": "third_party/xla/xla/tests/hlo_runner_agnostic_test_base.h",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4e2e069290417df8a06548650ed8843ade8fdf71/third_party%2Fxla%2Fxla%2Ftests%2Fhlo_runner_agnostic_test_base.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4e2e069290417df8a06548650ed8843ade8fdf71/third_party%2Fxla%2Fxla%2Ftests%2Fhlo_runner_agnostic_test_base.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fhlo_runner_agnostic_test_base.h?ref=4e2e069290417df8a06548650ed8843ade8fdf71",
            "patch": "@@ -32,6 +32,7 @@ limitations under the License.\n #include \"absl/strings/string_view.h\"\n #include \"absl/types/span.h\"\n #include \"xla/error_spec.h\"\n+#include \"xla/hlo/builder/xla_builder.h\"\n #include \"xla/hlo/ir/hlo_computation.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n@@ -136,6 +137,11 @@ class HloRunnerAgnosticTestBase : public HloHardwareIndependentTestBase {\n       absl::string_view hlo_text, const HloModuleConfig& config,\n       const HloParserOptions& parser_options = HloParserOptions()) const;\n \n+  // Builds an HLO module from the given XlaBuilder using the given\n+  // execution options.\n+  absl::StatusOr<std::unique_ptr<HloModule>> HloModuleFromXlaBuilder(\n+      XlaBuilder* builder, const ExecutionOptions& execution_options) const;\n+\n   HloComputation* AddEntryComputationAndUpdateEntryComputationLayout(\n       HloModule*, std::unique_ptr<HloComputation> computation);\n   void UpdateEntryComputationLayout(HloModule* module) const;"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 26,
        "deletions": 0
    }
}