{
    "author": "tensorflower-gardener",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 848078219",
    "sha": "38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85",
    "files": [
        {
            "sha": "b23b7a1b4d4e81ee29f7f50dda06a462c1bd5906",
            "filename": "tensorflow/core/kernels/unique_op.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Funique_op.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Funique_op.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2Funique_op.cc?ref=38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85",
            "patch": "@@ -83,10 +83,10 @@ class UniqueOp : public OpKernel {\n     // TODO(dga):  Make unique polymorphic for returning int32 and int64\n     // vectors to support large tensors.\n     OP_REQUIRES(context,\n-                input.NumElements() <= std::numeric_limits<int32>::max(),\n+                input.NumElements() <= std::numeric_limits<int32_t>::max(),\n                 errors::InvalidArgument(\n                     \"unique does not support input tensors larger than \",\n-                    std::numeric_limits<int32>::max(), \" elements\"));\n+                    std::numeric_limits<int32_t>::max(), \" elements\"));\n \n     int64_t axis = 0;\n     std::vector<int64_t> new_sizes{1, input.NumElements(), 1};\n@@ -115,7 +115,7 @@ class UniqueOp : public OpKernel {\n                         \"axis tensor should be int32 or int64, but got \",\n                         DataTypeString(axis_tensor.dtype())));\n         if (axis_tensor.dtype() == DT_INT32) {\n-          axis = internal::SubtleMustCopy(axis_tensor.scalar<int32>()());\n+          axis = internal::SubtleMustCopy(axis_tensor.scalar<int32_t>()());\n         } else {\n           axis = internal::SubtleMustCopy(axis_tensor.scalar<int64_t>()());\n         }"
        },
        {
            "sha": "b870921666bd8362edf7e01ad137579b48b1970a",
            "filename": "tensorflow/core/kernels/unique_op_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Funique_op_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Funique_op_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2Funique_op_test.cc?ref=38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85",
            "patch": "@@ -84,7 +84,7 @@ void BM_Unique_INT32(::testing::benchmark::State& state) {\n                   \"SINGLE_THREADED_EXECUTOR\", /*old_benchmark_api*/ false)\n       .Run(state);\n   state.SetBytesProcessed(static_cast<int64_t>(state.iterations()) * dim *\n-                          sizeof(int32));\n+                          sizeof(int32_t));\n }\n \n void BM_Unique_INT32_Repeat(::testing::benchmark::State& state) {\n@@ -108,7 +108,7 @@ void BM_Unique_INT32_Repeat(::testing::benchmark::State& state) {\n                   \"SINGLE_THREADED_EXECUTOR\", /*old_benchmark_api*/ false)\n       .Run(state);\n   state.SetBytesProcessed(static_cast<int64_t>(state.iterations()) * dim * 200 *\n-                          sizeof(int32));\n+                          sizeof(int32_t));\n }\n \n TensorProto GetRandomStringsTensorProto(int dim, int max_str_len) {\n@@ -118,7 +118,7 @@ TensorProto GetRandomStringsTensorProto(int dim, int max_str_len) {\n   tensor_proto.mutable_tensor_shape()->set_unknown_rank(false);\n   for (int i = 0; i < dim; ++i) {\n     const int len = std::rand() % max_str_len + 1;\n-    string rand_str;\n+    std::string rand_str;\n     rand_str.resize(len);\n     for (int j = 0; j < len; ++j) {\n       rand_str[j] = static_cast<char>(j % 256);"
        },
        {
            "sha": "a43beaecc040be78a599f8a0a1e016b1902932f0",
            "filename": "tensorflow/core/kernels/variable_ops.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fvariable_ops.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fvariable_ops.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2Fvariable_ops.cc?ref=38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85",
            "patch": "@@ -29,8 +29,8 @@ namespace {\n \n // Makes a unique name for a temporary variable inside a while loop body,\n // because loop can be executed in multiple iterations in parallel.\n-string TemporaryVariableName(const string& var_name,\n-                             const FrameAndIter& control_frame) {\n+std::string TemporaryVariableName(const std::string& var_name,\n+                                  const FrameAndIter& control_frame) {\n   if (control_frame.frame_id != kIllegalFrameId &&\n       control_frame.iter_id != kIllegalIterId) {\n     return strings::StrCat(var_name, \"/frame:\", control_frame.frame_id,\n@@ -53,7 +53,7 @@ class LegacyVar : public ResourceBase {\n   mutex* mu() { return &mu_; }\n   Tensor* tensor() { return &tensor_; }\n \n-  string DebugString() const override {\n+  std::string DebugString() const override {\n     return absl::StrCat(DataTypeString(tensor_.dtype()), \"/\",\n                         tensor_.shape().DebugString());\n   }\n@@ -130,14 +130,14 @@ class TemporaryVariableOp : public OpKernel {\n   struct TmpVar : public ResourceBase {\n     mutex mu;\n     Tensor val;\n-    string name;\n-    string DebugString() const override { return name; }\n+    std::string name;\n+    std::string DebugString() const override { return name; }\n     ~TmpVar() override { VLOG(3) << \"TmpVar \" << name << \" deleted\"; }\n   };\n \n   TensorShape shape_;\n   DataType dtype_;\n-  string var_name_;\n+  std::string var_name_;\n };\n \n class DestroyTemporaryVariableOp : public OpKernel {\n@@ -171,7 +171,7 @@ class DestroyTemporaryVariableOp : public OpKernel {\n   }\n \n  private:\n-  string var_name_;\n+  std::string var_name_;\n };\n \n class IsVariableInitializedOp : public OpKernel {"
        },
        {
            "sha": "6ed93a0e643f2faaf42416ac3d5c65c3cc192878",
            "filename": "tensorflow/core/kernels/variable_ops_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fvariable_ops_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fvariable_ops_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2Fvariable_ops_test.cc?ref=38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85",
            "patch": "@@ -31,7 +31,7 @@ namespace {\n void ManyManyVariablesHelper(int threads, int variables,\n                              ::testing::benchmark::State& state) {\n   Graph g(OpRegistry::Global());\n-  std::vector<string> targets;\n+  std::vector<std::string> targets;\n   for (int i = 0; i < variables; ++i) {\n     Node* v;\n     TF_CHECK_OK("
        },
        {
            "sha": "42c89f61ff3f4815bfaa1fd2855116957af50b98",
            "filename": "tensorflow/core/kernels/where_op.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fwhere_op.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fwhere_op.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2Fwhere_op.cc?ref=38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85",
            "patch": "@@ -259,8 +259,8 @@ class WhereGPUOp : public AsyncOpKernel {\n     const Tensor& input = context->input(0);\n     const int input_dims = input.dims();\n \n-    if (input.NumElements() < std::numeric_limits<int32>::max()) {\n-      ComputeAsyncType<int32>(input, input_dims, context, done);\n+    if (input.NumElements() < std::numeric_limits<int32_t>::max()) {\n+      ComputeAsyncType<int32_t>(input, input_dims, context, done);\n     } else {\n       ComputeAsyncType<int64_t>(input, input_dims, context, done);\n     }\n@@ -282,7 +282,7 @@ class WhereGPUOp : public AsyncOpKernel {\n \n     // Push kernel to stream to get number of true elements.\n     const GPUDevice& d = context->eigen_device<GPUDevice>();\n-    Status s = functor::NumTrue<GPUDevice, T, Tindex>::Compute(\n+    absl::Status s = functor::NumTrue<GPUDevice, T, Tindex>::Compute(\n         context, d, input.flat<T>(), num_true_t);\n     OP_REQUIRES_OK_ASYNC(context, s, done);\n \n@@ -374,9 +374,9 @@ TF_CALL_WHERE_GPU_TYPES(REGISTER_GPU_WHERE_OP);\n \n REGISTER_KERNEL_BUILDER(Name(\"Where\")\n                             .Device(DEVICE_DEFAULT)\n-                            .TypeConstraint<int32>(\"T\")\n+                            .TypeConstraint<int32_t>(\"T\")\n                             .HostMemory(\"input\")\n                             .HostMemory(\"index\"),\n-                        WhereCPUOp<int32>);\n+                        WhereCPUOp<int32_t>);\n \n }  // namespace tensorflow"
        },
        {
            "sha": "36c68d2b14e50849dd0103cf817be38b6a0fe92a",
            "filename": "tensorflow/core/kernels/while_op_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fwhile_op_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fwhile_op_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2Fwhile_op_test.cc?ref=38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85",
            "patch": "@@ -123,7 +123,8 @@ TEST_F(WhileOpTest, WhileOpCPUBuildWithPluggableDevice) {\n #if EIGEN_MAX_ALIGN_BYTES == 0\n     return malloc(size);\n #else\n-    return tensorflow::port::AlignedMalloc(size, EIGEN_MAX_ALIGN_BYTES);\n+    return tsl::port::AlignedMalloc(\n+        size, static_cast<std::align_val_t>(EIGEN_MAX_ALIGN_BYTES));\n #endif\n   };\n   se_.host_memory_deallocate = [](const SP_Device* const device, void* mem) {\n@@ -136,7 +137,8 @@ TEST_F(WhileOpTest, WhileOpCPUBuildWithPluggableDevice) {\n #if EIGEN_MAX_ALIGN_BYTES == 0\n     mem->opaque = malloc(size);\n #else\n-    mem->opaque = tensorflow::port::AlignedMalloc(size, EIGEN_MAX_ALIGN_BYTES);\n+    mem->opaque = tsl::port::AlignedMalloc(\n+        size, static_cast<std::align_val_t>(EIGEN_MAX_ALIGN_BYTES));\n #endif\n     mem->size = size;\n   };"
        },
        {
            "sha": "884c7725f43d6b36480895c4a9a40b6f8e368879",
            "filename": "tensorflow/core/kernels/whole_file_read_ops.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fwhole_file_read_ops.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85/tensorflow%2Fcore%2Fkernels%2Fwhole_file_read_ops.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2Fwhole_file_read_ops.cc?ref=38b33b3d64553e4a6610fd7a4088f9a1a6ca4b85",
            "patch": "@@ -35,7 +35,7 @@ limitations under the License.\n namespace tensorflow {\n \n template <typename T>\n-static absl::Status ReadEntireFile(Env* env, const string& filename,\n+static absl::Status ReadEntireFile(Env* env, const std::string& filename,\n                                    T* contents) {\n   std::unique_ptr<RandomAccessFile> file;\n   TF_RETURN_IF_ERROR(env->NewRandomAccessFile(filename, &file));\n@@ -47,7 +47,7 @@ static absl::Status ReadEntireFile(Env* env, const string& filename,\n \n class WholeFileReader : public ReaderBase {\n  public:\n-  WholeFileReader(Env* env, const string& node_name)\n+  WholeFileReader(Env* env, const std::string& node_name)\n       : ReaderBase(absl::StrCat(\"WholeFileReader '\", node_name, \"'\")),\n         env_(env) {}\n \n@@ -136,8 +136,8 @@ class WriteFileOp : public OpKernel {\n                 errors::InvalidArgument(\n                     \"Contents tensor must be scalar, but had shape: \",\n                     contents_input->shape().DebugString()));\n-    const string& filename = filename_input->scalar<tstring>()();\n-    const string dir(io::Dirname(filename));\n+    const std::string& filename = filename_input->scalar<tstring>()();\n+    const std::string dir(io::Dirname(filename));\n     if (!context->env()->FileExists(dir).ok()) {\n       OP_REQUIRES_OK(context, context->env()->RecursivelyCreateDir(dir));\n     }"
        }
    ],
    "stats": {
        "total": 52,
        "additions": 27,
        "deletions": 25
    }
}