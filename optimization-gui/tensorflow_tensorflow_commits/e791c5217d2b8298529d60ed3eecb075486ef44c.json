{
    "author": "marialyu",
    "message": "Add int16x8 kernel support for equal and not_equal ops\n\nPiperOrigin-RevId: 807869896",
    "sha": "e791c5217d2b8298529d60ed3eecb075486ef44c",
    "files": [
        {
            "sha": "7b386378e61bc92904d9d1a66cc4e1abc55a64d9",
            "filename": "RELEASE.md",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/RELEASE.md",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/RELEASE.md",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/RELEASE.md?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -21,6 +21,7 @@\n \n * `tf.lite`\n     * Adds int8 and int16x8 support for SQRT operator.\n+    * Adds int16x8 support for EQUAL and NOT_EQUAL operators.\n \n ### Bug Fixes and Other Changes\n "
        },
        {
            "sha": "44370d1cfdeb9609c6804e43d38bd80518c48ad2",
            "filename": "tensorflow/compiler/mlir/lite/ir/tfl_ops.td",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Fir%2Ftfl_ops.td",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Fir%2Ftfl_ops.td",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Flite%2Fir%2Ftfl_ops.td?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -1589,8 +1589,8 @@ def TFL_NotEqualOp : TFL_Op<\"not_equal\", [\n   }];\n \n   let arguments = (\n-      ins TFL_TensorOf<[I1, F32, I32, I64, QUI8, QI8, TFL_Quint8, TFL_Str]>:$lhs,\n-      TFL_TensorOf<[I1, F32, I32, I64, QUI8, QI8, TFL_Quint8, TFL_Str]>:$rhs);\n+      ins TFL_TensorOf<[I1, F32, I32, I64, QUI8, QI8, QI16, TFL_Quint8, TFL_Str]>:$lhs,\n+      TFL_TensorOf<[I1, F32, I32, I64, QUI8, QI8, QI16, TFL_Quint8, TFL_Str]>:$rhs);\n \n   let results = (outs TFL_BoolTensor:$output);\n \n@@ -1729,8 +1729,8 @@ def TFL_EqualOp: TFL_Op<\"equal\", [\n \n   let arguments = (\n     ins\n-    TFL_TensorOf<[I1, F32, I16, I32, I64, QI8, QUI8, UI8, TFL_Str]>:$x,\n-    TFL_TensorOf<[I1, F32, I16, I32, I64, QI8, QUI8, UI8, TFL_Str]>:$y\n+    TFL_TensorOf<[I1, F32, I16, I32, I64, QI8, QUI8, QI16, UI8, TFL_Str]>:$x,\n+    TFL_TensorOf<[I1, F32, I16, I32, I64, QI8, QUI8, QI16, UI8, TFL_Str]>:$y\n   );\n \n   let results = (outs TFL_BoolTensor:$output);"
        },
        {
            "sha": "ec4c81ece8c141dbfa22da2f9af2f744baa310fc",
            "filename": "tensorflow/compiler/mlir/lite/tests/ops.mlir",
            "status": "modified",
            "additions": 34,
            "deletions": 0,
            "changes": 34,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftests%2Fops.mlir",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftests%2Fops.mlir",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftests%2Fops.mlir?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -1209,6 +1209,40 @@ func.func @testEqualInt16(tensor<? x i16>, tensor<? x i16>) -> tensor<? x i1> {\n   func.return %0#0 : tensor<? x i1>\n }\n \n+// CHECK-LABEL: testEqualQuant\n+func.func @testEqualQuant(%arg0: tensor<1x80x1x!quant.uniform<i8:f32, 0.04:-128>>, %arg1: tensor<1x80x1x!quant.uniform<i8:f32, 0.04:-128>>) -> tensor<1x80x1xi1> {\n+  %0 = \"tfl.equal\"(%arg0, %arg1) : (tensor<1x80x1x!quant.uniform<i8:f32, 0.04:-128>>, tensor<1x80x1x!quant.uniform<i8:f32, 0.04:-128>>) -> tensor<1x80x1xi1>\n+  func.return %0 : tensor<1x80x1xi1>\n+}\n+\n+// CHECK-LABEL: testEqualQuantWithQI16\n+func.func @testEqualQuantWithQI16(%arg0: tensor<1x80x1x!quant.uniform<i16:f32, 0.04:0>>, %arg1: tensor<1x80x1x!quant.uniform<i16:f32, 0.04:0>>) -> tensor<1x80x1xi1> {\n+  %0 = \"tfl.equal\"(%arg0, %arg1) : (tensor<1x80x1x!quant.uniform<i16:f32, 0.04:0>>, tensor<1x80x1x!quant.uniform<i16:f32, 0.04:0>>) -> tensor<1x80x1xi1>\n+  func.return %0 : tensor<1x80x1xi1>\n+}\n+\n+// -----\n+\n+// CHECK-LABEL: testNotEqual\n+func.func @testNotEqual(tensor<? x f32>, tensor<? x f32>) -> tensor<? x i1> {\n+^bb0(%arg0: tensor<? x f32>, %arg1: tensor<? x f32>):\n+  // CHECK: tfl.not_equal(%arg0, %arg1)\n+  %0 = \"tfl.not_equal\"(%arg0, %arg1) : (tensor<? x f32>, tensor<? x f32>) -> tensor<? x i1>\n+  func.return %0#0 : tensor<? x i1>\n+}\n+\n+// CHECK-LABEL: testNotEqualQuant\n+func.func @testNotEqualQuant(%arg0: tensor<1x80x1x!quant.uniform<i8:f32, 0.04:-128>>, %arg1: tensor<1x80x1x!quant.uniform<i8:f32, 0.04:-128>>) -> tensor<1x80x1xi1> {\n+  %0 = \"tfl.not_equal\"(%arg0, %arg1) : (tensor<1x80x1x!quant.uniform<i8:f32, 0.04:-128>>, tensor<1x80x1x!quant.uniform<i8:f32, 0.04:-128>>) -> tensor<1x80x1xi1>\n+  func.return %0 : tensor<1x80x1xi1>\n+}\n+\n+// CHECK-LABEL: testNotEqualQuantWithQI16\n+func.func @testNotEqualQuantWithQI16(%arg0: tensor<1x80x1x!quant.uniform<i16:f32, 0.04:0>>, %arg1: tensor<1x80x1x!quant.uniform<i16:f32, 0.04:0>>) -> tensor<1x80x1xi1> {\n+  %0 = \"tfl.not_equal\"(%arg0, %arg1) : (tensor<1x80x1x!quant.uniform<i16:f32, 0.04:0>>, tensor<1x80x1x!quant.uniform<i16:f32, 0.04:0>>) -> tensor<1x80x1xi1>\n+  func.return %0 : tensor<1x80x1xi1>\n+}\n+\n // -----\n \n // CHECK-LABEL: testPad"
        },
        {
            "sha": "30c564c41c503c1ee2e25d7de7f1e7714e546bd7",
            "filename": "tensorflow/compiler/mlir/lite/tools/versioning/op_version.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftools%2Fversioning%2Fop_version.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftools%2Fversioning%2Fop_version.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftools%2Fversioning%2Fop_version.cc?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -789,7 +789,7 @@ int GetBuiltinOperatorVersion(const OpSignature& op_sig) {\n     case BuiltinOperator_EQUAL:\n       if (!op_sig.inputs.empty()) {\n         if (op_sig.inputs.at(0).type == kTfLiteInt16) {\n-          return 4;\n+          return 5;\n         }\n         if (op_sig.inputs.at(0).type == kTfLiteString) {\n           return 3;\n@@ -801,6 +801,9 @@ int GetBuiltinOperatorVersion(const OpSignature& op_sig) {\n       return 1;\n     case BuiltinOperator_NOT_EQUAL:\n       if (!op_sig.inputs.empty()) {\n+        if (op_sig.inputs.at(0).type == kTfLiteInt16) {\n+          return 4;\n+        }\n         if (op_sig.inputs.at(0).type == kTfLiteString) {\n           return 3;\n         }"
        },
        {
            "sha": "aaf335682a03582ab566ae8cc1dc92f1e519ef68",
            "filename": "tensorflow/compiler/mlir/lite/tools/versioning/op_version_test.cc",
            "status": "modified",
            "additions": 24,
            "deletions": 10,
            "changes": 34,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftools%2Fversioning%2Fop_version_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftools%2Fversioning%2Fop_version_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftools%2Fversioning%2Fop_version_test.cc?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -177,21 +177,35 @@ void SimpleOutputVersioningTest(BuiltinOperator op) {\n }\n \n TEST(OpVersionTest, VersioningEqualTest) {\n-  SimpleVersioningTest(BuiltinOperator_EQUAL);\n-  OpSignature fake_op_sig = {\n-      .op = BuiltinOperator_EQUAL,\n-      .inputs = CreateOpSignatureTensorSpecs(kTfLiteString),\n-  };\n+  OpSignature fake_op_sig = {};\n+  fake_op_sig.op = BuiltinOperator_EQUAL;\n+  fake_op_sig.inputs = CreateOpSignatureTensorSpecs(kTfLiteFloat32);\n+  EXPECT_EQ(GetBuiltinOperatorVersion(fake_op_sig), 1);\n+\n+  fake_op_sig.inputs = CreateOpSignatureTensorSpecs(kTfLiteInt8);\n+  EXPECT_EQ(GetBuiltinOperatorVersion(fake_op_sig), 2);\n+\n+  fake_op_sig.inputs = CreateOpSignatureTensorSpecs(kTfLiteString);\n   EXPECT_EQ(GetBuiltinOperatorVersion(fake_op_sig), 3);\n+\n+  fake_op_sig.inputs = CreateOpSignatureTensorSpecs(kTfLiteInt16);\n+  EXPECT_EQ(GetBuiltinOperatorVersion(fake_op_sig), 5);\n }\n \n TEST(OpVersionTest, VersioningNotEqualTest) {\n-  SimpleVersioningTest(BuiltinOperator_NOT_EQUAL);\n-  OpSignature fake_op_sig = {\n-      .op = BuiltinOperator_NOT_EQUAL,\n-      .inputs = CreateOpSignatureTensorSpecs(kTfLiteString),\n-  };\n+  OpSignature fake_op_sig = {};\n+  fake_op_sig.op = BuiltinOperator_NOT_EQUAL;\n+  fake_op_sig.inputs = CreateOpSignatureTensorSpecs(kTfLiteFloat32);\n+  EXPECT_EQ(GetBuiltinOperatorVersion(fake_op_sig), 1);\n+\n+  fake_op_sig.inputs = CreateOpSignatureTensorSpecs(kTfLiteInt8);\n+  EXPECT_EQ(GetBuiltinOperatorVersion(fake_op_sig), 2);\n+\n+  fake_op_sig.inputs = CreateOpSignatureTensorSpecs(kTfLiteString);\n   EXPECT_EQ(GetBuiltinOperatorVersion(fake_op_sig), 3);\n+\n+  fake_op_sig.inputs = CreateOpSignatureTensorSpecs(kTfLiteInt16);\n+  EXPECT_EQ(GetBuiltinOperatorVersion(fake_op_sig), 4);\n }\n \n TEST(OpVersionTest, VersioningLessTest) {"
        },
        {
            "sha": "8f2d9524acae40ce64bb364e6c6aea0b714a2844",
            "filename": "tensorflow/compiler/mlir/lite/tools/versioning/runtime_version.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftools%2Fversioning%2Fruntime_version.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftools%2Fversioning%2Fruntime_version.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Flite%2Ftools%2Fversioning%2Fruntime_version.cc?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -330,9 +330,11 @@ std::string FindMinimumRuntimeVersionForOp(tflite::BuiltinOperator op_code,\n               {{BuiltinOperator_EQUAL, 2}, \"1.14.0\"},\n               {{BuiltinOperator_EQUAL, 3}, \"2.3.0\"},\n               {{BuiltinOperator_EQUAL, 4}, \"2.13.0\"},\n+              {{BuiltinOperator_EQUAL, 5}, \"2.21.0\"},\n               {{BuiltinOperator_NOT_EQUAL, 1}, \"1.14.0\"},\n               {{BuiltinOperator_NOT_EQUAL, 2}, \"1.14.0\"},\n               {{BuiltinOperator_NOT_EQUAL, 3}, \"2.3.0\"},\n+              {{BuiltinOperator_NOT_EQUAL, 4}, \"2.21.0\"},\n               {{BuiltinOperator_GREATER, 1}, \"1.14.0\"},\n               {{BuiltinOperator_GREATER, 2}, \"1.14.0\"},\n               {{BuiltinOperator_GREATER_EQUAL, 1}, \"1.14.0\"},"
        },
        {
            "sha": "40db5b97064099bdf28e136d6a3ac76daa9d6016",
            "filename": "tensorflow/lite/core/kernels/register.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Flite%2Fcore%2Fkernels%2Fregister.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Flite%2Fcore%2Fkernels%2Fregister.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Fcore%2Fkernels%2Fregister.cc?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -246,10 +246,10 @@ BuiltinOpResolver::BuiltinOpResolver() {\n              /* max_version = */ 3);\n   AddBuiltin(BuiltinOperator_EQUAL, Register_EQUAL(),\n              /* min_version = */ 1,\n-             /* max_version = */ 4);\n+             /* max_version = */ 5);\n   AddBuiltin(BuiltinOperator_NOT_EQUAL, Register_NOT_EQUAL(),\n              /* min_version = */ 1,\n-             /* max_version = */ 3);\n+             /* max_version = */ 4);\n   AddBuiltin(BuiltinOperator_SQRT, Register_SQRT(),\n              /* min_version = */ 1,\n              /* max_version = */ 2);"
        },
        {
            "sha": "6230edd643d361ae53bef1f619bbaa98990f8c5d",
            "filename": "tensorflow/lite/kernels/comparisons.cc",
            "status": "modified",
            "additions": 23,
            "deletions": 11,
            "changes": 34,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Flite%2Fkernels%2Fcomparisons.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Flite%2Fkernels%2Fcomparisons.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Fkernels%2Fcomparisons.cc?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -95,7 +95,8 @@ void QuantizeMultiplier(double double_multiplier, int32_t* quantized_multiplier,\n template <typename input_dtype, reference_ops::ComparisonFn<int32> opname>\n void ComparisonQuantized(const TfLiteTensor* input1, const TfLiteTensor* input2,\n                          TfLiteTensor* output, bool requires_broadcast) {\n-  if (input1->type == kTfLiteUInt8 || input1->type == kTfLiteInt8) {\n+  if (input1->type == kTfLiteUInt8 || input1->type == kTfLiteInt8 ||\n+      input1->type == kTfLiteInt16) {\n     auto input1_offset = -input1->params.zero_point;\n     auto input2_offset = -input2->params.zero_point;\n     const int left_shift = 8;\n@@ -180,8 +181,13 @@ TfLiteStatus EqualEval(TfLiteContext* context, TfLiteNode* node) {\n                                                 requires_broadcast);\n       break;\n     case kTfLiteInt16:\n-      Comparison<int16_t, reference_ops::EqualFn>(input1, input2, output,\n-                                                  requires_broadcast);\n+      if (input1->quantization.type == kTfLiteNoQuantization) {\n+        Comparison<int16_t, reference_ops::EqualFn>(input1, input2, output,\n+                                                    requires_broadcast);\n+      } else {\n+        ComparisonQuantized<int16_t, reference_ops::EqualFn>(\n+            input1, input2, output, requires_broadcast);\n+      }\n       break;\n     case kTfLiteInt32:\n       Comparison<int32_t, reference_ops::EqualFn>(input1, input2, output,\n@@ -204,10 +210,10 @@ TfLiteStatus EqualEval(TfLiteContext* context, TfLiteNode* node) {\n                        requires_broadcast);\n       break;\n     default:\n-      TF_LITE_KERNEL_LOG(\n-          context,\n-          \"Does not support type %d, requires bool|float|int|uint8|string\",\n-          input1->type);\n+      TF_LITE_KERNEL_LOG(context,\n+                         \"Does not support type %d, requires \"\n+                         \"bool|float|int|uint8|int16|string\",\n+                         input1->type);\n       return kTfLiteError;\n   }\n   return kTfLiteOk;\n@@ -249,15 +255,21 @@ TfLiteStatus NotEqualEval(TfLiteContext* context, TfLiteNode* node) {\n       ComparisonQuantized<int8_t, reference_ops::NotEqualFn>(\n           input1, input2, output, requires_broadcast);\n       break;\n+    case kTfLiteInt16:\n+      if (input1->quantization.type != kTfLiteNoQuantization) {\n+        ComparisonQuantized<int16_t, reference_ops::NotEqualFn>(\n+            input1, input2, output, requires_broadcast);\n+      }\n+      break;\n     case kTfLiteString:\n       ComparisonString(reference_ops::StringRefNotEqualFn, input1, input2,\n                        output, requires_broadcast);\n       break;\n     default:\n-      TF_LITE_KERNEL_LOG(\n-          context,\n-          \"Does not support type %d, requires bool|float|int|uint8|string\",\n-          input1->type);\n+      TF_LITE_KERNEL_LOG(context,\n+                         \"Does not support type %d, requires \"\n+                         \"bool|float|int|uint8|qint16|string\",\n+                         input1->type);\n       return kTfLiteError;\n   }\n   return kTfLiteOk;"
        },
        {
            "sha": "10226bb60a8ed840d569668e7f6713f18525c10a",
            "filename": "tensorflow/lite/kernels/comparisons_test.cc",
            "status": "modified",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Flite%2Fkernels%2Fcomparisons_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Flite%2Fkernels%2Fcomparisons_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Fkernels%2Fcomparisons_test.cc?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -15,6 +15,7 @@ limitations under the License.\n #include <stdint.h>\n \n #include <initializer_list>\n+#include <limits>\n #include <string>\n #include <vector>\n \n@@ -538,6 +539,19 @@ TEST(QuantizedComparisonsTest, EqualInt8Quantized) {\n   EXPECT_THAT(model.GetOutput(), ElementsAre(false, false, true, false));\n }\n \n+TEST(QuantizedComparisonsTest, EqualInt16Quantized) {\n+  const float kMin = std::numeric_limits<int16_t>::min() + 1;\n+  const float kMax = std::numeric_limits<int16_t>::max();\n+  ComparisonOpModel model({TensorType_INT16, {1, 2, 2, 1}, kMin, kMax},\n+                          {TensorType_INT16, {1, 2, 2, 1}, kMin, kMax},\n+                          TensorType_INT16, BuiltinOperator_EQUAL);\n+  model.QuantizeAndPopulate<int16_t>(model.input1(), {10, -90, 70, kMin});\n+  model.QuantizeAndPopulate<int16_t>(model.input2(), {10, 20, 71, kMin});\n+  model.Invoke();\n+\n+  EXPECT_THAT(model.GetOutput(), ElementsAre(true, false, false, true));\n+}\n+\n TEST(QuantizedComparisonsTest, NotEqualUInt8Quantized) {\n   const float kMin = -1.f;\n   const float kMax = 128.f;\n@@ -564,6 +578,19 @@ TEST(QuantizedComparisonsTest, NotEqualInt8Quantized) {\n   EXPECT_THAT(model.GetOutput(), ElementsAre(false, true, false, true));\n }\n \n+TEST(QuantizedComparisonsTest, NotEqualInt16Quantized) {\n+  const float kMin = std::numeric_limits<int16_t>::min() + 1;\n+  const float kMax = std::numeric_limits<int16_t>::max();\n+  ComparisonOpModel model({TensorType_INT16, {1, 2, 2, 1}, kMin, kMax},\n+                          {TensorType_INT16, {1, 2, 2, 1}, kMin, kMax},\n+                          TensorType_INT16, BuiltinOperator_NOT_EQUAL);\n+  model.QuantizeAndPopulate<int16_t>(model.input1(), {10, -90, 70, kMin + 1});\n+  model.QuantizeAndPopulate<int16_t>(model.input2(), {10, 20, 71, kMin + 2});\n+  model.Invoke();\n+\n+  EXPECT_THAT(model.GetOutput(), ElementsAre(false, true, true, true));\n+}\n+\n TEST(ComparisonsTest, GreaterQuantized) {\n   const float kMin = -1.f;\n   const float kMax = 128.f;"
        },
        {
            "sha": "4adc77840919b6f83d86c8a66eca2cf3f7a811ad",
            "filename": "tensorflow/lite/kernels/register_ref.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Flite%2Fkernels%2Fregister_ref.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e791c5217d2b8298529d60ed3eecb075486ef44c/tensorflow%2Flite%2Fkernels%2Fregister_ref.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Fkernels%2Fregister_ref.cc?ref=e791c5217d2b8298529d60ed3eecb075486ef44c",
            "patch": "@@ -444,10 +444,10 @@ BuiltinRefOpResolver::BuiltinRefOpResolver() {\n              /* max_version = */ 3);\n   AddBuiltin(BuiltinOperator_EQUAL, Register_EQUAL(),\n              /* min_version = */ 1,\n-             /* max_version = */ 4);\n+             /* max_version = */ 5);\n   AddBuiltin(BuiltinOperator_NOT_EQUAL, Register_NOT_EQUAL(),\n              /* min_version = */ 1,\n-             /* max_version = */ 3);\n+             /* max_version = */ 4);\n   AddBuiltin(BuiltinOperator_SQRT, Register_SQRT(),\n              /* min_version = */ 1,\n              /* max_version = */ 2);"
        }
    ],
    "stats": {
        "total": 153,
        "additions": 123,
        "deletions": 30
    }
}