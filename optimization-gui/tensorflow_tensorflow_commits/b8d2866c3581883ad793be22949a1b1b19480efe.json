{
    "author": "jeffreyadean",
    "message": "Avoid redundant memset to clear the allocated backing store.\n\nIt turns out make_unique<...> default initializes the integer values\nto 0, so this was showing up on profiles as two calls to memset (one inside\nthe inlined make_unique code, and then the explicit memset after the\nmake_unique).  For large compilations, the allocated memory can\nbe large.\n\nPiperOrigin-RevId: 846017416",
    "sha": "b8d2866c3581883ad793be22949a1b1b19480efe",
    "files": [
        {
            "sha": "54e09fa300dd9b65d034c9a55add21d43390cdad",
            "filename": "third_party/xla/xla/hlo/analysis/hlo_reachability.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b8d2866c3581883ad793be22949a1b1b19480efe/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fhlo_reachability.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b8d2866c3581883ad793be22949a1b1b19480efe/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fhlo_reachability.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fhlo_reachability.cc?ref=b8d2866c3581883ad793be22949a1b1b19480efe",
            "patch": "@@ -41,10 +41,8 @@ HloReachabilityMap::HloReachabilityMap(\n   while (row < total_rows) {\n     const int rows_to_allocate = std::min(kRowsPerAllocation, total_rows - row);\n     size_t words_to_allocate = rows_to_allocate * words_per_bitset_;\n+    // make_unique initializes the array of words to 0\n     bit_storage_.push_back(std::make_unique<BitSet::Word[]>(words_to_allocate));\n-    // Initialize all the bitsets to 0\n-    memset(bit_storage_.back().get(), 0,\n-           words_to_allocate * sizeof(BitSet::Word));\n     row += rows_to_allocate;\n   }\n "
        }
    ],
    "stats": {
        "total": 4,
        "additions": 1,
        "deletions": 3
    }
}