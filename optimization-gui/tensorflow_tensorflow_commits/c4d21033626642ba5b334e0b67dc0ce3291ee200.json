{
    "author": "gonnet",
    "message": "Add an interface to initialize XNNPACK with an `xnn_threadpool`.\n\nThis required adding `xnn_threadpool_num_threads()` and `xnn_threadpool_schedule()` functions so that the `xnn_threadpool` could be used from `C`-language code, thus allowing a `pthreadpool` to use an `xnn_threadpool` as an executor.\n\nTo run Subgraph benchmarks with the new interface, build with `bazel build --define xnn_benchmark_use_xnn_threadpool=true`, or set `-DXNN_BENCHMARK_USE_XNN_THREADPOOL`.\n\nPiperOrigin-RevId: 812716071",
    "sha": "c4d21033626642ba5b334e0b67dc0ce3291ee200",
    "files": [
        {
            "sha": "44f6c5cfc2ab8acad5686a3492d5be98b82faa46",
            "filename": "third_party/xla/xla/backends/cpu/runtime/xnnpack/xnn_fusion_thunk.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/c4d21033626642ba5b334e0b67dc0ce3291ee200/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2Fxnnpack%2Fxnn_fusion_thunk.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/c4d21033626642ba5b334e0b67dc0ce3291ee200/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2Fxnnpack%2Fxnn_fusion_thunk.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2Fxnnpack%2Fxnn_fusion_thunk.cc?ref=c4d21033626642ba5b334e0b67dc0ce3291ee200",
            "patch": "@@ -149,7 +149,8 @@ XnnFusionThunk::CreateXnnExecutable(\n         capturing_builder_(arguments_, results_, arguments_buffers));\n   }\n \n-  uint32_t flags = XNN_FLAG_SLINKY_ENABLED | XNN_FLAG_SLINKY_STATIC_BOUNDS;\n+  uint32_t flags = XNN_FLAG_SLINKY_ENABLED | XNN_FLAG_SLINKY_STATIC_BOUNDS |\n+                   XNN_FLAG_DONT_SPIN_WORKERS;\n \n   TF_ASSIGN_OR_RETURN(\n       executable.runtime, CreateXnnRuntime([&](xnn_runtime_t* runtime) {\n@@ -191,7 +192,8 @@ absl::Status XnnFusionThunk::UpdateXnnExecutable(\n       executable.subgraph,\n       capturing_builder_(arguments_, results_, arguments_buffers));\n \n-  uint32_t flags = XNN_FLAG_SLINKY_ENABLED | XNN_FLAG_SLINKY_STATIC_BOUNDS;\n+  uint32_t flags = XNN_FLAG_SLINKY_ENABLED | XNN_FLAG_SLINKY_STATIC_BOUNDS |\n+                   XNN_FLAG_DONT_SPIN_WORKERS;\n \n   TF_ASSIGN_OR_RETURN(\n       executable.runtime, CreateXnnRuntime([&](xnn_runtime_t* runtime) {"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
    }
}