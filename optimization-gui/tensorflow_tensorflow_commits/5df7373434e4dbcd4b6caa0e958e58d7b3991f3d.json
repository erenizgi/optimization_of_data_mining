{
    "author": "WillFroom",
    "message": "[XLA:CPU][XTile] Use memref transpose rather than explicit vectorized version.\n\nI am getting some numerical issues with the vectorized version, which we don't really want to use anyway as it can cause a IR explosion, will look into a more principled vectorization after bufferization later.\n\nPiperOrigin-RevId: 840780579",
    "sha": "5df7373434e4dbcd4b6caa0e958e58d7b3991f3d",
    "files": [
        {
            "sha": "257bef3ecf366a3bdc8dc07ae1ce846cbc8e50ad",
            "filename": "third_party/xla/xla/backends/cpu/codegen/tiled/transforms/shlo_to_vector.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/5df7373434e4dbcd4b6caa0e958e58d7b3991f3d/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftransforms%2Fshlo_to_vector.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/5df7373434e4dbcd4b6caa0e958e58d7b3991f3d/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftransforms%2Fshlo_to_vector.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftransforms%2Fshlo_to_vector.cc?ref=5df7373434e4dbcd4b6caa0e958e58d7b3991f3d",
            "patch": "@@ -332,8 +332,8 @@ class ShloToVectorPass : public impl::ShloToVectorPassBase<ShloToVectorPass> {\n   void runOnOperation() override {\n     mlir::MLIRContext* context = &getContext();\n     mlir::RewritePatternSet patterns(context);\n-    patterns.add<LowerTranspose, LowerDotGeneral, LowerReduce,\n-                 LowerBroadcastInDim, LowerIota>(context);\n+    patterns.add<LowerDotGeneral, LowerReduce, LowerBroadcastInDim, LowerIota>(\n+        context);\n     if (mlir::failed(\n             mlir::applyPatternsGreedily(getOperation(), std::move(patterns)))) {\n       signalPassFailure();"
        },
        {
            "sha": "45cab1a7cffcd1e430985d82bac93bf094e4c1ff",
            "filename": "third_party/xla/xla/backends/cpu/codegen/tiled/transforms/tests/shlo_to_vector.mlir",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/5df7373434e4dbcd4b6caa0e958e58d7b3991f3d/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftransforms%2Ftests%2Fshlo_to_vector.mlir",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/5df7373434e4dbcd4b6caa0e958e58d7b3991f3d/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftransforms%2Ftests%2Fshlo_to_vector.mlir",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftransforms%2Ftests%2Fshlo_to_vector.mlir?ref=5df7373434e4dbcd4b6caa0e958e58d7b3991f3d",
            "patch": "@@ -1,7 +1,7 @@\n // RUN: fusion_compiler_opt %s --xtile-cpu-shlo-to-vector -split-input-file | FileCheck %s\n \n func.func @transpose(%input : tensor<1024x32xf32>) -> tensor<32x1024xf32> {\n-  // CHECK: vector.transpose %{{.*}}, [1, 0] : vector<1024x32xf32> to vector<32x1024xf32>\n+  // CHECK-NOT: vector.transpose %{{.*}}, [1, 0] : vector<1024x32xf32> to vector<32x1024xf32>\n   %transposed = stablehlo.transpose %input, dims = [1, 0] : (tensor<1024x32xf32>) -> tensor<32x1024xf32>\n   return %transposed : tensor<32x1024xf32>\n }"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
    }
}