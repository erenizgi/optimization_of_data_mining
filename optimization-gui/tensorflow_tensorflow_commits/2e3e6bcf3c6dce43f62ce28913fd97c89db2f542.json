{
    "author": "ZixuanJiang",
    "message": "Remove `importFuncCalls` parameter from `addStablehloImportPipeline`.\n\nThe `importFuncCalls` parameter was always passed as true. This change hardcodes the behavior within the `addStablehloImportPipeline` to always import function calls, simplifying the API.\n\nPiperOrigin-RevId: 834016460",
    "sha": "2e3e6bcf3c6dce43f62ce28913fd97c89db2f542",
    "files": [
        {
            "sha": "3ac62c9fe7700f074723f14a9f00f00e6563bc97",
            "filename": "third_party/xla/xla/service/spmd/shardy/shardy_xla_pass.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2e3e6bcf3c6dce43f62ce28913fd97c89db2f542/third_party%2Fxla%2Fxla%2Fservice%2Fspmd%2Fshardy%2Fshardy_xla_pass.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2e3e6bcf3c6dce43f62ce28913fd97c89db2f542/third_party%2Fxla%2Fxla%2Fservice%2Fspmd%2Fshardy%2Fshardy_xla_pass.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fspmd%2Fshardy%2Fshardy_xla_pass.cc?ref=2e3e6bcf3c6dce43f62ce28913fd97c89db2f542",
            "patch": "@@ -372,8 +372,7 @@ absl::Status runShardingPropagation(HloModule* hloModule,\n         spanToArrayRef(hloModule->config()\n                            .allow_spmd_sharding_propagation_to_parameters()),\n         spanToArrayRef(\n-            hloModule->config().allow_spmd_sharding_propagation_to_output()),\n-        /*importFuncCalls=*/true);\n+            hloModule->config().allow_spmd_sharding_propagation_to_output()));\n   } else {\n     // This branch is in production.\n     addSdyRoundTripImportPipeline(pm, /*enableConstantImport=*/true,"
        },
        {
            "sha": "1221954e2b02d0a864d2c3a607bdef70d425ce93",
            "filename": "third_party/xla/xla/service/spmd/shardy/stablehlo_round_trip/stablehlo_import.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2e3e6bcf3c6dce43f62ce28913fd97c89db2f542/third_party%2Fxla%2Fxla%2Fservice%2Fspmd%2Fshardy%2Fstablehlo_round_trip%2Fstablehlo_import.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2e3e6bcf3c6dce43f62ce28913fd97c89db2f542/third_party%2Fxla%2Fxla%2Fservice%2Fspmd%2Fshardy%2Fstablehlo_round_trip%2Fstablehlo_import.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fspmd%2Fshardy%2Fstablehlo_round_trip%2Fstablehlo_import.cc?ref=2e3e6bcf3c6dce43f62ce28913fd97c89db2f542",
            "patch": "@@ -750,13 +750,12 @@ void registerStablehloImportShardingsPass() {\n \n void addStablehloImportPipeline(mlir::OpPassManager& pm,\n                                 ArrayRef<bool> allowPropagationToArgs,\n-                                ArrayRef<bool> allowPropagationToResults,\n-                                bool importFuncCalls) {\n+                                ArrayRef<bool> allowPropagationToResults) {\n   addCommonPreImportPasses(pm);\n   pm.addPass(createImportShardingsPass(allowPropagationToArgs,\n                                        allowPropagationToResults));\n   pm.addPass(createStablehloRoundTripShardMapImportPass());\n-  addCommonPostImportPasses(pm, importFuncCalls);\n+  addCommonPostImportPasses(pm, /*importFuncCalls=*/true);\n }\n \n void registerStablehloImportPipeline() {\n@@ -765,7 +764,7 @@ void registerStablehloImportPipeline() {\n       \"Run passes to import a StableHLO module with `mhlo.shardings` into the \"\n       \"SDY (Shardy) dialect.\",\n       std::bind(addStablehloImportPipeline, std::placeholders::_1,\n-                ArrayRef<bool>(), ArrayRef<bool>(), true));\n+                ArrayRef<bool>(), ArrayRef<bool>()));\n }\n \n }  // namespace sdy"
        },
        {
            "sha": "13cffeec04f0b5cca7ef5328d1508e94f74e900a",
            "filename": "third_party/xla/xla/service/spmd/shardy/stablehlo_round_trip/stablehlo_import.h",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2e3e6bcf3c6dce43f62ce28913fd97c89db2f542/third_party%2Fxla%2Fxla%2Fservice%2Fspmd%2Fshardy%2Fstablehlo_round_trip%2Fstablehlo_import.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2e3e6bcf3c6dce43f62ce28913fd97c89db2f542/third_party%2Fxla%2Fxla%2Fservice%2Fspmd%2Fshardy%2Fstablehlo_round_trip%2Fstablehlo_import.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fspmd%2Fshardy%2Fstablehlo_round_trip%2Fstablehlo_import.h?ref=2e3e6bcf3c6dce43f62ce28913fd97c89db2f542",
            "patch": "@@ -75,8 +75,7 @@ void registerStablehloImportPipeline();\n // - have the same number of elements as the number of args/results.\n void addStablehloImportPipeline(mlir::OpPassManager& pm,\n                                 mlir::ArrayRef<bool> allowPropagationToArgs,\n-                                mlir::ArrayRef<bool> allowPropagationToResults,\n-                                bool importFuncCalls = true);\n+                                mlir::ArrayRef<bool> allowPropagationToResults);\n \n // Creates ImportShardingsPass that converts `mhlo.sharding` to `mesh` and\n // `sdy.sharding`."
        }
    ],
    "stats": {
        "total": 13,
        "additions": 5,
        "deletions": 8
    }
}