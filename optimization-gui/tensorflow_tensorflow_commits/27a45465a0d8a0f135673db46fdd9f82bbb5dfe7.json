{
    "author": "ezhulenev",
    "message": "[xla:codegen] Remove MlirKernelEmitter alias\n\nPiperOrigin-RevId: 825346639",
    "sha": "27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
    "files": [
        {
            "sha": "c2e0b317b91de32322ea91a3ed681e6cddb18ef0",
            "filename": "third_party/xla/xla/backends/cpu/codegen/emitters/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Femitters%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Femitters%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Femitters%2FBUILD?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -38,6 +38,7 @@ cc_library(\n         \"//xla/backends/cpu/codegen:kernel_api_ir_builder\",\n         \"//xla/backends/cpu/codegen:symbol_name_util\",\n         \"//xla/codegen:kernel_definition\",\n+        \"//xla/codegen:kernel_emitter\",\n         \"//xla/codegen:kernel_spec\",\n         \"//xla/codegen:mlir_kernel_source\",\n         \"//xla/codegen/emitters:computation_partitioner\","
        },
        {
            "sha": "dee46bc02e92332ba7a159fddd928bbae67cfa1d",
            "filename": "third_party/xla/xla/backends/cpu/codegen/emitters/cpu_scatter_emitter.h",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Femitters%2Fcpu_scatter_emitter.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Femitters%2Fcpu_scatter_emitter.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Femitters%2Fcpu_scatter_emitter.h?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -27,7 +27,7 @@ limitations under the License.\n #include \"mlir/IR/Builders.h\"\n #include \"mlir/IR/Value.h\"\n #include \"xla/codegen/emitters/computation_partitioner.h\"\n-#include \"xla/codegen/kernel_definition.h\"\n+#include \"xla/codegen/kernel_emitter.h\"\n #include \"xla/codegen/mlir_kernel_source.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n@@ -38,14 +38,14 @@ namespace xla {\n namespace cpu {\n \n // Generic scatter fusion. Lowers to LLVM via MLIR.\n-class CpuScatterFusion final : public MlirKernelEmitter {\n+class CpuScatterFusion final : public KernelEmitter<MlirKernelSource> {\n  public:\n   CpuScatterFusion(const BufferAssignment& buffer_assignment,\n                    const HloFusionInstruction* fusion,\n                    gpu::SymbolicExprContext* symbolic_expr_context);\n \n   absl::string_view name() const final { return \"cpu_scatter_fusion\"; }\n-  absl::StatusOr<MlirKernelDefinition> EmitKernelDefinition() final;\n+  absl::StatusOr<KernelDefinition> EmitKernelDefinition() final;\n \n  private:\n   absl::Status EmitEntryFunction("
        },
        {
            "sha": "418b2fc06400c031a2cc7fedd918ed9856a2da0e",
            "filename": "third_party/xla/xla/backends/cpu/testlib/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Ftestlib%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Ftestlib%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Ftestlib%2FBUILD?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -112,6 +112,7 @@ cc_library(\n     deps = [\n         \"//xla/backends/cpu/codegen:fusion_compiler\",\n         \"//xla/codegen:kernel_definition\",\n+        \"//xla/codegen:kernel_emitter\",\n         \"//xla/codegen:kernel_spec\",\n         \"//xla/codegen:mlir_kernel_source\",\n         \"//xla/runtime:buffer_use\","
        },
        {
            "sha": "d09a7bb2c0bd7edb352ec2b6b87e1e75458536d8",
            "filename": "third_party/xla/xla/backends/cpu/testlib/kernel_runner_extension.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Ftestlib%2Fkernel_runner_extension.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Ftestlib%2Fkernel_runner_extension.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Ftestlib%2Fkernel_runner_extension.cc?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -100,10 +100,10 @@ NB_MODULE(_extension, kernel_runner_module) {\n                                   {});\n       });\n \n-  nb::class_<MlirTestKernelEmitter, MlirKernelEmitter>(kernel_runner_module,\n-                                                       \"MlirTestKernelEmitter\")\n-      .def(\"__init__\", [](MlirKernelEmitter* self, absl::string_view ir,\n-                          absl::string_view kernel_name,\n+  nb::class_<MlirTestKernelEmitter, KernelEmitter<MlirKernelSource>>(\n+      kernel_runner_module, \"MlirTestKernelEmitter\")\n+      .def(\"__init__\", [](KernelEmitter<MlirKernelSource>* self,\n+                          absl::string_view ir, absl::string_view kernel_name,\n                           NbNumWorkGroups num_workgroups) {\n         new (self)\n             MlirTestKernelEmitter(ir, kernel_name,\n@@ -189,8 +189,8 @@ NB_MODULE(_extension, kernel_runner_module) {\n            nb::keep_alive<1, 2>(), nb::keep_alive<1, 3>(),\n            nb::keep_alive<1, 4>());\n \n-  nb::class_<CpuScatterFusion, MlirKernelEmitter>(kernel_runner_module,\n-                                                  \"ScatterKernelEmitter\")\n+  nb::class_<CpuScatterFusion, KernelEmitter<MlirKernelSource>>(\n+      kernel_runner_module, \"ScatterKernelEmitter\")\n       .def(\n           \"__init__\",\n           [](CpuScatterFusion* self, const HloFusionInstruction* instruction,"
        },
        {
            "sha": "566b97c4b4037b3b633e3fb97386015076dbcf69",
            "filename": "third_party/xla/xla/backends/cpu/testlib/mlir_kernel_emitter.h",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Ftestlib%2Fmlir_kernel_emitter.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Ftestlib%2Fmlir_kernel_emitter.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Ftestlib%2Fmlir_kernel_emitter.h?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -23,6 +23,7 @@ limitations under the License.\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/string_view.h\"\n #include \"absl/types/span.h\"\n+#include \"xla/codegen/kernel_emitter.h\"\n #include \"xla/codegen/mlir_kernel_source.h\"\n #include \"xla/runtime/buffer_use.h\"\n #include \"xla/runtime/work_group.h\"\n@@ -34,7 +35,7 @@ namespace xla::cpu {\n // into the dedicated MLIR context and module instance. This kernel emitter is\n // intended to be used for testing purposes only: (1) load pre-compiled LLVM IR\n // into the XLA kernel spec; (2) Execute it with user provided input buffers.\n-class MlirTestKernelEmitter : public MlirKernelEmitter {\n+class MlirTestKernelEmitter : public KernelEmitter<MlirKernelSource> {\n  public:\n   // When loading kernel IR into the KernelSpec we create a separate buffer\n   // allocation for every kernel argument. We don't use buffer assignment in\n@@ -49,7 +50,7 @@ class MlirTestKernelEmitter : public MlirKernelEmitter {\n                         absl::Span<const KernelArg> args);\n \n   absl::string_view name() const override { return \"mlir_test_kernel_emitter\"; }\n-  absl::StatusOr<MlirKernelDefinition> EmitKernelDefinition() final;\n+  absl::StatusOr<KernelDefinition> EmitKernelDefinition() final;\n \n  private:\n   std::string mlir_;"
        },
        {
            "sha": "55b715a51458c0832ed914c36553d694ccfd3e17",
            "filename": "third_party/xla/xla/codegen/emitters/BUILD",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2FBUILD?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -310,6 +310,7 @@ cc_library(\n         \"//xla:util\",\n         \"//xla/codegen:hlo_fusion_spec\",\n         \"//xla/codegen:kernel_definition\",\n+        \"//xla/codegen:kernel_emitter\",\n         \"//xla/codegen:kernel_spec\",\n         \"//xla/codegen:mlir_kernel_source\",\n         \"//xla/codegen/emitters/ir:xla\",\n@@ -363,6 +364,7 @@ cc_library(\n         \"//xla:util\",\n         \"//xla/codegen:hlo_fusion_spec\",\n         \"//xla/codegen:kernel_definition\",\n+        \"//xla/codegen:kernel_emitter\",\n         \"//xla/codegen:kernel_spec\",\n         \"//xla/codegen:mlir_kernel_source\",\n         \"//xla/codegen/emitters/ir:xla\",\n@@ -422,6 +424,7 @@ cc_library(\n         \"//xla/codegen:hlo_fusion_spec\",\n         \"//xla/codegen:ir_emission_utils\",\n         \"//xla/codegen:kernel_definition\",\n+        \"//xla/codegen:kernel_emitter\",\n         \"//xla/codegen:kernel_spec\",\n         \"//xla/codegen:mlir_kernel_source\",\n         \"//xla/codegen/emitters/ir:xla\","
        },
        {
            "sha": "536c86b58c6fb7954ff4b835a69919b5afb172a1",
            "filename": "third_party/xla/xla/codegen/emitters/concatenate_kernel_emitter.h",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fconcatenate_kernel_emitter.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fconcatenate_kernel_emitter.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fconcatenate_kernel_emitter.h?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -16,7 +16,6 @@ limitations under the License.\n #ifndef XLA_CODEGEN_EMITTERS_CONCATENATE_KERNEL_EMITTER_H_\n #define XLA_CODEGEN_EMITTERS_CONCATENATE_KERNEL_EMITTER_H_\n \n-#include <cstdint>\n #include <string>\n #include <vector>\n \n@@ -28,7 +27,7 @@ limitations under the License.\n #include \"xla/codegen/emitters/ir/xla_ops.h\"\n #include \"xla/codegen/emitters/kernel_arguments.h\"\n #include \"xla/codegen/hlo_fusion_spec.h\"\n-#include \"xla/codegen/kernel_definition.h\"\n+#include \"xla/codegen/kernel_emitter.h\"\n #include \"xla/codegen/mlir_kernel_source.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n@@ -39,7 +38,8 @@ limitations under the License.\n \n namespace xla::emitters {\n \n-class ConcatenateFusionKernelEmitter final : public MlirKernelEmitter {\n+class ConcatenateFusionKernelEmitter final\n+    : public KernelEmitter<MlirKernelSource> {\n  public:\n   ConcatenateFusionKernelEmitter(\n       gpu::SymbolicExprContext& symbolic_expr_context,\n@@ -53,7 +53,7 @@ class ConcatenateFusionKernelEmitter final : public MlirKernelEmitter {\n     return \"concatenate_fusion_kernel_emitter\";\n   }\n \n-  absl::StatusOr<MlirKernelDefinition> EmitKernelDefinition() override;\n+  absl::StatusOr<KernelDefinition> EmitKernelDefinition() override;\n \n   static IndexingMap ComputeWorkItemIdToOutputIndexing(\n       const WorkDimensions& work_dimensions, const Shape& largest_shape,"
        },
        {
            "sha": "65c6c17ede46a4146a1e042ba79ba5ed61492574",
            "filename": "third_party/xla/xla/codegen/emitters/dynamic_update_slice_kernel_emitter.h",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fdynamic_update_slice_kernel_emitter.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fdynamic_update_slice_kernel_emitter.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fdynamic_update_slice_kernel_emitter.h?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -27,7 +27,7 @@ limitations under the License.\n #include \"xla/codegen/emitters/ir/xla_ops.h\"\n #include \"xla/codegen/emitters/kernel_arguments.h\"\n #include \"xla/codegen/hlo_fusion_spec.h\"\n-#include \"xla/codegen/kernel_definition.h\"\n+#include \"xla/codegen/kernel_emitter.h\"\n #include \"xla/codegen/kernel_spec.h\"\n #include \"xla/codegen/mlir_kernel_source.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n@@ -46,7 +46,8 @@ namespace xla::emitters {\n // 3. a tuple op returning the result of several dynamic-update-slice ops\n // 4. a tuple op returning the result of several bitcast\n //    dynamic-update-slice ops\n-class DynamicUpdateSliceKernelEmitter final : public MlirKernelEmitter {\n+class DynamicUpdateSliceKernelEmitter final\n+    : public KernelEmitter<MlirKernelSource> {\n  public:\n   DynamicUpdateSliceKernelEmitter(\n       gpu::SymbolicExprContext& symbolic_expr_context,\n@@ -60,7 +61,7 @@ class DynamicUpdateSliceKernelEmitter final : public MlirKernelEmitter {\n     return \"dynamic_update_slice_kernel_emitter\";\n   }\n \n-  absl::StatusOr<MlirKernelDefinition> EmitKernelDefinition() override;\n+  absl::StatusOr<KernelDefinition> EmitKernelDefinition() override;\n \n   // Get the shape that will be used for loop indexing for the given fusion\n   // specification."
        },
        {
            "sha": "f725477deb6f73ad907715669ad90b9eddca0dcf",
            "filename": "third_party/xla/xla/codegen/emitters/loop_kernel_emitter.h",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Floop_kernel_emitter.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Floop_kernel_emitter.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Floop_kernel_emitter.h?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -26,7 +26,7 @@ limitations under the License.\n #include \"xla/codegen/emitters/ir/xla_ops.h\"\n #include \"xla/codegen/emitters/kernel_arguments.h\"\n #include \"xla/codegen/hlo_fusion_spec.h\"\n-#include \"xla/codegen/kernel_definition.h\"\n+#include \"xla/codegen/kernel_emitter.h\"\n #include \"xla/codegen/mlir_kernel_source.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n@@ -38,7 +38,7 @@ limitations under the License.\n namespace xla::emitters {\n \n // Generic loop fusion.\n-class LoopFusionKernelEmitter final : public MlirKernelEmitter {\n+class LoopFusionKernelEmitter final : public KernelEmitter<MlirKernelSource> {\n  public:\n   LoopFusionKernelEmitter(gpu::SymbolicExprContext& symbolic_expr_context,\n                           const HloFusionInstruction& fusion,\n@@ -50,7 +50,7 @@ class LoopFusionKernelEmitter final : public MlirKernelEmitter {\n                           BackendKind backend_kind);\n \n   absl::string_view name() const final { return \"loop_fusion_kernel_emitter\"; }\n-  absl::StatusOr<MlirKernelDefinition> EmitKernelDefinition() override;\n+  absl::StatusOr<KernelDefinition> EmitKernelDefinition() override;\n \n   static IndexingMap ComputeWorkItemIdToOutputIndexing(\n       const WorkDimensions& work_dimensions, const Shape& root_shape,"
        },
        {
            "sha": "896cd700de5bc9a594013802e314a2dbb5de1cfb",
            "filename": "third_party/xla/xla/codegen/mlir_kernel_source.h",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Fmlir_kernel_source.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/27a45465a0d8a0f135673db46fdd9f82bbb5dfe7/third_party%2Fxla%2Fxla%2Fcodegen%2Fmlir_kernel_source.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Fmlir_kernel_source.h?ref=27a45465a0d8a0f135673db46fdd9f82bbb5dfe7",
            "patch": "@@ -27,7 +27,6 @@ limitations under the License.\n #include \"mlir/IR/OwningOpRef.h\"\n #include \"mlir/Support/DebugStringHelper.h\"\n #include \"xla/codegen/kernel_definition.h\"\n-#include \"xla/codegen/kernel_emitter.h\"\n #include \"xla/codegen/kernel_source.h\"\n #include \"xla/service/gpu/model/experimental/symbolic_expr.h\"\n \n@@ -84,7 +83,6 @@ class MlirKernelSource final : public KernelSource {\n };\n \n using MlirKernelDefinition = KernelDefinition<MlirKernelSource>;  // NOLINT\n-using MlirKernelEmitter = KernelEmitter<MlirKernelSource>;        // NOLINT\n \n }  // namespace xla\n "
        }
    ],
    "stats": {
        "total": 51,
        "additions": 28,
        "deletions": 23
    }
}