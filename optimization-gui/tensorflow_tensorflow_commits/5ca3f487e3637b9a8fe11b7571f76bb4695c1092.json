{
    "author": "tensorflower-gardener",
    "message": "Migrate std::multimap::find() to equal_range().\n\nThis is expected to be a safe change. Calls to multimap::find() historically returned the first matching element, or end() if there is no match. However, this is not guaranteed, and recent changes in libc++ changed this to return an arbitrary element that matches. Using equal_range() is a safe replacement that will preserve the current behavior.\n\nPiperOrigin-RevId: 837348099",
    "sha": "5ca3f487e3637b9a8fe11b7571f76bb4695c1092",
    "files": [
        {
            "sha": "3fc358af4ad58090d3877eec83f910afc3fc028e",
            "filename": "tensorflow/core/distributed_runtime/rpc/grpc_master_service.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/5ca3f487e3637b9a8fe11b7571f76bb4695c1092/tensorflow%2Fcore%2Fdistributed_runtime%2Frpc%2Fgrpc_master_service.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/5ca3f487e3637b9a8fe11b7571f76bb4695c1092/tensorflow%2Fcore%2Fdistributed_runtime%2Frpc%2Fgrpc_master_service.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fdistributed_runtime%2Frpc%2Fgrpc_master_service.cc?ref=5ca3f487e3637b9a8fe11b7571f76bb4695c1092",
            "patch": "@@ -304,8 +304,7 @@ class GrpcMasterService : public tsl::AsyncServiceInterface {\n       absl::string_view name,\n       const std::multimap<::grpc::string_ref, ::grpc::string_ref>& metadata) {\n     absl::string_view id;\n-    auto it = metadata.find(GrpcIdKey());\n-    if (it != metadata.end()) {\n+    if (const auto [it, end] = metadata.equal_range(GrpcIdKey()); it != end) {\n       id = absl::string_view(it->second.data(), it->second.size());\n     }\n     return new tsl::profiler::TraceMe("
        },
        {
            "sha": "b89d2dd5c43af40661376fc8b2e15ac9cbe03c35",
            "filename": "third_party/xla/xla/python/ifrt_proxy/server/grpc_service_impl.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/5ca3f487e3637b9a8fe11b7571f76bb4695c1092/third_party%2Fxla%2Fxla%2Fpython%2Fifrt_proxy%2Fserver%2Fgrpc_service_impl.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/5ca3f487e3637b9a8fe11b7571f76bb4695c1092/third_party%2Fxla%2Fxla%2Fpython%2Fifrt_proxy%2Fserver%2Fgrpc_service_impl.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt_proxy%2Fserver%2Fgrpc_service_impl.cc?ref=5ca3f487e3637b9a8fe11b7571f76bb4695c1092",
            "patch": "@@ -69,9 +69,9 @@ ::grpc::Status GrpcServiceImpl::IfrtSession(\n     ::grpc::ServerReaderWriter<IfrtResponse, IfrtRequest>* stream) {\n   GrpcIfrtSessionMetadata metadata;\n   {\n-    const auto it = context->client_metadata().find(\n+    const auto [it, end] = context->client_metadata().equal_range(\n         \"ifrt-proxy-grpc-ifrt-session-metadata-bin\");\n-    if (it == context->client_metadata().end()) {\n+    if (it == end) {\n       return ::grpc::Status(::grpc::StatusCode::INVALID_ARGUMENT,\n                             \"Missing metadata for GrpcIfrtService.IfrtSession: \"\n                             \"ifrt-proxy-grpc-ifrt-session-metadata-bin\");\n@@ -158,9 +158,9 @@ ::grpc::Status GrpcServiceImpl::HostBufferStore(\n     ::grpc::ServerReader<GrpcHostBufferStoreRequest>* stream,\n     GrpcHostBufferStoreResponse* response) {\n   tsl::profiler::TraceMe traceme(\"HostBufferStore\");\n-  const auto it = context->client_metadata().find(\n+  const auto [it, end] = context->client_metadata().equal_range(\n       \"ifrt-proxy-grpc-host-buffer-store-metadata-bin\");\n-  if (it == context->client_metadata().end()) {\n+  if (it == end) {\n     LOG(WARNING) << \"Missing gRPC metadata for GrpcHostBufferService.Store\";\n     return ::grpc::Status(\n         ::grpc::StatusCode::INTERNAL,"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 5,
        "deletions": 6
    }
}