{
    "author": "tensorflower-gardener",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 826298597",
    "sha": "e61bac51b1deecc1e0acf16a70e362794a6cbfa6",
    "files": [
        {
            "sha": "3c954cf076ddc8db0bab9148f485e70c869dd67d",
            "filename": "tensorflow/core/api_def/api_test.cc",
            "status": "modified",
            "additions": 23,
            "deletions": 18,
            "changes": 41,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fapi_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fapi_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fapi_def%2Fapi_test.cc?ref=e61bac51b1deecc1e0acf16a70e362794a6cbfa6",
            "patch": "@@ -43,26 +43,27 @@ namespace {\n \n constexpr char kApiDefFilePattern[] = \"api_def_*.pbtxt\";\n \n-string DefaultApiDefDir() {\n+std::string DefaultApiDefDir() {\n   return GetDataDependencyFilepath(\n       io::JoinPath(\"tensorflow\", \"core\", \"api_def\", \"base_api\"));\n }\n \n-string PythonApiDefDir() {\n+std::string PythonApiDefDir() {\n   return GetDataDependencyFilepath(\n       io::JoinPath(\"tensorflow\", \"core\", \"api_def\", \"python_api\"));\n }\n \n // Reads golden ApiDef files and returns a map from file name to ApiDef file\n // contents.\n-void GetGoldenApiDefs(Env* env, const string& api_files_dir,\n-                      std::unordered_map<string, ApiDef>* name_to_api_def) {\n-  std::vector<string> matching_paths;\n+void GetGoldenApiDefs(\n+    Env* env, const std::string& api_files_dir,\n+    std::unordered_map<std::string, ApiDef>* name_to_api_def) {\n+  std::vector<std::string> matching_paths;\n   TF_CHECK_OK(env->GetMatchingPaths(\n       io::JoinPath(api_files_dir, kApiDefFilePattern), &matching_paths));\n \n   for (auto& file_path : matching_paths) {\n-    string file_contents;\n+    std::string file_contents;\n     TF_CHECK_OK(ReadFileToString(env, file_path, &file_contents));\n     file_contents = PBTxtFromMultiline(file_contents);\n \n@@ -76,8 +77,9 @@ void GetGoldenApiDefs(Env* env, const string& api_files_dir,\n }\n \n void TestAllApiDefsHaveCorrespondingOp(\n-    const OpList& ops, const std::unordered_map<string, ApiDef>& api_defs_map) {\n-  std::unordered_set<string> op_names;\n+    const OpList& ops,\n+    const std::unordered_map<std::string, ApiDef>& api_defs_map) {\n+  std::unordered_set<std::string> op_names;\n   for (const auto& op : ops.op()) {\n     op_names.insert(op.name());\n   }\n@@ -89,7 +91,8 @@ void TestAllApiDefsHaveCorrespondingOp(\n }\n \n void TestAllApiDefInputArgsAreValid(\n-    const OpList& ops, const std::unordered_map<string, ApiDef>& api_defs_map) {\n+    const OpList& ops,\n+    const std::unordered_map<std::string, ApiDef>& api_defs_map) {\n   for (const auto& op : ops.op()) {\n     const auto api_def_iter = api_defs_map.find(op.name());\n     if (api_def_iter == api_defs_map.end()) {\n@@ -113,7 +116,8 @@ void TestAllApiDefInputArgsAreValid(\n }\n \n void TestAllApiDefOutputArgsAreValid(\n-    const OpList& ops, const std::unordered_map<string, ApiDef>& api_defs_map) {\n+    const OpList& ops,\n+    const std::unordered_map<std::string, ApiDef>& api_defs_map) {\n   for (const auto& op : ops.op()) {\n     const auto api_def_iter = api_defs_map.find(op.name());\n     if (api_def_iter == api_defs_map.end()) {\n@@ -137,7 +141,8 @@ void TestAllApiDefOutputArgsAreValid(\n }\n \n void TestAllApiDefAttributeNamesAreValid(\n-    const OpList& ops, const std::unordered_map<string, ApiDef>& api_defs_map) {\n+    const OpList& ops,\n+    const std::unordered_map<std::string, ApiDef>& api_defs_map) {\n   for (const auto& op : ops.op()) {\n     const auto api_def_iter = api_defs_map.find(op.name());\n     if (api_def_iter == api_defs_map.end()) {\n@@ -159,7 +164,7 @@ void TestAllApiDefAttributeNamesAreValid(\n }\n \n void TestDeprecatedAttributesSetCorrectly(\n-    const std::unordered_map<string, ApiDef>& api_defs_map) {\n+    const std::unordered_map<std::string, ApiDef>& api_defs_map) {\n   for (const auto& name_and_api_def : api_defs_map) {\n     int num_deprecated_endpoints = 0;\n     const auto& api_def = name_and_api_def.second;\n@@ -186,7 +191,7 @@ void TestDeprecatedAttributesSetCorrectly(\n }\n \n void TestDeprecationVersionSetCorrectly(\n-    const std::unordered_map<string, ApiDef>& api_defs_map) {\n+    const std::unordered_map<std::string, ApiDef>& api_defs_map) {\n   for (const auto& name_and_api_def : api_defs_map) {\n     const auto& name = name_and_api_def.first;\n     const auto& api_def = name_and_api_def.second;\n@@ -205,13 +210,13 @@ class BaseApiTest : public ::testing::Test {\n  protected:\n   BaseApiTest() {\n     OpRegistry::Global()->Export(false, &ops_);\n-    const std::vector<string> multi_line_fields = {\"description\"};\n+    const std::vector<std::string> multi_line_fields = {\"description\"};\n \n     Env* env = Env::Default();\n     GetGoldenApiDefs(env, DefaultApiDefDir(), &api_defs_map_);\n   }\n   OpList ops_;\n-  std::unordered_map<string, ApiDef> api_defs_map_;\n+  std::unordered_map<std::string, ApiDef> api_defs_map_;\n };\n \n // Check that all ops have an ApiDef.\n@@ -233,7 +238,7 @@ TEST_F(BaseApiTest, AllApiDefsHaveCorrespondingOp) {\n   TestAllApiDefsHaveCorrespondingOp(ops_, api_defs_map_);\n }\n \n-string GetOpDefHasDocStringError(const string& op_name) {\n+std::string GetOpDefHasDocStringError(const std::string& op_name) {\n   return strings::Printf(\n       \"OpDef for %s has a doc string. \"\n       \"Doc strings must be defined in ApiDef instead of OpDef. \"\n@@ -301,13 +306,13 @@ class PythonApiTest : public ::testing::Test {\n  protected:\n   PythonApiTest() {\n     OpRegistry::Global()->Export(false, &ops_);\n-    const std::vector<string> multi_line_fields = {\"description\"};\n+    const std::vector<std::string> multi_line_fields = {\"description\"};\n \n     Env* env = Env::Default();\n     GetGoldenApiDefs(env, PythonApiDefDir(), &api_defs_map_);\n   }\n   OpList ops_;\n-  std::unordered_map<string, ApiDef> api_defs_map_;\n+  std::unordered_map<std::string, ApiDef> api_defs_map_;\n };\n \n // Check that ApiDefs have a corresponding op."
        },
        {
            "sha": "3534db758a78e01437aafa5e30acf4dfb857dd25",
            "filename": "tensorflow/core/api_def/update_api_def.cc",
            "status": "modified",
            "additions": 19,
            "deletions": 19,
            "changes": 38,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def.cc?ref=e61bac51b1deecc1e0acf16a70e362794a6cbfa6",
            "patch": "@@ -124,7 +124,7 @@ bool CheckDocsMatch(const OpDef& op1, const OpDef& op2) {\n \n // Returns true if descriptions and summaries in op match a\n // given single doc-string.\n-bool ValidateOpDocs(const OpDef& op, const string& doc) {\n+bool ValidateOpDocs(const OpDef& op, const std::string& doc) {\n   OpDefBuilder b(op.name());\n   // We don't really care about type we use for arguments and\n   // attributes. We just want to make sure attribute and argument names\n@@ -146,28 +146,28 @@ bool ValidateOpDocs(const OpDef& op, const string& doc) {\n }\n }  // namespace\n \n-string RemoveDoc(const OpDef& op, const string& file_contents,\n-                 size_t start_location) {\n+std::string RemoveDoc(const OpDef& op, const std::string& file_contents,\n+                      size_t start_location) {\n   // Look for a line starting with .Doc( after the REGISTER_OP.\n   const auto doc_start_location = file_contents.find(kDocStart, start_location);\n-  const string format_error = strings::Printf(\n+  const std::string format_error = strings::Printf(\n       \"Could not find %s doc for removal. Make sure the doc is defined with \"\n       \"'%s' prefix and '%s' suffix or remove the doc manually.\",\n       op.name().c_str(), kDocStart, kDocEnd);\n-  if (doc_start_location == string::npos) {\n+  if (doc_start_location == std::string::npos) {\n     std::cerr << format_error << std::endl;\n     LOG(ERROR) << \"Didn't find doc start\";\n     return file_contents;\n   }\n   const auto doc_end_location = file_contents.find(kDocEnd, doc_start_location);\n-  if (doc_end_location == string::npos) {\n+  if (doc_end_location == std::string::npos) {\n     LOG(ERROR) << \"Didn't find doc start\";\n     std::cerr << format_error << std::endl;\n     return file_contents;\n   }\n \n   const auto doc_start_size = sizeof(kDocStart) - 1;\n-  string doc_text = file_contents.substr(\n+  std::string doc_text = file_contents.substr(\n       doc_start_location + doc_start_size,\n       doc_end_location - doc_start_location - doc_start_size);\n \n@@ -189,12 +189,12 @@ namespace {\n // Remove .Doc calls that follow REGISTER_OP calls for the given ops.\n // We search for REGISTER_OP calls in the given op_files list.\n void RemoveDocs(const std::vector<const OpDef*>& ops,\n-                const std::vector<string>& op_files) {\n+                const std::vector<std::string>& op_files) {\n   // Set of ops that we already found REGISTER_OP calls for.\n-  std::set<string> processed_ops;\n+  std::set<std::string> processed_ops;\n \n   for (const auto& file : op_files) {\n-    string file_contents;\n+    std::string file_contents;\n     bool file_contents_updated = false;\n     TF_CHECK_OK(ReadFileToString(Env::Default(), file, &file_contents));\n \n@@ -203,11 +203,11 @@ void RemoveDocs(const std::vector<const OpDef*>& ops,\n         // We already found REGISTER_OP call for this op in another file.\n         continue;\n       }\n-      string register_call =\n+      std::string register_call =\n           strings::Printf(\"REGISTER_OP(\\\"%s\\\")\", op->name().c_str());\n       const auto register_call_location = file_contents.find(register_call);\n       // Find REGISTER_OP(OpName) call.\n-      if (register_call_location == string::npos) {\n+      if (register_call_location == std::string::npos) {\n         continue;\n       }\n       std::cout << \"Removing .Doc call for \" << op->name() << \" from \" << file\n@@ -228,11 +228,11 @@ void RemoveDocs(const std::vector<const OpDef*>& ops,\n \n // Returns ApiDefs text representation in multi-line format\n // constructed based on the given op.\n-string CreateApiDef(const OpDef& op) {\n+std::string CreateApiDef(const OpDef& op) {\n   ApiDefs api_defs;\n   FillBaseApiDef(api_defs.add_op(), op);\n \n-  const std::vector<string> multi_line_fields = {\"description\"};\n+  const std::vector<std::string> multi_line_fields = {\"description\"};\n   std::string new_api_defs_str;\n   ::tensorflow::protobuf::TextFormat::PrintToString(api_defs,\n                                                     &new_api_defs_str);\n@@ -242,8 +242,8 @@ string CreateApiDef(const OpDef& op) {\n // Creates ApiDef files for any new ops.\n // If op_file_pattern is not empty, then also removes .Doc calls from\n // new op registrations in these files.\n-void CreateApiDefs(const OpList& ops, const string& api_def_dir,\n-                   const string& op_file_pattern) {\n+void CreateApiDefs(const OpList& ops, const std::string& api_def_dir,\n+                   const std::string& op_file_pattern) {\n   auto* excluded_ops = GetExcludedOps();\n   std::vector<const OpDef*> new_ops_with_docs;\n \n@@ -252,8 +252,8 @@ void CreateApiDefs(const OpList& ops, const string& api_def_dir,\n       continue;\n     }\n     // Form the expected ApiDef path.\n-    string file_path =\n-        io::JoinPath(tensorflow::string(api_def_dir), kApiDefFileFormat);\n+    std::string file_path =\n+        io::JoinPath(std::string(api_def_dir), kApiDefFileFormat);\n     file_path = strings::Printf(file_path.c_str(), op.name().c_str());\n \n     // Create ApiDef if it doesn't exist.\n@@ -268,7 +268,7 @@ void CreateApiDefs(const OpList& ops, const string& api_def_dir,\n     }\n   }\n   if (!op_file_pattern.empty()) {\n-    std::vector<string> op_files;\n+    std::vector<std::string> op_files;\n     TF_CHECK_OK(Env::Default()->GetMatchingPaths(op_file_pattern, &op_files));\n     RemoveDocs(new_ops_with_docs, op_files);\n   }"
        },
        {
            "sha": "1ac71689bba2d077540fae28a950421142c7aa9f",
            "filename": "tensorflow/core/api_def/update_api_def.h",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def.h?ref=e61bac51b1deecc1e0acf16a70e362794a6cbfa6",
            "patch": "@@ -23,23 +23,23 @@ namespace tensorflow {\n \n // Returns ApiDefs text representation in multi-line format\n // constructed based on the given op.\n-string CreateApiDef(const OpDef& op);\n+std::string CreateApiDef(const OpDef& op);\n \n // Removes .Doc call for the given op.\n // If unsuccessful, returns original file_contents and prints an error.\n // start_location - We search for .Doc call starting at this location\n //   in file_contents.\n-string RemoveDoc(const OpDef& op, const string& file_contents,\n-                 size_t start_location);\n+std::string RemoveDoc(const OpDef& op, const std::string& file_contents,\n+                      size_t start_location);\n \n // Creates api_def_*.pbtxt files for any new ops (i.e. ops that don't have an\n // api_def_*.pbtxt file yet).\n // If op_file_pattern is non-empty, then this method will also\n // look for a REGISTER_OP call for the new ops and removes corresponding\n // .Doc() calls since the newly generated api_def_*.pbtxt files will\n // store the doc strings.\n-void CreateApiDefs(const OpList& ops, const string& api_def_dir,\n-                   const string& op_file_pattern);\n+void CreateApiDefs(const OpList& ops, const std::string& api_def_dir,\n+                   const std::string& op_file_pattern);\n \n }  // namespace tensorflow\n #endif  // TENSORFLOW_CORE_API_DEF_UPDATE_API_DEF_H_"
        },
        {
            "sha": "4cf74abf82cb6f807a1ff8bb4e47bb809bc123a2",
            "filename": "tensorflow/core/api_def/update_api_def_main.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def_main.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def_main.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def_main.cc?ref=e61bac51b1deecc1e0acf16a70e362794a6cbfa6",
            "patch": "@@ -33,8 +33,8 @@ limitations under the License.\n #include \"tensorflow/core/util/command_line_flags.h\"\n \n int main(int argc, char** argv) {\n-  tensorflow::string api_files_dir;\n-  tensorflow::string op_file_pattern;\n+  std::string api_files_dir;\n+  std::string op_file_pattern;\n   std::vector<tensorflow::Flag> flag_list = {\n       tensorflow::Flag(\"api_def_dir\", &api_files_dir,\n                        \"Base directory of api_def*.pbtxt files.\"),"
        },
        {
            "sha": "23751ffa3ecd25bc51c15f2ed68d741788b1118a",
            "filename": "tensorflow/core/api_def/update_api_def_test.cc",
            "status": "modified",
            "additions": 14,
            "deletions": 14,
            "changes": 28,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e61bac51b1deecc1e0acf16a70e362794a6cbfa6/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fapi_def%2Fupdate_api_def_test.cc?ref=e61bac51b1deecc1e0acf16a70e362794a6cbfa6",
            "patch": "@@ -24,15 +24,15 @@ namespace tensorflow {\n namespace {\n \n TEST(UpdateApiDefTest, TestRemoveDocSingleOp) {\n-  const string op_def_text = R\"opdef(\n+  const std::string op_def_text = R\"opdef(\n REGISTER_OP(\"Op1\")\n     .Input(\"a: T\")\n     .Output(\"output: T\")\n     .Attr(\"b: type\")\n     .SetShapeFn(shape_inference::UnchangedShape);\n )opdef\";\n \n-  const string op_def_text_with_doc = R\"opdef(\n+  const std::string op_def_text_with_doc = R\"opdef(\n REGISTER_OP(\"Op1\")\n     .Input(\"a: T\")\n     .Output(\"output: T\")\n@@ -50,7 +50,7 @@ output: Description for output.\n )doc\");\n )opdef\";\n \n-  const string op_text = R\"(\n+  const std::string op_text = R\"(\n name: \"Op1\"\n input_arg {\n   name: \"a\"\n@@ -75,7 +75,7 @@ description: \"Description\\nfor Op1.\"\n }\n \n TEST(UpdateApiDefTest, TestRemoveDocMultipleOps) {\n-  const string op_def_text = R\"opdef(\n+  const std::string op_def_text = R\"opdef(\n REGISTER_OP(\"Op1\")\n     .Input(\"a: T\")\n     .SetShapeFn(shape_inference::UnchangedShape);\n@@ -89,7 +89,7 @@ REGISTER_OP(\"Op3\")\n     .SetShapeFn(shape_inference::UnchangedShape);\n )opdef\";\n \n-  const string op_def_text_with_doc = R\"opdef(\n+  const std::string op_def_text_with_doc = R\"opdef(\n REGISTER_OP(\"Op1\")\n     .Input(\"a: T\")\n     .Doc(R\"doc(\n@@ -112,21 +112,21 @@ Summary for Op3.\n )doc\");\n )opdef\";\n \n-  const string op1_text = R\"(\n+  const std::string op1_text = R\"(\n name: \"Op1\"\n input_arg {\n   name: \"a\"\n }\n summary: \"Summary for Op1.\"\n )\";\n-  const string op2_text = R\"(\n+  const std::string op2_text = R\"(\n name: \"Op2\"\n input_arg {\n   name: \"a\"\n }\n summary: \"Summary for Op2.\"\n )\";\n-  const string op3_text = R\"(\n+  const std::string op3_text = R\"(\n name: \"Op3\"\n input_arg {\n   name: \"c\"\n@@ -138,12 +138,12 @@ summary: \"Summary for Op3.\"\n   protobuf::TextFormat::ParseFromString(op2_text, &op2);  // NOLINT\n   protobuf::TextFormat::ParseFromString(op3_text, &op3);  // NOLINT\n \n-  string updated_text =\n+  std::string updated_text =\n       RemoveDoc(op2, op_def_text_with_doc,\n                 op_def_text_with_doc.find(\"Op2\") /* start_location */);\n-  EXPECT_EQ(string::npos, updated_text.find(\"Summary for Op2\"));\n-  EXPECT_NE(string::npos, updated_text.find(\"Summary for Op1\"));\n-  EXPECT_NE(string::npos, updated_text.find(\"Summary for Op3\"));\n+  EXPECT_EQ(std::string::npos, updated_text.find(\"Summary for Op2\"));\n+  EXPECT_NE(std::string::npos, updated_text.find(\"Summary for Op1\"));\n+  EXPECT_NE(std::string::npos, updated_text.find(\"Summary for Op3\"));\n \n   updated_text = RemoveDoc(op3, updated_text,\n                            updated_text.find(\"Op3\") /* start_location */);\n@@ -153,7 +153,7 @@ summary: \"Summary for Op3.\"\n }\n \n TEST(UpdateApiDefTest, TestCreateApiDef) {\n-  const string op_text = R\"(\n+  const std::string op_text = R\"(\n name: \"Op1\"\n input_arg {\n   name: \"a\"\n@@ -173,7 +173,7 @@ description: \"Description\\nfor Op1.\"\n   OpDef op;\n   protobuf::TextFormat::ParseFromString(op_text, &op);  // NOLINT\n \n-  const string expected_api_def = R\"(op {\n+  const std::string expected_api_def = R\"(op {\n   graph_op_name: \"Op1\"\n   in_arg {\n     name: \"a\""
        }
    ],
    "stats": {
        "total": 121,
        "additions": 63,
        "deletions": 58
    }
}