{
    "author": "chsigg",
    "message": "[xla-opt] Register inliner interfaces in `xla-opt`.\n\nThe inliner pass requires interfaces for the func and LLVM dialects which were not registered. This CL registers them and adds the corresponding dependencies.\n\nThis is required to run the whole Triton compilation pipeline.\n\nPiperOrigin-RevId: 803373875",
    "sha": "7967261ff24352d99f8f3db31e990b637d0cfeb2",
    "files": [
        {
            "sha": "1262ed823016abeb0dbc5ba6e47dab0d9b42f16b",
            "filename": "third_party/xla/xla/service/gpu/tests/BUILD",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/7967261ff24352d99f8f3db31e990b637d0cfeb2/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftests%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/7967261ff24352d99f8f3db31e990b637d0cfeb2/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftests%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftests%2FBUILD?ref=7967261ff24352d99f8f3db31e990b637d0cfeb2",
            "patch": "@@ -655,15 +655,18 @@ lit_test_suite(\n #     srcs = [\"xla-opt.cc\"],\n #     deps = [\n #         \"@llvm-project//mlir:AllExtensions\",\n+#         \"@llvm-project//mlir:BuiltinToLLVMIRTranslation\",\n #         \"@llvm-project//mlir:FuncDialect\",\n+#         \"@llvm-project//mlir:FuncExtensions\",\n+#         \"@llvm-project//mlir:LLVMIRTransforms\",\n+#         \"@llvm-project//mlir:LLVMToLLVMIRTranslation\",\n #         \"@llvm-project//mlir:MlirOptLib\",\n #         \"@llvm-project//mlir:RegisterAllExtensions\",\n #         \"@llvm-project//mlir:TensorDialect\",\n #         \"//xla/backends/gpu/codegen/emitters/transforms:passes\",\n #         \"//xla/backends/gpu/codegen/triton/ir:triton_xla\",\n #         \"//xla/backends/gpu/codegen/triton/transforms:passes\",\n-#         # Needed for xla_ops.h\n-#         \"//xla/codegen/emitters/ir:xla\",  # buildcleaner: keep\n+#         \"//xla/codegen/emitters/ir:xla\",\n #         \"//xla/codegen/emitters/transforms:passes\",\n #         \"@triton//:AllPassesAndDialects\",\n #         \"@triton//third_party/amd:TestAMDAnalysis\","
        },
        {
            "sha": "716249eba4420507a9834a88bfb2f293be96daa4",
            "filename": "third_party/xla/xla/service/gpu/tests/xla-opt.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 1,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/7967261ff24352d99f8f3db31e990b637d0cfeb2/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftests%2Fxla-opt.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/7967261ff24352d99f8f3db31e990b637d0cfeb2/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftests%2Fxla-opt.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftests%2Fxla-opt.cc?ref=7967261ff24352d99f8f3db31e990b637d0cfeb2",
            "patch": "@@ -13,20 +13,28 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n+#include \"mlir/Dialect/Func/Extensions/InlinerExtension.h\"\n #include \"mlir/Dialect/Func/IR/FuncOps.h\"\n+#include \"mlir/Dialect/LLVMIR/Transforms/InlinerInterfaceImpl.h\"\n #include \"mlir/Dialect/Tensor/IR/Tensor.h\"\n #include \"mlir/InitAllExtensions.h\"\n+#include \"mlir/Target/LLVMIR/Dialect/Builtin/BuiltinToLLVMIRTranslation.h\"\n+#include \"mlir/Target/LLVMIR/Dialect/LLVMIR/LLVMToLLVMIRTranslation.h\"\n #include \"mlir/Tools/mlir-opt/MlirOptMain.h\"\n #include \"xla/backends/gpu/codegen/emitters/transforms/passes.h\"\n #include \"xla/backends/gpu/codegen/triton/ir/triton_xla_ops.h\"\n #include \"xla/backends/gpu/codegen/triton/transforms/passes.h\"\n-#include \"xla/codegen/emitters/ir/xla_ops.h\"\n+#include \"xla/codegen/emitters/ir/xla_dialect.h\"\n #include \"xla/codegen/emitters/transforms/passes.h\"\n #include \"third_party/triton/bin/RegisterTritonDialects.h\"\n \n int main(int argc, char **argv) {\n   mlir::DialectRegistry registry;\n   mlir::registerAllExtensions(registry);\n+  registerBuiltinDialectTranslation(registry);\n+  registerLLVMDialectTranslation(registry);\n+  mlir::LLVM::registerInlinerInterface(registry);\n+  mlir::func::registerInlinerExtension(registry);\n   registerTritonDialects(registry);  // This registers all passes as well.\n   registry.insert<mlir::func::FuncDialect, mlir::tensor::TensorDialect,\n                   mlir::triton::xla::XlaTritonDialect, xla::XlaDialect>();"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 14,
        "deletions": 3
    }
}