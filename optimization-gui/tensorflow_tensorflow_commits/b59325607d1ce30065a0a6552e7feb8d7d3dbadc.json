{
    "author": "krishnaharidasan",
    "message": "Make a variant of Get in AttributeMap that returns a variant type.\n\nPiperOrigin-RevId: 841934935",
    "sha": "b59325607d1ce30065a0a6552e7feb8d7d3dbadc",
    "files": [
        {
            "sha": "1efa12d993c918095e8b6f836d057309f0c610b5",
            "filename": "third_party/xla/xla/python/ifrt/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b59325607d1ce30065a0a6552e7feb8d7d3dbadc/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b59325607d1ce30065a0a6552e7feb8d7d3dbadc/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2FBUILD?ref=b59325607d1ce30065a0a6552e7feb8d7d3dbadc",
            "patch": "@@ -179,7 +179,6 @@ xla_cc_test(\n         \"//xla/tsl/platform:statusor\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:status_matchers\",\n-        \"@com_google_absl//absl/strings:string_view\",\n         \"@com_google_absl//absl/types:span\",\n         \"@com_google_googletest//:gtest_main\",\n     ],"
        },
        {
            "sha": "b1823d2d88b562c8f0ca61340c24167ae011a1be",
            "filename": "third_party/xla/xla/python/ifrt/attribute_map.h",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b59325607d1ce30065a0a6552e7feb8d7d3dbadc/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fattribute_map.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b59325607d1ce30065a0a6552e7feb8d7d3dbadc/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fattribute_map.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fattribute_map.h?ref=b59325607d1ce30065a0a6552e7feb8d7d3dbadc",
            "patch": "@@ -95,15 +95,19 @@ class AttributeMap {\n \n   template <typename T>\n   absl::StatusOr<T> Get(const std::string& key) const {\n-    if constexpr (std::is_same_v<T, std::string> ||\n-                  std::is_same_v<T, absl::string_view>) {\n+    if constexpr (std::is_same_v<T, Value>) {\n+      auto it = map_.find(key);\n+      if (it == map_.end()) {\n+        return absl::NotFoundError(absl::StrCat(\"Key not found: \", key));\n+      }\n+      return it->second;\n+    } else if constexpr (std::is_same_v<T, std::string>) {\n       return Get<T, StringValue>(key);\n     } else if constexpr (std::is_same_v<T, bool>) {\n       return Get<T, BoolValue>(key);\n     } else if constexpr (std::is_same_v<T, int64_t>) {\n       return Get<T, Int64Value>(key);\n-    } else if constexpr (std::is_same_v<T, std::vector<int64_t>> ||\n-                         std::is_same_v<T, absl::Span<const int64_t>>) {\n+    } else if constexpr (std::is_same_v<T, std::vector<int64_t>>) {\n       return Get<T, Int64ListValue>(key);\n     } else if constexpr (std::is_same_v<T, float>) {\n       return Get<T, FloatValue>(key);"
        },
        {
            "sha": "c8425ec79038a45399872855d128e650edebb30c",
            "filename": "third_party/xla/xla/python/ifrt/attribute_map_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b59325607d1ce30065a0a6552e7feb8d7d3dbadc/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fattribute_map_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b59325607d1ce30065a0a6552e7feb8d7d3dbadc/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fattribute_map_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fattribute_map_test.cc?ref=b59325607d1ce30065a0a6552e7feb8d7d3dbadc",
            "patch": "@@ -23,7 +23,6 @@ limitations under the License.\n #include <gtest/gtest.h>\n #include \"absl/status/status.h\"\n #include \"absl/status/status_matchers.h\"\n-#include \"absl/strings/string_view.h\"\n #include \"absl/types/span.h\"\n #include \"xla/python/ifrt/serdes_test_util.h\"\n #include \"xla/python/ifrt/serdes_version.h\"\n@@ -67,19 +66,16 @@ TEST(AttributeMapTest, Get) {\n   });\n \n   EXPECT_THAT(map.Get<std::string>(\"string\"), IsOkAndHolds(\"value\"));\n-  EXPECT_THAT(map.Get<absl::string_view>(\"string\"), IsOkAndHolds(\"value\"));\n   EXPECT_THAT(map.Get<bool>(\"bool\"), IsOkAndHolds(true));\n   EXPECT_THAT(map.Get<int64_t>(\"int64\"), IsOkAndHolds(123));\n   EXPECT_THAT(map.Get<std::vector<int64_t>>(\"int64_list\"),\n               IsOkAndHolds(std::vector<int64_t>{1, 2}));\n-  EXPECT_THAT(map.Get<absl::Span<const int64_t>>(\"int64_list\"),\n-              IsOkAndHolds(std::vector<int64_t>{1, 2}));\n   EXPECT_THAT(map.Get<float>(\"float\"), IsOkAndHolds(1.23f));\n \n   EXPECT_THAT(map.Get<std::string>(\"float\"),\n               StatusIs(absl::StatusCode::kInvalidArgument,\n                        HasSubstr(\"Value type mismatch for key: float\")));\n-  EXPECT_THAT(map.Get<absl::Span<const int64_t>>(\"string\"),\n+  EXPECT_THAT(map.Get<std::vector<int64_t>>(\"string\"),\n               StatusIs(absl::StatusCode::kInvalidArgument,\n                        HasSubstr(\"Value type mismatch for key: string\")));\n }"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 9,
        "deletions": 10
    }
}