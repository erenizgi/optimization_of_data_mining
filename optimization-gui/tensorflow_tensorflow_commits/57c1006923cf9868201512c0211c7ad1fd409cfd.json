{
    "author": "hhb",
    "message": "Add ScopedAsyncTrackingEvent to PJRT C API.\n\nPiperOrigin-RevId: 846413643",
    "sha": "57c1006923cf9868201512c0211c7ad1fd409cfd",
    "files": [
        {
            "sha": "babc266cfdb3415d6da5de3e86568a2ecb5aeac5",
            "filename": "third_party/xla/xla/pjrt/c/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2FBUILD?ref=57c1006923cf9868201512c0211c7ad1fd409cfd",
            "patch": "@@ -276,6 +276,7 @@ cc_library(\n         \"//xla/pjrt:pjrt_layout\",\n         \"//xla/pjrt:pjrt_stream_executor_client\",\n         \"//xla/pjrt:raw_buffer\",\n+        \"//xla/pjrt:scoped_async_tracking_event\",\n         \"//xla/pjrt/distributed:key_value_store_interface\",\n         \"//xla/pjrt/proto:compile_options_proto_cc\",\n         \"//xla/pjrt/proto:topology_description_proto_cc\","
        },
        {
            "sha": "1c142fa18afc151257ef98a93ab2d6ae38bd7e23",
            "filename": "third_party/xla/xla/pjrt/c/CHANGELOG.md",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2FCHANGELOG.md",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2FCHANGELOG.md",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2FCHANGELOG.md?ref=57c1006923cf9868201512c0211c7ad1fd409cfd",
            "patch": "@@ -1,5 +1,11 @@\n # PJRT C API changelog\n \n+## 0.86\n+\n+* Add `PJRT_Device_CreateAsyncTrackingEvent`.\n+\n+* Add `PJRT_AsyncTrackingEvent_Destroy`.\n+\n ## 0.85\n \n * Add `PJRT_Device_PoisonExecution`."
        },
        {
            "sha": "ae8caf9d7242466e52798dae2c0c1f4bb45b5973",
            "filename": "third_party/xla/xla/pjrt/c/pjrt_c_api.h",
            "status": "modified",
            "additions": 35,
            "deletions": 2,
            "changes": 37,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api.h?ref=57c1006923cf9868201512c0211c7ad1fd409cfd",
            "patch": "@@ -104,7 +104,7 @@ PJRT_DEFINE_STRUCT_TRAITS(PJRT_Extension_Base, next);\n // Changes include:\n // * Adding a new field to the PJRT_Api or argument structs\n // * Renaming a method or argument (doesn't affect ABI)\n-#define PJRT_API_MINOR 85\n+#define PJRT_API_MINOR 86\n \n // The plugin should set the major_version and minor_version of\n // PJRT_Api.pjrt_api_version to be the `PJRT_API_MAJOR` and `PJRT_API_MINOR` in\n@@ -1437,6 +1437,36 @@ PJRT_DEFINE_STRUCT_TRAITS(PJRT_Device_PoisonExecution_Args, poisoned);\n typedef PJRT_Error* PJRT_Device_PoisonExecution(\n     PJRT_Device_PoisonExecution_Args* args);\n \n+// --------------------------- AsyncTrackingEvent ------------------------------\n+\n+typedef struct PJRT_AsyncTrackingEvent PJRT_AsyncTrackingEvent;\n+\n+struct PJRT_Device_CreateAsyncTrackingEvent_Args {\n+  size_t struct_size;\n+  PJRT_Extension_Base* extension_start;\n+  PJRT_Device* device;\n+  const char* description;\n+  size_t description_size;\n+  PJRT_AsyncTrackingEvent* event;  // out\n+};\n+PJRT_DEFINE_STRUCT_TRAITS(PJRT_Device_CreateAsyncTrackingEvent_Args, event);\n+\n+// Creates an async tracking event. The caller is responsible for destroying the\n+// event.\n+typedef PJRT_Error* PJRT_Device_CreateAsyncTrackingEvent(\n+    PJRT_Device_CreateAsyncTrackingEvent_Args* args);\n+\n+struct PJRT_AsyncTrackingEvent_Destroy_Args {\n+  size_t struct_size;\n+  PJRT_Extension_Base* extension_start;\n+  PJRT_AsyncTrackingEvent* event;\n+};\n+PJRT_DEFINE_STRUCT_TRAITS(PJRT_AsyncTrackingEvent_Destroy_Args, event);\n+\n+// Destroys the async tracking event.\n+typedef PJRT_Error* PJRT_AsyncTrackingEvent_Destroy(\n+    PJRT_AsyncTrackingEvent_Destroy_Args* args);\n+\n //-------------------------------- Memory --------------------------------------\n \n struct PJRT_Memory_Id_Args {\n@@ -2794,10 +2824,13 @@ typedef struct PJRT_Api {\n   _PJRT_API_STRUCT_FIELD(PJRT_AsyncHostToDeviceTransferManager_TransferLiteral);\n   _PJRT_API_STRUCT_FIELD(PJRT_Buffer_CopyRawToHostFuture);\n   _PJRT_API_STRUCT_FIELD(PJRT_Device_PoisonExecution);\n+  _PJRT_API_STRUCT_FIELD(PJRT_Device_CreateAsyncTrackingEvent);\n+  _PJRT_API_STRUCT_FIELD(PJRT_AsyncTrackingEvent_Destroy);\n } PJRT_Api;\n \n enum {\n-  PJRT_Api_STRUCT_SIZE = PJRT_STRUCT_SIZE(PJRT_Api, PJRT_Device_PoisonExecution)\n+  PJRT_Api_STRUCT_SIZE =\n+      PJRT_STRUCT_SIZE(PJRT_Api, PJRT_AsyncTrackingEvent_Destroy)\n };\n \n #undef _PJRT_API_STRUCT_FIELD"
        },
        {
            "sha": "19e9c0678a0160e9658b5e676b68bed337fb4282",
            "filename": "third_party/xla/xla/pjrt/c/pjrt_c_api_test.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_test.cc?ref=57c1006923cf9868201512c0211c7ad1fd409cfd",
            "patch": "@@ -956,6 +956,10 @@ FieldOffsetsAndSizesForVersion(int major_version, int minor_version) {\n     if (minor_version >= 85) {\n       add_field(\"PJRT_Device_PoisonExecution\", kFnPtrSize);\n     }\n+    if (minor_version >= 86) {\n+      add_field(\"PJRT_Device_CreateAsyncTrackingEvent\", kFnPtrSize);\n+      add_field(\"PJRT_AsyncTrackingEvent_Destroy\", kFnPtrSize);\n+    }\n     return version_offsets_and_sizes;\n   }\n   LOG(FATAL) << \"Unsupported API version: \" << major_version << \".\"\n@@ -1361,6 +1365,12 @@ TEST_F(PjrtCAbiTestBase, FieldOffsetsAndSizes) {\n           {\"PJRT_Device_PoisonExecution\",\n            {offsetof(PJRT_Api, PJRT_Device_PoisonExecution),\n             sizeof(PJRT_Api::PJRT_Device_PoisonExecution)}},\n+          {\"PJRT_Device_CreateAsyncTrackingEvent\",\n+           {offsetof(PJRT_Api, PJRT_Device_CreateAsyncTrackingEvent),\n+            sizeof(PJRT_Api::PJRT_Device_CreateAsyncTrackingEvent)}},\n+          {\"PJRT_AsyncTrackingEvent_Destroy\",\n+           {offsetof(PJRT_Api, PJRT_AsyncTrackingEvent_Destroy),\n+            sizeof(PJRT_Api::PJRT_AsyncTrackingEvent_Destroy)}},\n       };\n   ASSERT_EQ(api_->pjrt_api_version.major_version, PJRT_API_MAJOR);\n   ASSERT_EQ(api_->pjrt_api_version.minor_version, PJRT_API_MINOR);"
        },
        {
            "sha": "23c788b97ad7bd4df4efe08ae79172c50459757f",
            "filename": "third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.cc",
            "status": "modified",
            "additions": 32,
            "deletions": 0,
            "changes": 32,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_wrapper_impl.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_wrapper_impl.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_wrapper_impl.cc?ref=57c1006923cf9868201512c0211c7ad1fd409cfd",
            "patch": "@@ -63,6 +63,7 @@ limitations under the License.\n #include \"xla/pjrt/proto/compile_options.pb.h\"\n #include \"xla/pjrt/proto/topology_description.pb.h\"\n #include \"xla/pjrt/raw_buffer.h\"\n+#include \"xla/pjrt/scoped_async_tracking_event.h\"\n #include \"xla/runtime/device_id.h\"\n #include \"xla/service/computation_placer.h\"\n #include \"xla/service/hlo.pb.h\"\n@@ -789,6 +790,33 @@ PJRT_Error* PJRT_Device_PoisonExecution(\n   return nullptr;\n }\n \n+PJRT_Error* PJRT_Device_CreateAsyncTrackingEvent(\n+    PJRT_Device_CreateAsyncTrackingEvent_Args* args) {\n+  PJRT_RETURN_IF_ERROR(ActualStructSizeIsGreaterOrEqual(\n+      \"PJRT_Device_CreateAsyncTrackingEvent_Args\",\n+      PJRT_Device_CreateAsyncTrackingEvent_Args_STRUCT_SIZE,\n+      args->struct_size));\n+\n+  absl::string_view description(args->description, args->description_size);\n+  std::unique_ptr<xla::ScopedAsyncTrackingEvent> event =\n+      args->device->device->CreateAsyncTrackingEvent(description);\n+  if (event == nullptr) {\n+    args->event = nullptr;\n+  } else {\n+    args->event = new PJRT_AsyncTrackingEvent{std::move(event)};\n+  }\n+  return nullptr;\n+}\n+\n+PJRT_Error* PJRT_AsyncTrackingEvent_Destroy(\n+    PJRT_AsyncTrackingEvent_Destroy_Args* args) {\n+  PJRT_RETURN_IF_ERROR(ActualStructSizeIsGreaterOrEqual(\n+      \"PJRT_AsyncTrackingEvent_Destroy_Args\",\n+      PJRT_AsyncTrackingEvent_Destroy_Args_STRUCT_SIZE, args->struct_size));\n+  delete args->event;\n+  return nullptr;\n+}\n+\n PJRT_Error* PJRT_AsyncHostToDeviceTransferManager_RetrieveBuffer(\n     PJRT_AsyncHostToDeviceTransferManager_RetrieveBuffer_Args* args) {\n   PJRT_RETURN_IF_ERROR(ActualStructSizeIsGreaterOrEqual(\n@@ -3243,6 +3271,10 @@ PJRT_Api CreatePjrtApi(PJRT_Client_Create* create_fn,\n       /*PJRT_Buffer_CopyRawToHostFuture=*/\n       pjrt::PJRT_Buffer_CopyRawToHostFuture,\n       /*PJRT_Device_PoisonExecution=*/pjrt::PJRT_Device_PoisonExecution,\n+      /*PJRT_Device_CreateAsyncTrackingEvent=*/\n+      pjrt::PJRT_Device_CreateAsyncTrackingEvent,\n+      /*PJRT_AsyncTrackingEvent_Destroy=*/\n+      pjrt::PJRT_AsyncTrackingEvent_Destroy,\n   };\n }\n "
        },
        {
            "sha": "e53813804306515c2550da14408f30195b701d90",
            "filename": "third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.h",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_wrapper_impl.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_wrapper_impl.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_wrapper_impl.h?ref=57c1006923cf9868201512c0211c7ad1fd409cfd",
            "patch": "@@ -42,6 +42,7 @@ limitations under the License.\n #include \"xla/pjrt/pjrt_device_description.h\"\n #include \"xla/pjrt/pjrt_executable.h\"\n #include \"xla/pjrt/pjrt_layout.h\"\n+#include \"xla/pjrt/scoped_async_tracking_event.h\"\n #include \"xla/shape.h\"\n \n struct PJRT_Error {\n@@ -259,6 +260,10 @@ struct PJRT_PhaseCompiler {\n       : compiler(phase_compiler), owned_compiler(nullptr) {}\n };\n \n+struct PJRT_AsyncTrackingEvent {\n+  std::unique_ptr<xla::ScopedAsyncTrackingEvent> event;\n+};\n+\n namespace pjrt {\n // C API definitions\n "
        },
        {
            "sha": "5f06f8d3ed1fda195b82123a50d9a8936a2e618a",
            "filename": "third_party/xla/xla/pjrt/c_api_client/BUILD",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2FBUILD?ref=57c1006923cf9868201512c0211c7ad1fd409cfd",
            "patch": "@@ -57,6 +57,7 @@ cc_library(\n         \"//xla/pjrt:pjrt_device_dimensions\",\n         \"//xla/pjrt:pjrt_executable\",\n         \"//xla/pjrt:pjrt_layout\",\n+        \"//xla/pjrt:scoped_async_tracking_event\",\n         \"//xla/pjrt:string_utils\",\n         \"//xla/pjrt/c:pjrt_c_api_ffi_extension_hdrs\",\n         \"//xla/pjrt/c:pjrt_c_api_hdrs\",\n@@ -77,6 +78,8 @@ cc_library(\n         \"//xla/service:computation_placer_hdr\",\n         \"//xla/service:hlo_cost_analysis\",\n         \"//xla/service:hlo_proto_cc\",\n+        \"//xla/tsl/concurrency:async_value\",\n+        \"//xla/tsl/concurrency:ref_count\",\n         \"//xla/tsl/framework:allocator\",\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:statusor\","
        },
        {
            "sha": "4d519828fbf1439fb8faae67f52a72de9465b1b3",
            "filename": "third_party/xla/xla/pjrt/c_api_client/pjrt_c_api_client.cc",
            "status": "modified",
            "additions": 45,
            "deletions": 0,
            "changes": 45,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.cc?ref=57c1006923cf9868201512c0211c7ad1fd409cfd",
            "patch": "@@ -77,10 +77,13 @@ limitations under the License.\n #include \"xla/pjrt/pjrt_executable.h\"\n #include \"xla/pjrt/pjrt_layout.h\"\n #include \"xla/pjrt/proto/compile_options.pb.h\"\n+#include \"xla/pjrt/scoped_async_tracking_event.h\"\n #include \"xla/service/computation_placer.h\"\n #include \"xla/service/hlo.pb.h\"\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n+#include \"xla/tsl/concurrency/async_value.h\"\n+#include \"xla/tsl/concurrency/ref_count.h\"\n #include \"xla/tsl/framework/allocator.h\"\n #include \"xla/tsl/platform/errors.h\"\n #include \"xla/tsl/platform/statusor.h\"\n@@ -1742,6 +1745,48 @@ absl::StatusOr<bool> PjRtCApiDevice::PoisonExecution(int32_t launch_id,\n   return args.poisoned;\n }\n \n+std::unique_ptr<ScopedAsyncTrackingEvent>\n+PjRtCApiDevice::CreateAsyncTrackingEvent(absl::string_view description) const {\n+  if (client_->pjrt_c_api()->pjrt_api_version.major_version == 0 &&\n+      client_->pjrt_c_api()->pjrt_api_version.minor_version < 86) {\n+    return nullptr;\n+  }\n+  PJRT_Device_CreateAsyncTrackingEvent_Args args;\n+  args.struct_size = PJRT_Device_CreateAsyncTrackingEvent_Args_STRUCT_SIZE;\n+  args.extension_start = nullptr;\n+  args.device = c_device();\n+  args.description = description.data();\n+  args.description_size = description.size();\n+  args.event = nullptr;\n+\n+  const PJRT_Api* api = client_->pjrt_c_api();\n+  pjrt::LogFatalIfPjrtError(api->PJRT_Device_CreateAsyncTrackingEvent(&args),\n+                            api);\n+\n+  if (args.event == nullptr) {\n+    return nullptr;\n+  }\n+  return std::make_unique<PjRtCApiAsyncTrackingEvent>(api, args.event);\n+}\n+\n+PjRtCApiAsyncTrackingEvent::PjRtCApiAsyncTrackingEvent(\n+    const PJRT_Api* c_api, PJRT_AsyncTrackingEvent* event)\n+    : c_api_(c_api), event_(event) {}\n+\n+PjRtCApiAsyncTrackingEvent::~PjRtCApiAsyncTrackingEvent() {\n+  PJRT_AsyncTrackingEvent_Destroy_Args args;\n+  args.struct_size = PJRT_AsyncTrackingEvent_Destroy_Args_STRUCT_SIZE;\n+  args.extension_start = nullptr;\n+  args.event = event_;\n+  pjrt::LogFatalIfPjrtError(c_api_->PJRT_AsyncTrackingEvent_Destroy(&args),\n+                            c_api_);\n+}\n+\n+void PjRtCApiAsyncTrackingEvent::AddDependency(\n+    tsl::RCReference<tsl::AsyncValue> dependency) {\n+  LOG(FATAL) << \"AddDependency is not supported in C API yet.\";\n+}\n+\n // ------------------------------- Memory --------------------------------------\n \n const PJRT_Api* PjRtCApiMemorySpace::pjrt_c_api() const {"
        },
        {
            "sha": "30e99cd55d74a72ab42d323953dea42c4a6c0cdf",
            "filename": "third_party/xla/xla/pjrt/c_api_client/pjrt_c_api_client.h",
            "status": "modified",
            "additions": 17,
            "deletions": 7,
            "changes": 24,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/57c1006923cf9868201512c0211c7ad1fd409cfd/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.h?ref=57c1006923cf9868201512c0211c7ad1fd409cfd",
            "patch": "@@ -54,9 +54,12 @@ limitations under the License.\n #include \"xla/pjrt/pjrt_executable.h\"\n #include \"xla/pjrt/pjrt_layout.h\"\n #include \"xla/pjrt/proto/topology_description.pb.h\"\n+#include \"xla/pjrt/scoped_async_tracking_event.h\"\n #include \"xla/service/computation_placer.h\"\n #include \"xla/service/hlo_cost_analysis.h\"\n #include \"xla/shape.h\"\n+#include \"xla/tsl/concurrency/async_value.h\"\n+#include \"xla/tsl/concurrency/ref_count.h\"\n #include \"xla/tsl/framework/allocator.h\"\n #include \"xla/tsl/protobuf/coordination_service.pb.h\"\n #include \"xla/util.h\"\n@@ -171,13 +174,7 @@ class PjRtCApiDevice : public PjRtDevice {\n       absl::string_view kind) const override;\n \n   std::unique_ptr<ScopedAsyncTrackingEvent> CreateAsyncTrackingEvent(\n-      absl::string_view description) const override {\n-    LOG(FATAL)\n-        << \"PJRT C API does not support CreateAsyncTrackingEvent. Please \"\n-           \"report an issue at https://github.com/google/jax/issues if you \"\n-           \"need this feature.\";\n-    return nullptr;\n-  }\n+      absl::string_view description) const override;\n \n   absl::StatusOr<bool> PoisonExecution(int32_t launch_id,\n                                        absl::Status error) override;\n@@ -324,6 +321,19 @@ class PjRtCApiTopologyDescription : public PjRtTopologyDescription {\n   void InitAttributes();\n };\n \n+class PjRtCApiAsyncTrackingEvent : public ScopedAsyncTrackingEvent {\n+ public:\n+  PjRtCApiAsyncTrackingEvent(const PJRT_Api* c_api,\n+                             PJRT_AsyncTrackingEvent* event);\n+  ~PjRtCApiAsyncTrackingEvent() override;\n+\n+  void AddDependency(tsl::RCReference<tsl::AsyncValue> dependency) override;\n+\n+ private:\n+  const PJRT_Api* c_api_;\n+  PJRT_AsyncTrackingEvent* event_;\n+};\n+\n class PjRtCApiClient : public PjRtClient {\n  public:\n   PjRtCApiClient("
        }
    ],
    "stats": {
        "total": 163,
        "additions": 154,
        "deletions": 9
    }
}