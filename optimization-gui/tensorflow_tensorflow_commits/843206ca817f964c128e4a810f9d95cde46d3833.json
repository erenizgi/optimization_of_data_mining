{
    "author": "ybaturina",
    "message": "Enable using custom hermetic NCCL version.\n\nThe NCCL version can be chosen via `HERMETIC_NCCL_VERSION` env var.\n\nSee docs [here](https://github.com/google-ml-infra/rules_ml_toolchain/blob/main/gpu/README.md#environment-variables-controlling-the-hermetic-cudacudnnnvshmem-versions).\n\nPiperOrigin-RevId: 846788706",
    "sha": "843206ca817f964c128e4a810f9d95cde46d3833",
    "files": [
        {
            "sha": "35e5b9454a68c029da6930a4bed0e4d2fe2f4a1d",
            "filename": ".bazelrc",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/843206ca817f964c128e4a810f9d95cde46d3833/.bazelrc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/843206ca817f964c128e4a810f9d95cde46d3833/.bazelrc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/.bazelrc?ref=843206ca817f964c128e4a810f9d95cde46d3833",
            "patch": "@@ -291,10 +291,11 @@ common:mkl_aarch64_threadpool -c opt\n # This is an alias for the mkl_aarch64_threadpool build.\n common:mkl_aarch64 --config=mkl_aarch64_threadpool\n \n-# Default CUDA, CUDNN and NVSHMEM versions.\n+# Default CUDA, CUDNN, NCCL and NVSHMEM versions.\n common:cuda_version --repo_env=HERMETIC_CUDA_VERSION=\"12.5.1\"\n common:cuda_version --repo_env=HERMETIC_CUDNN_VERSION=\"9.3.0\"\n common:cuda_version --repo_env=HERMETIC_NVSHMEM_VERSION=\"3.2.5\"\n+common:cuda_version --repo_env=HERMETIC_NCCL_VERSION=\"2.27.7\"\n \n # CUDA: This config refers to building CUDA op kernels with nvcc.\n common:cuda --repo_env TF_NEED_CUDA=1"
        },
        {
            "sha": "0c4c70e21101bc04df2949cf03e2edb387003902",
            "filename": "WORKSPACE",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/843206ca817f964c128e4a810f9d95cde46d3833/WORKSPACE",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/843206ca817f964c128e4a810f9d95cde46d3833/WORKSPACE",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/WORKSPACE?ref=843206ca817f964c128e4a810f9d95cde46d3833",
            "patch": "@@ -21,10 +21,10 @@ tf_http_archive(\n # Details: https://github.com/google-ml-infra/rules_ml_toolchain\n tf_http_archive(\n     name = \"rules_ml_toolchain\",\n-    sha256 = \"53905ede50e3eebc782266e20e9b9ac1d7166ef68b877bea593d3600dcfe03e6\",\n-    strip_prefix = \"rules_ml_toolchain-a1ff84835e407b41eef5fd1a865a23748c294db6\",\n+    sha256 = \"1c2c530a054e9e8b3c811ec21ed8a687fc865bec3abbc8ff65beb829b1d67ae4\",\n+    strip_prefix = \"rules_ml_toolchain-6734d2a174bf29e731d3f473743d1cc1a86100c3\",\n     urls = tf_mirror_urls(\n-        \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/a1ff84835e407b41eef5fd1a865a23748c294db6.tar.gz\",\n+        \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/6734d2a174bf29e731d3f473743d1cc1a86100c3.tar.gz\",\n     ),\n )\n "
        },
        {
            "sha": "22c315dc3c29bba7980013cead766592798bc7b3",
            "filename": "ci/official/utilities/code_check_full.bats",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/843206ca817f964c128e4a810f9d95cde46d3833/ci%2Fofficial%2Futilities%2Fcode_check_full.bats",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/843206ca817f964c128e4a810f9d95cde46d3833/ci%2Fofficial%2Futilities%2Fcode_check_full.bats",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/ci%2Fofficial%2Futilities%2Fcode_check_full.bats?ref=843206ca817f964c128e4a810f9d95cde46d3833",
            "patch": "@@ -216,6 +216,7 @@ EOF\n     --@local_config_cuda//cuda:include_cuda_libs=false \\\n     --repo_env=HERMETIC_CUDA_VERSION=\"12.3.2\" \\\n     --repo_env=HERMETIC_CUDNN_VERSION=\"8.9.7.29\" \\\n+    --repo_env=HERMETIC_NCCL_VERSION=\"2.27.7\" \\\n     \"somepath(//tensorflow/tools/pip_package:wheel, \" \\\n     \"@local_config_cuda//cuda:cudart + \"\\\n     \"@local_config_cuda//cuda:cudart + \"\\\n@@ -240,6 +241,7 @@ EOF\n     --@local_config_cuda//cuda:include_cuda_libs=false \\\n     --repo_env=HERMETIC_CUDA_VERSION=\"12.3.2\" \\\n     --repo_env=HERMETIC_CUDNN_VERSION=\"8.9.7.29\" \\\n+    --repo_env=HERMETIC_NCCL_VERSION=\"2.27.7\" \\\n     --define framework_shared_object=false \\\n     \"somepath(//tensorflow/tools/pip_package:wheel, \" \\\n     \"@local_config_cuda//cuda:cudart + \"\\"
        },
        {
            "sha": "005d8552b7930084123fd48a117a647a74e326b5",
            "filename": "tensorflow/workspace0.bzl",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/843206ca817f964c128e4a810f9d95cde46d3833/tensorflow%2Fworkspace0.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/843206ca817f964c128e4a810f9d95cde46d3833/tensorflow%2Fworkspace0.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fworkspace0.bzl?ref=843206ca817f964c128e4a810f9d95cde46d3833",
            "patch": "@@ -108,10 +108,10 @@ def workspace():\n     # Details: https://github.com/google-ml-infra/rules_ml_toolchain\n     tf_http_archive(\n         name = \"rules_ml_toolchain\",\n-        sha256 = \"53905ede50e3eebc782266e20e9b9ac1d7166ef68b877bea593d3600dcfe03e6\",\n-        strip_prefix = \"rules_ml_toolchain-a1ff84835e407b41eef5fd1a865a23748c294db6\",\n+        sha256 = \"1c2c530a054e9e8b3c811ec21ed8a687fc865bec3abbc8ff65beb829b1d67ae4\",\n+        strip_prefix = \"rules_ml_toolchain-6734d2a174bf29e731d3f473743d1cc1a86100c3\",\n         urls = tf_mirror_urls(\n-            \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/a1ff84835e407b41eef5fd1a865a23748c294db6.tar.gz\",\n+            \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/6734d2a174bf29e731d3f473743d1cc1a86100c3.tar.gz\",\n         ),\n     )\n "
        }
    ],
    "stats": {
        "total": 17,
        "additions": 10,
        "deletions": 7
    }
}