{
    "author": "chsigg",
    "message": "Update Triton pass constructors to include ptxVersion.\n\nThe `ConvertTritonGPUToLLVMPass` and `AllocateSharedMemoryNvPass` have a `ptxVersion` option. The former allows to use the default 80 while still specifying the compute capability. The latter does not allow this upstream and so we created a patch. Instead, pass in the default value explicitly so we don't need the patch.\n\nPiperOrigin-RevId: 799980838",
    "sha": "9f34b40044a1331235a41320bdbcc5baec5df34a",
    "files": [
        {
            "sha": "d7ac2f92e82ef61aa2a42a2786f8a2f800d48ced",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/compilation_pipeline_cuda.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9f34b40044a1331235a41320bdbcc5baec5df34a/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Fcompilation_pipeline_cuda.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9f34b40044a1331235a41320bdbcc5baec5df34a/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Fcompilation_pipeline_cuda.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Fcompilation_pipeline_cuda.cc?ref=9f34b40044a1331235a41320bdbcc5baec5df34a",
            "patch": "@@ -145,13 +145,15 @@ absl::Status CreateTritonPipeline(\n   pm->addPass(mt::gpu::createTritonGPUCombineTensorSelectAndIf());\n   pm->addPass(mt::gpu::createTritonGPUAllocateWarpGroups());\n   pm->addPass(mlir::createSCFToControlFlowPass());\n-  pm->addPass(mt::createAllocateSharedMemoryNvPass(ccAsInt));\n+  pm->addPass(mt::createAllocateSharedMemoryNvPass(\n+      ccAsInt, mlir::triton::AllocateSharedMemoryNvOptions{}.ptxVersion));\n   pm->addPass(ttng::createTritonTensorMemoryAllocationPass());\n   // We could add a flag to XLA to optionally enable the following pass:\n   // pm->addPass(mt::instrument::createTritonInstrumentConcurrencySanitizer());\n   pm->addPass(mt::gpu::createTritonGPUGlobalScratchAllocationPass());\n   pm->addPass(ttng::createTritonGPUProxyFenceInsertion({ccAsInt}));\n-  pm->addPass(mt::createConvertTritonGPUToLLVMPass(ccAsInt));\n+  pm->addPass(mt::createConvertTritonGPUToLLVMPass(\n+      ccAsInt, mlir::triton::ConvertTritonGPUToLLVMOptions{}.ptxVersion));\n   pm->addPass(mlir::createCanonicalizerPass());\n   pm->addPass(mlir::createCSEPass());\n   pm->addPass(mt::createConvertNVGPUToLLVM());"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
    }
}