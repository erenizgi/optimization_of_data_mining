{
    "author": "vwbaker",
    "message": "[xla:gpu] Reorder autotuner backends for autotuning fusion pass\n\nAdd native_backend before block_level_emitter_backend. This means that when tests are comparing against goldens and using `--xla_gpu_deterministic_ops=true`, it will choose the native emitter backend (it just chooses the first config). This means I don't have to update the sensitive goldens for the flag flip.\n\nPiperOrigin-RevId: 830895045",
    "sha": "876ba60dabb3f0f8b4fc02fcf62c7e07fd3d9c05",
    "files": [
        {
            "sha": "8855d5a62d9d09ff59218b30bb9d841ef28643ce",
            "filename": "third_party/xla/xla/service/gpu/nvptx_compiler.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/876ba60dabb3f0f8b4fc02fcf62c7e07fd3d9c05/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fnvptx_compiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/876ba60dabb3f0f8b4fc02fcf62c7e07fd3d9c05/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fnvptx_compiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fnvptx_compiler.cc?ref=876ba60dabb3f0f8b4fc02fcf62c7e07fd3d9c05",
            "patch": "@@ -439,15 +439,15 @@ absl::Status NVPTXCompiler::AddFusionAutotuningPass(\n   }\n \n   std::vector<std::unique_ptr<CodegenBackend>> backends;\n+  auto native_backend = std::make_unique<NativeEmitterBackend>(\n+      &debug_options, this, target_config);\n+  native_backend->AllowRegisterSpills();\n+  backends.push_back(std::move(native_backend));\n   auto ble_backend = std::make_unique<BlockLevelEmitterBackend>(\n       &debug_options, this, shape_size_fn, target_config,\n       /*use_default_config=*/true);\n   ble_backend->AllowRegisterSpills();\n   backends.push_back(std::move(ble_backend));\n-  auto native_backend = std::make_unique<NativeEmitterBackend>(\n-      &debug_options, this, target_config);\n-  native_backend->AllowRegisterSpills();\n-  backends.push_back(std::move(native_backend));\n \n   TF_ASSIGN_OR_RETURN(\n       std::unique_ptr<AutotunerPass> autotuner_pass,"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
    }
}