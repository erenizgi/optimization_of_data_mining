{
    "author": "hhb",
    "message": "Implement memory_space_by_kind for PjRtCApiDevice.\n\nPiperOrigin-RevId: 835307997",
    "sha": "c9d14b458f9965e084321f08cd3135f51e2ba36b",
    "files": [
        {
            "sha": "95c12ee72460f1b9bb2aece45c2bf0491ae4cd45",
            "filename": "third_party/xla/xla/pjrt/c_api_client/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/c9d14b458f9965e084321f08cd3135f51e2ba36b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/c9d14b458f9965e084321f08cd3135f51e2ba36b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2FBUILD?ref=c9d14b458f9965e084321f08cd3135f51e2ba36b",
            "patch": "@@ -80,6 +80,7 @@ cc_library(\n         \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/protobuf:coordination_service_proto_cc\",\n+        \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/cleanup\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/container:inlined_vector\","
        },
        {
            "sha": "4ee03ddaea027e1053f8d82b2605f237359c96cd",
            "filename": "third_party/xla/xla/pjrt/c_api_client/pjrt_c_api_client.cc",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/c9d14b458f9965e084321f08cd3135f51e2ba36b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/c9d14b458f9965e084321f08cd3135f51e2ba36b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.cc?ref=c9d14b458f9965e084321f08cd3135f51e2ba36b",
            "patch": "@@ -25,6 +25,7 @@ limitations under the License.\n #include <variant>\n #include <vector>\n \n+#include \"absl/algorithm/container.h\"\n #include \"absl/cleanup/cleanup.h\"\n #include \"absl/container/flat_hash_map.h\"\n #include \"absl/container/inlined_vector.h\"\n@@ -1532,6 +1533,18 @@ absl::StatusOr<PjRtMemorySpace*> PjRtCApiDevice::default_memory_space() const {\n   return client_->GetCppMemory(args.memory);\n }\n \n+absl::StatusOr<PjRtMemorySpace*> PjRtCApiDevice::memory_space_by_kind(\n+    absl::string_view kind) const {\n+  auto it = absl::c_find_if(memory_spaces_, [kind](PjRtMemorySpace* ms) {\n+    return ms->kind() == kind;\n+  });\n+  if (it != memory_spaces_.end()) {\n+    return *it;\n+  }\n+  return absl::InternalError(\n+      absl::StrCat(\"No memory space found (kind: \", kind, \")\"));\n+}\n+\n absl::StatusOr<tsl::AllocatorStats> PjRtCApiDevice::GetAllocatorStats() const {\n   PJRT_Device_MemoryStats_Args args;\n   args.struct_size = PJRT_Device_MemoryStats_Args_STRUCT_SIZE;"
        },
        {
            "sha": "1c67990eb569774316aea842670db5456e4b20f4",
            "filename": "third_party/xla/xla/pjrt/c_api_client/pjrt_c_api_client.h",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/c9d14b458f9965e084321f08cd3135f51e2ba36b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/c9d14b458f9965e084321f08cd3135f51e2ba36b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.h?ref=c9d14b458f9965e084321f08cd3135f51e2ba36b",
            "patch": "@@ -165,6 +165,9 @@ class PjRtCApiDevice : public PjRtDevice {\n \n   absl::StatusOr<PjRtMemorySpace*> default_memory_space() const override;\n \n+  absl::StatusOr<PjRtMemorySpace*> memory_space_by_kind(\n+      absl::string_view kind) const override;\n+\n   std::unique_ptr<ScopedAsyncTrackingEvent> CreateAsyncTrackingEvent(\n       absl::string_view description) const override {\n     LOG(FATAL)"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 17,
        "deletions": 0
    }
}