{
    "author": "junwhanahn",
    "message": "Avoid zero-initializing memory allocated for sub-byte packing\n\nThe memory is immediately overwritten anyway, so it's wasteful to zero-initialize the memory.\n\nPiperOrigin-RevId: 839755003",
    "sha": "328d48d034548f1bd073eceec73b3a7eb4583613",
    "files": [
        {
            "sha": "b745486dc9cf20f4a68bae90f8bf093b28176259",
            "filename": "third_party/xla/xla/util.h",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/328d48d034548f1bd073eceec73b3a7eb4583613/third_party%2Fxla%2Fxla%2Futil.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/328d48d034548f1bd073eceec73b3a7eb4583613/third_party%2Fxla%2Fxla%2Futil.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Futil.h?ref=328d48d034548f1bd073eceec73b3a7eb4583613",
            "patch": "@@ -923,7 +923,8 @@ inline void PackIntN(int bits_per_element, absl::Span<const char> input,\n inline std::unique_ptr<char[]> PackIntN(int bits_per_element, const char* data,\n                                         size_t size) {\n   size_t packed_size = size * bits_per_element / 8;\n-  auto buffer = std::make_unique<char[]>(packed_size);\n+  // Note: we can use `std::make_unique_for_overwrite` once C++20 is supported.\n+  std::unique_ptr<char[]> buffer(new char[packed_size]);\n   auto src = absl::MakeSpan(data, size);\n   auto dst = absl::MakeSpan(buffer.get(), packed_size);\n   PackIntN(bits_per_element, src, dst);\n@@ -976,7 +977,8 @@ inline void UnpackIntN(int bits_per_element, absl::Span<const char> input,\n inline std::unique_ptr<char[]> UnpackIntN(int bits_per_element,\n                                           const char* data, size_t size) {\n   size_t unpacked_size = size * 8 / bits_per_element;\n-  auto buffer = std::make_unique<char[]>(unpacked_size);\n+  // Note: we can use `std::make_unique_for_overwrite` once C++20 is supported.\n+  std::unique_ptr<char[]> buffer(new char[unpacked_size]);\n   auto src = absl::MakeSpan(data, size);\n   auto dst = absl::MakeSpan(buffer.get(), unpacked_size);\n   UnpackIntN(bits_per_element, src, dst);"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
    }
}