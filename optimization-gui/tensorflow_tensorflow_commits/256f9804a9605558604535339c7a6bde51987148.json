{
    "author": "tensorflower-gardener",
    "message": "Install NVIDIA dependencies for TF GPU builds.\n\nPiperOrigin-RevId: 810154637",
    "sha": "256f9804a9605558604535339c7a6bde51987148",
    "files": [
        {
            "sha": "c2989559bf5ee3755640be41db9cac8e13bb2390",
            "filename": "ci/official/utilities/rename_and_verify_wheels.sh",
            "status": "modified",
            "additions": 6,
            "deletions": 10,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/256f9804a9605558604535339c7a6bde51987148/ci%2Fofficial%2Futilities%2Frename_and_verify_wheels.sh",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/256f9804a9605558604535339c7a6bde51987148/ci%2Fofficial%2Futilities%2Frename_and_verify_wheels.sh",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/ci%2Fofficial%2Futilities%2Frename_and_verify_wheels.sh?ref=256f9804a9605558604535339c7a6bde51987148",
            "patch": "@@ -75,7 +75,12 @@ if [[ \"$TFCI_WHL_NUMPY_VERSION\" == 1 ]]; then\n     \"$python\" -m pip install numpy==1.26.0\n   fi\n fi\n-\"$python\" -m pip install *.whl $TFCI_PYTHON_VERIFY_PIP_INSTALL_ARGS\n+if [[ \"$TFCI_BAZEL_COMMON_ARGS\" =~ gpu|cuda ]]; then\n+  echo \"Checking to make sure tensorflow[and-cuda] is installable...\"\n+  \"$python\" -m pip install \"$(echo *.whl)[and-cuda]\" $TFCI_PYTHON_VERIFY_PIP_INSTALL_ARGS\n+else\n+  \"$python\" -m pip install *.whl $TFCI_PYTHON_VERIFY_PIP_INSTALL_ARGS\n+fi\n if [[ \"$TFCI_WHL_IMPORT_TEST_ENABLE\" == \"1\" ]]; then\n   \"$python\" -c 'import tensorflow as tf; t1=tf.constant([1,2,3,4]); t2=tf.constant([5,6,7,8]); print(tf.add(t1,t2).shape)'\n   \"$python\" -c 'import sys; import tensorflow as tf; sys.exit(0 if \"keras\" in tf.keras.__name__ else 1)'\n@@ -92,12 +97,3 @@ if [[ \"$TFCI_WHL_NUMPY_VERSION\" == 1 ]]; then\n     \"$python\" -c 'import sys; import tensorflow as tf; sys.exit(0 if \"keras\" in tf.keras.__name__ else 1)'\n   fi\n fi\n-# VERY basic check to ensure the [and-cuda] package variant is installable.\n-# Checks TFCI_BAZEL_COMMON_ARGS for \"gpu\" or \"cuda\", implying that the test is\n-# relevant. All of the GPU test machines have CUDA installed via other means,\n-# so I am not sure how to verify that the dependencies themselves are valid for\n-# the moment.\n-if [[ \"$TFCI_BAZEL_COMMON_ARGS\" =~ gpu|cuda ]]; then\n-  echo \"Checking to make sure tensorflow[and-cuda] is installable...\"\n-  \"$python\" -m pip install \"$(echo *.whl)[and-cuda]\" $TFCI_PYTHON_VERIFY_PIP_INSTALL_ARGS\n-fi"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 6,
        "deletions": 10
    }
}