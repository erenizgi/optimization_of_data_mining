{
    "author": "tensorflower-gardener",
    "message": "Re-enable CollectiveOpsTestE2EShardedUnsharded test.\n\nHang was resolved at head. With a new shapes test takes ~8 seconds vs 110 seconds before.\n\nPiperOrigin-RevId: 837814726",
    "sha": "7f6d5ae1192f88d293134cb21383960fbe5886fa",
    "files": [
        {
            "sha": "f8aa6524e00602c28735ad1f3cd90444a48665a8",
            "filename": "third_party/xla/xla/tests/collective_ops_e2e_test.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 11,
            "changes": 20,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/7f6d5ae1192f88d293134cb21383960fbe5886fa/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/7f6d5ae1192f88d293134cb21383960fbe5886fa/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test.cc?ref=7f6d5ae1192f88d293134cb21383960fbe5886fa",
            "patch": "@@ -1538,23 +1538,21 @@ TEST_F(CollectiveOpsTestE2EShardedUnsharded,\n \n TEST_F(CollectiveOpsTestE2EShardedUnsharded,\n        KeepPartitionedNonSlicedDimensionWithConstantIndices) {\n-  // TODO(464253894): Re-enable this test once hang is fixed.\n-  GTEST_SKIP() << \"Skipping hanging test\";\n   const std::string hlo_text = R\"(\n-    HloModule module, entry_computation_layout={(bf16[16,192,192,384]{3,2,1,0}, bf16[16,128,128,384]{3,2,1,0})->bf16[16,224,224,384]{3,2,1,0}}, num_partitions=8\n+    HloModule module, entry_computation_layout={(bf16[2,24,24,32]{3,2,1,0}, bf16[2,4,4,32]{3,2,1,0})->bf16[2,56,56,32]{3,2,1,0}}, num_partitions=8\n \n     ENTRY entry {\n-      p1 = bf16[16,192,192,384]{3,2,1,0} parameter(0), sharding={replicated}\n-      p2 = bf16[16,128,128,384]{3,2,1,0} parameter(1), sharding={replicated}\n-      c1 = bf16[16,192,192,384]{3,2,1,0} copy(p1), sharding={devices=[2,2,2,1]<=[8]}\n-      c2 = bf16[16,128,128,384]{3,2,1,0} copy(p2), sharding={devices=[2,2,2,1]<=[8]}\n+      p1 = bf16[2,24,24,32]{3,2,1,0} parameter(0), sharding={replicated}\n+      p2 = bf16[2,4,4,32]{3,2,1,0} parameter(1), sharding={replicated}\n+      c1 = bf16[2,24,24,32]{3,2,1,0} copy(p1), sharding={devices=[2,2,2,1]<=[8]}\n+      c2 = bf16[2,4,4,32]{3,2,1,0} copy(p2), sharding={devices=[2,2,2,1]<=[8]}\n       constant.1163 = bf16[] constant(0), sharding={replicated}\n       constant.1165 = s32[] constant(0), sharding={replicated}\n-      pad.179 = bf16[16,224,224,384]{3,2,1,0} pad(c1, constant.1163), padding=0_0x16_16x16_16x0_0, sharding={devices=[2,2,2,1]<=[8]}\n-      add.439 = bf16[16,128,128,384]{3,2,1,0} add(c2, c2), sharding={devices=[2,2,2,1]<=[8]}\n+      pad.179 = bf16[2,56,56,32]{3,2,1,0} pad(c1, constant.1163), padding=0_0x16_16x16_16x0_0, sharding={devices=[2,2,2,1]<=[8]}\n+      add.439 = bf16[2,4,4,32]{3,2,1,0} add(c2, c2), sharding={devices=[2,2,2,1]<=[8]}\n       constant.1070 = s32[] constant(48), sharding={replicated}\n-      dynamic-update-slice.128 = bf16[16,224,224,384]{3,2,1,0} dynamic-update-slice(pad.179, add.439, constant.1165, constant.1070, constant.1070, /*index=5*/constant.1165), sharding={devices=[2,2,2,1]<=[8]}\n-      ROOT c = bf16[16,224,224,384]{3,2,1,0} copy(dynamic-update-slice.128), sharding={devices=[2,2,2,1]<=[8]}\n+      dynamic-update-slice.128 = bf16[2,56,56,32]{3,2,1,0} dynamic-update-slice(pad.179, add.439, constant.1165, constant.1070, constant.1070, /*index=5*/constant.1165), sharding={devices=[2,2,2,1]<=[8]}\n+      ROOT c = bf16[2,56,56,32]{3,2,1,0} copy(dynamic-update-slice.128), sharding={devices=[2,2,2,1]<=[8]}\n     })\";\n   CollectiveOpsCompareShardedUnsharded(hlo_text, /*num_partitions=*/8,\n                                        /*enable_enzyme_comms_opt=*/true);"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 9,
        "deletions": 11
    }
}