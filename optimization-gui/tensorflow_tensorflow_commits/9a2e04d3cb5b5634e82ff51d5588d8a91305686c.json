{
    "author": "tensorflower-gardener",
    "message": "[SymbolicExpr] Reorder SymbolicExprType and update comparator\n\nThis is to mimic the exact same order than the one used in IndexingMap::CompareExpr().\n\nPiperOrigin-RevId: 802570029",
    "sha": "9a2e04d3cb5b5634e82ff51d5588d8a91305686c",
    "files": [
        {
            "sha": "9dcf72827b51f4d45e3a9bb00a5e969c295c97de",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_expr.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 7,
            "changes": 15,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9a2e04d3cb5b5634e82ff51d5588d8a91305686c/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_expr.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9a2e04d3cb5b5634e82ff51d5588d8a91305686c/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_expr.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_expr.cc?ref=9a2e04d3cb5b5634e82ff51d5588d8a91305686c",
            "patch": "@@ -562,16 +562,12 @@ int64_t SymbolicExpr::GetValue() const { return impl_->value_; }\n \n bool SymbolicExpr::operator<(const SymbolicExpr& other) const {\n   CHECK(*this && other);\n+  if (this == &other) {\n+    return false;\n+  }\n   SymbolicExprType lhs_type = GetType();\n   SymbolicExprType rhs_type = other.GetType();\n \n-  const bool lhs_is_const = (lhs_type == SymbolicExprType::kConstant);\n-  const bool rhs_is_const = (rhs_type == SymbolicExprType::kConstant);\n-  if (lhs_is_const != rhs_is_const) {\n-    // Non-constants come before constants.\n-    return rhs_is_const;\n-  }\n-\n   if (lhs_type != rhs_type) {\n     return lhs_type < rhs_type;\n   }\n@@ -582,6 +578,11 @@ bool SymbolicExpr::operator<(const SymbolicExpr& other) const {\n       return GetValue() < other.GetValue();\n     case SymbolicExprType::kAdd:\n     case SymbolicExprType::kMul:\n+    case SymbolicExprType::kFloorDiv:\n+    case SymbolicExprType::kCeilDiv:\n+    case SymbolicExprType::kMod:\n+    case SymbolicExprType::kMax:\n+    case SymbolicExprType::kMin:\n       if (GetLHS() != other.GetLHS()) {\n         return GetLHS() < other.GetLHS();\n       }"
        },
        {
            "sha": "134205625f149d8b03ef0c841b3b8d2a0306dc3e",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_expr.h",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9a2e04d3cb5b5634e82ff51d5588d8a91305686c/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_expr.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9a2e04d3cb5b5634e82ff51d5588d8a91305686c/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_expr.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_expr.h?ref=9a2e04d3cb5b5634e82ff51d5588d8a91305686c",
            "patch": "@@ -38,15 +38,15 @@ class SymbolicExprStorage;\n typedef int64_t VariableID;\n \n enum class SymbolicExprType {\n-  kConstant,\n-  kVariable,\n   kAdd,\n   kMul,\n+  kMod,\n   kFloorDiv,\n   kCeilDiv,\n-  kMod,\n   kMax,\n   kMin,\n+  kVariable,\n+  kConstant,  // Constant should be the last type for the comparator.\n   // TODO(karupayun): Add kIn operator.\n   // kIn,  // 'var in [a, b]' .\n };"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 11,
        "deletions": 10
    }
}