{
    "author": "ybaturina",
    "message": "Replace `http_archive` with `tf_http_archive` to use mirrored archives for python repository rules.\n\nPiperOrigin-RevId: 843459412",
    "sha": "c1dc3772d29977666737355147cbd2f61b5d21a9",
    "files": [
        {
            "sha": "e8bfd6548965e495d75dd7289a16b2ed9ff1f4a1",
            "filename": "third_party/py/python_init_rules.bzl",
            "status": "modified",
            "additions": 10,
            "deletions": 13,
            "changes": 23,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/c1dc3772d29977666737355147cbd2f61b5d21a9/third_party%2Fpy%2Fpython_init_rules.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/c1dc3772d29977666737355147cbd2f61b5d21a9/third_party%2Fpy%2Fpython_init_rules.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Fpython_init_rules.bzl?ref=c1dc3772d29977666737355147cbd2f61b5d21a9",
            "patch": "@@ -1,6 +1,5 @@\n \"\"\"Hermetic Python initialization. Consult the WORKSPACE on how to use it.\"\"\"\n \n-load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n \n def python_init_rules(extra_patches = []):\n@@ -11,15 +10,14 @@ def python_init_rules(extra_patches = []):\n         set of patches.\n     \"\"\"\n \n-    http_archive(\n+    tf_http_archive(\n         name = \"rules_cc\",\n-        urls = [\"https://github.com/bazelbuild/rules_cc/archive/refs/tags/0.1.0.tar.gz\"],\n+        urls = tf_mirror_urls(\"https://github.com/bazelbuild/rules_cc/archive/refs/tags/0.1.0.tar.gz\"),\n         strip_prefix = \"rules_cc-0.1.0\",\n         sha256 = \"4b12149a041ddfb8306a8fd0e904e39d673552ce82e4296e96fac9cbf0780e59\",\n-        patches = [\n-            Label(\"//third_party/py:rules_cc_protobuf.patch\"),\n+        patch_file = [\n+            \"@local_xla//third_party/py:rules_cc_protobuf.patch\",\n         ],\n-        patch_args = [\"-p1\"],\n     )\n \n     tf_http_archive(\n@@ -34,15 +32,14 @@ def python_init_rules(extra_patches = []):\n         },\n     )\n \n-    http_archive(\n+    tf_http_archive(\n         name = \"rules_python\",\n         sha256 = \"fa7dd2c6b7d63b3585028dd8a90a6cf9db83c33b250959c2ee7b583a6c130e12\",\n         strip_prefix = \"rules_python-1.6.0\",\n-        url = \"https://github.com/bazelbuild/rules_python/releases/download/1.6.0/rules_python-1.6.0.tar.gz\",\n-        patch_args = [\"-p1\"],\n-        patches = [\n-            Label(\"//third_party/py:rules_python_pip_version.patch\"),\n-            Label(\"//third_party/py:rules_python_freethreaded.patch\"),\n-            Label(\"//third_party/py:rules_python_versions.patch\"),\n+        urls = tf_mirror_urls(\"https://github.com/bazelbuild/rules_python/releases/download/1.6.0/rules_python-1.6.0.tar.gz\"),\n+        patch_file = [\n+            \"@local_xla//third_party/py:rules_python_pip_version.patch\",\n+            \"@local_xla//third_party/py:rules_python_freethreaded.patch\",\n+            \"@local_xla//third_party/py:rules_python_versions.patch\",\n         ] + extra_patches,\n     )"
        },
        {
            "sha": "e8bfd6548965e495d75dd7289a16b2ed9ff1f4a1",
            "filename": "third_party/xla/third_party/py/python_init_rules.bzl",
            "status": "modified",
            "additions": 10,
            "deletions": 13,
            "changes": 23,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/c1dc3772d29977666737355147cbd2f61b5d21a9/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_rules.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/c1dc3772d29977666737355147cbd2f61b5d21a9/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_rules.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_rules.bzl?ref=c1dc3772d29977666737355147cbd2f61b5d21a9",
            "patch": "@@ -1,6 +1,5 @@\n \"\"\"Hermetic Python initialization. Consult the WORKSPACE on how to use it.\"\"\"\n \n-load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n \n def python_init_rules(extra_patches = []):\n@@ -11,15 +10,14 @@ def python_init_rules(extra_patches = []):\n         set of patches.\n     \"\"\"\n \n-    http_archive(\n+    tf_http_archive(\n         name = \"rules_cc\",\n-        urls = [\"https://github.com/bazelbuild/rules_cc/archive/refs/tags/0.1.0.tar.gz\"],\n+        urls = tf_mirror_urls(\"https://github.com/bazelbuild/rules_cc/archive/refs/tags/0.1.0.tar.gz\"),\n         strip_prefix = \"rules_cc-0.1.0\",\n         sha256 = \"4b12149a041ddfb8306a8fd0e904e39d673552ce82e4296e96fac9cbf0780e59\",\n-        patches = [\n-            Label(\"//third_party/py:rules_cc_protobuf.patch\"),\n+        patch_file = [\n+            \"@local_xla//third_party/py:rules_cc_protobuf.patch\",\n         ],\n-        patch_args = [\"-p1\"],\n     )\n \n     tf_http_archive(\n@@ -34,15 +32,14 @@ def python_init_rules(extra_patches = []):\n         },\n     )\n \n-    http_archive(\n+    tf_http_archive(\n         name = \"rules_python\",\n         sha256 = \"fa7dd2c6b7d63b3585028dd8a90a6cf9db83c33b250959c2ee7b583a6c130e12\",\n         strip_prefix = \"rules_python-1.6.0\",\n-        url = \"https://github.com/bazelbuild/rules_python/releases/download/1.6.0/rules_python-1.6.0.tar.gz\",\n-        patch_args = [\"-p1\"],\n-        patches = [\n-            Label(\"//third_party/py:rules_python_pip_version.patch\"),\n-            Label(\"//third_party/py:rules_python_freethreaded.patch\"),\n-            Label(\"//third_party/py:rules_python_versions.patch\"),\n+        urls = tf_mirror_urls(\"https://github.com/bazelbuild/rules_python/releases/download/1.6.0/rules_python-1.6.0.tar.gz\"),\n+        patch_file = [\n+            \"@local_xla//third_party/py:rules_python_pip_version.patch\",\n+            \"@local_xla//third_party/py:rules_python_freethreaded.patch\",\n+            \"@local_xla//third_party/py:rules_python_versions.patch\",\n         ] + extra_patches,\n     )"
        }
    ],
    "stats": {
        "total": 46,
        "additions": 20,
        "deletions": 26
    }
}