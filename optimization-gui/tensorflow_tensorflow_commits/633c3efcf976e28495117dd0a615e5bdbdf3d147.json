{
    "author": "ezhulenev",
    "message": "[xla:cpu] Delete unused cpu_function_runtime header\n\nPiperOrigin-RevId: 822215543",
    "sha": "633c3efcf976e28495117dd0a615e5bdbdf3d147",
    "files": [
        {
            "sha": "089c404470a802e1be78f888d27d0c7c7d5bcc9c",
            "filename": "third_party/xla/xla/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 13,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2FBUILD?ref=633c3efcf976e28495117dd0a615e5bdbdf3d147",
            "patch": "@@ -51,7 +51,6 @@ filegroup(\n filegroup(\n     name = \"cpu_runtime_hdrs\",\n     srcs = [\n-        \"cpu_function_runtime.h\",\n         \"executable_run_options.h\",\n         \"types.h\",\n     ],\n@@ -1257,18 +1256,6 @@ xla_cc_test(\n     ],\n )\n \n-cc_library(\n-    name = \"cpu_function_runtime\",\n-    hdrs = [\"cpu_function_runtime.h\"],\n-    compatible_with = get_compatible_with_portable(),\n-    visibility = internal_visibility([\":friends\"]),\n-    deps = [\n-        \"//xla/backends/cpu:alignment\",\n-        \"@com_google_absl//absl/base:core_headers\",\n-        \"@com_google_absl//absl/base:dynamic_annotations\",\n-    ],\n-)\n-\n xla_cc_test(\n     name = \"debug_options_parsers_test\",\n     size = \"small\","
        },
        {
            "sha": "b35ad602969736f9a53ac9cf0f14d96a3692d832",
            "filename": "third_party/xla/xla/cpu_function_runtime.h",
            "status": "removed",
            "additions": 0,
            "deletions": 180,
            "changes": 180,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/61414968174396875917d754c69e542e66331d17/third_party%2Fxla%2Fxla%2Fcpu_function_runtime.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/61414968174396875917d754c69e542e66331d17/third_party%2Fxla%2Fxla%2Fcpu_function_runtime.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcpu_function_runtime.h?ref=61414968174396875917d754c69e542e66331d17",
            "patch": "@@ -1,180 +0,0 @@\n-/* Copyright 2018 The OpenXLA Authors.\n-\n-Licensed under the Apache License, Version 2.0 (the \"License\");\n-you may not use this file except in compliance with the License.\n-You may obtain a copy of the License at\n-\n-    http://www.apache.org/licenses/LICENSE-2.0\n-\n-Unless required by applicable law or agreed to in writing, software\n-distributed under the License is distributed on an \"AS IS\" BASIS,\n-WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n-See the License for the specific language governing permissions and\n-limitations under the License.\n-==============================================================================*/\n-\n-#ifndef XLA_CPU_FUNCTION_RUNTIME_H_\n-#define XLA_CPU_FUNCTION_RUNTIME_H_\n-\n-#include <stdint.h>\n-\n-#include <cassert>\n-#include <cstdlib>\n-\n-namespace xla {\n-namespace cpu_function_runtime_deprecated {\n-\n-struct EncodedBufferInfo {\n-  uint64_t packed_kind_and_size = 0;\n-  uint32_t entry_param_number = -1;\n-  uint32_t result_param_number = -1;\n-};\n-\n-// Stores information about one buffer used by an XLA:CPU compiled function.\n-// These buffers are used for holding inputs to the computation, outputs from\n-// the computation and as temporary scratch space.\n-class BufferInfo {\n- public:\n-  // Creates a BufferInfo from a serialized encoding generated by `Encode`.\n-  explicit constexpr BufferInfo(const EncodedBufferInfo& encoded)\n-      : kind_(UnpackKind(encoded.packed_kind_and_size)),\n-        size_(UnpackSize(encoded.packed_kind_and_size)),\n-        entry_param_number_(encoded.entry_param_number),\n-        result_param_number_(encoded.result_param_number) {}\n-\n-  // Returns true if this buffer stores a constant.\n-  bool is_constant() const { return kind() == Kind::kConstant; }\n-\n-  // Returns true if this buffer stores an entry parameter.  These may or may\n-  // not need to be allocated by the runtime, depending on\n-  // XlaCompiledCpuFunction::AllocMode.\n-  bool is_entry_parameter() const {\n-    return kind() == Kind::kParameter && entry_param_number_ >= 0;\n-  }\n-\n-  // Returns the entry parameter number of this buffer.\n-  uint32_t entry_parameter_number() const {\n-    assert(is_entry_parameter());\n-    return entry_param_number_;\n-  }\n-\n-  void set_result_parameter_number(uint32_t param_number) {\n-    result_param_number_ = param_number;\n-  }\n-\n-  bool is_result_parameter() const {\n-    // Note: the kind is not unique, e.g. could be a kTempBuffer, or a\n-    // kParameter if it is an in-out argument.\n-    return result_param_number_ >= 0;\n-  }\n-\n-  uint32_t result_parameter_number() const {\n-    assert(is_result_parameter());\n-    return result_param_number_;\n-  }\n-\n-  // Returns true if this buffer is temporary scratch space required by the XLA\n-  // computations.  These are always allocated by the runtime.\n-  bool is_temp_buffer() const { return kind() == Kind::kTempBuffer; }\n-\n-  // Returns true if this buffer is allocated on the C stack or into registers.\n-  // These buffers are never allocated by the runtime.\n-  bool is_on_stack_buffer() const { return kind() == Kind::kOnStackBuffer; }\n-\n-  // Returns the size for this buffer.\n-  uint64_t size() const { return size_; }\n-\n-  // Encodes this BufferInfo into two 64 bit integers that can be used to\n-  // reconstruct the BufferInfo later using the constructor.  We need this\n-  // because we use BufferInfo in places where using protocol buffers would\n-  // negatively impact binary size.\n-  EncodedBufferInfo Encode() const {\n-    static_assert(sizeof(*this) == 16, \"\");\n-    EncodedBufferInfo ret;\n-    ret.packed_kind_and_size = Pack(kind(), size_);\n-    ret.entry_param_number = entry_param_number_;\n-    ret.result_param_number = result_param_number_;\n-    return ret;\n-  }\n-\n-  bool operator==(const BufferInfo& buffer_info) const {\n-    if (kind() != buffer_info.kind() || size() != buffer_info.size()) {\n-      return false;\n-    }\n-    return !is_entry_parameter() ||\n-           entry_parameter_number() == buffer_info.entry_parameter_number();\n-  }\n-\n-  // Factory methods:\n-\n-  static BufferInfo MakeTempBuffer(uint64_t size) {\n-    return BufferInfo(Kind::kTempBuffer, size);\n-  }\n-  static BufferInfo MakeConstant(uint64_t size) {\n-    return BufferInfo(Kind::kConstant, size);\n-  }\n-  // Note: in-out parameters are possible by first creating an entry parameter\n-  // and then calling set_result_parameter_number().\n-  static BufferInfo MakeEntryParameter(uint64_t size,\n-                                       uint32_t entry_param_number) {\n-    return BufferInfo(Kind::kParameter, size, entry_param_number);\n-  }\n-  // Only used in tests. Here we use kTempBuffer but it is unimportant.\n-  static BufferInfo MakeResultParameter(uint64_t size,\n-                                        uint32_t result_param_number) {\n-    // Here we\n-    return BufferInfo(Kind::kTempBuffer, size, /*entry_param_number=*/-1,\n-                      result_param_number);\n-  }\n-  static BufferInfo MakeOnStackBuffer(uint64_t size) {\n-    return BufferInfo(Kind::kOnStackBuffer, size);\n-  }\n-\n- private:\n-  BufferInfo() = default;\n-\n-  enum class Kind : uint64_t {\n-    kConstant,\n-    kTempBuffer,\n-    kParameter,\n-    kOnStackBuffer\n-  };\n-\n-  Kind kind() const { return static_cast<Kind>(kind_); }\n-\n-  explicit BufferInfo(Kind kind, uint64_t size)\n-      : BufferInfo(kind, size,\n-                   /*entry_param_number=*/-1,\n-                   /*result_param_number=*/-1) {}\n-  explicit BufferInfo(Kind kind, uint64_t size, uint32_t entry_param_number)\n-      : BufferInfo(kind, size, entry_param_number,\n-                   /*result_param_number=*/-1) {}\n-  explicit BufferInfo(Kind kind, uint64_t size, uint32_t entry_param_number,\n-                      uint32_t result_param_number)\n-      : kind_(kind),\n-        size_(size),\n-        entry_param_number_(entry_param_number),\n-        result_param_number_(result_param_number) {}\n-\n-  static uint64_t Pack(Kind kind, uint64_t size) {\n-    return (static_cast<uint64_t>(size) << 2) | static_cast<uint64_t>(kind);\n-  }\n-\n-  static inline constexpr Kind UnpackKind(uint64_t packed) {\n-    return static_cast<Kind>((packed << 62) >> 62);\n-  }\n-\n-  static inline constexpr uint64_t UnpackSize(uint64_t packed) {\n-    return packed >> 2;\n-  }\n-\n-  Kind kind_ : 2;\n-  uint64_t size_ : 62;\n-  int32_t entry_param_number_ = -1;\n-  int32_t result_param_number_ = -1;\n-};\n-\n-}  // namespace cpu_function_runtime_deprecated\n-}  // namespace xla\n-\n-#endif  // XLA_CPU_FUNCTION_RUNTIME_H_"
        },
        {
            "sha": "429a51e8fd38e7fbe829cb599df61ba9ed8424a2",
            "filename": "third_party/xla/xla/pjrt/cpu/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fpjrt%2Fcpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fpjrt%2Fcpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fcpu%2FBUILD?ref=633c3efcf976e28495117dd0a615e5bdbdf3d147",
            "patch": "@@ -52,7 +52,6 @@ cc_library(\n     visibility = internal_visibility([\"//xla/pjrt/cpu:legacy_cpu_buffer_internal_users\"]),\n     deps = [\n         \":cpu_event\",\n-        \"//xla:cpu_function_runtime\",\n         \"//xla:future\",\n         \"//xla:literal\",\n         \"//xla:shape_tree\","
        },
        {
            "sha": "7d2b30b2a3530559bae79f4ff6794d5e0b433eee",
            "filename": "third_party/xla/xla/service/cpu/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD?ref=633c3efcf976e28495117dd0a615e5bdbdf3d147",
            "patch": "@@ -197,7 +197,6 @@ cc_library(\n         \":runtime_symbol_generator\",\n         \":small_while_loop_hoisting_pass\",\n         \":thunk_emitter\",\n-        \"//xla:cpu_function_runtime\",\n         \"//xla:debug_options_flags\",\n         \"//xla:literal\",\n         \"//xla:literal_pool\",\n@@ -417,7 +416,6 @@ cc_library(\n     deps = [\n         \":cpu_executable\",\n         \":executable_proto_cc\",\n-        \"//xla:cpu_function_runtime\",\n         \"//xla:util\",\n         \"//xla/backends/cpu:buffer_allocation_info\",\n         \"//xla/backends/cpu:buffer_allocation_info_util\",\n@@ -927,7 +925,6 @@ cc_library(\n         \":ir_emitter2\",\n         \":parallel_fusion_emitter\",\n         \"//xla:comparison_util\",\n-        \"//xla:cpu_function_runtime\",\n         \"//xla:shape_util\",\n         \"//xla:status_macros\",\n         \"//xla:util\","
        },
        {
            "sha": "fec59711e93c07ca379fe9e397195395b78136cb",
            "filename": "third_party/xla/xla/service/cpu/cpu_aot_compilation_result.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_aot_compilation_result.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_aot_compilation_result.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_aot_compilation_result.cc?ref=633c3efcf976e28495117dd0a615e5bdbdf3d147",
            "patch": "@@ -36,7 +36,6 @@ limitations under the License.\n #include \"xla/backends/cpu/runtime/thunk.h\"\n #include \"xla/backends/cpu/runtime/thunk.pb.h\"\n #include \"xla/backends/cpu/runtime/thunk_proto_serdes.h\"\n-#include \"xla/cpu_function_runtime.h\"\n #include \"xla/hlo/analysis/alias_info.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/hlo/ir/hlo_schedule.h\""
        },
        {
            "sha": "121df72f88f6b759d5ecee964269955c99820f71",
            "filename": "third_party/xla/xla/service/cpu/cpu_aot_compilation_result.h",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_aot_compilation_result.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_aot_compilation_result.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_aot_compilation_result.h?ref=633c3efcf976e28495117dd0a615e5bdbdf3d147",
            "patch": "@@ -29,7 +29,6 @@ limitations under the License.\n #include \"xla/backends/cpu/runtime/function_library.h\"\n #include \"xla/backends/cpu/runtime/thunk.h\"\n #include \"xla/backends/cpu/runtime/thunk.pb.h\"\n-#include \"xla/cpu_function_runtime.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/hlo/ir/hlo_schedule.h\"\n #include \"xla/service/buffer_assignment.h\""
        },
        {
            "sha": "4b8f90ebd960b3f8144a3b14a3bd8f071164a63d",
            "filename": "third_party/xla/xla/service/cpu/cpu_compiler.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_compiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_compiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_compiler.cc?ref=633c3efcf976e28495117dd0a615e5bdbdf3d147",
            "patch": "@@ -103,7 +103,6 @@ limitations under the License.\n #include \"xla/backends/cpu/transforms/library_rewriter.h\"\n #include \"xla/backends/cpu/transforms/xnn_graph_fusion.h\"\n #include \"xla/backends/cpu/xnn_support.h\"\n-#include \"xla/cpu_function_runtime.h\"\n #include \"xla/hlo/analysis/alias_info.h\"\n #include \"xla/hlo/analysis/hlo_ordering.h\"\n #include \"xla/hlo/analysis/indexed_array_analysis.h\""
        },
        {
            "sha": "480695f924266808c179a4e749ab12f3b21132de",
            "filename": "third_party/xla/xla/service/cpu/thunk_emitter.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fthunk_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/633c3efcf976e28495117dd0a615e5bdbdf3d147/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fthunk_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fthunk_emitter.cc?ref=633c3efcf976e28495117dd0a615e5bdbdf3d147",
            "patch": "@@ -82,7 +82,6 @@ limitations under the License.\n #include \"xla/codegen/mlir_kernel_definition.h\"\n #include \"xla/codegen/mlir_kernel_source.h\"\n #include \"xla/comparison_util.h\"\n-#include \"xla/cpu_function_runtime.h\"\n #include \"xla/hlo/ir/hlo_casting_utils.h\"\n #include \"xla/hlo/ir/hlo_computation.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\""
        }
    ],
    "stats": {
        "total": 201,
        "additions": 0,
        "deletions": 201
    }
}