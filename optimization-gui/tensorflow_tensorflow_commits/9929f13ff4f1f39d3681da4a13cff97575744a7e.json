{
    "author": "tensorflower-gardener",
    "message": "Update `rules_ml_toolchain` version to introduce new CUDA13 repositories.\n\nTurn off forward compatibility mode in XLA tests to enable CUDA driver update in RBE and Docker images for GPU testing.\n\nThe test `gpu_command_buffer_test_nvgpu_any` will be enabled after the RBE machine drivers are upgraded.\n\nPiperOrigin-RevId: 797442661",
    "sha": "9929f13ff4f1f39d3681da4a13cff97575744a7e",
    "files": [
        {
            "sha": "cc2d14723e1caff44b36ee3af909ab9483674bd7",
            "filename": "third_party/xla/WORKSPACE",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2FWORKSPACE",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2FWORKSPACE",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2FWORKSPACE?ref=9929f13ff4f1f39d3681da4a13cff97575744a7e",
            "patch": "@@ -9,10 +9,10 @@ load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n # Details: https://github.com/google-ml-infra/rules_ml_toolchain\n http_archive(\n     name = \"rules_ml_toolchain\",\n-    sha256 = \"59d7eb36a02cbe3c2e2fa67fda5e8f1ab7e274bc4773bbd207c51fe199e11c19\",\n-    strip_prefix = \"rules_ml_toolchain-ffd9e3d7b84e43c2686c803cb08ce790ffd58baa\",\n+    sha256 = \"c83082a90173c99a1a1cce7b98b9202a5d52fe3930f61dd91e5f01f45f086f57\",\n+    strip_prefix = \"rules_ml_toolchain-bddf41e78803cc7fb14a114bb9c229ce7100d1bf\",\n     urls = [\n-        \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/ffd9e3d7b84e43c2686c803cb08ce790ffd58baa.tar.gz\",\n+        \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/bddf41e78803cc7fb14a114bb9c229ce7100d1bf.tar.gz\",\n     ],\n )\n "
        },
        {
            "sha": "d95fee7fb639f60387a8df542b7b00b2d8c887f5",
            "filename": "third_party/xla/build_tools/ci/build.py",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fbuild_tools%2Fci%2Fbuild.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fbuild_tools%2Fci%2Fbuild.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fci%2Fbuild.py?ref=9929f13ff4f1f39d3681da4a13cff97575744a7e",
            "patch": "@@ -275,7 +275,6 @@ def nvidia_gpu_build_with_compute_capability(\n       ),\n       options={\n           \"run_under\": \"//build_tools/ci:parallel_gpu_execute\",\n-          \"@cuda_driver//:enable_forward_compatibility\": \"true\",\n           \"//xla/tsl:ci_build\": True,\n           **_DEFAULT_BAZEL_OPTIONS,\n       },\n@@ -412,7 +411,6 @@ def nvidia_gpu_build_with_compute_capability(\n     ),\n     options={\n         \"run_under\": \"//build_tools/ci:parallel_gpu_execute\",\n-        \"@cuda_driver//:enable_forward_compatibility\": \"false\",\n         \"//xla/tsl:ci_build\": True,\n         **_DEFAULT_BAZEL_OPTIONS,\n     },\n@@ -445,7 +443,6 @@ def nvidia_gpu_build_with_compute_capability(\n     ),\n     options={\n         \"run_under\": \"//build_tools/ci:parallel_gpu_execute\",\n-        \"@cuda_driver//:enable_forward_compatibility\": \"false\",\n         \"//xla/tsl:ci_build\": True,\n         **_DEFAULT_BAZEL_OPTIONS,\n     },\n@@ -479,7 +476,6 @@ def nvidia_gpu_build_with_compute_capability(\n     options={\n         \"run_under\": \"//build_tools/ci:parallel_gpu_execute\",\n         # Use User Mode and Kernel Mode Drivers pre-installed on the system.\n-        \"@cuda_driver//:enable_forward_compatibility\": \"true\",\n         \"//xla/tsl:ci_build\": True,\n         **_DEFAULT_BAZEL_OPTIONS,\n     },"
        },
        {
            "sha": "feeccc8235330bf29e35f1d654760f90e35ca2e1",
            "filename": "third_party/xla/build_tools/ci/golden_commands.txt",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fbuild_tools%2Fci%2Fgolden_commands.txt",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fbuild_tools%2Fci%2Fgolden_commands.txt",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fci%2Fgolden_commands.txt?ref=9929f13ff4f1f39d3681da4a13cff97575744a7e",
            "patch": "@@ -42,26 +42,26 @@ bazel analyze-profile profile.json.gz\n # END BuildType.XLA_LINUX_X86_CPU_GITHUB_ACTIONS\n # BEGIN BuildType.XLA_LINUX_X86_GPU_A4_224_VCPU_PRESUBMIT_GITHUB_ACTIONS\n nvidia-smi\n-parallel --ungroup --retries 3 --delay 15 --nonall -- bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm100-only,requires-gpu-sm60,requires-gpu-sm70,requires-gpu-sm80,requires-gpu-sm90,requires-gpu-sm100,-requires-gpu-amd,-requires-gpu-intel --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=10 --repo_env=HERMETIC_CUDA_VERSION=12.8.0 --repo_env=HERMETIC_CUDNN_VERSION=9.8.0 --run_under=//build_tools/ci:parallel_gpu_execute --@cuda_driver//:enable_forward_compatibility=true --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --nobuild -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n-bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm100-only,requires-gpu-sm60,requires-gpu-sm70,requires-gpu-sm80,requires-gpu-sm90,requires-gpu-sm100,-requires-gpu-amd,-requires-gpu-intel --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=10 --repo_env=HERMETIC_CUDA_VERSION=12.8.0 --repo_env=HERMETIC_CUDNN_VERSION=9.8.0 --run_under=//build_tools/ci:parallel_gpu_execute --@cuda_driver//:enable_forward_compatibility=true --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n+parallel --ungroup --retries 3 --delay 15 --nonall -- bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm100-only,requires-gpu-sm60,requires-gpu-sm70,requires-gpu-sm80,requires-gpu-sm90,requires-gpu-sm100,-requires-gpu-amd,-requires-gpu-intel --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=10 --repo_env=HERMETIC_CUDA_VERSION=12.8.0 --repo_env=HERMETIC_CUDNN_VERSION=9.8.0 --run_under=//build_tools/ci:parallel_gpu_execute --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --nobuild -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n+bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm100-only,requires-gpu-sm60,requires-gpu-sm70,requires-gpu-sm80,requires-gpu-sm90,requires-gpu-sm100,-requires-gpu-amd,-requires-gpu-intel --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=10 --repo_env=HERMETIC_CUDA_VERSION=12.8.0 --repo_env=HERMETIC_CUDNN_VERSION=9.8.0 --run_under=//build_tools/ci:parallel_gpu_execute --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n bazel analyze-profile profile.json.gz\n # END BuildType.XLA_LINUX_X86_GPU_A4_224_VCPU_PRESUBMIT_GITHUB_ACTIONS\n # BEGIN BuildType.XLA_LINUX_X86_GPU_L4_16_VCPU_PRESUBMIT_GITHUB_ACTIONS\n nvidia-smi\n-parallel --ungroup --retries 3 --delay 15 --nonall -- bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --@cuda_driver//:enable_forward_compatibility=false --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --nobuild -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n-bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --@cuda_driver//:enable_forward_compatibility=false --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n+parallel --ungroup --retries 3 --delay 15 --nonall -- bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --nobuild -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n+bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n bazel analyze-profile profile.json.gz\n # END BuildType.XLA_LINUX_X86_GPU_L4_16_VCPU_PRESUBMIT_GITHUB_ACTIONS\n # BEGIN BuildType.XLA_LINUX_X86_GPU_L4_48_VCPU_PRESUBMIT_GITHUB_ACTIONS\n nvidia-smi\n-parallel --ungroup --retries 3 --delay 15 --nonall -- bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --@cuda_driver//:enable_forward_compatibility=false --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --nobuild -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n-bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --@cuda_driver//:enable_forward_compatibility=false --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n+parallel --ungroup --retries 3 --delay 15 --nonall -- bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --nobuild -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n+bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async -- //xla/tools/multihost_hlo_runner:hlo_runner_main_gpu //xla/tools:compute_xspace_stats_main_gpu\n bazel analyze-profile profile.json.gz\n # END BuildType.XLA_LINUX_X86_GPU_L4_48_VCPU_PRESUBMIT_GITHUB_ACTIONS\n # BEGIN BuildType.XLA_LINUX_X86_GPU_L4_GITHUB_ACTIONS\n nvidia-smi\n-parallel --ungroup --retries 3 --delay 15 --nonall -- bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --@cuda_driver//:enable_forward_compatibility=true --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --nobuild -- //xla/... //build_tools/... @local_tsl//tsl/...\n-bazel test --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --@cuda_driver//:enable_forward_compatibility=true --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async -- //xla/... //build_tools/... @local_tsl//tsl/...\n+parallel --ungroup --retries 3 --delay 15 --nonall -- bazel build --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --nobuild -- //xla/... //build_tools/... @local_tsl//tsl/...\n+bazel test --build_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only --test_tag_filters=-no_oss,requires-gpu-nvidia,gpu,-rocm-only,-oneapi-only,requires-gpu-sm75-only,requires-gpu-sm60,requires-gpu-sm70,-requires-gpu-sm80,-requires-gpu-sm80-only,-requires-gpu-sm90,-requires-gpu-sm90-only,-requires-gpu-sm100,-requires-gpu-sm100-only,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=rbe_linux_cuda_nvcc --repo_env=TF_CUDA_COMPUTE_CAPABILITIES=7.5 --run_under=//build_tools/ci:parallel_gpu_execute --//xla/tsl:ci_build --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async -- //xla/... //build_tools/... @local_tsl//tsl/...\n bazel analyze-profile profile.json.gz\n # END BuildType.XLA_LINUX_X86_GPU_L4_GITHUB_ACTIONS\n # BEGIN BuildType.XLA_LINUX_X86_GPU_ONEAPI_GITHUB_ACTIONS"
        },
        {
            "sha": "e64c27982505534e0557d9b88fded3742344fa60",
            "filename": "third_party/xla/workspace0.bzl",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fworkspace0.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fworkspace0.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fworkspace0.bzl?ref=9929f13ff4f1f39d3681da4a13cff97575744a7e",
            "patch": "@@ -140,10 +140,10 @@ def workspace():\n     if \"rules_ml_toolchain\" not in native.existing_rules():\n         http_archive(\n             name = \"rules_ml_toolchain\",\n-            sha256 = \"59d7eb36a02cbe3c2e2fa67fda5e8f1ab7e274bc4773bbd207c51fe199e11c19\",\n-            strip_prefix = \"rules_ml_toolchain-ffd9e3d7b84e43c2686c803cb08ce790ffd58baa\",\n+            sha256 = \"c83082a90173c99a1a1cce7b98b9202a5d52fe3930f61dd91e5f01f45f086f57\",\n+            strip_prefix = \"rules_ml_toolchain-bddf41e78803cc7fb14a114bb9c229ce7100d1bf\",\n             urls = [\n-                \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/ffd9e3d7b84e43c2686c803cb08ce790ffd58baa.tar.gz\",\n+                \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/bddf41e78803cc7fb14a114bb9c229ce7100d1bf.tar.gz\",\n             ],\n         )\n "
        },
        {
            "sha": "a6ebb4ab7e77d434bb82d2f32a661eff58622b3d",
            "filename": "third_party/xla/xla/stream_executor/gpu/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2FBUILD?ref=9929f13ff4f1f39d3681da4a13cff97575744a7e",
            "patch": "@@ -600,6 +600,8 @@ xla_test(\n     name = \"gpu_command_buffer_test\",\n     srcs = [\"gpu_command_buffer_test.cc\"],\n     backends = [\"gpu\"],\n+    # TODO(ybaturina): Re-enable once the CUDA driver version is updated in RBE.\n+    tags = [\"manual\"],\n     deps = [\n         \":gpu_command_buffer\",\n         \":gpu_test_kernels\","
        },
        {
            "sha": "14d734c69da04ce6261e74fa57600cb5b068e5c0",
            "filename": "third_party/xla/xla/tsl/cuda/BUILD.bazel",
            "status": "modified",
            "additions": 30,
            "deletions": 7,
            "changes": 37,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Ftsl%2Fcuda%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Ftsl%2Fcuda%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fcuda%2FBUILD.bazel?ref=9929f13ff4f1f39d3681da4a13cff97575744a7e",
            "patch": "@@ -9,6 +9,7 @@ load(\n     \"@local_xla//xla/tsl/platform/default:cuda_build_defs.bzl\",\n     \"cuda_rpath_flags\",\n     \"if_cuda_is_configured\",\n+    \"if_cuda_newer_than\",\n )\n load(\n     \"//xla/tsl:tsl.default.bzl\",\n@@ -31,8 +32,10 @@ cc_library(\n         \"cublas_stub.cc\",\n         \"cublas.tramp.S\",\n     ]),\n-    linkopts = if_cuda_is_configured(cuda_rpath_flags(\n-        \"nvidia/cublas/lib\",\n+    linkopts = if_cuda_is_configured(if_cuda_newer_than(\n+        \"13_0\",\n+        if_false = cuda_rpath_flags(\"nvidia/cublas/lib\"),\n+        if_true = cuda_rpath_flags(\"nvidia/cu13/lib\"),\n     )),\n     local_defines = [\n         \"IMPLIB_EXPORT_SHIMS=1\",\n@@ -123,7 +126,11 @@ cc_library(\n         ],\n         \"//conditions:default\": [],\n     }),\n-    linkopts = if_cuda_is_configured(cuda_rpath_flags(\"nvidia/cuda_runtime/lib\")),\n+    linkopts = if_cuda_is_configured(if_cuda_newer_than(\n+        \"13_0\",\n+        if_false = cuda_rpath_flags(\"nvidia/cuda_runtime/lib\"),\n+        if_true = cuda_rpath_flags(\"nvidia/cu13/lib\"),\n+    )),\n     local_defines = [\n         \"IMPLIB_EXPORT_SHIMS=1\",\n     ],\n@@ -209,7 +216,11 @@ cc_library(\n         \"cufft_stub.cc\",\n         \"cufft.tramp.S\",\n     ]),\n-    linkopts = if_cuda_is_configured(cuda_rpath_flags(\"nvidia/cufft/lib\")),\n+    linkopts = if_cuda_is_configured(if_cuda_newer_than(\n+        \"13_0\",\n+        if_false = cuda_rpath_flags(\"nvidia/cufft/lib\"),\n+        if_true = cuda_rpath_flags(\"nvidia/cu13/lib\"),\n+    )),\n     local_defines = [\n         \"IMPLIB_EXPORT_SHIMS=1\",\n     ],\n@@ -241,7 +252,11 @@ cc_library(\n         \"cupti.tramp.S\",\n     ]),\n     data = if_cuda_is_configured([\"@local_config_cuda//cuda:cupti_dsos\"]),\n-    linkopts = if_cuda_is_configured(cuda_rpath_flags(\"nvidia/cuda_cupti/lib\")),\n+    linkopts = if_cuda_is_configured(if_cuda_newer_than(\n+        \"13_0\",\n+        if_false = cuda_rpath_flags(\"nvidia/cuda_cupti/lib\"),\n+        if_true = cuda_rpath_flags(\"nvidia/cu13/lib\"),\n+    )),\n     local_defines = [\n         \"IMPLIB_EXPORT_SHIMS=1\",\n     ],\n@@ -273,7 +288,11 @@ cc_library(\n         \"cusolver_stub.cc\",\n         \"cusolver.tramp.S\",\n     ]),\n-    linkopts = if_cuda_is_configured(cuda_rpath_flags(\"nvidia/cusolver/lib\")),\n+    linkopts = if_cuda_is_configured(if_cuda_newer_than(\n+        \"13_0\",\n+        if_false = cuda_rpath_flags(\"nvidia/cusolver/lib\"),\n+        if_true = cuda_rpath_flags(\"nvidia/cu13/lib\"),\n+    )),\n     local_defines = [\n         \"IMPLIB_EXPORT_SHIMS=1\",\n     ],\n@@ -304,7 +323,11 @@ cc_library(\n         \"cusparse_stub.cc\",\n         \"cusparse.tramp.S\",\n     ]),\n-    linkopts = if_cuda_is_configured(cuda_rpath_flags(\"nvidia/cusparse/lib\")),\n+    linkopts = if_cuda_is_configured(if_cuda_newer_than(\n+        \"13_0\",\n+        if_false = cuda_rpath_flags(\"nvidia/cusparse/lib\"),\n+        if_true = cuda_rpath_flags(\"nvidia/cu13/lib\"),\n+    )),\n     local_defines = [\n         \"IMPLIB_EXPORT_SHIMS=1\",\n     ],"
        },
        {
            "sha": "509150339d0d3dc895756ac0a9819bf2273cf8f9",
            "filename": "third_party/xla/xla/tsl/cuda/cuda.symbols",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Ftsl%2Fcuda%2Fcuda.symbols",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Ftsl%2Fcuda%2Fcuda.symbols",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fcuda%2Fcuda.symbols?ref=9929f13ff4f1f39d3681da4a13cff97575744a7e",
            "patch": "@@ -93,6 +93,7 @@ cuEventCreate\n cuEventDestroy\n cuEventDestroy_v2\n cuEventElapsedTime\n+cuEventElapsedTime_v2\n cuEventQuery\n cuEventRecord\n cuEventRecordWithFlags"
        },
        {
            "sha": "4b1b64527eadbda3c180282ce2777a48f5338cd1",
            "filename": "third_party/xla/xla/tsl/platform/default/BUILD",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2FBUILD?ref=9929f13ff4f1f39d3681da4a13cff97575744a7e",
            "patch": "@@ -16,6 +16,10 @@ load(\n     \"tsl_grpc_cc_dependencies\",\n )\n load(\"//xla/tsl/platform:rules_cc.bzl\", \"cc_library\")\n+load(\n+    \"//xla/tsl/platform/default:cuda_build_defs.bzl\",\n+    \"if_cuda_newer_than\",\n+)\n \n package(\n     # copybara:uncomment default_applicable_licenses = [\"//tensorflow:license\"],\n@@ -70,9 +74,11 @@ cc_library(\n     srcs = [\"cuda_root_path.cc\"],\n     hdrs = [\"@local_tsl//tsl/platform:cuda_root_path.h\"],\n     compatible_with = [],\n-    data = if_cuda_tools([\n-        \"@cuda_nvcc//:nvvm\",\n-    ]),\n+    data = if_cuda_tools(if_cuda_newer_than(\n+        \"13_0\",\n+        if_false = [\"@cuda_nvcc//:nvvm\"],\n+        if_true = [\"@cuda_nvvm//:nvvm\"],\n+    )),\n     tags = [\n         \"manual\",\n         \"no_oss\","
        },
        {
            "sha": "f915f6288f22e2010e044e232527e26bfc892a6b",
            "filename": "third_party/xla/xla/tsl/platform/default/cuda_root_path.cc",
            "status": "modified",
            "additions": 12,
            "deletions": 2,
            "changes": 14,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fcuda_root_path.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9929f13ff4f1f39d3681da4a13cff97575744a7e/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fcuda_root_path.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fcuda_root_path.cc?ref=9929f13ff4f1f39d3681da4a13cff97575744a7e",
            "patch": "@@ -20,6 +20,7 @@ limitations under the License.\n #include <string>\n #include <vector>\n \n+#include \"absl/strings/match.h\"\n #include \"tsl/platform/path.h\"\n #include \"tsl/platform/platform.h\"\n \n@@ -42,7 +43,7 @@ std::vector<std::string> CandidateCudaRoots() {\n   auto roots = std::vector<std::string>{};\n   std::string runfiles_suffix = \"runfiles\";\n   std::vector<std::string> cuda_dir_names = {\"cuda_nvcc\", \"cuda_nvdisasm\",\n-                                             \"nvidia_nvshmem\"};\n+                                             \"nvidia_nvshmem\", \"cuda_nvvm\"};\n \n   // The CUDA candidate root for c++ targets.\n   std::string executable_path = tsl::Env::Default()->GetExecutablePath();\n@@ -76,8 +77,17 @@ std::vector<std::string> CandidateCudaRoots() {\n     // TF lib binaries are located in both the package's root dir and within a\n     // 'python' subdirectory (for pywrap libs). So we check two possible paths\n     // relative to the current binary for the wheel-based nvcc package.\n-    for (auto path : {\"../nvidia/cuda_nvcc\", \"../../nvidia/cuda_nvcc\"})\n+\n+    // Runtime check on the version string content\n+    std::vector<const char*> paths_to_add =\n+        absl::StartsWith(TF_CUDA_VERSION, \"13\")\n+            ? std::vector<const char*>{\"../nvidia/cu13\", \"../../nvidia/cu13\"}\n+            : std::vector<const char*>{\"../nvidia/cuda_nvcc\",\n+                                       \"../../nvidia/cuda_nvcc\"};\n+\n+    for (const char* path : paths_to_add) {\n       roots.emplace_back(io::JoinPath(dir, path));\n+    }\n \n     // Also add the path to the copy of libdevice.10.bc that we include within\n     // the Python wheel."
        }
    ],
    "stats": {
        "total": 98,
        "additions": 68,
        "deletions": 30
    }
}