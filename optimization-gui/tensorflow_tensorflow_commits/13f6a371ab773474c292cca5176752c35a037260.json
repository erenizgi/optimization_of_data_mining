{
    "author": "ermilovmaxim",
    "message": "Add Shape to ConvolutionReorderThunk buffer_uses\n\nModify Thunk's serialization\n\nPiperOrigin-RevId: 848309350",
    "sha": "13f6a371ab773474c292cca5176752c35a037260",
    "files": [
        {
            "sha": "1e8947492ff6b80decb79bf76d289bf7306c034d",
            "filename": "third_party/xla/xla/backends/gpu/runtime/BUILD",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2FBUILD?ref=13f6a371ab773474c292cca5176752c35a037260",
            "patch": "@@ -556,8 +556,11 @@ cc_library(\n     hdrs = [\"convolution_reorder_thunk.h\"],\n     deps = [\n         \":convolution_filter_thunk_proto_cc\",\n+        \":shaped_slice\",\n         \":thunk\",\n         \":thunk_proto_cc\",\n+        \"//xla:shape_util\",\n+        \"//xla:util\",\n         \"//xla/runtime:buffer_use\",\n         \"//xla/service:buffer_assignment\",\n         \"//xla/service:buffer_assignment_proto_cc\",\n@@ -592,6 +595,7 @@ tf_proto_library(\n     name = \"convolution_filter_thunk_proto\",\n     srcs = [\"convolution_filter_thunk.proto\"],\n     protodeps = [\"//xla/service:buffer_assignment_proto\"],\n+    deps = [\":shaped_slice_proto\"],\n )\n \n cc_library("
        },
        {
            "sha": "94cb9967b42bdb8d86440b9a1d63be4e2a466539",
            "filename": "third_party/xla/xla/backends/gpu/runtime/convolution_filter_thunk.proto",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_filter_thunk.proto",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_filter_thunk.proto",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_filter_thunk.proto?ref=13f6a371ab773474c292cca5176752c35a037260",
            "patch": "@@ -2,6 +2,7 @@ syntax = \"proto3\";\n \n package xla.gpu;\n \n+import \"xla/backends/gpu/runtime/shaped_slice.proto\";\n import \"xla/service/buffer_assignment.proto\";\n \n // Dimensions of the convolution filter.\n@@ -20,6 +21,6 @@ message ConvolutionFilterDimensions {\n // Buffers for the bias input and output of the convolution reorder thunk.\n // Serialized version of xla::gpu::ConvolutionReorderThunk::BiasBuffers.\n message ConvolutionReorderBiasBuffers {\n-  xla.buffer_assignment.BufferAllocationSliceProto bias_input = 1;\n-  xla.buffer_assignment.BufferAllocationSliceProto bias_output = 2;\n+  ShapedSliceProto bias_input = 1;\n+  ShapedSliceProto bias_output = 2;\n }"
        },
        {
            "sha": "872cce67cfda749966e51bb510e1a7720a2eb624",
            "filename": "third_party/xla/xla/backends/gpu/runtime/convolution_reorder_thunk.cc",
            "status": "modified",
            "additions": 41,
            "deletions": 21,
            "changes": 62,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_reorder_thunk.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_reorder_thunk.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_reorder_thunk.cc?ref=13f6a371ab773474c292cca5176752c35a037260",
            "patch": "@@ -24,13 +24,16 @@ limitations under the License.\n #include \"absl/status/status.h\"\n #include \"absl/types/span.h\"\n #include \"xla/backends/gpu/runtime/convolution_filter_thunk.pb.h\"\n+#include \"xla/backends/gpu/runtime/shaped_slice.h\"\n #include \"xla/backends/gpu/runtime/thunk.h\"\n #include \"xla/service/buffer_assignment.h\"\n #include \"xla/service/buffer_assignment.pb.h\"\n+#include \"xla/shape.h\"\n #include \"xla/stream_executor/device_address.h\"\n #include \"xla/stream_executor/dnn.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n #include \"xla/tsl/platform/statusor.h\"\n+#include \"xla/util.h\"\n \n namespace xla {\n namespace gpu {\n@@ -50,7 +53,7 @@ static se::dnn::FilterDescriptor CreateFilterDescriptor(\n \n ConvolutionReorderThunk::ConvolutionReorderThunk(\n     ThunkInfo thunk_info, ConvolutionFilterDimensions filter_dimensions,\n-    BufferAllocation::Slice filter_input, BufferAllocation::Slice filter_output,\n+    ShapedSlice filter_input, ShapedSlice filter_output,\n     std::optional<BiasBuffers> biases)\n     : Thunk(Kind::kConvolutionReorder, thunk_info),\n       filter_dimensions_(std::move(filter_dimensions)),\n@@ -59,22 +62,41 @@ ConvolutionReorderThunk::ConvolutionReorderThunk(\n       filter_output_(filter_output),\n       biases_(biases) {}\n \n+absl::StatusOr<std::unique_ptr<ConvolutionReorderThunk>>\n+ConvolutionReorderThunk::Create(ThunkInfo thunk_info, ShapedSlice filter_input,\n+                                ShapedSlice filter_output,\n+                                std::optional<BiasBuffers> biases) {\n+  Shape shape = filter_output.shape;\n+  if (shape.dimensions().size() != 5 || shape.dimensions(4) != 32) {\n+    return Internal(\"Unexpected shape for convolution reorder: %s\",\n+                    shape.ToString());\n+  }\n+  ConvolutionFilterDimensions filter_dimensions;\n+  filter_dimensions.set_output_feature_map_count(shape.dimensions(0));\n+  filter_dimensions.set_input_feature_map_count(shape.dimensions(1) * 32);\n+  filter_dimensions.set_input_filter_height(shape.dimensions(2));\n+  filter_dimensions.set_input_filter_width(shape.dimensions(3));\n+  return std::make_unique<ConvolutionReorderThunk>(\n+      std::move(thunk_info), filter_dimensions, filter_input, filter_output,\n+      biases);\n+}\n+\n absl::Status ConvolutionReorderThunk::ExecuteOnStream(\n     const ExecuteParams& params) {\n   const auto& buffer_allocations = *params.buffer_allocations;\n \n   auto filter_input = se::DeviceAddress<int8_t>(\n-      buffer_allocations.GetDeviceAddress(filter_input_));\n+      buffer_allocations.GetDeviceAddress(filter_input_.slice));\n   auto filter_output = se::DeviceAddress<int8_t>(\n-      buffer_allocations.GetDeviceAddress(filter_output_));\n+      buffer_allocations.GetDeviceAddress(filter_output_.slice));\n \n   std::optional<se::DeviceAddress<float>> bias_input;\n   std::optional<se::DeviceAddress<float>> bias_output;\n   if (biases_.has_value()) {\n     bias_input = se::DeviceAddress<float>(\n-        buffer_allocations.GetDeviceAddress(biases_->bias_input));\n+        buffer_allocations.GetDeviceAddress(biases_->bias_input.slice));\n     bias_output = se::DeviceAddress<float>(\n-        buffer_allocations.GetDeviceAddress(biases_->bias_output));\n+        buffer_allocations.GetDeviceAddress(biases_->bias_output.slice));\n   }\n \n   auto dnn = params.stream->parent()->AsDnn();\n@@ -90,27 +112,26 @@ absl::StatusOr<std::unique_ptr<ConvolutionReorderThunk>>\n ConvolutionReorderThunk::FromProto(\n     ThunkInfo thunk_info, const ConvolutionReorderThunkProto& proto,\n     absl::Span<const BufferAllocation> buffer_allocations) {\n-  TF_ASSIGN_OR_RETURN(BufferAllocation::Slice filter_input,\n-                      BufferAllocation::Slice::FromProto(proto.filter_input(),\n-                                                         buffer_allocations));\n-  TF_ASSIGN_OR_RETURN(BufferAllocation::Slice filter_output,\n-                      BufferAllocation::Slice::FromProto(proto.filter_output(),\n-                                                         buffer_allocations));\n+  TF_ASSIGN_OR_RETURN(\n+      ShapedSlice filter_input,\n+      ShapedSlice::FromProto(proto.filter_input(), buffer_allocations));\n+  TF_ASSIGN_OR_RETURN(\n+      ShapedSlice filter_output,\n+      ShapedSlice::FromProto(proto.filter_output(), buffer_allocations));\n \n   std::optional<BiasBuffers> biases;\n   if (proto.has_biases()) {\n-    TF_ASSIGN_OR_RETURN(BufferAllocation::Slice bias_input,\n-                        BufferAllocation::Slice::FromProto(\n-                            proto.biases().bias_input(), buffer_allocations));\n-    TF_ASSIGN_OR_RETURN(BufferAllocation::Slice bias_output,\n-                        BufferAllocation::Slice::FromProto(\n-                            proto.biases().bias_output(), buffer_allocations));\n+    TF_ASSIGN_OR_RETURN(ShapedSlice bias_input,\n+                        ShapedSlice::FromProto(proto.biases().bias_input(),\n+                                               buffer_allocations));\n+    TF_ASSIGN_OR_RETURN(ShapedSlice bias_output,\n+                        ShapedSlice::FromProto(proto.biases().bias_output(),\n+                                               buffer_allocations));\n     biases = {{bias_input, bias_output}};\n   }\n \n-  return std::make_unique<ConvolutionReorderThunk>(\n-      std::move(thunk_info), proto.filter_dimensions(), filter_input,\n-      filter_output, biases);\n+  return ConvolutionReorderThunk::Create(std::move(thunk_info), filter_input,\n+                                         filter_output, biases);\n }\n \n absl::StatusOr<ThunkProto> ConvolutionReorderThunk::ToProto() const {\n@@ -119,7 +140,6 @@ absl::StatusOr<ThunkProto> ConvolutionReorderThunk::ToProto() const {\n \n   ConvolutionReorderThunkProto* reorder_proto =\n       thunk_proto.mutable_convolution_reorder_thunk();\n-  *reorder_proto->mutable_filter_dimensions() = filter_dimensions_;\n \n   TF_ASSIGN_OR_RETURN(*reorder_proto->mutable_filter_input(),\n                       filter_input_.ToProto());"
        },
        {
            "sha": "d409c48819fc220c98f060aaa56df687d31e5c9c",
            "filename": "third_party/xla/xla/backends/gpu/runtime/convolution_reorder_thunk.h",
            "status": "modified",
            "additions": 17,
            "deletions": 11,
            "changes": 28,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_reorder_thunk.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_reorder_thunk.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_reorder_thunk.h?ref=13f6a371ab773474c292cca5176752c35a037260",
            "patch": "@@ -23,6 +23,7 @@ limitations under the License.\n #include \"absl/status/statusor.h\"\n #include \"absl/types/span.h\"\n #include \"xla/backends/gpu/runtime/convolution_filter_thunk.pb.h\"\n+#include \"xla/backends/gpu/runtime/shaped_slice.h\"\n #include \"xla/backends/gpu/runtime/thunk.h\"\n #include \"xla/backends/gpu/runtime/thunk.pb.h\"\n #include \"xla/runtime/buffer_use.h\"\n@@ -36,29 +37,34 @@ namespace gpu {\n class ConvolutionReorderThunk : public Thunk {\n  public:\n   struct BiasBuffers {\n-    BufferAllocation::Slice bias_input;\n-    BufferAllocation::Slice bias_output;\n+    ShapedSlice bias_input;\n+    ShapedSlice bias_output;\n   };\n \n   ConvolutionReorderThunk(ThunkInfo thunk_info,\n                           ConvolutionFilterDimensions filter_dimensions,\n-                          BufferAllocation::Slice filter_input,\n-                          BufferAllocation::Slice filter_output,\n+                          ShapedSlice filter_input, ShapedSlice filter_output,\n                           std::optional<BiasBuffers> biases);\n \n+  static absl::StatusOr<std::unique_ptr<ConvolutionReorderThunk>> Create(\n+      ThunkInfo thunk_info, ShapedSlice filter_input, ShapedSlice filter_output,\n+      std::optional<BiasBuffers> biases);\n+\n   ConvolutionReorderThunk(const ConvolutionReorderThunk&) = delete;\n   ConvolutionReorderThunk& operator=(const ConvolutionReorderThunk&) = delete;\n \n   absl::Status ExecuteOnStream(const ExecuteParams& params) override;\n \n   BufferUses buffer_uses() const override {\n     BufferUses res{\n-        BufferUse::Read(filter_input_),\n-        BufferUse::Write(filter_output_),\n+        BufferUse::Read(filter_input_.slice, filter_input_.shape),\n+        BufferUse::Write(filter_output_.slice, filter_output_.shape),\n     };\n     if (biases_.has_value()) {\n-      res.push_back(BufferUse::Read(biases_->bias_input));\n-      res.push_back(BufferUse::Write(biases_->bias_output));\n+      res.push_back(BufferUse::Read(biases_->bias_input.slice,\n+                                    biases_->bias_input.shape));\n+      res.push_back(BufferUse::Write(biases_->bias_output.slice,\n+                                     biases_->bias_output.shape));\n     }\n     return res;\n   }\n@@ -72,9 +78,9 @@ class ConvolutionReorderThunk : public Thunk {\n  private:\n   const ConvolutionFilterDimensions filter_dimensions_;\n   const se::dnn::FilterDescriptor filter_descriptor_;\n-  BufferAllocation::Slice filter_input_;\n-  BufferAllocation::Slice filter_output_;\n-  std::optional<BiasBuffers> biases_;\n+  const ShapedSlice filter_input_;\n+  const ShapedSlice filter_output_;\n+  const std::optional<BiasBuffers> biases_;\n };\n \n }  // namespace gpu"
        },
        {
            "sha": "f85b49bd35509a788fbf246d2d64a98f6cc4ab3a",
            "filename": "third_party/xla/xla/backends/gpu/runtime/convolution_reorder_thunk_test.cc",
            "status": "modified",
            "additions": 27,
            "deletions": 9,
            "changes": 36,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_reorder_thunk_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_reorder_thunk_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fconvolution_reorder_thunk_test.cc?ref=13f6a371ab773474c292cca5176752c35a037260",
            "patch": "@@ -39,17 +39,35 @@ TEST(ConvolutionReorderThunkTest, ProtoRoundTrip) {\n   auto proto = ParseTextProtoOrDie<ThunkProto>(R\"pb(\n     thunk_info { profile_annotation: \"test\" execution_stream_id: 0 }\n     convolution_reorder_thunk {\n-      filter_dimensions {\n-        output_feature_map_count: 1\n-        input_feature_map_count: 2\n-        input_filter_height: 3\n-        input_filter_width: 4\n+      filter_input {\n+        slice { buffer_allocation_index: 0 offset: 0 size: 1024 }\n+        shape {}\n+      }\n+      filter_output {\n+        slice { buffer_allocation_index: 1 offset: 0 size: 512 }\n+        shape {\n+          element_type: F32\n+          dimensions: 1\n+          dimensions: 2\n+          dimensions: 3\n+          dimensions: 4\n+          dimensions: 32\n+          is_dynamic_dimension: false\n+          is_dynamic_dimension: false\n+          is_dynamic_dimension: false\n+          is_dynamic_dimension: false\n+          is_dynamic_dimension: false\n+        }\n       }\n-      filter_input { buffer_allocation_index: 0 offset: 0 size: 1024 }\n-      filter_output { buffer_allocation_index: 1 offset: 0 size: 512 }\n       biases {\n-        bias_input { buffer_allocation_index: 2 offset: 0 size: 256 }\n-        bias_output { buffer_allocation_index: 3 offset: 0 size: 128 }\n+        bias_input {\n+          slice { buffer_allocation_index: 2 offset: 0 size: 256 }\n+          shape {}\n+        }\n+        bias_output {\n+          slice { buffer_allocation_index: 3 offset: 0 size: 128 }\n+          shape {}\n+        }\n       }\n     }\n   )pb\");"
        },
        {
            "sha": "a5a21c6fc89fdacc9c5e9d6a5994ff6525603434",
            "filename": "third_party/xla/xla/backends/gpu/runtime/thunk.proto",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fthunk.proto",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fthunk.proto",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fthunk.proto?ref=13f6a371ab773474c292cca5176752c35a037260",
            "patch": "@@ -344,10 +344,9 @@ message ConvolutionThunkProto {\n }\n \n message ConvolutionReorderThunkProto {\n-  ConvolutionFilterDimensions filter_dimensions = 1;\n-  xla.buffer_assignment.BufferAllocationSliceProto filter_input = 2;\n-  xla.buffer_assignment.BufferAllocationSliceProto filter_output = 3;\n-  optional ConvolutionReorderBiasBuffers biases = 4;\n+  ShapedSliceProto filter_input = 1;\n+  ShapedSliceProto filter_output = 2;\n+  optional ConvolutionReorderBiasBuffers biases = 3;\n }\n \n message FftThunkProto {"
        },
        {
            "sha": "500ec3183e9275458e0fb900bc9e66a838327b46",
            "filename": "third_party/xla/xla/service/gpu/thunk_emitter.cc",
            "status": "modified",
            "additions": 15,
            "deletions": 24,
            "changes": 39,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fthunk_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13f6a371ab773474c292cca5176752c35a037260/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fthunk_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fthunk_emitter.cc?ref=13f6a371ab773474c292cca5176752c35a037260",
            "patch": "@@ -778,38 +778,29 @@ absl::StatusOr<ThunkSequence> ThunkEmitter::EmitCublasLtMatmulThunkF8(\n absl::StatusOr<ThunkSequence> ThunkEmitter::EmitConvolutionReorderThunk(\n     const HloCustomCallInstruction* instr) {\n   bool has_bias = instr->operand_count() > 1;\n-  Shape shape = has_bias ? instr->shape().tuple_shapes(0) : instr->shape();\n-  if (shape.dimensions().size() != 5 || shape.dimensions(4) != 32) {\n-    return Internal(\"Unexpected shape for convolution reorder: %s\",\n-                    instr->ToString());\n-  }\n-  ConvolutionFilterDimensions filter_dimensions;\n-  filter_dimensions.set_output_feature_map_count(shape.dimensions(0));\n-  filter_dimensions.set_input_feature_map_count(shape.dimensions(1) * 32);\n-  filter_dimensions.set_input_filter_height(shape.dimensions(2));\n-  filter_dimensions.set_input_filter_width(shape.dimensions(3));\n-\n-  TF_ASSIGN_OR_RETURN(BufferAllocation::Slice filter_input,\n-                      GetAllocationSliceForHlo(instr->operand(0)));\n \n-  BufferAllocation::Slice filter_output;\n+  TF_ASSIGN_OR_RETURN(ShapedSlice filter_input,\n+                      GetShapedSliceForHlo(instr->operand(0)));\n+\n+  ShapedSlice filter_output;\n   std::optional<ConvolutionReorderThunk::BiasBuffers> biases;\n   if (has_bias) {\n-    TF_ASSIGN_OR_RETURN(filter_output, GetAllocationSliceForHlo(instr, {0}));\n+    TF_ASSIGN_OR_RETURN(filter_output, GetShapedSliceForHlo(instr, {0}));\n \n-    TF_ASSIGN_OR_RETURN(BufferAllocation::Slice bias_input,\n-                        GetAllocationSliceForHlo(instr->operand(1)));\n-    TF_ASSIGN_OR_RETURN(BufferAllocation::Slice bias_output,\n-                        GetAllocationSliceForHlo(instr, {1}));\n+    TF_ASSIGN_OR_RETURN(ShapedSlice bias_input,\n+                        GetShapedSliceForHlo(instr->operand(1)));\n+    TF_ASSIGN_OR_RETURN(ShapedSlice bias_output,\n+                        GetShapedSliceForHlo(instr, {1}));\n     biases = {{bias_input, bias_output}};\n   } else {\n-    TF_ASSIGN_OR_RETURN(filter_output, GetAllocationSliceForHlo(instr));\n+    TF_ASSIGN_OR_RETURN(filter_output, GetShapedSliceForHlo(instr));\n   }\n \n-  auto thunk = std::make_unique<ConvolutionReorderThunk>(\n-      Thunk::ThunkInfo::WithProfileAnnotation(\n-          instr, ir_emitter_context_->GetNextThunkId()),\n-      std::move(filter_dimensions), filter_input, filter_output, biases);\n+  ASSIGN_OR_RETURN(auto thunk,\n+                   ConvolutionReorderThunk::Create(\n+                       Thunk::ThunkInfo::WithProfileAnnotation(\n+                           instr, ir_emitter_context_->GetNextThunkId()),\n+                       filter_input, filter_output, biases));\n   return GetThunkSequence(std::move(thunk));\n }\n "
        }
    ],
    "stats": {
        "total": 181,
        "additions": 110,
        "deletions": 71
    }
}