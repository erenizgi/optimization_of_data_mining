{
    "author": "EusebioDM",
    "message": "Add riegeli as a dependency in XLA\n\nWe'll be using it to be able to generate AOT binaries for models bigger than 2GiB (proto size limit). Additional changes:\n\n* Add brotli as a dependency (required by riegeli)\n* Upgraded the Snappy versions, which was also required by riegeli\n\nPiperOrigin-RevId: 844802068",
    "sha": "eacb3d2330330875c7ed530cb41ff1cf995999d9",
    "files": [
        {
            "sha": "9b372e6b9d9ad0a186ab4949c2e5acf51aca6293",
            "filename": "third_party/xla/MODULE.bazel",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2FMODULE.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2FMODULE.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2FMODULE.bazel?ref=eacb3d2330330875c7ed530cb41ff1cf995999d9",
            "patch": "@@ -3,6 +3,7 @@ module(name = \"xla\")\n ##############################################################\n # Bazel module dependencies\n \n+# go/keep-sorted start\n bazel_dep(name = \"abseil-cpp\", version = \"20250814.0\", repo_name = \"com_google_absl\")\n bazel_dep(name = \"abseil-py\", version = \"2.1.0\", repo_name = \"absl_py\")\n bazel_dep(name = \"bazel_features\", version = \"1.36.0\")\n@@ -21,13 +22,15 @@ bazel_dep(name = \"pybind11_abseil\", version = \"202402.0\")\n bazel_dep(name = \"pybind11_bazel\", version = \"2.13.6\")\n bazel_dep(name = \"pybind11_protobuf\", version = \"0.0.0-20250210-f02a2b7\")\n bazel_dep(name = \"re2\", version = \"2024-07-02.bcr.1\", repo_name = \"com_googlesource_code_re2\")\n+bazel_dep(name = \"riegeli\", version = \"0.0.0-20250822-9f2744d\", repo_name = \"com_google_riegeli\")\n bazel_dep(name = \"rules_cc\", version = \"0.2.0\")\n bazel_dep(name = \"rules_java\", version = \"8.16.1\")\n bazel_dep(name = \"rules_license\", version = \"1.0.0\")\n bazel_dep(name = \"rules_python\", version = \"1.6.0\")\n bazel_dep(name = \"rules_shell\", version = \"0.6.1\")\n bazel_dep(name = \"snappy\", version = \"1.2.1\")\n bazel_dep(name = \"zlib\", version = \"1.3.1.bcr.5\")\n+# go/keep-sorted end\n \n # Only for compatibility, not directly used, change repo_name to None after upgrading Bazel to latest 7.x\n bazel_dep(name = \"eigen\", version = \"4.0.0-20241125.bcr.3\", repo_name = \"DO_NOT_USE_eigen\")\n@@ -71,12 +74,12 @@ single_version_override(\n # Use an unreleased version of googletest\n archive_override(\n     module_name = \"googletest\",\n-    strip_prefix = \"googletest-28e9d1f26771c6517c3b4be10254887673c94018\",\n-    urls = [\"https://github.com/google/googletest/archive/28e9d1f26771c6517c3b4be10254887673c94018.zip\"],\n     patch_strip = 1,\n     patches = [\n         \"//third_party/googletest:0001-Add-ASSERT_OK-EXPECT_OK-ASSERT_OK_AND_ASSIGN-macros.patch\",\n     ],\n+    strip_prefix = \"googletest-28e9d1f26771c6517c3b4be10254887673c94018\",\n+    urls = [\"https://github.com/google/googletest/archive/28e9d1f26771c6517c3b4be10254887673c94018.zip\"],\n )\n \n ##############################################################"
        },
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "third_party/xla/third_party/brotli/BUILD.bazel",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fthird_party%2Fbrotli%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fthird_party%2Fbrotli%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fbrotli%2FBUILD.bazel?ref=eacb3d2330330875c7ed530cb41ff1cf995999d9"
        },
        {
            "sha": "ec76237744b34704236f8c307121d5b9b23faea0",
            "filename": "third_party/xla/third_party/brotli/workspace.bzl",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fthird_party%2Fbrotli%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fthird_party%2Fbrotli%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fbrotli%2Fworkspace.bzl?ref=eacb3d2330330875c7ed530cb41ff1cf995999d9",
            "patch": "@@ -0,0 +1,11 @@\n+\"\"\"Provides the repo macro to import brotli\"\"\"\n+\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n+\n+def repo():\n+    tf_http_archive(\n+        name = \"org_brotli\",\n+        sha256 = \"e720a6ca29428b803f4ad165371771f5398faba397edf6778837a18599ea13ff\",\n+        strip_prefix = \"brotli-1.1.0\",\n+        urls = tf_mirror_urls(\"https://github.com/google/brotli/archive/refs/tags/v1.1.0.tar.gz\"),\n+    )"
        },
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "third_party/xla/third_party/riegeli/BUILD.bazel",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fthird_party%2Friegeli%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fthird_party%2Friegeli%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Friegeli%2FBUILD.bazel?ref=eacb3d2330330875c7ed530cb41ff1cf995999d9"
        },
        {
            "sha": "577511ee10e83e9435eac19495a15a7c0b1b8049",
            "filename": "third_party/xla/third_party/riegeli/workspace.bzl",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fthird_party%2Friegeli%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fthird_party%2Friegeli%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Friegeli%2Fworkspace.bzl?ref=eacb3d2330330875c7ed530cb41ff1cf995999d9",
            "patch": "@@ -0,0 +1,11 @@\n+\"\"\"Provides the repo macro to import riegeli\"\"\"\n+\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n+\n+def repo():\n+    tf_http_archive(\n+        name = \"com_google_riegeli\",\n+        sha256 = \"f63337f63f794ba9dc7dd281b20af3d036dfe0c1a5a4b7b8dc20b39f7e323b97\",\n+        strip_prefix = \"riegeli-9f2744dc23e81d84c02f6f51244e9e9bb9802d57\",\n+        urls = tf_mirror_urls(\"https://github.com/google/riegeli/archive/9f2744dc23e81d84c02f6f51244e9e9bb9802d57.tar.gz\"),\n+    )"
        },
        {
            "sha": "9438e40f32fe267652ea7327f860841264e0fd48",
            "filename": "third_party/xla/workspace2.bzl",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fworkspace2.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eacb3d2330330875c7ed530cb41ff1cf995999d9/third_party%2Fxla%2Fworkspace2.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fworkspace2.bzl?ref=eacb3d2330330875c7ed530cb41ff1cf995999d9",
            "patch": "@@ -10,6 +10,7 @@ load(\"@rules_ml_toolchain//gpu/sycl:sycl_init_repository.bzl\", \"sycl_init_reposi\n load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n load(\"//third_party/absl:workspace.bzl\", absl = \"repo\")\n load(\"//third_party/benchmark:workspace.bzl\", benchmark = \"repo\")\n+load(\"//third_party/brotli:workspace.bzl\", brotli = \"repo\")\n load(\"//third_party/clang_toolchain:cc_configure_clang.bzl\", \"cc_download_clang_toolchain\")\n load(\"//third_party/cpuinfo:workspace.bzl\", cpuinfo = \"repo\")\n load(\"//third_party/cudnn_frontend:workspace.bzl\", cudnn_frontend = \"repo\")\n@@ -42,6 +43,7 @@ load(\"//third_party/pybind11_abseil:workspace.bzl\", pybind11_abseil = \"repo\")\n load(\"//third_party/pybind11_bazel:workspace.bzl\", pybind11_bazel = \"repo\")\n load(\"//third_party/raft:workspace.bzl\", raft = \"repo\")\n load(\"//third_party/rapids_logger:workspace.bzl\", rapids_logger = \"repo\")\n+load(\"//third_party/riegeli:workspace.bzl\", riegeli = \"repo\")\n load(\"//third_party/rmm:workspace.bzl\", rmm = \"repo\")\n load(\"//third_party/robin_map:workspace.bzl\", robin_map = \"repo\")\n load(\"//third_party/rocm_device_libs:workspace.bzl\", rocm_device_libs = \"repo\")\n@@ -76,6 +78,8 @@ def _initialize_third_party():\n     farmhash()\n     fmt()\n     fxdiv()\n+    riegeli()\n+    brotli()\n     gemmlowp()\n     gloo()\n     gutil()\n@@ -389,9 +393,9 @@ def _tf_repositories():\n     tf_http_archive(\n         name = \"snappy\",\n         build_file = \"//third_party:snappy.BUILD\",\n-        sha256 = \"2e458b7017cd58dcf1469ab315389e85e7f445bd035188f2983f81fb19ecfb29\",\n-        strip_prefix = \"snappy-984b191f0fefdeb17050b42a90b7625999c13b8d\",\n-        urls = tf_mirror_urls(\"https://github.com/google/snappy/archive/984b191f0fefdeb17050b42a90b7625999c13b8d.tar.gz\"),\n+        sha256 = \"736aeb64d86566d2236ddffa2865ee5d7a82d26c9016b36218fcc27ea4f09f86\",\n+        strip_prefix = \"snappy-1.2.1\",\n+        urls = tf_mirror_urls(\"https://github.com/google/snappy/archive/refs/tags/1.2.1.tar.gz\"),\n     )\n \n     tf_http_archive("
        }
    ],
    "stats": {
        "total": 39,
        "additions": 34,
        "deletions": 5
    }
}