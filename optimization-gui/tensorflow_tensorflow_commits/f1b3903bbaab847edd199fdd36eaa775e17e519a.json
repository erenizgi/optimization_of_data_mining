{
    "author": "olegshyshkov",
    "message": "[XLA:GPU] Use ExecuteReplicated overload returning ExecutionResult.\n\nPiperOrigin-RevId: 838388773",
    "sha": "f1b3903bbaab847edd199fdd36eaa775e17e519a",
    "files": [
        {
            "sha": "dd935fcdf9b8de3c4e2b824717227c95fc8c9d33",
            "filename": "third_party/xla/xla/tests/collective_ops_e2e_test.cc",
            "status": "modified",
            "additions": 103,
            "deletions": 78,
            "changes": 181,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f1b3903bbaab847edd199fdd36eaa775e17e519a/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f1b3903bbaab847edd199fdd36eaa775e17e519a/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test.cc?ref=f1b3903bbaab847edd199fdd36eaa775e17e519a",
            "patch": "@@ -205,11 +205,15 @@ TEST_P(AsyncCollectiveOps, AsyncAllReduce) {\n       << hlo_runner_->device_count() << \" available)\";\n \n   const bool enable_async_all_reduce = GetParam();\n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n \n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n+\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n+\n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* all_reduce_start =\n       FindInstruction(hlo_module, HloOpcode::kAllReduceStart);\n   HloInstruction* all_reduce_done =\n@@ -218,8 +222,7 @@ TEST_P(AsyncCollectiveOps, AsyncAllReduce) {\n   EXPECT_THAT(all_reduce_done, NotNull());\n   EXPECT_EQ(IsAsync(all_reduce_start), enable_async_all_reduce);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n   // sum [0, num_devices)\n   const uint32_t expected = kNumReplicas * (kNumReplicas - 1) / 2;\n@@ -247,11 +250,14 @@ TEST_P(AsyncCollectiveOps, AsyncAllGather) {\n \n   const bool enable_async_all_gather = GetParam();\n \n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n \n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n+\n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* all_gather_start =\n       FindInstruction(hlo_module, HloOpcode::kAllGatherStart);\n   HloInstruction* all_gather_done =\n@@ -260,9 +266,7 @@ TEST_P(AsyncCollectiveOps, AsyncAllGather) {\n   EXPECT_THAT(all_gather_done, NotNull());\n   EXPECT_EQ(IsAsync(all_gather_start), enable_async_all_gather);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n-\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n   for (const Literal& result : results) {\n     LiteralTestUtil::ExpectR1Equal<uint32_t>({10, 15, 11, 16}, result);\n@@ -293,11 +297,14 @@ TEST_P(AsyncCollectiveOps, AsyncAllGatherMixedTypes) {\n \n   const bool enable_async_all_gather = GetParam();\n \n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n+\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n \n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* all_gather_start =\n       FindInstruction(hlo_module, HloOpcode::kAllGatherStart);\n   HloInstruction* all_gather_done =\n@@ -306,14 +313,14 @@ TEST_P(AsyncCollectiveOps, AsyncAllGatherMixedTypes) {\n   EXPECT_THAT(all_gather_done, NotNull());\n   EXPECT_EQ(IsAsync(all_gather_start), enable_async_all_gather);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n-\n+  std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n   for (Literal& result : results) {\n-    std::vector<Literal> results = result.DecomposeTuple();\n-    LiteralTestUtil::ExpectR1Equal<uint32_t>({10, 15, 11, 16}, results[0]);\n-    LiteralTestUtil::ExpectR1Equal<float>({10.0, 15.0, 11.0, 16.0}, results[1]);\n+    std::vector<Literal> tuple_results = result.DecomposeTuple();\n+    LiteralTestUtil::ExpectR1Equal<uint32_t>({10, 15, 11, 16},\n+                                             tuple_results[0]);\n+    LiteralTestUtil::ExpectR1Equal<float>({10.0, 15.0, 11.0, 16.0},\n+                                          tuple_results[1]);\n   }\n }\n \n@@ -335,20 +342,22 @@ TEST_P(AsyncCollectiveOps, AsyncCollectiveBroadcast) {\n       << hlo_runner_->device_count() << \" available)\";\n \n   const bool enable_async_collective_broadcast = GetParam();\n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n+\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n \n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* cb_start =\n       FindInstruction(hlo_module, HloOpcode::kAsyncStart);\n   HloInstruction* cb_done = FindInstruction(hlo_module, HloOpcode::kAsyncDone);\n   EXPECT_THAT(cb_start, NotNull());\n   EXPECT_THAT(cb_done, NotNull());\n   EXPECT_EQ(IsAsync(cb_start), enable_async_collective_broadcast);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({11, 11}, results[0]);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({11, 11}, results[1]);\n@@ -372,11 +381,14 @@ TEST_P(AsyncCollectiveOps, AsyncCollectivePermute) {\n       << hlo_runner_->device_count() << \" available)\";\n \n   const bool enable_async_collective_permute = GetParam();\n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n \n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n+\n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* cp_start =\n       FindInstruction(hlo_module, HloOpcode::kCollectivePermuteStart);\n   HloInstruction* cp_done =\n@@ -385,8 +397,7 @@ TEST_P(AsyncCollectiveOps, AsyncCollectivePermute) {\n   EXPECT_THAT(cp_done, NotNull());\n   EXPECT_EQ(IsAsync(cp_start), enable_async_collective_permute);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({11, 11}, results[0]);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({10, 10}, results[1]);\n@@ -409,11 +420,15 @@ TEST_P(AsyncCollectiveOps, CombinedCollectivePermute) {\n   )\";\n   const int64_t kNumReplicas = 2;\n   const bool enable_async_collective_permute = GetParam();\n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n \n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n+\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n+\n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* cp_start =\n       FindInstruction(hlo_module, HloOpcode::kCollectivePermuteStart);\n   HloInstruction* cp_done =\n@@ -422,8 +437,7 @@ TEST_P(AsyncCollectiveOps, CombinedCollectivePermute) {\n   EXPECT_THAT(cp_done, NotNull());\n   EXPECT_EQ(IsAsync(cp_start), enable_async_collective_permute);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({1, 1, 11, 11}, results[0]);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({0, 0, 10, 10}, results[1]);\n@@ -451,11 +465,14 @@ TEST_P(AsyncCollectiveOps, CollectivePermuteCombiner) {\n     GTEST_SKIP() << \"Test requires at least \" << kNumReplicas << \" devices (\"\n                  << hlo_runner_->device_count() << \" available)\";\n   }\n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n \n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n+\n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* cp_start =\n       FindInstruction(hlo_module, HloOpcode::kCollectivePermuteStart);\n   HloInstruction* cp_done =\n@@ -479,8 +496,7 @@ TEST_P(AsyncCollectiveOps, CollectivePermuteCombiner) {\n   EXPECT_THAT(cp_done, NotNull());\n   EXPECT_EQ(IsAsync(cp_start), enable_async_collective_permute);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({3, 3, 6, 6, 13, 13}, results[0]);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({0, 0, 0, 0, 10, 10}, results[1]);\n@@ -517,11 +533,14 @@ TEST_P(AsyncCollectiveOps, AsyncReduceScatter) {\n       << hlo_runner_->device_count() << \" available)\";\n \n   const bool enable_async_reduce_scatter = GetParam();\n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n \n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n+\n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* rs_start =\n       FindInstruction(hlo_module, HloOpcode::kAsyncStart);\n   HloInstruction* rs_done = FindInstruction(hlo_module, HloOpcode::kAsyncDone);\n@@ -531,8 +550,7 @@ TEST_P(AsyncCollectiveOps, AsyncReduceScatter) {\n   EXPECT_EQ(rs_start_async->async_wrapped_opcode(), HloOpcode::kReduceScatter);\n   EXPECT_EQ(IsAsync(rs_start), enable_async_reduce_scatter);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({11, 13, 15, 17}, results[0]);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({19, 21, 23, 25}, results[1]);\n }\n@@ -555,11 +573,14 @@ TEST_P(AsyncCollectiveOps, AsyncAllToAllWithSplitDim) {\n       << hlo_runner_->device_count() << \" available)\";\n \n   const bool enable_async_all_to_all = GetParam();\n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n+\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n \n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* a2a_start =\n       FindInstruction(hlo_module, HloOpcode::kAsyncStart);\n   HloInstruction* a2a_done = FindInstruction(hlo_module, HloOpcode::kAsyncDone);\n@@ -569,8 +590,7 @@ TEST_P(AsyncCollectiveOps, AsyncAllToAllWithSplitDim) {\n   EXPECT_EQ(a2a_start_async->async_wrapped_opcode(), HloOpcode::kAllToAll);\n   EXPECT_EQ(IsAsync(a2a_start), enable_async_all_to_all);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({10, 11}, results[0]);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({15, 16}, results[1]);\n@@ -643,11 +663,14 @@ TEST_P(AsyncCollectiveOps, AsyncAllToAllWithoutSplitDim) {\n       << hlo_runner_->device_count() << \" available)\";\n \n   const bool enable_async_all_to_all = GetParam();\n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n \n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n+\n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* a2a_start =\n       FindInstruction(hlo_module, HloOpcode::kAsyncStart);\n   HloInstruction* a2a_done = FindInstruction(hlo_module, HloOpcode::kAsyncDone);\n@@ -657,8 +680,7 @@ TEST_P(AsyncCollectiveOps, AsyncAllToAllWithoutSplitDim) {\n   EXPECT_EQ(a2a_start_async->async_wrapped_opcode(), HloOpcode::kAllToAll);\n   EXPECT_EQ(IsAsync(a2a_start_async), enable_async_all_to_all);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({10, 15, 11, 16}, results[0]);\n   LiteralTestUtil::ExpectR1Equal<uint32_t>({40, 60, 44, 64}, results[1]);\n@@ -708,7 +730,6 @@ TEST_P(AsyncCollectiveOps, AsyncAllToAllMemCpyWithoutSplitDim) {\n TEST_P(AsyncCollectiveOps, AsyncAllToAllNumberOfElementsLargerThanInt32Max) {\n   const absl::string_view kModuleStr = R\"(\n   HloModule test\n-\n   ENTRY test_computation {\n     id = u32[] replica-id()\n     id_u8 = u8[] convert(id)\n@@ -723,11 +744,14 @@ TEST_P(AsyncCollectiveOps, AsyncAllToAllNumberOfElementsLargerThanInt32Max) {\n       << hlo_runner_->device_count() << \" available)\";\n \n   const bool enable_async_all_to_all = GetParam();\n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n \n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n+\n+  const HloModule* hlo_module = execution_result.optimized_module;\n   HloInstruction* a2a_start =\n       FindInstruction(hlo_module, HloOpcode::kAsyncStart);\n   HloInstruction* a2a_done = FindInstruction(hlo_module, HloOpcode::kAsyncDone);\n@@ -737,8 +761,7 @@ TEST_P(AsyncCollectiveOps, AsyncAllToAllNumberOfElementsLargerThanInt32Max) {\n   EXPECT_EQ(a2a_start_async->async_wrapped_opcode(), HloOpcode::kAllToAll);\n   EXPECT_EQ(IsAsync(a2a_start_async), enable_async_all_to_all);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n \n   // Sanity check only a few elements in each result, because checking all 2GB\n@@ -775,11 +798,14 @@ ENTRY entry {\n       << \"Test requires at least \" << kNumReplicas << \" devices (\"\n       << hlo_runner_->device_count() << \" available)\";\n \n-  TF_ASSERT_OK_AND_ASSIGN(auto executable,\n-                          CreateExecutable(kModuleStr, kNumReplicas));\n-  TF_ASSERT_OK_AND_ASSIGN(const HloModule* const hlo_module,\n-                          hlo_runner_->HloModuleFromWrapped(executable.get()));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      auto module, ParseAndReturnVerifiedModule(kModuleStr, kNumReplicas));\n+\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      ExecutionResult execution_result,\n+      ExecuteReplicated(std::move(module), /*arguments=*/{{}, {}}));\n \n+  const HloModule* hlo_module = execution_result.optimized_module;\n   const bool enable_async_ragged_all_to_all = GetParam();\n   HloInstruction* ra2a_start =\n       FindInstruction(hlo_module, HloOpcode::kAsyncStart);\n@@ -798,8 +824,7 @@ ENTRY entry {\n       ra2a_start_async->async_wrapped_instruction()->shape().element_type(),\n       BF16);\n \n-  TF_ASSERT_OK_AND_ASSIGN(std::vector<Literal> results,\n-                          ExecuteReplicated(executable.get(), kNumReplicas));\n+  const std::vector<Literal>& results = execution_result.results;\n   ASSERT_EQ(results.size(), kNumReplicas);\n \n   const bfloat16 four = static_cast<bfloat16>(4.);"
        }
    ],
    "stats": {
        "total": 181,
        "additions": 103,
        "deletions": 78
    }
}