{
    "author": "Ma-gi-cian",
    "message": "Improved readability and tests",
    "sha": "0c6ab467e5234f40386da611e43567eab220e1fb",
    "files": [
        {
            "sha": "9b669d071bb698b1f2363f02bb31fc508d6d4639",
            "filename": "tensorflow/python/ops/math_ops.py",
            "status": "modified",
            "additions": 17,
            "deletions": 11,
            "changes": 28,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/0c6ab467e5234f40386da611e43567eab220e1fb/tensorflow%2Fpython%2Fops%2Fmath_ops.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/0c6ab467e5234f40386da611e43567eab220e1fb/tensorflow%2Fpython%2Fops%2Fmath_ops.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fops%2Fmath_ops.py?ref=0c6ab467e5234f40386da611e43567eab220e1fb",
            "patch": "@@ -300,19 +300,25 @@ def argmax_v2(input, axis=None, output_type=dtypes.int64, name=None):\n     axis = 0\n \n   if hasattr(axis, \"dtype\"):\n-    if axis.dtype not in (\n-        dtypes.int8,\n-        dtypes.uint8,\n-        dtypes.int16,\n-        dtypes.uint16,\n-        dtypes.int32,\n-        dtypes.int64,\n-    ):\n-      raise TypeError(f\"axis tensor dtypes {axis.dtype} is not supported\")\n-    if axis.dtype in (dtypes.int8, dtypes.int16, dtypes.uint8, dtypes.uint16):\n+    allowed_dtypes = {\n+      dtypes.int8, dtypes.uint8,\n+      dtypes.int16, dtypes.uint16,\n+      dtypes.int32, dtypes.int64\n+    }\n+    if axis.dtype not in allowed_dtypes:\n+      raise TypeError(\n+        f\"axis tensor dtypes {axis.dtype} is not supported\"\n+      )\n+    castable_types = {\n+        dtypes.int8, dtypes.int16,\n+        dtypes.uint8, dtypes.uint16\n+      }\n+    if axis.dtype in castable_types:\n       axis = cast(axis, dtypes.int32)\n   elif not isinstance(axis, int):\n-    raise TypeError(f\"axis must be int or Tensor with integer datatype\")\n+    raise TypeError(\n+      \"axis must be int or Tensor with integer datatype\"\n+    )\n \n   return gen_math_ops.arg_max(input, axis, name=name, output_type=output_type)\n "
        },
        {
            "sha": "5a08ba486d8433d2799e0eb7b970af6df65fda0b",
            "filename": "tensorflow/python/ops/math_ops_test.py",
            "status": "modified",
            "additions": 25,
            "deletions": 10,
            "changes": 35,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/0c6ab467e5234f40386da611e43567eab220e1fb/tensorflow%2Fpython%2Fops%2Fmath_ops_test.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/0c6ab467e5234f40386da611e43567eab220e1fb/tensorflow%2Fpython%2Fops%2Fmath_ops_test.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fops%2Fmath_ops_test.py?ref=0c6ab467e5234f40386da611e43567eab220e1fb",
            "patch": "@@ -1426,19 +1426,34 @@ def testArgMaxUint16(self):\n         tf_max = math_ops.argmax(\n             tf_values, axis=axis, output_type=dtypes.uint16)\n         self.assertAllEqual(tf_max, np_max)\n-\n-  def testArgMaxInt16(self):\n+ \n+  def testArgMaxWithIntegerDtypes(self):\n+    axis_dtypes = {\n+      dtypes.int8, dtypes.uint8,\n+      dtypes.int16, dtypes.uint16,\n+      dtypes.int32, dtypes.int64\n+    }\n     shape = (24, 8)\n-    tf_values = self._generateRandomTensor(dtypes.int16, shape)\n-    np_values = self.evaluate(tf_values)\n-    for axis in range(0, len(shape)):\n-      np_max = np.argmax(np_values, axis=axis)\n-      tf_max = math_ops.argmax(\n+    for d_type in axis_dtypes:\n+      tf_values = self._generateRandomTensor(d_type, shape)\n+      np_values = self.evaluate(tf_values)\n+      for axis in range(len(shape)):\n+        np_max = np.argmax(np_values, axis=axis)\n+        tf_max = math_ops.argmax(\n           tf_values,\n-          axis=constant_op.constant(axis, dtype=dtypes.int16),\n-          output_type=dtypes.int32,\n+          axis=constant_op.constant(axis, dtype=d_type),\n+          output_type=dtypes.int32\n+        )\n+        self.assertAllEqual(tf_max, np_max)\n+\n+  def testArgMaxRaisesInvalidDtype(self):\n+    invalid_axis = constant_op.constant(1, dtype=dtypes.float32)\n+    with self.assertRaises(TypeError):\n+      math_ops.argmax(\n+        constant_op.constant([1,2,3]),\n+        axis=invalid_axis,\n+        output_type=dtypes.int32\n       )\n-      self.assertAllEqual(tf_max, np_max)\n \n   def testArgMin(self):\n     shape = (24, 8)"
        }
    ],
    "stats": {
        "total": 63,
        "additions": 42,
        "deletions": 21
    }
}