{
    "author": "tensorflower-gardener",
    "message": "Merge pull request #99058 from Aaraviitkgp:wav_error_clean\n\nPiperOrigin-RevId: 797190171",
    "sha": "65ee632c1345a48bdb16d13724cf1aca36a73996",
    "files": [
        {
            "sha": "7d4ff1a068238a4149fe9966011f05c6fcecb8e2",
            "filename": "tensorflow/core/kernels/decode_wav_op.cc",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/65ee632c1345a48bdb16d13724cf1aca36a73996/tensorflow%2Fcore%2Fkernels%2Fdecode_wav_op.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/65ee632c1345a48bdb16d13724cf1aca36a73996/tensorflow%2Fcore%2Fkernels%2Fdecode_wav_op.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fkernels%2Fdecode_wav_op.cc?ref=65ee632c1345a48bdb16d13724cf1aca36a73996",
            "patch": "@@ -54,6 +54,12 @@ class DecodeWavOp : public OpKernel {\n                        wav_string, &decoded_samples, &decoded_sample_count,\n                        &decoded_channel_count, &decoded_sample_rate));\n \n+    OP_REQUIRES(context, desired_channels_ >= -1,\n+                errors::InvalidArgument(\"desired_channels must be >= -1, got \",\n+                                        desired_channels_));\n+    OP_REQUIRES(context, desired_samples_ >= -1,\n+                errors::InvalidArgument(\"desired_samples must be >= -1, got \",\n+                                        desired_samples_));\n     int32_t output_sample_count;\n     if (desired_samples_ == -1) {\n       output_sample_count = decoded_sample_count;\n@@ -67,6 +73,14 @@ class DecodeWavOp : public OpKernel {\n       output_channel_count = desired_channels_;\n     }\n \n+    OP_REQUIRES(\n+        context, output_sample_count >= 0,\n+        errors::InvalidArgument(\"Output sample count must be >= 0, got \",\n+                                output_sample_count));\n+    OP_REQUIRES(\n+        context, output_channel_count >= 0,\n+        errors::InvalidArgument(\"Output channel count must be >= 0, got \",\n+                                output_channel_count));\n     Tensor* output = nullptr;\n     OP_REQUIRES_OK(\n         context,"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 14,
        "deletions": 0
    }
}