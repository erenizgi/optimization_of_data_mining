{
    "author": "tensorflower-gardener",
    "message": "Add SymbolicExpr::IsBinaryOp() method\n\nThis CL introduces a new helper method SymbolicExpr::IsBinaryOp() to quickly determine if a SymbolicExpr is a binary operation (i.e., not a constant or a variable). This is used in indexing_map.cc in several places for AffineMap and it will simplify the refactor.\n\nPiperOrigin-RevId: 826468454",
    "sha": "f73a95490618257a100fbde24f5b568b5630aad9",
    "files": [
        {
            "sha": "e7588404cf2ad46555531d4b2bd629568cb6b02b",
            "filename": "third_party/xla/xla/hlo/analysis/symbolic_expr.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 6,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f73a95490618257a100fbde24f5b568b5630aad9/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fsymbolic_expr.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f73a95490618257a100fbde24f5b568b5630aad9/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fsymbolic_expr.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fsymbolic_expr.cc?ref=f73a95490618257a100fbde24f5b568b5630aad9",
            "patch": "@@ -557,6 +557,12 @@ SymbolicExprContext* SymbolicExpr::GetContext() const { return impl_->ctx_; }\n \n SymbolicExprType SymbolicExpr::GetType() const { return impl_->type_; }\n \n+bool SymbolicExpr::IsBinaryOp() const {\n+  auto type = GetType();\n+  return type != SymbolicExprType::kConstant &&\n+         type != SymbolicExprType::kVariable;\n+}\n+\n SymbolicExpr SymbolicExpr::GetLHS() const { return impl_->lhs_; }\n \n SymbolicExpr SymbolicExpr::GetRHS() const { return impl_->rhs_; }\n@@ -732,12 +738,11 @@ SymbolicExpr SymbolicExpr::Replace(\n     return it->second;\n   }\n \n-  SymbolicExprType type = GetType();\n-  if (type == SymbolicExprType::kConstant ||\n-      type == SymbolicExprType::kVariable) {\n+  if (!IsBinaryOp()) {\n     return *this;\n   }\n \n+  SymbolicExprType type = GetType();\n   SymbolicExpr lhs = GetLHS();\n   SymbolicExpr rhs = GetRHS();\n   SymbolicExpr new_lhs = lhs.Replace(replacements);\n@@ -779,12 +784,11 @@ SymbolicExpr SymbolicExpr::Canonicalize() const {\n     return *this;\n   }\n \n-  SymbolicExprType type = GetType();\n-  if (type == SymbolicExprType::kConstant ||\n-      type == SymbolicExprType::kVariable) {\n+  if (!IsBinaryOp()) {\n     return *this;\n   }\n \n+  SymbolicExprType type = GetType();\n   SymbolicExpr lhs = this->GetLHS().Canonicalize();\n   SymbolicExpr rhs = this->GetRHS().Canonicalize();\n "
        },
        {
            "sha": "ffb8269d62fc3f69fcb23e4ffda1a97ad086fff5",
            "filename": "third_party/xla/xla/hlo/analysis/symbolic_expr.h",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f73a95490618257a100fbde24f5b568b5630aad9/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fsymbolic_expr.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f73a95490618257a100fbde24f5b568b5630aad9/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fsymbolic_expr.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fsymbolic_expr.h?ref=f73a95490618257a100fbde24f5b568b5630aad9",
            "patch": "@@ -65,6 +65,7 @@ class SymbolicExpr {\n \n   SymbolicExprContext* GetContext() const;\n   SymbolicExprType GetType() const;\n+  bool IsBinaryOp() const;\n   SymbolicExpr GetLHS() const;\n   SymbolicExpr GetRHS() const;\n   int64_t GetValue() const;"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 11,
        "deletions": 6
    }
}