{
    "author": "tensorflower-gardener",
    "message": "Correctly set dnn_version in device_description when parsing from proto.\n\nRemoving the setting from the other 2 places as it is no longer necessary.\n\nPiperOrigin-RevId: 822533070",
    "sha": "3cc86433e3d1900d01ccf8777e2a47ed052ecc8f",
    "files": [
        {
            "sha": "790f68ea9a4c81bd773afafb7a0545e3d5b68fae",
            "filename": "third_party/xla/xla/service/compiler.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cc86433e3d1900d01ccf8777e2a47ed052ecc8f/third_party%2Fxla%2Fxla%2Fservice%2Fcompiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cc86433e3d1900d01ccf8777e2a47ed052ecc8f/third_party%2Fxla%2Fxla%2Fservice%2Fcompiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcompiler.cc?ref=3cc86433e3d1900d01ccf8777e2a47ed052ecc8f",
            "patch": "@@ -68,6 +68,11 @@ absl::StatusOr<Compiler::TargetConfig> Compiler::TargetConfig::FromProto(\n                                       proto.runtime_version().minor(),\n                                       proto.runtime_version().patch());\n   target_config.device_description.set_runtime_version(runtime_version);\n+  se::SemanticVersion dnn_version(\n+      static_cast<unsigned>(proto.dnn_version_info().major()),\n+      static_cast<unsigned>(proto.dnn_version_info().minor()),\n+      static_cast<unsigned>(proto.dnn_version_info().patch()));\n+  target_config.device_description.set_dnn_version(dnn_version);\n   return target_config;\n }\n "
        },
        {
            "sha": "a11da2525df1a3f0c545d671960c2ec62b88653d",
            "filename": "third_party/xla/xla/service/gpu/autotuning/autotuner_pass.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 7,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cc86433e3d1900d01ccf8777e2a47ed052ecc8f/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fautotuning%2Fautotuner_pass.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cc86433e3d1900d01ccf8777e2a47ed052ecc8f/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fautotuning%2Fautotuner_pass.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fautotuning%2Fautotuner_pass.cc?ref=3cc86433e3d1900d01ccf8777e2a47ed052ecc8f",
            "patch": "@@ -102,17 +102,11 @@ absl::StatusOr<std::unique_ptr<AutotunerPass>> AutotunerPass::Create(\n                                    GetProfileOptions(debug_options), allocator);\n   }\n \n-  se::DeviceDescription device_description = target_config->device_description;\n-  device_description.set_dnn_version(\n-      {static_cast<unsigned>(target_config->dnn_version_info.major_version()),\n-       static_cast<unsigned>(target_config->dnn_version_info.minor_version()),\n-       static_cast<unsigned>(target_config->dnn_version_info.patch())});\n-\n   std::unique_ptr<AutotunerCacheInterface> cache =\n       std::make_unique<LegacyCache>(\n           debug_options.xla_gpu_experimental_autotuner_cache_dir(),\n           debug_options.xla_gpu_experimental_autotune_cache_mode(),\n-          device_description);\n+          target_config->device_description);\n \n   TF_ASSIGN_OR_RETURN(\n       std::unique_ptr<Autotuner> autotuner,"
        },
        {
            "sha": "5d4ad76127592408dbcc3434f96386312d9b2ced",
            "filename": "third_party/xla/xla/service/gpu/gpu_compiler.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 9,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cc86433e3d1900d01ccf8777e2a47ed052ecc8f/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fgpu_compiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cc86433e3d1900d01ccf8777e2a47ed052ecc8f/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fgpu_compiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fgpu_compiler.cc?ref=3cc86433e3d1900d01ccf8777e2a47ed052ecc8f",
            "patch": "@@ -366,15 +366,8 @@ DeviceOrDevicelessConfig GetDeviceConfig(\n     return DeviceOrDevicelessConfig{\n         DeviceConfig{stream_exec, options.device_allocator}};\n   }\n-  se::DeviceDescription device_description =\n-      gpu_target_config.device_description;\n-  device_description.set_dnn_version(\n-      {static_cast<unsigned>(\n-           gpu_target_config.dnn_version_info.major_version()),\n-       static_cast<unsigned>(\n-           gpu_target_config.dnn_version_info.minor_version()),\n-       static_cast<unsigned>(gpu_target_config.dnn_version_info.patch())});\n-  return DeviceOrDevicelessConfig{DevicelessConfig{device_description}};\n+  return DeviceOrDevicelessConfig{\n+      DevicelessConfig{gpu_target_config.device_description}};\n }\n \n se::GpuComputeCapability GetGpuVersion(const se::StreamExecutor* stream_exec) {"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 8,
        "deletions": 16
    }
}