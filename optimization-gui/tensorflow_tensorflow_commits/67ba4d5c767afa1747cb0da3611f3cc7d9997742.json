{
    "author": "cerisier",
    "message": "PR #34320: Migrate from native built-ins to Starlark rule definitions\n\nImported from GitHub PR https://github.com/openxla/xla/pull/34320\n\nüìù Summary of Changes\n\n- Replaces all occurrences of native.rule by their starlark version.\n- Add missing load statements where native rules were implicit.\n\nüéØ Justification\n\nThis is a preparation PR for Bazel 9 where implicits must be loaded from starlark.\n\nüöÄ Kind of Contribution\nPlease remove what does not apply: üêõ Bug Fix, ‚ö°Ô∏è Performance Improvement,\n‚ú® New Feature, ‚ôªÔ∏è Cleanup, üìö Documentation, üß™ Tests\n\nCopybara import of the project:\n\n--\n08d48174ab45858d7a16df9cfe43fea13d6366f7 by Corentin Kerisit <corentin.kerisit@gmail.com>:\n\nMove all remaining native.* rules to their loaded equivalent\n\n--\n3dc798cfe9bed6c0094c8a618b8004cb497ee5e1 by Corentin Kerisit <corentin.kerisit@gmail.com>:\n\nUse rules_java that uses same abseil-cpp version\n\nin latest rules_java, abseil-cpp is bumped and local patches\ndo not apply anymore.\n\nMerging this change closes #34320\n\nPiperOrigin-RevId: 842743151",
    "sha": "67ba4d5c767afa1747cb0da3611f3cc7d9997742",
    "files": [
        {
            "sha": "0aa63a6b4b78f5e8237c7fdf16dcb823390821ec",
            "filename": "third_party/xla/MODULE.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2FMODULE.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2FMODULE.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2FMODULE.bazel?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -22,6 +22,7 @@ bazel_dep(name = \"pybind11_bazel\", version = \"2.13.6\")\n bazel_dep(name = \"pybind11_protobuf\", version = \"0.0.0-20250210-f02a2b7\")\n bazel_dep(name = \"re2\", version = \"2024-07-02.bcr.1\", repo_name = \"com_googlesource_code_re2\")\n bazel_dep(name = \"rules_cc\", version = \"0.2.0\")\n+bazel_dep(name = \"rules_java\", version = \"8.16.1\")\n bazel_dep(name = \"rules_license\", version = \"1.0.0\")\n bazel_dep(name = \"rules_python\", version = \"1.6.0\")\n bazel_dep(name = \"rules_shell\", version = \"0.6.1\")"
        },
        {
            "sha": "79a571ba22ace1ea3195f3aac092df116b9abbfa",
            "filename": "third_party/xla/build_tools/ci/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fbuild_tools%2Fci%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fbuild_tools%2Fci%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fci%2FBUILD?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -14,6 +14,7 @@\n # ============================================================================\n \n load(\"@bazel_skylib//rules:diff_test.bzl\", \"diff_test\")\n+load(\"@rules_shell//shell:sh_binary.bzl\", \"sh_binary\")\n load(\"//xla:pytype.bzl\", \"pytype_strict_binary\")\n \n package("
        },
        {
            "sha": "b9adc77a1690e8f79a34f1ae3da97dbda740fb15",
            "filename": "third_party/xla/build_tools/pjrt_wheels/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -1,6 +1,8 @@\n load(\"@cuda_cudart//:version.bzl\", cuda_major_version = \"VERSION\")\n load(\"@nightly_timestamp//:timestamp.bzl\", \"XLA_NIGHTLY_TIMESTAMP\")\n load(\"@rc_number//:rc_number.bzl\", \"XLA_RC_NUMBER\")\n+load(\"@rules_cc//cc:cc_binary.bzl\", \"cc_binary\")\n+load(\"@rules_cc//cc:cc_test.bzl\", \"cc_test\")\n load(\"@rules_python//python:packaging.bzl\", \"py_wheel\")\n \n # This ensures we can only build plugins for selected CUDA versions."
        },
        {
            "sha": "e9da7383842473872bfabf1d790a527aa13071e8",
            "filename": "third_party/xla/third_party/gpus/crosstool/cc_toolchain_config.bzl.tpl",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcrosstool%2Fcc_toolchain_config.bzl.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcrosstool%2Fcc_toolchain_config.bzl.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcrosstool%2Fcc_toolchain_config.bzl.tpl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -16,6 +16,7 @@ load(\n     \"with_feature_set\",\n )\n load(\"@bazel_tools//tools/build_defs/cc:action_names.bzl\", \"ACTION_NAMES\")\n+load(\"@rules_cc//cc/toolchains:cc_toolchain_config_info.bzl\", \"CcToolchainConfigInfo\")\n \n def all_assembly_actions():\n     return ["
        },
        {
            "sha": "a97202d8e9fb61a72bf6a8424c33afa747a6a2ca",
            "filename": "third_party/xla/third_party/gpus/crosstool/hipcc_cc_toolchain_config.bzl.tpl",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcrosstool%2Fhipcc_cc_toolchain_config.bzl.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcrosstool%2Fhipcc_cc_toolchain_config.bzl.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcrosstool%2Fhipcc_cc_toolchain_config.bzl.tpl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -11,6 +11,7 @@ load(\n     \"with_feature_set\",\n )\n load(\"@bazel_tools//tools/build_defs/cc:action_names.bzl\", \"ACTION_NAMES\")\n+load(\"@rules_cc//cc/toolchains:cc_toolchain_config_info.bzl\", \"CcToolchainConfigInfo\")\n \n all_compile_actions = [\n     ACTION_NAMES.c_compile,"
        },
        {
            "sha": "e754300e3dbc9dccca771f1b0fd22960cf27b5bf",
            "filename": "third_party/xla/third_party/gpus/crosstool/sycl_cc_toolchain_config.bzl.tpl",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcrosstool%2Fsycl_cc_toolchain_config.bzl.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcrosstool%2Fsycl_cc_toolchain_config.bzl.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcrosstool%2Fsycl_cc_toolchain_config.bzl.tpl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -16,6 +16,7 @@ load(\n     \"with_feature_set\",\n )\n load(\"@bazel_tools//tools/build_defs/cc:action_names.bzl\", \"ACTION_NAMES\")\n+load(\"@rules_cc//cc/toolchains:cc_toolchain_config_info.bzl\", \"CcToolchainConfigInfo\")\n \n def all_assembly_actions():\n     return ["
        },
        {
            "sha": "3ee6d2d348b2fc4377b3a3ff051a5de9b951834e",
            "filename": "third_party/xla/third_party/gpus/cuda/build_defs.bzl.tpl",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcuda%2Fbuild_defs.bzl.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcuda%2Fbuild_defs.bzl.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcuda%2Fbuild_defs.bzl.tpl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -1,3 +1,5 @@\n+load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+\n # Macros for building CUDA code.\n def if_cuda(if_true, if_false = []):\n     \"\"\"Shorthand for select()'ing on whether we're building with CUDA.\n@@ -137,7 +139,7 @@ def cuda_header_library(\n     target without virtual includes. This works around the fact that bazel can't\n     mix 'includes' and 'include_prefix' in the same target.\"\"\"\n \n-    native.cc_library(\n+    cc_library(\n         name = name + \"_virtual\",\n         hdrs = hdrs,\n         include_prefix = include_prefix,\n@@ -146,7 +148,7 @@ def cuda_header_library(\n         visibility = [\"//visibility:private\"],\n     )\n \n-    native.cc_library(\n+    cc_library(\n         name = name,\n         textual_hdrs = hdrs,\n         deps = deps + [\":%s_virtual\" % name],\n@@ -160,7 +162,7 @@ def cuda_library(copts = [], tags = [], deps = [], **kwargs):\n     # \"use of the \"register\" storage class specifier is not allowed\" error.\n     # This can and should be removed once we migrate on glibc-2.27 or newer.\n     local_defines = kwargs.pop(\"local_defines\", []) + [\"register=\"]\n-    native.cc_library(\n+    cc_library(\n         copts = cuda_default_copts() + copts,\n         tags = tags + [\n             \"gpu\","
        },
        {
            "sha": "d04a045907f274e66727379e96e8953dbb682bc8",
            "filename": "third_party/xla/third_party/gpus/rocm/build_defs.bzl.tpl",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Frocm%2Fbuild_defs.bzl.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Frocm%2Fbuild_defs.bzl.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fgpus%2Frocm%2Fbuild_defs.bzl.tpl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -1,3 +1,5 @@\n+load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+\n # Macros for building ROCm code.\n def if_rocm(if_true, if_false = []):\n     \"\"\"Shorthand for select()'ing on whether we're building with ROCm.\n@@ -80,7 +82,7 @@ def rocm_library(copts = [], deps = [], **kwargs):\n     \"\"\"Wrapper over cc_library which adds default ROCm options.\"\"\"\n     if \"@local_config_rocm//rocm:rocm_headers\" not in deps:\n       deps.append(\"@local_config_rocm//rocm:rocm_headers\")\n-    native.cc_library(copts = rocm_default_copts() + copts, deps = deps, **kwargs)\n+    cc_library(copts = rocm_default_copts() + copts, deps = deps, **kwargs)\n \n def get_rbe_amdgpu_pool(is_single_gpu = False):\n     return \"%{single_gpu_rbe_pool}\" if is_single_gpu else \"%{multi_gpu_rbe_pool}\""
        },
        {
            "sha": "debfd5d27639f78ba8574220ccc2db5ec982448d",
            "filename": "third_party/xla/third_party/gpus/sycl/build_defs.bzl.tpl",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fsycl%2Fbuild_defs.bzl.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fgpus%2Fsycl%2Fbuild_defs.bzl.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fgpus%2Fsycl%2Fbuild_defs.bzl.tpl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -1,3 +1,5 @@\n+load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+\n # Macros for building SYCL code.\n def if_sycl(if_true, if_false = []):\n     \"\"\"Shorthand for select()'ing on whether we're building with SYCL.\n@@ -40,7 +42,7 @@ def if_sycl_build_is_configured(x, y):\n \n def sycl_library(copts = [], linkopts = [], tags = [], deps = [], **kwargs):\n     \"\"\"Wrapper over cc_library which adds default SYCL options.\"\"\"\n-    native.cc_library(copts = sycl_default_copts() + copts,\n+    cc_library(copts = sycl_default_copts() + copts,\n                       linkopts = sycl_default_linkopts() + linkopts,\n                       tags = tags + [\"gpu\"],\n                       deps = deps + if_sycl_is_configured(["
        },
        {
            "sha": "1cb7282ea89d71b1d74da0da4ee6a0ba6829f56e",
            "filename": "third_party/xla/third_party/implib_so/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fimplib_so%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fimplib_so%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fimplib_so%2FBUILD.bazel?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -1,3 +1,5 @@\n+load(\"@rules_python//python:defs.bzl\", \"py_binary\")\n+\n package(default_visibility = [\"//visibility:public\"])\n \n licenses([\"notice\"])  # MIT"
        },
        {
            "sha": "15f0218bf2f6a25a8b7c8c880a20d260e5f8de1b",
            "filename": "third_party/xla/third_party/llvm_openmp/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fllvm_openmp%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fllvm_openmp%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fllvm_openmp%2FBUILD.bazel?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -17,6 +17,7 @@ load(\n     \"if_macos\",\n     \"if_windows\",\n )\n+load(\"@rules_python//python:defs.bzl\", \"py_binary\")\n \n package(\n     default_visibility = ["
        },
        {
            "sha": "ad447657d907a2ef6af963822c296ed137dc3e3c",
            "filename": "third_party/xla/third_party/nccl/build_defs.bzl.tpl",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fnccl%2Fbuild_defs.bzl.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fnccl%2Fbuild_defs.bzl.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fnccl%2Fbuild_defs.bzl.tpl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -2,6 +2,7 @@\n \n load(\"@local_config_cuda//cuda:build_defs.bzl\", \"cuda_default_copts\", \"cuda_gpu_architectures\")\n load(\"@bazel_tools//tools/cpp:toolchain_utils.bzl\", \"find_cpp_toolchain\")\n+load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n \n # CUDA toolkit version as tuple (e.g. '(11, 1)').\n _cuda_version = %{cuda_version}\n@@ -311,7 +312,7 @@ def cuda_rdc_library(name, hdrs = None, copts = None, linkstatic = True, **kwarg\n \n     # Compile host and device code into library.\n     lib = name + \"_lib\"\n-    native.cc_library(\n+    cc_library(\n         name = lib,\n         hdrs = hdrs,\n         copts = _rdc_copts() + copts,\n@@ -336,7 +337,7 @@ def cuda_rdc_library(name, hdrs = None, copts = None, linkstatic = True, **kwarg\n \n     # Compile the source file into a library.\n     dlink = name + \"_dlink\"\n-    native.cc_library(\n+    cc_library(\n         name = dlink,\n         srcs = [dlink_cc],\n         textual_hdrs = [dlink_hdrs],\n@@ -371,7 +372,7 @@ def cuda_rdc_library(name, hdrs = None, copts = None, linkstatic = True, **kwarg\n     )\n \n     # Create cc target from archive.\n-    native.cc_library(\n+    cc_library(\n         name = name,\n         srcs = [merged],\n         hdrs = hdrs,"
        },
        {
            "sha": "a8e181e57b1932bf389a360eae5a9a6041fa139e",
            "filename": "third_party/xla/third_party/nvtx/BUILD.bazel",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fnvtx%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Fnvtx%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fnvtx%2FBUILD.bazel?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -1,5 +1,7 @@\n # NVIDIA NVTX 3\n \n+load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+\n licenses([\"notice\"])\n \n exports_files([\"LICENSE.txt\"])"
        },
        {
            "sha": "45a8d0a78aa78cdb9c83899d571ee4f0163402d6",
            "filename": "third_party/xla/third_party/tensorrt/plugin/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Ftensorrt%2Fplugin%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fthird_party%2Ftensorrt%2Fplugin%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Ftensorrt%2Fplugin%2FBUILD.bazel?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -2,6 +2,7 @@\n # This package contains build targets for select TensorRT plugins included in the\n # TensorRT open source repository.\n load(\"@local_config_cuda//cuda:build_defs.bzl\", \"cuda_default_copts\", \"cuda_library\")\n+load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n \n exports_files([\"LICENSE\"])\n "
        },
        {
            "sha": "4b8fb550b7de97e04d97fed7f028c18db095ad47",
            "filename": "third_party/xla/xla/service/gpu/build_defs.bzl",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fbuild_defs.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fbuild_defs.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fbuild_defs.bzl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -2,6 +2,7 @@\n \"\"\"\n \n load(\"@bazel_skylib//lib:paths.bzl\", \"paths\")\n+load(\"@rules_shell//shell:sh_test.bzl\", \"sh_test\")\n load(\"//xla/tests:build_defs.bzl\", \"prepare_gpu_backend_data\")\n load(\"//xla/tsl:package_groups.bzl\", \"DEFAULT_LOAD_VISIBILITY\")\n \n@@ -147,7 +148,7 @@ def gen_gpu_hlo_compile_tests(\n         ]\n \n         for backend in backends:\n-            native.sh_test(\n+            sh_test(\n                 name = \"gpu_compile_%s_%s_hlo_test\" % (filename, backend),\n                 srcs = [name + \"_gensh\"],\n                 args = ["
        },
        {
            "sha": "36b349fc0afbb228da14a6f1a946c24a96a41a34",
            "filename": "third_party/xla/xla/tsl/mkl/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fxla%2Ftsl%2Fmkl%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fxla%2Ftsl%2Fmkl%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fmkl%2FBUILD.bazel?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -1,6 +1,7 @@\n load(\"@bazel_skylib//:bzl_library.bzl\", \"bzl_library\")\n load(\"@local_xla//xla/tsl:tsl.bzl\", \"clean_dep\")\n load(\"@local_xla//xla/tsl/mkl:build_defs.bzl\", \"mkl_dep\")\n+load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n \n licenses([\"notice\"])  # 3-Clause BSD\n "
        },
        {
            "sha": "a9b14ee112367108ce0508a2ca49561e0fbb6d2f",
            "filename": "third_party/xla/xla/tsl/platform/default/build_config.bzl",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fbuild_config.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fbuild_config.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fbuild_config.bzl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -6,6 +6,7 @@\n load(\"@com_github_grpc_grpc//bazel:cc_grpc_library.bzl\", \"cc_grpc_library\")\n load(\"@com_github_grpc_grpc//bazel:python_rules.bzl\", \"py_grpc_library\")\n load(\"@com_google_protobuf//bazel:cc_proto_library.bzl\", \"cc_proto_library\")\n+load(\"@com_google_protobuf//bazel:proto_library.bzl\", \"proto_library\")\n load(\"@com_google_protobuf//bazel:py_proto_library.bzl\", \"py_proto_library\")\n load(\"@rules_cc//cc:cc_binary.bzl\", \"cc_binary\")\n load(\"@rules_cc//cc:cc_test.bzl\", _cc_test = \"cc_test\")\n@@ -228,7 +229,7 @@ def tf_proto_library(\n         name_sans_proto = name[:-6]\n     else:\n         name_sans_proto = name\n-    native.proto_library(\n+    proto_library(\n         name = name,\n         srcs = srcs,\n         deps = deps + protodeps + ["
        },
        {
            "sha": "51dd87ab1c9920ab8ba9373e6ec210ccbff71a47",
            "filename": "third_party/xla/xla/tsl/platform/default/rules_cc.bzl",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Frules_cc.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/67ba4d5c767afa1747cb0da3611f3cc7d9997742/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Frules_cc.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Frules_cc.bzl?ref=67ba4d5c767afa1747cb0da3611f3cc7d9997742",
            "patch": "@@ -3,19 +3,18 @@\n # This file is used in OSS only. It is not transformed by copybara. Therefore all paths in this\n # file are OSS paths.\n \n+load(\"@rules_cc//cc:cc_binary.bzl\", _cc_binary = \"cc_binary\")\n+load(\"@rules_cc//cc:cc_import.bzl\", _cc_import = \"cc_import\")\n load(\"@rules_cc//cc:cc_library.bzl\", _cc_library = \"cc_library\")\n+load(\"@rules_cc//cc:cc_shared_library.bzl\", _cc_shared_library = \"cc_shared_library\")\n+load(\"@rules_cc//cc:cc_test.bzl\", _cc_test = \"cc_test\")\n \n # IMPORTANT: Do not remove this load statement. We rely on that //xla/tsl doesn't exist in g3\n # to prevent g3 .bzl files from loading this file.\n load(\"//xla/tsl:package_groups.bzl\", \"DEFAULT_LOAD_VISIBILITY\")\n \n visibility(DEFAULT_LOAD_VISIBILITY)\n \n-_cc_binary = native.cc_binary\n-_cc_import = native.cc_import\n-_cc_shared_library = native.cc_shared_library\n-_cc_test = native.cc_test\n-\n cc_binary = _cc_binary\n cc_import = _cc_import\n cc_shared_library = _cc_shared_library\n@@ -27,7 +26,7 @@ def cc_library(name, deps = None, **kwargs):\n     Args:\n       name: name of target.\n       deps: deps with `xla/tsl:bazel_issue_21519` added.\n-      **kwargs: passed to native.cc_library.\n+      **kwargs: passed to cc_library.\n     \"\"\"\n \n     if deps == None:"
        }
    ],
    "stats": {
        "total": 54,
        "additions": 38,
        "deletions": 16
    }
}