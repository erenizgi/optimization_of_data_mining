{
    "author": "tensorflower-gardener",
    "message": "[XLA:GPU] Add BlackwellPro cuda compute capability\n\nPiperOrigin-RevId: 811474852",
    "sha": "0fae4523e39832cf09ef3d3251f9a7168ada1253",
    "files": [
        {
            "sha": "0d45e0cdb801f954089b7df1d0422f73bb48060c",
            "filename": "third_party/xla/xla/stream_executor/cuda/cuda_compute_capability.h",
            "status": "modified",
            "additions": 24,
            "deletions": 1,
            "changes": 25,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/0fae4523e39832cf09ef3d3251f9a7168ada1253/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_compute_capability.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/0fae4523e39832cf09ef3d3251f9a7168ada1253/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_compute_capability.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_compute_capability.h?ref=0fae4523e39832cf09ef3d3251f9a7168ada1253",
            "patch": "@@ -69,7 +69,8 @@ struct CudaComputeCapability {\n     kVolta = 7,\n     kAmpere = 8,\n     kHopper = 9,\n-    kBlackwell = 10\n+    kBlackwell = 10,\n+    kBlackwellPro = 12\n   };\n \n   constexpr CudaComputeCapability() = default;\n@@ -137,6 +138,20 @@ struct CudaComputeCapability {\n                                  FeatureExtension::kForwardCompatibleFeatures};\n   }\n \n+  // Includes all GPUs with compute capability 12.x. When comparing with\n+  // `IsAtLeast` this will true for all compute capabilities of 12.0 or higher.\n+  constexpr static CudaComputeCapability BlackwellPro() {\n+    return CudaComputeCapability{kBlackwellPro, 0, FeatureExtension::kNone};\n+  }\n+\n+  // Includes all GPUs with compute capability 12.x. When comparing with\n+  // `IsAtLeast` this will true for all 12.x compute capabilities but not for\n+  // compute capabilities with a higher major version.\n+  constexpr static CudaComputeCapability BlackwellProGenerationOnly() {\n+    return CudaComputeCapability{kBlackwellPro, 0,\n+                                 FeatureExtension::kForwardCompatibleFeatures};\n+  }\n+\n   // Returns true if the compute capability is at least\n   // `other_major.other_minor`. It is equivalent to\n   // this->SupportsAllFeaturesOf(CudaComputeCapability{other_major,\n@@ -168,6 +183,10 @@ struct CudaComputeCapability {\n     return major >= CudaComputeCapabilities::kBlackwell;\n   }\n \n+  bool IsAtLeastBlackwellPro() const {\n+    return major >= CudaComputeCapabilities::kBlackwellPro;\n+  }\n+\n   bool IsPascal() const { return major == CudaComputeCapabilities::kPascal; }\n \n   bool IsVolta() const { return major == CudaComputeCapabilities::kVolta; }\n@@ -185,6 +204,10 @@ struct CudaComputeCapability {\n     return major == CudaComputeCapabilities::kBlackwell;\n   }\n \n+  bool IsBlackwellPro() const {\n+    return major == CudaComputeCapabilities::kBlackwellPro;\n+  }\n+\n   // Returns true if a kernel compiled for compute capability `other` can be run\n   // on a GPU with compute capability `this`.\n   bool SupportsAllFeaturesOf(const CudaComputeCapability& other) const {"
        },
        {
            "sha": "2920d7713d4c8779fde96b94ec6e8cbc5e42beb0",
            "filename": "third_party/xla/xla/stream_executor/cuda/cuda_compute_capability_test.cc",
            "status": "modified",
            "additions": 67,
            "deletions": 0,
            "changes": 67,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/0fae4523e39832cf09ef3d3251f9a7168ada1253/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_compute_capability_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/0fae4523e39832cf09ef3d3251f9a7168ada1253/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_compute_capability_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_compute_capability_test.cc?ref=0fae4523e39832cf09ef3d3251f9a7168ada1253",
            "patch": "@@ -143,6 +143,73 @@ TEST(CudaComputeCapabilityTest, FromProtoWithFeatureExtensionUnspecified) {\n   EXPECT_EQ(cc.major, 10);\n   EXPECT_EQ(cc.minor, 2);\n   EXPECT_EQ(cc.feature_extension, FeatureExtension::kAcceleratedFeatures);\n+\n+  proto.set_major(12);\n+  proto.set_minor(0);\n+  TF_ASSERT_OK_AND_ASSIGN(cc, CudaComputeCapability::FromProto(proto));\n+  EXPECT_EQ(cc.major, 12);\n+  EXPECT_EQ(cc.minor, 0);\n+  EXPECT_NE(cc.feature_extension, FeatureExtension::kAcceleratedFeatures);\n+}\n+\n+TEST(CudaComputeCapabilityTest, IsAtLeastMethods) {\n+  using FeatureExtension = CudaComputeCapability::FeatureExtension;\n+\n+  // IsAtLeastVolta (sm_75)\n+  EXPECT_TRUE(CudaComputeCapability(7, 0).IsAtLeastVolta());\n+  EXPECT_TRUE(CudaComputeCapability(7, 4).IsAtLeastVolta());\n+  EXPECT_TRUE(CudaComputeCapability(7, 5).IsAtLeastVolta());\n+  EXPECT_TRUE(\n+      CudaComputeCapability(7, 5, FeatureExtension::kAcceleratedFeatures)\n+          .IsAtLeastVolta());\n+  EXPECT_TRUE(CudaComputeCapability(8, 0).IsAtLeastVolta());\n+\n+  // IsAtLeastAmpere (sm_80)\n+  EXPECT_FALSE(CudaComputeCapability(7, 5).IsAtLeastAmpere());\n+  EXPECT_FALSE(\n+      CudaComputeCapability(7, 5, FeatureExtension::kForwardCompatibleFeatures)\n+          .IsAtLeastAmpere());\n+  EXPECT_TRUE(CudaComputeCapability(8, 0).IsAtLeastAmpere());\n+  EXPECT_TRUE(\n+      CudaComputeCapability(8, 0, FeatureExtension::kAcceleratedFeatures)\n+          .IsAtLeastAmpere());\n+  EXPECT_TRUE(CudaComputeCapability(8, 6).IsAtLeastAmpere());\n+  EXPECT_TRUE(CudaComputeCapability(9, 0).IsAtLeastAmpere());\n+\n+  // IsAtLeastHopper (sm_90)\n+  EXPECT_FALSE(CudaComputeCapability(8, 9).IsAtLeastHopper());\n+  EXPECT_TRUE(CudaComputeCapability(9, 0).IsAtLeastHopper());\n+  EXPECT_TRUE(\n+      CudaComputeCapability(9, 0, FeatureExtension::kAcceleratedFeatures)\n+          .IsAtLeastHopper());\n+  EXPECT_TRUE(CudaComputeCapability(9, 1).IsAtLeastHopper());\n+  EXPECT_TRUE(CudaComputeCapability(10, 0).IsAtLeastHopper());\n+\n+  // IsAtLeastBlackwell (sm_100)\n+  EXPECT_FALSE(CudaComputeCapability(9, 0).IsAtLeastBlackwell());\n+  EXPECT_FALSE(\n+      CudaComputeCapability(9, 0, FeatureExtension::kForwardCompatibleFeatures)\n+          .IsAtLeastBlackwell());\n+  EXPECT_TRUE(CudaComputeCapability(10, 0).IsAtLeastBlackwell());\n+  EXPECT_TRUE(\n+      CudaComputeCapability(10, 0, FeatureExtension::kAcceleratedFeatures)\n+          .IsAtLeastBlackwell());\n+  EXPECT_TRUE(CudaComputeCapability(10, 1).IsAtLeastBlackwell());\n+\n+  // IsAtLeastBlackwellPro (sm_120)\n+  EXPECT_FALSE(CudaComputeCapability(11, 0).IsAtLeastBlackwellPro());\n+  EXPECT_FALSE(\n+      CudaComputeCapability(11, 0, FeatureExtension::kForwardCompatibleFeatures)\n+          .IsAtLeastBlackwellPro());\n+  EXPECT_TRUE(CudaComputeCapability(12, 0).IsAtLeastBlackwellPro());\n+  EXPECT_TRUE(\n+      CudaComputeCapability(12, 0, FeatureExtension::kAcceleratedFeatures)\n+          .IsAtLeastBlackwellPro());\n+  EXPECT_TRUE(CudaComputeCapability(12, 0).IsAtLeastBlackwellPro());\n+  EXPECT_TRUE(CudaComputeCapability(12, 0).IsAtLeastBlackwellPro());\n+  EXPECT_TRUE(\n+      CudaComputeCapability(12, 0, FeatureExtension::kForwardCompatibleFeatures)\n+          .IsAtLeastBlackwellPro());\n }\n \n TEST(CudaComputeCapabilityTest, FromProtoWithFeatureExtensionSpecified) {"
        }
    ],
    "stats": {
        "total": 92,
        "additions": 91,
        "deletions": 1
    }
}