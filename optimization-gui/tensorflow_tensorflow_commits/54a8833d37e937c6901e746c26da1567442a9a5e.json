{
    "author": "ybaturina",
    "message": "Add XLA Windows presubmit job to XLA repo.\n\nPiperOrigin-RevId: 838868069",
    "sha": "54a8833d37e937c6901e746c26da1567442a9a5e",
    "files": [
        {
            "sha": "daafda6979df76cfd702af3be68edce61d8fce13",
            "filename": "third_party/xla/.github/workflows/ci.yml",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2F.github%2Fworkflows%2Fci.yml",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2F.github%2Fworkflows%2Fci.yml",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2F.github%2Fworkflows%2Fci.yml?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -48,6 +48,12 @@ jobs:\n             name: \"XLA Linux x86 CPU\",\n             repo: \"openxla/xla\",\n           },\n+          {\n+            pool: \"windows-x86-n2-16\",\n+            container: null,\n+            name: \"XLA Windows x86 CPU\",\n+            repo: \"openxla/xla\",\n+          },\n           {\n             pool: \"linux-x86-n2-16\",\n             container: \"us-docker.pkg.dev/ml-oss-artifacts-published/ml-public-container/ml-build:latest\","
        },
        {
            "sha": "afc722b92e94a9f7b0e96d0e699823b7beff41e4",
            "filename": "third_party/xla/build_tools/ci/build.py",
            "status": "modified",
            "additions": 78,
            "deletions": 1,
            "changes": 79,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fbuild_tools%2Fci%2Fbuild.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fbuild_tools%2Fci%2Fbuild.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fci%2Fbuild.py?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -107,6 +107,7 @@ class BuildType(enum.Enum):\n   \"\"\"\n \n   XLA_LINUX_X86_CPU_GITHUB_ACTIONS = enum.auto()\n+  XLA_WINDOWS_X86_CPU_GITHUB_ACTIONS = enum.auto()\n   XLA_LINUX_X86_CPU_BZLMOD_GITHUB_ACTIONS = enum.auto()\n   XLA_LINUX_ARM64_CPU_GITHUB_ACTIONS = enum.auto()\n   XLA_LINUX_X86_GPU_L4_GITHUB_ACTIONS = enum.auto()\n@@ -238,7 +239,10 @@ def commands(self) -> List[List[str]]:\n         self.type_ == BuildType.XLA_MACOS_X86_CPU_KOKORO\n         or self.type_ == BuildType.XLA_MACOS_ARM64_CPU_KOKORO\n     )\n-    windows_build = (self.type_ == BuildType.JAX_WINDOWS_X86_CPU_GITHUB_ACTIONS)\n+    windows_build = (\n+        self.type_ == BuildType.JAX_WINDOWS_X86_CPU_GITHUB_ACTIONS\n+        or self.type_ == BuildType.XLA_WINDOWS_X86_CPU_GITHUB_ACTIONS\n+    )\n     if not (macos_build or windows_build):\n       cmds.append(\n           retry(\n@@ -323,6 +327,79 @@ def nvidia_gpu_build_with_compute_capability(\n     options={**_DEFAULT_BAZEL_OPTIONS, \"//xla/tsl:ci_build\": True},\n )\n \n+windows_x86_tag_filter = (\n+    \"-no_windows\",\n+    \"-no_oss\",\n+    \"-gpu\",\n+    \"-tpu\",\n+    \"-requires-gpu-nvidia\",\n+    \"-requires-gpu-amd\",\n+    \"-requires-gpu-intel\",\n+)\n+\n+Build(\n+    type_=BuildType.XLA_WINDOWS_X86_CPU_GITHUB_ACTIONS,\n+    repo=\"openxla/xla\",\n+    configs=(\n+        \"warnings\",\n+        \"nonccl\",\n+        \"rbe_xla_windows_x86_cpu_2022\",\n+    ),\n+    target_patterns=(\n+        \"//xla/...\",\n+        \"//build_tools/...\",\n+        \"@local_tsl//tsl/...\",\n+        \"-//xla/stream_executor/tpu/...\",\n+        # mpitrampoline and gloo are not windows compatible\n+        \"-//xla/backends/cpu/collectives:gloo_collectives_test\",\n+        \"-//xla/backends/cpu/collectives:mpi_collectives\",\n+        \"-//xla/backends/cpu/collectives:mpi_communicator\",\n+        # ortools is not windows compatible\n+        \"-//xla/hlo/experimental/...\",\n+        # implementation is not windows compatible\n+        \"-//xla/python/transfer/...\",\n+        \"-//xla/backends/profiler/subprocess:subprocess_profiling_session\",\n+        \"-//xla/backends/profiler/subprocess:subprocess_profiling_session_test\",\n+        \"-//xla/backends/profiler/subprocess:subprocess_registry\",\n+        \"-//xla/backends/profiler/subprocess:subprocess_registry_test\",\n+        \"-//xla/tools/benchmarks/utils:generate_benchmark_matrices_cc\",\n+        \"-//xla/tools/benchmarks/utils:generate_benchmark_matrices_main\",\n+        \"-//xla/tools/benchmarks/utils:generate_benchmark_matrices_test\",\n+        # xnnpack is not windows compatible\n+        \"-//xla/backends/cpu/runtime/ynnpack:ynn_fusion_thunk\",\n+        \"-//xla/backends/cpu/runtime/ynnpack:ynn_interop\",\n+        \"-//xla/backends/cpu/runtime/ynnpack:ynn_threadpool\",\n+        # triton is not windows compatible\n+        \"-//xla/backends/gpu/...\",\n+        \"-//xla/codegen/emitters/tests/...\",\n+        \"-//xla/service/gpu/...\",\n+        # undefined symbols\n+        \"-//xla/codegen/xtile/ir/...\",\n+        \"-//xla/codegen/tools:emitters_opt\",\n+        \"-//xla/codegen/emitters/ir/tests/...\",\n+        \"-//xla/codegen/emitters/transforms/tests/...\",\n+        \"-//xla/backends/cpu/codegen/emitters/ir/tests/...\",\n+        \"-//xla/backends/cpu/codegen/emitters/transforms/tests/...\",\n+        \"-//xla/backends/cpu:ynn_emitter\",\n+        \"-//xla/backends/cpu:ynn_support\",\n+        \"-//xla/hlo/transforms/simplifiers:simplify_fp_conversions_test\",\n+        \"-@local_tsl//tsl/platform:net_test\",\n+        # eigen is not windows compatible\n+        \"-//xla/codegen/intrinsic/cpp:eigen_unary_test\",\n+        \"-//xla/codegen/intrinsic/cpp:eigen_unary_ll_generator\",\n+    ),\n+    build_tag_filters=windows_x86_tag_filter,\n+    test_tag_filters=windows_x86_tag_filter,\n+    options={\n+        **_DEFAULT_BAZEL_OPTIONS,\n+        \"//xla/tsl:ci_build\": True,\n+    },\n+    subcommand=\"build\",\n+    startup_options={\n+        \"output_user_root\": \"C:/x\",\n+    },\n+)\n+\n Build(\n     type_=BuildType.XLA_LINUX_X86_CPU_BZLMOD_GITHUB_ACTIONS,\n     repo=\"openxla/xla\","
        },
        {
            "sha": "ea31d2abe5e4983fe234280f5db1886c761ab5b4",
            "filename": "third_party/xla/build_tools/ci/golden_commands.txt",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fbuild_tools%2Fci%2Fgolden_commands.txt",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fbuild_tools%2Fci%2Fgolden_commands.txt",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fci%2Fgolden_commands.txt?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -115,3 +115,7 @@ mkdir -p /Volumes/BuildData/bazel_output\n bazel test --build_tag_filters=-no_oss,-gpu,-no_mac,-mac_excluded,-requires-gpu-nvidia,-requires-gpu-amd,-requires-gpu-intel --test_tag_filters=-no_oss,-gpu,-no_mac,-mac_excluded,-requires-gpu-nvidia,-requires-gpu-amd,-requires-gpu-intel --config=nonccl --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --macos_minimum_os=10.15 --test_tmpdir=/Volumes/BuildData/bazel_output --define=xnn_enable_avxvnniint8=false --//xla/tsl:ci_build -- //xla/... -//xla/hlo/experimental/... -//xla/python_api/... -//xla/python/... -//xla/service/gpu/...\n bazel analyze-profile profile.json.gz\n # END BuildType.XLA_MACOS_X86_CPU_KOKORO\n+# BEGIN BuildType.XLA_WINDOWS_X86_CPU_GITHUB_ACTIONS\n+bazel --output_user_root=C:/x build --build_tag_filters=-no_windows,-no_oss,-gpu,-tpu,-requires-gpu-nvidia,-requires-gpu-amd,-requires-gpu-intel --test_tag_filters=-no_windows,-no_oss,-gpu,-tpu,-requires-gpu-nvidia,-requires-gpu-amd,-requires-gpu-intel --config=warnings --config=nonccl --config=rbe_xla_windows_x86_cpu_2022 --color=yes --test_output=errors --verbose_failures --keep_going --nobuild_tests_only --profile=profile.json.gz --flaky_test_attempts=3 --jobs=150 --bes_upload_mode=fully_async --//xla/tsl:ci_build -- //xla/... //build_tools/... @local_tsl//tsl/... -//xla/stream_executor/tpu/... -//xla/backends/cpu/collectives:gloo_collectives_test -//xla/backends/cpu/collectives:mpi_collectives -//xla/backends/cpu/collectives:mpi_communicator -//xla/hlo/experimental/... -//xla/python/transfer/... -//xla/backends/profiler/subprocess:subprocess_profiling_session -//xla/backends/profiler/subprocess:subprocess_profiling_session_test -//xla/backends/profiler/subprocess:subprocess_registry -//xla/backends/profiler/subprocess:subprocess_registry_test -//xla/tools/benchmarks/utils:generate_benchmark_matrices_cc -//xla/tools/benchmarks/utils:generate_benchmark_matrices_main -//xla/tools/benchmarks/utils:generate_benchmark_matrices_test -//xla/backends/cpu/runtime/ynnpack:ynn_fusion_thunk -//xla/backends/cpu/runtime/ynnpack:ynn_interop -//xla/backends/cpu/runtime/ynnpack:ynn_threadpool -//xla/backends/gpu/... -//xla/codegen/emitters/tests/... -//xla/service/gpu/... -//xla/codegen/xtile/ir/... -//xla/codegen/tools:emitters_opt -//xla/codegen/emitters/ir/tests/... -//xla/codegen/emitters/transforms/tests/... -//xla/backends/cpu/codegen/emitters/ir/tests/... -//xla/backends/cpu/codegen/emitters/transforms/tests/... -//xla/backends/cpu:ynn_emitter -//xla/backends/cpu:ynn_support -//xla/hlo/transforms/simplifiers:simplify_fp_conversions_test -@local_tsl//tsl/platform:net_test -//xla/codegen/intrinsic/cpp:eigen_unary_test -//xla/codegen/intrinsic/cpp:eigen_unary_ll_generator\n+bazel analyze-profile profile.json.gz\n+# END BuildType.XLA_WINDOWS_X86_CPU_GITHUB_ACTIONS"
        },
        {
            "sha": "5848bb71b1c20c7a005c5a5aff37a80f740593cb",
            "filename": "third_party/xla/build_tools/pjrt_wheels/BUILD.bazel",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -136,6 +136,7 @@ cc_test(\n         \"PJRT_PLUGIN_PATH\": \"build_tools/pjrt_wheels/xla_plugins/xla_cpu_pjrt/xla_cpu_pjrt.so\",\n     },\n     linkopts = [\"-ldl\"],\n+    tags = [\"no_windows\"],\n     deps = [\"//xla/pjrt/c:pjrt_c_api_hdrs\"],\n )\n \n@@ -147,19 +148,22 @@ cc_test(\n         \"PJRT_PLUGIN_PATH\": \"build_tools/pjrt_wheels/xla_plugins/xla_\" + cuda_label + \"_pjrt/xla_gpu_pjrt.so\",\n     },\n     linkopts = [\"-ldl\"],\n+    tags = [\"no_windows\"],\n     deps = [\"//xla/pjrt/c:pjrt_c_api_hdrs\"],\n )\n \n # The CPU and CUDA test suites are run in CI's build script\n test_suite(\n     name = \"cpu_test_suite\",\n+    tags = [\"no_windows\"],\n     tests = [\n         \":cpu_smoke_test\",\n     ],\n )\n \n test_suite(\n     name = \"cuda_test_suite\",\n+    tags = [\"no_windows\"],\n     tests = [\n         \":\" + cuda_label + \"_smoke_test\",\n     ],"
        },
        {
            "sha": "d931eb9fdfeab6eff6ca257d4223a668c09b29e1",
            "filename": "third_party/xla/tensorflow.bazelrc",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Ftensorflow.bazelrc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Ftensorflow.bazelrc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Ftensorflow.bazelrc?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -449,6 +449,13 @@ common:windows_x86_cpu_2022 --extra_execution_platforms=\"//tensorflow/tools/tool\n common:windows_x86_cpu_2022 --host_platform=\"//tensorflow/tools/toolchains/win2022:windows_ltsc2022_clang\"\n common:windows_x86_cpu_2022 --platforms=\"//tensorflow/tools/toolchains/win2022:windows_ltsc2022_clang\"\n \n+common:xla_windows_x86_cpu_2022 --config=win_clang_base\n+common:xla_windows_x86_cpu_2022 --crosstool_top=\"//tools/toolchains/win2022/20241118:toolchain\"\n+common:xla_windows_x86_cpu_2022 --extra_toolchains=\"//tools/toolchains/win2022/20241118:cc-toolchain-x64_windows-clang-cl\"\n+common:xla_windows_x86_cpu_2022 --extra_execution_platforms=\"//tools/toolchains/win2022:windows_ltsc2022_clang\"\n+common:xla_windows_x86_cpu_2022 --host_platform=\"//tools/toolchains/win2022:windows_ltsc2022_clang\"\n+common:xla_windows_x86_cpu_2022 --platforms=\"//tools/toolchains/win2022:windows_ltsc2022_clang\"\n+\n # Options to build TensorFlow 1.x or 2.x.\n # TODO(kanglan): Change v2's define to default behavior\n common:v2 --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1\n@@ -557,6 +564,7 @@ common:rbe_win_base --nobuild_runfile_links\n common:rbe_win_base --define=override_eigen_strong_inline=true\n \n common:rbe_windows_x86_cpu_2022 --config=rbe_win_base --config=windows_x86_cpu_2022\n+common:rbe_xla_windows_x86_cpu_2022 --config=rbe_win_base --config=xla_windows_x86_cpu_2022\n \n # END TF REMOTE BUILD EXECUTION OPTIONS\n "
        },
        {
            "sha": "ea7e669f6925a8375e814cb773d559d647b07737",
            "filename": "third_party/xla/third_party/llvm/lit_test.patch",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fthird_party%2Fllvm%2Flit_test.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fthird_party%2Fllvm%2Flit_test.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fllvm%2Flit_test.patch?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -0,0 +1,15 @@\n+diff --git a/utils/bazel/llvm-project-overlay/llvm/lit_test.bzl b/utils/bazel/llvm-project-overlay/llvm/lit_test.bzl\n+index 64528f28492f..a573750d9322 100644\n+--- a/utils/bazel/llvm-project-overlay/llvm/lit_test.bzl\n++++ b/utils/bazel/llvm-project-overlay/llvm/lit_test.bzl\n+@@ -34,7 +34,9 @@ def lit_test(\n+     data = data or []\n+     deps = deps or []\n+     py_test(\n+-        name = name,\n++        # Prevents creation of the files with identical names located in different\n++        # directories on Windows platform.\n++        name = name.replace(\"/\", \"_\"),\n+         srcs = [Label(\"//llvm:lit\")],\n+         main = Label(\"//llvm:utils/lit/lit.py\"),\n+         args = args + [\"-v\"] + [\"$(execpath %s)\" % src for src in srcs],\n\\ No newline at end of file"
        },
        {
            "sha": "4af023574123bb319b4e54dc031f3e68c94bb0c6",
            "filename": "third_party/xla/third_party/llvm/workspace.bzl",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fthird_party%2Fllvm%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fthird_party%2Fllvm%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fllvm%2Fworkspace.bzl?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -22,6 +22,7 @@ def repo(name):\n             \"//third_party/llvm:mathextras.patch\",\n             \"//third_party/llvm:toolchains.patch\",\n             \"//third_party/llvm:zstd.patch\",\n+            \"//third_party/llvm:lit_test.patch\",\n         ],\n         link_files = {\"//third_party/llvm:run_lit.sh\": \"mlir/run_lit.sh\"},\n     )"
        },
        {
            "sha": "90271f0caf8092c0a5aa9b24a5c83450a8e0dab0",
            "filename": "third_party/xla/xla/codegen/intrinsic/cpp/cc_to_llvm_ir.bzl",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fcodegen%2Fintrinsic%2Fcpp%2Fcc_to_llvm_ir.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fcodegen%2Fintrinsic%2Fcpp%2Fcc_to_llvm_ir.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Fintrinsic%2Fcpp%2Fcc_to_llvm_ir.bzl?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -44,7 +44,10 @@ def _cc_ir_header_impl(ctx):\n     )\n \n     # Copy the compiler's output to our declared intermediate file.\n-    temp_ir_output = compilation_outputs[1].pic_objects[0]\n+    if len(compilation_outputs[1].pic_objects) > 0:\n+        temp_ir_output = compilation_outputs[1].pic_objects[0]\n+    else:\n+        temp_ir_output = compilation_outputs[1].objects[0]\n     ctx.actions.run_shell(\n         inputs = [temp_ir_output],\n         outputs = [ir_file],"
        },
        {
            "sha": "9b3f90854d7bb3d4acb9a4e7d86cc1e3daf1eadd",
            "filename": "third_party/xla/xla/hlo/analysis/hlo_replication_analysis.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fhlo_replication_analysis.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fhlo_replication_analysis.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fhlo_replication_analysis.cc?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -15,8 +15,6 @@ limitations under the License.\n \n #include \"xla/hlo/analysis/hlo_replication_analysis.h\"\n \n-#include <unistd.h>\n-\n #include <algorithm>\n #include <cstddef>\n #include <cstdint>"
        },
        {
            "sha": "51035eb4301efb6323434ba319c851c5893c97a1",
            "filename": "third_party/xla/xla/hlo/experimental/auto_sharding/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2FBUILD?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -484,6 +484,7 @@ cc_library(\n     compatible_with = get_compatible_with_libtpu_portable(),\n     deps = [\n         \"@com_google_absl//absl/numeric:int128\",\n+        \"@com_google_absl//absl/random\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\","
        },
        {
            "sha": "0adefdf2c4e6eddd8e5c372d6e0329a05cfd02eb",
            "filename": "third_party/xla/xla/hlo/experimental/auto_sharding/solver.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fsolver.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fsolver.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fsolver.cc?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -18,9 +18,12 @@ limitations under the License.\n \n #include <stdlib.h>\n \n+#include <cstdint>\n #include <iostream>\n #include <optional>\n+#include <random>  // Required for std::seed_seq\n \n+#include \"absl/random/random.h\"\n #include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/str_join.h\"\n@@ -40,12 +43,14 @@ absl::StatusOr<Solution> Solver::Solve(const Problem& problem,\n   const absl::Time start_time = absl::Now();\n   std::optional<TotalCost> best_cost;\n   std::optional<Solution> best_solution;\n-  unsigned int seed = 2025;\n+  std::seed_seq seed_seq({2025});\n+  absl::BitGen gen(seed_seq);\n   while (absl::Now() - start_time < timeout) {\n     Solution solution;\n     solution.reserve(problem.nodes.size());\n     for (const Node& node : problem.nodes) {\n-      solution.push_back(rand_r(&seed) % node.strategies.size());\n+      solution.push_back(\n+          absl::Uniform<uint64_t>(gen, 0, node.strategies.size()));\n     }\n     auto cost = Evaluate(problem, solution);\n     if (!cost.ok() || (best_cost && *best_cost <= *cost)) {"
        },
        {
            "sha": "66fe0909bacbf1e945ba4551efb92c55aae28f1e",
            "filename": "third_party/xla/xla/lit.bzl",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Flit.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Flit.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Flit.bzl?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -342,7 +342,9 @@ def lit_test(\n     _ = py_binary  # @unused\n \n     # copybara:comment_begin(oss-only)\n-    lit_name = \"lit_custom_\" + name\n+    # Prevents creation of the files with identical names located in different\n+    # directories on Windows platform.\n+    lit_name = \"lit_custom_\" + name.replace(\"/\", \"_\")\n     py_binary(\n         name = lit_name,\n         main = \"@llvm-project//llvm:utils/lit/lit.py\","
        },
        {
            "sha": "e301441db591c9eb622e7ea50f345b40c138f145",
            "filename": "third_party/xla/xla/mlir_hlo/tests/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fmlir_hlo%2Ftests%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fmlir_hlo%2Ftests%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fmlir_hlo%2Ftests%2FBUILD?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -27,7 +27,6 @@ package(\n         tags = [\n             \"nomsan\",  # The execution engine doesn't work with msan, see b/248097619.\n         ],\n-        deps = [\"@pypi//lit\"],\n         deps = [\"@pypi//lit\"],  # copybara:comment\n     )\n     for src in glob([\"**/*.mlir\"])"
        },
        {
            "sha": "23c09be1ff87fd3c52303bfaa54f9a23173fa78c",
            "filename": "third_party/xla/xla/pjrt/c_api_client/pjrt_c_api_client_test.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client_test.cc?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -14,8 +14,6 @@ limitations under the License.\n ==============================================================================*/\n #include \"xla/pjrt/c_api_client/pjrt_c_api_client.h\"\n \n-#include <unistd.h>\n-\n #include <array>\n #include <cstddef>\n #include <cstdint>"
        },
        {
            "sha": "6ecd00c18d5f8f8154718f6383cba6cf316ed995",
            "filename": "third_party/xla/xla/service/gpu/kernels/cutlass_gemm.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fkernels%2Fcutlass_gemm.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/54a8833d37e937c6901e746c26da1567442a9a5e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fkernels%2Fcutlass_gemm.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fkernels%2Fcutlass_gemm.cc?ref=54a8833d37e937c6901e746c26da1567442a9a5e",
            "patch": "@@ -21,7 +21,7 @@ limitations under the License.\n \n #include \"xla/tsl/platform/logging.h\"\n \n-#if !defined(PLATFORM_WINDOWS)\n+#if !defined(_WIN32)\n #include <dlfcn.h>\n #endif\n "
        }
    ],
    "stats": {
        "total": 143,
        "additions": 132,
        "deletions": 11
    }
}