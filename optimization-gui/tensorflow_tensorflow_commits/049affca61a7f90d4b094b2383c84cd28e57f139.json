{
    "author": "pifon2a",
    "message": "[XLA:GPU] Move legacy emitters to the codegen/llvm directory.\n\nPiperOrigin-RevId: 837532458",
    "sha": "049affca61a7f90d4b094b2383c84cd28e57f139",
    "files": [
        {
            "sha": "99739bcf36b73270b6cd4cb6c52f726322bf7661",
            "filename": "third_party/xla/xla/backends/gpu/codegen/llvm/BUILD",
            "status": "added",
            "additions": 130,
            "deletions": 0,
            "changes": 130,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2FBUILD?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -0,0 +1,130 @@\n+# LLVM codegen for GPU.\n+load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+load(\"//xla/tsl:tsl.bzl\", \"internal_visibility\")\n+load(\"//xla/tsl:tsl.default.bzl\", \"get_compatible_with_portable\")\n+\n+package_group(\n+    name = \"friends\",\n+    includes = [\n+        \"//xla:friends\",\n+    ],\n+)\n+\n+package(\n+    # copybara:uncomment default_applicable_licenses = [\"//tensorflow:license\"],\n+    default_visibility = internal_visibility([\":friends\"]),\n+    licenses = [\"notice\"],\n+)\n+\n+cc_library(\n+    name = \"ir_emitter\",\n+    srcs = [\n+        \"ir_emitter.cc\",\n+        \"ir_emitter_nested.cc\",\n+    ],\n+    hdrs = [\n+        \"ir_emitter.h\",\n+        \"ir_emitter_nested.h\",\n+    ],\n+    deps = [\n+        \":parallel_loop_emitter\",\n+        \":sort_util\",\n+        \"//xla:literal\",\n+        \"//xla:shape_util\",\n+        \"//xla:status_macros\",\n+        \"//xla:util\",\n+        \"//xla/backends/gpu/codegen:fusion_emitter\",\n+        \"//xla/backends/gpu/runtime:kernel_thunk\",\n+        \"//xla/backends/gpu/runtime:thunk\",\n+        \"//xla/backends/gpu/runtime:thunk_id\",\n+        \"//xla/codegen/emitters:computation_fingerprint\",\n+        \"//xla/codegen/emitters:kernel_arguments\",\n+        \"//xla/hlo/ir:hlo\",\n+        \"//xla/service:buffer_assignment\",\n+        \"//xla/service:elemental_ir_emitter\",\n+        \"//xla/service/gpu:gpu_constants\",\n+        \"//xla/service/gpu:gpu_executable\",\n+        \"//xla/service/gpu:hlo_to_ir_bindings\",\n+        \"//xla/service/gpu:ir_emission_utils\",\n+        \"//xla/service/gpu:ir_emitter_context\",\n+        \"//xla/service/gpu:launch_dimensions\",\n+        \"//xla/service/llvm_ir:buffer_assignment_util\",\n+        \"//xla/service/llvm_ir:fused_ir_emitter\",\n+        \"//xla/service/llvm_ir:ir_array\",\n+        \"//xla/service/llvm_ir:ir_builder_mixin\",\n+        \"//xla/service/llvm_ir:kernel_support_library\",\n+        \"//xla/service/llvm_ir:llvm_util\",\n+        \"//xla/service/llvm_ir:loop_emitter\",\n+        \"//xla/service/llvm_ir:tuple_ops\",\n+        \"//xla/stream_executor:device_description\",\n+        \"//xla/stream_executor/gpu:tma_metadata\",\n+        \"//xla/tsl/platform:errors\",\n+        \"//xla/tsl/platform:statusor\",\n+        \"@com_google_absl//absl/algorithm:container\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/status:statusor\",\n+        \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/strings:str_format\",\n+        \"@com_google_absl//absl/types:span\",\n+        \"@llvm-project//llvm:Core\",\n+        \"@llvm-project//llvm:Support\",\n+        \"@llvm-project//llvm:TargetParser\",\n+        \"@local_tsl//tsl/platform:errors\",\n+        \"@local_tsl//tsl/platform:fingerprint\",\n+        \"@local_tsl//tsl/platform:statusor\",\n+    ],\n+)\n+\n+cc_library(\n+    name = \"sort_util\",\n+    srcs = [\"sort_util.cc\"],\n+    hdrs = [\"sort_util.h\"],\n+    deps = [\n+        \":parallel_loop_emitter\",\n+        \"//xla:shape_util\",\n+        \"//xla:util\",\n+        \"//xla:xla_data_proto_cc\",\n+        \"//xla/service/gpu:ir_emission_utils\",\n+        \"//xla/service/gpu:launch_dimensions\",\n+        \"//xla/service/gpu:target_util\",\n+        \"//xla/service/llvm_ir:ir_array\",\n+        \"//xla/service/llvm_ir:kernel_support_library\",\n+        \"//xla/service/llvm_ir:llvm_util\",\n+        \"//xla/service/llvm_ir:loop_emitter\",\n+        \"//xla/tsl/platform:errors\",\n+        \"//xla/tsl/platform:status\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/types:span\",\n+        \"@llvm-project//llvm:Core\",\n+        \"@llvm-project//llvm:Support\",\n+    ],\n+)\n+\n+cc_library(\n+    name = \"parallel_loop_emitter\",\n+    srcs = [\"parallel_loop_emitter.cc\"],\n+    hdrs = [\"parallel_loop_emitter.h\"],\n+    compatible_with = get_compatible_with_portable(),\n+    deps = [\n+        \"//xla:shape_util\",\n+        \"//xla/service/gpu:launch_dimensions\",\n+        \"//xla/service/gpu:target_util\",\n+        \"//xla/service/llvm_ir:ir_array\",\n+        \"//xla/service/llvm_ir:kernel_support_library\",\n+        \"//xla/service/llvm_ir:llvm_loop\",\n+        \"//xla/service/llvm_ir:llvm_util\",\n+        \"//xla/service/llvm_ir:loop_emitter\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/strings:string_view\",\n+        \"@com_google_absl//absl/types:span\",\n+        \"@llvm-project//llvm:Core\",\n+        \"@local_tsl//tsl/platform:errors\",\n+        \"@local_tsl//tsl/platform:logging\",\n+    ],\n+)"
        },
        {
            "sha": "2c6ba108cd68d015d6ccd72932d6a42a3f3cfe2c",
            "filename": "third_party/xla/xla/backends/gpu/codegen/llvm/ir_emitter.cc",
            "status": "renamed",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter.cc?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -13,7 +13,7 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#include \"xla/service/gpu/ir_emitter.h\"\n+#include \"xla/backends/gpu/codegen/llvm/ir_emitter.h\"\n \n #include <algorithm>\n #include <cstdint>\n@@ -37,6 +37,9 @@ limitations under the License.\n #include \"llvm/IR/Instructions.h\"\n #include \"llvm/IR/Module.h\"\n #include \"xla/backends/gpu/codegen/fusion_emitter.h\"\n+#include \"xla/backends/gpu/codegen/llvm/ir_emitter_nested.h\"\n+#include \"xla/backends/gpu/codegen/llvm/parallel_loop_emitter.h\"\n+#include \"xla/backends/gpu/codegen/llvm/sort_util.h\"\n #include \"xla/backends/gpu/runtime/kernel_thunk.h\"\n #include \"xla/backends/gpu/runtime/thunk.h\"\n #include \"xla/backends/gpu/runtime/thunk_id.h\"\n@@ -48,15 +51,12 @@ limitations under the License.\n #include \"xla/service/gpu/gpu_constants.h\"\n #include \"xla/service/gpu/ir_emission_utils.h\"\n #include \"xla/service/gpu/ir_emitter_context.h\"\n-#include \"xla/service/gpu/ir_emitter_nested.h\"\n #include \"xla/service/gpu/launch_dimensions.h\"\n-#include \"xla/service/gpu/parallel_loop_emitter.h\"\n #include \"xla/service/llvm_ir/fused_ir_emitter.h\"\n #include \"xla/service/llvm_ir/ir_array.h\"\n #include \"xla/service/llvm_ir/kernel_support_library.h\"\n #include \"xla/service/llvm_ir/llvm_util.h\"\n #include \"xla/service/llvm_ir/loop_emitter.h\"\n-#include \"xla/service/llvm_ir/sort_util.h\"\n #include \"xla/service/llvm_ir/tuple_ops.h\"\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"",
            "previous_filename": "third_party/xla/xla/service/gpu/ir_emitter.cc"
        },
        {
            "sha": "60a20387767a4fb85ab02885f9c9c9d20f50dc0d",
            "filename": "third_party/xla/xla/backends/gpu/codegen/llvm/ir_emitter.h",
            "status": "renamed",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter.h?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -13,8 +13,8 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#ifndef XLA_SERVICE_GPU_IR_EMITTER_H_\n-#define XLA_SERVICE_GPU_IR_EMITTER_H_\n+#ifndef XLA_BACKENDS_GPU_CODEGEN_LLVM_IR_EMITTER_H_\n+#define XLA_BACKENDS_GPU_CODEGEN_LLVM_IR_EMITTER_H_\n \n #include <vector>\n \n@@ -159,4 +159,4 @@ absl::StatusOr<ThunkSequence> EmitRngGetAndUpdateStateLLVMIR(\n }  // namespace gpu\n }  // namespace xla\n \n-#endif  // XLA_SERVICE_GPU_IR_EMITTER_H_\n+#endif  // XLA_BACKENDS_GPU_CODEGEN_LLVM_IR_EMITTER_H_",
            "previous_filename": "third_party/xla/xla/service/gpu/ir_emitter.h"
        },
        {
            "sha": "dcf83cee18ed541575297a52296d59aae7571d84",
            "filename": "third_party/xla/xla/backends/gpu/codegen/llvm/ir_emitter_nested.cc",
            "status": "renamed",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter_nested.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter_nested.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter_nested.cc?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -12,7 +12,7 @@ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n-#include \"xla/service/gpu/ir_emitter_nested.h\"\n+#include \"xla/backends/gpu/codegen/llvm/ir_emitter_nested.h\"\n \n #include <algorithm>\n #include <cstddef>\n@@ -42,6 +42,7 @@ limitations under the License.\n #include \"llvm/IR/LLVMContext.h\"\n #include \"llvm/Support/Casting.h\"\n #include \"llvm/TargetParser/Triple.h\"\n+#include \"xla/backends/gpu/codegen/llvm/ir_emitter.h\"\n #include \"xla/codegen/emitters/computation_fingerprint.h\"\n #include \"xla/hlo/ir/hlo_computation.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n@@ -50,7 +51,6 @@ limitations under the License.\n #include \"xla/service/gpu/gpu_constants.h\"\n #include \"xla/service/gpu/gpu_executable.h\"\n #include \"xla/service/gpu/ir_emission_utils.h\"\n-#include \"xla/service/gpu/ir_emitter.h\"\n #include \"xla/service/gpu/ir_emitter_context.h\"\n #include \"xla/service/llvm_ir/buffer_assignment_util.h\"\n #include \"xla/service/llvm_ir/ir_array.h\"",
            "previous_filename": "third_party/xla/xla/service/gpu/ir_emitter_nested.cc"
        },
        {
            "sha": "7d82e8db2a451a7b56fab0d3e3f1e8b1cb7ed60a",
            "filename": "third_party/xla/xla/backends/gpu/codegen/llvm/ir_emitter_nested.h",
            "status": "renamed",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter_nested.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter_nested.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fir_emitter_nested.h?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -13,8 +13,8 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#ifndef XLA_SERVICE_GPU_IR_EMITTER_NESTED_H_\n-#define XLA_SERVICE_GPU_IR_EMITTER_NESTED_H_\n+#ifndef XLA_BACKENDS_GPU_CODEGEN_LLVM_IR_EMITTER_NESTED_H_\n+#define XLA_BACKENDS_GPU_CODEGEN_LLVM_IR_EMITTER_NESTED_H_\n \n #include <cstdint>\n #include <vector>\n@@ -66,4 +66,4 @@ GpuExecutable::ConstantInfo AppendGlobalConstant(llvm::Module* module,\n }  // namespace gpu\n }  // namespace xla\n \n-#endif  // XLA_SERVICE_GPU_IR_EMITTER_NESTED_H_\n+#endif  // XLA_BACKENDS_GPU_CODEGEN_LLVM_IR_EMITTER_NESTED_H_",
            "previous_filename": "third_party/xla/xla/service/gpu/ir_emitter_nested.h"
        },
        {
            "sha": "3f0f257f19e91587d95087c808cfd737ae814183",
            "filename": "third_party/xla/xla/backends/gpu/codegen/llvm/parallel_loop_emitter.cc",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fparallel_loop_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fparallel_loop_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fparallel_loop_emitter.cc?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -13,7 +13,7 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#include \"xla/service/gpu/parallel_loop_emitter.h\"\n+#include \"xla/backends/gpu/codegen/llvm/parallel_loop_emitter.h\"\n \n #include <cstdint>\n #include <vector>",
            "previous_filename": "third_party/xla/xla/service/gpu/parallel_loop_emitter.cc"
        },
        {
            "sha": "d59c04f57a09eef0092703528cdf89a32c37de9c",
            "filename": "third_party/xla/xla/backends/gpu/codegen/llvm/parallel_loop_emitter.h",
            "status": "renamed",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fparallel_loop_emitter.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fparallel_loop_emitter.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fparallel_loop_emitter.h?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -13,8 +13,8 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#ifndef XLA_SERVICE_GPU_PARALLEL_LOOP_EMITTER_H_\n-#define XLA_SERVICE_GPU_PARALLEL_LOOP_EMITTER_H_\n+#ifndef XLA_BACKENDS_GPU_CODEGEN_LLVM_PARALLEL_LOOP_EMITTER_H_\n+#define XLA_BACKENDS_GPU_CODEGEN_LLVM_PARALLEL_LOOP_EMITTER_H_\n \n #include <vector>\n \n@@ -99,4 +99,4 @@ class ParallelLoopEmitter {\n }  // namespace gpu\n }  // namespace xla\n \n-#endif  // XLA_SERVICE_GPU_PARALLEL_LOOP_EMITTER_H_\n+#endif  // XLA_BACKENDS_GPU_CODEGEN_LLVM_PARALLEL_LOOP_EMITTER_H_",
            "previous_filename": "third_party/xla/xla/service/gpu/parallel_loop_emitter.h"
        },
        {
            "sha": "e7634a27615e37834c6f89f43f32d07e6fdfd288",
            "filename": "third_party/xla/xla/backends/gpu/codegen/llvm/sort_util.cc",
            "status": "renamed",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fsort_util.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fsort_util.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fsort_util.cc?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -13,7 +13,7 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#include \"xla/service/llvm_ir/sort_util.h\"\n+#include \"xla/backends/gpu/codegen/llvm/sort_util.h\"\n \n #include <algorithm>\n #include <cstdint>\n@@ -33,10 +33,10 @@ limitations under the License.\n #include \"llvm/IR/Instructions.h\"\n #include \"llvm/IR/Value.h\"\n #include \"llvm/Support/Casting.h\"\n+#include \"xla/backends/gpu/codegen/llvm/parallel_loop_emitter.h\"\n #include \"xla/layout_util.h\"\n #include \"xla/service/gpu/ir_emission_utils.h\"\n #include \"xla/service/gpu/launch_dimensions.h\"\n-#include \"xla/service/gpu/parallel_loop_emitter.h\"\n #include \"xla/service/gpu/target_util.h\"\n #include \"xla/service/llvm_ir/ir_array.h\"\n #include \"xla/service/llvm_ir/kernel_support_library.h\"",
            "previous_filename": "third_party/xla/xla/service/llvm_ir/sort_util.cc"
        },
        {
            "sha": "7486d218bc3f6be5905e617852b5808cef3883de",
            "filename": "third_party/xla/xla/backends/gpu/codegen/llvm/sort_util.h",
            "status": "renamed",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fsort_util.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fsort_util.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Fllvm%2Fsort_util.h?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -13,8 +13,8 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#ifndef XLA_SERVICE_LLVM_IR_SORT_UTIL_H_\n-#define XLA_SERVICE_LLVM_IR_SORT_UTIL_H_\n+#ifndef XLA_BACKENDS_GPU_CODEGEN_LLVM_SORT_UTIL_H_\n+#define XLA_BACKENDS_GPU_CODEGEN_LLVM_SORT_UTIL_H_\n \n #include <cstdint>\n #include <functional>\n@@ -45,4 +45,4 @@ absl::Status EmitSortInPlace(\n }  // namespace llvm_ir\n }  // namespace xla\n \n-#endif  // XLA_SERVICE_LLVM_IR_SORT_UTIL_H_\n+#endif  // XLA_BACKENDS_GPU_CODEGEN_LLVM_SORT_UTIL_H_",
            "previous_filename": "third_party/xla/xla/service/llvm_ir/sort_util.h"
        },
        {
            "sha": "4e4ef55b01b8dcd1fe2bd0eb0ab67db361d5be4e",
            "filename": "third_party/xla/xla/service/gpu/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 91,
            "changes": 92,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2FBUILD?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -459,13 +459,11 @@ cc_library(\n         \":gpu_norm_runner\",\n         \":hlo_fusion_analysis\",\n         \":ir_emission_utils\",\n-        \":ir_emitter\",\n         \":ir_emitter_context\",\n         \":kernel_call\",\n         \":kernel_reuse_cache\",\n         \":launch_dimensions\",\n         \":matmul_utils\",\n-        \":parallel_loop_emitter\",\n         \":ptx_custom_kernel_emitter\",\n         \":stream_executor_util\",\n         \":triton_call\",\n@@ -477,6 +475,7 @@ cc_library(\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/backends/gpu/codegen:fusion_emitter\",\n         \"//xla/backends/gpu/codegen:fusions\",\n+        \"//xla/backends/gpu/codegen/llvm:ir_emitter\",\n         \"//xla/backends/gpu/codegen/triton:fusion_emitter\",\n         \"//xla/backends/gpu/codegen/triton:xtile_compiler\",\n         \"//xla/backends/gpu/collectives:gpu_clique_key\",\n@@ -553,7 +552,6 @@ cc_library(\n         \"//xla/service/llvm_ir:kernel_support_library\",\n         \"//xla/service/llvm_ir:llvm_util\",\n         \"//xla/service/llvm_ir:loop_emitter\",\n-        \"//xla/service/llvm_ir:sort_util\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/stream_executor:gpu_solver_context\",\n         \"//xla/stream_executor:launch_dim\",\n@@ -604,67 +602,6 @@ cc_library(\n     ]),\n )\n \n-cc_library(\n-    name = \"ir_emitter\",\n-    srcs = [\n-        \"ir_emitter.cc\",\n-        \"ir_emitter_nested.cc\",\n-    ],\n-    hdrs = [\n-        \"ir_emitter.h\",\n-        \"ir_emitter_nested.h\",\n-    ],\n-    deps = [\n-        \":gpu_constants\",\n-        \":gpu_executable\",\n-        \":hlo_to_ir_bindings\",\n-        \":ir_emission_utils\",\n-        \":ir_emitter_context\",\n-        \":launch_dimensions\",\n-        \":parallel_loop_emitter\",\n-        \"//xla:literal\",\n-        \"//xla:shape_util\",\n-        \"//xla:status_macros\",\n-        \"//xla:util\",\n-        \"//xla/backends/gpu/codegen:fusion_emitter\",\n-        \"//xla/backends/gpu/runtime:kernel_thunk\",\n-        \"//xla/backends/gpu/runtime:thunk\",\n-        \"//xla/backends/gpu/runtime:thunk_id\",\n-        \"//xla/codegen/emitters:computation_fingerprint\",\n-        \"//xla/codegen/emitters:kernel_arguments\",\n-        \"//xla/hlo/ir:hlo\",\n-        \"//xla/service:buffer_assignment\",\n-        \"//xla/service:elemental_ir_emitter\",\n-        \"//xla/service/llvm_ir:buffer_assignment_util\",\n-        \"//xla/service/llvm_ir:fused_ir_emitter\",\n-        \"//xla/service/llvm_ir:ir_array\",\n-        \"//xla/service/llvm_ir:ir_builder_mixin\",\n-        \"//xla/service/llvm_ir:kernel_support_library\",\n-        \"//xla/service/llvm_ir:llvm_util\",\n-        \"//xla/service/llvm_ir:loop_emitter\",\n-        \"//xla/service/llvm_ir:sort_util\",\n-        \"//xla/service/llvm_ir:tuple_ops\",\n-        \"//xla/stream_executor:device_description\",\n-        \"//xla/stream_executor/gpu:tma_metadata\",\n-        \"//xla/tsl/platform:errors\",\n-        \"//xla/tsl/platform:statusor\",\n-        \"@com_google_absl//absl/algorithm:container\",\n-        \"@com_google_absl//absl/log\",\n-        \"@com_google_absl//absl/log:check\",\n-        \"@com_google_absl//absl/status\",\n-        \"@com_google_absl//absl/status:statusor\",\n-        \"@com_google_absl//absl/strings\",\n-        \"@com_google_absl//absl/strings:str_format\",\n-        \"@com_google_absl//absl/types:span\",\n-        \"@llvm-project//llvm:Core\",\n-        \"@llvm-project//llvm:Support\",\n-        \"@llvm-project//llvm:TargetParser\",\n-        \"@local_tsl//tsl/platform:errors\",\n-        \"@local_tsl//tsl/platform:fingerprint\",\n-        \"@local_tsl//tsl/platform:statusor\",\n-    ],\n-)\n-\n cc_library(\n     name = \"kernel_call\",\n     srcs = [\"kernel_call.cc\"],\n@@ -713,32 +650,6 @@ cc_library(\n     ],\n )\n \n-cc_library(\n-    name = \"parallel_loop_emitter\",\n-    srcs = [\"parallel_loop_emitter.cc\"],\n-    hdrs = [\"parallel_loop_emitter.h\"],\n-    compatible_with = get_compatible_with_portable(),\n-    deps = [\n-        \":launch_dimensions\",\n-        \":target_util\",\n-        \"//xla:shape_util\",\n-        \"//xla/service/llvm_ir:ir_array\",\n-        \"//xla/service/llvm_ir:kernel_support_library\",\n-        \"//xla/service/llvm_ir:llvm_loop\",\n-        \"//xla/service/llvm_ir:llvm_util\",\n-        \"//xla/service/llvm_ir:loop_emitter\",\n-        \"@com_google_absl//absl/log\",\n-        \"@com_google_absl//absl/log:check\",\n-        \"@com_google_absl//absl/status\",\n-        \"@com_google_absl//absl/strings\",\n-        \"@com_google_absl//absl/strings:string_view\",\n-        \"@com_google_absl//absl/types:span\",\n-        \"@llvm-project//llvm:Core\",\n-        \"@local_tsl//tsl/platform:errors\",\n-        \"@local_tsl//tsl/platform:logging\",\n-    ],\n-)\n-\n cc_library(\n     name = \"buffer_allocations\",\n     srcs = [\"buffer_allocations.cc\"],\n@@ -1678,7 +1589,6 @@ cc_library(\n         \":gpu_spmd_pipeline\",\n         \":hlo_fusion_stats\",\n         \":ir_emission_utils\",\n-        \":ir_emitter\",\n         \":ir_emitter_context\",\n         \":kernel_reuse_cache\",\n         \":legacy_gpu_aot_compilation_result\","
        },
        {
            "sha": "0f12b608c5aa8de2cf8b9c33c1e9a3d1f7ff6d4b",
            "filename": "third_party/xla/xla/service/gpu/thunk_emitter.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fthunk_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fthunk_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fthunk_emitter.cc?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -51,6 +51,8 @@ limitations under the License.\n #include \"mlir/Target/LLVMIR/Export.h\"\n #include \"xla/backends/gpu/codegen/fusion_emitter.h\"\n #include \"xla/backends/gpu/codegen/fusions.h\"\n+#include \"xla/backends/gpu/codegen/llvm/ir_emitter.h\"\n+#include \"xla/backends/gpu/codegen/llvm/ir_emitter_nested.h\"\n #include \"xla/backends/gpu/codegen/triton/xtile_compiler.h\"\n #include \"xla/backends/gpu/runtime/all_gather_thunk.h\"\n #include \"xla/backends/gpu/runtime/all_reduce_thunk.h\"\n@@ -128,9 +130,7 @@ limitations under the License.\n #include \"xla/service/gpu/gpu_norm_runner.h\"\n #include \"xla/service/gpu/hlo_fusion_analysis.h\"\n #include \"xla/service/gpu/ir_emission_utils.h\"\n-#include \"xla/service/gpu/ir_emitter.h\"\n #include \"xla/service/gpu/ir_emitter_context.h\"\n-#include \"xla/service/gpu/ir_emitter_nested.h\"\n #include \"xla/service/gpu/kernel_reuse_cache.h\"\n #include \"xla/service/gpu/kernels/custom_kernel.h\"\n #include \"xla/service/gpu/launch_dimensions.h\""
        },
        {
            "sha": "63acd385a6974ab3230c09a19100b77cce5c7963",
            "filename": "third_party/xla/xla/service/gpu/thunk_emitter.h",
            "status": "modified",
            "additions": 0,
            "deletions": 9,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fthunk_emitter.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fthunk_emitter.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fthunk_emitter.h?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -42,11 +42,7 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_instructions.h\"\n #include \"xla/service/buffer_assignment.h\"\n #include \"xla/service/call_graph.h\"\n-#include \"xla/service/gpu/ir_emitter.h\"\n #include \"xla/service/gpu/ir_emitter_context.h\"\n-#include \"xla/service/gpu/launch_dimensions.h\"\n-#include \"xla/service/llvm_ir/ir_array.h\"\n-#include \"xla/service/llvm_ir/loop_emitter.h\"\n #include \"xla/shape_util.h\"\n \n namespace xla {\n@@ -78,11 +74,6 @@ class ThunkEmitter {\n     return ir_emitter_context_->platform_name();\n   }\n \n-  using ValueVector3 = std::array<llvm::Value*, 3>;\n-  using ValueVector2 = std::array<llvm::Value*, 2>;\n-\n-  using ConstantGenerator = std::function<llvm::Value*(int64_t)>;\n-\n   ThunkEmitter(const ThunkEmitter&) = delete;\n   ThunkEmitter& operator=(const ThunkEmitter&) = delete;\n "
        },
        {
            "sha": "a625cd355bdbe0977d1dd6ff4e0f5fd555bd97b6",
            "filename": "third_party/xla/xla/service/llvm_ir/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 28,
            "changes": 28,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fllvm_ir%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fllvm_ir%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fllvm_ir%2FBUILD?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -212,8 +212,6 @@ cc_library(\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/service:buffer_assignment\",\n         \"//xla/service/cpu:backend_config_proto_cc\",\n-        \"//xla/service/gpu:launch_dimensions\",\n-        \"//xla/service/gpu:parallel_loop_emitter\",\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:statusor\",\n         \"@com_google_absl//absl/log\",\n@@ -226,32 +224,6 @@ cc_library(\n     ],\n )\n \n-cc_library(\n-    name = \"sort_util\",\n-    srcs = [\"sort_util.cc\"],\n-    hdrs = [\"sort_util.h\"],\n-    deps = [\n-        \":ir_array\",\n-        \":kernel_support_library\",\n-        \":llvm_util\",\n-        \":loop_emitter\",\n-        \"//xla:shape_util\",\n-        \"//xla:util\",\n-        \"//xla:xla_data_proto_cc\",\n-        \"//xla/service/gpu:ir_emission_utils\",\n-        \"//xla/service/gpu:launch_dimensions\",\n-        \"//xla/service/gpu:parallel_loop_emitter\",\n-        \"//xla/service/gpu:target_util\",\n-        \"//xla/tsl/platform:errors\",\n-        \"//xla/tsl/platform:status\",\n-        \"@com_google_absl//absl/status\",\n-        \"@com_google_absl//absl/strings\",\n-        \"@com_google_absl//absl/types:span\",\n-        \"@llvm-project//llvm:Core\",\n-        \"@llvm-project//llvm:Support\",\n-    ],\n-)\n-\n cc_library(\n     name = \"tuple_ops\",\n     srcs = [\"tuple_ops.cc\"],"
        },
        {
            "sha": "348b78e47cd016788b41e8857d7ea3001fd07aea",
            "filename": "third_party/xla/xla/service/llvm_ir/dynamic_update_slice_util.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 17,
            "changes": 24,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fllvm_ir%2Fdynamic_update_slice_util.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/049affca61a7f90d4b094b2383c84cd28e57f139/third_party%2Fxla%2Fxla%2Fservice%2Fllvm_ir%2Fdynamic_update_slice_util.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fllvm_ir%2Fdynamic_update_slice_util.cc?ref=049affca61a7f90d4b094b2383c84cd28e57f139",
            "patch": "@@ -37,8 +37,6 @@ limitations under the License.\n #include \"xla/layout_util.h\"\n #include \"xla/service/buffer_assignment.h\"\n #include \"xla/service/cpu/backend_config.pb.h\"\n-#include \"xla/service/gpu/launch_dimensions.h\"\n-#include \"xla/service/gpu/parallel_loop_emitter.h\"\n #include \"xla/service/llvm_ir/fused_ir_emitter.h\"\n #include \"xla/service/llvm_ir/ir_array.h\"\n #include \"xla/service/llvm_ir/llvm_util.h\"\n@@ -119,14 +117,14 @@ bool CanEmitFusedDynamicUpdateSliceInPlace(HloInstruction* fusion,\n // Shared implementation of EmitDynamicUpdateSliceInPlace and\n // EmitFusedDynamicUpdateSliceInPlace.\n //\n-// Emits a sequential loop if launch_dimensions is null.\n+// Emits a sequential loop.\n using IndexGenerator = std::function<absl::StatusOr<llvm::Value*>(int64_t)>;\n \n static absl::Status EmitDynamicUpdateSliceInPlaceImpl(\n     const Shape& update_shape, const IndexGenerator& start_indices_generator,\n     bool is_signed, ElementGenerator update_array_generator,\n-    const IrArray& output_array, const gpu::LaunchDimensions* launch_dimensions,\n-    absl::string_view name, llvm::IRBuilderBase* b) {\n+    const IrArray& output_array, absl::string_view name,\n+    llvm::IRBuilderBase* b) {\n   const Shape& output_shape = output_array.GetShape();\n \n   // Read start indices from start_indices_generator.\n@@ -179,12 +177,6 @@ static absl::Status EmitDynamicUpdateSliceInPlaceImpl(\n     output_array.EmitWriteArrayElement(output_index, update_data, b);\n     return absl::OkStatus();\n   };\n-\n-  if (launch_dimensions != nullptr) {\n-    return gpu::ParallelLoopEmitter(loop_body_emitter, update_shape,\n-                                    *launch_dimensions, b)\n-        .EmitLoop(name);\n-  }\n   return LoopEmitter(loop_body_emitter, update_shape, b).EmitLoop(name);\n }\n \n@@ -211,7 +203,7 @@ absl::Status EmitDynamicUpdateSliceInPlace(\n   bool is_signed = ShapeUtil::ElementIsSigned(start_indices_array.GetShape());\n   return EmitDynamicUpdateSliceInPlaceImpl(\n       update_shape, start_indices_generator, is_signed, update_array_generator,\n-      output_array, /*launch_dimensions=*/nullptr, name, b);\n+      output_array, name, b);\n }\n \n // Shared implementation for EmitFusedDynamicUpdateSliceInPlace and\n@@ -222,8 +214,7 @@ static absl::Status EmitFusedDynamicUpdateSliceInPlaceImpl(\n     const HloComputation* fusion,\n     const std::vector<std::pair<const HloInstruction*, const IrArray>>&\n         dus_and_output_array,\n-    FusedIrEmitter* fused_emitter,\n-    const gpu::LaunchDimensions* launch_dimensions, llvm::IRBuilderBase* b) {\n+    FusedIrEmitter* fused_emitter, llvm::IRBuilderBase* b) {\n   VLOG(2) << \"EmitFusedDynamicUpdateSliceInPlace for \" << fusion->ToString();\n \n   CHECK_GE(dus_and_output_array.size(), 1);\n@@ -267,7 +258,7 @@ static absl::Status EmitFusedDynamicUpdateSliceInPlaceImpl(\n \n     TF_RETURN_IF_ERROR(EmitDynamicUpdateSliceInPlaceImpl(\n         update_shape, start_indices_generator, is_signed,\n-        update_array_generator, fusion_output_array, launch_dimensions,\n+        update_array_generator, fusion_output_array,\n         IrName(dynamic_update_slice), b));\n   }\n \n@@ -283,8 +274,7 @@ absl::Status EmitFusedDynamicUpdateSliceInPlace(\n       dus_and_output_array{std::make_pair(dus, fusion_output_array)};\n \n   return EmitFusedDynamicUpdateSliceInPlaceImpl(\n-      fusion->called_computations()[0], dus_and_output_array, fused_emitter,\n-      /*launch_dimensions=*/nullptr, b);\n+      fusion->called_computations()[0], dus_and_output_array, fused_emitter, b);\n }\n \n }  // namespace llvm_ir"
        }
    ],
    "stats": {
        "total": 329,
        "additions": 161,
        "deletions": 168
    }
}