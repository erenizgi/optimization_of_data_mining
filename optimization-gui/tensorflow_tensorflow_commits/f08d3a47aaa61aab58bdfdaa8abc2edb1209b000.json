{
    "author": "belitskiy",
    "message": "[CI] Stop optional services in Windows CI to reduce file permission error flakes.\n\nThey may be causing permission errors on Windows when Bazel tries to access header\nfiles in Windows SDK/Clang while building @@bazel_tools targets.\n\nPiperOrigin-RevId: 834792776",
    "sha": "f08d3a47aaa61aab58bdfdaa8abc2edb1209b000",
    "files": [
        {
            "sha": "03f49d85797225e4b46f8d6f56a5f68032f6dde5",
            "filename": "ci/official/utilities/setup_docker.sh",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f08d3a47aaa61aab58bdfdaa8abc2edb1209b000/ci%2Fofficial%2Futilities%2Fsetup_docker.sh",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f08d3a47aaa61aab58bdfdaa8abc2edb1209b000/ci%2Fofficial%2Futilities%2Fsetup_docker.sh",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/ci%2Fofficial%2Futilities%2Fsetup_docker.sh?ref=f08d3a47aaa61aab58bdfdaa8abc2edb1209b000",
            "patch": "@@ -62,6 +62,12 @@ if ! docker container inspect tf >/dev/null 2>&1 ; then\n     # Additional setup is contained in ci/official/envs/rbe.\n     CONTAINER_IP_ADDR=$(docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' tf)\n     netsh advfirewall firewall add rule name=\"Allow Metadata Proxy\" dir=in action=allow protocol=TCP localport=80 remoteip=\"$CONTAINER_IP_ADDR\"\n+\n+    # Stop non-essential indexing and link tracking services that\n+    # may lock new files or symlinks.\n+    # They may be causing sporadic \"Permission denied\" errors during Bazel builds.\n+    # b/461500885\n+    docker exec tf powershell -NoProfile -Command 'Stop-Service -Name SysMain,DiagTrack -Force -ErrorAction SilentlyContinue'\n   fi\n \n fi"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
    }
}