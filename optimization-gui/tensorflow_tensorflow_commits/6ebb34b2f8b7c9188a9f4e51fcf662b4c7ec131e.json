{
    "author": "ezhulenev",
    "message": "[xla] Delete PjRtFuture<>::MoveOnlyPromise\n\nPiperOrigin-RevId: 809732789",
    "sha": "6ebb34b2f8b7c9188a9f4e51fcf662b4c7ec131e",
    "files": [
        {
            "sha": "e09b62d88bd258269aea0f9c2752ec80027fdae8",
            "filename": "third_party/xla/xla/pjrt/pjrt_future.h",
            "status": "modified",
            "additions": 7,
            "deletions": 19,
            "changes": 26,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/6ebb34b2f8b7c9188a9f4e51fcf662b4c7ec131e/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_future.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/6ebb34b2f8b7c9188a9f4e51fcf662b4c7ec131e/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_future.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_future.h?ref=6ebb34b2f8b7c9188a9f4e51fcf662b4c7ec131e",
            "patch": "@@ -786,32 +786,20 @@ class PjRtFuture<void> : public internal::PjRtFutureBase<absl::Status> {\n       Base::Promise::emplace(std::move(status));\n     }\n \n-   private:\n-    friend class PjRtFuture<void>;\n-  };\n-\n-  // This is a temporary class to support migration from CreatePromise() to\n-  // MakePromise() and an end goal of making Promise move-only type.\n-  class MoveOnlyPromise : public Promise {\n-   public:\n-    using Promise::Promise;\n-    using Promise::Set;\n-\n-    MoveOnlyPromise(MoveOnlyPromise&&) = default;\n-    MoveOnlyPromise& operator=(MoveOnlyPromise&&) = default;\n-\n     // A helper function to convert move-only Promise to shared_ptr, which is\n     // useful when the promise has to be captured by a std::function.\n-    std::shared_ptr<MoveOnlyPromise> ToShared() && {\n-      return std::make_shared<MoveOnlyPromise>(std::move(*this));\n+    std::shared_ptr<Promise> ToShared() && {\n+      return std::make_shared<Promise>(std::move(*this));\n     }\n+\n+   private:\n+    friend class PjRtFuture<void>;\n   };\n \n   // Returns a pair of connected Promise and PjRtFuture<>. Setting the returned\n   // promise will fulfill the connected future.\n-  static std::pair<MoveOnlyPromise, PjRtFuture<>> MakePromise() {\n-    MoveOnlyPromise promise(\n-        tsl::MakeUnconstructedAsyncValueRef<absl::Status>());\n+  static std::pair<Promise, PjRtFuture<>> MakePromise() {\n+    Promise promise(tsl::MakeUnconstructedAsyncValueRef<absl::Status>());\n     PjRtFuture<> future(promise);\n     return std::make_pair(std::move(promise), std::move(future));\n   }"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 7,
        "deletions": 19
    }
}