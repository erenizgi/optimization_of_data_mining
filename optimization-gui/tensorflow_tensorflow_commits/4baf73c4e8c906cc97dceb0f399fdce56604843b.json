{
    "author": "beckerhe",
    "message": "Refactor: Extract AotCompilationResult to CompiledModule.\n\nThis change moves the definition of `AotCompilationResult` into a new header file `compiled_module.h` and renames the class to `CompiledModule`. `CompilationResult` would have been the preferred name, but it's already in-use elsewhere.\n\nThe original `AotCompilationResult` is kept as a deprecated alias.\n\nPiperOrigin-RevId: 846246415",
    "sha": "4baf73c4e8c906cc97dceb0f399fdce56604843b",
    "files": [
        {
            "sha": "640992b0283e5bd887374a8f7dc08a34b9406c62",
            "filename": "third_party/xla/xla/service/BUILD",
            "status": "modified",
            "additions": 13,
            "deletions": 1,
            "changes": 14,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4baf73c4e8c906cc97dceb0f399fdce56604843b/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4baf73c4e8c906cc97dceb0f399fdce56604843b/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2FBUILD?ref=4baf73c4e8c906cc97dceb0f399fdce56604843b",
            "patch": "@@ -1586,6 +1586,18 @@ xla_cc_test(\n     ],\n )\n \n+cc_library(\n+    name = \"compiled_module\",\n+    hdrs = [\"compiled_module.h\"],\n+    deps = [\n+        \":buffer_assignment\",\n+        \"//xla/hlo/ir:hlo\",\n+        \"//xla/stream_executor:stream_executor_h\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/status:statusor\",\n+    ],\n+)\n+\n cc_library(\n     name = \"compiler\",\n     srcs = [\"compiler.cc\"],\n@@ -1595,8 +1607,8 @@ cc_library(\n         \"//xla/backends/gpu/runtime:__subpackages__\",\n     ]),\n     deps = [\n-        \":buffer_assignment\",\n         \":buffer_value\",\n+        \":compiled_module\",\n         \":computation_placer\",\n         \":executable\",\n         \":hlo_cost_analysis\","
        },
        {
            "sha": "7c4f8f6f305aaf85b11e08760f02b4a676382b90",
            "filename": "third_party/xla/xla/service/compiled_module.h",
            "status": "added",
            "additions": 55,
            "deletions": 0,
            "changes": 55,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4baf73c4e8c906cc97dceb0f399fdce56604843b/third_party%2Fxla%2Fxla%2Fservice%2Fcompiled_module.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4baf73c4e8c906cc97dceb0f399fdce56604843b/third_party%2Fxla%2Fxla%2Fservice%2Fcompiled_module.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcompiled_module.h?ref=4baf73c4e8c906cc97dceb0f399fdce56604843b",
            "patch": "@@ -0,0 +1,55 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#ifndef XLA_SERVICE_COMPILED_MODULE_H_\n+#define XLA_SERVICE_COMPILED_MODULE_H_\n+\n+#include <memory>\n+#include <string>\n+\n+#include \"absl/status/status.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"xla/hlo/ir/hlo_module.h\"\n+#include \"xla/service/buffer_assignment.h\"\n+#include \"xla/stream_executor/stream_executor.h\"\n+\n+namespace xla {\n+\n+class Executable;\n+\n+// Abstract superclass describing the result of an ahead-of-time compilation.\n+class CompiledModule {\n+ public:\n+  virtual ~CompiledModule() = default;\n+\n+  virtual absl::StatusOr<std::string> SerializeAsString() const = 0;\n+\n+  virtual absl::StatusOr<std::unique_ptr<Executable>> LoadExecutable(\n+      const stream_executor::StreamExecutor* executor) && = 0;\n+\n+  virtual absl::StatusOr<std::unique_ptr<BufferAssignment>> buffer_assignment()\n+      const {\n+    return absl::UnimplementedError(\"buffer_assignment is not supported.\");\n+  }\n+\n+  // Returns the optimized HLO module if one was computed and the implementation\n+  // supports it.\n+  virtual const HloModule* optimized_module() const = 0;\n+  virtual std::shared_ptr<HloModule> shared_optimized_module() = 0;\n+};\n+\n+}  // namespace xla\n+\n+#endif  // XLA_SERVICE_COMPILED_MODULE_H_"
        },
        {
            "sha": "7938e3d1a50588193aa2959f396d2b4e75e2fb72",
            "filename": "third_party/xla/xla/service/compiler.h",
            "status": "modified",
            "additions": 2,
            "deletions": 31,
            "changes": 33,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4baf73c4e8c906cc97dceb0f399fdce56604843b/third_party%2Fxla%2Fxla%2Fservice%2Fcompiler.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4baf73c4e8c906cc97dceb0f399fdce56604843b/third_party%2Fxla%2Fxla%2Fservice%2Fcompiler.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcompiler.h?ref=4baf73c4e8c906cc97dceb0f399fdce56604843b",
            "patch": "@@ -41,8 +41,8 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/pjrt/distributed/key_value_store_interface.h\"\n-#include \"xla/service/buffer_assignment.h\"\n #include \"xla/service/buffer_value.h\"\n+#include \"xla/service/compiled_module.h\"\n #include \"xla/service/computation_placer.h\"\n #include \"xla/service/executable.h\"\n #include \"xla/service/hlo_cost_analysis.h\"\n@@ -71,36 +71,7 @@ using ObjectFileData = std::vector<char>;\n \n class AotCompilationOptions;\n \n-// Abstract superclass describing the result of an ahead-of-time compilation.\n-class AotCompilationResult {\n- public:\n-  AotCompilationResult(const AotCompilationResult&) = delete;\n-  AotCompilationResult& operator=(AotCompilationResult const&) = delete;\n-\n-  virtual ~AotCompilationResult() = default;\n-\n-  virtual absl::StatusOr<std::string> SerializeAsString() const {\n-    return Unimplemented(\"SerializeAsString unimplemented.\");\n-  }\n-\n-  virtual absl::StatusOr<std::unique_ptr<Executable>> LoadExecutable(\n-      const se::StreamExecutor* executor) && {\n-    return Unimplemented(\"LoadExecutable unimplemented.\");\n-  }\n-\n-  virtual absl::StatusOr<std::unique_ptr<BufferAssignment>> buffer_assignment()\n-      const {\n-    return Unimplemented(\"buffer_assignment unimplemented.\");\n-  }\n-\n-  // Returns the optimized HLO module if one was computed and the implementation\n-  // supports it.\n-  virtual const HloModule* optimized_module() const = 0;\n-  virtual std::shared_ptr<HloModule> shared_optimized_module() = 0;\n-\n- protected:\n-  AotCompilationResult() = default;\n-};\n+using AotCompilationResult ABSL_DEPRECATE_AND_INLINE() = CompiledModule;\n \n // Abstract superclass describing metadata produced during ahead-of-time\n // compilation."
        }
    ],
    "stats": {
        "total": 102,
        "additions": 70,
        "deletions": 32
    }
}