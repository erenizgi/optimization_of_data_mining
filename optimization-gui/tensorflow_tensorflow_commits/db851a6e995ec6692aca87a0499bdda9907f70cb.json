{
    "author": "tensorflower-gardener",
    "message": "Fix freethreaded aarch64 builds in JAX.\n\nThe urls for all python versions can use `pgo+lto-full`.\n\nPiperOrigin-RevId: 810595592",
    "sha": "db851a6e995ec6692aca87a0499bdda9907f70cb",
    "files": [
        {
            "sha": "e1229b94d7730a625e107696716acce9f3bafc06",
            "filename": "third_party/py/rules_python_versions.patch",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/db851a6e995ec6692aca87a0499bdda9907f70cb/third_party%2Fpy%2Frules_python_versions.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/db851a6e995ec6692aca87a0499bdda9907f70cb/third_party%2Fpy%2Frules_python_versions.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Frules_python_versions.patch?ref=db851a6e995ec6692aca87a0499bdda9907f70cb",
            "patch": "@@ -1,25 +1,21 @@\n diff --git a/python/versions.bzl b/python/versions.bzl\n-index 30929f82..73974065 100644\n+index 30929f82..3d0d6025 100644\n --- a/python/versions.bzl\n +++ b/python/versions.bzl\n-@@ -1045,29 +1045,29 @@ def get_release_info(platform, python_version, base_url = DEFAULT_RELEASE_BASE_U\n+@@ -1045,29 +1045,25 @@ def get_release_info(platform, python_version, base_url = DEFAULT_RELEASE_BASE_U\n      for u in url:\n          p, _, _ = platform.partition(FREETHREADED)\n  \n -        release_id = int(u.split(\"/\")[-2])\n -\n          if FREETHREADED.lstrip(\"-\") in platform:\n-+            if \"3.13\" in python_version:\n-+                aarch64_linux_suffix = \"lto\"\n-+            else:\n-+                aarch64_linux_suffix = \"pgo+lto\"\n              build = \"{}+{}-full\".format(\n                  FREETHREADED.lstrip(\"-\"),\n                  {\n                      \"aarch64-apple-darwin\": \"pgo+lto\",\n                      \"aarch64-pc-windows-msvc\": \"pgo\",\n -                    \"aarch64-unknown-linux-gnu\": \"lto\" if release_id < 20250702 else \"pgo+lto\",\n-+                    \"aarch64-unknown-linux-gnu\": aarch64_linux_suffix,\n++                    \"aarch64-unknown-linux-gnu\": \"pgo+lto\",\n                      \"ppc64le-unknown-linux-gnu\": \"lto\",\n                      \"riscv64-unknown-linux-gnu\": \"lto\",\n                      \"s390x-unknown-linux-gnu\": \"lto\","
        },
        {
            "sha": "e1229b94d7730a625e107696716acce9f3bafc06",
            "filename": "third_party/xla/third_party/py/rules_python_versions.patch",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/db851a6e995ec6692aca87a0499bdda9907f70cb/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python_versions.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/db851a6e995ec6692aca87a0499bdda9907f70cb/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python_versions.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python_versions.patch?ref=db851a6e995ec6692aca87a0499bdda9907f70cb",
            "patch": "@@ -1,25 +1,21 @@\n diff --git a/python/versions.bzl b/python/versions.bzl\n-index 30929f82..73974065 100644\n+index 30929f82..3d0d6025 100644\n --- a/python/versions.bzl\n +++ b/python/versions.bzl\n-@@ -1045,29 +1045,29 @@ def get_release_info(platform, python_version, base_url = DEFAULT_RELEASE_BASE_U\n+@@ -1045,29 +1045,25 @@ def get_release_info(platform, python_version, base_url = DEFAULT_RELEASE_BASE_U\n      for u in url:\n          p, _, _ = platform.partition(FREETHREADED)\n  \n -        release_id = int(u.split(\"/\")[-2])\n -\n          if FREETHREADED.lstrip(\"-\") in platform:\n-+            if \"3.13\" in python_version:\n-+                aarch64_linux_suffix = \"lto\"\n-+            else:\n-+                aarch64_linux_suffix = \"pgo+lto\"\n              build = \"{}+{}-full\".format(\n                  FREETHREADED.lstrip(\"-\"),\n                  {\n                      \"aarch64-apple-darwin\": \"pgo+lto\",\n                      \"aarch64-pc-windows-msvc\": \"pgo\",\n -                    \"aarch64-unknown-linux-gnu\": \"lto\" if release_id < 20250702 else \"pgo+lto\",\n-+                    \"aarch64-unknown-linux-gnu\": aarch64_linux_suffix,\n++                    \"aarch64-unknown-linux-gnu\": \"pgo+lto\",\n                      \"ppc64le-unknown-linux-gnu\": \"lto\",\n                      \"riscv64-unknown-linux-gnu\": \"lto\",\n                      \"s390x-unknown-linux-gnu\": \"lto\","
        }
    ],
    "stats": {
        "total": 20,
        "additions": 6,
        "deletions": 14
    }
}