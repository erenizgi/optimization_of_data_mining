{
    "author": "hhb",
    "message": "Expose new methods to PjRtTopologyDescription.\n\nPiperOrigin-RevId: 820837477",
    "sha": "a619e2de083a10779da5943d6ef995e6da27fe6c",
    "files": [
        {
            "sha": "041c8d3877c3f2e19d01941b3b558e793ac6310d",
            "filename": "third_party/xla/xla/pjrt/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a619e2de083a10779da5943d6ef995e6da27fe6c/third_party%2Fxla%2Fxla%2Fpjrt%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a619e2de083a10779da5943d6ef995e6da27fe6c/third_party%2Fxla%2Fxla%2Fpjrt%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2FBUILD?ref=a619e2de083a10779da5943d6ef995e6da27fe6c",
            "patch": "@@ -475,6 +475,7 @@ cc_library(\n     visibility = internal_visibility([\":friends\"]),\n     deps = [\n         \":pjrt_device_description\",\n+        \":pjrt_device_dimensions\",\n         \":pjrt_executable\",\n         \"//xla/hlo/builder:xla_computation\",\n         \"//xla/pjrt/proto:pjrt_partial_program_proto_cc\","
        },
        {
            "sha": "51b825fd9a110c5958379be85e4144eb5e1b6e34",
            "filename": "third_party/xla/xla/pjrt/pjrt_compiler.h",
            "status": "modified",
            "additions": 40,
            "deletions": 0,
            "changes": 40,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a619e2de083a10779da5943d6ef995e6da27fe6c/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_compiler.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a619e2de083a10779da5943d6ef995e6da27fe6c/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_compiler.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_compiler.h?ref=a619e2de083a10779da5943d6ef995e6da27fe6c",
            "patch": "@@ -32,6 +32,7 @@ limitations under the License.\n #include \"mlir/IR/BuiltinOps.h\"\n #include \"xla/hlo/builder/xla_computation.h\"\n #include \"xla/pjrt/pjrt_device_description.h\"\n+#include \"xla/pjrt/pjrt_device_dimensions.h\"\n #include \"xla/pjrt/pjrt_executable.h\"\n #include \"xla/pjrt/proto/pjrt_partial_program.pb.h\"\n #include \"xla/pjrt/proto/topology_description.pb.h\"\n@@ -153,6 +154,37 @@ class PjRtTopologyDescription {\n         \"CoreCountOfDefaultTypePerChip is unsupported.\");\n   }\n \n+  // Returns a unique integer ID for the logical device of the default type on\n+  // the chip at the given coordinates and with the given core index.\n+  virtual absl::StatusOr<int32_t> IdForLogicalDeviceOfDefaultType(\n+      const PjRtDeviceDimensions& chip, int core_index) const {\n+    return absl::UnimplementedError(\n+        \"IdForLogicalDeviceOfDefaultType is unsupported.\");\n+  }\n+\n+  // Returns the chip coordinates and core index of the logical device of the\n+  // default type for the given unique device ID.\n+  virtual absl::StatusOr<std::pair<PjRtDeviceDimensions, int32_t>>\n+  LogicalDeviceOfDefaultTypeForId(int device_id) const {\n+    return absl::UnimplementedError(\n+        \"LogicalDeviceCoordsOfDefaultTypeForId is unsupported.\");\n+  }\n+\n+  // Returns the bounds of the chips within a single host.\n+  virtual absl::StatusOr<PjRtDeviceDimensions> ChipsPerHostBounds() const {\n+    return absl::UnimplementedError(\"GetChipsPerHostBounds is unsupported.\");\n+  }\n+\n+  // Returns the total bounds of all chips in the topology.\n+  virtual absl::StatusOr<PjRtDeviceDimensions> ChipBounds() const {\n+    return absl::UnimplementedError(\"ChipBounds is unsupported.\");\n+  }\n+\n+  // Returns the total bounds of all hosts in the topology.\n+  virtual absl::StatusOr<PjRtDeviceDimensions> HostBounds() const {\n+    return absl::UnimplementedError(\"HostBounds is unsupported.\");\n+  }\n+\n   // Serializes the topology for use in cache keys. (No guarantees on\n   // stability).\n   virtual absl::StatusOr<std::string> Serialize() const = 0;\n@@ -173,6 +205,14 @@ class PjRtTopologyDescription {\n   virtual absl::StatusOr<PjRtTopologyDescriptionProto> ToProto() const {\n     return absl::UnimplementedError(\"ToProto is unsupported.\");\n   }\n+\n+  // Returns a new `PjRtTopologyDescription` representing a subslice of the\n+  // current topology, defined by `chips_per_host_bounds` and `host_bounds`.\n+  virtual absl::StatusOr<std::unique_ptr<PjRtTopologyDescription>> Subslice(\n+      const PjRtDeviceDimensions& chips_per_host_bounds,\n+      const PjRtDeviceDimensions& host_bounds) const {\n+    return absl::UnimplementedError(\"Subslice is not supported.\");\n+  }\n };\n \n // Abstract interface that all registered compilers must implement."
        }
    ],
    "stats": {
        "total": 41,
        "additions": 41,
        "deletions": 0
    }
}