{
    "author": "SiqiaoWu1993",
    "message": "Let `RunWithSortedInputsOutputs` take `graph_name`.\n\nPiperOrigin-RevId: 815900754",
    "sha": "3bc0da7933cd06e4798382d7698fe923f5c792f2",
    "files": [
        {
            "sha": "7bb9a7babebc7e00ae556a882168eac8eb5127d3",
            "filename": "tensorflow/core/tfrt/graph_executor/graph_executor.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 10,
            "changes": 19,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3bc0da7933cd06e4798382d7698fe923f5c792f2/tensorflow%2Fcore%2Ftfrt%2Fgraph_executor%2Fgraph_executor.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3bc0da7933cd06e4798382d7698fe923f5c792f2/tensorflow%2Fcore%2Ftfrt%2Fgraph_executor%2Fgraph_executor.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftfrt%2Fgraph_executor%2Fgraph_executor.cc?ref=3bc0da7933cd06e4798382d7698fe923f5c792f2",
            "patch": "@@ -560,7 +560,7 @@ void CreateSortedNamesAndOriginalIndices(absl::Span<const std::string> names,\n }\n \n absl::Status GraphExecutor::RunWithSortedInputsOutputs(\n-    const RunOptions& run_options,\n+    const RunOptions& run_options, absl::string_view graph_name,\n     absl::Span<const std::pair<std::string, tensorflow::Tensor>> inputs,\n     absl::Span<const std::string> sorted_input_names,\n     absl::Span<const tensorflow::DataType> sorted_input_dtypes,\n@@ -570,12 +570,11 @@ absl::Status GraphExecutor::RunWithSortedInputsOutputs(\n     absl::Span<const int> output_original_indices,\n     std::vector<tensorflow::Tensor>* outputs) {\n   // Load the client graph.\n-  TF_ASSIGN_OR_RETURN(\n-      LoadedClientGraph & loaded_client_graph,\n-      GetOrCreateLoadedClientGraph(\n-          run_options, sorted_input_names, sorted_input_dtypes,\n-          sorted_output_names, sorted_target_node_names, run_options.work_queue,\n-          /*graph_name=*/{}, inputs));\n+  TF_ASSIGN_OR_RETURN(LoadedClientGraph & loaded_client_graph,\n+                      GetOrCreateLoadedClientGraph(\n+                          run_options, sorted_input_names, sorted_input_dtypes,\n+                          sorted_output_names, sorted_target_node_names,\n+                          run_options.work_queue, graph_name, inputs));\n \n   // Get a shared_ptr of the executable so that during the current request the\n   // executable to use is guaranteed to be alive.\n@@ -683,9 +682,9 @@ absl::Status GraphExecutor::Run(\n   std::sort(sorted_target_node_names.begin(), sorted_target_node_names.end());\n \n   return RunWithSortedInputsOutputs(\n-      run_options, inputs, sorted_input_names, sorted_input_dtypes,\n-      sorted_output_names, sorted_target_node_names, input_original_indices,\n-      output_original_indices, outputs);\n+      run_options, /*graph_name=*/\"\", inputs, sorted_input_names,\n+      sorted_input_dtypes, sorted_output_names, sorted_target_node_names,\n+      input_original_indices, output_original_indices, outputs);\n }\n \n absl::Status GraphExecutor::Extend(const GraphDef& graph) {"
        },
        {
            "sha": "66d088abbbf237e1968cf0b8be4f45935f8b2b31",
            "filename": "tensorflow/core/tfrt/graph_executor/graph_executor.h",
            "status": "modified",
            "additions": 9,
            "deletions": 6,
            "changes": 15,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3bc0da7933cd06e4798382d7698fe923f5c792f2/tensorflow%2Fcore%2Ftfrt%2Fgraph_executor%2Fgraph_executor.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3bc0da7933cd06e4798382d7698fe923f5c792f2/tensorflow%2Fcore%2Ftfrt%2Fgraph_executor%2Fgraph_executor.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftfrt%2Fgraph_executor%2Fgraph_executor.h?ref=3bc0da7933cd06e4798382d7698fe923f5c792f2",
            "patch": "@@ -274,14 +274,17 @@ class GraphExecutor {\n       std::vector<tensorflow::Tensor>* outputs);\n \n   // Similar as `Run`, but it requires additional input parameters to specify\n-  // the sorted input/output names and the original indices of the\n-  // inputs/outputs. The caller must guarantee that inputs are in the same order\n-  // as of `sorted_input_names`. The sorted input/output names are needed to\n-  // consistently build the key for looking up the `LoadedClientGraph` in the\n+  // the `graph_name`, the sorted input/output names and the original indices of\n+  // the inputs/outputs. The caller must guarantee that inputs are in the same\n+  // order as of `sorted_input_names`. The sorted input/output names are needed\n+  // to consistently build the key for looking up the `LoadedClientGraph` in the\n   // cache. The original indices are needed to map the results to the original\n-  // inputs/outputs.\n+  // inputs/outputs. The `graph_name` will be used to lookup the compiled graph\n+  // in the cache. It is usually the signature name of the graph. If it is\n+  // empty, a joined name will be constructed from the sorted input/output names\n+  // to lookup the `LoadedClientGraph` in the cache.\n   absl::Status RunWithSortedInputsOutputs(\n-      const RunOptions& run_options,\n+      const RunOptions& run_options, absl::string_view graph_name,\n       absl::Span<const std::pair<std::string, tensorflow::Tensor>> inputs,\n       absl::Span<const std::string> sorted_input_names,\n       absl::Span<const tensorflow::DataType> sorted_input_dtypes,"
        }
    ],
    "stats": {
        "total": 34,
        "additions": 18,
        "deletions": 16
    }
}