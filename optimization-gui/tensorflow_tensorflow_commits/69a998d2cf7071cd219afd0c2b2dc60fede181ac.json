{
    "author": "unknown",
    "message": "Rollback change that broke presubmit build.\n\nReverts 9c8c270936133cdd51fd0e64fe66dd9f75f6bad9\n\nPiperOrigin-RevId: 827481410",
    "sha": "69a998d2cf7071cd219afd0c2b2dc60fede181ac",
    "files": [
        {
            "sha": "51a159afb44dc3783947e167126f2b0418c4ff5f",
            "filename": "third_party/xla/xla/tsl/platform/default/build_config.bzl",
            "status": "modified",
            "additions": 25,
            "deletions": 25,
            "changes": 50,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/69a998d2cf7071cd219afd0c2b2dc60fede181ac/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fbuild_config.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/69a998d2cf7071cd219afd0c2b2dc60fede181ac/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fbuild_config.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fbuild_config.bzl?ref=69a998d2cf7071cd219afd0c2b2dc60fede181ac",
            "patch": "@@ -7,19 +7,19 @@ load(\"@com_github_grpc_grpc//bazel:cc_grpc_library.bzl\", \"cc_grpc_library\")\n load(\"@com_github_grpc_grpc//bazel:python_rules.bzl\", \"py_grpc_library\")\n load(\"@com_google_protobuf//bazel:cc_proto_library.bzl\", \"cc_proto_library\")\n load(\"@com_google_protobuf//bazel:py_proto_library.bzl\", \"py_proto_library\")\n+load(\n+    \"@local_xla//xla/tsl:tsl.bzl\",\n+    \"clean_dep\",\n+    \"if_tsl_link_protobuf\",\n+)\n+load(\"@local_xla//xla/tsl/platform:build_config_root.bzl\", \"if_static\")\n load(\"@rules_cc//cc:cc_binary.bzl\", \"cc_binary\")\n load(\"@rules_cc//cc:cc_test.bzl\", _cc_test = \"cc_test\")\n load(\"@rules_python//python:py_library.bzl\", \"py_library\")\n \n # IMPORTANT: Do not remove this load statement. We rely on that //xla/tsl doesn't exist in g3\n # to prevent g3 .bzl files from loading this file.\n load(\"//xla/tsl:package_groups.bzl\", \"DEFAULT_LOAD_VISIBILITY\")\n-load(\n-    \"//xla/tsl:tsl.bzl\",\n-    \"clean_dep\",\n-    \"if_tsl_link_protobuf\",\n-)\n-load(\"//xla/tsl/platform:build_config_root.bzl\", \"if_static\")\n \n visibility(DEFAULT_LOAD_VISIBILITY)\n \n@@ -132,7 +132,7 @@ def pyx_library(\n         cc_binary(\n             name = shared_object_name,\n             srcs = [stem + \".cpp\"],\n-            deps = cc_deps + [Label(\"//third_party/python_runtime:headers\")],\n+            deps = cc_deps + [\"@local_xla//third_party/python_runtime:headers\"],\n             linkshared = 1,\n             testonly = testonly,\n             copts = copts,\n@@ -327,7 +327,7 @@ def tf_additional_lib_hdrs():\n         clean_dep(\"//xla/tsl/platform/default:tracing_impl.h\"),\n         clean_dep(\"//xla/tsl/platform/default:unbounded_work_queue.h\"),\n     ] + select({\n-        clean_dep(\"//xla/tsl:windows\"): [\n+        clean_dep(\"@local_xla//xla/tsl:windows\"): [\n             clean_dep(\"//xla/tsl/platform/windows:intrinsics_port.h\"),\n             clean_dep(\"//xla/tsl/platform/windows:stacktrace.h\"),\n             clean_dep(\"//xla/tsl/platform/windows:subprocess.h\"),\n@@ -379,19 +379,19 @@ def tf_additional_lib_deps():\n \n def tf_additional_core_deps():\n     return select({\n-        clean_dep(\"//xla/tsl:android\"): [],\n-        clean_dep(\"//xla/tsl:ios\"): [],\n-        clean_dep(\"//xla/tsl:linux_s390x\"): [],\n+        clean_dep(\"@local_xla//xla/tsl:android\"): [],\n+        clean_dep(\"@local_xla//xla/tsl:ios\"): [],\n+        clean_dep(\"@local_xla//xla/tsl:linux_s390x\"): [],\n         \"//conditions:default\": [\n-            clean_dep(\"//xla/tsl/platform/cloud:gcs_file_system\"),\n+            clean_dep(\"@local_xla//xla/tsl/platform/cloud:gcs_file_system\"),\n         ],\n     })\n \n def tf_lib_proto_parsing_deps():\n     return [\n         \":protos_all_cc\",\n         clean_dep(\"@eigen_archive//:eigen3\"),\n-        clean_dep(\"//xla/tsl/protobuf:protos_all_cc\"),\n+        clean_dep(\"@local_xla//xla/tsl/protobuf:protos_all_cc\"),\n     ]\n \n def tf_py_clif_cc(name, visibility = None, **_kwargs):\n@@ -472,7 +472,7 @@ def strict_cc_test(\n         # cases. Local builds are exempt from this enforcement to allow for development with\n         # --gtest_filter.\n         args = args + select({\n-            clean_dep(\"//xla/tsl:is_ci_build\"): [\"--gtest_fail_if_no_test_selected\"],\n+            clean_dep(\"@local_xla//xla/tsl:is_ci_build\"): [\"--gtest_fail_if_no_test_selected\"],\n             \"//conditions:default\": [],\n         })\n     _cc_test(\n@@ -511,9 +511,9 @@ def tsl_cc_test(\n                 clean_dep(\"@com_google_protobuf//:protobuf\"),\n                 # TODO(ddunleavy) remove these and add proto deps to tests\n                 # granularly\n-                clean_dep(\"//xla/tsl/protobuf:error_codes_proto_impl_cc_impl\"),\n-                clean_dep(\"//xla/tsl/protobuf:histogram_proto_cc_impl\"),\n-                clean_dep(\"//xla/tsl/protobuf:status_proto_cc_impl\"),\n+                clean_dep(\"@local_xla//xla/tsl/protobuf:error_codes_proto_impl_cc_impl\"),\n+                clean_dep(\"@local_xla//xla/tsl/protobuf:histogram_proto_cc_impl\"),\n+                clean_dep(\"@local_xla//xla/tsl/protobuf:status_proto_cc_impl\"),\n                 clean_dep(\"//tsl/profiler/protobuf:xplane_proto_cc_impl\"),\n                 clean_dep(\"//tsl/profiler/protobuf:profiler_options_proto_cc_impl\"),\n             ],\n@@ -522,7 +522,7 @@ def tsl_cc_test(\n     )\n \n def tf_portable_proto_lib():\n-    return [\"//tensorflow/core:protos_all_cc_impl\", clean_dep(\"//xla/tsl/protobuf:protos_all_cc_impl\")]\n+    return [\"//tensorflow/core:protos_all_cc_impl\", clean_dep(\"@local_xla//xla/tsl/protobuf:protos_all_cc_impl\")]\n \n def tf_protobuf_compiler_deps():\n     return if_static(\n@@ -534,22 +534,22 @@ def tf_protobuf_compiler_deps():\n \n def tf_windows_aware_platform_deps(name):\n     return select({\n-        clean_dep(\"//xla/tsl:windows\"): [\n-            clean_dep(\"//xla/tsl/platform/windows:\" + name),\n+        clean_dep(\"@local_xla//xla/tsl:windows\"): [\n+            clean_dep(\"@local_xla//xla/tsl/platform/windows:\" + name),\n         ],\n         \"//conditions:default\": [\n             clean_dep(\"//xla/tsl/platform/default:\" + name),\n         ],\n     })\n \n-def tf_platform_deps(name, platform_dir = \"//xla/tsl/platform/\"):\n-    return [clean_dep(platform_dir + \"default:\" + name)]\n+def tf_platform_deps(name, platform_dir = \"@local_xla//xla/tsl/platform/\"):\n+    return [platform_dir + \"default:\" + name]\n \n-def tf_stream_executor_deps(name, platform_dir = \"//xla/tsl/platform/\"):\n+def tf_stream_executor_deps(name, platform_dir = \"@local_xla//xla/tsl/platform/\"):\n     return tf_platform_deps(name, platform_dir)\n \n-def tf_platform_alias(name, platform_dir = \"//xla/tsl/platform/\"):\n-    return [clean_dep(platform_dir + \"default:\" + name)]\n+def tf_platform_alias(name, platform_dir = \"@local_xla//xla/tsl/platform/\"):\n+    return [platform_dir + \"default:\" + name]\n \n def tf_error_logging_deps():\n     return [clean_dep(\"//xla/tsl/platform/default:error_logging\")]"
        },
        {
            "sha": "d6b786f0fe3a89fe39d2c225e1d2d988d1e94cd7",
            "filename": "third_party/xla/xla/tsl/platform/default/build_config_root.bzl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/69a998d2cf7071cd219afd0c2b2dc60fede181ac/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fbuild_config_root.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/69a998d2cf7071cd219afd0c2b2dc60fede181ac/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fbuild_config_root.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fbuild_config_root.bzl?ref=69a998d2cf7071cd219afd0c2b2dc60fede181ac",
            "patch": "@@ -6,7 +6,7 @@ be separate to avoid cyclic references.\n \n load(\"@local_config_remote_execution//:remote_execution.bzl\", \"gpu_test_tags\")\n load(\"@local_config_rocm//rocm:build_defs.bzl\", \"is_rocm_configured\")\n-load(\"//third_party/py/rules_pywrap:pywrap.default.bzl\", \"use_pywrap_rules\")\n+load(\"@local_xla//third_party/py/rules_pywrap:pywrap.default.bzl\", \"use_pywrap_rules\")\n load(\"//xla/tsl:package_groups.bzl\", \"DEFAULT_LOAD_VISIBILITY\")\n load(\"//xla/tsl/platform/default:cuda_build_defs.bzl\", \"is_cuda_configured\")\n "
        },
        {
            "sha": "5eb1c2329dfca9a70e8cdbfb68bf68b6447c1587",
            "filename": "third_party/xla/xla/tsl/platform/default/rules_cc.bzl",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/69a998d2cf7071cd219afd0c2b2dc60fede181ac/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Frules_cc.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/69a998d2cf7071cd219afd0c2b2dc60fede181ac/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Frules_cc.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Frules_cc.bzl?ref=69a998d2cf7071cd219afd0c2b2dc60fede181ac",
            "patch": "@@ -36,6 +36,6 @@ def cc_library(name, deps = None, **kwargs):\n     # Horrifying, but needed to prevent a cycle, as `bazel_issue_21519` is an\n     # alias of `empty`.\n     if name != \"empty\":\n-        deps = deps + [Label(\"//xla/tsl:bazel_issue_21519\")]  # buildifier: disable=list-append\n-        deps = deps + [Label(\"@local_tsl//:bazel_issue_21519\")]  # buildifier: disable=list-append\n+        deps = deps + [\"@local_xla//xla/tsl:bazel_issue_21519\"]  # buildifier: disable=list-append\n+        deps = deps + [\"@local_tsl//:bazel_issue_21519\"]  # buildifier: disable=list-append\n     _cc_library(name = name, deps = deps, **kwargs)"
        }
    ],
    "stats": {
        "total": 56,
        "additions": 28,
        "deletions": 28
    }
}