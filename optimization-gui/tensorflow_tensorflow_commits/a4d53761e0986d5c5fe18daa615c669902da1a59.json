{
    "author": "nvgrw",
    "message": "Migrate batch_normalization_test to PjRt.\n\nPiperOrigin-RevId: 840428945",
    "sha": "a4d53761e0986d5c5fe18daa615c669902da1a59",
    "files": [
        {
            "sha": "fdb9151c44dd5d9abd5458fa259675e55b31848e",
            "filename": "third_party/xla/xla/tests/BUILD",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a4d53761e0986d5c5fe18daa615c669902da1a59/third_party%2Fxla%2Fxla%2Ftests%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a4d53761e0986d5c5fe18daa615c669902da1a59/third_party%2Fxla%2Fxla%2Ftests%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2FBUILD?ref=a4d53761e0986d5c5fe18daa615c669902da1a59",
            "patch": "@@ -1783,9 +1783,11 @@ xla_test(\n         \"interpreter\",\n     ],\n     shard_count = 40,\n+    tags = [\"test_migrated_to_hlo_runner_pjrt\"],\n     deps = [\n         \":client_library_test_runner_mixin\",\n-        \":hlo_test_base\",\n+        \":hlo_pjrt_interpreter_reference_mixin\",\n+        \":hlo_pjrt_test_base\",\n         \":xla_internal_test_main\",\n         \"//xla:array2d\",\n         \"//xla:array3d\","
        },
        {
            "sha": "cdcb2f868e607157b4ae2748ea99660a499c3fce",
            "filename": "third_party/xla/xla/tests/batch_normalization_test.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a4d53761e0986d5c5fe18daa615c669902da1a59/third_party%2Fxla%2Fxla%2Ftests%2Fbatch_normalization_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a4d53761e0986d5c5fe18daa615c669902da1a59/third_party%2Fxla%2Fxla%2Ftests%2Fbatch_normalization_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fbatch_normalization_test.cc?ref=a4d53761e0986d5c5fe18daa615c669902da1a59",
            "patch": "@@ -38,7 +38,8 @@ limitations under the License.\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n #include \"xla/tests/client_library_test_runner_mixin.h\"\n-#include \"xla/tests/hlo_test_base.h\"\n+#include \"xla/tests/hlo_pjrt_interpreter_reference_mixin.h\"\n+#include \"xla/tests/hlo_pjrt_test_base.h\"\n #include \"xla/tsl/lib/math/math_util.h\"\n #include \"xla/tsl/platform/test.h\"\n #include \"xla/types.h\"\n@@ -51,7 +52,8 @@ namespace {\n constexpr ErrorSpec kErrorSpec{0.001, 0.001};\n \n class BatchNormalizationTest\n-    : public ClientLibraryTestRunnerMixin<HloTestBase> {\n+    : public ClientLibraryTestRunnerMixin<\n+          HloPjRtInterpreterReferenceMixin<HloPjRtTestBase>> {\n  protected:\n   BatchNormalizationTest() : input_array_(kSamples, kZ, kY, kX) {\n     Array2D<float> pz({\n@@ -467,7 +469,8 @@ struct BatchNormTestParam {\n \n // Tests to test the fused operation of BatchNorm.\n class BatchNormTestManySizes\n-    : public ClientLibraryTestRunnerMixin<HloTestBase>,\n+    : public ClientLibraryTestRunnerMixin<\n+          HloPjRtInterpreterReferenceMixin<HloPjRtTestBase>>,\n       public ::testing::WithParamInterface<BatchNormTestParam> {};\n \n std::vector<BatchNormTestParam> BuildBatchNormTestParams() {"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 9,
        "deletions": 4
    }
}