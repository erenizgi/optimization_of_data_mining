{
    "author": "tensorflower-gardener",
    "message": "[IFRT] Introduce `MpmdLoadedExecutable` for MPMD-specific interfaces.\n\nThis change adds a new `MpmdLoadedExecutable` abstract class, inheriting from `LoadedExecutable`, to provide interfaces specific to Multi-Program Multi-Data (MPMD) execution.\n\nPiperOrigin-RevId: 817025768",
    "sha": "b37aebef19c2f85da4c2f855a3472470d2efd821",
    "files": [
        {
            "sha": "2c0276a28e43703c79bdc649e96039882926ef0d",
            "filename": "third_party/xla/xla/python/ifrt/BUILD",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b37aebef19c2f85da4c2f855a3472470d2efd821/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b37aebef19c2f85da4c2f855a3472470d2efd821/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2FBUILD?ref=b37aebef19c2f85da4c2f855a3472470d2efd821",
            "patch": "@@ -1195,6 +1195,22 @@ cc_library(\n     ],\n )\n \n+cc_library(\n+    name = \"mpmd_executable\",\n+    srcs = [\"mpmd_executable.cc\"],\n+    hdrs = [\"mpmd_executable.h\"],\n+    deps = [\n+        \":attribute_map\",\n+        \":ifrt\",\n+        \"//xla/hlo/ir:hlo\",\n+        \"//xla/pjrt:pjrt_executable\",\n+        \"@com_google_absl//absl/container:flat_hash_map\",\n+        \"@com_google_absl//absl/status:statusor\",\n+        \"@com_google_absl//absl/types:span\",\n+        \"@llvm-project//llvm:Support\",\n+    ],\n+)\n+\n xla_cc_test(\n     name = \"user_context_status_util_test\",\n     srcs = [\"user_context_status_util_test.cc\"],"
        },
        {
            "sha": "ec31a6710e89c25b8c4d35b7773b918f41fbb3e0",
            "filename": "third_party/xla/xla/python/ifrt/mpmd_executable.cc",
            "status": "added",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b37aebef19c2f85da4c2f855a3472470d2efd821/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fmpmd_executable.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b37aebef19c2f85da4c2f855a3472470d2efd821/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fmpmd_executable.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fmpmd_executable.cc?ref=b37aebef19c2f85da4c2f855a3472470d2efd821",
            "patch": "@@ -0,0 +1,24 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#include \"xla/python/ifrt/mpmd_executable.h\"\n+\n+namespace xla {\n+namespace ifrt {\n+\n+char MpmdLoadedExecutable::ID = 0;\n+\n+}  // namespace ifrt\n+}  // namespace xla"
        },
        {
            "sha": "53ecbb60299d64fa2a9ec44fa181dd4b236238b2",
            "filename": "third_party/xla/xla/python/ifrt/mpmd_executable.h",
            "status": "added",
            "additions": 68,
            "deletions": 0,
            "changes": 68,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b37aebef19c2f85da4c2f855a3472470d2efd821/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fmpmd_executable.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b37aebef19c2f85da4c2f855a3472470d2efd821/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fmpmd_executable.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fmpmd_executable.h?ref=b37aebef19c2f85da4c2f855a3472470d2efd821",
            "patch": "@@ -0,0 +1,68 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#ifndef XLA_PYTHON_IFRT_MPMD_EXECUTABLE_H_\n+#define XLA_PYTHON_IFRT_MPMD_EXECUTABLE_H_\n+\n+#include <memory>\n+#include <string>\n+#include <vector>\n+\n+#include \"absl/container/flat_hash_map.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"absl/types/span.h\"\n+#include \"llvm/Support/ExtensibleRTTI.h\"\n+#include \"xla/hlo/ir/hlo_module.h\"\n+#include \"xla/pjrt/pjrt_executable.h\"\n+#include \"xla/python/ifrt/attribute_map.h\"\n+#include \"xla/python/ifrt/device.h\"\n+#include \"xla/python/ifrt/executable.h\"\n+\n+namespace xla {\n+namespace ifrt {\n+\n+// Wraps a computation that has been fully compiled and loaded for MPMD\n+// execution.\n+class MpmdLoadedExecutable\n+    : public llvm::RTTIExtends<MpmdLoadedExecutable, LoadedExecutable> {\n+ public:\n+  // MPMD-specific interfaces.\n+\n+  // Returns a mapping between atom program name and addressable devices.\n+  virtual absl::StatusOr<\n+      absl::flat_hash_map<std::string, absl::Span<Device* const>>>\n+  GetMpmdAddressableDevices() const = 0;\n+\n+  // Returns a mapping between atom program name and CompiledMemoryStats.\n+  virtual absl::StatusOr<absl::flat_hash_map<std::string, CompiledMemoryStats>>\n+  GetMpmdCompiledMemoryStats() const = 0;\n+\n+  // Returns a mapping between atom program name and a vector of HLO modules,\n+  // with an entry for each partition.\n+  virtual absl::StatusOr<\n+      absl::flat_hash_map<std::string, std::vector<std::shared_ptr<HloModule>>>>\n+  GetMpmdHloModules() const = 0;\n+\n+  // Returns a mapping between atom program name and map of cost properties.\n+  virtual absl::StatusOr<absl::flat_hash_map<std::string, AttributeMap>>\n+  GetMpmdCostAnalysis() const = 0;\n+\n+  static char ID;  // NOLINT\n+};\n+\n+}  // namespace ifrt\n+}  // namespace xla\n+\n+#endif  // XLA_PYTHON_IFRT_MPMD_EXECUTABLE_H_"
        }
    ],
    "stats": {
        "total": 108,
        "additions": 108,
        "deletions": 0
    }
}