{
    "author": "nvgrw",
    "message": "Provide access to default device assignment via HloRunnerInterface.\n\nPiperOrigin-RevId: 810486071",
    "sha": "9a93fecaea13a4951ba1eeff4de59daf96340761",
    "files": [
        {
            "sha": "24b46e62670569b4b7edf4759f14afd4a26ac924",
            "filename": "third_party/xla/xla/service/hlo_runner.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner.cc?ref=9a93fecaea13a4951ba1eeff4de59daf96340761",
            "patch": "@@ -869,6 +869,12 @@ absl::StatusOr<const HloProto* absl_nonnull> HloRunner::HloProtoFromWrapped(\n   return hlo_runner_executable->executable()->hlo_proto();\n }\n \n+absl::StatusOr<DeviceAssignment> HloRunner::GetDefaultDeviceAssignment(\n+    int num_replicas, int num_partitions) const {\n+  return backend().computation_placer()->AssignDevices(num_replicas,\n+                                                       num_partitions);\n+}\n+\n void HloRunner::MaybeUpdateEntryComputationLayout(HloModule* module) {\n   absl::MutexLock lock(&mu_);\n   if (module_ids_with_updated_layouts_.insert(module->unique_id()).second) {"
        },
        {
            "sha": "3059cf690245bbaa734c2614a57e028acac1fd11",
            "filename": "third_party/xla/xla/service/hlo_runner.h",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner.h?ref=9a93fecaea13a4951ba1eeff4de59daf96340761",
            "patch": "@@ -235,6 +235,9 @@ class HloRunner : public HloRunnerInterface {\n     return false;\n   }\n \n+  absl::StatusOr<DeviceAssignment> GetDefaultDeviceAssignment(\n+      int num_replicas, int num_partitions) const override;\n+\n  private:\n   absl::StatusOr<ScopedShapedBuffer> TransferLiteralToDevice(\n       const Literal& literal,"
        },
        {
            "sha": "4c1e98184a75ec50da8c2bf0e211c30de81b11c4",
            "filename": "third_party/xla/xla/service/hlo_runner_interface.h",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_interface.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_interface.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_interface.h?ref=9a93fecaea13a4951ba1eeff4de59daf96340761",
            "patch": "@@ -321,6 +321,9 @@ class HloRunnerInterface {\n   virtual bool ExecutablesAreEquivalent(\n       const OpaqueExecutable* absl_nonnull lhs,\n       const OpaqueExecutable* absl_nonnull rhs) const = 0;\n+\n+  virtual absl::StatusOr<DeviceAssignment> GetDefaultDeviceAssignment(\n+      int num_replicas, int num_partitions) const = 0;\n };\n \n }  // namespace xla"
        },
        {
            "sha": "3609ab7dd714707a4923da2a69a814419affc2f9",
            "filename": "third_party/xla/xla/service/hlo_runner_pjrt.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_pjrt.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_pjrt.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_pjrt.cc?ref=9a93fecaea13a4951ba1eeff4de59daf96340761",
            "patch": "@@ -884,6 +884,11 @@ bool HloRunnerPjRt::ExecutablesAreEquivalent(\n   return *lhs_fingerprint == *rhs_fingerprint;\n }\n \n+absl::StatusOr<DeviceAssignment> HloRunnerPjRt::GetDefaultDeviceAssignment(\n+    int num_replicas, int num_partitions) const {\n+  return pjrt_client_->GetDefaultDeviceAssignment(num_replicas, num_partitions);\n+}\n+\n // Split-phase HloRunnerPjRt implementations:\n \n namespace {"
        },
        {
            "sha": "c01c62980d283e8211ba1a1a7c6ebcf358cbb2a5",
            "filename": "third_party/xla/xla/service/hlo_runner_pjrt.h",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_pjrt.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9a93fecaea13a4951ba1eeff4de59daf96340761/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_pjrt.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_pjrt.h?ref=9a93fecaea13a4951ba1eeff4de59daf96340761",
            "patch": "@@ -128,6 +128,9 @@ class HloRunnerPjRt : public HloRunnerInterface {\n       const OpaqueExecutable* absl_nonnull lhs,\n       const OpaqueExecutable* absl_nonnull rhs) const override;\n \n+  absl::StatusOr<DeviceAssignment> GetDefaultDeviceAssignment(\n+      int num_replicas, int num_partitions) const override;\n+\n  private:\n   absl::StatusOr<CompileOptions> GenerateDefaultCompileOptions(\n       HloModule* module, bool run_hlo_passes);"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 20,
        "deletions": 0
    }
}