{
    "author": "tensorflower-gardener",
    "message": "Encapsulate XLA compilation error payload handling.\n\nPiperOrigin-RevId: 817301328",
    "sha": "d4c168b03067c0a67928f95a96f08b2e880240ee",
    "files": [
        {
            "sha": "2a269a3caa2588da312ada075806c6f710a51ae3",
            "filename": "third_party/xla/xla/pjrt/errors.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d4c168b03067c0a67928f95a96f08b2e880240ee/third_party%2Fxla%2Fxla%2Fpjrt%2Ferrors.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d4c168b03067c0a67928f95a96f08b2e880240ee/third_party%2Fxla%2Fxla%2Fpjrt%2Ferrors.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Ferrors.cc?ref=d4c168b03067c0a67928f95a96f08b2e880240ee",
            "patch": "@@ -20,6 +20,15 @@ limitations under the License.\n #include \"absl/strings/string_view.h\"\n \n namespace xla {\n+// The payload attached to the absl::Status returned by the compilation\n+// service when the compilation fails due to compilation errors.\n+inline constexpr absl::string_view kCompilationErrorPayload =\n+    \"compilation_error\";\n+\n+bool HasCompilationErrorPayload(const absl::Status& status) {\n+  return status.GetPayload(kCompilationErrorPayload).has_value();\n+}\n+\n absl::Status SetCompilationErrorWithPayload(absl::Status status) {\n   status.SetPayload(kCompilationErrorPayload, absl::Cord(\"\"));\n   return status;"
        },
        {
            "sha": "9bb95c78912483f25776cff684e678216fb94ff4",
            "filename": "third_party/xla/xla/pjrt/errors.h",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d4c168b03067c0a67928f95a96f08b2e880240ee/third_party%2Fxla%2Fxla%2Fpjrt%2Ferrors.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d4c168b03067c0a67928f95a96f08b2e880240ee/third_party%2Fxla%2Fxla%2Fpjrt%2Ferrors.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Ferrors.h?ref=d4c168b03067c0a67928f95a96f08b2e880240ee",
            "patch": "@@ -17,13 +17,11 @@ limitations under the License.\n #define XLA_PJRT_ERRORS_H_\n \n #include \"absl/status/status.h\"\n-#include \"absl/strings/string_view.h\"\n \n namespace xla {\n-// The payload attached to the absl::Status returned by the compilation\n-// service when the compilation fails due to compilation errors.\n-inline constexpr absl::string_view kCompilationErrorPayload =\n-    \"compilation_error\";\n+\n+// Returns true if the status has the compilation error payload.\n+bool HasCompilationErrorPayload(const absl::Status& status);\n \n // Sets the payload of the compilation error status to the compilation error\n // payload. Useful to denote compilation errors separately from other errors."
        },
        {
            "sha": "b1d5dfdfd5a3889170b78d79df957c08689b573d",
            "filename": "third_party/xla/xla/pjrt/errors_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d4c168b03067c0a67928f95a96f08b2e880240ee/third_party%2Fxla%2Fxla%2Fpjrt%2Ferrors_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d4c168b03067c0a67928f95a96f08b2e880240ee/third_party%2Fxla%2Fxla%2Fpjrt%2Ferrors_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Ferrors_test.cc?ref=d4c168b03067c0a67928f95a96f08b2e880240ee",
            "patch": "@@ -30,8 +30,7 @@ TEST(ErrorsTest, SetCompilationErrorWithPayload) {\n   absl::Status status_with_payload = SetCompilationErrorWithPayload(status);\n   EXPECT_THAT(status_with_payload, StatusIs(absl::StatusCode::kInvalidArgument,\n                                             HasSubstr(\"test error\")));\n-  EXPECT_TRUE(\n-      status_with_payload.GetPayload(kCompilationErrorPayload).has_value());\n+  EXPECT_TRUE(HasCompilationErrorPayload(status_with_payload));\n }\n \n }  // namespace xla"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 13,
        "deletions": 7
    }
}