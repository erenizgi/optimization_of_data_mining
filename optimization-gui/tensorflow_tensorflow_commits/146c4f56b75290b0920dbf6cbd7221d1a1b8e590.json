{
    "author": "ZixuanJiang",
    "message": "Clear frontend attributes for get-tuple-elements of GlobalToLocal and LocalToGlobal custom-calls.\n\nThe GlobalToLocal and LocalToGlobal custom-calls are for Shardy round trip. These get-tuple-elements will be removed when we import the Shardy dialect and thus they do not need to hold frontend attributes.\n\nThis can reduce the size of the generated HLO module text.\n\nPiperOrigin-RevId: 826134489",
    "sha": "146c4f56b75290b0920dbf6cbd7221d1a1b8e590",
    "files": [
        {
            "sha": "f8a0e730265aae6981b2db8dac6fcc65d190df5b",
            "filename": "third_party/xla/xla/hlo/translate/mhlo_to_hlo/mlir_hlo_to_hlo.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/146c4f56b75290b0920dbf6cbd7221d1a1b8e590/third_party%2Fxla%2Fxla%2Fhlo%2Ftranslate%2Fmhlo_to_hlo%2Fmlir_hlo_to_hlo.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/146c4f56b75290b0920dbf6cbd7221d1a1b8e590/third_party%2Fxla%2Fxla%2Fhlo%2Ftranslate%2Fmhlo_to_hlo%2Fmlir_hlo_to_hlo.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Ftranslate%2Fmhlo_to_hlo%2Fmlir_hlo_to_hlo.cc?ref=146c4f56b75290b0920dbf6cbd7221d1a1b8e590",
            "patch": "@@ -4428,6 +4428,15 @@ LogicalResult ExportXlaOp(CustomCallOp op, OpLoweringContext ctx) {\n \n   if (op->getNumResults() == 1 && !return_tuple) {\n     value_map[op.getResult(0)] = custom_call;\n+  } else if (op.getCallTargetName() ==\n+                 xla::sdy::kGlobalToLocalShapeCallTargetName ||\n+             op.getCallTargetName() ==\n+                 xla::sdy::kLocalToGlobalShapeCallTargetName) {\n+    // We will convert HLO to StableHLO in the ShardyXLA pipeline. These\n+    // get-tuple-elements does not need to hold the frontend attributes.\n+    xla::XlaScopedFrontendAttributesAssignment frontend_attributes_scope(\n+        ctx.builder, xla::FrontendAttributes());\n+    BuildGetTupleElementsForTupleResults(op, custom_call, ctx);\n   } else {\n     BuildGetTupleElementsForTupleResults(op, custom_call, ctx);\n   }"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 9,
        "deletions": 0
    }
}