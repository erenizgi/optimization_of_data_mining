{
    "author": "Tongfei-Guo",
    "message": "[XLA] Use default implementation of `RunOnModuleGroup` for cycle detection.\n\nPiperOrigin-RevId: 816243614",
    "sha": "42d2e59e5cf02f1735afb5ef8b161a33edf214d0",
    "files": [
        {
            "sha": "bb50c18e87187bce1a03a8a4914e1e495ca6f561",
            "filename": "third_party/xla/xla/service/hlo_cycle_detection.h",
            "status": "modified",
            "additions": 3,
            "deletions": 17,
            "changes": 20,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/42d2e59e5cf02f1735afb5ef8b161a33edf214d0/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_cycle_detection.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/42d2e59e5cf02f1735afb5ef8b161a33edf214d0/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_cycle_detection.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_cycle_detection.h?ref=42d2e59e5cf02f1735afb5ef8b161a33edf214d0",
            "patch": "@@ -33,20 +33,15 @@ namespace xla {\n \n class CycleDetectionVisitor : public DfsHloVisitorWithDefault {\n  public:\n-  absl::Status VerifyNoCycle(HloModule* module) {\n-    for (auto* comp : module->computations()) {\n-      TF_RETURN_IF_ERROR(comp->Accept(this));\n-    }\n-    return absl::OkStatus();\n-  }\n   // Relies on HloInstruction::Accept() to run PostOrderDFS which does cycle\n   // detection by default.\n-  absl::Status VerifyNoCycle(HloModuleGroup* module_group) {\n-    for (auto* comp : module_group->module(0).computations()) {\n+  absl::Status VerifyNoCycle(HloModule* module) {\n+    for (auto* comp : module->computations()) {\n       TF_RETURN_IF_ERROR(comp->Accept(this));\n     }\n     return absl::OkStatus();\n   }\n+\n   absl::Status DefaultAction(HloInstruction* instruction) override {\n     return absl::OkStatus();\n   }\n@@ -66,15 +61,6 @@ class HloCycleDetection : public HloModulePass {\n     return false;\n   }\n \n-  using HloPassInterface::RunOnModuleGroup;\n-  absl::StatusOr<bool> RunOnModuleGroup(\n-      HloModuleGroup* module_group,\n-      const absl::flat_hash_set<absl::string_view>& execution_threads)\n-      override {\n-    TF_RETURN_IF_ERROR(visitor_.VerifyNoCycle(module_group));\n-    return false;\n-  }\n-\n  private:\n   CycleDetectionVisitor visitor_;\n };"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 3,
        "deletions": 17
    }
}