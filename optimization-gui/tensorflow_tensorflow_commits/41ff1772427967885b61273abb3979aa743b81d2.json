{
    "author": "tensorflower-gardener",
    "message": "Avoid GetIndex calculations for transiently created hlo instructions.\n\nPiperOrigin-RevId: 802607045",
    "sha": "41ff1772427967885b61273abb3979aa743b81d2",
    "files": [
        {
            "sha": "24397d64f4011581303c7df27971f439e222297c",
            "filename": "third_party/xla/xla/hlo/analysis/hlo_reachability.h",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/41ff1772427967885b61273abb3979aa743b81d2/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fhlo_reachability.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/41ff1772427967885b61273abb3979aa743b81d2/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fhlo_reachability.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fanalysis%2Fhlo_reachability.h?ref=41ff1772427967885b61273abb3979aa743b81d2",
            "patch": "@@ -132,7 +132,13 @@ class HloReachabilityMap {\n \n   // Checks if an instruction is in the Reachability map.\n   bool IsPresent(const HloInstruction* instruction) const {\n-    return indices_.contains(GetKey(instruction));\n+    // If we cannot construct the key, then the instruction is not in the\n+    // reachability map.\n+    return (instruction == nullptr\n+                ? false\n+                : (instruction->GetModule() != nullptr\n+                       ? indices_.contains(GetKey(instruction))\n+                       : false));\n   }\n \n   // Replace the instruction \"original\" with \"replacement\" in the reachability"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 7,
        "deletions": 1
    }
}