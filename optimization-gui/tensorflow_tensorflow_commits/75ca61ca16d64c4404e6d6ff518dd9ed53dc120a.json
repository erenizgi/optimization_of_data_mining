{
    "author": "alexander-shaposhnikov",
    "message": "Add missing ynn_params.\n\nPiperOrigin-RevId: 835119986",
    "sha": "75ca61ca16d64c4404e6d6ff518dd9ed53dc120a",
    "files": [
        {
            "sha": "de6b36916ae05693205f16a4a4d4198ded197b40",
            "filename": "third_party/xla/xla/service/cpu/cpu_executable.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/75ca61ca16d64c4404e6d6ff518dd9ed53dc120a/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_executable.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/75ca61ca16d64c4404e6d6ff518dd9ed53dc120a/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_executable.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_executable.cc?ref=75ca61ca16d64c4404e6d6ff518dd9ed53dc120a",
            "patch": "@@ -275,6 +275,12 @@ absl::Status CpuExecutable::ExecuteThunks(\n     TF_ASSIGN_OR_RETURN(xnn_params, Thunk::XnnParams::Create(run_options));\n   }\n \n+  // Prepare for executing YNNPACK fusions.\n+  std::optional<Thunk::YnnParams> ynn_params;\n+  if (has_ynn_fusions()) {\n+    TF_ASSIGN_OR_RETURN(ynn_params, Thunk::YnnParams::Create(run_options));\n+  }\n+\n   // Use the intra-op thread pool to offload thunk executor tasks.\n   auto* intra_op_thread_pool = run_options->intra_op_thread_pool();\n   ThreadPoolTaskRunner task_runner(\n@@ -288,7 +294,8 @@ absl::Status CpuExecutable::ExecuteThunks(\n       &task_runner,\n       &collective_execute_params,\n       &custom_call_execute_params,\n-      xnn_params ? &*xnn_params : nullptr};\n+      xnn_params ? &*xnn_params : nullptr,\n+      ynn_params ? &*ynn_params : nullptr};\n \n   auto executed_event = thunks_->Execute(execute_params);\n "
        }
    ],
    "stats": {
        "total": 9,
        "additions": 8,
        "deletions": 1
    }
}