{
    "author": "ezhulenev",
    "message": "[xla:hlo] Do not initialize rare fields for empty statistics proto\n\nPiperOrigin-RevId: 797598724",
    "sha": "dc322f8cba974e24962ca05f4bc742d1264a113d",
    "files": [
        {
            "sha": "3a2d33553cfb2feba130d9be2452951adfbc08d7",
            "filename": "third_party/xla/xla/hlo/ir/hlo_instruction.h",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/dc322f8cba974e24962ca05f4bc742d1264a113d/third_party%2Fxla%2Fxla%2Fhlo%2Fir%2Fhlo_instruction.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/dc322f8cba974e24962ca05f4bc742d1264a113d/third_party%2Fxla%2Fxla%2Fhlo%2Fir%2Fhlo_instruction.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fir%2Fhlo_instruction.h?ref=dc322f8cba974e24962ca05f4bc742d1264a113d",
            "patch": "@@ -1981,6 +1981,10 @@ class HloInstruction {\n   }\n \n   void set_statistics_viz(StatisticsViz statistics_viz) {\n+    if (!has_rare() && statistics_viz.stat_index_to_visualize() == 0 &&\n+        statistics_viz.statistics().empty()) {\n+      return;\n+    }\n     mutable_rare()->statistics_viz = std::move(statistics_viz);\n   }\n "
        }
    ],
    "stats": {
        "total": 4,
        "additions": 4,
        "deletions": 0
    }
}