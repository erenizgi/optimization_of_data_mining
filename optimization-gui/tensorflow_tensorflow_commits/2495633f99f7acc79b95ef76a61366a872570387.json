{
    "author": "bhavani-subramanian",
    "message": "PR #30716: [XLA:GPU][oneAPI] SYCL context and device pool\n\nImported from GitHub PR https://github.com/openxla/xla/pull/30716\n\nCo-author: @kanvi-nervana\n\nThis PR implements SYCL context and device-pool and adds corresponding tests. It has no dependencies.\nCopybara import of the project:\n\n--\n59caf55113280cf8b79b3e8c8de8f2c2da83706a by Bhavani Subramanian <bhavani1.subramanian@intel.com>:\n\nAdded SYCL context, SyclDevicePool and tests\n\n--\n56b00fdbdcdcdcd765688378b632a9b9deb43cf9 by Bhavani Subramanian <bhavani1.subramanian@intel.com>:\n\nAddressed review comments.\n- Use absl instead of TSL if possible.\n- Combine TF_ASSERT_OK and EXPECT_GT with EXPECT_THAT(cond, IsOkAndHolds(Gt()))\n- Use absl::string_view instead of std::string in IsValidDeviceOrdinal().\n- Remove static annotation.\n- Use actual type name instead of auto unless it is obvious.\n- Use namespace stream_executor::sycl instead of stream_executor::gpu.\n\n--\n3e3cc1a36b500946aec9de821e280ead23c1fb8d by Bhavani Subramanian <bhavani1.subramanian@intel.com>:\n\nReturn a static sycl context from SyclDevicePool::GetDeviceContext\n\n--\nd48f9d29107944d55cdf4ca268ea67bd13678c2f by Bhavani Subramanian <bhavani1.subramanian@intel.com>:\n\nFixed sycl_platform_test failure on CPU\n\n--\n7a3f40a4d8a9690977ddecc1defe8c15fee90e15 by Bhavani Subramanian <bhavani1.subramanian@intel.com>:\n\nUpdated copyright section in sycl_gpu_runtime\n\nMerging this change closes #30716\n\nPiperOrigin-RevId: 815750270",
    "sha": "2495633f99f7acc79b95ef76a61366a872570387",
    "files": [
        {
            "sha": "5b16d09437d6dc81a94c8956ad8d4c9d7903636b",
            "filename": "third_party/xla/xla/stream_executor/sycl/BUILD",
            "status": "modified",
            "additions": 72,
            "deletions": 8,
            "changes": 80,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2FBUILD?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -47,14 +47,12 @@ cc_library(\n         \"//xla/stream_executor:platform_manager\",\n         \"//xla/stream_executor:stream_executor_h\",\n         \"//xla/stream_executor/platform:initialize\",\n-        \"@com_google_absl//absl/base\",\n+        \"//xla/tsl/platform:errors\",\n+        \"//xla/tsl/platform:status\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n-        \"@com_google_absl//absl/strings:str_format\",\n-        \"@local_tsl//tsl/platform:errors\",\n-        \"@local_tsl//tsl/platform:status\",\n     ],\n     alwayslink = True,  # Registers itself with the PlatformManager.\n )\n@@ -66,11 +64,11 @@ xla_cc_test(\n     fail_if_no_test_selected = False,  # NOLINT=If not building with SYCL, we don't have any tests linked.\n     deps = [\n         \":sycl_platform\",\n+        \":sycl_platform_id\",\n         \"//xla/stream_executor:platform\",\n         \"//xla/stream_executor:platform_manager\",\n+        \"//xla/tsl/platform:statusor\",\n         \"@com_google_googletest//:gtest_main\",\n-        \"@local_tsl//tsl/platform:statusor\",\n-        \"@local_tsl//tsl/platform:test\",\n     ],\n )\n \n@@ -160,8 +158,8 @@ sycl_library(\n     ],\n     deps = [\n         \"//xla/stream_executor:stream_executor_h\",\n+        \"//xla/tsl/platform:logging\",\n         \"@com_google_absl//absl/status:statusor\",\n-        \"@local_tsl//tsl/platform:logging\",\n     ],\n )\n \n@@ -174,6 +172,7 @@ xla_test(\n         \"oneapi-only\",\n     ],\n     deps = [\n+        \":sycl_platform_id\",\n         \"//xla/stream_executor:kernel\",\n         \"//xla/stream_executor:launch_dim\",\n         \"//xla/stream_executor:platform\",\n@@ -213,8 +212,8 @@ xla_test(\n     ],\n     deps = [\n         \":sycl_event\",\n+        \":sycl_platform_id\",\n         \"//xla/stream_executor:platform_manager\",\n-        \"//xla/stream_executor/sycl:sycl_platform_id\",\n         \"@com_google_googletest//:gtest_main\",\n     ],\n )\n@@ -253,3 +252,68 @@ xla_test(\n         \"@com_google_googletest//:gtest_main\",\n     ],\n )\n+\n+sycl_library(\n+    name = \"sycl_gpu_runtime\",\n+    srcs = [\"sycl_gpu_runtime.cc\"],\n+    hdrs = [\"sycl_gpu_runtime.h\"],\n+    tags = [\n+        \"gpu\",\n+        \"oneapi-only\",\n+    ],\n+    deps = [\n+        \":sycl_status\",\n+        \"//xla/tsl/platform:statusor\",\n+        \"//xla/tsl/util:env_var\",\n+        \"@com_google_absl//absl/strings\",\n+    ],\n+)\n+\n+xla_test(\n+    name = \"sycl_gpu_runtime_test\",\n+    srcs = [\"sycl_gpu_runtime_test.cc\"],\n+    backends = [\"gpu\"],\n+    tags = [\n+        \"gpu\",\n+        \"oneapi-only\",\n+    ],\n+    deps = [\n+        \":sycl_gpu_runtime\",\n+        \"//xla/tsl/platform:status_matchers\",\n+        \"@com_google_googletest//:gtest_main\",\n+    ],\n+)\n+\n+sycl_library(\n+    name = \"sycl_context\",\n+    srcs = [\"sycl_context.cc\"],\n+    hdrs = [\"sycl_context.h\"],\n+    tags = [\n+        \"gpu\",\n+        \"oneapi-only\",\n+    ],\n+    deps = [\n+        \":sycl_gpu_runtime\",\n+        \"//xla/stream_executor/gpu:context\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/status:statusor\",\n+        \"@com_google_absl//absl/strings\",\n+    ],\n+)\n+\n+xla_test(\n+    name = \"sycl_context_test\",\n+    srcs = [\"sycl_context_test.cc\"],\n+    backends = [\"gpu\"],\n+    tags = [\n+        \"gpu\",\n+        \"oneapi-only\",\n+    ],\n+    deps = [\n+        \":sycl_context\",\n+        \":sycl_platform_id\",\n+        \"//xla/stream_executor:platform_manager\",\n+        \"//xla/stream_executor:stream_executor_h\",\n+        \"@com_google_googletest//:gtest_main\",\n+    ],\n+)"
        },
        {
            "sha": "63d26774732f3a64a11e0b2cd7ce609a66095a47",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_context.cc",
            "status": "added",
            "additions": 38,
            "deletions": 0,
            "changes": 38,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_context.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_context.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_context.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -0,0 +1,38 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#include \"xla/stream_executor/sycl/sycl_context.h\"\n+\n+namespace stream_executor::sycl {\n+\n+absl::StatusOr<std::unique_ptr<SyclContext>> SyclContext::Create(\n+    int device_ordinal) {\n+  TF_ASSIGN_OR_RETURN(::sycl::context sycl_context,\n+                      SyclDevicePool::GetDeviceContext());\n+  return std::make_unique<SyclContext>(sycl_context, device_ordinal);\n+}\n+\n+absl::StatusOr<uint64_t> SyclContext::GetDeviceTotalMemory(\n+    const ::sycl::device& device) {\n+  return device.get_info<::sycl::info::device::global_mem_size>();\n+}\n+\n+absl::Status SyclContext::Synchronize() {\n+  // TODO(intel-tf): Add this feature once SyclStreamPool class is implemented.\n+  return absl::UnimplementedError(\n+      \"SyclContext::Synchronize is not implemented for SYCL platform.\");\n+}\n+\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "e6f60a61803ee64cce37265d6de61b830f155f43",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_context.h",
            "status": "added",
            "additions": 79,
            "deletions": 0,
            "changes": 79,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_context.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_context.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_context.h?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -0,0 +1,79 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#ifndef XLA_STREAM_EXECUTOR_SYCL_SYCL_CONTEXT_H_\n+#define XLA_STREAM_EXECUTOR_SYCL_SYCL_CONTEXT_H_\n+\n+#include \"absl/log/log.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"xla/stream_executor/gpu/context.h\"\n+#include \"xla/stream_executor/sycl/sycl_gpu_runtime.h\"\n+\n+namespace stream_executor::sycl {\n+\n+// SyclContext is a wrapper around SYCL context that provides methods to\n+// create/synchronize contexts and get device memory information.\n+class SyclContext : public gpu::Context {\n+ public:\n+  // Initializes the SYCL context with the given device ordinal.\n+  explicit SyclContext(::sycl::context context, const int device_ordinal)\n+      : context_(context), device_ordinal_(device_ordinal) {}\n+\n+  // No explicit destructor is needed since ::sycl::context is an RAII object.\n+  ~SyclContext() override = default;\n+\n+  ::sycl::context context() const { return context_; }\n+\n+  // SYCL does not have a concept of an active context like CUDA/ROCm.\n+  // SYCL contexts are created and used directly without needing to set them\n+  // as active. These methods are provided to maintain interface consistency\n+  // with other backends.\n+  void SetActive() override {\n+    LOG(WARNING) << \"SetActive is not supported for SYCL context\";\n+  }\n+\n+  bool IsActive() const override {\n+    LOG(WARNING) << \"IsActive is not supported for SYCL context\";\n+    return false;\n+  }\n+\n+  int device_ordinal() const override { return device_ordinal_; }\n+\n+  // Synchronizes all streams associated with device_ordinal_.\n+  absl::Status Synchronize() override;\n+\n+  // Ensure SyclContext is moveable but not copyable.\n+  SyclContext(const SyclContext&) = delete;\n+  SyclContext& operator=(const SyclContext&) = delete;\n+  SyclContext(SyclContext&& other) noexcept;\n+  SyclContext& operator=(SyclContext&& other) noexcept;\n+\n+  // Returns the total amount of memory available on the given device.\n+  static absl::StatusOr<uint64_t> GetDeviceTotalMemory(\n+      const ::sycl::device& device);\n+\n+  // Creates a new context for the given device ordinal.\n+  // Returns an error if the context cannot be created.\n+  static absl::StatusOr<std::unique_ptr<SyclContext>> Create(\n+      int device_ordinal);\n+\n+ private:\n+  ::sycl::context context_;\n+  const int device_ordinal_;\n+};\n+\n+}  // namespace stream_executor::sycl\n+\n+#endif  // XLA_STREAM_EXECUTOR_SYCL_SYCL_CONTEXT_H_"
        },
        {
            "sha": "9f6df42a38d226545737c02e71bc4f60bd798ead",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_context_test.cc",
            "status": "added",
            "additions": 54,
            "deletions": 0,
            "changes": 54,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_context_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_context_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_context_test.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -0,0 +1,54 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+#include \"xla/stream_executor/sycl/sycl_context.h\"\n+\n+#include <gtest/gtest.h>\n+#include \"xla/stream_executor/platform_manager.h\"\n+#include \"xla/stream_executor/stream_executor.h\"\n+#include \"xla/stream_executor/sycl/sycl_platform_id.h\"\n+\n+namespace stream_executor::sycl {\n+namespace {\n+\n+class SyclContextTest : public ::testing::Test {\n+ protected:\n+  void SetUp() override {\n+    TF_ASSERT_OK_AND_ASSIGN(\n+        Platform * platform,\n+        stream_executor::PlatformManager::PlatformWithId(kSyclPlatformId));\n+    TF_ASSERT_OK_AND_ASSIGN(StreamExecutor * executor,\n+                            platform->ExecutorForDevice(kDefaultDeviceOrdinal));\n+  }\n+};\n+\n+TEST_F(SyclContextTest, GetDeviceTotalMemory) {\n+  TF_ASSERT_OK_AND_ASSIGN(::sycl::device device,\n+                          SyclDevicePool::GetDevice(kDefaultDeviceOrdinal));\n+  TF_ASSERT_OK_AND_ASSIGN(uint64_t total_memory,\n+                          SyclContext::GetDeviceTotalMemory(device));\n+  EXPECT_GT(total_memory, 0)\n+      << \"Total memory should be greater than 0, got \" << total_memory;\n+}\n+\n+TEST_F(SyclContextTest, CreateAndSynchronizeContext) {\n+  TF_ASSERT_OK_AND_ASSIGN(std::unique_ptr<SyclContext> sycl_context_ptr,\n+                          SyclContext::Create(kDefaultDeviceOrdinal));\n+  EXPECT_NE(sycl_context_ptr, nullptr);\n+  EXPECT_EQ(sycl_context_ptr->device_ordinal(), kDefaultDeviceOrdinal);\n+  EXPECT_TRUE(sycl_context_ptr->Synchronize().ok());\n+}\n+\n+}  // namespace\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "8d25cb26278fcc70cd64571c30235421f756492b",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_event.cc",
            "status": "modified",
            "additions": 15,
            "deletions": 17,
            "changes": 32,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_event.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_event.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_event.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -20,26 +20,25 @@ limitations under the License.\n #include \"xla/stream_executor/activate_context.h\"\n #include \"xla/stream_executor/event.h\"\n \n-namespace stream_executor {\n-namespace gpu {\n+namespace stream_executor::sycl {\n \n Event::Status SyclEvent::PollForStatus() {\n   try {\n     auto event_status =\n-        event_.get_info<sycl::info::event::command_execution_status>();\n+        event_.get_info<::sycl::info::event::command_execution_status>();\n     switch (event_status) {\n-      case sycl::info::event_command_status::submitted: {\n+      case ::sycl::info::event_command_status::submitted: {\n         VLOG(2)\n             << \"Command is submitted to the queue but not yet running on the \"\n                \"device.\";\n         return Event::Status::kPending;\n       }\n-      case sycl::info::event_command_status::running: {\n+      case ::sycl::info::event_command_status::running: {\n         VLOG(2) << \"Command has started running on the device but has not yet \"\n                    \"completed.\";\n         return Event::Status::kPending;\n       }\n-      case sycl::info::event_command_status::complete: {\n+      case ::sycl::info::event_command_status::complete: {\n         VLOG(2) << \"Command has finished running on the device.\";\n         return Event::Status::kComplete;\n       }\n@@ -49,42 +48,42 @@ Event::Status SyclEvent::PollForStatus() {\n         return Event::Status::kUnknown;\n       }\n     }\n-  } catch (const sycl::exception& e) {\n+  } catch (const ::sycl::exception& e) {\n     LOG(ERROR) << \"SYCL exception while polling event status: \" << e.what()\n                << \" (error code: \" << e.code() << \")\";\n     return Event::Status::kError;\n   }\n }\n \n absl::Status SyclEvent::WaitStreamOnEvent(StreamExecutor* executor,\n-                                          sycl::queue* stream_handle,\n-                                          const sycl::event& event) {\n+                                          ::sycl::queue* stream_handle,\n+                                          const ::sycl::event& event) {\n   // No need to call executor->Activate() since the SYCL context need not\n   // be activated explicitly.\n   if (stream_handle == nullptr) {\n     return absl::InternalError(\n         \"WaitStreamOnEvent: Stream handle is not initialized.\");\n   }\n-  std::vector<sycl::event> event_list{event};\n-  stream_handle->submit([&](sycl::handler& cgh) {\n+  std::vector<::sycl::event> event_list{event};\n+  stream_handle->submit([&](::sycl::handler& cgh) {\n     cgh.depends_on(event_list);\n     cgh.host_task([=]() {});\n   });\n   return absl::OkStatus();\n }\n \n absl::Status SyclEvent::WaitForEventOnExternalStream(std::intptr_t stream) {\n-  sycl::queue* queue_ptr = absl::bit_cast<sycl::queue*>(stream);\n+  ::sycl::queue* queue_ptr = absl::bit_cast<::sycl::queue*>(stream);\n   return WaitStreamOnEvent(executor_, queue_ptr, event_);\n }\n \n absl::StatusOr<SyclEvent> SyclEvent::Create(StreamExecutor* executor) {\n   // SYCL reports synchronous (host-side) errors via exceptions, so we catch\n   // them and return an error status.\n   try {\n-    // Initialize with a default-constructed sycl::event.\n-    return SyclEvent(executor, sycl::event());\n-  } catch (const sycl::exception& e) {\n+    // Initialize with a default-constructed ::sycl::event.\n+    return SyclEvent(executor, ::sycl::event());\n+  } catch (const ::sycl::exception& e) {\n     LOG(ERROR) << \"SYCL exception while creating event: \" << e.what()\n                << \" (error code: \" << e.code() << \")\";\n     return absl::InternalError(\n@@ -107,5 +106,4 @@ SyclEvent& SyclEvent::operator=(SyclEvent&& other) noexcept {\n   return *this;\n }\n \n-}  // namespace gpu\n-}  // namespace stream_executor\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "660b0b424527107b589220608ac3eb171cdf697f",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_event.h",
            "status": "modified",
            "additions": 11,
            "deletions": 13,
            "changes": 24,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_event.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_event.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_event.h?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -22,8 +22,7 @@ limitations under the License.\n #include \"xla/stream_executor/event.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n \n-namespace stream_executor {\n-namespace gpu {\n+namespace stream_executor::sycl {\n \n // This class implements the Event class for SYCL devices.\n class SyclEvent : public Event {\n@@ -32,20 +31,20 @@ class SyclEvent : public Event {\n \n   // Waits for the event to complete on the specified stream.\n   static absl::Status WaitStreamOnEvent(StreamExecutor* executor,\n-                                        sycl::queue* stream_handle,\n-                                        const sycl::event& event);\n+                                        ::sycl::queue* stream_handle,\n+                                        const ::sycl::event& event);\n \n   // Waits for the event to complete on an external stream.\n   absl::Status WaitForEventOnExternalStream(std::intptr_t stream) override;\n \n   // Creates a SyclEvent instance and initializes it with a default\n-  // constructed sycl::event that has no dependencies and associated commands.\n+  // constructed ::sycl::event that has no dependencies and associated commands.\n   static absl::StatusOr<SyclEvent> Create(StreamExecutor* executor);\n \n-  sycl::event GetEvent() const { return event_; }\n+  ::sycl::event GetEvent() const { return event_; }\n \n-  // We don't need a destructor for sycl::event since it is handled by the SYCL\n-  // runtime.\n+  // We don't need a destructor for ::sycl::event since it is handled by the\n+  // SYCL runtime.\n   ~SyclEvent() = default;\n \n   // Ensure SyclEvent is moveable but not copyable.\n@@ -55,17 +54,16 @@ class SyclEvent : public Event {\n   SyclEvent& operator=(SyclEvent&& other) noexcept;\n \n  private:\n-  explicit SyclEvent(StreamExecutor* executor, const sycl::event& event)\n+  explicit SyclEvent(StreamExecutor* executor, const ::sycl::event& event)\n       : executor_(executor), event_(event) {}\n \n-  // The Executor used to which this object and sycl::event are bound.\n+  // The Executor used to which this object and ::sycl::event are bound.\n   StreamExecutor* executor_;\n \n   // The underlying SYCL event.\n-  sycl::event event_;\n+  ::sycl::event event_;\n };\n \n-}  // namespace gpu\n-}  // namespace stream_executor\n+}  // namespace stream_executor::sycl\n \n #endif  // XLA_STREAM_EXECUTOR_SYCL_SYCL_EVENT_H_"
        },
        {
            "sha": "3afb29336429de3f36709925cfbe207de86d4734",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_event_test.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_event_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_event_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_event_test.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -19,17 +19,17 @@ limitations under the License.\n #include \"xla/stream_executor/platform_manager.h\"\n #include \"xla/stream_executor/sycl/sycl_platform_id.h\"\n \n-namespace stream_executor::gpu {\n+namespace stream_executor::sycl {\n namespace {\n \n const int kDefaultDeviceOrdinal = 0;\n \n class SyclEventTest : public ::testing::Test {\n  protected:\n   void SetUp() override {\n-    TF_ASSERT_OK_AND_ASSIGN(Platform * platform,\n-                            stream_executor::PlatformManager::PlatformWithId(\n-                                stream_executor::sycl::kSyclPlatformId));\n+    TF_ASSERT_OK_AND_ASSIGN(\n+        Platform * platform,\n+        stream_executor::PlatformManager::PlatformWithId(kSyclPlatformId));\n     TF_ASSERT_OK_AND_ASSIGN(executor_,\n                             platform->ExecutorForDevice(kDefaultDeviceOrdinal));\n   }\n@@ -66,4 +66,4 @@ TEST_F(SyclEventTest, MoveEvent) {\n \n }  // namespace\n \n-}  // namespace stream_executor::gpu\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "02e245ba102cc97fa7e082af7f541d5945a06e15",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_gpu_runtime.cc",
            "status": "added",
            "additions": 110,
            "deletions": 0,
            "changes": 110,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_gpu_runtime.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_gpu_runtime.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_gpu_runtime.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -0,0 +1,110 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#include \"xla/stream_executor/sycl/sycl_gpu_runtime.h\"\n+\n+#include <cassert>\n+#include <iostream>\n+#include <unordered_map>\n+\n+#include \"absl/base/call_once.h\"\n+#include \"absl/synchronization/mutex.h\"\n+#include \"xla/tsl/util/env_var.h\"\n+\n+namespace stream_executor::sycl {\n+\n+namespace {\n+\n+absl::Status IsValidDeviceOrdinal(int device_ordinal,\n+                                  const absl::string_view& function_name) {\n+  TF_ASSIGN_OR_RETURN(int device_count, SyclDevicePool::GetDeviceCount());\n+  if (device_ordinal >= 0 && device_ordinal < device_count) {\n+    return absl::OkStatus();\n+  } else {\n+    return absl::InvalidArgumentError(absl::StrCat(\n+        function_name, \": Invalid device ordinal: \", device_ordinal));\n+  }\n+}\n+\n+}  // namespace\n+\n+DevicePool SyclDevicePool::device_pool_;\n+\n+absl::Status SyclDevicePool::InitDevicePool() {\n+  static absl::once_flag device_init_flag;\n+  static absl::Status init_status = absl::OkStatus();\n+  absl::call_once(device_init_flag, []() {\n+    DevicePool devices;\n+    std::vector<::sycl::platform> platform_list =\n+        ::sycl::platform::get_platforms();\n+    for (const auto& platform : platform_list) {\n+      std::string platform_name =\n+          platform.get_info<::sycl::info::platform::name>();\n+      // Add all Level-Zero backend GPUs to the device pool so that it can be\n+      // used by the SYCL runtime.\n+      if (platform_name.find(\"Level-Zero\") != std::string::npos) {\n+        LOG(INFO) << \"Selected platform: \" << platform_name;\n+        std::vector<::sycl::device> device_list = platform.get_devices();\n+        for (const auto& device : device_list) {\n+          if (device.is_gpu()) {\n+            devices.push_back(device);\n+          }\n+        }\n+      }\n+    }\n+    if (devices.empty()) {\n+      init_status = absl::InternalError(\n+          \"SyclDevicePool::InitDevicePool: No SYCL devices found with \"\n+          \"Level-Zero \"\n+          \"backend. Check oneAPI installation and environment variables.\");\n+      return;\n+    }\n+    device_pool_ = std::move(devices);\n+  });\n+  return init_status;\n+}\n+\n+absl::StatusOr<::sycl::context> SyclDevicePool::GetDeviceContext() {\n+  TF_RETURN_IF_ERROR(SyclDevicePool::InitDevicePool());\n+  static ::sycl::context device_context(device_pool_);\n+  return device_context;\n+}\n+\n+absl::StatusOr<int> SyclDevicePool::GetDeviceCount() {\n+  TF_RETURN_IF_ERROR(SyclDevicePool::InitDevicePool());\n+  // Cast to int since device_ordinal is usually an int.\n+  return static_cast<int>(device_pool_.size());\n+}\n+\n+absl::StatusOr<int> SyclDevicePool::GetDeviceOrdinal(\n+    const ::sycl::device& device) {\n+  TF_RETURN_IF_ERROR(SyclDevicePool::InitDevicePool());\n+  auto it = std::find(device_pool_.begin(), device_pool_.end(), device);\n+  if (it != device_pool_.end()) {\n+    return static_cast<int>(it - device_pool_.begin());\n+  } else {\n+    return absl::InternalError(\n+        \"SyclDevicePool::GetDeviceOrdinal failed, got invalid device\");\n+  }\n+}\n+\n+absl::StatusOr<::sycl::device> SyclDevicePool::GetDevice(int device_ordinal) {\n+  TF_RETURN_IF_ERROR(SyclDevicePool::InitDevicePool());\n+  TF_RETURN_IF_ERROR(\n+      IsValidDeviceOrdinal(device_ordinal, \"SyclDevicePool::GetDevice\"));\n+  return device_pool_[device_ordinal];\n+}\n+\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "ec48eb282a7a922f6a680caad9cfa5281a080242",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_gpu_runtime.h",
            "status": "added",
            "additions": 77,
            "deletions": 0,
            "changes": 77,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_gpu_runtime.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_gpu_runtime.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_gpu_runtime.h?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -0,0 +1,77 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#ifndef XLA_STREAM_EXECUTOR_SYCL_SYCL_GPU_RUNTIME_H_\n+#define XLA_STREAM_EXECUTOR_SYCL_SYCL_GPU_RUNTIME_H_\n+\n+// clang-format off\n+#include <level_zero/ze_api.h>\n+#include <sycl/sycl.hpp>\n+// clang-format on\n+\n+#include <string>\n+#include <vector>\n+\n+#include \"absl/strings/ascii.h\"\n+#include \"xla/stream_executor/sycl/sycl_status.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n+\n+namespace stream_executor::sycl {\n+\n+constexpr int kDefaultDeviceOrdinal = 0;\n+\n+// The SYCL context constructor expects a std::vector<::sycl::device> as input.\n+// Therefore, we define DevicePool as a vector of ::sycl::device.\n+// <https://github.khronos.org/SYCL_Reference/iface/context.html#constructors>\n+using DevicePool = std::vector<::sycl::device>;\n+\n+// SyclDevicePool is a utility class for managing SYCL devices.\n+// It provides methods to access devices, their contexts, and device counts.\n+// This class cannot be instantiated and is intended to be used as a static\n+// utility.\n+class SyclDevicePool {\n+ public:\n+  // Returns a static thread-safe SYCL context associated with the device pool.\n+  // The context is initialized on the first call and remains valid for the\n+  // lifetime of the process, ensuring all callers share the same context.\n+  //\n+  // This function assumes that the device pool is not modified after\n+  // initialization. If this assumption is violated, the context may become\n+  // invalid.\n+  static absl::StatusOr<::sycl::context> GetDeviceContext();\n+\n+  // Returns the number of devices in the pool.\n+  static absl::StatusOr<int> GetDeviceCount();\n+\n+  // Returns the device ordinal for a given device.\n+  static absl::StatusOr<int> GetDeviceOrdinal(const ::sycl::device& device);\n+\n+  // Returns the SYCL device for a given device ordinal.\n+  static absl::StatusOr<::sycl::device> GetDevice(int device_ordinal);\n+\n+ private:\n+  // The underlying device pool.\n+  static DevicePool device_pool_;\n+\n+  // Thread-safe initialization of device_pool_ with all Level-Zero backend GPUs\n+  // using absl::call_once.\n+  static absl::Status InitDevicePool();\n+\n+  // Prevent instantiation: this class is intended to be a static utility only.\n+  SyclDevicePool() = delete;\n+};\n+\n+}  // namespace stream_executor::sycl\n+#endif  // XLA_STREAM_EXECUTOR_SYCL_SYCL_GPU_RUNTIME_H_"
        },
        {
            "sha": "8e01fb4b2e8d6f8169a04c2c7528aa2ad8c677f3",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_gpu_runtime_test.cc",
            "status": "added",
            "additions": 47,
            "deletions": 0,
            "changes": 47,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_gpu_runtime_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_gpu_runtime_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_gpu_runtime_test.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -0,0 +1,47 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+#include \"xla/stream_executor/sycl/sycl_gpu_runtime.h\"\n+\n+#include <gtest/gtest.h>\n+#include \"xla/tsl/platform/status_matchers.h\"\n+\n+namespace stream_executor::sycl {\n+namespace {\n+\n+TEST(SyclGpuRuntimeTest, GetDeviceCount) {\n+  EXPECT_THAT(SyclDevicePool::GetDeviceCount(),\n+              ::absl_testing::IsOkAndHolds(::testing::Gt(0)));\n+}\n+\n+TEST(SyclGpuRuntimeTest, GetDeviceOrdinal) {\n+  TF_ASSERT_OK_AND_ASSIGN(::sycl::device sycl_device,\n+                          SyclDevicePool::GetDevice(kDefaultDeviceOrdinal));\n+  TF_ASSERT_OK_AND_ASSIGN(int device_ordinal,\n+                          SyclDevicePool::GetDeviceOrdinal(sycl_device));\n+  EXPECT_EQ(device_ordinal, kDefaultDeviceOrdinal);\n+}\n+\n+TEST(SyclGpuRuntimeTest, TestStaticDeviceContext) {\n+  // Verify that GetDeviceContext returns the same context instance on multiple\n+  // calls.\n+  TF_ASSERT_OK_AND_ASSIGN(::sycl::context saved_sycl_context,\n+                          SyclDevicePool::GetDeviceContext());\n+  TF_ASSERT_OK_AND_ASSIGN(::sycl::context current_sycl_context,\n+                          SyclDevicePool::GetDeviceContext());\n+  EXPECT_EQ(saved_sycl_context, current_sycl_context);\n+}\n+\n+}  // namespace\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "72dc4b222a75cc7f483907505dda81e229404fcd",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_kernel.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_kernel.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_kernel.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_kernel.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -12,8 +12,7 @@ limitations under the License.\n \n #include \"xla/stream_executor/sycl/sycl_kernel.h\"\n \n-namespace stream_executor {\n-namespace gpu {\n+namespace stream_executor::sycl {\n \n // TODO(intel-tf): Implement this feature in SYCL\n absl::StatusOr<int32_t> SyclKernel::GetMaxOccupiedBlocksPerCore(\n@@ -104,5 +103,4 @@ absl::Status SyclKernel::Launch(const ThreadDim& thread_dims,\n   return absl::InternalError(\"Unsupported kernel arguments type\");\n }\n \n-}  // namespace gpu\n-}  // namespace stream_executor\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "5fc589138c3c0a8314d9cd8f2f6a6090801452b7",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_kernel.h",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_kernel.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_kernel.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_kernel.h?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -17,9 +17,9 @@ limitations under the License.\n \n #include \"absl/status/statusor.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n-#include \"tsl/platform/logging.h\"\n+#include \"xla/tsl/platform/logging.h\"\n \n-namespace stream_executor::gpu {\n+namespace stream_executor::sycl {\n \n class SyclKernel : public Kernel {\n  public:\n@@ -55,6 +55,6 @@ class SyclKernel : public Kernel {\n   unsigned arity_ = 0;  // number of formal parameters the kernel takes\n };\n \n-}  // namespace stream_executor::gpu\n+}  // namespace stream_executor::sycl\n \n #endif  // XLA_STREAM_EXECUTOR_SYCL_SYCL_KERNEL_H_"
        },
        {
            "sha": "d793f150b7a0ca638a1815fbd97d4a2bd07f0cca",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_kernel_test.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_kernel_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_kernel_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_kernel_test.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -18,15 +18,16 @@ limitations under the License.\n #include \"absl/types/span.h\"\n #include \"xla/stream_executor/platform_manager.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n+#include \"xla/stream_executor/sycl/sycl_platform_id.h\"\n #include \"xla/tsl/platform/status_matchers.h\"\n \n-namespace stream_executor::gpu {\n+namespace stream_executor::sycl {\n namespace {\n-using tsl::testing::IsOkAndHolds;\n \n TEST(SyclKernelTest, CheckKernelLoading) {\n-  TF_ASSERT_OK_AND_ASSIGN(Platform * platform,\n-                          PlatformManager::PlatformWithName(\"SYCL\"));\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      Platform * platform,\n+      stream_executor::PlatformManager::PlatformWithId(kSyclPlatformId));\n   TF_ASSERT_OK_AND_ASSIGN(StreamExecutor * executor,\n                           platform->ExecutorForDevice(0));\n \n@@ -140,4 +141,4 @@ TEST(SyclKernelTest, CheckKernelLoading) {\n }\n \n }  // namespace\n-}  // namespace stream_executor::gpu\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "94de7f9ba2f96c7b0300a5461263685b0520f7a3",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_platform.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -27,17 +27,17 @@ limitations under the License.\n #include \"xla/stream_executor/platform/initialize.h\"\n #include \"xla/stream_executor/platform_manager.h\"\n #include \"xla/stream_executor/sycl/sycl_platform_id.h\"\n-#include \"tsl/platform/errors.h\"\n-#include \"tsl/platform/status.h\"\n+#include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/status.h\"\n \n namespace stream_executor {\n-namespace gpu {\n+namespace sycl {\n \n SyclPlatform::SyclPlatform() : name_(\"SYCL\") {}\n \n SyclPlatform::~SyclPlatform() {}\n \n-Platform::Id SyclPlatform::id() const { return sycl::kSyclPlatformId; }\n+Platform::Id SyclPlatform::id() const { return kSyclPlatformId; }\n \n int SyclPlatform::VisibleDeviceCount() const {\n   // Initialized in a thread-safe manner the first time this is run.\n@@ -64,11 +64,11 @@ SyclPlatform::GetUncachedExecutor(int ordinal) {\n       \"GetUncachedExecutor is unimplemented for SYCL platform.\");\n }\n \n-}  // namespace gpu\n+}  // namespace sycl\n \n static void InitializeSyclPlatform() {\n-  TF_CHECK_OK(\n-      PlatformManager::RegisterPlatform(std::make_unique<gpu::SyclPlatform>()));\n+  TF_CHECK_OK(PlatformManager::RegisterPlatform(\n+      std::make_unique<sycl::SyclPlatform>()));\n }\n \n }  // namespace stream_executor"
        },
        {
            "sha": "4273d7744e0ceef9e80c8e9f47f337f669c2157b",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_platform.h",
            "status": "modified",
            "additions": 4,
            "deletions": 13,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform.h?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -25,16 +25,14 @@ limitations under the License.\n #include \"xla/stream_executor/platform_manager.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n \n-namespace stream_executor {\n-namespace sycl {\n+namespace stream_executor::sycl {\n+\n // Opaque and unique identifier for the SYCL platform plugin.\n // This is needed so that plugins can refer to/identify this platform without\n // instantiating a SyclPlatform object.\n extern const Platform::Id kSyclPlatformId;\n-}  // namespace sycl\n \n-namespace gpu {\n-// Sycl-specific platform plugin, registered as a singleton value via module\n+// SYCL-specific platform plugin, registered as a singleton value via module\n // initializer.\n class SyclPlatform : public Platform {\n  public:\n@@ -72,13 +70,6 @@ class SyclPlatform : public Platform {\n   void operator=(const SyclPlatform&) = delete;\n };\n \n-}  // namespace gpu\n-\n-namespace sycl {\n-\n-using SyclPlatform = gpu::SyclPlatform;\n-\n-}  // namespace sycl\n-}  // namespace stream_executor\n+}  // namespace stream_executor::sycl\n \n #endif  // XLA_STREAM_EXECUTOR_SYCL_SYCL_PLATFORM_H_"
        },
        {
            "sha": "c2b6bd26d5086a7ce8f06d2a70e242955ba23fec",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_platform_id.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform_id.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform_id.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform_id.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -17,10 +17,8 @@ limitations under the License.\n \n #include \"xla/stream_executor/platform.h\"\n \n-namespace stream_executor {\n-namespace sycl {\n+namespace stream_executor::sycl {\n \n PLATFORM_DEFINE_ID(kSyclPlatformId);\n \n-}  // namespace sycl\n-}  // namespace stream_executor\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "6684cdd102edfcec0fa2f79cc88995b827071c2a",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_platform_id.h",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform_id.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform_id.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform_id.h?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -18,8 +18,7 @@ limitations under the License.\n \n #include \"xla/stream_executor/platform.h\"\n \n-namespace stream_executor {\n-namespace sycl {\n+namespace stream_executor::sycl {\n \n // Opaque and unique identifier for the sycl platform.\n // This is needed so that plugins can refer to/identify this platform without\n@@ -28,7 +27,6 @@ namespace sycl {\n // and SyclExecutor.\n extern const Platform::Id kSyclPlatformId;\n \n-}  // namespace sycl\n-}  // namespace stream_executor\n+}  // namespace stream_executor::sycl\n \n #endif  // XLA_STREAM_EXECUTOR_SYCL_SYCL_PLATFORM_ID_H_"
        },
        {
            "sha": "ddd85001f925ed5cfa367f7e956a5b452478241c",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_platform_test.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 15,
            "changes": 26,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform_test.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -13,22 +13,18 @@ limitations under the License.\n #include <gtest/gtest.h>\n #include \"xla/stream_executor/platform.h\"\n #include \"xla/stream_executor/platform_manager.h\"\n-#include \"tsl/platform/statusor.h\"\n-#include \"tsl/platform/test.h\"\n+#include \"xla/stream_executor/sycl/sycl_platform_id.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n \n-namespace stream_executor {\n-namespace gpu {\n+namespace stream_executor::sycl {\n+namespace {\n \n-static Platform* NewPlatform() {\n-  Platform* platform = PlatformManager::PlatformWithName(\"SYCL\").value();\n-  return platform;\n+TEST(SyclPlatformTest, TestPlatformName) {\n+  TF_ASSERT_OK_AND_ASSIGN(\n+      Platform * platform,\n+      stream_executor::PlatformManager::PlatformWithId(kSyclPlatformId));\n+  EXPECT_EQ(platform->Name(), \"SYCL\");\n }\n \n-TEST(SyclPlatformTest, Name) {\n-  auto platform = NewPlatform();\n-  auto name = platform->Name();\n-  EXPECT_EQ(name, \"SYCL\");\n-}\n-\n-}  // namespace gpu\n-}  // namespace stream_executor\n+}  // namespace\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "2cf8a14105669e15d44cca4410e7d5bc8b690805",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_solver_context.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_solver_context.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_solver_context.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_solver_context.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -22,7 +22,7 @@ limitations under the License.\n #include \"xla/stream_executor/sycl/sycl_platform_id.h\"\n #include \"xla/tsl/platform/logging.h\"\n \n-namespace stream_executor {\n+namespace stream_executor::sycl {\n \n // A stub for SyclSolverContext to enable sycl build. Proper functionality\n // will be implemented soon.\n@@ -41,7 +41,7 @@ SyclSolverContext::~SyclSolverContext() {\n \n STREAM_EXECUTOR_REGISTER_OBJECT_STATICALLY(SyclSolverContextFactory,\n                                            GpuSolverContextFactory,\n-                                           sycl::kSyclPlatformId,\n+                                           kSyclPlatformId,\n                                            SyclSolverContext::Create);\n \n-}  // namespace stream_executor\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "d6450d27a685b7459ad64bd631887fdd12c52f78",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_solver_context.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_solver_context.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_solver_context.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_solver_context.h?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -22,7 +22,7 @@ limitations under the License.\n #include \"xla/stream_executor/stream.h\"\n #include \"xla/xla_data.pb.h\"\n \n-namespace stream_executor {\n+namespace stream_executor::sycl {\n \n class SyclSolverContext : public GpuSolverContext {\n  public:\n@@ -35,6 +35,6 @@ class SyclSolverContext : public GpuSolverContext {\n   explicit SyclSolverContext();\n };\n \n-}  // namespace stream_executor\n+}  // namespace stream_executor::sycl\n \n #endif  // XLA_STREAM_EXECUTOR_SYCL_SYCL_SOLVER_CONTEXT_H_"
        },
        {
            "sha": "e1cec7ea8e9ab7d7a62e244490fe53e01555b295",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_status.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_status.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_status.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_status.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -17,7 +17,8 @@ limitations under the License.\n \n #include <string>\n \n-namespace stream_executor::gpu {\n+namespace stream_executor::sycl {\n+\n std::string ToString(SyclError error) {\n   switch (error) {\n     case SyclError::kSyclSuccess:\n@@ -40,4 +41,5 @@ std::string ToString(SyclError error) {\n       return \"SYCL got invalid error code.\";\n   }\n }\n-}  // namespace stream_executor::gpu\n+\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "6e4d1158112c79e059e8778189bb7404d6dc63ad",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_status.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_status.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_status.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_status.h?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -23,7 +23,7 @@ limitations under the License.\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/string_view.h\"\n \n-namespace stream_executor::gpu {\n+namespace stream_executor::sycl {\n \n enum class SyclError {\n   kSyclSuccess,\n@@ -48,6 +48,6 @@ inline absl::Status ToStatus(SyclError result, absl::string_view detail = \"\") {\n   return absl::InternalError(error_message);\n }\n \n-}  // namespace stream_executor::gpu\n+}  // namespace stream_executor::sycl\n \n #endif  // XLA_STREAM_EXECUTOR_SYCL_SYCL_STATUS_H_"
        },
        {
            "sha": "9897ad6da0a99252361969e9a95b9d4ee58f4719",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_status_test.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_status_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_status_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_status_test.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -23,7 +23,7 @@ limitations under the License.\n #include \"xla/tsl/platform/status_matchers.h\"\n #include \"xla/tsl/platform/test.h\"\n \n-namespace stream_executor::gpu {\n+namespace stream_executor::sycl {\n namespace {\n \n using ::testing::HasSubstr;\n@@ -46,4 +46,4 @@ TEST(SyclStatusTest, ToStatusIncludesDetailMessage) {\n }\n \n }  // namespace\n-}  // namespace stream_executor::gpu\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "4b734db79c76ae21be058aee846f2a6c408c1f7c",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_timer.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_timer.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_timer.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_timer.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -21,20 +21,20 @@ limitations under the License.\n \n constexpr int kMsecInSec = 1000;\n \n-namespace stream_executor::gpu {\n+namespace stream_executor::sycl {\n \n namespace {\n \n absl::StatusOr<float> GetEventElapsedTime(StreamExecutor* executor,\n-                                          const sycl::event& start,\n-                                          const sycl::event& stop) {\n+                                          const ::sycl::event& start,\n+                                          const ::sycl::event& stop) {\n   std::unique_ptr<ActivateContext> activation = executor->Activate();\n \n   // Get the native Level Zero event handles.\n   ze_event_handle_t start_event =\n-      ::sycl::get_native<sycl::backend::ext_oneapi_level_zero>(start);\n+      ::sycl::get_native<::sycl::backend::ext_oneapi_level_zero>(start);\n   ze_event_handle_t end_event =\n-      ::sycl::get_native<sycl::backend::ext_oneapi_level_zero>(stop);\n+      ::sycl::get_native<::sycl::backend::ext_oneapi_level_zero>(stop);\n \n   // Synchronize the events to ensure they are complete.\n   ze_result_t sync_result = zeEventHostSynchronize(end_event, UINT64_MAX);\n@@ -107,4 +107,4 @@ absl::StatusOr<SyclTimer> SyclTimer::Create(StreamExecutor* executor,\n                    stream);\n }\n \n-}  // namespace stream_executor::gpu\n+}  // namespace stream_executor::sycl"
        },
        {
            "sha": "db7317ac6daaaf0a052b3efee66a244de8313d38",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_timer.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_timer.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_timer.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_timer.h?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -23,7 +23,7 @@ limitations under the License.\n #include \"xla/stream_executor/stream_executor.h\"\n #include \"xla/stream_executor/sycl/sycl_event.h\"\n \n-namespace stream_executor::gpu {\n+namespace stream_executor::sycl {\n \n // This class implements a timer for SYCL streams by measuring the elapsed\n // time between two SYCL events using Level-Zero backend timestamps.\n@@ -65,6 +65,6 @@ class SyclTimer : public EventBasedTimer {\n   SyclEvent start_event_;\n   SyclEvent stop_event_;\n };\n-}  // namespace stream_executor::gpu\n+}  // namespace stream_executor::sycl\n \n #endif  // XLA_STREAM_EXECUTOR_SYCL_SYCL_TIMER_H_"
        },
        {
            "sha": "d771f2be8ee05b5723d01a2369f5ace457fd329d",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_timer_test.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_timer_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2495633f99f7acc79b95ef76a61366a872570387/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_timer_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_timer_test.cc?ref=2495633f99f7acc79b95ef76a61366a872570387",
            "patch": "@@ -22,7 +22,7 @@ limitations under the License.\n #include \"xla/stream_executor/typed_kernel_factory.h\"\n #include \"xla/tsl/platform/status_matchers.h\"\n \n-namespace stream_executor::gpu {\n+namespace stream_executor::sycl {\n namespace {\n \n const int kDefaultDeviceOrdinal = 0;\n@@ -209,9 +209,9 @@ class SyclTimerTest : public ::testing::Test {\n \n  protected:\n   void SetUp() override {\n-    TF_ASSERT_OK_AND_ASSIGN(Platform * platform,\n-                            stream_executor::PlatformManager::PlatformWithId(\n-                                stream_executor::sycl::kSyclPlatformId));\n+    TF_ASSERT_OK_AND_ASSIGN(\n+        Platform * platform,\n+        stream_executor::PlatformManager::PlatformWithId(kSyclPlatformId));\n     TF_ASSERT_OK_AND_ASSIGN(executor_,\n                             platform->ExecutorForDevice(kDefaultDeviceOrdinal));\n     TF_ASSERT_OK_AND_ASSIGN(stream_,\n@@ -239,4 +239,4 @@ TEST_F(SyclTimerTest, Create) {\n }\n \n }  // namespace\n-}  // namespace stream_executor::gpu\n+}  // namespace stream_executor::sycl"
        }
    ],
    "stats": {
        "total": 693,
        "additions": 571,
        "deletions": 122
    }
}