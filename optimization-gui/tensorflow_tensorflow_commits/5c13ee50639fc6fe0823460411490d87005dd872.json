{
    "author": "unknown",
    "message": "Internal build rule change.\n\nPiperOrigin-RevId: 825151475",
    "sha": "5c13ee50639fc6fe0823460411490d87005dd872",
    "files": [
        {
            "sha": "c845587d791b558c08bc38ea0ec555f00717cc7d",
            "filename": "tensorflow/compiler/tests/BUILD",
            "status": "modified",
            "additions": 12,
            "deletions": 25,
            "changes": 37,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/5c13ee50639fc6fe0823460411490d87005dd872/tensorflow%2Fcompiler%2Ftests%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/5c13ee50639fc6fe0823460411490d87005dd872/tensorflow%2Fcompiler%2Ftests%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftests%2FBUILD?ref=5c13ee50639fc6fe0823460411490d87005dd872",
            "patch": "@@ -2,7 +2,14 @@ load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\", \"py_strict_test\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"cuda_py_strict_test\", \"tf_cuda_cc_test\")\n load(\"//tensorflow/compiler/aot:tfcompile.bzl\", \"tf_library\")\n load(\"//tensorflow/compiler/tests:build_combined_defs.bzl\", \"tf_xla_combined_py_test\")\n-load(\"//tensorflow/compiler/tests:build_defs.bzl\", \"generate_backend_suites\", \"tf_xla_py_strict_test\")\n+load(\n+    \"//tensorflow/compiler/tests:build_defs.bzl\",\n+    \"generate_backend_suites\",\n+    \"tf_xla_py_strict_test\",\n+    # copybara:uncomment_begin(google-only)\n+    # \"tpu_backends\",\n+    # copybara:uncomment_end\n+)\n load(\n     \"//tensorflow/core/platform:build_config_root.bzl\",\n     \"tf_cuda_tests_tags\",\n@@ -213,9 +220,8 @@ tf_xla_combined_py_test(\n     name = \"combined_ops_test_f\",\n     size = \"medium\",\n     timeout = \"long\",\n-    # copybara:uncomment_begin\n-    # #TODO(b/286470564): Remove once the bug is fixed.\n-    # disable_tpu_tfrt = True,\n+    # copybara:uncomment_begin(google-only)\n+    # disabled_backends = tpu_backends(),\n     # copybara:uncomment_end\n     exec_properties = {\n         \"cpp_link.mem\": \"16g\",\n@@ -340,10 +346,6 @@ tf_xla_py_strict_test(\n     name = \"add_n_test\",\n     size = \"small\",\n     srcs = [\"add_n_test.py\"],\n-    # copybara:uncomment_begin\n-    # #TODO(b/286470564): Remove once the bug is fixed.\n-    # disable_tpu_tfrt = True,\n-    # copybara:uncomment_end\n     tags = [\n         \"no_pip\",  # TODO(b/149738646): fix pip install so these tests run on kokoro pip\n         \"notap\",\n@@ -496,10 +498,6 @@ tf_xla_py_strict_test(\n     name = \"cond_test\",\n     size = \"small\",\n     srcs = [\"cond_test.py\"],\n-    # copybara:uncomment_begin\n-    # #TODO(b/286470564): Remove once the bug is fixed.\n-    # disable_tpu_tfrt = True,\n-    # copybara:uncomment_end\n     tags = [\n         \"no_pip\",  # TODO(b/149738646): fix pip install so these tests run on kokoro pip\n         \"notap\",\n@@ -1746,12 +1744,8 @@ tf_xla_py_strict_test(\n     name = \"tensor_list_ops_test\",\n     size = \"small\",\n     srcs = [\"tensor_list_ops_test.py\"],\n-    # copybara:uncomment_begin\n-    # #TODO(b/286470564): Remove once the bug is fixed.\n-    # disable_tpu_tfrt = True,\n-    # copybara:uncomment_end\n-    # TensorList ops are not implemented in the on-demand compilation model yet.\n-    disabled_backends = [\"cpu_ondemand\"],\n+    # TensorList ops are only implemented on CPU.\n+    enabled_backends = [\"cpu\"],\n     tags = [\n         \"no_pip\",  # TODO(b/149738646): fix pip install so these tests run on kokoro pip\n     ],\n@@ -1906,10 +1900,6 @@ tf_xla_py_strict_test(\n     name = \"while_test\",\n     size = \"small\",\n     srcs = [\"while_test.py\"],\n-    # copybara:uncomment_begin\n-    # #TODO(b/291130193): Remove once the bug is fixed.\n-    # disable_tpu_tfrt = True,\n-    # copybara:uncomment_end\n     tags = [\n         \"no_pip\",  # TODO(b/149738646): fix pip install so these tests run on kokoro pip\n         \"notap\",\n@@ -2429,9 +2419,6 @@ tf_xla_py_strict_test(\n     name = \"where_op_tpu_test\",\n     size = \"small\",\n     srcs = [\"where_op_test.py\"],\n-    args = [\n-        \"--tpu_use_tfrt=true\",\n-    ],\n     disabled_backends = [\n         \"cpu\",\n         \"cpu_ondemand\","
        }
    ],
    "stats": {
        "total": 37,
        "additions": 12,
        "deletions": 25
    }
}