{
    "author": "d4n1elchen",
    "message": "[HLO Diff] Add a button to show/hide the program shape in HLO diff.\n\nThis change adds a \"show program shape\" button next to each computation name. Clicking the button toggles the visibility of the computation's program shape, which is initially hidden to reduce visual clutter.\n\nPiperOrigin-RevId: 809136567",
    "sha": "7fa8dbb359ada23b326a7e791c0779b0cd5769a5",
    "files": [
        {
            "sha": "a2d5429440cc10747ffb4d69cb99151defd3321b",
            "filename": "third_party/xla/xla/hlo/tools/hlo_diff/render/hlo_gumgraph_html_renderer.cc",
            "status": "modified",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/7fa8dbb359ada23b326a7e791c0779b0cd5769a5/third_party%2Fxla%2Fxla%2Fhlo%2Ftools%2Fhlo_diff%2Frender%2Fhlo_gumgraph_html_renderer.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/7fa8dbb359ada23b326a7e791c0779b0cd5769a5/third_party%2Fxla%2Fxla%2Fhlo%2Ftools%2Fhlo_diff%2Frender%2Fhlo_gumgraph_html_renderer.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Ftools%2Fhlo_diff%2Frender%2Fhlo_gumgraph_html_renderer.cc?ref=7fa8dbb359ada23b326a7e791c0779b0cd5769a5",
            "patch": "@@ -274,6 +274,18 @@ std::string PrintCss() {\n     div.hlo-instruction.has-overflow:not(.expanded):hover button.hlo-expand-btn {\n       visibility: visible;\n     }\n+    button.hlo-program-shape-btn {\n+      background: #e8eaf6;\n+      color: #3f51b5;\n+      padding: 0 4px;\n+      border: 1px solid #c5cae9;\n+      box-shadow: none;\n+      font-weight: bold;\n+      margin-left: 4px;\n+      height: 1.3em;\n+      line-height: 1.1;\n+      cursor: pointer;\n+    }\n     div.bordered {\n       border: 2px solid #4285F4;\n     }\n@@ -414,6 +426,23 @@ std::string PrintJavascriptForHoverEvent() {\n       }\n   });\n \n+  const allProgramShapeButtons = document.querySelectorAll('.hlo-program-shape-btn');\n+  allProgramShapeButtons.forEach(btn => {\n+    btn.addEventListener('click', (e) => {\n+      const shapeSpan = btn.nextElementSibling;\n+      if (shapeSpan && shapeSpan.classList.contains('hlo-program-shape')) {\n+        if (shapeSpan.style.display === 'none') {\n+          shapeSpan.style.display = 'inline';\n+          btn.textContent = 'hide program shape';\n+        } else {\n+          shapeSpan.style.display = 'none';\n+          btn.textContent = 'show program shape';\n+        }\n+      }\n+      e.stopPropagation();\n+    });\n+  });\n+\n   function getRelatedDivs(diffId, mappedId) {\n     return document.querySelectorAll(`div[data-diffid=\"${diffId}\"][data-diffid-mapped=\"${mappedId}\"], div[data-diffid=\"${mappedId}\"][data-diffid-mapped=\"${diffId}\"]`);\n   }\n@@ -829,8 +858,12 @@ std::string PrintHloComputationToHtml(\n   printer.Append(\"<b>%\");\n   printer.Append(comp->name());\n   printer.Append(\" \");\n+  printer.Append(\n+      \"<button class='hlo-program-shape-btn'>show program shape</button>\");\n+  printer.Append(\"<span class='hlo-program-shape' style='display: none;'>\");\n   ShapeUtil::PrintHumanString(&printer,\n                               comp->ComputeProgramShape(/*include_ids=*/true));\n+  printer.Append(\"</span>\");\n   printer.Append(\" \");\n   printer.Append(\"{</b>\\n\");\n "
        }
    ],
    "stats": {
        "total": 33,
        "additions": 33,
        "deletions": 0
    }
}