{
    "author": "WillFroom",
    "message": "[XLA] Add div, min & max to ImplicitArithOpBuilder.\n\nPiperOrigin-RevId: 831275082",
    "sha": "b6aea89f0dffb56651969d84e7970cb6cbd6e6b3",
    "files": [
        {
            "sha": "79ef073b9cef29661c151fc83a76e4065cf2bdc0",
            "filename": "third_party/xla/xla/codegen/emitters/implicit_arith_op_builder.cc",
            "status": "modified",
            "additions": 29,
            "deletions": 0,
            "changes": 29,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b6aea89f0dffb56651969d84e7970cb6cbd6e6b3/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fimplicit_arith_op_builder.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b6aea89f0dffb56651969d84e7970cb6cbd6e6b3/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fimplicit_arith_op_builder.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fimplicit_arith_op_builder.cc?ref=b6aea89f0dffb56651969d84e7970cb6cbd6e6b3",
            "patch": "@@ -18,6 +18,7 @@ limitations under the License.\n #include <cstdint>\n \n #include \"mlir/Dialect/Arith/IR/Arith.h\"\n+#include \"mlir/IR/BuiltinTypes.h\"\n #include \"mlir/IR/ImplicitLocOpBuilder.h\"\n #include \"mlir/IR/Value.h\"\n \n@@ -57,6 +58,15 @@ ImplicitArithOpBuilder ImplicitArithOpBuilder::operator*(\n   return Binop<mlir::arith::MulIOp>(rhs);\n }\n \n+ImplicitArithOpBuilder ImplicitArithOpBuilder::operator/(int64_t rhs) const {\n+  return Binop<mlir::arith::DivSIOp>(rhs);\n+}\n+\n+ImplicitArithOpBuilder ImplicitArithOpBuilder::operator/(\n+    mlir::Value rhs) const {\n+  return Binop<mlir::arith::DivSIOp>(rhs);\n+}\n+\n ImplicitArithOpBuilder ImplicitArithOpBuilder::operator&(\n     mlir::Value rhs) const {\n   return Binop<mlir::arith::AndIOp>(rhs);\n@@ -137,7 +147,26 @@ ImplicitArithOpBuilder ImplicitArithOpBuilder::operator!=(int64_t rhs) const {\n   return cmp(mlir::arith::CmpIPredicate::ne, rhs);\n }\n \n+ImplicitArithOpBuilder ImplicitArithOpBuilder::min(mlir::Value rhs) const {\n+  return {builder_->create<mlir::arith::MinSIOp>(value_, rhs), builder_};\n+}\n+\n+ImplicitArithOpBuilder ImplicitArithOpBuilder::min(int64_t rhs) const {\n+  return min(MakeConstant(rhs));\n+}\n+\n+ImplicitArithOpBuilder ImplicitArithOpBuilder::max(mlir::Value rhs) const {\n+  return {builder_->create<mlir::arith::MaxSIOp>(value_, rhs), builder_};\n+}\n+\n+ImplicitArithOpBuilder ImplicitArithOpBuilder::max(int64_t rhs) const {\n+  return max(MakeConstant(rhs));\n+}\n+\n ImplicitArithOpBuilder ImplicitArithOpBuilder::MakeConstant(int64_t c) const {\n+  if (mlir::isa<mlir::IndexType>(value_.getType())) {\n+    return {builder_->create<mlir::arith::ConstantIndexOp>(c), builder_};\n+  }\n   return {builder_->create<mlir::arith::ConstantIntOp>(value_.getType(), c),\n           builder_};\n }"
        },
        {
            "sha": "4f7f404b452daf5ef2e75d3f6382040fbcffc635",
            "filename": "third_party/xla/xla/codegen/emitters/implicit_arith_op_builder.h",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b6aea89f0dffb56651969d84e7970cb6cbd6e6b3/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fimplicit_arith_op_builder.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b6aea89f0dffb56651969d84e7970cb6cbd6e6b3/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fimplicit_arith_op_builder.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Fimplicit_arith_op_builder.h?ref=b6aea89f0dffb56651969d84e7970cb6cbd6e6b3",
            "patch": "@@ -44,6 +44,9 @@ class ImplicitArithOpBuilder {\n   // Integer multiplication.\n   ImplicitArithOpBuilder operator*(int64_t rhs) const;\n   ImplicitArithOpBuilder operator*(mlir::Value rhs) const;\n+  // Signed integer division.\n+  ImplicitArithOpBuilder operator/(int64_t rhs) const;\n+  ImplicitArithOpBuilder operator/(mlir::Value rhs) const;\n   // Bitwise and.\n   ImplicitArithOpBuilder operator&(mlir::Value rhs) const;\n   ImplicitArithOpBuilder operator&(int64_t rhs) const;\n@@ -72,6 +75,14 @@ class ImplicitArithOpBuilder {\n   ImplicitArithOpBuilder operator==(int64_t rhs) const;\n   ImplicitArithOpBuilder operator!=(int64_t rhs) const;\n \n+  // Signed integer min.\n+  ImplicitArithOpBuilder min(mlir::Value rhs) const;\n+  ImplicitArithOpBuilder min(int64_t rhs) const;\n+\n+  // Signed integer max.\n+  ImplicitArithOpBuilder max(mlir::Value rhs) const;\n+  ImplicitArithOpBuilder max(int64_t rhs) const;\n+\n   ImplicitArithOpBuilder MakeConstant(int64_t c) const;\n \n  private:"
        }
    ],
    "stats": {
        "total": 40,
        "additions": 40,
        "deletions": 0
    }
}