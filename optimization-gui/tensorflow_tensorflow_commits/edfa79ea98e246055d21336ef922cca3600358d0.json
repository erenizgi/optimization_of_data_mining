{
    "author": "jakeharmon8",
    "message": "Create python wheels containing XLA PJRT Plugins\n\nPiperOrigin-RevId: 804645186",
    "sha": "edfa79ea98e246055d21336ef922cca3600358d0",
    "files": [
        {
            "sha": "6129c137166b6c236f58234790d6b5244af02c00",
            "filename": "third_party/xla/build_tools/pjrt_wheels/BUILD.bazel",
            "status": "added",
            "additions": 105,
            "deletions": 0,
            "changes": 105,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/edfa79ea98e246055d21336ef922cca3600358d0/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/edfa79ea98e246055d21336ef922cca3600358d0/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2FBUILD.bazel?ref=edfa79ea98e246055d21336ef922cca3600358d0",
            "patch": "@@ -0,0 +1,105 @@\n+load(\"@rules_python//python:packaging.bzl\", \"py_wheel\")\n+\n+cuda_wheels = [\n+    \"cuda12\",\n+    \"cuda13\",\n+]\n+\n+cpu_wheel = [\"cpu\"]\n+\n+# Aliases and filegroups don't move files within bazel-out, so we need to use genrules to place them\n+# in the correct directory structure for the wheel.\n+[\n+    genrule(\n+        name = \"init_file_\" + arch,\n+        srcs = [\"__init__.py\"],\n+        outs = [\"xla_plugins/xla_\" + arch + \"_pjrt/__init__.py\"],\n+        cmd = \"cp $< $@\",\n+    )\n+    for arch in cuda_wheels + cpu_wheel\n+]\n+\n+# GPU-specific files\n+[\n+    cc_binary(\n+        name = \"xla_plugins/xla_\" + arch + \"_pjrt/xla_gpu_pjrt.so\",\n+        linkopts = [\n+            \"-Wl,--version-script,$(location :pjrt_symbols.lds)\",\n+            \"-Wl,--no-undefined\",\n+        ],\n+        linkshared = True,\n+        deps = [\n+            \":pjrt_symbols.lds\",\n+            \"//xla/pjrt/c:pjrt_c_api_gpu\",\n+        ],\n+    )\n+    for arch in cuda_wheels\n+]\n+\n+# GPU wheels\n+[\n+    py_wheel(\n+        name = \"xla_\" + arch + \"_pjrt\",\n+        author = \"The OpenXLA Authors\",\n+        classifiers = [\"Development Status :: 1 - Planning\"],\n+        distribution = \"xla_\" + arch + \"_pjrt\",\n+        entry_points = {\n+            \"xla_plugins\": [\n+                \"xla_\" + arch + \"_pjrt = xla_plugins.xla_\" + arch + \"_pjrt\\n\",\n+            ],\n+        },\n+        platform = \"manylinux2014_x86_64\",\n+        python_tag = \"py3\",\n+        strip_path_prefixes = [\"build_tools/pjrt_wheels\"],\n+        summary = \"XLA PJRT Plugin\",\n+        version = \"0.0.0.dev0\",\n+        deps = [\n+            \":xla_plugins/xla_\" + arch + \"_pjrt/xla_gpu_pjrt.so\",\n+            \":init_file_\" + arch,\n+        ],\n+    )\n+    for arch in cuda_wheels\n+]\n+\n+# CPU-specific files\n+[\n+    # TODO: Replace this with alias to .so found in xla/pjrt/c/BUILD\n+    cc_binary(\n+        name = \"xla_plugins/xla_\" + arch + \"_pjrt/xla_cpu_pjrt.so\",\n+        linkopts = [\n+            \"-Wl,--version-script,$(location :pjrt_symbols.lds)\",\n+            \"-Wl,--no-undefined\",\n+        ],\n+        linkshared = True,\n+        deps = [\n+            \":pjrt_symbols.lds\",\n+            \"//xla/pjrt/c:pjrt_c_api_cpu\",\n+        ],\n+    )\n+    for arch in cpu_wheel\n+]\n+\n+# CPU wheel\n+[\n+    py_wheel(\n+        name = \"xla_\" + arch + \"_pjrt\",\n+        author = \"The OpenXLA Authors\",\n+        classifiers = [\"Development Status :: 1 - Planning\"],\n+        distribution = \"xla_\" + arch + \"_pjrt\",\n+        entry_points = {\n+            \"xla_plugins\": [\n+                \"xla_\" + arch + \"_pjrt = xla_plugins.xla_\" + arch + \"_pjrt\\n\",\n+            ],\n+        },\n+        platform = \"manylinux2014_x86_64\",\n+        python_tag = \"py3\",\n+        strip_path_prefixes = [\"build_tools/pjrt_wheels\"],\n+        summary = \"XLA PJRT Plugin\",\n+        version = \"0.0.0.dev0\",\n+        deps = [\n+            \":xla_plugins/xla_\" + arch + \"_pjrt/xla_cpu_pjrt.so\",\n+            \":init_file_\" + arch,\n+        ],\n+    )\n+    for arch in cpu_wheel\n+]"
        },
        {
            "sha": "331a2f38efe7a329d667b82dd85752658ec5b260",
            "filename": "third_party/xla/build_tools/pjrt_wheels/__init__.py",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/edfa79ea98e246055d21336ef922cca3600358d0/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2F__init__.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/edfa79ea98e246055d21336ef922cca3600358d0/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2F__init__.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2F__init__.py?ref=edfa79ea98e246055d21336ef922cca3600358d0",
            "patch": "@@ -0,0 +1 @@\n+# This is currently just here to mark the directory as a module."
        },
        {
            "sha": "cbac4549bde38d04f2083f98de5cf511811e21c1",
            "filename": "third_party/xla/build_tools/pjrt_wheels/pjrt_symbols.lds",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/edfa79ea98e246055d21336ef922cca3600358d0/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2Fpjrt_symbols.lds",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/edfa79ea98e246055d21336ef922cca3600358d0/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2Fpjrt_symbols.lds",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Fpjrt_wheels%2Fpjrt_symbols.lds?ref=edfa79ea98e246055d21336ef922cca3600358d0",
            "patch": "@@ -0,0 +1,9 @@\n+VERS_1.0 {\n+  global:\n+    extern \"C\" {\n+      GetPjrtApi;\n+    };\n+\n+  local:\n+    *;\n+};"
        }
    ],
    "stats": {
        "total": 115,
        "additions": 115,
        "deletions": 0
    }
}