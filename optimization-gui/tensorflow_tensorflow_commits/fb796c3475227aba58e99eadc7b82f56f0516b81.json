{
    "author": "KanishAnand",
    "message": "Clarify maximal mesh documentation.\n\nPiperOrigin-RevId: 825417349",
    "sha": "fb796c3475227aba58e99eadc7b82f56f0516b81",
    "files": [
        {
            "sha": "76de5f1f4b0a1270b4a98ed58b53a65812b0a6f2",
            "filename": "third_party/xla/xla/xla_data.proto",
            "status": "modified",
            "additions": 32,
            "deletions": 28,
            "changes": 60,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/fb796c3475227aba58e99eadc7b82f56f0516b81/third_party%2Fxla%2Fxla%2Fxla_data.proto",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/fb796c3475227aba58e99eadc7b82f56f0516b81/third_party%2Fxla%2Fxla%2Fxla_data.proto",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fxla_data.proto?ref=fb796c3475227aba58e99eadc7b82f56f0516b81",
            "patch": "@@ -959,38 +959,42 @@ message StatisticsViz {\n   repeated Statistic statistics = 2;\n }\n \n-// A mesh is a list of axes and an optional list of device IDs specifying\n-// the device ordering.\n-//\n-// If the list of axes is empty, the mesh has an implicit unnamed axis of\n-// size 1. In this case, if a device ID list is not provided, the implicit\n-// device ID list is [0]; if a device ID list is provided, it must\n-// contains a single integer of any non-negative value. We call this\n-// maximal-sharding case.\n-//\n-// For all non-maximal-sharding cases, if a device ID list is specified,\n-// the product of the axis sizes should match the number of devices. If a\n-// device ID list is not specified, the implicit device ID list is\n-// iota(product(axes)). For simplicity, we also disallow specifying a\n-// device ID list that is the same as iota(product(axes)); in this case, a\n-// device ID list shouldn't be specified.\n-//\n+// A mesh is a list of axes and an optional list of device IDs specifying the\n+// device ordering.\n+\n+// If the list of axes is empty\n+//   - If the `device_ids` is not provided, it is an empty mesh.\n+//   - If the `device_ids` is provided, it must be a single non-negative\n+//     integer, we call it a **maximal-sharding mesh**.\n+\n+// If the list of axes is provided\n+//   - If a device ID list is specified, the product of the axis sizes should\n+//     match the number of devices.\n+//   - If a device ID list is not specified, the implicit device ID list is\n+//     iota(product(axes)). For simplicity, we also disallow specifying a\n+//     device ID list that is the same as iota(product(axes)); in this case, a\n+//     device ID list shouldn't be specified.\n+//   - It is not a maximal-sharding mesh even if the total size of axes is 1.\n+\n // Here are some examples of meshes:\n+\n // - An empty mesh represents a placeholder mesh that can be replaced during\n-// propagation: <[]>\n-// - A mesh with an unnamed axis and an explicit device ID, which is\n-// typically used to represent maximal sharding: <[], device_ids=[3]>\n+//   propagation: <[]>\n+// - A mesh without axes list and a single non-negative device ID, which is a\n+//   maximal-sharding mesh: <[], device_ids=[3]>\n // - A mesh with two axes and implicit device IDs iota(6): <[\"a\"=2, \"b\"=3]>\n // - A mesh with two axes and explicit device IDs specifying the device\n-// ordering: <[\"a\"=3, \"b\"=2], device_ids=[0, 2, 4, 1, 3, 5]>\n-//\n-// Constraints:\n-// - Elements in `axes` must not have duplicate names.\n-// - If `device_ids` is specified:\n-//   * The product of axis sizes must match the number of devices.\n-//   * All of its elements must be non-negative.\n-//   * `device_ids` should not be equal to `iota(product(axis_sizes))`.\n-//   * Sorted `device_ids` must be `iota(product(axis_sizes))`.\n+//   ordering: <[\"a\"=3, \"b\"=2], device_ids=[0, 2, 4, 1, 3, 5]>\n+\n+// **Constraints:**\n+// - Elements in `device_ids` should be non-negative.\n+// - If `axes` is empty, the size of `device_ids` can be 0 (empty mesh) or 1\n+//   (maximal-sharding mesh).\n+// - If `axes` is not empty,\n+//     - Elements in `axes` must not have duplicate names.\n+//     - If `device_ids` is specified, the original `device_ids` is not\n+//       `iota(product(axis_sizes))` and the sorted `device_ids` is\n+//       `iota(product(axis_sizes))`.\n message MeshProto {\n   message MeshAxis {\n     string name = 1;"
        }
    ],
    "stats": {
        "total": 60,
        "additions": 32,
        "deletions": 28
    }
}