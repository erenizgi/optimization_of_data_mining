{
    "author": "pschuh",
    "message": "Oops, test doesn't actually use BufferReturner.\n\nPiperOrigin-RevId: 827724847",
    "sha": "18161a0cb25a84e08ba105797760c46eda285729",
    "files": [
        {
            "sha": "24c551b7136ff08fce1e99b4dafa74a2138d364b",
            "filename": "third_party/xla/xla/python/transfer/streaming_ifrt_test.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/18161a0cb25a84e08ba105797760c46eda285729/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming_ifrt_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/18161a0cb25a84e08ba105797760c46eda285729/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming_ifrt_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming_ifrt_test.cc?ref=18161a0cb25a84e08ba105797760c46eda285729",
            "patch": "@@ -189,8 +189,11 @@ TEST(PremappedCopierState, FreeCycle) {\n     absl::AnyInvocable<void() &&> on_done_;\n   };\n   cstate->ScheduleCopy(\n-      {/*copy_fn=*/[](void* dst, int64_t offset,\n-                      int64_t transfer_size) -> xla::Future<> {\n+      {/*copy_fn=*/[buffer = std::make_unique<BufferReturner>(\n+                        [buffer_to_return, cstate]() {\n+                          cstate->ReturnBuffer(buffer_to_return);\n+                        })](void* dst, int64_t offset,\n+                            int64_t transfer_size) -> xla::Future<> {\n          return xla::Future<>(absl::OkStatus());\n        },\n        /*buffer_id=*/0,"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
    }
}