{
    "author": "tensorflower-gardener",
    "message": "Add the g3doc for ML wheels.\n\nPiperOrigin-RevId: 804522912",
    "sha": "0e97766ff1b37ffd2ad96a14dbcfec548fe910a1",
    "files": [
        {
            "sha": "231e667b2134f8d1dd93d11089e9890d8c01b65c",
            "filename": "third_party/xla/third_party/py/README.md",
            "status": "added",
            "additions": 105,
            "deletions": 0,
            "changes": 105,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/0e97766ff1b37ffd2ad96a14dbcfec548fe910a1/third_party%2Fxla%2Fthird_party%2Fpy%2FREADME.md",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/0e97766ff1b37ffd2ad96a14dbcfec548fe910a1/third_party%2Fxla%2Fthird_party%2Fpy%2FREADME.md",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2FREADME.md?ref=0e97766ff1b37ffd2ad96a14dbcfec548fe910a1",
            "patch": "@@ -0,0 +1,105 @@\n+# ML wheels\n+\n+Provides a standardized and efficient system for packaging and verifying ML\n+software.\n+\n+## ML wheels features\n+\n+- Standardized creation, validation (`auditwheel`) and testing of wheel\n+  artifacts.\n+\n+- Availability of the final wheel artifacts in the Bazel Build phase, which\n+  enables testing of generated wheels by regular `py_test` targets\n+  together with the rest of the existing tests.\n+\n+- Ability to use Bazel RBE for wheel creation and testing.\n+\n+- Reproducible and unified steps for generating testing of the wheels on\n+  different platforms.\n+\n+## Getting started\n+\n+1. Integrate hermetic Python, C++ and CUDA (if needed) toolchains in the\n+   project.\n+\n+   Examples:\n+\n+   [JAX hermetic Python and C++ integration](https://github.com/jax-ml/jax/blob/006b2904720bf029cb4298ab963f8f50438e79df/WORKSPACE#L16-L84)\n+\n+   [JAX hermetic CUDA integration](https://github.com/jax-ml/jax/blob/006b2904720bf029cb4298ab963f8f50438e79df/WORKSPACE#L131-L196)\n+\n+   [TensorFlow hermetic Python integration](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/WORKSPACE#L32-L67)\n+\n+   [TensorFlow hermetic C++ and CUDA integration](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/WORKSPACE#L94-L170)\n+\n+2. Create python script that produces a wheel, and declare it as `py_binary`\n+   build rule.\n+\n+   A common case scenario: a python script should take wheel sources provided in\n+   the arguments list, then do the required transformations and run command like\n+   `python -m build` in the folder with the collected resources.\n+\n+   [JAX py_binary declaration](https://github.com/jax-ml/jax/blob/006b2904720bf029cb4298ab963f8f50438e79df/jaxlib/tools/BUILD.bazel#L230-L241)\n+\n+   [TensorFlow py_binary declaration](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/tensorflow/tools/pip_package/BUILD#L242-L253)\n+\n+3. Create Bazel build rule that returns python wheel in the output.\n+\n+   In a common case scenario, this Bazel rule runs `py_binary` (created in\n+   step 1) passed in the rule attributes.\n+\n+   [JAX rule definition](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/tensorflow/tools/pip_package/BUILD#L242-L253)\n+\n+   [TensorFlow rule definition](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/tensorflow/tools/pip_package/utils/tf_wheel.bzl#L137-L154)\n+\n+   - The wheel sources should be provided in the wheel build rule attributes.\n+\n+     To collect the wheel sources that are suitable for all types of Bazel\n+     builds, including cross-compile builds, the following build rules should be\n+     used: `collect_data_files`, `transitive_py_deps` from\n+     `@local_xla//third_party/py:python_wheel.bzl`, and `transitive_hdrs` from\n+     `@local_xla//xla/tsl:tsl.bzl`.\n+\n+     [jaxlib wheel sources](https://github.com/jax-ml/jax/blob/006b2904720bf029cb4298ab963f8f50438e79df/jaxlib/tools/BUILD.bazel#L243-L265)\n+\n+     [TensorFlow wheel sources](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/tensorflow/tools/pip_package/BUILD#L312-L367)\n+\n+   - the wheel name should conform to\n+     [PEP-491 naming convention](https://peps.python.org/pep-0491/#file-name-convention).\n+\n+     [JAX example](https://github.com/jax-ml/jax/blob/006b2904720bf029cb4298ab963f8f50438e79df/jaxlib/jax.bzl#L326-L348)\n+\n+     [TensorFlow example](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/tensorflow/tools/pip_package/utils/tf_wheel.bzl#L56-L69)\n+\n+   - Storing of the wheel version is custom, and should be implemented per\n+     project. It can be additional repository rule, or a constant in .bzl file.\n+\n+     [JAX example](https://github.com/jax-ml/jax/blob/006b2904720bf029cb4298ab963f8f50438e79df/WORKSPACE#L108-L114)\n+\n+     [Tensorflow example](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/tensorflow/tf_version.bzl#L11)\n+\n+   - The wheel suffix is controlled by a common repository rule\n+     `python_wheel_version_suffix_repository`, that should be called in\n+     `WORKSPACE` file.\n+\n+     [JAX rule call](https://github.com/jax-ml/jax/blob/006b2904720bf029cb4298ab963f8f50438e79df/WORKSPACE#L127-L129)\n+\n+     [Tensorflow rule call](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/WORKSPACE#L92)\n+\n+4. To verify manylinux tag compliance, use common py_binary\n+  `verify_manylinux_compliance_test`.\n+\n+  [JAX tests](https://github.com/jax-ml/jax/blob/006b2904720bf029cb4298ab963f8f50438e79df/jaxlib/tools/BUILD.bazel#L626-L668)\n+\n+  [Tensorflow test](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/tensorflow/tools/pip_package/BUILD#L441-L450)\n+\n+5. With the wheel build rule defined, one can run Bazel test targets dependent\n+  on the wheel instead of individual Bazel targets. To implement it, define\n+  `py_import` call. `py_import` target can be used in other python targets in\n+  the same way as `py_library`.\n+\n+  [JAX example](https://github.com/jax-ml/jax/blob/006b2904720bf029cb4298ab963f8f50438e79df/jaxlib/tools/BUILD.bazel#L542-L570)\n+\n+  [Tensorflow example](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/tensorflow/tools/pip_package/BUILD#L452-L485)\n+\n+  [TensorFlow tests dependent on `py_import`](https://github.com/tensorflow/tensorflow/blob/5feca557408c3552494c4db03a02b36f9817bd37/tensorflow/tools/pip_package/BUILD#L411-L439)"
        }
    ],
    "stats": {
        "total": 105,
        "additions": 105,
        "deletions": 0
    }
}