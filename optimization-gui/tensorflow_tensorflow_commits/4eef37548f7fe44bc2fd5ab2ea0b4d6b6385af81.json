{
    "author": "tensorflower-gardener",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 832664914",
    "sha": "4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81",
    "files": [
        {
            "sha": "459dbb6e4db0b024a26c5442ef165bbfbc278069",
            "filename": "third_party/xla/xla/tsl/framework/allocator.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fallocator.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fallocator.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fallocator.cc?ref=4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81",
            "patch": "@@ -26,7 +26,7 @@ limitations under the License.\n \n namespace tsl {\n \n-string AllocatorStats::DebugString() const {\n+std::string AllocatorStats::DebugString() const {\n   return strings::Printf(\n       \"Limit:            %20lld\\n\"\n       \"InUse:            %20lld\\n\"\n@@ -56,7 +56,7 @@ static bool cpu_allocator_collect_full_stats = false;\n void EnableCPUAllocatorFullStats() { cpu_allocator_collect_full_stats = true; }\n bool CPUAllocatorFullStatsEnabled() { return cpu_allocator_collect_full_stats; }\n \n-string AllocatorAttributes::DebugString() const {\n+std::string AllocatorAttributes::DebugString() const {\n   return strings::StrCat(\"AllocatorAttributes(on_host=\", on_host(),\n                          \" nic_compatible=\", nic_compatible(),\n                          \" gpu_compatible=\", gpu_compatible(), \")\");"
        },
        {
            "sha": "218bb24f05d54ba7403f269024b5d97612bd6877",
            "filename": "third_party/xla/xla/tsl/framework/allocator.h",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fallocator.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fallocator.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fallocator.h?ref=4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81",
            "patch": "@@ -38,7 +38,7 @@ struct AllocationAttributes {\n   AllocationAttributes() = default;\n \n   AllocationAttributes(bool retry_on_failure, bool allocation_will_be_logged,\n-                       std::function<uint64()>* freed_by_func)\n+                       std::function<uint64_t()>* freed_by_func)\n       : retry_on_failure(retry_on_failure),\n         allocation_will_be_logged(allocation_will_be_logged),\n         freed_by_func(freed_by_func) {}\n@@ -59,7 +59,7 @@ struct AllocationAttributes {\n   // EXPERIMENTAL: If provided, then evaluates to a timing count such that only\n   // a memory chunk whose freed_at_count is at this value or earlier may be\n   // returned.\n-  std::function<uint64()>* freed_by_func = nullptr;  // Not owned.\n+  std::function<uint64_t()>* freed_by_func = nullptr;  // Not owned.\n \n   AllocationAttributes(const AllocationAttributes&) = delete;\n   void operator=(const AllocationAttributes&) = delete;\n@@ -232,7 +232,7 @@ class Allocator {\n   // REQUIRES: GetStats is overridden.\n   virtual bool ClearStats() TF_MUST_USE_RESULT { return false; }\n \n-  virtual void SetSafeFrontier(uint64 count) {}\n+  virtual void SetSafeFrontier(uint64_t count) {}\n \n   // For allocator that are stream aware, allow to specify the compute\n   // stream this allocator is used for. This can also trigger memory\n@@ -352,10 +352,10 @@ struct AllocatorAttributes {\n   // device-specific uses.  Implementors of a device can interpret these\n   // upper 8 bits in device-specific ways, and ops implemented for those\n   // devices are responsible for setting those 8 bits appropriately.\n-  uint32 value = 0;\n+  uint32_t value = 0;\n   // EXPERIMENTAL: If this is greater than zero, then allocation is delegated to\n   // a named special-purpose allocator on the same device.\n-  int32 scope_id = 0;\n+  int32_t scope_id = 0;\n \n   // Returns a human readable representation of this.\n   std::string DebugString() const;"
        },
        {
            "sha": "b52ac7c77558c1e7dbf182556b0fa46a470373ef",
            "filename": "third_party/xla/xla/tsl/framework/bfc_allocator.h",
            "status": "modified",
            "additions": 14,
            "deletions": 13,
            "changes": 27,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fbfc_allocator.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fbfc_allocator.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fbfc_allocator.h?ref=4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81",
            "patch": "@@ -76,11 +76,11 @@ class BFCAllocator : public Allocator {\n     double fragmentation_fraction = 0;\n   };\n   BFCAllocator(std::unique_ptr<SubAllocator> sub_allocator, size_t total_memory,\n-               const string& name, const Options& opts);\n+               const std::string& name, const Options& opts);\n \n   ~BFCAllocator() override;\n \n-  string Name() override { return name_; }\n+  std::string Name() override { return name_; }\n \n   void* AllocateRaw(size_t alignment, size_t num_bytes) override {\n     return AllocateRaw(alignment, num_bytes, AllocationAttributes());\n@@ -105,7 +105,7 @@ class BFCAllocator : public Allocator {\n \n   void SetTimingCounter(SharedCounter* sc) { timing_counter_ = sc; }\n \n-  void SetSafeFrontier(uint64 count) override;\n+  void SetSafeFrontier(uint64_t count) override;\n \n   AllocatorMemoryType GetMemoryType() const override;\n \n@@ -118,7 +118,7 @@ class BFCAllocator : public Allocator {\n \n   void* AllocateRawInternal(size_t alignment, size_t num_bytes,\n                             bool dump_log_on_failure,\n-                            uint64 freed_before_count);\n+                            uint64_t freed_before_count);\n \n   void* AllocateRawInternalWithRetry(\n       size_t alignment, size_t num_bytes,\n@@ -212,7 +212,7 @@ class BFCAllocator : public Allocator {\n     BinNum bin_num = kInvalidBinNum;\n \n     // Optional count when this chunk was most recently made free.\n-    uint64 freed_at_count = 0;\n+    uint64_t freed_at_count = 0;\n \n     bool in_use() const { return allocation_id != -1; }\n \n@@ -223,9 +223,9 @@ class BFCAllocator : public Allocator {\n     int64 action_count = 0;\n #endif\n \n-    string DebugString(BFCAllocator* a,\n-                       bool recurse) ABSL_NO_THREAD_SAFETY_ANALYSIS {\n-      string dbg;\n+    std::string DebugString(BFCAllocator* a,\n+                            bool recurse) ABSL_NO_THREAD_SAFETY_ANALYSIS {\n+      std::string dbg;\n       absl::StrAppend(\n           &dbg, \"  Size: \", strings::HumanReadableNumBytes(size),\n           \" | Requested Size: \", strings::HumanReadableNumBytes(requested_size),\n@@ -474,7 +474,8 @@ class BFCAllocator : public Allocator {\n   // Returns a pointer to an underlying allocated chunk of size\n   // 'rounded_bytes'.\n   void* FindChunkPtr(BinNum bin_num, size_t rounded_bytes, size_t num_bytes,\n-                     uint64 freed_before) ABSL_EXCLUSIVE_LOCKS_REQUIRED(mutex_);\n+                     uint64_t freed_before)\n+      ABSL_EXCLUSIVE_LOCKS_REQUIRED(mutex_);\n \n   // Splits the chunk specified by 'h' into two chunks, one at least\n   // of size 'num_bytes'.\n@@ -504,7 +505,7 @@ class BFCAllocator : public Allocator {\n   // Removes the chunk metadata represented by 'h'.\n   void DeleteChunk(ChunkHandle h) ABSL_EXCLUSIVE_LOCKS_REQUIRED(mutex_);\n \n-  string RenderOccupancy() ABSL_EXCLUSIVE_LOCKS_REQUIRED(mutex_);\n+  std::string RenderOccupancy() ABSL_EXCLUSIVE_LOCKS_REQUIRED(mutex_);\n   void DumpMemoryLog(size_t num_bytes) ABSL_EXCLUSIVE_LOCKS_REQUIRED(mutex_);\n   tensorflow::MemoryDump RecordMemoryMapInternal()\n       ABSL_EXCLUSIVE_LOCKS_REQUIRED(mutex_);\n@@ -552,7 +553,7 @@ class BFCAllocator : public Allocator {\n     return static_cast<size_t>(256) << index;\n   }\n   BinNum BinNumForSize(size_t bytes) {\n-    uint64 v = std::max<size_t>(bytes, 256) >> kMinAllocationBits;\n+    uint64_t v = std::max<size_t>(bytes, 256) >> kMinAllocationBits;\n     int b = std::min(kNumBins - 1, tsl::Log2Floor64(v));\n     return b;\n   }\n@@ -573,11 +574,11 @@ class BFCAllocator : public Allocator {\n   const bool coalesce_regions_;\n \n   std::unique_ptr<SubAllocator> sub_allocator_;\n-  string name_;\n+  std::string name_;\n   SharedCounter* timing_counter_ = nullptr;\n   std::deque<ChunkHandle> timestamped_chunks_;\n \n-  std::atomic<uint64> safe_frontier_ = {0};\n+  std::atomic<uint64_t> safe_frontier_ = {0};\n \n   // Structures mutable after construction\n   mutable absl::Mutex mutex_;"
        },
        {
            "sha": "6738ffb356c7b38522215111f935568f9a62c548",
            "filename": "third_party/xla/xla/tsl/framework/device_id.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fdevice_id.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fdevice_id.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Fdevice_id.h?ref=4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81",
            "patch": "@@ -81,8 +81,8 @@ namespace tsl {\n // for the StreamExecutor interface (as we don't change its API), whenever we\n // need a TF device id (or platform device id) we should use TfDeviceId (or\n // PlatformDeviceId) instead of a raw integer.\n-TSL_LIB_GTL_DEFINE_INT_TYPE(TfDeviceId, int32);\n-TSL_LIB_GTL_DEFINE_INT_TYPE(PlatformDeviceId, int32);\n+TSL_LIB_GTL_DEFINE_INT_TYPE(TfDeviceId, int32_t);\n+TSL_LIB_GTL_DEFINE_INT_TYPE(PlatformDeviceId, int32_t);\n \n }  // namespace tsl\n "
        },
        {
            "sha": "18120da72225ab93674eb402507a2d5f0a06ef72",
            "filename": "third_party/xla/xla/tsl/framework/type_traits.h",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Ftype_traits.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Ftype_traits.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fframework%2Ftype_traits.h?ref=4eef37548f7fe44bc2fd5ab2ea0b4d6b6385af81",
            "patch": "@@ -89,15 +89,15 @@ struct is_simple_type {\n // standard types.\n namespace std {\n template <>\n-class numeric_limits<tsl::qint8> : public numeric_limits<tsl::int8> {};\n+class numeric_limits<tsl::qint8> : public numeric_limits<int8_t> {};\n template <>\n-class numeric_limits<tsl::quint8> : public numeric_limits<tsl::uint8> {};\n+class numeric_limits<tsl::quint8> : public numeric_limits<uint8_t> {};\n template <>\n-class numeric_limits<tsl::qint16> : public numeric_limits<tsl::int16> {};\n+class numeric_limits<tsl::qint16> : public numeric_limits<int16_t> {};\n template <>\n-class numeric_limits<tsl::quint16> : public numeric_limits<tsl::uint16> {};\n+class numeric_limits<tsl::quint16> : public numeric_limits<uint16_t> {};\n template <>\n-class numeric_limits<tsl::qint32> : public numeric_limits<tsl::int32> {};\n+class numeric_limits<tsl::qint32> : public numeric_limits<int32_t> {};\n \n }  // namespace std\n "
        }
    ],
    "stats": {
        "total": 55,
        "additions": 28,
        "deletions": 27
    }
}