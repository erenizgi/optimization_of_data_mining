{
    "author": "mwhittaker",
    "message": "Avoid metric clash in coordination service.\n\nPiperOrigin-RevId: 840797879",
    "sha": "50db1276483fb25a894d8ab3e03e1384031935b4",
    "files": [
        {
            "sha": "72dfd996032f16de2f56b92f70ebdfb930b60e43",
            "filename": "third_party/xla/xla/pjrt/distributed/coordination/coordination_service_agent.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/50db1276483fb25a894d8ab3e03e1384031935b4/third_party%2Fxla%2Fxla%2Fpjrt%2Fdistributed%2Fcoordination%2Fcoordination_service_agent.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/50db1276483fb25a894d8ab3e03e1384031935b4/third_party%2Fxla%2Fxla%2Fpjrt%2Fdistributed%2Fcoordination%2Fcoordination_service_agent.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fdistributed%2Fcoordination%2Fcoordination_service_agent.cc?ref=50db1276483fb25a894d8ab3e03e1384031935b4",
            "patch": "@@ -66,7 +66,7 @@ using tensorflow::KeyValueEntry;\n namespace {\n \n auto* enabled_usage_metric = tsl::monitoring::Gauge<bool, 0>::New(\n-    \"/coordination_service/agent/enabled\",\n+    \"/coordination_service/v2/agent/enabled\",\n     \"Tracks usage of coordination service.\");\n \n constexpr absl::Duration kDefaultClusterRegisterTimeout = absl::Hours(1);"
        },
        {
            "sha": "377ff5f50a9bf14fbe12eec535ed4e795f21d5ed",
            "filename": "third_party/xla/xla/pjrt/distributed/preemption/preemption_sync_manager.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/50db1276483fb25a894d8ab3e03e1384031935b4/third_party%2Fxla%2Fxla%2Fpjrt%2Fdistributed%2Fpreemption%2Fpreemption_sync_manager.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/50db1276483fb25a894d8ab3e03e1384031935b4/third_party%2Fxla%2Fxla%2Fpjrt%2Fdistributed%2Fpreemption%2Fpreemption_sync_manager.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fdistributed%2Fpreemption%2Fpreemption_sync_manager.cc?ref=50db1276483fb25a894d8ab3e03e1384031935b4",
            "patch": "@@ -51,20 +51,20 @@ constexpr char kPreemptionBarrier[] = \"PREEMPTION_SYNC_BARRIER\";\n constexpr absl::Duration kPreemptionBarrierTimeout = absl::Minutes(3);\n \n auto* sync_usage_metric = tsl::monitoring::Gauge<bool, 0>::New(\n-    \"/coordination_service/preempt_manager/reached_sync_point_usage\",\n+    \"/coordination_service/v2/preempt_manager/reached_sync_point_usage\",\n     \"Records if preempt sync manager's ReachSyncPoint() was called at least \"\n     \"once.\");\n \n auto* notified_metric = tsl::monitoring::Gauge<bool, 0>::New(\n-    \"/coordination_service/preempt_manager/notified\",\n+    \"/coordination_service/v2/preempt_manager/notified\",\n     \"Records receipt of preemption notification.\");\n \n auto* set_sync_point_metric = tsl::monitoring::Gauge<bool, 0>::New(\n-    \"/coordination_service/preempt_manager/set_sync_point\",\n+    \"/coordination_service/v2/preempt_manager/set_sync_point\",\n     \"Records that sync point is set.\");\n \n auto* reached_sync_point_metric = tsl::monitoring::Gauge<bool, 0>::New(\n-    \"/coordination_service/preempt_manager/reached_sync_point\",\n+    \"/coordination_service/v2/preempt_manager/reached_sync_point\",\n     \"Records that sync point is reached.\");\n \n // Only start protocol if death time is within `kProtocolDuration`, so that we"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
    }
}