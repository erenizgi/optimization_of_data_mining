{
    "author": "alekstheod",
    "message": "PR #32460: [ROCm] Add cuda-only tag to cuda_library\n\nImported from GitHub PR https://github.com/openxla/xla/pull/32460\n\nğŸ“ Summary of Changes\nFix building xla with rocm.\n\nğŸ¯ Justification\nAdd cuda-only tag to cuda_library targets,\nthat will prevent building them when build with rocm config.\n\nğŸš€ Kind of Contribution\nPlease remove what does not apply: ğŸ› Bug Fix\n\nğŸ“Š Benchmark (for Performance Improvements)\nNot relevant\n\nğŸ§ª Unit Tests:\nCI, build fix\n\nğŸ§ª Execution Tests:\nNot relevant\n\nCopybara import of the project:\n\n--\n2698efeb4f8fec85396bad712c86ba59d2a6b1e6 by Alexandros Theodoridis <atheodor@amd.com>:\n\nAdd cuda-only tag to cuda_library\n\nMerging this change closes #32460\n\nPiperOrigin-RevId: 817101933",
    "sha": "2a645ba8c46d11c756e7954ec78a33d61c4067be",
    "files": [
        {
            "sha": "40ca4a62607cdad124f836d4f275234ccf6d332e",
            "filename": "third_party/xla/third_party/gpus/cuda/build_defs.bzl.tpl",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2a645ba8c46d11c756e7954ec78a33d61c4067be/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcuda%2Fbuild_defs.bzl.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2a645ba8c46d11c756e7954ec78a33d61c4067be/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcuda%2Fbuild_defs.bzl.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fgpus%2Fcuda%2Fbuild_defs.bzl.tpl?ref=2a645ba8c46d11c756e7954ec78a33d61c4067be",
            "patch": "@@ -162,7 +162,10 @@ def cuda_library(copts = [], tags = [], deps = [], **kwargs):\n     local_defines = kwargs.pop(\"local_defines\", []) + [\"register=\"]\n     native.cc_library(\n         copts = cuda_default_copts() + copts,\n-        tags = tags + [\"gpu\"],\n+        tags = tags + [\n+            \"gpu\",\n+            \"cuda-only\",\n+        ],\n         deps = deps + if_cuda_is_configured([\n             \"@local_config_cuda//cuda:implicit_cuda_headers_dependency\",\n         ]),"
        }
    ],
    "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
    }
}