{
    "author": "tensorflower-gardener",
    "message": "Add `size_t` casts to `memcpy` size calculation in `BroadcastTo`.\n\nExplicitly cast the operands of the size calculation to `size_t` to prevent potential integer overflow before calling `memcpy` under 64bit system.\n\nPiperOrigin-RevId: 824732102",
    "sha": "633e1931cd7c1c18c5a88550e2112f41e2ce8f66",
    "files": [
        {
            "sha": "0cd03db926df672ac3dbd352b4122a1fe5403496",
            "filename": "tensorflow/lite/kernels/internal/reference/broadcast_to.h",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/633e1931cd7c1c18c5a88550e2112f41e2ce8f66/tensorflow%2Flite%2Fkernels%2Finternal%2Freference%2Fbroadcast_to.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/633e1931cd7c1c18c5a88550e2112f41e2ce8f66/tensorflow%2Flite%2Fkernels%2Finternal%2Freference%2Fbroadcast_to.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Fkernels%2Finternal%2Freference%2Fbroadcast_to.h?ref=633e1931cd7c1c18c5a88550e2112f41e2ce8f66",
            "patch": "@@ -15,6 +15,8 @@ limitations under the License.\n #ifndef TENSORFLOW_LITE_KERNELS_INTERNAL_REFERENCE_BROADCAST_TO_H_\n #define TENSORFLOW_LITE_KERNELS_INTERNAL_REFERENCE_BROADCAST_TO_H_\n \n+#include <cstddef>\n+\n #include \"tensorflow/lite/kernels/internal/common.h\"\n #include \"tensorflow/lite/kernels/kernel_util.h\"\n \n@@ -83,7 +85,8 @@ inline void BroadcastTo(const RuntimeShape& unextended_input_shape,\n   // If non-broadcasting, just copy data from input to output tensor.\n   if (last_broadcast_dim == -1) {\n     memcpy(output_data, input_data,\n-           unextended_input_shape.FlatSize() * TfLiteTypeGetSize(data_type));\n+           static_cast<size_t>(unextended_input_shape.FlatSize()) *\n+               static_cast<size_t>(TfLiteTypeGetSize(data_type)));\n     return;\n   }\n "
        }
    ],
    "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
    }
}