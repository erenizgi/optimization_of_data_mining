{
    "author": "codingWizard-Nikhil",
    "message": "Add validation to raise clear error for complex dtypes in argsort\n\nFixes #99164\n\n- Added dtype validation in np_math_ops.argsort to check for complex64/complex128\n- Raises TypeError with clear message instead of confusing internal error\n- Added test case to verify error is raised correctly for both complex dtypes",
    "sha": "241cd1c1412fe400dcbe1581426873a4c8bfd58c",
    "files": [
        {
            "sha": "3c433730cdd1dd7bb2bb76df4c797cfa0edb5019",
            "filename": "tensorflow/python/ops/numpy_ops/np_math_ops.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/241cd1c1412fe400dcbe1581426873a4c8bfd58c/tensorflow%2Fpython%2Fops%2Fnumpy_ops%2Fnp_math_ops.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/241cd1c1412fe400dcbe1581426873a4c8bfd58c/tensorflow%2Fpython%2Fops%2Fnumpy_ops%2Fnp_math_ops.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fops%2Fnumpy_ops%2Fnp_math_ops.py?ref=241cd1c1412fe400dcbe1581426873a4c8bfd58c",
            "patch": "@@ -1363,6 +1363,12 @@ def argsort(a, axis=-1, kind='quicksort', order=None):  # pylint: disable=missin\n \n   a = np_array_ops.array(a)\n \n+  if a.dtype in (dtypes.complex64, dtypes.complex128):\n+    raise TypeError(\n+        'argsort does not support complex64/complex128 dtypes on CPU backend. '\n+        f'Received dtype: {a.dtype}'\n+    )\n+\n   def _argsort(a, axis, stable):\n     if axis is None:\n       a = array_ops.reshape(a, [-1])"
        },
        {
            "sha": "94448fce8f8cf8b7a4afcaed14cdb76c13aeae8f",
            "filename": "tensorflow/python/ops/numpy_ops/np_math_ops_test.py",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/241cd1c1412fe400dcbe1581426873a4c8bfd58c/tensorflow%2Fpython%2Fops%2Fnumpy_ops%2Fnp_math_ops_test.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/241cd1c1412fe400dcbe1581426873a4c8bfd58c/tensorflow%2Fpython%2Fops%2Fnumpy_ops%2Fnp_math_ops_test.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fops%2Fnumpy_ops%2Fnp_math_ops_test.py?ref=241cd1c1412fe400dcbe1581426873a4c8bfd58c",
            "patch": "@@ -178,6 +178,20 @@ def testArgsort(self):\n     a = np.zeros(100)\n     np.testing.assert_equal(np_math_ops.argsort(a, kind='stable'), r)\n \n+    def testArgsortRaisesErrorForComplexDtypes(self):\n+      \"\"\"Test that argsort raises TypeError for complex64 and complex128.\"\"\"\n+      complex64_array = np.array([1+2j, 3+4j, 5+6j], dtype=np.complex64)\n+      with self.assertRaisesRegex(\n+          TypeError,\n+          'argsort does not support complex64/complex128 dtypes'):\n+        np_math_ops.argsort(complex64_array)\n+    \n+      complex128_array = np.array([1+2j, 3+4j, 5+6j], dtype=np.complex128)\n+      with self.assertRaisesRegex(\n+          TypeError,\n+          'argsort does not support complex64/complex128 dtypes'):\n+        np_math_ops.argsort(complex128_array)\n+\n   def testArgMaxArgMin(self):\n     data = [\n         0,"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 20,
        "deletions": 0
    }
}