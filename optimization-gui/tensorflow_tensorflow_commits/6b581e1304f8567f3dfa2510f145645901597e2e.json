{
    "author": "vksnk",
    "message": "[XLA:CPU] Enable i8xi8->i32 grouped convolutions with ynnpack.\n\nPiperOrigin-RevId: 846354265",
    "sha": "6b581e1304f8567f3dfa2510f145645901597e2e",
    "files": [
        {
            "sha": "7054d92f615ced8683fd32dac41ea0b64e85c547",
            "filename": "third_party/xla/xla/backends/cpu/ynn_support.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 13,
            "changes": 15,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/6b581e1304f8567f3dfa2510f145645901597e2e/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_support.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/6b581e1304f8567f3dfa2510f145645901597e2e/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_support.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_support.cc?ref=6b581e1304f8567f3dfa2510f145645901597e2e",
            "patch": "@@ -313,23 +313,12 @@ bool IsConvolutionOpSupportedByYnn(const HloInstruction* instr) {\n   // Stores tuple of allowed (input, output) dtypes.\n   static const absl::NoDestructor<absl::flat_hash_set<\n       std::tuple<PrimitiveType, PrimitiveType, PrimitiveType>>>\n-      kAllowedTypesNonGrouped(\n-          {{F32, F32, F32}, {BF16, BF16, F32}, {S8, S8, S32}});\n-\n-  static const absl::NoDestructor<absl::flat_hash_set<\n-      std::tuple<PrimitiveType, PrimitiveType, PrimitiveType>>>\n-      kAllowedTypesGrouped({{F32, F32, F32}, {BF16, BF16, F32}});\n+      kAllowedTypes({{F32, F32, F32}, {BF16, BF16, F32}, {S8, S8, S32}});\n \n   PrimitiveType lhs_dtype = conv->operand(0)->shape().element_type();\n   PrimitiveType rhs_dtype = conv->operand(1)->shape().element_type();\n   PrimitiveType out_dtype = conv->shape().element_type();\n-  if (conv->feature_group_count() == 1 &&\n-      !kAllowedTypesNonGrouped->contains({lhs_dtype, rhs_dtype, out_dtype})) {\n-    return false;\n-  }\n-\n-  if (conv->feature_group_count() > 1 &&\n-      !kAllowedTypesGrouped->contains({lhs_dtype, rhs_dtype, out_dtype})) {\n+  if (!kAllowedTypes->contains({lhs_dtype, rhs_dtype, out_dtype})) {\n     return false;\n   }\n "
        }
    ],
    "stats": {
        "total": 15,
        "additions": 2,
        "deletions": 13
    }
}