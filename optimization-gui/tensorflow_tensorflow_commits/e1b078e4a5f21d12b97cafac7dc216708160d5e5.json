{
    "author": "tensorflower-gardener",
    "message": "#HLODiff Add a system message pop-up for HLO diff.\n\nPiperOrigin-RevId: 799339560",
    "sha": "e1b078e4a5f21d12b97cafac7dc216708160d5e5",
    "files": [
        {
            "sha": "cf66044595c05d0dc99b48df70c9ade451b2267d",
            "filename": "third_party/xla/xla/hlo/tools/hlo_diff/render/hlo_gumgraph_html_renderer.cc",
            "status": "modified",
            "additions": 61,
            "deletions": 3,
            "changes": 64,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e1b078e4a5f21d12b97cafac7dc216708160d5e5/third_party%2Fxla%2Fxla%2Fhlo%2Ftools%2Fhlo_diff%2Frender%2Fhlo_gumgraph_html_renderer.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e1b078e4a5f21d12b97cafac7dc216708160d5e5/third_party%2Fxla%2Fxla%2Fhlo%2Ftools%2Fhlo_diff%2Frender%2Fhlo_gumgraph_html_renderer.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Ftools%2Fhlo_diff%2Frender%2Fhlo_gumgraph_html_renderer.cc?ref=e1b078e4a5f21d12b97cafac7dc216708160d5e5",
            "patch": "@@ -219,6 +219,7 @@ std::string PrintCss() {\n \n     span.hlo-instruction {\n       display: inline-block;\n+      cursor: pointer;\n     }\n     span.hlo-instruction:hover {\n       border: 2px solid #4285F4;\n@@ -259,6 +260,38 @@ std::string PrintCss() {\n       transform: translateY(-1px) scale(1.02);\n     }\n \n+    /* Styles for the system message pop-up */\n+    .system-message-container {\n+        /* Position fixed at the bottom of the viewport */\n+        position: fixed;\n+        bottom: 7px;\n+        left: 50%;\n+        transform: translateX(-50%) translateY(100%);\n+\n+        /* Appearance and transitions */\n+        background-color: #F5F3FF;\n+        border: 2px solid #8B5CF6;\n+        opacity: 0;\n+        visibility: hidden;\n+        transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out, visibility 0s 0.3s;\n+        z-index: 1000;\n+    }\n+\n+    /* Class to show the message */\n+    .system-message-container.show-message {\n+        transform: translateX(-50%) translateY(0);\n+        opacity: 1;\n+        visibility: visible;\n+        transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;\n+    }\n+\n+    .system-message-container.show-message span {\n+      color: #4C1D95;\n+      font-weight: 500;\n+      font-size: 16px;\n+      padding: 1.5rem;\n+    }\n+\n     </style>\n   )html\";\n }\n@@ -282,6 +315,20 @@ std::string PrintJavascript() {\n std::string PrintJavascriptForHoverEvent() {\n   return R\"html(\n   <script>\n+  function ShowSystemMessage(message) {\n+      const messageContainer = document.getElementById('system-message');\n+      const messageText = messageContainer.querySelector('span');\n+      messageText.textContent = message;\n+\n+      // Show the message pop-up\n+      messageContainer.classList.add('show-message');\n+\n+      // Automatically hide the message after 3 seconds\n+      setTimeout(() => {\n+      messageContainer.classList.remove('show-message');\n+      }, 3000);\n+  }\n+\n   const allSpans = document.querySelectorAll('span[data-diffid]');\n   allSpans.forEach(span => {\n       span.addEventListener('mouseover', handleMouseOver);\n@@ -353,6 +400,8 @@ std::string PrintJavascriptForHoverEvent() {\n               setTimeout(() => {\n                   targetSpan.classList.remove('temp-highlight');\n               }, 1500); // Remove highlight after 1.5 seconds\n+          } else {\n+              ShowSystemMessage(\"Corresponding instruction is in another computation.\");\n           }\n       }\n   }\n@@ -408,9 +457,11 @@ std::string EscapeStringForHtmlAttribute(absl::string_view str) {\n \n // Prints the div html block.\n std::string PrintDiv(absl::string_view content,\n-                     absl::Span<const absl::string_view> class_names) {\n-  return absl::StrFormat(R\"html(<div class=\"%s\">%s</div>)html\",\n-                         absl::StrJoin(class_names, \" \"), content);\n+                     absl::Span<const absl::string_view> class_names,\n+                     absl::string_view id = \"\") {\n+  std::string div_id = id.empty() ? \"\" : absl::StrCat(\" id=\\\"\", id, \"\\\"\");\n+  return absl::StrFormat(R\"html(<div class=\"%s\"%s>%s</div>)html\",\n+                         absl::StrJoin(class_names, \" \"), div_id, content);\n }\n \n // Print the span html block.\n@@ -441,6 +492,12 @@ std::string PrintSectionWithHeader(absl::string_view header,\n                   {\"section\"});\n }\n \n+// Prints a system message placeholder.\n+std::string PrintSystemMessagePlaceholder() {\n+  return PrintDiv(PrintSpan(\"System message placeholder\", {}),\n+                  {\"system-message-container\"}, \"system-message\");\n+}\n+\n // Prints a list of items.\n std::string PrintList(absl::Span<const std::string> items) {\n   return PrintDiv(absl::StrJoin(items, \"\",\n@@ -1193,6 +1250,7 @@ void RenderHtml(const DiffResult& diff_result, const DiffSummary& diff_summary,\n               PrintChangedInstructions(\n                   filtered_diff_result.changed_instructions, url_generator))));\n \n+  out << PrintSystemMessagePlaceholder();\n   out << PrintJavascriptForHoverEvent();\n   out << PrintJavascriptForToggleButton();\n }"
        }
    ],
    "stats": {
        "total": 64,
        "additions": 61,
        "deletions": 3
    }
}