{
    "author": "SandSnip3r",
    "message": "Remove HloPass dependency from DebugMeContextUtil.\n\nPiperOrigin-RevId: 809233536",
    "sha": "1ee501c2f7e019e5c1116a6627a45ff48dbc64fa",
    "files": [
        {
            "sha": "e9e38fd8bdc177d29a7de0eba9f50225e4f04510",
            "filename": "third_party/xla/xla/error/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 7,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/1ee501c2f7e019e5c1116a6627a45ff48dbc64fa/third_party%2Fxla%2Fxla%2Ferror%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/1ee501c2f7e019e5c1116a6627a45ff48dbc64fa/third_party%2Fxla%2Fxla%2Ferror%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ferror%2FBUILD?ref=1ee501c2f7e019e5c1116a6627a45ff48dbc64fa",
            "patch": "@@ -34,7 +34,6 @@ cc_library(\n     srcs = [\"debug_me_context_util.cc\"],\n     hdrs = [\"debug_me_context_util.h\"],\n     deps = [\n-        \"//xla/hlo/pass:hlo_pass\",\n         \"//xla/tsl/platform:debug_me_context\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n@@ -47,12 +46,7 @@ xla_cc_test(\n     srcs = [\"debug_me_context_util_test.cc\"],\n     deps = [\n         \":debug_me_context_util\",\n-        \"//xla/hlo/ir:hlo\",\n-        \"//xla/hlo/ir:hlo_module_group\",\n-        \"//xla/hlo/pass:hlo_pass\",\n-        \"@com_google_absl//absl/container:flat_hash_set\",\n-        \"@com_google_absl//absl/status\",\n-        \"@com_google_absl//absl/status:statusor\",\n+        \"//xla/tsl/platform:debug_me_context\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_googletest//:gtest_main\",\n     ],"
        },
        {
            "sha": "85ca8c6a4456364988a1c8b51ab5dfa62c951de9",
            "filename": "third_party/xla/xla/error/debug_me_context_util.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/1ee501c2f7e019e5c1116a6627a45ff48dbc64fa/third_party%2Fxla%2Fxla%2Ferror%2Fdebug_me_context_util.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/1ee501c2f7e019e5c1116a6627a45ff48dbc64fa/third_party%2Fxla%2Fxla%2Ferror%2Fdebug_me_context_util.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ferror%2Fdebug_me_context_util.cc?ref=1ee501c2f7e019e5c1116a6627a45ff48dbc64fa",
            "patch": "@@ -22,7 +22,6 @@ limitations under the License.\n #include \"absl/strings/cord.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/str_join.h\"\n-#include \"xla/hlo/pass/hlo_pass_interface.h\"\n #include \"xla/tsl/platform/debug_me_context.h\"\n \n namespace xla::error {\n@@ -67,8 +66,4 @@ std::string DebugMeContextToErrorMessageString() {\n   return error_message;\n }\n \n-HloPassDebugMeContext::HloPassDebugMeContext(const HloPassInterface* pass)\n-    : tsl::DebugMeContext<DebugMeContextKey>(DebugMeContextKey::kHloPass,\n-                                             std::string(pass->name())) {}\n-\n }  // namespace xla::error"
        },
        {
            "sha": "7e62007f0041aaa5e113ba5a62427b2217291a41",
            "filename": "third_party/xla/xla/error/debug_me_context_util.h",
            "status": "modified",
            "additions": 0,
            "deletions": 11,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/1ee501c2f7e019e5c1116a6627a45ff48dbc64fa/third_party%2Fxla%2Fxla%2Ferror%2Fdebug_me_context_util.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/1ee501c2f7e019e5c1116a6627a45ff48dbc64fa/third_party%2Fxla%2Fxla%2Ferror%2Fdebug_me_context_util.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ferror%2Fdebug_me_context_util.h?ref=1ee501c2f7e019e5c1116a6627a45ff48dbc64fa",
            "patch": "@@ -35,9 +35,6 @@ limitations under the License.\n \n namespace xla {\n \n-// Foward declaration\n-class HloPassInterface;\n-\n namespace error {\n \n // The canonical type URL for the DebugContextPayload.\n@@ -62,14 +59,6 @@ std::string DebugMeContextToErrorMessageString();\n // status, if the context is not empty and the status is not OK.\n void AttachDebugMeContextPayload(absl::Status& status);\n \n-// This class is a specialization of the RAII DebugMeContext specifically for\n-// HloPasses. The details of its constructor dictate what information from the\n-// HloPass is stored in the context.\n-class HloPassDebugMeContext : public tsl::DebugMeContext<DebugMeContextKey> {\n- public:\n-  explicit HloPassDebugMeContext(const HloPassInterface* pass);\n-};\n-\n }  // namespace error\n }  // namespace xla\n "
        },
        {
            "sha": "ef87f5a32f0d0dd32fbb10f3803132325c5a3303",
            "filename": "third_party/xla/xla/error/debug_me_context_util_test.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 26,
            "changes": 34,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/1ee501c2f7e019e5c1116a6627a45ff48dbc64fa/third_party%2Fxla%2Fxla%2Ferror%2Fdebug_me_context_util_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/1ee501c2f7e019e5c1116a6627a45ff48dbc64fa/third_party%2Fxla%2Fxla%2Ferror%2Fdebug_me_context_util_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ferror%2Fdebug_me_context_util_test.cc?ref=1ee501c2f7e019e5c1116a6627a45ff48dbc64fa",
            "patch": "@@ -18,41 +18,23 @@ limitations under the License.\n #include <string>\n \n #include <gtest/gtest.h>\n-#include \"absl/container/flat_hash_set.h\"\n-#include \"absl/status/statusor.h\"\n #include \"absl/strings/match.h\"\n #include \"absl/strings/string_view.h\"\n-#include \"xla/hlo/ir/hlo_module.h\"\n-#include \"xla/hlo/ir/hlo_module_group.h\"\n-#include \"xla/hlo/pass/hlo_pass_interface.h\"\n+#include \"xla/tsl/platform/debug_me_context.h\"\n \n namespace xla {\n namespace {\n \n-TEST(DebugMeContextUtil, BasicHloPass) {\n-  // Define a custom HLO pass.\n-  class TestPass : public HloPassInterface {\n-   public:\n-    absl::string_view name() const override { return \"hello123123\"; }\n-    absl::StatusOr<bool> Run(HloModule* module,\n-                             const absl::flat_hash_set<absl::string_view>&\n-                                 execution_threads) override {\n-      return false;\n-    }\n-    absl::StatusOr<bool> RunOnModuleGroup(\n-        HloModuleGroup* module_group,\n-        const absl::flat_hash_set<absl::string_view>& execution_threads)\n-        override {\n-      return false;\n-    }\n-  };\n-\n-  TestPass test_pass;\n-  error::HloPassDebugMeContext ctx(&test_pass);\n+TEST(DebugMeContextUtil, StringCheck) {\n+  constexpr absl::string_view kCompilerName{\"MyCompiler\"};\n+\n+  tsl::DebugMeContext<error::DebugMeContextKey> ctx(\n+      error::DebugMeContextKey::kCompiler, std::string(kCompilerName));\n+\n   const std::string error_message =\n       error::DebugMeContextToErrorMessageString();\n \n-  EXPECT_TRUE(absl::StrContains(error_message, test_pass.name()));\n+  EXPECT_TRUE(absl::StrContains(error_message, kCompilerName));\n }\n \n }  // namespace"
        }
    ],
    "stats": {
        "total": 58,
        "additions": 9,
        "deletions": 49
    }
}