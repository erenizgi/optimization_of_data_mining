{
    "author": "tensorflower-gardener",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 811167117",
    "sha": "ffe019c33f56478047ae1dfe39c7013307c1e279",
    "files": [
        {
            "sha": "9cdd8aa8310be4a66c10b045646b319d339ce727",
            "filename": "third_party/xla/xla/hlo/builder/xla_builder.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 4,
            "changes": 14,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ffe019c33f56478047ae1dfe39c7013307c1e279/third_party%2Fxla%2Fxla%2Fhlo%2Fbuilder%2Fxla_builder.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ffe019c33f56478047ae1dfe39c7013307c1e279/third_party%2Fxla%2Fxla%2Fhlo%2Fbuilder%2Fxla_builder.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fbuilder%2Fxla_builder.cc?ref=ffe019c33f56478047ae1dfe39c7013307c1e279",
            "patch": "@@ -545,7 +545,9 @@ absl::StatusOr<ProgramShape> XlaBuilder::GetSubcomputationShape(\n   TF_RETURN_IF_ERROR(first_error_);\n   TF_ASSIGN_OR_RETURN(const HloComputationProto* computation_proto,\n                       GetSubcomputation(id));\n-  return ProgramShape(computation_proto->program_shape());\n+  return ProgramShape(\n+      ProgramShape::FromProto(computation_proto->program_shape())\n+          .value_or(ProgramShape()));\n }\n \n absl::Status XlaBuilder::AddCalledComputation(XlaComputationId computation,\n@@ -867,8 +869,10 @@ absl::StatusOr<XlaComputation> XlaBuilder::Build(\n   }\n   if (!input_output_aliases_.empty() || !buffer_donors_.empty()) {\n     TF_RETURN_IF_ERROR(PopulateInputOutputAliasAndBufferDonor(\n-        module, ProgramShape(entry.program_shape()), input_output_aliases_,\n-        buffer_donors_));\n+        module,\n+        ProgramShape(ProgramShape::FromProto(entry.program_shape())\n+                         .value_or(ProgramShape())),\n+        input_output_aliases_, buffer_donors_));\n   }\n   module->add_computations()->Swap(&entry);\n   embedded_.clear();\n@@ -887,7 +891,9 @@ absl::StatusOr<XlaComputation> XlaBuilder::Build(XlaComputationId entry_id) {\n   if (!computation.input_output_aliases.empty() ||\n       !computation.buffer_donors.empty()) {\n     TF_RETURN_IF_ERROR(PopulateInputOutputAliasAndBufferDonor(\n-        &module, ProgramShape(entry.program_shape()),\n+        &module,\n+        ProgramShape(ProgramShape::FromProto(entry.program_shape())\n+                         .value_or(ProgramShape())),\n         computation.input_output_aliases, computation.buffer_donors));\n   }\n   for (auto& e : embedded_) {"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 10,
        "deletions": 4
    }
}