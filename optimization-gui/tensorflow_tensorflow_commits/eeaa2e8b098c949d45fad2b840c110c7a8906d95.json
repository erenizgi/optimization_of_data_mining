{
    "author": "tensorflower-gardener",
    "message": "[SymbolicMap] Add IsEmpty and IsIdentity methods\n\nPiperOrigin-RevId: 799475198",
    "sha": "eeaa2e8b098c949d45fad2b840c110c7a8906d95",
    "files": [
        {
            "sha": "f49307f138fbbd28feb004185c07ed1ac85fa13b",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/BUILD",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eeaa2e8b098c949d45fad2b840c110c7a8906d95/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eeaa2e8b098c949d45fad2b840c110c7a8906d95/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2FBUILD?ref=eeaa2e8b098c949d45fad2b840c110c7a8906d95",
            "patch": "@@ -218,6 +218,16 @@ cc_library(\n     ],\n )\n \n+xla_cc_test(\n+    name = \"symbolic_map_test\",\n+    srcs = [\"symbolic_map_test.cc\"],\n+    deps = [\n+        \":symbolic_expr\",\n+        \":symbolic_map\",\n+        \"@com_google_googletest//:gtest_main\",\n+    ],\n+)\n+\n cc_library(\n     name = \"symbolic_expr\",\n     srcs = [\"symbolic_expr.cc\"],"
        },
        {
            "sha": "125966a9c327b8c8696ea0a514ab24748da4747e",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_map.cc",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eeaa2e8b098c949d45fad2b840c110c7a8906d95/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eeaa2e8b098c949d45fad2b840c110c7a8906d95/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.cc?ref=eeaa2e8b098c949d45fad2b840c110c7a8906d95",
            "patch": "@@ -30,5 +30,18 @@ SymbolicMap::SymbolicMap(int64_t num_dimensions, int64_t num_symbols,\n       num_symbols_(num_symbols),\n       exprs_(std::move(exprs)) {}\n \n+bool SymbolicMap::IsIdentity() const {\n+  if (num_dimensions_ != GetNumResults()) {\n+    return false;\n+  }\n+  for (int i = 0; i < num_dimensions_; ++i) {\n+    const auto& expr = exprs_[i];\n+    if (expr.GetType() != SymbolicExprType::kVariable || expr.GetValue() != i) {\n+      return false;\n+    }\n+  }\n+  return true;\n+}\n+\n }  // namespace gpu\n }  // namespace xla"
        },
        {
            "sha": "5227ddd05ca26377674687bcfc75ce6b39a05164",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_map.h",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eeaa2e8b098c949d45fad2b840c110c7a8906d95/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eeaa2e8b098c949d45fad2b840c110c7a8906d95/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h?ref=eeaa2e8b098c949d45fad2b840c110c7a8906d95",
            "patch": "@@ -36,6 +36,12 @@ class SymbolicMap {\n   const std::vector<SymbolicExpr>& GetResults() const { return exprs_; }\n   SymbolicExpr GetResult(unsigned idx) const { return exprs_[idx]; }\n \n+  bool IsEmpty() const { return exprs_.empty(); }\n+\n+  // Returns true if each result expression is a direct mapping of the dimension\n+  // at the same index. Symbols are not considered in this check.\n+  bool IsIdentity() const;\n+\n  private:\n   int64_t num_dimensions_;\n   int64_t num_symbols_;"
        },
        {
            "sha": "680a9093def0fdfc4880bdea1bc725084dba41fd",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_map_test.cc",
            "status": "added",
            "additions": 60,
            "deletions": 0,
            "changes": 60,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/eeaa2e8b098c949d45fad2b840c110c7a8906d95/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/eeaa2e8b098c949d45fad2b840c110c7a8906d95/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map_test.cc?ref=eeaa2e8b098c949d45fad2b840c110c7a8906d95",
            "patch": "@@ -0,0 +1,60 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#include \"xla/service/gpu/model/experimental/symbolic_map.h\"\n+\n+#include <vector>\n+\n+#include <gtest/gtest.h>\n+#include \"xla/service/gpu/model/experimental/symbolic_expr.h\"\n+\n+namespace xla {\n+namespace gpu {\n+namespace {\n+\n+TEST(SymbolicMapTest, IsEmpty) {\n+  SymbolicExprContext ctx;\n+  EXPECT_TRUE(SymbolicMap(0, 0, {}).IsEmpty());\n+  EXPECT_TRUE(SymbolicMap(2, 1, {}).IsEmpty());\n+  EXPECT_FALSE(SymbolicMap(1, 0, {ctx.CreateVariable(0)}).IsEmpty());\n+}\n+\n+TEST(SymbolicMapTest, IsIdentity) {\n+  SymbolicExprContext ctx;\n+\n+  // True identity\n+  EXPECT_TRUE(SymbolicMap(2, 0, {ctx.CreateVariable(0), ctx.CreateVariable(1)})\n+                  .IsIdentity());\n+  // True identity with symbols\n+  EXPECT_TRUE(SymbolicMap(2, 1, {ctx.CreateVariable(0), ctx.CreateVariable(1)})\n+                  .IsIdentity());\n+\n+  // False: Wrong number of results\n+  EXPECT_FALSE(SymbolicMap(2, 0, {ctx.CreateVariable(0)}).IsIdentity());\n+  EXPECT_FALSE(SymbolicMap(1, 0, {ctx.CreateVariable(0), ctx.CreateVariable(1)})\n+                   .IsIdentity());\n+\n+  // False: Wrong expression type\n+  EXPECT_FALSE(SymbolicMap(2, 0, {ctx.CreateVariable(0), ctx.CreateConstant(1)})\n+                   .IsIdentity());\n+\n+  // False: Wrong variable ID\n+  EXPECT_FALSE(SymbolicMap(2, 0, {ctx.CreateVariable(1), ctx.CreateVariable(0)})\n+                   .IsIdentity());\n+}\n+\n+}  // namespace\n+}  // namespace gpu\n+}  // namespace xla"
        }
    ],
    "stats": {
        "total": 89,
        "additions": 89,
        "deletions": 0
    }
}