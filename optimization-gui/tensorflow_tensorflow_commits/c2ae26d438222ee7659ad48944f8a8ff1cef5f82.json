{
    "author": "tensorflower-gardener",
    "message": "[SymbolicMap] Add methods to get symbolic expressions for dimensions and symbols\n\nWe need them to replace GetAffineDimExpr() and GetAffineSymbolExpr() in IndexingMap\n\nPiperOrigin-RevId: 802592283",
    "sha": "c2ae26d438222ee7659ad48944f8a8ff1cef5f82",
    "files": [
        {
            "sha": "44811dfd299a479dd8ccf12c513eaf98cd8edbb3",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_map.h",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/c2ae26d438222ee7659ad48944f8a8ff1cef5f82/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/c2ae26d438222ee7659ad48944f8a8ff1cef5f82/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h?ref=c2ae26d438222ee7659ad48944f8a8ff1cef5f82",
            "patch": "@@ -40,6 +40,12 @@ class SymbolicMap {\n   SymbolicExprContext* GetContext() const { return ctx_; }\n   int64_t GetNumDims() const { return num_dimensions_; }\n   int64_t GetNumSymbols() const { return num_symbols_; }\n+  SymbolicExpr GetDimExpression(unsigned idx) const {\n+    return ctx_->CreateVariable(idx);\n+  }\n+  SymbolicExpr GetSymbolExpression(unsigned idx) const {\n+    return ctx_->CreateVariable(num_dimensions_ + idx);\n+  }\n   int64_t GetNumResults() const { return exprs_.size(); }\n   const llvm::SmallVector<SymbolicExpr>& GetResults() const { return exprs_; }\n   SymbolicExpr GetResult(unsigned idx) const { return exprs_[idx]; }"
        },
        {
            "sha": "2d8df62429469f3cac0258f617b3426c1d2d63a9",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_map_test.cc",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/c2ae26d438222ee7659ad48944f8a8ff1cef5f82/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/c2ae26d438222ee7659ad48944f8a8ff1cef5f82/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map_test.cc?ref=c2ae26d438222ee7659ad48944f8a8ff1cef5f82",
            "patch": "@@ -26,6 +26,19 @@ namespace {\n \n using ::testing::ElementsAre;\n \n+TEST(SymbolicMapTest, GetSymbolAndDimExpressions) {\n+  SymbolicExprContext ctx;\n+  SymbolicExpr d0 = ctx.CreateVariable(0);\n+  SymbolicExpr d1 = ctx.CreateVariable(1);\n+  SymbolicExpr s0 = ctx.CreateVariable(2);\n+  SymbolicExpr s1 = ctx.CreateVariable(3);\n+  SymbolicMap map = SymbolicMap::Get(&ctx, 2, 2, {d0 + s0, d1 * s1});\n+  EXPECT_EQ(map.GetSymbolExpression(0), s0);\n+  EXPECT_EQ(map.GetSymbolExpression(1), s1);\n+  EXPECT_EQ(map.GetDimExpression(0), d0);\n+  EXPECT_EQ(map.GetDimExpression(1), d1);\n+}\n+\n TEST(SymbolicMapTest, ToString) {\n   SymbolicExprContext ctx;\n   SymbolicExpr d0 = ctx.CreateVariable(0);"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 19,
        "deletions": 0
    }
}