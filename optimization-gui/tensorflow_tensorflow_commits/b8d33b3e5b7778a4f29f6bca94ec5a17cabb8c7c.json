{
    "author": "tensorflower-gardener",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 849601638",
    "sha": "b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c",
    "files": [
        {
            "sha": "a9db2449db33291a3dae65a445ddf7f665ae0f51",
            "filename": "tensorflow/core/tpu/kernels/tpu_compilation_cache_entry_unloader.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_compilation_cache_entry_unloader.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_compilation_cache_entry_unloader.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_compilation_cache_entry_unloader.h?ref=b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c",
            "patch": "@@ -40,7 +40,7 @@ class TpuCompilationCacheEntryUnloader : public ResourceBase {\n   }\n \n   ~TpuCompilationCacheEntryUnloader() override {\n-    absl::MutexLock lock(&mu_);\n+    absl::MutexLock lock(mu_);\n     for (int64_t uid : cache_entry_uids_) {\n       absl::Status s = cache_->MarkEntryForEviction(uid);\n       if (!s.ok()) {\n@@ -55,7 +55,7 @@ class TpuCompilationCacheEntryUnloader : public ResourceBase {\n \n   // Add cache entry uid to be unloaded in destructor.\n   void AddCacheEntryUid(int64_t uid) {\n-    absl::MutexLock lock(&mu_);\n+    absl::MutexLock lock(mu_);\n     cache_entry_uids_.insert(uid);\n   }\n "
        },
        {
            "sha": "448672840d8f13221933f0bfcdfcfbf8d5c902de",
            "filename": "tensorflow/core/tpu/kernels/tpu_compilation_cache_interface.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_compilation_cache_interface.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_compilation_cache_interface.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_compilation_cache_interface.cc?ref=b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c",
            "patch": "@@ -153,7 +153,7 @@ absl::Status TpuCompilationCacheInterface::MarkEntryForEviction(\n       /*level=*/2);\n   CompiledSubgraph* deleted_entry = nullptr;\n   {\n-    absl::MutexLock lock(&mu_);\n+    absl::MutexLock lock(mu_);\n     auto iter = entries_by_uid_.find(subgraph_uid);\n     if (iter == entries_by_uid_.end()) {\n       // If already evicted, return ok.\n@@ -201,7 +201,7 @@ absl::Status TpuCompilationCacheInterface::Release(int64_t subgraph_uid) {\n \n   CompiledSubgraph* deleted_entry = nullptr;\n   {\n-    absl::MutexLock lock(&mu_);\n+    absl::MutexLock lock(mu_);\n     auto iter = entries_by_uid_.find(subgraph_uid);\n \n     if (iter == entries_by_uid_.end()) {\n@@ -291,7 +291,7 @@ void TpuCompilationCacheInterface::DiscardEntryRefs(\n     absl::Span<CompiledSubgraph* const> entries) {\n   std::vector<CompiledSubgraph*> removed_entries;\n   {\n-    absl::MutexLock lock(&mu_);\n+    absl::MutexLock lock(mu_);\n \n     for (auto entry : entries) {\n       removed_entries.push_back(DiscardEntryRef(entry));\n@@ -424,7 +424,7 @@ absl::Status TpuCompilationCacheInterface::CompileIfKeyAbsentHelper(\n \n   // NOTE: In spite of the fact that we use MutexLock, we do not hold the lock\n   // for the lifetime of the object, see InitializeEntry() call below.\n-  absl::MutexLock lock(&mu_);\n+  absl::MutexLock lock(mu_);\n \n   std::string cache_key = FindCacheKey(subgraph_key);\n   auto iter = cache_.find(cache_key);\n@@ -556,7 +556,7 @@ absl::Status TpuCompilationCacheInterface::GetKeysFromUid(\n     int64_t uid, std::vector<std::string>* keys) {\n   keys->clear();\n \n-  absl::MutexLock lock(&mu_);\n+  absl::MutexLock lock(mu_);\n   const auto iter = entries_by_uid_.find(uid);\n   if (iter == entries_by_uid_.end()) {\n     return errors::NotFound(\"No subgraph found for uid \", uid);\n@@ -574,7 +574,7 @@ absl::Status TpuCompilationCacheInterface::Lookup(\n       \"TPU compilation cache proto lookup by uid\",\n       /*level=*/2);\n \n-  absl::MutexLock lock(&mu_);\n+  absl::MutexLock lock(mu_);\n   const auto iter = entries_by_uid_.find(uid);\n   if (iter == entries_by_uid_.end()) {\n     return errors::NotFound(\"No subgraph found for uid \", uid);\n@@ -599,7 +599,7 @@ absl::Status TpuCompilationCacheInterface::Lookup(\n       \"TPU compilation cache proto lookup\",\n       /*level=*/2);\n \n-  absl::MutexLock lock(&mu_);\n+  absl::MutexLock lock(mu_);\n   const auto iter = entries_by_proto_key_.find(proto_key);\n   if (iter == entries_by_proto_key_.end()) {\n     return errors::NotFound(\"No proto found for key \", proto_key);"
        },
        {
            "sha": "f93699c40b323cdc3b24a59cc4b466c2f56ed7a4",
            "filename": "tensorflow/core/tpu/kernels/tpu_compilation_cache_rpc_lookup.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_compilation_cache_rpc_lookup.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_compilation_cache_rpc_lookup.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_compilation_cache_rpc_lookup.cc?ref=b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c",
            "patch": "@@ -81,7 +81,7 @@ absl::Status TpuCompilationCacheRpcLookup::Lookup(\n       proto_key, \"_\", tpu::CompilationCacheFetchTarget_Name(fetch_target));\n \n   {\n-    absl::MutexLock lock(&mu_);\n+    absl::MutexLock lock(mu_);\n     auto iter = cache_.find(local_proto_key);\n     if (iter == cache_.end()) {\n       tpu::GetTpuProgramRequest request;\n@@ -123,7 +123,7 @@ absl::Status TpuCompilationCacheRpcLookup::Lookup(\n       absl::StrCat(\" _ \", uid, \":\", proto_index, \"_\",\n                    tpu::CompilationCacheFetchTarget_Name(fetch_target));\n   {\n-    absl::MutexLock lock(&mu_);\n+    absl::MutexLock lock(mu_);\n     auto iter = cache_.find(local_proto_key);\n     if (iter == cache_.end()) {\n       tpu::GetTpuProgramRequest request;"
        },
        {
            "sha": "a518c9e47cc4543378645428a77a5992c315bb25",
            "filename": "tensorflow/core/tpu/kernels/tpu_fingerprint_lookup.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_fingerprint_lookup.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_fingerprint_lookup.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_fingerprint_lookup.cc?ref=b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c",
            "patch": "@@ -26,7 +26,7 @@ TpuFingerprintLookup* TpuFingerprintLookup::Create() {\n \n void TpuFingerprintLookup::RegisterKeyAndIntermediatePair(uint64 key,\n                                                           uint64 intermediate) {\n-  absl::MutexLock lock(&mu_);\n+  absl::MutexLock lock(mu_);\n   auto [it, emplaced] = intermediate_to_key_.try_emplace(intermediate, key);\n   if (it->second != key) {\n     VLOG(2) << \"The key (\" << it->second\n@@ -37,7 +37,7 @@ void TpuFingerprintLookup::RegisterKeyAndIntermediatePair(uint64 key,\n \n bool TpuFingerprintLookup::RegisterIntermediateAndValuePair(uint64 intermediate,\n                                                             std::string value) {\n-  absl::MutexLock lock(&mu_);\n+  absl::MutexLock lock(mu_);\n   auto it = intermediate_to_key_.find(intermediate);\n   if (it == intermediate_to_key_.end()) {\n     VLOG(2) << \"Cannot find the intermediate ( \" << intermediate\n@@ -83,7 +83,7 @@ bool TpuFingerprintLookup::RegisterIntermediateAndValuePair(uint64 intermediate,\n }\n \n std::optional<absl::string_view> TpuFingerprintLookup::Lookup(uint64 key) {\n-  absl::MutexLock lock(&mu_);\n+  absl::MutexLock lock(mu_);\n   auto it = key_to_value_.find(key);\n   if (it == key_to_value_.end()) {\n     return std::optional<absl::string_view>{};"
        },
        {
            "sha": "b84d188afadda69b939403f370a955e336357745",
            "filename": "tensorflow/core/tpu/kernels/tpu_fingerprint_lookup.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_fingerprint_lookup.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_fingerprint_lookup.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_fingerprint_lookup.h?ref=b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c",
            "patch": "@@ -68,7 +68,7 @@ class TpuFingerprintLookup : public ResourceBase {\n   std::optional<absl::string_view> Lookup(uint64 key);\n \n   size_t num_valid() {\n-    absl::MutexLock lock(&mu_);\n+    absl::MutexLock lock(mu_);\n     return key_to_value_.size();\n   }\n "
        },
        {
            "sha": "802020af1f345143f17213546220bcd74ca131c0",
            "filename": "tensorflow/core/tpu/kernels/tpu_functional_ops.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_functional_ops.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_functional_ops.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftpu%2Fkernels%2Ftpu_functional_ops.cc?ref=b8d33b3e5b7778a4f29f6bca94ec5a17cabb8c7c",
            "patch": "@@ -1263,7 +1263,7 @@ void TPUPartitionedCallOp::ComputeAsync(OpKernelContext* ctx,\n     bool enable_spmd_xla_partitioning = false;\n     TPUMetadata tpu_metadata;\n     {\n-      absl::MutexLock l(&mu_);\n+      absl::MutexLock l(mu_);\n       // We are not using OP_REQUIRES_OK_ASYNC here as we are inside the\n       // call_once. It will be checked later whether `ordinal_selector_` is\n       // initialized.\n@@ -1301,7 +1301,7 @@ void TPUPartitionedCallOp::ComputeAsync(OpKernelContext* ctx,\n                         &device_ordinal),\n       done);\n   uint64_t cache_hash = Hash64Combine(input_hash, device_ordinal);\n-  absl::ReleasableMutexLock lock(&mu_);\n+  absl::ReleasableMutexLock lock(mu_);\n \n   const std::vector<DeviceAndFHandle>* functions;\n "
        }
    ],
    "stats": {
        "total": 34,
        "additions": 17,
        "deletions": 17
    }
}