{
    "author": "tensorflower-gardener",
    "message": "Add opt-barrier to hlo evaluator to handle as just forwarding the operand\n\nPiperOrigin-RevId: 805954442",
    "sha": "abb3a189e874e1845a9b5f8bcebb13bb207a3ed7",
    "files": [
        {
            "sha": "1f8a13e9b2c254fefbec3469e4b38f003a6af886",
            "filename": "third_party/xla/xla/hlo/evaluator/hlo_evaluator.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/abb3a189e874e1845a9b5f8bcebb13bb207a3ed7/third_party%2Fxla%2Fxla%2Fhlo%2Fevaluator%2Fhlo_evaluator.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/abb3a189e874e1845a9b5f8bcebb13bb207a3ed7/third_party%2Fxla%2Fxla%2Fhlo%2Fevaluator%2Fhlo_evaluator.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fevaluator%2Fhlo_evaluator.cc?ref=abb3a189e874e1845a9b5f8bcebb13bb207a3ed7",
            "patch": "@@ -3284,6 +3284,14 @@ absl::Status HloEvaluator::HandleAddDependency(\n   return absl::OkStatus();\n }\n \n+absl::Status HloEvaluator::HandleOptimizationBarrier(\n+    const HloInstruction* optimization_barrier) {\n+  SetEvaluatedLiteralFor(\n+      optimization_barrier,\n+      GetEvaluatedLiteralFor(optimization_barrier->operand(0)).Clone());\n+  return absl::OkStatus();\n+}\n+\n absl::Status HloEvaluator::HandleGetTupleElement(\n     const HloInstruction* get_tuple_element) {\n   const auto result_shape = get_tuple_element->shape();"
        },
        {
            "sha": "3d5bec17dcde39ce2065c110a1b4a9bec172b287",
            "filename": "third_party/xla/xla/hlo/evaluator/hlo_evaluator.h",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/abb3a189e874e1845a9b5f8bcebb13bb207a3ed7/third_party%2Fxla%2Fxla%2Fhlo%2Fevaluator%2Fhlo_evaluator.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/abb3a189e874e1845a9b5f8bcebb13bb207a3ed7/third_party%2Fxla%2Fxla%2Fhlo%2Fevaluator%2Fhlo_evaluator.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fevaluator%2Fhlo_evaluator.h?ref=abb3a189e874e1845a9b5f8bcebb13bb207a3ed7",
            "patch": "@@ -370,6 +370,8 @@ class HloEvaluator : public ConstDfsHloVisitorWithDefault,\n   absl::Status HandleReduceWindow(const HloInstruction* hlo) override;\n   absl::Status HandleMap(const HloInstruction* map) override;\n   absl::Status HandleCustomCall(const HloInstruction* custom_call) override;\n+  absl::Status HandleOptimizationBarrier(\n+      const HloInstruction* optimization_barrier) override;\n \n   // Unsupported HLOs, note some of them (such as BatchNorm*) are typically\n   // expanded in a semantic-preserving way into other HLOs by adding expansion"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 10,
        "deletions": 0
    }
}