{
    "author": "hsharsha",
    "message": "PR #32678: [ROCm] Use working sha256 for latest ROCm 7.0 docker image and fix test scripts\n\nImported from GitHub PR https://github.com/openxla/xla/pull/32678\n\nüìù Summary of Changes\n- Fix sha256 of docker image to ensure CI is not broken due to malformed image\n- Fix test scripts by passing ROCM_PATH to bazel sandbox via repo_env\n\nüéØ Justification\nContinued CI runs\n\nüöÄ Kind of Contribution\n üß™ Tests\n\nCopybara import of the project:\n\n--\n3ca8114613d8e002c137f28bb6608639d08a724a by Harsha Havanur Shamsundara <harsha.havanurshamsundara@amd.com>:\n\n[ROCm] Use working sha256 for latest ROCm 7.0 docker image\n\n--\n09ddfbdf205a6406cdd67e20671f41455fffe0f9 by Harsha HS <Harsha.HavanurShamsundara@amd.com>:\n\n[ROCm] Add ROCM_PATH repo_env to test scripts\n\nMerging this change closes #32678\n\nPiperOrigin-RevId: 820582560",
    "sha": "086937e138ded50b332efa10f9a235abdb700c37",
    "files": [
        {
            "sha": "5c05c005498f4d3c36abeae2fb9e44eb0d5d76f2",
            "filename": "third_party/xla/build_tools/rocm/platform/linux_x64/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/086937e138ded50b332efa10f9a235abdb700c37/third_party%2Fxla%2Fbuild_tools%2Frocm%2Fplatform%2Flinux_x64%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/086937e138ded50b332efa10f9a235abdb700c37/third_party%2Fxla%2Fbuild_tools%2Frocm%2Fplatform%2Flinux_x64%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Frocm%2Fplatform%2Flinux_x64%2FBUILD?ref=086937e138ded50b332efa10f9a235abdb700c37",
            "patch": "@@ -26,7 +26,8 @@ platform(\n         \"@bazel_tools//tools/cpp:clang\",\n     ],\n     exec_properties = {\n-        \"container-image\": \"docker://rocm/tensorflow-build:latest-jammy-python3.10-rocm6.4.0@sha256:9c2fbc861570735fc86dbf39dd3cefef6a13fcf6ae08358271af52f1aebd4248\",\n+        # SHA256 for rocm/tensorflow-build:latest-jammy-python3.10-rocm7.0.0\n+        \"container-image\": \"docker://rocm/tensorflow-build@sha256:7cd444ac48657fee2f5087fbda7766266704d3f8fb2299f681952ae4eabed060\",\n         \"OSFamily\": \"Linux\",\n     },\n )"
        },
        {
            "sha": "c7645757b19a5b4f0948a0fd457207516f627e1e",
            "filename": "third_party/xla/build_tools/rocm/run_xla.sh",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/086937e138ded50b332efa10f9a235abdb700c37/third_party%2Fxla%2Fbuild_tools%2Frocm%2Frun_xla.sh",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/086937e138ded50b332efa10f9a235abdb700c37/third_party%2Fxla%2Fbuild_tools%2Frocm%2Frun_xla.sh",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Frocm%2Frun_xla.sh?ref=086937e138ded50b332efa10f9a235abdb700c37",
            "patch": "@@ -72,5 +72,6 @@ bazel \\\n     --action_env=TF_ROCM_AMDGPU_TARGETS=${AMD_GPU_GFX_ID} \\\n     --action_env=XLA_FLAGS=--xla_gpu_force_compilation_parallelism=16 \\\n     --action_env=XLA_FLAGS=--xla_gpu_enable_llvm_module_compilation_parallelism=true \\\n+    --repo_env=\"ROCM_PATH=$ROCM_PATH\" \\\n     --run_under=//build_tools/ci:parallel_gpu_execute \\\n     -- //xla/..."
        },
        {
            "sha": "14724e2fe44d706e2bb10abf935b726b742df1d4",
            "filename": "third_party/xla/build_tools/rocm/run_xla_multi_gpu.sh",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/086937e138ded50b332efa10f9a235abdb700c37/third_party%2Fxla%2Fbuild_tools%2Frocm%2Frun_xla_multi_gpu.sh",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/086937e138ded50b332efa10f9a235abdb700c37/third_party%2Fxla%2Fbuild_tools%2Frocm%2Frun_xla_multi_gpu.sh",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fbuild_tools%2Frocm%2Frun_xla_multi_gpu.sh?ref=086937e138ded50b332efa10f9a235abdb700c37",
            "patch": "@@ -90,6 +90,7 @@ bazel \\\n     --action_env=XLA_FLAGS=--xla_gpu_force_compilation_parallelism=16 \\\n     --action_env=XLA_FLAGS=--xla_gpu_enable_llvm_module_compilation_parallelism=true \\\n     --action_env=NCCL_MAX_NCHANNELS=1 \\\n+    --repo_env=\"ROCM_PATH=$ROCM_PATH\" \\\n     -- //xla/tests:collective_ops_e2e_test \\\n        //xla/tests:collective_ops_test \\\n        //xla/tests:collective_pipeline_parallelism_test \\"
        }
    ],
    "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
    }
}