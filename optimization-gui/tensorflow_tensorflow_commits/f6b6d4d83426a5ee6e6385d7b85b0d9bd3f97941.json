{
    "author": "loislo",
    "message": "[XLA:GPU] Fix usages of deprecated tsl::errors::InvalidArgument in xla\n\nThis change replaces usages of tsl::errors::InvalidArgument with absl::InvalidArgumentError,\nwrapping arguments in absl::StrCat where necessary. This addresses deprecation\nwarnings and moves towards standard Abseil error handling.\n\nThe deprecated tsl::errors::InvalidArgument function was identified in third_party/tensorflow/compiler/xla/tsl/platform/errors.h.\n\nChanges:\n- Replaced errors::InvalidArgument with absl::InvalidArgumentError.\n- Used absl::StrCat to construct error messages where necessary.\n- Fixed missing dependencies in BUILD files using build_cleaner.\nPiperOrigin-RevId: 837013893",
    "sha": "f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
    "files": [
        {
            "sha": "c80b73e92a27a25055cffec7b961f18788135fcc",
            "filename": "third_party/xla/xla/backends/interpreter/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fbackends%2Finterpreter%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fbackends%2Finterpreter%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Finterpreter%2FBUILD?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -33,7 +33,6 @@ cc_library(\n         \"//xla:util\",\n         \"//xla/hlo/evaluator:hlo_evaluator\",\n         \"//xla/hlo/ir:hlo\",\n-        \"//xla/hlo/ir:hlo_module_group\",\n         \"//xla/hlo/pass:hlo_pass_pipeline\",\n         \"//xla/hlo/transforms/expanders:cholesky_expander\",\n         \"//xla/hlo/transforms/expanders:dynamic_index_splitter\",\n@@ -52,13 +51,13 @@ cc_library(\n         \"//xla/service:triangular_solve_expander\",\n         \"//xla/stream_executor:platform\",\n         \"//xla/stream_executor:stream_executor_h\",\n+        \"//xla/tsl/platform:errors\",\n+        \"//xla/tsl/platform:statusor\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/types:span\",\n-        \"@local_tsl//tsl/platform:errors\",\n         \"@local_tsl//tsl/platform:status\",\n-        \"@local_tsl//tsl/platform:statusor\",\n     ],\n     alwayslink = True,  # Contains compiler registration\n )"
        },
        {
            "sha": "12126740762af99a1f25f06cd07e6c270a0b249f",
            "filename": "third_party/xla/xla/backends/interpreter/compiler.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fbackends%2Finterpreter%2Fcompiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fbackends%2Finterpreter%2Fcompiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Finterpreter%2Fcompiler.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -48,9 +48,9 @@ limitations under the License.\n #include \"xla/status_macros.h\"\n #include \"xla/stream_executor/platform.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n+#include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n #include \"xla/util.h\"\n-#include \"tsl/platform/errors.h\"\n-#include \"tsl/platform/statusor.h\"\n \n namespace xla {\n namespace interpreter {\n@@ -162,7 +162,7 @@ absl::StatusOr<std::vector<std::unique_ptr<AotCompilationResult>>>\n InterpreterCompiler::CompileAheadOfTime(\n     std::unique_ptr<HloModule> hlo_module,\n     const AotCompilationOptions& aot_options) {\n-  return tsl::errors::InvalidArgument(\n+  return absl::InvalidArgumentError(\n       \"AOT compilation not supported on Interpreter\");\n }\n "
        },
        {
            "sha": "7f35288f4a7696acf20aadaee4501f985cb136c5",
            "filename": "third_party/xla/xla/hlo/builder/lib/BUILD",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fhlo%2Fbuilder%2Flib%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fhlo%2Fbuilder%2Flib%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fbuilder%2Flib%2FBUILD?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -330,9 +330,12 @@ cc_library(\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/hlo/builder:padding\",\n         \"//xla/hlo/builder:xla_builder\",\n+        \"//xla/tsl/platform:statusor\",\n         \"@com_google_absl//absl/container:inlined_vector\",\n         \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n+        \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/types:span\",\n         \"@local_tsl//tsl/platform:errors\",\n         \"@local_tsl//tsl/platform:statusor\","
        },
        {
            "sha": "a48c74ee459b73a4941b7be01377b22c6e170d77",
            "filename": "third_party/xla/xla/hlo/builder/lib/pooling.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fhlo%2Fbuilder%2Flib%2Fpooling.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fhlo%2Fbuilder%2Flib%2Fpooling.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fbuilder%2Flib%2Fpooling.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -21,14 +21,17 @@ limitations under the License.\n #include <vector>\n \n #include \"absl/log/check.h\"\n+#include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n+#include \"absl/strings/str_cat.h\"\n #include \"absl/types/span.h\"\n #include \"xla/hlo/builder/lib/arithmetic.h\"\n #include \"xla/hlo/builder/lib/constants.h\"\n #include \"xla/hlo/builder/lib/conv_grad_size_util.h\"\n #include \"xla/hlo/builder/padding.h\"\n #include \"xla/hlo/builder/xla_builder.h\"\n #include \"xla/shape.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n #include \"xla/util.h\"\n #include \"xla/xla_data.pb.h\"\n #include \"tsl/platform/errors.h\"\n@@ -217,17 +220,17 @@ XlaOp AvgPoolGrad(XlaOp out_backprop, absl::Span<const int64_t> gradients_size,\n     const int num_dims = kernel_size.size();\n     const int num_gradients = gradients_size.size();\n     if (num_gradients != num_dims) {\n-      return tsl::errors::InvalidArgument(\"gradients must be \", num_dims,\n-                                          \"-dimensional\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(\"gradients must be \", num_dims, \"-dimensional\"));\n     }\n \n     TF_ASSIGN_OR_RETURN(Shape out_backprop_xla_shape,\n                         b->GetShape(out_backprop));\n     const int backprop_xla_num_dims =\n         out_backprop_xla_shape.dimensions().size();\n     if (backprop_xla_num_dims != num_dims) {\n-      return tsl::errors::InvalidArgument(\"out_backprop must be \", num_dims,\n-                                          \"-dimensional\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(\"out_backprop must be \", num_dims, \"-dimensional\"));\n     }\n \n     // We can think of average-pooling as:"
        },
        {
            "sha": "97c728901b6c07bd436a742ce6f0d1f33c98a2e8",
            "filename": "third_party/xla/xla/hlo/translate/hlo_to_mhlo/async_importer.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fhlo%2Ftranslate%2Fhlo_to_mhlo%2Fasync_importer.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fhlo%2Ftranslate%2Fhlo_to_mhlo%2Fasync_importer.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Ftranslate%2Fhlo_to_mhlo%2Fasync_importer.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -77,12 +77,12 @@ absl::StatusOr<mlir::Operation*> ImportOldStyleAsyncStart(\n     std::function<absl::Status(sync_op)> mutate_op) {\n   auto context = builder->getContext();\n   if (!llvm::isa<mlir::TupleType>(result_type)) {\n-    return tsl::errors::InvalidArgument(\n+    return absl::InvalidArgumentError(\n         \"expected async_bundle tuple result type\");\n   }\n   auto result_types = mlir::cast<mlir::TupleType>(result_type).getTypes();\n   if (result_types.size() < 2) {\n-    return tsl::errors::InvalidArgument(\n+    return absl::InvalidArgumentError(\n         \"async_bundle must contain at least two values\");\n   }\n   auto func_type = mlir::FunctionType::get(context, Untuple(result_types[0]),"
        },
        {
            "sha": "9f072392bffaddfb955bf09d46898d8e8afcc9d7",
            "filename": "third_party/xla/xla/pjrt/c/pjrt_c_api_helpers.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_helpers.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_helpers.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_helpers.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -523,8 +523,8 @@ static absl::StatusOr<PJRT_NamedValue> ConvertToPjRtNamedValue(\n     c_value.bool_value = std::get<bool>(value);\n     c_value.value_size = 1;\n   } else {\n-    return tsl::errors::InvalidArgument(\"Unexpected PjRtValueType: '\",\n-                                        value.index(), \" with name: \", name);\n+    return absl::InvalidArgumentError(absl::StrCat(\n+        \"Unexpected PjRtValueType: '\", value.index(), \" with name: \", name));\n   }\n \n   return c_value;\n@@ -601,8 +601,8 @@ static absl::StatusOr<PJRT_NamedValue_Type> GetPjrtNamedValueType(\n   if (std::holds_alternative<bool>(cpp_value)) {\n     return PJRT_NamedValue_Type::PJRT_NamedValue_kBool;\n   }\n-  return tsl::errors::InvalidArgument(\"Unexpected PjRtValueType with index\",\n-                                      cpp_value.index());\n+  return absl::InvalidArgumentError(\n+      absl::StrCat(\"Unexpected PjRtValueType with index\", cpp_value.index()));\n }\n \n absl::Status ValidateCreateOptions(\n@@ -612,16 +612,16 @@ absl::Status ValidateCreateOptions(\n   for (const auto& [name, value] : value_map) {\n     auto it = expected_name_and_types.find(name);\n     if (it == expected_name_and_types.end()) {\n-      return tsl::errors::InvalidArgument(\n-          \"Unexpected option name passed to PJRT_Client_Create: \", name);\n+      return absl::InvalidArgumentError(absl::StrCat(\n+          \"Unexpected option name passed to PJRT_Client_Create: \", name));\n     }\n     TF_ASSIGN_OR_RETURN(PJRT_NamedValue_Type type,\n                         GetPjrtNamedValueType(value));\n     if (type != it->second) {\n-      return tsl::errors::InvalidArgument(\n-          \"Option passed to PJRT_Client_Create with name \", name,\n-          \" has type index \", value.index(), \" but expected type index is \",\n-          it->second);\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(\"Option passed to PJRT_Client_Create with name \", name,\n+                       \" has type index \", value.index(),\n+                       \" but expected type index is \", it->second));\n     }\n   }\n   return absl::OkStatus();\n@@ -686,7 +686,7 @@ absl::Status ActualStructSizeIsGreaterOrEqual(absl::string_view struct_name,\n                                               size_t expected_size,\n                                               size_t actual_size) {\n   if (actual_size < expected_size) {\n-    return tsl::errors::InvalidArgument(\n+    return absl::InvalidArgumentError(\n         StructSizeErrorMsg(struct_name, expected_size, actual_size));\n   }\n   if (actual_size > expected_size) {"
        },
        {
            "sha": "a789991ce722f22156561c9a7db15461eb2d00ea",
            "filename": "third_party/xla/xla/pjrt/c/pjrt_c_api_wrapper_impl.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_wrapper_impl.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_wrapper_impl.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_wrapper_impl.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -834,7 +834,7 @@ absl::StatusOr<xla::CompileOptions> ParseCompileOptions(\n   xla::CompileOptionsProto options_proto;\n   // Open source ParseFromString doesn't support string_view.\n   if (!options_proto.ParseFromString(options_str)) {\n-    return tsl::errors::InvalidArgument(\n+    return absl::InvalidArgumentError(\n         \"PJRT_Client_Compile: failed to deserialize CompileOptionsProto\");\n   }\n   return xla::CompileOptions::FromProto(options_proto);\n@@ -861,12 +861,12 @@ ParsePjrtProgram(std::optional<mlir::MLIRContext>& context,\n     xla::HloModuleProto module_proto;\n     // Open source ParseFromString doesn't support string_view.\n     if (!module_proto.ParseFromString(module_str)) {\n-      return tsl::errors::InvalidArgument(\n+      return absl::InvalidArgumentError(\n           \"PJRT_Client_Compile: failed to deserialize HloModuleProto\");\n     }\n     return ProgramVariant(xla::XlaComputation(module_proto));\n   } else {\n-    return tsl::errors::InvalidArgument(ProgramFormatErrorMsg(format_str));\n+    return absl::InvalidArgumentError(ProgramFormatErrorMsg(format_str));\n   }\n }\n "
        },
        {
            "sha": "6d25030b2f8a4a106a861c45bb76695e49c3fa54",
            "filename": "third_party/xla/xla/service/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2FBUILD?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -1557,6 +1557,7 @@ cc_library(\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n+        \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/strings:string_view\",\n         \"@com_google_absl//absl/synchronization\",\n         \"@com_google_absl//absl/types:span\","
        },
        {
            "sha": "8227421765dfa0300a7eeaf620272506e05382f6",
            "filename": "third_party/xla/xla/service/compilation_environments.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fservice%2Fcompilation_environments.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fservice%2Fcompilation_environments.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcompilation_environments.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -210,7 +210,7 @@ absl::Status CompilationEnvironments::InitializeAllKnownEnvs() {\n absl::Status CompilationEnvironments::AddEnv(\n     std::unique_ptr<tsl::protobuf::Message> env) {\n   if (!env) {\n-    return tsl::errors::InvalidArgument(\n+    return absl::InvalidArgumentError(\n         \"Can not add a null compilation environment.\");\n   }\n   const tsl::protobuf::Descriptor& descriptor = *env->GetDescriptor();"
        },
        {
            "sha": "7fe3ed7fab8444e20b10b2814a2c4f7c9d3247bc",
            "filename": "third_party/xla/xla/service/executable.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fservice%2Fexecutable.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Fservice%2Fexecutable.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fexecutable.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -25,6 +25,7 @@ limitations under the License.\n #include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n+#include \"absl/strings/str_cat.h\"\n #include \"absl/types/span.h\"\n #include \"xla/service/maybe_owning_device_memory.h\"\n #include \"xla/service/service_executable_run_options.h\"\n@@ -60,9 +61,9 @@ ExecutionInput::ExecutionInput(ExecutionInput&& rhs) noexcept\n absl::Status ExecutionInput::SetDynamicShape(Shape dynamic_shape) {\n   const Shape& input_shape = shape();\n   if (!ShapeUtil::DynamicShapeIsCompatible(input_shape, dynamic_shape)) {\n-    return tsl::errors::InvalidArgument(\n-        \"Cannot set dynamic shape: \", input_shape.ToString(), \" vs. \",\n-        dynamic_shape.ToString());\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"Cannot set dynamic shape: \", input_shape.ToString(),\n+                     \" vs. \", dynamic_shape.ToString()));\n   }\n   dynamic_shape_ = std::make_unique<Shape>(std::move(dynamic_shape));\n   return absl::OkStatus();"
        },
        {
            "sha": "2d8438e0d0445127c65bfccb993eaf9d55585732",
            "filename": "third_party/xla/xla/tools/BUILD",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftools%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftools%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftools%2FBUILD?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -1086,7 +1086,9 @@ xla_test(\n         \"@local_tsl//tsl/platform:status_matchers\",\n         \"@local_tsl//tsl/platform:statusor\",\n         \"@local_tsl//tsl/platform:test\",\n-    ] + if_google([\"@com_google_protobuf//:duration_cc_proto\"]),\n+    ] + if_google([\"@com_google_protobuf//:duration_cc_proto\"]) + if_cuda([\n+        \"//xla/tsl/cuda:nvml\",\n+    ]),\n )\n \n xla_test("
        },
        {
            "sha": "45dcc6b2beea920981d16eb4319f1d43386ffae1",
            "filename": "third_party/xla/xla/tools/multihost_hlo_runner/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftools%2Fmultihost_hlo_runner%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftools%2Fmultihost_hlo_runner%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftools%2Fmultihost_hlo_runner%2FBUILD?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -282,7 +282,7 @@ xla_test(\n         \"@com_google_googletest//:gtest\",\n         \"@local_tsl//tsl/platform:path\",\n         \"@local_tsl//tsl/platform:protobuf\",\n-    ],\n+    ] + if_cuda([\"//xla/tsl/cuda:nvml\"]),\n )\n \n tsl_pybind_extension("
        },
        {
            "sha": "57b26d87659273214d1ecb4a783f70f8f4388a83",
            "filename": "third_party/xla/xla/tsl/lib/io/BUILD",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2FBUILD?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -92,7 +92,9 @@ cc_library(\n         \"//xla/tsl/platform:types\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/strings:string_view\",\n+        \"@com_google_absl//absl/types:span\",\n         \"@local_tsl//tsl/platform:coding\",\n     ],\n     alwayslink = True,\n@@ -164,8 +166,12 @@ cc_library(\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:macros\",\n         \"//xla/tsl/platform:types\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n         \"@local_tsl//tsl/platform:raw_coding\",\n         \"@local_tsl//tsl/platform:stringpiece\",\n+        \"@local_tsl//tsl/platform:tstring\",\n     ],\n     alwayslink = True,\n )\n@@ -323,6 +329,12 @@ cc_library(\n         \"//xla/tsl/platform:macros\",\n         \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:types\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/strings:cord\",\n+        \"@com_google_absl//absl/strings:string_view\",\n         \"@local_tsl//tsl/platform:stringpiece\",\n         \"@zlib\",\n     ],"
        },
        {
            "sha": "21bf6caa9b09f9d934d85bead2ad2b174928aaad",
            "filename": "third_party/xla/xla/tsl/lib/io/inputbuffer.cc",
            "status": "modified",
            "additions": 16,
            "deletions": 11,
            "changes": 27,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Finputbuffer.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Finputbuffer.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Finputbuffer.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -19,12 +19,17 @@ limitations under the License.\n #include <cstddef>\n #include <cstdint>\n #include <cstring>\n+#include <string>\n \n #include \"absl/log/check.h\"\n #include \"absl/status/status.h\"\n+#include \"absl/strings/str_cat.h\"\n #include \"absl/strings/string_view.h\"\n+#include \"absl/types/span.h\"\n #include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/file_system.h\"\n #include \"xla/tsl/platform/logging.h\"\n+#include \"tsl/platform/coding.h\"\n \n namespace tsl {\n namespace io {\n@@ -89,8 +94,8 @@ absl::Status InputBuffer::ReadNBytes(int64_t bytes_to_read,\n                                      std::string* result) {\n   result->clear();\n   if (bytes_to_read < 0) {\n-    return errors::InvalidArgument(\"Can't read a negative number of bytes: \",\n-                                   bytes_to_read);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"Can't read a negative number of bytes: \", bytes_to_read));\n   }\n   result->resize(bytes_to_read);\n   size_t bytes_read = 0;\n@@ -102,10 +107,10 @@ absl::Status InputBuffer::ReadNBytes(int64_t bytes_to_read,\n absl::Status InputBuffer::ReadNBytes(int64_t bytes_to_read, char* result,\n                                      size_t* bytes_read) {\n   if (bytes_to_read < 0) {\n-    return errors::InvalidArgument(\"Can't read a negative number of bytes: \",\n-                                   bytes_to_read);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"Can't read a negative number of bytes: \", bytes_to_read));\n   }\n-  absl::Status status;\n+  absl::Status status;  // Re-declare status here\n   *bytes_read = 0;\n   while (*bytes_read < static_cast<size_t>(bytes_to_read)) {\n     if (pos_ == limit_) {\n@@ -164,8 +169,8 @@ absl::Status InputBuffer::ReadVarintFallback(T* result, int max_bytes) {\n \n absl::Status InputBuffer::SkipNBytes(int64_t bytes_to_skip) {\n   if (bytes_to_skip < 0) {\n-    return errors::InvalidArgument(\"Can only skip forward, not \",\n-                                   bytes_to_skip);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"Can only skip forward, not \", bytes_to_skip));\n   }\n   int64_t bytes_skipped = 0;\n   absl::Status s;\n@@ -190,8 +195,8 @@ absl::Status InputBuffer::SkipNBytes(int64_t bytes_to_skip) {\n \n absl::Status InputBuffer::Seek(int64_t position) {\n   if (position < 0) {\n-    return errors::InvalidArgument(\"Seeking to a negative position: \",\n-                                   position);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"Seeking to a negative position: \", position));\n   }\n   // Position of the buffer within file.\n   const int64_t bufpos = file_pos_ - static_cast<int64_t>(limit_ - buf());\n@@ -210,8 +215,8 @@ absl::Status InputBuffer::Seek(int64_t position) {\n \n absl::Status InputBuffer::Hint(int64_t bytes_to_read) {\n   if (bytes_to_read < 0) {\n-    return errors::InvalidArgument(\"Can't read a negative number of bytes: \",\n-                                   bytes_to_read);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"Can't read a negative number of bytes: \", bytes_to_read));\n   }\n \n   // The internal buffer is too small. Do nothing."
        },
        {
            "sha": "c1a4619bce86c9383f3202888a0642976b6fa506",
            "filename": "third_party/xla/xla/tsl/lib/io/record_reader.cc",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Frecord_reader.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Frecord_reader.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Frecord_reader.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -17,13 +17,24 @@ limitations under the License.\n \n #include <limits.h>\n \n+#include <cstddef>\n+#include <cstdint>\n+#include <string>\n+\n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/status.h\"\n #include \"xla/tsl/lib/hash/crc32c.h\"\n #include \"xla/tsl/lib/io/buffered_inputstream.h\"\n #include \"xla/tsl/lib/io/compression.h\"\n #include \"xla/tsl/lib/io/random_inputstream.h\"\n+#include \"xla/tsl/lib/io/snappy/snappy_inputstream.h\"\n+#include \"xla/tsl/lib/io/zlib_compression_options.h\"\n+#include \"xla/tsl/lib/io/zlib_inputstream.h\"\n #include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n #include \"tsl/platform/raw_coding.h\"\n+#include \"tsl/platform/tstring.h\"\n \n namespace tsl {\n namespace io {\n@@ -131,7 +142,7 @@ absl::Status RecordReader::ReadChecksummed(uint64_t offset, size_t n,\n \n absl::Status RecordReader::GetMetadata(Metadata* md) {\n   if (!md) {\n-    return errors::InvalidArgument(\n+    return absl::InvalidArgumentError(\n         \"Metadata object call to GetMetadata() was null\");\n   }\n "
        },
        {
            "sha": "9d6ac85447dc4d2d6d610d750e270069da6bbdf1",
            "filename": "third_party/xla/xla/tsl/lib/io/record_reader.h",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Frecord_reader.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Frecord_reader.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Frecord_reader.h?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -162,9 +162,9 @@ class SequentialRecordReader {\n   // offset. Trying to seek backward will throw error.\n   absl::Status SeekOffset(uint64_t offset) {\n     if (offset < offset_)\n-      return errors::InvalidArgument(\n-          \"Trying to seek offset: \", offset,\n-          \" which is less than the current offset: \", offset_);\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(\"Trying to seek offset: \", offset,\n+                       \" which is less than the current offset: \", offset_));\n     offset_ = offset;\n     return absl::OkStatus();\n   }"
        },
        {
            "sha": "f3db1612c93ca01fc97abdfa3f5e3dadc8122d89",
            "filename": "third_party/xla/xla/tsl/lib/io/zlib_outputbuffer.cc",
            "status": "modified",
            "additions": 17,
            "deletions": 4,
            "changes": 21,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Fzlib_outputbuffer.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Fzlib_outputbuffer.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Fzlib_outputbuffer.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -15,7 +15,20 @@ limitations under the License.\n \n #include \"xla/tsl/lib/io/zlib_outputbuffer.h\"\n \n+#include <cstddef>\n+#include <cstdint>\n+#include <cstring>\n+#include <string>\n+\n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/status.h\"\n+#include \"absl/strings/cord.h\"\n+#include \"absl/strings/str_cat.h\"\n+#include \"absl/strings/string_view.h\"\n+#include \"xla/tsl/lib/io/zlib_compression_options.h\"\n #include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/file_system.h\"\n \n namespace tsl {\n namespace io {\n@@ -45,9 +58,8 @@ absl::Status ZlibOutputBuffer::Init() {\n   // Output buffer size should be greater than 1 because deflation needs at\n   // least one byte for book keeping etc.\n   if (output_buffer_capacity_ <= 1) {\n-    return errors::InvalidArgument(\n-        \"output_buffer_bytes should be greater than \"\n-        \"1\");\n+    return absl::InvalidArgumentError(\n+        \"output_buffer_bytes should be greater than 1\");\n   }\n   memset(z_stream_.get(), 0, sizeof(z_stream));\n   z_stream_->zalloc = Z_NULL;\n@@ -59,7 +71,8 @@ absl::Status ZlibOutputBuffer::Init() {\n                    zlib_options_.mem_level, zlib_options_.compression_strategy);\n   if (status != Z_OK) {\n     z_stream_.reset(nullptr);\n-    return errors::InvalidArgument(\"deflateInit failed with status\", status);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"deflateInit failed with status\", status));\n   }\n   z_stream_->next_in = z_stream_input_.get();\n   z_stream_->next_out = z_stream_output_.get();"
        },
        {
            "sha": "9caa6fefc3afcdf814c71b7c635733e2e2941a67",
            "filename": "third_party/xla/xla/tsl/lib/monitoring/cell_reader-inl.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fmonitoring%2Fcell_reader-inl.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fmonitoring%2Fcell_reader-inl.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fmonitoring%2Fcell_reader-inl.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -75,10 +75,10 @@ absl::StatusOr<std::vector<Point>> GetPoints(\n   const std::vector<std::string>& label_names =\n       metric_descriptor->second->label_names;\n   if (label_names.size() != labels.size()) {\n-    return errors::InvalidArgument(\n+    return absl::InvalidArgumentError(absl::StrCat(\n         \"Metric \", metric_name, \" has \", label_names.size(), \" labels: [\",\n         absl::StrJoin(label_names, \", \"), \"]. Got label values [\",\n-        absl::StrJoin(labels, \", \"), \"].\");\n+        absl::StrJoin(labels, \", \"), \"].\"));\n   }\n   auto point_set = metrics.point_set_map.find(metric_name);\n   if (point_set == metrics.point_set_map.end()) {"
        },
        {
            "sha": "821b795f00c9430bc001418d106b044abd5f1210",
            "filename": "third_party/xla/xla/tsl/platform/cloud/curl_http_request.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fcloud%2Fcurl_http_request.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fcloud%2Fcurl_http_request.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fcloud%2Fcurl_http_request.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -256,8 +256,8 @@ absl::Status CurlHttpRequest::SetPutFromFile(const string& body_filepath,\n   }\n   put_body_ = fopen(body_filepath.c_str(), \"r\");\n   if (!put_body_) {\n-    return errors::InvalidArgument(\"Couldn't open the specified file: \" +\n-                                   body_filepath);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"Couldn't open the specified file: \", body_filepath));\n   }\n   fseek(put_body_, 0, SEEK_END);\n   const auto size = ftell(put_body_) - offset;\n@@ -506,7 +506,7 @@ absl::Status CurlHttpRequest::Send() {\n     case 406:  // Not Acceptable\n     case 411:  // Length Required\n     case 414:  // URI Too Long\n-      result = errors::InvalidArgument(get_error_message());\n+      result = absl::InvalidArgumentError(get_error_message());\n       break;\n \n     // PERMISSION_DENIED indicates an authentication or an authorization issue."
        },
        {
            "sha": "6ddb24fda8476262f5b54741768d6b3b725a20b1",
            "filename": "third_party/xla/xla/tsl/platform/cloud/gcs_file_system.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fcloud%2Fgcs_file_system.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fcloud%2Fgcs_file_system.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fcloud%2Fgcs_file_system.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -1295,19 +1295,19 @@ absl::Status GcsFileSystem::ParseGcsPathForScheme(absl::string_view fname,\n   absl::string_view parsed_scheme, bucketp, objectp;\n   io::ParseURI(fname, &parsed_scheme, &bucketp, &objectp);\n   if (parsed_scheme != scheme) {\n-    return errors::InvalidArgument(\"GCS path doesn't start with 'gs://': \",\n-                                   fname);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"GCS path doesn't start with 'gs://': \", fname));\n   }\n   *bucket = string(bucketp);\n   if (bucket->empty() || *bucket == \".\") {\n-    return errors::InvalidArgument(\"GCS path doesn't contain a bucket name: \",\n-                                   fname);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"GCS path doesn't contain a bucket name: \", fname));\n   }\n   absl::ConsumePrefix(&objectp, \"/\");\n   *object = string(objectp);\n   if (!empty_object_ok && object->empty()) {\n-    return errors::InvalidArgument(\"GCS path doesn't contain an object name: \",\n-                                   fname);\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"GCS path doesn't contain an object name: \", fname));\n   }\n   return absl::OkStatus();\n }\n@@ -1580,7 +1580,7 @@ absl::Status GcsFileSystem::StatForObject(const string& fname,\n                                           const string& object,\n                                           GcsFileStat* stat) {\n   if (object.empty()) {\n-    return errors::InvalidArgument(strings::Printf(\n+    return absl::InvalidArgumentError(strings::Printf(\n         \"'object' must be a non-empty string. (File: %s)\", fname.c_str()));\n   }\n \n@@ -1729,7 +1729,7 @@ absl::Status GcsFileSystem::FolderExists(const string& dirname, bool* result) {\n       stat->base = DIRECTORY_STAT;\n       return absl::OkStatus();\n     } else {\n-      return errors::InvalidArgument(\"Not a directory!\");\n+      return absl::InvalidArgumentError(\"Not a directory!\");\n     }\n   };\n   GcsFileStat stat;\n@@ -1765,8 +1765,8 @@ absl::Status GcsFileSystem::GetMatchingPaths(const string& pattern,\n             pattern.substr(0, pattern.find_first_of(\"*?[\\\\\"));\n         const string dir(this->Dirname(fixed_prefix));\n         if (dir.empty()) {\n-          return errors::InvalidArgument(\n-              \"A GCS pattern doesn't have a bucket name: \", pattern);\n+          return absl::InvalidArgumentError(absl::StrCat(\n+              \"A GCS pattern doesn't have a bucket name: \", pattern));\n         }\n         std::vector<string> all_files;\n         TF_RETURN_IF_ERROR(GetChildrenBounded(\n@@ -1803,7 +1803,7 @@ absl::Status GcsFileSystem::GetChildrenBounded(\n     const string& dirname, uint64 max_results, std::vector<string>* result,\n     bool recursive, bool include_self_directory_marker) {\n   if (!result) {\n-    return errors::InvalidArgument(\"'result' cannot be null\");\n+    return absl::InvalidArgumentError(\"'result' cannot be null\");\n   }\n   string bucket, object_prefix;\n   TF_RETURN_IF_ERROR("
        },
        {
            "sha": "b6d309648deea12fb0f7cc6b5d0870717723d7aa",
            "filename": "third_party/xla/xla/tsl/platform/default/posix_file_system.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fposix_file_system.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fposix_file_system.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2Fposix_file_system.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -46,9 +46,7 @@ limitations under the License.\n #include \"xla/tsl/platform/errors.h\"\n #include \"xla/tsl/platform/file_system_helper.h\"\n #include \"xla/tsl/platform/logging.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/protobuf/error_codes.pb.h\"\n-#include \"tsl/platform/strcat.h\"\n \n namespace tsl {\n \n@@ -116,9 +114,9 @@ class PosixRandomAccessFile : public RandomAccessFile {\n       return absl::OkStatus();\n     }\n     if (n < 0) {\n-      return errors::InvalidArgument(\n-          \"Attempting to read \", n,\n-          \" bytes. You cannot read a negative number of bytes.\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(\"Attempting to read \", n,\n+                       \" bytes. You cannot read a negative number of bytes.\"));\n     }\n \n     char* scratch = new char[n];"
        },
        {
            "sha": "b7bbc84c67df7aa3e365583daf3655240e37b06a",
            "filename": "third_party/xla/xla/tsl/platform/ram_file_system.h",
            "status": "modified",
            "additions": 10,
            "deletions": 6,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fram_file_system.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fram_file_system.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fram_file_system.h?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -37,19 +37,20 @@ limitations under the License.\n #include \"absl/status/status.h\"\n #include \"absl/strings/cord.h\"\n #include \"absl/strings/match.h\"\n+#include \"absl/strings/str_cat.h\"\n #include \"absl/strings/string_view.h\"\n #include \"absl/synchronization/mutex.h\"\n #include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n #include \"xla/tsl/platform/file_statistics.h\"\n #include \"xla/tsl/platform/file_system.h\"\n #include \"xla/tsl/platform/types.h\"\n-#include \"tsl/platform/stringpiece.h\"\n \n #ifdef PLATFORM_WINDOWS\n #undef DeleteFile\n #undef CopyFile\n #undef TranslateName\n+#undef StrCat\n #endif\n \n namespace tsl {\n@@ -128,7 +129,8 @@ class RamFileSystem : public FileSystem {\n       return absl::NotFoundError(\"\");\n     }\n     if (fs_[fname] == nullptr) {\n-      return errors::InvalidArgument(fname_, \" is a directory.\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(fname_, \" is a directory.\"));\n     }\n     *result = std::unique_ptr<RandomAccessFile>(\n         new RamRandomAccessFile(fname, fs_[fname]));\n@@ -145,7 +147,8 @@ class RamFileSystem : public FileSystem {\n       fs_[fname] = std::make_shared<std::string>();\n     }\n     if (fs_[fname] == nullptr) {\n-      return errors::InvalidArgument(fname_, \" is a directory.\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(fname_, \" is a directory.\"));\n     }\n     *result = std::unique_ptr<WritableFile>(\n         new RamRandomAccessFile(fname, fs_[fname]));\n@@ -162,7 +165,8 @@ class RamFileSystem : public FileSystem {\n       fs_[fname] = std::make_shared<std::string>();\n     }\n     if (fs_[fname] == nullptr) {\n-      return errors::InvalidArgument(fname_, \" is a directory.\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(fname_, \" is a directory.\"));\n     }\n     *result = std::unique_ptr<WritableFile>(\n         new RamRandomAccessFile(fname, fs_[fname]));\n@@ -293,7 +297,7 @@ class RamFileSystem : public FileSystem {\n       return absl::NotFoundError(\"\");\n     }\n     if (it->second != nullptr) {\n-      return errors::InvalidArgument(\"Not a directory\");\n+      return absl::InvalidArgumentError(\"Not a directory\");\n     }\n     fs_.erase(dirname);\n \n@@ -307,7 +311,7 @@ class RamFileSystem : public FileSystem {\n \n     if (fs_.find(fname) != fs_.end()) {\n       if (fs_[fname] == nullptr) {\n-        return errors::InvalidArgument(\"Not a file\");\n+        return absl::InvalidArgumentError(\"Not a file\");\n       }\n       *file_size = fs_[fname]->size();\n       return absl::OkStatus();"
        },
        {
            "sha": "219166c8b17697b4cfd88d50e1d23583dcc0f0d5",
            "filename": "third_party/xla/xla/tsl/platform/windows/windows_file_system.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fwindows%2Fwindows_file_system.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fwindows%2Fwindows_file_system.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fwindows%2Fwindows_file_system.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -164,9 +164,9 @@ class WindowsRandomAccessFile : public RandomAccessFile {\n       return absl::OkStatus();\n     }\n     if (n < 0) {\n-      return errors::InvalidArgument(\n-          \"Attempting to read \", n,\n-          \" bytes. You cannot read a negative number of bytes.\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(\"Attempting to read \", n,\n+                       \" bytes. You cannot read a negative number of bytes.\"));\n     }\n \n     char* scratch = new char[n];"
        },
        {
            "sha": "30cf9023c925718317f1c92f3334c533b308f426",
            "filename": "third_party/xla/xla/tsl/util/BUILD",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2FBUILD?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -236,11 +236,12 @@ cc_library(\n     ]),\n     deps = [\n         \"//xla/tsl/platform:env\",\n-        \"//xla/tsl/platform:env_impl\",\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:macros\",\n         \"//xla/tsl/platform:types\",\n         \"//xla/tsl/protobuf:test_log_proto_cc\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/strings\",\n         \"@local_tsl//tsl/platform:str_util\",\n     ],\n )\n@@ -278,6 +279,9 @@ cc_library(\n     deps = [\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:status\",\n+        \"//xla/tsl/platform:types\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/strings:string_view\",\n         \"@local_tsl//tsl/platform:str_util\","
        },
        {
            "sha": "a79551b6b7f080a4e10edfa9d121401da3e3c878",
            "filename": "third_party/xla/xla/tsl/util/device_name_utils.cc",
            "status": "modified",
            "additions": 34,
            "deletions": 28,
            "changes": 62,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2Fdevice_name_utils.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2Fdevice_name_utils.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2Fdevice_name_utils.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -17,12 +17,18 @@ limitations under the License.\n \n #include <algorithm>\n #include <cstdint>\n+#include <ostream>\n #include <string>\n+#include <vector>\n \n+#include \"absl/log/check.h\"\n+#include \"absl/status/status.h\"\n #include \"absl/strings/ascii.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/string_view.h\"\n+#include \"absl/strings/strip.h\"\n #include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/types.h\"\n #include \"tsl/platform/str_util.h\"\n \n namespace tsl {\n@@ -214,15 +220,15 @@ absl::Status DeviceNameUtils::CanonicalizeDeviceName(absl::string_view fullname,\n   *canonical_name = \"\";\n   ParsedName parsed_basename;\n   if (!ParseFullName(basename, &parsed_basename)) {\n-    return errors::InvalidArgument(\"Could not parse basename: \", basename,\n-                                   \" into a device specification.\");\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"Could not parse basename: \", basename,\n+                     \" into a device specification.\"));\n   }\n   if (!(parsed_basename.has_job && parsed_basename.has_replica &&\n         parsed_basename.has_task && parsed_basename.has_type &&\n         parsed_basename.has_id)) {\n-    return errors::InvalidArgument(\"Basename: \", basename,\n-                                   \" should be fully \"\n-                                   \"specified.\");\n+    return absl::InvalidArgumentError(\n+        absl::StrCat(\"Basename: \", basename, \" should be fully specified.\"));\n   }\n   ParsedName parsed_name;\n   if (ParseLocalName(fullname, &parsed_name)) {\n@@ -235,9 +241,9 @@ absl::Status DeviceNameUtils::CanonicalizeDeviceName(absl::string_view fullname,\n     *canonical_name = ParsedNameToString(parsed_name);\n     return absl::OkStatus();\n   }\n-  return errors::InvalidArgument(\"Could not parse \", fullname,\n-                                 \" into a device \"\n-                                 \"specification.\");\n+  return absl::InvalidArgumentError(absl::StrCat(\"Could not parse \", fullname,\n+                                                 \" into a device \"\n+                                                 \"specification.\"));\n }\n \n /* static */\n@@ -367,32 +373,32 @@ absl::Status MergeDevNamesImpl(DeviceNameUtils::ParsedName* target,\n   const auto& ParsedNameToString = DeviceNameUtils::ParsedNameToString;\n   if (other.has_job) {\n     if (target->has_job && target->job != other.job) {\n-      return errors::InvalidArgument(\n-          \"Cannot merge devices with incompatible jobs: '\",\n-          ParsedNameToString(*target), \"' and '\", ParsedNameToString(other),\n-          \"'\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(\"Cannot merge devices with incompatible jobs: '\",\n+                       ParsedNameToString(*target), \"' and '\",\n+                       ParsedNameToString(other), \"'\"));\n     }\n     target->has_job = other.has_job;\n     target->job = other.job;\n   }\n \n   if (other.has_replica) {\n     if (target->has_replica && target->replica != other.replica) {\n-      return errors::InvalidArgument(\n-          \"Cannot merge devices with incompatible replicas: '\",\n-          ParsedNameToString(*target), \"' and '\", ParsedNameToString(other),\n-          \"'\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(\"Cannot merge devices with incompatible replicas: '\",\n+                       ParsedNameToString(*target), \"' and '\",\n+                       ParsedNameToString(other), \"'\"));\n     }\n     target->has_replica = other.has_replica;\n     target->replica = other.replica;\n   }\n \n   if (other.has_task) {\n     if (target->has_task && target->task != other.task) {\n-      return errors::InvalidArgument(\n-          \"Cannot merge devices with incompatible tasks: '\",\n-          ParsedNameToString(*target), \"' and '\", ParsedNameToString(other),\n-          \"'\");\n+      return absl::InvalidArgumentError(\n+          absl::StrCat(\"Cannot merge devices with incompatible tasks: '\",\n+                       ParsedNameToString(*target), \"' and '\",\n+                       ParsedNameToString(other), \"'\"));\n     }\n     target->has_task = other.has_task;\n     target->task = other.task;\n@@ -401,10 +407,10 @@ absl::Status MergeDevNamesImpl(DeviceNameUtils::ParsedName* target,\n   if (other.has_type) {\n     if (target->has_type && target->type != other.type) {\n       if (!allow_soft_placement) {\n-        return errors::InvalidArgument(\n-            \"Cannot merge devices with incompatible types: '\",\n-            ParsedNameToString(*target), \"' and '\", ParsedNameToString(other),\n-            \"'\");\n+        return absl::InvalidArgumentError(\n+            absl::StrCat(\"Cannot merge devices with incompatible types: '\",\n+                         ParsedNameToString(*target), \"' and '\",\n+                         ParsedNameToString(other), \"'\"));\n       }\n       if (override_conflicts) {\n         target->type = other.type;\n@@ -422,10 +428,10 @@ absl::Status MergeDevNamesImpl(DeviceNameUtils::ParsedName* target,\n   if (other.has_id) {\n     if (target->has_id && target->id != other.id) {\n       if (!allow_soft_placement) {\n-        return errors::InvalidArgument(\n-            \"Cannot merge devices with incompatible ids: '\",\n-            ParsedNameToString(*target), \"' and '\", ParsedNameToString(other),\n-            \"'\");\n+        return absl::InvalidArgumentError(\n+            absl::StrCat(\"Cannot merge devices with incompatible ids: '\",\n+                         ParsedNameToString(*target), \"' and '\",\n+                         ParsedNameToString(other), \"'\"));\n       }\n       if (override_conflicts) {\n         target->id = other.id;"
        },
        {
            "sha": "a2124135327bbf1f408bdfe9cf7122a63fb48212",
            "filename": "third_party/xla/xla/tsl/util/reporter.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2Freporter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2Freporter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2Freporter.cc?ref=f6b6d4d83426a5ee6e6385d7b85b0d9bd3f97941",
            "patch": "@@ -15,7 +15,14 @@ limitations under the License.\n \n #include \"xla/tsl/util/reporter.h\"\n \n+#include <cstdint>\n+\n+#include \"absl/status/status.h\"\n+#include \"absl/strings/str_cat.h\"\n+#include \"absl/strings/str_join.h\"\n+#include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/types.h\"\n #include \"tsl/platform/str_util.h\"\n \n namespace tsl {\n@@ -46,8 +53,8 @@ absl::Status TestReportFile::Initialize() {\n       fname_, absl::StrJoin(str_util::Split(test_name_, '/'), \"__\"));\n   Env* env = Env::Default();\n   if (env->FileExists(mangled_fname).ok()) {\n-    return errors::InvalidArgument(\n-        \"Cannot create TestReportFile, file exists: \", mangled_fname);\n+    return absl::InvalidArgumentError(absl::StrCat(\n+        \"Cannot create TestReportFile, file exists: \", mangled_fname));\n   }\n   TF_RETURN_IF_ERROR(env->NewWritableFile(mangled_fname, &log_file_));\n   TF_RETURN_IF_ERROR(log_file_->Flush());"
        }
    ],
    "stats": {
        "total": 293,
        "additions": 181,
        "deletions": 112
    }
}