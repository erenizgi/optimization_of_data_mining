{
    "author": "tensorflower-gardener",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 831315934",
    "sha": "d66234ca9e80b2fdc3f50bde23de92cdc29369ac",
    "files": [
        {
            "sha": "cd332ed1791849818b99f261e9eada7634e4d120",
            "filename": "tensorflow/cc/framework/fuzzing/cc_op_fuzz_gen.cc",
            "status": "modified",
            "additions": 39,
            "deletions": 39,
            "changes": 78,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d66234ca9e80b2fdc3f50bde23de92cdc29369ac/tensorflow%2Fcc%2Fframework%2Ffuzzing%2Fcc_op_fuzz_gen.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d66234ca9e80b2fdc3f50bde23de92cdc29369ac/tensorflow%2Fcc%2Fframework%2Ffuzzing%2Fcc_op_fuzz_gen.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcc%2Fframework%2Ffuzzing%2Fcc_op_fuzz_gen.cc?ref=d66234ca9e80b2fdc3f50bde23de92cdc29369ac",
            "patch": "@@ -42,7 +42,7 @@ namespace tensorflow {\n namespace cc_op {\n namespace {\n \n-string DefaultValue(OpDef_AttrDef attr) {\n+std::string DefaultValue(OpDef_AttrDef attr) {\n   static const auto* attr_default_value_map =\n       new absl::flat_hash_map<absl::string_view, absl::string_view,\n                               StringPieceHasher>{\n@@ -80,19 +80,19 @@ string DefaultValue(OpDef_AttrDef attr) {\n   return std::string(entry->second);\n }\n \n-string WriteClassFuzzDef(const OpInfo& op_info) {\n-  string class_signature_str = absl::Substitute(\n+std::string WriteClassFuzzDef(const OpInfo& op_info) {\n+  std::string class_signature_str = absl::Substitute(\n       \"class Fuzz$0 : public FuzzSession<$1> {\\n\", op_info.op_name,\n       absl::StrJoin(op_info.graph_op_def.input_arg(), \", \",\n-                    [](string* out, const auto arg) {\n+                    [](std::string* out, const auto arg) {\n                       absl::StrAppend(out, \"Tensor\");\n                       if (ArgIsList(arg)) absl::StrAppend(out, \", Tensor\");\n                     }));\n \n-  string build_graph_body = absl::StrCat(\n+  std::string build_graph_body = absl::StrCat(\n       absl::StrJoin(\n           op_info.graph_op_def.input_arg(), \"\",\n-          [op_info](string* out, const OpDef_ArgDef arg) {\n+          [op_info](std::string* out, const OpDef_ArgDef arg) {\n             std::string type = \"DT_UINT8\";\n \n             if (arg.type() != DT_INVALID) {\n@@ -130,7 +130,7 @@ string WriteClassFuzzDef(const OpInfo& op_info) {\n             }\n           }),\n       absl::StrJoin(op_info.graph_op_def.attr(), \"\",\n-                    [op_info](string* out, const OpDef_AttrDef attr) {\n+                    [op_info](std::string* out, const OpDef_AttrDef attr) {\n                       if (op_info.inferred_input_attrs.count(attr.name()) ==\n                               0 &&\n                           !attr.has_default_value()) {\n@@ -139,43 +139,43 @@ string WriteClassFuzzDef(const OpInfo& op_info) {\n                       }\n                     }));\n \n-  string constructor_call_str = absl::Substitute(\n+  std::string constructor_call_str = absl::Substitute(\n       \"    tensorflow::ops::$0(scope.WithOpName(\\\"output\\\")$1);\\n\",\n       op_info.op_name,\n       absl::StrCat(\n           op_info.api_def.arg_order().empty()\n               ? absl::StrJoin(op_info.api_def.in_arg(), \"\",\n-                              [](string* out, const auto api_def_arg) {\n+                              [](std::string* out, const auto api_def_arg) {\n                                 strings::StrAppend(out, \", \",\n                                                    api_def_arg.name());\n                               })\n               : absl::StrJoin(op_info.api_def.arg_order(), \"\",\n-                              [](string* out, const auto name) {\n+                              [](std::string* out, const auto name) {\n                                 strings::StrAppend(out, \", \", name);\n                               }),\n           absl::StrJoin(op_info.graph_op_def.attr(), \"\",\n-                        [op_info](string* out, const OpDef_AttrDef attr) {\n+                        [op_info](std::string* out, const OpDef_AttrDef attr) {\n                           if (op_info.inferred_input_attrs.count(attr.name()) ==\n                                   0 &&\n                               !attr.has_default_value()) {\n                             absl::StrAppend(out, \", \", attr.name());\n                           }\n                         })));\n \n-  string fuzz_impl_signature_str = absl::Substitute(\n+  std::string fuzz_impl_signature_str = absl::Substitute(\n       \"  void FuzzImpl($0) final {\\n\",\n       absl::StrJoin(\n           op_info.graph_op_def.input_arg(), \", \",\n-          [](string* out, const auto arg) {\n+          [](std::string* out, const auto arg) {\n             strings::StrAppend(out, \"const Tensor& \", arg.name(), \"_0\");\n             if (ArgIsList(arg))\n               strings::StrAppend(out, \", const Tensor& \", arg.name(), \"_1\");\n           }));\n \n-  string run_inputs_str = absl::Substitute(\n+  std::string run_inputs_str = absl::Substitute(\n       \"    RunInputs({$0});\\n\",\n       absl::StrJoin(op_info.graph_op_def.input_arg(), \", \",\n-                    [](string* out, const auto arg) {\n+                    [](std::string* out, const auto arg) {\n                       if (ArgIsList(arg)) {\n                         strings::StrAppend(\n                             out, \"{\\\"\", arg.name(), \"\\\", \", arg.name(), \"_0}, \",\n@@ -186,32 +186,32 @@ string WriteClassFuzzDef(const OpInfo& op_info) {\n                       }\n                     }));\n \n-  string fuzz_class_def = strings::StrCat(\n+  std::string fuzz_class_def = strings::StrCat(\n       class_signature_str, \"  void BuildGraph(const Scope& scope) override {\\n\",\n       build_graph_body, constructor_call_str, \"  }\\n\", fuzz_impl_signature_str,\n       run_inputs_str, \"  }\\n\", \"};\\n\");\n \n   return fuzz_class_def;\n }\n \n-string WriteFuzzTest(const OpInfo& op_info) {\n+std::string WriteFuzzTest(const OpInfo& op_info) {\n   return absl::Substitute(\n       \"FUZZ_TEST_F(Fuzz$0, Fuzz).WithDomains($1);\\n\", op_info.op_name,\n       absl::StrJoin(op_info.graph_op_def.input_arg(), \", \",\n-                    [](string* out, const auto arg) {\n+                    [](std::string* out, const auto arg) {\n                       absl::StrAppend(out, \"AnyTensor()\");\n                       if (ArgIsList(arg)) absl::StrAppend(out, \", AnyTensor()\");\n                     }));\n }\n \n-string FuzzerFileStart() {\n-  const string fuzz_namespace_begin = R\"namespace(\n+std::string FuzzerFileStart() {\n+  const std::string fuzz_namespace_begin = R\"namespace(\n namespace tensorflow {\n namespace fuzzing {\n \n )namespace\";\n \n-  const string fuzz_header =\n+  const std::string fuzz_header =\n       absl::StrCat(R\"include(// This file is MACHINE GENERATED! Do not edit.\n \n #include \"tensorflow/cc/ops/const_op.h\"\n@@ -224,8 +224,8 @@ namespace fuzzing {\n   return fuzz_header;\n }\n \n-string FuzzerFileEnd() {\n-  const string fuzz_footer = R\"footer(\n+std::string FuzzerFileEnd() {\n+  const std::string fuzz_footer = R\"footer(\n }  // namespace fuzzing\n }  // namespace tensorflow\n )footer\";\n@@ -258,27 +258,27 @@ bool OpFuzzingIsOk(const OpInfo& op_info) {\n   }\n \n   // TODO(unda) : zero input ops\n-  std::set<string> zero_input_ops = {\"Placeholder\", \"ImmutableConst\"};\n+  std::set<std::string> zero_input_ops = {\"Placeholder\", \"ImmutableConst\"};\n   if (zero_input_ops.find(op_info.op_name) != zero_input_ops.end()) {\n     std::cout << \"NOT fuzzing: \" << op_info.graph_op_def.name()\n               << \" takes zero inputs.\\n\";\n     return false;\n   }\n \n   // TODO(unda, 253431636): constrained kernel\n-  std::set<string> constrained_kernel = {\"Diag\",\n-                                         \"DiagPart\",\n-                                         \"GatherNd\",\n-                                         \"GatherV2\",\n-                                         \"QuantizeAndDequantizeV2\",\n-                                         \"QuantizeAndDequantizeV3\",\n-                                         \"QuantizeAndDequantizeV4\",\n-                                         \"QuantizeAndDequantizeV4Grad\",\n-                                         \"QuantizedConcat\",\n-                                         \"QuantizedInstanceNorm\",\n-                                         \"QuantizedReshape\",\n-                                         \"ScatterNd\",\n-                                         \"TensorScatterUpdate\"};\n+  std::set<std::string> constrained_kernel = {\"Diag\",\n+                                              \"DiagPart\",\n+                                              \"GatherNd\",\n+                                              \"GatherV2\",\n+                                              \"QuantizeAndDequantizeV2\",\n+                                              \"QuantizeAndDequantizeV3\",\n+                                              \"QuantizeAndDequantizeV4\",\n+                                              \"QuantizeAndDequantizeV4Grad\",\n+                                              \"QuantizedConcat\",\n+                                              \"QuantizedInstanceNorm\",\n+                                              \"QuantizedReshape\",\n+                                              \"ScatterNd\",\n+                                              \"TensorScatterUpdate\"};\n \n   // TODO(unda, b/253431636): constrained kernel\n   if (constrained_kernel.find(op_info.op_name) != constrained_kernel.end()) {\n@@ -297,7 +297,7 @@ bool OpFuzzingIsOk(const OpInfo& op_info) {\n     }\n   }\n \n-  std::set<string> unhandled_attr_types = {\n+  std::set<std::string> unhandled_attr_types = {\n       \"list(type)\",   \"func\",         \"float\",      \"bool\",\n       \"tensor\",       \"list(string)\", \"list(bool)\", \"list(shape)\",\n       \"list(tensor)\", \"list(attr)\"};\n@@ -321,7 +321,7 @@ bool OpFuzzingIsOk(const OpInfo& op_info) {\n   return true;\n }\n \n-string WriteSingleFuzzer(const OpInfo& op_info, bool is_fuzzable) {\n+std::string WriteSingleFuzzer(const OpInfo& op_info, bool is_fuzzable) {\n   return absl::StrCat(\n       FuzzerFileStart(), is_fuzzable ? WriteClassFuzzDef(op_info) : \"\",\n       is_fuzzable ? WriteFuzzTest(op_info) : \"\", FuzzerFileEnd());"
        },
        {
            "sha": "9dfee93e55e2e1e17b2e6dbfa4dc4e98d1149669",
            "filename": "tensorflow/cc/framework/fuzzing/cc_op_fuzz_gen.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d66234ca9e80b2fdc3f50bde23de92cdc29369ac/tensorflow%2Fcc%2Fframework%2Ffuzzing%2Fcc_op_fuzz_gen.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d66234ca9e80b2fdc3f50bde23de92cdc29369ac/tensorflow%2Fcc%2Fframework%2Ffuzzing%2Fcc_op_fuzz_gen.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcc%2Fframework%2Ffuzzing%2Fcc_op_fuzz_gen.h?ref=d66234ca9e80b2fdc3f50bde23de92cdc29369ac",
            "patch": "@@ -25,7 +25,7 @@ namespace tensorflow {\n namespace cc_op {\n \n // String with single fuzzer file content.\n-string WriteSingleFuzzer(const OpInfo& op_info, bool is_fuzzable);\n+std::string WriteSingleFuzzer(const OpInfo& op_info, bool is_fuzzable);\n \n // Do we have all we need to create a fuzzer\n bool OpFuzzingIsOk(const OpInfo& op_info);"
        },
        {
            "sha": "6da6e2af6c34456b4465d0dc80d35a3e8f57f143",
            "filename": "tensorflow/cc/framework/fuzzing/cc_op_fuzz_gen_main.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d66234ca9e80b2fdc3f50bde23de92cdc29369ac/tensorflow%2Fcc%2Fframework%2Ffuzzing%2Fcc_op_fuzz_gen_main.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d66234ca9e80b2fdc3f50bde23de92cdc29369ac/tensorflow%2Fcc%2Fframework%2Ffuzzing%2Fcc_op_fuzz_gen_main.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcc%2Fframework%2Ffuzzing%2Fcc_op_fuzz_gen_main.cc?ref=d66234ca9e80b2fdc3f50bde23de92cdc29369ac",
            "patch": "@@ -39,8 +39,9 @@ namespace tensorflow {\n namespace cc_op {\n namespace {\n \n-void WriteAllFuzzers(string root_location, std::vector<string> api_def_dirs,\n-                     std::vector<string> op_names) {\n+void WriteAllFuzzers(std::string root_location,\n+                     std::vector<std::string> api_def_dirs,\n+                     std::vector<std::string> op_names) {\n   OpList ops;\n   absl::StatusOr<ApiDefMap> api_def_map =\n       LoadOpsAndApiDefs(ops, false, api_def_dirs);\n@@ -60,7 +61,7 @@ void WriteAllFuzzers(string root_location, std::vector<string> api_def_dirs,\n       continue;\n     }\n \n-    OpInfo op_info(op_def, *api_def, std::vector<string>());\n+    OpInfo op_info(op_def, *api_def, std::vector<std::string>());\n     status.Update(env->NewWritableFile(\n         root_location + \"/\" + op_def.name() + \"_fuzz.cc\", &fuzz_file));\n     status.Update(\n@@ -87,9 +88,9 @@ int main(int argc, char* argv[]) {\n   for (int i = 1; i < argc; ++i) {\n     fprintf(stdout, \"Arg %d = %s\\n\", i, argv[i]);\n   }\n-  std::vector<tensorflow::string> api_def_srcs = tensorflow::str_util::Split(\n+  std::vector<std::string> api_def_srcs = tensorflow::str_util::Split(\n       argv[2], \",\", tensorflow::str_util::SkipEmpty());\n-  std::vector<tensorflow::string> op_names = tensorflow::str_util::Split(\n+  std::vector<std::string> op_names = tensorflow::str_util::Split(\n       argv[3], \",\", tensorflow::str_util::SkipEmpty());\n   tensorflow::cc_op::WriteAllFuzzers(argv[1], api_def_srcs, op_names);\n   return 0;"
        }
    ],
    "stats": {
        "total": 91,
        "additions": 46,
        "deletions": 45
    }
}