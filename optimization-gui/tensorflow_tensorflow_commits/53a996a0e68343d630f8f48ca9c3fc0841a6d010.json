{
    "author": "tensorflower-gardener",
    "message": "Make the `Device` constructor take `DeviceAttributes` rather than `const DeviceAttributes&` since it is always copied.\n\nThis change allows for passing an r-value into the function, avoiding an additional copy.\n\nCurrently, `NewRenamedDevice()` creates a `DeviceAttributes` copy, then passes it as a const ref to `RenamedDevice` constructor. It is passed again as a const ref to the `Device` constructor, where the `DeviceAttributes` is copied again.\n\nPiperOrigin-RevId: 814385232",
    "sha": "53a996a0e68343d630f8f48ca9c3fc0841a6d010",
    "files": [
        {
            "sha": "0bfc121b23cab49522a47975eabac8b6d5638b5c",
            "filename": "tensorflow/core/common_runtime/renamed_device.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/53a996a0e68343d630f8f48ca9c3fc0841a6d010/tensorflow%2Fcore%2Fcommon_runtime%2Frenamed_device.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/53a996a0e68343d630f8f48ca9c3fc0841a6d010/tensorflow%2Fcore%2Fcommon_runtime%2Frenamed_device.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fcommon_runtime%2Frenamed_device.cc?ref=53a996a0e68343d630f8f48ca9c3fc0841a6d010",
            "patch": "@@ -17,8 +17,11 @@ limitations under the License.\n \n #include \"tensorflow/core/common_runtime/renamed_device.h\"\n \n+#include <utility>\n+\n #include \"absl/memory/memory.h\"\n #include \"unsupported/Eigen/CXX11/Tensor\"  // from @eigen_archive\n+#include \"tensorflow/core/framework/device.h\"\n #include \"tensorflow/core/lib/core/threadpool.h\"\n \n namespace tensorflow {\n@@ -43,16 +46,15 @@ std::unique_ptr<Device> RenamedDevice::NewRenamedDevice(\n   attributes.set_name(name);\n   // Call absl::WrapUnique to access private constructor.\n   return absl::WrapUnique(\n-      new RenamedDevice(underlying, attributes, owns_underlying,\n+      new RenamedDevice(underlying, std::move(attributes), owns_underlying,\n                         isolate_session_state, underlying_threadpool));\n }\n \n-RenamedDevice::RenamedDevice(Device* underlying,\n-                             const DeviceAttributes& attributes,\n+RenamedDevice::RenamedDevice(Device* underlying, DeviceAttributes attributes,\n                              bool owns_underlying_device,\n                              bool isolate_session_state,\n                              thread::ThreadPoolInterface* underlying_threadpool)\n-    : Device(underlying->env(), attributes),\n+    : Device(underlying->env(), std::move(attributes)),\n       underlying_device_(underlying),\n       owns_underlying_device_(owns_underlying_device),\n       isolate_session_state_(isolate_session_state) {"
        },
        {
            "sha": "4a0e1057b398a432f13c4054e13b3d0b94d3d60f",
            "filename": "tensorflow/core/common_runtime/renamed_device.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/53a996a0e68343d630f8f48ca9c3fc0841a6d010/tensorflow%2Fcore%2Fcommon_runtime%2Frenamed_device.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/53a996a0e68343d630f8f48ca9c3fc0841a6d010/tensorflow%2Fcore%2Fcommon_runtime%2Frenamed_device.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fcommon_runtime%2Frenamed_device.h?ref=53a996a0e68343d630f8f48ca9c3fc0841a6d010",
            "patch": "@@ -155,7 +155,7 @@ class RenamedDevice : public Device {\n   }\n \n  private:\n-  RenamedDevice(Device* underlying, const DeviceAttributes& attributes,\n+  RenamedDevice(Device* underlying, DeviceAttributes attributes,\n                 bool owns_underlying, bool isolate_session_state,\n                 thread::ThreadPoolInterface* underlying_threadpool);\n   Device* const underlying_device_;"
        },
        {
            "sha": "59730e3ce1d436f7a46ae65ab697585bfa0c7020",
            "filename": "tensorflow/core/framework/device.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/53a996a0e68343d630f8f48ca9c3fc0841a6d010/tensorflow%2Fcore%2Fframework%2Fdevice.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/53a996a0e68343d630f8f48ca9c3fc0841a6d010/tensorflow%2Fcore%2Fframework%2Fdevice.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fframework%2Fdevice.cc?ref=53a996a0e68343d630f8f48ca9c3fc0841a6d010",
            "patch": "@@ -24,8 +24,8 @@ limitations under the License.\n \n namespace tensorflow {\n \n-Device::Device(Env* env, const DeviceAttributes& device_attributes)\n-    : DeviceBase(env), device_attributes_(device_attributes) {\n+Device::Device(Env* env, DeviceAttributes device_attributes)\n+    : DeviceBase(env), device_attributes_(std::move(device_attributes)) {\n   CHECK(DeviceNameUtils::ParseFullName(name(), &parsed_name_))\n       << \"Invalid device name: \" << name();\n   rmgr_ = new ResourceMgr(parsed_name_.job);"
        },
        {
            "sha": "493001e756b814a5d83b73800edc7b829b7b9bdb",
            "filename": "tensorflow/core/framework/device.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/53a996a0e68343d630f8f48ca9c3fc0841a6d010/tensorflow%2Fcore%2Fframework%2Fdevice.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/53a996a0e68343d630f8f48ca9c3fc0841a6d010/tensorflow%2Fcore%2Fframework%2Fdevice.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fframework%2Fdevice.h?ref=53a996a0e68343d630f8f48ca9c3fc0841a6d010",
            "patch": "@@ -56,7 +56,7 @@ class Device : public DeviceBase {\n   // Callback type that takes a Status and returns void.\n   typedef std::function<void(const absl::Status&)> DoneCallback;\n \n-  Device(Env* env, const DeviceAttributes& device_attributes);\n+  Device(Env* env, DeviceAttributes device_attributes);\n   ~Device() override;\n \n   // A compare function that orders devices by their parsed name."
        }
    ],
    "stats": {
        "total": 18,
        "additions": 10,
        "deletions": 8
    }
}