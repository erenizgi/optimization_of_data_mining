{
    "author": "dsharletg",
    "message": "Change xnn_fusion_benchmark_test to ynn_fusion_benchmark_test\n\nI also incorrectly removed the build rule for this in a previous change.\n\nPiperOrigin-RevId: 844995933",
    "sha": "d7a2f4a21ea36000f33fa0485d91bf287a70f0f3",
    "files": [
        {
            "sha": "c9a377c6ecb010cae29c50bac335a07e7339d71e",
            "filename": "third_party/xla/xla/backends/cpu/benchmarks/BUILD",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d7a2f4a21ea36000f33fa0485d91bf287a70f0f3/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d7a2f4a21ea36000f33fa0485d91bf287a70f0f3/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2FBUILD?ref=d7a2f4a21ea36000f33fa0485d91bf287a70f0f3",
            "patch": "@@ -586,6 +586,27 @@ xla_cc_test(\n     ],\n )\n \n+xla_cc_test(\n+    name = \"ynn_fusion_benchmark_test\",\n+    srcs = [\"ynn_fusion_benchmark_test.cc\"],\n+    fail_if_no_test_linked = False,  # NOLINT=This contains benchmarks only, no tests.\n+    fail_if_no_test_selected = False,  # NOLINT=This contains benchmarks only, no tests.\n+    deps = [\n+        \":hlo_benchmark_runner\",\n+        \":multi_benchmark_config\",\n+        \"//xla:literal\",\n+        \"//xla:literal_util\",\n+        \"//xla:shape_util\",\n+        \"//xla:xla_data_proto_cc\",\n+        \"//xla/tsl/platform:logging\",\n+        \"//xla/tsl/platform:test_benchmark\",\n+        \"//xla/tsl/platform:test_main\",\n+        \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/strings:string_view\",\n+        \"@com_google_absl//absl/types:span\",\n+    ],\n+)\n+\n xla_cc_test(\n     name = \"snapshot_loading_test\",\n     srcs = [\"snapshot_loading_test.cc\"],"
        },
        {
            "sha": "061e681937330c50b7d8e0b74c22a84d6c8342b7",
            "filename": "third_party/xla/xla/backends/cpu/benchmarks/ynn_fusion_benchmark_test.cc",
            "status": "renamed",
            "additions": 14,
            "deletions": 14,
            "changes": 28,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d7a2f4a21ea36000f33fa0485d91bf287a70f0f3/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2Fynn_fusion_benchmark_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d7a2f4a21ea36000f33fa0485d91bf287a70f0f3/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2Fynn_fusion_benchmark_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2Fynn_fusion_benchmark_test.cc?ref=d7a2f4a21ea36000f33fa0485d91bf287a70f0f3",
            "patch": "@@ -37,7 +37,7 @@ namespace xla::cpu {\n static absl::Status RunFusionBenchmark(benchmark::State& state,\n                                        HloBenchmarkOptions options,\n                                        absl::string_view hlo,\n-                                       bool is_xnn_fusion = false) {\n+                                       bool is_ynn_fusion = false) {\n   int64_t d0 = state.range(0);  // Tensor size.\n   int64_t n = state.range(1);   // Number of add-multiply iterations.\n \n@@ -58,7 +58,7 @@ static absl::Status RunFusionBenchmark(benchmark::State& state,\n       ShapeUtil::MakeShape(F32, {d0, d0}), &engine, 1.0f, 0.1f);\n   std::vector<const Literal*> args = {&p0, &p1};\n \n-  if (is_xnn_fusion) {\n+  if (is_ynn_fusion) {\n     options.disable_parallel_task_assigner = true;\n     options.aot_options = nullptr;\n   }\n@@ -88,13 +88,13 @@ static void BM_EltwiseF32(benchmark::State& state,\n   CHECK_OK(RunFusionBenchmark(state, std::move(options), hlo));\n }\n \n-static void BM_XnnEltwiseF32(benchmark::State& state,\n+static void BM_YnnEltwiseF32(benchmark::State& state,\n                              HloBenchmarkOptions options) {\n   // Perform `n+1` iterations of `add` and `multiply`, then end with `subtract`.\n   absl::string_view hlo = R\"(\n     HloModule eltwise_f32_$n\n \n-    xnn_fusion {\n+    ynn_fusion {\n       p0 = f32[$d0,$d0] parameter(0)\n       p1 = f32[$d0,$d0] parameter(1)\n       add0 = f32[$d0,$d0] add(p0, p1)\n@@ -107,12 +107,12 @@ static void BM_XnnEltwiseF32(benchmark::State& state,\n       p0 = f32[$d0,$d0] parameter(0)\n       p1 = f32[$d0,$d0] parameter(1)\n       ROOT %result = f32[$d0,$d0] fusion(%p0, %p1), kind=kCustom,\n-        calls=xnn_fusion,\n-        backend_config={\"fusion_config\": {kind: \"__xnn_fusion\"}}\n+        calls=ynn_fusion,\n+        backend_config={\"fusion_config\": {kind: \"__ynn_fusion\"}}\n     }\n   )\";\n   CHECK_OK(RunFusionBenchmark(state, std::move(options), hlo,\n-                              /*is_xnn_fusion=*/true));\n+                              /*is_ynn_fusion=*/true));\n }\n \n static void BM_DotAndEltwiseF32(benchmark::State& state,\n@@ -136,14 +136,14 @@ static void BM_DotAndEltwiseF32(benchmark::State& state,\n   CHECK_OK(RunFusionBenchmark(state, std::move(options), hlo));\n }\n \n-static void BM_XnnDotAndEltwiseF32(benchmark::State& state,\n+static void BM_YnnDotAndEltwiseF32(benchmark::State& state,\n                                    HloBenchmarkOptions options) {\n   // Perform `dot` followed by `n+1` iterations of `add` and `multiply`, then\n   // end with `subtract`.\n   absl::string_view hlo = R\"(\n     HloModule dot_and_eltwise_f32_$n\n \n-    xnn_fusion {\n+    ynn_fusion {\n       p0 = f32[$d0,$d0] parameter(0)\n       p1 = f32[$d0,$d0] parameter(1)\n       dot0 = f32[$d0,$d0] dot(p0, p1), lhs_contracting_dims={1},\n@@ -158,12 +158,12 @@ static void BM_XnnDotAndEltwiseF32(benchmark::State& state,\n       p0 = f32[$d0,$d0] parameter(0)\n       p1 = f32[$d0,$d0] parameter(1)\n       ROOT %result = f32[$d0,$d0] fusion(%p0, %p1), kind=kCustom,\n-        calls=xnn_fusion,\n-        backend_config={\"fusion_config\": {kind: \"__xnn_fusion\"}}\n+        calls=ynn_fusion,\n+        backend_config={\"fusion_config\": {kind: \"__ynn_fusion\"}}\n     }\n   )\";\n   CHECK_OK(RunFusionBenchmark(state, std::move(options), hlo,\n-                              /*is_xnn_fusion=*/true));\n+                              /*is_ynn_fusion=*/true));\n }\n \n #define BENCHMARK_FUSION(name)  \\\n@@ -175,8 +175,8 @@ static void BM_XnnDotAndEltwiseF32(benchmark::State& state,\n       ->Args({1024, 32})\n \n BENCHMARK_FUSION(BM_EltwiseF32);\n-BENCHMARK_FUSION(BM_XnnEltwiseF32);\n+BENCHMARK_FUSION(BM_YnnEltwiseF32);\n BENCHMARK_FUSION(BM_DotAndEltwiseF32);\n-BENCHMARK_FUSION(BM_XnnDotAndEltwiseF32);\n+BENCHMARK_FUSION(BM_YnnDotAndEltwiseF32);\n \n }  // namespace xla::cpu",
            "previous_filename": "third_party/xla/xla/backends/cpu/benchmarks/xnn_fusion_benchmark_test.cc"
        }
    ],
    "stats": {
        "total": 49,
        "additions": 35,
        "deletions": 14
    }
}