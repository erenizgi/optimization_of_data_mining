{
    "author": "krishnaharidasan",
    "message": "Remove `devices` from XlaDeserializeExecutableOptions and use devices from the base ifrt::DeserializeExecutableOptions\n\nPiperOrigin-RevId: 804659500",
    "sha": "595ea2f2d3c7ac329a832440e3ac7e0a755ae39a",
    "files": [
        {
            "sha": "2d97545c5530f33e455a76cdf88afcddf7112652",
            "filename": "third_party/xla/xla/python/ifrt/executable_serdes.h",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/595ea2f2d3c7ac329a832440e3ac7e0a755ae39a/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fexecutable_serdes.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/595ea2f2d3c7ac329a832440e3ac7e0a755ae39a/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fexecutable_serdes.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fexecutable_serdes.h?ref=595ea2f2d3c7ac329a832440e3ac7e0a755ae39a",
            "patch": "@@ -16,6 +16,9 @@ limitations under the License.\n #ifndef XLA_PYTHON_IFRT_EXECUTABLE_SERDES_H_\n #define XLA_PYTHON_IFRT_EXECUTABLE_SERDES_H_\n \n+#include <optional>\n+#include <utility>\n+\n #include \"llvm/Support/ExtensibleRTTI.h\"\n #include \"xla/python/ifrt/device_list.h\"\n #include \"xla/python/ifrt/serdes.h\"\n@@ -30,8 +33,15 @@ namespace ifrt {\n // TODO(hyeontaek): Make an new `LoadOptions` that is specific for loading.\n struct DeserializeExecutableOptions\n     : llvm::RTTIExtends<DeserializeExecutableOptions, DeserializeOptions> {\n+  DeserializeExecutableOptions() = default;\n+  explicit DeserializeExecutableOptions(std::optional<DeviceListRef> devices)\n+      : devices(std::move(devices)) {}\n+\n   // The devices to load the executable on to.\n-  DeviceListRef devices;\n+  // If unspecified, let the runtime decide the devices to use for loading.\n+  // TODO(hyeontaek): Require `devices` to be always provided.\n+  std::optional<DeviceListRef> devices;\n+\n   static char ID;  // NOLINT\n };\n "
        },
        {
            "sha": "aff1b3f7f2f76d2aaf8f45d374997eb88030ba39",
            "filename": "third_party/xla/xla/python/pjrt_ifrt/xla_compiler.h",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/595ea2f2d3c7ac329a832440e3ac7e0a755ae39a/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fxla_compiler.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/595ea2f2d3c7ac329a832440e3ac7e0a755ae39a/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fxla_compiler.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fxla_compiler.h?ref=595ea2f2d3c7ac329a832440e3ac7e0a755ae39a",
            "patch": "@@ -29,6 +29,7 @@ limitations under the License.\n #include \"xla/pjrt/pjrt_executable.h\"\n #include \"xla/python/ifrt/compiler.h\"\n #include \"xla/python/ifrt/device_list.h\"\n+#include \"xla/python/ifrt/executable_serdes.h\"\n #include \"xla/python/ifrt/host_callback.h\"\n \n namespace xla {\n@@ -79,14 +80,14 @@ struct XlaDeserializeExecutableOptions\n       std::optional<DeviceListRef> devices,\n       std::vector<tsl::RCReference<LoadedHostCallback>> loaded_host_callbacks =\n           {})\n-      : compile_options(std::move(compile_options)),\n-        devices(std::move(devices)),\n+      : llvm::RTTIExtends<XlaDeserializeExecutableOptions,\n+                          DeserializeExecutableOptions>(std::move(devices)),\n+        compile_options(std::move(compile_options)),\n         loaded_host_callbacks(std::move(loaded_host_callbacks)) {}\n \n   // `compile_options` may be unspecified if deserialization does not override\n   // it.\n   std::optional<xla::CompileOptions> compile_options;\n-  std::optional<DeviceListRef> devices;\n   std::vector<tsl::RCReference<LoadedHostCallback>> loaded_host_callbacks;\n \n   // DeserializeExecutableOptions implementation."
        }
    ],
    "stats": {
        "total": 19,
        "additions": 15,
        "deletions": 4
    }
}