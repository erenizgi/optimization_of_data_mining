{
    "author": "tensorflower-gardener",
    "message": "Disclaim support for small dots in YNNPACK\n\nThese are probably not that helpful to send to YNNPACK anyways, and this works around a bug where `xla_cpu_small_call` attributes result in inconsistent dot handling logic.\n\nPiperOrigin-RevId: 829245496",
    "sha": "b44bd9b7aed377f2f3dc9b661af64d0fffd3ff44",
    "files": [
        {
            "sha": "2c030f2d4b67d0890f98bc07bf210fa45cb02f3f",
            "filename": "third_party/xla/xla/backends/cpu/ynn_support.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b44bd9b7aed377f2f3dc9b661af64d0fffd3ff44/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_support.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b44bd9b7aed377f2f3dc9b661af64d0fffd3ff44/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_support.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_support.cc?ref=b44bd9b7aed377f2f3dc9b661af64d0fffd3ff44",
            "patch": "@@ -197,6 +197,13 @@ absl::StatusOr<bool> IsDotSupportedByYnn(\n     return false;\n   }\n \n+  if (std::max({dot_canonical_dims.m, dot_canonical_dims.k,\n+                dot_canonical_dims.n}) < 8) {\n+    // If this dot is small, our overhead is probably too significant.\n+    // TODO(b/458529782): This is here as a workaround for an unrelated bug.\n+    return false;\n+  }\n+\n   // YNNPACK supports transposing the inputs efficiently if possible (they will\n   // fuse with dot packing), but we don't currently support generating the\n   // necessary transposes."
        }
    ],
    "stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
    }
}