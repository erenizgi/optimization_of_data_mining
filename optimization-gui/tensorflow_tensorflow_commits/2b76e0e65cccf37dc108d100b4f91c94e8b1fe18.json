{
    "author": "olegshyshkov",
    "message": "[XLA:GPU] Use HloHardwareIndependentTestBase::CreateDefaultDeviceAssignment.\n\nPiperOrigin-RevId: 839349267",
    "sha": "2b76e0e65cccf37dc108d100b4f91c94e8b1fe18",
    "files": [
        {
            "sha": "fd0c8ac3357594f118831832399e64b33a1a6628",
            "filename": "third_party/xla/xla/tests/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2b76e0e65cccf37dc108d100b4f91c94e8b1fe18/third_party%2Fxla%2Fxla%2Ftests%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2b76e0e65cccf37dc108d100b4f91c94e8b1fe18/third_party%2Fxla%2Fxla%2Ftests%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2FBUILD?ref=2b76e0e65cccf37dc108d100b4f91c94e8b1fe18",
            "patch": "@@ -3007,14 +3007,12 @@ xla_test(\n         \":literal_test_util\",\n         \":test_utils\",\n         \":xla_internal_test_main\",\n-        \"//xla:array\",\n         \"//xla:error_spec\",\n         \"//xla:literal\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/parser:hlo_parser\",\n         \"//xla/hlo/testlib:verified_hlo_module\",\n-        \"//xla/service:computation_placer_hdr\",\n         \"//xla/service:hlo_module_config\",\n         \"//xla/service:hlo_runner\",\n         \"//xla/service/gpu:backend_configs_cc\","
        },
        {
            "sha": "708ea93373f29c2dc0fc08cefd34d3a5889ebaf9",
            "filename": "third_party/xla/xla/tests/collective_ops_e2e_test_base.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2b76e0e65cccf37dc108d100b4f91c94e8b1fe18/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test_base.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2b76e0e65cccf37dc108d100b4f91c94e8b1fe18/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test_base.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test_base.cc?ref=2b76e0e65cccf37dc108d100b4f91c94e8b1fe18",
            "patch": "@@ -22,13 +22,11 @@ limitations under the License.\n #include <utility>\n #include <vector>\n \n-#include \"absl/functional/any_invocable.h\"\n #include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/string_view.h\"\n-#include \"absl/types/span.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n@@ -147,7 +145,7 @@ CollectiveOpsE2ETestBase::ExecuteReplicated(\n   CHECK(num_partitions > 0 && \"expect at least one partition\");\n \n   DeviceAssignment device_assignment =\n-      MakeDeviceAssignment(num_replicas, num_partitions);\n+      GetDefaultDeviceAssignment(num_replicas, num_partitions);\n   int64_t num_devices = num_replicas * num_partitions;\n \n   CHECK(num_devices == arguments.size() &&"
        },
        {
            "sha": "a825106360f409c24310e74f72feaf8ab3b88eca",
            "filename": "third_party/xla/xla/tests/collective_ops_e2e_test_base.h",
            "status": "modified",
            "additions": 0,
            "deletions": 17,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2b76e0e65cccf37dc108d100b4f91c94e8b1fe18/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test_base.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2b76e0e65cccf37dc108d100b4f91c94e8b1fe18/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test_base.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_e2e_test_base.h?ref=2b76e0e65cccf37dc108d100b4f91c94e8b1fe18",
            "patch": "@@ -20,19 +20,15 @@ limitations under the License.\n #include <memory>\n #include <vector>\n \n-#include \"absl/functional/any_invocable.h\"\n #include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/string_view.h\"\n-#include \"absl/types/span.h\"\n-#include \"xla/array.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n #include \"xla/literal.h\"\n #include \"xla/service/backend.h\"\n-#include \"xla/service/computation_placer.h\"\n #include \"xla/service/gpu/backend_configs.pb.h\"\n #include \"xla/service/hlo_runner.h\"\n #include \"xla/service/hlo_runner_interface.h\"\n@@ -78,19 +74,6 @@ class CollectiveOpsE2ETestBase : public HloHardwareIndependentTestBase {\n            Capability().cuda_compute_capability()->IsAtLeastHopper();\n   }\n \n-  // Makes an iota device assignment.\n-  DeviceAssignment MakeDeviceAssignment(int64_t num_replicas,\n-                                        int64_t num_partitions = 1) {\n-    DeviceAssignment assn(/*replica_count=*/num_replicas,\n-                          /*computation_count=*/num_partitions);\n-    for (int64_t i = 0; i < num_replicas; ++i) {\n-      for (int64_t j = 0; j < num_partitions; ++j) {\n-        assn(i, j) = i * num_partitions + j;\n-      }\n-    }\n-    return assn;\n-  }\n-\n  protected:\n   std::unique_ptr<HloRunner> hlo_runner_;\n   std::unique_ptr<HloRunner> reference_hlo_runner_;"
        },
        {
            "sha": "4e1d2037ec253a575039d7104feb5978bd5e43aa",
            "filename": "third_party/xla/xla/tests/collective_ops_sharded_unsharded_e2e_test.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/2b76e0e65cccf37dc108d100b4f91c94e8b1fe18/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_sharded_unsharded_e2e_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/2b76e0e65cccf37dc108d100b4f91c94e8b1fe18/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_sharded_unsharded_e2e_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fcollective_ops_sharded_unsharded_e2e_test.cc?ref=2b76e0e65cccf37dc108d100b4f91c94e8b1fe18",
            "patch": "@@ -26,14 +26,12 @@ limitations under the License.\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/string_view.h\"\n #include \"absl/types/span.h\"\n-#include \"xla/array.h\"\n #include \"xla/error_spec.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_sharding.h\"\n #include \"xla/hlo/parser/hlo_parser.h\"\n #include \"xla/hlo/testlib/verified_hlo_module.h\"\n #include \"xla/literal.h\"\n-#include \"xla/service/computation_placer.h\"\n #include \"xla/service/gpu/backend_configs.pb.h\"\n #include \"xla/service/hlo_module_config.h\"\n #include \"xla/service/hlo_runner.h\""
        }
    ],
    "stats": {
        "total": 25,
        "additions": 1,
        "deletions": 24
    }
}