{
    "author": "tensorflower-gardener",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 834142800",
    "sha": "7d2055700fa7b793329d9e720affc25921d30e68",
    "files": [
        {
            "sha": "1144ddb78c7cdfa1473062a69717faea4c70b9af",
            "filename": "tensorflow/core/ops/compat/op_compatibility_lib.cc",
            "status": "modified",
            "additions": 23,
            "deletions": 22,
            "changes": 45,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/7d2055700fa7b793329d9e720affc25921d30e68/tensorflow%2Fcore%2Fops%2Fcompat%2Fop_compatibility_lib.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/7d2055700fa7b793329d9e720affc25921d30e68/tensorflow%2Fcore%2Fops%2Fcompat%2Fop_compatibility_lib.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fops%2Fcompat%2Fop_compatibility_lib.cc?ref=7d2055700fa7b793329d9e720affc25921d30e68",
            "patch": "@@ -27,19 +27,19 @@ limitations under the License.\n \n namespace tensorflow {\n \n-static string OpsHistoryDirectory(const string& ops_prefix,\n-                                  const string& history_version) {\n+static std::string OpsHistoryDirectory(const std::string& ops_prefix,\n+                                       const std::string& history_version) {\n   return io::JoinPath(ops_prefix,\n                       absl::StrCat(\"compat/ops_history_\", history_version));\n }\n \n-static string OpsHistoryFile(const string& ops_prefix,\n-                             const string& history_version) {\n+static std::string OpsHistoryFile(const std::string& ops_prefix,\n+                                  const std::string& history_version) {\n   return io::JoinPath(ops_prefix, absl::StrCat(\"compat/ops_history.\",\n                                                history_version, \".pbtxt\"));\n }\n \n-static string FileNameFromOpName(const string& op_name) {\n+static std::string FileNameFromOpName(const std::string& op_name) {\n   return absl::StrCat(op_name, \".pbtxt\");\n }\n \n@@ -51,23 +51,24 @@ static void AddNewOpToHistory(const OpDef& op,\n   }\n }\n \n-static absl::Status ReadOpHistory(Env* env, const string& file,\n-                                  const string& directory,\n+static absl::Status ReadOpHistory(Env* env, const std::string& file,\n+                                  const std::string& directory,\n                                   OpCompatibilityLib::OpHistory* out) {\n   // Read op history form `directory` if it exists there.\n-  std::vector<string> matching_files;\n+  std::vector<std::string> matching_files;\n   absl::Status status = env->GetMatchingPaths(\n       io::JoinPath(directory, \"*.pbtxt\"), &matching_files);\n   if (status.ok() && !matching_files.empty()) {\n     printf(\"Reading op history from %s/*.pbtxt...\\n\", directory.c_str());\n     std::sort(matching_files.begin(), matching_files.end());\n-    for (const string& full_file : matching_files) {\n-      string op_history_str;\n+    for (const std::string& full_file : matching_files) {\n+      std::string op_history_str;\n       TF_RETURN_IF_ERROR(ReadFileToString(env, full_file, &op_history_str));\n       OpList in_op_history;\n       protobuf::TextFormat::ParseFromString(op_history_str, &in_op_history);\n-      const string file_tail = FileNameFromOpName(in_op_history.op(0).name());\n-      const string expected = io::JoinPath(directory, file_tail);\n+      const std::string file_tail =\n+          FileNameFromOpName(in_op_history.op(0).name());\n+      const std::string expected = io::JoinPath(directory, file_tail);\n       if (full_file != expected) {\n         return errors::Internal(\"Expected file paths to match but '\", full_file,\n                                 \"' != '\", expected, \"'\");\n@@ -76,7 +77,7 @@ static absl::Status ReadOpHistory(Env* env, const string& file,\n     }\n   } else {  // Otherwise, fall back to reading op history from `file`.\n     printf(\"Reading op history from %s...\\n\", file.c_str());\n-    string op_history_str;\n+    std::string op_history_str;\n     TF_RETURN_IF_ERROR(ReadFileToString(env, file, &op_history_str));\n     OpList in_op_history;\n     protobuf::TextFormat::ParseFromString(op_history_str, &in_op_history);\n@@ -98,9 +99,9 @@ static absl::Status ReadOpHistory(Env* env, const string& file,\n   return absl::OkStatus();\n }\n \n-OpCompatibilityLib::OpCompatibilityLib(const string& ops_prefix,\n-                                       const string& history_version,\n-                                       const std::set<string>* stable_ops)\n+OpCompatibilityLib::OpCompatibilityLib(const std::string& ops_prefix,\n+                                       const std::string& history_version,\n+                                       const std::set<std::string>* stable_ops)\n     : ops_file_(io::JoinPath(ops_prefix, \"ops.pbtxt\")),\n       op_history_file_(OpsHistoryFile(ops_prefix, history_version)),\n       op_history_directory_(OpsHistoryDirectory(ops_prefix, history_version)),\n@@ -121,12 +122,12 @@ absl::Status OpCompatibilityLib::ValidateCompatible(Env* env, int* changed_ops,\n \n   if (stable_ops_ != nullptr) {\n     printf(\"Verifying no stable ops have been removed...\\n\");\n-    std::vector<string> removed;\n+    std::vector<std::string> removed;\n     // We rely on stable_ops_ and op_list_ being in sorted order.\n     auto iter = stable_ops_->begin();\n     for (int cur = 0; iter != stable_ops_->end() && cur < op_list_.op_size();\n          ++cur) {\n-      const string& op_name = op_list_.op(cur).name();\n+      const std::string& op_name = op_list_.op(cur).name();\n       while (op_name > *iter) {\n         removed.push_back(*iter);\n         ++iter;\n@@ -156,9 +157,9 @@ absl::Status OpCompatibilityLib::ValidateCompatible(Env* env, int* changed_ops,\n   // Within the OplList it has versions in oldest-first order.\n   while (cur < op_list_.op_size() && hist < in_op_history.size()) {\n     const OpDef& cur_op = op_list_.op(cur);\n-    const string& cur_op_name = cur_op.name();\n+    const std::string& cur_op_name = cur_op.name();\n     const OpList& history_op_list = in_op_history[hist].second;\n-    const string& history_op_name = history_op_list.op(0).name();\n+    const std::string& history_op_name = history_op_list.op(0).name();\n     if (stable_ops_ != nullptr && stable_ops_->count(cur_op_name) == 0) {\n       // Ignore unstable op.\n       for (++cur; cur < op_list_.op_size(); ++cur) {\n@@ -188,7 +189,7 @@ absl::Status OpCompatibilityLib::ValidateCompatible(Env* env, int* changed_ops,\n       const int end = history_op_list.op_size();\n       // Is the last op in the history the same as the current op?\n       // Compare using their serialized representations.\n-      string history_str, cur_str;\n+      std::string history_str, cur_str;\n       history_op_list.op(end - 1).SerializeToString(&history_str);\n       cur_op.SerializeToString(&cur_str);\n \n@@ -232,7 +233,7 @@ absl::Status OpCompatibilityLib::ValidateCompatible(Env* env, int* changed_ops,\n \n   // Add remaining new ops.\n   for (; cur < op_list_.op_size(); ++cur) {\n-    const string& op_name = op_list_.op(cur).name();\n+    const std::string& op_name = op_list_.op(cur).name();\n     if (stable_ops_ != nullptr && stable_ops_->count(op_name) == 0) {\n       // Ignore unstable op.\n     } else {"
        },
        {
            "sha": "829c152a8cb5c5bf06dc29529747b454e685d846",
            "filename": "tensorflow/core/ops/compat/op_compatibility_lib.h",
            "status": "modified",
            "additions": 15,
            "deletions": 12,
            "changes": 27,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/7d2055700fa7b793329d9e720affc25921d30e68/tensorflow%2Fcore%2Fops%2Fcompat%2Fop_compatibility_lib.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/7d2055700fa7b793329d9e720affc25921d30e68/tensorflow%2Fcore%2Fops%2Fcompat%2Fop_compatibility_lib.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fops%2Fcompat%2Fop_compatibility_lib.h?ref=7d2055700fa7b793329d9e720affc25921d30e68",
            "patch": "@@ -33,27 +33,30 @@ class OpCompatibilityLib {\n   //   If stable_ops == nullptr, we use all registered ops.\n   //   Otherwise ValidateCompatible() ignores ops not in *stable_ops\n   //   and require all ops in *stable_ops to exist.\n-  OpCompatibilityLib(const string& ops_prefix, const string& history_version,\n-                     const std::set<string>* stable_ops);\n+  OpCompatibilityLib(const std::string& ops_prefix,\n+                     const std::string& history_version,\n+                     const std::set<std::string>* stable_ops);\n \n   // Name of the file that contains the checked-in versions of *all*\n   // ops, with docs.\n-  const string& ops_file() const { return ops_file_; }\n+  const std::string& ops_file() const { return ops_file_; }\n \n   // Name of the file that contains all versions of *stable* ops,\n   // without docs.  Op history is in (alphabetical, oldest-first)\n   // order.\n-  const string& op_history_file() const { return op_history_file_; }\n+  const std::string& op_history_file() const { return op_history_file_; }\n \n   // Name of the directory that contains all versions of *stable* ops,\n   // without docs.  Op history is one file per op, in oldest-first\n   // order within the file.\n-  const string& op_history_directory() const { return op_history_directory_; }\n+  const std::string& op_history_directory() const {\n+    return op_history_directory_;\n+  }\n \n   // Should match the contents of ops_file().  Run before calling\n   // ValidateCompatible().\n-  string OpsString() const {\n-    string result;\n+  std::string OpsString() const {\n+    std::string result;\n     google::protobuf::TextFormat::PrintToString(op_list_, &result);\n     return result;\n   }\n@@ -63,7 +66,7 @@ class OpCompatibilityLib {\n   int num_all_ops() const { return op_list_.op_size(); }\n \n   // <file name, file contents> pairs representing op history.\n-  typedef std::vector<std::pair<string, OpList>> OpHistory;\n+  typedef std::vector<std::pair<std::string, OpList>> OpHistory;\n \n   // Make sure the current version of the *stable* ops are compatible\n   // with the historical versions, and if out_op_history != nullptr,\n@@ -74,10 +77,10 @@ class OpCompatibilityLib {\n                                   OpHistory* out_op_history);\n \n  private:\n-  const string ops_file_;\n-  const string op_history_file_;\n-  const string op_history_directory_;\n-  const std::set<string>* stable_ops_;\n+  const std::string ops_file_;\n+  const std::string op_history_file_;\n+  const std::string op_history_directory_;\n+  const std::set<std::string>* stable_ops_;\n   OpList op_list_;\n };\n "
        },
        {
            "sha": "b1a1e93e8fa9255be67c5b41a336a652b7e0b6f8",
            "filename": "tensorflow/core/ops/compat/update_ops_main.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/7d2055700fa7b793329d9e720affc25921d30e68/tensorflow%2Fcore%2Fops%2Fcompat%2Fupdate_ops_main.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/7d2055700fa7b793329d9e720affc25921d30e68/tensorflow%2Fcore%2Fops%2Fcompat%2Fupdate_ops_main.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fops%2Fcompat%2Fupdate_ops_main.cc?ref=7d2055700fa7b793329d9e720affc25921d30e68",
            "patch": "@@ -30,14 +30,14 @@ limitations under the License.\n namespace tensorflow {\n namespace {\n \n-void WriteUpdateTo(const string& directory) {\n+void WriteUpdateTo(const std::string& directory) {\n   OpCompatibilityLib compatibility(\n       directory, absl::StrCat(\"v\", TF_MAJOR_VERSION), nullptr);\n \n   // Write full copy of all ops to ops.pbtxt.\n   Env* env = Env::Default();\n   {\n-    const string& ops_file = compatibility.ops_file();\n+    const std::string& ops_file = compatibility.ops_file();\n     printf(\"Writing ops to %s...\\n\", ops_file.c_str());\n     TF_QCHECK_OK(WriteStringToFile(env, ops_file, compatibility.OpsString()));\n   }\n@@ -52,7 +52,7 @@ void WriteUpdateTo(const string& directory) {\n                                                 &out_op_history));\n   printf(\"%d changed ops\\n%d added ops\\n\", changed_ops, added_ops);\n \n-  const string& history_dir = compatibility.op_history_directory();\n+  const std::string& history_dir = compatibility.op_history_directory();\n   absl::Status status = env->CreateDir(history_dir);\n   if (!absl::IsAlreadyExists(status)) {\n     TF_QCHECK_OK(status);"
        }
    ],
    "stats": {
        "total": 78,
        "additions": 41,
        "deletions": 37
    }
}