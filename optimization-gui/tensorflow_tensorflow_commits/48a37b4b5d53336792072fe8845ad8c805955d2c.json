{
    "author": "beckerhe",
    "message": "Protobuf dependency cleanup\n\nPiperOrigin-RevId: 812731794",
    "sha": "48a37b4b5d53336792072fe8845ad8c805955d2c",
    "files": [
        {
            "sha": "b49f93f9938373a850b36ccdc25db57e2daffc11",
            "filename": "tensorflow/core/common_runtime/optimized_function_graph_info_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/tensorflow%2Fcore%2Fcommon_runtime%2Foptimized_function_graph_info_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/tensorflow%2Fcore%2Fcommon_runtime%2Foptimized_function_graph_info_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fcommon_runtime%2Foptimized_function_graph_info_test.cc?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -131,7 +131,7 @@ TEST(OptimizedFunctionGraphUtilsTest,\n      FromProtoProducesReturnsErrorIfGraphInvalid) {\n   OptimizedFunctionGraph proto;\n   // Invalid proto because no device specified for node B.\n-  proto2::TextFormat::ParseFromString(\n+  google::protobuf::TextFormat::ParseFromString(\n       R\"pb(\n         name: \"test_func\",\n         function_graph { node { name: 'B' op: 'OneOutput' } $0 }\n@@ -146,7 +146,7 @@ TEST(OptimizedFunctionGraphUtilsTest,\n \n TEST(OptimizedFunctionGraphUtilsTest, FromProtoProducesCorrectResult) {\n   OptimizedFunctionGraph proto;\n-  proto2::TextFormat::ParseFromString(\n+  google::protobuf::TextFormat::ParseFromString(\n       absl::Substitute(\n           R\"pb(\n             name: \"test_func\",\n@@ -192,7 +192,7 @@ TEST(OptimizedFunctionGraphUtilsTest, FromProtoProducesCorrectResult) {\n TEST(OptimizedFunctionGraphUtilsTest,\n      FromProtoProducesCorrectResultWithFunctionCall) {\n   OptimizedFunctionGraph proto;\n-  proto2::TextFormat::ParseFromString(\n+  google::protobuf::TextFormat::ParseFromString(\n       absl::Substitute(\n           R\"pb(\n             name: \"test_func\","
        },
        {
            "sha": "1712b5769d55b97ddb2f11d808e4361c22790c85",
            "filename": "tensorflow/core/grappler/mutable_graph_view.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/tensorflow%2Fcore%2Fgrappler%2Fmutable_graph_view.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/tensorflow%2Fcore%2Fgrappler%2Fmutable_graph_view.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fgrappler%2Fmutable_graph_view.cc?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -340,7 +340,7 @@ string GeneratedNameForIdentityConsumingSwitch(\n }\n \n string PrintInTextFormat(const protobuf::MessageLite& message) {\n-  // Unfortunately proto2::TextFormat::Printer::PrintToString does not have\n+  // Unfortunately google::protobuf::TextFormat::Printer::PrintToString does not have\n   // a overload for MessageLite so here we have to use\n   // MessageLite::ShortDebugString.\n   return message.ShortDebugString();"
        },
        {
            "sha": "4ef6d8fff392be8b5f5e458c9cb7ff6217e95b7e",
            "filename": "tensorflow/core/ir/importexport/mangling.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/tensorflow%2Fcore%2Fir%2Fimportexport%2Fmangling.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/tensorflow%2Fcore%2Fir%2Fimportexport%2Fmangling.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fir%2Fimportexport%2Fmangling.cc?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -47,7 +47,7 @@ const char kTensorPrefix[] = \"tftensor$\";\n \n std::string PrintShortTextProto(\n     const ::tensorflow::protobuf::MessageLite& message) {\n-  // proto2::TextFormat::Printer::PrintToString does not have\n+  // google::protobuf::TextFormat::Printer::PrintToString does not have\n   // a overload for MessageLite so here to be consistent with the existing\n   // behavior we use MessageLite::ShortDebugString().\n   return message.ShortDebugString();"
        },
        {
            "sha": "07345ec3dad3d790794eddb0adba01f3fcd13da4",
            "filename": "third_party/xla/third_party/tsl/tsl/platform/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fthird_party%2Ftsl%2Ftsl%2Fplatform%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fthird_party%2Ftsl%2Ftsl%2Fplatform%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Ftsl%2Ftsl%2Fplatform%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -203,6 +203,7 @@ cc_library(\n     hdrs = [\"protobuf.h\"],\n     deps = [\n         \":platform\",\n+        \":tstring\",\n         \"@local_xla//xla/tsl/platform:types\",\n     ] + tsl_protobuf_deps(),\n )\n@@ -1330,7 +1331,7 @@ tsl_cc_test(\n         \":platform_port\",\n         \"@com_google_googletest//:gtest_main\",\n         \"@local_xla//xla/tsl/platform:env\",\n-        \"@local_xla//xla/tsl/platform:env_impl\",\n+        \"@local_xla//xla/tsl/platform:env_time\",\n         \"@local_xla//xla/tsl/platform:test\",\n     ],\n )"
        },
        {
            "sha": "c2f8bee913bf4a0a1aa61be13feeb7775e4a9318",
            "filename": "third_party/xla/third_party/tsl/tsl/platform/protobuf.h",
            "status": "modified",
            "additions": 22,
            "deletions": 18,
            "changes": 40,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fthird_party%2Ftsl%2Ftsl%2Fplatform%2Fprotobuf.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fthird_party%2Ftsl%2Ftsl%2Fplatform%2Fprotobuf.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Ftsl%2Ftsl%2Fplatform%2Fprotobuf.h?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -16,7 +16,10 @@ limitations under the License.\n #ifndef TENSORFLOW_TSL_PLATFORM_PROTOBUF_H_\n #define TENSORFLOW_TSL_PLATFORM_PROTOBUF_H_\n \n+#include <cstddef>\n #include <cstdint>\n+#include <string>\n+#include <utility>\n \n #include \"xla/tsl/platform/types.h\"\n #include \"tsl/platform/platform.h\"\n@@ -27,24 +30,25 @@ limitations under the License.\n // TensorFlow code should use the ::tensorflow::protobuf namespace to\n // refer to all protobuf APIs.\n \n-#include \"google/protobuf/descriptor.pb.h\"         // IWYU pragma: export\n-#include \"google/protobuf/arena.h\"                // IWYU pragma: export\n-#include \"google/protobuf/descriptor.h\"           // IWYU pragma: export\n-#include \"google/protobuf/dynamic_message.h\"      // IWYU pragma: export\n-#include \"google/protobuf/io/coded_stream.h\"      // IWYU pragma: export\n-#include \"google/protobuf/io/tokenizer.h\"         // IWYU pragma: export\n-#include \"google/protobuf/io/zero_copy_stream.h\"  // IWYU pragma: export\n-#include \"google/protobuf/io/zero_copy_stream_impl_lite.h\"  // IWYU pragma: export\n-#include \"google/protobuf/map.h\"                 // IWYU pragma: export\n-#include \"google/protobuf/message.h\"             // IWYU pragma: export\n-#include \"google/protobuf/repeated_field.h\"      // IWYU pragma: export\n-#include \"google/protobuf/repeated_ptr_field.h\"  // IWYU pragma: export\n-#include \"google/protobuf/text_format.h\"         // IWYU pragma: export\n-#include \"google/protobuf/util/delimited_message_util.h\"  // IWYU pragma: export\n-#include \"google/protobuf/util/field_comparator.h\"  // IWYU pragma: export\n-#include \"google/protobuf/util/json_util.h\"         // IWYU pragma: export\n-#include \"google/protobuf/util/message_differencer.h\"  // IWYU pragma: export\n-#include \"google/protobuf/util/type_resolver_util.h\"  // IWYU pragma: export\n+#include \"google/protobuf/descriptor.pb.h\"         // IWYU pragma: keep\n+#include \"google/protobuf/arena.h\"                // IWYU pragma: keep\n+#include \"google/protobuf/descriptor.h\"           // IWYU pragma: keep\n+#include \"google/protobuf/dynamic_message.h\"      // IWYU pragma: keep\n+#include \"google/protobuf/io/coded_stream.h\"      // IWYU pragma: keep\n+#include \"google/protobuf/io/tokenizer.h\"         // IWYU pragma: keep\n+#include \"google/protobuf/io/zero_copy_stream.h\"  // IWYU pragma: keep\n+#include \"google/protobuf/io/zero_copy_stream_impl_lite.h\"  // IWYU pragma: keep\n+#include \"google/protobuf/map.h\"                 // IWYU pragma: keep\n+#include \"google/protobuf/message.h\"             // IWYU pragma: keep\n+#include \"google/protobuf/repeated_field.h\"      // IWYU pragma: keep\n+#include \"google/protobuf/repeated_ptr_field.h\"  // IWYU pragma: keep\n+#include \"google/protobuf/text_format.h\"         // IWYU pragma: keep\n+#include \"google/protobuf/util/delimited_message_util.h\"  // IWYU pragma: keep\n+#include \"google/protobuf/util/field_comparator.h\"     // IWYU pragma: keep\n+#include \"google/protobuf/util/json_util.h\"            // IWYU pragma: keep\n+#include \"google/protobuf/util/message_differencer.h\"  // IWYU pragma: keep\n+#include \"google/protobuf/util/type_resolver_util.h\"   // IWYU pragma: keep\n+#include \"tsl/platform/tstring.h\"\n \n #if !TSL_IS_IN_OSS\n #define TENSORFLOW_PROTOBUF_USES_CORD 1"
        },
        {
            "sha": "d97d6048d421a696bbfc5c8a2f1d8ae9ca6d5511",
            "filename": "third_party/xla/xla/BUILD",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -75,7 +75,7 @@ tf_proto_library(\n     protodeps = [\n         \":xla_data_proto\",\n         \"//xla/service:hlo_proto\",\n-    ] + if_google([\"@com_google_protobuf//:any\"]),\n+    ] + if_google([\"@com_google_protobuf//:any_proto\"]),\n     visibility = [\"//visibility:public\"],\n )\n \n@@ -1236,8 +1236,8 @@ cc_library(\n             \"@com_google_absl//absl/status:statusor\",\n             \"@com_google_absl//absl/strings\",\n             \"@com_google_absl//absl/strings:str_format\",\n+            \"@com_google_protobuf//:protobuf\",\n             \"@local_tsl//tsl/platform:platform_port\",\n-            \"@local_tsl//tsl/platform:protobuf\",\n         ],\n )\n \n@@ -1288,7 +1288,7 @@ xla_cc_test(\n             \"@com_google_absl//absl/status:statusor\",\n             \"@com_google_absl//absl/strings\",\n             \"@com_google_googletest//:gtest\",\n-            \"@local_tsl//tsl/platform:protobuf\",\n+            \"@com_google_protobuf//:protobuf_lite\",\n         ],\n )\n \n@@ -1340,8 +1340,8 @@ tf_proto_library(\n     protodeps = [\n         \"//xla/tsl/protobuf:dnn_proto\",\n     ] + if_google([\n-        \"@com_google_protobuf//:any\",\n-        \"@com_google_protobuf//:duration\",\n+        \"@com_google_protobuf//:any_proto\",\n+        \"@com_google_protobuf//:duration_proto\",\n     ]),\n )\n "
        },
        {
            "sha": "232375a949502f2aa2833c3362e345ccc7e203e6",
            "filename": "third_party/xla/xla/backends/autotuner/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fbackends%2Fautotuner%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fbackends%2Fautotuner%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fautotuner%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -103,7 +103,7 @@ xla_cc_test(\n tf_proto_library(\n     name = \"autotuner_cache_proto\",\n     srcs = [\"autotuner_cache.proto\"],\n-    deps = if_google([\"@com_google_protobuf//:any\"]),\n+    deps = if_google([\"@com_google_protobuf//:any_proto\"]),\n )\n \n cc_library("
        },
        {
            "sha": "a155fb9760950f61375322656609582a5cdcf61e",
            "filename": "third_party/xla/xla/backends/cpu/runtime/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -151,7 +151,7 @@ tf_proto_library(\n         \"//xla/service:buffer_assignment_proto\",\n         \"//xla:xla_data_proto\",\n         \"//xla/service:hlo_proto\",\n-    ] + if_google([\"@com_google_protobuf//:any\"]),\n+    ] + if_google([\"@com_google_protobuf//:any_proto\"]),\n     visibility = [\"//visibility:public\"],\n )\n "
        },
        {
            "sha": "424abe337d83c5e047e98725dd68c2b7b26acad9",
            "filename": "third_party/xla/xla/backends/interpreter/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 8,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fbackends%2Finterpreter%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fbackends%2Finterpreter%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Finterpreter%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -1,7 +1,3 @@\n-load(\n-    \"//xla/tsl:tsl.bzl\",\n-    \"if_google\",\n-)\n load(\"//xla/tsl/platform:rules_cc.bzl\", \"cc_library\")\n \n package(\n@@ -71,10 +67,7 @@ cc_library(\n     name = \"platform_id\",\n     srcs = [\"platform_id.cc\"],\n     hdrs = [\"platform_id.h\"],\n-    deps = [\"//xla/stream_executor:platform\"] + if_google(\n-        [\"@com_google_protobuf//:any_cc_proto\"],\n-        [\"@com_google_protobuf//:protobuf_headers\"],\n-    ),\n+    deps = [\"//xla/stream_executor:platform\"],\n )\n \n cc_library("
        },
        {
            "sha": "215d84f243e98e2b45cbc5b10177a00753cc6a70",
            "filename": "third_party/xla/xla/debug_options_flags.cc",
            "status": "modified",
            "additions": 12,
            "deletions": 11,
            "changes": 23,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fdebug_options_flags.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fdebug_options_flags.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fdebug_options_flags.cc?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -21,6 +21,7 @@ limitations under the License.\n #include <fstream>\n #include <limits>\n #include <memory>\n+#include <sstream>\n #include <string>\n #include <vector>\n \n@@ -41,6 +42,8 @@ limitations under the License.\n #include \"absl/strings/str_join.h\"\n #include \"absl/strings/str_split.h\"\n #include \"absl/strings/string_view.h\"\n+#include \"google/protobuf/descriptor.h\"\n+#include \"google/protobuf/text_format.h\"\n #include \"xla/debug_options_parsers.h\"\n #include \"xla/parse_flags_from_env.h\"\n #include \"xla/service/collective_utils.h\"\n@@ -50,7 +53,6 @@ limitations under the License.\n #include \"xla/tsl/util/command_line_flags.h\"\n #include \"xla/xla.pb.h\"\n #include \"tsl/platform/cpu_info.h\"  // NOLINT\n-#include \"tsl/platform/protobuf.h\"  // IWYU pragma: keep\n \n namespace xla {\n \n@@ -100,8 +102,7 @@ absl::StatusOr<std::vector<RepeatedFlagModifier>> ParseRepeatedEnumModifiers(\n namespace {\n \n template <typename T>\n-static auto FindRepeatedFieldValue(tsl::protobuf::RepeatedField<int>* list,\n-                                   T value) {\n+static auto FindRepeatedFieldValue(google::protobuf::RepeatedField<int>* list, T value) {\n   for (auto it = list->begin(); it != list->end(); ++it) {\n     if (*it == value) {\n       return it;\n@@ -118,7 +119,7 @@ template <typename T>\n static auto SetterForRepeatedEnum(\n     absl::string_view flag_name, absl::string_view enum_prefix,\n     bool (*enum_parser)(absl::string_view string_value, T* value),\n-    tsl::protobuf::RepeatedField<int>* mutable_array) {\n+    google::protobuf::RepeatedField<int>* mutable_array) {\n   return [flag_name, enum_prefix, enum_parser,\n           mutable_array](const std::string& input) {\n     if (input.empty()) {  // Disable all values.\n@@ -682,7 +683,7 @@ void MakeDebugOptionsFlags(std::vector<tsl::Flag>* flag_list,\n       };\n \n   auto command_types_to_string =\n-      [](tsl::protobuf::RepeatedField<int> command_types) -> std::string {\n+      [](google::protobuf::RepeatedField<int> command_types) -> std::string {\n     struct Formatter {\n       void operator()(std::string* out, int type) const {\n         absl::StrAppend(out, DebugOptions::CommandBufferCmdType_Name(type));\n@@ -737,7 +738,7 @@ void MakeDebugOptionsFlags(std::vector<tsl::Flag>* flag_list,\n   };\n \n   auto collective_op_types_to_string =\n-      [](tsl::protobuf::RepeatedField<int> collective_ops) -> std::string {\n+      [](google::protobuf::RepeatedField<int> collective_ops) -> std::string {\n     struct Formatter {\n       void operator()(std::string* out, int type) const {\n         absl::StrAppend(out, DebugOptions::CollectiveOpType_Name(type));\n@@ -848,7 +849,7 @@ void MakeDebugOptionsFlags(std::vector<tsl::Flag>* flag_list,\n       };\n \n   auto xla_gpu_generic_triton_emitter_features_to_string =\n-      [](tsl::protobuf::RepeatedField<int> values) -> std::string {\n+      [](google::protobuf::RepeatedField<int> values) -> std::string {\n     struct Formatter {\n       void operator()(std::string* out, int type) const {\n         absl::StrAppend(out,\n@@ -2576,8 +2577,8 @@ bool ParseFlagsFromDebugOptionsFile(absl::string_view filename) {\n   file_content = buffer.str();\n   file.close();\n   DebugOptions new_debug_options;\n-  tsl::protobuf::TextFormat::Parser parser;\n-  tsl::protobuf::TextFormat::ParseInfoTree tree;\n+  google::protobuf::TextFormat::Parser parser;\n+  google::protobuf::TextFormat::ParseInfoTree tree;\n   parser.WriteLocationsTo(&tree);\n   VLOG(1) << \"Debug options file contents: \" << file_content;\n   if (!parser.ParseFromString(file_content, &new_debug_options)) {\n@@ -2588,10 +2589,10 @@ bool ParseFlagsFromDebugOptionsFile(absl::string_view filename) {\n \n   // Read from new_debug_options, and overwrite the flags in debug_options that\n   // are actually mentioned in file_contents.\n-  std::vector<const tsl::protobuf::FieldDescriptor*> overwritten_fields;\n+  std::vector<const google::protobuf::FieldDescriptor*> overwritten_fields;\n   int field_count = new_debug_options.GetDescriptor()->field_count();\n   for (int i = 0; i < field_count; i++) {\n-    const tsl::protobuf::FieldDescriptor* field =\n+    const google::protobuf::FieldDescriptor* field =\n         new_debug_options.GetDescriptor()->field(i);\n     if (tree.GetLocation(field, field->is_repeated() ? 0 : -1).line != -1) {\n       VLOG(2) << \"Non default field: \" << field->name();"
        },
        {
            "sha": "5dd25afa5387ab7481c1cd27634a0549029a242d",
            "filename": "third_party/xla/xla/debug_options_parsers_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fdebug_options_parsers_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fdebug_options_parsers_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fdebug_options_parsers_test.cc?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -28,14 +28,14 @@ limitations under the License.\n #include \"absl/strings/match.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/string_view.h\"\n+#include \"google/protobuf/repeated_field.h\"\n #include \"xla/debug_options_flags.h\"\n #include \"xla/parse_flags_from_env.h\"\n #include \"xla/service/dump.h\"\n #include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/test.h\"\n #include \"xla/tsl/util/command_line_flags.h\"\n #include \"xla/xla.pb.h\"\n-#include \"tsl/platform/protobuf.h\"  // IWYU pragma: keep\n \n namespace xla {\n namespace {\n@@ -497,7 +497,7 @@ void TestLibraryFusionType(absl::string_view lib) {\n       absl::StrCat(\"--xla_cpu_experimental_\", lib, \"_fusion_type\");\n \n   {\n-    const tsl::protobuf::RepeatedField<int> enabled_types =\n+    const google::protobuf::RepeatedField<int> enabled_types =\n         lib == \"onednn\"\n             ? debug_options.xla_cpu_experimental_onednn_fusion_type()\n             : debug_options.xla_cpu_experimental_xnn_fusion_type();\n@@ -510,7 +510,7 @@ void TestLibraryFusionType(absl::string_view lib) {\n     // Overwriting the default setting.\n     SetXlaFlagsEnvVar(absl::StrCat(flag_name, \"=dot,eltwise\"));\n     ParseFlagsFromEnvAndDieIfUnknown(\"XLA_FLAGS\", flag_objects);\n-    const tsl::protobuf::RepeatedField<int> enabled_types =\n+    const google::protobuf::RepeatedField<int> enabled_types =\n         lib == \"onednn\"\n             ? debug_options.xla_cpu_experimental_onednn_fusion_type()\n             : debug_options.xla_cpu_experimental_xnn_fusion_type();\n@@ -525,7 +525,7 @@ void TestLibraryFusionType(absl::string_view lib) {\n     // Adding / removing options from the existing setting.\n     SetXlaFlagsEnvVar(absl::StrCat(flag_name, \"=+reduce,-eltwise\"));\n     ParseFlagsFromEnvAndDieIfUnknown(\"XLA_FLAGS\", flag_objects);\n-    const tsl::protobuf::RepeatedField<int> enabled_types =\n+    const google::protobuf::RepeatedField<int> enabled_types =\n         lib == \"onednn\"\n             ? debug_options.xla_cpu_experimental_onednn_fusion_type()\n             : debug_options.xla_cpu_experimental_xnn_fusion_type();"
        },
        {
            "sha": "abd7fac1ea65ca5942fa7a3218db520e657cb7a4",
            "filename": "third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_cpsat_for_request_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fauto_sharding_cpsat_for_request_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fauto_sharding_cpsat_for_request_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fauto_sharding_cpsat_for_request_test.cc?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -38,7 +38,7 @@ using CostMatrix = std::vector<std::vector<double>>;\n using NodeMatrix = std::vector<std::vector<int64_t>>;\n using EdgeMatrix = std::vector<std::vector<int64_t>>;\n \n-void AddCosts(proto2::RepeatedPtrField<AutoShardingSolverRequest_Costs>* costs,\n+void AddCosts(google::protobuf::RepeatedPtrField<AutoShardingSolverRequest_Costs>* costs,\n               const CostMatrix& cost_matrix) {\n   for (const auto& cost_row : cost_matrix) {\n     AutoShardingSolverRequest_Costs cost;\n@@ -47,7 +47,7 @@ void AddCosts(proto2::RepeatedPtrField<AutoShardingSolverRequest_Costs>* costs,\n   }\n }\n \n-void AddEdges(proto2::RepeatedPtrField<AutoShardingSolverRequest_Edges>* edges,\n+void AddEdges(google::protobuf::RepeatedPtrField<AutoShardingSolverRequest_Edges>* edges,\n               const EdgeMatrix& edge_matrix) {\n   for (const auto& edge_row : edge_matrix) {\n     AutoShardingSolverRequest_Edges edge;\n@@ -57,7 +57,7 @@ void AddEdges(proto2::RepeatedPtrField<AutoShardingSolverRequest_Edges>* edges,\n }\n \n void AddIntervals(\n-    proto2::RepeatedPtrField<AutoShardingSolverRequest_Pair>* pairs,\n+    google::protobuf::RepeatedPtrField<AutoShardingSolverRequest_Pair>* pairs,\n     const std::vector<std::pair<int64_t, int64_t>>& intervals) {\n   for (const auto& interval : intervals) {\n     AutoShardingSolverRequest_Pair pair;\n@@ -68,7 +68,7 @@ void AddIntervals(\n }\n \n void AddGroups(\n-    proto2::RepeatedPtrField<AutoShardingSolverRequest_Group>* groups,\n+    google::protobuf::RepeatedPtrField<AutoShardingSolverRequest_Group>* groups,\n     const std::vector<std::vector<int64_t>>& reduced_groups) {\n   for (const auto& reduced_group : reduced_groups) {\n     AutoShardingSolverRequest_Group group;"
        },
        {
            "sha": "56f02d37428d59bc71880d7974a2da23efe8e0b2",
            "filename": "third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_memory_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fauto_sharding_memory_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fauto_sharding_memory_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fauto_sharding_memory_test.cc?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -32,7 +32,7 @@ namespace {\n std::function<tsl::protobuf::RepeatedField<int64_t>(int64_t)>  // NOLINT\n Convert(const std::vector<std::vector<int64_t>>& live) {\n   return [live](int64_t live_idx) {\n-    return ::proto2::RepeatedField<int64_t>(live[live_idx].begin(),  // NOLINT\n+    return ::google::protobuf::RepeatedField<int64_t>(live[live_idx].begin(),  // NOLINT\n                                             live[live_idx].end());\n   };\n }"
        },
        {
            "sha": "82891d75e78fae787980efb628603d6780e7fa0e",
            "filename": "third_party/xla/xla/hlo/experimental/auto_sharding/auto_sharding_solver_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fauto_sharding_solver_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fauto_sharding_solver_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fexperimental%2Fauto_sharding%2Fauto_sharding_solver_test.cc?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -34,7 +34,7 @@ using CostMatrix = std::vector<std::vector<double>>;\n using NodeMatrix = std::vector<std::vector<int64_t>>;\n using EdgeMatrix = std::vector<std::vector<int64_t>>;\n \n-void AddCosts(proto2::RepeatedPtrField<AutoShardingSolverRequest_Costs>* costs,\n+void AddCosts(google::protobuf::RepeatedPtrField<AutoShardingSolverRequest_Costs>* costs,\n               const CostMatrix& cost_matrix) {\n   for (const auto& cost_row : cost_matrix) {\n     AutoShardingSolverRequest_Costs cost;\n@@ -43,7 +43,7 @@ void AddCosts(proto2::RepeatedPtrField<AutoShardingSolverRequest_Costs>* costs,\n   }\n }\n \n-void AddEdges(proto2::RepeatedPtrField<AutoShardingSolverRequest_Edges>* edges,\n+void AddEdges(google::protobuf::RepeatedPtrField<AutoShardingSolverRequest_Edges>* edges,\n               const EdgeMatrix& edge_matrix) {\n   for (const auto& edge_row : edge_matrix) {\n     AutoShardingSolverRequest_Edges edge;\n@@ -53,7 +53,7 @@ void AddEdges(proto2::RepeatedPtrField<AutoShardingSolverRequest_Edges>* edges,\n }\n \n void AddIntervals(\n-    proto2::RepeatedPtrField<AutoShardingSolverRequest_Pair>* pairs,\n+    google::protobuf::RepeatedPtrField<AutoShardingSolverRequest_Pair>* pairs,\n     const std::vector<std::pair<int64_t, int64_t>>& intervals) {\n   for (const auto& interval : intervals) {\n     AutoShardingSolverRequest_Pair pair;\n@@ -64,7 +64,7 @@ void AddIntervals(\n }\n \n void AddGroups(\n-    proto2::RepeatedPtrField<AutoShardingSolverRequest_Group>* groups,\n+    google::protobuf::RepeatedPtrField<AutoShardingSolverRequest_Group>* groups,\n     const std::vector<std::vector<int64_t>>& reduced_groups) {\n   for (const auto& reduced_group : reduced_groups) {\n     AutoShardingSolverRequest_Group group;"
        },
        {
            "sha": "3dc78fc5dc4b8d613c65691f13de07376b0d337e",
            "filename": "third_party/xla/xla/pjrt/proto/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fpjrt%2Fproto%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fpjrt%2Fproto%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fproto%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -59,5 +59,5 @@ tf_proto_library(\n     srcs = [\"topology_description.proto\"],\n     compatible_with = (get_compatible_with_libtpu_portable() + get_compatible_with_portable()),\n     visibility = [\"//visibility:public\"],\n-    deps = if_google([\"@com_google_protobuf//:any\"]),\n+    deps = if_google([\"@com_google_protobuf//:any_proto\"]),\n )"
        },
        {
            "sha": "878c5b3e5547bbf810bf69485a33ecbb1595d1a1",
            "filename": "third_party/xla/xla/python/ifrt_proxy/common/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fpython%2Fifrt_proxy%2Fcommon%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fpython%2Fifrt_proxy%2Fcommon%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt_proxy%2Fcommon%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -83,7 +83,7 @@ tf_proto_library(\n     srcs = [\"ifrt_service.proto\"],\n     protodeps = [\n         \":types_proto\",\n-        # copybara:uncomment \"@com_google_protobuf//:any\",\n+        # copybara:uncomment \"@com_google_protobuf//:any_proto\",\n         \"//xla:xla_data_proto\",\n         \"//xla/pjrt/proto:execute_options_proto\",\n         \"//xla/python/ifrt:array_spec_proto\","
        },
        {
            "sha": "74d1fee60467ba10cd8514684324da6b3d67e96e",
            "filename": "third_party/xla/xla/python/pjrt_ifrt/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -65,7 +65,7 @@ tf_proto_library(\n     srcs = [\"xla_host_callback.proto\"],\n     protodeps = [\n         \"//xla:xla_data_proto\",\n-    ] + if_google([\"@com_google_protobuf//:any\"]),\n+    ] + if_google([\"@com_google_protobuf//:any_proto\"]),\n )\n \n tf_proto_library("
        },
        {
            "sha": "fc212c966a86ddb6e3212195ecbaca28b9f8e182",
            "filename": "third_party/xla/xla/service/BUILD",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -51,7 +51,7 @@ tf_proto_library(\n     protodeps = [\n         \"//xla:xla_data_proto\",\n         \"//xla/service:metrics_proto\",\n-    ] + if_google([\"@com_google_protobuf//:any\"]),\n+    ] + if_google([\"@com_google_protobuf//:any_proto\"]),\n     visibility = [\"//visibility:public\"],\n )\n \n@@ -78,9 +78,9 @@ tf_proto_library(\n     srcs = [\"metrics.proto\"],\n     make_default_target_header_only = True,\n     protodeps = if_google([\n-        \"@com_google_protobuf//:any\",\n-        \"@com_google_protobuf//:duration\",\n-        \"@com_google_protobuf//:timestamp\",\n+        \"@com_google_protobuf//:any_proto\",\n+        \"@com_google_protobuf//:duration_proto\",\n+        \"@com_google_protobuf//:timestamp_proto\",\n     ]),\n     visibility = [\"//visibility:public\"],\n )\n@@ -6030,7 +6030,7 @@ tf_proto_library(\n     protodeps = [\n         \":hlo_proto\",\n         \"//xla/tsl/protobuf:status_proto\",\n-    ] + if_google([\"@com_google_protobuf//:duration\"]),\n+    ] + if_google([\"@com_google_protobuf//:duration_proto\"]),\n     visibility = [\"//visibility:public\"],\n )\n "
        },
        {
            "sha": "5e50485deca60f37baa30b707dbab97a31995fdd",
            "filename": "third_party/xla/xla/tsl/protobuf/BUILD",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Ftsl%2Fprotobuf%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/48a37b4b5d53336792072fe8845ad8c805955d2c/third_party%2Fxla%2Fxla%2Ftsl%2Fprotobuf%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fprotobuf%2FBUILD?ref=48a37b4b5d53336792072fe8845ad8c805955d2c",
            "patch": "@@ -29,8 +29,8 @@ tf_proto_library(\n     srcs = [\"test_log.proto\"],\n     make_default_target_header_only = True,\n     protodeps = if_google([\n-        \"@com_google_protobuf//:any\",\n-        \"@com_google_protobuf//:wrappers\",\n+        \"@com_google_protobuf//:any_proto\",\n+        \"@com_google_protobuf//:wrappers_proto\",\n     ]),\n     visibility = [\"//visibility:public\"],\n )\n@@ -39,7 +39,7 @@ tf_proto_library(\n     name = \"dnn_proto\",\n     srcs = [\"dnn.proto\"],\n     make_default_target_header_only = True,\n-    protodeps = if_google([\"@com_google_protobuf//:wrappers\"]),\n+    protodeps = if_google([\"@com_google_protobuf//:wrappers_proto\"]),\n     visibility = [\"//visibility:public\"],\n )\n \n@@ -73,7 +73,7 @@ tf_proto_library(\n     create_java_proto = False,\n     create_kotlin_proto = False,\n     create_service = True,\n-    protodeps = if_google([\"@com_google_protobuf//:any\"]),\n+    protodeps = if_google([\"@com_google_protobuf//:any_proto\"]),\n     visibility = [\"//visibility:public\"],\n )\n \n@@ -103,7 +103,7 @@ tf_proto_library(\n     name = \"error_codes_proto_impl\",\n     srcs = [\"error_codes.proto\"],\n     make_default_target_header_only = True,\n-    protodeps = if_google([\"@com_google_protobuf//:any\"]),\n+    protodeps = if_google([\"@com_google_protobuf//:any_proto\"]),\n     visibility = [\"//visibility:public\"],\n )\n \n@@ -123,6 +123,6 @@ tf_proto_library(\n         \":rpc_options_proto\",\n         \":status_proto\",\n         \":test_log_proto\",\n-    ] + if_google([\"@com_google_protobuf//:any\"]),\n+    ] + if_google([\"@com_google_protobuf//:any_proto\"]),\n     visibility = [\"//visibility:public\"],\n )"
        }
    ],
    "stats": {
        "total": 153,
        "additions": 76,
        "deletions": 77
    }
}