{
    "author": "tensorflower-gardener",
    "message": "Disable HDF5 plugin loading when importing h5py in Tensorflow.\n\nSet the HDF5_PLUGIN_PATH environment variable to \"disable\" before importing h5py to prevent the loading of external HDF5 plugins.\n\nPiperOrigin-RevId: 844896565",
    "sha": "46e7f7fb144fd11cf6d17c23dd47620328d77082",
    "files": [
        {
            "sha": "4206ef9f882ffc2f5ce9b633a59005f9d25c028e",
            "filename": "tensorflow/python/keras/engine/training.py",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/46e7f7fb144fd11cf6d17c23dd47620328d77082/tensorflow%2Fpython%2Fkeras%2Fengine%2Ftraining.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/46e7f7fb144fd11cf6d17c23dd47620328d77082/tensorflow%2Fpython%2Fkeras%2Fengine%2Ftraining.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fkeras%2Fengine%2Ftraining.py?ref=46e7f7fb144fd11cf6d17c23dd47620328d77082",
            "patch": "@@ -83,6 +83,9 @@\n \n # pylint: disable=g-import-not-at-top\n try:\n+  # Disable loading HDF5 plugins from a default path and prevent ZDI-CAN-25480.\n+  # Importing h5py prior to importing tensorflow will restore the old behavior.\n+  os.environ['HDF5_PLUGIN_PATH'] = 'disable'\n   import h5py\n except ImportError:\n   h5py = None"
        },
        {
            "sha": "1a44e6b76f3276f954100002a55e3ec2b10341a2",
            "filename": "tensorflow/python/keras/keras_parameterized.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/46e7f7fb144fd11cf6d17c23dd47620328d77082/tensorflow%2Fpython%2Fkeras%2Fkeras_parameterized.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/46e7f7fb144fd11cf6d17c23dd47620328d77082/tensorflow%2Fpython%2Fkeras%2Fkeras_parameterized.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fkeras%2Fkeras_parameterized.py?ref=46e7f7fb144fd11cf6d17c23dd47620328d77082",
            "patch": "@@ -17,6 +17,7 @@\n import collections\n import functools\n import itertools\n+import os\n import unittest\n \n from absl.testing import parameterized\n@@ -30,6 +31,9 @@\n from tensorflow.python.util import nest\n \n try:\n+  # Disable loading HDF5 plugins from a default path and prevent ZDI-CAN-25480.\n+  # Importing h5py prior to importing tensorflow will restore the old behavior.\n+  os.environ['HDF5_PLUGIN_PATH'] = 'disable'\n   import h5py  # pylint:disable=g-import-not-at-top\n except ImportError:\n   h5py = None"
        },
        {
            "sha": "05a2c9282909a2525cf8e6dca5ad7483d1b2e5c8",
            "filename": "tensorflow/python/keras/saving/hdf5_format.py",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/46e7f7fb144fd11cf6d17c23dd47620328d77082/tensorflow%2Fpython%2Fkeras%2Fsaving%2Fhdf5_format.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/46e7f7fb144fd11cf6d17c23dd47620328d77082/tensorflow%2Fpython%2Fkeras%2Fsaving%2Fhdf5_format.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fkeras%2Fsaving%2Fhdf5_format.py?ref=46e7f7fb144fd11cf6d17c23dd47620328d77082",
            "patch": "@@ -34,6 +34,9 @@\n \n # pylint: disable=g-import-not-at-top\n try:\n+  # Disable loading HDF5 plugins from a default path and prevent ZDI-CAN-25480.\n+  # Importing h5py prior to importing tensorflow will restore the old behavior.\n+  os.environ['HDF5_PLUGIN_PATH'] = 'disable'\n   import h5py\n   HDF5_OBJECT_HEADER_LIMIT = 64512\n except ImportError:"
        },
        {
            "sha": "b9ba0bc20d0ba0e11cd9b3ebdcb94a3fe6345b2c",
            "filename": "tensorflow/python/keras/saving/save.py",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/46e7f7fb144fd11cf6d17c23dd47620328d77082/tensorflow%2Fpython%2Fkeras%2Fsaving%2Fsave.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/46e7f7fb144fd11cf6d17c23dd47620328d77082/tensorflow%2Fpython%2Fkeras%2Fsaving%2Fsave.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fkeras%2Fsaving%2Fsave.py?ref=46e7f7fb144fd11cf6d17c23dd47620328d77082",
            "patch": "@@ -13,7 +13,7 @@\n # limitations under the License.\n # ==============================================================================\n \"\"\"Keras model saving code.\"\"\"\n-\n+import os\n from tensorflow.python import tf2\n from tensorflow.python.keras.saving import hdf5_format\n from tensorflow.python.keras.saving import saving_utils\n@@ -25,6 +25,9 @@\n \n # pylint: disable=g-import-not-at-top\n try:\n+  # Disable loading HDF5 plugins from a default path and prevent ZDI-CAN-25480.\n+  # Importing h5py prior to importing tensorflow will restore the old behavior.\n+  os.environ['HDF5_PLUGIN_PATH'] = 'disable'\n   import h5py\n except ImportError:\n   h5py = None"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 14,
        "deletions": 1
    }
}