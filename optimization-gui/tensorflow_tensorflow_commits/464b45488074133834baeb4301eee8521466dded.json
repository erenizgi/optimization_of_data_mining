{
    "author": "WillFroom",
    "message": "[XLA:CPU][XTile] Don't try and emit instructions that are not currently supported by the tiled emitter.\n\nThese instructions are not supported by the tiled emitter and it will return an error, just don't try for now and we can slowly add them once the emitter is landed.\n\nPiperOrigin-RevId: 840793062",
    "sha": "464b45488074133834baeb4301eee8521466dded",
    "files": [
        {
            "sha": "ca968b3df04a1dd953804b0f47b6954e302744e4",
            "filename": "third_party/xla/xla/backends/cpu/codegen/tiled/tiled_fusion_emitter.cc",
            "status": "modified",
            "additions": 25,
            "deletions": 7,
            "changes": 32,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/464b45488074133834baeb4301eee8521466dded/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftiled_fusion_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/464b45488074133834baeb4301eee8521466dded/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftiled_fusion_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Ftiled%2Ftiled_fusion_emitter.cc?ref=464b45488074133834baeb4301eee8521466dded",
            "patch": "@@ -130,6 +130,12 @@ static bool IsSupportedType(PrimitiveType type) {\n     return false;\n   }\n \n+  // Some f8 types are not supported by the emitter, just don't support any of\n+  // them for now.\n+  if (primitive_util::IsF8Type(type) || primitive_util::IsMXType(type)) {\n+    return false;\n+  }\n+\n   return true;\n }\n \n@@ -150,14 +156,26 @@ static bool IsSupportedShape(const Shape& shape) {\n static bool IsSupportedInstruction(const HloInstruction& inst) {\n   HloOpcode opcode = inst.opcode();\n   switch (opcode) {\n-    case xla::HloOpcode::kBitcast:\n-    case xla::HloOpcode::kIota:\n-    case xla::HloOpcode::kReshape:\n-    case xla::HloOpcode::kTranspose:\n-    case xla::HloOpcode::kParameter:\n-    case xla::HloOpcode::kConstant:\n+    case HloOpcode::kBitcast:\n+    case HloOpcode::kIota:\n+    case HloOpcode::kReshape:\n+    case HloOpcode::kTranspose:\n+    case HloOpcode::kParameter:\n       return true;\n-    case xla::HloOpcode::kBitcastConvert:\n+    case HloOpcode::kConstant:\n+      return ShapeUtil::IsEffectiveScalar(inst.shape());\n+    case HloOpcode::kBitcastConvert:\n+    case HloOpcode::kMap:\n+    case HloOpcode::kPopulationCount:\n+    case HloOpcode::kReal:\n+    case HloOpcode::kImag:\n+    case HloOpcode::kSign:\n+    case HloOpcode::kRoundNearestAfz:\n+    case HloOpcode::kRoundNearestEven:\n+    case HloOpcode::kShiftLeft:\n+    case HloOpcode::kShiftRightArithmetic:\n+    case HloOpcode::kShiftRightLogical:\n+    case HloOpcode::kClz:\n       return false;\n       break;\n     default:"
        }
    ],
    "stats": {
        "total": 32,
        "additions": 25,
        "deletions": 7
    }
}