{
    "author": "deqiangc",
    "message": "Append the name of error-emitting kernel to the error status message\n\nPiperOrigin-RevId: 824288070",
    "sha": "28054871f6627fb158defb8efdc80b4fcbf10a7c",
    "files": [
        {
            "sha": "4aa8584e7e4041a6f90560b35447b5912478e42d",
            "filename": "tensorflow/core/tfrt/mlrt/kernel/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/28054871f6627fb158defb8efdc80b4fcbf10a7c/tensorflow%2Fcore%2Ftfrt%2Fmlrt%2Fkernel%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/28054871f6627fb158defb8efdc80b4fcbf10a7c/tensorflow%2Fcore%2Ftfrt%2Fmlrt%2Fkernel%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftfrt%2Fmlrt%2Fkernel%2FBUILD?ref=28054871f6627fb158defb8efdc80b4fcbf10a7c",
            "patch": "@@ -142,6 +142,7 @@ cc_library(\n         \"//tensorflow/core/tfrt/mlrt/interpreter:register_span\",\n         \"@com_google_absl//absl/base:core_headers\",\n         \"@com_google_absl//absl/cleanup\",\n+        \"@local_xla//xla/tsl/platform:errors\",\n     ],\n )\n "
        },
        {
            "sha": "fe9833ea071531cc5e61e25813d7ef83b858a0d2",
            "filename": "tensorflow/core/tfrt/mlrt/kernel/kernel_runner_utils.h",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/28054871f6627fb158defb8efdc80b4fcbf10a7c/tensorflow%2Fcore%2Ftfrt%2Fmlrt%2Fkernel%2Fkernel_runner_utils.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/28054871f6627fb158defb8efdc80b4fcbf10a7c/tensorflow%2Fcore%2Ftfrt%2Fmlrt%2Fkernel%2Fkernel_runner_utils.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftfrt%2Fmlrt%2Fkernel%2Fkernel_runner_utils.h?ref=28054871f6627fb158defb8efdc80b4fcbf10a7c",
            "patch": "@@ -22,6 +22,7 @@ limitations under the License.\n \n #include \"absl/base/optimization.h\"\n #include \"absl/cleanup/cleanup.h\"\n+#include \"xla/tsl/platform/errors.h\"\n #include \"tensorflow/core/profiler/lib/traceme.h\"\n #include \"tensorflow/core/runtime_fallback/kernel/kernel_fallback_compat_request_state.h\"\n #include \"tensorflow/core/runtime_fallback/kernel/kernel_fallback_utils.h\"\n@@ -117,7 +118,11 @@ void ExecuteKernelRunner(\n     }\n \n     if (ABSL_PREDICT_FALSE(!op_kernel_context.status().ok())) {\n-      frame.execution_context().Fail(op_kernel_context.status());\n+      absl::Status status = op_kernel_context.status();\n+      tsl::errors::AppendToMessage(\n+          &status, absl::StrCat(\"Error from kernel: \",\n+                                kernel_runner.op_kernel()->name_view()));\n+      frame.execution_context().Fail(std::move(status));\n       return;\n     }\n "
        },
        {
            "sha": "bf316332ed4f893b511fcd33708dc9d4ff7672aa",
            "filename": "tensorflow/core/tfrt/mlrt/kernel/kernel_test.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/28054871f6627fb158defb8efdc80b4fcbf10a7c/tensorflow%2Fcore%2Ftfrt%2Fmlrt%2Fkernel%2Fkernel_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/28054871f6627fb158defb8efdc80b4fcbf10a7c/tensorflow%2Fcore%2Ftfrt%2Fmlrt%2Fkernel%2Fkernel_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftfrt%2Fmlrt%2Fkernel%2Fkernel_test.cc?ref=28054871f6627fb158defb8efdc80b4fcbf10a7c",
            "patch": "@@ -399,7 +399,8 @@ TEST(KernelTest, CreateExecuteOpError) {\n \n   EXPECT_THAT(\n       execution_context.status(),\n-      absl_testing::StatusIs(absl::StatusCode::kInternal, \"test error\"));\n+      absl_testing::StatusIs(absl::StatusCode::kInternal,\n+                             \"test error\\n\\tError from kernel: TestError\"));\n }\n \n REGISTER_OP(\"TestAsyncIdentity\")"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
    }
}