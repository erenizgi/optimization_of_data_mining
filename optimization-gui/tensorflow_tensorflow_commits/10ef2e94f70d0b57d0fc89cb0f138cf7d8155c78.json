{
    "author": "ybaturina",
    "message": "Replace `http_archive` with `tf_http_archive` for Github links to avoid timeout issues.\n\nPiperOrigin-RevId: 843727468",
    "sha": "10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78",
    "files": [
        {
            "sha": "cf7afb583b2199e0a55fb45261d2f9984f4df25f",
            "filename": "third_party/xla/WORKSPACE",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78/third_party%2Fxla%2FWORKSPACE",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78/third_party%2Fxla%2FWORKSPACE",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2FWORKSPACE?ref=10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78",
            "patch": "@@ -1,19 +1,19 @@\n # buildifier: disable=load-on-top\n workspace(name = \"xla\")\n \n-load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n \n # Initialize toolchains for ML projects.\n #\n # A hermetic build system is designed to produce completely reproducible builds for C++.\n # Details: https://github.com/google-ml-infra/rules_ml_toolchain\n-http_archive(\n+tf_http_archive(\n     name = \"rules_ml_toolchain\",\n     sha256 = \"7f00b3e94bbca1a4737ded6b9ed5358f6d1c86430c2ec97c90081343c0482f18\",\n     strip_prefix = \"rules_ml_toolchain-29d54c875da37e74b8548924ed30e78cb28126b9\",\n-    urls = [\n+    urls = tf_mirror_urls(\n         \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/29d54c875da37e74b8548924ed30e78cb28126b9.tar.gz\",\n-    ],\n+    ),\n )\n \n load("
        },
        {
            "sha": "4e66ac333f0e230777ca99a3af756f7076a43664",
            "filename": "third_party/xla/workspace0.bzl",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78/third_party%2Fxla%2Fworkspace0.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78/third_party%2Fxla%2Fworkspace0.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fworkspace0.bzl?ref=10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78",
            "patch": "@@ -7,6 +7,7 @@ load(\"@build_bazel_rules_apple//apple:repositories.bzl\", \"apple_rules_dependenci\n load(\"@build_bazel_rules_swift//swift:repositories.bzl\", \"swift_rules_dependencies\")\n load(\"@com_github_grpc_grpc//bazel:grpc_extra_deps.bzl\", \"grpc_extra_deps\")\n load(\"@com_google_benchmark//:bazel/benchmark_deps.bzl\", \"benchmark_deps\")\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n \n def _tf_bind():\n     \"\"\"Bind targets for some external repositories\"\"\"\n@@ -109,21 +110,20 @@ def workspace():\n     # Note: We add this to fix Kokoro builds.\n     # The rules below call into `rules_proto` but the hash has changed and\n     # Bazel refuses to continue. So, we add our own mirror.\n-    http_archive(\n+    tf_http_archive(\n         name = \"rules_proto\",\n         sha256 = \"20b240eba17a36be4b0b22635aca63053913d5c1ee36e16be36499d167a2f533\",\n         strip_prefix = \"rules_proto-11bf7c25e666dd7ddacbcd4d4c4a9de7a25175f8\",\n-        urls = [\n-            \"https://storage.googleapis.com/mirror.tensorflow.org/github.com/bazelbuild/rules_proto/archive/11bf7c25e666dd7ddacbcd4d4c4a9de7a25175f8.tar.gz\",\n+        urls = tf_mirror_urls(\n             \"https://github.com/bazelbuild/rules_proto/archive/11bf7c25e666dd7ddacbcd4d4c4a9de7a25175f8.tar.gz\",\n-        ],\n+        ),\n     )\n \n-    http_archive(\n+    tf_http_archive(\n         name = \"rules_shell\",\n         sha256 = \"bc61ef94facc78e20a645726f64756e5e285a045037c7a61f65af2941f4c25e1\",\n         strip_prefix = \"rules_shell-0.4.1\",\n-        url = \"https://github.com/bazelbuild/rules_shell/releases/download/v0.4.1/rules_shell-v0.4.1.tar.gz\",\n+        urls = tf_mirror_urls(\"https://github.com/bazelbuild/rules_shell/releases/download/v0.4.1/rules_shell-v0.4.1.tar.gz\"),\n     )\n \n     # Now, finally use the rules\n@@ -138,13 +138,13 @@ def workspace():\n     # Toolchains for ML projects hermetic builds.\n     # Details: https://github.com/google-ml-infra/rules_ml_toolchain\n     if \"rules_ml_toolchain\" not in native.existing_rules():\n-        http_archive(\n+        tf_http_archive(\n             name = \"rules_ml_toolchain\",\n             sha256 = \"7f00b3e94bbca1a4737ded6b9ed5358f6d1c86430c2ec97c90081343c0482f18\",\n             strip_prefix = \"rules_ml_toolchain-29d54c875da37e74b8548924ed30e78cb28126b9\",\n-            urls = [\n+            urls = tf_mirror_urls(\n                 \"https://github.com/google-ml-infra/rules_ml_toolchain/archive/29d54c875da37e74b8548924ed30e78cb28126b9.tar.gz\",\n-            ],\n+            ),\n         )\n \n     # If a target is bound twice, the later one wins, so we have to do tf bindings"
        },
        {
            "sha": "cbd3d24aec8a1a1e4956799f53d50ada0f078115",
            "filename": "third_party/xla/workspace1.bzl",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78/third_party%2Fxla%2Fworkspace1.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78/third_party%2Fxla%2Fworkspace1.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fworkspace1.bzl?ref=10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78",
            "patch": "@@ -1,9 +1,9 @@\n \"\"\"TensorFlow workspace initialization. Consult the WORKSPACE on how to use it.\"\"\"\n \n-load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n load(\"@com_github_grpc_grpc//bazel:grpc_deps.bzl\", \"grpc_deps\")\n load(\"@io_bazel_rules_closure//closure:defs.bzl\", \"closure_repositories\")\n load(\"@rules_pkg//:deps.bzl\", \"rules_pkg_dependencies\")\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n load(\"//third_party/llvm:setup.bzl\", \"llvm_setup\")\n \n # buildifier: disable=unnamed-macro\n@@ -15,14 +15,13 @@ def workspace():\n \n     closure_repositories()\n \n-    http_archive(\n+    tf_http_archive(\n         name = \"bazel_toolchains\",\n         sha256 = \"294cdd859e57fcaf101d4301978c408c88683fbc46fbc1a3829da92afbea55fb\",\n         strip_prefix = \"bazel-toolchains-8c717f8258cd5f6c7a45b97d974292755852b658\",\n-        urls = [\n-            \"http://mirror.tensorflow.org/github.com/bazelbuild/bazel-toolchains/archive/8c717f8258cd5f6c7a45b97d974292755852b658.tar.gz\",\n+        urls = tf_mirror_urls(\n             \"https://github.com/bazelbuild/bazel-toolchains/archive/8c717f8258cd5f6c7a45b97d974292755852b658.tar.gz\",\n-        ],\n+        ),\n     )\n \n     grpc_deps()"
        },
        {
            "sha": "10212d417103d114594136502e8bbc90b5187fea",
            "filename": "third_party/xla/workspace3.bzl",
            "status": "modified",
            "additions": 20,
            "deletions": 25,
            "changes": 45,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78/third_party%2Fxla%2Fworkspace3.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78/third_party%2Fxla%2Fworkspace3.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fworkspace3.bzl?ref=10ef2e94f70d0b57d0fc89cb0f138cf7d8155c78",
            "patch": "@@ -1,71 +1,66 @@\n \"\"\"TensorFlow workspace initialization. Consult the WORKSPACE on how to use it.\"\"\"\n \n-load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n \n # buildifier: disable=function-docstring\n # buildifier: disable=unnamed-macro\n def workspace():\n-    http_archive(\n+    tf_http_archive(\n         name = \"io_bazel_rules_closure\",\n         sha256 = \"5b00383d08dd71f28503736db0500b6fb4dda47489ff5fc6bed42557c07c6ba9\",\n         strip_prefix = \"rules_closure-308b05b2419edb5c8ee0471b67a40403df940149\",\n-        urls = [\n-            \"https://storage.googleapis.com/mirror.tensorflow.org/github.com/bazelbuild/rules_closure/archive/308b05b2419edb5c8ee0471b67a40403df940149.tar.gz\",\n+        urls = tf_mirror_urls(\n             \"https://github.com/bazelbuild/rules_closure/archive/308b05b2419edb5c8ee0471b67a40403df940149.tar.gz\",  # 2019-06-13\n-        ],\n+        ),\n     )\n \n     # https://github.com/bazelbuild/bazel-skylib/releases\n-    http_archive(\n+    tf_http_archive(\n         name = \"bazel_skylib\",\n         sha256 = \"bc283cdfcd526a52c3201279cda4bc298652efa898b10b4db0837dc51652756f\",\n-        urls = [\n-            \"https://storage.googleapis.com/mirror.tensorflow.org/github.com/bazelbuild/bazel-skylib/releases/download/1.7.1/bazel-skylib-1.7.1.tar.gz\",\n+        urls = tf_mirror_urls(\n             \"https://github.com/bazelbuild/bazel-skylib/releases/download/1.7.1/bazel-skylib-1.7.1.tar.gz\",\n-        ],\n+        ),\n     )\n \n-    http_archive(\n+    tf_http_archive(\n         name = \"rules_license\",\n-        urls = [\n-            \"https://mirror.bazel.build/github.com/bazelbuild/rules_license/releases/download/0.0.7/rules_license-0.0.7.tar.gz\",\n+        urls = tf_mirror_urls(\n             \"https://github.com/bazelbuild/rules_license/releases/download/0.0.7/rules_license-0.0.7.tar.gz\",\n-        ],\n+        ),\n         sha256 = \"4531deccb913639c30e5c7512a054d5d875698daeb75d8cf90f284375fe7c360\",\n     )\n \n-    http_archive(\n+    tf_http_archive(\n         name = \"rules_pkg\",\n-        urls = [\n-            \"https://mirror.bazel.build/github.com/bazelbuild/rules_pkg/releases/download/0.7.1/rules_pkg-0.7.1.tar.gz\",\n+        urls = tf_mirror_urls(\n             \"https://github.com/bazelbuild/rules_pkg/releases/download/0.7.1/rules_pkg-0.7.1.tar.gz\",\n-        ],\n+        ),\n         sha256 = \"451e08a4d78988c06fa3f9306ec813b836b1d076d0f055595444ba4ff22b867f\",\n     )\n \n-    http_archive(\n+    tf_http_archive(\n         name = \"bazel_features\",\n         sha256 = \"4fd9922d464686820ffd8fcefa28ccffa147f7cdc6b6ac0d8b07fde565c65d66\",\n         strip_prefix = \"bazel_features-1.25.0\",\n-        url = \"https://github.com/bazel-contrib/bazel_features/releases/download/v1.25.0/bazel_features-v1.25.0.tar.gz\",\n+        urls = tf_mirror_urls(\"https://github.com/bazel-contrib/bazel_features/releases/download/v1.25.0/bazel_features-v1.25.0.tar.gz\"),\n     )\n \n     # Maven dependencies.\n     RULES_JVM_EXTERNAL_TAG = \"4.3\"\n-    http_archive(\n+    tf_http_archive(\n         name = \"rules_jvm_external\",\n         strip_prefix = \"rules_jvm_external-%s\" % RULES_JVM_EXTERNAL_TAG,\n         sha256 = \"6274687f6fc5783b589f56a2f1ed60de3ce1f99bc4e8f9edef3de43bdf7c6e74\",\n-        url = \"https://github.com/bazelbuild/rules_jvm_external/archive/%s.zip\" % RULES_JVM_EXTERNAL_TAG,\n+        urls = tf_mirror_urls(\"https://github.com/bazelbuild/rules_jvm_external/archive/%s.zip\" % RULES_JVM_EXTERNAL_TAG),\n     )\n \n     # Platforms\n-    http_archive(\n+    tf_http_archive(\n         name = \"platforms\",\n-        urls = [\n-            \"https://mirror.bazel.build/github.com/bazelbuild/platforms/releases/download/0.0.11/platforms-0.0.11.tar.gz\",\n+        urls = tf_mirror_urls(\n             \"https://github.com/bazelbuild/platforms/releases/download/0.0.11/platforms-0.0.11.tar.gz\",\n-        ],\n+        ),\n         sha256 = \"29742e87275809b5e598dc2f04d86960cc7a55b3067d97221c9abbc9926bff0f\",\n     )\n "
        }
    ],
    "stats": {
        "total": 80,
        "additions": 37,
        "deletions": 43
    }
}