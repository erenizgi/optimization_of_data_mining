{
    "author": "ezhulenev",
    "message": "[xla] Migrate XLA to xla::Future and xla::Promise\n\nPiperOrigin-RevId: 812264007",
    "sha": "3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
    "files": [
        {
            "sha": "145db2ef4bf313516a0987d82f70887c37b95aba",
            "filename": "third_party/xla/xla/python/pjrt_ifrt/basic_string_array_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fbasic_string_array_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fbasic_string_array_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fbasic_string_array_test.cc?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -159,7 +159,7 @@ TEST(BasicStringArrayTest, Destruction) {\n       [&on_done_with_buffer_called]() { on_done_with_buffer_called.Notify(); };\n \n   auto [array_creation_promise, array_creation_future] =\n-      PjRtFuture<>::MakePromise();\n+      Future<>::MakePromise();\n \n   tsl::Env::Default()->SchedClosure(\n       ([&, promise = std::move(array_creation_promise)]() mutable {"
        },
        {
            "sha": "0bbda958f27d78aa9c13a02d9d9412bc00890bc3",
            "filename": "third_party/xla/xla/python/pjrt_ifrt/pjrt_client.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fpjrt_client.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fpjrt_client.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fpjrt_client.cc?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -1507,7 +1507,7 @@ absl::Status PjRtClient::CrossHostSendBuffers(\n   // TODO(emilyaf): Use an async version of KeyValueStore::Get or query batched\n   // keys together to reduce the number of threads used.\n   for (int i = 0; i < keys.size(); ++i) {\n-    auto [promise, descriptor_future] = PjRtFuture<std::string>::MakePromise();\n+    auto [promise, descriptor_future] = Future<std::string>::MakePromise();\n     work_queue_->Schedule(\n         [this, k = keys[i], promise = std::move(promise).ToShared()]() mutable {\n           std::string key = absl::StrCat(kKeyPrefix, k);"
        },
        {
            "sha": "2c22d21445453494579a4303a006e430d8a4013f",
            "filename": "third_party/xla/xla/python/pjrt_ifrt/pjrt_executable.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fpjrt_executable.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fpjrt_executable.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fpjrt_executable.cc?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -659,7 +659,7 @@ PjRtLoadedExecutable::Execute(absl::Span<ArrayRef> args,\n   std::vector<std::vector<std::unique_ptr<PjRtBuffer>>> pjrt_outputs;\n   xla::ifrt::Future<> status;\n   if (portable_execution) {\n-    std::optional<PjRtFuture<>> returned_pjrt_future;\n+    std::optional<Future<>> returned_pjrt_future;\n     TF_RET_CHECK(portable_execution_device->IsAddressable());\n     TF_ASSIGN_OR_RETURN(\n         std::vector<std::unique_ptr<PjRtBuffer>> single_device_pjrt_results,\n@@ -671,7 +671,7 @@ PjRtLoadedExecutable::Execute(absl::Span<ArrayRef> args,\n     pjrt_outputs.push_back(std::move(single_device_pjrt_results));\n     status = *std::move(returned_pjrt_future);\n   } else {\n-    std::optional<std::vector<PjRtFuture<>>> returned_pjrt_futures;\n+    std::optional<std::vector<Future<>>> returned_pjrt_futures;\n     returned_pjrt_futures.emplace();\n \n     TF_ASSIGN_OR_RETURN("
        },
        {
            "sha": "033f2e12a18cbfcf4cdd566db66e63be13425611",
            "filename": "third_party/xla/xla/python/transfer/streaming.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming.cc?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -44,8 +44,7 @@ namespace aux {\n \n class StringFutureChunkDestination : public aux::ChunkDestination {\n  public:\n-  explicit StringFutureChunkDestination(\n-      xla::PjRtFuture<std::string>::Promise dest)\n+  explicit StringFutureChunkDestination(xla::Promise<std::string> dest)\n       : dest_(std::move(dest)) {}\n   ~StringFutureChunkDestination() override { dest_.Set(ConsumeFinalResult()); }\n   absl::Status Put(const void* data, int64_t offset, size_t size,\n@@ -78,12 +77,12 @@ class StringFutureChunkDestination : public aux::ChunkDestination {\n  private:\n   absl::Mutex mu_;\n   std::vector<std::pair<size_t, std::string>> chunks_;\n-  xla::PjRtFuture<std::string>::Promise dest_;\n+  xla::Future<std::string>::Promise dest_;\n };\n \n-std::pair<xla::PjRtFuture<std::string>, tsl::RCReference<ChunkDestination>>\n+std::pair<xla::Future<std::string>, tsl::RCReference<ChunkDestination>>\n ChunkDestination::MakeStringDest() {\n-  auto [promise, result] = xla::PjRtFuture<std::string>::MakePromise();\n+  auto [promise, result] = xla::Future<std::string>::MakePromise();\n   return std::make_pair(\n       std::move(result),\n       tsl::MakeRef<StringFutureChunkDestination>(std::move(promise)));"
        },
        {
            "sha": "0087985790ed33123432a2b418e7257d4d56efcf",
            "filename": "third_party/xla/xla/python/transfer/streaming.h",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming.h?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -46,8 +46,7 @@ class ChunkDestination : public tsl::ReferenceCounted<ChunkDestination> {\n   virtual void Poison(absl::Status s) = 0;\n \n   // For testing.\n-  static std::pair<xla::PjRtFuture<std::string>,\n-                   tsl::RCReference<ChunkDestination>>\n+  static std::pair<xla::Future<std::string>, tsl::RCReference<ChunkDestination>>\n   MakeStringDest();\n };\n "
        },
        {
            "sha": "5ba223e11f6246f9a12354d2a2186ff57899eba7",
            "filename": "third_party/xla/xla/python/transfer/streaming_ifrt.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 9,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming_ifrt.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming_ifrt.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming_ifrt.cc?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -100,7 +100,7 @@ DmaCopyChunk::DivideBufferCopiesEvenly(std::shared_ptr<xla::PjRtBuffer> buffer,\n   for (size_t i = 0; i < total_num_copies; ++i) {\n     work_units.push_back(\n         DmaCopyChunk{[buffer](void* dst, int64_t offset,\n-                              int64_t transfer_size) -> xla::PjRtFuture<> {\n+                              int64_t transfer_size) -> xla::Future<> {\n                        return buffer->CopyRawToHost(dst, offset, transfer_size);\n                      },\n                      buffer_id, i* xfer_size,\n@@ -264,7 +264,7 @@ class SlicedRawBufferChunkDestination : public ChunkDestination {\n  public:\n   SlicedRawBufferChunkDestination(\n       tsl::RCReference<xla::PjRtRawBuffer> raw_buffer, size_t offset,\n-      size_t size, xla::PjRtFuture<>::Promise promise)\n+      size_t size, xla::Promise<> promise)\n       : raw_buffer_(raw_buffer),\n         slice_offset_(offset),\n         slice_size_(size),\n@@ -325,13 +325,13 @@ class SlicedRawBufferChunkDestination : public ChunkDestination {\n   size_t copied_bytes_ ABSL_GUARDED_BY(&mu_) = 0;\n   absl::Mutex mu_;\n   absl::Status saved_status_ ABSL_GUARDED_BY(&mu_);\n-  xla::PjRtFuture<>::Promise promise_ ABSL_GUARDED_BY(&mu_);\n+  xla::Promise<> promise_ ABSL_GUARDED_BY(&mu_);\n };\n \n-absl::StatusOr<std::pair<tsl::RCReference<ChunkDestination>, xla::PjRtFuture<>>>\n+absl::StatusOr<std::pair<tsl::RCReference<ChunkDestination>, xla::Future<>>>\n CreateSlicedRawBufferDest(tsl::RCReference<xla::PjRtRawBuffer> raw_buffer,\n                           size_t offset, size_t size) {\n-  auto [promise, future] = xla::PjRtFuture<>::MakePromise();\n+  auto [promise, future] = xla::Future<>::MakePromise();\n   auto dest = tsl::MakeRef<SlicedRawBufferChunkDestination>(\n       raw_buffer, offset, size, std::move(promise));\n   return std::make_pair(std::move(dest), std::move(future));\n@@ -382,9 +382,8 @@ bool RawBufferEntry::Handle(tsl::RCReference<ConnectionState> state,\n                           offset, size, is_largest, [buffer]() {});\n             } else {\n               DmaCopyChunk blob;\n-              blob.copy_fn = [buffer](\n-                                 void* dst, int64_t offset,\n-                                 int64_t transfer_size) -> xla::PjRtFuture<> {\n+              blob.copy_fn = [buffer](void* dst, int64_t offset,\n+                                      int64_t transfer_size) -> xla::Future<> {\n                 return buffer->CopyRawDeviceToHost(dst, offset, transfer_size);\n               };\n               blob.buffer_id = bid;\n@@ -459,7 +458,7 @@ bool PjRtBufferEntry::Handle(tsl::RCReference<ConnectionState> state,\n             DmaCopyChunk blob;\n             blob.copy_fn = [buffer = std::move(buffer)](\n                                void* dst, int64_t offset,\n-                               int64_t transfer_size) -> xla::PjRtFuture<> {\n+                               int64_t transfer_size) -> xla::Future<> {\n               return buffer->CopyRawToHost(dst, offset, transfer_size);\n             };\n             blob.buffer_id = bid;"
        },
        {
            "sha": "0228a84c6545a98b00fcb9e29bc784c8f68cadb5",
            "filename": "third_party/xla/xla/python/transfer/streaming_ifrt.h",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming_ifrt.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming_ifrt.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Ftransfer%2Fstreaming_ifrt.h?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -52,21 +52,21 @@ absl::StatusOr<std::shared_ptr<absl::Span<uint8_t>>> AllocateAndMapPjrtMemory(\n // An structure which represents a single copy of a chunk out of a buffer\n // with an assigned 'buffer_id'.\n struct DmaCopyChunk {\n-  absl::AnyInvocable<xla::PjRtFuture<>(void* dst, int64_t offset,\n-                                       int64_t transfer_size)>\n+  absl::AnyInvocable<xla::Future<>(void* dst, int64_t offset,\n+                                   int64_t transfer_size)>\n       copy_fn;\n   size_t buffer_id;\n   size_t offset;\n   size_t size;\n \n   static DmaCopyChunk Make(xla::ifrt::ArrayRef arr, xla::PjRtBuffer* buffer,\n                            size_t buffer_id, size_t offset, size_t size) {\n-    return DmaCopyChunk{\n-        [arr, buffer](void* dst, int64_t offset,\n-                      int64_t transfer_size) -> xla::PjRtFuture<> {\n-          return buffer->CopyRawToHost(dst, offset, transfer_size);\n-        },\n-        buffer_id, offset, size};\n+    return DmaCopyChunk{[arr, buffer](void* dst, int64_t offset,\n+                                      int64_t transfer_size) -> xla::Future<> {\n+                          return buffer->CopyRawToHost(dst, offset,\n+                                                       transfer_size);\n+                        },\n+                        buffer_id, offset, size};\n   }\n \n   // Divides an IFRT array up evenly for copying.\n@@ -129,7 +129,7 @@ class RawBufferEntry : public PullTable::Entry {\n   struct BufferRef {\n     // TODO(parkers): Technically this should be a use-ref instead of a\n     // ready_future + buffer, but there is no PJRT api for this.\n-    xla::PjRtFuture<> ready_future;\n+    xla::Future<> ready_future;\n     tsl::RCReference<xla::PjRtRawBuffer> buffer;\n     size_t buf_size;\n   };\n@@ -155,7 +155,7 @@ class PjRtBufferEntry : public PullTable::Entry {\n   struct BufferRef {\n     std::shared_ptr<xla::PjRtBuffer> buffer;\n     size_t buf_size;\n-    xla::PjRtFuture<> ready_future;\n+    xla::Future<> ready_future;\n   };\n   explicit PjRtBufferEntry(std::vector<BufferRef> arrs,\n                            std::shared_ptr<PremappedCopierState> state,\n@@ -180,7 +180,7 @@ tsl::RCReference<ChunkDestination> MakeDmaDestination(\n \n // Creates a ChunkDestination for a sliced offset into\n // a PjRtRawBuffer.\n-absl::StatusOr<std::pair<tsl::RCReference<ChunkDestination>, xla::PjRtFuture<>>>\n+absl::StatusOr<std::pair<tsl::RCReference<ChunkDestination>, xla::Future<>>>\n CreateSlicedRawBufferDest(tsl::RCReference<xla::PjRtRawBuffer> raw_buffer,\n                           size_t offset, size_t size);\n "
        },
        {
            "sha": "217e6fdf6c75231749ebc3d859dc200d1056febd",
            "filename": "third_party/xla/xla/service/hlo_runner_pjrt.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_pjrt.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_pjrt.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_runner_pjrt.cc?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -432,7 +432,7 @@ HloRunnerPjRt::ExecuteWithDeviceBuffers(\n       PjRtLoadedExecutable * pjrt_executable,\n       wrapped_executable->GetOrLoadExecutable(pjrt_client_.get()));\n   std::vector<PjRtBuffer*> argument_ptrs = BufferVecToPointerVec(arguments);\n-  std::optional<PjRtFuture<>> returned_future = {};\n+  std::optional<Future<>> returned_future = {};\n   TF_ASSIGN_OR_RETURN(\n       std::vector<std::unique_ptr<PjRtBuffer>> buffers,\n       pjrt_executable->ExecuteSharded(\n@@ -629,7 +629,7 @@ absl::StatusOr<std::vector<Literal>> HloRunnerPjRt::ExecuteReplicated(\n                     DeviceIdForInvocation(*device_assignment, i)));\n             pool.Schedule([&per_replica_results, i, pjrt_executable,\n                            args = argument_buffer_slices[i], device_ptr]() {\n-              std::optional<PjRtFuture<>> returned_future = {};\n+              std::optional<Future<>> returned_future = {};\n               xla::ExecuteOptions options;\n               options.untuple_result = true;\n               per_replica_results[i] = pjrt_executable->ExecuteSharded("
        },
        {
            "sha": "dc140fd659508f6d17c1d7be6f943108b74aa8b3",
            "filename": "third_party/xla/xla/tools/multihost_hlo_runner/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Ftools%2Fmultihost_hlo_runner%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Ftools%2Fmultihost_hlo_runner%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftools%2Fmultihost_hlo_runner%2FBUILD?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -161,6 +161,7 @@ cc_library(\n     deps = [\n         \":hlo_input_output_format\",\n         \":profiler_interface\",\n+        \"//xla:future\",\n         \"//xla:literal\",\n         \"//xla:literal_util\",\n         \"//xla:shape_layout\","
        },
        {
            "sha": "bc4ab9aa00acc1fcb3311ded53d6582bd31c5ce6",
            "filename": "third_party/xla/xla/tools/multihost_hlo_runner/functional_hlo_runner.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Ftools%2Fmultihost_hlo_runner%2Ffunctional_hlo_runner.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Ftools%2Fmultihost_hlo_runner%2Ffunctional_hlo_runner.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftools%2Fmultihost_hlo_runner%2Ffunctional_hlo_runner.cc?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -40,6 +40,7 @@ limitations under the License.\n #include \"absl/types/span.h\"\n #include \"mlir/Dialect/Func/Extensions/AllExtensions.h\"\n #include \"xla/client/executable_build_options.h\"\n+#include \"xla/future.h\"\n #include \"xla/hlo/builder/xla_computation.h\"\n #include \"xla/hlo/ir/hlo_input_output_alias_config.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n@@ -543,7 +544,7 @@ absl::StatusOr<PerDeviceLiteralVecType> RunInternal(\n \n   std::vector<std::vector<std::unique_ptr<PjRtBuffer>>> output_buffers;\n   execute_options.arguments_are_tupled = false;\n-  std::optional<std::vector<PjRtFuture<>>> futures;\n+  std::optional<std::vector<Future<>>> futures;\n   futures.emplace();\n   std::vector<std::vector<std::unique_ptr<PjRtBuffer>>> device_buffers;\n   std::vector<std::vector<PjRtBuffer*>> argument_ptrs;"
        },
        {
            "sha": "634bdd53b51e1ff0454cd575509da47e5f74a875",
            "filename": "third_party/xla/xla/tsl/concurrency/future.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Ftsl%2Fconcurrency%2Ffuture.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3cb2f7b51b02296661aa93acf5a6c8e8a63be276/third_party%2Fxla%2Fxla%2Ftsl%2Fconcurrency%2Ffuture.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fconcurrency%2Ffuture.cc?ref=3cb2f7b51b02296661aa93acf5a6c8e8a63be276",
            "patch": "@@ -47,7 +47,7 @@ struct State {\n   }\n \n   std::atomic<int32_t> pending_count;\n-  Future<>::Promise promise;\n+  Promise<> promise;\n   Future<> future;\n \n   absl::Mutex mu;"
        }
    ],
    "stats": {
        "total": 69,
        "additions": 34,
        "deletions": 35
    }
}