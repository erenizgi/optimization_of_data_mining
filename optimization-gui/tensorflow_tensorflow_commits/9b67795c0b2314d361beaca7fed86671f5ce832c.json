{
    "author": "alekstheod",
    "message": "PR #35077: [ROCm] Fix hermetic build rocm\n\nImported from GitHub PR https://github.com/openxla/xla/pull/35077\n\nüìù Summary of Changes\nMove comgr into the data directory, fixing hermetic build\n\nüéØ Justification\nHermetic build with rocm config is broken due to invalid\ndependency management. Invalid merge of this PR: https://github.com/openxla/xla/pull/34812\n\nüöÄ Kind of Contribution\nPlease remove what does not apply: üêõ Bug Fix\n\nüìä Benchmark (for Performance Improvements)\nNot relevant\n\nüß™ Unit Tests:\nNot relevant\n\nüß™ Execution Tests:\nNot relevant\n\nCopybara import of the project:\n\n--\n66c08137948a92ac98ccaa1785ce27ebd4c489ca by Alexandros Theodoridis <alexandros.theodoridis@amd.com>:\n\nFix hermetic build rocm\n\nMerging this change closes #35077\n\nPiperOrigin-RevId: 842648079",
    "sha": "9b67795c0b2314d361beaca7fed86671f5ce832c",
    "files": [
        {
            "sha": "a9f510d7e0c7aa4e8b2d9b3eac0f39e175fc4ad7",
            "filename": "third_party/xla/third_party/gpus/rocm/BUILD.tpl",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/9b67795c0b2314d361beaca7fed86671f5ce832c/third_party%2Fxla%2Fthird_party%2Fgpus%2Frocm%2FBUILD.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/9b67795c0b2314d361beaca7fed86671f5ce832c/third_party%2Fxla%2Fthird_party%2Fgpus%2Frocm%2FBUILD.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fgpus%2Frocm%2FBUILD.tpl?ref=9b67795c0b2314d361beaca7fed86671f5ce832c",
            "patch": "@@ -537,7 +537,7 @@ cc_library(\n cc_library(\n     name = \"amd_comgr\",\n     hdrs = glob([\"%{rocm_root}/include/amd_comgr/**\"]),\n-    srcs = glob([\n+    data = glob([\n         \"%{rocm_root}/lib/libamd_comgr_loader.so*\",\n         \"%{rocm_root}/lib/libamd_comgr.so*\",\n         \"%{rocm_root}/lib/llvm/lib/libLLVM.so*\",\n@@ -549,10 +549,11 @@ cc_library(\n     linkopts = select({\n         \":build_hermetic\": [\n             \"-lamd_comgr_loader\",\n+            \"-lamd_comgr\",\n         ],\n         \"//conditions:default\": [\n             \"-lamd_comgr\",\n-\t],\n+        ],\n     }),\n     strip_include_prefix = \"%{rocm_root}\",\n     visibility = [\"//visibility:public\"],"
        }
    ],
    "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
    }
}