{
    "author": "loislo",
    "message": "[XLA:GPU] Fix usages of deprecated tsl::errors::Unimplemented in xla and resolve nvml linker errors\n\nThis change addresses the deprecation of `tsl::errors::Unimplemented` by replacing its usages with `absl::UnimplementedError`,\nwrapping arguments in `absl::StrCat` where necessary. This brings the code closer to standard Abseil error handling.\n\nChanges:\n- Replaced `errors::Unimplemented` with `absl::UnimplementedError`.\n- Used `absl::StrCat` to construct error messages where necessary.\nPiperOrigin-RevId: 838065042",
    "sha": "13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
    "files": [
        {
            "sha": "97faff6cd234204706874ccf987501cdfe0b399c",
            "filename": "third_party/xla/xla/tsl/lib/io/BUILD",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2FBUILD?ref=13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
            "patch": "@@ -109,7 +109,6 @@ cc_library(\n     hdrs = [\"inputstream_interface.h\"],\n     deps = [\n         \"//xla/tsl/platform:errors\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:types\",\n         \"@com_google_absl//absl/status\",\n         \"@local_tsl//tsl/platform:cord\",\n@@ -598,10 +597,14 @@ tsl_cc_test(\n         \":block\",\n         \":iterator\",\n         \":table\",\n+        \":table_options\",\n         \"//xla/tsl/lib/random:philox\",\n+        \"//xla/tsl/lib/random:philox_random\",\n         \"//xla/tsl/platform:env\",\n         \"//xla/tsl/platform:errors\",\n+        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:test\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_googletest//:gtest_main\","
        },
        {
            "sha": "ee4f39ed76835e5913232af2dbbb16224ac77745",
            "filename": "third_party/xla/xla/tsl/lib/io/inputstream_interface.h",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Finputstream_interface.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Finputstream_interface.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Finputstream_interface.h?ref=13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
            "patch": "@@ -16,10 +16,9 @@ limitations under the License.\n #ifndef XLA_TSL_LIB_IO_INPUTSTREAM_INTERFACE_H_\n #define XLA_TSL_LIB_IO_INPUTSTREAM_INTERFACE_H_\n \n-#include <string>\n+#include <cstdint>\n \n-#include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n+#include \"absl/status/status.h\"\n #include \"xla/tsl/platform/types.h\"\n #include \"tsl/platform/cord.h\"\n \n@@ -42,7 +41,7 @@ class InputStreamInterface {\n   //  * OK - in case of success.\n   //  * OUT_OF_RANGE - not enough bytes remaining before end of file.\n   virtual absl::Status ReadNBytes(int64_t bytes_to_read, absl::Cord* cord) {\n-    return errors::Unimplemented(\n+    return absl::UnimplementedError(\n         \"ReadNBytes(int64, absl::Cord*) is not implemented.\");\n   }\n #endif"
        },
        {
            "sha": "bdd7eac09029467f30f4752a102442bbddac56bb",
            "filename": "third_party/xla/xla/tsl/lib/io/table_test.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 2,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Ftable_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Ftable_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fio%2Ftable_test.cc?ref=13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
            "patch": "@@ -15,21 +15,30 @@ limitations under the License.\n \n #include \"xla/tsl/lib/io/table.h\"\n \n-#include <algorithm>\n+#include <cstddef>\n+#include <cstdint>\n+#include <cstdio>\n+#include <cstring>\n #include <map>\n #include <string>\n+#include <utility>\n #include <vector>\n \n+#include \"absl/log/check.h\"\n #include \"absl/status/status.h\"\n #include \"absl/strings/escaping.h\"\n+#include \"absl/strings/string_view.h\"\n #include \"xla/tsl/lib/io/block.h\"\n #include \"xla/tsl/lib/io/block_builder.h\"\n #include \"xla/tsl/lib/io/format.h\"\n #include \"xla/tsl/lib/io/iterator.h\"\n #include \"xla/tsl/lib/io/table_builder.h\"\n+#include \"xla/tsl/lib/io/table_options.h\"\n+#include \"xla/tsl/lib/random/philox_random.h\"\n #include \"xla/tsl/lib/random/simple_philox.h\"\n-#include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/file_system.h\"\n+#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/test.h\"\n #include \"tsl/platform/snappy.h\"\n "
        },
        {
            "sha": "b17e05bccbf0afb3b5259883c61155dfd1e51d8b",
            "filename": "third_party/xla/xla/tsl/platform/BUILD",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2FBUILD?ref=13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
            "patch": "@@ -374,9 +374,30 @@ cc_library(\n         \"threadpool.h\",\n     ],\n     deps = tf_windows_aware_platform_deps(\"env\") + if_static([\":env_impl\"]) + [\n+        \":env_time\",\n+        \":errors\",\n+        \":file_statistics\",\n+        \":macros\",\n+        \":status\",\n+        \":statusor\",\n+        \":threadpool_interface\",\n+        \":types\",\n+        \"//xla/tsl/concurrency:executor\",\n+        \"@com_google_absl//absl/base:core_headers\",\n+        \"@com_google_absl//absl/base:nullability\",\n+        \"@com_google_absl//absl/functional:any_invocable\",\n+        \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/strings:string_view\",\n+        \"@com_google_absl//absl/types:span\",\n+        \"@com_google_protobuf//:protobuf\",\n+        \"@com_google_protobuf//:protobuf_lite\",\n+        \"@local_tsl//tsl/platform\",\n+        \"@local_tsl//tsl/platform:cord\",\n+        \"@local_tsl//tsl/platform:platform_port\",\n+        \"@local_tsl//tsl/platform:protobuf\",\n+        \"@local_tsl//tsl/platform:stringpiece\",\n     ],\n )\n "
        },
        {
            "sha": "12e8d81c34f7eb75448750c60e752f46a3640ecb",
            "filename": "third_party/xla/xla/tsl/platform/default/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fdefault%2FBUILD?ref=13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
            "patch": "@@ -167,6 +167,7 @@ cc_library(\n         \"@com_google_absl//absl/base:core_headers\",\n         \"@com_google_absl//absl/base:nullability\",\n         \"@com_google_absl//absl/functional:any_invocable\",\n+        \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\","
        },
        {
            "sha": "cb52d3938e190c453fbe9c01cd4257ce0b7744ab",
            "filename": "third_party/xla/xla/tsl/platform/env.h",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fenv.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fenv.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fenv.h?ref=13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
            "patch": "@@ -18,25 +18,25 @@ limitations under the License.\n \n #include <stdint.h>\n \n+#include <cstddef>\n #include <memory>\n #include <string>\n-#include <unordered_map>\n #include <utility>\n #include <vector>\n \n #include \"absl/functional/any_invocable.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/status.h\"\n #include \"absl/strings/ascii.h\"\n-#include \"absl/synchronization/mutex.h\"\n+#include \"absl/strings/string_view.h\"\n+#include \"google/protobuf/message.h\"\n+#include \"google/protobuf/message_lite.h\"\n #include \"xla/tsl/platform/env_time.h\"\n-#include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/file_statistics.h\"\n #include \"xla/tsl/platform/file_system.h\"\n #include \"xla/tsl/platform/macros.h\"\n-#include \"xla/tsl/platform/status.h\"\n-#include \"xla/tsl/platform/types.h\"\n #include \"tsl/platform/numa.h\"\n-#include \"tsl/platform/platform.h\"\n #include \"tsl/platform/protobuf.h\"\n-#include \"tsl/platform/stringpiece.h\"\n \n // Delete leaked Windows definitions.\n #ifdef PLATFORM_WINDOWS\n@@ -665,7 +665,7 @@ absl::Status ReadBinaryProto(Env* env, const std::string& fname,\n inline absl::Status WriteTextProto(Env* /* env */,\n                                    const std::string& /* fname */,\n                                    const protobuf::MessageLite& /* proto */) {\n-  return errors::Unimplemented(\"Can't write text protos with protolite.\");\n+  return absl::UnimplementedError(\"Can't write text protos with protolite.\");\n }\n absl::Status WriteTextProto(Env* env, const std::string& fname,\n                             const protobuf::Message& proto);\n@@ -675,7 +675,7 @@ absl::Status WriteTextProto(Env* env, const std::string& fname,\n inline absl::Status ReadTextProto(Env* /* env */,\n                                   const std::string& /* fname */,\n                                   protobuf::MessageLite* /* proto */) {\n-  return errors::Unimplemented(\"Can't parse text protos with protolite.\");\n+  return absl::UnimplementedError(\"Can't parse text protos with protolite.\");\n }\n absl::Status ReadTextProto(Env* env, const std::string& fname,\n                            protobuf::Message* proto);"
        },
        {
            "sha": "74c1e19a2273a4eefdce80359a6da77b1b942c86",
            "filename": "third_party/xla/xla/tsl/platform/ram_file_system.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fram_file_system.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fram_file_system.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fplatform%2Fram_file_system.h?ref=13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
            "patch": "@@ -105,7 +105,7 @@ class RamRandomAccessFile : public RandomAccessFile, public WritableFile {\n \n   absl::Status Tell(int64_t* position) override {\n     *position = -1;\n-    return errors::Unimplemented(\"This filesystem does not support Tell()\");\n+    return absl::UnimplementedError(\"This filesystem does not support Tell()\");\n   }\n \n  private:\n@@ -176,7 +176,7 @@ class RamFileSystem : public FileSystem {\n   absl::Status NewReadOnlyMemoryRegionFromFile(\n       const std::string& fname, TransactionToken* token,\n       std::unique_ptr<ReadOnlyMemoryRegion>* result) override {\n-    return errors::Unimplemented(\"\");\n+    return absl::UnimplementedError(\"\");\n   }\n \n   absl::Status FileExists(const std::string& fname_,"
        },
        {
            "sha": "5d88c42e54299fee41202586b53789f35f702870",
            "filename": "third_party/xla/xla/tsl/util/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2FBUILD?ref=13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
            "patch": "@@ -145,6 +145,8 @@ cc_library(\n         \"//xla/tsl/platform:byte_order\",\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:status\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/strings\",\n     ],\n )\n "
        },
        {
            "sha": "33d21c438b6f941aef242be6e47d20e150ccbd4b",
            "filename": "third_party/xla/xla/tsl/util/byte_swap_array.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2Fbyte_swap_array.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/13d523c8ee7e36c68374417ea9ea3b95e8391f7d/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2Fbyte_swap_array.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Futil%2Fbyte_swap_array.cc?ref=13d523c8ee7e36c68374417ea9ea3b95e8391f7d",
            "patch": "@@ -15,9 +15,11 @@ limitations under the License.\n \n #include \"xla/tsl/util/byte_swap_array.h\"\n \n+#include <cstddef>\n #include <cstdint>\n \n-#include \"xla/tsl/platform/errors.h\"\n+#include \"absl/status/status.h\"\n+#include \"absl/strings/str_cat.h\"\n #include \"xla/tsl/util/safe_reinterpret_cast.h\"\n \n namespace tsl {\n@@ -46,8 +48,8 @@ absl::Status ByteSwapArray(char* array, size_t bytes_per_elem, int array_len) {\n     }\n     return absl::OkStatus();\n   } else {\n-    return errors::Unimplemented(\"Byte-swapping of \", bytes_per_elem,\n-                                 \"-byte values not supported.\");\n+    return absl::UnimplementedError(absl::StrCat(\n+        \"Byte-swapping of \", bytes_per_elem, \"-byte values not supported.\"));\n   }\n }\n "
        }
    ],
    "stats": {
        "total": 79,
        "additions": 58,
        "deletions": 21
    }
}