{
    "author": "tensorflower-gardener",
    "message": "Add a protobuf to capture benchmark results.\n\nPiperOrigin-RevId: 798357657",
    "sha": "a6e54152841a86b711343c4c35ef1f614704ec08",
    "files": [
        {
            "sha": "1249b5c01e321f718c814d6426389d2adb9d8a99",
            "filename": "tensorflow/lite/CMakeLists.txt",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2FCMakeLists.txt",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2FCMakeLists.txt",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2FCMakeLists.txt?ref=a6e54152841a86b711343c4c35ef1f614704ec08",
            "patch": "@@ -841,6 +841,9 @@ set(TFLITE_GENERATED_HEADERS_DIR ${CMAKE_BINARY_DIR}/tensorflow/lite)\n # Add the profiling proto directory.\n add_subdirectory(${TFLITE_SOURCE_DIR}/profiling/proto)\n \n+# Add the benchmark result proto directory.\n+add_subdirectory(${TFLITE_SOURCE_DIR}/tools/benchmark/proto)\n+\n # Add the tf example directory.\n add_subdirectory(${TF_SOURCE_DIR}/core/example ${CMAKE_BINARY_DIR}/example_proto_generated)\n "
        },
        {
            "sha": "aee420c6a52b9f678eaef9cab87cab5f7198e09e",
            "filename": "tensorflow/lite/tools/benchmark/CMakeLists.txt",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2Ftools%2Fbenchmark%2FCMakeLists.txt",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2Ftools%2Fbenchmark%2FCMakeLists.txt",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Ftools%2Fbenchmark%2FCMakeLists.txt?ref=a6e54152841a86b711343c4c35ef1f614704ec08",
            "patch": "@@ -51,6 +51,7 @@ list(APPEND TFLITE_BENCHMARK_LIBS\n   feature_proto\n   example_proto\n   model_runtime_info_proto\n+  benchmark_result_proto\n   protobuf::libprotobuf\n   absl::log\n )"
        },
        {
            "sha": "9eff6982b4d1ad4ff7405edc891e7c701e1d6179",
            "filename": "tensorflow/lite/tools/benchmark/proto/BUILD",
            "status": "added",
            "additions": 34,
            "deletions": 0,
            "changes": 34,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2FBUILD?ref=a6e54152841a86b711343c4c35ef1f614704ec08",
            "patch": "@@ -0,0 +1,34 @@\n+# Placeholder: load py_proto_library\n+# Placeholder: load proto_library\n+load(\"//tensorflow:tensorflow.default.bzl\", \"get_compatible_with_portable\")\n+load(\n+    \"//tensorflow/core/platform:build_config.bzl\",\n+    \"tf_proto_library\",\n+)\n+\n+package(\n+    # copybara:uncomment default_applicable_licenses = [\"//tensorflow:license\"],\n+    default_visibility = [\"//visibility:public\"],\n+    licenses = [\"notice\"],\n+)\n+\n+proto_library(\n+    name = \"benchmark_result_proto\",\n+    srcs = [\"benchmark_result.proto\"],\n+    compatible_with = get_compatible_with_portable(),\n+    visibility = [\"//visibility:public\"],\n+)\n+\n+tf_proto_library(\n+    name = \"benchmark_result\",  # bzl adds _py for python proto library\n+    srcs = [\"benchmark_result.proto\"],\n+    visibility = [\"//visibility:public\"],\n+)\n+\n+# copybara:uncomment_begin(google-only)\n+# py_proto_library(\n+#     name = \"benchmark_result_py_pb2\",\n+#     compatible_with = get_compatible_with_portable(),\n+#     deps = [\":benchmark_result_proto\"],\n+# )\n+# copybara:uncomment_end"
        },
        {
            "sha": "12a7e577bd3277c4308e438e98173ddeea90b3e9",
            "filename": "tensorflow/lite/tools/benchmark/proto/CMakeLists.txt",
            "status": "added",
            "additions": 36,
            "deletions": 0,
            "changes": 36,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2FCMakeLists.txt",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2FCMakeLists.txt",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2FCMakeLists.txt?ref=a6e54152841a86b711343c4c35ef1f614704ec08",
            "patch": "@@ -0,0 +1,36 @@\n+#\n+# Copyright 2025 The TensorFlow Authors. All Rights Reserved.\n+#\n+# Licensed under the Apache License, Version 2.0 (the \"License\");\n+# you may not use this file except in compliance with the License.\n+# You may obtain a copy of the License at\n+#\n+#      https://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+find_package(Protobuf REQUIRED)\n+\n+add_library(benchmark_result_proto benchmark_result.proto)\n+\n+list(APPEND benchmark_result_generated_files\n+    ${CMAKE_BINARY_DIR}/tflite/tools/benchmark/proto/benchmark_result.pb.cc\n+    ${CMAKE_BINARY_DIR}/tflite/tools/benchmark/proto/benchmark_result.pb.h)\n+\n+# Generate benchmark_result.pb.cc and benchmark_result.pb.h from\n+# benchmark_result.proto using protoc. Once the protobuf package version is\n+# upgraded, we can use protobuf_generate_cpp/protobuf_generate here directly.\n+add_custom_command(\n+    OUTPUT ${benchmark_result_generated_files}\n+    COMMAND ${Protobuf_PROTOC_EXECUTABLE}\n+    ARGS --cpp_out=${CMAKE_BINARY_DIR} --proto_path=${CMAKE_CURRENT_SOURCE_DIR}/../../../.. tflite/tools/benchmark/proto/benchmark_result.proto\n+    DEPENDS ${Protobuf_PROTOC_EXECUTABLE} ${CMAKE_CURRENT_SOURCE_DIR}/benchmark_result.proto\n+)\n+\n+set_source_files_properties(${benchmark_result_generated_files} PROPERTIES GENERATED TRUE)\n+target_sources(benchmark_result_proto PRIVATE ${benchmark_result_generated_files})\n+target_link_libraries(benchmark_result_proto protobuf::libprotobuf)\n+target_include_directories(benchmark_result_proto PUBLIC ${CMAKE_BINARY_DIR})"
        },
        {
            "sha": "ab0c5d2588eb8ce82918350aa3c8f3201b51500f",
            "filename": "tensorflow/lite/tools/benchmark/proto/benchmark_result.proto",
            "status": "added",
            "additions": 58,
            "deletions": 0,
            "changes": 58,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2Fbenchmark_result.proto",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a6e54152841a86b711343c4c35ef1f614704ec08/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2Fbenchmark_result.proto",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2Fbenchmark_result.proto?ref=a6e54152841a86b711343c4c35ef1f614704ec08",
            "patch": "@@ -0,0 +1,58 @@\n+syntax = \"proto2\";\n+\n+package tflite.tools.benchmark;\n+\n+option java_multiple_files = true;\n+option java_package = \"tflite.tools.benchmark\";\n+\n+// Next ID: 11\n+message LatencyMetrics {\n+  // Note all fields defined here refers to wall time by default.\n+  optional float avg_ms = 1;\n+  optional float min_ms = 2;\n+  optional float max_ms = 3;\n+  optional float stddev_ms = 4;\n+  optional float median_ms = 5;\n+  optional float p5_ms = 6;\n+  optional float p95_ms = 7;\n+  optional float init_ms = 8;\n+  optional float first_inference_ms = 9;\n+  optional float average_warm_up_ms = 10;\n+}\n+\n+// Next ID: 4\n+message MemoryMetrics {\n+  // The amount of memory allocated during model initialization. This is the\n+  // delta of memory footprint after the model has been loaded and interpreter\n+  // has been created, compared to the memory footprint at the beginning of the\n+  // benchmark tool.\n+  optional int64 init_footprint_kb = 1;\n+\n+  // The memory allocated during the model initialization and execution.\n+  // This is the delta of memory footprint after the model has been intialized\n+  // and executed, compared to the memory footprint at the beginning of the\n+  // benchmark tool.\n+  optional int64 overall_footprint_kb = 2;\n+\n+  // Peak memory usage (in megabytes).\n+  optional float peak_mem_mb = 3;\n+}\n+\n+// Next ID: 5\n+message MiscMetrics {\n+  optional float model_size_mb = 1;\n+  optional int32 num_runs = 2;\n+  optional int32 num_warmup_runs = 3;\n+  // Model throughput in megabytes per second. This is the average throughput\n+  // of the model over all the inferences.\n+  optional float model_throughput_in_mb_per_sec = 4;\n+}\n+\n+// Next ID: 5\n+message BenchmarkResult {\n+  // The name representing the configuration of the benchmark run.\n+  optional string name = 1;\n+  optional LatencyMetrics latency_metrics = 2;\n+  optional MemoryMetrics memory_metrics = 3;\n+  optional MiscMetrics misc_metrics = 4;\n+}"
        }
    ],
    "stats": {
        "total": 132,
        "additions": 132,
        "deletions": 0
    }
}