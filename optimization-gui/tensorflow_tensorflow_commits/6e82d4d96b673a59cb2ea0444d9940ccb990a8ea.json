{
    "author": "tensorflower-gardener",
    "message": "Add call to `ynn_optimize_subgraph`\n\nThis currently happens implicitly in `ynn_create_runtime`, but that will not be the case soon. (Calling it multiple times is harmless.)\n\nPiperOrigin-RevId: 824754921",
    "sha": "6e82d4d96b673a59cb2ea0444d9940ccb990a8ea",
    "files": [
        {
            "sha": "eefee29600ac6a2d44061354b9498f3e04fa0c0e",
            "filename": "third_party/xla/xla/backends/cpu/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/6e82d4d96b673a59cb2ea0444d9940ccb990a8ea/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/6e82d4d96b673a59cb2ea0444d9940ccb990a8ea/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2FBUILD?ref=6e82d4d96b673a59cb2ea0444d9940ccb990a8ea",
            "patch": "@@ -161,6 +161,7 @@ cc_library(\n         \"//xla/backends/cpu/runtime/ynnpack:ynn_interop\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/stream_executor:device_memory\",\n+        \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:logging\",\n         \"//xla/tsl/platform:statusor\",\n         \"@XNNPACK//ynnpack\","
        },
        {
            "sha": "bd7fbe651a23ed69726c8c1736e2c40a83928d8d",
            "filename": "third_party/xla/xla/backends/cpu/ynn_emitter.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/6e82d4d96b673a59cb2ea0444d9940ccb990a8ea/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/6e82d4d96b673a59cb2ea0444d9940ccb990a8ea/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_emitter.cc?ref=6e82d4d96b673a59cb2ea0444d9940ccb990a8ea",
            "patch": "@@ -40,6 +40,7 @@ limitations under the License.\n #include \"xla/primitive_util.h\"\n #include \"xla/shape.h\"\n #include \"xla/stream_executor/device_memory.h\"\n+#include \"xla/tsl/platform/errors.h\"\n #include \"xla/tsl/platform/logging.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/util.h\"\n@@ -285,6 +286,10 @@ static absl::StatusOr<YnnSubgraph> EmitYnnSubgraph(\n     }\n   }\n \n+  ynn_status status = ynn_optimize_subgraph(\n+      subgraph.get(), /*threadpool=*/nullptr, /*flags=*/0);\n+  TF_RETURN_IF_ERROR(YnnStatusToStatus(status));\n+\n   return subgraph;\n }\n "
        }
    ],
    "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
    }
}