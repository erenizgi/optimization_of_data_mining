{
    "author": "junwhanahn",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 850925755",
    "sha": "8d95b9424ac4ae8bf996d730421825b937c2d6ef",
    "files": [
        {
            "sha": "8df3a018d4372a69f4d00c9088f84b9497600d16",
            "filename": "third_party/xla/xla/python/ifrt/ir/transforms/multi_threaded_atom_program_compiler.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8d95b9424ac4ae8bf996d730421825b937c2d6ef/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fir%2Ftransforms%2Fmulti_threaded_atom_program_compiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8d95b9424ac4ae8bf996d730421825b937c2d6ef/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fir%2Ftransforms%2Fmulti_threaded_atom_program_compiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fir%2Ftransforms%2Fmulti_threaded_atom_program_compiler.cc?ref=8d95b9424ac4ae8bf996d730421825b937c2d6ef",
            "patch": "@@ -50,6 +50,7 @@ limitations under the License.\n #include \"xla/service/computation_placer.h\"\n #include \"xla/service/hlo.pb.h\"\n #include \"xla/status_macros.h\"\n+#include \"xla/tsl/concurrency/future.h\"\n #include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/platform/threadpool.h\"\n@@ -179,7 +180,7 @@ absl::StatusOr<CompileFuture> MultiThreadedAtomProgramCompiler::CompileXla(\n   auto hlo_program = std::make_unique<HloProgram>(\n       /*context=*/nullptr,  // Shares the same long-living context.\n       mlir::OwningOpRef<mlir::ModuleOp>(module_op.clone()));\n-  auto [promise, future] = CompileFuture::MakePromise();\n+  auto [promise, future] = tsl::MakePromise<AtomProgramCompileResult>();\n   tsl::Env::Default()->StartDetachedThread(\n       tsl::ThreadOptions(), /*name=*/\"MultiThreadedAtomProgramCompiler\",\n       WithCurrentUserContext([this, hlo_program = std::move(hlo_program),\n@@ -221,7 +222,7 @@ MultiThreadedAtomProgramCompiler::CompileMpmdReshard(mlir::ModuleOp module_op) {\n         << \"Unsupported return type `\" << mlir::debugString(result_type) << \"`\";\n     out_arrays_types.push_back(array_type);\n   }\n-  auto [promise, future] = CompileFuture::MakePromise();\n+  auto [promise, future] = tsl::MakePromise<AtomProgramCompileResult>();\n   // No need to dispatch from a different thread because MpmdReshard uses its\n   // own thread pool already.\n   auto compile_result = compiler_->CompileMpmdReshard("
        }
    ],
    "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
    }
}