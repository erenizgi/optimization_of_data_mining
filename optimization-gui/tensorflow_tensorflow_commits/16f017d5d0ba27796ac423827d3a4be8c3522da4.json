{
    "author": "unknown",
    "message": "[XLA] Remove TF_ prefix from TF_{ASSERT,EXPECT}_OK\n\nPiperOrigin-RevId: 839751744",
    "sha": "16f017d5d0ba27796ac423827d3a4be8c3522da4",
    "files": [
        {
            "sha": "c5ae2b2b62ec181b459a17668d8ced4607d849c3",
            "filename": "third_party/xla/xla/service/gpu/transforms/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2FBUILD?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -916,19 +916,14 @@ xla_cc_test(\n     name = \"cudnn_simplify_padding_test\",\n     srcs = [\"cudnn_simplify_padding_test.cc\"],\n     deps = [\n-        \":cudnn_pad_for_convolutions\",\n         \":cudnn_simplify_padding\",\n         \"//xla:literal\",\n         \"//xla:util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/hlo/pass:hlo_pass\",\n-        \"//xla/hlo/pass:hlo_pass_pipeline\",\n         \"//xla/hlo/testlib:hlo_hardware_independent_test_base\",\n         \"//xla/hlo/testlib:pattern_matcher_gmock\",\n         \"//xla/hlo/transforms/simplifiers:algebraic_simplifier\",\n-        \"//xla/hlo/transforms/simplifiers:reshape_mover\",\n-        \"//xla/hlo/transforms/simplifiers:tuple_simplifier\",\n-        \"//xla/service:call_inliner\",\n         \"//xla/service:pattern_matcher\",\n         \"//xla/stream_executor:dnn\",\n         \"//xla/stream_executor/cuda:cuda_compute_capability\","
        },
        {
            "sha": "cc9a0c29566f825a9265c3165dc4fb0eae0a79a2",
            "filename": "third_party/xla/xla/service/gpu/transforms/alias_passthrough_params_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Falias_passthrough_params_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Falias_passthrough_params_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Falias_passthrough_params_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -15,6 +15,7 @@ limitations under the License.\n \n #include \"xla/service/gpu/transforms/alias_passthrough_params.h\"\n \n+#include <gmock/gmock.h>\n #include <gtest/gtest.h>\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n #include \"xla/tsl/lib/core/status_test_util.h\"\n@@ -72,9 +73,9 @@ TEST_F(AliasPassthroughParamsTest, PresetAliases) {\n   // Presetting an alias for p0 -> Sum. This could happen in a case of\n   // `alias_resource_update`.\n   auto& preset_alias = module->input_output_alias_config();\n-  TF_EXPECT_OK(preset_alias.SetUpAlias(/*output_index=*/{1},\n-                                       /*param_number=*/0,\n-                                       /*param_index=*/{}));\n+  EXPECT_OK(preset_alias.SetUpAlias(/*output_index=*/{1},\n+                                    /*param_number=*/0,\n+                                    /*param_index=*/{}));\n \n   EXPECT_TRUE(AliasPassthroughParams().Run(module.get()).value());\n   const auto& alias_result = module->input_output_alias_config();"
        },
        {
            "sha": "1f1ab7f58ea265aa925157cc61f13058b3da9cca",
            "filename": "third_party/xla/xla/service/gpu/transforms/collectives/all_reduce_decomposer_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fall_reduce_decomposer_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fall_reduce_decomposer_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fall_reduce_decomposer_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -17,6 +17,7 @@ limitations under the License.\n \n #include <memory>\n \n+#include <gmock/gmock.h>\n #include <gtest/gtest.h>\n #include \"absl/log/log.h\"\n #include \"xla/hlo/testlib/filecheck.h\"\n@@ -52,8 +53,8 @@ ENTRY main {\n   AllReduceDecomposer decomposer;\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, decomposer.Run(module.get(), {}));\n   EXPECT_TRUE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n-  TF_EXPECT_OK(HloCSE(true).Run(module.get()));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(HloCSE(true).Run(module.get()));\n \n   EXPECT_TRUE(*RunFileCheck(module->ToString(), R\"(\n     // CHECK: f32[1,16]{1,0} reshape"
        },
        {
            "sha": "636b59c0968894e176a95a7e5ffa81ab38e159b2",
            "filename": "third_party/xla/xla/service/gpu/transforms/collectives/all_reduce_splitter_test.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fall_reduce_splitter_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fall_reduce_splitter_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fall_reduce_splitter_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -54,21 +54,21 @@ class AllReduceSplitterTest : public HloHardwareIndependentTestBase {\n     return ParseAndReturnVerifiedModule(hlo_module, config);\n   }\n \n-  size_t AllReduceCount(const HloModule &module) {\n+  size_t AllReduceCount(const HloModule& module) {\n     return CollectiveCount(module, HloOpcode::kAllReduce);\n   }\n \n  private:\n-  size_t CollectiveCount(const HloModule &module, HloOpcode opcode) {\n+  size_t CollectiveCount(const HloModule& module, HloOpcode opcode) {\n     return absl::c_count_if(\n         module.entry_computation()->instructions(),\n-        [&opcode](HloInstruction *instr) { return instr->opcode() == opcode; });\n+        [&opcode](HloInstruction* instr) { return instr->opcode() == opcode; });\n   }\n };\n \n class AllReduceSplitterFilecheckTest : public AllReduceSplitterTest {\n  public:\n-  absl::Status FileCheck(const std::string &hlo_text,\n+  absl::Status FileCheck(const std::string& hlo_text,\n                          absl::string_view pattern) {\n     TF_ASSIGN_OR_RETURN(bool matched, RunFileCheck(hlo_text, pattern));\n     if (!matched) {\n@@ -112,7 +112,7 @@ ENTRY main {\n \n   EXPECT_THAT(AllReduceSplitter().Run(module.get()),\n               absl_testing::IsOkAndHolds(true));\n-  TF_EXPECT_OK(FileCheck(module->ToString(), R\"(\n+  EXPECT_OK(FileCheck(module->ToString(), R\"(\n     CHECK-DAG:    %[[P0:.*]] = bf16[2,4096,4096]{2,1,0} parameter(0)\n     CHECK:        %[[AR0:.*]] = bf16[2,4096,4096]{2,1,0} all-reduce(%[[P0]])\n     CHECK-SAME:   replica_groups={[[DESIRED_RGS:.*]]}\n@@ -200,7 +200,7 @@ ENTRY main {\n \n   EXPECT_THAT(AllReduceSplitter().Run(module.get()),\n               absl_testing::IsOkAndHolds(true));\n-  TF_EXPECT_OK(FileCheck(module->ToString(), R\"(\n+  EXPECT_OK(FileCheck(module->ToString(), R\"(\n     CHECK-DAG:    %[[P0:.*]] = bf16[2,4096,4096]{2,1,0} parameter(0)\n     CHECK-DAG:    %[[ZERO:.*]] = bf16[] constant(0)\n     CHECK-DAG:    %[[LOCAL_REDUCE:.*]] = bf16[4096]{0} reduce(%[[P0]], %[[ZERO]])\n@@ -442,7 +442,7 @@ ENTRY main {\n   pipeline.AddPass<AllReduceSplitter>();\n   pipeline.AddPass<ReduceScatterCreator>();\n   EXPECT_THAT(pipeline.Run(module.get()), absl_testing::IsOkAndHolds(true));\n-  TF_EXPECT_OK(FileCheck(module->ToString(), R\"(\n+  EXPECT_OK(FileCheck(module->ToString(), R\"(\n     CHECK-DAG:    %[[P0:.*]] = bf16[2,4096,4096]{2,1,0} parameter(0)\n     CHECK:        %[[AR0:.*]] = bf16[2,4096,4096]{2,1,0} all-reduce(%[[P0]])\n     CHECK-SAME:   replica_groups={[[DESIRED_RGS:.*]]}\n@@ -493,7 +493,7 @@ ENTRY main {\n   pipeline.AddPass<AllReduceSplitter>();\n   pipeline.AddPass<ReduceScatterCreator>();\n   EXPECT_THAT(pipeline.Run(module.get()), absl_testing::IsOkAndHolds(true));\n-  TF_EXPECT_OK(FileCheck(module->ToString(), R\"(\n+  EXPECT_OK(FileCheck(module->ToString(), R\"(\n     CHECK-DAG:    %[[P0:.*]] = bf16[2,4096,4096]{2,1,0} parameter(0)\n     CHECK-DAG:    %[[ZERO:.*]] = bf16[] constant(0)\n     CHECK-DAG:    %[[LOCAL_REDUCE:.*]] = bf16[4096]{0} reduce(%[[P0]], %[[ZERO]])"
        },
        {
            "sha": "1ff9b780cb5bbd1a73866f666d5e0449950554b0",
            "filename": "third_party/xla/xla/service/gpu/transforms/collectives/collective_permute_cycle_decomposer_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fcollective_permute_cycle_decomposer_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fcollective_permute_cycle_decomposer_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fcollective_permute_cycle_decomposer_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -79,7 +79,7 @@ TEST_F(CollectivePermuteCycleDecomposerTest, NoCycle_NotTransformed) {\n         source_target_pairs={{0,0}}\n     }\n   )\";\n-  TF_ASSERT_OK(RunAndCheckHloRewrite(kHlo, Decomposer(0), false));\n+  ASSERT_OK(RunAndCheckHloRewrite(kHlo, Decomposer(0), false));\n }\n \n TEST_F(CollectivePermuteCycleDecomposerTest, HonorsThreshold) {\n@@ -95,9 +95,9 @@ TEST_F(CollectivePermuteCycleDecomposerTest, HonorsThreshold) {\n     }\n   )\";\n \n-  TF_ASSERT_OK(RunAndCheckHloRewrite(hlo, Decomposer(33), false));\n-  TF_ASSERT_OK(RunAndCheckHloRewrite(hlo, Decomposer(32), true));\n-  TF_ASSERT_OK(RunAndCheckHloRewrite(hlo, Decomposer(16), true));\n+  ASSERT_OK(RunAndCheckHloRewrite(hlo, Decomposer(33), false));\n+  ASSERT_OK(RunAndCheckHloRewrite(hlo, Decomposer(32), true));\n+  ASSERT_OK(RunAndCheckHloRewrite(hlo, Decomposer(16), true));\n }\n \n TEST_F(CollectivePermuteCycleDecomposerTest, ForwardCycle) {"
        },
        {
            "sha": "4bfcda5146d68f2294907949c06bd841d90fa1d9",
            "filename": "third_party/xla/xla/service/gpu/transforms/collectives/collective_pipelining_analyzer_test.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 20,
            "changes": 31,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fcollective_pipelining_analyzer_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fcollective_pipelining_analyzer_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fcollective_pipelining_analyzer_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -17,6 +17,7 @@ limitations under the License.\n \n #include <memory>\n \n+#include <gmock/gmock.h>\n #include <gtest/gtest.h>\n #include \"absl/strings/string_view.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n@@ -92,8 +93,7 @@ ENTRY main {\n   config.set_use_spmd_partitioning(true);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* ar = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),\n@@ -155,8 +155,7 @@ ENTRY main {\n   config.set_num_partitions(8);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* ar = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),\n@@ -220,8 +219,7 @@ ENTRY main {\n   config.set_num_partitions(8);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* ar = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),\n@@ -285,8 +283,7 @@ ENTRY main {\n   config.set_num_partitions(8);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* ar = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),\n@@ -349,8 +346,7 @@ ENTRY main {\n   config.set_num_partitions(8);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* rs = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),\n@@ -415,8 +411,7 @@ ENTRY main {\n   config.set_num_partitions(8);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* rs = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),\n@@ -481,8 +476,7 @@ ENTRY main {\n   config.set_num_partitions(8);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* rs = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),\n@@ -541,8 +535,7 @@ ENTRY main {\n   config.set_num_partitions(8);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* ag = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),\n@@ -604,8 +597,7 @@ ENTRY main {\n   config.set_num_partitions(8);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* ag = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),\n@@ -666,8 +658,7 @@ ENTRY main {\n   config.set_num_partitions(8);\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo, config));\n-  TF_ASSERT_OK(\n-      CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n+  ASSERT_OK(CollectivePipeliningAnalyzer(/*pointer_size=*/4).Run(module.get()));\n \n   HloInstruction* ag = hlo_query::FindInstruction(\n       module->entry_computation()->root_instruction()->while_body(),"
        },
        {
            "sha": "d5205bbf308f9860f4143338fd76804dc7869f93",
            "filename": "third_party/xla/xla/service/gpu/transforms/collectives/collective_select_folder_test.cc",
            "status": "modified",
            "additions": 15,
            "deletions": 15,
            "changes": 30,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fcollective_select_folder_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fcollective_select_folder_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fcollective_select_folder_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -245,19 +245,19 @@ TEST_F(CollectiveSelectFolderTest, CommutativeCompare) {\n TEST_F(CollectiveSelectFolderTest, MoreThanOnePair_NotTransformed) {\n   // The cp contains sources 0 and 1, and therefore doesn't match\n   // equal(1) and not equal(1)\n-  TF_ASSERT_OK(RunAndCheckHloRewrite(kSelectBasecase, CollectiveSelectFolder(),\n-                                     /*expect_change=*/false,\n-                                     {{\"$device_id_constant\", \"1\"},\n-                                      {\"$direction\", \"EQ\"},\n-                                      {\"$pairs\", \"{{0,1},{1,2}}\"}}));\n+  ASSERT_OK(RunAndCheckHloRewrite(kSelectBasecase, CollectiveSelectFolder(),\n+                                  /*expect_change=*/false,\n+                                  {{\"$device_id_constant\", \"1\"},\n+                                   {\"$direction\", \"EQ\"},\n+                                   {\"$pairs\", \"{{0,1},{1,2}}\"}}));\n \n   // The cp contains sources 0 and 1, and therefore doesn't match\n   // not_equal(1) and not not_equal(1)\n-  TF_ASSERT_OK(RunAndCheckHloRewrite(kSelectBasecase, CollectiveSelectFolder(),\n-                                     /*expect_change=*/false,\n-                                     {{\"$device_id_constant\", \"1\"},\n-                                      {\"$direction\", \"NE\"},\n-                                      {\"$pairs\", \"{{0,1},{1,2}}\"}}));\n+  ASSERT_OK(RunAndCheckHloRewrite(kSelectBasecase, CollectiveSelectFolder(),\n+                                  /*expect_change=*/false,\n+                                  {{\"$device_id_constant\", \"1\"},\n+                                   {\"$direction\", \"NE\"},\n+                                   {\"$pairs\", \"{{0,1},{1,2}}\"}}));\n }\n \n const char* kSelectNoBroadcast = R\"(\n@@ -302,7 +302,7 @@ TEST_F(CollectiveSelectFolderTest, NegatedPredicate_NotTransformed) {\n           source_target_pairs={{3,0}}, channel_id=1\n     }\n   )\";\n-  TF_ASSERT_OK(ExpectNoTranform(kHlo));\n+  ASSERT_OK(ExpectNoTranform(kHlo));\n }\n \n TEST_F(CollectiveSelectFolderTest, ReplicaIdChannelIdMismatch_NotTransformed) {\n@@ -320,7 +320,7 @@ TEST_F(CollectiveSelectFolderTest, ReplicaIdChannelIdMismatch_NotTransformed) {\n           source_target_pairs={{0,1}}\n     }\n   )\";\n-  TF_ASSERT_OK(ExpectNoTranform(hlo));\n+  ASSERT_OK(ExpectNoTranform(hlo));\n }\n \n TEST_F(CollectiveSelectFolderTest, PartIdChannelIdMismatch_NotTransformed) {\n@@ -338,7 +338,7 @@ TEST_F(CollectiveSelectFolderTest, PartIdChannelIdMismatch_NotTransformed) {\n           source_target_pairs={{0,1}}\n     }\n   )\";\n-  TF_ASSERT_OK(ExpectNoTranform(hlo));\n+  ASSERT_OK(ExpectNoTranform(hlo));\n }\n \n TEST_F(CollectiveSelectFolderTest, WrongNesting_NotTransformed) {\n@@ -357,7 +357,7 @@ TEST_F(CollectiveSelectFolderTest, WrongNesting_NotTransformed) {\n           source_target_pairs={{0,1}}\n     }\n   )\";\n-  TF_ASSERT_OK(ExpectNoTranform(hlo));\n+  ASSERT_OK(ExpectNoTranform(hlo));\n }\n \n // This select predicate operates on `replica-id` while the two collectives are\n@@ -389,7 +389,7 @@ TEST_F(CollectiveSelectFolderTest,\n           cp.forward)\n     }\n   )\";\n-  TF_ASSERT_OK(ExpectNoTranform(kHlo));\n+  ASSERT_OK(ExpectNoTranform(kHlo));\n }\n \n // This select predicate operates on `partition-id` with collectives in the same"
        },
        {
            "sha": "40481fe59cfd36705336ac14abcac40fdf282ce0",
            "filename": "third_party/xla/xla/service/gpu/transforms/collectives/convert_async_collectives_to_sync_test.cc",
            "status": "modified",
            "additions": 18,
            "deletions": 18,
            "changes": 36,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fconvert_async_collectives_to_sync_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fconvert_async_collectives_to_sync_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcollectives%2Fconvert_async_collectives_to_sync_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -40,16 +40,16 @@ using ::testing::IsTrue;\n class GpuConvertAsyncCollectivesToSyncTest\n     : public HloHardwareIndependentTestBase {\n  public:\n-  absl::Status RunPass(HloModule *module, bool expect_change) {\n+  absl::Status RunPass(HloModule* module, bool expect_change) {\n     TF_ASSIGN_OR_RETURN(bool changed,\n                         GpuConvertAsyncCollectivesToSync().Run(module));\n     EXPECT_EQ(changed, expect_change);\n     return absl::OkStatus();\n   }\n \n   // Returns true if the instruction with the given name is synchronous.\n-  bool IsSync(HloModule *module, absl::string_view name) {\n-    const HloInstruction *inst = FindInstruction(module, name);\n+  bool IsSync(HloModule* module, absl::string_view name) {\n+    const HloInstruction* inst = FindInstruction(module, name);\n     if (inst == nullptr) {\n       return false;\n     }\n@@ -82,7 +82,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleAllReduce) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"start\"), IsTrue());\n }\n \n@@ -105,7 +105,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleAllReduceWithNop) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"start\"), IsTrue());\n }\n TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleCollectiveBroadcast) {\n@@ -125,7 +125,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleCollectiveBroadcast) {\n   )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"cb-start\"), IsTrue());\n }\n \n@@ -148,7 +148,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleAllReduceWithNonNop) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/false));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/false));\n }\n \n TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleAllGather) {\n@@ -161,7 +161,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleAllGather) {\n   })\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"ags\"), IsTrue());\n }\n \n@@ -176,7 +176,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleCollectivePermute) {\n   })\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"start\"), IsTrue());\n }\n \n@@ -204,7 +204,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleReduceScatter) {\n   )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"rs-start\"), IsTrue());\n }\n \n@@ -226,7 +226,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, SimpleAllToAll) {\n \n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"a2a-start\"), IsTrue());\n }\n \n@@ -251,7 +251,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, ControlDeps) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"start1\"), IsTrue());\n   EXPECT_THAT(IsSync(module.get(), \"start2\"), IsTrue());\n }\n@@ -279,7 +279,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, MultipleInFlightStreaming) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"start1\"), IsTrue());\n   EXPECT_THAT(IsSync(module.get(), \"start2\"), IsTrue());\n }\n@@ -306,7 +306,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, MultipleInFlightNested) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"start1\"), IsTrue());\n   EXPECT_THAT(IsSync(module.get(), \"start2\"), IsTrue());\n }\n@@ -335,7 +335,7 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest, MultipleInFlightNestedPartial) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"start1\"), IsFalse());\n   EXPECT_THAT(IsSync(module.get(), \"start2\"), IsTrue());\n }\n@@ -360,15 +360,15 @@ TEST_F(GpuConvertAsyncCollectivesToSyncTest,\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto module,\n                           ParseAndReturnVerifiedModule(hlo_string));\n-  const HloInstruction *inst_orig = FindInstruction(module.get(), \"start\");\n+  const HloInstruction* inst_orig = FindInstruction(module.get(), \"start\");\n   const CollectiveBackendConfig backend_config_orig =\n       inst_orig->backend_config<GpuBackendConfig>()\n           .value()\n           .collective_backend_config();\n \n-  TF_ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n+  ASSERT_OK(RunPass(module.get(), /*expect_change=*/true));\n   EXPECT_THAT(IsSync(module.get(), \"start\"), IsTrue());\n-  const HloInstruction *inst = FindInstruction(module.get(), \"start\");\n+  const HloInstruction* inst = FindInstruction(module.get(), \"start\");\n   const CollectiveBackendConfig backend_config =\n       inst->backend_config<GpuBackendConfig>()\n           .value()"
        },
        {
            "sha": "83b5d59a54011c3690b83fe1d9ddd19b2aa041d3",
            "filename": "third_party/xla/xla/service/gpu/transforms/cudnn_fused_conv_rewriter_test.cc",
            "status": "modified",
            "additions": 91,
            "deletions": 91,
            "changes": 182,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcudnn_fused_conv_rewriter_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcudnn_fused_conv_rewriter_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcudnn_fused_conv_rewriter_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -158,7 +158,7 @@ class CudnnFusedConvRewriterTest : public GpuCodegenTest {\n         ParseAndReturnVerifiedModule(hlo_string, config).value(),\n         backend().default_stream_executor(), backend().memory_allocator());\n     if (!result.status().ok()) {\n-      TF_EXPECT_OK(result.status())\n+      EXPECT_OK(result.status())\n           << \"HLO compilation failed: \" << result.status();\n       return \"\";\n     }\n@@ -1622,9 +1622,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, TestConvInt8ToFloat) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   EXPECT_THAT(m->entry_computation()->root_instruction(),\n@@ -1655,13 +1655,13 @@ TEST_F(CudnnFusedConvRewriterHloTest, TestConvInt8ToInt8BiasSideInput) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   EXPECT_THAT(\n@@ -1695,13 +1695,13 @@ TEST_F(CudnnFusedConvRewriterHloTest,\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   EXPECT_THAT(\n@@ -1735,13 +1735,13 @@ TEST_F(CudnnFusedConvRewriterHloTest, TestReluAfterConvert) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -1788,13 +1788,13 @@ TEST_F(CudnnFusedConvRewriterHloTest, TestConvInt8ToFloatBiasSideInput) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   EXPECT_THAT(\n@@ -1833,16 +1833,16 @@ TEST_F(CudnnFusedConvRewriterHloTest, Int8SideInputWithScaleAndReshape) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   HloPassFix<HloPassPipeline> simplify(\"simplify\");\n   simplify.AddPass<AlgebraicSimplifier>(AlgebraicSimplifierOptions{});\n   simplify.AddPass<ReshapeMover>();\n   simplify.AddPass<ConvertMover>();\n-  TF_ASSERT_OK(RunHloPass(&simplify, m.get()).status());\n+  ASSERT_OK(RunHloPass(&simplify, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv = nullptr;\n@@ -1887,9 +1887,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseAlpha) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv = nullptr;\n@@ -1926,9 +1926,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseRelu) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -1966,9 +1966,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseReluIfMultipleUses) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2015,11 +2015,11 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseElu) {\n   m->mutable_config().set_debug_options(debug_opts);\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   // elu fusion is only active on Ampere+.\n   CudnnFusedConvRewriter fuser{se::CudaComputeCapability(8, 0), GetDnnVersion(),\n                                GetToolkitVersion()};\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2064,9 +2064,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseEluIfMultipleUses) {\n   m->mutable_config().set_debug_options(debug_opts);\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2116,11 +2116,11 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseRelu6) {\n   m->mutable_config().set_debug_options(debug_opts);\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   // relu6 fusion is only enabled on Ampere+.\n   CudnnFusedConvRewriter fuser{se::CudaComputeCapability(8, 0), GetDnnVersion(),\n                                GetToolkitVersion()};\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n   ASSERT_THAT(\n@@ -2160,9 +2160,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseRelu6IfMultipleUses) {\n   m->mutable_config().set_debug_options(debug_opts);\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2207,11 +2207,11 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseLeakyRelu) {\n   m->mutable_config().set_debug_options(debug_opts);\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   // Leaky-relu fusion is only enabled on Ampere+.\n   CudnnFusedConvRewriter fuser{se::CudaComputeCapability(8, 0), GetDnnVersion(),\n                                GetToolkitVersion()};\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2254,9 +2254,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseLeakyReluIfMultipleUses) {\n   m->mutable_config().set_debug_options(debug_opts);\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2301,9 +2301,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseAlphaIfMultipleUsers) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv1;\n@@ -2340,9 +2340,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseBiasIfMultipleUsers) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv1;\n@@ -2378,9 +2378,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseSideInputThroughRelu) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2416,9 +2416,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseBiasThroughRelu) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2451,9 +2451,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseSideInputIfMultipleUsers) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv1;\n@@ -2487,9 +2487,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseConvertToF16IfMultipleUsers) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv1;\n@@ -2520,9 +2520,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontFuseToS8IfMultipleUsers) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv1;\n@@ -2552,9 +2552,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, RemoveConvertByFusingS32ToF32) {\n \n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n   SCOPED_TRACE(m->ToString());\n   HloInstruction* conv1 = nullptr;\n   // Checks that it removed the Convert inside multiply around conv.\n@@ -2578,9 +2578,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, RemoveConvertByFusingS8ToF32) {\n \n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n   SCOPED_TRACE(m->ToString());\n   HloInstruction* conv1 = nullptr;\n   // Checks that it removed the Convert inside multiply around conv.\n@@ -2604,9 +2604,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, RemoveConvertByFusingF32ToS8) {\n \n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n   SCOPED_TRACE(m->ToString());\n   HloInstruction* conv1 = nullptr;\n   // Checks that it removed the Convert inside multiply around conv.\n@@ -2631,9 +2631,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, DontRemoveConvertDuetoMultpleUser) {\n \n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n   SCOPED_TRACE(m->ToString());\n   HloInstruction* conv1 = nullptr;\n   // Checks that it removed the Convert inside multiply around conv.\n@@ -2660,9 +2660,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseBias) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   ASSERT_THAT(\n@@ -2691,9 +2691,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseSideInput) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2733,9 +2733,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseScaledSideInput) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2775,9 +2775,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseBiasAndSideInput) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2812,9 +2812,9 @@ TEST_F(CudnnFusedConvRewriterHloTest, EffectiveScalarBias) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2854,13 +2854,13 @@ TEST_F(CudnnFusedConvRewriterHloTest, StrengthReduceF32ToF16) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2900,13 +2900,13 @@ TEST_F(CudnnFusedConvRewriterHloTest, BroadcastReshapeTransposeAfterConvert) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -2952,13 +2952,13 @@ TEST_F(CudnnFusedConvRewriterHloTest, NoStrengthReduceF32ToF16IfBiasIsF32) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -3007,16 +3007,16 @@ TEST_F(CudnnFusedConvRewriterHloTest, F32Constants) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph, and fold\n   // convert back into constants.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n   HloConstantFolding constant_folding;\n-  TF_ASSERT_OK(RunHloPass(&constant_folding, m.get()).status());\n+  ASSERT_OK(RunHloPass(&constant_folding, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -3060,16 +3060,16 @@ TEST_F(CudnnFusedConvRewriterHloTest, F32ConstantsNotLosslesslyConvertible) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph, and fold\n   // convert back into constants.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n   HloConstantFolding constant_folding;\n-  TF_ASSERT_OK(RunHloPass(&constant_folding, m.get()).status());\n+  ASSERT_OK(RunHloPass(&constant_folding, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -3123,13 +3123,13 @@ TEST_F(CudnnFusedConvRewriterHloTest, FuseReluBeforeConvert) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;\n@@ -3165,13 +3165,13 @@ TEST_F(CudnnFusedConvRewriterHloTest, BiasTypeMatchesConvTypeIfFp) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(module_str));\n \n   ConvRewriter rewriter = GetConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n+  ASSERT_OK(RunHloPass(&rewriter, m.get()).status());\n   CudnnFusedConvRewriter fuser = GetCudnnFusedConvRewriter();\n-  TF_ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n+  ASSERT_OK(RunHloPass(&fuser, m.get()).status());\n \n   // Simplify new `convert`'s that may be added to the graph.\n   AlgebraicSimplifier algsimp(AlgebraicSimplifierOptions{});\n-  TF_ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n+  ASSERT_OK(RunHloPass(&algsimp, m.get()).status());\n \n   SCOPED_TRACE(m->ToString());\n   const HloInstruction* conv;"
        },
        {
            "sha": "61f19032a1909cb01820577aec7696312afe6b06",
            "filename": "third_party/xla/xla/service/gpu/transforms/cudnn_simplify_padding_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcudnn_simplify_padding_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcudnn_simplify_padding_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fcudnn_simplify_padding_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -82,7 +82,7 @@ void SetConstantValue(\n     absl::FunctionRef<NativeT(absl::Span<const int64_t>, NativeT)> value_fn) {\n   Literal new_literal = instr->literal().Clone();\n   new_literal.MutableEachCell<int8_t>(value_fn);\n-  TF_EXPECT_OK(instr->parent()->ReplaceWithNewInstruction(\n+  EXPECT_OK(instr->parent()->ReplaceWithNewInstruction(\n       instr, HloInstruction::CreateConstant(std::move(new_literal))));\n }\n "
        },
        {
            "sha": "09a48cc11b06f92862fee791fa10f1a27f2f38c8",
            "filename": "third_party/xla/xla/service/gpu/transforms/explicit_collectives_group_async_wrapper_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fexplicit_collectives_group_async_wrapper_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fexplicit_collectives_group_async_wrapper_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fexplicit_collectives_group_async_wrapper_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -17,6 +17,7 @@ limitations under the License.\n \n #include <memory>\n \n+#include <gmock/gmock.h>\n #include <gtest/gtest.h>\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/string_view.h\"\n@@ -57,7 +58,7 @@ TEST_F(ExplicitCollectivesGroupAsyncWrapperTest, AnnotatedOpIsWrapped) {\n   // CHECK: %tuple-start = ((f32[1]{0}), (f32[1]{0}, f32[1]{0})) async-start(%b), calls=%comms.collectives_group, frontend_attributes={_collectives_group=\"\"}\n   // CHECK: ROOT %tuple-done = (f32[1]{0}, f32[1]{0}) async-done(%tuple-start), frontend_attributes={_collectives_group=\"\"}\n   )\");\n-  TF_ASSERT_OK(filecheck_result.status());\n+  ASSERT_OK(filecheck_result.status());\n   EXPECT_TRUE(*filecheck_result);\n   ASSERT_TRUE(mutated);\n }\n@@ -96,7 +97,7 @@ TEST_F(ExplicitCollectivesGroupAsyncWrapperTest,\n   // CHECK-NEXT: %[[P1:.*]] = {{.*}} async-start(%[[P0]]), calls=%comms.collectives_group, frontend_attributes={_collectives_group=\"\",_scheduling_group_id=\"1\"}  \n   // CHECK-NEXT: ROOT %{{.*}} async-done(%[[P1]]), frontend_attributes={_collectives_group=\"\",_scheduling_group_id=\"1\"}\n   )\");\n-  TF_ASSERT_OK(filecheck_result.status());\n+  ASSERT_OK(filecheck_result.status());\n   EXPECT_TRUE(*filecheck_result);\n   ASSERT_TRUE(mutated);\n }\n@@ -134,7 +135,7 @@ TEST_F(ExplicitCollectivesGroupAsyncWrapperTest, ManyCollectivesGroups) {\n   // CHECK: %tuple-start.1 = ((f32[1]{0}), (f32[1]{0}, f32[1]{0})) async-start(%c), calls=%comms.collectives_group.1, frontend_attributes={_collectives_group=\"\"}\n   // CHECK: ROOT %tuple-done.1 = (f32[1]{0}, f32[1]{0}) async-done(%tuple-start.1), frontend_attributes={_collectives_group=\"\"}\n   )\");\n-  TF_ASSERT_OK(filecheck_result.status());\n+  ASSERT_OK(filecheck_result.status());\n   EXPECT_TRUE(*filecheck_result);\n   ASSERT_TRUE(mutated);\n }"
        },
        {
            "sha": "0438d9b530c5029b85ab77b29dcc5b01760d47b6",
            "filename": "third_party/xla/xla/service/gpu/transforms/explicit_stream_annotation_async_wrapper_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fexplicit_stream_annotation_async_wrapper_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fexplicit_stream_annotation_async_wrapper_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fexplicit_stream_annotation_async_wrapper_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -17,6 +17,7 @@ limitations under the License.\n \n #include <memory>\n \n+#include <gmock/gmock.h>\n #include <gtest/gtest.h>\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/string_view.h\"\n@@ -60,7 +61,7 @@ TEST_F(ExplicitStreamAnnotationAsyncWrapperTest, AnnotatedOpIsWrapped) {\n   // CHECK: %call-start = ((f32[]), f32[]) call-start(%lhs.1), to_apply=%sub, frontend_attributes={_xla_stream_annotation=\"1\"}\n   // CHECK: ROOT %call-done = f32[] call-done(%call-start), frontend_attributes={_xla_stream_annotation=\"1\"}, backend_config={\"operation_queue_id\":\"0\",\"wait_on_operation_queues\":[],\"force_earliest_schedule\":false\n   )\");\n-  TF_ASSERT_OK(filecheck_result.status());\n+  ASSERT_OK(filecheck_result.status());\n   EXPECT_TRUE(*filecheck_result);\n \n   ASSERT_TRUE(mutated);\n@@ -107,7 +108,7 @@ TEST_F(ExplicitStreamAnnotationAsyncWrapperTest, OverlappingGemms) {\n   // CHECK: %call-start.1 = ((f32[2048,2048]{1,0}, f32[2048,2048]{1,0}), f32[2048,2048]{1,0}) call-start(%x, %y), to_apply=%gemm2, frontend_attributes={_scheduling_group_id=\"1\",_xla_stream_annotation=\"1\"}\n   // CHECK: ROOT %call-done.1 = f32[2048,2048]{1,0} call-done(%call-start.1), frontend_attributes={_scheduling_group_id=\"1\",_xla_stream_annotation=\"1\"}, backend_config={\"operation_queue_id\":\"0\",\"wait_on_operation_queues\":[],\"force_earliest_schedule\":false\n   )\");\n-  TF_ASSERT_OK(filecheck_result.status());\n+  ASSERT_OK(filecheck_result.status());\n   EXPECT_TRUE(*filecheck_result);\n   for (auto name : {\"call-start\", \"call-done\"}) {\n     EXPECT_EQ(FindInstruction(module.get(), name)"
        },
        {
            "sha": "179927aeb7bf9ada30203a3d844c3a99c67c96c0",
            "filename": "third_party/xla/xla/service/gpu/transforms/gemm_rewriter_test.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fgemm_rewriter_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fgemm_rewriter_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fgemm_rewriter_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -22,6 +22,7 @@ limitations under the License.\n #include <utility>\n #include <vector>\n \n+#include <gmock/gmock.h>\n #include <gtest/gtest.h>\n #include \"absl/container/flat_hash_map.h\"\n #include \"absl/status/statusor.h\"\n@@ -142,7 +143,7 @@ ENTRY AddDotsFunc {\n                    R\"(\n ; CHECK:    custom_call_target=\"__cublas${{(lt\\$matmul|gemm)}}\"\n     )\");\n-  TF_ASSERT_OK(filecheck_result.status());\n+  ASSERT_OK(filecheck_result.status());\n   EXPECT_TRUE(filecheck_result.value());\n   EXPECT_TRUE(RunAndCompare(*get_module(), ErrorSpec{1e-3, 1e-3}));\n }"
        },
        {
            "sha": "b353c68c8b2d29257cb774c97afbaf5c854f7c19",
            "filename": "third_party/xla/xla/service/gpu/transforms/nest_gemm_fusion_test.cc",
            "status": "modified",
            "additions": 33,
            "deletions": 33,
            "changes": 66,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fnest_gemm_fusion_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fnest_gemm_fusion_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fnest_gemm_fusion_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -106,7 +106,7 @@ ENTRY entry {\n   ASSERT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n \n   const HloInstruction* fusion = nullptr;\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n@@ -165,7 +165,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   HloComputation* fusion_computation = module->entry_computation()\n                                            ->root_instruction()\n                                            ->fused_instructions_computation();\n@@ -284,7 +284,7 @@ ENTRY entry {\n   ASSERT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n \n   const HloInstruction* fusion = nullptr;\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n@@ -331,7 +331,7 @@ ENTRY entry {\n   ASSERT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n \n   const HloInstruction* fusion = nullptr;\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n@@ -378,7 +378,7 @@ ENTRY entry {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest,\n@@ -413,7 +413,7 @@ ENTRY entry {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest, BitcastsCanBeHoistedPastConvertEpilogues) {\n@@ -454,7 +454,7 @@ CHECK: f16[3,11]{1,0} fusion(\n )\"),\n       absl_testing::IsOkAndHolds(true));\n \n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n // We cannot hoist bitcasts past transposes, but we don't need to hoist\n@@ -493,7 +493,7 @@ ENTRY entry {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest, BitcastsKeepElementSizeInBits) {\n@@ -537,7 +537,7 @@ ENTRY entry {\n   CHECK: ROOT {{.*}} = s8[33]{0:E(4)} bitcast([[fusion]])\n )\"),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest, TritonFusionEmitterDeviceLegacyTestSample1) {\n@@ -573,7 +573,7 @@ ENTRY entry {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest, TritonFusionEmitterDeviceLegacyTestSample2) {\n@@ -612,7 +612,7 @@ ENTRY entry_computation {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest, TritonFusionEmitterDeviceLegacyTestSample3) {\n@@ -648,7 +648,7 @@ ENTRY entry_computation {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest, BitcastsAreHoistedPastCompare) {\n@@ -683,7 +683,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest, BitcastsAreHoistedUpThroughBroadcasts) {\n@@ -715,7 +715,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(\n       RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"(\n // Broadcast fusion:\n@@ -761,7 +761,7 @@ ENTRY e {\n   EXPECT_TRUE(NestGemmFusion(device_description_, &mlir_context_)\n                   .Run(module.get())\n                   .ok());\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   // Cos should not be rewritten as we cannot hoist bitcast.\n   EXPECT_THAT(RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()),\n                            absl::Substitute(R\"(\n@@ -803,7 +803,7 @@ ENTRY e {\n   EXPECT_TRUE(NestGemmFusion(device_description_, &mlir_context_)\n                   .Run(module.get())\n                   .ok());\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   // Cos should not be rewritten as we cannot hoist bitcast.\n   EXPECT_THAT(RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()),\n                            absl::Substitute(R\"(\n@@ -846,7 +846,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(\n       RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"(\n CHECK: [[p0:[^ ]+]] = f32[15]{0} parameter(0)\n@@ -886,7 +886,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()),\n                            R\"(\n // Broadcast fusion:\n@@ -937,7 +937,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()),\n                            absl::Substitute(R\"(\n CHECK: {{.*}} {\n@@ -988,7 +988,7 @@ ENTRY entry {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(\n       RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"(\n CHECK: bf16[1,2,4,8]{{.*}} broadcast({{.*}}), dimensions={0,3}\n@@ -1024,7 +1024,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(\n       RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"(\n CHECK:      ROOT transpose\n@@ -1061,7 +1061,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(\n       RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"(\n CHECK:      transpose\n@@ -1098,7 +1098,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()),\n                            absl::Substitute(R\"(\n CHECK:      f32[2,3,5]{2,1,0} $0\n@@ -1137,7 +1137,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   // Checks that transpose is on rank 3 tensor from hoisting bitcast1, not rank\n   // 4 tensor from hoisting bitcast0 first and then failing to hoist bitcast1.\n   EXPECT_THAT(\n@@ -1176,7 +1176,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(\n       RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"(\n CHECK:      ROOT transpose\n@@ -1212,7 +1212,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(\n       RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"(\n CHECK:      ROOT broadcast\n@@ -1249,7 +1249,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()),\n                            absl::Substitute(R\"(\n CHECK:      f32[2,3,5]{2,1,0} $0(dot)\n@@ -1284,7 +1284,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(\n       RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"(\n CHECK: ROOT dot\n@@ -1321,7 +1321,7 @@ ENTRY e {\n   EXPECT_THAT(\n       NestGemmFusion(device_description_, &mlir_context_).Run(module.get()),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n   EXPECT_THAT(\n       RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"(\n CHECK: ROOT add = f32[3,5]{1,0} add\n@@ -1377,7 +1377,7 @@ CHECK: result = f32[2,7,15,11]{2,1,0,3} fusion\n CHECK: ROOT {{.*}} = f32[15,11,14]{0,2,1} bitcast(result)\n )\"),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest,\n@@ -1428,7 +1428,7 @@ CHECK: result = f32[3,5,2]{2,1,0} fusion\n CHECK: ROOT {{.*}} = f32[2,3,5]{0,2,1} bitcast(result)\n )\"),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest, MultipleBitcastsAreHoistedOut) {\n@@ -1468,7 +1468,7 @@ CHECK-NOT: reshape\n CHECK: ENTRY\n )\"),\n       absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n TEST_P(NestGemmFusionReshapeTest,\n@@ -1510,7 +1510,7 @@ CHECK-NOT: reshape\n         )\",\n                                             HloOpcodeString(opcode))),\n               absl_testing::IsOkAndHolds(true));\n-  TF_ASSERT_OK(verifier().Run(module.get()).status());\n+  ASSERT_OK(verifier().Run(module.get()).status());\n }\n \n INSTANTIATE_TEST_SUITE_P(NestGemmFusionReshapeTestSuite,"
        },
        {
            "sha": "07fa372f9d18c434dd690c59224ca6a03cd1f657",
            "filename": "third_party/xla/xla/service/gpu/transforms/ragged_all_to_all_canonicalizer_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fragged_all_to_all_canonicalizer_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fragged_all_to_all_canonicalizer_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fragged_all_to_all_canonicalizer_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -17,6 +17,7 @@ limitations under the License.\n \n #include <memory>\n \n+#include <gmock/gmock.h>\n #include <gtest/gtest.h>\n #include \"xla/hlo/ir/hlo_opcode.h\"\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n@@ -51,7 +52,7 @@ ENTRY main {\n   RaggedAllToAllCanonicalizer canonicalizer;\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, canonicalizer.Run(module.get(), {}));\n   EXPECT_TRUE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n \n   auto* ragged_all_to_all =\n       FindInstruction(module.get(), HloOpcode::kRaggedAllToAll);\n@@ -83,7 +84,7 @@ ENTRY main {\n   RaggedAllToAllCanonicalizer canonicalizer;\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, canonicalizer.Run(module.get(), {}));\n   EXPECT_FALSE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n }\n \n }  // namespace"
        },
        {
            "sha": "d00c5779a819bc6bc8f72bc7cebd4598a0e0f9f6",
            "filename": "third_party/xla/xla/service/gpu/transforms/ragged_all_to_all_decomposer_test.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 8,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fragged_all_to_all_decomposer_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fragged_all_to_all_decomposer_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fragged_all_to_all_decomposer_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -17,6 +17,7 @@ limitations under the License.\n \n #include <memory>\n \n+#include <gmock/gmock.h>\n #include <gtest/gtest.h>\n #include \"absl/log/log.h\"\n #include \"xla/hlo/ir/hlo_print_options.h\"\n@@ -55,8 +56,8 @@ ENTRY main {\n   RaggedAllToAllDecomposer decomposer;\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, decomposer.Run(module.get(), {}));\n   EXPECT_TRUE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n-  TF_EXPECT_OK(HloCSE(true).Run(module.get()));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(HloCSE(true).Run(module.get()));\n \n   EXPECT_TRUE(*RunFileCheck(module->ToString(), R\"(\n     // CHECK: s64[2,1]{1,0} all-to-all\n@@ -95,8 +96,8 @@ ENTRY main {\n   RaggedAllToAllDecomposer decomposer;\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, decomposer.Run(module.get(), {}));\n   EXPECT_TRUE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n-  TF_EXPECT_OK(HloCSE(true).Run(module.get()));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(HloCSE(true).Run(module.get()));\n \n   EXPECT_TRUE(*RunFileCheck(module->ToString(), R\"(\n     // CHECK: s64[2,1]{1,0} all-to-all\n@@ -135,8 +136,8 @@ ENTRY main {\n   RaggedAllToAllDecomposer decomposer;\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, decomposer.Run(module.get(), {}));\n   EXPECT_TRUE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n-  TF_EXPECT_OK(HloCSE(true).Run(module.get()));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(HloCSE(true).Run(module.get()));\n \n   EXPECT_TRUE(*RunFileCheck(module->ToString(), R\"(\n     // CHECK: dynamic-slice\n@@ -174,8 +175,8 @@ ENTRY main {\n   RaggedAllToAllDecomposer decomposer;\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, decomposer.Run(module.get(), {}));\n   EXPECT_TRUE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n-  TF_EXPECT_OK(HloCSE(true).Run(module.get()));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(HloCSE(true).Run(module.get()));\n \n   EXPECT_TRUE(\n       *RunFileCheck(module->ToString(HloPrintOptions::ShortParsable()), R\"("
        },
        {
            "sha": "9508b9395c15de8a4c4556898b9021bde9edf7f2",
            "filename": "third_party/xla/xla/service/gpu/transforms/ragged_all_to_all_multi_host_decomposer_test.cc",
            "status": "modified",
            "additions": 13,
            "deletions": 12,
            "changes": 25,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fragged_all_to_all_multi_host_decomposer_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fragged_all_to_all_multi_host_decomposer_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fragged_all_to_all_multi_host_decomposer_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -17,6 +17,7 @@ limitations under the License.\n \n #include <memory>\n \n+#include <gmock/gmock.h>\n #include <gtest/gtest.h>\n #include \"xla/hlo/testlib/filecheck.h\"\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n@@ -56,9 +57,9 @@ ENTRY main {\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, decomposer.Run(module.get(), {}));\n \n   EXPECT_TRUE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n-  TF_EXPECT_OK(HloDCE().Run(module.get()));\n-  TF_EXPECT_OK(HloCSE(true).Run(module.get()));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(HloDCE().Run(module.get()));\n+  EXPECT_OK(HloCSE(true).Run(module.get()));\n \n   EXPECT_TRUE(*RunFileCheck(module->ToString(), R\"(\n     // CHECK: all-gather{{.*}}, replica_groups={{[{]}}{0,8},{1,9},{2,10},{3,11},{4,12},{5,13},{6,14},{7,15}{{[}]}}\n@@ -90,9 +91,9 @@ ENTRY main {\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, decomposer.Run(module.get(), {}));\n \n   EXPECT_TRUE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n-  TF_EXPECT_OK(HloDCE().Run(module.get()));\n-  TF_EXPECT_OK(HloCSE(true).Run(module.get()));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(HloDCE().Run(module.get()));\n+  EXPECT_OK(HloCSE(true).Run(module.get()));\n \n   EXPECT_TRUE(*RunFileCheck(module->ToString(), R\"(\n     // CHECK: all-gather{{.*}}, replica_groups={{[{]}}{0,8},{1,9},{2,10},{3,11},{4,12},{5,13},{6,14},{7,15}{{[}]}}\n@@ -146,9 +147,9 @@ ENTRY main {\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, decomposer.Run(module.get(), {}));\n \n   EXPECT_TRUE(changed);\n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n-  TF_EXPECT_OK(HloDCE().Run(module.get()));\n-  TF_EXPECT_OK(HloCSE(true).Run(module.get()));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(HloDCE().Run(module.get()));\n+  EXPECT_OK(HloCSE(true).Run(module.get()));\n \n   EXPECT_TRUE(*RunFileCheck(module->ToString(), R\"(\n     // CHECK: ragged-all-to-all{{.*}}, replica_groups={{[{]}}{0,1,2,3,4,5,6,7},{8,9,10,11,12,13,14,15}{{[}]}}\n@@ -180,9 +181,9 @@ ENTRY main {\n   TF_ASSERT_OK_AND_ASSIGN(bool changed, decomposer.Run(module.get(), {}));\n   EXPECT_TRUE(changed);\n \n-  TF_EXPECT_OK(VerifyHloModule(module.get(), true, true));\n-  TF_EXPECT_OK(HloDCE().Run(module.get()));\n-  TF_EXPECT_OK(HloCSE(true).Run(module.get()));\n+  EXPECT_OK(VerifyHloModule(module.get(), true, true));\n+  EXPECT_OK(HloDCE().Run(module.get()));\n+  EXPECT_OK(HloCSE(true).Run(module.get()));\n \n   EXPECT_TRUE(*RunFileCheck(module->ToString(), R\"(\n     // CHECK: all-gather{{.*}}, replica_groups={{[{]}}{0,8},{2,10},{4,12},{6,14},{1,9},{3,11},{5,13},{7,15}{{[}]}}"
        },
        {
            "sha": "57d0a81de3072c0c68bd69c5548422654c64a207",
            "filename": "third_party/xla/xla/service/gpu/transforms/triton_fusion_numerics_verifier_test.cc",
            "status": "modified",
            "additions": 13,
            "deletions": 13,
            "changes": 26,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Ftriton_fusion_numerics_verifier_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/16f017d5d0ba27796ac423827d3a4be8c3522da4/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Ftriton_fusion_numerics_verifier_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Ftriton_fusion_numerics_verifier_test.cc?ref=16f017d5d0ba27796ac423827d3a4be8c3522da4",
            "patch": "@@ -58,7 +58,7 @@ class TritonFusionNumericsVerifierTest\n                                          absl::string_view type) {\n     auto m = ParseAndReturnVerifiedModule(\n         absl::Substitute(hlo_text_template, type), GetModuleConfigForTest());\n-    TF_EXPECT_OK(m);\n+    EXPECT_OK(m);\n     return std::move(m.value());\n   }\n \n@@ -79,15 +79,15 @@ class TritonFusionNumericsVerifierTest\n   DeviceOrDevicelessConfig CreateDeviceOrDevicelessConfig() {\n     se::Platform* platform = PlatformUtil::GetDefaultPlatform().value();\n     auto executors_or = PlatformUtil::GetStreamExecutors(platform);\n-    TF_EXPECT_OK(executors_or);\n+    EXPECT_OK(executors_or);\n     return DeviceOrDevicelessConfig{DeviceConfig{executors_or->at(0), nullptr}};\n   }\n \n   AutotunerCompileUtil CreateAutotunerCompileUtil(\n       DeviceOrDevicelessConfig& config) {\n     auto compile_util_or =\n         AutotunerCompileUtil::Create(config, GetDebugOptionsForTest());\n-    TF_EXPECT_OK(compile_util_or);\n+    EXPECT_OK(compile_util_or);\n     return std::move(compile_util_or).value();\n   }\n \n@@ -138,7 +138,7 @@ TEST_P(TritonFusionNumericsVerifierTest, VerifyExactSoftmaxFusionNumerics) {\n   EXPECT_NE(TritonFusion(*module), nullptr);\n   auto verifier = TritonFusionNumericsVerifier(CreateDeviceOrDevicelessConfig(),\n                                                &mlir_context_);\n-  TF_EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n+  EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n }\n \n TEST_P(TritonFusionNumericsVerifierTest, VerifyNestedGemmNumerics) {\n@@ -193,7 +193,7 @@ ENTRY entry {\n   EXPECT_NE(TritonFusion(*module), nullptr);\n   auto verifier = TritonFusionNumericsVerifier(CreateDeviceOrDevicelessConfig(),\n                                                &mlir_context_);\n-  TF_EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n+  EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n }\n \n TEST_P(TritonFusionNumericsVerifierTest, VerifyMultiOutputFusionNumerics) {\n@@ -224,7 +224,7 @@ ENTRY main{\n   EXPECT_NE(TritonFusion(*module), nullptr);\n   auto verifier = TritonFusionNumericsVerifier(CreateDeviceOrDevicelessConfig(),\n                                                &mlir_context_);\n-  TF_EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n+  EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n }\n \n TEST_P(TritonFusionNumericsVerifierTest, VerifyMultipleNestedFusionNumerics) {\n@@ -314,7 +314,7 @@ ENTRY main (p0: bf16[128,512], p1: bf16[256,512], p2: bf16[512,512]) -> bf16[384\n   EXPECT_NE(TritonFusion(*module), nullptr);\n   auto verifier = TritonFusionNumericsVerifier(CreateDeviceOrDevicelessConfig(),\n                                                &mlir_context_);\n-  TF_EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n+  EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n }\n \n TEST_F(TritonFusionNumericsVerifierTest, CheckMismatch) {\n@@ -346,15 +346,15 @@ TEST_F(TritonFusionNumericsVerifierTest, CheckMismatch) {\n   auto f64_result = triton_fusion_numerics_pass_internal::CompileAndRunFusion(\n       compile_util, *fusion_f64, autotune_config, debug_options,\n       /*disable_triton=*/false, &mlir_context_);\n-  TF_EXPECT_OK(f64_result);\n+  EXPECT_OK(f64_result);\n \n   auto f32_result = triton_fusion_numerics_pass_internal::CompileAndRunFusion(\n       compile_util, *fusion_f32, autotune_config, debug_options,\n       /*disable_triton=*/false, &mlir_context_);\n-  TF_EXPECT_OK(f32_result);\n+  EXPECT_OK(f32_result);\n \n   auto stream = autotune_config.GetStream();\n-  TF_EXPECT_OK(stream);\n+  EXPECT_OK(stream);\n \n   // Intentionally compare the fusions from the different modules, triggering a\n   // mismatch.\n@@ -401,7 +401,7 @@ ENTRY main {\n \n   auto verifier = TritonFusionNumericsVerifier(CreateDeviceOrDevicelessConfig(),\n                                                &mlir_context_);\n-  TF_EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n+  EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n   auto fusion = TritonFusion(*module);\n   EXPECT_NE(fusion, nullptr);\n \n@@ -471,7 +471,7 @@ ENTRY main {\n   std::unique_ptr<HloModule> module = Module(hlo_text, \"\");\n   auto verifier = TritonFusionNumericsVerifier(CreateDeviceOrDevicelessConfig(),\n                                                &mlir_context_);\n-  TF_EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n+  EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n   EXPECT_EQ(verifier.CacheHitsForTestingOnly(), 1);\n }\n \n@@ -526,7 +526,7 @@ ENTRY main {\n   EXPECT_NE(TritonFusion(*module), nullptr);\n   auto verifier = TritonFusionNumericsVerifier(CreateDeviceOrDevicelessConfig(),\n                                                &mlir_context_);\n-  TF_EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n+  EXPECT_OK(verifier.Run(module.get(), /*execution_threads=*/{}));\n }\n \n INSTANTIATE_TEST_SUITE_P(TritonFusionNumericsVerifierTestSuite,"
        }
    ],
    "stats": {
        "total": 476,
        "additions": 235,
        "deletions": 241
    }
}