{
    "author": "WillFroom",
    "message": "[XLA:CPU/GPU] Move TileHlo<Instruction/Computation> to shared directory.\n\nPiperOrigin-RevId: 813683004",
    "sha": "b45369f4c106ff093831a10bb42b95e67db2041e",
    "files": [
        {
            "sha": "6eaff27a302a27c21ffbc2b76e93b96dd358765e",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/BUILD",
            "status": "modified",
            "additions": 18,
            "deletions": 13,
            "changes": 31,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2FBUILD?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -42,6 +42,7 @@ cc_library(\n         \"//xla/backends/gpu/runtime:kernel_thunk\",\n         \"//xla/backends/gpu/runtime:thunk\",\n         \"//xla/codegen/emitters:kernel_arguments\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/utils:hlo_traversal\",\n         \"//xla/service/gpu:backend_configs_cc\",\n@@ -53,7 +54,6 @@ cc_library(\n         \"//xla/service/gpu:launch_dimensions\",\n         \"//xla/service/gpu:matmul_utils\",\n         \"//xla/service/gpu:triton_fusion_analysis\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/service/llvm_ir:ir_array\",\n         \"//xla/service/llvm_ir:llvm_util\",\n         \"//xla/stream_executor:device_description\",\n@@ -205,10 +205,13 @@ cc_library(\n         \"//xla:autotuning_proto_cc\",\n         \"//xla/backends/gpu/codegen/triton/ir:triton_xla\",\n         \"//xla/codegen:emitter_loc_op_builder\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n+        \"//xla/codegen/tiling:tiled_hlo_fusion_instruction\",\n+        \"//xla/codegen/tiling:tiled_hlo_instruction\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/service:hlo_module_config\",\n+        \"//xla/service/gpu/model:block_level_parameters\",\n         \"//xla/service/gpu/model:symbolic_tile_analysis\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/stream_executor:launch_dim\",\n         \"//xla/stream_executor/gpu:tma_metadata\",\n@@ -319,6 +322,7 @@ cc_library(\n         \"//xla:util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/codegen:emitter_loc_op_builder\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/utils:hlo_query\",\n         \"//xla/hlo/utils:hlo_traversal\",\n@@ -333,7 +337,7 @@ cc_library(\n         \"//xla/service/gpu:matmul_utils\",\n         \"//xla/service/gpu:triton_fusion_analysis\",\n         \"//xla/service/gpu:triton_tiling_propagation\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n+        \"//xla/service/gpu/model:block_level_parameters\",\n         \"//xla/service/llvm_ir:llvm_util\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/stream_executor:launch_dim\",\n@@ -407,14 +411,15 @@ cc_library(\n         \"//xla:autotuning_proto_cc\",\n         \"//xla/backends/gpu/codegen/triton/ir:triton_xla\",\n         \"//xla/codegen:emitter_loc_op_builder\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/utils:hlo_traversal\",\n         \"//xla/service:hlo_module_config\",\n         \"//xla/service/gpu:launch_dimensions\",\n         \"//xla/service/gpu:matmul_utils\",\n         \"//xla/service/gpu:triton_fusion_analysis\",\n+        \"//xla/service/gpu/model:block_level_parameters\",\n         \"//xla/service/gpu/model:symbolic_tile_analysis\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/stream_executor:launch_dim\",\n         \"//xla/stream_executor/gpu:tma_metadata\",\n@@ -439,10 +444,10 @@ xla_cc_test(\n         \"//xla:literal\",\n         \"//xla:literal_util\",\n         \"//xla/codegen:emitter_loc_op_builder\",\n+        \"//xla/codegen/tiling:tiled_hlo_instruction\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/utils:hlo_traversal\",\n         \"//xla/service:hlo_module_config\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"@com_google_googletest//:gtest_main\",\n         \"@llvm-project//mlir:IR\",\n         \"@llvm-project//mlir:Pass\",\n@@ -457,12 +462,12 @@ xla_cc_test(\n         \":fusion_emitter\",\n         \"//xla:xla_proto_cc\",\n         \"//xla/codegen:emitter_loc_op_builder\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/testlib:filecheck\",\n         \"//xla/hlo/testlib:hlo_hardware_independent_test_base\",\n         \"//xla/hlo/testlib:verified_hlo_module\",\n         \"//xla/service/gpu:gpu_device_info_for_tests\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/stream_executor/cuda:cuda_compute_capability\",\n         \"//xla/tests:xla_internal_test_main\",\n@@ -506,14 +511,14 @@ xla_test(\n         \"//xla:error_spec\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla:xla_proto_cc\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/testlib:filecheck\",\n         \"//xla/hlo/testlib:pattern_matcher_gmock\",\n         \"//xla/hlo/testlib:verified_hlo_module\",\n         \"//xla/service:pattern_matcher\",\n         \"//xla/service/gpu:backend_configs_cc\",\n         \"//xla/service/gpu:gpu_device_info_for_tests\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/service/gpu/tests:gpu_codegen_test\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/tests:xla_internal_test_main\",  # fixdeps: keep\n@@ -552,6 +557,7 @@ xla_test(\n         \"//xla:error_spec\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla:xla_proto_cc\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/testlib:filecheck\",\n         \"//xla/hlo/testlib:pattern_matcher_gmock\",\n@@ -560,7 +566,6 @@ xla_test(\n         \"//xla/service:pattern_matcher\",\n         \"//xla/service/gpu:backend_configs_cc\",\n         \"//xla/service/gpu:gpu_device_info_for_tests\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/service/gpu/tests:gpu_codegen_test\",\n         \"//xla/service/gpu/transforms:nest_gemm_fusion\",\n         \"//xla/stream_executor:device_description\",\n@@ -817,13 +822,13 @@ xla_test(\n         \"//xla:util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla:xla_proto_cc\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/testlib:filecheck\",\n         \"//xla/hlo/testlib:verified_hlo_module\",\n         \"//xla/service:algorithm_util\",\n         \"//xla/service/gpu:backend_configs_cc\",\n         \"//xla/service/gpu:gpu_device_info_for_tests\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/service/gpu/tests:gpu_codegen_test\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/stream_executor/cuda:cuda_compute_capability\",\n@@ -858,6 +863,7 @@ cc_library(\n         \"//xla:status_macros\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla:xla_proto_cc\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/pass:hlo_pass_pipeline\",\n         \"//xla/hlo/testlib:filecheck\",\n@@ -869,8 +875,7 @@ cc_library(\n         \"//xla/service/gpu:gpu_float_support\",\n         \"//xla/service/gpu:ir_emission_utils\",\n         \"//xla/service/gpu:matmul_utils\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n-        \"//xla/service/gpu/transforms:nest_gemm_fusion\",\n+        \"//xla/service/gpu/model:block_level_parameters\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/stream_executor/cuda:cuda_compute_capability\",\n         \"//xla/tests:hlo_test_base\",\n@@ -1032,7 +1037,7 @@ xla_cc_test(\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/service/gpu:gpu_device_info_for_tests\",\n         \"//xla/service/gpu:ir_emission_utils\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n+        \"//xla/service/gpu/model:block_level_parameters\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/stream_executor/cuda:cuda_compute_capability\",\n         \"//xla/tsl/platform:statusor\",\n@@ -1065,10 +1070,10 @@ xla_test(\n         \"//xla:shape_util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla:xla_proto_cc\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/service/gpu:gpu_device_info_for_tests\",\n         \"//xla/service/gpu:triton_fusion_analysis\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/tsl/lib/core:status_test_util\",\n         \"@com_google_absl//absl/log:check\","
        },
        {
            "sha": "7190f181e276695b13b8c65cd44e5a97eee9dc0e",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -55,7 +55,6 @@ limitations under the License.\n #include \"xla/service/gpu/kernel_reuse_cache.h\"\n #include \"xla/service/gpu/launch_dimensions.h\"\n #include \"xla/service/gpu/matmul_utils.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/triton_fusion_analysis.h\"\n #include \"xla/service/llvm_ir/ir_array.h\"\n #include \"xla/service/llvm_ir/llvm_util.h\""
        },
        {
            "sha": "233cb186bccbbe9726857e79ba8fb4b2a9ff0375",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -23,11 +23,11 @@ limitations under the License.\n #include \"mlir/IR/MLIRContext.h\"\n #include \"xla/backends/gpu/codegen/fusion_emitter.h\"\n #include \"xla/backends/gpu/codegen/triton/fusion_emitter.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n #include \"xla/service/gpu/hlo_fusion_analysis.h\"\n #include \"xla/service/gpu/ir_emitter_context.h\"\n #include \"xla/service/gpu/launch_dimensions.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/stream_executor/device_description.h\"\n \n namespace xla {"
        },
        {
            "sha": "e1915f71c3ac75bdfc456b8d5149c08862925fb7",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -101,6 +101,9 @@ limitations under the License.\n #include \"xla/codegen/emitters/elemental_hlo_to_mlir.h\"\n #include \"xla/codegen/emitters/ir/xla_ops.h\"\n #include \"xla/codegen/emitters/transforms/passes.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_fusion_instruction.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/builder/xla_builder.h\"\n #include \"xla/hlo/ir/hlo_casting_utils.h\"\n@@ -120,9 +123,8 @@ limitations under the License.\n #include \"xla/service/gpu/ir_emission_utils.h\"\n #include \"xla/service/gpu/llvm_gpu_backend/amdgpu_backend.h\"\n #include \"xla/service/gpu/llvm_gpu_backend/nvptx_libdevice_path.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/service/gpu/model/symbolic_tile_analysis.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/service/gpu/model/triton_emitter_constraints.h\"\n #include \"xla/service/gpu/triton_fusion_analysis.h\"\n #include \"xla/service/hlo_module_config.h\""
        },
        {
            "sha": "006ac719d353889fc9e23bb3e4ea4203f5db1ff9",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -35,8 +35,8 @@ limitations under the License.\n #include \"xla/codegen/emitter_loc_op_builder.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/service/gpu/model/symbolic_tile_analysis.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/hlo_module_config.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/stream_executor/gpu/tma_metadata.h\""
        },
        {
            "sha": "ff156435861c94376f192e90ecf0d87694511ad6",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter_device_legacy_port_test.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_device_legacy_port_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_device_legacy_port_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_device_legacy_port_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -46,7 +46,6 @@ limitations under the License.\n #include \"xla/hlo/utils/hlo_query.h\"\n #include \"xla/service/gpu/backend_configs.pb.h\"\n #include \"xla/service/gpu/gpu_device_info_for_tests.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/tests/gpu_codegen_test.h\"\n #include \"xla/service/gpu/transforms/nest_gemm_fusion.h\"\n #include \"xla/service/pattern_matcher.h\""
        },
        {
            "sha": "6a4a72eafe33537b5d276543e8e4c9968be191b3",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter_device_legacy_test.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_device_legacy_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_device_legacy_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_device_legacy_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -42,7 +42,6 @@ limitations under the License.\n #include \"xla/hlo/testlib/verified_hlo_module.h\"\n #include \"xla/service/gpu/backend_configs.pb.h\"\n #include \"xla/service/gpu/gpu_device_info_for_tests.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/tests/gpu_codegen_test.h\"\n #include \"xla/service/pattern_matcher.h\"\n #include \"xla/stream_executor/device_description.h\""
        },
        {
            "sha": "79378d170f427d34e77549b2ba279ceeaec60290",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter_device_test.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_device_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_device_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_device_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -52,7 +52,6 @@ limitations under the License.\n #include \"xla/service/algorithm_util.h\"\n #include \"xla/service/gpu/backend_configs.pb.h\"\n #include \"xla/service/gpu/gpu_device_info_for_tests.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/tests/gpu_codegen_test.h\"\n #include \"xla/shape.h\"\n #include \"xla/stream_executor/cuda/cuda_compute_capability.h\""
        },
        {
            "sha": "f921a9b9f96fb53dc206e652edfb255a9c9aaf17",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter_deviceless_test.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_deviceless_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_deviceless_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_deviceless_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -30,7 +30,6 @@ limitations under the License.\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n #include \"xla/hlo/testlib/verified_hlo_module.h\"\n #include \"xla/service/gpu/gpu_device_info_for_tests.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/stream_executor/cuda/cuda_compute_capability.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/tsl/platform/status_matchers.h\""
        },
        {
            "sha": "bfa1d66cd68f3f108f9816dd78770803edf6087d",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter_legacy_matmul.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_legacy_matmul.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_legacy_matmul.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_legacy_matmul.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -77,7 +77,7 @@ limitations under the License.\n #include \"xla/service/gpu/ir_emission_utils.h\"\n #include \"xla/service/gpu/launch_dimensions.h\"\n #include \"xla/service/gpu/matmul_utils.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/service/gpu/triton_fusion_analysis.h\"\n #include \"xla/service/gpu/triton_tiling_propagation.h\"\n #include \"xla/service/llvm_ir/llvm_util.h\""
        },
        {
            "sha": "c33e17a5c0ef8042b5279c56a5e7769ce8ba88ab",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter_legacy_matmul.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_legacy_matmul.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_legacy_matmul.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_legacy_matmul.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -25,7 +25,7 @@ limitations under the License.\n #include \"xla/hlo/utils/hlo_traversal.h\"\n #include \"xla/service/gpu/launch_dimensions.h\"\n #include \"xla/service/gpu/matmul_utils.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/service/gpu/triton_fusion_analysis.h\"\n #include \"xla/stream_executor/device_description.h\"\n "
        },
        {
            "sha": "72cc46e8cd38f23f916f40e73a41ec4733d8c416",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter_legacy_matmul_stub.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_legacy_matmul_stub.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_legacy_matmul_stub.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_legacy_matmul_stub.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -13,7 +13,6 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-\n #include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/string_view.h\"\n@@ -24,7 +23,6 @@ limitations under the License.\n #include \"xla/hlo/utils/hlo_traversal.h\"\n #include \"xla/service/gpu/launch_dimensions.h\"\n #include \"xla/service/gpu/matmul_utils.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/triton_fusion_analysis.h\"\n #include \"xla/stream_executor/device_description.h\"\n "
        },
        {
            "sha": "d5af81b56c90bd55904e7df851fd229c5e332b07",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter_stub.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_stub.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_stub.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_stub.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -27,7 +27,6 @@ limitations under the License.\n #include \"xla/backends/gpu/codegen/triton/fusion_emitter.h\"\n #include \"xla/hlo/ir/hlo_clone_context.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/hlo_module_config.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"triton/Dialect/Triton/IR/Dialect.h\""
        },
        {
            "sha": "9e091d433d274e9a90ad80c450feebedbdfb2404",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/fusion_emitter_stub_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_stub_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_stub_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ffusion_emitter_stub_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -20,12 +20,12 @@ limitations under the License.\n #include \"xla/backends/gpu/codegen/triton/fusion_emitter.h\"\n #include \"xla/backends/gpu/codegen/triton/fusion_emitter_legacy_matmul.h\"\n #include \"xla/codegen/emitter_loc_op_builder.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/hlo/utils/hlo_traversal.h\"\n #include \"xla/literal.h\"\n #include \"xla/literal_util.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/service/hlo_module_config.h\"\n \n namespace xla::gpu {"
        },
        {
            "sha": "0f24b94b5261e6f696fade27cc2387432dfad181",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/support_legacy_test.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Fsupport_legacy_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Fsupport_legacy_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Fsupport_legacy_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -36,7 +36,6 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_opcode.h\"\n #include \"xla/primitive_util.h\"\n #include \"xla/service/gpu/gpu_device_info_for_tests.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/triton_fusion_analysis.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/tsl/lib/core/status_test_util.h\""
        },
        {
            "sha": "0fd1d2dd3e0e9485ce8167e2f708c0aa53141ce6",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/support_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Fsupport_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Fsupport_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Fsupport_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -41,7 +41,7 @@ limitations under the License.\n #include \"xla/primitive_util.h\"\n #include \"xla/service/gpu/gpu_device_info_for_tests.h\"\n #include \"xla/service/gpu/ir_emission_utils.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/stream_executor/cuda/cuda_compute_capability.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/tsl/platform/statusor.h\""
        },
        {
            "sha": "59c7e5b6ca2d743036b1a01afdaae81b1bbf4cc5",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/test_utils.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ftest_utils.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ftest_utils.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ftest_utils.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -52,7 +52,6 @@ limitations under the License.\n #include \"xla/service/gpu/gpu_device_info_for_tests.h\"\n #include \"xla/service/gpu/gpu_float_support.h\"\n #include \"xla/service/gpu/ir_emission_utils.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/status_macros.h\"\n #include \"xla/stream_executor/cuda/cuda_compute_capability.h\"\n #include \"xla/stream_executor/device_description.h\""
        },
        {
            "sha": "8d9b7fa20f85e08a4e0862d2c756572e64772ea5",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/test_utils.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ftest_utils.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ftest_utils.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ftest_utils.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -36,7 +36,7 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_instructions.h\"\n #include \"xla/hlo/ir/hlo_opcode.h\"\n #include \"xla/service/gpu/matmul_utils.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/tests/hlo_test_base.h\"\n #include \"xla/xla.pb.h\""
        },
        {
            "sha": "a14998ff9f86260f50630b002b89f9e0018221bf",
            "filename": "third_party/xla/xla/codegen/tiling/BUILD",
            "status": "added",
            "additions": 111,
            "deletions": 0,
            "changes": 111,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2FBUILD?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -0,0 +1,111 @@\n+load(\"//xla:xla.default.bzl\", \"xla_cc_test\")\n+load(\"//xla/tsl:tsl.bzl\", \"internal_visibility\")\n+load(\"//xla/tsl/platform:rules_cc.bzl\", \"cc_library\")\n+\n+package(\n+    # copybara:uncomment default_applicable_licenses = [\"//tensorflow:license\"],\n+    default_visibility = internal_visibility([\":friends\"]),\n+    licenses = [\"notice\"],\n+)\n+\n+package_group(\n+    name = \"friends\",\n+    includes = [\n+        \"//xla:friends\",\n+    ],\n+)\n+\n+cc_library(\n+    name = \"tiled_hlo_instruction\",\n+    srcs = [\n+        \"tiled_hlo_instruction.cc\",\n+    ],\n+    hdrs = [\n+        \"tiled_hlo_instruction.h\",\n+    ],\n+    deps = [\n+        \"//xla:util\",\n+        \"//xla/hlo/analysis:indexing_analysis\",\n+        \"//xla/hlo/ir:hlo\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/memory\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/status:statusor\",\n+        \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/strings:str_format\",\n+        \"@com_google_absl//absl/types:span\",\n+        \"@llvm-project//llvm:Support\",\n+    ],\n+)\n+\n+xla_cc_test(\n+    name = \"tiled_hlo_instruction_test\",\n+    srcs = [\"tiled_hlo_instruction_test.cc\"],\n+    deps = [\n+        \":tiled_hlo_instruction\",\n+        \"//xla:shape_util\",\n+        \"//xla:xla_data_proto_cc\",\n+        \"//xla/hlo/analysis:indexing_analysis\",\n+        \"//xla/hlo/analysis:indexing_test_utils\",\n+        \"//xla/hlo/ir:hlo\",\n+        \"//xla/hlo/testlib:hlo_hardware_independent_test_base\",\n+        \"//xla/tsl/platform:status_matchers\",\n+        \"//xla/tsl/platform:statusor\",\n+        \"@com_google_googletest//:gtest_main\",\n+        \"@llvm-project//mlir:IR\",\n+    ],\n+)\n+\n+cc_library(\n+    name = \"tiled_hlo_computation\",\n+    srcs = [\n+        \"tiled_hlo_computation.cc\",\n+    ],\n+    hdrs = [\n+        \"tiled_hlo_computation.h\",\n+    ],\n+    deps = [\n+        \":tiled_hlo_instruction\",\n+        \"//xla:util\",\n+        \"//xla/hlo/ir:hlo\",\n+        \"//xla/service:name_uniquer\",\n+        \"//xla/tsl/lib/gtl:iterator_range\",\n+        \"@com_google_absl//absl/container:flat_hash_map\",\n+        \"@com_google_absl//absl/container:inlined_vector\",\n+        \"@com_google_absl//absl/strings\",\n+        \"@llvm-project//llvm:Support\",\n+    ],\n+)\n+\n+cc_library(\n+    name = \"tiled_hlo_fusion_instruction\",\n+    srcs = [\"tiled_hlo_fusion_instruction.cc\"],\n+    hdrs = [\"tiled_hlo_fusion_instruction.h\"],\n+    deps = [\n+        \":tiled_hlo_computation\",\n+        \":tiled_hlo_instruction\",\n+        \"//xla/hlo/analysis:indexing_analysis\",\n+        \"//xla/hlo/ir:hlo\",\n+        \"//xla/tsl/platform:statusor\",\n+        \"@com_google_absl//absl/memory\",\n+        \"@com_google_absl//absl/status:statusor\",\n+        \"@llvm-project//llvm:Support\",\n+    ],\n+)\n+\n+xla_cc_test(\n+    name = \"tiled_hlo_fusion_instruction_test\",\n+    srcs = [\"tiled_hlo_fusion_instruction_test.cc\"],\n+    deps = [\n+        \":tiled_hlo_fusion_instruction\",\n+        \"//xla:shape_util\",\n+        \"//xla:xla_data_proto_cc\",\n+        \"//xla/hlo/analysis:indexing_analysis\",\n+        \"//xla/hlo/analysis:indexing_test_utils\",\n+        \"//xla/hlo/ir:hlo\",\n+        \"//xla/hlo/testlib:hlo_hardware_independent_test_base\",\n+        \"//xla/tsl/platform:status_matchers\",\n+        \"@com_google_googletest//:gtest_main\",\n+        \"@llvm-project//mlir:IR\",\n+    ],\n+)"
        },
        {
            "sha": "281111782e5e2d884073286a2d2ff720e02642ad",
            "filename": "third_party/xla/xla/codegen/tiling/tiled_hlo_computation.cc",
            "status": "renamed",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_computation.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_computation.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_computation.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -13,7 +13,7 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n \n #include <sstream>\n #include <string>\n@@ -22,13 +22,12 @@ limitations under the License.\n #include \"absl/container/inlined_vector.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/str_join.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_opcode.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/service/name_uniquer.h\"\n #include \"xla/util.h\"\n \n namespace xla {\n-namespace gpu {\n \n std::string TiledHloComputation::ToString() const {\n   std::stringstream ss;\n@@ -53,5 +52,4 @@ std::string TiledHloComputation::ToString() const {\n   return ss.str();\n }\n \n-}  // namespace gpu\n }  // namespace xla",
            "previous_filename": "third_party/xla/xla/service/gpu/model/tiled_hlo_computation.cc"
        },
        {
            "sha": "d5813f90d655bdcb8a5264aef77ff1d2a53b3b78",
            "filename": "third_party/xla/xla/codegen/tiling/tiled_hlo_computation.h",
            "status": "renamed",
            "additions": 4,
            "deletions": 52,
            "changes": 56,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_computation.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_computation.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_computation.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -13,8 +13,8 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#ifndef XLA_SERVICE_GPU_MODEL_TILED_HLO_COMPUTATION_H_\n-#define XLA_SERVICE_GPU_MODEL_TILED_HLO_COMPUTATION_H_\n+#ifndef XLA_CODEGEN_TILING_TILED_HLO_COMPUTATION_H_\n+#define XLA_CODEGEN_TILING_TILED_HLO_COMPUTATION_H_\n \n #include <cstdint>\n #include <memory>\n@@ -23,59 +23,12 @@ limitations under the License.\n #include <vector>\n \n #include \"llvm/ADT/SmallVector.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n #include \"xla/iterator_util.h\"\n-#include \"xla/service/gpu/backend_configs.pb.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/tsl/lib/gtl/iterator_range.h\"\n #include \"xla/util.h\"\n \n namespace xla {\n-namespace gpu {\n-\n-// A container for block-level parameters. Currently only used for Triton\n-// fusions.\n-struct BlockLevelParameters {\n-  // TODO(b/421837868): migrate to carry a full tiling instance wherever\n-  // possible?\n-  std::vector<std::vector<int64_t>> output_tile_sizes;\n-\n-  // Triton-specific parameters.\n-  int64_t num_warps = 1;\n-  int num_ctas = 1;\n-  int num_stages = 1;\n-  bool is_tma_allowed = false;\n-\n-  // Returns a BlockLevelParameters struct from a BlockLevelFusionConfig proto.\n-  static BlockLevelParameters FromBlockLevelFusionConfig(\n-      const BlockLevelFusionConfig& config) {\n-    BlockLevelParameters result;\n-    result.num_warps = config.num_warps();\n-    result.num_ctas = config.num_ctas();\n-    result.num_stages = config.num_stages();\n-    result.is_tma_allowed = config.is_tma_allowed();\n-    result.output_tile_sizes.reserve(config.output_tiles_size());\n-    for (const auto& tile : config.output_tiles()) {\n-      result.output_tile_sizes.push_back(\n-          std::vector<int64_t>(tile.sizes().begin(), tile.sizes().end()));\n-    }\n-    return result;\n-  }\n-\n-  // Returns a BlockLevelFusionConfig proto from a BlockLevelParameters struct.\n-  BlockLevelFusionConfig ToBlockLevelFusionConfig() const {\n-    BlockLevelFusionConfig config;\n-    for (const auto& tile_sizes : output_tile_sizes) {\n-      Tile tile;\n-      tile.mutable_sizes()->Add(tile_sizes.begin(), tile_sizes.end());\n-      *config.add_output_tiles() = tile;\n-    }\n-    config.set_num_warps(num_warps);\n-    config.set_num_ctas(num_ctas);\n-    config.set_num_stages(num_stages);\n-    config.set_is_tma_allowed(is_tma_allowed);\n-    return config;\n-  }\n-};\n \n // Stores `TiledHloInstruction`s in the computation.\n //  * Instructions reference each other with non-owning pointers.\n@@ -148,7 +101,6 @@ class TiledHloComputation {\n   llvm::SmallVector<int64_t> num_output_tiles_per_dim_;\n };\n \n-}  // namespace gpu\n }  // namespace xla\n \n-#endif  // XLA_SERVICE_GPU_MODEL_TILED_HLO_COMPUTATION_H_\n+#endif  // XLA_CODEGEN_TILING_TILED_HLO_COMPUTATION_H_",
            "previous_filename": "third_party/xla/xla/service/gpu/model/tiled_hlo_computation.h"
        },
        {
            "sha": "4e67771baf916a7bd9335947890b34bdfa4c00fe",
            "filename": "third_party/xla/xla/codegen/tiling/tiled_hlo_fusion_instruction.cc",
            "status": "added",
            "additions": 60,
            "deletions": 0,
            "changes": 60,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_fusion_instruction.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_fusion_instruction.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_fusion_instruction.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -0,0 +1,60 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#include \"xla/codegen/tiling/tiled_hlo_fusion_instruction.h\"\n+\n+#include <cstdint>\n+#include <memory>\n+#include <optional>\n+#include <utility>\n+\n+#include \"absl/memory/memory.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"llvm/ADT/SmallVector.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n+#include \"xla/hlo/analysis/indexing_map.h\"\n+#include \"xla/hlo/ir/hlo_instruction.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n+\n+namespace xla {\n+\n+absl::StatusOr<std::unique_ptr<TiledHloFusionInstruction>>\n+TiledHloFusionInstruction::Create(\n+    const HloInstruction* hlo,\n+    llvm::SmallVector<const TiledHloInstruction*> operands,\n+    llvm::SmallVector<const TiledHloInstruction*> runtime_variables,\n+    std::unique_ptr<TiledHloComputation> called_computation,\n+    llvm::SmallVector<int64_t> tile_sizes,\n+    llvm::SmallVector<int64_t> tile_strides,\n+    std::optional<IndexingMap> tile_offsets_indexing) {\n+  TF_ASSIGN_OR_RETURN(\n+      std::unique_ptr<TiledHloInstruction> tiled_hlo,\n+      TiledHloInstruction::Create(\n+          hlo, std::move(operands), std::move(runtime_variables),\n+          std::move(tile_sizes), std::move(tile_strides),\n+          std::move(tile_offsets_indexing)));\n+\n+  return absl::WrapUnique(new TiledHloFusionInstruction(\n+      std::move(*tiled_hlo), std::move(called_computation)));\n+}\n+\n+TiledHloFusionInstruction::TiledHloFusionInstruction(\n+    TiledHloInstruction tiled_hlo_instruction,\n+    std::unique_ptr<TiledHloComputation> called_computation)\n+    : TiledHloInstruction(std::move(tiled_hlo_instruction)),\n+      called_computation_(std::move(called_computation)) {}\n+\n+}  // namespace xla"
        },
        {
            "sha": "c6162f6a9b58a8d3bbb605aa19dfe3fa1a318ec1",
            "filename": "third_party/xla/xla/codegen/tiling/tiled_hlo_fusion_instruction.h",
            "status": "added",
            "additions": 67,
            "deletions": 0,
            "changes": 67,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_fusion_instruction.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_fusion_instruction.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_fusion_instruction.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -0,0 +1,67 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#ifndef XLA_CODEGEN_TILING_TILED_HLO_FUSION_INSTRUCTION_H_\n+#define XLA_CODEGEN_TILING_TILED_HLO_FUSION_INSTRUCTION_H_\n+\n+#include <cstdint>\n+#include <memory>\n+#include <optional>\n+\n+#include \"absl/status/statusor.h\"\n+#include \"llvm/ADT/SmallVector.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n+#include \"xla/hlo/analysis/indexing_map.h\"\n+#include \"xla/hlo/ir/hlo_instruction.h\"\n+\n+namespace xla {\n+\n+// `TiledHloFusionInstruction` is to `TiledHloInstruction` what\n+// `HloFusionInstruction` is to `HloInstruction`.\n+//\n+// The main use case for `TiledHloFusionInstruction`s is to support nested\n+// fusions in block-level codegen.\n+//\n+// Similarly to `HloFusionInstruction`, this subclass holds a nested\n+// `TiledHloComputation` accessible through the `called_computation()` method.\n+class TiledHloFusionInstruction : public TiledHloInstruction {\n+ public:\n+  static absl::StatusOr<std::unique_ptr<TiledHloFusionInstruction>> Create(\n+      const HloInstruction* hlo,\n+      llvm::SmallVector<const TiledHloInstruction*> operands,\n+      llvm::SmallVector<const TiledHloInstruction*> runtime_variables,\n+      std::unique_ptr<TiledHloComputation> called_computation,\n+      llvm::SmallVector<int64_t> tile_sizes,\n+      llvm::SmallVector<int64_t> tile_strides,\n+      std::optional<IndexingMap> tile_offsets_indexing);\n+\n+  // The `TiledHloComputation` called by this instruction.\n+  const TiledHloComputation* called_computation() const {\n+    return called_computation_.get();\n+  }\n+\n+ private:\n+  TiledHloFusionInstruction(\n+      TiledHloInstruction tiled_hlo_instruction,\n+      std::unique_ptr<TiledHloComputation> called_computation);\n+\n+  // See comment for `called_computation()`.\n+  std::unique_ptr<TiledHloComputation> called_computation_;\n+};\n+\n+}  // namespace xla\n+\n+#endif  // XLA_CODEGEN_TILING_TILED_HLO_FUSION_INSTRUCTION_H_"
        },
        {
            "sha": "cd13e4e097e0a109b7ca24ced3b297fdd73ec55d",
            "filename": "third_party/xla/xla/codegen/tiling/tiled_hlo_fusion_instruction_test.cc",
            "status": "added",
            "additions": 74,
            "deletions": 0,
            "changes": 74,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_fusion_instruction_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_fusion_instruction_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_fusion_instruction_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -0,0 +1,74 @@\n+/* Copyright 2024 The TensorFlow Authors. All Rights Reserved.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#include \"xla/codegen/tiling/tiled_hlo_fusion_instruction.h\"\n+\n+#include <memory>\n+\n+#include <gmock/gmock.h>\n+#include <gtest/gtest.h>\n+#include \"mlir/IR/MLIRContext.h\"\n+#include \"xla/hlo/analysis/indexing_map.h\"\n+#include \"xla/hlo/analysis/indexing_test_utils.h\"\n+#include \"xla/hlo/ir/hlo_instruction.h\"\n+#include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n+#include \"xla/shape_util.h\"\n+#include \"xla/tsl/platform/status_matchers.h\"\n+#include \"xla/xla_data.pb.h\"\n+\n+namespace xla {\n+namespace {\n+\n+using ::testing::HasSubstr;\n+\n+class TiledHloFusionInstructionTest : public HloHardwareIndependentTestBase {\n+ public:\n+  mlir::MLIRContext mlir_context_;\n+};\n+\n+TEST_F(TiledHloFusionInstructionTest,\n+       TileSizesAndStridesShouldMatchHloShapeRank) {\n+  std::unique_ptr<HloInstruction> hlo = HloInstruction::CreateParameter(\n+      /*parameter_number=*/0,\n+      ShapeUtil::MakeShape(PrimitiveType::F32, {32, 64}), \"p0\");\n+\n+  IndexingMap tile_offsets_indexing = IndexingMap::FromTensorSizes(\n+      ParseAffineMap(\"(d0) -> (d0 floordiv 16, (d0 mod 16) * 16)\",\n+                     &mlir_context_),\n+      /*dim_upper_bounds=*/{8},\n+      /*symbol_upper_bounds=*/{});\n+\n+  EXPECT_THAT(TiledHloFusionInstruction::Create(\n+                  hlo.get(), /*operands=*/{}, /*runtime_variables=*/{},\n+                  /*called_computation=*/nullptr,\n+                  /*tile_sizes=*/{16},\n+                  /*tile_strides=*/{1, 1}, tile_offsets_indexing)\n+                  .status()\n+                  .message(),\n+              HasSubstr(\"Number of tile sizes must be equal to the rank\"));\n+\n+  EXPECT_THAT(TiledHloFusionInstruction::Create(\n+                  hlo.get(), /*operands=*/{}, /*runtime_variables=*/{},\n+                  /*called_computation=*/nullptr,\n+                  /*tile_sizes=*/{16, 16},\n+                  /*tile_strides=*/{1, 1, 1}, tile_offsets_indexing)\n+                  .status()\n+                  .message(),\n+              HasSubstr(\"Number of tile strides must be equal to the rank\"));\n+}\n+\n+}  // namespace\n+\n+}  // namespace xla"
        },
        {
            "sha": "8fec09c257ef2df98361c1fe1fee056b1fc587de",
            "filename": "third_party/xla/xla/codegen/tiling/tiled_hlo_instruction.cc",
            "status": "renamed",
            "additions": 1,
            "deletions": 38,
            "changes": 39,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_instruction.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_instruction.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_instruction.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -13,7 +13,7 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n \n #include <cstdint>\n #include <memory>\n@@ -32,12 +32,9 @@ limitations under the License.\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/analysis/indexing_map_serialization.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/util.h\"\n-#include \"tsl/platform/errors.h\"\n \n namespace xla {\n-namespace gpu {\n \n namespace {\n \n@@ -149,38 +146,4 @@ std::string TiledHloInstruction::ToString() const {\n   return ss.str();\n }\n \n-/*static*/\n-absl::StatusOr<std::unique_ptr<TiledHloFusionInstruction>>\n-TiledHloFusionInstruction::Create(\n-    const HloInstruction* hlo,\n-    llvm::SmallVector<const TiledHloInstruction*> operands,\n-    llvm::SmallVector<const TiledHloInstruction*> runtime_variables,\n-    std::unique_ptr<TiledHloComputation> called_computation,\n-    llvm::SmallVector<int64_t> tile_sizes,\n-    llvm::SmallVector<int64_t> tile_strides,\n-    std::optional<IndexingMap> tile_offsets_indexing) {\n-  TF_RETURN_IF_ERROR(VerifyTiledHloInstructionConstructorPreconditions(\n-      hlo, tile_sizes, tile_strides, tile_offsets_indexing, runtime_variables));\n-\n-  return absl::WrapUnique(new TiledHloFusionInstruction(\n-      hlo, std::move(operands), std::move(runtime_variables),\n-      std::move(called_computation), std::move(tile_sizes),\n-      std::move(tile_strides), std::move(tile_offsets_indexing)));\n-}\n-\n-TiledHloFusionInstruction::TiledHloFusionInstruction(\n-    const HloInstruction* hlo,\n-    llvm::SmallVector<const TiledHloInstruction*> operands,\n-    llvm::SmallVector<const TiledHloInstruction*> runtime_variables,\n-    std::unique_ptr<TiledHloComputation> called_computation,\n-    llvm::SmallVector<int64_t> tile_sizes,\n-    llvm::SmallVector<int64_t> tile_strides,\n-    std::optional<IndexingMap> tile_offsets_indexing)\n-    : TiledHloInstruction(hlo, std::move(operands),\n-                          std::move(runtime_variables), std::move(tile_sizes),\n-                          std::move(tile_strides),\n-                          std::move(tile_offsets_indexing)),\n-      called_computation_(std::move(called_computation)) {}\n-\n-}  // namespace gpu\n }  // namespace xla",
            "previous_filename": "third_party/xla/xla/service/gpu/model/tiled_hlo_instruction.cc"
        },
        {
            "sha": "a235f17d2c0a7c9691ef417433758fc1ebd13b23",
            "filename": "third_party/xla/xla/codegen/tiling/tiled_hlo_instruction.h",
            "status": "renamed",
            "additions": 6,
            "deletions": 47,
            "changes": 53,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_instruction.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_instruction.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_instruction.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -13,27 +13,24 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#ifndef XLA_SERVICE_GPU_MODEL_TILED_HLO_INSTRUCTION_H_\n-#define XLA_SERVICE_GPU_MODEL_TILED_HLO_INSTRUCTION_H_\n+#ifndef XLA_CODEGEN_TILING_TILED_HLO_INSTRUCTION_H_\n+#define XLA_CODEGEN_TILING_TILED_HLO_INSTRUCTION_H_\n \n #include <cstdint>\n #include <memory>\n #include <optional>\n #include <string>\n #include <utility>\n-#include <vector>\n \n #include \"absl/log/check.h\"\n #include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/types/span.h\"\n #include \"llvm/ADT/SmallVector.h\"\n-#include \"xla/hlo/analysis/indexing_analysis.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n \n namespace xla {\n-namespace gpu {\n \n // A wrapper around HloInstruction that represents a tiled HLO instruction.\n //\n@@ -43,6 +40,9 @@ namespace gpu {\n // `(block_id) -> (tile_offset0, tile_offset1, ...)`\n class TiledHloInstruction {\n  public:\n+  TiledHloInstruction& operator=(TiledHloInstruction&&) = default;\n+  TiledHloInstruction(TiledHloInstruction&&) = default;\n+\n   virtual ~TiledHloInstruction() = default;\n \n   // Creates an instance of TiledHloInstruction. Returns an error if any of the\n@@ -187,47 +187,6 @@ H AbslHashValue(H h, const TiledHloInstruction& tiled_hlo_instruction) {\n           tiled_hlo_instruction.runtime_variables()));\n }\n \n-class TiledHloComputation;\n-\n-// `TiledHloFusionInstruction` is to `TiledHloInstruction` what\n-// `HloFusionInstruction` is to `HloInstruction`.\n-//\n-// The main use case for `TiledHloFusionInstruction`s is to support nested\n-// fusions in block-level codegen.\n-//\n-// Similarly to `HloFusionInstruction`, this subclass holds a nested\n-// `TiledHloComputation` accessible through the `called_computation()` method.\n-class TiledHloFusionInstruction : public TiledHloInstruction {\n- public:\n-  static absl::StatusOr<std::unique_ptr<TiledHloFusionInstruction>> Create(\n-      const HloInstruction* hlo,\n-      llvm::SmallVector<const TiledHloInstruction*> operands,\n-      llvm::SmallVector<const TiledHloInstruction*> runtime_variables,\n-      std::unique_ptr<TiledHloComputation> called_computation,\n-      llvm::SmallVector<int64_t> tile_sizes,\n-      llvm::SmallVector<int64_t> tile_strides,\n-      std::optional<IndexingMap> tile_offsets_indexing);\n-\n-  // The `TiledHloComputation` called by this instruction.\n-  const TiledHloComputation* called_computation() const {\n-    return called_computation_.get();\n-  }\n-\n- private:\n-  TiledHloFusionInstruction(\n-      const HloInstruction* hlo,\n-      llvm::SmallVector<const TiledHloInstruction*> operands,\n-      llvm::SmallVector<const TiledHloInstruction*> runtime_variables,\n-      std::unique_ptr<TiledHloComputation> called_computation,\n-      llvm::SmallVector<int64_t> tile_sizes,\n-      llvm::SmallVector<int64_t> tile_strides,\n-      std::optional<IndexingMap> tile_offsets_indexing);\n-\n-  // See comment for `called_computation()`.\n-  std::unique_ptr<TiledHloComputation> called_computation_;\n-};\n-\n-}  // namespace gpu\n }  // namespace xla\n \n-#endif  // XLA_SERVICE_GPU_MODEL_TILED_HLO_INSTRUCTION_H_\n+#endif  // XLA_CODEGEN_TILING_TILED_HLO_INSTRUCTION_H_",
            "previous_filename": "third_party/xla/xla/service/gpu/model/tiled_hlo_instruction.h"
        },
        {
            "sha": "d1a029f74864260f512db85ac03809a1c5e21df9",
            "filename": "third_party/xla/xla/codegen/tiling/tiled_hlo_instruction_test.cc",
            "status": "renamed",
            "additions": 1,
            "deletions": 37,
            "changes": 38,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_instruction_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_instruction_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Ftiling%2Ftiled_hlo_instruction_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -13,7 +13,7 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n \n #include <memory>\n \n@@ -24,14 +24,12 @@ limitations under the License.\n #include \"xla/hlo/analysis/indexing_test_utils.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"  // IWYU pragma: keep\n #include \"xla/shape_util.h\"\n #include \"xla/tsl/platform/status_matchers.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/xla_data.pb.h\"\n \n namespace xla {\n-namespace gpu {\n namespace {\n \n using ::testing::HasSubstr;\n@@ -155,40 +153,6 @@ TEST_F(TiledHloInstructionTest,\n                            \"2 runtime variables were provided\"));\n }\n \n-using TiledHloFusionInstructionTest = TiledHloInstructionTest;\n-\n-TEST_F(TiledHloFusionInstructionTest,\n-       TileSizesAndStridesShouldMatchHloShapeRank) {\n-  std::unique_ptr<HloInstruction> hlo = HloInstruction::CreateParameter(\n-      /*parameter_number=*/0,\n-      ShapeUtil::MakeShape(PrimitiveType::F32, {32, 64}), \"p0\");\n-\n-  IndexingMap tile_offsets_indexing = IndexingMap::FromTensorSizes(\n-      ParseAffineMap(\"(d0) -> (d0 floordiv 16, (d0 mod 16) * 16)\",\n-                     &mlir_context_),\n-      /*dim_upper_bounds=*/{8},\n-      /*symbol_upper_bounds=*/{});\n-\n-  EXPECT_THAT(TiledHloFusionInstruction::Create(\n-                  hlo.get(), /*operands=*/{}, /*runtime_variables=*/{},\n-                  /*called_computation=*/nullptr,\n-                  /*tile_sizes=*/{16},\n-                  /*tile_strides=*/{1, 1}, tile_offsets_indexing)\n-                  .status()\n-                  .message(),\n-              HasSubstr(\"Number of tile sizes must be equal to the rank\"));\n-\n-  EXPECT_THAT(TiledHloFusionInstruction::Create(\n-                  hlo.get(), /*operands=*/{}, /*runtime_variables=*/{},\n-                  /*called_computation=*/nullptr,\n-                  /*tile_sizes=*/{16, 16},\n-                  /*tile_strides=*/{1, 1, 1}, tile_offsets_indexing)\n-                  .status()\n-                  .message(),\n-              HasSubstr(\"Number of tile strides must be equal to the rank\"));\n-}\n-\n }  // namespace\n \n-}  // namespace gpu\n }  // namespace xla",
            "previous_filename": "third_party/xla/xla/service/gpu/model/tiled_hlo_instruction_test.cc"
        },
        {
            "sha": "9fe2e69b7bbe54c914dfa5990a5546c769453587",
            "filename": "third_party/xla/xla/service/gpu/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2FBUILD?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -433,7 +433,7 @@ cc_library(\n         \"//xla/service:name_uniquer\",\n         \"//xla/service:platform_util\",\n         \"//xla/service/gpu/kernels:custom_kernel\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n+        \"//xla/service/gpu/model:block_level_parameters\",\n         \"//xla/service/llvm_ir:buffer_assignment_util\",\n         \"//xla/service/llvm_ir:ir_array\",\n         \"//xla/service/llvm_ir:kernel_support_library\","
        },
        {
            "sha": "254cf1f6edbda60b6ac84a7640a411568f98d4d3",
            "filename": "third_party/xla/xla/service/gpu/ir_emitter_unnested.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fir_emitter_unnested.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fir_emitter_unnested.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fir_emitter_unnested.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -157,7 +157,7 @@ limitations under the License.\n #include \"xla/service/gpu/kernels/custom_kernel.h\"\n #include \"xla/service/gpu/launch_dimensions.h\"\n #include \"xla/service/gpu/matmul_utils.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/service/gpu/parallel_loop_emitter.h\"\n #include \"xla/service/gpu/stream_executor_util.h\"\n #include \"xla/service/gpu/triton_call.h\""
        },
        {
            "sha": "473570bce8f7daf070e7df97535d26aea072e041",
            "filename": "third_party/xla/xla/service/gpu/model/BUILD",
            "status": "modified",
            "additions": 19,
            "deletions": 61,
            "changes": 80,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2FBUILD?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -408,8 +408,6 @@ xla_cc_test(\n         \"@com_google_absl//absl/time\",\n         \"@com_google_googletest//:gtest\",\n         \"@llvm-project//mlir:IR\",\n-        \"@local_tsl//tsl/platform:errors\",\n-        \"@local_tsl//tsl/platform:statusor\",\n     ],\n )\n \n@@ -418,8 +416,8 @@ cc_library(\n     srcs = [\"gpu_dot_fusion_cost_model.cc\"],\n     hdrs = [\"gpu_dot_fusion_cost_model.h\"],\n     deps = [\n+        \":block_level_parameters\",\n         \":gpu_performance_model_base\",\n-        \":tiled_hlo_instruction_or_computation\",\n         \"//xla:shape_util\",\n         \"//xla:util\",\n         \"//xla:xla_data_proto_cc\",\n@@ -443,8 +441,8 @@ xla_cc_test(\n     name = \"gpu_dot_fusion_cost_model_test\",\n     srcs = [\"gpu_dot_fusion_cost_model_test.cc\"],\n     deps = [\n+        \":block_level_parameters\",\n         \":gpu_dot_fusion_cost_model\",\n-        \":tiled_hlo_instruction_or_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/testlib:hlo_hardware_independent_test_base\",\n         \"//xla/hlo/testlib:test_helpers\",\n@@ -517,17 +515,18 @@ cc_library(\n     srcs = [\"gpu_indexing_performance_model.cc\"],\n     hdrs = [\"gpu_indexing_performance_model.h\"],\n     deps = [\n+        \":block_level_parameters\",\n         \":coalescing_analysis\",\n         \":fusion_analysis_cache\",\n         \":gpu_hlo_cost_analysis\",\n         \":gpu_performance_model_base\",\n         \":hlo_op_profiles\",\n         \":symbolic_tile_analysis\",\n-        \":tiled_hlo_instruction_or_computation\",\n         \":triton_emitter_constraints\",\n         \"//xla:shape_util\",\n         \"//xla:util\",\n         \"//xla/backends/gpu/codegen/triton:fusion\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/analysis:indexing_analysis\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/utils:hlo_traversal\",\n@@ -562,8 +561,8 @@ xla_cc_test(\n         \":gpu_indexing_performance_model\",\n         \":gpu_performance_model_base\",\n         \":symbolic_tile_analysis\",\n-        \":tiled_hlo_instruction_or_computation\",\n         \"//xla:shape_util\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/testlib:hlo_hardware_independent_test_base\",\n         \"//xla/hlo/testlib:test_helpers\",\n@@ -582,8 +581,6 @@ xla_cc_test(\n         \"@com_google_absl//absl/time\",\n         \"@com_google_googletest//:gtest\",\n         \"@llvm-project//mlir:IR\",\n-        \"@local_tsl//tsl/platform:status_matchers\",\n-        \"@local_tsl//tsl/platform:statusor\",\n     ],\n )\n \n@@ -727,59 +724,18 @@ xla_cc_test(\n )\n \n cc_library(\n-    name = \"tiled_hlo_instruction_or_computation\",\n-    srcs = [\n-        \"tiled_hlo_computation.cc\",\n-        \"tiled_hlo_instruction.cc\",\n-    ],\n+    name = \"block_level_parameters\",\n     hdrs = [\n-        \"tiled_hlo_computation.h\",\n-        \"tiled_hlo_instruction.h\",\n-    ],\n-    deps = [\n-        \"//xla:util\",\n-        \"//xla/hlo/analysis:indexing_analysis\",\n-        \"//xla/hlo/ir:hlo\",\n-        \"//xla/service:name_uniquer\",\n-        \"//xla/service/gpu:backend_configs_cc\",\n-        \"//xla/tsl/lib/gtl:iterator_range\",\n-        \"@com_google_absl//absl/container:flat_hash_map\",\n-        \"@com_google_absl//absl/container:inlined_vector\",\n-        \"@com_google_absl//absl/log:check\",\n-        \"@com_google_absl//absl/memory\",\n-        \"@com_google_absl//absl/status\",\n-        \"@com_google_absl//absl/status:statusor\",\n-        \"@com_google_absl//absl/strings\",\n-        \"@com_google_absl//absl/strings:str_format\",\n-        \"@com_google_absl//absl/types:span\",\n-        \"@llvm-project//llvm:Support\",\n-        \"@local_tsl//tsl/platform:errors\",\n-    ],\n-)\n-\n-xla_cc_test(\n-    name = \"tiled_hlo_instruction_test\",\n-    srcs = [\"tiled_hlo_instruction_test.cc\"],\n-    deps = [\n-        \":tiled_hlo_instruction_or_computation\",\n-        \"//xla:shape_util\",\n-        \"//xla:xla_data_proto_cc\",\n-        \"//xla/hlo/analysis:indexing_analysis\",\n-        \"//xla/hlo/analysis:indexing_test_utils\",\n-        \"//xla/hlo/ir:hlo\",\n-        \"//xla/hlo/testlib:hlo_hardware_independent_test_base\",\n-        \"//xla/tsl/platform:status_matchers\",\n-        \"//xla/tsl/platform:statusor\",\n-        \"@com_google_googletest//:gtest_main\",\n-        \"@llvm-project//mlir:IR\",\n+        \"block_level_parameters.h\",\n     ],\n+    deps = [\"//xla/service/gpu:backend_configs_cc\"],\n )\n \n xla_cc_test(\n-    name = \"tiled_hlo_computation_test\",\n-    srcs = [\"tiled_hlo_computation_test.cc\"],\n+    name = \"block_level_parameters_test\",\n+    srcs = [\"block_level_parameters_test.cc\"],\n     deps = [\n-        \":tiled_hlo_instruction_or_computation\",\n+        \":block_level_parameters\",\n         \"//xla/service/gpu:backend_configs_cc\",\n         \"@com_google_googletest//:gtest_main\",\n     ],\n@@ -793,9 +749,11 @@ cc_library(\n         \":constraint_expression\",\n         \":symbolic_tile\",\n         \":symbolic_tiled_hlo_instruction\",\n-        \":tiled_hlo_instruction_or_computation\",\n         \"//xla:shape_util\",\n         \"//xla:util\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n+        \"//xla/codegen/tiling:tiled_hlo_fusion_instruction\",\n+        \"//xla/codegen/tiling:tiled_hlo_instruction\",\n         \"//xla/hlo/analysis:indexing_analysis\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/utils:hlo_traversal\",\n@@ -830,8 +788,9 @@ xla_cc_test(\n         \":constraint_expression\",\n         \":symbolic_tile_analysis\",\n         \":symbolic_tiled_hlo_instruction\",\n-        \":tiled_hlo_instruction_or_computation\",\n         \"//xla:util\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n+        \"//xla/codegen/tiling:tiled_hlo_fusion_instruction\",\n         \"//xla/hlo/analysis:indexing_test_utils\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/parser:hlo_parser\",\n@@ -912,12 +871,12 @@ cc_library(\n     hdrs = [\"coalescing_analysis.h\"],\n     deps = [\n         \":affine_map_evaluator\",\n-        \":tiled_hlo_instruction_or_computation\",\n         \"//xla:shape_util\",\n         \"//xla:util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/backends/gpu/codegen:fusion_emitter\",\n         \"//xla/backends/gpu/codegen:fusions\",\n+        \"//xla/codegen/tiling:tiled_hlo_instruction\",\n         \"//xla/hlo/analysis:indexing_analysis\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/utils:hlo_traversal\",\n@@ -938,11 +897,11 @@ xla_cc_test(\n     deps = [\n         \":coalescing_analysis\",\n         \":symbolic_tile_analysis\",\n-        \":tiled_hlo_instruction_or_computation\",\n         \"//xla:shape_util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/backends/gpu/codegen:fusion_emitter\",\n         \"//xla/backends/gpu/codegen:fusions\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/testlib:hlo_hardware_independent_test_base\",\n         \"//xla/hlo/utils:hlo_traversal\",\n@@ -1159,7 +1118,6 @@ cc_library(\n     name = \"interpolator\",\n     hdrs = [\"interpolator.h\"],\n     deps = [\n-        \"//xla/tsl/platform:logging\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/strings\",\n@@ -1349,11 +1307,11 @@ cc_library(\n     srcs = [\"matmul_ptable_stats_collection.cc\"],\n     hdrs = [\"matmul_ptable_stats_collection.h\"],\n     deps = [\n+        \":block_level_parameters\",\n         \":gpu_dot_fusion_cost_model\",\n         \":hlo_op_profile_proto_cc\",\n         \":hlo_op_profiles\",\n         \":matmul_interpolator\",\n-        \":tiled_hlo_instruction_or_computation\",\n         \"//xla:util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/backends/gpu/codegen/triton:support\","
        },
        {
            "sha": "3aba427de0fb0fda1aa591cf10b5859908677d73",
            "filename": "third_party/xla/xla/service/gpu/model/block_level_parameters.h",
            "status": "added",
            "additions": 75,
            "deletions": 0,
            "changes": 75,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fblock_level_parameters.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fblock_level_parameters.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fblock_level_parameters.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -0,0 +1,75 @@\n+/* Copyright 2024 The TensorFlow Authors. All Rights Reserved.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#ifndef XLA_SERVICE_GPU_MODEL_BLOCK_LEVEL_PARAMETERS_H_\n+#define XLA_SERVICE_GPU_MODEL_BLOCK_LEVEL_PARAMETERS_H_\n+\n+#include <cstdint>\n+#include <vector>\n+\n+#include \"xla/service/gpu/backend_configs.pb.h\"\n+\n+namespace xla {\n+namespace gpu {\n+\n+// A container for block-level parameters. Currently only used for Triton\n+// fusions.\n+struct BlockLevelParameters {\n+  // TODO(b/421837868): migrate to carry a full tiling instance wherever\n+  // possible?\n+  std::vector<std::vector<int64_t>> output_tile_sizes;\n+\n+  // Triton-specific parameters.\n+  int64_t num_warps = 1;\n+  int num_ctas = 1;\n+  int num_stages = 1;\n+  bool is_tma_allowed = false;\n+\n+  // Returns a BlockLevelParameters struct from a BlockLevelFusionConfig proto.\n+  static BlockLevelParameters FromBlockLevelFusionConfig(\n+      const BlockLevelFusionConfig& config) {\n+    BlockLevelParameters result;\n+    result.num_warps = config.num_warps();\n+    result.num_ctas = config.num_ctas();\n+    result.num_stages = config.num_stages();\n+    result.is_tma_allowed = config.is_tma_allowed();\n+    result.output_tile_sizes.reserve(config.output_tiles_size());\n+    for (const auto& tile : config.output_tiles()) {\n+      result.output_tile_sizes.push_back(\n+          std::vector<int64_t>(tile.sizes().begin(), tile.sizes().end()));\n+    }\n+    return result;\n+  }\n+\n+  // Returns a BlockLevelFusionConfig proto from a BlockLevelParameters struct.\n+  BlockLevelFusionConfig ToBlockLevelFusionConfig() const {\n+    BlockLevelFusionConfig config;\n+    for (const auto& tile_sizes : output_tile_sizes) {\n+      Tile tile;\n+      tile.mutable_sizes()->Add(tile_sizes.begin(), tile_sizes.end());\n+      *config.add_output_tiles() = tile;\n+    }\n+    config.set_num_warps(num_warps);\n+    config.set_num_ctas(num_ctas);\n+    config.set_num_stages(num_stages);\n+    config.set_is_tma_allowed(is_tma_allowed);\n+    return config;\n+  }\n+};\n+\n+}  // namespace gpu\n+}  // namespace xla\n+\n+#endif  // XLA_SERVICE_GPU_MODEL_BLOCK_LEVEL_PARAMETERS_H_"
        },
        {
            "sha": "7cf1aa13b21c19441a8d7f63a0fe0d7fb5a1039d",
            "filename": "third_party/xla/xla/service/gpu/model/block_level_parameters_test.cc",
            "status": "renamed",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fblock_level_parameters_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fblock_level_parameters_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fblock_level_parameters_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -13,7 +13,7 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n \n #include <gmock/gmock.h>\n #include <gtest/gtest.h>",
            "previous_filename": "third_party/xla/xla/service/gpu/model/tiled_hlo_computation_test.cc"
        },
        {
            "sha": "1fd383d92c431122f9798a2478996bb29bf21612",
            "filename": "third_party/xla/xla/service/gpu/model/coalescing_analysis.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fcoalescing_analysis.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fcoalescing_analysis.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fcoalescing_analysis.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -43,7 +43,6 @@ limitations under the License.\n #include \"xla/service/gpu/gpu_fusible.h\"\n #include \"xla/service/gpu/hlo_fusion_analysis.h\"\n #include \"xla/service/gpu/model/affine_map_evaluator.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n #include \"xla/stream_executor/device_description.h\""
        },
        {
            "sha": "550d847d4af1b7aaa1d40a063403817bd3941574",
            "filename": "third_party/xla/xla/service/gpu/model/coalescing_analysis.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fcoalescing_analysis.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fcoalescing_analysis.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fcoalescing_analysis.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -22,10 +22,10 @@ limitations under the License.\n #include \"absl/types/span.h\"\n #include \"llvm/ADT/SmallVector.h\"\n #include \"mlir/IR/MLIRContext.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/service/gpu/hlo_fusion_analysis.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/stream_executor/device_description.h\"\n \n namespace xla::gpu {"
        },
        {
            "sha": "c5495a674b0e8d3330fe27b8caa5f8246c040ae6",
            "filename": "third_party/xla/xla/service/gpu/model/coalescing_analysis_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fcoalescing_analysis_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fcoalescing_analysis_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fcoalescing_analysis_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -26,15 +26,14 @@ limitations under the License.\n #include \"mlir/IR/MLIRContext.h\"\n #include \"xla/backends/gpu/codegen/fusion_emitter.h\"\n #include \"xla/backends/gpu/codegen/fusions.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_opcode.h\"\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n #include \"xla/hlo/utils/hlo_traversal.h\"\n #include \"xla/service/gpu/gpu_device_info_for_tests.h\"\n #include \"xla/service/gpu/hlo_fusion_analysis.h\"\n #include \"xla/service/gpu/model/symbolic_tile_analysis.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/service/hlo_module_config.h\"\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\""
        },
        {
            "sha": "cd0f9066955bb5e6fefae4cb17800abcc27f52a0",
            "filename": "third_party/xla/xla/service/gpu/model/gpu_dot_fusion_cost_model.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_dot_fusion_cost_model.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_dot_fusion_cost_model.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_dot_fusion_cost_model.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -31,8 +31,8 @@ limitations under the License.\n #include \"absl/types/span.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n #include \"xla/primitive_util.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/service/gpu/model/gpu_performance_model_base.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/shape.h\"\n #include \"xla/stream_executor/cuda/cuda_compute_capability.h\"\n #include \"xla/stream_executor/device_description.h\""
        },
        {
            "sha": "cd43ac2e1905b886c079c185eb44369eb085ef41",
            "filename": "third_party/xla/xla/service/gpu/model/gpu_dot_fusion_cost_model.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_dot_fusion_cost_model.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_dot_fusion_cost_model.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_dot_fusion_cost_model.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -23,7 +23,7 @@ limitations under the License.\n #include \"absl/time/time.h\"\n #include \"absl/types/span.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/stream_executor/device_description.h\"\n \n namespace xla {"
        },
        {
            "sha": "e406869b6fee54f4939e94f54ef291e9f5d9a3e9",
            "filename": "third_party/xla/xla/service/gpu/model/gpu_dot_fusion_cost_model_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_dot_fusion_cost_model_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_dot_fusion_cost_model_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_dot_fusion_cost_model_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -26,7 +26,7 @@ limitations under the License.\n #include \"xla/hlo/testlib/test_helpers.h\"\n #include \"xla/hlo/testlib/verified_hlo_module.h\"\n #include \"xla/service/gpu/gpu_device_info_for_tests.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/tsl/platform/statusor.h\"\n "
        },
        {
            "sha": "3d94d7ec65e128f0c049a85111dbacaf4bb576b5",
            "filename": "third_party/xla/xla/service/gpu/model/gpu_indexing_performance_model.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_indexing_performance_model.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_indexing_performance_model.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_indexing_performance_model.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -32,6 +32,7 @@ limitations under the License.\n #include \"absl/types/span.h\"\n #include \"llvm/Support/MathExtras.h\"\n #include \"xla/backends/gpu/codegen/triton/fusion.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n #include \"xla/hlo/analysis/indexing_analysis.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n@@ -45,8 +46,6 @@ limitations under the License.\n #include \"xla/service/gpu/model/gpu_hlo_cost_analysis.h\"\n #include \"xla/service/gpu/model/gpu_performance_model_base.h\"\n #include \"xla/service/gpu/model/symbolic_tile_analysis.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/service/gpu/model/triton_emitter_constraints.h\"\n #include \"xla/service/instruction_fusion.h\"\n #include \"xla/shape.h\""
        },
        {
            "sha": "85f40e8505482d9ffef6d8c47604f63220947281",
            "filename": "third_party/xla/xla/service/gpu/model/gpu_indexing_performance_model.h",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_indexing_performance_model.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_indexing_performance_model.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_indexing_performance_model.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -23,15 +23,16 @@ limitations under the License.\n #include \"absl/status/statusor.h\"\n #include \"absl/types/span.h\"\n #include \"mlir/IR/MLIRContext.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/utils/hlo_traversal.h\"\n #include \"xla/service/gpu/hlo_fusion_analysis.h\"\n #include \"xla/service/gpu/launch_dimensions.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/service/gpu/model/fusion_analysis_cache.h\"\n #include \"xla/service/gpu/model/gpu_hlo_cost_analysis.h\"\n #include \"xla/service/gpu/model/gpu_performance_model_base.h\"\n #include \"xla/service/gpu/model/hlo_op_profiles.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/hlo_cost_analysis.h\"\n #include \"xla/service/instruction_fusion.h\"\n #include \"xla/shape.h\""
        },
        {
            "sha": "2b4ce7c94dd484fb406fd8e85b9c98bb98bb2914",
            "filename": "third_party/xla/xla/service/gpu/model/gpu_indexing_performance_model_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_indexing_performance_model_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_indexing_performance_model_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fgpu_indexing_performance_model_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -26,6 +26,7 @@ limitations under the License.\n #include \"absl/strings/string_view.h\"\n #include \"absl/time/time.h\"\n #include \"mlir/IR/MLIRContext.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n #include \"xla/hlo/ir/hlo_computation.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/testlib/hlo_hardware_independent_test_base.h\"\n@@ -39,7 +40,6 @@ limitations under the License.\n #include \"xla/service/gpu/model/gpu_hlo_cost_analysis.h\"\n #include \"xla/service/gpu/model/gpu_performance_model_base.h\"\n #include \"xla/service/gpu/model/symbolic_tile_analysis.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/hlo_cost_analysis.h\"\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\""
        },
        {
            "sha": "38309bb82d4ec1f5701c462cf6e97c30e8d38795",
            "filename": "third_party/xla/xla/service/gpu/model/matmul_ptable_stats_collection.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fmatmul_ptable_stats_collection.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fmatmul_ptable_stats_collection.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fmatmul_ptable_stats_collection.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -38,11 +38,11 @@ limitations under the License.\n #include \"xla/hlo/utils/hlo_query.h\"\n #include \"xla/service/gpu/backend_configs.pb.h\"\n #include \"xla/service/gpu/matmul_utils.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/service/gpu/model/gpu_dot_fusion_cost_model.h\"\n #include \"xla/service/gpu/model/hlo_op_profile.pb.h\"\n #include \"xla/service/gpu/model/hlo_op_profiles.h\"\n #include \"xla/service/gpu/model/matmul_interpolator.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/transforms/nest_gemm_fusion.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/tsl/platform/env.h\""
        },
        {
            "sha": "31f97ca424d29bab72d1c9aaa391f64c8b15af41",
            "filename": "third_party/xla/xla/service/gpu/model/symbolic_tile_analysis.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fsymbolic_tile_analysis.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fsymbolic_tile_analysis.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fsymbolic_tile_analysis.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -52,6 +52,8 @@ limitations under the License.\n #include \"mlir/IR/AffineMap.h\"\n #include \"mlir/IR/MLIRContext.h\"\n #include \"mlir/Support/LLVM.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_fusion_instruction.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_instruction.h\"\n #include \"xla/hlo/analysis/indexing_analysis.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/analysis/indexing_map_serialization.h\"\n@@ -64,8 +66,6 @@ limitations under the License.\n #include \"xla/service/gpu/model/constraint_expression.h\"\n #include \"xla/service/gpu/model/symbolic_tile.h\"\n #include \"xla/service/gpu/model/symbolic_tiled_hlo_instruction.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/service/instruction_fusion.h\"\n #include \"xla/service/name_uniquer.h\"\n #include \"xla/shape.h\""
        },
        {
            "sha": "a47bc38201679501d29bf73047f9926cae9506de",
            "filename": "third_party/xla/xla/service/gpu/model/symbolic_tile_analysis.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fsymbolic_tile_analysis.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fsymbolic_tile_analysis.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fsymbolic_tile_analysis.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -31,13 +31,13 @@ limitations under the License.\n #include \"absl/status/statusor.h\"\n #include \"absl/types/span.h\"\n #include \"mlir/IR/MLIRContext.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n #include \"xla/hlo/analysis/indexing_map.h\"\n #include \"xla/hlo/ir/hlo_computation.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/utils/hlo_traversal.h\"\n #include \"xla/service/gpu/model/constraint_expression.h\"\n #include \"xla/service/gpu/model/symbolic_tiled_hlo_instruction.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/instruction_fusion.h\"\n \n namespace xla {"
        },
        {
            "sha": "d13a3e3f210bee0b540a48afbe357e1e95bb449c",
            "filename": "third_party/xla/xla/service/gpu/model/symbolic_tile_analysis_test.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fsymbolic_tile_analysis_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fsymbolic_tile_analysis_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fsymbolic_tile_analysis_test.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -35,6 +35,8 @@ limitations under the License.\n #include \"absl/strings/string_view.h\"\n #include \"absl/types/span.h\"\n #include \"mlir/IR/MLIRContext.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_computation.h\"\n+#include \"xla/codegen/tiling/tiled_hlo_fusion_instruction.h\"\n #include \"xla/hlo/analysis/indexing_test_utils.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n@@ -45,8 +47,6 @@ limitations under the License.\n #include \"xla/hlo/utils/hlo_traversal.h\"\n #include \"xla/service/gpu/model/constraint_expression.h\"\n #include \"xla/service/gpu/model/symbolic_tiled_hlo_instruction.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_instruction.h\"\n #include \"xla/service/instruction_fusion.h\"\n #include \"xla/tsl/lib/core/status_test_util.h\"\n #include \"xla/tsl/platform/errors.h\""
        },
        {
            "sha": "cd445b4760b6a0b462f221d3cd2273cf72538be9",
            "filename": "third_party/xla/xla/service/gpu/transforms/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2FBUILD?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -1979,10 +1979,10 @@ cc_library(\n         \"//xla/service/gpu:backend_configs_cc\",\n         \"//xla/service/gpu:ir_emission_utils\",\n         \"//xla/service/gpu:matmul_utils\",\n+        \"//xla/service/gpu/model:block_level_parameters\",\n         \"//xla/service/gpu/model:symbolic_tile\",\n         \"//xla/service/gpu/model:symbolic_tile_analysis\",\n         \"//xla/service/gpu/model:symbolic_tiled_hlo_instruction\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/service/gpu/model:triton_emitter_constraints\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/tools:hlo_decomposer_lib\",\n@@ -2062,7 +2062,6 @@ cc_library(\n         \"//xla/service/gpu/model:gpu_indexing_performance_model\",\n         \"//xla/service/gpu/model:gpu_performance_model\",\n         \"//xla/service/gpu/model:gpu_performance_model_base\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/service/gpu/model:triton_emitter_constraints\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/tsl/platform:env\",\n@@ -2520,6 +2519,7 @@ cc_library(\n         \"//xla:util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/backends/gpu/codegen/triton:support\",\n+        \"//xla/codegen/tiling:tiled_hlo_computation\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/pass:hlo_pass\",\n         \"//xla/hlo/pass:hlo_pass_pipeline\",\n@@ -2536,7 +2536,6 @@ cc_library(\n         \"//xla/service/gpu/model:gpu_performance_model\",\n         \"//xla/service/gpu/model:gpu_performance_model_base\",\n         \"//xla/service/gpu/model:symbolic_tile_analysis\",\n-        \"//xla/service/gpu/model:tiled_hlo_instruction_or_computation\",\n         \"//xla/service/gpu/model:triton_emitter_constraints\",\n         \"//xla/stream_executor:device_description\",\n         \"//xla/tools:hlo_decomposer_lib\","
        },
        {
            "sha": "68b9dee491d204ac2748c49f89c753595643c25b",
            "filename": "third_party/xla/xla/service/gpu/transforms/nest_gemm_fusion.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fnest_gemm_fusion.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fnest_gemm_fusion.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fnest_gemm_fusion.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -59,7 +59,6 @@ limitations under the License.\n #include \"xla/service/gpu/model/symbolic_tile.h\"\n #include \"xla/service/gpu/model/symbolic_tile_analysis.h\"\n #include \"xla/service/gpu/model/symbolic_tiled_hlo_instruction.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/model/triton_emitter_constraints.h\"\n #include \"xla/service/instruction_fusion.h\"\n #include \"xla/service/matmul_indexing_utils.h\""
        },
        {
            "sha": "915ba8421e7def177d4e345436acce33f5f19096",
            "filename": "third_party/xla/xla/service/gpu/transforms/nest_gemm_fusion.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fnest_gemm_fusion.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fnest_gemm_fusion.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fnest_gemm_fusion.h?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -24,7 +24,7 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/hlo/pass/hlo_pass_interface.h\"\n #include \"xla/service/gpu/matmul_utils.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n+#include \"xla/service/gpu/model/block_level_parameters.h\"\n #include \"xla/stream_executor/device_description.h\"\n \n namespace xla::gpu {"
        },
        {
            "sha": "a752e0cfe3d7adf2cdf11d09d2d207158a2d5f24",
            "filename": "third_party/xla/xla/service/gpu/transforms/priority_fusion.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fpriority_fusion.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fpriority_fusion.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fpriority_fusion.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -63,7 +63,6 @@ limitations under the License.\n #include \"xla/service/gpu/model/gpu_indexing_performance_model.h\"\n #include \"xla/service/gpu/model/gpu_performance_model.h\"\n #include \"xla/service/gpu/model/gpu_performance_model_base.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/model/triton_emitter_constraints.h\"\n #include \"xla/service/hlo_graph_dumper.h\"\n #include \"xla/service/instruction_fusion.h\""
        },
        {
            "sha": "62209625d0b8eee92c9a06de31c856d3f2a0ab5f",
            "filename": "third_party/xla/xla/service/gpu/transforms/softmax_rewriter_triton.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fsoftmax_rewriter_triton.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b45369f4c106ff093831a10bb42b95e67db2041e/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fsoftmax_rewriter_triton.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fsoftmax_rewriter_triton.cc?ref=b45369f4c106ff093831a10bb42b95e67db2041e",
            "patch": "@@ -51,7 +51,6 @@ limitations under the License.\n #include \"xla/service/gpu/model/gpu_performance_model.h\"\n #include \"xla/service/gpu/model/gpu_performance_model_base.h\"\n #include \"xla/service/gpu/model/symbolic_tile_analysis.h\"\n-#include \"xla/service/gpu/model/tiled_hlo_computation.h\"\n #include \"xla/service/gpu/model/triton_emitter_constraints.h\"\n #include \"xla/service/gpu/transforms/reduction_dimension_grouper.h\"\n #include \"xla/service/gpu/transforms/reduction_splitter.h\""
        }
    ],
    "stats": {
        "total": 768,
        "additions": 470,
        "deletions": 298
    }
}