{
    "author": "ezhulenev",
    "message": "[xla:ffi] Revert ABI version change\n\nAlso relax the FFI version check.\n\nPiperOrigin-RevId: 821905272",
    "sha": "5caf2a70d8112150d06033ad369137026f6ea4d9",
    "files": [
        {
            "sha": "1715a07995531ed2f810e9adca59b53eb4b81f6d",
            "filename": "third_party/xla/xla/ffi/api/c_api.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/5caf2a70d8112150d06033ad369137026f6ea4d9/third_party%2Fxla%2Fxla%2Fffi%2Fapi%2Fc_api.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/5caf2a70d8112150d06033ad369137026f6ea4d9/third_party%2Fxla%2Fxla%2Fffi%2Fapi%2Fc_api.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fffi%2Fapi%2Fc_api.h?ref=5caf2a70d8112150d06033ad369137026f6ea4d9",
            "patch": "@@ -67,7 +67,7 @@ XLA_FFI_DEFINE_STRUCT_TRAITS(XLA_FFI_Extension_Base, next);\n // * Deleting a method or argument\n // * Changing the type of an argument\n // * Rearranging fields in the XLA_FFI_Api or argument structs\n-#define XLA_FFI_API_MAJOR 1\n+#define XLA_FFI_API_MAJOR 0\n \n // Incremented when the interface is updated in a way that is potentially\n // ABI-compatible with older versions, if supported by the caller and/or\n@@ -82,7 +82,7 @@ XLA_FFI_DEFINE_STRUCT_TRAITS(XLA_FFI_Extension_Base, next);\n // Minor changes include:\n // * Adding a new field to the XLA_FFI_Api or argument structs\n // * Renaming a method or argument (doesn't affect ABI)\n-#define XLA_FFI_API_MINOR 0\n+#define XLA_FFI_API_MINOR 2\n \n struct XLA_FFI_Api_Version {\n   size_t struct_size;"
        },
        {
            "sha": "f03f15936ac63f380ec170c310f1d634ca6267e8",
            "filename": "third_party/xla/xla/ffi/ffi_api.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/5caf2a70d8112150d06033ad369137026f6ea4d9/third_party%2Fxla%2Fxla%2Fffi%2Fffi_api.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/5caf2a70d8112150d06033ad369137026f6ea4d9/third_party%2Fxla%2Fxla%2Fffi%2Fffi_api.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fffi%2Fffi_api.cc?ref=5caf2a70d8112150d06033ad369137026f6ea4d9",
            "patch": "@@ -384,8 +384,8 @@ static absl::Status RegisterHandler(absl::string_view name,\n   // Check the API versions.\n   TF_ASSIGN_OR_RETURN(XLA_FFI_Metadata metadata, GetMetadata(bundle.execute));\n   const XLA_FFI_Api_Version& api_version = metadata.api_version;\n-  if (api_version.major_version != XLA_FFI_API_MAJOR ||\n-      api_version.minor_version != XLA_FFI_API_MINOR) {\n+  if (std::make_pair(api_version.major_version, api_version.minor_version) >\n+      std::make_pair(XLA_FFI_API_MAJOR, XLA_FFI_API_MINOR)) {\n     return InvalidArgument(\n         \"FFI handler registration for %s on platform %s (canonical %s) failed \"\n         \"because the handler's API version (%d.%d) is incompatible with the \""
        }
    ],
    "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
    }
}