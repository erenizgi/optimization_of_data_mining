{
    "author": "tensorflower-gardener",
    "message": "[SymbolicMap] Add `GetSubMap`\n\nPiperOrigin-RevId: 802529019",
    "sha": "8c227de99af4ca54f0b78faad55c3b6d6689fa67",
    "files": [
        {
            "sha": "6f8cc928f0d82c66eaabd1ca3f2b08a1ec4b3ddd",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_map.cc",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8c227de99af4ca54f0b78faad55c3b6d6689fa67/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8c227de99af4ca54f0b78faad55c3b6d6689fa67/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.cc?ref=8c227de99af4ca54f0b78faad55c3b6d6689fa67",
            "patch": "@@ -15,6 +15,7 @@ limitations under the License.\n \n #include \"xla/service/gpu/model/experimental/symbolic_map.h\"\n \n+#include <cstddef>\n #include <cstdint>\n #include <iterator>\n #include <string>\n@@ -170,6 +171,17 @@ SymbolicMap SymbolicMap::Compose(const SymbolicMap& other) const {\n                                this_symbol_replacements, new_dims, new_syms);\n }\n \n+SymbolicMap SymbolicMap::GetSubMap(\n+    absl::Span<const size_t> result_indices) const {\n+  llvm::SmallVector<SymbolicExpr> sub_exprs;\n+  sub_exprs.reserve(result_indices.size());\n+  for (unsigned int index : result_indices) {\n+    CHECK_LT(index, exprs_.size()) << \"Result index out of bounds\";\n+    sub_exprs.push_back(exprs_[index]);\n+  }\n+  return SymbolicMap(ctx_, num_dimensions_, num_symbols_, std::move(sub_exprs));\n+}\n+\n SymbolicMap SymbolicMap::Replace(SymbolicExpr expr,\n                                  SymbolicExpr replacement) const {\n   llvm::SmallVector<SymbolicExpr> new_exprs;"
        },
        {
            "sha": "740cf5c14bc5a9ef0b829e685444c9ef018a8ce8",
            "filename": "third_party/xla/xla/service/gpu/model/experimental/symbolic_map.h",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8c227de99af4ca54f0b78faad55c3b6d6689fa67/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8c227de99af4ca54f0b78faad55c3b6d6689fa67/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fexperimental%2Fsymbolic_map.h?ref=8c227de99af4ca54f0b78faad55c3b6d6689fa67",
            "patch": "@@ -16,6 +16,7 @@ limitations under the License.\n #ifndef XLA_SERVICE_GPU_MODEL_EXPERIMENTAL_SYMBOLIC_MAP_H_\n #define XLA_SERVICE_GPU_MODEL_EXPERIMENTAL_SYMBOLIC_MAP_H_\n \n+#include <cstddef>\n #include <cstdint>\n #include <string>\n \n@@ -82,6 +83,9 @@ class SymbolicMap {\n   // this.compose(other): (d0, s0, s1, s2) -> (d0 * 2 + 3 * s1 + s0, d0 + s2)\n   SymbolicMap Compose(const SymbolicMap& other) const;\n \n+  // Creates a new SymbolicMap with a subset of the results of this map.\n+  SymbolicMap GetSubMap(absl::Span<const size_t> result_indices) const;\n+\n   SymbolicMap Replace(SymbolicExpr expr, SymbolicExpr replacement) const;\n \n   bool operator==(const SymbolicMap& other) const;"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 16,
        "deletions": 0
    }
}