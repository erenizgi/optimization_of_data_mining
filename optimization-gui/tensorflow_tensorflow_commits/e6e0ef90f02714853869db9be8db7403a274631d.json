{
    "author": "tensorflower-gardener",
    "message": "Don't pass `nullptr` into `CopyToArray` which annotated `nonnull`\n\n`mem_region.data()` of empty string can be `nullptr`.\n`std::memcpy` passing `nullptr` into `memcpy` is also UB.\n\nPiperOrigin-RevId: 812213207",
    "sha": "e6e0ef90f02714853869db9be8db7403a274631d",
    "files": [
        {
            "sha": "d8c3d283bc2fff979e8a6f601eee7fcf22adf059",
            "filename": "third_party/xla/xla/python/ifrt_proxy/client/array.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 3,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e6e0ef90f02714853869db9be8db7403a274631d/third_party%2Fxla%2Fxla%2Fpython%2Fifrt_proxy%2Fclient%2Farray.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e6e0ef90f02714853869db9be8db7403a274631d/third_party%2Fxla%2Fxla%2Fpython%2Fifrt_proxy%2Fclient%2Farray.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt_proxy%2Fclient%2Farray.cc?ref=e6e0ef90f02714853869db9be8db7403a274631d",
            "patch": "@@ -921,12 +921,17 @@ Future<> Array::CopyToHostBuffer(\n             promise.Set(status);\n             return;\n           }\n+          if (!mem_region.empty()) {\n #if defined(PLATFORM_GOOGLE)\n-          data->CopyToArray(const_cast<char*>(mem_region.data()));\n+            // NOLINTNEXTLINE\n+            data->CopyToArray(const_cast<char*>(mem_region.data()));\n+\n #else\n-          std::memcpy(const_cast<char*>(mem_region.data()),\n-                      data->Flatten().data(), data->size());\n+            // NOLINTNEXTLINE\n+            std::memcpy(const_cast<char*>(mem_region.data()),\n+                        data->Flatten().data(), data->size());\n #endif\n+          }\n           promise.Set();\n         });\n   };"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 8,
        "deletions": 3
    }
}