{
    "author": "tensorflower-gardener",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 811693338",
    "sha": "f947e9962bb3d5ac7a70ac43a29976b0a141ace5",
    "files": [
        {
            "sha": "04d605aaf6b377881391ac39be891973ea63109f",
            "filename": "tensorflow/core/tpu/graph_rewrite/distributed_tpu_rewrite_pass.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f947e9962bb3d5ac7a70ac43a29976b0a141ace5/tensorflow%2Fcore%2Ftpu%2Fgraph_rewrite%2Fdistributed_tpu_rewrite_pass.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f947e9962bb3d5ac7a70ac43a29976b0a141ace5/tensorflow%2Fcore%2Ftpu%2Fgraph_rewrite%2Fdistributed_tpu_rewrite_pass.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftpu%2Fgraph_rewrite%2Fdistributed_tpu_rewrite_pass.cc?ref=f947e9962bb3d5ac7a70ac43a29976b0a141ace5",
            "patch": "@@ -1160,7 +1160,7 @@ absl::StatusOr<Node*> CreateConcatNode(int dim, int num_splits, DataType dtype,\n       graph->NewName(absl::StrCat(name_prefix, \"/concat_dim\")));\n   concat_dim_def.set_op(\"Const\");\n   AddNodeAttr(\"dtype\", DT_INT32, &concat_dim_def);\n-  concat_dim_def.set_device(std::string(device));\n+  concat_dim_def.set_device(device);\n   TensorProto tensor_proto;\n   tensor_proto.set_dtype(DT_INT32);\n   tensor_proto.add_int_val(dim);\n@@ -1176,7 +1176,7 @@ absl::StatusOr<Node*> CreateConcatNode(int dim, int num_splits, DataType dtype,\n   AddNodeAttr(\"N\", num_splits, &concat_def);\n   AddNodeAttr(\"T\", dtype, &concat_def);\n   concat_def.add_input(absl::StrCat(concat_dim_node->name(), \":0\"));\n-  concat_def.set_device(std::string(device));\n+  concat_def.set_device(device);\n   for (const auto& i : inputs) {\n     concat_def.add_input(absl::StrCat(i.node->name(), \":\", i.index));\n   }\n@@ -1207,7 +1207,7 @@ absl::StatusOr<Node*> CreateSliceNode(DataType dtype,\n       graph->NewName(absl::StrCat(concat_node->name(), \"/slice_begin\")));\n   begin_def.set_op(\"Const\");\n   AddNodeAttr(\"dtype\", DT_INT32, &begin_def);\n-  begin_def.set_device(std::string(device));\n+  begin_def.set_device(device);\n   TensorProto begin_tensor_proto;\n   begin_tensor_proto.set_dtype(DT_INT32);\n   for (int i = 0; i < shape.dims(); ++i) {\n@@ -1224,7 +1224,7 @@ absl::StatusOr<Node*> CreateSliceNode(DataType dtype,\n       graph->NewName(absl::StrCat(concat_node->name(), \"/slice_size\")));\n   size_def.set_op(\"Const\");\n   AddNodeAttr(\"dtype\", DT_INT32, &size_def);\n-  size_def.set_device(std::string(device));\n+  size_def.set_device(device);\n   TensorProto sizes_tensor_proto;\n   sizes_tensor_proto.set_dtype(DT_INT32);\n   for (int i = 0; i < shape.dims(); ++i) {\n@@ -1240,7 +1240,7 @@ absl::StatusOr<Node*> CreateSliceNode(DataType dtype,\n   slice_def.set_name(\n       graph->NewName(absl::StrCat(concat_node->name(), \"/slice\")));\n   slice_def.set_op(\"Slice\");\n-  slice_def.set_device(std::string(device));\n+  slice_def.set_device(device);\n   AddNodeAttr(\"T\", dtype, &slice_def);\n   AddNodeAttr(\"Index\", DT_INT32, &slice_def);\n   slice_def.add_input(absl::StrCat(concat_node->name(), \":\", concat_out_index));\n@@ -1316,7 +1316,7 @@ absl::StatusOr<Node*> CreateXlaConcatNode(\n   xla_concat_def.set_name(graph->NewName(\n       absl::StrCat(\"sharded_output/replica_\", replica_id, \"_concat\")));\n   xla_concat_def.set_op(\"XlaConcatND\");\n-  xla_concat_def.set_device(std::string(device));\n+  xla_concat_def.set_device(device);\n   AddNodeAttr(\"T\", dtype, &xla_concat_def);\n   AddNodeAttr(\"N\", static_cast<int64_t>(orig_inputs.size()), &xla_concat_def);\n   const std::vector<int64_t> num_concats("
        },
        {
            "sha": "2b015a383ff2ab17adfe2ec73c254515aa0f7d02",
            "filename": "tensorflow/core/tpu/graph_rewrite/tpu_embedding_software_deduplication_rewrite_pass.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/f947e9962bb3d5ac7a70ac43a29976b0a141ace5/tensorflow%2Fcore%2Ftpu%2Fgraph_rewrite%2Ftpu_embedding_software_deduplication_rewrite_pass.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/f947e9962bb3d5ac7a70ac43a29976b0a141ace5/tensorflow%2Fcore%2Ftpu%2Fgraph_rewrite%2Ftpu_embedding_software_deduplication_rewrite_pass.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftpu%2Fgraph_rewrite%2Ftpu_embedding_software_deduplication_rewrite_pass.cc?ref=f947e9962bb3d5ac7a70ac43a29976b0a141ace5",
            "patch": "@@ -180,8 +180,7 @@ absl::StatusOr<NodeDef> MakeSendGradientsNodeDef(\n     absl::Span<const NodeDefBuilder::NodeOut> data_inputs,\n     absl::Span<const std::string> control_inputs) {\n   tpu::TPUEmbeddingConfiguration tpu_embedding_config;\n-  if (!tpu_embedding_config.ParseFromString(\n-          std::string(tpu_embedding_config_str))) {\n+  if (!tpu_embedding_config.ParseFromString(tpu_embedding_config_str)) {\n     return absl::InvalidArgumentError(\n         \"Malformed config attribute in the SendTPUEmbeddingGradients node.\");\n   }"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 7,
        "deletions": 8
    }
}