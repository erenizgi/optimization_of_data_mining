{
    "author": "tensorflower-gardener",
    "message": "Integrate LLVM at llvm/llvm-project@d0a7411cb840\n\nUpdates LLVM usage to match\n[d0a7411cb840](https://github.com/llvm/llvm-project/commit/d0a7411cb840)\n\nPiperOrigin-RevId: 824767534",
    "sha": "4231383b5b3f76367e80f89542c8f549a4e8239f",
    "files": [
        {
            "sha": "93e78944a8e5041c9eee852a70a6b709624f6bf0",
            "filename": "third_party/xla/third_party/llvm/workspace.bzl",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4231383b5b3f76367e80f89542c8f549a4e8239f/third_party%2Fxla%2Fthird_party%2Fllvm%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4231383b5b3f76367e80f89542c8f549a4e8239f/third_party%2Fxla%2Fthird_party%2Fllvm%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fllvm%2Fworkspace.bzl?ref=4231383b5b3f76367e80f89542c8f549a4e8239f",
            "patch": "@@ -4,8 +4,8 @@ load(\"//third_party:repo.bzl\", \"tf_http_archive\")\n \n def repo(name):\n     \"\"\"Imports LLVM.\"\"\"\n-    LLVM_COMMIT = \"d7e40f3e71654658e249ee481e28aeae0e0410b1\"\n-    LLVM_SHA256 = \"86d7df5660d6e72bd05a486474ba3e811fcc703840ef8efe13529791565d851d\"\n+    LLVM_COMMIT = \"d0a7411cb840d253f58a627cc3957fc7b5263a3d\"\n+    LLVM_SHA256 = \"b8bc83aa8b5ead53af8425786bba4aab9fb6c901d97dc33dc89924824d943234\"\n \n     tf_http_archive(\n         name = name,"
        },
        {
            "sha": "a7424a00aaa942dd2f530674483ce196479d1cdc",
            "filename": "third_party/xla/third_party/shardy/temporary.patch",
            "status": "modified",
            "additions": 5,
            "deletions": 63,
            "changes": 68,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4231383b5b3f76367e80f89542c8f549a4e8239f/third_party%2Fxla%2Fthird_party%2Fshardy%2Ftemporary.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4231383b5b3f76367e80f89542c8f549a4e8239f/third_party%2Fxla%2Fthird_party%2Fshardy%2Ftemporary.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fshardy%2Ftemporary.patch?ref=4231383b5b3f76367e80f89542c8f549a4e8239f",
            "patch": "@@ -1,73 +1,15 @@\n-diff --git a/third_party/llvm/generated.patch b/third_party/llvm/generated.patch\n-index 6f93f59..509398d 100644\n---- a/third_party/llvm/generated.patch\n-+++ b/third_party/llvm/generated.patch\n-@@ -1,53 +1 @@\n- Auto generated patch. Do not edit or delete it, even if empty.\n--diff -ruN --strip-trailing-cr a/llvm/include/llvm/ExecutionEngine/Orc/Core.h b/llvm/include/llvm/ExecutionEngine/Orc/Core.h\n----- a/llvm/include/llvm/ExecutionEngine/Orc/Core.h\n--+++ b/llvm/include/llvm/ExecutionEngine/Orc/Core.h\n--@@ -1768,7 +1768,7 @@\n--   // FIXME: We should be able to derive FailedSymsForQuery from each query once\n--   //        we fix how the detach operation works.\n--   struct EmitQueries {\n---    JITDylib::AsynchronousSymbolQuerySet Updated;\n--+    JITDylib::AsynchronousSymbolQuerySet Completed;\n--     JITDylib::AsynchronousSymbolQuerySet Failed;\n--     DenseMap<AsynchronousSymbolQuery *, std::shared_ptr<SymbolDependenceMap>>\n--         FailedSymsForQuery;\n--diff -ruN --strip-trailing-cr a/llvm/lib/ExecutionEngine/Orc/Core.cpp b/llvm/lib/ExecutionEngine/Orc/Core.cpp\n----- a/llvm/lib/ExecutionEngine/Orc/Core.cpp\n--+++ b/llvm/lib/ExecutionEngine/Orc/Core.cpp\n--@@ -2901,13 +2901,23 @@\n-- \n--   for (auto &SN : ER.Ready)\n--     IL_collectQueries(\n---        EQ.Updated, SN->defs(),\n--+        EQ.Completed, SN->defs(),\n--         [](JITDylib::SymbolTableEntry &E) { E.setState(SymbolState::Ready); },\n--         [](AsynchronousSymbolQuery &Q, JITDylib &JD,\n--            NonOwningSymbolStringPtr Name, JITDylib::SymbolTableEntry &E) {\n--           Q.notifySymbolMetRequiredState(SymbolStringPtr(Name), E.getSymbol());\n--         });\n-- \n--+  // std::erase_if is not available in C++17, and llvm::erase_if does not work\n--+  // here.\n--+  for (auto it = EQ.Completed.begin(), end = EQ.Completed.end(); it != end;) {\n--+    if ((*it)->isComplete()) {\n--+      ++it;\n--+    } else {\n--+      it = EQ.Completed.erase(it);\n--+    }\n--+  }\n--+\n-- #ifdef EXPENSIVE_CHECKS\n--   verifySessionState(\"exiting ExecutionSession::IL_emit\");\n-- #endif\n--@@ -3043,9 +3053,8 @@\n--     }\n--   }\n-- \n---  for (auto &UQ : EmitQueries->Updated)\n---    if (UQ->isComplete())\n---      UQ->handleComplete(*this);\n--+  for (auto &UQ : EmitQueries->Completed)\n--+    UQ->handleComplete(*this);\n-- \n--   // If there are any bad dependencies then return an error.\n--   if (!BadDeps.empty()) {\n diff --git a/third_party/llvm/workspace.bzl b/third_party/llvm/workspace.bzl\n-index 335486c..429d012 100644\n+index 429d012..93e7894 100644\n --- a/third_party/llvm/workspace.bzl\n +++ b/third_party/llvm/workspace.bzl\n @@ -4,8 +4,8 @@ load(\"//third_party:repo.bzl\", \"tf_http_archive\")\n  \n  def repo(name):\n      \"\"\"Imports LLVM.\"\"\"\n--    LLVM_COMMIT = \"621ed04e28787ade92b98e296332ac71d1b81678\"\n--    LLVM_SHA256 = \"60729061c07f0e834acb1a18607d2552dc08596e651125a7aea9c37a4b390058\"\n-+    LLVM_COMMIT = \"d7e40f3e71654658e249ee481e28aeae0e0410b1\"\n-+    LLVM_SHA256 = \"86d7df5660d6e72bd05a486474ba3e811fcc703840ef8efe13529791565d851d\"\n+-    LLVM_COMMIT = \"d7e40f3e71654658e249ee481e28aeae0e0410b1\"\n+-    LLVM_SHA256 = \"86d7df5660d6e72bd05a486474ba3e811fcc703840ef8efe13529791565d851d\"\n++    LLVM_COMMIT = \"d0a7411cb840d253f58a627cc3957fc7b5263a3d\"\n++    LLVM_SHA256 = \"b8bc83aa8b5ead53af8425786bba4aab9fb6c901d97dc33dc89924824d943234\"\n  \n      tf_http_archive(\n          name = name,"
        },
        {
            "sha": "49900e67b631db509d0db9ed6ba394974d291b23",
            "filename": "third_party/xla/third_party/shardy/workspace.bzl",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/4231383b5b3f76367e80f89542c8f549a4e8239f/third_party%2Fxla%2Fthird_party%2Fshardy%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/4231383b5b3f76367e80f89542c8f549a4e8239f/third_party%2Fxla%2Fthird_party%2Fshardy%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fshardy%2Fworkspace.bzl?ref=4231383b5b3f76367e80f89542c8f549a4e8239f",
            "patch": "@@ -3,8 +3,8 @@\n load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n \n def repo():\n-    SHARDY_COMMIT = \"c2e02e3479c33dcc6bb5222683444948144beef9\"\n-    SHARDY_SHA256 = \"896a99739603991b2ef451c466b10a4517574761bb8130b90b4ef8f8280e9caa\"\n+    SHARDY_COMMIT = \"95ed418a446ad28756c47f6b0c936af2c18803f0\"\n+    SHARDY_SHA256 = \"a322773c08f9aab5246240b51aa6f89110bf338c8a760124e9e2a8d3f31bda80\"\n \n     tf_http_archive(\n         name = \"shardy\","
        }
    ],
    "stats": {
        "total": 76,
        "additions": 9,
        "deletions": 67
    }
}