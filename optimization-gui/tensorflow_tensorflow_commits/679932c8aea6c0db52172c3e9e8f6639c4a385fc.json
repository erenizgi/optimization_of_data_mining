{
    "author": "tensorflower-gardener",
    "message": "Add missing includes and TODO\n\nPiperOrigin-RevId: 806441533",
    "sha": "679932c8aea6c0db52172c3e9e8f6639c4a385fc",
    "files": [
        {
            "sha": "db77b55e0243a93122a7fb4abad8a450733e4f84",
            "filename": "third_party/xla/xla/service/gpu/model/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/679932c8aea6c0db52172c3e9e8f6639c4a385fc/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/679932c8aea6c0db52172c3e9e8f6639c4a385fc/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2FBUILD?ref=679932c8aea6c0db52172c3e9e8f6639c4a385fc",
            "patch": "@@ -1029,6 +1029,7 @@ cc_library(\n         \"@local_tsl//tsl/platform:statusor\",\n     ] + if_cuda([\n         # keep sorted\n+        \"//xla/backends/profiler/gpu:cupti_buffer_events\",\n         \"//xla/backends/profiler/gpu:cupti_collector\",\n         \"//xla/backends/profiler/gpu:cupti_tracer\",\n     ]),\n@@ -1063,11 +1064,9 @@ xla_test(\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/strings:str_format\",\n-        \"@local_tsl//tsl/platform:env\",\n         \"@local_tsl//tsl/platform:path\",\n         \"@local_tsl//tsl/platform:platform_port\",\n         \"@local_tsl//tsl/platform:protobuf\",\n-        \"@local_tsl//tsl/platform:status\",\n     ],\n )\n "
        },
        {
            "sha": "404bd9eddb96f6d36b472e498043d23d9db0d9e4",
            "filename": "third_party/xla/xla/service/gpu/model/hlo_op_profiler.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/679932c8aea6c0db52172c3e9e8f6639c4a385fc/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/679932c8aea6c0db52172c3e9e8f6639c4a385fc/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiler.cc?ref=679932c8aea6c0db52172c3e9e8f6639c4a385fc",
            "patch": "@@ -35,7 +35,6 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_opcode.h\"\n #include \"xla/literal.h\"\n #include \"xla/primitive_util.h\"\n-#include \"xla/service/executable.h\"\n #include \"xla/service/gpu/model/hlo_op_profile.pb.h\"\n #include \"xla/service/hlo_module_config.h\"\n #include \"xla/service/hlo_runner.h\"\n@@ -51,6 +50,9 @@ limitations under the License.\n #include \"xla/xla_data.pb.h\"\n \n #ifdef GOOGLE_CUDA\n+#include <algorithm>  // IWYU pragma: keep\n+\n+#include \"xla/backends/profiler/gpu/cupti_buffer_events.h\"\n #include \"xla/backends/profiler/gpu/cupti_collector.h\"\n #include \"xla/backends/profiler/gpu/cupti_tracer.h\"\n #endif\n@@ -169,6 +171,7 @@ static const std::unordered_set<HloOpcode> UnsupportedOps = {\n     // used for profiling. They are not created by HloInstruction::CreateUnary\n     // or HloInstruction::CreateBinary functions.\n \n+    // TODO(444503555): Add support for these Opcodes by using custom APIs.\n     // Unary\n     // go/keep-sorted start\n     HloOpcode::kBitcastConvert,\n@@ -250,7 +253,7 @@ class CuptiKernelTracer : public HloOpProfiler::KernelTracer,\n       return 0;\n     }\n     std::sort(kernel_times_ns_.begin(), kernel_times_ns_.end());\n-    size_t i = kernel_times_ns_.size() / 2;\n+    auto i = kernel_times_ns_.size() / 2;\n     // Return median value if number of values is odd.\n     if (kernel_times_ns_.size() % 2 != 0) {\n       return kernel_times_ns_[i];"
        },
        {
            "sha": "5d31e4547fca579ec144e4ed7aa7994d91e81975",
            "filename": "third_party/xla/xla/service/gpu/model/hlo_op_profiler_run.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/679932c8aea6c0db52172c3e9e8f6639c4a385fc/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiler_run.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/679932c8aea6c0db52172c3e9e8f6639c4a385fc/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiler_run.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiler_run.cc?ref=679932c8aea6c0db52172c3e9e8f6639c4a385fc",
            "patch": "@@ -30,11 +30,9 @@ limitations under the License.\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/tsl/util/command_line_flags.h\"\n #include \"xla/xla_data.pb.h\"\n-#include \"tsl/platform/env.h\"\n #include \"tsl/platform/init_main.h\"\n #include \"tsl/platform/path.h\"\n #include \"tsl/platform/protobuf.h\"\n-#include \"tsl/platform/status.h\"\n \n namespace xla {\n namespace gpu {"
        },
        {
            "sha": "511fed82169b144beaeb7dccca1342b3ab24c155",
            "filename": "third_party/xla/xla/service/gpu/model/hlo_op_profiles.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/679932c8aea6c0db52172c3e9e8f6639c4a385fc/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiles.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/679932c8aea6c0db52172c3e9e8f6639c4a385fc/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiles.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fmodel%2Fhlo_op_profiles.cc?ref=679932c8aea6c0db52172c3e9e8f6639c4a385fc",
            "patch": "@@ -27,6 +27,7 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_opcode.h\"\n #include \"xla/service/gpu/model/hlo_op_profile.pb.h\"\n #include \"xla/service/gpu/model/hlo_op_profiles_data.h\"\n+#include \"xla/stream_executor/cuda/cuda_compute_capability.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"tsl/platform/protobuf.h\"\n "
        }
    ],
    "stats": {
        "total": 13,
        "additions": 7,
        "deletions": 6
    }
}