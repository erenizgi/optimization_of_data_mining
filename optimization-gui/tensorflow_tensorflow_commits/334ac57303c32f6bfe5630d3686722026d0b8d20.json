{
    "author": "Ma-gi-cian",
    "message": "fixed tf.math.argmax, axis int16",
    "sha": "334ac57303c32f6bfe5630d3686722026d0b8d20",
    "files": [
        {
            "sha": "c6fe633accc442b1172040fd4f2047a0dbb93874",
            "filename": "tensorflow/python/ops/math_ops.py",
            "status": "modified",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/334ac57303c32f6bfe5630d3686722026d0b8d20/tensorflow%2Fpython%2Fops%2Fmath_ops.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/334ac57303c32f6bfe5630d3686722026d0b8d20/tensorflow%2Fpython%2Fops%2Fmath_ops.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fops%2Fmath_ops.py?ref=334ac57303c32f6bfe5630d3686722026d0b8d20",
            "patch": "@@ -298,6 +298,23 @@ def argmax_v2(input, axis=None, output_type=dtypes.int64, name=None):\n   \"\"\"\n   if axis is None:\n     axis = 0\n+\n+  if isinstance(axis , int):\n+    pass\n+  elif hasattr(axis, \"dtype\"):\n+    if axis.dtype in (dtypes.int32, dtypes.int64):\n+      pass\n+    elif axis.dtype in (dtypes.int8, dtypes.int16, dtypes.uint8, dtypes.uint16):\n+      axis = cast(axis, dtypes.int32)\n+    else:\n+      raise TypeError(\n+        f\"axis tensor dtypes {axis.dtype} is not supported\"\n+        )\n+  else:\n+    raise TypeError(\n+      f\"axis must be int or Tensor with integer datatype\"\n+    )\n+\n   return gen_math_ops.arg_max(input, axis, name=name, output_type=output_type)\n \n "
        },
        {
            "sha": "621df1876d202fa645b92fa861c2ecc8e0444dd7",
            "filename": "tensorflow/python/ops/math_ops_test.py",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/334ac57303c32f6bfe5630d3686722026d0b8d20/tensorflow%2Fpython%2Fops%2Fmath_ops_test.py",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/334ac57303c32f6bfe5630d3686722026d0b8d20/tensorflow%2Fpython%2Fops%2Fmath_ops_test.py",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fops%2Fmath_ops_test.py?ref=334ac57303c32f6bfe5630d3686722026d0b8d20",
            "patch": "@@ -1427,6 +1427,22 @@ def testArgMaxUint16(self):\n             tf_values, axis=axis, output_type=dtypes.uint16)\n         self.assertAllEqual(tf_max, np_max)\n \n+  def testArgMaxInt16(self):\n+    shape = (24, 8)\n+    tf_values = self._generateRandomTensor(dtypes.int16, shape)\n+    np_values = self.evaluate(tf_values)\n+    for axis in range(0, len(shape)):\n+      np_max = np.argmax(np_values, axis=axis)\n+      tf_max = math_ops.argmax(\n+        tf_values,\n+        axis=constant_op.constant(\n+          axis, dtype=dtypes.int16\n+          ),\n+        output_type=dtypes.int32\n+      )\n+      print(\"Tf Max is :\", tf_max , \"and np_max is :\", np_max)\n+      self.assertAllEqual(tf_max, np_max)\n+\n   def testArgMin(self):\n     shape = (24, 8)\n     for dtype in self._getValidDtypes():"
        }
    ],
    "stats": {
        "total": 33,
        "additions": 33,
        "deletions": 0
    }
}