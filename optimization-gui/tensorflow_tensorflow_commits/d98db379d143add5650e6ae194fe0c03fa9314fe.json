{
    "author": "tensorflower-gardener",
    "message": "Move \"cell_reader_test.cc\" to xla/tsl/lib/monitoring.\n\nPiperOrigin-RevId: 823067036",
    "sha": "d98db379d143add5650e6ae194fe0c03fa9314fe",
    "files": [
        {
            "sha": "dd8da3665c5294db398241ce81743162e0726937",
            "filename": "tensorflow/core/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 7,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d98db379d143add5650e6ae194fe0c03fa9314fe/tensorflow%2Fcore%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d98db379d143add5650e6ae194fe0c03fa9314fe/tensorflow%2Fcore%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2FBUILD?ref=d98db379d143add5650e6ae194fe0c03fa9314fe",
            "patch": "@@ -1936,21 +1936,15 @@ tf_cc_tests(\n )\n \n tf_cc_tests(\n-    name = \"cell_reader_test\",\n+    name = \"test_utils_test\",\n     size = \"small\",\n     srcs = [\n-        \"//tensorflow/core/lib/monitoring:cell_reader_test.cc\",\n         \"//tensorflow/core/lib/monitoring:test_utils_test.cc\",\n     ],\n     deps = [\n         \":protos_all_cc\",\n         \":test\",\n         \":test_main\",\n-        \"//tensorflow/core/lib/monitoring:cell_reader\",\n-        \"//tensorflow/core/lib/monitoring:counter\",\n-        \"//tensorflow/core/lib/monitoring:gauge\",\n-        \"//tensorflow/core/lib/monitoring:percentile_sampler\",\n-        \"//tensorflow/core/lib/monitoring:sampler\",\n         \"//tensorflow/core/lib/monitoring:test_utils\",\n         \"//tensorflow/core/lib/monitoring:types\",\n         \"//tensorflow/core/platform:errors\","
        },
        {
            "sha": "fae5828c6b4daa6b7719de652b5d2cb5e0b605ed",
            "filename": "tensorflow/core/lib/monitoring/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d98db379d143add5650e6ae194fe0c03fa9314fe/tensorflow%2Fcore%2Flib%2Fmonitoring%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d98db379d143add5650e6ae194fe0c03fa9314fe/tensorflow%2Fcore%2Flib%2Fmonitoring%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Flib%2Fmonitoring%2FBUILD?ref=d98db379d143add5650e6ae194fe0c03fa9314fe",
            "patch": "@@ -263,7 +263,6 @@ filegroup(\n # \"/tensorflow/test/sampler_without_labels\").\n exports_files(\n     [\n-        \"cell_reader_test.cc\",\n         \"collection_registry_test.cc\",\n         \"counter_test.cc\",\n         \"gauge_test.cc\","
        },
        {
            "sha": "751c862078ca811c62e10eee92e03cbb7c67a9ca",
            "filename": "third_party/xla/xla/tsl/lib/monitoring/BUILD",
            "status": "modified",
            "additions": 20,
            "deletions": 0,
            "changes": 20,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d98db379d143add5650e6ae194fe0c03fa9314fe/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fmonitoring%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d98db379d143add5650e6ae194fe0c03fa9314fe/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fmonitoring%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fmonitoring%2FBUILD?ref=d98db379d143add5650e6ae194fe0c03fa9314fe",
            "patch": "@@ -1,5 +1,9 @@\n load(\"//xla/tsl:tsl.bzl\", \"internal_visibility\")\n load(\"//xla/tsl:tsl.default.bzl\", \"filegroup\")\n+load(\n+    \"//xla/tsl/platform:build_config.bzl\",\n+    \"tsl_cc_test\",\n+)\n load(\n     \"//xla/tsl/platform:rules_cc.bzl\",\n     \"cc_library\",\n@@ -180,6 +184,22 @@ cc_library(\n     ],\n )\n \n+tsl_cc_test(\n+    name = \"cell_reader_test\",\n+    size = \"small\",\n+    srcs = [\"cell_reader_test.cc\"],\n+    deps = [\n+        \":cell_reader\",\n+        \":counter\",\n+        \":gauge\",\n+        \":percentile_sampler\",\n+        \":sampler\",\n+        \":test_utils\",\n+        \":types\",\n+        \"@com_google_googletest//:gtest_main\",\n+    ],\n+)\n+\n cc_library(\n     name = \"percentile_sampler\",\n     srcs = [\"percentile_sampler.cc\"],"
        },
        {
            "sha": "695fbcb42eecee565aee3e0f7fde43bb8a58aefc",
            "filename": "third_party/xla/xla/tsl/lib/monitoring/cell_reader_test.cc",
            "status": "renamed",
            "additions": 95,
            "deletions": 100,
            "changes": 195,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/d98db379d143add5650e6ae194fe0c03fa9314fe/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fmonitoring%2Fcell_reader_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/d98db379d143add5650e6ae194fe0c03fa9314fe/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fmonitoring%2Fcell_reader_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fmonitoring%2Fcell_reader_test.cc?ref=d98db379d143add5650e6ae194fe0c03fa9314fe",
            "patch": "@@ -12,21 +12,22 @@ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n-#include \"tensorflow/core/lib/monitoring/cell_reader.h\"\n+\n+#include \"xla/tsl/lib/monitoring/cell_reader.h\"\n \n #include <cstdint>\n #include <string>\n #include <vector>\n \n-#include \"tensorflow/core/lib/monitoring/counter.h\"\n-#include \"tensorflow/core/lib/monitoring/gauge.h\"\n-#include \"tensorflow/core/lib/monitoring/percentile_sampler.h\"\n-#include \"tensorflow/core/lib/monitoring/sampler.h\"\n-#include \"tensorflow/core/lib/monitoring/test_utils.h\"\n-#include \"tensorflow/core/lib/monitoring/types.h\"\n-#include \"tensorflow/core/platform/test.h\"\n+#include <gtest/gtest.h>\n+#include \"xla/tsl/lib/monitoring/counter.h\"\n+#include \"xla/tsl/lib/monitoring/gauge.h\"\n+#include \"xla/tsl/lib/monitoring/percentile_sampler.h\"\n+#include \"xla/tsl/lib/monitoring/sampler.h\"\n+#include \"xla/tsl/lib/monitoring/test_utils.h\"\n+#include \"xla/tsl/lib/monitoring/types.h\"\n \n-namespace tensorflow {\n+namespace tsl {\n namespace monitoring {\n namespace testing {\n namespace {\n@@ -35,64 +36,65 @@ std::vector<double> GetDefaultPercentiles() {\n   return {25.0, 50.0, 80.0, 90.0, 95.0, 99.0};\n }\n \n-auto* test_counter = monitoring::Counter<0>::New(\n-    \"/tensorflow/monitoring/test/counter\", \"Test counter.\");\n+auto* test_counter = tsl::monitoring::Counter<0>::New(\n+    \"/tsl/monitoring/test/counter\", \"Test counter.\");\n \n-auto* test_counter_with_labels = monitoring::Counter<2>::New(\n-    \"/tensorflow/monitoring/test/counter_with_labels\",\n-    \"Test counter with two labels.\", \"label1\", \"label2\");\n+auto* test_counter_with_labels = tsl::monitoring::Counter<2>::New(\n+    \"/tsl/monitoring/test/counter_with_labels\", \"Test counter with two labels.\",\n+    \"label1\", \"label2\");\n \n-auto* test_sampler = monitoring::Sampler<0>::New(\n-    {\"/tensorflow/monitoring/test/sampler\", \"Test sampler.\"},\n-    /*buckets=*/monitoring::Buckets::Explicit(\n+auto* test_sampler = tsl::monitoring::Sampler<0>::New(\n+    {\"/tsl/monitoring/test/sampler\", \"Test sampler.\"},\n+    /*buckets=*/tsl::monitoring::Buckets::Explicit(\n         {0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0}));\n \n-auto* test_sampler_with_labels = monitoring::Sampler<2>::New(\n-    {\"/tensorflow/monitoring/test/sampler_with_labels\", \"Test sampler.\",\n-     \"label1\", \"label2\"},\n-    /*buckets=*/monitoring::Buckets::Exponential(\n+auto* test_sampler_with_labels = tsl::monitoring::Sampler<2>::New(\n+    {\"/tsl/monitoring/test/sampler_with_labels\", \"Test sampler.\", \"label1\",\n+     \"label2\"},\n+    /*buckets=*/tsl::monitoring::Buckets::Exponential(\n         /*scale=*/1, /*growth_factor=*/10, /*bucket_count=*/5));\n \n-auto* test_int_gauge = monitoring::Gauge<int64_t, 0>::New(\n-    \"/tensorflow/monitoring/test/int_gauge\", \"Test gauge.\");\n+auto* test_int_gauge = tsl::monitoring::Gauge<int64_t, 0>::New(\n+    \"/tsl/monitoring/test/int_gauge\", \"Test gauge.\");\n \n-auto* test_int_gauge_with_labels = monitoring::Gauge<int64_t, 2>::New(\n-    \"/tensorflow/monitoring/test/int_gauge_with_labels\", \"Test gauge.\",\n-    \"label1\", \"label2\");\n+auto* test_int_gauge_with_labels = tsl::monitoring::Gauge<int64_t, 2>::New(\n+    \"/tsl/monitoring/test/int_gauge_with_labels\", \"Test gauge.\", \"label1\",\n+    \"label2\");\n \n-auto* test_string_gauge = monitoring::Gauge<std::string, 0>::New(\n-    \"/tensorflow/monitoring/test/string_gauge\", \"Test gauge.\");\n+auto* test_string_gauge = tsl::monitoring::Gauge<std::string, 0>::New(\n+    \"/tsl/monitoring/test/string_gauge\", \"Test gauge.\");\n \n-auto* test_string_gauge_with_labels = monitoring::Gauge<std::string, 2>::New(\n-    \"/tensorflow/monitoring/test/string_gauge_with_labels\", \"Test gauge.\",\n-    \"label1\", \"label2\");\n+auto* test_string_gauge_with_labels =\n+    tsl::monitoring::Gauge<std::string, 2>::New(\n+        \"/tsl/monitoring/test/string_gauge_with_labels\", \"Test gauge.\",\n+        \"label1\", \"label2\");\n \n-auto* test_bool_gauge = monitoring::Gauge<bool, 0>::New(\n-    \"/tensorflow/monitoring/test/bool_gauge\", \"Test gauge.\");\n+auto* test_bool_gauge = tsl::monitoring::Gauge<bool, 0>::New(\n+    \"/tsl/monitoring/test/bool_gauge\", \"Test gauge.\");\n \n-auto* test_bool_gauge_with_labels = monitoring::Gauge<bool, 2>::New(\n-    \"/tensorflow/monitoring/test/bool_gauge_with_labels\", \"Test gauge.\",\n-    \"label1\", \"label2\");\n+auto* test_bool_gauge_with_labels = tsl::monitoring::Gauge<bool, 2>::New(\n+    \"/tsl/monitoring/test/bool_gauge_with_labels\", \"Test gauge.\", \"label1\",\n+    \"label2\");\n \n-auto* test_percentiles = monitoring::PercentileSampler<0>::New(\n-    {\"/tensorflow/monitoring/test/percentiles\", \"Test percentiles.\"},\n+auto* test_percentiles = tsl::monitoring::PercentileSampler<0>::New(\n+    {\"/tsl/monitoring/test/percentiles\", \"Test percentiles.\"},\n     GetDefaultPercentiles(), /*max_samples=*/1024,\n-    monitoring::UnitOfMeasure::kTime);\n+    tsl::monitoring::UnitOfMeasure::kTime);\n \n-auto* test_percentiles_with_labels = monitoring::PercentileSampler<2>::New(\n-    {\"/tensorflow/monitoring/test/percentiles_with_labels\", \"Test percentiles.\",\n+auto* test_percentiles_with_labels = tsl::monitoring::PercentileSampler<2>::New(\n+    {\"/tsl/monitoring/test/percentiles_with_labels\", \"Test percentiles.\",\n      \"label1\", \"label2\"},\n     GetDefaultPercentiles(), /*max_samples=*/1024,\n-    monitoring::UnitOfMeasure::kTime);\n+    tsl::monitoring::UnitOfMeasure::kTime);\n \n void IncrementLazyCounter() {\n   static auto* test_counter = monitoring::Counter<0>::New(\n-      \"/tensorflow/monitoring/test/lazy_counter\", \"Test lazy counter.\");\n+      \"/tsl/monitoring/test/lazy_counter\", \"Test lazy counter.\");\n   test_counter->GetCell()->IncrementBy(1);\n }\n \n TEST(CellReaderTest, CounterDeltaNoLabels) {\n-  CellReader<int64_t> cell_reader(\"/tensorflow/monitoring/test/counter\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/counter\");\n   EXPECT_EQ(cell_reader.Delta(), 0);\n \n   test_counter->GetCell()->IncrementBy(5);\n@@ -106,7 +108,7 @@ TEST(CellReaderTest, CounterDeltaNoLabels) {\n }\n \n TEST(CellReaderTest, CounterReadNoLabels) {\n-  CellReader<int64_t> cell_reader(\"/tensorflow/monitoring/test/counter\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/counter\");\n   EXPECT_EQ(cell_reader.Read(), 0);\n \n   test_counter->GetCell()->IncrementBy(5);\n@@ -120,7 +122,7 @@ TEST(CellReaderTest, CounterReadNoLabels) {\n }\n \n TEST(CellReaderTest, CounterDeltaAndReadNoLabels) {\n-  CellReader<int64_t> cell_reader(\"/tensorflow/monitoring/test/counter\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/counter\");\n   EXPECT_EQ(cell_reader.Delta(), 0);\n   EXPECT_EQ(cell_reader.Read(), 0);\n \n@@ -138,8 +140,7 @@ TEST(CellReaderTest, CounterDeltaAndReadNoLabels) {\n }\n \n TEST(CellReaderTest, CounterDeltaWithLabels) {\n-  CellReader<int64_t> cell_reader(\n-      \"/tensorflow/monitoring/test/counter_with_labels\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/counter_with_labels\");\n   EXPECT_EQ(cell_reader.Delta(\"x1\", \"y1\"), 0);\n   EXPECT_EQ(cell_reader.Delta(\"x1\", \"y2\"), 0);\n   EXPECT_EQ(cell_reader.Delta(\"x2\", \"y1\"), 0);\n@@ -170,8 +171,7 @@ TEST(CellReaderTest, CounterDeltaWithLabels) {\n }\n \n TEST(CellReaderTest, CounterReadWithLabels) {\n-  CellReader<int64_t> cell_reader(\n-      \"/tensorflow/monitoring/test/counter_with_labels\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/counter_with_labels\");\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), 0);\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y2\"), 0);\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y1\"), 0);\n@@ -202,8 +202,7 @@ TEST(CellReaderTest, CounterReadWithLabels) {\n }\n \n TEST(CellReaderTest, CounterDeltaAndReadWithLabels) {\n-  CellReader<int64_t> cell_reader(\n-      \"/tensorflow/monitoring/test/counter_with_labels\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/counter_with_labels\");\n   EXPECT_EQ(cell_reader.Delta(\"x1\", \"y1\"), 0);\n   EXPECT_EQ(cell_reader.Delta(\"x1\", \"y2\"), 0);\n   EXPECT_EQ(cell_reader.Delta(\"x2\", \"y1\"), 0);\n@@ -250,9 +249,9 @@ TEST(CellReaderTest, CounterDeltaAndReadWithLabels) {\n }\n \n TEST(CellReaderTest, TwoCounterReaders) {\n-  CellReader<int64_t> cell_reader(\"/tensorflow/monitoring/test/counter\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/counter\");\n   CellReader<int64_t> cell_reader_with_labels(\n-      \"/tensorflow/monitoring/test/counter_with_labels\");\n+      \"/tsl/monitoring/test/counter_with_labels\");\n   EXPECT_EQ(cell_reader.Delta(), 0);\n   EXPECT_EQ(cell_reader_with_labels.Delta(\"x1\", \"y1\"), 0);\n   EXPECT_EQ(cell_reader_with_labels.Delta(\"x2\", \"y2\"), 0);\n@@ -290,9 +289,9 @@ TEST(CellReaderTest, TwoCounterReaders) {\n }\n \n TEST(CellReaderTest, RepeatedReads) {\n-  CellReader<int64_t> cell_reader(\"/tensorflow/monitoring/test/counter\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/counter\");\n   CellReader<int64_t> cell_reader_with_labels(\n-      \"/tensorflow/monitoring/test/counter_with_labels\");\n+      \"/tsl/monitoring/test/counter_with_labels\");\n   EXPECT_EQ(cell_reader.Delta(), 0);\n   EXPECT_EQ(cell_reader_with_labels.Delta(\"x1\", \"y1\"), 0);\n   EXPECT_EQ(cell_reader_with_labels.Delta(\"x2\", \"y2\"), 0);\n@@ -320,7 +319,7 @@ TEST(CellReaderTest, RepeatedReads) {\n }\n \n TEST(CellReaderTest, SamplerDeltaNoLabels) {\n-  CellReader<Histogram> cell_reader(\"/tensorflow/monitoring/test/sampler\");\n+  CellReader<Histogram> cell_reader(\"/tsl/monitoring/test/sampler\");\n   Histogram histogram = cell_reader.Delta();\n   EXPECT_FLOAT_EQ(histogram.num(), 0.0);\n   EXPECT_FLOAT_EQ(histogram.sum(), 0.0);\n@@ -398,7 +397,7 @@ TEST(CellReaderTest, SamplerDeltaNoLabels) {\n }\n \n TEST(CellReaderTest, SamplerReadNoLabels) {\n-  CellReader<Histogram> cell_reader(\"/tensorflow/monitoring/test/sampler\");\n+  CellReader<Histogram> cell_reader(\"/tsl/monitoring/test/sampler\");\n   Histogram histogram = cell_reader.Read();\n   EXPECT_FLOAT_EQ(histogram.num(), 0.0);\n   EXPECT_FLOAT_EQ(histogram.sum(), 0.0);\n@@ -476,7 +475,7 @@ TEST(CellReaderTest, SamplerReadNoLabels) {\n }\n \n TEST(CellReaderTest, SamplerDeltaAndReadNoLabels) {\n-  CellReader<Histogram> cell_reader(\"/tensorflow/monitoring/test/sampler\");\n+  CellReader<Histogram> cell_reader(\"/tsl/monitoring/test/sampler\");\n   Histogram histogram = cell_reader.Delta();\n   EXPECT_FLOAT_EQ(histogram.num(), 0.0);\n   EXPECT_FLOAT_EQ(histogram.sum(), 0.0);\n@@ -591,8 +590,7 @@ TEST(CellReaderTest, SamplerDeltaAndReadNoLabels) {\n }\n \n TEST(CellReaderTest, SamplerDeltaWithLabels) {\n-  CellReader<Histogram> cell_reader(\n-      \"/tensorflow/monitoring/test/sampler_with_labels\");\n+  CellReader<Histogram> cell_reader(\"/tsl/monitoring/test/sampler_with_labels\");\n   Histogram histogram = cell_reader.Delta(\"x1\", \"y1\");\n   EXPECT_FLOAT_EQ(histogram.num(), 0.0);\n   EXPECT_FLOAT_EQ(histogram.sum(), 0.0);\n@@ -683,8 +681,7 @@ TEST(CellReaderTest, SamplerDeltaWithLabels) {\n }\n \n TEST(CellReaderTest, SamplerReadWithLabels) {\n-  CellReader<Histogram> cell_reader(\n-      \"/tensorflow/monitoring/test/sampler_with_labels\");\n+  CellReader<Histogram> cell_reader(\"/tsl/monitoring/test/sampler_with_labels\");\n   Histogram histogram = cell_reader.Read(\"x1\", \"y1\");\n   EXPECT_FLOAT_EQ(histogram.num(), 0.0);\n   EXPECT_FLOAT_EQ(histogram.sum(), 0.0);\n@@ -775,8 +772,7 @@ TEST(CellReaderTest, SamplerReadWithLabels) {\n }\n \n TEST(CellReaderTest, SamplerRepeatedReads) {\n-  CellReader<Histogram> cell_reader(\n-      \"/tensorflow/monitoring/test/sampler_with_labels\");\n+  CellReader<Histogram> cell_reader(\"/tsl/monitoring/test/sampler_with_labels\");\n   Histogram histogram = cell_reader.Read(\"x1\", \"y1\");\n   EXPECT_FLOAT_EQ(histogram.num(), 0.0);\n   EXPECT_FLOAT_EQ(histogram.sum(), 0.0);\n@@ -884,7 +880,7 @@ TEST(CellReaderTest, SamplerRepeatedReads) {\n }\n \n TEST(CellReaderTest, IntGaugeRead) {\n-  CellReader<int64_t> cell_reader(\"/tensorflow/monitoring/test/int_gauge\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/int_gauge\");\n   EXPECT_EQ(cell_reader.Read(), 0);\n \n   test_int_gauge->GetCell()->Set(100);\n@@ -898,8 +894,7 @@ TEST(CellReaderTest, IntGaugeRead) {\n }\n \n TEST(CellReaderTest, IntGaugeReadWithLabels) {\n-  CellReader<int64_t> cell_reader(\n-      \"/tensorflow/monitoring/test/int_gauge_with_labels\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/int_gauge_with_labels\");\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), 0);\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), 0);\n \n@@ -919,11 +914,12 @@ TEST(CellReaderTest, IntGaugeReadWithLabels) {\n   test_int_gauge_with_labels->GetCell(\"x1\", \"y1\")->Set(0);\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), 0);\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), 100000);\n+  test_int_gauge_with_labels->GetCell(\"x2\", \"y2\")->Set(0);\n+  EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), 0);\n }\n \n TEST(CellReaderTest, IntGaugeRepeatedSetAndRead) {\n-  CellReader<int64_t> cell_reader(\n-      \"/tensorflow/monitoring/test/int_gauge_with_labels\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/int_gauge_with_labels\");\n \n   test_int_gauge_with_labels->GetCell(\"x1\", \"y1\")->Set(-1);\n   test_int_gauge_with_labels->GetCell(\"x2\", \"y2\")->Set(1);\n@@ -946,11 +942,12 @@ TEST(CellReaderTest, IntGaugeRepeatedSetAndRead) {\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), -500);\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), 0);\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), -500);\n+  test_int_gauge_with_labels->GetCell(\"x2\", \"y2\")->Set(0);\n+  EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), 0);\n }\n \n TEST(CellReaderTest, StringGaugeRead) {\n-  CellReader<std::string> cell_reader(\n-      \"/tensorflow/monitoring/test/string_gauge\");\n+  CellReader<std::string> cell_reader(\"/tsl/monitoring/test/string_gauge\");\n   EXPECT_EQ(cell_reader.Read(), \"\");\n \n   test_string_gauge->GetCell()->Set(\"gauge value\");\n@@ -965,7 +962,7 @@ TEST(CellReaderTest, StringGaugeRead) {\n \n TEST(CellReaderTest, StringGaugeReadWithLabels) {\n   CellReader<std::string> cell_reader(\n-      \"/tensorflow/monitoring/test/string_gauge_with_labels\");\n+      \"/tsl/monitoring/test/string_gauge_with_labels\");\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), \"\");\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), \"\");\n \n@@ -990,7 +987,7 @@ TEST(CellReaderTest, StringGaugeReadWithLabels) {\n \n TEST(CellReaderTest, StringGaugeRepeatedSetAndRead) {\n   CellReader<std::string> cell_reader(\n-      \"/tensorflow/monitoring/test/string_gauge_with_labels\");\n+      \"/tsl/monitoring/test/string_gauge_with_labels\");\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), \"\");\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), \"\");\n \n@@ -1015,10 +1012,14 @@ TEST(CellReaderTest, StringGaugeRepeatedSetAndRead) {\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), \"-10\");\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), \"-10\");\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), \"-10\");\n+  test_string_gauge_with_labels->GetCell(\"x1\", \"y1\")->Set(\"\");\n+  test_string_gauge_with_labels->GetCell(\"x2\", \"y2\")->Set(\"\");\n+  EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), \"\");\n+  EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), \"\");\n }\n \n TEST(CellReaderTest, BoolGaugeRead) {\n-  CellReader<bool> cell_reader(\"/tensorflow/monitoring/test/bool_gauge\");\n+  CellReader<bool> cell_reader(\"/tsl/monitoring/test/bool_gauge\");\n   EXPECT_EQ(cell_reader.Read(), false);\n \n   test_bool_gauge->GetCell()->Set(true);\n@@ -1029,8 +1030,7 @@ TEST(CellReaderTest, BoolGaugeRead) {\n }\n \n TEST(CellReaderTest, BoolGaugeReadWithLabels) {\n-  CellReader<bool> cell_reader(\n-      \"/tensorflow/monitoring/test/bool_gauge_with_labels\");\n+  CellReader<bool> cell_reader(\"/tsl/monitoring/test/bool_gauge_with_labels\");\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), false);\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), false);\n \n@@ -1054,8 +1054,7 @@ TEST(CellReaderTest, BoolGaugeReadWithLabels) {\n }\n \n TEST(CellReaderTest, BoolGaugeRepeatedSetAndRead) {\n-  CellReader<bool> cell_reader(\n-      \"/tensorflow/monitoring/test/bool_gauge_with_labels\");\n+  CellReader<bool> cell_reader(\"/tsl/monitoring/test/bool_gauge_with_labels\");\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), false);\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), false);\n \n@@ -1080,11 +1079,12 @@ TEST(CellReaderTest, BoolGaugeRepeatedSetAndRead) {\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), true);\n   EXPECT_EQ(cell_reader.Read(\"x1\", \"y1\"), false);\n   EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), true);\n+  test_bool_gauge_with_labels->GetCell(\"x2\", \"y2\")->Set(false);\n+  EXPECT_EQ(cell_reader.Read(\"x2\", \"y2\"), false);\n }\n \n TEST(CellReaderTest, PercentilesDeltaNoLabels) {\n-  CellReader<Percentiles> cell_reader(\n-      \"/tensorflow/monitoring/test/percentiles\");\n+  CellReader<Percentiles> cell_reader(\"/tsl/monitoring/test/percentiles\");\n   Percentiles percentiles = cell_reader.Delta();\n   EXPECT_EQ(percentiles.num(), 0);\n   EXPECT_FLOAT_EQ(percentiles.sum(), 0.0);\n@@ -1106,8 +1106,7 @@ TEST(CellReaderTest, PercentilesDeltaNoLabels) {\n }\n \n TEST(CellReaderTest, PercentilesReadNoLabels) {\n-  CellReader<Percentiles> cell_reader(\n-      \"/tensorflow/monitoring/test/percentiles\");\n+  CellReader<Percentiles> cell_reader(\"/tsl/monitoring/test/percentiles\");\n   Percentiles percentiles = cell_reader.Read();\n   EXPECT_EQ(percentiles.num(), 0);\n   EXPECT_FLOAT_EQ(percentiles.sum(), 0.0);\n@@ -1130,7 +1129,7 @@ TEST(CellReaderTest, PercentilesReadNoLabels) {\n \n TEST(CellReaderTest, PercentilesWithLabels) {\n   CellReader<Percentiles> cell_reader(\n-      \"/tensorflow/monitoring/test/percentiles_with_labels\");\n+      \"/tsl/monitoring/test/percentiles_with_labels\");\n   Percentiles percentiles = cell_reader.Delta(\"x1\", \"y1\");\n   EXPECT_EQ(percentiles.num(), 0);\n   EXPECT_FLOAT_EQ(percentiles.sum(), 0.0);\n@@ -1190,7 +1189,7 @@ TEST(CellReaderTest, PercentilesWithLabels) {\n \n TEST(CellReaderTest, PercentilesRepeatedSetAndRead) {\n   CellReader<Percentiles> cell_reader(\n-      \"/tensorflow/monitoring/test/percentiles_with_labels\");\n+      \"/tsl/monitoring/test/percentiles_with_labels\");\n   Percentiles percentiles = cell_reader.Delta(\"x1\", \"y1\");\n   EXPECT_EQ(percentiles.num(), 0);\n   EXPECT_FLOAT_EQ(percentiles.sum(), 0.0);\n@@ -1238,16 +1237,15 @@ TEST(CellReaderTest, PercentilesRepeatedSetAndRead) {\n   EXPECT_FLOAT_EQ(percentiles.sum(), -111.0);\n }\n \n-#if GTEST_HAS_DEATH_TEST\n TEST(CellReaderTest, WrongNumberOfLabels) {\n-  CellReader<int64_t> cell_reader(\"/tensorflow/monitoring/test/counter\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/counter\");\n   EXPECT_EQ(cell_reader.Read(), 0);\n   EXPECT_DEATH(cell_reader.Read(\"label1\"), \"has 0 labels\");\n   EXPECT_DEATH(cell_reader.Read(\"label1\", \"label2\"), \"has 0 labels\");\n   EXPECT_DEATH(cell_reader.Read(\"label1\", \"label2\", \"label3\"), \"has 0 labels\");\n \n   CellReader<int64_t> cell_reader_with_labels(\n-      \"/tensorflow/monitoring/test/counter_with_labels\");\n+      \"/tsl/monitoring/test/counter_with_labels\");\n   EXPECT_DEATH(cell_reader_with_labels.Read(), \"has 2 labels\");\n   EXPECT_DEATH(cell_reader_with_labels.Read(\"label1\"), \"has 2 labels\");\n   EXPECT_EQ(cell_reader_with_labels.Read(\"label1\", \"label2\"), 0);\n@@ -1263,29 +1261,27 @@ TEST(CellReaderTest, MetricIsNotFoundRead) {\n }\n \n TEST(CellReaderTest, StringGaugeDelta) {\n-  CellReader<std::string> cell_reader(\n-      \"/tensorflow/monitoring/test/string_gauge\");\n+  CellReader<std::string> cell_reader(\"/tsl/monitoring/test/string_gauge\");\n   CellReader<std::string> cell_reader_with_labels(\n-      \"/tensorflow/monitoring/test/string_gauge_with_labels\");\n+      \"/tsl/monitoring/test/string_gauge_with_labels\");\n   EXPECT_DEATH(cell_reader.Delta(), \"Please use `Read` instead.\");\n   EXPECT_DEATH(cell_reader_with_labels.Delta(\"x\", \"y\"),\n                \"Please use `Read` instead.\");\n }\n \n TEST(CellReaderTest, BoolGaugeDelta) {\n-  CellReader<bool> cell_reader(\"/tensorflow/monitoring/test/bool_gauge\");\n+  CellReader<bool> cell_reader(\"/tsl/monitoring/test/bool_gauge\");\n   CellReader<bool> cell_reader_with_labels(\n-      \"/tensorflow/monitoring/test/bool_gauge_with_labels\");\n+      \"/tsl/monitoring/test/bool_gauge_with_labels\");\n   EXPECT_DEATH(cell_reader.Delta(), \"Please use `Read` instead.\");\n   EXPECT_DEATH(cell_reader_with_labels.Delta(\"x\", \"y\"),\n                \"Please use `Read` instead.\");\n }\n \n TEST(CellReaderTest, InvalidType) {\n-  CellReader<std::vector<int>> cell_reader(\n-      \"/tensorflow/monitoring/test/counter\");\n+  CellReader<std::vector<int>> cell_reader(\"/tsl/monitoring/test/counter\");\n   CellReader<std::vector<int>> cell_reader_with_labels(\n-      \"/tensorflow/monitoring/test/counter_with_labels\");\n+      \"/tsl/monitoring/test/counter_with_labels\");\n   EXPECT_DEATH(cell_reader.Read(),\n                \"Tensorflow CellReader does not support type\");\n   EXPECT_DEATH(cell_reader_with_labels.Delta(\"x\", \"y\"),\n@@ -1298,7 +1294,6 @@ TEST(CellReaderTest, InvalidType) {\n   EXPECT_DEATH(cell_reader_with_labels.Delta(\"x\", \"y\"),\n                \"Tensorflow CellReader does not support type\");\n }\n-#endif\n \n TEST(CellReaderTest, MetricIsNotFoundDelta) {\n   CellReader<int64_t> cell_reader(\"/metric/does/not/exist\");\n@@ -1308,17 +1303,17 @@ TEST(CellReaderTest, MetricIsNotFoundDelta) {\n }\n \n TEST(CellReaderTest, LazyInitializationDelta) {\n-  CellReader<int64_t> cell_reader(\"/tensorflow/monitoring/test/lazy_counter\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/lazy_counter\");\n   EXPECT_EQ(cell_reader.Delta(), 0);\n }\n \n TEST(CellReaderTest, LazyInitializationDeltaAfterIncrement) {\n-  CellReader<int64_t> cell_reader(\"/tensorflow/monitoring/test/lazy_counter\");\n+  CellReader<int64_t> cell_reader(\"/tsl/monitoring/test/lazy_counter\");\n   IncrementLazyCounter();\n   EXPECT_EQ(cell_reader.Delta(), 1);\n }\n \n }  // namespace\n }  // namespace testing\n }  // namespace monitoring\n-}  // namespace tensorflow\n+}  // namespace tsl",
            "previous_filename": "tensorflow/core/lib/monitoring/cell_reader_test.cc"
        }
    ],
    "stats": {
        "total": 224,
        "additions": 116,
        "deletions": 108
    }
}