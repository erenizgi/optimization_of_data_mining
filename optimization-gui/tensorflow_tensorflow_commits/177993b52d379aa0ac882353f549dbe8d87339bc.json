{
    "author": "tensorflower-gardener",
    "message": "Automated Code Change\n\nPiperOrigin-RevId: 809834411",
    "sha": "177993b52d379aa0ac882353f549dbe8d87339bc",
    "files": [
        {
            "sha": "cf24ab205f966407c115dd4c097e0246a0aaf408",
            "filename": "third_party/xla/xla/hlo/transforms/simplifiers/algebraic_simplifier_test.cc",
            "status": "modified",
            "additions": 97,
            "deletions": 87,
            "changes": 184,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/177993b52d379aa0ac882353f549dbe8d87339bc/third_party%2Fxla%2Fxla%2Fhlo%2Ftransforms%2Fsimplifiers%2Falgebraic_simplifier_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/177993b52d379aa0ac882353f549dbe8d87339bc/third_party%2Fxla%2Fxla%2Fhlo%2Ftransforms%2Fsimplifiers%2Falgebraic_simplifier_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Ftransforms%2Fsimplifiers%2Falgebraic_simplifier_test.cc?ref=177993b52d379aa0ac882353f549dbe8d87339bc",
            "patch": "@@ -3648,7 +3648,7 @@ TEST_F(AlgebraicSimplifierTest, CopyEqualsBitcast) {\n   AlgebraicSimplifierOptions options2;\n   options2.set_is_layout_sensitive(true);\n   AlgebraicSimplifier simplifier2(options2);\n-  ASSERT_THAT(simplifier2.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier2.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   // Verify that the copy is replaced.\n   EXPECT_THAT(computation->root_instruction(),\n               GmockMatch(m::Bitcast(m::Parameter(0))));\n@@ -3788,7 +3788,7 @@ ENTRY test {\n                           ParseAndReturnVerifiedModule(kHloString));\n \n   AlgebraicSimplifier simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   const HloInstruction* slice_0 = FindInstruction(module.get(), \"slice.0\");\n   EXPECT_EQ(slice_0->slice_starts(0), 2);\n   EXPECT_EQ(slice_0->slice_limits(0), 3);\n@@ -4233,7 +4233,7 @@ TEST_F(AlgebraicSimplifierTest, ReshapeOfTransposeOfRngToRng) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n \n   // Verify that reshape(transpose(rng)) is replace by a single rng of the\n   // same shape as the reshape.\n@@ -4286,7 +4286,7 @@ TEST_F(AlgebraicSimplifierTest, ReshapeReplacedWithBitcast) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_is_layout_sensitive(true);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n \n   // Verify that only the first reshape is replaced.\n   EXPECT_THAT(\n@@ -4316,7 +4316,7 @@ TEST_F(AlgebraicSimplifierTest, FailureToSinkReshapeDoesntAffectChangedBit) {\n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n   m->AddEntryComputationWithLayouts(builder.Build());\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n }\n \n // Regression test for a bug where if we failed to sink a reshape, we'd set the\n@@ -4341,7 +4341,7 @@ TEST_F(AlgebraicSimplifierTest, FailureToSinkBroadcastDoesntAffectChangedBit) {\n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n   m->AddEntryComputationWithLayouts(builder.Build());\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n }\n \n TEST_F(AlgebraicSimplifierTest, TransposeEqualsBitcast1) {\n@@ -4502,7 +4502,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfBroadcast) {\n                           ParseAndReturnVerifiedModule(hlo_string));\n \n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::Slice(m::Parameter(0)))));\n }\n@@ -4523,7 +4523,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfBroadcastPreserveLayout) {\n   const Shape original_slice_shape =\n       module->entry_computation()->root_instruction()->shape();\n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::Slice(m::Parameter(0)))));\n   EXPECT_TRUE(ShapeUtil::Equal(root->shape(), original_slice_shape));\n@@ -4546,7 +4546,7 @@ TEST_F(AlgebraicSimplifierTest, DynamicSliceOfBroadcast) {\n                           ParseAndReturnVerifiedModule(hlo_string));\n \n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::DynamicSlice(\n                         m::Parameter(0), m::Parameter(1), m::Parameter(3)))));\n@@ -4571,7 +4571,7 @@ TEST_F(AlgebraicSimplifierTest, DynamicSliceOfBroadcastPreserveLayout) {\n   const Shape original_dynslice_shape =\n       module->entry_computation()->root_instruction()->shape();\n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::DynamicSlice(\n                         m::Parameter(0), m::Parameter(1), m::Parameter(3)))));\n@@ -4593,7 +4593,7 @@ TEST_F(AlgebraicSimplifierTest, TransposeIsReshape) {\n                           ParseAndReturnVerifiedModule(hlo_string));\n \n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Parameter()));\n }\n@@ -4660,7 +4660,7 @@ TEST_F(AlgebraicSimplifierTest, BroadcastAndReshape_1_3x1_3) {\n               GmockMatch(m::Reshape(m::Broadcast(m::Parameter(0)))));\n \n   AlgebraicSimplifier simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n \n   EXPECT_THAT(computation->root_instruction(),\n               GmockMatch(m::Broadcast(m::Reshape(m::Parameter(0)))));\n@@ -5045,7 +5045,7 @@ TEST_F(AlgebraicSimplifierTest, BroadcastSinking) {\n                           ParseAndReturnVerifiedModule(kModuleStr));\n \n   AlgebraicSimplifier simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   EXPECT_THAT(module->entry_computation()->root_instruction(),\n               op::Broadcast(op::Or(op::Parameter(0), op::Parameter(1))));\n }\n@@ -5157,7 +5157,7 @@ TEST_F(AlgebraicSimplifierTest, TrivialInteriorPadding) {\n               GmockMatch(m::Pad(m::Parameter(0), m::Op().Is(zero))));\n   ASSERT_TRUE(HasInteriorPadding(pad->padding_config()));\n \n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n \n   EXPECT_THAT(computation->root_instruction(),\n               GmockMatch(m::Pad(m::Parameter(0), m::Op().Is(zero))));\n@@ -6811,7 +6811,7 @@ TEST_F(AlgebraicSimplifierTest, TransposeOfDot) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   const HloInstruction* dot;\n   ASSERT_THAT(root, GmockMatch(m::Dot(&dot, m::Parameter(1), m::Parameter(0))));\n@@ -6844,7 +6844,7 @@ TEST_F(AlgebraicSimplifierTest, DotAssociativeReorder) {\n   options.set_use_associative_reordering(true);\n   options.set_associative_reordering_threshold(1.5);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Parameter(0),\n                                 m::Dot(m::Parameter(1), m::Parameter(2)))));\n@@ -6874,7 +6874,7 @@ TEST_F(AlgebraicSimplifierTest, DotLeftDotSharedBatchReorder) {\n   options.set_use_associative_reordering(true);\n   options.set_associative_reordering_threshold(1.5);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Parameter(0),\n                                 m::Dot(m::Parameter(1), m::Parameter(2)))));\n@@ -6904,7 +6904,7 @@ TEST_F(AlgebraicSimplifierTest, DotRightDotSharedBatchReorder) {\n   options.set_use_associative_reordering(true);\n   options.set_associative_reordering_threshold(1.5);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Dot(m::Parameter(0), m::Parameter(1)),\n                                 m::Parameter(2))));\n@@ -6958,7 +6958,7 @@ TEST_F(AlgebraicSimplifierTest, DotReverseLeftReorder) {\n   options.set_use_associative_reordering(true);\n   options.set_associative_reordering_threshold(1.1);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Parameter(0), m::Reverse(m::Parameter(1)))));\n }\n@@ -6983,7 +6983,7 @@ TEST_F(AlgebraicSimplifierTest, DotReverseRightReorder) {\n   options.set_use_associative_reordering(true);\n   options.set_associative_reordering_threshold(1.1);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Reverse(m::Parameter(0)),\n                                 m::Reverse(m::Parameter(1)))));\n@@ -7010,7 +7010,7 @@ TEST_F(AlgebraicSimplifierTest, DotPadLeftReorder) {\n   options.set_use_associative_reordering(true);\n   options.set_associative_reordering_threshold(1.1);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Parameter(0), m::Slice(m::Parameter(1)))));\n }\n@@ -7036,7 +7036,7 @@ TEST_F(AlgebraicSimplifierTest, DotPadRightReorder) {\n   options.set_use_associative_reordering(true);\n   options.set_associative_reordering_threshold(1.1);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Slice(m::Parameter(0)),\n                                 m::Pad(m::Parameter(1), m::Constant()))));\n@@ -7063,7 +7063,7 @@ TEST_F(AlgebraicSimplifierTest, DotBroadcastLeftReorder) {\n   options.set_use_associative_reordering(true);\n   options.set_associative_reordering_threshold(1.1);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Broadcast(m::Parameter(0)),\n                                 m::Reduce(m::Parameter(1), m::Constant()))));\n@@ -7090,7 +7090,7 @@ TEST_F(AlgebraicSimplifierTest, DotBroadcastRightReorder) {\n   options.set_use_associative_reordering(true);\n   options.set_associative_reordering_threshold(1.1);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Reduce(m::Parameter(0), m::Constant()),\n                                 m::Parameter(1))));\n@@ -7123,7 +7123,7 @@ TEST_F(AlgebraicSimplifierTest, ReduceDotReorder) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_raise_slice_and_reduce_through_dot(true);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(\n       module->entry_computation()->root_instruction(),\n       GmockMatch(m::Dot(m::Reduce(m::Parameter(0), m::ConstantScalar(0)),\n@@ -7149,7 +7149,7 @@ TEST_F(AlgebraicSimplifierTest, SliceDotReorder) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_raise_slice_and_reduce_through_dot(true);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(m::Slice(m::Parameter(0)), m::Parameter(1))));\n }\n@@ -7173,7 +7173,7 @@ TEST_F(AlgebraicSimplifierTest, SliceDotReorderWithStrides) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_raise_slice_and_reduce_through_dot(true);\n   ASSERT_THAT(AlgebraicSimplifier(options).Run(module.get()),\n-              IsOkAndHolds(true));\n+              absl_testing::IsOkAndHolds(true));\n   ASSERT_THAT(\n       module->entry_computation()->root_instruction(),\n       GmockMatch(m::Dot(m::Slice(m::Parameter(0)), m::Slice(m::Parameter(1)))));\n@@ -7199,7 +7199,8 @@ TEST_F(AlgebraicSimplifierTest, TransposeOfBatchDot) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(RunHloPass(&simplifier, module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(RunHloPass(&simplifier, module.get()),\n+              absl_testing::IsOkAndHolds(true));\n   const HloInstruction* dot;\n   ASSERT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Dot(&dot, m::Parameter(1), m::Parameter(0))));\n@@ -7233,11 +7234,13 @@ TEST_F(AlgebraicSimplifierTest, TransposeOfBatchDimsInBatchDotCantSimplify) {\n \n   options.set_supports_non_canonical_dots(false);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(RunHloPass(&simplifier, module.get()), IsOkAndHolds(false));\n+  ASSERT_THAT(RunHloPass(&simplifier, module.get()),\n+              absl_testing::IsOkAndHolds(false));\n \n   options.set_supports_non_canonical_dots(true);\n   AlgebraicSimplifier simplifier2(options);\n-  ASSERT_THAT(RunHloPass(&simplifier2, module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(RunHloPass(&simplifier2, module.get()),\n+              absl_testing::IsOkAndHolds(true));\n }\n \n TEST_F(AlgebraicSimplifierTest, TransposeOfNonCanonicalBatchDotCantSimplify) {\n@@ -7259,7 +7262,8 @@ TEST_F(AlgebraicSimplifierTest, TransposeOfNonCanonicalBatchDotCantSimplify) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(RunHloPass(&simplifier, module.get()), IsOkAndHolds(false));\n+  ASSERT_THAT(RunHloPass(&simplifier, module.get()),\n+              absl_testing::IsOkAndHolds(false));\n }\n \n TEST_F(AlgebraicSimplifierTest, DynamicSliceOfTranspose) {\n@@ -7286,7 +7290,7 @@ TEST_F(AlgebraicSimplifierTest, DynamicSliceOfTranspose) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Transpose(\n                         m::DynamicSlice(m::Parameter(0), m::Parameter(1),\n@@ -7314,7 +7318,7 @@ TEST_F(AlgebraicSimplifierTest, DynamicSliceOfTrivialReshape) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_is_layout_sensitive(false);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Reshape(m::DynamicSlice(\n                         m::Parameter(0), m::Parameter(1), m::Parameter(2),\n@@ -7337,7 +7341,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfPadLow) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::Constant())));\n }\n@@ -7358,7 +7362,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfPadHigh) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::Constant())));\n }\n@@ -7379,7 +7383,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfPadMidNonScalar) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   EXPECT_THAT(module->entry_computation()->root_instruction(),\n               GmockMatch(m::Slice(m::Parameter(0))));\n }\n@@ -7400,7 +7404,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfPad) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Slice(m::Parameter(0))));\n   EXPECT_THAT(root->slice_starts(), ElementsAre(1, 1));\n@@ -7422,7 +7426,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfPadMidScalarConstant) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::Constant())));\n }\n@@ -7443,7 +7447,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfPadMidScalar) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Parameter()));\n }\n@@ -7466,7 +7470,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfPadSomeDimsInPadding) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::ConstantScalar(-7.0))));\n }\n@@ -7488,7 +7492,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfConcatScalarInput) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Parameter(1)));\n }\n@@ -7510,7 +7514,7 @@ TEST_F(AlgebraicSimplifierTest, SliceOfConcatNonScalarInput) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Slice(m::Parameter(2))));\n   EXPECT_EQ(root->slice_starts(0), 1);\n@@ -7591,7 +7595,7 @@ TEST_F(AlgebraicSimplifierTest, ConcatToBroadcast) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::Reshape(m::Parameter(0)))));\n }\n@@ -7611,7 +7615,7 @@ TEST_F(AlgebraicSimplifierTest, NegateNegate) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Parameter(0)));\n }\n@@ -7631,7 +7635,7 @@ TEST_F(AlgebraicSimplifierTest, NotNot) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Parameter(0)));\n }\n@@ -7656,7 +7660,8 @@ TEST_F(AlgebraicSimplifierTest, BatchDotTransposeOperands) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(RunHloPass(&simplifier, module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(RunHloPass(&simplifier, module.get()),\n+              absl_testing::IsOkAndHolds(true));\n   const HloInstruction* dot;\n   ASSERT_THAT(\n       module->entry_computation()->root_instruction(),\n@@ -7687,7 +7692,8 @@ TEST_F(AlgebraicSimplifierTest, BatchDotTransposeBatchDims) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(RunHloPass(&simplifier, module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(RunHloPass(&simplifier, module.get()),\n+              absl_testing::IsOkAndHolds(true));\n   const HloInstruction* dot;\n   ASSERT_THAT(\n       module->entry_computation()->root_instruction(),\n@@ -7718,7 +7724,8 @@ TEST_F(AlgebraicSimplifierTest, BatchDotTransposeBatchDimsAndOperands) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(RunHloPass(&simplifier, module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(RunHloPass(&simplifier, module.get()),\n+              absl_testing::IsOkAndHolds(true));\n   const HloInstruction* dot;\n   ASSERT_THAT(\n       module->entry_computation()->root_instruction(),\n@@ -7913,7 +7920,7 @@ TEST_P(BatchDotStrengthReductionTest, BatchDotStrengthReduction) {\n   const bool dot_should_be_transformed =\n       m == 1 || k == 1 || n == 1 || m == -1 || k == -1 || n == -1;\n   EXPECT_EQ(changed, dot_should_be_transformed);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOk());\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOk());\n   bool has_no_dot = true;\n   for (const auto& hlo : computation->instructions()) {\n     if (hlo->opcode() == HloOpcode::kDot) {\n@@ -7973,11 +7980,11 @@ TEST_P(DotStrengthReductionTest, DotStrengthReduction) {\n   const bool computation_should_be_modified =\n       dot_should_be_transformed || (transpose_lhs && transpose_rhs);\n   ASSERT_THAT(simplifier.Run(module.get()),\n-              IsOkAndHolds(computation_should_be_modified));\n+              absl_testing::IsOkAndHolds(computation_should_be_modified));\n   // The second pass of algebraic simplifier will remove dots without\n   // non-contracting dimensions or contracting dimensions.\n   ASSERT_THAT(simplifier.Run(module.get()),\n-              IsOkAndHolds(computation_should_be_modified));\n+              absl_testing::IsOkAndHolds(computation_should_be_modified));\n   bool has_no_dot = true;\n   for (const auto& hlo : computation->instructions()) {\n     if (hlo->opcode() == HloOpcode::kDot) {\n@@ -8051,7 +8058,7 @@ TEST_P(DotOfConcatSimplificationTest, ConstantLHS) {\n \n   auto computation = m->AddEntryComputationWithLayouts(builder.Build());\n   AlgebraicSimplifier simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n \n   EXPECT_TRUE(\n       ShapeUtil::Equal(computation->root_instruction()->shape(), dot_shape));\n@@ -8115,7 +8122,7 @@ TEST_P(DotOfConcatSimplificationTest, ConstantRHS) {\n \n   auto computation = m->AddEntryComputationWithLayouts(builder.Build());\n   AlgebraicSimplifier simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   EXPECT_TRUE(\n       ShapeUtil::Equal(computation->root_instruction()->shape(), dot_shape));\n \n@@ -8166,7 +8173,8 @@ TEST_F(DotOfConcatSimplificationTest, UnnestConcatenate) {\n     })\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(kModuleStr));\n   AlgebraicSimplifier simplifier(default_options_);\n-  ASSERT_THAT(RunHloPass(&simplifier, m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(RunHloPass(&simplifier, m.get()),\n+              absl_testing::IsOkAndHolds(true));\n   EXPECT_THAT(m->entry_computation()->root_instruction(),\n               GmockMatch(m::Concatenate(m::Parameter(0), m::Parameter(1),\n                                         m::Parameter(2))));\n@@ -8638,7 +8646,7 @@ TEST_P(DotOfGatherSimplificationTest, ConstantRHS) {\n \n   auto computation = m->AddEntryComputationWithLayouts(builder.Build());\n   AlgebraicSimplifier simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   EXPECT_TRUE(\n       ShapeUtil::Equal(computation->root_instruction()->shape(), dot_shape));\n \n@@ -8710,7 +8718,7 @@ TEST_P(DotOfGatherSimplificationTest, ConstantLHS) {\n \n   auto computation = m->AddEntryComputationWithLayouts(builder.Build());\n   AlgebraicSimplifier simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   EXPECT_TRUE(\n       ShapeUtil::Equal(computation->root_instruction()->shape(), dot_shape));\n \n@@ -8795,7 +8803,7 @@ TEST_F(AlgebraicSimplifierTest, GatherOfScalarToBroadcast) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Broadcast(m::Reshape(m::Parameter(0)))));\n }\n@@ -8818,7 +8826,7 @@ ENTRY %entry {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   VLOG(2) << \"After rewrite \\n\" << module->ToString();\n   auto root = module->entry_computation()->root_instruction();\n   const HloInstruction* gather_instr;\n@@ -8848,7 +8856,7 @@ ENTRY %entry {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   VLOG(2) << \"After rewrite \\n\" << module->ToString();\n   auto root = module->entry_computation()->root_instruction();\n   const HloInstruction* gather_instr;\n@@ -8944,7 +8952,7 @@ TEST_F(AlgebraicSimplifierTest, GatherOfPadWithPaddedBatchDims) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   VLOG(2) << \"After rewrite \\n\" << module->ToString();\n \n   auto root = module->entry_computation()->root_instruction();\n@@ -8981,7 +8989,7 @@ ENTRY %entry {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   VLOG(2) << \"After rewrite \\n\" << module->ToString();\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Pad(\n@@ -9008,7 +9016,7 @@ ENTRY %entry {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   VLOG(2) << \"After rewrite \\n\" << module->ToString();\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(\n@@ -9064,7 +9072,7 @@ ENTRY %entry {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   VLOG(0) << \"After rewrite \\n\" << module->ToString();\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Pad(m::Gather(m::Reshape(), m::Parameter(1)),\n@@ -9101,7 +9109,7 @@ ENTRY entry {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Tuple(\n                         m::Reshape(m::GetTupleElement(m::Parameter(), 0)),\n@@ -9136,7 +9144,7 @@ ENTRY entry {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   auto root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Tuple(m::Broadcast(m::ConstantScalar(0)),\n                                         m::Broadcast(m::ConstantScalar(1)))));\n@@ -9162,7 +9170,7 @@ TEST_F(AlgebraicSimplifierTest, ZeroSizedReshapeWithoutLayout) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Constant()));\n }\n@@ -9189,7 +9197,7 @@ TEST_F(AlgebraicSimplifierTest, DividedByConstantInstructionWithoutLayout) {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(module.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(module.get()), absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = module->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Multiply()));\n }\n@@ -10968,7 +10976,7 @@ TEST_F(AlgebraicSimplifierTest, ReplaceReduceSumOfConstantBroadcast) {\n \n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(kModuleStr));\n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   int64_t reduce_count =\n       absl::c_count_if(m->entry_computation()->instructions(),\n                        HloPredicateIsOp<HloOpcode::kReduce>);\n@@ -12037,7 +12045,7 @@ TEST_F(AlgebraicSimplifierTest, MultiplyOfConvertedPred) {\n                                    m::Broadcast(m::ConstantScalar(0)))));\n   // Also run the HloVerifier on the resulting module to check that the\n   // generated instructions don't have an invalid layout change now.\n-  ASSERT_THAT(verifier().Run(m.get()), IsOk());\n+  ASSERT_THAT(verifier().Run(m.get()), absl_testing::IsOk());\n }\n \n TEST_F(AlgebraicSimplifierTest, TransposeOfBroadcast) {\n@@ -12357,7 +12365,7 @@ TEST_F(AlgebraicSimplifierTest, BroadcastToTranspose) {\n   )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   ASSERT_THAT(AlgebraicSimplifier(default_options_).Run(m.get()),\n-              IsOkAndHolds(true));\n+              absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = m->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Transpose(m::Parameter(0))));\n   EXPECT_EQ(root->dimensions(), std::vector<int64_t>({1, 2, 0}));\n@@ -12373,7 +12381,7 @@ TEST_F(AlgebraicSimplifierTest, BroadcastToTranspose2) {\n   )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   ASSERT_THAT(AlgebraicSimplifier(default_options_).Run(m.get()),\n-              IsOkAndHolds(true));\n+              absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = m->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Transpose(m::Parameter(0))));\n   EXPECT_EQ(root->dimensions(), std::vector<int64_t>({1, 0, 2}));\n@@ -12392,7 +12400,8 @@ TEST_F(AlgebraicSimplifierTest, LayoutConstraintToNoop) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_is_layout_sensitive(true);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(AlgebraicSimplifier(options).Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(AlgebraicSimplifier(options).Run(m.get()),\n+              absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = m->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Parameter(0)));\n }\n@@ -12410,7 +12419,8 @@ TEST_F(AlgebraicSimplifierTest, LayoutConstraintToCopy) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_is_layout_sensitive(true);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(AlgebraicSimplifier(options).Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(AlgebraicSimplifier(options).Run(m.get()),\n+              absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = m->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Copy(m::Parameter(0))));\n }\n@@ -12428,7 +12438,7 @@ TEST_F(AlgebraicSimplifierTest, KeepLayoutConstraint) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_is_layout_sensitive(false);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(false));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(false));\n }\n \n TEST_F(AlgebraicSimplifierTest, PreserveSharding) {\n@@ -12442,7 +12452,7 @@ TEST_F(AlgebraicSimplifierTest, PreserveSharding) {\n   )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   ASSERT_THAT(AlgebraicSimplifier(default_options_).Run(m.get()),\n-              IsOkAndHolds(true));\n+              absl_testing::IsOkAndHolds(true));\n   EXPECT_TRUE(m->entry_computation()->parameter_instruction(0)->has_sharding());\n }\n \n@@ -12457,7 +12467,7 @@ TEST_F(AlgebraicSimplifierTest, PreserveSdySharding) {\n   )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   ASSERT_THAT(AlgebraicSimplifier(default_options_).Run(m.get()),\n-              IsOkAndHolds(true));\n+              absl_testing::IsOkAndHolds(true));\n   EXPECT_EQ(\n       m->entry_computation()->parameter_instruction(0)->get_frontend_attribute(\n           HloSharding::kShardingFrontendAttrName),\n@@ -12482,7 +12492,7 @@ ENTRY main.1 {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   default_options_.set_enable_move_dot_param_to_rhs(true);\n   ASSERT_THAT(AlgebraicSimplifier(default_options_).Run(m.get()),\n-              IsOkAndHolds(true));\n+              absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = m->entry_computation()->root_instruction();\n   EXPECT_EQ(root->opcode(), HloOpcode::kTranspose);\n   EXPECT_EQ(root->operand(0)->opcode(), HloOpcode::kDot);\n@@ -12508,7 +12518,7 @@ TEST_F(AlgebraicSimplifierTest, ReduceOfConstantBroadcastS32) {\n   )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   int64_t reduce_count =\n       absl::c_count_if(m->entry_computation()->instructions(),\n                        HloPredicateIsOp<HloOpcode::kReduce>);\n@@ -12534,7 +12544,7 @@ TEST_F(AlgebraicSimplifierTest, TrivialReduce) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_is_layout_sensitive(false);\n   HloPassFix<AlgebraicSimplifier> simplifier(options);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   int64_t reduce_count =\n       absl::c_count_if(m->entry_computation()->instructions(),\n                        HloPredicateIsOp<HloOpcode::kReduce>);\n@@ -12559,7 +12569,7 @@ TEST_F(AlgebraicSimplifierTest, ReduceOfConstantBroadcastBF16) {\n   )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   int64_t reduce_count =\n       absl::c_count_if(m->entry_computation()->instructions(),\n                        HloPredicateIsOp<HloOpcode::kReduce>);\n@@ -12586,7 +12596,7 @@ TEST_F(AlgebraicSimplifierTest, ReduceOfNonScalarBroadcast) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = m->entry_computation()->root_instruction();\n   int64_t reduce_count =\n       absl::c_count_if(m->entry_computation()->instructions(),\n@@ -12617,7 +12627,7 @@ TEST_F(AlgebraicSimplifierTest, RemoveConvertConstant) {\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   default_options_.set_use_convert_constant_folding(true);\n   ASSERT_THAT(AlgebraicSimplifier(default_options_).Run(m.get()),\n-              IsOkAndHolds(true));\n+              absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = m->entry_computation()->root_instruction();\n   EXPECT_THAT(root, GmockMatch(m::Reduce(m::Parameter(0),\n                                          m::Constant().WithShape(F32, {}))));\n@@ -12657,7 +12667,7 @@ TEST_F(AlgebraicSimplifierTest, ReduceBroadcastScalarToBroadcastMultiply) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   HloPassFix<AlgebraicSimplifier> simplifier(default_options_);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = m->entry_computation()->root_instruction();\n   EXPECT_EQ(root->opcode(), HloOpcode::kBroadcast);\n   EXPECT_EQ(root->operand(0)->opcode(), HloOpcode::kMultiply);\n@@ -12677,7 +12687,7 @@ TEST_F(AlgebraicSimplifierTest, SinkCbrtThroughMax) {\n     )\";\n   TF_ASSERT_OK_AND_ASSIGN(auto m, ParseAndReturnVerifiedModule(hlo_string));\n   ASSERT_THAT(AlgebraicSimplifier(default_options_).Run(m.get()),\n-              IsOkAndHolds(true));\n+              absl_testing::IsOkAndHolds(true));\n   HloInstruction* root = m->entry_computation()->root_instruction();\n   EXPECT_THAT(\n       root, GmockMatch(m::Cbrt(m::Maximum(m::Parameter(0), m::Parameter(1)))));\n@@ -12883,7 +12893,7 @@ TEST_F(AlgebraicSimplifierTest,\n                           ParseAndReturnVerifiedModule(hlo));\n   default_options_.set_enable_remove_no_op_reduce_precision(true);\n   ASSERT_THAT(AlgebraicSimplifier(default_options_).Run(m.get()),\n-              IsOkAndHolds(true));\n+              absl_testing::IsOkAndHolds(true));\n   EXPECT_THAT(m->entry_computation()->root_instruction(),\n               GmockMatch(m::Parameter()));\n }\n@@ -12935,7 +12945,7 @@ TEST_F(AlgebraicSimplifierTest, TestWithControlDependencies) {\n   AlgebraicSimplifierOptions options = default_options_;\n   options.set_is_layout_sensitive(true);\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n }\n \n TEST_F(AlgebraicSimplifierTest, CopyReshapeToReshapeCopyWithHostCopies) {\n@@ -12975,7 +12985,7 @@ ENTRY main {\n \n   AlgebraicSimplifierOptions options = default_options_;\n   AlgebraicSimplifier simplifier(options);\n-  ASSERT_THAT(simplifier.Run(m.get()), IsOkAndHolds(true));\n+  ASSERT_THAT(simplifier.Run(m.get()), absl_testing::IsOkAndHolds(true));\n   EXPECT_THAT(m->entry_computation()->root_instruction(),\n               GmockMatch(m::Broadcast(\n                   m::Pad(m::Broadcast(m::Constant()), m::Constant()))));"
        }
    ],
    "stats": {
        "total": 184,
        "additions": 97,
        "deletions": 87
    }
}