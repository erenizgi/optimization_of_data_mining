{
    "author": "ezhulenev",
    "message": "[xla:cpu] Copy service/cpu/runtime_pow to cpu/codegen/builtin_pow\n\nFirst change in preparation of moving XLA:CPU builtins to backends/cpu/codegen folder\n\nPiperOrigin-RevId: 827761123",
    "sha": "ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae",
    "files": [
        {
            "sha": "e6784eb89a5ea3a15f579a1c7a08b787c374ccef",
            "filename": "third_party/xla/xla/backends/cpu/codegen/BUILD",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2FBUILD?ref=ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae",
            "patch": "@@ -23,6 +23,14 @@ package_group(\n     ],\n )\n \n+cc_library(\n+    name = \"builtin_pow\",\n+    srcs = [\"builtin_pow.cc\"],\n+    hdrs = [\"builtin_pow.h\"],\n+    visibility = internal_visibility([\":friends\"]),\n+    deps = [\"@com_google_absl//absl/base:core_headers\"],\n+)\n+\n cc_library(\n     name = \"contiguous_section_memory_manager\",\n     srcs = [\"contiguous_section_memory_manager.cc\"],"
        },
        {
            "sha": "ddc23f59b6801597d6acd3ef99685f293e7bf425",
            "filename": "third_party/xla/xla/backends/cpu/codegen/builtin_pow.cc",
            "status": "added",
            "additions": 41,
            "deletions": 0,
            "changes": 41,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Fbuiltin_pow.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Fbuiltin_pow.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Fbuiltin_pow.cc?ref=ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae",
            "patch": "@@ -0,0 +1,41 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#include \"xla/backends/cpu/codegen/builtin_pow.h\"\n+\n+#include <cstdint>\n+\n+#include \"absl/base/attributes.h\"\n+\n+template <typename T>\n+static T Powi(T a, int32_t b) {\n+  const bool recip = b < 0;\n+  T r = 1;\n+  while (true) {\n+    if (b & 1) {\n+      r *= a;\n+    }\n+    b /= 2;\n+    if (b == 0) {\n+      break;\n+    }\n+    a *= a;\n+  }\n+  return recip ? 1 / r : r;\n+}\n+\n+float ABSL_ATTRIBUTE_WEAK __powisf2(float a, int32_t b) { return Powi(a, b); }\n+\n+double ABSL_ATTRIBUTE_WEAK __powidf2(double a, int32_t b) { return Powi(a, b); }"
        },
        {
            "sha": "cbbdba29375b0069d70792c1d1437a48a5f432b1",
            "filename": "third_party/xla/xla/backends/cpu/codegen/builtin_pow.h",
            "status": "added",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Fbuiltin_pow.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Fbuiltin_pow.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fcodegen%2Fbuiltin_pow.h?ref=ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae",
            "patch": "@@ -0,0 +1,27 @@\n+/* Copyright 2025 The OpenXLA Authors.\n+\n+Licensed under the Apache License, Version 2.0 (the \"License\");\n+you may not use this file except in compliance with the License.\n+You may obtain a copy of the License at\n+\n+    http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing, software\n+distributed under the License is distributed on an \"AS IS\" BASIS,\n+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+See the License for the specific language governing permissions and\n+limitations under the License.\n+==============================================================================*/\n+\n+#ifndef XLA_BACKENDS_CPU_CODEGEN_BUILTIN_POW_H_\n+#define XLA_BACKENDS_CPU_CODEGEN_BUILTIN_POW_H_\n+\n+#include <stdint.h>\n+\n+// Raises F32 value a to the power of b.\n+extern \"C\" float __powisf2(float a, int32_t b);\n+\n+// Raises F64 value a to the power of b.\n+extern \"C\" double __powidf2(double a, int32_t b);\n+\n+#endif  // XLA_BACKENDS_CPU_CODEGEN_BUILTIN_POW_H_"
        },
        {
            "sha": "632eb0427091e7652719e798ea73a3a38705c721",
            "filename": "third_party/xla/xla/service/cpu/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD?ref=ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae",
            "patch": "@@ -572,7 +572,7 @@ cc_library(\n     copts = tsl_copts(),\n     deps = [\n         \":runtime_fp16\",\n-        \":runtime_pow\",\n+        \"//xla/backends/cpu/codegen:builtin_pow\",\n         \"@com_google_absl//absl/base:no_destructor\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/functional:any_invocable\","
        },
        {
            "sha": "2d0c6d97bd27cd807e4db9741ab090690eaedb8f",
            "filename": "third_party/xla/xla/service/cpu/runtime_symbol_generator.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fruntime_symbol_generator.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fruntime_symbol_generator.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fruntime_symbol_generator.cc?ref=ec1d26fc12f21dbaa8a81a7f577b5bef6b9779ae",
            "patch": "@@ -37,8 +37,8 @@ limitations under the License.\n #include \"llvm/ExecutionEngine/Orc/Shared/ExecutorSymbolDef.h\"\n #include \"llvm/IR/DataLayout.h\"\n #include \"llvm/Support/Error.h\"\n+#include \"xla/backends/cpu/codegen/builtin_pow.h\"\n #include \"xla/service/cpu/runtime_fp16.h\"\n-#include \"xla/service/cpu/runtime_pow.h\"\n \n namespace xla::cpu {\n "
        }
    ],
    "stats": {
        "total": 80,
        "additions": 78,
        "deletions": 2
    }
}