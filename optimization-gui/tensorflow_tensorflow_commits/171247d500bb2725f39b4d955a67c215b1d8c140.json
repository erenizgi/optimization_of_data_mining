{
    "author": "alexander-shaposhnikov",
    "message": "Temporarily bring back the old logic for capturing RHS.\n\nPiperOrigin-RevId: 823712382",
    "sha": "171247d500bb2725f39b4d955a67c215b1d8c140",
    "files": [
        {
            "sha": "78e6e53e2e43dc87b1d9a6c8cf8469934447e96c",
            "filename": "third_party/xla/xla/service/cpu/thunk_emitter.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/171247d500bb2725f39b4d955a67c215b1d8c140/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fthunk_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/171247d500bb2725f39b4d955a67c215b1d8c140/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fthunk_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fthunk_emitter.cc?ref=171247d500bb2725f39b4d955a67c215b1d8c140",
            "patch": "@@ -1558,7 +1558,7 @@ absl::StatusOr<ThunkSequence> ThunkEmitter::EmitYnnFusionThunk(\n     const HloDotInstruction* dot = Cast<HloDotInstruction>(instruction);\n     // TODO(ashaposhnikov): Revisit this if we ever get a reliable way\n     // to determine that RHS is constant.\n-    bool capture_rhs = false;\n+    bool capture_rhs = HloPredicateIsOp<HloOpcode::kParameter>(dot->operand(1));\n     // Construct YNNPACK subgraph builder from the dot instruction.\n     TF_ASSIGN_OR_RETURN(builder, EmitYnnDotBuilder(dot, capture_rhs));\n     static constexpr int64_t kCapturedIds[1] = {1};"
        }
    ],
    "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    }
}