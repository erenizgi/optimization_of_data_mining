{
    "author": "boomanaiden154",
    "message": "Use triple overloads of TargetRegistry functions\n\nThe overloads accepting triples as strings are deprecated and will be removed soon.\n\nPiperOrigin-RevId: 813035688",
    "sha": "716bcf2a66c418777493aa33272ad247643fb53b",
    "files": [
        {
            "sha": "987dac62bca0fefb0842280fb89fba0fc0d45a8f",
            "filename": "tensorflow/compiler/aot/embedded_constant_buffers.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/716bcf2a66c418777493aa33272ad247643fb53b/tensorflow%2Fcompiler%2Faot%2Fembedded_constant_buffers.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/716bcf2a66c418777493aa33272ad247643fb53b/tensorflow%2Fcompiler%2Faot%2Fembedded_constant_buffers.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Faot%2Fembedded_constant_buffers.cc?ref=716bcf2a66c418777493aa33272ad247643fb53b",
            "patch": "@@ -128,7 +128,7 @@ GetTargetMachineFromTriple(absl::string_view target_triple) {\n   }\n \n   return absl::WrapUnique(target->createTargetMachine(\n-      normalized_triple, /*CPU=*/\"\",\n+      llvm::Triple(normalized_triple), /*CPU=*/\"\",\n       /*Features=*/\"\", llvm::TargetOptions(), std::nullopt));\n }\n "
        },
        {
            "sha": "ae5b62ccec01a9800e808a9da4685773d1a64847",
            "filename": "tensorflow/compiler/aot/embedded_protocol_buffers.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/716bcf2a66c418777493aa33272ad247643fb53b/tensorflow%2Fcompiler%2Faot%2Fembedded_protocol_buffers.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/716bcf2a66c418777493aa33272ad247643fb53b/tensorflow%2Fcompiler%2Faot%2Fembedded_protocol_buffers.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Faot%2Fembedded_protocol_buffers.cc?ref=716bcf2a66c418777493aa33272ad247643fb53b",
            "patch": "@@ -107,7 +107,7 @@ GetTargetMachineFromTriple(absl::string_view target_triple) {\n   }\n \n   return absl::WrapUnique(target->createTargetMachine(\n-      normalized_triple, /*CPU=*/\"\",\n+      llvm::Triple(normalized_triple), /*CPU=*/\"\",\n       /*Features=*/\"\", llvm::TargetOptions(), std::nullopt));\n }\n "
        },
        {
            "sha": "8f06eb691551efc77749f05cf0195069eeb6700e",
            "filename": "tensorflow/compiler/mlir/tools/kernel_gen/hlo_to_kernel.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/716bcf2a66c418777493aa33272ad247643fb53b/tensorflow%2Fcompiler%2Fmlir%2Ftools%2Fkernel_gen%2Fhlo_to_kernel.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/716bcf2a66c418777493aa33272ad247643fb53b/tensorflow%2Fcompiler%2Fmlir%2Ftools%2Fkernel_gen%2Fhlo_to_kernel.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftools%2Fkernel_gen%2Fhlo_to_kernel.cc?ref=716bcf2a66c418777493aa33272ad247643fb53b",
            "patch": "@@ -87,7 +87,7 @@ std::unique_ptr<llvm::TargetMachine> GetTargetMachine(\n   llvm::TargetOptions target_options =\n       llvm::codegen::InitTargetOptionsFromCodeGenFlags(llvm::Triple());\n   return std::unique_ptr<llvm::TargetMachine>(target->createTargetMachine(\n-      triple.str(), \"generic\", \"\", target_options, llvm::Reloc::Model::PIC_));\n+      triple, \"generic\", \"\", target_options, llvm::Reloc::Model::PIC_));\n }\n \n // Compiles the given MLIR module via LLVM into an executable binary format."
        },
        {
            "sha": "b530ca83faccdf813a282bb4a9803f891fefbe31",
            "filename": "third_party/xla/xla/pjrt/triton_cuda.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fpjrt%2Ftriton_cuda.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fpjrt%2Ftriton_cuda.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Ftriton_cuda.cc?ref=716bcf2a66c418777493aa33272ad247643fb53b",
            "patch": "@@ -100,8 +100,8 @@ absl::StatusOr<std::unique_ptr<llvm::TargetMachine>> CreateTargetMachine(\n   opt.MCOptions.AsmVerbose = true;\n   opt.MCOptions.PreserveAsmComments = true;\n   return std::unique_ptr<llvm::TargetMachine>(target->createTargetMachine(\n-      module->getTargetTriple().str(), arch_name, features, opt,\n-      llvm::Reloc::PIC_, std::nullopt, llvm::CodeGenOptLevel::Aggressive));\n+      module->getTargetTriple(), arch_name, features, opt, llvm::Reloc::PIC_,\n+      std::nullopt, llvm::CodeGenOptLevel::Aggressive));\n }\n \n absl::StatusOr<std::string> GetLibdeviceDir() {"
        },
        {
            "sha": "2a97d56cc3c2866504b4cfc72c15e6ae64243520",
            "filename": "third_party/xla/xla/service/cpu/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD?ref=716bcf2a66c418777493aa33272ad247643fb53b",
            "patch": "@@ -1666,6 +1666,7 @@ xla_cc_test(\n         \"@llvm-project//llvm:Core\",\n         \"@llvm-project//llvm:MC\",\n         \"@llvm-project//llvm:Target\",\n+        \"@llvm-project//llvm:TargetParser\",\n         \"@local_tsl//tsl/platform:statusor\",\n     ],\n )"
        },
        {
            "sha": "eff8f5858217ca501604659b77903c52102683ab",
            "filename": "third_party/xla/xla/service/cpu/cpu_compiler.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_compiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_compiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_compiler.cc?ref=716bcf2a66c418777493aa33272ad247643fb53b",
            "patch": "@@ -2112,8 +2112,8 @@ CpuCompiler::CompileAheadOfTime(std::unique_ptr<HloModuleGroup> module_group,\n       CompilerTargetOptions(modules[0]->config());\n   auto target_machine_builder = [&]() {\n     return absl::WrapUnique(target->createTargetMachine(\n-        triple.getTriple(), options.cpu_name(), options.features(),\n-        target_options, reloc_model, std::nullopt, opt_level));\n+        triple, options.cpu_name(), options.features(), target_options,\n+        reloc_model, std::nullopt, opt_level));\n   };\n \n   std::unique_ptr<llvm::TargetMachine> target_machine ="
        },
        {
            "sha": "523e21277632946b06a238cf84329e70216e0e61",
            "filename": "third_party/xla/xla/service/cpu/vectorized_reduce_with_no_vector_registers_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fvectorized_reduce_with_no_vector_registers_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fvectorized_reduce_with_no_vector_registers_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fvectorized_reduce_with_no_vector_registers_test.cc?ref=716bcf2a66c418777493aa33272ad247643fb53b",
            "patch": "@@ -28,6 +28,7 @@ limitations under the License.\n #include \"llvm/IR/LLVMContext.h\"\n #include \"llvm/MC/TargetRegistry.h\"\n #include \"llvm/Target/TargetMachine.h\"\n+#include \"llvm/TargetParser/Triple.h\"\n #include \"xla/backends/cpu/codegen/target_machine_features.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/hlo/ir/hlo_module_group.h\"\n@@ -64,7 +65,8 @@ absl::StatusOr<unsigned int> GetTargetVectorRegisterByteSize(\n \n   std::unique_ptr<llvm::TargetMachine> target_machine =\n       absl::WrapUnique(target->createTargetMachine(\n-          /*TT=*/triple, /*CPU=*/\"\", /*Features=*/\"\", llvm::TargetOptions{},\n+          /*TT=*/llvm::Triple(triple), /*CPU=*/\"\", /*Features=*/\"\",\n+          llvm::TargetOptions{},\n           /*RM=*/std::nullopt));\n   cpu::TargetMachineFeatures target_machine_features(target_machine.get());\n   return target_machine_features.vector_register_byte_size(*function);"
        },
        {
            "sha": "940c864f676ff04156f1e610b76ca5514eba7cbb",
            "filename": "third_party/xla/xla/service/gpu/llvm_gpu_backend/gpu_backend_lib.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fllvm_gpu_backend%2Fgpu_backend_lib.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/716bcf2a66c418777493aa33272ad247643fb53b/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fllvm_gpu_backend%2Fgpu_backend_lib.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fllvm_gpu_backend%2Fgpu_backend_lib.cc?ref=716bcf2a66c418777493aa33272ad247643fb53b",
            "patch": "@@ -131,9 +131,8 @@ std::unique_ptr<llvm::TargetMachine> GetTargetMachine(\n       codegen_opt_level = llvm::CodeGenOptLevel::None;\n   }\n   return absl::WrapUnique(target->createTargetMachine(\n-      triple.str(), llvm_ir::AsStringRef(cpu_name),\n-      llvm_ir::AsStringRef(feature_str), target_options,\n-      llvm::codegen::getExplicitRelocModel(),\n+      triple, llvm_ir::AsStringRef(cpu_name), llvm_ir::AsStringRef(feature_str),\n+      target_options, llvm::codegen::getExplicitRelocModel(),\n       llvm::codegen::getExplicitCodeModel(), codegen_opt_level));\n }\n "
        }
    ],
    "stats": {
        "total": 24,
        "additions": 13,
        "deletions": 11
    }
}