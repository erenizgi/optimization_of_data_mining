{
    "author": "tensorflower-gardener",
    "message": "Update `rules_python` to v1.6 in XLA and TensorFlow projects.\n\n`com_google_protobuf` and `rules_cc` initialization was moved to `python_init_rules` macros.\n\nThe JAX repository update will be done [in the next step](https://github.com/jax-ml/jax/pull/31709)\n\nPiperOrigin-RevId: 808689003",
    "sha": "3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
    "files": [
        {
            "sha": "be122db30c97736c83e21380de6f87f2edb2ee9a",
            "filename": ".bazelrc",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/.bazelrc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/.bazelrc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/.bazelrc?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -96,7 +96,11 @@ build --host_copt=-DGRPC_BAZEL_BUILD\n build --action_env=GRPC_BAZEL_RUNTIME=1\n build --repo_env=PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=upb\n build --action_env=PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=upb\n-build --repo_env=RULES_PYTHON_ENABLE_PYSTAR=0\n+# Some targets have the same py source file, but use different\n+# configurations via `requires-` tags. This results in an action\n+# conflict when precompiling. Disable to avoid that problem.\n+# See https://github.com/bazel-contrib/rules_python/issues/2445\n+build --@rules_python//python/config_settings:precompile=force_disabled\n \n # Do not do this. If enabled protobuf's core internal target \n # @com_google_protobuf//python:protobuf_python will start depending on a bunch"
        },
        {
            "sha": "3b80e2d6543ccdf1fc1bd083fdf9c4d53d600380",
            "filename": "ci/official/requirements_updater/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/ci%2Fofficial%2Frequirements_updater%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/ci%2Fofficial%2Frequirements_updater%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/ci%2Fofficial%2Frequirements_updater%2FBUILD.bazel?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -13,8 +13,8 @@\n # limitations under the License.\n # ==============================================================================\n \n-load(\"@python//:defs.bzl\", \"compile_pip_requirements\")\n load(\"@python_version_repo//:py_version.bzl\", \"REQUIREMENTS\")\n+load(\"@rules_python//python:pip.bzl\", \"compile_pip_requirements\")\n \n # TODO(ybaturina): Remove once TF is migrated to CUDA 12.9.\n genrule("
        },
        {
            "sha": "f000821983b77912758c73c6ccfeaeb80544623e",
            "filename": "tensorflow/BUILD",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -3,6 +3,13 @@\n # learning applications.\n \n load(\"@rules_cc//cc:cc_import.bzl\", \"cc_import\")\n+\n+# buildifier: disable=out-of-order-load\n+# copybara:comment_begin(oss-only)\n+load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\")\n+\n+# copybara:comment_end\n+# buildifier: enable=out-of-order-load\n load(\"@bazel_skylib//lib:selects.bzl\", \"selects\")\n load(\"@bazel_skylib//rules:common_settings.bzl\", \"bool_flag\", \"bool_setting\")\n load(\"@local_config_cuda//cuda:build_defs.bzl\", \"if_cuda\")\n@@ -1695,7 +1702,7 @@ generate_apis(\n     visibility = [\"//visibility:public\"],\n )\n \n-py_library(\n+py_strict_library(\n     name = \"tensorflow_py\",\n     srcs_version = \"PY3\",\n     visibility = [\"//visibility:public\"],\n@@ -1707,7 +1714,7 @@ py_library(\n     ],\n )\n \n-py_library(\n+py_strict_library(\n     name = \"tensorflow_py_no_contrib\",\n     srcs = select({\n         \"api_version_2\": [\":tf_python_api_gen_v2\"],"
        },
        {
            "sha": "7f200aa186a466802de92bff3ccf1054831ed07a",
            "filename": "tensorflow/compiler/mlir/lite/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Flite%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Flite%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Flite%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -2,8 +2,7 @@ load(\"@bazel_skylib//lib:selects.bzl\", \"selects\")\n load(\"@bazel_skylib//rules:build_test.bzl\", \"build_test\")\n load(\"@bazel_skylib//rules:common_settings.bzl\", \"bool_flag\")\n load(\"@llvm-project//mlir:tblgen.bzl\", \"gentbl_cc_library\", \"td_library\")\n-\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:tensorflow.bzl\", \"if_google\", \"if_oss\", \"tf_cc_binary\", \"tf_cc_test\", \"tf_native_cc_binary\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"filegroup\", \"get_compatible_with_portable\")\n load(\"//tensorflow/compiler/mlir/lite:build_def.bzl\", \"tflite_copts_warnings\")"
        },
        {
            "sha": "318b2987ba7708925a400e5d7c180cf08a6affc7",
            "filename": "tensorflow/compiler/mlir/lite/metrics/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Flite%2Fmetrics%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Flite%2Fmetrics%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Flite%2Fmetrics%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,4 +1,4 @@\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:tensorflow.bzl\", \"tf_cc_test\")\n load(\n     \"//tensorflow/core/platform:build_config.bzl\","
        },
        {
            "sha": "5c0de51a4f059a761e61f7f597756de8f68d8ebd",
            "filename": "tensorflow/compiler/mlir/quantization/stablehlo/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Fstablehlo%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Fstablehlo%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Fstablehlo%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,7 +1,6 @@\n load(\"@llvm-project//mlir:tblgen.bzl\", \"gentbl_cc_library\", \"td_library\")\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n-\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:tensorflow.bzl\", \"tf_cc_binary\", \"tf_cc_test\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"get_compatible_with_portable\")\n load(\"//tensorflow/compiler/mlir/quantization/stablehlo:internal_visibility_allowlist.bzl\", \"internal_visibility_allowlist\")"
        },
        {
            "sha": "1994f31be8433f30f8e9fc597fd07da29a37838c",
            "filename": "tensorflow/compiler/mlir/quantization/tensorflow/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,8 +1,7 @@\n load(\"@llvm-project//mlir:tblgen.bzl\", \"gentbl_cc_library\", \"td_library\")\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_binary\")\n-\n-# Placeholder: load py_proto_library\n load(\"//tensorflow:tensorflow.bzl\", \"tf_cc_binary\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"get_compatible_with_portable\")\n load(\"//tensorflow/compiler/mlir/quantization/tensorflow:internal_visibility_allowlist.bzl\", \"internal_visibility_allowlist\")"
        },
        {
            "sha": "4d6f366f97650455b6167b20f2b6bb094aff5ab9",
            "filename": "tensorflow/compiler/mlir/quantization/tensorflow/calibrator/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcalibrator%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcalibrator%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcalibrator%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,8 +1,7 @@\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:pytype.default.bzl\", \"pytype_strict_contrib_test\", \"pytype_strict_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"tf_cc_test\","
        },
        {
            "sha": "d818c373b7a8ce8729913244ddb8cad5155c001c",
            "filename": "tensorflow/compiler/tf2tensorrt/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Ftf2tensorrt%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcompiler%2Ftf2tensorrt%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2tensorrt%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -8,9 +8,8 @@ load(\n     \"@local_xla//xla/tsl/platform/default:cuda_build_defs.bzl\",\n     \"cuda_rpath_flags\",\n )\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"VERSION\","
        },
        {
            "sha": "3fa7271936d7aca24ecb9d2b09ea21e7c9bf63ff",
            "filename": "tensorflow/core/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -62,14 +62,13 @@\n # build targets.\n \n load(\"@com_google_protobuf//bazel:java_proto_library.bzl\", \"java_proto_library\")\n-\n-# Placeholder: load py_proto_library\n load(\"@local_config_cuda//cuda:build_defs.bzl\", \"if_cuda\")\n load(\"@local_config_tensorrt//:build_defs.bzl\", \"if_tensorrt\")\n load(\n     \"@local_xla//xla/tsl/mkl:build_defs.bzl\",\n     \"if_mkl\",\n )\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"if_android\","
        },
        {
            "sha": "2d5d3d60cb8f3b7334ae5f2f9ae766c824aa8319",
            "filename": "tensorflow/core/debug/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fdebug%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fdebug%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fdebug%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -12,7 +12,7 @@\n #    a watch state.\n # \":debug_node_key\" - Defines a struct used for tracking tensors.\n \n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"check_deps\","
        },
        {
            "sha": "2550ed00d7d9c2246ea4100fa0bd364921f2e0eb",
            "filename": "tensorflow/core/framework/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fframework%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fframework%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fframework%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,4 +1,4 @@\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"tf_cc_test\","
        },
        {
            "sha": "09935830c27692d47efce32aa8d36aefd393eb17",
            "filename": "tensorflow/core/function/polymorphism/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Ffunction%2Fpolymorphism%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Ffunction%2Fpolymorphism%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ffunction%2Fpolymorphism%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,7 +1,6 @@\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:pytype.default.bzl\", \"pytype_strict_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_test\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow/core/platform:build_config.bzl\",\n     \"tf_proto_library\","
        },
        {
            "sha": "45522e914a1ace1f580d3c0fc123efe45125a801",
            "filename": "tensorflow/core/function/trace_type/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Ffunction%2Ftrace_type%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Ffunction%2Ftrace_type%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ffunction%2Ftrace_type%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,7 +1,6 @@\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:pytype.default.bzl\", \"pytype_strict_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_test\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow/core/platform:build_config.bzl\",\n     \"tf_proto_library\","
        },
        {
            "sha": "964839d99aafde7bc28666aea2307a03244b52d5",
            "filename": "tensorflow/core/grappler/costs/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fgrappler%2Fcosts%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fgrappler%2Fcosts%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fgrappler%2Fcosts%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,4 +1,4 @@\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"tf_cc_test\","
        },
        {
            "sha": "ad838b5ec670e7afcd8a583b77a9de0c229484ff",
            "filename": "tensorflow/core/grappler/optimizers/inference/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fgrappler%2Foptimizers%2Finference%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fgrappler%2Foptimizers%2Finference%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fgrappler%2Foptimizers%2Finference%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,5 @@\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n-\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:tensorflow.bzl\", \"tf_cc_test\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_proto_library\")\n "
        },
        {
            "sha": "4e3158a1b151b36f55cb27c2e699e7a1c12e1581",
            "filename": "tensorflow/core/profiler/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fprofiler%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fprofiler%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fprofiler%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,5 +1,5 @@\n # copybara:uncomment(oss-unused) load(\"//net/grpc/go/build_defs:go_grpc_library.bzl\", \"go_grpc_library\")\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:tensorflow.bzl\", \"tf_cc_binary\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"filegroup\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_additional_all_protos\", \"tf_proto_library\")"
        },
        {
            "sha": "f1f6a8fa217a9f5f8be4b5a943760e9ca75d91d2",
            "filename": "tensorflow/core/profiler/protobuf/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fprofiler%2Fprotobuf%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fprofiler%2Fprotobuf%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fprofiler%2Fprotobuf%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,4 +1,4 @@\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_proto_library\")\n \n package("
        },
        {
            "sha": "b9b9ba12e7e265ab62e447a436cd719d5a1129bb",
            "filename": "tensorflow/core/protobuf/tpu/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fprotobuf%2Ftpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Fprotobuf%2Ftpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Fprotobuf%2Ftpu%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,4 +1,4 @@\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow/core/platform:build_config.bzl\",\n     \"tf_additional_all_protos\","
        },
        {
            "sha": "e91e68da7ee131cd44269609c62d3a6faa15744a",
            "filename": "tensorflow/core/tfrt/graph_executor/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Ftfrt%2Fgraph_executor%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Ftfrt%2Fgraph_executor%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftfrt%2Fgraph_executor%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,5 @@\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n-\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:tensorflow.bzl\", \"if_google\", \"tf_cc_shared_object\", \"tf_cc_test\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"get_compatible_with_portable\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_proto_library\")"
        },
        {
            "sha": "bc876406a86cb927de0c2ab4bba5f6f8f0eb8d28",
            "filename": "tensorflow/core/tpu/kernels/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Ftpu%2Fkernels%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Ftpu%2Fkernels%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Ftpu%2Fkernels%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,6 @@\n # TPU Kernel Implementations\n \n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"if_google\","
        },
        {
            "sha": "fff2305563c5f51192d0842ab0649e3c27309eb3",
            "filename": "tensorflow/core/util/autotune_maps/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Futil%2Fautotune_maps%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fcore%2Futil%2Fautotune_maps%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcore%2Futil%2Fautotune_maps%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -2,7 +2,7 @@\n # The autotuning results can be serialized as a string, allowing you to save\n # and later restore them.\n \n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"tf_cc_test\","
        },
        {
            "sha": "02bf7738d0cc7b294e3dd91a4642c33026af8681",
            "filename": "tensorflow/distribute/experimental/rpc/proto/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fdistribute%2Fexperimental%2Frpc%2Fproto%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fdistribute%2Fexperimental%2Frpc%2Fproto%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fdistribute%2Fexperimental%2Frpc%2Fproto%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,4 +1,4 @@\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow/core/platform:build_config.bzl\",\n     \"tf_additional_all_protos\","
        },
        {
            "sha": "fe98de39f9e75bcc8c41e09e14167e4c54be510b",
            "filename": "tensorflow/dtensor/proto/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fdtensor%2Fproto%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fdtensor%2Fproto%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fdtensor%2Fproto%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,4 +1,4 @@\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_proto_library\")\n \n package("
        },
        {
            "sha": "6c3cd95e4c8d44db7ff503951821b40d797cef36",
            "filename": "tensorflow/lite/profiling/proto/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Fprofiling%2Fproto%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Fprofiling%2Fproto%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Fprofiling%2Fproto%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,5 +1,5 @@\n-# Placeholder: load py_proto_library\n load(\"@com_google_protobuf//bazel:proto_library.bzl\", \"proto_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"get_compatible_with_portable\")\n load(\n     \"//tensorflow/core/platform:build_config.bzl\","
        },
        {
            "sha": "46d817cd0c065c840847e4f98f64e68b8d1cca22",
            "filename": "tensorflow/lite/toco/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftoco%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftoco%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Ftoco%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,5 @@\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n-\n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"tf_cc_binary\","
        },
        {
            "sha": "0c07aa5406dae57bc04760a7c24cf35af3a3c394",
            "filename": "tensorflow/lite/toco/logging/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftoco%2Flogging%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftoco%2Flogging%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Ftoco%2Flogging%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,7 +1,6 @@\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\", \"py_strict_test\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"tf_cc_test\","
        },
        {
            "sha": "2c7267bc4471c04228539a955170ea8aeb31739a",
            "filename": "tensorflow/lite/tools/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftools%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftools%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Ftools%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,9 +1,8 @@\n load(\"@rules_cc//cc:cc_binary.bzl\", \"cc_binary\")\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n load(\"@rules_cc//cc:cc_test.bzl\", \"cc_test\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_binary\", \"py_strict_library\", \"py_strict_test\")\n-\n-# Placeholder: load py_proto_library\n load(\"//tensorflow:tensorflow.bzl\", \"tf_cc_binary\", \"tf_cc_test\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"get_compatible_with_portable\")\n load("
        },
        {
            "sha": "4f5189de5bc39d2fbd8d062c236937486ea9f725",
            "filename": "tensorflow/lite/tools/benchmark/proto/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Ftools%2Fbenchmark%2Fproto%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,5 +1,5 @@\n-# Placeholder: load py_proto_library\n load(\"@com_google_protobuf//bazel:proto_library.bzl\", \"proto_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"get_compatible_with_portable\")\n load(\n     \"//tensorflow/core/platform:build_config.bzl\","
        },
        {
            "sha": "014d06b6b412638166c1560d5fae42d48307d728",
            "filename": "tensorflow/lite/tools/evaluation/proto/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftools%2Fevaluation%2Fproto%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Flite%2Ftools%2Fevaluation%2Fproto%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Flite%2Ftools%2Fevaluation%2Fproto%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -13,9 +13,9 @@\n # limitations under the License.\n # ==============================================================================\n \n-# Placeholder: load py_proto_library\n load(\"@com_google_protobuf//bazel:java_proto_library.bzl\", \"java_proto_library\")\n load(\"@com_google_protobuf//bazel:proto_library.bzl\", \"proto_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\n     \"//tensorflow/core/platform:build_config.bzl\",\n     \"tf_proto_library\","
        },
        {
            "sha": "84547ebf0b9b0ed8e364580f2e9821b16b5bbc36",
            "filename": "tensorflow/python/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -7,10 +7,9 @@ load(\n     \"if_cuda_is_configured\",\n )\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:pytype.default.bzl\", \"pytype_strict_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"VERSION\","
        },
        {
            "sha": "9c33877609340f2e908a1d3622afd1ec908d9b3c",
            "filename": "tensorflow/python/framework/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Fframework%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Fframework%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fframework%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,10 +1,9 @@\n # python/framework package\n \n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:pytype.default.bzl\", \"pytype_strict_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\", \"py_strict_test\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"if_cuda_tools\","
        },
        {
            "sha": "144509a4ad7c8abf751d394d0aebb2d06a5f0a41",
            "filename": "tensorflow/python/keras/protobuf/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Fkeras%2Fprotobuf%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Fkeras%2Fprotobuf%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fkeras%2Fprotobuf%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,7 +1,7 @@\n # Description:\n #   Contains Keras protobufs\n \n-# Placeholder: load py_proto_library\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_proto_library\")\n \n package("
        },
        {
            "sha": "f75bc6283cd5d5467071804be1dd6e688d6021e4",
            "filename": "tensorflow/python/kernel_tests/proto/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Fkernel_tests%2Fproto%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Fkernel_tests%2Fproto%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Fkernel_tests%2Fproto%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,8 +1,7 @@\n # Tests of tf.io.*proto.\n \n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\")\n-\n-# Placeholder: load py_proto_library\n load(\"//tensorflow:tensorflow.bzl\", \"if_oss\", \"tf_cc_shared_object\")\n load(\"//tensorflow:tensorflow.default.bzl\", \"stripped_cc_info\", \"tf_py_strict_test\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_additional_all_protos\", \"tf_proto_library\")"
        },
        {
            "sha": "e3a2a349d7415608d6eda2cc8d344716434f5105",
            "filename": "tensorflow/python/tools/api/generator2/generate_api.bzl",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Ftools%2Fapi%2Fgenerator2%2Fgenerate_api.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Ftools%2Fapi%2Fgenerator2%2Fgenerate_api.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Ftools%2Fapi%2Fgenerator2%2Fgenerate_api.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,7 +1,7 @@\n \"\"\"Rules to generate the TensorFlow public API from annotated files.\"\"\"\n \n-# Placeholder: load PyInfo\n load(\"@bazel_skylib//lib:paths.bzl\", \"paths\")\n+load(\"@rules_python//python:py_info.bzl\", \"PyInfo\")\n load(\"//tensorflow/python/tools/api/generator:api_init_files.bzl\", \"TENSORFLOW_API_INIT_FILES\")\n load(\":apis.bzl\", _APIS = \"APIS\")\n load(\":patterns.bzl\", \"any_match\")"
        },
        {
            "sha": "45c9470f88e93712af9b5c52831e1dfba4f4043e",
            "filename": "tensorflow/python/tpu/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Ftpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Ftpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Ftpu%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,10 +1,9 @@\n load(\"@bazel_skylib//:bzl_library.bzl\", \"bzl_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n \n # Description: Operations defined for Cloud TPUs\n load(\"//tensorflow:pytype.default.bzl\", \"pytype_strict_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\", \"py_strict_test\")\n-\n-# Placeholder: load py_proto_library\n load(\"//tensorflow:tensorflow.default.bzl\", \"tf_py_strict_test\", \"tf_python_pybind_extension\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_proto_library\")\n load(\"//tensorflow/core/platform:build_config_root.bzl\", \"if_pywrap\")"
        },
        {
            "sha": "9cb571525d39ff6f39df392c5dfa4e7b116d26bb",
            "filename": "tensorflow/python/training/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Ftraining%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Ftraining%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Ftraining%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,5 @@\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\")\n-\n-# Placeholder: load py_proto_library\n load(\"//tensorflow:tensorflow.default.bzl\", \"cuda_py_strict_test\", \"tf_py_strict_test\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_proto_library\")\n load(\"//tensorflow/core/platform:distribute.bzl\", \"distribute_py_strict_test\")"
        },
        {
            "sha": "db2217fbbb38a4644c95818dd2deb3b0974b6f3c",
            "filename": "tensorflow/python/util/protobuf/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Futil%2Fprotobuf%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fpython%2Futil%2Fprotobuf%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fpython%2Futil%2Fprotobuf%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,8 +1,7 @@\n # Tensorflow protobuf utility package\n \n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\")\n-\n-# Placeholder: load py_proto_library\n load(\"//tensorflow:tensorflow.default.bzl\", \"get_compatible_with_portable\", \"tf_py_strict_test\")\n load(\"//tensorflow/core/platform:build_config.bzl\", \"tf_proto_library\")  # @unused\n "
        },
        {
            "sha": "8b7d21d99772534ac63e4e0264223b20d121657b",
            "filename": "tensorflow/tools/api/lib/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Ftools%2Fapi%2Flib%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Ftools%2Fapi%2Flib%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Ftools%2Fapi%2Flib%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,8 +1,7 @@\n # Helper libraries for TensorFlow API compatibility test.\n \n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_library\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow/core/platform:build_config.bzl\",\n     \"tf_proto_library\","
        },
        {
            "sha": "924c43f6afc3f2014ffc91f27ba76a54a4fd03e4",
            "filename": "tensorflow/tools/pip_package/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Ftools%2Fpip_package%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Ftools%2Fpip_package%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Ftools%2Fpip_package%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -15,6 +15,7 @@ load(\n load(\"@local_xla//third_party/py:python_wheel.bzl\", \"collect_data_files\", \"transitive_py_deps\")\n load(\"@local_xla//xla/tsl/mkl:build_defs.bzl\", \"if_enable_mkl\", \"if_mkl\", \"if_mkl_ml\")\n load(\"@nvidia_wheel_versions//:versions.bzl\", \"NVIDIA_WHEEL_VERSIONS\")\n+load(\"//tensorflow:py.default.bzl\", \"py_binary\", \"py_test\")\n load(\"//tensorflow:tensorflow.bzl\", \"if_wheel_dependency\", \"if_with_tpu_support\", \"transitive_hdrs\")\n load(\"//tensorflow:tf_version.bzl\", \"TF_SEMANTIC_VERSION_SUFFIX\", \"TF_VERSION\")\n load("
        },
        {
            "sha": "5d0cb5ae7a636f93b68816aa2ff9015c3c3bc112",
            "filename": "tensorflow/tools/proto_splitter/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Ftools%2Fproto_splitter%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Ftools%2Fproto_splitter%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Ftools%2Fproto_splitter%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -2,10 +2,9 @@\n #   Utilities for splitting and joining large protos > 2GB.\n \n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:pytype.default.bzl\", \"pytype_strict_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_test\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow:tensorflow.bzl\",\n     \"if_oss\","
        },
        {
            "sha": "3823c2d8b77dbba01b58fb8b8d1549ffd1e96aa5",
            "filename": "tensorflow/tools/proto_splitter/testdata/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Ftools%2Fproto_splitter%2Ftestdata%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Ftools%2Fproto_splitter%2Ftestdata%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Ftools%2Fproto_splitter%2Ftestdata%2FBUILD?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,5 @@\n+load(\"@rules_python//python:proto.bzl\", \"py_proto_library\")\n load(\"//tensorflow:strict.default.bzl\", \"py_strict_binary\")\n-\n-# Placeholder: load py_proto_library\n load(\n     \"//tensorflow/core/platform:build_config.bzl\",\n     \"tf_proto_library\","
        },
        {
            "sha": "d8452045b664ad7ed910376be43cdace1854a99b",
            "filename": "tensorflow/workspace2.bzl",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fworkspace2.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/tensorflow%2Fworkspace2.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fworkspace2.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -3,6 +3,7 @@\n load(\"@bazel_features//:deps.bzl\", \"bazel_features_deps\")\n load(\"@bazel_skylib//lib:versions.bzl\", \"versions\")\n load(\"@bazel_tools//tools/build_defs/repo:java.bzl\", \"java_import_external\")\n+load(\"@bazel_tools//tools/build_defs/repo:utils.bzl\", \"maybe\")\n load(\"@local_xla//third_party/absl:workspace.bzl\", absl = \"repo\")\n load(\"@local_xla//third_party/benchmark:workspace.bzl\", benchmark = \"repo\")\n load(\"@local_xla//third_party/clang_toolchain:cc_configure_clang.bzl\", \"cc_download_clang_toolchain\")\n@@ -391,7 +392,8 @@ def _tf_repositories():\n         urls = tf_mirror_urls(\"https://github.com/abseil/abseil-py/archive/refs/tags/v2.1.0.tar.gz\"),\n     )\n \n-    tf_http_archive(\n+    maybe(\n+        tf_http_archive,\n         name = \"com_google_protobuf\",\n         patch_file = [\"@local_xla//third_party/protobuf:protobuf.patch\"],\n         sha256 = \"6e09bbc950ba60c3a7b30280210cd285af8d7d8ed5e0a6ed101c72aff22e8d88\","
        },
        {
            "sha": "9597930e710dbf1edd3e9916f03c548cd8052794",
            "filename": "third_party/py/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2FBUILD.bazel?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,6 @@\n load(\"@bazel_skylib//rules:common_settings.bzl\", \"bool_flag\")\n-load(\"@python//:defs.bzl\", \"compile_pip_requirements\")\n load(\"@python_version_repo//:py_version.bzl\", \"REQUIREMENTS\")\n+load(\"@rules_python//python:pip.bzl\", \"compile_pip_requirements\")\n \n compile_pip_requirements(\n     name = \"requirements\","
        },
        {
            "sha": "be0c6091d92c6ad8d0c8920a4d730e9487a0aa9c",
            "filename": "third_party/py/BUILD.tpl",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2FBUILD.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2FBUILD.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2FBUILD.tpl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -5,17 +5,16 @@ package(default_visibility = [\"//visibility:public\"])\n # Point both runtimes to the same python binary to ensure we always\n # use the python binary specified by ./configure.py script.\n load(\"@bazel_tools//tools/python:toolchain.bzl\", \"py_runtime_pair\")\n-load(\"@python//:defs.bzl\", \"interpreter\")\n \n py_runtime(\n     name = \"py2_runtime\",\n-    interpreter_path = interpreter,\n+    interpreter = \"%{PYTHON_INTERPRETER}\",\n     python_version = \"PY2\",\n )\n \n py_runtime(\n     name = \"py3_runtime\",\n-    interpreter_path = interpreter,\n+    interpreter = \"%{PYTHON_INTERPRETER}\",\n     python_version = \"PY3\",\n )\n \n@@ -34,7 +33,7 @@ toolchain(\n )\n \n alias(name = \"python_headers\",\n-      actual = \"@python//:python_headers\")\n+      actual = \"@rules_python//python/cc:current_py_cc_headers\")\n \n # This alias is exists for the use of targets in the @llvm-project dependency,\n # which expect a python_headers target called @python_runtime//:headers. We use"
        },
        {
            "sha": "18f238c015151d0a0bc101f64d823c0c02332f75",
            "filename": "third_party/py/python_configure.bzl",
            "status": "modified",
            "additions": 20,
            "deletions": 5,
            "changes": 25,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Fpython_configure.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Fpython_configure.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Fpython_configure.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -7,18 +7,27 @@ load(\n     \"PYTHON_BIN_PATH\",\n     \"PYTHON_LIB_PATH\",\n )\n+load(\"//third_party/py:python_init_toolchains.bzl\", \"get_toolchain_name_per_python_version\")\n+\n+def _get_python_interpreter():\n+    return \"@{}_host//:python\".format(\n+        get_toolchain_name_per_python_version(\"python\"),\n+    )\n \n def _create_local_python_repository(repository_ctx):\n     \"\"\"Creates the repository containing files set up to build with Python.\"\"\"\n \n-    # Resolve all labels before doing any real work. Resolving causes the\n-    # function to be restarted with all previous state being lost. This\n-    # can easily lead to a O(n^2) runtime in the number of labels.\n-    build_tpl = repository_ctx.path(Label(\"//third_party/py:BUILD.tpl\"))\n     platform_constraint = \"\"\n     if repository_ctx.attr.platform_constraint:\n         platform_constraint = \"\\\"%s\\\"\" % repository_ctx.attr.platform_constraint\n-    repository_ctx.template(\"BUILD\", build_tpl, {\"%{PLATFORM_CONSTRAINT}\": platform_constraint})\n+    repository_ctx.template(\n+        \"BUILD\",\n+        repository_ctx.attr.build_tpl,\n+        {\n+            \"%{PLATFORM_CONSTRAINT}\": platform_constraint,\n+            \"%{PYTHON_INTERPRETER}\": repository_ctx.attr.python_interpreter,\n+        },\n+    )\n \n def _python_autoconf_impl(repository_ctx):\n     \"\"\"Implementation of the python_autoconf repository rule.\"\"\"\n@@ -35,6 +44,8 @@ local_python_configure = repository_rule(\n     attrs = {\n         \"environ\": attr.string_dict(),\n         \"platform_constraint\": attr.string(),\n+        \"build_tpl\": attr.label(default = Label(\"//third_party/py:BUILD.tpl\")),\n+        \"python_interpreter\": attr.string(default = _get_python_interpreter()),\n     },\n )\n \n@@ -45,13 +56,17 @@ remote_python_configure = repository_rule(\n     attrs = {\n         \"environ\": attr.string_dict(),\n         \"platform_constraint\": attr.string(),\n+        \"build_tpl\": attr.label(default = Label(\"//third_party/py:BUILD.tpl\")),\n+        \"python_interpreter\": attr.string(default = _get_python_interpreter()),\n     },\n )\n \n python_configure = repository_rule(\n     implementation = _python_autoconf_impl,\n     attrs = {\n         \"platform_constraint\": attr.string(),\n+        \"build_tpl\": attr.label(default = Label(\"//third_party/py:BUILD.tpl\")),\n+        \"python_interpreter\": attr.string(default = _get_python_interpreter()),\n     },\n )\n \"\"\"Detects and configures the local Python."
        },
        {
            "sha": "c75db81be75b94bee449ce80bc6e3dfee1dde27f",
            "filename": "third_party/py/python_init_pip.bzl",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Fpython_init_pip.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Fpython_init_pip.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Fpython_init_pip.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,8 +1,11 @@\n \"\"\"Hermetic Python initialization. Consult the WORKSPACE on how to use it.\"\"\"\n \n-load(\"@python//:defs.bzl\", \"interpreter\")\n load(\"@python_version_repo//:py_version.bzl\", \"REQUIREMENTS_WITH_LOCAL_WHEELS\")\n load(\"@rules_python//python:pip.bzl\", \"package_annotation\", \"pip_parse\")\n+load(\n+    \"//third_party/py:python_init_toolchains.bzl\",\n+    \"get_toolchain_name_per_python_version\",\n+)\n \n def python_init_pip():\n     numpy_annotations = {\n@@ -29,6 +32,8 @@ cc_library(\n     pip_parse(\n         name = \"pypi\",\n         annotations = numpy_annotations,\n-        python_interpreter_target = interpreter,\n+        python_interpreter_target = \"@{}_host//:python\".format(\n+            get_toolchain_name_per_python_version(\"python\"),\n+        ),\n         requirements_lock = REQUIREMENTS_WITH_LOCAL_WHEELS,\n     )"
        },
        {
            "sha": "670b4807764e9a0e733f2b40d9c6445504ed7a8f",
            "filename": "third_party/py/python_init_rules.bzl",
            "status": "modified",
            "additions": 30,
            "deletions": 6,
            "changes": 36,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Fpython_init_rules.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Fpython_init_rules.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Fpython_init_rules.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,7 @@\n \"\"\"Hermetic Python initialization. Consult the WORKSPACE on how to use it.\"\"\"\n \n load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n \n def python_init_rules(extra_patches = []):\n     \"\"\"Defines (doesn't setup) the rules_python repository.\n@@ -9,15 +10,38 @@ def python_init_rules(extra_patches = []):\n       extra_patches: list of labels. Additional patches to apply after the default\n         set of patches.\n     \"\"\"\n+\n+    http_archive(\n+        name = \"rules_cc\",\n+        urls = [\"https://github.com/bazelbuild/rules_cc/archive/refs/tags/0.1.0.tar.gz\"],\n+        strip_prefix = \"rules_cc-0.1.0\",\n+        sha256 = \"4b12149a041ddfb8306a8fd0e904e39d673552ce82e4296e96fac9cbf0780e59\",\n+        patches = [\n+            Label(\"//third_party/py:rules_cc_protobuf.patch\"),\n+        ],\n+        patch_args = [\"-p1\"],\n+    )\n+\n+    tf_http_archive(\n+        name = \"com_google_protobuf\",\n+        patch_file = [\"//third_party/protobuf:protobuf.patch\"],\n+        sha256 = \"6e09bbc950ba60c3a7b30280210cd285af8d7d8ed5e0a6ed101c72aff22e8d88\",\n+        strip_prefix = \"protobuf-6.31.1\",\n+        urls = tf_mirror_urls(\"https://github.com/protocolbuffers/protobuf/archive/refs/tags/v6.31.1.zip\"),\n+        repo_mapping = {\n+            \"@abseil-cpp\": \"@com_google_absl\",\n+            \"@protobuf_pip_deps\": \"@pypi\",\n+        },\n+    )\n+\n     http_archive(\n         name = \"rules_python\",\n-        sha256 = \"62ddebb766b4d6ddf1712f753dac5740bea072646f630eb9982caa09ad8a7687\",\n-        strip_prefix = \"rules_python-0.39.0\",\n-        url = \"https://github.com/bazelbuild/rules_python/releases/download/0.39.0/rules_python-0.39.0.tar.gz\",\n+        sha256 = \"fa7dd2c6b7d63b3585028dd8a90a6cf9db83c33b250959c2ee7b583a6c130e12\",\n+        strip_prefix = \"rules_python-1.6.0\",\n+        url = \"https://github.com/bazelbuild/rules_python/releases/download/1.6.0/rules_python-1.6.0.tar.gz\",\n         patch_args = [\"-p1\"],\n         patches = [\n-            Label(\"//third_party/py:rules_python1.patch\"),\n-            Label(\"//third_party/py:rules_python2.patch\"),\n-            Label(\"//third_party/py:rules_python3.patch\"),\n+            Label(\"//third_party/py:rules_python_pip_version.patch\"),\n+            Label(\"//third_party/py:rules_python_freethreaded.patch\"),\n         ] + extra_patches,\n     )"
        },
        {
            "sha": "9f549850a7dafca373e02580f7e02d085862d2fb",
            "filename": "third_party/py/python_init_toolchains.bzl",
            "status": "modified",
            "additions": 10,
            "deletions": 6,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Fpython_init_toolchains.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Fpython_init_toolchains.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Fpython_init_toolchains.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -6,16 +6,21 @@ load(\n     \"HERMETIC_PYTHON_SHA256\",\n     \"HERMETIC_PYTHON_URL\",\n     \"HERMETIC_PYTHON_VERSION\",\n-    \"HERMETIC_PYTHON_VERSION_KIND\",\n )\n load(\"@rules_python//python:repositories.bzl\", \"python_register_toolchains\")\n load(\"@rules_python//python:versions.bzl\", \"MINOR_MAPPING\", \"PLATFORMS\")\n \n+def get_toolchain_name_per_python_version(name):\n+    return \"{name}_{version}\".format(\n+        name = name,\n+        version = HERMETIC_PYTHON_VERSION.replace(\".\", \"_\"),\n+    )\n+\n def python_init_toolchains(name = \"python\", python_version = None, **kwargs):\n     \"\"\"Register hermetic python toolchains.\n \n     Args:\n-        name: name of the toolchain, \"python\" by default (it is strongly\n+        name: prefix of the toolchain, \"python\" by default (it is strongly\n           recommended to rely on the default).\n         python_version: version of the python to register; if set it will bypass\n           kwargs to underlying python_register_toolchains as is (manual\n@@ -27,7 +32,7 @@ def python_init_toolchains(name = \"python\", python_version = None, **kwargs):\n \n     if python_version:\n         python_register_toolchains(\n-            name = name,\n+            name = get_toolchain_name_per_python_version(name),\n             python_version = python_version,\n             **kwargs\n         )\n@@ -44,7 +49,7 @@ def python_init_toolchains(name = \"python\", python_version = None, **kwargs):\n                 sha256s[platform] = HERMETIC_PYTHON_SHA256\n \n         python_register_toolchains(\n-            name = name,\n+            name = get_toolchain_name_per_python_version(name),\n             base_url = url_components[0] + \"://\",\n             ignore_root_user_error = True,\n             python_version = tool_version,\n@@ -59,8 +64,7 @@ def python_init_toolchains(name = \"python\", python_version = None, **kwargs):\n         )\n     elif HERMETIC_PYTHON_VERSION in MINOR_MAPPING:\n         python_register_toolchains(\n-            name = name,\n+            name = get_toolchain_name_per_python_version(name),\n             ignore_root_user_error = True,\n             python_version = HERMETIC_PYTHON_VERSION,\n-            python_version_kind = HERMETIC_PYTHON_VERSION_KIND,\n         )"
        },
        {
            "sha": "95c4d447c49c97c97f2b8932a10bfad93f46eb80",
            "filename": "third_party/py/rules_cc_protobuf.patch",
            "status": "added",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Frules_cc_protobuf.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Frules_cc_protobuf.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Frules_cc_protobuf.patch?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -0,0 +1,16 @@\n+diff --git a/cc/defs.bzl b/cc/defs.bzl\n+index 3448e77..9c298ab 100644\n+--- a/cc/defs.bzl\n++++ b/cc/defs.bzl\n+@@ -30,9 +30,11 @@ load(\"//cc/toolchains:cc_toolchain_suite.bzl\", _cc_toolchain_suite = \"cc_toolcha\n+ load(\"//cc/toolchains:compiler_flag.bzl\", _compiler_flag = \"compiler_flag\")\n+ load(\"//cc/toolchains:fdo_prefetch_hints.bzl\", _fdo_prefetch_hints = \"fdo_prefetch_hints\")\n+ load(\"//cc/toolchains:fdo_profile.bzl\", _fdo_profile = \"fdo_profile\")\n++load(\"@com_google_protobuf//bazel:cc_proto_library.bzl\", _protobuf_cc_proto_library = \"cc_proto_library\")\n+ \n+ # Rules\n+ \n++cc_proto_library = _protobuf_cc_proto_library\n+ cc_library = _cc_library\n+ cc_binary = _cc_binary\n+ cc_test = _cc_test\n\\ No newline at end of file"
        },
        {
            "sha": "aab0c23d4d22dbef0d81548da8f580018e64550d",
            "filename": "third_party/py/rules_python1.patch",
            "status": "removed",
            "additions": 0,
            "deletions": 93,
            "changes": 93,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fpy%2Frules_python1.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fpy%2Frules_python1.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Frules_python1.patch?ref=06352207355a1a70a713b6d142d39bcf1857d832",
            "patch": "@@ -1,93 +0,0 @@\n-diff --git a/python/private/pypi/deps.bzl b/python/private/pypi/deps.bzl\n-index 8949ed4a..8d0ab0e7 100644\n---- a/python/private/pypi/deps.bzl\n-+++ b/python/private/pypi/deps.bzl\n-@@ -51,8 +51,8 @@ _RULE_DEPS = [\n-     ),\n-     (\n-         \"pypi__packaging\",\n--        \"https://files.pythonhosted.org/packages/49/df/1fceb2f8900f8639e278b056416d49134fb8d84c5942ffaa01ad34782422/packaging-24.0-py3-none-any.whl\",\n--        \"2ddfb553fdf02fb784c234c7ba6ccc288296ceabec964ad2eae3777778130bc5\",\n-+        \"https://files.pythonhosted.org/packages/88/ef/eb23f262cca3c0c4eb7ab1933c3b1f03d021f2c48f54763065b6f0e321be/packaging-24.2-py3-none-any.whl\",\n-+        \"09abb1bccd265c01f4a3aa3f7a7db064b36514d2cba19a2f694fe6150451a759\",\n-     ),\n-     (\n-         \"pypi__pep517\",\n-@@ -61,8 +61,8 @@ _RULE_DEPS = [\n-     ),\n-     (\n-         \"pypi__pip\",\n--        \"https://files.pythonhosted.org/packages/8a/6a/19e9fe04fca059ccf770861c7d5721ab4c2aebc539889e97c7977528a53b/pip-24.0-py3-none-any.whl\",\n--        \"ba0d021a166865d2265246961bec0152ff124de910c5cc39f1156ce3fa7c69dc\",\n-+        \"https://files.pythonhosted.org/packages/ef/7d/500c9ad20238fcfcb4cb9243eede163594d7020ce87bd9610c9e02771876/pip-24.3.1-py3-none-any.whl\",\n-+        \"3790624780082365f47549d032f3770eeb2b1e8bd1f7b2e02dace1afa361b4ed\",\n-     ),\n-     (\n-         \"pypi__pip_tools\",\n-diff --git a/python/private/pypi/evaluate_markers.bzl b/python/private/pypi/evaluate_markers.bzl\n-index c805fd7a..e57e6138 100644\n---- a/python/private/pypi/evaluate_markers.bzl\n-+++ b/python/private/pypi/evaluate_markers.bzl\n-@@ -20,7 +20,7 @@ load(\":pypi_repo_utils.bzl\", \"pypi_repo_utils\")\n- SRCS = [\n-     # When the version, or any of the files in `packaging` package changes,\n-     # this file will change as well.\n--    Label(\"@pypi__packaging//:packaging-24.0.dist-info/RECORD\"),\n-+    Label(\"@pypi__packaging//:packaging-24.2.dist-info/RECORD\"),\n-     Label(\"//python/private/pypi/requirements_parser:resolve_target_platforms.py\"),\n-     Label(\"//python/private/pypi/whl_installer:platform.py\"),\n- ]\n-diff --git a/python/versions.bzl b/python/versions.bzl\n-index 774c24d1..91e59f9b 100644\n---- a/python/versions.bzl\n-+++ b/python/versions.bzl\n-@@ -561,6 +561,20 @@ TOOL_VERSIONS = {\n-         },\n-         \"strip_prefix\": \"python\",\n-     },\n-+    \"3.12.8\": {\n-+        \"url\": \"20241206/cpython-{python_version}+20241206-{platform}-{build}.tar.gz\",\n-+        \"sha256\": {\n-+            \"aarch64-apple-darwin\": \"e3c4aa607717b23903ca2650d5c3ee24f89b97543e2db2b0f463bddc7a9e92f3\",\n-+            \"aarch64-unknown-linux-gnu\": \"ce674b55442b732973afb2932c281bb1ded4ad7e22bcf9b07071165770758c7e\",\n-+            \"ppc64le-unknown-linux-gnu\": \"b7214790b273de9ed0532420054b72ba1393d62d2fc844ec55ade193771bd90c\",\n-+            \"s390x-unknown-linux-gnu\": \"73102f5dbd7d1e7e9c2f2c80aedf2893d99a7fa407f6674ec8b2f57ba07daee5\",\n-+            \"x86_64-apple-darwin\": \"3ba35c706577d755e8e52a4c161a042464577c0e695e2a605362fa469e26de10\",\n-+            \"x86_64-pc-windows-msvc\": \"767b4be3ddf6b99e5ade519789c1615c191d8cf99d5aff4685cc18b48931f1e6\",\n-+            \"x86_64-unknown-linux-gnu\": \"b9d6ee5ddac1198e72d53112698773fc8bb597de095592eb849ca794306699ba\",\n-+            \"x86_64-unknown-linux-musl\": \"6f305888703691dd04cfff85284d23ea0b0146ed7c4415e472f1fb72b3f32cdf\",\n-+        },\n-+        \"strip_prefix\": \"python\",\n-+    },\n-     \"3.13.0\": {\n-         \"url\": \"20241016/cpython-{python_version}+20241016-{platform}-{build}.{ext}\",\n-         \"sha256\": {\n-@@ -589,7 +603,7 @@ MINOR_MAPPING = {\n-     \"3.9\": \"3.9.20\",\n-     \"3.10\": \"3.10.15\",\n-     \"3.11\": \"3.11.10\",\n--    \"3.12\": \"3.12.7\",\n-+    \"3.12\": \"3.12.8\",\n-     \"3.13\": \"3.13.0\",\n- }\n-\n-diff --git a/python/private/python_bootstrap_template.txt b/python/private/python_bootstrap_template.txt\n-index 0f9c90b3..567bdc88 100644\n---- a/python/private/python_bootstrap_template.txt\n-+++ b/python/private/python_bootstrap_template.txt\n-@@ -52,7 +52,14 @@ def GetWindowsPathWithUNCPrefix(path):\n-   # removed from common Win32 file and directory functions.\n-   # Related doc: https://docs.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=cmd#enable-long-paths-in-windows-10-version-1607-and-later\n-   import platform\n--  if platform.win32_ver()[1] >= '10.0.14393':\n-+  version = None\n-+  # The try-except block is needed to fix the flakiness of RBE tests\n-+  # on Windows 2022 using hermetic python 3.12.8.\n-+  try:\n-+    version = platform.win32_ver()[1]\n-+  except (ValueError, KeyError):\n-+    version = platform.win32_ver()[1]\n-+  if version and version >= '10.0.14393':\n-     return path\n-\n-   # import sysconfig only now to maintain python 2.6 compatibility"
        },
        {
            "sha": "6b36379d208cccc659025935780e2c1d35ac7339",
            "filename": "third_party/py/rules_python2.patch",
            "status": "removed",
            "additions": 0,
            "deletions": 150,
            "changes": 150,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fpy%2Frules_python2.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fpy%2Frules_python2.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Frules_python2.patch?ref=06352207355a1a70a713b6d142d39bcf1857d832",
            "patch": "@@ -1,150 +0,0 @@\n-diff --git a/python/versions.bzl b/python/versions.bzl\n-index 91e59f9b..d72855db 100644\n---- a/python/versions.bzl\n-+++ b/python/versions.bzl\n-@@ -21,7 +21,7 @@ LINUX_NAME = \"linux\"\n- WINDOWS_NAME = \"windows\"\n- FREETHREADED = \"freethreaded\"\n- \n--DEFAULT_RELEASE_BASE_URL = \"https://github.com/indygreg/python-build-standalone/releases/download\"\n-+DEFAULT_RELEASE_BASE_URL = \"https://github.com/astral-sh/python-build-standalone/releases/download\"\n- \n- # When updating the versions and releases, run the following command to get\n- # the hashes:\n-@@ -575,25 +575,81 @@ TOOL_VERSIONS = {\n-         },\n-         \"strip_prefix\": \"python\",\n-     },\n--    \"3.13.0\": {\n--        \"url\": \"20241016/cpython-{python_version}+20241016-{platform}-{build}.{ext}\",\n--        \"sha256\": {\n--            \"aarch64-apple-darwin\": \"31397953849d275aa2506580f3fa1cb5a85b6a3d392e495f8030e8b6412f5556\",\n--            \"aarch64-unknown-linux-gnu\": \"e8378c0162b2e0e4cc1f62b29443a3305d116d09583304dbb0149fecaff6347b\",\n--            \"ppc64le-unknown-linux-gnu\": \"fc4b7f27c4e84c78f3c8e6c7f8e4023e4638d11f1b36b6b5ce457b1926cebb53\",\n--            \"s390x-unknown-linux-gnu\": \"66b19e6a07717f6cfcd3a8ca953f0a2eaa232291142f3d26a8d17c979ec0f467\",\n--            \"x86_64-apple-darwin\": \"cff1b7e7cd26f2d47acac1ad6590e27d29829776f77e8afa067e9419f2f6ce77\",\n--            \"x86_64-pc-windows-msvc\": \"b25926e8ce4164cf103bacc4f4d154894ea53e07dd3fdd5ebb16fb1a82a7b1a0\",\n--            \"x86_64-unknown-linux-gnu\": \"2c8cb15c6a2caadaa98af51df6fe78a8155b8471cb3dd7b9836038e0d3657fb4\",\n--            \"aarch64-apple-darwin-freethreaded\": \"efc2e71c0e05bc5bedb7a846e05f28dd26491b1744ded35ed82f8b49ccfa684b\",\n--            \"aarch64-unknown-linux-gnu-freethreaded\": \"59b50df9826475d24bb7eff781fa3949112b5e9c92adb29e96a09cdf1216d5bd\",\n--            \"ppc64le-unknown-linux-gnu-freethreaded\": \"1217efa5f4ce67fcc9f7eb64165b1bd0912b2a21bc25c1a7e2cb174a21a5df7e\",\n--            \"s390x-unknown-linux-gnu-freethreaded\": \"6c3e1e4f19d2b018b65a7e3ef4cd4225c5b9adfbc490218628466e636d5c4b8c\",\n--            \"x86_64-apple-darwin-freethreaded\": \"2e07dfea62fe2215738551a179c87dbed1cc79d1b3654f4d7559889a6d5ce4eb\",\n--            \"x86_64-pc-windows-msvc-freethreaded\": \"bfd89f9acf866463bc4baf01733da5e767d13f5d0112175a4f57ba91f1541310\",\n--            \"x86_64-unknown-linux-gnu-freethreaded\": \"a73adeda301ad843cce05f31a2d3e76222b656984535a7b87696a24a098b216c\",\n-+    \"3.13.2\": {\n-+        \"url\": \"20250317/cpython-{python_version}+20250317-{platform}-{build}.{ext}\",\n-+        \"sha256\": {\n-+            \"aarch64-apple-darwin\": \"faa44274a331eb39786362818b21b3a4e74514e8805000b20b0e55c590cecb94\",\n-+            \"aarch64-unknown-linux-gnu\": \"9c67260446fee6ea706dad577a0b32936c63f449c25d66e4383d5846b2ab2e36\",\n-+            \"ppc64le-unknown-linux-gnu\": \"345b53d2f86c9dbd7f1320657cb227ff9a42ef63ff21f129abbbc8c82a375147\",\n-+            \"s390x-unknown-linux-gnu\": \"ec3b16ea8a97e3138acec72bc5ff35949950c62c8994a8ec8e213fd93f0e806b\",\n-+            \"x86_64-apple-darwin\": \"ee4526e84b5ce5b11141c50060b385320f2773616249a741f90c96d460ce8e8f\",\n-+            \"x86_64-pc-windows-msvc\": \"84d7b52f3558c8e35c670a4fa14080c75e3ec584adfae49fec8b51008b75b21e\",\n-+            \"x86_64-unknown-linux-gnu\": \"db011f0cd29cab2291584958f4e2eb001b0e6051848d89b38a2dc23c5c54e512\",\n-+            \"x86_64-unknown-linux-musl\": \"00bb2d629f7eacbb5c6b44dc04af26d1f1da64cee3425b0d8eb5135a93830296\",\n-+            \"aarch64-apple-darwin-freethreaded\": \"c98c9c977e6fa05c3813bd49f3553904d89d60fed27e2e36468da7afa1d6d5e2\",\n-+            \"aarch64-unknown-linux-gnu-freethreaded\": \"b8635e59e3143fd17f19a3dfe8ccc246ee6587c87da359bd1bcab35eefbb5f19\",\n-+            \"ppc64le-unknown-linux-gnu-freethreaded\": \"6ae8fa44cb2edf4ab49cff1820b53c40c10349c0f39e11b8cd76ce7f3e7e1def\",\n-+            \"s390x-unknown-linux-gnu-freethreaded\": \"c074144cc80c2af32c420b79a9df26e8db405212619990c1fbdd308bd75afe3f\",\n-+            \"x86_64-apple-darwin-freethreaded\": \"0d73e4348d8d4b5159058609d2303705190405b485dd09ad05d870d7e0f36e0f\",\n-+            \"x86_64-pc-windows-msvc-freethreaded\": \"c51b4845fda5421e044067c111192f645234081d704313f74ee77fa013a186ea\",\n-+            \"x86_64-unknown-linux-gnu-freethreaded\": \"1aea5062614c036904b55c1cc2fb4b500b7f6f7a4cacc263f4888889d355eef8\",\n-+        },\n-+        \"strip_prefix\": {\n-+            \"aarch64-apple-darwin\": \"python\",\n-+            \"aarch64-unknown-linux-gnu\": \"python\",\n-+            \"ppc64le-unknown-linux-gnu\": \"python\",\n-+            \"s390x-unknown-linux-gnu\": \"python\",\n-+            \"x86_64-apple-darwin\": \"python\",\n-+            \"x86_64-pc-windows-msvc\": \"python\",\n-+            \"x86_64-unknown-linux-gnu\": \"python\",\n-+            \"x86_64-unknown-linux-musl\": \"python\",\n-+            \"aarch64-apple-darwin-freethreaded\": \"python/install\",\n-+            \"aarch64-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"ppc64le-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"s390x-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"x86_64-apple-darwin-freethreaded\": \"python/install\",\n-+            \"x86_64-pc-windows-msvc-freethreaded\": \"python/install\",\n-+            \"x86_64-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+        },\n-+    },\n-+    # Note: This is python 3.14.0rc1, but it is labeled as '3.14.0' due to limitation within rules_python\n-+    # that prevents the correct handling of pre-release version identifiers like '3.14.0a'.\n-+    \"3.14.0\": {\n-+        \"url\": \"20250723/cpython-{python_version}rc1+20250723-{platform}-{build}.{ext}\",\n-+        \"sha256\": {\n-+            \"aarch64-apple-darwin\": \"2b92957f70585f5672390fff3401055e668819777df47e3a66e000e382940979\",\n-+            \"aarch64-unknown-linux-gnu\": \"832ce0f827bb3f2c93c993d45a8706e20d3222edf35a918879cf94f9545732a4\",\n-+            \"ppc64le-unknown-linux-gnu\": \"a28efca51e222133acd159cd304f1b4a0634b3c782ed833fae0ee0b9a18173df\",\n-+            \"s390x-unknown-linux-gnu\": \"7638642bbdf0fba3fe2cd515fd8d14d91846bfaad20acc8ef87efe5c3e55b05d\",\n-+            \"x86_64-apple-darwin\": \"244348d8504ff649a6e79c128c51e1ec52bef689f15433fe7948fdd1d523076e\",\n-+            \"x86_64-pc-windows-msvc\": \"dbaac5ef2aeba93372f7a829bd1f88c2d8612875a87bffc1be68fa1a1940613e\",\n-+            \"x86_64-unknown-linux-gnu\": \"7547d0f0621cc9641a98b5dfb93ef2386f194b9c95996912cf9e3195d3760089\",\n-+            \"x86_64-unknown-linux-musl\": \"09142c7c4f413393b035f015733adb02f0fb72a4af3fab43b01fa03d3682c9ad\",\n-+            \"aarch64-apple-darwin-freethreaded\": \"0bed2d0aee3eec6ae47fb5aa18e83c63d31621276ec73956cff8074870e2b8cd\",\n-+            \"aarch64-unknown-linux-gnu-freethreaded\": \"b71f5c60fdffb4f375d53a3d16a45520b76af52448f55414243b6b20606447ac\",\n-+            \"ppc64le-unknown-linux-gnu-freethreaded\": \"982f0f8451cd90986b43683b119f157fe4eb69f763be18a65503b4869266798a\",\n-+            \"s390x-unknown-linux-gnu-freethreaded\": \"d870eb1d41bdf97a9739c387b6d8ca948f66f9ea9a77e5a3591c3b88551bdcfd\",\n-+            \"x86_64-apple-darwin-freethreaded\": \"04447e12c93b9299a28bfba10d94fb02bd18ff858097fa95474c5c6673d826d1\",\n-+            \"x86_64-pc-windows-msvc-freethreaded\": \"3cf7290af19454ed0e30649ccd0c68d67911b22428e008af08766723efd212b2\",\n-+            \"x86_64-unknown-linux-gnu-freethreaded\": \"ab51a2a4162b9ec329fdcd2e15ac0d59a458d8db133c03a07ad86a8890a302ae\",\n-+        },\n-+        \"strip_prefix\": {\n-+            \"aarch64-apple-darwin\": \"python\",\n-+            \"aarch64-unknown-linux-gnu\": \"python\",\n-+            \"ppc64le-unknown-linux-gnu\": \"python\",\n-+            \"s390x-unknown-linux-gnu\": \"python\",\n-+            \"x86_64-apple-darwin\": \"python\",\n-+            \"x86_64-pc-windows-msvc\": \"python\",\n-+            \"x86_64-unknown-linux-gnu\": \"python\",\n-+            \"x86_64-unknown-linux-musl\": \"python\",\n-+            \"aarch64-apple-darwin-freethreaded\": \"python/install\",\n-+            \"aarch64-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"ppc64le-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"s390x-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"x86_64-apple-darwin-freethreaded\": \"python/install\",\n-+            \"x86_64-pc-windows-msvc-freethreaded\": \"python/install\",\n-+            \"x86_64-unknown-linux-gnu-freethreaded\": \"python/install\",\n-         },\n--        \"strip_prefix\": \"python\",\n-     },\n- }\n- \n-@@ -604,7 +660,8 @@ MINOR_MAPPING = {\n-     \"3.10\": \"3.10.15\",\n-     \"3.11\": \"3.11.10\",\n-     \"3.12\": \"3.12.8\",\n--    \"3.13\": \"3.13.0\",\n-+    \"3.13\": \"3.13.2\",\n-+    \"3.14\": \"3.14.0\",\n- }\n- \n- def _generate_platforms():\n-@@ -778,11 +835,15 @@ def get_release_info(platform, python_version, base_url = DEFAULT_RELEASE_BASE_U\n-         p, _, _ = platform.partition(\"-\" + FREETHREADED)\n- \n-         if FREETHREADED in platform:\n-+            if \"3.13\" in python_version:\n-+                aarch64_linux_suffix = \"lto\"\n-+            else:\n-+                aarch64_linux_suffix = \"pgo+lto\"\n-             build = \"{}+{}-full\".format(\n-                 FREETHREADED,\n-                 {\n-                     \"aarch64-apple-darwin\": \"pgo+lto\",\n--                    \"aarch64-unknown-linux-gnu\": \"lto\",\n-+                    \"aarch64-unknown-linux-gnu\": aarch64_linux_suffix,\n-                     \"ppc64le-unknown-linux-gnu\": \"lto\",\n-                     \"s390x-unknown-linux-gnu\": \"lto\",\n-                     \"x86_64-apple-darwin\": \"pgo+lto\",\n-@@ -793,9 +854,6 @@ def get_release_info(platform, python_version, base_url = DEFAULT_RELEASE_BASE_U\n-         else:\n-             build = \"install_only\"\n- \n--        if WINDOWS_NAME in platform:\n--            build = \"shared-\" + build\n--\n-         release_filename = u.format(\n-             platform = p,\n-             python_version = python_version,"
        },
        {
            "sha": "4b3c8c99885b1c96190b29b759922979905ffae5",
            "filename": "third_party/py/rules_python3.patch",
            "status": "removed",
            "additions": 0,
            "deletions": 45,
            "changes": 45,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fpy%2Frules_python3.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fpy%2Frules_python3.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Frules_python3.patch?ref=06352207355a1a70a713b6d142d39bcf1857d832",
            "patch": "@@ -1,45 +0,0 @@\n-diff --git a/python/private/python_register_toolchains.bzl b/python/private/python_register_toolchains.bzl\n-index 98c8e5bf..fc533001 100644\n---- a/python/private/python_register_toolchains.bzl\n-+++ b/python/private/python_register_toolchains.bzl\n-@@ -86,6 +86,7 @@ def python_register_toolchains(\n-     minor_mapping = minor_mapping or MINOR_MAPPING\n-\n-     python_version = full_version(version = python_version, minor_mapping = minor_mapping)\n-+    python_version_kind = kwargs.pop(\"python_version_kind\", \"\")\n-\n-     toolchain_repo_name = \"{name}_toolchains\".format(name = name)\n-\n-@@ -165,6 +166,7 @@ def python_register_toolchains(\n-     toolchain_aliases(\n-         name = name,\n-         python_version = python_version,\n-+        python_version_kind = python_version_kind,\n-         user_repository_name = name,\n-         platforms = loaded_platforms,\n-     )\n-diff --git a/python/private/toolchains_repo.bzl b/python/private/toolchains_repo.bzl\n-index d21fb53a..a5271c18 100644\n---- a/python/private/toolchains_repo.bzl\n-+++ b/python/private/toolchains_repo.bzl\n-@@ -130,6 +130,9 @@ def _toolchain_aliases_impl(rctx):\n-     (os_name, arch) = _get_host_os_arch(rctx, logger)\n-\n-     host_platform = _get_host_platform(os_name, arch)\n-+    python_version_kind = rctx.attr.python_version_kind\n-+    if python_version_kind == \"ft\":\n-+        host_platform += \"-freethreaded\"\n-\n-     is_windows = (os_name == WINDOWS_NAME)\n-     python3_binary_path = \"python.exe\" if is_windows else \"bin/python3\"\n-@@ -233,6 +236,10 @@ actions.\"\"\",\n-             doc = \"List of platforms for which aliases shall be created\",\n-         ),\n-         \"python_version\": attr.string(doc = \"The Python version.\"),\n-+        \"python_version_kind\": attr.string(\n-+            doc = \"Python version kind, e.g. ft (free-threaded)\",\n-+            default = \"\"\n-+        ),\n-         \"user_repository_name\": attr.string(\n-             mandatory = True,\n-             doc = \"The base name for all created repositories, like 'python38'.\",\n\\ No newline at end of file"
        },
        {
            "sha": "8472f26bd8c7c42360ed67451a34f4f96f5cd9b3",
            "filename": "third_party/py/rules_python_freethreaded.patch",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Frules_python_freethreaded.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Frules_python_freethreaded.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Frules_python_freethreaded.patch?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -0,0 +1,13 @@\n+diff --git a/python/private/toolchains_repo.bzl b/python/private/toolchains_repo.bzl\n+index 93bbb521..f7ff19c3 100644\n+--- a/python/private/toolchains_repo.bzl\n++++ b/python/private/toolchains_repo.bzl\n+@@ -214,7 +214,7 @@ def python_toolchain_build_file_content(\n+             user_repository_name = \"{}_{}\".format(user_repository_name, platform),\n+             python_version = python_version,\n+             set_python_version_constraint = set_python_version_constraint,\n+-            target_settings = [],\n++            target_settings = meta.target_settings,\n+         ))\n+     return \"\\n\\n\".join(entries)\n+ \n\\ No newline at end of file"
        },
        {
            "sha": "5c761d191021e3ba0f6ccae95f7c3b76a5eb0205",
            "filename": "third_party/py/rules_python_pip_version.patch",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Frules_python_pip_version.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fpy%2Frules_python_pip_version.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fpy%2Frules_python_pip_version.patch?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -0,0 +1,26 @@\n+diff --git a/python/private/pypi/deps.bzl b/python/private/pypi/deps.bzl\n+index 8949ed4a..8d0ab0e7 100644\n+--- a/python/private/pypi/deps.bzl\n++++ b/python/private/pypi/deps.bzl\n+@@ -51,8 +51,8 @@ _RULE_DEPS = [\n+     ),\n+     (\n+         \"pypi__packaging\",\n+-        \"https://files.pythonhosted.org/packages/49/df/1fceb2f8900f8639e278b056416d49134fb8d84c5942ffaa01ad34782422/packaging-24.0-py3-none-any.whl\",\n+-        \"2ddfb553fdf02fb784c234c7ba6ccc288296ceabec964ad2eae3777778130bc5\",\n++        \"https://files.pythonhosted.org/packages/88/ef/eb23f262cca3c0c4eb7ab1933c3b1f03d021f2c48f54763065b6f0e321be/packaging-24.2-py3-none-any.whl\",\n++        \"09abb1bccd265c01f4a3aa3f7a7db064b36514d2cba19a2f694fe6150451a759\",\n+     ),\n+     (\n+         \"pypi__pep517\",\n+@@ -61,8 +61,8 @@ _RULE_DEPS = [\n+     ),\n+     (\n+         \"pypi__pip\",\n+-        \"https://files.pythonhosted.org/packages/8a/6a/19e9fe04fca059ccf770861c7d5721ab4c2aebc539889e97c7977528a53b/pip-24.0-py3-none-any.whl\",\n+-        \"ba0d021a166865d2265246961bec0152ff124de910c5cc39f1156ce3fa7c69dc\",\n++        \"https://files.pythonhosted.org/packages/ef/7d/500c9ad20238fcfcb4cb9243eede163594d7020ce87bd9610c9e02771876/pip-24.3.1-py3-none-any.whl\",\n++        \"3790624780082365f47549d032f3770eeb2b1e8bd1f7b2e02dace1afa361b4ed\",\n+     ),\n+     (\n+         \"pypi__pip_tools\","
        },
        {
            "sha": "ac32e59e46bf4fed32fec80d88c36e709716a6ef",
            "filename": "third_party/xla/tensorflow.bazelrc",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Ftensorflow.bazelrc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Ftensorflow.bazelrc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Ftensorflow.bazelrc?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -64,7 +64,12 @@ build --host_copt=-DGRPC_BAZEL_BUILD\n build --action_env=GRPC_BAZEL_RUNTIME=1\n build --repo_env=PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=upb\n build --action_env=PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=upb\n-build --repo_env=RULES_PYTHON_ENABLE_PYSTAR=0\n+# Some targets have the same py source file, but use different\n+# configurations via `requires-` tags. This results in an action\n+# conflict when precompiling. Disable to avoid that problem.\n+# See https://github.com/bazel-contrib/rules_python/issues/2445\n+build --@rules_python//python/config_settings:precompile=force_disabled\n+\n # Do not do this. This is how gRPC builds itself by default, but we don't want\n # that as it would link protobuf into its own set of dynamic libraries, which\n # would conflict with our protobuf linkage."
        },
        {
            "sha": "e54be1995c458a881c4db02302351f7d1312c5c4",
            "filename": "third_party/xla/third_party/protobuf/protobuf.patch",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fprotobuf%2Fprotobuf.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fprotobuf%2Fprotobuf.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fprotobuf%2Fprotobuf.patch?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -57,7 +57,7 @@ diff --git a/python/dist/system_python.bzl b/python/dist/system_python.bzl\n -   visibility = [\"//visibility:public\"],\n +alias(\n +    name = \"python_headers\",\n-+    actual = \"@python//:python_headers\",\n++    actual = \"@rules_python//python/cc:current_py_cc_headers\",\n +    visibility = [\"//visibility:public\"],\n  )\n "
        },
        {
            "sha": "9597930e710dbf1edd3e9916f03c548cd8052794",
            "filename": "third_party/xla/third_party/py/BUILD.bazel",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2FBUILD.bazel",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2FBUILD.bazel",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2FBUILD.bazel?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,6 @@\n load(\"@bazel_skylib//rules:common_settings.bzl\", \"bool_flag\")\n-load(\"@python//:defs.bzl\", \"compile_pip_requirements\")\n load(\"@python_version_repo//:py_version.bzl\", \"REQUIREMENTS\")\n+load(\"@rules_python//python:pip.bzl\", \"compile_pip_requirements\")\n \n compile_pip_requirements(\n     name = \"requirements\","
        },
        {
            "sha": "be0c6091d92c6ad8d0c8920a4d730e9487a0aa9c",
            "filename": "third_party/xla/third_party/py/BUILD.tpl",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2FBUILD.tpl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2FBUILD.tpl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2FBUILD.tpl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -5,17 +5,16 @@ package(default_visibility = [\"//visibility:public\"])\n # Point both runtimes to the same python binary to ensure we always\n # use the python binary specified by ./configure.py script.\n load(\"@bazel_tools//tools/python:toolchain.bzl\", \"py_runtime_pair\")\n-load(\"@python//:defs.bzl\", \"interpreter\")\n \n py_runtime(\n     name = \"py2_runtime\",\n-    interpreter_path = interpreter,\n+    interpreter = \"%{PYTHON_INTERPRETER}\",\n     python_version = \"PY2\",\n )\n \n py_runtime(\n     name = \"py3_runtime\",\n-    interpreter_path = interpreter,\n+    interpreter = \"%{PYTHON_INTERPRETER}\",\n     python_version = \"PY3\",\n )\n \n@@ -34,7 +33,7 @@ toolchain(\n )\n \n alias(name = \"python_headers\",\n-      actual = \"@python//:python_headers\")\n+      actual = \"@rules_python//python/cc:current_py_cc_headers\")\n \n # This alias is exists for the use of targets in the @llvm-project dependency,\n # which expect a python_headers target called @python_runtime//:headers. We use"
        },
        {
            "sha": "18f238c015151d0a0bc101f64d823c0c02332f75",
            "filename": "third_party/xla/third_party/py/python_configure.bzl",
            "status": "modified",
            "additions": 20,
            "deletions": 5,
            "changes": 25,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_configure.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_configure.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_configure.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -7,18 +7,27 @@ load(\n     \"PYTHON_BIN_PATH\",\n     \"PYTHON_LIB_PATH\",\n )\n+load(\"//third_party/py:python_init_toolchains.bzl\", \"get_toolchain_name_per_python_version\")\n+\n+def _get_python_interpreter():\n+    return \"@{}_host//:python\".format(\n+        get_toolchain_name_per_python_version(\"python\"),\n+    )\n \n def _create_local_python_repository(repository_ctx):\n     \"\"\"Creates the repository containing files set up to build with Python.\"\"\"\n \n-    # Resolve all labels before doing any real work. Resolving causes the\n-    # function to be restarted with all previous state being lost. This\n-    # can easily lead to a O(n^2) runtime in the number of labels.\n-    build_tpl = repository_ctx.path(Label(\"//third_party/py:BUILD.tpl\"))\n     platform_constraint = \"\"\n     if repository_ctx.attr.platform_constraint:\n         platform_constraint = \"\\\"%s\\\"\" % repository_ctx.attr.platform_constraint\n-    repository_ctx.template(\"BUILD\", build_tpl, {\"%{PLATFORM_CONSTRAINT}\": platform_constraint})\n+    repository_ctx.template(\n+        \"BUILD\",\n+        repository_ctx.attr.build_tpl,\n+        {\n+            \"%{PLATFORM_CONSTRAINT}\": platform_constraint,\n+            \"%{PYTHON_INTERPRETER}\": repository_ctx.attr.python_interpreter,\n+        },\n+    )\n \n def _python_autoconf_impl(repository_ctx):\n     \"\"\"Implementation of the python_autoconf repository rule.\"\"\"\n@@ -35,6 +44,8 @@ local_python_configure = repository_rule(\n     attrs = {\n         \"environ\": attr.string_dict(),\n         \"platform_constraint\": attr.string(),\n+        \"build_tpl\": attr.label(default = Label(\"//third_party/py:BUILD.tpl\")),\n+        \"python_interpreter\": attr.string(default = _get_python_interpreter()),\n     },\n )\n \n@@ -45,13 +56,17 @@ remote_python_configure = repository_rule(\n     attrs = {\n         \"environ\": attr.string_dict(),\n         \"platform_constraint\": attr.string(),\n+        \"build_tpl\": attr.label(default = Label(\"//third_party/py:BUILD.tpl\")),\n+        \"python_interpreter\": attr.string(default = _get_python_interpreter()),\n     },\n )\n \n python_configure = repository_rule(\n     implementation = _python_autoconf_impl,\n     attrs = {\n         \"platform_constraint\": attr.string(),\n+        \"build_tpl\": attr.label(default = Label(\"//third_party/py:BUILD.tpl\")),\n+        \"python_interpreter\": attr.string(default = _get_python_interpreter()),\n     },\n )\n \"\"\"Detects and configures the local Python."
        },
        {
            "sha": "c75db81be75b94bee449ce80bc6e3dfee1dde27f",
            "filename": "third_party/xla/third_party/py/python_init_pip.bzl",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_pip.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_pip.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_pip.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,8 +1,11 @@\n \"\"\"Hermetic Python initialization. Consult the WORKSPACE on how to use it.\"\"\"\n \n-load(\"@python//:defs.bzl\", \"interpreter\")\n load(\"@python_version_repo//:py_version.bzl\", \"REQUIREMENTS_WITH_LOCAL_WHEELS\")\n load(\"@rules_python//python:pip.bzl\", \"package_annotation\", \"pip_parse\")\n+load(\n+    \"//third_party/py:python_init_toolchains.bzl\",\n+    \"get_toolchain_name_per_python_version\",\n+)\n \n def python_init_pip():\n     numpy_annotations = {\n@@ -29,6 +32,8 @@ cc_library(\n     pip_parse(\n         name = \"pypi\",\n         annotations = numpy_annotations,\n-        python_interpreter_target = interpreter,\n+        python_interpreter_target = \"@{}_host//:python\".format(\n+            get_toolchain_name_per_python_version(\"python\"),\n+        ),\n         requirements_lock = REQUIREMENTS_WITH_LOCAL_WHEELS,\n     )"
        },
        {
            "sha": "670b4807764e9a0e733f2b40d9c6445504ed7a8f",
            "filename": "third_party/xla/third_party/py/python_init_rules.bzl",
            "status": "modified",
            "additions": 30,
            "deletions": 6,
            "changes": 36,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_rules.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_rules.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_rules.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,6 +1,7 @@\n \"\"\"Hermetic Python initialization. Consult the WORKSPACE on how to use it.\"\"\"\n \n load(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n \n def python_init_rules(extra_patches = []):\n     \"\"\"Defines (doesn't setup) the rules_python repository.\n@@ -9,15 +10,38 @@ def python_init_rules(extra_patches = []):\n       extra_patches: list of labels. Additional patches to apply after the default\n         set of patches.\n     \"\"\"\n+\n+    http_archive(\n+        name = \"rules_cc\",\n+        urls = [\"https://github.com/bazelbuild/rules_cc/archive/refs/tags/0.1.0.tar.gz\"],\n+        strip_prefix = \"rules_cc-0.1.0\",\n+        sha256 = \"4b12149a041ddfb8306a8fd0e904e39d673552ce82e4296e96fac9cbf0780e59\",\n+        patches = [\n+            Label(\"//third_party/py:rules_cc_protobuf.patch\"),\n+        ],\n+        patch_args = [\"-p1\"],\n+    )\n+\n+    tf_http_archive(\n+        name = \"com_google_protobuf\",\n+        patch_file = [\"//third_party/protobuf:protobuf.patch\"],\n+        sha256 = \"6e09bbc950ba60c3a7b30280210cd285af8d7d8ed5e0a6ed101c72aff22e8d88\",\n+        strip_prefix = \"protobuf-6.31.1\",\n+        urls = tf_mirror_urls(\"https://github.com/protocolbuffers/protobuf/archive/refs/tags/v6.31.1.zip\"),\n+        repo_mapping = {\n+            \"@abseil-cpp\": \"@com_google_absl\",\n+            \"@protobuf_pip_deps\": \"@pypi\",\n+        },\n+    )\n+\n     http_archive(\n         name = \"rules_python\",\n-        sha256 = \"62ddebb766b4d6ddf1712f753dac5740bea072646f630eb9982caa09ad8a7687\",\n-        strip_prefix = \"rules_python-0.39.0\",\n-        url = \"https://github.com/bazelbuild/rules_python/releases/download/0.39.0/rules_python-0.39.0.tar.gz\",\n+        sha256 = \"fa7dd2c6b7d63b3585028dd8a90a6cf9db83c33b250959c2ee7b583a6c130e12\",\n+        strip_prefix = \"rules_python-1.6.0\",\n+        url = \"https://github.com/bazelbuild/rules_python/releases/download/1.6.0/rules_python-1.6.0.tar.gz\",\n         patch_args = [\"-p1\"],\n         patches = [\n-            Label(\"//third_party/py:rules_python1.patch\"),\n-            Label(\"//third_party/py:rules_python2.patch\"),\n-            Label(\"//third_party/py:rules_python3.patch\"),\n+            Label(\"//third_party/py:rules_python_pip_version.patch\"),\n+            Label(\"//third_party/py:rules_python_freethreaded.patch\"),\n         ] + extra_patches,\n     )"
        },
        {
            "sha": "9f549850a7dafca373e02580f7e02d085862d2fb",
            "filename": "third_party/xla/third_party/py/python_init_toolchains.bzl",
            "status": "modified",
            "additions": 10,
            "deletions": 6,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_toolchains.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_toolchains.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_init_toolchains.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -6,16 +6,21 @@ load(\n     \"HERMETIC_PYTHON_SHA256\",\n     \"HERMETIC_PYTHON_URL\",\n     \"HERMETIC_PYTHON_VERSION\",\n-    \"HERMETIC_PYTHON_VERSION_KIND\",\n )\n load(\"@rules_python//python:repositories.bzl\", \"python_register_toolchains\")\n load(\"@rules_python//python:versions.bzl\", \"MINOR_MAPPING\", \"PLATFORMS\")\n \n+def get_toolchain_name_per_python_version(name):\n+    return \"{name}_{version}\".format(\n+        name = name,\n+        version = HERMETIC_PYTHON_VERSION.replace(\".\", \"_\"),\n+    )\n+\n def python_init_toolchains(name = \"python\", python_version = None, **kwargs):\n     \"\"\"Register hermetic python toolchains.\n \n     Args:\n-        name: name of the toolchain, \"python\" by default (it is strongly\n+        name: prefix of the toolchain, \"python\" by default (it is strongly\n           recommended to rely on the default).\n         python_version: version of the python to register; if set it will bypass\n           kwargs to underlying python_register_toolchains as is (manual\n@@ -27,7 +32,7 @@ def python_init_toolchains(name = \"python\", python_version = None, **kwargs):\n \n     if python_version:\n         python_register_toolchains(\n-            name = name,\n+            name = get_toolchain_name_per_python_version(name),\n             python_version = python_version,\n             **kwargs\n         )\n@@ -44,7 +49,7 @@ def python_init_toolchains(name = \"python\", python_version = None, **kwargs):\n                 sha256s[platform] = HERMETIC_PYTHON_SHA256\n \n         python_register_toolchains(\n-            name = name,\n+            name = get_toolchain_name_per_python_version(name),\n             base_url = url_components[0] + \"://\",\n             ignore_root_user_error = True,\n             python_version = tool_version,\n@@ -59,8 +64,7 @@ def python_init_toolchains(name = \"python\", python_version = None, **kwargs):\n         )\n     elif HERMETIC_PYTHON_VERSION in MINOR_MAPPING:\n         python_register_toolchains(\n-            name = name,\n+            name = get_toolchain_name_per_python_version(name),\n             ignore_root_user_error = True,\n             python_version = HERMETIC_PYTHON_VERSION,\n-            python_version_kind = HERMETIC_PYTHON_VERSION_KIND,\n         )"
        },
        {
            "sha": "d8ff140a0278ffc6cd5047d5ed118be810dab855",
            "filename": "third_party/xla/third_party/py/python_wheel.bzl",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_wheel.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_wheel.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Fpython_wheel.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -1,3 +1,5 @@\n+load(\"@rules_python//python:py_info.bzl\", \"PyInfo\")\n+\n \"\"\" Repository and build rules for Python wheels packaging utilities. \"\"\"\n \n def _get_host_environ(repository_ctx, name, default_value = None):"
        },
        {
            "sha": "95c4d447c49c97c97f2b8932a10bfad93f46eb80",
            "filename": "third_party/xla/third_party/py/rules_cc_protobuf.patch",
            "status": "added",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_cc_protobuf.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_cc_protobuf.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_cc_protobuf.patch?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -0,0 +1,16 @@\n+diff --git a/cc/defs.bzl b/cc/defs.bzl\n+index 3448e77..9c298ab 100644\n+--- a/cc/defs.bzl\n++++ b/cc/defs.bzl\n+@@ -30,9 +30,11 @@ load(\"//cc/toolchains:cc_toolchain_suite.bzl\", _cc_toolchain_suite = \"cc_toolcha\n+ load(\"//cc/toolchains:compiler_flag.bzl\", _compiler_flag = \"compiler_flag\")\n+ load(\"//cc/toolchains:fdo_prefetch_hints.bzl\", _fdo_prefetch_hints = \"fdo_prefetch_hints\")\n+ load(\"//cc/toolchains:fdo_profile.bzl\", _fdo_profile = \"fdo_profile\")\n++load(\"@com_google_protobuf//bazel:cc_proto_library.bzl\", _protobuf_cc_proto_library = \"cc_proto_library\")\n+ \n+ # Rules\n+ \n++cc_proto_library = _protobuf_cc_proto_library\n+ cc_library = _cc_library\n+ cc_binary = _cc_binary\n+ cc_test = _cc_test\n\\ No newline at end of file"
        },
        {
            "sha": "aab0c23d4d22dbef0d81548da8f580018e64550d",
            "filename": "third_party/xla/third_party/py/rules_python1.patch",
            "status": "removed",
            "additions": 0,
            "deletions": 93,
            "changes": 93,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python1.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python1.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python1.patch?ref=06352207355a1a70a713b6d142d39bcf1857d832",
            "patch": "@@ -1,93 +0,0 @@\n-diff --git a/python/private/pypi/deps.bzl b/python/private/pypi/deps.bzl\n-index 8949ed4a..8d0ab0e7 100644\n---- a/python/private/pypi/deps.bzl\n-+++ b/python/private/pypi/deps.bzl\n-@@ -51,8 +51,8 @@ _RULE_DEPS = [\n-     ),\n-     (\n-         \"pypi__packaging\",\n--        \"https://files.pythonhosted.org/packages/49/df/1fceb2f8900f8639e278b056416d49134fb8d84c5942ffaa01ad34782422/packaging-24.0-py3-none-any.whl\",\n--        \"2ddfb553fdf02fb784c234c7ba6ccc288296ceabec964ad2eae3777778130bc5\",\n-+        \"https://files.pythonhosted.org/packages/88/ef/eb23f262cca3c0c4eb7ab1933c3b1f03d021f2c48f54763065b6f0e321be/packaging-24.2-py3-none-any.whl\",\n-+        \"09abb1bccd265c01f4a3aa3f7a7db064b36514d2cba19a2f694fe6150451a759\",\n-     ),\n-     (\n-         \"pypi__pep517\",\n-@@ -61,8 +61,8 @@ _RULE_DEPS = [\n-     ),\n-     (\n-         \"pypi__pip\",\n--        \"https://files.pythonhosted.org/packages/8a/6a/19e9fe04fca059ccf770861c7d5721ab4c2aebc539889e97c7977528a53b/pip-24.0-py3-none-any.whl\",\n--        \"ba0d021a166865d2265246961bec0152ff124de910c5cc39f1156ce3fa7c69dc\",\n-+        \"https://files.pythonhosted.org/packages/ef/7d/500c9ad20238fcfcb4cb9243eede163594d7020ce87bd9610c9e02771876/pip-24.3.1-py3-none-any.whl\",\n-+        \"3790624780082365f47549d032f3770eeb2b1e8bd1f7b2e02dace1afa361b4ed\",\n-     ),\n-     (\n-         \"pypi__pip_tools\",\n-diff --git a/python/private/pypi/evaluate_markers.bzl b/python/private/pypi/evaluate_markers.bzl\n-index c805fd7a..e57e6138 100644\n---- a/python/private/pypi/evaluate_markers.bzl\n-+++ b/python/private/pypi/evaluate_markers.bzl\n-@@ -20,7 +20,7 @@ load(\":pypi_repo_utils.bzl\", \"pypi_repo_utils\")\n- SRCS = [\n-     # When the version, or any of the files in `packaging` package changes,\n-     # this file will change as well.\n--    Label(\"@pypi__packaging//:packaging-24.0.dist-info/RECORD\"),\n-+    Label(\"@pypi__packaging//:packaging-24.2.dist-info/RECORD\"),\n-     Label(\"//python/private/pypi/requirements_parser:resolve_target_platforms.py\"),\n-     Label(\"//python/private/pypi/whl_installer:platform.py\"),\n- ]\n-diff --git a/python/versions.bzl b/python/versions.bzl\n-index 774c24d1..91e59f9b 100644\n---- a/python/versions.bzl\n-+++ b/python/versions.bzl\n-@@ -561,6 +561,20 @@ TOOL_VERSIONS = {\n-         },\n-         \"strip_prefix\": \"python\",\n-     },\n-+    \"3.12.8\": {\n-+        \"url\": \"20241206/cpython-{python_version}+20241206-{platform}-{build}.tar.gz\",\n-+        \"sha256\": {\n-+            \"aarch64-apple-darwin\": \"e3c4aa607717b23903ca2650d5c3ee24f89b97543e2db2b0f463bddc7a9e92f3\",\n-+            \"aarch64-unknown-linux-gnu\": \"ce674b55442b732973afb2932c281bb1ded4ad7e22bcf9b07071165770758c7e\",\n-+            \"ppc64le-unknown-linux-gnu\": \"b7214790b273de9ed0532420054b72ba1393d62d2fc844ec55ade193771bd90c\",\n-+            \"s390x-unknown-linux-gnu\": \"73102f5dbd7d1e7e9c2f2c80aedf2893d99a7fa407f6674ec8b2f57ba07daee5\",\n-+            \"x86_64-apple-darwin\": \"3ba35c706577d755e8e52a4c161a042464577c0e695e2a605362fa469e26de10\",\n-+            \"x86_64-pc-windows-msvc\": \"767b4be3ddf6b99e5ade519789c1615c191d8cf99d5aff4685cc18b48931f1e6\",\n-+            \"x86_64-unknown-linux-gnu\": \"b9d6ee5ddac1198e72d53112698773fc8bb597de095592eb849ca794306699ba\",\n-+            \"x86_64-unknown-linux-musl\": \"6f305888703691dd04cfff85284d23ea0b0146ed7c4415e472f1fb72b3f32cdf\",\n-+        },\n-+        \"strip_prefix\": \"python\",\n-+    },\n-     \"3.13.0\": {\n-         \"url\": \"20241016/cpython-{python_version}+20241016-{platform}-{build}.{ext}\",\n-         \"sha256\": {\n-@@ -589,7 +603,7 @@ MINOR_MAPPING = {\n-     \"3.9\": \"3.9.20\",\n-     \"3.10\": \"3.10.15\",\n-     \"3.11\": \"3.11.10\",\n--    \"3.12\": \"3.12.7\",\n-+    \"3.12\": \"3.12.8\",\n-     \"3.13\": \"3.13.0\",\n- }\n-\n-diff --git a/python/private/python_bootstrap_template.txt b/python/private/python_bootstrap_template.txt\n-index 0f9c90b3..567bdc88 100644\n---- a/python/private/python_bootstrap_template.txt\n-+++ b/python/private/python_bootstrap_template.txt\n-@@ -52,7 +52,14 @@ def GetWindowsPathWithUNCPrefix(path):\n-   # removed from common Win32 file and directory functions.\n-   # Related doc: https://docs.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=cmd#enable-long-paths-in-windows-10-version-1607-and-later\n-   import platform\n--  if platform.win32_ver()[1] >= '10.0.14393':\n-+  version = None\n-+  # The try-except block is needed to fix the flakiness of RBE tests\n-+  # on Windows 2022 using hermetic python 3.12.8.\n-+  try:\n-+    version = platform.win32_ver()[1]\n-+  except (ValueError, KeyError):\n-+    version = platform.win32_ver()[1]\n-+  if version and version >= '10.0.14393':\n-     return path\n-\n-   # import sysconfig only now to maintain python 2.6 compatibility"
        },
        {
            "sha": "6b36379d208cccc659025935780e2c1d35ac7339",
            "filename": "third_party/xla/third_party/py/rules_python2.patch",
            "status": "removed",
            "additions": 0,
            "deletions": 150,
            "changes": 150,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python2.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python2.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python2.patch?ref=06352207355a1a70a713b6d142d39bcf1857d832",
            "patch": "@@ -1,150 +0,0 @@\n-diff --git a/python/versions.bzl b/python/versions.bzl\n-index 91e59f9b..d72855db 100644\n---- a/python/versions.bzl\n-+++ b/python/versions.bzl\n-@@ -21,7 +21,7 @@ LINUX_NAME = \"linux\"\n- WINDOWS_NAME = \"windows\"\n- FREETHREADED = \"freethreaded\"\n- \n--DEFAULT_RELEASE_BASE_URL = \"https://github.com/indygreg/python-build-standalone/releases/download\"\n-+DEFAULT_RELEASE_BASE_URL = \"https://github.com/astral-sh/python-build-standalone/releases/download\"\n- \n- # When updating the versions and releases, run the following command to get\n- # the hashes:\n-@@ -575,25 +575,81 @@ TOOL_VERSIONS = {\n-         },\n-         \"strip_prefix\": \"python\",\n-     },\n--    \"3.13.0\": {\n--        \"url\": \"20241016/cpython-{python_version}+20241016-{platform}-{build}.{ext}\",\n--        \"sha256\": {\n--            \"aarch64-apple-darwin\": \"31397953849d275aa2506580f3fa1cb5a85b6a3d392e495f8030e8b6412f5556\",\n--            \"aarch64-unknown-linux-gnu\": \"e8378c0162b2e0e4cc1f62b29443a3305d116d09583304dbb0149fecaff6347b\",\n--            \"ppc64le-unknown-linux-gnu\": \"fc4b7f27c4e84c78f3c8e6c7f8e4023e4638d11f1b36b6b5ce457b1926cebb53\",\n--            \"s390x-unknown-linux-gnu\": \"66b19e6a07717f6cfcd3a8ca953f0a2eaa232291142f3d26a8d17c979ec0f467\",\n--            \"x86_64-apple-darwin\": \"cff1b7e7cd26f2d47acac1ad6590e27d29829776f77e8afa067e9419f2f6ce77\",\n--            \"x86_64-pc-windows-msvc\": \"b25926e8ce4164cf103bacc4f4d154894ea53e07dd3fdd5ebb16fb1a82a7b1a0\",\n--            \"x86_64-unknown-linux-gnu\": \"2c8cb15c6a2caadaa98af51df6fe78a8155b8471cb3dd7b9836038e0d3657fb4\",\n--            \"aarch64-apple-darwin-freethreaded\": \"efc2e71c0e05bc5bedb7a846e05f28dd26491b1744ded35ed82f8b49ccfa684b\",\n--            \"aarch64-unknown-linux-gnu-freethreaded\": \"59b50df9826475d24bb7eff781fa3949112b5e9c92adb29e96a09cdf1216d5bd\",\n--            \"ppc64le-unknown-linux-gnu-freethreaded\": \"1217efa5f4ce67fcc9f7eb64165b1bd0912b2a21bc25c1a7e2cb174a21a5df7e\",\n--            \"s390x-unknown-linux-gnu-freethreaded\": \"6c3e1e4f19d2b018b65a7e3ef4cd4225c5b9adfbc490218628466e636d5c4b8c\",\n--            \"x86_64-apple-darwin-freethreaded\": \"2e07dfea62fe2215738551a179c87dbed1cc79d1b3654f4d7559889a6d5ce4eb\",\n--            \"x86_64-pc-windows-msvc-freethreaded\": \"bfd89f9acf866463bc4baf01733da5e767d13f5d0112175a4f57ba91f1541310\",\n--            \"x86_64-unknown-linux-gnu-freethreaded\": \"a73adeda301ad843cce05f31a2d3e76222b656984535a7b87696a24a098b216c\",\n-+    \"3.13.2\": {\n-+        \"url\": \"20250317/cpython-{python_version}+20250317-{platform}-{build}.{ext}\",\n-+        \"sha256\": {\n-+            \"aarch64-apple-darwin\": \"faa44274a331eb39786362818b21b3a4e74514e8805000b20b0e55c590cecb94\",\n-+            \"aarch64-unknown-linux-gnu\": \"9c67260446fee6ea706dad577a0b32936c63f449c25d66e4383d5846b2ab2e36\",\n-+            \"ppc64le-unknown-linux-gnu\": \"345b53d2f86c9dbd7f1320657cb227ff9a42ef63ff21f129abbbc8c82a375147\",\n-+            \"s390x-unknown-linux-gnu\": \"ec3b16ea8a97e3138acec72bc5ff35949950c62c8994a8ec8e213fd93f0e806b\",\n-+            \"x86_64-apple-darwin\": \"ee4526e84b5ce5b11141c50060b385320f2773616249a741f90c96d460ce8e8f\",\n-+            \"x86_64-pc-windows-msvc\": \"84d7b52f3558c8e35c670a4fa14080c75e3ec584adfae49fec8b51008b75b21e\",\n-+            \"x86_64-unknown-linux-gnu\": \"db011f0cd29cab2291584958f4e2eb001b0e6051848d89b38a2dc23c5c54e512\",\n-+            \"x86_64-unknown-linux-musl\": \"00bb2d629f7eacbb5c6b44dc04af26d1f1da64cee3425b0d8eb5135a93830296\",\n-+            \"aarch64-apple-darwin-freethreaded\": \"c98c9c977e6fa05c3813bd49f3553904d89d60fed27e2e36468da7afa1d6d5e2\",\n-+            \"aarch64-unknown-linux-gnu-freethreaded\": \"b8635e59e3143fd17f19a3dfe8ccc246ee6587c87da359bd1bcab35eefbb5f19\",\n-+            \"ppc64le-unknown-linux-gnu-freethreaded\": \"6ae8fa44cb2edf4ab49cff1820b53c40c10349c0f39e11b8cd76ce7f3e7e1def\",\n-+            \"s390x-unknown-linux-gnu-freethreaded\": \"c074144cc80c2af32c420b79a9df26e8db405212619990c1fbdd308bd75afe3f\",\n-+            \"x86_64-apple-darwin-freethreaded\": \"0d73e4348d8d4b5159058609d2303705190405b485dd09ad05d870d7e0f36e0f\",\n-+            \"x86_64-pc-windows-msvc-freethreaded\": \"c51b4845fda5421e044067c111192f645234081d704313f74ee77fa013a186ea\",\n-+            \"x86_64-unknown-linux-gnu-freethreaded\": \"1aea5062614c036904b55c1cc2fb4b500b7f6f7a4cacc263f4888889d355eef8\",\n-+        },\n-+        \"strip_prefix\": {\n-+            \"aarch64-apple-darwin\": \"python\",\n-+            \"aarch64-unknown-linux-gnu\": \"python\",\n-+            \"ppc64le-unknown-linux-gnu\": \"python\",\n-+            \"s390x-unknown-linux-gnu\": \"python\",\n-+            \"x86_64-apple-darwin\": \"python\",\n-+            \"x86_64-pc-windows-msvc\": \"python\",\n-+            \"x86_64-unknown-linux-gnu\": \"python\",\n-+            \"x86_64-unknown-linux-musl\": \"python\",\n-+            \"aarch64-apple-darwin-freethreaded\": \"python/install\",\n-+            \"aarch64-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"ppc64le-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"s390x-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"x86_64-apple-darwin-freethreaded\": \"python/install\",\n-+            \"x86_64-pc-windows-msvc-freethreaded\": \"python/install\",\n-+            \"x86_64-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+        },\n-+    },\n-+    # Note: This is python 3.14.0rc1, but it is labeled as '3.14.0' due to limitation within rules_python\n-+    # that prevents the correct handling of pre-release version identifiers like '3.14.0a'.\n-+    \"3.14.0\": {\n-+        \"url\": \"20250723/cpython-{python_version}rc1+20250723-{platform}-{build}.{ext}\",\n-+        \"sha256\": {\n-+            \"aarch64-apple-darwin\": \"2b92957f70585f5672390fff3401055e668819777df47e3a66e000e382940979\",\n-+            \"aarch64-unknown-linux-gnu\": \"832ce0f827bb3f2c93c993d45a8706e20d3222edf35a918879cf94f9545732a4\",\n-+            \"ppc64le-unknown-linux-gnu\": \"a28efca51e222133acd159cd304f1b4a0634b3c782ed833fae0ee0b9a18173df\",\n-+            \"s390x-unknown-linux-gnu\": \"7638642bbdf0fba3fe2cd515fd8d14d91846bfaad20acc8ef87efe5c3e55b05d\",\n-+            \"x86_64-apple-darwin\": \"244348d8504ff649a6e79c128c51e1ec52bef689f15433fe7948fdd1d523076e\",\n-+            \"x86_64-pc-windows-msvc\": \"dbaac5ef2aeba93372f7a829bd1f88c2d8612875a87bffc1be68fa1a1940613e\",\n-+            \"x86_64-unknown-linux-gnu\": \"7547d0f0621cc9641a98b5dfb93ef2386f194b9c95996912cf9e3195d3760089\",\n-+            \"x86_64-unknown-linux-musl\": \"09142c7c4f413393b035f015733adb02f0fb72a4af3fab43b01fa03d3682c9ad\",\n-+            \"aarch64-apple-darwin-freethreaded\": \"0bed2d0aee3eec6ae47fb5aa18e83c63d31621276ec73956cff8074870e2b8cd\",\n-+            \"aarch64-unknown-linux-gnu-freethreaded\": \"b71f5c60fdffb4f375d53a3d16a45520b76af52448f55414243b6b20606447ac\",\n-+            \"ppc64le-unknown-linux-gnu-freethreaded\": \"982f0f8451cd90986b43683b119f157fe4eb69f763be18a65503b4869266798a\",\n-+            \"s390x-unknown-linux-gnu-freethreaded\": \"d870eb1d41bdf97a9739c387b6d8ca948f66f9ea9a77e5a3591c3b88551bdcfd\",\n-+            \"x86_64-apple-darwin-freethreaded\": \"04447e12c93b9299a28bfba10d94fb02bd18ff858097fa95474c5c6673d826d1\",\n-+            \"x86_64-pc-windows-msvc-freethreaded\": \"3cf7290af19454ed0e30649ccd0c68d67911b22428e008af08766723efd212b2\",\n-+            \"x86_64-unknown-linux-gnu-freethreaded\": \"ab51a2a4162b9ec329fdcd2e15ac0d59a458d8db133c03a07ad86a8890a302ae\",\n-+        },\n-+        \"strip_prefix\": {\n-+            \"aarch64-apple-darwin\": \"python\",\n-+            \"aarch64-unknown-linux-gnu\": \"python\",\n-+            \"ppc64le-unknown-linux-gnu\": \"python\",\n-+            \"s390x-unknown-linux-gnu\": \"python\",\n-+            \"x86_64-apple-darwin\": \"python\",\n-+            \"x86_64-pc-windows-msvc\": \"python\",\n-+            \"x86_64-unknown-linux-gnu\": \"python\",\n-+            \"x86_64-unknown-linux-musl\": \"python\",\n-+            \"aarch64-apple-darwin-freethreaded\": \"python/install\",\n-+            \"aarch64-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"ppc64le-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"s390x-unknown-linux-gnu-freethreaded\": \"python/install\",\n-+            \"x86_64-apple-darwin-freethreaded\": \"python/install\",\n-+            \"x86_64-pc-windows-msvc-freethreaded\": \"python/install\",\n-+            \"x86_64-unknown-linux-gnu-freethreaded\": \"python/install\",\n-         },\n--        \"strip_prefix\": \"python\",\n-     },\n- }\n- \n-@@ -604,7 +660,8 @@ MINOR_MAPPING = {\n-     \"3.10\": \"3.10.15\",\n-     \"3.11\": \"3.11.10\",\n-     \"3.12\": \"3.12.8\",\n--    \"3.13\": \"3.13.0\",\n-+    \"3.13\": \"3.13.2\",\n-+    \"3.14\": \"3.14.0\",\n- }\n- \n- def _generate_platforms():\n-@@ -778,11 +835,15 @@ def get_release_info(platform, python_version, base_url = DEFAULT_RELEASE_BASE_U\n-         p, _, _ = platform.partition(\"-\" + FREETHREADED)\n- \n-         if FREETHREADED in platform:\n-+            if \"3.13\" in python_version:\n-+                aarch64_linux_suffix = \"lto\"\n-+            else:\n-+                aarch64_linux_suffix = \"pgo+lto\"\n-             build = \"{}+{}-full\".format(\n-                 FREETHREADED,\n-                 {\n-                     \"aarch64-apple-darwin\": \"pgo+lto\",\n--                    \"aarch64-unknown-linux-gnu\": \"lto\",\n-+                    \"aarch64-unknown-linux-gnu\": aarch64_linux_suffix,\n-                     \"ppc64le-unknown-linux-gnu\": \"lto\",\n-                     \"s390x-unknown-linux-gnu\": \"lto\",\n-                     \"x86_64-apple-darwin\": \"pgo+lto\",\n-@@ -793,9 +854,6 @@ def get_release_info(platform, python_version, base_url = DEFAULT_RELEASE_BASE_U\n-         else:\n-             build = \"install_only\"\n- \n--        if WINDOWS_NAME in platform:\n--            build = \"shared-\" + build\n--\n-         release_filename = u.format(\n-             platform = p,\n-             python_version = python_version,"
        },
        {
            "sha": "4b3c8c99885b1c96190b29b759922979905ffae5",
            "filename": "third_party/xla/third_party/py/rules_python3.patch",
            "status": "removed",
            "additions": 0,
            "deletions": 45,
            "changes": 45,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python3.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/06352207355a1a70a713b6d142d39bcf1857d832/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python3.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python3.patch?ref=06352207355a1a70a713b6d142d39bcf1857d832",
            "patch": "@@ -1,45 +0,0 @@\n-diff --git a/python/private/python_register_toolchains.bzl b/python/private/python_register_toolchains.bzl\n-index 98c8e5bf..fc533001 100644\n---- a/python/private/python_register_toolchains.bzl\n-+++ b/python/private/python_register_toolchains.bzl\n-@@ -86,6 +86,7 @@ def python_register_toolchains(\n-     minor_mapping = minor_mapping or MINOR_MAPPING\n-\n-     python_version = full_version(version = python_version, minor_mapping = minor_mapping)\n-+    python_version_kind = kwargs.pop(\"python_version_kind\", \"\")\n-\n-     toolchain_repo_name = \"{name}_toolchains\".format(name = name)\n-\n-@@ -165,6 +166,7 @@ def python_register_toolchains(\n-     toolchain_aliases(\n-         name = name,\n-         python_version = python_version,\n-+        python_version_kind = python_version_kind,\n-         user_repository_name = name,\n-         platforms = loaded_platforms,\n-     )\n-diff --git a/python/private/toolchains_repo.bzl b/python/private/toolchains_repo.bzl\n-index d21fb53a..a5271c18 100644\n---- a/python/private/toolchains_repo.bzl\n-+++ b/python/private/toolchains_repo.bzl\n-@@ -130,6 +130,9 @@ def _toolchain_aliases_impl(rctx):\n-     (os_name, arch) = _get_host_os_arch(rctx, logger)\n-\n-     host_platform = _get_host_platform(os_name, arch)\n-+    python_version_kind = rctx.attr.python_version_kind\n-+    if python_version_kind == \"ft\":\n-+        host_platform += \"-freethreaded\"\n-\n-     is_windows = (os_name == WINDOWS_NAME)\n-     python3_binary_path = \"python.exe\" if is_windows else \"bin/python3\"\n-@@ -233,6 +236,10 @@ actions.\"\"\",\n-             doc = \"List of platforms for which aliases shall be created\",\n-         ),\n-         \"python_version\": attr.string(doc = \"The Python version.\"),\n-+        \"python_version_kind\": attr.string(\n-+            doc = \"Python version kind, e.g. ft (free-threaded)\",\n-+            default = \"\"\n-+        ),\n-         \"user_repository_name\": attr.string(\n-             mandatory = True,\n-             doc = \"The base name for all created repositories, like 'python38'.\",\n\\ No newline at end of file"
        },
        {
            "sha": "8472f26bd8c7c42360ed67451a34f4f96f5cd9b3",
            "filename": "third_party/xla/third_party/py/rules_python_freethreaded.patch",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python_freethreaded.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python_freethreaded.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python_freethreaded.patch?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -0,0 +1,13 @@\n+diff --git a/python/private/toolchains_repo.bzl b/python/private/toolchains_repo.bzl\n+index 93bbb521..f7ff19c3 100644\n+--- a/python/private/toolchains_repo.bzl\n++++ b/python/private/toolchains_repo.bzl\n+@@ -214,7 +214,7 @@ def python_toolchain_build_file_content(\n+             user_repository_name = \"{}_{}\".format(user_repository_name, platform),\n+             python_version = python_version,\n+             set_python_version_constraint = set_python_version_constraint,\n+-            target_settings = [],\n++            target_settings = meta.target_settings,\n+         ))\n+     return \"\\n\\n\".join(entries)\n+ \n\\ No newline at end of file"
        },
        {
            "sha": "5c761d191021e3ba0f6ccae95f7c3b76a5eb0205",
            "filename": "third_party/xla/third_party/py/rules_python_pip_version.patch",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python_pip_version.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python_pip_version.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_python_pip_version.patch?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -0,0 +1,26 @@\n+diff --git a/python/private/pypi/deps.bzl b/python/private/pypi/deps.bzl\n+index 8949ed4a..8d0ab0e7 100644\n+--- a/python/private/pypi/deps.bzl\n++++ b/python/private/pypi/deps.bzl\n+@@ -51,8 +51,8 @@ _RULE_DEPS = [\n+     ),\n+     (\n+         \"pypi__packaging\",\n+-        \"https://files.pythonhosted.org/packages/49/df/1fceb2f8900f8639e278b056416d49134fb8d84c5942ffaa01ad34782422/packaging-24.0-py3-none-any.whl\",\n+-        \"2ddfb553fdf02fb784c234c7ba6ccc288296ceabec964ad2eae3777778130bc5\",\n++        \"https://files.pythonhosted.org/packages/88/ef/eb23f262cca3c0c4eb7ab1933c3b1f03d021f2c48f54763065b6f0e321be/packaging-24.2-py3-none-any.whl\",\n++        \"09abb1bccd265c01f4a3aa3f7a7db064b36514d2cba19a2f694fe6150451a759\",\n+     ),\n+     (\n+         \"pypi__pep517\",\n+@@ -61,8 +61,8 @@ _RULE_DEPS = [\n+     ),\n+     (\n+         \"pypi__pip\",\n+-        \"https://files.pythonhosted.org/packages/8a/6a/19e9fe04fca059ccf770861c7d5721ab4c2aebc539889e97c7977528a53b/pip-24.0-py3-none-any.whl\",\n+-        \"ba0d021a166865d2265246961bec0152ff124de910c5cc39f1156ce3fa7c69dc\",\n++        \"https://files.pythonhosted.org/packages/ef/7d/500c9ad20238fcfcb4cb9243eede163594d7020ce87bd9610c9e02771876/pip-24.3.1-py3-none-any.whl\",\n++        \"3790624780082365f47549d032f3770eeb2b1e8bd1f7b2e02dace1afa361b4ed\",\n+     ),\n+     (\n+         \"pypi__pip_tools\","
        },
        {
            "sha": "3b78f0de1b03d4bdeec400b0d7c4d2d5ed4201e6",
            "filename": "third_party/xla/third_party/py/rules_pywrap/pywrap.impl.bzl",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_pywrap%2Fpywrap.impl.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_pywrap%2Fpywrap.impl.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fpy%2Frules_pywrap%2Fpywrap.impl.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -2,6 +2,7 @@ load(\"@bazel_tools//tools/cpp:toolchain_utils.bzl\", \"find_cpp_toolchain\", \"use_c\n load(\"@rules_cc//cc:cc_binary.bzl\", \"cc_binary\")\n load(\"@rules_cc//cc:cc_import.bzl\", \"cc_import\")\n load(\"@rules_cc//cc:cc_library.bzl\", \"cc_library\")\n+load(\"@rules_python//python:py_info.bzl\", \"PyInfo\")\n load(\"@rules_python//python:py_library.bzl\", \"py_library\")\n \n PywrapInfo = provider("
        },
        {
            "sha": "92254682422a39c14cf904bf4b14536a98e950d1",
            "filename": "third_party/xla/workspace2.bzl",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fworkspace2.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/3eae65361bdfaf5c54986491e48ca2d7e8782ffe/third_party%2Fxla%2Fworkspace2.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fworkspace2.bzl?ref=3eae65361bdfaf5c54986491e48ca2d7e8782ffe",
            "patch": "@@ -3,6 +3,7 @@\n load(\"@bazel_features//:deps.bzl\", \"bazel_features_deps\")\n load(\"@bazel_skylib//lib:versions.bzl\", \"versions\")\n load(\"@bazel_tools//tools/build_defs/repo:java.bzl\", \"java_import_external\")\n+load(\"@bazel_tools//tools/build_defs/repo:utils.bzl\", \"maybe\")\n load(\"@io_bazel_rules_closure//closure:defs.bzl\", \"filegroup_external\")\n load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n load(\"//third_party/absl:workspace.bzl\", absl = \"repo\")\n@@ -305,7 +306,9 @@ def _tf_repositories():\n         },\n     )\n \n-    tf_http_archive(\n+    # `com_google_protobuf` is initialized in `python_init_rules()`.\n+    maybe(\n+        tf_http_archive,\n         name = \"com_google_protobuf\",\n         patch_file = [\"//third_party/protobuf:protobuf.patch\"],\n         sha256 = \"6e09bbc950ba60c3a7b30280210cd285af8d7d8ed5e0a6ed101c72aff22e8d88\","
        }
    ],
    "stats": {
        "total": 1015,
        "additions": 323,
        "deletions": 692
    }
}