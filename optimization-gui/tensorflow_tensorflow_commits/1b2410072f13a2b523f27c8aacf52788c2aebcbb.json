{
    "author": "tensorflower-gardener",
    "message": "Remove no-op flag xla_gpu_redzone_scratch_max_megabytes.\n\n- Functionality was removed 2 years ago.\n\nPiperOrigin-RevId: 807218428",
    "sha": "1b2410072f13a2b523f27c8aacf52788c2aebcbb",
    "files": [
        {
            "sha": "63fa5ab947b31644120d63742db08a45135555b2",
            "filename": "third_party/xla/xla/debug_options_flags.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 8,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/1b2410072f13a2b523f27c8aacf52788c2aebcbb/third_party%2Fxla%2Fxla%2Fdebug_options_flags.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/1b2410072f13a2b523f27c8aacf52788c2aebcbb/third_party%2Fxla%2Fxla%2Fdebug_options_flags.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fdebug_options_flags.cc?ref=1b2410072f13a2b523f27c8aacf52788c2aebcbb",
            "patch": "@@ -283,8 +283,6 @@ DebugOptions DefaultDebugOptionsIgnoringFlags() {\n   opts.set_xla_gpu_temp_buffer_use_separate_color(false);\n   opts.set_xla_gpu_require_exclusive_lock(false);\n \n-  // Set 4GB space limit for redzone scratch allocator.\n-  opts.set_xla_gpu_redzone_scratch_max_megabytes(1LL << 12);\n   opts.set_xla_gpu_redzone_padding_bytes(8 * 1024 * 1024);\n   opts.set_xla_gpu_shape_checks(DebugOptions::RUNTIME);\n   opts.set_xla_dump_latency_hiding_schedule(false);\n@@ -1744,12 +1742,6 @@ void MakeDebugOptionsFlags(std::vector<tsl::Flag>* flag_list,\n       \"Maximum number of ranks associated with a root rank to initialize a \"\n       \"NCCL communicator via ncclCommInitRankScalable. \"\n       \"A value of zero will lead to a single root.\"));\n-  flag_list->push_back(tsl::Flag(\n-      \"xla_gpu_redzone_scratch_max_megabytes\",\n-      int64_setter_for(\n-          &DebugOptions::set_xla_gpu_redzone_scratch_max_megabytes),\n-      debug_options->xla_gpu_redzone_scratch_max_megabytes(),\n-      \"Max size (in megabytes) for the GPU redzone scratch allocator.\"));\n   flag_list->push_back(tsl::Flag(\n       \"xla_gpu_redzone_padding_bytes\",\n       int64_setter_for(&DebugOptions::set_xla_gpu_redzone_padding_bytes),"
        },
        {
            "sha": "84f8c68cdda4504f3ec2009eba444e11854eb120",
            "filename": "third_party/xla/xla/pjrt/pjrt_executable_test.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/1b2410072f13a2b523f27c8aacf52788c2aebcbb/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_executable_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/1b2410072f13a2b523f27c8aacf52788c2aebcbb/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_executable_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_executable_test.cc?ref=1b2410072f13a2b523f27c8aacf52788c2aebcbb",
            "patch": "@@ -102,7 +102,6 @@ TEST(ExecuteOptionsTest, ApplyOptionsCanParseStringsAndEnums) {\n   src.env_option_overrides = {\n       {\"xla_gpu_use_runtime_fusion\", std::string(\"True\")},\n       {\"xla_gpu_graph_min_graph_size\", std::string(\"2\")},\n-      {\"xla_gpu_redzone_scratch_max_megabytes\", std::string(\"3400\")},\n       {\"xla_gpu_auto_spmd_partitioning_memory_budget_ratio\", 0.9},\n       {\"xla_gpu_pgle_profile_file_or_directory_path\", std::string(\"abc\")},\n       // Repeated fields.\n@@ -119,7 +118,6 @@ TEST(ExecuteOptionsTest, ApplyOptionsCanParseStringsAndEnums) {\n   auto& debug_options = src.executable_build_options.debug_options();\n   EXPECT_EQ(debug_options.xla_gpu_use_runtime_fusion(), true);\n   EXPECT_EQ(debug_options.xla_gpu_graph_min_graph_size(), 2);\n-  EXPECT_EQ(debug_options.xla_gpu_redzone_scratch_max_megabytes(), 3400);\n   EXPECT_FLOAT_EQ(\n       debug_options.xla_gpu_auto_spmd_partitioning_memory_budget_ratio(), 0.9);\n   EXPECT_EQ(debug_options.xla_gpu_pgle_profile_file_or_directory_path(), \"abc\");"
        },
        {
            "sha": "9509df428cf69f2172b345e89ebacb170520bef6",
            "filename": "third_party/xla/xla/xla.proto",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/1b2410072f13a2b523f27c8aacf52788c2aebcbb/third_party%2Fxla%2Fxla%2Fxla.proto",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/1b2410072f13a2b523f27c8aacf52788c2aebcbb/third_party%2Fxla%2Fxla%2Fxla.proto",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fxla.proto?ref=1b2410072f13a2b523f27c8aacf52788c2aebcbb",
            "patch": "@@ -818,9 +818,6 @@ message DebugOptions {\n   // scratch), so this can be multiplied by quite a lot.\n   optional int64 xla_gpu_redzone_padding_bytes = 228;\n \n-  // Size threshold (in megabytes) for the GPU redzone scratch allocator.\n-  optional int64 xla_gpu_redzone_scratch_max_megabytes = 167;\n-\n   // If true, will require complete AOT autotuning results; in the case of\n   // missing AOT result, the model will not be compiled or executed, a\n   // `NotFound` error will be returned.\n@@ -919,6 +916,7 @@ message DebugOptions {\n \n   // go/keep-sorted end\n \n+  reserved 167;  // xla_gpu_redzone_scratch_max_megabytes\n   reserved 276;  // xla_gpu_enable_nccl_per_stream_comms\n   reserved 226;  // xla_gpu_triton_gemm_disable_reduced_precision_reduction\n   reserved 385;  // xla_gpu_experimental_enable_dynamic_dot_search_space"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 1,
        "deletions": 13
    }
}