{
    "author": "ermilovmaxim",
    "message": "switch from deprecated TF_CHECK_OK\n\nPiperOrigin-RevId: 846448345",
    "sha": "decbcf45d973916d1e0f8101eab3b1f3f105e837",
    "files": [
        {
            "sha": "b48a8ef6411711027f96c1d01f30231bf2f66f5e",
            "filename": "tensorflow/compiler/mlir/lite/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Flite%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Flite%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Flite%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -1699,6 +1699,7 @@ cc_library(\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/container:flat_hash_set\",\n         \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\",\n@@ -1714,7 +1715,6 @@ cc_library(\n         \"@llvm-project//mlir:Support\",\n         \"@llvm-project//mlir:TranslateLib\",\n         \"@local_xla//xla/tsl/platform:errors\",\n-        \"@local_xla//xla/tsl/platform:status\",\n         \"@local_xla//xla/tsl/platform:statusor\",\n         \"@stablehlo//:stablehlo_ops\",\n         \"@stablehlo//:vhlo_ops\","
        },
        {
            "sha": "ab7d782dba8d3304ad66a3a257eddbfd518e0bfd",
            "filename": "tensorflow/compiler/mlir/lite/flatbuffer_import.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Flite%2Fflatbuffer_import.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Flite%2Fflatbuffer_import.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Flite%2Fflatbuffer_import.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -29,6 +29,7 @@ limitations under the License.\n \n #include \"absl/container/flat_hash_map.h\"\n #include \"absl/container/flat_hash_set.h\"\n+#include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n@@ -101,7 +102,6 @@ limitations under the License.\n #include \"tensorflow/compiler/mlir/tensorflow/utils/dynamic_shape_utils.h\"\n #include \"tensorflow/compiler/mlir/tensorflow/utils/mangling_util.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"tensorflow/core/framework/tensor.pb.h\"\n #include \"tensorflow/core/framework/tensor_shape.pb.h\"\n@@ -974,8 +974,8 @@ StatusOr<Operation*> ConvertOp(\n   if (op_name == \"tfl.lstm\") {\n     // TODO(b/147587779): add the right region if region is empty.\n     op_state.addRegion();\n-    TF_CHECK_OK(AddOpIntermediatesForLstm(op, intermediate_types, op_state, loc,\n-                                          builder));\n+    CHECK_OK(AddOpIntermediatesForLstm(op, intermediate_types, op_state, loc,\n+                                       builder));\n   }\n   if (op_name == \"tfl.while\") {\n     // Adds two empty regions for \"tfl.while\". We will fill the regions after\n@@ -986,8 +986,8 @@ StatusOr<Operation*> ConvertOp(\n     op_state.addRegion();\n   }\n   if (op_name == \"tfl.unidirectional_sequence_lstm\") {\n-    TF_CHECK_OK(AddOpIntermediatesForLstm(op, intermediate_types, op_state, loc,\n-                                          builder));\n+    CHECK_OK(AddOpIntermediatesForLstm(op, intermediate_types, op_state, loc,\n+                                       builder));\n   }\n   if (op_name == \"tfl.reshape\") {\n     // Flattens reshape ops when more than one dimension shape operand is given."
        },
        {
            "sha": "b06568589dadf2763d35e80586b196406b4bcf08",
            "filename": "tensorflow/compiler/mlir/quantization/tensorflow/calibrator/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcalibrator%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcalibrator%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcalibrator%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -221,9 +221,9 @@ tf_cc_test(\n         \"//tensorflow/core:test\",\n         \"//tensorflow/core:test_main\",\n         \"//tensorflow/core:testlib\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:status_matchers\",\n         \"@com_google_googletest//:gtest\",\n         \"@local_xla//xla/tsl/platform:errors\",\n-        \"@local_xla//xla/tsl/platform:status\",\n     ],\n )"
        },
        {
            "sha": "7f8f2623b7bfa082fef268476f2983093aa99c3d",
            "filename": "tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics_saver_op_test.cc",
            "status": "modified",
            "additions": 54,
            "deletions": 58,
            "changes": 112,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcalibrator%2Fcalibration_statistics_saver_op_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcalibrator%2Fcalibration_statistics_saver_op_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcalibrator%2Fcalibration_statistics_saver_op_test.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -19,11 +19,11 @@ limitations under the License.\n \n #include <gmock/gmock.h>\n #include <gtest/gtest.h>\n+#include \"absl/log/check.h\"\n #include \"absl/status/status_matchers.h\"\n #include \"tensorflow/compiler/mlir/quantization/stablehlo/quantization_config.pb.h\"\n #include \"tensorflow/compiler/mlir/quantization/tensorflow/calibrator/calibration_statistics.pb.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"tensorflow/core/framework/node_def_builder.h\"\n #include \"tensorflow/core/framework/tensor_shape.h\"\n #include \"tensorflow/core/framework/types.pb.h\"\n@@ -55,11 +55,11 @@ TEST_F(CalibrationStatisticsSaverTest, MissingOutputPath) {\n   inputs.emplace_back(\"min\", 0, DT_FLOAT);\n   inputs.emplace_back(\"max\", 0, DT_FLOAT);\n \n-  TF_CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n-                  .Input(inputs)\n-                  .Attr(\"ids\", ids)\n-                  .Attr(\"calibration_methods\", calibration_methods)\n-                  .Finalize(node_def()));\n+  CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n+               .Input(inputs)\n+               .Attr(\"ids\", ids)\n+               .Attr(\"calibration_methods\", calibration_methods)\n+               .Finalize(node_def()));\n   ASSERT_THAT(InitOp(),\n               absl_testing::StatusIs(\n                   tsl::error::INVALID_ARGUMENT,\n@@ -75,12 +75,12 @@ TEST_F(CalibrationStatisticsSaverTest, WrongNumInputs) {\n   inputs.emplace_back(\"min\", 0, DT_FLOAT);\n   inputs.emplace_back(\"max\", 0, DT_FLOAT);\n \n-  TF_CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n-                  .Input(inputs)\n-                  .Attr(\"ids\", ids)\n-                  .Attr(\"calibration_methods\", calibration_methods)\n-                  .Attr(\"output_file_path\", \"/tmp/statistics.pbtxt\")\n-                  .Finalize(node_def()));\n+  CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n+               .Input(inputs)\n+               .Attr(\"ids\", ids)\n+               .Attr(\"calibration_methods\", calibration_methods)\n+               .Attr(\"output_file_path\", \"/tmp/statistics.pbtxt\")\n+               .Finalize(node_def()));\n   ASSERT_THAT(InitOp(),\n               absl_testing::StatusIs(\n                   tsl::error::ABORTED,\n@@ -98,12 +98,12 @@ TEST_F(CalibrationStatisticsSaverTest, WrongInputTypes) {\n   inputs.emplace_back(\"max\", 0, DT_FLOAT);\n   inputs.emplace_back(\"histogram\", 0, DT_FLOAT);\n \n-  TF_CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n-                  .Input(inputs)\n-                  .Attr(\"ids\", ids)\n-                  .Attr(\"calibration_methods\", calibration_methods)\n-                  .Attr(\"output_file_path\", \"/tmp/statistics.pbtxt\")\n-                  .Finalize(node_def()));\n+  CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n+               .Input(inputs)\n+               .Attr(\"ids\", ids)\n+               .Attr(\"calibration_methods\", calibration_methods)\n+               .Attr(\"output_file_path\", \"/tmp/statistics.pbtxt\")\n+               .Finalize(node_def()));\n   ASSERT_THAT(InitOp(),\n               absl_testing::StatusIs(\n                   tsl::error::ABORTED,\n@@ -123,24 +123,23 @@ TEST_F(CalibrationStatisticsSaverTest, SimpleMinMax) {\n   const std::string dir = testing::TmpDir();\n   const std::string output_file_path = io::JoinPath(dir, \"statistics.pbtxt\");\n \n-  TF_CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n-                  .Input(inputs)\n-                  .Attr(\"ids\", ids)\n-                  .Attr(\"calibration_methods\", calibration_methods)\n-                  .Attr(\"output_file_path\", output_file_path)\n-                  .Finalize(node_def()));\n-  TF_CHECK_OK(InitOp());\n+  CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n+               .Input(inputs)\n+               .Attr(\"ids\", ids)\n+               .Attr(\"calibration_methods\", calibration_methods)\n+               .Attr(\"output_file_path\", output_file_path)\n+               .Finalize(node_def()));\n+  CHECK_OK(InitOp());\n \n   AddInputFromArray<float>(TensorShape({}), {1.f});\n   AddInputFromArray<float>(TensorShape({}), {5.f});\n   AddInputFromArray<int64_t>(TensorShape({0}), {});\n \n-  TF_CHECK_OK(RunOpKernel());\n+  CHECK_OK(RunOpKernel());\n   kernel_.reset();\n \n   CalibrationStatisticsMap statistics_map;\n-  TF_CHECK_OK(\n-      ReadBinaryProto(Env::Default(), output_file_path, &statistics_map));\n+  CHECK_OK(ReadBinaryProto(Env::Default(), output_file_path, &statistics_map));\n   ASSERT_THAT(statistics_map.statistics(), SizeIs(1));\n   ASSERT_THAT(statistics_map.statistics(), ElementsAre(Key(\"1\")));\n \n@@ -163,24 +162,23 @@ TEST_F(CalibrationStatisticsSaverTest, SimpleAverageMinMax) {\n   const std::string dir = testing::TmpDir();\n   const std::string output_file_path = io::JoinPath(dir, \"statistics.pbtxt\");\n \n-  TF_CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n-                  .Input(inputs)\n-                  .Attr(\"ids\", ids)\n-                  .Attr(\"calibration_methods\", calibration_methods)\n-                  .Attr(\"output_file_path\", output_file_path)\n-                  .Finalize(node_def()));\n-  TF_CHECK_OK(InitOp());\n+  CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n+               .Input(inputs)\n+               .Attr(\"ids\", ids)\n+               .Attr(\"calibration_methods\", calibration_methods)\n+               .Attr(\"output_file_path\", output_file_path)\n+               .Finalize(node_def()));\n+  CHECK_OK(InitOp());\n \n   AddInputFromArray<float>(TensorShape({}), {1.f});\n   AddInputFromArray<float>(TensorShape({}), {5.f});\n   AddInputFromArray<int64_t>(TensorShape({0}), {});\n \n-  TF_CHECK_OK(RunOpKernel());\n+  CHECK_OK(RunOpKernel());\n   kernel_.reset();\n \n   CalibrationStatisticsMap statistics_map;\n-  TF_CHECK_OK(\n-      ReadBinaryProto(Env::Default(), output_file_path, &statistics_map));\n+  CHECK_OK(ReadBinaryProto(Env::Default(), output_file_path, &statistics_map));\n   ASSERT_THAT(statistics_map.statistics(), SizeIs(1));\n   ASSERT_THAT(statistics_map.statistics(), ElementsAre(Key(\"1\")));\n \n@@ -204,24 +202,23 @@ TEST_F(CalibrationStatisticsSaverTest, SimpleHistogram) {\n   const std::string dir = testing::TmpDir();\n   const std::string output_file_path = io::JoinPath(dir, \"statistics.pbtxt\");\n \n-  TF_CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n-                  .Input(inputs)\n-                  .Attr(\"ids\", ids)\n-                  .Attr(\"calibration_methods\", calibration_methods)\n-                  .Attr(\"output_file_path\", output_file_path)\n-                  .Finalize(node_def()));\n-  TF_CHECK_OK(InitOp());\n+  CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n+               .Input(inputs)\n+               .Attr(\"ids\", ids)\n+               .Attr(\"calibration_methods\", calibration_methods)\n+               .Attr(\"output_file_path\", output_file_path)\n+               .Finalize(node_def()));\n+  CHECK_OK(InitOp());\n \n   AddInputFromArray<float>(TensorShape({}), {1.f});\n   AddInputFromArray<float>(TensorShape({}), {5.f});\n   AddInputFromArray<int64_t>(TensorShape({8}), {1, 4, 6, 7, 3, 2, 1, 0});\n \n-  TF_CHECK_OK(RunOpKernel());\n+  CHECK_OK(RunOpKernel());\n   kernel_.reset();\n \n   CalibrationStatisticsMap statistics_map;\n-  TF_CHECK_OK(\n-      ReadBinaryProto(Env::Default(), output_file_path, &statistics_map));\n+  CHECK_OK(ReadBinaryProto(Env::Default(), output_file_path, &statistics_map));\n   ASSERT_THAT(statistics_map.statistics(), SizeIs(1));\n   ASSERT_THAT(statistics_map.statistics(), ElementsAre(Key(\"1\")));\n \n@@ -250,13 +247,13 @@ TEST_F(CalibrationStatisticsSaverTest, MultipleStats) {\n   const std::string dir = testing::TmpDir();\n   const std::string output_file_path = io::JoinPath(dir, \"statistics.pbtxt\");\n \n-  TF_CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n-                  .Input(inputs)\n-                  .Attr(\"ids\", ids)\n-                  .Attr(\"calibration_methods\", calibration_methods)\n-                  .Attr(\"output_file_path\", output_file_path)\n-                  .Finalize(node_def()));\n-  TF_CHECK_OK(InitOp());\n+  CHECK_OK(NodeDefBuilder(\"op\", \"CalibrationStatisticsSaver\")\n+               .Input(inputs)\n+               .Attr(\"ids\", ids)\n+               .Attr(\"calibration_methods\", calibration_methods)\n+               .Attr(\"output_file_path\", output_file_path)\n+               .Finalize(node_def()));\n+  CHECK_OK(InitOp());\n \n   AddInputFromArray<float>(TensorShape({}), {1.f});\n   AddInputFromArray<float>(TensorShape({}), {5.f});\n@@ -265,12 +262,11 @@ TEST_F(CalibrationStatisticsSaverTest, MultipleStats) {\n   AddInputFromArray<float>(TensorShape({}), {5.f});\n   AddInputFromArray<int64_t>(TensorShape({8}), {1, 4, 6, 7, 3, 2, 1, 0});\n \n-  TF_CHECK_OK(RunOpKernel());\n+  CHECK_OK(RunOpKernel());\n   kernel_.reset();\n \n   CalibrationStatisticsMap statistics_map;\n-  TF_CHECK_OK(\n-      ReadBinaryProto(Env::Default(), output_file_path, &statistics_map));\n+  CHECK_OK(ReadBinaryProto(Env::Default(), output_file_path, &statistics_map));\n   ASSERT_THAT(statistics_map.statistics(), SizeIs(2));\n   ASSERT_THAT(statistics_map.statistics(), Contains(Key(\"1\")));\n   ASSERT_THAT(statistics_map.statistics(), Contains(Key(\"2\")));"
        },
        {
            "sha": "99f2d2a52e1a925ee557c6eb45feb77535760d33",
            "filename": "tensorflow/compiler/mlir/quantization/tensorflow/cc/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcc%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcc%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcc%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -54,6 +54,7 @@ tf_cc_test(\n         \"//tensorflow/core/framework:tensor_testutil\",\n         \"//tensorflow/core/util/tensor_bundle\",\n         \"@com_google_absl//absl/cleanup\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:status_matchers\",\n         \"@com_google_absl//absl/status:statusor\",\n@@ -62,7 +63,6 @@ tf_cc_test(\n         \"@llvm-project//mlir:FuncDialect\",\n         \"@llvm-project//mlir:IR\",\n         \"@llvm-project//mlir:Parser\",\n-        \"@local_xla//xla/tsl/platform:status\",\n     ],\n )\n "
        },
        {
            "sha": "3c5d085d7655aa8b94ecd5a27ab33a68237091d3",
            "filename": "tensorflow/compiler/mlir/quantization/tensorflow/cc/save_variables_test.cc",
            "status": "modified",
            "additions": 18,
            "deletions": 18,
            "changes": 36,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcc%2Fsave_variables_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcc%2Fsave_variables_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Fquantization%2Ftensorflow%2Fcc%2Fsave_variables_test.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -20,6 +20,7 @@ limitations under the License.\n \n #include <gmock/gmock.h>\n #include \"absl/cleanup/cleanup.h\"\n+#include \"absl/log/check.h\"\n #include \"absl/status/status.h\"\n #include \"absl/status/status_matchers.h\"\n #include \"absl/status/statusor.h\"\n@@ -31,7 +32,6 @@ limitations under the License.\n #include \"mlir/Parser/Parser.h\"  // from @llvm-project\n #include \"tensorflow/compiler/mlir/tensorflow/ir/tf_dialect.h\"\n #include \"tensorflow/compiler/mlir/tensorflow/ir/tf_saved_model.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"tensorflow/core/framework/tensor.h\"\n #include \"tensorflow/core/framework/tensor_testutil.h\"\n #include \"tensorflow/core/framework/types.pb.h\"\n@@ -63,7 +63,7 @@ class SaveVariablesToCheckpointTest : public ::testing::Test {\n       return absl::InternalError(\"Failed to create temp file.\");\n     }\n \n-    TF_CHECK_OK(env_->CreateDir(tmp_dir));\n+    CHECK_OK(env_->CreateDir(tmp_dir));\n     return tmp_dir;\n   }\n \n@@ -103,8 +103,8 @@ TEST_F(SaveVariablesToCheckpointTest, VariableSavedToCheckpoint) {\n \n   const absl::Cleanup checkpoint_prefix_cleanup = [this, &checkpoint_prefix]() {\n     int64_t undeleted_files, undeleted_dirs;\n-    TF_CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n-                                        &undeleted_dirs));\n+    CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n+                                     &undeleted_dirs));\n   };\n \n   const absl::StatusOr<std::vector<std::string>> variable_shared_names =\n@@ -149,8 +149,8 @@ TEST_F(SaveVariablesToCheckpointTest, MultipleVariablesSavedToCheckpoint) {\n \n   const absl::Cleanup checkpoint_prefix_cleanup = [this, &checkpoint_prefix]() {\n     int64_t undeleted_files, undeleted_dirs;\n-    TF_CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n-                                        &undeleted_dirs));\n+    CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n+                                     &undeleted_dirs));\n   };\n \n   const absl::StatusOr<std::vector<std::string>> variable_shared_names =\n@@ -186,8 +186,8 @@ TEST_F(SaveVariablesToCheckpointTest,\n \n   const absl::Cleanup checkpoint_prefix_cleanup = [this, &checkpoint_prefix]() {\n     int64_t undeleted_files, undeleted_dirs;\n-    TF_CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n-                                        &undeleted_dirs));\n+    CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n+                                     &undeleted_dirs));\n   };\n \n   const absl::StatusOr<std::vector<std::string>> variable_shared_names =\n@@ -218,8 +218,8 @@ TEST_F(SaveVariablesToCheckpointTest,\n \n   const absl::Cleanup checkpoint_prefix_cleanup = [this, &checkpoint_prefix]() {\n     int64_t undeleted_files, undeleted_dirs;\n-    TF_CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n-                                        &undeleted_dirs));\n+    CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n+                                     &undeleted_dirs));\n   };\n \n   EXPECT_TRUE(\n@@ -253,8 +253,8 @@ TEST_F(SaveVariablesToCheckpointTest,\n \n   const absl::Cleanup checkpoint_prefix_cleanup = [this, &checkpoint_prefix]() {\n     int64_t undeleted_files, undeleted_dirs;\n-    TF_CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n-                                        &undeleted_dirs));\n+    CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n+                                     &undeleted_dirs));\n   };\n \n   const absl::StatusOr<std::vector<std::string>> variable_shared_names =\n@@ -293,8 +293,8 @@ TEST_F(SaveVariablesToCheckpointTest, MutableVariablesNotSaved) {\n \n   const absl::Cleanup checkpoint_prefix_cleanup = [this, &checkpoint_prefix]() {\n     int64_t undeleted_files, undeleted_dirs;\n-    TF_CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n-                                        &undeleted_dirs));\n+    CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n+                                     &undeleted_dirs));\n   };\n \n   const absl::StatusOr<std::vector<std::string>> variable_shared_names =\n@@ -330,8 +330,8 @@ TEST_F(SaveVariablesToCheckpointTest,\n \n   const absl::Cleanup checkpoint_prefix_cleanup = [this, &checkpoint_prefix]() {\n     int64_t undeleted_files, undeleted_dirs;\n-    TF_CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n-                                        &undeleted_dirs));\n+    CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n+                                     &undeleted_dirs));\n   };\n \n   const absl::StatusOr<std::vector<std::string>> variable_shared_names =\n@@ -371,8 +371,8 @@ TEST_F(SaveVariablesToCheckpointTest, FailsWhenDuplicateSharedName) {\n \n   const absl::Cleanup checkpoint_prefix_cleanup = [this, &checkpoint_prefix]() {\n     int64_t undeleted_files, undeleted_dirs;\n-    TF_CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n-                                        &undeleted_dirs));\n+    CHECK_OK(env_->DeleteRecursively(*checkpoint_prefix, &undeleted_files,\n+                                     &undeleted_dirs));\n   };\n \n   EXPECT_FALSE("
        },
        {
            "sha": "494c23f1344e9bfedfa960563c11fbeeebafb5ca",
            "filename": "tensorflow/compiler/mlir/tensorflow/BUILD",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftensorflow%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftensorflow%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftensorflow%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -574,10 +574,11 @@ cc_library(\n         \"//tensorflow/core:framework_internal\",\n         \"//tensorflow/core:protos_all_cc\",\n         \"//tensorflow/core:session_options\",\n-        \"//tensorflow/core/common_runtime:threadpool_device\",\n         \"//tensorflow/core/platform:errors\",\n         \"//tensorflow/core/platform:status\",\n         \"//tensorflow/core/platform:threadpool_options\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n         \"@llvm-project//llvm:Support\",\n     ],\n@@ -1311,8 +1312,10 @@ tf_cc_test(\n         \"//tensorflow/core:test\",\n         \"//tensorflow/core:test_main\",\n         \"//tensorflow/core/platform:test\",\n-        \"@llvm-project//llvm:Support\",\n-        \"@llvm-project//mlir:IR\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/strings:string_view\",\n     ],\n )\n "
        },
        {
            "sha": "3fea8e64e85ca37e92a40f61184fa078337976bf",
            "filename": "tensorflow/compiler/mlir/tensorflow/utils/dump_graph_test.cc",
            "status": "modified",
            "additions": 14,
            "deletions": 3,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftensorflow%2Futils%2Fdump_graph_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftensorflow%2Futils%2Fdump_graph_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftensorflow%2Futils%2Fdump_graph_test.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -15,11 +15,22 @@ limitations under the License.\n \n #include \"tensorflow/compiler/mlir/tensorflow/utils/dump_graph.h\"\n \n+#include <cstdint>\n+#include <string>\n+\n+#include \"absl/log/check.h\"\n+#include \"absl/status/status.h\"\n+#include \"absl/strings/match.h\"\n+#include \"absl/strings/str_cat.h\"\n+#include \"absl/strings/string_view.h\"\n+#include \"xla/tsl/lib/core/status_test_util.h\"\n+#include \"tensorflow/core/framework/op.h\"\n #include \"tensorflow/core/graph/graph.h\"\n #include \"tensorflow/core/graph/node_builder.h\"\n-#include \"tensorflow/core/lib/core/status_test_util.h\"\n #include \"tensorflow/core/lib/io/path.h\"\n #include \"tensorflow/core/platform/env.h\"\n+#include \"tensorflow/core/platform/errors.h\"\n+#include \"tensorflow/core/platform/file_system.h\"\n #include \"tensorflow/core/platform/test.h\"\n #include \"tensorflow/core/util/dump_graph.h\"\n \n@@ -68,7 +79,7 @@ class StringWritableFile : public WritableFile {\n TEST(Dump, TextualIrToFileSuccess) {\n   Graph graph(OpRegistry::Global());\n   Node* node;\n-  TF_CHECK_OK(NodeBuilder(\"A\", \"NoOp\").Finalize(&graph, &node));\n+  CHECK_OK(NodeBuilder(\"A\", \"NoOp\").Finalize(&graph, &node));\n \n   setenv(\"TF_DUMP_GRAPH_PREFIX\", testing::TmpDir().c_str(), 1);\n   UseMlirForGraphDump(MlirDumpConfig());\n@@ -98,7 +109,7 @@ TEST(Dump, TextualIrWithOptions) {\n TEST(Dump, DumpToTFG) {\n   Graph graph(OpRegistry::Global());\n   Node* node;\n-  TF_CHECK_OK(NodeBuilder(\"A\", \"NoOp\").Finalize(&graph, &node));\n+  CHECK_OK(NodeBuilder(\"A\", \"NoOp\").Finalize(&graph, &node));\n \n   std::string actual;\n   StringWritableFile file(&actual);"
        },
        {
            "sha": "cb406a2d0e3fc9ca6558c45c32cae5d02f0948be",
            "filename": "tensorflow/compiler/mlir/tensorflow/utils/fake_session.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftensorflow%2Futils%2Ffake_session.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftensorflow%2Futils%2Ffake_session.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftensorflow%2Futils%2Ffake_session.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -19,17 +19,21 @@ limitations under the License.\n #include <utility>\n #include <vector>\n \n+#include \"absl/log/check.h\"\n+#include \"absl/status/status.h\"\n #include \"absl/strings/match.h\"\n #include \"llvm/Support/CommandLine.h\"\n #include \"tensorflow/core/common_runtime/device_mgr.h\"\n-#include \"tensorflow/core/common_runtime/threadpool_device.h\"\n-#include \"tensorflow/core/framework/allocator.h\"\n #include \"tensorflow/core/framework/device_attributes.pb.h\"\n #include \"tensorflow/core/framework/device_factory.h\"\n+#include \"tensorflow/core/framework/resource_handle.h\"\n #include \"tensorflow/core/framework/resource_mgr.h\"\n #include \"tensorflow/core/framework/resource_var.h\"\n+#include \"tensorflow/core/framework/tensor.h\"\n+#include \"tensorflow/core/framework/tensor_shape.h\"\n #include \"tensorflow/core/framework/types.pb.h\"\n-#include \"tensorflow/core/graph/types.h\"\n+#include \"tensorflow/core/platform/errors.h\"\n+#include \"tensorflow/core/platform/status.h\"\n #include \"tensorflow/core/platform/threadpool_options.h\"\n #include \"tensorflow/core/protobuf/error_codes.pb.h\"\n #include \"tensorflow/core/public/session_options.h\"\n@@ -81,9 +85,9 @@ void FakeSession::InitVariables() {\n   auto container = device->resource_manager()->default_container();\n \n   // Create 2 resources and initialize them with dummy values.\n-  TF_CHECK_OK(device->resource_manager()->Create(\n+  CHECK_OK(device->resource_manager()->Create(\n       container, \"var1\", new tensorflow::Var(tensorflow::DataType::DT_FLOAT)));\n-  TF_CHECK_OK(device->resource_manager()->Create(\n+  CHECK_OK(device->resource_manager()->Create(\n       container, \"var2\", new tensorflow::Var(tensorflow::DataType::DT_FLOAT)));\n }\n "
        },
        {
            "sha": "da75a97030412d7edc0bddd2d7ff029b5e2a7109",
            "filename": "tensorflow/compiler/mlir/tf2xla/api/v2/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Fapi%2Fv2%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Fapi%2Fv2%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Fapi%2Fv2%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -323,6 +323,7 @@ cc_library(\n     ],\n     visibility = [\"//visibility:public\"],\n     deps = [\n+        \":mlir_roundtrip_flags\",\n         \"//tensorflow/compiler/jit:shape_inference_helpers\",\n         \"//tensorflow/compiler/mlir:op_or_arg_name_mapper\",\n         \"//tensorflow/compiler/mlir/tensorflow\",\n@@ -349,13 +350,13 @@ cc_library(\n         \"//tensorflow/core:lib\",\n         \"//tensorflow/core:protos_all_cc\",\n         \"//tensorflow/core/common_runtime:function_body\",\n-        \"//tensorflow/core/platform:crash_analysis\",\n         \"//tensorflow/core/platform:types\",\n         \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/container:flat_hash_set\",\n         \"@com_google_absl//absl/container:inlined_vector\",\n         \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n         \"@llvm-project//llvm:Support\",\n@@ -365,7 +366,6 @@ cc_library(\n         \"@llvm-project//mlir:Pass\",\n         \"@llvm-project//mlir:Support\",\n         \"@local_xla//xla:status_macros\",\n-        \"@local_xla//xla/tsl/platform:status\",\n     ],\n )\n "
        },
        {
            "sha": "cb48ff03def75d9e904da8a79b7bc9a8a5820653",
            "filename": "tensorflow/compiler/mlir/tf2xla/api/v2/graph_to_tf_executor.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Fapi%2Fv2%2Fgraph_to_tf_executor.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Fapi%2Fv2%2Fgraph_to_tf_executor.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Fapi%2Fv2%2Fgraph_to_tf_executor.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -34,6 +34,7 @@ limitations under the License.\n #include \"absl/container/flat_hash_map.h\"\n #include \"absl/container/flat_hash_set.h\"\n #include \"absl/container/inlined_vector.h\"\n+#include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n #include \"absl/strings/match.h\"\n@@ -74,7 +75,6 @@ limitations under the License.\n #include \"tensorflow/compiler/mlir/tensorflow/ir/tf_dialect.h\"\n #include \"tensorflow/compiler/mlir/tensorflow/ir/tf_executor.h\"\n #include \"tensorflow/compiler/mlir/tensorflow/ir/tf_types.h\"\n-#include \"tensorflow/compiler/mlir/tensorflow/translate/mlir_roundtrip_flags.h\"\n #include \"tensorflow/compiler/mlir/tensorflow/utils/convert_attr.h\"\n #include \"tensorflow/compiler/mlir/tensorflow/utils/convert_tensor.h\"\n #include \"tensorflow/compiler/mlir/tensorflow/utils/convert_type.h\"\n@@ -83,14 +83,15 @@ limitations under the License.\n #include \"tensorflow/compiler/mlir/tensorflow/utils/error_util.h\"\n #include \"tensorflow/compiler/mlir/tensorflow/utils/mangling_util.h\"\n #include \"tensorflow/compiler/mlir/tensorflow/utils/translate_utils.h\"\n+#include \"tensorflow/compiler/mlir/tf2xla/api/v2/mlir_roundtrip_flags.h\"\n #include \"tensorflow/compiler/mlir/tf2xla/internal/graph_to_tf_executor_util.h\"\n #include \"tensorflow/compiler/mlir/tf2xla/internal/node_order.h\"\n #include \"tensorflow/compiler/tf2xla/functionalize_control_flow.h\"\n #include \"tensorflow/compiler/tf2xla/functionalize_control_flow_util.h\"\n #include \"tensorflow/compiler/tf2xla/tf2xla_defs.h\"\n #include \"xla/status_macros.h\"\n+#include \"xla/tsl/platform/crash_analysis.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"tensorflow/core/common_runtime/function_body.h\"\n #include \"tensorflow/core/common_runtime/function_def_utils.h\"\n@@ -120,11 +121,9 @@ limitations under the License.\n #include \"tensorflow/core/graph/node_builder.h\"\n #include \"tensorflow/core/graph/tensor_id.h\"\n #include \"tensorflow/core/lib/core/errors.h\"\n-#include \"tensorflow/core/platform/crash_analysis.h\"\n #include \"tensorflow/core/platform/errors.h\"\n #include \"tensorflow/core/platform/logging.h\"\n #include \"tensorflow/core/platform/stack_frame.h\"\n-#include \"tensorflow/core/platform/stringpiece.h\"\n #include \"tensorflow/core/platform/types.h\"\n #include \"tensorflow/core/protobuf/meta_graph.pb.h\"\n #include \"tensorflow/core/protobuf/saved_object_graph.pb.h\"\n@@ -1889,7 +1888,7 @@ mlir::Operation* ImporterBase::CreateOperation(\n     NameRangeMap input_ranges, output_ranges;\n     // This will fail only if the OpDef is syntactically invalid.\n     // TODO(jpienaar): Convert this CHECK into a properly propagated error.\n-    TF_CHECK_OK(\n+    CHECK_OK(\n         NameRangesForNode(node, node.op_def(), &input_ranges, &output_ranges));\n     if (inner_op->hasTrait<mlir::OpTrait::AttrSizedOperandSegments>()) {\n       // Add derived \"operand_segment_sizes\" attr to the created operation."
        },
        {
            "sha": "f292b270f855e8c536163250c0c976ac1875356e",
            "filename": "tensorflow/compiler/mlir/tf2xla/internal/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Finternal%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Finternal%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Finternal%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -419,10 +419,10 @@ tf_cc_test(\n         \"//tensorflow/core:protos_all_cc\",\n         \"//tensorflow/core/framework:tensor_testutil\",\n         \"//tensorflow/core/platform:enable_tf2_utils\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_googletest//:gtest_main\",\n         \"@local_xla//xla/tsl/lib/core:status_test_util\",\n-        \"@local_xla//xla/tsl/platform:status\",\n     ],\n )"
        },
        {
            "sha": "cb332fe4fb997b6e7a48bb9dcbdfa83fca466be4",
            "filename": "tensorflow/compiler/mlir/tf2xla/internal/graph_to_tf_executor_util_test.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Finternal%2Fgraph_to_tf_executor_util_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Finternal%2Fgraph_to_tf_executor_util_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftf2xla%2Finternal%2Fgraph_to_tf_executor_util_test.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -20,6 +20,7 @@ limitations under the License.\n #include <vector>\n \n #include <gtest/gtest.h>\n+#include \"absl/log/check.h\"\n #include \"absl/status/status.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/string_view.h\"\n@@ -31,7 +32,6 @@ limitations under the License.\n #include \"tensorflow/cc/ops/tpu_functional_ops.h\"\n #include \"tensorflow/cc/ops/tpu_replication_ops.h\"\n #include \"xla/tsl/lib/core/status_test_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"tensorflow/core/framework/function.h\"\n #include \"tensorflow/core/framework/function.pb.h\"\n #include \"tensorflow/core/framework/node_def.pb.h\"\n@@ -124,11 +124,11 @@ Node* FromNodeDef(absl::string_view name, absl::string_view node_type,\n   }\n \n   NodeDef node_def;\n-  TF_CHECK_OK(builder.Finalize(&node_def));\n+  CHECK_OK(builder.Finalize(&node_def));\n \n   absl::Status s;\n   Node* node = graph.AddNode(node_def, &s);\n-  TF_CHECK_OK(s);\n+  CHECK_OK(s);\n   return node;\n }\n \n@@ -547,12 +547,12 @@ TEST(UnsupportedOpTest,\n   builder.Attr(\"dtypes\", DT_FLOAT);\n   builder.Attr(\"shapes\", 1);\n   NodeDef node_def;\n-  TF_CHECK_OK(builder.Finalize(&node_def));\n+  CHECK_OK(builder.Finalize(&node_def));\n   absl::Status s;\n   Node* node_InfeedDequeueTuple = (*root.graph()).AddNode(node_def, &s);\n   node_InfeedDequeueTuple->set_requested_device(\n       \"/device:TPU_REPLICATED_CORE:0\");\n-  TF_CHECK_OK(s);\n+  CHECK_OK(s);\n   ASSERT_NE(node_InfeedDequeueTuple, nullptr);\n \n   Graph graph(OpRegistry::Global());"
        },
        {
            "sha": "d7bece21567fdf80aec85ceacde2e1461149a6a9",
            "filename": "tensorflow/compiler/mlir/tools/optimize/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftools%2Foptimize%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftools%2Foptimize%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftools%2Foptimize%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -17,9 +17,7 @@ cc_library(\n     deps = [\n         \"//tensorflow/compiler/mlir/tools:safe_cast\",\n         \"//tensorflow/core/framework:tensor_shape\",\n-        \"//tensorflow/core/platform:logging\",\n-        \"//tensorflow/core/platform:macros\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/types:span\",\n-        \"@local_xla//xla/tsl/platform:status\",\n     ],\n )"
        },
        {
            "sha": "5e0ec1ccac3b9f4b54a98dd63bd5d390b07f29df",
            "filename": "tensorflow/compiler/mlir/tools/optimize/quantization_utils.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftools%2Foptimize%2Fquantization_utils.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Fmlir%2Ftools%2Foptimize%2Fquantization_utils.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Fmlir%2Ftools%2Foptimize%2Fquantization_utils.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -21,9 +21,9 @@ limitations under the License.\n #include <limits>\n #include <vector>\n \n+#include \"absl/log/check.h\"\n #include \"absl/types/span.h\"\n #include \"tensorflow/compiler/mlir/tools/safe_cast.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"tensorflow/core/framework/tensor_shape.h\"\n \n namespace tflite_migration {\n@@ -92,13 +92,13 @@ void SymmetricPerChannelQuantizeValues(const float* const input,\n   // Quantize the values.\n   int indices[kPerChannelMaxDim];\n   tensorflow::TensorShape unextended_shape;\n-  TF_CHECK_OK(tensorflow::TensorShapeUtils::MakeShape(absl::MakeSpan(dimension),\n-                                                      &unextended_shape));\n+  CHECK_OK(tensorflow::TensorShapeUtils::MakeShape(absl::MakeSpan(dimension),\n+                                                   &unextended_shape));\n   tensorflow::TensorShape shape;\n   for (int i = 0; i < kPerChannelMaxDim - unextended_shape.dims(); ++i) {\n-    TF_CHECK_OK(shape.AddDimWithStatus(1));\n+    CHECK_OK(shape.AddDimWithStatus(1));\n   }\n-  TF_CHECK_OK(shape.AppendShapeWithStatus(unextended_shape));\n+  CHECK_OK(shape.AppendShapeWithStatus(unextended_shape));\n   channel_dim_index += kPerChannelMaxDim - unextended_shape.dims();\n \n   for (indices[0] = 0; indices[0] < shape.dim_size(0); indices[0]++) {"
        },
        {
            "sha": "22e471c768e37728ee495450fcdf6ddbe72ee633",
            "filename": "tensorflow/compiler/tests/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftests%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftests%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftests%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -2903,13 +2903,12 @@ tf_cuda_cc_test(\n         \"//tensorflow/compiler/jit:xla_kernel_creator\",\n         \"//tensorflow/compiler/tf2xla:xla_compiler\",\n         \"//tensorflow/core:framework\",\n-        \"//tensorflow/core:lib\",\n         \"//tensorflow/core:protos_all_cc\",\n         \"//tensorflow/core:test\",\n         \"//tensorflow/core:test_main\",\n         \"//tensorflow/core:testlib\",\n         \"//tensorflow/core/kernels:ops_testutil\",\n-        \"@local_xla//xla/tsl/platform:status\",\n+        \"@com_google_absl//absl/log:check\",\n     ],\n )\n "
        },
        {
            "sha": "b23164ac9aeb18d03d2500c6dfb65a5b34617c71",
            "filename": "tensorflow/compiler/tests/randomized_tests.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftests%2Frandomized_tests.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftests%2Frandomized_tests.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftests%2Frandomized_tests.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -90,11 +90,9 @@ limitations under the License.\n #include \"tensorflow/core/framework/types.h\"\n #include \"tensorflow/core/framework/types.pb.h\"\n #include \"tensorflow/core/graph/graph.h\"\n-#include \"tensorflow/core/lib/core/status.h\"\n #include \"tensorflow/core/platform/bfloat16.h\"\n #include \"tensorflow/core/platform/errors.h\"\n #include \"tensorflow/core/platform/test.h\"\n-#include \"tensorflow/core/platform/types.h\"\n #include \"tensorflow/core/protobuf/config.pb.h\"\n #include \"tensorflow/core/public/session.h\"\n #include \"tensorflow/core/public/session_options.h\"\n@@ -4931,8 +4929,8 @@ int main(int argc, char** argv) {\n   // XLA devices register kernels at construction time; create all known devices\n   // to make sure the kernels are registered.\n   std::vector<std::unique_ptr<tensorflow::Device>> devices;\n-  TF_CHECK_OK(tensorflow::DeviceFactory::AddDevices(\n-      tensorflow::SessionOptions(), \"\", &devices));\n+  CHECK_OK(tensorflow::DeviceFactory::AddDevices(tensorflow::SessionOptions(),\n+                                                 \"\", &devices));\n   tensorflow::StaticDeviceMgr device_mgr(std::move(devices));\n \n   tensorflow::Device* ignored;"
        },
        {
            "sha": "00fd0ea67041b9f0f73c0b3f4f53b585b1cc799c",
            "filename": "tensorflow/compiler/tests/unary_ops_composition_test.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftests%2Funary_ops_composition_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftests%2Funary_ops_composition_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftests%2Funary_ops_composition_test.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -16,12 +16,13 @@ limitations under the License.\n #include <algorithm>\n #include <cmath>\n #include <memory>\n+#include <string>\n #include <vector>\n \n+#include \"absl/log/check.h\"\n #include \"tensorflow/compiler/jit/flags.h\"\n #include \"tensorflow/compiler/tf2xla/xla_op_registry.h\"\n #include \"xla/tsl/lib/core/status_test_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"tensorflow/core/framework/allocator.h\"\n #include \"tensorflow/core/framework/device_base.h\"\n #include \"tensorflow/core/framework/device_factory.h\"\n@@ -33,7 +34,6 @@ limitations under the License.\n #include \"tensorflow/core/framework/types.h\"\n #include \"tensorflow/core/framework/types.pb.h\"\n #include \"tensorflow/core/kernels/ops_testutil.h\"\n-#include \"tensorflow/core/platform/logging.h\"\n #include \"tensorflow/core/platform/test.h\"\n #include \"tensorflow/core/util/port.h\"\n \n@@ -84,8 +84,8 @@ class UnaryOpsCompositionTest : public OpsTestBase {\n     DeviceContext* device_context =\n         device_->tensorflow_accelerator_device_info()->default_context;\n \n-    TF_CHECK_OK(device_context->CopyCPUTensorToDeviceSync(&input_on_host,\n-                                                          device_, input));\n+    CHECK_OK(device_context->CopyCPUTensorToDeviceSync(&input_on_host, device_,\n+                                                       input));\n \n     TF_ASSERT_OK(RunOpKernel());\n \n@@ -95,7 +95,7 @@ class UnaryOpsCompositionTest : public OpsTestBase {\n     Tensor* output = GetOutput(0);\n     Tensor output_on_host(cpu_allocator, output->dtype(), output->shape());\n \n-    TF_CHECK_OK(device_context->CopyDeviceTensorToCPUSync(\n+    CHECK_OK(device_context->CopyDeviceTensorToCPUSync(\n         output, \"output 0\", device_, &output_on_host));\n \n     test::ExpectClose(expected_tensor, output_on_host, /*atol=*/1e-5,"
        },
        {
            "sha": "9c2dfc073afccb069eb8ec060ea4a7b6137327e2",
            "filename": "tensorflow/compiler/tf2xla/BUILD",
            "status": "modified",
            "additions": 44,
            "deletions": 16,
            "changes": 60,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -490,7 +490,6 @@ cc_library(\n         \"@local_xla//xla/service/cpu:executable_proto_cc\",\n         \"@local_xla//xla/tsl/concurrency:async_value\",\n         \"@local_xla//xla/tsl/platform:env\",\n-        \"@local_xla//xla/tsl/platform:status\",\n     ],\n )\n \n@@ -721,12 +720,15 @@ cc_library(\n         \":common\",\n         \":xla_expression\",\n         \":xla_helpers\",\n+        \":xla_resource\",\n         \"//tensorflow/core:framework\",\n         \"//tensorflow/core:lib\",\n         \"//tensorflow/core/common_runtime:core_cpu_internal\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/types:span\",\n-        \"@local_xla//xla:literal\",\n         \"@local_xla//xla:shape_util\",\n         \"@local_xla//xla:status_macros\",\n         \"@local_xla//xla:xla_data_proto_cc\",\n@@ -767,7 +769,6 @@ cc_library(\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/strings:string_view\",\n         \"@com_google_absl//absl/types:span\",\n-        \"@local_tsl//tsl/platform:status\",\n         \"@local_xla//xla:util\",\n         \"@local_xla//xla/client:client_library\",\n     ],\n@@ -846,18 +847,25 @@ cc_library(\n         \"//tensorflow/core:core_cpu_base\",\n         \"//tensorflow/core:framework\",\n         \"//tensorflow/core:lib\",\n+        \"//tensorflow/core/platform:refcount\",\n+        \"@com_google_absl//absl/container:btree\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/status:statusor\",\n+        \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/synchronization\",\n+        \"@com_google_absl//absl/time\",\n         \"@com_google_absl//absl/types:optional\",\n         \"@com_google_absl//absl/types:span\",\n         \"@local_xla//xla:executable_run_options\",\n-        \"@local_xla//xla:types\",\n-        \"@local_xla//xla/backends/gpu/collectives:gpu_clique_key\",\n+        \"@local_xla//xla:literal\",\n+        \"@local_xla//xla:literal_util\",\n+        \"@local_xla//xla:shape_util\",\n         \"@local_xla//xla/core/collectives:clique_id\",\n         \"@local_xla//xla/core/collectives:clique_key\",\n         \"@local_xla//xla/hlo/builder:xla_builder\",\n         \"@local_xla//xla/hlo/builder:xla_computation\",\n-        \"@local_xla//xla/hlo/builder/lib:arithmetic\",\n-        \"@local_xla//xla/hlo/builder/lib:constants\",\n         \"@local_xla//xla/hlo/ir:hlo\",\n         \"@local_xla//xla/hlo/translate/mhlo_to_hlo:layout_util\",\n         \"@local_xla//xla/service:computation_placer_hdr\",\n@@ -1046,6 +1054,11 @@ cc_library(\n         \"//tensorflow/core:lib\",\n         \"//tensorflow/core:protos_all_cc\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n+        \"@com_google_absl//absl/container:flat_hash_set\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/types:optional\",\n         \"@local_xla//xla:status_macros\",\n@@ -1063,6 +1076,7 @@ tf_cc_test(\n         \"//tensorflow/cc:function_ops\",\n         \"//tensorflow/cc:functional_ops\",\n         \"//tensorflow/cc:ops\",\n+        \"//tensorflow/cc:scope\",\n         \"//tensorflow/core:core_cpu_internal\",\n         \"//tensorflow/core:framework\",\n         \"//tensorflow/core:lib\",\n@@ -1071,6 +1085,8 @@ tf_cc_test(\n         \"//tensorflow/core:protos_all_cc\",\n         \"//tensorflow/core:test\",\n         \"//tensorflow/core:test_main\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n     ],\n )\n@@ -1253,10 +1269,9 @@ cc_library(\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/types:span\",\n-        \"@local_tsl//tsl/platform:status\",\n-        \"@local_tsl//tsl/platform:statusor\",\n         \"@local_xla//xla/stream_executor:device_memory\",\n         \"@local_xla//xla/stream_executor:stream\",\n+        \"@local_xla//xla/tsl/platform:statusor\",\n     ],\n     alwayslink = 1,\n )\n@@ -1327,21 +1342,21 @@ cc_library(\n         \"functionalize_cond.h\",\n     ],\n     deps = [\n-        \":frontend_attributes_util\",\n         \":functionalize_control_flow_util\",\n-        \":tf2xla_util\",\n+        \":tf2xla_defs\",\n         \"//tensorflow/compiler/tf2xla/ops:xla_ops\",\n         \"//tensorflow/core:core_cpu\",\n         \"//tensorflow/core:core_cpu_internal\",\n         \"//tensorflow/core:framework\",\n-        \"//tensorflow/core:graph\",\n         \"//tensorflow/core:lib\",\n         \"//tensorflow/core:protos_all_cc\",\n-        \"@com_google_absl//absl/memory\",\n+        \"//tensorflow/core/platform:hash\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\",\n-        \"@com_google_absl//absl/types:optional\",\n         \"@local_xla//xla:status_macros\",\n-        \"@local_xla//xla:union_find\",\n     ],\n )\n \n@@ -1607,7 +1622,14 @@ cc_library(\n     visibility = [\":friends\"],\n     deps = [\n         \"//tensorflow/core:core_cpu\",\n+        \"//tensorflow/core:framework\",\n+        \"//tensorflow/core/platform:errors\",\n+        \"//tensorflow/core/platform:str_util\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/types:span\",\n+        \"@local_xla//xla/tsl/platform:errors\",\n     ],\n )\n \n@@ -1673,12 +1695,18 @@ cc_library(\n     deps = [\n         \":resource_operation_table\",\n         \"//tensorflow/core:core_cpu\",\n-        \"//tensorflow/core:graph\",\n+        \"//tensorflow/core:framework\",\n         \"//tensorflow/core:lib\",\n         \"//tensorflow/core:protos_all_cc\",\n+        \"//tensorflow/core/common_runtime:function_body\",\n+        \"//tensorflow/core/common_runtime:function_utils\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/container:flat_hash_set\",\n+        \"@com_google_absl//absl/container:inlined_vector\",\n         \"@com_google_absl//absl/hash\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\",\n         \"@local_xla//xla:status_macros\",\n     ],"
        },
        {
            "sha": "b5426bc35c58df59c0bd1da40338aa64cf64cdf9",
            "filename": "tensorflow/compiler/tf2xla/functionalize_cond.cc",
            "status": "modified",
            "additions": 31,
            "deletions": 12,
            "changes": 43,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Ffunctionalize_cond.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Ffunctionalize_cond.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Ffunctionalize_cond.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -16,30 +16,49 @@ limitations under the License.\n #include \"tensorflow/compiler/tf2xla/functionalize_cond.h\"\n \n #include <algorithm>\n+#include <array>\n+#include <cstddef>\n+#include <cstdint>\n #include <deque>\n-#include <stack>\n+#include <functional>\n+#include <iterator>\n+#include <map>\n+#include <memory>\n+#include <set>\n+#include <string>\n+#include <tuple>\n+#include <unordered_map>\n #include <unordered_set>\n+#include <utility>\n #include <vector>\n \n-#include \"absl/memory/memory.h\"\n-#include \"absl/strings/match.h\"\n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/status.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"absl/strings/str_cat.h\"\n #include \"absl/strings/str_join.h\"\n-#include \"absl/types/optional.h\"\n-#include \"tensorflow/compiler/tf2xla/frontend_attributes_util.h\"\n+#include \"absl/strings/string_view.h\"\n #include \"tensorflow/compiler/tf2xla/functionalize_control_flow_util.h\"\n-#include \"tensorflow/compiler/tf2xla/tf2xla_util.h\"\n-#include \"xla/union_find.h\"\n-#include \"tensorflow/core/common_runtime/function.h\"\n+#include \"tensorflow/compiler/tf2xla/tf2xla_defs.h\"\n+#include \"xla/status_macros.h\"\n+#include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n #include \"tensorflow/core/common_runtime/shape_refiner.h\"\n+#include \"tensorflow/core/framework/function.h\"\n #include \"tensorflow/core/framework/graph_to_functiondef.h\"\n #include \"tensorflow/core/framework/node_def_builder.h\"\n+#include \"tensorflow/core/framework/node_def_util.h\"\n+#include \"tensorflow/core/framework/shape_inference.h\"\n+#include \"tensorflow/core/framework/tensor_shape.h\"\n+#include \"tensorflow/core/framework/types.h\"\n #include \"tensorflow/core/framework/versions.pb.h\"\n #include \"tensorflow/core/graph/algorithm.h\"\n-#include \"tensorflow/core/graph/control_flow.h\"\n+#include \"tensorflow/core/graph/graph.h\"\n+#include \"tensorflow/core/graph/graph_node_util.h\"\n #include \"tensorflow/core/graph/node_builder.h\"\n #include \"tensorflow/core/lib/core/errors.h\"\n-#include \"tensorflow/core/lib/hash/hash.h\"\n-#include \"tensorflow/core/lib/strings/strcat.h\"\n+#include \"tensorflow/core/platform/hash.h\"\n #include \"tensorflow/core/util/dump_graph.h\"\n \n namespace tensorflow {\n@@ -1138,7 +1157,7 @@ StateMap::CondId FunctionalizeCond::StateAlongEdge(const Edge* e) {\n     StateMap::CondState state;\n     if (id != nullptr) state = *id;\n     OutputTensor predicate;\n-    TF_CHECK_OK(GetSwitchPredicate(*src, &predicate));\n+    CHECK_OK(GetSwitchPredicate(*src, &predicate));\n     if (e->IsControlEdge()) {\n       // In gradients of tf.cond(), in each branch, we have a NoOp node as\n       // control pivot. These NoOp nodes have control dependency from Switch"
        },
        {
            "sha": "281da5c23c54e8dcc3240c9ea187391ab28b5eed",
            "filename": "tensorflow/compiler/tf2xla/kernels/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fkernels%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fkernels%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Fkernels%2FBUILD?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -1893,18 +1893,17 @@ tf_kernel_library(\n         \"//tensorflow/compiler/tf2xla:xla_resource\",\n         \"//tensorflow/compiler/tf2xla/ops:xla_ops\",\n         \"//tensorflow/core:framework\",\n-        \"//tensorflow/core:portable_gif_internal\",\n         \"//tensorflow/core:protos_all_cc\",\n         \"//tensorflow/core/platform:errors\",\n         \"@com_google_absl//absl/container:inlined_vector\",\n         \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/strings\",\n         \"@local_xla//xla:literal\",\n         \"@local_xla//xla:shape_util\",\n         \"@local_xla//xla:xla_data_proto_cc\",\n         \"@local_xla//xla/hlo/builder:xla_builder\",\n         \"@local_xla//xla/hlo/builder:xla_computation\",\n-        \"@local_xla//xla/tsl/platform:status\",\n     ],\n )\n \n@@ -3019,10 +3018,10 @@ tf_kernel_library(\n         \"//tensorflow/core:framework\",\n         \"//tensorflow/core:lib\",\n         \"//tensorflow/core:protos_all_cc\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@local_xla//xla:shape_util\",\n         \"@local_xla//xla:xla_data_proto_cc\",\n         \"@local_xla//xla/hlo/builder:xla_builder\",\n-        \"@local_xla//xla/tsl/platform:status\",\n     ],\n )\n "
        },
        {
            "sha": "6e8417e2d25ff2609f8cc8c09544577b3d379e04",
            "filename": "tensorflow/compiler/tf2xla/kernels/reduction_ops_common.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fkernels%2Freduction_ops_common.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fkernels%2Freduction_ops_common.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Fkernels%2Freduction_ops_common.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -16,9 +16,11 @@ limitations under the License.\n // XLA-specific reduction Ops.\n \n #include <cstdint>\n+#include <string>\n #include <vector>\n \n #include \"absl/container/inlined_vector.h\"\n+#include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/str_join.h\"\n@@ -30,14 +32,12 @@ limitations under the License.\n #include \"xla/hlo/builder/xla_computation.h\"\n #include \"xla/literal.h\"\n #include \"xla/shape_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/xla_data.pb.h\"\n #include \"tensorflow/core/framework/op_kernel.h\"\n #include \"tensorflow/core/framework/op_requires.h\"\n #include \"tensorflow/core/framework/tensor_shape.h\"\n #include \"tensorflow/core/framework/types.pb.h\"\n #include \"tensorflow/core/platform/errors.h\"\n-#include \"tensorflow/core/platform/types.h\"\n \n namespace tensorflow {\n \n@@ -125,7 +125,7 @@ void XlaReductionOp::Compile(XlaOpKernelContext* ctx) {\n   // Construct the builder for the reduction lambda.\n   xla::XlaBuilder r(absl::StrCat(desc, \"-reduction\"));\n   xla::PrimitiveType type;\n-  TF_CHECK_OK(DataTypeToPrimitiveType(reduction_type_, &type));\n+  CHECK_OK(DataTypeToPrimitiveType(reduction_type_, &type));\n \n   auto data = xla::ConvertElementType(ctx->Input(0), type);\n   // Call virtual method to get the initial value."
        },
        {
            "sha": "e9d0314780ca54b1dcc6a01b565485a5bcd6cb93",
            "filename": "tensorflow/compiler/tf2xla/kernels/xla_custom_call_op.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fkernels%2Fxla_custom_call_op.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fkernels%2Fxla_custom_call_op.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Fkernels%2Fxla_custom_call_op.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -13,20 +13,20 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n+#include <string>\n #include <vector>\n \n+#include \"absl/log/check.h\"\n #include \"tensorflow/compiler/tf2xla/shape_util.h\"\n #include \"tensorflow/compiler/tf2xla/xla_op_kernel.h\"\n #include \"tensorflow/compiler/tf2xla/xla_op_registry.h\"\n #include \"xla/hlo/builder/xla_builder.h\"\n #include \"xla/shape.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/xla_data.pb.h\"\n #include \"tensorflow/core/framework/op_kernel.h\"\n #include \"tensorflow/core/framework/op_requires.h\"\n #include \"tensorflow/core/framework/tensor_shape.h\"\n #include \"tensorflow/core/framework/types.pb.h\"\n-#include \"tensorflow/core/platform/types.h\"\n \n namespace tensorflow {\n namespace {\n@@ -47,8 +47,7 @@ class XlaCustomCallOp : public XlaOpKernel {\n     }\n \n     xla::Shape output_shape;\n-    TF_CHECK_OK(\n-        TensorShapeToXLAShape(output_type_, output_shape_, &output_shape));\n+    CHECK_OK(TensorShapeToXLAShape(output_type_, output_shape_, &output_shape));\n     xla::XlaOp output = xla::CustomCall(ctx->builder(), target_name_, inputs,\n                                         output_shape, backend_config_);\n     ctx->SetOutput(0, output);"
        },
        {
            "sha": "93444bfeb491256d53b8ab2cbe33b74d298d1855",
            "filename": "tensorflow/compiler/tf2xla/light_outside_compilation_kernels_for_test.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Flight_outside_compilation_kernels_for_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Flight_outside_compilation_kernels_for_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Flight_outside_compilation_kernels_for_test.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -14,7 +14,9 @@ limitations under the License.\n ==============================================================================*/\n \n #include <algorithm>\n-#include <string>\n+#include <cstddef>\n+#include <cstdint>\n+#include <vector>\n \n #include \"absl/log/check.h\"\n #include \"absl/status/status.h\"\n@@ -24,6 +26,7 @@ limitations under the License.\n #include \"tensorflow/compiler/tf2xla/xla_op_registry.h\"\n #include \"xla/stream_executor/device_memory.h\"\n #include \"xla/stream_executor/stream.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n #include \"tensorflow/core/framework/allocator.h\"\n #include \"tensorflow/core/framework/node_def.pb.h\"\n #include \"tensorflow/core/framework/node_def_util.h\"\n@@ -36,8 +39,6 @@ limitations under the License.\n #include \"tensorflow/core/framework/types.h\"\n #include \"tensorflow/core/platform/errors.h\"\n #include \"tensorflow/core/platform/types.h\"\n-#include \"tsl/platform/status.h\"\n-#include \"tsl/platform/statusor.h\"\n \n // Sample kernels for the light outside compilation test.\n \n@@ -302,8 +303,8 @@ class TestTfMustBeConstantOp : public OpKernel {\n     AllocatorAttributes pinned_alloc_attrs;\n     pinned_alloc_attrs.set_on_host(true);\n     pinned_alloc_attrs.set_gpu_compatible(true);\n-    TF_CHECK_OK(ctx->allocate_temp(input.dtype(), input.shape(), &tmp,\n-                                   pinned_alloc_attrs));\n+    CHECK_OK(ctx->allocate_temp(input.dtype(), input.shape(), &tmp,\n+                                pinned_alloc_attrs));\n \n     OP_REQUIRES_OK(ctx, stream->Memcpy(tmp.data(),\n                                        stream_executor::DeviceAddressBase{"
        },
        {
            "sha": "50990e0bb2858da66e721e2e1550b9cbae6fc85b",
            "filename": "tensorflow/compiler/tf2xla/resource_util.cc",
            "status": "modified",
            "additions": 16,
            "deletions": 2,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fresource_util.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fresource_util.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Fresource_util.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -15,13 +15,27 @@ limitations under the License.\n \n #include \"tensorflow/compiler/tf2xla/resource_util.h\"\n \n+#include <optional>\n #include <string>\n+#include <unordered_map>\n+#include <utility>\n #include <vector>\n \n #include \"absl/container/flat_hash_map.h\"\n #include \"absl/container/flat_hash_set.h\"\n+#include \"absl/container/inlined_vector.h\"\n+#include \"absl/log/check.h\"\n+#include \"absl/status/status.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"absl/strings/string_view.h\"\n #include \"tensorflow/compiler/tf2xla/resource_operation_table.h\"\n #include \"xla/status_macros.h\"\n+#include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n+#include \"tensorflow/core/common_runtime/function_body.h\"\n+#include \"tensorflow/core/common_runtime/function_utils.h\"\n+#include \"tensorflow/core/framework/function.h\"\n+#include \"tensorflow/core/framework/node_def_util.h\"\n #include \"tensorflow/core/graph/algorithm.h\"\n #include \"tensorflow/core/graph/graph.h\"\n #include \"tensorflow/core/lib/core/errors.h\"\n@@ -204,8 +218,8 @@ absl::Status PropagateThroughCallOp(\n   // Instantiate associated function to get function body.\n   FunctionLibraryRuntime::Handle handle;\n   TF_RETURN_IF_ERROR(InstantiateFunctionCall(n.def(), lib_runtime, &handle));\n-  auto release_handle_on_return = gtl::MakeCleanup(\n-      [&] { TF_CHECK_OK(lib_runtime->ReleaseHandle(handle)); });\n+  auto release_handle_on_return =\n+      gtl::MakeCleanup([&] { CHECK_OK(lib_runtime->ReleaseHandle(handle)); });\n   const FunctionBody* fbody = lib_runtime->GetFunctionBody(handle);\n \n   // Recursively analyze called function for resource sources and users."
        },
        {
            "sha": "a28d6ac8b1554f4c38bf88b3fb5e2246dbab672f",
            "filename": "tensorflow/compiler/tf2xla/side_effect_util.cc",
            "status": "modified",
            "additions": 15,
            "deletions": 3,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fside_effect_util.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fside_effect_util.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Fside_effect_util.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -15,8 +15,21 @@ limitations under the License.\n \n #include \"tensorflow/compiler/tf2xla/side_effect_util.h\"\n \n+#include <map>\n+#include <set>\n+#include <string>\n+#include <vector>\n+\n+#include \"absl/log/check.h\"\n+#include \"absl/status/status.h\"\n #include \"absl/strings/numbers.h\"\n+#include \"absl/types/span.h\"\n+#include \"xla/tsl/platform/errors.h\"\n+#include \"tensorflow/core/framework/node_def_util.h\"\n #include \"tensorflow/core/graph/algorithm.h\"\n+#include \"tensorflow/core/graph/graph.h\"\n+#include \"tensorflow/core/platform/errors.h\"\n+#include \"tensorflow/core/platform/str_util.h\"\n \n namespace tensorflow {\n \n@@ -98,9 +111,8 @@ std::set<std::string> CalculateTokenInputsForOutputToken(const Graph& g) {\n \n         first_side_effecting_node_on_path = n;\n         std::string original_node_name;\n-        TF_CHECK_OK(GetNodeAttr(n->def(),\n-                                kXlaOriginalOutsideCompilationNodeName,\n-                                &original_node_name));\n+        CHECK_OK(GetNodeAttr(n->def(), kXlaOriginalOutsideCompilationNodeName,\n+                             &original_node_name));\n         results.insert(original_node_name);\n       },\n       [&](Node* n) {"
        },
        {
            "sha": "5884cddba62b3d57ca47894c22966232ec75b503",
            "filename": "tensorflow/compiler/tf2xla/tf2xla_util.cc",
            "status": "modified",
            "additions": 29,
            "deletions": 9,
            "changes": 38,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Ftf2xla_util.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Ftf2xla_util.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Ftf2xla_util.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -15,33 +15,53 @@ limitations under the License.\n \n #include \"tensorflow/compiler/tf2xla/tf2xla_util.h\"\n \n-#include <functional>\n+#include <atomic>\n+#include <cstdint>\n+#include <cstdlib>\n+#include <limits>\n+#include <map>\n+#include <memory>\n+#include <optional>\n #include <queue>\n #include <random>\n #include <set>\n+#include <string>\n #include <unordered_map>\n+#include <utility>\n+#include <vector>\n \n #include \"absl/container/flat_hash_map.h\"\n+#include \"absl/container/flat_hash_set.h\"\n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/status.h\"\n+#include \"absl/status/statusor.h\"\n #include \"absl/strings/str_cat.h\"\n+#include \"absl/strings/string_view.h\"\n #include \"tensorflow/compiler/tf2xla/sharding_util.h\"\n #include \"tensorflow/compiler/tf2xla/tf2xla.pb.h\"\n+#include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n #include \"xla/xla_data.pb.h\"\n-#include \"tensorflow/core/common_runtime/function.h\"\n #include \"tensorflow/core/common_runtime/function_body.h\"\n+#include \"tensorflow/core/common_runtime/function_def_utils.h\"\n #include \"tensorflow/core/framework/function.h\"\n #include \"tensorflow/core/framework/graph.pb.h\"\n #include \"tensorflow/core/framework/graph_def_util.h\"\n #include \"tensorflow/core/framework/graph_to_functiondef.h\"\n #include \"tensorflow/core/framework/node_def.pb.h\"\n #include \"tensorflow/core/framework/node_def_builder.h\"\n #include \"tensorflow/core/framework/node_def_util.h\"\n-#include \"tensorflow/core/framework/op_def_builder.h\"\n+#include \"tensorflow/core/framework/op.h\"\n #include \"tensorflow/core/framework/tensor_shape.h\"\n #include \"tensorflow/core/framework/tensor_shape.pb.h\"\n+#include \"tensorflow/core/framework/types.h\"\n #include \"tensorflow/core/framework/versions.pb.h\"\n+#include \"tensorflow/core/graph/graph.h\"\n+#include \"tensorflow/core/graph/graph_debug_info_builder.h\"\n+#include \"tensorflow/core/graph/graph_node_util.h\"\n #include \"tensorflow/core/graph/tensor_id.h\"\n #include \"tensorflow/core/lib/core/errors.h\"\n-#include \"tensorflow/core/lib/core/status.h\"\n #include \"tensorflow/core/platform/errors.h\"\n \n namespace tensorflow {\n@@ -1025,15 +1045,15 @@ absl::Status RewriteTensorListWithConstElement(Graph* g,\n     // Look into forward While body function and check if TensorListPushBack op\n     // has a Const input.\n     NameAttrList fwd_body_attr;\n-    TF_CHECK_OK(GetNodeAttr(fwd_while->def(), \"body\", &fwd_body_attr));\n+    CHECK_OK(GetNodeAttr(fwd_while->def(), \"body\", &fwd_body_attr));\n     const FunctionDef* fwd_body = fld->Find(fwd_body_attr.name());\n     if (!fwd_body) {\n       return errors::InvalidArgument(\"Cannot find function \",\n                                      fwd_body_attr.name(), \" for While node \",\n                                      fwd_while->DebugString());\n     }\n     std::unique_ptr<FunctionBody> fwd_fbody;\n-    TF_CHECK_OK(FunctionDefToBodyHelper(\n+    CHECK_OK(FunctionDefToBodyHelper(\n         *fwd_body, AttrSlice(&fwd_body_attr.attr()), fld, &fwd_fbody));\n \n     // Find the TensorListPushBack node; it's one of fwd_arg's successors.\n@@ -1051,7 +1071,7 @@ absl::Status RewriteTensorListWithConstElement(Graph* g,\n \n     // Get input for the TensorListPushBack node.\n     Node* input_node;\n-    TF_CHECK_OK(tl_push_nodes[0]->input_node(1, &input_node));\n+    CHECK_OK(tl_push_nodes[0]->input_node(1, &input_node));\n     if (input_node->type_string() != \"Const\") {\n       // Input for the TensorList is not Const node.\n       continue;\n@@ -1062,15 +1082,15 @@ absl::Status RewriteTensorListWithConstElement(Graph* g,\n     // Rewrite backward While body function, replace usages of\n     // TensorListPopBack with a Const node.\n     NameAttrList bwd_body_attr;\n-    TF_CHECK_OK(GetNodeAttr(bwd_while->def(), \"body\", &bwd_body_attr));\n+    CHECK_OK(GetNodeAttr(bwd_while->def(), \"body\", &bwd_body_attr));\n     const FunctionDef* bwd_body = fld->Find(bwd_body_attr.name());\n     if (!bwd_body) {\n       return errors::InvalidArgument(\"Cannot find function \",\n                                      bwd_body_attr.name(), \" for While node \",\n                                      bwd_while->DebugString());\n     }\n     std::unique_ptr<FunctionBody> bwd_fbody;\n-    TF_CHECK_OK(FunctionDefToBodyHelper(\n+    CHECK_OK(FunctionDefToBodyHelper(\n         *bwd_body, AttrSlice(&bwd_body_attr.attr()), fld, &bwd_fbody));\n \n     // Find the TensorListPopBack node; it's one of bwd_arg's successors."
        },
        {
            "sha": "1d81f77823252381f5ae1076446c3fb2fd11857f",
            "filename": "tensorflow/compiler/tf2xla/tf2xla_util_test.cc",
            "status": "modified",
            "additions": 20,
            "deletions": 7,
            "changes": 27,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Ftf2xla_util_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Ftf2xla_util_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Ftf2xla_util_test.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -15,25 +15,39 @@ limitations under the License.\n \n #include \"tensorflow/compiler/tf2xla/tf2xla_util.h\"\n \n+#include <initializer_list>\n+#include <memory>\n+#include <string>\n+#include <unordered_map>\n+#include <vector>\n+\n+#include \"absl/log/check.h\"\n+#include \"absl/status/status.h\"\n #include \"absl/strings/match.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/string_view.h\"\n #include \"tensorflow/cc/framework/ops.h\"\n-#include \"tensorflow/cc/ops/data_flow_ops.h\"\n+#include \"tensorflow/cc/framework/scope.h\"\n+#include \"tensorflow/cc/ops/array_ops.h\"\n+#include \"tensorflow/cc/ops/const_op.h\"\n #include \"tensorflow/cc/ops/function_ops.h\"\n #include \"tensorflow/cc/ops/functional_ops.h\"\n #include \"tensorflow/cc/ops/list_ops.h\"\n-#include \"tensorflow/cc/ops/standard_ops.h\"\n+#include \"tensorflow/cc/ops/math_ops.h\"\n+#include \"tensorflow/cc/ops/no_op.h\"\n #include \"tensorflow/compiler/tf2xla/sharding_util.h\"\n+#include \"xla/tsl/lib/core/status_test_util.h\"\n #include \"tensorflow/core/common_runtime/function.h\"\n-#include \"tensorflow/core/common_runtime/graph_optimizer.h\"\n+#include \"tensorflow/core/common_runtime/function_def_utils.h\"\n #include \"tensorflow/core/common_runtime/process_function_library_runtime.h\"\n #include \"tensorflow/core/framework/function.h\"\n #include \"tensorflow/core/framework/graph_to_functiondef.h\"\n #include \"tensorflow/core/framework/node_def.pb.h\"\n+#include \"tensorflow/core/framework/node_def_util.h\"\n+#include \"tensorflow/core/framework/op.h\"\n+#include \"tensorflow/core/framework/tensor_shape.h\"\n #include \"tensorflow/core/graph/graph.h\"\n-#include \"tensorflow/core/lib/core/status.h\"\n-#include \"tensorflow/core/lib/core/status_test_util.h\"\n+#include \"tensorflow/core/platform/env.h\"\n #include \"tensorflow/core/platform/test.h\"\n #include \"tensorflow/core/public/version.h\"\n \n@@ -492,8 +506,7 @@ TEST(PropagateConstIntoFunctionalNodes, RewriteTensorListWithConstMember) {\n   const FunctionDef* bwd_body = fld.Find(\"bwd_body_tl_rewrite_0\");\n   ASSERT_NE(bwd_body, nullptr);\n   std::unique_ptr<FunctionBody> bwd_fbody;\n-  TF_CHECK_OK(\n-      FunctionDefToBodyHelper(*bwd_body, AttrSlice(), &fld, &bwd_fbody));\n+  CHECK_OK(FunctionDefToBodyHelper(*bwd_body, AttrSlice(), &fld, &bwd_fbody));\n   auto node_name_index = bwd_fbody->graph->BuildNodeNameIndex();\n   const Node* identity = node_name_index.at(\"identity\");\n   ASSERT_NE(identity, nullptr);"
        },
        {
            "sha": "f4b7ed44ff41d5863298f652cbc1cccaacbec35e",
            "filename": "tensorflow/compiler/tf2xla/xla_compiled_cpu_function_thunks.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_compiled_cpu_function_thunks.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_compiled_cpu_function_thunks.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_compiled_cpu_function_thunks.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -29,7 +29,6 @@ limitations under the License.\n #include \"xla/backends/cpu/runtime/function_library.h\"\n #include \"xla/service/cpu/cpu_aot_compilation_result.h\"\n #include \"xla/tsl/concurrency/async_value_ref.h\"\n-#include \"xla/tsl/platform/status.h\"\n \n namespace tensorflow {\n \n@@ -47,17 +46,17 @@ XlaCompiledCpuFunctionThunks::XlaCompiledCpuFunctionThunks(\n       std::move(function_library));\n \n   // To load a CPU executable we don't need a compiler or a stream executor.\n-  TF_CHECK_OK(aot_compilation_result.status());\n+  CHECK_OK(aot_compilation_result.status());\n   // NO_CDC: aot_compilation_result is checked to be OK above.\n   auto cpu_executable = std::move(*aot_compilation_result.value())\n                             .LoadExecutable(/*stream_exec=*/nullptr);\n \n-  TF_CHECK_OK(cpu_executable.status());\n+  CHECK_OK(cpu_executable.status());\n   auto executable_or_err =\n       // NO_CDC: cpu_executable is checked to be OK above.\n       xla::cpu::NanoRtExecutable::Create(std::move(cpu_executable.value()));\n \n-  TF_CHECK_OK(executable_or_err.status());\n+  CHECK_OK(executable_or_err.status());\n   // NO_CDC: executable_or_err is checked to be OK above.\n   executable_ = std::move(executable_or_err.value());\n }"
        },
        {
            "sha": "162898288924602f67fdda54bd4f6120a32d846c",
            "filename": "tensorflow/compiler/tf2xla/xla_context.cc",
            "status": "modified",
            "additions": 21,
            "deletions": 15,
            "changes": 36,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_context.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_context.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_context.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -15,23 +15,29 @@ limitations under the License.\n \n #include \"tensorflow/compiler/tf2xla/xla_context.h\"\n \n+#include <cstdint>\n+#include <functional>\n #include <memory>\n+#include <string>\n #include <utility>\n #include <vector>\n \n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/status.h\"\n+#include \"absl/status/statusor.h\"\n #include \"absl/types/span.h\"\n-#include \"tensorflow/compiler/tf2xla/literal_util.h\"\n-#include \"tensorflow/compiler/tf2xla/shape_util.h\"\n #include \"tensorflow/compiler/tf2xla/type_util.h\"\n+#include \"tensorflow/compiler/tf2xla/xla_expression.h\"\n #include \"tensorflow/compiler/tf2xla/xla_helpers.h\"\n-#include \"xla/client/client_library.h\"\n+#include \"tensorflow/compiler/tf2xla/xla_resource.h\"\n #include \"xla/hlo/builder/xla_builder.h\"\n #include \"xla/hlo/builder/xla_computation.h\"\n-#include \"xla/layout_util.h\"\n-#include \"xla/literal.h\"\n-#include \"tensorflow/core/common_runtime/dma_helper.h\"\n-#include \"tensorflow/core/platform/logging.h\"\n-#include \"tensorflow/core/platform/statusor.h\"\n+#include \"xla/shape_util.h\"\n+#include \"tensorflow/core/framework/op_kernel.h\"\n+#include \"tensorflow/core/framework/types.h\"\n+#include \"tensorflow/core/graph/graph.h\"\n+#include \"tensorflow/core/platform/errors.h\"\n \n namespace tensorflow {\n \n@@ -44,8 +50,8 @@ const char XlaContext::kXlaContextResourceName[] = \"_xla_context\";\n   // per-step context is looked up in the resource manager. The\n   // JIT will prepopulate the JITContext.\n   XlaContext* context;\n-  TF_CHECK_OK(ctx->step_container()->Lookup(ctx->resource_manager(),\n-                                            kXlaContextResourceName, &context));\n+  CHECK_OK(ctx->step_container()->Lookup(ctx->resource_manager(),\n+                                         kXlaContextResourceName, &context));\n   // The resource manager handed us a fresh reference to 'context', but retains\n   // a reference itself so the context won't be freed. The resource manager will\n   // outlive the JIT compilation.\n@@ -88,7 +94,7 @@ const xla::XlaComputation* XlaContext::GetOrCreateMax(const DataType type) {\n     VLOG(1) << \"Building Max() for \" << type_string;\n     xla::XlaBuilder b(\"max<\" + type_string + \">\");\n     xla::PrimitiveType xla_type;\n-    TF_CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n+    CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n     auto x =\n         xla::Parameter(&b, 0, xla::ShapeUtil::MakeShape(xla_type, {}), \"x\");\n     auto y =\n@@ -104,7 +110,7 @@ const xla::XlaComputation* XlaContext::GetOrCreateMin(const DataType type) {\n     VLOG(1) << \"Building Min() for \" << type_string;\n     xla::XlaBuilder b(\"min<\" + type_string + \">\");\n     xla::PrimitiveType xla_type;\n-    TF_CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n+    CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n     auto x =\n         xla::Parameter(&b, 0, xla::ShapeUtil::MakeShape(xla_type, {}), \"x\");\n     auto y =\n@@ -120,7 +126,7 @@ const xla::XlaComputation* XlaContext::GetOrCreateAdd(const DataType type) {\n     VLOG(1) << \"Building Add() for \" << type_string;\n     xla::XlaBuilder b(\"add<\" + type_string + \">\");\n     xla::PrimitiveType xla_type;\n-    TF_CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n+    CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n     auto x =\n         xla::Parameter(&b, 0, xla::ShapeUtil::MakeShape(xla_type, {}), \"x\");\n     auto y =\n@@ -137,7 +143,7 @@ const xla::XlaComputation* XlaContext::GetOrCreateLogAddExp(\n     VLOG(1) << \"Building LogAddExp() for \" << type_string;\n     xla::XlaBuilder b(\"log_add_exp<\" + type_string + \">\");\n     xla::PrimitiveType xla_type;\n-    TF_CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n+    CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n     auto x =\n         xla::Parameter(&b, 0, xla::ShapeUtil::MakeShape(xla_type, {}), \"x\");\n     auto y =\n@@ -158,7 +164,7 @@ const xla::XlaComputation* XlaContext::GetOrCreateMul(const DataType type) {\n     VLOG(1) << \"Building Mul() for \" << type_string;\n     xla::XlaBuilder b(\"mul<\" + type_string + \">\");\n     xla::PrimitiveType xla_type;\n-    TF_CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n+    CHECK_OK(DataTypeToPrimitiveType(type, &xla_type));\n     auto x =\n         xla::Parameter(&b, 0, xla::ShapeUtil::MakeShape(xla_type, {}), \"x\");\n     auto y ="
        },
        {
            "sha": "0250d423296ede3d805276587cbf3488e4d03517",
            "filename": "tensorflow/compiler/tf2xla/xla_helpers.cc",
            "status": "modified",
            "additions": 27,
            "deletions": 11,
            "changes": 38,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_helpers.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_helpers.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_helpers.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -17,58 +17,74 @@ limitations under the License.\n \n #include \"tensorflow/compiler/tf2xla/xla_helpers.h\"\n \n-#include <map>\n+#include <cstdint>\n+#include <numeric>\n #include <string>\n #include <utility>\n+#include <vector>\n \n+#include \"absl/container/btree_map.h\"\n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/status.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"absl/strings/str_cat.h\"\n #include \"absl/synchronization/notification.h\"\n+#include \"absl/time/time.h\"\n #include \"absl/types/span.h\"\n #include \"tensorflow/compiler/tf2xla/lib/util.h\"\n-#include \"tensorflow/compiler/tf2xla/literal_util.h\"\n #include \"tensorflow/compiler/tf2xla/shape_util.h\"\n #include \"tensorflow/compiler/tf2xla/type_util.h\"\n-#include \"xla/backends/gpu/collectives/gpu_clique_key.h\"\n #include \"xla/core/collectives/clique_id.h\"\n #include \"xla/core/collectives/clique_key.h\"\n-#include \"xla/hlo/builder/lib/arithmetic.h\"\n-#include \"xla/hlo/builder/lib/constants.h\"\n+#include \"xla/executable_run_options.h\"\n #include \"xla/hlo/builder/xla_builder.h\"\n #include \"xla/hlo/builder/xla_computation.h\"\n+#include \"xla/literal.h\"\n+#include \"xla/literal_util.h\"\n+#include \"xla/service/computation_placer.h\"\n #include \"xla/service/gpu/gpu_executable_run_options.h\"\n+#include \"xla/shape.h\"\n+#include \"xla/shape_util.h\"\n #include \"xla/stream_executor/stream.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n-#include \"xla/types.h\"\n+#include \"xla/tsl/platform/errors.h\"\n #include \"tensorflow/core/common_runtime/device_mgr.h\"\n #include \"tensorflow/core/framework/collective.h\"\n #include \"tensorflow/core/framework/device.h\"\n+#include \"tensorflow/core/framework/device_base.h\"\n #include \"tensorflow/core/framework/tensor.h\"\n+#include \"tensorflow/core/framework/tensor_shape.h\"\n+#include \"tensorflow/core/framework/types.h\"\n #include \"tensorflow/core/lib/core/status.h\"\n+#include \"tensorflow/core/platform/errors.h\"\n+#include \"tensorflow/core/platform/refcount.h\"\n \n namespace tensorflow {\n \n xla::XlaOp XlaHelpers::Zero(xla::XlaBuilder* b, DataType data_type) {\n   xla::PrimitiveType type;\n-  TF_CHECK_OK(DataTypeToPrimitiveType(data_type, &type));\n+  CHECK_OK(DataTypeToPrimitiveType(data_type, &type));\n   return xla::ConstantLiteral(b, xla::LiteralUtil::Zero(type));\n }\n \n xla::XlaOp XlaHelpers::One(xla::XlaBuilder* b, DataType data_type) {\n   xla::PrimitiveType type;\n-  TF_CHECK_OK(DataTypeToPrimitiveType(data_type, &type));\n+  CHECK_OK(DataTypeToPrimitiveType(data_type, &type));\n   return xla::ConstantLiteral(b, xla::LiteralUtil::One(type));\n }\n \n xla::XlaOp XlaHelpers::IntegerLiteral(xla::XlaBuilder* b, DataType data_type,\n                                       int64_t value) {\n   xla::PrimitiveType type;\n-  TF_CHECK_OK(DataTypeToPrimitiveType(data_type, &type));\n+  CHECK_OK(DataTypeToPrimitiveType(data_type, &type));\n   return ::tensorflow::IntegerLiteral(b, type, value);\n }\n \n xla::XlaOp XlaHelpers::FloatLiteral(xla::XlaBuilder* b, DataType data_type,\n                                     double value) {\n   xla::PrimitiveType type;\n-  TF_CHECK_OK(DataTypeToPrimitiveType(data_type, &type));\n+  CHECK_OK(DataTypeToPrimitiveType(data_type, &type));\n   return ::tensorflow::FloatLiteral(b, type, value);\n }\n \n@@ -139,7 +155,7 @@ DataType XlaHelpers::SumAccumulationType(const DataType& dtype) {\n xla::XlaOp XlaHelpers::ConvertElementType(const xla::XlaOp operand,\n                                           const DataType new_element_type) {\n   xla::PrimitiveType convert_to;\n-  TF_CHECK_OK(DataTypeToPrimitiveType(new_element_type, &convert_to));\n+  CHECK_OK(DataTypeToPrimitiveType(new_element_type, &convert_to));\n   return xla::ConvertElementType(operand, convert_to);\n }\n "
        },
        {
            "sha": "f8e85ba81f677a3a7cc5a869a40f056bd0f86a8c",
            "filename": "tensorflow/compiler/tf2xla/xla_op_registry.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 7,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_op_registry.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/decbcf45d973916d1e0f8101eab3b1f3f105e837/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_op_registry.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/tensorflow%2Fcompiler%2Ftf2xla%2Fxla_op_registry.cc?ref=decbcf45d973916d1e0f8101eab3b1f3f105e837",
            "patch": "@@ -15,9 +15,14 @@ limitations under the License.\n \n #include \"tensorflow/compiler/tf2xla/xla_op_registry.h\"\n \n-#include <functional>\n+#include <algorithm>\n+#include <iterator>\n #include <memory>\n+#include <set>\n #include <string>\n+#include <unordered_set>\n+#include <utility>\n+#include <vector>\n \n #include \"absl/algorithm/container.h\"\n #include \"absl/log/check.h\"\n@@ -28,6 +33,7 @@ limitations under the License.\n #include \"absl/types/span.h\"\n #include \"tensorflow/compiler/jit/flags.h\"\n #include \"tensorflow/compiler/jit/xla_cluster_util.h\"\n+#include \"xla/tsl/platform/errors.h\"\n #include \"xla/util.h\"\n #include \"tensorflow/core/common_runtime/next_pluggable_device/next_pluggable_device_factory.h\"\n #include \"tensorflow/core/framework/device_base.h\"\n@@ -42,11 +48,7 @@ limitations under the License.\n #include \"tensorflow/core/framework/types.h\"\n #include \"tensorflow/core/framework/types.pb.h\"\n #include \"tensorflow/core/platform/mutex.h\"\n-#include \"tensorflow/core/platform/status.h\"\n-#include \"tensorflow/core/platform/types.h\"\n #include \"tensorflow/core/tfrt/common/pjrt_util.h\"\n-#include \"tsl/platform/errors.h\"\n-#include \"tsl/platform/status.h\"\n \n namespace tensorflow {\n \n@@ -265,7 +267,7 @@ void XlaOpRegistry::RegisterCompilationKernels() {\n             \"Ops registered: \\n\" +\n                 dynamic_cast<OpRegistry*>(op_registry)->DebugString(true));\n       }\n-      TF_CHECK_OK(lookup_status);\n+      CHECK_OK(lookup_status);\n \n       std::unordered_set<std::string> type_attrs;\n       for (const OpDef::AttrDef& attr_def : op_def->attr()) {\n@@ -475,7 +477,7 @@ XlaOpRegistry::CompileTimeConstantInputArgNames(const std::string& op) {\n       }\n     } else {\n       int start, stop;\n-      TF_CHECK_OK(op_kernel->InputRange(input, &start, &stop));\n+      CHECK_OK(op_kernel->InputRange(input, &start, &stop));\n       for (int i = start; i < stop; ++i) {\n         result->push_back(i);\n       }"
        }
    ],
    "stats": {
        "total": 592,
        "additions": 364,
        "deletions": 228
    }
}