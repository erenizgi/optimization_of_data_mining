{
    "author": "junwhanahn",
    "message": "Implement `AbslStringify` for strong int types in TSL\n\nPiperOrigin-RevId: 845904790",
    "sha": "b525b848e7b79f7583665ee82b0fced245871425",
    "files": [
        {
            "sha": "9f1ff1dc6723ebeda8796fadb777d7e18e12fbde",
            "filename": "third_party/xla/xla/tsl/lib/gtl/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b525b848e7b79f7583665ee82b0fced245871425/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fgtl%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b525b848e7b79f7583665ee82b0fced245871425/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fgtl%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fgtl%2FBUILD?ref=b525b848e7b79f7583665ee82b0fced245871425",
            "patch": "@@ -98,6 +98,7 @@ cc_library(\n     deps = [\n         \"//xla/tsl/platform:macros\",\n         \"//xla/tsl/platform:types\",\n+        \"@com_google_absl//absl/strings:str_format\",\n     ],\n )\n \n@@ -247,6 +248,7 @@ tsl_cc_test(\n         \"//xla/tsl/platform:test\",\n         \"//xla/tsl/platform:types\",\n         \"@com_google_absl//absl/status\",\n+        \"@com_google_absl//absl/strings\",\n         \"@com_google_googletest//:gtest_main\",\n         \"@local_tsl//tsl/platform:hash\",\n     ],"
        },
        {
            "sha": "7930484b948a8361d12a181e6e6b66c435e90af1",
            "filename": "third_party/xla/xla/tsl/lib/gtl/int_type.h",
            "status": "modified",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b525b848e7b79f7583665ee82b0fced245871425/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fgtl%2Fint_type.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b525b848e7b79f7583665ee82b0fced245871425/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fgtl%2Fint_type.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fgtl%2Fint_type.h?ref=b525b848e7b79f7583665ee82b0fced245871425",
            "patch": "@@ -154,11 +154,13 @@ limitations under the License.\n \n #include <stddef.h>\n \n+#include <cstdint>\n #include <functional>\n #include <iosfwd>\n #include <ostream>  // NOLINT\n #include <unordered_map>\n \n+#include \"absl/strings/str_format.h\"\n #include \"xla/tsl/platform/macros.h\"\n #include \"xla/tsl/platform/types.h\"\n \n@@ -290,6 +292,21 @@ std::ostream& operator<<(std::ostream& os,  // NOLINT\n   return os << arg.value();\n }\n \n+template <typename Sink, typename... T>\n+void AbslStringify(Sink& sink, IntType<T...> arg) {\n+  using ValueType = typename decltype(arg)::ValueType;\n+\n+  // int8_t/uint8_t are not supported by the \"%v\" specifier due to it being\n+  // ambiguous whether an integer or character should be printed.\n+  if constexpr (std::is_same_v<ValueType, int8_t>) {\n+    absl::Format(&sink, \"%d\", arg.value());\n+  } else if constexpr (std::is_same_v<ValueType, uint8_t>) {\n+    absl::Format(&sink, \"%u\", arg.value());\n+  } else {\n+    absl::Format(&sink, \"%v\", arg.value());\n+  }\n+}\n+\n // -- NON-MEMBER ARITHMETIC OPERATORS ------------------------------------------\n // We support only the +, -, *, and / operators with the same IntType and\n // ValueType types.  The reason is to allow simple manipulation on these IDs"
        },
        {
            "sha": "0120e2f96e1ecc070f7688e30df6431b0738d2ed",
            "filename": "third_party/xla/xla/tsl/lib/gtl/int_type_test.cc",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b525b848e7b79f7583665ee82b0fced245871425/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fgtl%2Fint_type_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b525b848e7b79f7583665ee82b0fced245871425/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fgtl%2Fint_type_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Flib%2Fgtl%2Fint_type_test.cc?ref=b525b848e7b79f7583665ee82b0fced245871425",
            "patch": "@@ -20,6 +20,7 @@ limitations under the License.\n #include <memory>\n #include <unordered_map>\n \n+#include \"absl/strings/str_cat.h\"\n #include \"xla/tsl/platform/test.h\"\n #include \"xla/tsl/platform/types.h\"\n \n@@ -291,4 +292,10 @@ TYPED_TEST(IntTypeTest, TestMove) {\n   EXPECT_EQ(321, *foo.ptr);\n }\n \n+TYPED_TEST(IntTypeTest, TestAbslStringify) {\n+  TypeParam a(1);\n+\n+  EXPECT_EQ(absl::StrCat(a), absl::StrCat(a.value()));\n+}\n+\n }  // namespace tsl"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 26,
        "deletions": 0
    }
}