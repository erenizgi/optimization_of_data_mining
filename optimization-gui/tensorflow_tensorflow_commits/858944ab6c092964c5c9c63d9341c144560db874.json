{
    "author": "zvikinoza",
    "message": "Test for HLO module splitting and linking\n\nAdds end-to-end execution tests for HLO module splitting and linking on both CPU and TPU backends. These tests verify that splitting a module and then linking it back produces a module that is semantically equivalent to the original, by executing both versions and comparing their outputs for numerical consistency.\n\nPiperOrigin-RevId: 844821926",
    "sha": "858944ab6c092964c5c9c63d9341c144560db874",
    "files": [
        {
            "sha": "1e40fbf64e9f6674af76b118d4c8e4017a5e2014",
            "filename": "third_party/xla/xla/hlo/separate_compilation/hlo_module_linking.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/858944ab6c092964c5c9c63d9341c144560db874/third_party%2Fxla%2Fxla%2Fhlo%2Fseparate_compilation%2Fhlo_module_linking.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/858944ab6c092964c5c9c63d9341c144560db874/third_party%2Fxla%2Fxla%2Fhlo%2Fseparate_compilation%2Fhlo_module_linking.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fhlo%2Fseparate_compilation%2Fhlo_module_linking.cc?ref=858944ab6c092964c5c9c63d9341c144560db874",
            "patch": "@@ -202,6 +202,8 @@ absl::StatusOr<std::unique_ptr<HloModule>> LinkComputation(\n   TF_ASSIGN_OR_RETURN(HloComputation * linked_clone_ptr, linker.Link());\n \n   linked_module->ReplaceEntryComputation(linked_clone_ptr);\n+  linked_module->mutable_config().SetComputationLayoutIfExists(\n+      linked_clone_ptr->ComputeProgramShape());\n   xla::HloDCE dce_pass;\n   TF_RETURN_IF_ERROR(dce_pass.Run(linked_module.get()).status());\n "
        }
    ],
    "stats": {
        "total": 2,
        "additions": 2,
        "deletions": 0
    }
}