{
    "author": "tensorflower-gardener",
    "message": "Bring together gemm autotuning passes.\n\nTo seperately check the effect of pipeline change before migrating the gemm_fusion_autotuner.\n\nPiperOrigin-RevId: 839340018",
    "sha": "74e4377cb0d4559f8a8e5c6d662f867b1d84dbb5",
    "files": [
        {
            "sha": "c6dca240f4c100f931d67c202820afeba211e1b5",
            "filename": "third_party/xla/xla/service/gpu/gpu_compiler.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/74e4377cb0d4559f8a8e5c6d662f867b1d84dbb5/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fgpu_compiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/74e4377cb0d4559f8a8e5c6d662f867b1d84dbb5/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fgpu_compiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Fgpu_compiler.cc?ref=74e4377cb0d4559f8a8e5c6d662f867b1d84dbb5",
            "patch": "@@ -1717,6 +1717,10 @@ absl::Status GpuCompiler::OptimizeHloPostLayoutAssignment(\n   AddGemmRewriterPasses(pipeline, debug_options, gpu_version,\n                         gpu_target_config.device_description.runtime_version());\n \n+  TF_RETURN_IF_ERROR(AddConvAndGemmAutotuningPasses(\n+      &pipeline, gpu_version, options, hlo_module, autotune_config, thread_pool,\n+      stream_exec, &gpu_target_config));\n+\n   // Rewrite GEMMs with broadcasted inputs as strided GEMMs.\n   pipeline.AddPass<GemmBroadcastFoldingRewriter>();\n \n@@ -1734,10 +1738,6 @@ absl::Status GpuCompiler::OptimizeHloPostLayoutAssignment(\n \n   pipeline.AddPass<HostOffloader>(alias_info);\n \n-  TF_RETURN_IF_ERROR(AddConvAndGemmAutotuningPasses(\n-      &pipeline, gpu_version, options, hlo_module, autotune_config, thread_pool,\n-      stream_exec, &gpu_target_config));\n-\n   // The GEMM fusion autotuner can insert new bf16 reductions that need to be\n   // normalized again.\n   add_float_normalization(pipeline);"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
    }
}