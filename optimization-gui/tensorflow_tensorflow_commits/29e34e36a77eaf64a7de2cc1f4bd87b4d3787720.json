{
    "author": "cezheng",
    "message": "Make NonCopyableBuffer constructor that takes unique_ptr and size public.\n\nPiperOrigin-RevId: 809250103",
    "sha": "29e34e36a77eaf64a7de2cc1f4bd87b4d3787720",
    "files": [
        {
            "sha": "8fb31232886372e759998d7e5d26067bd876ba01",
            "filename": "third_party/xla/xla/stream_executor/tpu/noncopyable_buffer.h",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/29e34e36a77eaf64a7de2cc1f4bd87b4d3787720/third_party%2Fxla%2Fxla%2Fstream_executor%2Ftpu%2Fnoncopyable_buffer.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/29e34e36a77eaf64a7de2cc1f4bd87b4d3787720/third_party%2Fxla%2Fxla%2Fstream_executor%2Ftpu%2Fnoncopyable_buffer.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Ftpu%2Fnoncopyable_buffer.h?ref=29e34e36a77eaf64a7de2cc1f4bd87b4d3787720",
            "patch": "@@ -72,6 +72,10 @@ class NoncopyableBuffer {\n     std::fill_n(data_u32, size_in_u32s, v);\n   }\n \n+  // Takes ownership of an OwnedDataPtr.\n+  NoncopyableBuffer(OwnedDataPtr data, size_t size)\n+      : data_(std::move(data)), buf_(data_.get()), size_(size) {}\n+\n   // Directly use buf pointer without copying it to owning data_. This delays\n   // the memcpy until mutable access is requested. \"buf\" is not owned by this\n   // data structure, so it is the user's duty to ensure the live range of \"buf\"\n@@ -143,9 +147,6 @@ class NoncopyableBuffer {\n   }\n \n  private:\n-  NoncopyableBuffer(OwnedDataPtr data, size_t size)\n-      : data_(std::move(data)), buf_(data_.get()), size_(size) {}\n-\n   // If data_ != nullptr then buf_ == data_.get()\n   OwnedDataPtr data_{nullptr, free};  // Owning data pointer.\n   const void* buf_;                   // Non-owning data pointer."
        }
    ],
    "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
    }
}