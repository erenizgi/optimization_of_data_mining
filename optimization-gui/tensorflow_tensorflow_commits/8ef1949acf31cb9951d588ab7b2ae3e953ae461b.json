{
    "author": "ermilovmaxim",
    "message": "switch from deprecated TF_CHECK_OK\n\nPiperOrigin-RevId: 836913810",
    "sha": "8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
    "files": [
        {
            "sha": "3fc095b9545cc258ec0f2eb1db76cc57bd020144",
            "filename": "third_party/xla/xla/pjrt/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -700,6 +700,7 @@ cc_library(\n         \"//xla/client:local_client\",\n         \"//xla/hlo/builder:xla_computation\",\n         \"//xla/hlo/ir:hlo\",\n+        \"//xla/mlir_hlo:mhlo_passes\",\n         \"//xla/pjrt/distributed:protocol_proto_cc\",\n         \"//xla/pjrt/dump\",\n         \"//xla/pjrt/profiling:device_time_measurement\",\n@@ -719,15 +720,13 @@ cc_library(\n         \"//xla/service/gpu:gpu_executable_run_options\",\n         \"//xla/stream_executor:device_memory\",\n         \"//xla/stream_executor:device_memory_allocator\",\n-        \"//xla/stream_executor:event\",\n         \"//xla/stream_executor:stream\",\n         \"//xla/tsl/concurrency:async_value\",\n         \"//xla/tsl/concurrency:ref_count\",\n         \"//xla/tsl/framework:allocator\",\n         \"//xla/tsl/platform:env\",\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:logging\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/base\",\n@@ -1074,7 +1073,6 @@ cc_library(\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/synchronization\",\n         \"@local_tsl//tsl/platform:logging\",\n-        \"@local_tsl//tsl/platform:status\",\n     ],\n )\n "
        },
        {
            "sha": "9313c2cd13a087bc6cdfddfa9de7b1d1203e9628",
            "filename": "third_party/xla/xla/pjrt/c/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -537,7 +537,6 @@ cc_library(\n         \"//xla/pjrt:pjrt_executable\",\n         \"//xla/pjrt/proto:compile_options_proto_cc\",\n         \"//xla/service:computation_placer_hdr\",\n-        \"//xla/tsl/platform:status\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n@@ -570,7 +569,6 @@ xla_test(\n         \"//xla:literal\",\n         \"//xla:literal_util\",\n         \"//xla:shape_util\",\n-        \"//xla:util\",\n         \"//xla/client:client_library\",\n         \"//xla/ffi:execution_context\",\n         \"//xla/ffi:ffi_api\",\n@@ -585,7 +583,6 @@ xla_test(\n         \"//xla/stream_executor/gpu:gpu_init\",\n         \"//xla/tests:literal_test_util\",\n         \"//xla/tsl/lib/core:status_test_util\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"@com_google_absl//absl/cleanup\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n@@ -643,7 +640,6 @@ cc_library(\n     deps = [\n         \":pjrt_c_api_hdrs\",\n         \":pjrt_c_api_helpers\",\n-        \":pjrt_c_api_memory_descriptions_extension_hdrs\",\n         \":pjrt_c_api_test_base\",\n         \"//xla:future\",\n         \"//xla:literal\",\n@@ -660,7 +656,6 @@ cc_library(\n         \"//xla/service:computation_placer_hdr\",\n         \"//xla/service:hlo_proto_cc\",\n         \"//xla/tests:literal_test_util\",\n-        \"//xla/tsl/platform:status\",\n         \"@com_google_absl//absl/base:core_headers\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/log\","
        },
        {
            "sha": "1b994f5d53cf1b6a65fbcf129aa7d5f086e37160",
            "filename": "third_party/xla/xla/pjrt/c/pjrt_c_api_gpu_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_gpu_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_gpu_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_gpu_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -69,9 +69,7 @@ limitations under the License.\n #include \"xla/stream_executor/gpu/gpu_init.h\"\n #include \"xla/tests/literal_test_util.h\"\n #include \"xla/tsl/lib/core/status_test_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n-#include \"xla/util.h\"\n #include \"tsl/platform/mem.h\"\n \n namespace pjrt {\n@@ -99,7 +97,7 @@ class PjrtCApiGpuTest : public PjrtCApiTestBase {\n TEST_F(PjrtCApiGpuTest, CreateViewOfDeviceBuffer) {\n   // Prepares a device memory ptr on GPU.\n   auto [buffer, buffer_future] = create_iota_buffer();\n-  TF_CHECK_OK(buffer_future.Await());\n+  CHECK_OK(buffer_future.Await());\n   PJRT_Buffer_OpaqueDeviceMemoryDataPointer_Args device_buffer_ptr_args;\n   device_buffer_ptr_args.struct_size =\n       PJRT_Buffer_OpaqueDeviceMemoryDataPointer_Args_STRUCT_SIZE;\n@@ -170,7 +168,7 @@ TEST_F(PjrtCApiGpuTest, CreateViewOfDeviceBuffer) {\n   ASSERT_EQ(to_host_error, nullptr);\n   xla::Future<> transfer_to_host =\n       ::pjrt::ConvertCEventToCppFuture(to_host_args.event, api_);\n-  TF_CHECK_OK(transfer_to_host.Await());\n+  CHECK_OK(transfer_to_host.Await());\n   ASSERT_EQ(literal->data<float>().size(), 4);\n   std::vector<float> float_data(4);\n   std::iota(float_data.begin(), float_data.end(), 41.0f);\n@@ -207,7 +205,7 @@ class PjrtCApiGpuBufferTest : public PjrtCApiGpuTest {\n \n TEST_F(PjrtCApiGpuBufferTest, CopyRawToHost) {\n   auto [buffer, buffer_future] = create_iota_buffer();\n-  TF_CHECK_OK(buffer_future.Await());\n+  CHECK_OK(buffer_future.Await());\n \n   size_t size = buffer_->buffer->GetOnDeviceSizeInBytes().value();\n   PJRT_Buffer_CopyRawToHost_Args args;"
        },
        {
            "sha": "d45ce89ba062be901bd2449528f7c45a44914fc7",
            "filename": "third_party/xla/xla/pjrt/c/pjrt_c_api_test.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -45,7 +45,6 @@ limitations under the License.\n #include \"xla/literal_util.h\"\n #include \"xla/pjrt/c/pjrt_c_api.h\"\n #include \"xla/pjrt/c/pjrt_c_api_helpers.h\"\n-#include \"xla/pjrt/c/pjrt_c_api_memory_descriptions_extension.h\"\n #include \"xla/pjrt/c/pjrt_c_api_test_base.h\"\n #include \"xla/pjrt/pjrt_client.h\"\n #include \"xla/pjrt/pjrt_device_description.h\"\n@@ -55,7 +54,6 @@ limitations under the License.\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n #include \"xla/tests/literal_test_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/xla.pb.h\"\n #include \"xla/xla_data.pb.h\"\n \n@@ -664,7 +662,7 @@ TEST_F(PjrtCApiBufferTest, ReadyEvent) {\n \n TEST_F(PjrtCApiBufferTest, ToHostBufferNoHostLayout) {\n   auto [buffer, buffer_future] = create_iota_buffer();\n-  TF_CHECK_OK(buffer_future.Await());\n+  CHECK_OK(buffer_future.Await());\n \n   PJRT_Buffer_ToHostBuffer_Args args;\n   args.struct_size = PJRT_Buffer_ToHostBuffer_Args_STRUCT_SIZE;\n@@ -680,7 +678,7 @@ TEST_F(PjrtCApiBufferTest, ToHostBufferNoHostLayout) {\n   PJRT_Error* error = api_->PJRT_Buffer_ToHostBuffer(&args);\n   xla::Future<> transfer_to_host =\n       ::pjrt::ConvertCEventToCppFuture(args.event, api_);\n-  TF_CHECK_OK(transfer_to_host.Await());\n+  CHECK_OK(transfer_to_host.Await());\n \n   EXPECT_EQ(error, nullptr);\n   ASSERT_EQ(literal->data<float>().size(), 4);"
        },
        {
            "sha": "093adac9c61a90ec46b61d557b4af56cdbd74df4",
            "filename": "third_party/xla/xla/pjrt/c/pjrt_c_api_test_base.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_test_base.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_test_base.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc%2Fpjrt_c_api_test_base.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -38,7 +38,6 @@ limitations under the License.\n #include \"xla/service/computation_placer.h\"\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/xla_data.pb.h\"\n \n namespace pjrt {\n@@ -135,7 +134,7 @@ std::string PjrtCApiTestBase::BuildSingleDeviceCompileOptionStr() {\n   xla::CompileOptions options;\n   options.executable_build_options = build_options;\n   absl::StatusOr<xla::CompileOptionsProto> options_proto = options.ToProto();\n-  TF_CHECK_OK(options_proto.status());\n+  CHECK_OK(options_proto.status());\n   return options_proto->SerializeAsString();\n }\n "
        },
        {
            "sha": "c2fe9027d68117ddc951af6054237aecdf1406fb",
            "filename": "third_party/xla/xla/pjrt/c_api_client/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -79,7 +79,6 @@ cc_library(\n         \"//xla/service:hlo_proto_cc\",\n         \"//xla/tsl/framework:allocator\",\n         \"//xla/tsl/platform:errors\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/protobuf:coordination_service_proto_cc\",\n         \"@com_google_absl//absl/algorithm:container\","
        },
        {
            "sha": "8ddbd034434a55d86554d5d7c5f35f3f4baa919b",
            "filename": "third_party/xla/xla/pjrt/c_api_client/pjrt_c_api_client.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fc_api_client%2Fpjrt_c_api_client.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -39,7 +39,6 @@ limitations under the License.\n #include \"absl/strings/string_view.h\"\n #include \"absl/synchronization/mutex.h\"\n #include \"absl/types/span.h\"\n-#include \"llvm/ADT/STLExtras.h\"\n #include \"llvm/Support/ErrorHandling.h\"\n #include \"mlir/IR/OwningOpRef.h\"\n #include \"mlir/Pass/PassManager.h\"\n@@ -84,7 +83,6 @@ limitations under the License.\n #include \"xla/shape_util.h\"\n #include \"xla/tsl/framework/allocator.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/protobuf/coordination_service.pb.h\"\n #include \"xla/util.h\"\n@@ -1328,7 +1326,7 @@ class PjRtCApiAsyncHostToDeviceTransferManager\n     };\n     absl::StatusOr<std::vector<PJRT_NamedValue>> result =\n         pjrt::ConvertToPjRtNamedValueList(pjrt_metadata);\n-    TF_CHECK_OK(result.status());\n+    CHECK_OK(result.status());\n     std::vector<PJRT_NamedValue> c_metadata = result.value();\n     args.transfer_metadata = c_metadata.data();\n     args.num_metadata = c_metadata.size();\n@@ -1933,7 +1931,7 @@ PjRtCApiExecutable::GetOutputLayouts() const {\n                                   serialize_args.serialized_bytes_size);\n     absl::StatusOr<std::shared_ptr<const PjRtLayout>> pjrt_layout =\n         PjRtLayout::Deserialize(serialized_layout);\n-    TF_CHECK_OK(pjrt_layout.status());\n+    CHECK_OK(pjrt_layout.status());\n     layouts.push_back(*std::move(pjrt_layout));\n   }\n   return layouts;\n@@ -2795,7 +2793,7 @@ std::shared_ptr<const PjRtLayout> PjRtCApiBuffer::layout() const {\n                                       serialize_args.serialized_bytes_size);\n         absl::StatusOr<std::shared_ptr<const PjRtLayout>> pjrt_layout =\n             PjRtLayout::Deserialize(serialized_layout);\n-        TF_CHECK_OK(pjrt_layout.status());\n+        CHECK_OK(pjrt_layout.status());\n         layout_ = *std::move(pjrt_layout);\n       }\n     }"
        },
        {
            "sha": "73d544a3b20cd3b5ccb642b6e756774bf1f49785",
            "filename": "third_party/xla/xla/pjrt/extensions/cross_host_transfers/pjrt_c_api_cross_host_transfers_extension_gpu_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fextensions%2Fcross_host_transfers%2Fpjrt_c_api_cross_host_transfers_extension_gpu_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fextensions%2Fcross_host_transfers%2Fpjrt_c_api_cross_host_transfers_extension_gpu_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fextensions%2Fcross_host_transfers%2Fpjrt_c_api_cross_host_transfers_extension_gpu_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -240,12 +240,12 @@ absl::Status SuccessfulCrossHostTransferTestBody(bool is_sender,\n       if (transfer_error != nullptr) {\n         return transfer_error->status;\n       }\n-      TF_CHECK_OK(args.buffer->buffer->GetReadyFuture().Await());\n+      CHECK_OK(args.buffer->buffer->GetReadyFuture().Await());\n       std::unique_ptr<PJRT_Event, PJRT_EventDeleter> event(\n           args.done_with_host_buffer, MakeEventDeleter(api));\n \n       raw_buffers.push_back(args.buffer);\n-      TF_CHECK_OK(event->future.Await());\n+      CHECK_OK(event->future.Await());\n       xla::PjRtGlobalDeviceId src_device_id =\n           args.device->device->global_device_id();\n       dst_device_ids.push_back(1 - src_device_id);\n@@ -268,12 +268,12 @@ absl::Status SuccessfulCrossHostTransferTestBody(bool is_sender,\n         ->PJRT_Transfers_PJRT_Client_CrossHostSendBuffers(&send_args);\n \n     for (int i = 0; i < num_arrays; ++i) {\n-      TF_CHECK_OK(send_args.send_events[i]->future.Await());\n+      CHECK_OK(send_args.send_events[i]->future.Await());\n       std::unique_ptr<PJRT_Buffer, ::pjrt::PJRT_BufferDeleter> buffer(\n           raw_buffers[i], ::pjrt::MakeBufferDeleter(api));\n       std::unique_ptr<PJRT_Event, PJRT_EventDeleter> send_event(\n           send_args.send_events[i], MakeEventDeleter(api));\n-      TF_CHECK_OK(send_event->future.Await());\n+      CHECK_OK(send_event->future.Await());\n     }\n   } else {\n     // Receive some data."
        },
        {
            "sha": "a6af9eab59bbf38154c35c292919f7cec8ca365b",
            "filename": "third_party/xla/xla/pjrt/gpu/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -282,7 +282,6 @@ xla_test(\n         \"@local_tsl//tsl/platform\",\n         \"@local_tsl//tsl/platform:casts\",\n         \"@local_tsl//tsl/platform:platform_port\",\n-        \"@local_tsl//tsl/platform:protobuf\",\n     ],\n )\n "
        },
        {
            "sha": "98142238862092de56423a84b8c29b0bc5c82e80",
            "filename": "third_party/xla/xla/pjrt/gpu/se_gpu_pjrt_client_test.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Fse_gpu_pjrt_client_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Fse_gpu_pjrt_client_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Fse_gpu_pjrt_client_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -96,6 +96,7 @@ limitations under the License.\n #include \"xla/tests/literal_test_util.h\"\n #include \"xla/tsl/concurrency/async_value_ref.h\"\n #include \"xla/tsl/concurrency/ref_count.h\"\n+#include \"xla/tsl/framework/allocator.h\"\n #include \"xla/tsl/lib/core/status_test_util.h\"\n #include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n@@ -111,7 +112,6 @@ limitations under the License.\n #include \"tsl/platform/casts.h\"\n #include \"tsl/platform/mem.h\"\n #include \"tsl/platform/platform.h\"\n-#include \"tsl/platform/protobuf.h\"\n \n namespace xla {\n namespace {\n@@ -395,11 +395,11 @@ TEST(StreamExecutorGpuClientTest, SendRecvChunked) {\n                             std::unique_ptr<CopyToDeviceStream> stream) {\n         auto chunk0 = PjRtChunk::AllocateDefault(sizeof(float));\n         *reinterpret_cast<float*>(chunk0.data()) = 5.0f;\n-        TF_CHECK_OK(stream->AddChunk(std::move(chunk0)).Await());\n+        CHECK_OK(stream->AddChunk(std::move(chunk0)).Await());\n \n         auto chunk1 = PjRtChunk::AllocateDefault(sizeof(float));\n         *reinterpret_cast<float*>(chunk1.data()) = 6.0f;\n-        TF_CHECK_OK(stream->AddChunk(std::move(chunk1)).Await());\n+        CHECK_OK(stream->AddChunk(std::move(chunk1)).Await());\n \n         return absl::OkStatus();\n       }};\n@@ -2498,11 +2498,11 @@ TEST(StreamExecutorGpuClientTest, NonZeroGPUDeviceTimeMeasurementSingleGPU) {\n                             std::unique_ptr<CopyToDeviceStream> stream) {\n         auto chunk0 = PjRtChunk::AllocateDefault(sizeof(float));\n         *reinterpret_cast<float*>(chunk0.data()) = 5.0f;\n-        TF_CHECK_OK(stream->AddChunk(std::move(chunk0)).Await());\n+        CHECK_OK(stream->AddChunk(std::move(chunk0)).Await());\n \n         auto chunk1 = PjRtChunk::AllocateDefault(sizeof(float));\n         *reinterpret_cast<float*>(chunk1.data()) = 6.0f;\n-        TF_CHECK_OK(stream->AddChunk(std::move(chunk1)).Await());\n+        CHECK_OK(stream->AddChunk(std::move(chunk1)).Await());\n \n         return absl::OkStatus();\n       }};"
        },
        {
            "sha": "605d6af61b2378f5fbea4ac733495c1294f8a79e",
            "filename": "third_party/xla/xla/pjrt/gpu/tfrt/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -60,6 +60,7 @@ cc_library(\n         \"//xla/core/collectives:collectives_registry\",\n         \"//xla/hlo/builder:xla_computation\",\n         \"//xla/hlo/ir:hlo\",\n+        \"//xla/mlir_hlo:mhlo_passes\",\n         \"//xla/pjrt:abstract_tracked_device_buffer\",\n         \"//xla/pjrt:device_event\",\n         \"//xla/pjrt:host_callback\",\n@@ -173,7 +174,6 @@ xla_test(\n         \":gpu_event\",\n         \":tfrt_gpu_client\",\n         \":tracked_gpu_device_buffer\",\n-        \"@com_google_googletest//:gtest\",\n         \"@com_google_googletest//:gtest_main\",\n         \"@com_google_absl//absl/cleanup\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n@@ -188,6 +188,7 @@ xla_test(\n         \"@com_google_absl//absl/time\",\n         \"@com_google_absl//absl/types:span\",\n         \"@llvm-project//mlir:IR\",\n+        \"@com_google_protobuf//:protobuf\",\n         \"//xla:future\",\n         \"//xla:literal\",\n         \"//xla:literal_util\","
        },
        {
            "sha": "7ec8d2dc198fee530132a42628fbcc43bbb2cbf0",
            "filename": "third_party/xla/xla/pjrt/gpu/tfrt/tfrt_gpu_async_host_to_device_transfer_manager.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2Ftfrt_gpu_async_host_to_device_transfer_manager.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2Ftfrt_gpu_async_host_to_device_transfer_manager.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2Ftfrt_gpu_async_host_to_device_transfer_manager.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -59,7 +59,6 @@ limitations under the License.\n #include \"xla/stream_executor/device_memory_allocator.h\"\n #include \"xla/tsl/concurrency/async_value_ref.h\"\n #include \"xla/tsl/platform/logging.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/util.h\"\n #include \"xla/xla_data.pb.h\"\n@@ -232,8 +231,8 @@ absl::Status TfrtGpuAsyncHostToDeviceTransferManager::TransferLiteralToBuffer(\n         buffer->AsShapedBuffer(device_shapes_[buffer_index], device_);\n \n     auto stream = device_->stream();\n-    TF_CHECK_OK(transfer_manager->TransferLiteralToDeviceAsync(stream, literal,\n-                                                               shaped_buffer));\n+    CHECK_OK(transfer_manager->TransferLiteralToDeviceAsync(stream, literal,\n+                                                            shaped_buffer));\n \n     absl::Status status = BlockHostUntilDoneWithHostCallback(stream);\n     VLOG(3) << \"Finish transfer h2d for literal with shape \"\n@@ -332,7 +331,7 @@ TfrtGpuAsyncHostToDeviceTransferManager::TransferRawDataToSubBuffer(\n       VLOG(3) << \"H2D copy: \" << host_data_ptr << \" -> \" << sub_buffer.opaque()\n               << \" (\" << transfer_size << \" bytes) on device \"\n               << device_->DebugString();\n-      TF_CHECK_OK(stream->Memcpy(&sub_buffer, host_data_ptr, transfer_size))\n+      CHECK_OK(stream->Memcpy(&sub_buffer, host_data_ptr, transfer_size))\n           << \"Failed to copy data to GPU\";\n \n       absl::Status status = BlockHostUntilDoneWithHostCallback(stream);"
        },
        {
            "sha": "eec0d99679e068400c739734707ee59be8048e8f",
            "filename": "third_party/xla/xla/pjrt/gpu/tfrt/tfrt_gpu_client.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2Ftfrt_gpu_client.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2Ftfrt_gpu_client.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2Ftfrt_gpu_client.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -29,6 +29,8 @@ limitations under the License.\n #include <vector>\n \n #include \"absl/algorithm/container.h\"\n+#include \"absl/container/flat_hash_set.h\"\n+#include \"absl/container/inlined_vector.h\"\n #include \"absl/functional/any_invocable.h\"\n #include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n@@ -48,9 +50,11 @@ limitations under the License.\n #include \"xla/debug_options_flags.h\"\n #include \"xla/executable_run_options.h\"\n #include \"xla/hlo/builder/xla_computation.h\"\n+#include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/layout.h\"\n #include \"xla/literal.h\"\n #include \"xla/maybe_owning.h\"\n+#include \"xla/mlir_hlo/mhlo/transforms/passes.h\"\n #include \"xla/pjrt/distributed/in_memory_key_value_store.h\"\n #include \"xla/pjrt/distributed/key_value_store_interface.h\"\n #include \"xla/pjrt/distributed/protocol.pb.h\"\n@@ -66,6 +70,7 @@ limitations under the License.\n #include \"xla/pjrt/gpu/tfrt/tracked_gpu_device_buffer.h\"\n #include \"xla/pjrt/gpu/tfrt/utils.h\"\n #include \"xla/pjrt/host_memory_spaces.h\"\n+#include \"xla/pjrt/layout_mode.h\"\n #include \"xla/pjrt/mlir_to_hlo.h\"\n #include \"xla/pjrt/pjrt_client.h\"\n #include \"xla/pjrt/pjrt_common.h\"\n@@ -96,10 +101,11 @@ limitations under the License.\n #include \"xla/stream_executor/stream_executor.h\"\n #include \"xla/tsl/concurrency/async_value_ref.h\"\n #include \"xla/tsl/framework/allocator.h\"\n+#include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n #include \"xla/tsl/platform/logging.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n+#include \"xla/tsl/platform/threadpool.h\"\n #include \"xla/util.h\"\n #include \"xla/xla_data.pb.h\"\n #include \"tsl/platform/casts.h\"\n@@ -1108,8 +1114,8 @@ TfrtGpuClient::BufferFromHostLiteral(const LiteralSlice& literal,\n \n         ShapedBuffer shaped_buffer = buffer->AsShapedBuffer(shape, device);\n \n-        TF_CHECK_OK(transfer_manager->TransferLiteralToDeviceAsync(\n-            stream, literal, shaped_buffer));\n+        CHECK_OK(transfer_manager->TransferLiteralToDeviceAsync(stream, literal,\n+                                                                shaped_buffer));\n \n         absl::Status status = BlockHostUntilDoneWithHostCallback(stream);\n         CHECK_OK(status) << \"Failed to block host until done\";"
        },
        {
            "sha": "2ea7c3a01611f54f4573182ca963558028317116",
            "filename": "third_party/xla/xla/pjrt/gpu/tfrt/tfrt_gpu_client_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2Ftfrt_gpu_client_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2Ftfrt_gpu_client_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fgpu%2Ftfrt%2Ftfrt_gpu_client_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -45,6 +45,7 @@ limitations under the License.\n #include \"absl/time/time.h\"\n #include \"absl/types/span.h\"\n #include \"mlir/IR/MLIRContext.h\"\n+#include \"google/protobuf/text_format.h\"\n #include \"xla/ffi/ffi.h\"\n #include \"xla/ffi/ffi_api.h\"\n #include \"xla/future.h\"\n@@ -85,7 +86,6 @@ limitations under the License.\n #include \"xla/tsl/lib/core/status_test_util.h\"\n #include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/platform/threadpool.h\"\n #include \"xla/types.h\"\n@@ -94,7 +94,6 @@ limitations under the License.\n #include \"xla/xla_data.pb.h\"\n #include \"tsl/platform/casts.h\"\n #include \"tsl/platform/mem.h\"\n-#include \"tsl/platform/protobuf.h\"\n \n namespace xla {\n \n@@ -273,11 +272,11 @@ TEST(TfrtGpuClientTest, SendRecvChunked) {\n                             std::unique_ptr<CopyToDeviceStream> stream) {\n         auto chunk0 = PjRtChunk::AllocateDefault(sizeof(float));\n         *reinterpret_cast<float*>(chunk0.data()) = 5.0f;\n-        TF_CHECK_OK(stream->AddChunk(std::move(chunk0)).Await());\n+        CHECK_OK(stream->AddChunk(std::move(chunk0)).Await());\n \n         auto chunk1 = PjRtChunk::AllocateDefault(sizeof(float));\n         *reinterpret_cast<float*>(chunk1.data()) = 6.0f;\n-        TF_CHECK_OK(stream->AddChunk(std::move(chunk1)).Await());\n+        CHECK_OK(stream->AddChunk(std::move(chunk1)).Await());\n \n         return absl::OkStatus();\n       }};"
        },
        {
            "sha": "7d96b6b00dedf60daf7865d1b8bbe8f56b293b56",
            "filename": "third_party/xla/xla/pjrt/host_callback.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fhost_callback.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fhost_callback.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fhost_callback.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -27,8 +27,6 @@ limitations under the License.\n #include \"xla/pjrt/pjrt_client.h\"\n #include \"xla/pjrt/pjrt_executable.h\"\n #include \"xla/shape_util.h\"\n-#include \"tsl/platform/logging.h\"\n-#include \"tsl/platform/status.h\"\n \n namespace xla {\n \n@@ -54,7 +52,7 @@ absl::Status HostCallbackContext::OnSend(int arg_num,\n     DCHECK_GE(data.size(), host_size);\n \n     auto delinearized = PjRtChunk::AllocateDefault(host_size);\n-    TF_CHECK_OK(host_memory_for_device_manager_->ToHostLayout(\n+    CHECK_OK(host_memory_for_device_manager_->ToHostLayout(\n         data.data(), data.size(), device_shape, delinearized.data(),\n         delinearized.size(), host_shape));\n \n@@ -124,7 +122,7 @@ void HostCallbackContext::Receive(int res_num,\n   result_channel->Pop().OnReady(\n       [this, res_num, metadata,\n        stream = std::move(stream)](absl::StatusOr<PjRtChunk> chunk) mutable {\n-        TF_CHECK_OK(chunk.status());\n+        CHECK_OK(chunk.status());\n \n         if (!use_major_to_minor_data_layout_for_callbacks_) {\n           const auto& host_shape = host_callback_.results.at(res_num).shape;\n@@ -136,7 +134,7 @@ void HostCallbackContext::Receive(int res_num,\n         }\n \n         stream->AddChunk(*std::move(chunk)).OnReady([](absl::Status s) {\n-          TF_CHECK_OK(s);\n+          CHECK_OK(s);\n         });\n       });\n }"
        },
        {
            "sha": "69635421f8039964ac7c4a8713ee8162c3e219c7",
            "filename": "third_party/xla/xla/pjrt/pjrt_stream_executor_client.cc",
            "status": "modified",
            "additions": 12,
            "deletions": 13,
            "changes": 25,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_stream_executor_client.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_stream_executor_client.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Fpjrt_stream_executor_client.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -105,9 +105,10 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/hlo/ir/hlo_print_options.h\"\n #include \"xla/layout.h\"\n-#include \"xla/layout_util.h\"\n #include \"xla/literal.h\"\n+#include \"xla/mlir_hlo/mhlo/transforms/passes.h\"\n #include \"xla/pjrt/abstract_tracked_device_buffer.h\"\n+#include \"xla/pjrt/buffer_sequencing_event.h\"\n #include \"xla/pjrt/common_pjrt_client.h\"\n #include \"xla/pjrt/device_event.h\"\n #include \"xla/pjrt/distributed/protocol.pb.h\"\n@@ -138,7 +139,6 @@ limitations under the License.\n #include \"xla/service/computation_layout.h\"\n #include \"xla/service/dump.h\"\n #include \"xla/service/executable.h\"\n-#include \"xla/service/generic_transfer_manager.h\"\n #include \"xla/service/hlo.pb.h\"\n #include \"xla/service/hlo_cost_analysis.h\"\n #include \"xla/service/maybe_owning_device_memory.h\"\n@@ -155,7 +155,6 @@ limitations under the License.\n #include \"xla/tsl/framework/allocator.h\"\n #include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/platform/threadpool.h\"\n #include \"xla/util.h\"\n@@ -391,7 +390,7 @@ void StallStreamOnError(LocalDeviceState* local_device, se::Stream* stream) {\n       // This will stall the calling thread but that's ok in this very rare\n       // error case. If the stall fails just crash, since we have no other\n       // way to synchronize.\n-      TF_CHECK_OK(stream->BlockHostUntilDone());\n+      CHECK_OK(stream->BlockHostUntilDone());\n       break;\n   }\n }\n@@ -725,7 +724,7 @@ PjRtStreamExecutorClient::LinearizeHostBufferInto(\n                      std::move(on_done_with_host_buffer))\n                : nullptr,\n        host_buffer_semantics, transpose{std::move(transpose)}]() mutable {\n-        // This function uses TF_CHECK_OK and value() since we have no way\n+        // This function uses CHECK_OK and value() since we have no way\n         // to report failures from a callback. However, the operations here are\n         // unlikely to fail and not recoverable even if we were to fail: DMAs to\n         // memory that has already been allocated, and a possible Event\n@@ -767,14 +766,14 @@ PjRtStreamExecutorClient::LinearizeHostBufferInto(\n               }\n             }\n           }\n-          TF_CHECK_OK(local_device->host_to_device_stream()->Memcpy(\n+          CHECK_OK(local_device->host_to_device_stream()->Memcpy(\n               &device_memory, staging_buffer.get(), packed_size));\n         } else {\n-          TF_CHECK_OK(local_device->host_to_device_stream()->Memcpy(\n+          CHECK_OK(local_device->host_to_device_stream()->Memcpy(\n               &device_memory, data, packed_size));\n         }\n \n-        TF_CHECK_OK(AddDestinationBufferSynchronization(\n+        CHECK_OK(AddDestinationBufferSynchronization(\n             this, local_device, event, local_device->host_to_device_stream()));\n \n         event.AndThen([raw_buffer = std::move(raw_buffer),\n@@ -865,7 +864,7 @@ PjRtStreamExecutorClient::LinearizeInto(\n   auto transfer_h2d = [this, local_client = client(), transfer_manager,\n                        local_device, raw_buffer, device, event, literal,\n                        on_device_shape = std::move(on_device_shape)]() mutable {\n-    // This function uses TF_CHECK_OK and value() since we have no way\n+    // This function uses CHECK_OK and value() since we have no way\n     // to report failures from a callback. However, the operations here are\n     // unlikely to fail and not recoverable even if we were to fail: DMAs to\n     // memory that has already been allocated, and a possible Event\n@@ -878,11 +877,11 @@ PjRtStreamExecutorClient::LinearizeInto(\n \n     ShapedBuffer buffer =\n         device_memory->AsShapedBuffer(device, on_device_shape);\n-    TF_CHECK_OK(transfer_manager->TransferLiteralToDeviceAsync(\n-        h2d_stream, literal, buffer));\n+    CHECK_OK(transfer_manager->TransferLiteralToDeviceAsync(h2d_stream, literal,\n+                                                            buffer));\n \n-    TF_CHECK_OK(AddDestinationBufferSynchronization(this, local_device, event,\n-                                                    h2d_stream));\n+    CHECK_OK(AddDestinationBufferSynchronization(this, local_device, event,\n+                                                 h2d_stream));\n \n     local_device->ThenRelease(h2d_stream, device_memory).IgnoreError();\n "
        },
        {
            "sha": "f5595d2ea3904039cb349969006ce3fa5085f2dd",
            "filename": "third_party/xla/xla/pjrt/tracked_device_buffer.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 7,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Ftracked_device_buffer.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fpjrt%2Ftracked_device_buffer.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpjrt%2Ftracked_device_buffer.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -33,7 +33,6 @@ limitations under the License.\n #include \"xla/pjrt/abstract_tracked_device_buffer.h\"\n #include \"xla/pjrt/buffer_sequencing_event.h\"\n #include \"xla/pjrt/device_event.h\"\n-#include \"xla/pjrt/event_pool.h\"\n #include \"xla/pjrt/local_device_state.h\"\n #include \"xla/pjrt/pjrt_client.h\"\n #include \"xla/pjrt/pjrt_common.h\"\n@@ -45,16 +44,12 @@ limitations under the License.\n #include \"xla/shape_tree.h\"\n #include \"xla/stream_executor/device_memory.h\"\n #include \"xla/stream_executor/device_memory_allocator.h\"\n-#include \"xla/stream_executor/event.h\"\n #include \"xla/tsl/concurrency/async_value.h\"\n #include \"xla/tsl/concurrency/async_value_ref.h\"\n #include \"xla/tsl/concurrency/ref_count.h\"\n #include \"xla/tsl/platform/logging.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/threadpool.h\"\n #include \"tsl/platform/casts.h\"\n-#include \"tsl/profiler/lib/connected_traceme.h\"\n-#include \"tsl/profiler/lib/context_types.h\"\n \n namespace xla {\n \n@@ -224,8 +219,8 @@ TrackedDeviceBuffer::CloneWithControlDependency(PjRtMemorySpace* memory_space,\n           return;\n         }\n         auto stream = local_device->BorrowStreamFromPool();\n-        TF_CHECK_OK(client->AllocateAndRecordEvent(definition_event_for_status,\n-                                                   local_device, stream.get()));\n+        CHECK_OK(client->AllocateAndRecordEvent(definition_event_for_status,\n+                                                local_device, stream.get()));\n         local_device->ReturnStreamToPool(std::move(stream));\n       });\n   return new_device_buffer;"
        },
        {
            "sha": "ad76772eea22178461a82c87b56800cab6ba8f4b",
            "filename": "third_party/xla/xla/stream_executor/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -218,11 +218,10 @@ cc_library(\n     deps = [\n         \":device_memory\",\n         \":platform\",\n+        \"//xla/tsl/platform:errors\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n-        \"@local_tsl//tsl/platform:errors\",\n-        \"@local_tsl//tsl/platform:status\",\n     ],\n )\n \n@@ -835,7 +834,6 @@ cc_library(\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/synchronization\",\n-        \"@local_tsl//tsl/platform:status\",\n     ],\n )\n "
        },
        {
            "sha": "5aae2f4e04b90f9f286d68f28c53515a2a6c1f60",
            "filename": "third_party/xla/xla/stream_executor/cuda/BUILD",
            "status": "modified",
            "additions": 3,
            "deletions": 7,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -180,13 +180,12 @@ cc_library(\n         \"//xla/stream_executor/gpu:context\",\n         \"//xla/stream_executor/gpu:context_map\",\n         \"//xla/stream_executor/gpu:scoped_activate_context\",\n+        \"//xla/tsl/platform:errors\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@local_config_cuda//cuda:cuda_headers\",\n-        \"@local_tsl//tsl/platform:errors\",\n-        \"@local_tsl//tsl/platform:status\",\n     ],\n )\n \n@@ -217,10 +216,9 @@ xla_test(\n         \":cuda_diagnostics\",\n         \":cuda_status\",\n         \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_googletest//:gtest_main\",\n         \"@local_config_cuda//cuda:cuda_headers\",\n-        \"@local_tsl//tsl/platform:status\",\n-        \"@local_tsl//tsl/platform:test\",\n     ],\n )\n \n@@ -532,7 +530,6 @@ cc_library(\n         \"//xla/stream_executor/platform:initialize\",\n         \"//xla/tsl/cuda:cudnn\",\n         \"//xla/tsl/platform:errors\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/protobuf:dnn_proto_cc\",\n         \"//xla/tsl/util:env_var\",\n@@ -1175,7 +1172,6 @@ cc_library(\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:logging\",\n         \"//xla/tsl/platform:macros\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/base\",\n@@ -1606,7 +1602,6 @@ cc_library(\n         \"//xla/stream_executor/gpu:gpu_asm_opts\",\n         \"//xla/tsl/platform:env\",\n         \"//xla/tsl/platform:errors\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/platform:subprocess\",\n         \"@com_google_absl//absl/algorithm:container\",\n@@ -1615,6 +1610,7 @@ cc_library(\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/container:flat_hash_set\",\n         \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\","
        },
        {
            "sha": "b15cada11740fbaa825ae8a600cf19ca6feb3b02",
            "filename": "third_party/xla/xla/stream_executor/cuda/cuda_context.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_context.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_context.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_context.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -24,8 +24,7 @@ limitations under the License.\n #include \"xla/stream_executor/cuda/cuda_status.h\"\n #include \"xla/stream_executor/gpu/context_map.h\"\n #include \"xla/stream_executor/gpu/scoped_activate_context.h\"\n-#include \"tsl/platform/errors.h\"\n-#include \"tsl/platform/status.h\"\n+#include \"xla/tsl/platform/errors.h\"\n \n namespace stream_executor::gpu {\n \n@@ -67,8 +66,8 @@ int GetFlagsFromEnv() {\n // Returns the current context or dies if it fails.\n CUcontext CurrentContextOrDie() {\n   CUcontext current = nullptr;\n-  TF_CHECK_OK(cuda::ToStatus(cuCtxGetCurrent(&current),\n-                             \"Failed to query current context\"));\n+  CHECK_OK(cuda::ToStatus(cuCtxGetCurrent(&current),\n+                          \"Failed to query current context\"));\n   return current;\n }\n \n@@ -183,8 +182,7 @@ absl::StatusOr<CudaContext*> CudaContext::Create(int device_ordinal,\n }\n \n void CudaContext::SetActive() {\n-  TF_CHECK_OK(\n-      cuda::ToStatus(cuCtxSetCurrent(context_), \"Failed setting context\"));\n+  CHECK_OK(cuda::ToStatus(cuCtxSetCurrent(context_), \"Failed setting context\"));\n }\n \n bool CudaContext::IsActive() const { return CurrentContext() == context_; }"
        },
        {
            "sha": "55d93ce992e7411d0cab5068df8d0723cfac9d63",
            "filename": "third_party/xla/xla/stream_executor/cuda/cuda_dnn.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_dnn.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_dnn.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_dnn.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -72,7 +72,6 @@ limitations under the License.\n #include \"xla/stream_executor/stream.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/protobuf/dnn.pb.h\"\n #include \"xla/tsl/util/env_var.h\"\n@@ -845,7 +844,7 @@ const json* CudnnExecutionPlanEngineFilterRuntime() {\n bool BatchnormSpatialPersistentEnabled() {\n   static bool is_enabled = [] {\n     bool is_enabled = false;\n-    TF_CHECK_OK(\n+    CHECK_OK(\n         tsl::ReadBoolFromEnvVar(\"TF_USE_CUDNN_BATCHNORM_SPATIAL_PERSISTENT\",\n                                 /*default_val=*/false, &is_enabled));\n     return is_enabled;\n@@ -857,8 +856,8 @@ bool BatchnormSpatialPersistentEnabled() {\n bool ConvUseDefaultAlgorithm() {\n   static bool use_default = [] {\n     bool use_default = false;\n-    TF_CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_USE_DEFAULT_CONV_ALGO\",\n-                                        /*default_val=*/false, &use_default));\n+    CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_USE_DEFAULT_CONV_ALGO\",\n+                                     /*default_val=*/false, &use_default));\n     return use_default;\n   }();\n   return use_default;"
        },
        {
            "sha": "81a215c1ad72fe388944d38b82d5ba4d36f1cb73",
            "filename": "third_party/xla/xla/stream_executor/cuda/cuda_driver_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_driver_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_driver_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_driver_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -14,20 +14,19 @@ limitations under the License.\n ==============================================================================*/\n \n #include <gtest/gtest.h>\n+#include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"third_party/gpus/cuda/include/cuda.h\"\n #include \"third_party/gpus/cuda/include/cuda_runtime_api.h\"\n #include \"third_party/gpus/cuda/include/driver_types.h\"\n #include \"xla/stream_executor/cuda/cuda_diagnostics.h\"\n #include \"xla/stream_executor/cuda/cuda_status.h\"\n-#include \"tsl/platform/status.h\"\n-#include \"tsl/platform/test.h\"\n \n namespace stream_executor {\n namespace cuda {\n \n void CheckCuda(CUresult result, const char* file, int line) {\n-  TF_CHECK_OK(cuda::ToStatus(result));\n+  CHECK_OK(cuda::ToStatus(result));\n }\n \n void CheckCuda(cudaError_t result, const char* file, int line) {\n@@ -52,13 +51,13 @@ TEST_F(CudaDriverTest, DriverVersionParsingTest) {\n   auto driver_version = Diagnostician::FindKernelModuleVersion(\n       \"... NVIDIA UNIX Open Kernel Module for x86_64  570.00  Release Build  \"\n       \"...  Mon Aug 12 04:17:20 UTC 2024\");\n-  TF_CHECK_OK(driver_version.status());\n+  CHECK_OK(driver_version.status());\n   EXPECT_EQ(\"570.0.0\", cuda::DriverVersionToString(driver_version.value()));\n \n   driver_version = Diagnostician::FindKernelModuleVersion(\n       \"... NVIDIA UNIX Open Kernel Module  571.00  Release Build  \"\n       \"...  Mon Aug 12 04:17:20 UTC 2024\");\n-  TF_CHECK_OK(driver_version.status());\n+  CHECK_OK(driver_version.status());\n   EXPECT_EQ(\"571.0.0\", cuda::DriverVersionToString(driver_version.value()));\n }\n }  // namespace cuda"
        },
        {
            "sha": "845c5ff5967785bd6b487809bdc394b5b40a192b",
            "filename": "third_party/xla/xla/stream_executor/cuda/cuda_executor.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 7,
            "changes": 13,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_executor.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_executor.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_executor.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -98,7 +98,6 @@ limitations under the License.\n #include \"xla/tsl/platform/errors.h\"\n #include \"xla/tsl/platform/logging.h\"\n #include \"xla/tsl/platform/macros.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/platform/threadpool.h\"\n #include \"xla/util.h\"\n@@ -849,7 +848,7 @@ absl::StatusOr<xla::gpu::GpuCollectives*> GetGpuCollectives(\n   return tsl::down_cast<xla::gpu::GpuCollectives*>(collectives);\n }\n \n-CudaExecutor::VmmMemoryHandle::~VmmMemoryHandle() { TF_CHECK_OK(Release()); }\n+CudaExecutor::VmmMemoryHandle::~VmmMemoryHandle() { CHECK_OK(Release()); }\n \n absl::Status CudaExecutor::VmmMemoryHandle::Release() {\n   if (handle_ != 0) {\n@@ -869,7 +868,7 @@ CudaExecutor::VmmMemoryHandle::VmmMemoryHandle(VmmMemoryHandle&& other) {\n CudaExecutor::VmmMemoryHandle& CudaExecutor::VmmMemoryHandle::operator=(\n     VmmMemoryHandle&& other) {\n   if (this != &other) {\n-    TF_CHECK_OK(Release());\n+    CHECK_OK(Release());\n     handle_ = other.handle_;\n     other.handle_ = 0;\n   }\n@@ -1975,18 +1974,18 @@ CudaExecutor::CudaMulticastMemory::~CudaMulticastMemory() {\n   if (handle_ != 0) {\n     for (auto const& [device_ordinal, mapped_memory_ptr] : mapped_devices_) {\n       VLOG(3) << \"[\" << device_ordinal << \"] Unbind multicast: \" << handle_;\n-      TF_CHECK_OK(stream_executor::cuda::ToStatus(cuMulticastUnbind(\n+      CHECK_OK(stream_executor::cuda::ToStatus(cuMulticastUnbind(\n           handle_, device_ordinal, /*mcOffset=*/0, padded_size_)));\n \n       VLOG(3) << \"[\" << device_ordinal << \"] Unmap ptr: \" << mapped_memory_ptr;\n-      TF_CHECK_OK(stream_executor::cuda::ToStatus(\n+      CHECK_OK(stream_executor::cuda::ToStatus(\n           cuMemUnmap(mapped_memory_ptr, padded_size_)));\n       VLOG(3) << \"[\" << device_ordinal\n               << \"] Release address space: \" << mapped_memory_ptr;\n-      TF_CHECK_OK(stream_executor::cuda::ToStatus(\n+      CHECK_OK(stream_executor::cuda::ToStatus(\n           cuMemAddressFree(mapped_memory_ptr, padded_size_)));\n     }\n-    TF_CHECK_OK(stream_executor::cuda::ToStatus(\n+    CHECK_OK(stream_executor::cuda::ToStatus(\n         cuMemRelease(static_cast<CUmemGenericAllocationHandle>(handle_))));\n   }\n }"
        },
        {
            "sha": "87bc56a136f65e2fe1be901fec663bfef26a7d55",
            "filename": "third_party/xla/xla/stream_executor/cuda/cuda_platform.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_platform.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_platform.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fcuda_platform.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -35,7 +35,6 @@ limitations under the License.\n #include \"xla/stream_executor/platform/initialize.h\"\n #include \"xla/stream_executor/platform_manager.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n \n namespace stream_executor {\n namespace gpu {\n@@ -129,7 +128,7 @@ CudaPlatform::GetUncachedExecutor(int ordinal) {\n }  // namespace gpu\n \n static void InitializeCudaPlatform() {\n-  TF_CHECK_OK(\n+  CHECK_OK(\n       PlatformManager::RegisterPlatform(std::make_unique<gpu::CudaPlatform>()));\n }\n "
        },
        {
            "sha": "cd394504942ec7ac27dc9f0edde1a09944643f6e",
            "filename": "third_party/xla/xla/stream_executor/cuda/subprocess_compilation.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fsubprocess_compilation.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fsubprocess_compilation.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fcuda%2Fsubprocess_compilation.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -30,6 +30,7 @@ limitations under the License.\n #include \"absl/cleanup/cleanup.h\"\n #include \"absl/container/flat_hash_map.h\"\n #include \"absl/container/flat_hash_set.h\"\n+#include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n@@ -52,7 +53,6 @@ limitations under the License.\n #include \"xla/stream_executor/semantic_version.h\"\n #include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/platform/subprocess.h\"\n #include \"xla/util.h\"\n@@ -281,7 +281,7 @@ absl::StatusOr<cuda::Assembly> CompileGpuAsmUsingPtxAs(\n   VLOG(2) << \"ptx written to: \" << ptx_path;\n \n   absl::Cleanup ptx_cleaner = [&ptx_path] {\n-    TF_CHECK_OK(tsl::Env::Default()->DeleteFile(ptx_path));\n+    CHECK_OK(tsl::Env::Default()->DeleteFile(ptx_path));\n   };\n \n   // Invoke ptxas and collect its output.\n@@ -396,7 +396,7 @@ absl::StatusOr<std::vector<uint8_t>> BundleGpuAsmUsingFatbin(\n   }\n   absl::Cleanup image_files_cleaner = [&image_paths] {\n     for (const auto& path : image_paths) {\n-      TF_CHECK_OK(tsl::Env::Default()->DeleteFile(path));\n+      CHECK_OK(tsl::Env::Default()->DeleteFile(path));\n     }\n   };\n \n@@ -504,7 +504,7 @@ absl::StatusOr<std::vector<uint8_t>> LinkUsingNvlink(\n   std::vector<std::string> temp_files;\n   absl::Cleanup cleaners = [&] {\n     for (auto& f : temp_files) {\n-      TF_CHECK_OK(tsl::Env::Default()->DeleteFile(f));\n+      CHECK_OK(tsl::Env::Default()->DeleteFile(f));\n     }\n   };\n   for (int i = 0; i < images.size(); i++) {"
        },
        {
            "sha": "44692817316b3862022c860e8e0219c5bbc62ba1",
            "filename": "third_party/xla/xla/stream_executor/device_memory_allocator.h",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fdevice_memory_allocator.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fdevice_memory_allocator.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fdevice_memory_allocator.h?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -24,8 +24,7 @@ limitations under the License.\n #include \"absl/status/statusor.h\"\n #include \"xla/stream_executor/device_memory.h\"\n #include \"xla/stream_executor/platform.h\"\n-#include \"tsl/platform/errors.h\"\n-#include \"tsl/platform/status.h\"\n+#include \"xla/tsl/platform/errors.h\"\n \n namespace stream_executor {\n \n@@ -73,13 +72,13 @@ class ScopedDeviceMemory {\n         allocator_(other.allocator_) {}\n \n   // Releases the memory that was provided in the constructor.\n-  ~ScopedDeviceMemory() { TF_CHECK_OK(Free()); }\n+  ~ScopedDeviceMemory() { CHECK_OK(Free()); }\n \n   // Moves ownership of the memory from other to this object.\n   //\n   // Postcondition: other == nullptr.\n   ScopedDeviceMemory &operator=(ScopedDeviceMemory &&other) noexcept {\n-    TF_CHECK_OK(Free());\n+    CHECK_OK(Free());\n     wrapped_ = other.Release();\n     allocator_ = other.allocator_;\n     device_ordinal_ = other.device_ordinal_;"
        },
        {
            "sha": "783e078159a7d65bfe7c4db084f56969176216de",
            "filename": "third_party/xla/xla/stream_executor/fft.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Ffft.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Ffft.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Ffft.h?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -34,7 +34,7 @@ limitations under the License.\n //  stream\n //    .Init()\n //    .ThenFft(plan.get(), x, &y);\n-//  TF_CHECK_OK(stream.BlockHostUntilDone());\n+//  CHECK_OK(stream.BlockHostUntilDone());\n //\n // By using stream operations in this manner the user can easily intermix custom\n // kernel launches with these pre-canned FFT routines."
        },
        {
            "sha": "5f56816e01600a3efddf62a5c88ceffe4dff53d4",
            "filename": "third_party/xla/xla/stream_executor/gpu/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -304,7 +304,6 @@ cc_library(\n     deps = [\n         \"//xla/tsl/platform:env\",\n         \"//xla/tsl/platform:errors\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:subprocess\",\n         \"@com_google_absl//absl/cleanup\",\n         \"@com_google_absl//absl/log\",\n@@ -407,8 +406,6 @@ cc_library(\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/synchronization\",\n         \"@local_config_cuda//cuda:cuda_headers\",\n-        \"@local_tsl//tsl/platform:logging\",\n-        \"@local_tsl//tsl/platform:status\",\n     ],\n )\n \n@@ -897,8 +894,8 @@ xla_test(\n         \"//xla/stream_executor:platform_manager\",\n         \"//xla/stream_executor:stream\",\n         \"//xla/stream_executor:stream_executor_h\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:status_matchers\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/types:span\","
        },
        {
            "sha": "1d53d8a2324a7899b50f231741736a424d00c66b",
            "filename": "third_party/xla/xla/stream_executor/gpu/asm_compiler.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2Fasm_compiler.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2Fasm_compiler.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2Fasm_compiler.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -33,7 +33,6 @@ limitations under the License.\n #include \"absl/strings/string_view.h\"\n #include \"xla/tsl/platform/env.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/subprocess.h\"\n #include \"tsl/platform/path.h\"\n \n@@ -83,7 +82,7 @@ absl::StatusOr<std::vector<uint8_t>> BundleGpuAsm(\n   }\n   absl::Cleanup image_files_cleaner = [&image_paths] {\n     for (const auto& path : image_paths) {\n-      TF_CHECK_OK(tsl::Env::Default()->DeleteFile(path));\n+      CHECK_OK(tsl::Env::Default()->DeleteFile(path));\n     }\n   };\n "
        },
        {
            "sha": "05b581069ef0992831cdafa469d012f4b93316a4",
            "filename": "third_party/xla/xla/stream_executor/gpu/gpu_cudamallocasync_allocator.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2Fgpu_cudamallocasync_allocator.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2Fgpu_cudamallocasync_allocator.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2Fgpu_cudamallocasync_allocator.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -38,8 +38,6 @@ limitations under the License.\n #include \"xla/tsl/framework/allocator.h\"\n #include \"xla/tsl/framework/device_id.h\"\n #include \"xla/tsl/util/env_var.h\"\n-#include \"tsl/platform/logging.h\"\n-#include \"tsl/platform/status.h\"\n \n namespace stream_executor {\n \n@@ -216,8 +214,8 @@ GpuCudaMallocAsyncAllocator::GpuCudaMallocAsyncAllocator(\n   // If in TF_DETERMINISTIC_ALLOCATOR is set, then make the allocator behave\n   // determistically.\n   bool deterministic = false;\n-  TF_CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_DETERMINISTIC_ALLOCATOR\",\n-                                      /*default_val=*/false, &deterministic));\n+  CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_DETERMINISTIC_ALLOCATOR\",\n+                                   /*default_val=*/false, &deterministic));\n   if (deterministic) {\n     int disable = 0;\n     if (auto status = cuMemPoolSetAttribute(\n@@ -488,8 +486,8 @@ void GpuCudaMallocAsyncAllocator::SetStreamAndPreallocateMemory(void* stream) {\n   int64_t prealloc_size = 0;\n   // TF_CUDA_MALLOC_ASYNC_SUPPORTED_PREALLOC=-1 is a special value that\n   // preallocates the total pool size.\n-  TF_CHECK_OK(tsl::ReadInt64FromEnvVar(\n-      \"TF_CUDA_MALLOC_ASYNC_SUPPORTED_PREALLOC\", 0, &prealloc_size));\n+  CHECK_OK(tsl::ReadInt64FromEnvVar(\"TF_CUDA_MALLOC_ASYNC_SUPPORTED_PREALLOC\",\n+                                    0, &prealloc_size));\n   if (prealloc_size == -1) {\n     prealloc_size = pool_size_64;\n   } else if (reserve_memory_) {"
        },
        {
            "sha": "0c6fd85f8bffeb091a4a6f204a5d7e70fe9bd959",
            "filename": "third_party/xla/xla/stream_executor/gpu/repeat_buffer_kernel_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2Frepeat_buffer_kernel_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2Frepeat_buffer_kernel_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fgpu%2Frepeat_buffer_kernel_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -22,6 +22,7 @@ limitations under the License.\n \n #include <gmock/gmock.h>\n #include <gtest/gtest.h>\n+#include \"absl/log/check.h\"\n #include \"absl/status/status_matchers.h\"\n #include \"absl/strings/ascii.h\"\n #include \"absl/types/span.h\"\n@@ -33,7 +34,6 @@ limitations under the License.\n #include \"xla/stream_executor/platform_manager.h\"\n #include \"xla/stream_executor/stream.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n \n namespace stream_executor::gpu {\n@@ -67,7 +67,7 @@ TEST_F(RepeatBufferKernelTest, CreateRepeatedBufferAndTestResult) {\n   DeviceMemory<float> buffer =\n       executor_->AllocateArray<float>(kNumberOfTotalElements);\n \n-  TF_CHECK_OK(stream->MemcpyH2D(absl::MakeConstSpan(kInitialBuf), &buffer));\n+  CHECK_OK(stream->MemcpyH2D(absl::MakeConstSpan(kInitialBuf), &buffer));\n \n   TF_ASSERT_OK_AND_ASSIGN(\n       RepeatBufferKernel::KernelType kernel,\n@@ -86,8 +86,8 @@ TEST_F(RepeatBufferKernelTest, CreateRepeatedBufferAndTestResult) {\n   std::array<float, kNumberOfTotalElements> result_buffer{};\n   absl::Span<const float> result = absl::MakeConstSpan(result_buffer);\n \n-  TF_CHECK_OK(stream->MemcpyD2H(buffer, absl::MakeSpan(result_buffer)));\n-  TF_CHECK_OK(stream->BlockHostUntilDone());\n+  CHECK_OK(stream->MemcpyD2H(buffer, absl::MakeSpan(result_buffer)));\n+  CHECK_OK(stream->BlockHostUntilDone());\n \n   for (int offset = 0; offset < kNumberOfTotalElements;\n        offset += kNumberOfRepeatedElements) {"
        },
        {
            "sha": "2c82cdc0e67b88cbf30f2cc7d0632a0eae061f23",
            "filename": "third_party/xla/xla/stream_executor/host/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fhost%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fhost%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fhost%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -48,10 +48,10 @@ cc_library(\n         \"//xla/stream_executor:platform_manager\",\n         \"//xla/stream_executor:stream_executor_h\",\n         \"//xla/stream_executor/platform:initialize\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings:str_format\",\n-        \"@local_tsl//tsl/platform:status\",\n     ],\n     alwayslink = True,  # Registers itself with the PlatformManager.\n )"
        },
        {
            "sha": "5c99ecb1a917d5ed7f3499b2fe39d18e36825e08",
            "filename": "third_party/xla/xla/stream_executor/host/host_platform.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fhost%2Fhost_platform.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fhost%2Fhost_platform.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fhost%2Fhost_platform.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -20,6 +20,7 @@ limitations under the License.\n #include <thread>  // NOLINT\n #include <utility>\n \n+#include \"absl/log/check.h\"\n #include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/str_format.h\"\n@@ -29,7 +30,6 @@ limitations under the License.\n #include \"xla/stream_executor/platform.h\"\n #include \"xla/stream_executor/platform/initialize.h\"\n #include \"xla/stream_executor/platform_manager.h\"\n-#include \"tsl/platform/status.h\"\n \n namespace stream_executor {\n namespace host {\n@@ -71,7 +71,7 @@ HostPlatform::GetUncachedExecutor(int ordinal) {\n \n static void InitializeHostPlatform() {\n   std::unique_ptr<Platform> platform(new host::HostPlatform);\n-  TF_CHECK_OK(PlatformManager::RegisterPlatform(std::move(platform)));\n+  CHECK_OK(PlatformManager::RegisterPlatform(std::move(platform)));\n }\n \n }  // namespace host"
        },
        {
            "sha": "6edf18090e6996ce45beece359ac4b4c738623be",
            "filename": "third_party/xla/xla/stream_executor/integrations/tf_allocator_adapter_test.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fintegrations%2Ftf_allocator_adapter_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fintegrations%2Ftf_allocator_adapter_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fintegrations%2Ftf_allocator_adapter_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -32,7 +32,6 @@ limitations under the License.\n #include \"xla/stream_executor/stream.h\"\n #include \"xla/stream_executor/stream_executor.h\"\n #include \"xla/tsl/framework/allocator.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n \n namespace stream_executor {\n@@ -144,7 +143,7 @@ TEST(MultiDeviceAdapter, DeallocationWithDifferentAllocator) {\n   CHECK_EQ(allocations->size(), 1);\n   CHECK_EQ(reinterpret_cast<size_t>(buff0->opaque()), 0x1001);\n \n-  TF_CHECK_OK(deallocator->Deallocate(/*device_ordinal=*/0, buff0.cref()));\n+  CHECK_OK(deallocator->Deallocate(/*device_ordinal=*/0, buff0.cref()));\n   CHECK_EQ(allocations->size(), 0);\n \n   // Place back memory pointer to remove it during with ScopedDeviceMemory"
        },
        {
            "sha": "d41818bdf0c102b24d9773b24ca780785bcc5250",
            "filename": "third_party/xla/xla/stream_executor/rocm/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -60,12 +60,10 @@ cc_library(\n     deps = [\n         \":rocm_driver_wrapper\",\n         \":rocm_status\",\n-        \"//xla/stream_executor:device_description\",\n         \"//xla/stream_executor/gpu:context\",\n         \"//xla/stream_executor/gpu:context_map\",\n         \"//xla/stream_executor/gpu:scoped_activate_context\",\n         \"//xla/tsl/platform:errors\",\n-        \"//xla/tsl/platform:status\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n@@ -314,8 +312,8 @@ cc_library(\n         \"//xla/stream_executor:stream_executor_h\",\n         \"//xla/stream_executor/platform:initialize\",\n         \"//xla/tsl/platform:errors\",\n-        \"//xla/tsl/platform:status\",\n         \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\",\n@@ -531,7 +529,6 @@ cc_library(\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:logging\",\n         \"//xla/tsl/platform:macros\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/util:determinism_for_kernels\",\n         \"//xla/tsl/util:env_var\","
        },
        {
            "sha": "4bcfe51e8e5a0850a4a202c69b65f5588ba7a562",
            "filename": "third_party/xla/xla/stream_executor/rocm/rocm_context.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2Frocm_context.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2Frocm_context.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2Frocm_context.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -24,14 +24,13 @@ limitations under the License.\n #include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n #include \"absl/strings/str_cat.h\"\n+#include \"rocm/include/hip/driver_types.h\"\n #include \"rocm/include/hip/hip_runtime_api.h\"\n-#include \"xla/stream_executor/device_description.h\"\n #include \"xla/stream_executor/gpu/context_map.h\"\n #include \"xla/stream_executor/gpu/scoped_activate_context.h\"\n #include \"xla/stream_executor/rocm/rocm_driver_wrapper.h\"\n #include \"xla/stream_executor/rocm/rocm_status.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n \n namespace stream_executor::gpu {\n \n@@ -40,7 +39,7 @@ namespace {\n // Returns the current context or dies if it fails.\n hipCtx_t CurrentContextOrDie() {\n   hipCtx_t current = nullptr;\n-  TF_CHECK_OK(\n+  CHECK_OK(\n       ToStatus(hipCtxGetCurrent(&current), \"Failed to query current context\"));\n   return current;\n }\n@@ -134,7 +133,7 @@ RocmContext::~RocmContext() {\n }\n \n void RocmContext::SetActive() {\n-  TF_CHECK_OK(\n+  CHECK_OK(\n       ToStatus(wrap::hipCtxSetCurrent(context_), \"Failed setting context\"));\n }\n "
        },
        {
            "sha": "89c8daec06985577ab4ee8c21a2fc00a54fc880f",
            "filename": "third_party/xla/xla/stream_executor/rocm/rocm_dnn.cc",
            "status": "modified",
            "additions": 8,
            "deletions": 9,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2Frocm_dnn.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2Frocm_dnn.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2Frocm_dnn.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -63,7 +63,6 @@ limitations under the License.\n #include \"xla/tsl/platform/errors.h\"\n #include \"xla/tsl/platform/logging.h\"\n #include \"xla/tsl/platform/macros.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/util/determinism.h\"\n #include \"xla/tsl/util/env_var.h\"\n@@ -790,19 +789,19 @@ MIOpenSupport::MIOpenSupport(StreamExecutor* parent) : parent_(parent) {\n   return_best_algo_only_ = false;\n   // but if the env var TF_ROCM_RETURN_BEST_ALGO_ONLY is set, only the best\n   // (i.e. most efficient) algorithm will be returned\n-  TF_CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_ROCM_RETURN_BEST_ALGO_ONLY\", false,\n-                                      &return_best_algo_only_));\n+  CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_ROCM_RETURN_BEST_ALGO_ONLY\", false,\n+                                   &return_best_algo_only_));\n \n   // by default, use Find Mode APIs for convolution\n   use_immediate_mode_ = false;\n   // swich to Find Mode if env var TF_ROCM_USE_IMMEDIATE_MODE is set\n \n-  TF_CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_ROCM_USE_IMMEDIATE_MODE\", false,\n-                                      &use_immediate_mode_));\n+  CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_ROCM_USE_IMMEDIATE_MODE\", false,\n+                                   &use_immediate_mode_));\n \n   bool enable_pooling_cache = false;\n-  TF_CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_ROCM_BW_POOL_CACHE\", false,\n-                                      &enable_pooling_cache));\n+  CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_ROCM_BW_POOL_CACHE\", false,\n+                                   &enable_pooling_cache));\n   if (enable_pooling_cache) m_pooling_cache_allowed = true;\n }\n \n@@ -5200,8 +5199,8 @@ bool UseNhwcLayoutForRocm() {\n #if TF_ROCM_VERSION >= 50100\n   static bool is_enabled = [] {\n     bool is_enabled = false;\n-    TF_CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_USE_ROCM_NHWC\",\n-                                        /*default_val=*/false, &is_enabled));\n+    CHECK_OK(tsl::ReadBoolFromEnvVar(\"TF_USE_ROCM_NHWC\",\n+                                     /*default_val=*/false, &is_enabled));\n     return is_enabled;\n   }();\n   return is_enabled;"
        },
        {
            "sha": "30d91be0640cbccee682f338772c8e1c2371b171",
            "filename": "third_party/xla/xla/stream_executor/rocm/rocm_platform.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2Frocm_platform.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2Frocm_platform.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Frocm%2Frocm_platform.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -19,6 +19,7 @@ limitations under the License.\n #include <string>\n #include <utility>\n \n+#include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n #include \"absl/strings/str_cat.h\"\n@@ -32,7 +33,6 @@ limitations under the License.\n #include \"xla/stream_executor/rocm/rocm_platform_id.h\"\n #include \"xla/stream_executor/rocm/rocm_status.h\"\n #include \"xla/tsl/platform/errors.h\"\n-#include \"xla/tsl/platform/status.h\"\n \n namespace stream_executor {\n namespace gpu {\n@@ -114,7 +114,7 @@ ROCmPlatform::GetUncachedExecutor(int ordinal) {\n static void InitializeROCmPlatform() {\n   auto status = PlatformManager::PlatformWithName(\"ROCM\");\n   if (!status.ok()) {\n-    TF_CHECK_OK(PlatformManager::RegisterPlatform(\n+    CHECK_OK(PlatformManager::RegisterPlatform(\n         std::make_unique<gpu::ROCmPlatform>()));\n   }\n }"
        },
        {
            "sha": "ebeff36f1de6d43e2519cfb970b2405e10ec48d6",
            "filename": "third_party/xla/xla/stream_executor/stream_executor_common.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fstream_executor_common.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fstream_executor_common.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fstream_executor_common.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -25,15 +25,14 @@ limitations under the License.\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/stream_executor/platform.h\"\n #include \"xla/tsl/util/env_var.h\"\n-#include \"tsl/platform/status.h\"\n \n namespace stream_executor {\n \n // Get per-device memory limit in bytes. Returns 0 if\n // TF_PER_DEVICE_MEMORY_LIMIT_MB environment variable is not set.\n static int64_t GetMemoryLimitBytesFromEnvironmentVariable() {\n   int64_t value;\n-  TF_CHECK_OK(\n+  CHECK_OK(\n       tsl::ReadInt64FromEnvVar(\"TF_PER_DEVICE_MEMORY_LIMIT_MB\", 0, &value));\n   return value * (1ll << 20);\n }"
        },
        {
            "sha": "4e0c530ba245c53bec1daac6a33e486877286df8",
            "filename": "third_party/xla/xla/stream_executor/sycl/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -47,7 +47,6 @@ cc_library(\n         \"//xla/stream_executor:platform_manager\",\n         \"//xla/stream_executor:stream_executor_h\",\n         \"//xla/stream_executor/platform:initialize\",\n-        \"//xla/tsl/platform:status\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\","
        },
        {
            "sha": "85e2cdea9cd6add91b3f231488b93b28477601a5",
            "filename": "third_party/xla/xla/stream_executor/sycl/sycl_platform.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Fsycl%2Fsycl_platform.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -27,7 +27,6 @@ limitations under the License.\n #include \"xla/stream_executor/platform/initialize.h\"\n #include \"xla/stream_executor/platform_manager.h\"\n #include \"xla/stream_executor/sycl/sycl_platform_id.h\"\n-#include \"xla/tsl/platform/status.h\"\n \n namespace stream_executor {\n namespace sycl {\n@@ -66,7 +65,7 @@ SyclPlatform::GetUncachedExecutor(int ordinal) {\n }  // namespace sycl\n \n static void InitializeSyclPlatform() {\n-  TF_CHECK_OK(PlatformManager::RegisterPlatform(\n+  CHECK_OK(PlatformManager::RegisterPlatform(\n       std::make_unique<sycl::SyclPlatform>()));\n }\n "
        },
        {
            "sha": "12e6e71cb665d7934a2cc275ed41ecd6a119301f",
            "filename": "third_party/xla/xla/stream_executor/tpu/BUILD",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Ftpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Ftpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Ftpu%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -352,7 +352,6 @@ cc_library(\n         \"@local_tsl//tsl/platform:casts\",\n         \"@local_tsl//tsl/platform:errors\",\n         \"@local_tsl//tsl/platform:logging\",\n-        \"@local_tsl//tsl/platform:status\",\n         \"@local_tsl//tsl/platform:types\",\n     ],\n )"
        },
        {
            "sha": "29db3c980a985230f0c0b135c96f2742b626a22a",
            "filename": "third_party/xla/xla/stream_executor/tpu/tpu_platform.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Ftpu%2Ftpu_platform.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Fstream_executor%2Ftpu%2Ftpu_platform.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fstream_executor%2Ftpu%2Ftpu_platform.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -34,10 +34,8 @@ limitations under the License.\n #include \"xla/stream_executor/tpu/tpu_executor.h\"\n #include \"xla/stream_executor/tpu/tpu_executor_api.h\"\n #include \"xla/stream_executor/tpu/tpu_platform_id.h\"\n-#include \"xla/stream_executor/tpu/tpu_platform_interface.h\"\n #include \"xla/stream_executor/tpu/tpu_topology.h\"\n #include \"tsl/platform/logging.h\"  // IWYU pragma: keep\n-#include \"tsl/platform/status.h\"\n \n namespace tensorflow {\n namespace tpu {\n@@ -176,7 +174,7 @@ bool RegisterTpuPlatform() {\n     tpu_registered_platform = new TpuPlatform();\n     std::unique_ptr<stream_executor::Platform> platform(\n         tpu_registered_platform);\n-    TF_CHECK_OK(stream_executor::PlatformManager::RegisterPlatform(\n+    CHECK_OK(stream_executor::PlatformManager::RegisterPlatform(\n         std::move(platform)));\n     tpu_platform_registered = true;\n   }"
        },
        {
            "sha": "a8875d154218dec7330d626d4e091604e3440d98",
            "filename": "third_party/xla/xla/tests/BUILD",
            "status": "modified",
            "additions": 58,
            "deletions": 21,
            "changes": 79,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2FBUILD?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -91,10 +91,10 @@ cc_library(\n         \"//xla/hlo/testlib:test\",\n         \"//xla/hlo/testlib:test_helpers\",\n         \"//xla/tsl/platform:env\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:test\",\n         \"@com_google_absl//absl/base:core_headers\",\n         \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/strings:str_format\",\n@@ -188,14 +188,12 @@ cc_library(\n         \"//xla/stream_executor:platform\",\n         \"//xla/stream_executor:stream_executor_memory_allocator\",\n         \"//xla/tsl/lib/core:status_test_util\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/platform:test\",\n         \"@com_google_absl//absl/base:core_headers\",\n         \"@com_google_absl//absl/base:nullability\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n-        \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings:string_view\",\n     ],\n@@ -316,27 +314,33 @@ cc_library(\n         \"//xla:array2d\",\n         \"//xla:array3d\",\n         \"//xla:array4d\",\n+        \"//xla:error_spec\",\n         \"//xla:execution_options_util\",\n         \"//xla:literal\",\n         \"//xla:literal_util\",\n         \"//xla:shape_util\",\n-        \"//xla:status_macros\",\n         \"//xla:types\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/client:client_library\",\n         \"//xla/client:local_client\",\n         \"//xla/hlo/builder:xla_builder\",\n         \"//xla/hlo/builder:xla_computation\",\n         \"//xla/hlo/testlib:test_helpers\",\n+        \"//xla/service\",\n         \"//xla/service:interpreter_plugin\",  # reference backend\n         \"//xla/service:platform_util\",\n+        \"//xla/stream_executor:platform\",\n         \"//xla/stream_executor:stream_executor_h\",\n         \"//xla/tsl/lib/core:bitmap\",\n+        \"//xla/tsl/platform:errors\",\n+        \"//xla/tsl/platform:statusor\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/types:span\",\n-        \"@local_tsl//tsl/platform:logging\",\n+        \"@com_google_googletest//:gtest_for_library\",\n         \"@local_tsl//tsl/platform:ml_dtypes\",\n         \"@local_tsl//tsl/platform:test\",\n     ],\n@@ -389,7 +393,6 @@ cc_library(\n         \"//xla:shape_util\",\n         \"//xla/hlo/builder:xla_builder\",\n         \"//xla/hlo/builder:xla_computation\",\n-        \"//xla/tsl/platform:status\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/types:span\",\n     ],\n@@ -504,17 +507,35 @@ xla_test(\n         \":hlo_test_base\",\n         \":literal_test_util\",\n         \":xla_internal_test_main\",\n+        \"//xla:comparison_util\",\n+        \"//xla:executable_run_options\",\n         \"//xla:literal\",\n-        \"//xla:status_macros\",\n+        \"//xla:literal_util\",\n+        \"//xla:shape_tree\",\n+        \"//xla:shape_util\",\n         \"//xla/client:client_library\",\n         \"//xla/client:local_client\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/hlo/testlib:verified_hlo_module\",\n         \"//xla/service:backend\",\n         \"//xla/service:executable\",\n+        \"//xla/service:hlo_module_config\",\n+        \"//xla/service:maybe_owning_device_memory\",\n+        \"//xla/service:shaped_buffer\",\n+        \"//xla/stream_executor:device_memory\",\n+        \"//xla/stream_executor:device_memory_allocator\",\n+        \"//xla/stream_executor:platform\",\n+        \"//xla/stream_executor:stream_executor_h\",\n         \"//xla/stream_executor:stream_executor_memory_allocator\",\n         \"//xla/tests:xla_test_backend_predicates\",\n         \"//xla/tsl/lib/core:status_test_util\",\n+        \"//xla/tsl/platform:statusor\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status:statusor\",\n+        \"@com_google_absl//absl/strings\",\n+        \"@com_google_absl//absl/strings:string_view\",\n+        \"@com_google_absl//absl/types:span\",\n         \"@com_google_googletest//:gtest\",\n     ],\n )\n@@ -701,8 +722,8 @@ xla_test(\n         \"//xla/hlo/testlib:test_helpers\",\n         \"//xla/service\",\n         \"//xla/tests:xla_test_backend_predicates\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:test\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings:string_view\",\n     ],\n@@ -889,6 +910,8 @@ xla_test(\n         \"//xla/hlo/builder:xla_computation\",\n         \"//xla/hlo/testlib:test\",\n         \"//xla/hlo/testlib:test_helpers\",\n+        \"//xla/service\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/types:span\",\n     ],\n@@ -899,18 +922,22 @@ xla_test(\n     srcs = [\"deconstruct_tuple_test.cc\"],\n     deps = [\n         \":client_library_test_base\",\n+        \":literal_test_util\",\n         \":xla_internal_test_main\",\n         \"//xla:literal\",\n+        \"//xla:literal_util\",\n         \"//xla:shape_util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/client:local_client\",\n         \"//xla/hlo/builder:xla_builder\",\n         \"//xla/hlo/builder:xla_computation\",\n         \"//xla/hlo/testlib:test\",\n         \"//xla/hlo/testlib:test_helpers\",\n+        \"//xla/service\",\n+        \"//xla/tsl/platform:statusor\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/types:span\",\n-        \"@local_tsl//tsl/platform:test\",\n     ],\n )\n \n@@ -3086,24 +3113,21 @@ xla_test(\n     srcs = [\"compute_constant_test.cc\"],\n     deps = [\n         \":literal_test_util\",\n-        \":test_utils\",\n         \":xla_internal_test_main\",\n         \"//xla:literal\",\n         \"//xla:literal_util\",\n         \"//xla:shape_util\",\n-        \"//xla:status_macros\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/client\",\n         \"//xla/client:client_library\",\n         \"//xla/hlo/builder:xla_builder\",\n         \"//xla/hlo/builder:xla_computation\",\n         \"//xla/hlo/testlib:test\",\n         \"//xla/stream_executor:platform\",\n-        \"//xla/tsl/lib/core:status_test_util\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/util/proto:proto_matchers\",\n         \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\",\n     ],\n@@ -3214,10 +3238,13 @@ xla_test(\n         \"//xla:shape_util\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/client:local_client\",\n+        \"//xla/service\",\n+        \"//xla/tsl/platform:env\",\n+        \"//xla/tsl/platform:test\",\n         \"@com_google_absl//absl/base\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/types:span\",\n-        \"@local_tsl//tsl/platform:env\",\n         \"@local_tsl//tsl/platform:test\",\n     ],\n )\n@@ -3285,7 +3312,6 @@ xla_test(\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/tests:xla_test_backend_predicates\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/platform:test\",\n         \"@com_google_absl//absl/log:check\",\n@@ -3441,12 +3467,18 @@ xla_cc_test(\n     srcs = [\"literal_test_util_test.cc\"],\n     deps = [\n         \":literal_test_util\",\n+        \"//xla:error_spec\",\n         \"//xla:literal\",\n+        \"//xla:literal_util\",\n+        \"//xla:shape_util\",\n+        \"//xla:types\",\n         \"//xla/hlo/testlib:test_helpers\",\n+        \"//xla/tsl/platform:env\",\n+        \"//xla/tsl/platform:test\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_googletest//:gtest_main\",\n-        \"@local_tsl//tsl/platform:env\",\n-        \"@local_tsl//tsl/platform:logging\",\n         \"@local_tsl//tsl/platform:path\",\n         \"@local_tsl//tsl/platform:test\",\n     ],\n@@ -3461,19 +3493,24 @@ xla_test(\n         \":local_client_test_base\",\n         \":xla_internal_test_main\",\n         \"//xla:literal\",\n+        \"//xla:literal_util\",\n         \"//xla:shape_util\",\n         \"//xla:types\",\n         \"//xla:xla_data_proto_cc\",\n         \"//xla/hlo/parser:hlo_parser\",\n+        \"//xla/hlo/testlib:test_helpers\",\n         \"//xla/service:generic_transfer_manager\",\n         \"//xla/service:shaped_buffer\",\n         \"//xla/service:stream_pool\",\n         \"//xla/stream_executor:device_memory_allocator\",\n-        \"//xla/stream_executor:stream_executor_h\",\n         \"//xla/tests:xla_test_backend_predicates\",\n+        \"//xla/tsl/platform:statusor\",\n+        \"//xla/tsl/platform:test_benchmark\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:statusor\",\n-        \"@local_tsl//tsl/platform:logging\",\n-        \"@local_tsl//tsl/platform:test_benchmark\",\n+        \"@com_google_absl//absl/types:span\",\n+        \"@com_google_benchmark//:benchmark\",\n+        \"@com_google_googletest//:gtest\",\n     ],\n )\n \n@@ -3774,10 +3811,10 @@ xla_test(\n         \"//xla:literal_util\",\n         \"//xla:shape_util\",\n         \"//xla/hlo/testlib:test\",\n-        \"//xla/tsl/platform:status\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/platform:test\",\n         \"@com_google_absl//absl/algorithm:container\",\n+        \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/types:span\",\n         \"@com_google_googletest//:gtest\","
        },
        {
            "sha": "150e6c769ace79eec902db2b54946c7301bc684b",
            "filename": "third_party/xla/xla/tests/buffer_donation_test.cc",
            "status": "modified",
            "additions": 25,
            "deletions": 3,
            "changes": 28,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fbuffer_donation_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fbuffer_donation_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fbuffer_donation_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -14,24 +14,46 @@ limitations under the License.\n ==============================================================================*/\n \n #include <memory>\n+#include <string>\n #include <utility>\n #include <vector>\n \n #include \"xla/tests/xla_test_backend_predicates.h\"\n+#include <gtest/gtest.h>\n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"absl/strings/match.h\"\n+#include \"absl/strings/string_view.h\"\n+#include \"absl/types/span.h\"\n #include \"xla/client/client_library.h\"\n #include \"xla/client/local_client.h\"\n+#include \"xla/comparison_util.h\"\n+#include \"xla/executable_run_options.h\"\n #include \"xla/hlo/ir/hlo_input_output_alias_config.h\"\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_opcode.h\"\n #include \"xla/hlo/testlib/verified_hlo_module.h\"\n #include \"xla/literal.h\"\n+#include \"xla/literal_util.h\"\n #include \"xla/service/backend.h\"\n #include \"xla/service/executable.h\"\n-#include \"xla/status_macros.h\"\n+#include \"xla/service/hlo_module_config.h\"\n+#include \"xla/service/maybe_owning_device_memory.h\"\n+#include \"xla/service/service_executable_run_options.h\"\n+#include \"xla/service/shaped_buffer.h\"\n+#include \"xla/shape.h\"\n+#include \"xla/shape_tree.h\"\n+#include \"xla/shape_util.h\"\n+#include \"xla/stream_executor/device_memory.h\"\n+#include \"xla/stream_executor/device_memory_allocator.h\"\n+#include \"xla/stream_executor/platform.h\"\n+#include \"xla/stream_executor/stream_executor.h\"\n #include \"xla/stream_executor/stream_executor_memory_allocator.h\"\n #include \"xla/tests/hlo_test_base.h\"\n #include \"xla/tests/literal_test_util.h\"\n #include \"xla/tsl/lib/core/status_test_util.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n \n namespace xla {\n namespace {\n@@ -49,7 +71,7 @@ class BufferDonationTest : public HloTestBase {\n     backend_ = client_->mutable_backend();\n     platform_ = backend_->platform();\n     executor_ = backend_->default_stream_executor();\n-    TF_CHECK_OK(executor_->Init());\n+    CHECK_OK(executor_->Init());\n   }\n \n  protected:\n@@ -106,7 +128,7 @@ class BufferDonationTest : public HloTestBase {\n               argument_literal.shape(), &memory_allocator,\n               executor_->device_ordinal()));\n       ShapedBuffer shaped_buffer = scoped_shaped_buffer.release();\n-      TF_CHECK_OK(backend_->transfer_manager()->TransferLiteralToDevice(\n+      CHECK_OK(backend_->transfer_manager()->TransferLiteralToDevice(\n           stream.get(), argument_literal, shaped_buffer));\n       ShapeTree<se::DeviceMemoryBase> input_buffers = shaped_buffer.buffers();\n       inputs_buffers.push_back(input_buffers);"
        },
        {
            "sha": "97f69de00fbc8f90f271751b0b252b147627e8dd",
            "filename": "third_party/xla/xla/tests/client_library_test_base.cc",
            "status": "modified",
            "additions": 25,
            "deletions": 4,
            "changes": 29,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fclient_library_test_base.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fclient_library_test_base.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fclient_library_test_base.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -15,24 +15,45 @@ limitations under the License.\n \n #include \"xla/tests/client_library_test_base.h\"\n \n+#include <algorithm>\n+#include <cstdint>\n+#include <functional>\n+#include <iterator>\n #include <memory>\n+#include <numeric>\n+#include <optional>\n #include <string>\n+#include <tuple>\n #include <utility>\n+#include <vector>\n \n+#include <gtest/gtest.h>\n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/str_cat.h\"\n+#include \"absl/strings/string_view.h\"\n+#include \"absl/types/span.h\"\n #include \"xla/client/client_library.h\"\n #include \"xla/client/local_client.h\"\n+#include \"xla/error_spec.h\"\n #include \"xla/execution_options_util.h\"\n #include \"xla/hlo/builder/xla_builder.h\"\n+#include \"xla/hlo/builder/xla_computation.h\"\n #include \"xla/hlo/testlib/test_helpers.h\"\n+#include \"xla/layout_util.h\"\n #include \"xla/literal_util.h\"\n #include \"xla/service/platform_util.h\"\n+#include \"xla/service/service.h\"\n+#include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n-#include \"xla/status_macros.h\"\n+#include \"xla/stream_executor/platform.h\"\n+#include \"xla/tests/literal_test_util.h\"\n+#include \"xla/tsl/lib/core/bitmap.h\"\n+#include \"xla/tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n #include \"xla/xla_data.pb.h\"\n-#include \"tsl/platform/logging.h\"\n \n namespace xla {\n namespace {\n@@ -46,14 +67,14 @@ LocalClient* GetOrCreateLocalClientOrDie(\n     const LocalClientOptions& client_options) {\n   absl::StatusOr<LocalClient*> result =\n       ClientLibrary::GetOrCreateLocalClient(client_options);\n-  TF_CHECK_OK(result.status()) << \" could not create local client for testing\";\n+  CHECK_OK(result.status()) << \" could not create local client for testing\";\n   return result.value();\n }\n \n // Helper functions to get the reference platform.\n se::Platform* GetReferencePlatform() {\n   auto result = PlatformUtil::GetPlatform(kInterpreter);\n-  TF_CHECK_OK(result.status()) << \"could not get interpreter platform\";\n+  CHECK_OK(result.status()) << \"could not get interpreter platform\";\n   return result.value();\n }\n "
        },
        {
            "sha": "e3cf8afe4d8a8fd178a2c25c2bf2e47c9eeba30b",
            "filename": "third_party/xla/xla/tests/client_library_test_runner_utils.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fclient_library_test_runner_utils.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fclient_library_test_runner_utils.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fclient_library_test_runner_utils.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -25,7 +25,6 @@ limitations under the License.\n #include \"xla/hlo/builder/xla_computation.h\"\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n \n namespace xla {\n \n@@ -36,7 +35,7 @@ XlaComputation CreateScalarReluF32() {\n   XlaOp zero = ConstantR0<float>(&builder, 0.0f);\n   Max(std::move(z_value), std::move(zero));\n   absl::StatusOr<XlaComputation> computation = builder.Build();\n-  TF_CHECK_OK(computation.status());\n+  CHECK_OK(computation.status());\n   return *std::move(computation);\n }\n \n@@ -47,7 +46,7 @@ XlaComputation CreateScalarMax(const PrimitiveType test_type) {\n   XlaOp y = Parameter(&builder, 1, shape, \"y\");\n   Max(std::move(x), std::move(y));\n   absl::StatusOr<XlaComputation> computation = builder.Build();\n-  TF_CHECK_OK(computation.status());\n+  CHECK_OK(computation.status());\n   return *std::move(computation);\n }\n "
        },
        {
            "sha": "848ef1727329787476c00594823e8d7191afcb70",
            "filename": "third_party/xla/xla/tests/compute_constant_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fcompute_constant_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fcompute_constant_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fcompute_constant_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -18,6 +18,7 @@ limitations under the License.\n #include <utility>\n #include <vector>\n \n+#include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/match.h\"\n@@ -33,7 +34,6 @@ limitations under the License.\n #include \"xla/shape_util.h\"\n #include \"xla/stream_executor/platform.h\"\n #include \"xla/tests/literal_test_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/util/proto/proto_matchers.h\"\n #include \"xla/xla_data.pb.h\"\n@@ -59,13 +59,12 @@ class ComputeConstantTest : public ::testing::Test {\n     if (client_type == ClientType::kLocal) {\n       absl::StatusOr<Client*> result =\n           ClientLibrary::GetOrCreateLocalClient(platform);\n-      TF_CHECK_OK(result.status())\n-          << \"could not create LocalClient for testing\";\n+      CHECK_OK(result.status()) << \"could not create LocalClient for testing\";\n       return result.value();\n     } else if (client_type == ClientType::kCompileOnly) {\n       absl::StatusOr<Client*> result =\n           ClientLibrary::GetOrCreateCompileOnlyClient(platform);\n-      TF_CHECK_OK(result.status())\n+      CHECK_OK(result.status())\n           << \"could not create CompileOnlyClient for testing\";\n       return result.value();\n     }"
        },
        {
            "sha": "ec0db90a50411e9d2348daaf79c269cb2995b420",
            "filename": "third_party/xla/xla/tests/concatenate_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fconcatenate_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fconcatenate_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fconcatenate_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -20,6 +20,7 @@ limitations under the License.\n \n #include <gtest/gtest.h>\n #include \"absl/algorithm/container.h\"\n+#include \"absl/log/check.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/str_join.h\"\n #include \"absl/types/span.h\"\n@@ -29,7 +30,6 @@ limitations under the License.\n #include \"xla/shape.h\"\n #include \"xla/tests/hlo_pjrt_test_base.h\"\n #include \"xla/tests/literal_test_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/platform/test.h\"\n \n@@ -134,10 +134,10 @@ TEST_F(ConcatenateTest, TwoR3Axis1Parallel) {\n                           ParseAndReturnVerifiedModule(hlo_text_module));\n \n   Literal x_input = LiteralUtil::CreateFromDimensions(S32, {64, 64, 64});\n-  TF_CHECK_OK(x_input.Populate<int32_t>(MakeIotaForShape(x_input.shape())));\n+  CHECK_OK(x_input.Populate<int32_t>(MakeIotaForShape(x_input.shape())));\n \n   Literal y_input = LiteralUtil::CreateFromDimensions(S32, {64, 64, 64});\n-  TF_CHECK_OK(\n+  CHECK_OK(\n       y_input.Populate<int32_t>(MakeNegativeIotaForShape(y_input.shape())));\n \n   TF_ASSERT_OK_AND_ASSIGN(Literal result,"
        },
        {
            "sha": "2296ea385122632d5498d9231f5ea49cd1bfa983",
            "filename": "third_party/xla/xla/tests/deallocation_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fdeallocation_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fdeallocation_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fdeallocation_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -15,13 +15,15 @@ limitations under the License.\n \n #include <memory>\n \n+#include \"absl/log/check.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/types/span.h\"\n #include \"xla/client/local_client.h\"\n #include \"xla/hlo/builder/xla_builder.h\"\n #include \"xla/hlo/builder/xla_computation.h\"\n #include \"xla/hlo/testlib/test.h\"\n #include \"xla/hlo/testlib/test_helpers.h\"\n+#include \"xla/service/service.h\"\n #include \"xla/tests/client_library_test_base.h\"\n \n namespace xla {\n@@ -38,7 +40,7 @@ class DeallocationTest : public ClientLibraryTestBase {\n     XlaComputation computation = builder->Build().value();\n     auto global_data =\n         client_->Execute(computation, arguments, &execution_options_).value();\n-    TF_CHECK_OK(client_->Transfer(*global_data).status());\n+    CHECK_OK(client_->Transfer(*global_data).status());\n     return global_data;\n   }\n };"
        },
        {
            "sha": "a7dbbe2ec3122b8f753e3ebb723a5fa9ca246573",
            "filename": "third_party/xla/xla/tests/deconstruct_tuple_test.cc",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fdeconstruct_tuple_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fdeconstruct_tuple_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fdeconstruct_tuple_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -17,6 +17,7 @@ limitations under the License.\n #include <utility>\n #include <vector>\n \n+#include \"absl/log/check.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/types/span.h\"\n #include \"xla/client/local_client.h\"\n@@ -25,10 +26,13 @@ limitations under the License.\n #include \"xla/hlo/testlib/test.h\"\n #include \"xla/hlo/testlib/test_helpers.h\"\n #include \"xla/literal.h\"\n+#include \"xla/literal_util.h\"\n+#include \"xla/service/service.h\"\n #include \"xla/shape_util.h\"\n #include \"xla/tests/client_library_test_base.h\"\n+#include \"xla/tests/literal_test_util.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n #include \"xla/xla_data.pb.h\"\n-#include \"tsl/platform/test.h\"\n \n namespace xla {\n namespace {\n@@ -45,7 +49,7 @@ class DeconstructTupleTest : public ClientLibraryTestBase {\n     XlaComputation computation = builder->Build().value();\n     auto global_data =\n         client_->Execute(computation, arguments, &execution_options_).value();\n-    TF_CHECK_OK(client_->Transfer(*global_data).status());\n+    CHECK_OK(client_->Transfer(*global_data).status());\n     return global_data;\n   }\n };"
        },
        {
            "sha": "6421e9badcbec7d918f50d0013b32eccfbeed84d",
            "filename": "third_party/xla/xla/tests/hlo_test_base.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fhlo_test_base.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fhlo_test_base.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fhlo_test_base.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -24,7 +24,6 @@ limitations under the License.\n \n #include \"absl/base/nullability.h\"\n #include \"absl/log/check.h\"\n-#include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/string_view.h\"\n #include \"xla/error_spec.h\"\n@@ -47,7 +46,6 @@ limitations under the License.\n #include \"xla/tests/hlo_runner_agnostic_test_base.h\"\n #include \"xla/tests/pjrt_client_registry.h\"\n #include \"xla/tsl/lib/core/status_test_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/platform/test.h\"\n #include \"xla/util.h\"\n@@ -140,13 +138,13 @@ HloTestBase::HloTestBase(\n \n /*static*/ se::Platform* HloTestBase::GetReferencePlatform() {\n   auto result = PlatformUtil::GetPlatform(kInterpreter);\n-  TF_CHECK_OK(result.status()) << \"could not get interpreter platform\";\n+  CHECK_OK(result.status()) << \"could not get interpreter platform\";\n   return result.value();\n }\n \n /*static*/ se::Platform* HloTestBase::GetTestPlatform() {\n   auto result = PlatformUtil::GetDefaultPlatform();\n-  TF_CHECK_OK(result.status()) << \"could not get test platform\";\n+  CHECK_OK(result.status()) << \"could not get test platform\";\n   return result.value();\n }\n "
        },
        {
            "sha": "af5512a2248304c2303dd66f2867ee0130a362ea",
            "filename": "third_party/xla/xla/tests/literal_test_util.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fliteral_test_util.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fliteral_test_util.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fliteral_test_util.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -19,6 +19,7 @@ limitations under the License.\n #include <string>\n \n #include <gtest/gtest.h>\n+#include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n #include \"absl/strings/str_cat.h\"\n@@ -29,7 +30,6 @@ limitations under the License.\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n #include \"xla/tsl/platform/env.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/test.h\"\n #include \"tsl/platform/path.h\"\n \n@@ -51,10 +51,10 @@ void WriteLiteralToTempFile(const LiteralSlice& literal,\n   auto* env = tsl::Env::Default();\n   std::string filename = tsl::io::JoinPath(\n       outdir, absl::StrFormat(\"tempfile-%d-%s\", env->NowMicros(), name));\n-  TF_CHECK_OK(tsl::WriteBinaryProto(env, absl::StrCat(filename, \".pb\"),\n-                                    literal.ToProto()));\n-  TF_CHECK_OK(tsl::WriteStringToFile(env, absl::StrCat(filename, \".txt\"),\n-                                     literal.ToString()));\n+  CHECK_OK(tsl::WriteBinaryProto(env, absl::StrCat(filename, \".pb\"),\n+                                 literal.ToProto()));\n+  CHECK_OK(tsl::WriteStringToFile(env, absl::StrCat(filename, \".txt\"),\n+                                  literal.ToString()));\n   LOG(ERROR) << \"wrote Literal to \" << name << \" file: \" << filename\n              << \".{pb,txt}\";\n }"
        },
        {
            "sha": "36face591dd390e987c227ec0c20f8436a5f3f10",
            "filename": "third_party/xla/xla/tests/literal_test_util_test.cc",
            "status": "modified",
            "additions": 18,
            "deletions": 8,
            "changes": 26,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fliteral_test_util_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fliteral_test_util_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fliteral_test_util_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -18,15 +18,26 @@ limitations under the License.\n \n #include \"xla/tests/literal_test_util.h\"\n \n+#include <cmath>\n+#include <cstdint>\n+#include <limits>\n+#include <string>\n #include <vector>\n \n+#include <gmock/gmock.h>\n+#include <gtest/gtest.h>\n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n #include \"absl/strings/str_join.h\"\n+#include \"xla/error_spec.h\"\n #include \"xla/hlo/testlib/test_helpers.h\"\n #include \"xla/literal.h\"\n-#include \"tsl/platform/env.h\"\n-#include \"tsl/platform/logging.h\"\n+#include \"xla/literal_util.h\"\n+#include \"xla/shape_util.h\"\n+#include \"xla/tsl/platform/env.h\"\n+#include \"xla/tsl/platform/test.h\"\n+#include \"xla/types.h\"\n #include \"tsl/platform/path.h\"\n-#include \"tsl/platform/test.h\"\n \n namespace xla {\n namespace {\n@@ -135,24 +146,23 @@ TEST(LiteralTestUtilTest, ExpectNearFailurePlacesResultsInTemporaryDirectory) {\n   }\n   std::string pattern = tsl::io::JoinPath(outdir, \"tempfile-*.pb\");\n   std::vector<std::string> files;\n-  TF_CHECK_OK(env->GetMatchingPaths(pattern, &files));\n+  CHECK_OK(env->GetMatchingPaths(pattern, &files));\n   for (const auto& f : files) {\n-    TF_CHECK_OK(env->DeleteFile(f)) << f;\n+    CHECK_OK(env->DeleteFile(f)) << f;\n   }\n \n   ASSERT_DEATH(dummy_lambda(), \"two is not near four\");\n \n   // Now check we wrote temporary files to the temporary directory that we can\n   // read.\n   std::vector<std::string> results;\n-  TF_CHECK_OK(env->GetMatchingPaths(pattern, &results));\n+  CHECK_OK(env->GetMatchingPaths(pattern, &results));\n \n   LOG(INFO) << \"results: [\" << absl::StrJoin(results, \", \") << \"]\";\n   EXPECT_EQ(3, results.size());\n   for (const std::string& result : results) {\n     LiteralProto literal_proto;\n-    TF_CHECK_OK(\n-        tsl::ReadBinaryProto(tsl::Env::Default(), result, &literal_proto));\n+    CHECK_OK(tsl::ReadBinaryProto(tsl::Env::Default(), result, &literal_proto));\n     Literal literal = Literal::CreateFromProto(literal_proto).value();\n     if (result.find(\"expected\") != std::string::npos) {\n       EXPECT_EQ(\"f32[] 2\", literal.ToString());"
        },
        {
            "sha": "d4a8bba948287bbb09b6d9223516c04741230847",
            "filename": "third_party/xla/xla/tests/map_test.cc",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fmap_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fmap_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fmap_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -18,6 +18,7 @@ limitations under the License.\n #include <utility>\n \n #include \"xla/tests/xla_test_backend_predicates.h\"\n+#include \"absl/log/check.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/strings/string_view.h\"\n #include \"xla/array2d.h\"\n@@ -36,7 +37,6 @@ limitations under the License.\n #include \"xla/tests/client_library_test_runner_mixin.h\"\n #include \"xla/tests/hlo_pjrt_interpreter_reference_mixin.h\"\n #include \"xla/tests/hlo_pjrt_test_base.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/test.h\"\n #include \"xla/xla_data.pb.h\"\n \n@@ -62,7 +62,7 @@ class MapTest : public ClientLibraryTestRunnerMixin<\n     auto one = ConstantR0<float>(&mapped_builder, 1.0);\n     Add(x, one);\n     auto computation_status = mapped_builder.Build();\n-    TF_CHECK_OK(computation_status.status());\n+    CHECK_OK(computation_status.status());\n     return std::move(computation_status).value();\n   }\n \n@@ -72,7 +72,7 @@ class MapTest : public ClientLibraryTestRunnerMixin<\n     auto rhs = Parameter(&b, 1, ShapeUtil::MakeShape(F32, {}), \"y\");\n     Max(lhs, rhs);\n     auto computation_status = b.Build();\n-    TF_CHECK_OK(computation_status.status());\n+    CHECK_OK(computation_status.status());\n     return std::move(computation_status).value();\n   }\n \n@@ -84,7 +84,7 @@ class MapTest : public ClientLibraryTestRunnerMixin<\n     (void)Parameter(&mapped_builder, 0, ShapeUtil::MakeShape(F32, {}), \"x\");\n     ConstantR0<T>(&mapped_builder, 1);\n     auto computation_status = mapped_builder.Build();\n-    TF_CHECK_OK(computation_status.status());\n+    CHECK_OK(computation_status.status());\n     return std::move(computation_status).value();\n   }\n \n@@ -99,7 +99,7 @@ class MapTest : public ClientLibraryTestRunnerMixin<\n     auto two = ConstantR0<float>(&mapped_builder, 2.0);\n     Mul(x, two);\n     auto computation_status = mapped_builder.Build();\n-    TF_CHECK_OK(computation_status.status());\n+    CHECK_OK(computation_status.status());\n     return std::move(computation_status).value();\n   }\n \n@@ -118,7 +118,7 @@ class MapTest : public ClientLibraryTestRunnerMixin<\n     auto adder_to_one = Add(x, one);\n     Mul(x, adder_to_one);\n     auto computation_status = mapped_builder.Build();\n-    TF_CHECK_OK(computation_status.status());\n+    CHECK_OK(computation_status.status());\n     return std::move(computation_status).value();\n   }\n \n@@ -136,7 +136,7 @@ class MapTest : public ClientLibraryTestRunnerMixin<\n     auto constant_n = ConstantR0<float>(&builder, n);\n     Add(map, constant_n);\n     auto computation_status = builder.Build();\n-    TF_CHECK_OK(computation_status.status());\n+    CHECK_OK(computation_status.status());\n     return std::move(computation_status).value();\n   }\n \n@@ -148,7 +148,7 @@ class MapTest : public ClientLibraryTestRunnerMixin<\n     auto y = Parameter(&b, 1, ShapeUtil::MakeShape(F32, {}), \"y\");\n     Gt(x, y);\n     auto computation_status = b.Build();\n-    TF_CHECK_OK(computation_status.status());\n+    CHECK_OK(computation_status.status());\n     return std::move(computation_status).value();\n   }\n \n@@ -167,7 +167,7 @@ class MapTest : public ClientLibraryTestRunnerMixin<\n     auto xy = Add(x, y);\n     Add(xy, z);\n     auto computation_status = mapped_builder.Build();\n-    TF_CHECK_OK(computation_status.status());\n+    CHECK_OK(computation_status.status());\n     return std::move(computation_status).value();\n   }\n };"
        },
        {
            "sha": "c839b5e1826c61f2bb59e09a80b45b61f014021f",
            "filename": "third_party/xla/xla/tests/multioutput_fusion_test.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fmultioutput_fusion_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fmultioutput_fusion_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fmultioutput_fusion_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -33,7 +33,6 @@ limitations under the License.\n #include \"xla/tests/hlo_pjrt_interpreter_reference_mixin.h\"\n #include \"xla/tests/hlo_pjrt_test_base.h\"\n #include \"xla/tests/literal_test_util.h\"\n-#include \"xla/tsl/platform/status.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/tsl/platform/test.h\"\n #include \"xla/xla_data.pb.h\"\n@@ -95,8 +94,8 @@ class MultiOutputFusionTest\n           HloInstruction::CreateGetTupleElement(elem_shape2, tuple, 0));\n       auto gte1 = computation->AddInstruction(\n           HloInstruction::CreateGetTupleElement(elem_shape2, tuple, 1));\n-      TF_CHECK_OK(dot->ReplaceOperandWith(0, gte0));\n-      TF_CHECK_OK(dot->ReplaceOperandWith(1, gte1));\n+      CHECK_OK(dot->ReplaceOperandWith(0, gte0));\n+      CHECK_OK(dot->ReplaceOperandWith(1, gte1));\n \n       CHECK_NE(\n           computation->CreateFusionInstruction(\n@@ -159,8 +158,8 @@ class MultiOutputFusionTest\n           HloInstruction::CreateGetTupleElement(elem_shape_U8, tuple, 0));\n       auto gte1 = computation->AddInstruction(\n           HloInstruction::CreateGetTupleElement(elem_shape_F32, tuple, 1));\n-      TF_CHECK_OK(sub->ReplaceOperandWith(0, gte0));\n-      TF_CHECK_OK(reshape->ReplaceOperandWith(0, gte1));\n+      CHECK_OK(sub->ReplaceOperandWith(0, gte0));\n+      CHECK_OK(reshape->ReplaceOperandWith(0, gte1));\n \n       CHECK_NE(computation->CreateFusionInstruction(\n                    {tuple, sub_U8, add, param0_U8, param1_F32},"
        },
        {
            "sha": "f618502926f3954ca287b3a3bb16356f9f960394",
            "filename": "third_party/xla/xla/tests/round_trip_packed_literal_test.cc",
            "status": "modified",
            "additions": 10,
            "deletions": 5,
            "changes": 15,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fround_trip_packed_literal_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Fround_trip_packed_literal_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Fround_trip_packed_literal_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -14,20 +14,25 @@ limitations under the License.\n ==============================================================================*/\n \n #include <memory>\n+#include <string>\n \n #include \"absl/base/casts.h\"\n+#include \"absl/log/check.h\"\n #include \"absl/status/statusor.h\"\n #include \"absl/types/span.h\"\n #include \"xla/client/local_client.h\"\n+#include \"xla/layout.h\"\n #include \"xla/layout_util.h\"\n #include \"xla/literal.h\"\n #include \"xla/packed_literal_reader.h\"\n+#include \"xla/service/service.h\"\n #include \"xla/shape_util.h\"\n #include \"xla/tests/client_library_test_base.h\"\n #include \"xla/tests/literal_test_util.h\"\n+#include \"xla/tsl/platform/env.h\"\n+#include \"xla/tsl/platform/file_system.h\"\n+#include \"xla/tsl/platform/test.h\"\n #include \"xla/xla_data.pb.h\"\n-#include \"tsl/platform/env.h\"\n-#include \"tsl/platform/test.h\"\n \n namespace xla {\n namespace {\n@@ -52,7 +57,7 @@ TEST_F(RoundTripPackedLiteralTest, RoundTripsR1F32Length2) {\n   EXPECT_TRUE(tsl::WriteStringToFile(tsl::Env::Default(), fname, data).ok());\n \n   std::unique_ptr<tsl::RandomAccessFile> f;\n-  TF_CHECK_OK(tsl::Env::Default()->NewRandomAccessFile(fname, &f));\n+  CHECK_OK(tsl::Env::Default()->NewRandomAccessFile(fname, &f));\n   PackedLiteralReader reader(f.release());\n   Literal actual = reader.Read(ShapeUtil::MakeShape(F32, {2})).value();\n   EXPECT_TRUE(reader.IsExhausted());\n@@ -77,7 +82,7 @@ TEST_F(RoundTripPackedLiteralTest, RoundTripsR2F32Size2x2Dim0Minor) {\n   const Layout layout = LayoutUtil::MakeLayout({1, 0});\n \n   std::unique_ptr<tsl::RandomAccessFile> f;\n-  TF_CHECK_OK(tsl::Env::Default()->NewRandomAccessFile(fname, &f));\n+  CHECK_OK(tsl::Env::Default()->NewRandomAccessFile(fname, &f));\n   PackedLiteralReader reader(f.release());\n   Literal actual =\n       reader.Read(ShapeUtil::MakeShape(F32, {2, 2}), &layout).value();\n@@ -108,7 +113,7 @@ TEST_F(RoundTripPackedLiteralTest, RoundTripsR2F32Size2x2Dim1Minor) {\n   const Layout layout = LayoutUtil::MakeLayout({0, 1});\n \n   std::unique_ptr<tsl::RandomAccessFile> f;\n-  TF_CHECK_OK(tsl::Env::Default()->NewRandomAccessFile(fname, &f));\n+  CHECK_OK(tsl::Env::Default()->NewRandomAccessFile(fname, &f));\n   PackedLiteralReader reader(f.release());\n   Literal actual =\n       reader.Read(ShapeUtil::MakeShape(F32, {2, 2}), &layout).value();"
        },
        {
            "sha": "6a4a188afd94fac046334e46e0a270c52e293085",
            "filename": "third_party/xla/xla/tests/transfer_manager_test.cc",
            "status": "modified",
            "additions": 17,
            "deletions": 10,
            "changes": 27,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Ftransfer_manager_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8ef1949acf31cb9951d588ab7b2ae3e953ae461b/third_party%2Fxla%2Fxla%2Ftests%2Ftransfer_manager_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftests%2Ftransfer_manager_test.cc?ref=8ef1949acf31cb9951d588ab7b2ae3e953ae461b",
            "patch": "@@ -13,27 +13,34 @@ See the License for the specific language governing permissions and\n limitations under the License.\n ==============================================================================*/\n \n-#include <memory>\n-#include <string>\n+#include <cstdint>\n+#include <functional>\n+#include <numeric>\n+#include <utility>\n #include <vector>\n \n #include \"xla/tests/xla_test_backend_predicates.h\"\n+#include <gtest/gtest.h>\n+#include \"absl/log/check.h\"\n #include \"absl/status/statusor.h\"\n+#include \"absl/types/span.h\"\n+#include \"benchmark/benchmark.h\"\n #include \"xla/hlo/parser/hlo_parser.h\"\n+#include \"xla/hlo/testlib/test_helpers.h\"\n #include \"xla/layout_util.h\"\n #include \"xla/literal.h\"\n-#include \"xla/service/generic_transfer_manager.h\"\n+#include \"xla/literal_util.h\"\n #include \"xla/service/shaped_buffer.h\"\n #include \"xla/service/stream_pool.h\"\n+#include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n #include \"xla/stream_executor/device_memory_allocator.h\"\n-#include \"xla/stream_executor/stream_executor.h\"\n #include \"xla/tests/literal_test_util.h\"\n #include \"xla/tests/local_client_test_base.h\"\n+#include \"xla/tsl/platform/statusor.h\"\n+#include \"xla/tsl/platform/test_benchmark.h\"\n #include \"xla/types.h\"\n #include \"xla/xla_data.pb.h\"\n-#include \"tsl/platform/logging.h\"\n-#include \"tsl/platform/test_benchmark.h\"\n \n namespace xla {\n namespace {\n@@ -412,8 +419,8 @@ class TransferDeviceToHostBenchmark : public TransferManagerTest {\n     }\n     Literal literal = LiteralUtil::MakeTupleOwned(std::move(tuple_elements));\n     auto device_buffer = AllocateDeviceBuffer(literal.shape());\n-    TF_CHECK_OK(transfer_manager_->TransferLiteralToDevice(stream_, literal,\n-                                                           device_buffer));\n+    CHECK_OK(transfer_manager_->TransferLiteralToDevice(stream_, literal,\n+                                                        device_buffer));\n     for (auto s : state) {\n       TF_ASSERT_OK_AND_ASSIGN(\n           Literal result,\n@@ -443,8 +450,8 @@ class TransferHostToDeviceBenchmark : public TransferManagerTest {\n     auto device_buffer = AllocateDeviceBuffer(literal.shape());\n \n     for (auto s : state) {\n-      TF_CHECK_OK(transfer_manager_->TransferLiteralToDevice(stream_, literal,\n-                                                             device_buffer));\n+      CHECK_OK(transfer_manager_->TransferLiteralToDevice(stream_, literal,\n+                                                          device_buffer));\n     }\n     TearDown();\n   }"
        }
    ],
    "stats": {
        "total": 555,
        "additions": 304,
        "deletions": 251
    }
}