{
    "author": "apivovarov",
    "message": "[GPU] Add RAFT library and its dependencies\n\nThis PR adds the RAFT library and its dependencies to OSS XLA.\n\nThe `raft::matrix::select_k` function will be used to implement `hlo.topk` on GPU, enabling efficient selection of the top-K elements in GPU computations.\n\nPiperOrigin-RevId: 798286948",
    "sha": "84c50c32010849b49ed6dd6765aa218fac8920e3",
    "files": [
        {
            "sha": "cc558415f2b3d22e6e29586e495b47e8efc9be5a",
            "filename": "third_party/xla/third_party/fmt/BUILD",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Ffmt%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Ffmt%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Ffmt%2FBUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1 @@\n+# copybara:uncomment package(default_applicable_licenses = [\"//third_party/tensorflow:license\"])"
        },
        {
            "sha": "3b470ed4383742e53a774b2fdf671fc9fdd22d28",
            "filename": "third_party/xla/third_party/fmt/fmt.BUILD",
            "status": "added",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Ffmt%2Ffmt.BUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Ffmt%2Ffmt.BUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Ffmt%2Ffmt.BUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,30 @@\n+# fmt is an open-source formatting library providing a fast and safe alternative to C stdio and C++ iostreams.\n+licenses([\"notice\"])  # MIT\n+\n+exports_files([\"LICENSE\"])\n+\n+cc_library(\n+    name = \"fmt\",\n+    hdrs = glob([\"include/fmt/*.h\"]),\n+    copts = [\"-fexceptions\"],\n+    defines = [\n+        \"FMT_HEADER_ONLY=1\",\n+        \"FMT_USE_USER_DEFINED_LITERALS=0\",\n+    ],\n+    features = [\"-use_header_modules\"],\n+    includes = [\"include\"],\n+    visibility = [\"//visibility:public\"],\n+)\n+\n+cc_test(\n+    name = \"fmt_smoke_test\",\n+    srcs = [\n+        \"test/assert-test.cc\",\n+        \"test/header-only-test.cc\",\n+        \"test/test-main.cc\",\n+    ],\n+    deps = [\n+        \":fmt\",\n+        \"@com_google_googletest//:gtest\",\n+    ],\n+)"
        },
        {
            "sha": "f0038631b7205028936e08193f0c0f87081779ae",
            "filename": "third_party/xla/third_party/fmt/workspace.bzl",
            "status": "added",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Ffmt%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Ffmt%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Ffmt%2Fworkspace.bzl?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,17 @@\n+\"\"\"Provides the repository macro to import fmt.\"\"\"\n+\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n+\n+def repo():\n+    \"\"\"Imports fmt.\"\"\"\n+\n+    FMT_VERSION = \"8.1.1\"\n+    FMT_SHA256 = \"3d794d3cf67633b34b2771eb9f073bde87e846e0d395d254df7b211ef1ec7346\"\n+\n+    tf_http_archive(\n+        name = \"fmt\",\n+        sha256 = FMT_SHA256,\n+        strip_prefix = \"fmt-{version}\".format(version = FMT_VERSION),\n+        urls = tf_mirror_urls(\"https://github.com/fmtlib/fmt/archive/refs/tags/{version}.tar.gz\".format(version = FMT_VERSION)),\n+        build_file = \"//third_party/fmt:fmt.BUILD\",\n+    )"
        },
        {
            "sha": "cc558415f2b3d22e6e29586e495b47e8efc9be5a",
            "filename": "third_party/xla/third_party/kokkos/BUILD",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fkokkos%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fkokkos%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fkokkos%2FBUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1 @@\n+# copybara:uncomment package(default_applicable_licenses = [\"//third_party/tensorflow:license\"])"
        },
        {
            "sha": "ca1f7128e9a144c1911789b07609bc0cb85f8a7a",
            "filename": "third_party/xla/third_party/kokkos/kokkos.BUILD",
            "status": "added",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fkokkos%2Fkokkos.BUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fkokkos%2Fkokkos.BUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fkokkos%2Fkokkos.BUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,21 @@\n+# Kokkos C++ Performance Portability Programming Ecosystem: The Programming Model - Parallel Execution and Memory Abstraction\n+licenses([\"notice\"])  # Apache 2.0\n+\n+exports_files([\"LICENSE\"])\n+\n+cc_library(\n+    name = \"mdspan\",\n+    hdrs = glob([\"tpls/mdspan/include/**/*.hpp\"]),\n+    copts = [\"-fexceptions\"],\n+    includes = [\"tpls/mdspan/include\"],\n+    visibility = [\"//visibility:public\"],\n+)\n+\n+cc_test(\n+    name = \"smoke_test\",\n+    srcs = [\"smoke_test.cc\"],\n+    copts = [\"-fexceptions\"],\n+    deps = [\n+        \":mdspan\",\n+    ],\n+)"
        },
        {
            "sha": "3e1bed2974d7a6a7bb9db39949b13111c12508e0",
            "filename": "third_party/xla/third_party/kokkos/smoke_test.cc.patch",
            "status": "added",
            "additions": 32,
            "deletions": 0,
            "changes": 32,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fkokkos%2Fsmoke_test.cc.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fkokkos%2Fsmoke_test.cc.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fkokkos%2Fsmoke_test.cc.patch?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,32 @@\n+--- /dev/null\t2025-08-20 16:29:02.164000374 +0000\n++++ b/smoke_test.cc\t2025-08-20 21:02:15.000000000 +0000\n+@@ -0,0 +1,29 @@\n++#include <iostream>\n++#include <mdspan/mdspan.hpp>\n++\n++int main() {\n++  constexpr size_t N = 3, M = 4;\n++\n++  // Flattened storage\n++  double data[N * M] = {1.0, 2.0, 3.0, 4.0,  5.0,  6.0,\n++                        7.0, 8.0, 9.0, 10.0, 11.0, 12.0};\n++\n++  // Create mdspan over flat data\n++  Kokkos::mdspan<double, Kokkos::extents<size_t, N, M>> view(data);\n++\n++  // Access elements\n++  std::cout << \"Original array via mdspan:\\n\";\n++  for (size_t i = 0; i < N; ++i) {\n++    for (size_t j = 0; j < M; ++j) {\n++      std::cout << view(i, j) << \" \";\n++    }\n++    std::cout << \"\\n\";\n++  }\n++\n++  // Modify a value\n++  view(1, 2) = 42.0;\n++  std::cout << \"\\nAfter modification:\\n\";\n++  std::cout << \"view(1,2) = \" << view(1, 2) << \"\\n\";\n++\n++  return 0;\n++}"
        },
        {
            "sha": "7929cc751ceb18b2e9de10f31a7f889a8389e2e5",
            "filename": "third_party/xla/third_party/kokkos/workspace.bzl",
            "status": "added",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fkokkos%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fkokkos%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fkokkos%2Fworkspace.bzl?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,18 @@\n+\"\"\"Provides the repository macro to import kokkos.\"\"\"\n+\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n+\n+def repo():\n+    \"\"\"Imports kokkos.\"\"\"\n+\n+    KOKKOS_VERSION = \"4.4.01\"\n+    KOKKOS_SHA256 = \"3f7096d17eaaa4004c7497ac082bf1ae3ff47b5104149e54af021a89414c3682\"\n+\n+    tf_http_archive(\n+        name = \"kokkos\",\n+        sha256 = KOKKOS_SHA256,\n+        strip_prefix = \"kokkos-{version}\".format(version = KOKKOS_VERSION),\n+        urls = tf_mirror_urls(\"https://github.com/kokkos/kokkos/archive/refs/tags/{version}.tar.gz\".format(version = KOKKOS_VERSION)),\n+        build_file = \"//third_party/kokkos:kokkos.BUILD\",\n+        patch_file = [\"//third_party/kokkos:smoke_test.cc.patch\"],\n+    )"
        },
        {
            "sha": "cc558415f2b3d22e6e29586e495b47e8efc9be5a",
            "filename": "third_party/xla/third_party/raft/BUILD",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fraft%2FBUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1 @@\n+# copybara:uncomment package(default_applicable_licenses = [\"//third_party/tensorflow:license\"])"
        },
        {
            "sha": "fff854a35a94e274b392185d9f6292cecefe0e18",
            "filename": "third_party/xla/third_party/raft/logger_macros.hpp.patch",
            "status": "added",
            "additions": 70,
            "deletions": 0,
            "changes": 70,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Flogger_macros.hpp.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Flogger_macros.hpp.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fraft%2Flogger_macros.hpp.patch?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,70 @@\n+--- /dev/null\n++++ b/cpp/include/raft/core/logger_macros.hpp\n+@@ -0,0 +1,67 @@\n++/*\n++ * Copyright (c) 2025, NVIDIA CORPORATION.\n++ *\n++ * Licensed under the Apache License, Version 2.0 (the \"License\");\n++ * you may not use this file except in compliance with the License.\n++ * You may obtain a copy of the License at\n++ *\n++ *     http://www.apache.org/licenses/LICENSE-2.0\n++ *\n++ * Unless required by applicable law or agreed to in writing, software\n++ * distributed under the License is distributed on an \"AS IS\" BASIS,\n++ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n++ * See the License for the specific language governing permissions and\n++ * limitations under the License.\n++ */\n++\n++#pragma once\n++\n++#include <rapids_logger/log_levels.h>\n++\n++// Default to info level if not specified.\n++#if !defined(RAFT_LOG_ACTIVE_LEVEL)\n++#define RAFT_LOG_ACTIVE_LEVEL RAPIDS_LOGGER_LOG_LEVEL_INFO\n++#endif\n++\n++// Macros for easier logging, similar to spdlog.\n++#define RAFT_LOGGER_CALL(logger, level, ...) (logger).log(level, __VA_ARGS__)\n++\n++#if RAFT_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_TRACE\n++#define RAFT_LOG_TRACE(...) \\\n++  RAFT_LOGGER_CALL(raft::default_logger(), rapids_logger::level_enum::trace, __VA_ARGS__)\n++#else\n++#define RAFT_LOG_TRACE(...) (void)0\n++#endif\n++\n++#if RAFT_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_DEBUG\n++#define RAFT_LOG_DEBUG(...) \\\n++  RAFT_LOGGER_CALL(raft::default_logger(), rapids_logger::level_enum::debug, __VA_ARGS__)\n++#else\n++#define RAFT_LOG_DEBUG(...) (void)0\n++#endif\n++\n++#if RAFT_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_INFO\n++#define RAFT_LOG_INFO(...) RAFT_LOGGER_CALL(raft::default_logger(), rapids_logger::level_enum::info, __VA_ARGS__)\n++#else\n++#define RAFT_LOG_INFO(...) (void)0\n++#endif\n++\n++#if RAFT_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_WARN\n++#define RAFT_LOG_WARN(...) RAFT_LOGGER_CALL(raft::default_logger(), rapids_logger::level_enum::warn, __VA_ARGS__)\n++#else\n++#define RAFT_LOG_WARN(...) (void)0\n++#endif\n++\n++#if RAFT_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_ERROR\n++#define RAFT_LOG_ERROR(...) \\\n++  RAFT_LOGGER_CALL(raft::default_logger(), rapids_logger::level_enum::error, __VA_ARGS__)\n++#else\n++#define RAFT_LOG_ERROR(...) (void)0\n++#endif\n++\n++#if RAFT_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_CRITICAL\n++#define RAFT_LOG_CRITICAL(...) \\\n++  RAFT_LOGGER_CALL(raft::default_logger(), rapids_logger::level_enum::critical, __VA_ARGS__)\n++#else\n++#define RAFT_LOG_CRITICAL(...) (void)0\n++#endif"
        },
        {
            "sha": "b93de29dcc1c6fa0176329cc0e3821b02cf4d5e4",
            "filename": "third_party/xla/third_party/raft/raft.BUILD",
            "status": "added",
            "additions": 70,
            "deletions": 0,
            "changes": 70,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fraft.BUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fraft.BUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fraft%2Fraft.BUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,70 @@\n+load(\"@local_config_cuda//cuda:build_defs.bzl\", \"cuda_library\")\n+\n+licenses([\"notice\"])  # Apache 2.0\n+\n+exports_files([\"LICENSE\"])\n+\n+BASE_COPTS = [\n+    \"-fexceptions\",\n+    \"-Wno-unused-variable\",\n+    \"-Wno-ctad-maybe-unsupported\",\n+    \"-Wno-reorder-ctor\",\n+    \"-Wno-non-virtual-dtor\",\n+    \"-Wno-uninitialized\",\n+    \"-Wno-pass-failed\",\n+    \"-DLIBCUDACXX_ENABLE_EXPERIMENTAL_MEMORY_RESOURCE\",\n+    \"-DRAFT_SYSTEM_LITTLE_ENDIAN\",\n+]\n+\n+cuda_library(\n+    name = \"raft_matrix\",\n+    srcs = glob([\n+        \"cpp/include/raft/core/detail/*.hpp\",\n+        \"cpp/include/raft/core/resource/detail/*.hpp\",\n+        \"cpp/include/raft/linalg/detail/*.hpp\",\n+        \"cpp/include/raft/matrix/detail/*.hpp\",\n+        \"cpp/include/raft/util/detail/*.hpp\",\n+    ]),\n+    hdrs = glob([\n+        \"cpp/include/raft/core/*.hpp\",\n+        \"cpp/include/raft/core/resource/*.hpp\",\n+        \"cpp/include/raft/linalg/*.hpp\",\n+        \"cpp/include/raft/matrix/*.hpp\",\n+        \"cpp/include/raft/util/*.hpp\",\n+    ]),\n+    copts = BASE_COPTS,\n+    includes = [\"cpp/include\"],\n+    textual_hdrs = glob([\n+        \"cpp/include/raft/core/**/*.cuh\",\n+        \"cpp/include/raft/linalg/**/*.cuh\",\n+        \"cpp/include/raft/matrix/**/*.cuh\",\n+        \"cpp/include/raft/util/**/*.cuh\",\n+    ]),\n+    visibility = [\"//visibility:public\"],\n+    deps = [\n+        \"@kokkos//:mdspan\",\n+        \"@rapids_logger\",\n+        \"@rmm\",\n+    ],\n+)\n+\n+cuda_library(\n+    name = \"select_k_runner\",\n+    srcs = [\"select_k_runner.cu.cc\"],\n+    hdrs = [\"select_k_runner.hpp\"],\n+    copts = BASE_COPTS,\n+    visibility = [\"//visibility:public\"],\n+    deps = [\n+        \":raft_matrix\",\n+    ],\n+)\n+\n+cc_test(\n+    name = \"select_k_smoke_test\",\n+    srcs = [\"select_k_smoke_test.cu.cc\"],\n+    copts = BASE_COPTS,\n+    deps = [\n+        \":select_k_runner\",\n+        \"@com_google_googletest//:gtest_main\",\n+    ],\n+)"
        },
        {
            "sha": "0dd9d16b649c5ab811ed733c62af7192a4f960b8",
            "filename": "third_party/xla/third_party/raft/select_k_runner.cu.cc.patch",
            "status": "added",
            "additions": 36,
            "deletions": 0,
            "changes": 36,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fselect_k_runner.cu.cc.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fselect_k_runner.cu.cc.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fraft%2Fselect_k_runner.cu.cc.patch?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,36 @@\n+--- /dev/null\t2025-08-20 16:29:02.164000374 +0000\n++++ b/select_k_runner.cu.cc\t2025-08-20 20:47:12.000000000 +0000\n+@@ -0,0 +1,33 @@\n++#include <cstdint>\n++#include <optional>\n++\n++#include \"raft/core/resources.hpp\"\n++#include \"raft/matrix/select_k.cuh\"\n++\n++namespace myraft {\n++\n++// Simple wrapper around raft::matrix::select_k\n++void run_select_k(raft::resources const& res, const float* d_data_in,\n++                  float* d_data_out, std::uint32_t* d_indices_out,\n++                  std::uint32_t batch, std::uint32_t n, std::uint32_t k,\n++                  bool select_min, bool sorted) {\n++  auto input_view =\n++      raft::make_device_matrix_view<const float, uint32_t, raft::row_major>(\n++          d_data_in, batch, n);\n++\n++  auto output_values_view =\n++      raft::make_device_matrix_view<float, uint32_t, raft::row_major>(\n++          d_data_out, batch, k);\n++\n++  auto output_indices_view =\n++      raft::make_device_matrix_view<uint32_t, uint32_t, raft::row_major>(\n++          d_indices_out, batch, k);\n++\n++  raft::matrix::SelectAlgo algo = raft::matrix::SelectAlgo::kWarpDistributedShm;\n++\n++  raft::matrix::select_k<float, uint32_t>(\n++      res, input_view, std::nullopt, output_values_view, output_indices_view,\n++      select_min, sorted, algo);\n++}\n++\n++}  // namespace myraft"
        },
        {
            "sha": "d8ed11d7103f0020f853bddbe8ac30e9835bfee3",
            "filename": "third_party/xla/third_party/raft/select_k_runner.hpp.patch",
            "status": "added",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fselect_k_runner.hpp.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fselect_k_runner.hpp.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fraft%2Fselect_k_runner.hpp.patch?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,17 @@\n+--- /dev/null\t2025-08-20 16:29:02.164000374 +0000\n++++ b/select_k_runner.hpp\t2025-08-20 20:47:22.000000000 +0000\n+@@ -0,0 +1,14 @@\n++#pragma once\n++\n++#include <cstdint>\n++\n++#include \"raft/core/resources.hpp\"\n++\n++namespace myraft {\n++\n++void run_select_k(raft::resources const& res, const float* d_data_in,\n++                  float* d_data_out, std::uint32_t* d_indices_out,\n++                  std::uint32_t batch, std::uint32_t n, std::uint32_t k,\n++                  bool select_min, bool sorted);\n++\n++}  // namespace myraft"
        },
        {
            "sha": "b82906656d6ad5cb6121879edf9393c8a0e4975b",
            "filename": "third_party/xla/third_party/raft/select_k_smoke_test.cu.cc.patch",
            "status": "added",
            "additions": 44,
            "deletions": 0,
            "changes": 44,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fselect_k_smoke_test.cu.cc.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fselect_k_smoke_test.cu.cc.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fraft%2Fselect_k_smoke_test.cu.cc.patch?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,44 @@\n+--- /dev/null\t2025-08-20 16:29:02.164000374 +0000\n++++ b/select_k_smoke_test.cu.cc\t2025-08-20 20:54:24.000000000 +0000\n+@@ -0,0 +1,41 @@\n++#include <cuda_runtime.h>\n++#include <gtest/gtest.h>\n++\n++#include \"select_k_runner.hpp\"\n++\n++TEST(SelectKWrapperTest, BasicTopK) {\n++  raft::resources res;\n++\n++  const uint32_t batch = 8;\n++  const uint32_t n = 8192;\n++  const uint32_t k = 16;\n++\n++  float* d_data_in = nullptr;\n++  float* d_data_out = nullptr;\n++  uint32_t* d_indices_out = nullptr;\n++\n++  ASSERT_EQ(cudaMalloc(&d_data_in, batch * n * sizeof(float)), cudaSuccess);\n++  ASSERT_EQ(cudaMalloc(&d_data_out, batch * k * sizeof(float)), cudaSuccess);\n++  ASSERT_EQ(cudaMalloc(&d_indices_out, batch * k * sizeof(uint32_t)),\n++            cudaSuccess);\n++\n++  // host input: 0..n-1\n++  std::vector<float> h_data_in(batch * n);\n++  for (uint32_t row = 0; row < batch; ++row) {\n++    for (uint32_t col = 0; col < n; ++col) {\n++      h_data_in[row * n + col] = static_cast<float>(col);\n++    }\n++  }\n++  ASSERT_EQ(\n++      cudaMemcpy(d_data_in, h_data_in.data(), h_data_in.size() * sizeof(float),\n++                 cudaMemcpyHostToDevice),\n++      cudaSuccess);\n++\n++  // call wrapper\n++  myraft::run_select_k(res, d_data_in, d_data_out, d_indices_out, batch, n, k,\n++                       /*select_min=*/false, /*sorted=*/true);\n++\n++  cudaFree(d_data_in);\n++  cudaFree(d_data_out);\n++  cudaFree(d_indices_out);\n++}"
        },
        {
            "sha": "b0e3f6ed91f1ec959a232688b8aa5207590aaa21",
            "filename": "third_party/xla/third_party/raft/workspace.bzl",
            "status": "added",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fraft%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fraft%2Fworkspace.bzl?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,23 @@\n+\"\"\"Provides the repository macro to import raft.\"\"\"\n+\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n+\n+def repo():\n+    \"\"\"Imports raft.\"\"\"\n+\n+    RAFT_VERSION = \"25.08.00\"\n+    RAFT_SHA256 = \"032dce57b297e121352a1556bd9021410be30fcf319e158592f615e1990b2e58\"\n+\n+    tf_http_archive(\n+        name = \"raft\",\n+        sha256 = RAFT_SHA256,\n+        strip_prefix = \"raft-{version}\".format(version = RAFT_VERSION),\n+        urls = tf_mirror_urls(\"https://github.com/rapidsai/raft/archive/refs/tags/v{version}.tar.gz\".format(version = RAFT_VERSION)),\n+        build_file = \"//third_party/raft:raft.BUILD\",\n+        patch_file = [\n+            \"//third_party/raft:logger_macros.hpp.patch\",\n+            \"//third_party/raft:select_k_runner.hpp.patch\",\n+            \"//third_party/raft:select_k_runner.cu.cc.patch\",\n+            \"//third_party/raft:select_k_smoke_test.cu.cc.patch\",\n+        ],\n+    )"
        },
        {
            "sha": "cc558415f2b3d22e6e29586e495b47e8efc9be5a",
            "filename": "third_party/xla/third_party/rapids_logger/BUILD",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frapids_logger%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frapids_logger%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Frapids_logger%2FBUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1 @@\n+# copybara:uncomment package(default_applicable_licenses = [\"//third_party/tensorflow:license\"])"
        },
        {
            "sha": "dc0a5c2046eb33361563a842830d7a812516b2c9",
            "filename": "third_party/xla/third_party/rapids_logger/rapids_logger.BUILD",
            "status": "added",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frapids_logger%2Frapids_logger.BUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frapids_logger%2Frapids_logger.BUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Frapids_logger%2Frapids_logger.BUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,30 @@\n+# The rapids-logger project defines an easy way to produce a project-specific logger using the excellent spdlog package\n+licenses([\"notice\"])  # Apache 2.0\n+\n+exports_files([\"LICENSE\"])\n+\n+cc_library(\n+    name = \"rapids_logger\",\n+    srcs = [\"src/logger.cpp\"],\n+    hdrs = glob([\"include/rapids_logger/*.h*\"]),\n+    copts = [\n+        \"-std=c++17\",\n+        \"-fexceptions\",\n+    ],\n+    features = [\"-use_header_modules\"],\n+    includes = [\"include\"],\n+    visibility = [\"//visibility:public\"],\n+    deps = [\n+        \"@spdlog\",\n+    ],\n+)\n+\n+cc_test(\n+    name = \"smoke_test\",\n+    srcs = [\"smoke_test.cc\"],\n+    deps = [\n+        \":rapids_logger\",\n+        \"@com_google_googletest//:gtest\",\n+        \"@com_google_googletest//:gtest_main\",\n+    ],\n+)"
        },
        {
            "sha": "781ee83cd418c05b90f31bf5c0061817c1bcc83b",
            "filename": "third_party/xla/third_party/rapids_logger/smoke_test.cc.patch",
            "status": "added",
            "additions": 41,
            "deletions": 0,
            "changes": 41,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frapids_logger%2Fsmoke_test.cc.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frapids_logger%2Fsmoke_test.cc.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Frapids_logger%2Fsmoke_test.cc.patch?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,41 @@\n+--- /dev/null\t2025-08-20 16:29:02.164000374 +0000\n++++ b/smoke_test.cc\t2025-08-20 21:00:53.000000000 +0000\n+@@ -0,0 +1,38 @@\n++#include <gtest/gtest.h>\n++\n++#include <memory>\n++#include <sstream>\n++#include <string>\n++\n++#include \"rapids_logger/logger.hpp\"\n++\n++struct LoggerTest : public ::testing::Test {\n++  LoggerTest()\n++      : oss{},\n++        logger_{\"logger_test\",\n++                {std::make_shared<rapids_logger::ostream_sink_mt>(oss)}} {\n++    // Remove extra formatting to simplify validation of outputs.\n++    logger_.set_pattern(\"%v\");\n++  }\n++\n++  void clear_sink() { oss.str(\"\"); }\n++  std::string sink_content() { return oss.str(); }\n++\n++  std::ostringstream oss;\n++  rapids_logger::logger logger_;\n++};\n++\n++TEST_F(LoggerTest, DefaultLevel) {\n++  // The default level should not change without suitable warning to consumers.\n++  EXPECT_EQ(logger_.level(), rapids_logger::level_enum::info);\n++}\n++\n++TEST_F(LoggerTest, DefaultLevelLogs) {\n++  logger_.trace(\"trace\");\n++  logger_.debug(\"debug\");\n++  logger_.info(\"info\");\n++  logger_.warn(\"warn\");\n++  logger_.error(\"error\");\n++  logger_.critical(\"critical\");\n++  EXPECT_EQ(this->sink_content(), \"info\\nwarn\\nerror\\ncritical\\n\");\n++}"
        },
        {
            "sha": "929d99382fa178b6c2adcea6cf74abf3dbafd585",
            "filename": "third_party/xla/third_party/rapids_logger/workspace.bzl",
            "status": "added",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frapids_logger%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frapids_logger%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Frapids_logger%2Fworkspace.bzl?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,18 @@\n+\"\"\"Provides the repository macro to import rapids_logger.\"\"\"\n+\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n+\n+def repo():\n+    \"\"\"Imports rapids_logger.\"\"\"\n+\n+    RAPIDS_LOGGER_VERSION = \"0.1.1\"\n+    RAPIDS_LOGGER_SHA256 = \"9ef22efcc3e00affed254bf12b52c6775050bb55e93e010067c2fcd9620163c9\"\n+\n+    tf_http_archive(\n+        name = \"rapids_logger\",\n+        sha256 = RAPIDS_LOGGER_SHA256,\n+        strip_prefix = \"rapids-logger-{version}\".format(version = RAPIDS_LOGGER_VERSION),\n+        urls = tf_mirror_urls(\"https://github.com/rapidsai/rapids-logger/archive/refs/tags/v{version}.tar.gz\".format(version = RAPIDS_LOGGER_VERSION)),\n+        build_file = \"//third_party/rapids_logger:rapids_logger.BUILD\",\n+        patch_file = [\"//third_party/rapids_logger:smoke_test.cc.patch\"],\n+    )"
        },
        {
            "sha": "cc558415f2b3d22e6e29586e495b47e8efc9be5a",
            "filename": "third_party/xla/third_party/rmm/BUILD",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frmm%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frmm%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Frmm%2FBUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1 @@\n+# copybara:uncomment package(default_applicable_licenses = [\"//third_party/tensorflow:license\"])"
        },
        {
            "sha": "e0b437b221bbb2e0a8c467347df065f2f77cd67a",
            "filename": "third_party/xla/third_party/rmm/logger_macros.hpp.patch",
            "status": "added",
            "additions": 70,
            "deletions": 0,
            "changes": 70,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frmm%2Flogger_macros.hpp.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frmm%2Flogger_macros.hpp.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Frmm%2Flogger_macros.hpp.patch?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,70 @@\n+--- /dev/null\n++++ b/cpp/include/rmm/logger_macros.hpp\n+@@ -0,0 +1,67 @@\n++/*\n++ * Copyright (c) 2025, NVIDIA CORPORATION.\n++ *\n++ * Licensed under the Apache License, Version 2.0 (the \"License\");\n++ * you may not use this file except in compliance with the License.\n++ * You may obtain a copy of the License at\n++ *\n++ *     http://www.apache.org/licenses/LICENSE-2.0\n++ *\n++ * Unless required by applicable law or agreed to in writing, software\n++ * distributed under the License is distributed on an \"AS IS\" BASIS,\n++ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n++ * See the License for the specific language governing permissions and\n++ * limitations under the License.\n++ */\n++\n++#pragma once\n++\n++#include <rapids_logger/log_levels.h>\n++\n++// Default to info level if not specified.\n++#if !defined(RMM_LOG_ACTIVE_LEVEL)\n++#define RMM_LOG_ACTIVE_LEVEL RAPIDS_LOGGER_LOG_LEVEL_INFO\n++#endif\n++\n++// Macros for easier logging, similar to spdlog.\n++#define RMM_LOGGER_CALL(logger, level, ...) (logger).log(level, __VA_ARGS__)\n++\n++#if RMM_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_TRACE\n++#define RMM_LOG_TRACE(...) \\\n++  RMM_LOGGER_CALL(rmm::default_logger(), rapids_logger::level_enum::trace, __VA_ARGS__)\n++#else\n++#define RMM_LOG_TRACE(...) (void)0\n++#endif\n++\n++#if RMM_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_DEBUG\n++#define RMM_LOG_DEBUG(...) \\\n++  RMM_LOGGER_CALL(rmm::default_logger(), rapids_logger::level_enum::debug, __VA_ARGS__)\n++#else\n++#define RMM_LOG_DEBUG(...) (void)0\n++#endif\n++\n++#if RMM_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_INFO\n++#define RMM_LOG_INFO(...) RMM_LOGGER_CALL(rmm::default_logger(), rapids_logger::level_enum::info, __VA_ARGS__)\n++#else\n++#define RMM_LOG_INFO(...) (void)0\n++#endif\n++\n++#if RMM_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_WARN\n++#define RMM_LOG_WARN(...) RMM_LOGGER_CALL(rmm::default_logger(), rapids_logger::level_enum::warn, __VA_ARGS__)\n++#else\n++#define RMM_LOG_WARN(...) (void)0\n++#endif\n++\n++#if RMM_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_ERROR\n++#define RMM_LOG_ERROR(...) \\\n++  RMM_LOGGER_CALL(rmm::default_logger(), rapids_logger::level_enum::error, __VA_ARGS__)\n++#else\n++#define RMM_LOG_ERROR(...) (void)0\n++#endif\n++\n++#if RMM_LOG_ACTIVE_LEVEL <= RAPIDS_LOGGER_LOG_LEVEL_CRITICAL\n++#define RMM_LOG_CRITICAL(...) \\\n++  RMM_LOGGER_CALL(rmm::default_logger(), rapids_logger::level_enum::critical, __VA_ARGS__)\n++#else\n++#define RMM_LOG_CRITICAL(...) (void)0\n++#endif"
        },
        {
            "sha": "6bbe135e20c711f73727a412ccc2a36dd9453c5a",
            "filename": "third_party/xla/third_party/rmm/rmm.BUILD",
            "status": "added",
            "additions": 44,
            "deletions": 0,
            "changes": 44,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frmm%2Frmm.BUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frmm%2Frmm.BUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Frmm%2Frmm.BUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,44 @@\n+load(\"@local_config_cuda//cuda:build_defs.bzl\", \"cuda_library\")\n+\n+licenses([\"notice\"])  # Apache 2.0\n+\n+exports_files([\"LICENSE\"])\n+\n+BASE_COPTS = [\n+    \"-Wno-unused-result\",\n+    \"-Wno-ctad-maybe-unsupported\",\n+    \"-Wno-self-move\",\n+    \"-Wno-pragma-once-outside-header\",\n+    \"-fexceptions\",\n+    \"-DLIBCUDACXX_ENABLE_EXPERIMENTAL_MEMORY_RESOURCE\",\n+]\n+\n+cuda_library(\n+    name = \"rmm\",\n+    srcs = glob([\n+        \"cpp/src/*.cpp\",\n+    ]),\n+    copts = BASE_COPTS,\n+    features = [\"-use_header_modules\"],\n+    includes = [\"cpp/include\"],\n+    textual_hdrs = glob([\n+        \"cpp/include/rmm/**/*.h\",\n+        \"cpp/include/rmm/**/*.hpp\",\n+    ]),\n+    visibility = [\"//visibility:public\"],\n+    deps = [\n+        \"@local_config_cuda//cuda:cuda_headers\",\n+        \"@local_config_cuda//cuda:cudart\",\n+        \"@rapids_logger\",\n+    ],\n+)\n+\n+cc_test(\n+    name = \"cuda_stream_tests\",\n+    srcs = [\"cpp/tests/cuda_stream_tests.cpp\"],\n+    copts = BASE_COPTS,\n+    deps = [\n+        \":rmm\",\n+        \"@com_google_googletest//:gtest_main\",\n+    ],\n+)"
        },
        {
            "sha": "357b9d5123286e66765f04ef1c99445ee3147fa9",
            "filename": "third_party/xla/third_party/rmm/workspace.bzl",
            "status": "added",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frmm%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Frmm%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Frmm%2Fworkspace.bzl?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,18 @@\n+\"\"\"Provides the repository macro to import rmm.\"\"\"\n+\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n+\n+def repo():\n+    \"\"\"Imports rmm.\"\"\"\n+\n+    RMM_VERSION = \"25.08.00\"\n+    RMM_SHA256 = \"6931f4de923b617af8c3b97505d79fd3b7b6b5492c1b5a8cd8bcfdc147cdf458\"\n+\n+    tf_http_archive(\n+        name = \"rmm\",\n+        sha256 = RMM_SHA256,\n+        strip_prefix = \"rmm-{version}\".format(version = RMM_VERSION),\n+        urls = tf_mirror_urls(\"https://github.com/rapidsai/rmm/archive/refs/tags/v{version}.tar.gz\".format(version = RMM_VERSION)),\n+        build_file = \"//third_party/rmm:rmm.BUILD\",\n+        patch_file = [\"//third_party/rmm:logger_macros.hpp.patch\"],\n+    )"
        },
        {
            "sha": "cc558415f2b3d22e6e29586e495b47e8efc9be5a",
            "filename": "third_party/xla/third_party/spdlog/BUILD",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fspdlog%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fspdlog%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fspdlog%2FBUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1 @@\n+# copybara:uncomment package(default_applicable_licenses = [\"//third_party/tensorflow:license\"])"
        },
        {
            "sha": "a6f33fd4cc7c08730d6226dee7dca39ece8def6b",
            "filename": "third_party/xla/third_party/spdlog/smoke_test.cc.patch",
            "status": "added",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fspdlog%2Fsmoke_test.cc.patch",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fspdlog%2Fsmoke_test.cc.patch",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fspdlog%2Fsmoke_test.cc.patch?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,30 @@\n+--- /dev/null\n++++ b/smoke_test.cc\n+@@ -0,0 +1,27 @@\n++#include \"spdlog/spdlog.h\"\n++#include \"spdlog/sinks/basic_file_sink.h\"\n++#include <iostream>\n++\n++int main() {\n++  try {\n++    // Log to stdout\n++    spdlog::info(\"Hello from spdlog smoke test!\");\n++\n++    // Log with formatting\n++    int answer = 42;\n++    spdlog::warn(\"The answer is {}\", answer);\n++\n++    // Create a file logger\n++    auto file_logger = spdlog::basic_logger_mt(\"file_logger\", \"smoke_test.log\");\n++    file_logger->info(\"Logging to a file from smoke test\");\n++\n++    // Flush and shutdown\n++    spdlog::shutdown();\n++\n++    std::cout << \"spdlog smoke test passed.\" << std::endl;\n++    return 0;  // success\n++  } catch (const spdlog::spdlog_ex& ex) {\n++    std::cerr << \"spdlog smoke test failed: \" << ex.what() << std::endl;\n++    return 1;  // failure\n++  }\n++}"
        },
        {
            "sha": "61d56ec3b7ff3efe04f91e3be619e852c3ea1367",
            "filename": "third_party/xla/third_party/spdlog/spdlog.BUILD",
            "status": "added",
            "additions": 34,
            "deletions": 0,
            "changes": 34,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fspdlog%2Fspdlog.BUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fspdlog%2Fspdlog.BUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fspdlog%2Fspdlog.BUILD?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,34 @@\n+# Fast C++ logging library. Header-only.\n+licenses([\"notice\"])  # MIT\n+\n+exports_files([\"LICENSE\"])\n+\n+cc_library(\n+    name = \"spdlog\",\n+    hdrs = glob([\"include/spdlog/**/*.h\"]),\n+    defines = [\n+        \"SPDLOG_FMT_EXTERNAL\",\n+    ],\n+    features = [\"-parse_headers\"],\n+    includes = [\"include\"],\n+    visibility = [\"//visibility:public\"],\n+    deps = [\n+        \"@com_google_absl//absl/container:node_hash_map\",\n+        \"@fmt\",\n+    ],\n+)\n+\n+cc_test(\n+    name = \"smoke_test\",\n+    srcs = [\n+        \"smoke_test.cc\",  # lightweight test file\n+    ],\n+    copts = [\n+        \"-DSPDLOG_FMT_EXTERNAL\",\n+        \"-fexceptions\",\n+    ],\n+    deps = [\n+        \":spdlog\",\n+        \"@fmt\",\n+    ],\n+)"
        },
        {
            "sha": "813777ed3fb80d45a89a499f971f4551a6bc0f92",
            "filename": "third_party/xla/third_party/spdlog/workspace.bzl",
            "status": "added",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fspdlog%2Fworkspace.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fthird_party%2Fspdlog%2Fworkspace.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fthird_party%2Fspdlog%2Fworkspace.bzl?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -0,0 +1,18 @@\n+\"\"\"Provides the repository macro to import spdlog.\"\"\"\n+\n+load(\"//third_party:repo.bzl\", \"tf_http_archive\", \"tf_mirror_urls\")\n+\n+def repo():\n+    \"\"\"Imports spdlog.\"\"\"\n+\n+    SPDLOG_VERSION = \"1.15.2\"\n+    SPDLOG_SHA256 = \"7a80896357f3e8e920e85e92633b14ba0f229c506e6f978578bdc35ba09e9a5d\"\n+\n+    tf_http_archive(\n+        name = \"spdlog\",\n+        sha256 = SPDLOG_SHA256,\n+        strip_prefix = \"spdlog-{version}\".format(version = SPDLOG_VERSION),\n+        urls = tf_mirror_urls(\"https://github.com/gabime/spdlog/archive/refs/tags/v{version}.tar.gz\".format(version = SPDLOG_VERSION)),\n+        build_file = \"//third_party/spdlog:spdlog.BUILD\",\n+        patch_file = [\"//third_party/spdlog:smoke_test.cc.patch\"],\n+    )"
        },
        {
            "sha": "608e865e15e52b743b047ae1f0711d674f5e3233",
            "filename": "third_party/xla/workspace2.bzl",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fworkspace2.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/84c50c32010849b49ed6dd6765aa218fac8920e3/third_party%2Fxla%2Fworkspace2.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fworkspace2.bzl?ref=84c50c32010849b49ed6dd6765aa218fac8920e3",
            "patch": "@@ -12,6 +12,7 @@ load(\"//third_party/dlpack:workspace.bzl\", dlpack = \"repo\")\n load(\"//third_party/ducc:workspace.bzl\", ducc = \"repo\")\n load(\"//third_party/eigen3:workspace.bzl\", eigen3 = \"repo\")\n load(\"//third_party/farmhash:workspace.bzl\", farmhash = \"repo\")\n+load(\"//third_party/fmt:workspace.bzl\", fmt = \"repo\")\n load(\"//third_party/FP16:workspace.bzl\", FP16 = \"repo\")\n load(\"//third_party/gemmlowp:workspace.bzl\", gemmlowp = \"repo\")\n load(\"//third_party/git:git_configure.bzl\", \"git_configure\")\n@@ -21,6 +22,7 @@ load(\"//third_party/gpus:sycl_configure.bzl\", \"sycl_configure\")\n load(\"//third_party/highwayhash:workspace.bzl\", highwayhash = \"repo\")\n load(\"//third_party/hwloc:workspace.bzl\", hwloc = \"repo\")\n load(\"//third_party/implib_so:workspace.bzl\", implib_so = \"repo\")\n+load(\"//third_party/kokkos:workspace.bzl\", kokkos = \"repo\")\n load(\"//third_party/llvm:workspace.bzl\", llvm = \"repo\")\n load(\"//third_party/mpitrampoline:workspace.bzl\", mpitrampoline = \"repo\")\n load(\"//third_party/nanobind:workspace.bzl\", nanobind = \"repo\")\n@@ -30,8 +32,12 @@ load(\"//third_party/py:python_configure.bzl\", \"python_configure\")\n load(\"//third_party/py/ml_dtypes:workspace.bzl\", ml_dtypes = \"repo\")\n load(\"//third_party/pybind11_abseil:workspace.bzl\", pybind11_abseil = \"repo\")\n load(\"//third_party/pybind11_bazel:workspace.bzl\", pybind11_bazel = \"repo\")\n+load(\"//third_party/raft:workspace.bzl\", raft = \"repo\")\n+load(\"//third_party/rapids_logger:workspace.bzl\", rapids_logger = \"repo\")\n+load(\"//third_party/rmm:workspace.bzl\", rmm = \"repo\")\n load(\"//third_party/robin_map:workspace.bzl\", robin_map = \"repo\")\n load(\"//third_party/shardy:workspace.bzl\", shardy = \"repo\")\n+load(\"//third_party/spdlog:workspace.bzl\", spdlog = \"repo\")\n load(\"//third_party/stablehlo:workspace.bzl\", stablehlo = \"repo\")\n load(\"//third_party/tensorrt:tensorrt_configure.bzl\", \"tensorrt_configure\")\n load(\"//third_party/tensorrt:workspace.bzl\", tensorrt = \"repo\")\n@@ -54,20 +60,26 @@ def _initialize_third_party():\n     ducc()\n     eigen3()\n     farmhash()\n+    fmt()\n     gemmlowp()\n     gloo()\n     highwayhash()\n     hwloc()\n     implib_so()\n+    kokkos()\n     ml_dtypes()\n     mpitrampoline()\n     nanobind()\n     nasm()\n     nvshmem()\n     pybind11_abseil()\n     pybind11_bazel()\n+    raft()\n+    rapids_logger()\n+    rmm()\n     robin_map()\n     shardy()\n+    spdlog()\n     stablehlo()\n     tensorrt()\n     triton()"
        }
    ],
    "stats": {
        "total": 699,
        "additions": 699,
        "deletions": 0
    }
}