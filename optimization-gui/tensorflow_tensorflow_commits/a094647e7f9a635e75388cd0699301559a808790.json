{
    "author": "apivovarov",
    "message": "Clean XLA service CompilationCache.\n\nThis change includes:\n-   Adding necessary includes and removing unused ones in compilation_cache.cc and compilation_cache.h.\n-   Removing an unnecessary else block in CompilationCache::Lookup.\n-   Using `= default` for the default constructor of CompilationCache.\n\nPiperOrigin-RevId: 840604067",
    "sha": "a094647e7f9a635e75388cd0699301559a808790",
    "files": [
        {
            "sha": "adfe23c292272bde269e871557fecdd00d383ccb",
            "filename": "third_party/xla/xla/service/BUILD",
            "status": "modified",
            "additions": 5,
            "deletions": 4,
            "changes": 9,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a094647e7f9a635e75388cd0699301559a808790/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a094647e7f9a635e75388cd0699301559a808790/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2FBUILD?ref=a094647e7f9a635e75388cd0699301559a808790",
            "patch": "@@ -3556,13 +3556,14 @@ cc_library(\n     hdrs = [\"compilation_cache.h\"],\n     deps = [\n         \":executable\",\n-        \":hlo_module_config\",\n-        \"//xla:types\",\n         \"//xla:util\",\n         \"//xla:xla_data_proto_cc\",\n+        \"@com_google_absl//absl/base:core_headers\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n-        \"@local_tsl//tsl/platform:logging\",\n-        \"@local_tsl//tsl/platform:strcat\",\n+        \"@com_google_absl//absl/log\",\n+        \"@com_google_absl//absl/log:check\",\n+        \"@com_google_absl//absl/status:statusor\",\n+        \"@com_google_absl//absl/synchronization\",\n     ],\n )\n "
        },
        {
            "sha": "9d163264b42ca296012a7141516ed3d4932044c6",
            "filename": "third_party/xla/xla/service/compilation_cache.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 7,
            "changes": 18,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a094647e7f9a635e75388cd0699301559a808790/third_party%2Fxla%2Fxla%2Fservice%2Fcompilation_cache.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a094647e7f9a635e75388cd0699301559a808790/third_party%2Fxla%2Fxla%2Fservice%2Fcompilation_cache.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcompilation_cache.cc?ref=a094647e7f9a635e75388cd0699301559a808790",
            "patch": "@@ -15,13 +15,18 @@ limitations under the License.\n \n #include \"xla/service/compilation_cache.h\"\n \n+#include <cstdint>\n+#include <memory>\n #include <utility>\n \n-#include \"xla/types.h\"\n+#include \"absl/base/const_init.h\"\n+#include \"absl/log/check.h\"\n+#include \"absl/log/log.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"absl/synchronization/mutex.h\"\n+#include \"xla/service/executable.h\"\n #include \"xla/util.h\"\n #include \"xla/xla_data.pb.h\"\n-#include \"tsl/platform/logging.h\"\n-#include \"tsl/platform/strcat.h\"\n \n namespace xla {\n \n@@ -60,11 +65,10 @@ absl::StatusOr<std::shared_ptr<Executable>> CompilationCache::LookUp(\n   if (cache_.count(key) == 0) {\n     VLOG(2) << \"cache key not found: \" << key;\n     return InvalidArgumentStrCat(\"can not find executable with handle \", key);\n-  } else {\n-    auto& result = cache_.at(key);\n-    VLOG(2) << \"hit executable: \" << result->module().name();\n-    return result;\n   }\n+  auto& result = cache_.at(key);\n+  VLOG(2) << \"hit executable: \" << result->module().name();\n+  return result;\n }\n \n }  // namespace xla"
        },
        {
            "sha": "fb2f62336f1fa3a43c4da0d2de93859b5967ee67",
            "filename": "third_party/xla/xla/service/compilation_cache.h",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a094647e7f9a635e75388cd0699301559a808790/third_party%2Fxla%2Fxla%2Fservice%2Fcompilation_cache.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a094647e7f9a635e75388cd0699301559a808790/third_party%2Fxla%2Fxla%2Fservice%2Fcompilation_cache.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcompilation_cache.h?ref=a094647e7f9a635e75388cd0699301559a808790",
            "patch": "@@ -16,14 +16,14 @@ limitations under the License.\n #ifndef XLA_SERVICE_COMPILATION_CACHE_H_\n #define XLA_SERVICE_COMPILATION_CACHE_H_\n \n-#include <map>\n+#include <cstdint>\n #include <memory>\n-#include <string>\n \n+#include \"absl/base/thread_annotations.h\"\n #include \"absl/container/flat_hash_map.h\"\n+#include \"absl/status/statusor.h\"\n+#include \"absl/synchronization/mutex.h\"\n #include \"xla/service/executable.h\"\n-#include \"xla/service/hlo_module_config.h\"\n-#include \"xla/types.h\"\n \n namespace xla {\n \n@@ -33,7 +33,7 @@ namespace xla {\n // compilation cache.\n class CompilationCache {\n  public:\n-  CompilationCache() {}\n+  CompilationCache() = default;\n \n   ExecutionHandle Insert(std::unique_ptr<Executable> executable);\n "
        }
    ],
    "stats": {
        "total": 37,
        "additions": 21,
        "deletions": 16
    }
}