{
    "author": "junwhanahn",
    "message": "Optimize remap ops in IFRT IR by performing more work at compile time\n\nWith two-stage program interpreter, we can now calculate `input_devices_for_output_map` and verify the remap plan at compile time without having to worry about their overheads. The former may improve the performance for runtime implementations that leverage the additional information.\n\nPiperOrigin-RevId: 841856704",
    "sha": "cc327345d12c6e82a0e0c8345b66cfa30844ea16",
    "files": [
        {
            "sha": "313977f13d1030b57888d7fa9e1f55d929c5a384",
            "filename": "third_party/xla/xla/python/ifrt/ir/program_interpreter.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/cc327345d12c6e82a0e0c8345b66cfa30844ea16/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fir%2Fprogram_interpreter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/cc327345d12c6e82a0e0c8345b66cfa30844ea16/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fir%2Fprogram_interpreter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fifrt%2Fir%2Fprogram_interpreter.cc?ref=cc327345d12c6e82a0e0c8345b66cfa30844ea16",
            "patch": "@@ -615,6 +615,9 @@ absl::StatusOr<ProgramInterpreter::OpFn> ProgramInterpreter::HandleOp(\n   };\n   state.remap_is_donated = remap_op.getDonated();\n \n+  TF_RETURN_IF_ERROR(state.remap_plan.ComputeInputDevicesForOutputMap(client_));\n+  TF_RETURN_IF_ERROR(state.remap_plan.Validate());\n+\n   for (const auto output : remap_op.getOutputs()) {\n     const ArrayHandle handle = output.use_empty() ? 0 : ToArrayHandle(output);\n     state.output_handles.push_back(handle);"
        }
    ],
    "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
    }
}