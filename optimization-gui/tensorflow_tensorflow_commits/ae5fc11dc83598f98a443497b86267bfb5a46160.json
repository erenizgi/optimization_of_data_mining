{
    "author": "vwbaker",
    "message": "Do not LOG(FATAL) as this results in a crash at compile time. Instead, log error and return the corresponding status. Also, return anytime we signalPassFailure() - this is not done automatically & can cause the compiler to crash if it accesses a value afterwards.\n\nPiperOrigin-RevId: 802550430",
    "sha": "ae5fc11dc83598f98a443497b86267bfb5a46160",
    "files": [
        {
            "sha": "8bd7312fa52d9a2c0f144ea7f090290105d3866f",
            "filename": "third_party/xla/xla/backends/gpu/codegen/triton/transforms/int4_passes.cc",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ae5fc11dc83598f98a443497b86267bfb5a46160/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ftransforms%2Fint4_passes.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ae5fc11dc83598f98a443497b86267bfb5a46160/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ftransforms%2Fint4_passes.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fcodegen%2Ftriton%2Ftransforms%2Fint4_passes.cc?ref=ae5fc11dc83598f98a443497b86267bfb5a46160",
            "patch": "@@ -670,7 +670,7 @@ absl::StatusOr<int> GetPackedDimension(MLIRContext *ctx,\n   }\n   std::string not_found_message =\n       \"No MakeTensorPtrOp or mlir::triton::xla::ExtractOp found\";\n-  LOG(FATAL) << not_found_message;\n+  LOG(ERROR) << not_found_message;\n   return absl::InvalidArgumentError(not_found_message);\n }\n \n@@ -779,7 +779,7 @@ class PlainInt4ToPackedInt4RewritePass\n     normalize_patterns.add(SitofpToExtFpSitofpRewrite);\n     if (failed(applyPatternsGreedily(module, std::move(normalize_patterns)))) {\n       VLOG(5) << \"failed to apply patterns\";\n-      signalPassFailure();\n+      return signalPassFailure();\n     }\n \n     auto ext_ops = FindInt4ExtSIOp(module);\n@@ -793,7 +793,7 @@ class PlainInt4ToPackedInt4RewritePass\n       if (!packed_dimension_result.ok()) {\n         VLOG(5) << \"failed to get packed dimension: \"\n                 << packed_dimension_result.status();\n-        signalPassFailure();\n+        return signalPassFailure();\n       };\n       packed_dimension = packed_dimension_result.value();\n     }\n@@ -836,7 +836,7 @@ class PlainInt4ToPackedInt4RewritePass\n         patterns, converter);\n     if (failed(applyPartialConversion(module, target, std::move(patterns)))) {\n       VLOG(5) << \"failed to apply partial conversion\";\n-      signalPassFailure();\n+      return signalPassFailure();\n     }\n   }\n   // The default value is true, which means that bf16x2 instructions are used"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
    }
}