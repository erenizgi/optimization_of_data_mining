{
    "author": "apivovarov",
    "message": "This change replaces uses of std::iota with absl::c_iota, which operate directly on containers. This simplifies the code by removing the need to pass begin() and end() iterators.\n\nAlso includes minor refactoring of if/else structures and updates function signatures for clarity.\n\nPiperOrigin-RevId: 839479205",
    "sha": "e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
    "files": [
        {
            "sha": "909c9c1518b6f79cc03afdd0af70e2f2a0a2dc5e",
            "filename": "third_party/xla/xla/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2FBUILD?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -358,6 +358,7 @@ xla_cc_test(\n         \"//xla/hlo/testlib:test\",\n         \"//xla/tsl/platform:logging\",\n         \"//xla/tsl/platform:test_main\",\n+        \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/base:log_severity\",\n         \"@com_google_absl//absl/container:inlined_vector\",\n         \"@com_google_absl//absl/log:check\","
        },
        {
            "sha": "a25f500a8078c40d213d3517cd5c0045b2ae24d4",
            "filename": "third_party/xla/xla/backends/cpu/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2FBUILD?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -168,6 +168,7 @@ cc_library(\n         \"//xla/tsl/platform:logging\",\n         \"//xla/tsl/platform:statusor\",\n         \"@XNNPACK//ynnpack\",\n+        \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/functional:any_invocable\",\n         \"@com_google_absl//absl/status:statusor\","
        },
        {
            "sha": "71cd84d147728b32e91963f70d0aaf9e6a9b9df9",
            "filename": "third_party/xla/xla/backends/cpu/benchmarks/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2FBUILD?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -538,6 +538,7 @@ xla_cc_test(\n         \"//xla/tsl/platform:logging\",\n         \"//xla/tsl/platform:test_benchmark\",\n         \"//xla/tsl/platform:test_main\",\n+        \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/strings:string_view\",\n     ],"
        },
        {
            "sha": "321c23ba4d6c9cc38792aa43c833934960388bea",
            "filename": "third_party/xla/xla/backends/cpu/benchmarks/scatter_benchmark_test.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2Fscatter_benchmark_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2Fscatter_benchmark_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fbenchmarks%2Fscatter_benchmark_test.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -15,11 +15,11 @@ limitations under the License.\n \n #include <algorithm>\n #include <cstdint>\n-#include <numeric>\n #include <random>\n #include <string>\n #include <vector>\n \n+#include \"absl/algorithm/container.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"absl/strings/str_replace.h\"\n #include \"absl/strings/string_view.h\"\n@@ -51,7 +51,7 @@ Literal createR1ScatterIndices(int64_t domain_size, int64_t scatter_size,\n   Literal scatter_indices;\n \n   std::vector<int32_t> scatter_indices_vector(domain_size);\n-  std::iota(scatter_indices_vector.begin(), scatter_indices_vector.end(), 0);\n+  absl::c_iota(scatter_indices_vector, 0);\n   std::shuffle(scatter_indices_vector.begin(), scatter_indices_vector.end(),\n                engine);\n   scatter_indices_vector.resize(scatter_size);"
        },
        {
            "sha": "3ad936afd42504cb9ddbd8d3e63792f8d9d0df94",
            "filename": "third_party/xla/xla/backends/cpu/runtime/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2FBUILD?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -1209,9 +1209,9 @@ cc_library(\n     name = \"topk_lib\",\n     hdrs = [\"topk_lib.h\"],\n     deps = [\n+        \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/base\",\n         \"@com_google_absl//absl/base:dynamic_annotations\",\n-        \"@com_google_absl//absl/numeric:bits\",\n     ],\n )\n "
        },
        {
            "sha": "e4d7abacfe73c2ed02a0df188c542d60006ae0d6",
            "filename": "third_party/xla/xla/backends/cpu/runtime/topk_lib.h",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2Ftopk_lib.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2Ftopk_lib.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fruntime%2Ftopk_lib.h?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -20,9 +20,9 @@ limitations under the License.\n #include <cstddef>\n #include <cstdint>\n #include <limits>\n-#include <numeric>\n #include <vector>\n \n+#include \"absl/algorithm/container.h\"\n #include \"absl/base/casts.h\"\n #include \"absl/base/dynamic_annotations.h\"\n \n@@ -43,7 +43,7 @@ void TopK(int64_t batch_size, int64_t input_size, int64_t k, const T* values,\n \n   std::vector<int32_t> temp_indices(input_size);\n   for (int64_t batch = 0; batch != batch_size; ++batch) {\n-    std::iota(temp_indices.begin(), temp_indices.end(), 0);\n+    absl::c_iota(temp_indices, 0);\n \n     const T* values_batch = values + batch * input_size;\n "
        },
        {
            "sha": "cce21c6abe709d9d15a19129b46537d91616335f",
            "filename": "third_party/xla/xla/backends/cpu/ynn_emitter.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_emitter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_emitter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fcpu%2Fynn_emitter.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -19,11 +19,11 @@ limitations under the License.\n #include <cstddef>\n #include <cstdint>\n #include <memory>\n-#include <numeric>\n #include <utility>\n #include <vector>\n \n #include \"ynnpack/include/ynnpack.h\"\n+#include \"absl/algorithm/container.h\"\n #include \"absl/container/flat_hash_map.h\"\n #include \"absl/functional/any_invocable.h\"\n #include \"absl/status/statusor.h\"\n@@ -38,7 +38,6 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_instructions.h\"\n #include \"xla/hlo/ir/hlo_opcode.h\"\n #include \"xla/literal.h\"\n-#include \"xla/primitive_util.h\"\n #include \"xla/shape.h\"\n #include \"xla/stream_executor/device_memory.h\"\n #include \"xla/tsl/platform/errors.h\"\n@@ -352,7 +351,7 @@ static ynn_status DefineBatchMatrixMultiply(ynn_subgraph_t subgraph,\n   if (transpose_b) {\n     uint32_t input2_id_transposed = YNN_INVALID_VALUE_ID;\n     std::array<int32_t, YNN_MAX_TENSOR_RANK> perm;\n-    std::iota(perm.begin(), perm.end(), 0);\n+    absl::c_iota(perm, 0);\n     CHECK_LT(b_rank, YNN_MAX_TENSOR_RANK);\n     std::swap(perm[b_rank - 1], perm[b_rank - 2]);\n     ynn_status status = ynn_define_static_transpose("
        },
        {
            "sha": "424d14b43647105b516942497ef411072feb3a52",
            "filename": "third_party/xla/xla/backends/gpu/runtime/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2FBUILD?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -2638,6 +2638,7 @@ xla_test(\n         \"//xla/tsl/lib/core:status_test_util\",\n         \"//xla/tsl/platform:test\",\n         \"//xla/tsl/platform:test_main\",\n+        \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/types:span\","
        },
        {
            "sha": "3b1bd7680e1413995c8faa75f46a44794369b61b",
            "filename": "third_party/xla/xla/backends/gpu/runtime/ragged_all_to_all_test.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fragged_all_to_all_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fragged_all_to_all_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fbackends%2Fgpu%2Fruntime%2Fragged_all_to_all_test.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -16,10 +16,10 @@ limitations under the License.\n #include \"xla/backends/gpu/runtime/ragged_all_to_all.h\"\n \n #include <cstdint>\n-#include <numeric>\n #include <vector>\n \n #include <gtest/gtest.h>\n+#include \"absl/algorithm/container.h\"\n #include \"absl/log/check.h\"\n #include \"absl/log/log.h\"\n #include \"absl/types/span.h\"\n@@ -109,7 +109,7 @@ TEST_F(RaggedAllToAllKernelTest, SimpleKernelTest) {\n                 output_offsets_buffer.memory().is_null()));\n \n   std::vector<T> input_data(n);\n-  std::iota(input_data.begin(), input_data.end(), 0);\n+  absl::c_iota(input_data, 0);\n   TF_ASSERT_OK(stream->Memcpy(input_buffer.memory_ptr(), input_data.data(),\n                               n * sizeof(T)));\n "
        },
        {
            "sha": "e5b407a102e869c87f9d7b41f8ef9f0bb54f92ce",
            "filename": "third_party/xla/xla/layout_util.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 9,
            "changes": 20,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Flayout_util.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Flayout_util.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Flayout_util.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -32,7 +32,6 @@ limitations under the License.\n #include \"absl/strings/string_view.h\"\n #include \"absl/types/span.h\"\n #include \"xla/layout.h\"\n-#include \"xla/primitive_util.h\"\n #include \"xla/printer.h\"\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n@@ -101,7 +100,7 @@ void SetDefaultLayoutToContainer(T* minor_to_major) {\n \n /* static */ Layout LayoutUtil::MakeDescendingLayout(int64_t num_dims) {\n   std::vector<int64_t> layout(num_dims);\n-  std::iota(layout.rbegin(), layout.rend(), static_cast<int64_t>(0));\n+  std::iota(layout.rbegin(), layout.rend(), 0);\n   return MakeLayout(layout);\n }\n \n@@ -111,7 +110,7 @@ void SetDefaultLayoutToContainer(T* minor_to_major) {\n \n /* static */ Layout LayoutUtil::MakeAscendingLayout(int64_t num_dims) {\n   std::vector<int64_t> layout(num_dims);\n-  std::iota(layout.begin(), layout.end(), static_cast<int64_t>(0));\n+  absl::c_iota(layout, 0);\n   return MakeLayout(layout);\n }\n \n@@ -205,7 +204,8 @@ Layout CreateDefaultLayoutForRank(int64_t num_dims) {\n           ValidateLayoutInShape(element_shape, allow_missing_layouts));\n     }\n     return absl::OkStatus();\n-  } else if (shape.IsArray()) {\n+  }\n+  if (shape.IsArray()) {\n     if (!shape.has_layout()) {\n       if (allow_missing_layouts) {\n         return absl::OkStatus();\n@@ -214,10 +214,9 @@ Layout CreateDefaultLayoutForRank(int64_t num_dims) {\n                              ShapeUtil::HumanString(shape));\n     }\n     return ValidateLayoutForShape(shape.layout(), shape);\n-  } else {\n-    // Token, opaque, etc. shape.\n-    return absl::OkStatus();\n   }\n+  // Token, opaque, etc. shape.\n+  return absl::OkStatus();\n }\n \n /* static */ absl::Status LayoutUtil::ValidateLayoutForShape(\n@@ -370,7 +369,8 @@ Layout CreateDefaultLayoutForRank(int64_t num_dims) {\n   if (shape.IsTuple()) {\n     return absl::c_any_of(shape.tuple_shapes(),\n                           LayoutUtil::HasCustomElementSizeInBits);\n-  } else if (!shape.IsArray()) {\n+  }\n+  if (!shape.IsArray()) {\n     // Opaque or token types have no custom element size in bits.\n     return false;\n   }\n@@ -494,7 +494,9 @@ absl::Status LayoutUtil::CopyLayoutBetweenShapes(const Shape& src, Shape* dst) {\n \n /*static*/ Layout LayoutUtil::MoveDimToMajor(const Layout& layout,\n                                              int64_t dim) {\n-  if (dim == MinorToMajor(layout).back()) return layout;\n+  if (dim == MinorToMajor(layout).back()) {\n+    return layout;\n+  }\n   Layout ret = layout;\n   ret.clear_minor_to_major();\n   for (auto d : MinorToMajor(layout)) {"
        },
        {
            "sha": "6fa9f4461c0da87668fd9bf5674bef1c2acbc53e",
            "filename": "third_party/xla/xla/service/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2FBUILD?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -2051,6 +2051,7 @@ cc_library(\n         \":hlo_module_config\",\n         \":shape_inference\",\n         \"//xla:comparison_util\",\n+        \"//xla:literal\",\n         \"//xla:literal_util\",\n         \"//xla:shape_util\",\n         \"//xla:status_macros\",\n@@ -2060,15 +2061,14 @@ cc_library(\n         \"//xla/hlo/builder:xla_computation\",\n         \"//xla/hlo/builder/lib:comparators\",\n         \"//xla/hlo/ir:hlo\",\n+        \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:statusor\",\n         \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status:statusor\",\n         \"@com_google_absl//absl/strings\",\n         \"@com_google_absl//absl/types:span\",\n-        \"@local_tsl//tsl/platform:errors\",\n-        \"@local_tsl//tsl/platform:statusor\",\n     ],\n )\n "
        },
        {
            "sha": "a58a7a8d623df73864196da60dcd7f20ba654d68",
            "filename": "third_party/xla/xla/service/cpu/BUILD",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2FBUILD?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -1172,16 +1172,15 @@ cc_library(\n         \":dot_op_emitter\",\n         \":ir_emission_utils\",\n         \"//xla:shape_util\",\n-        \"//xla:util\",\n         \"//xla/backends/cpu/codegen:target_machine_features\",\n         \"//xla/hlo/ir:hlo\",\n         \"//xla/service:computation_layout\",\n         \"//xla/service:layout_assignment\",\n+        \"//xla/tsl/platform:errors\",\n         \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/container:flat_hash_map\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\",\n-        \"@local_tsl//tsl/platform:errors\",\n         \"@local_tsl//tsl/platform:status\",\n     ],\n )\n@@ -1423,6 +1422,7 @@ onednn_cc_library(\n         \"//xla/service/llvm_ir:ir_array\",\n         \"//xla/service/llvm_ir:llvm_util\",\n         \"//xla/tsl/mkl:onednn\",\n+        \"@com_google_absl//absl/algorithm:container\",\n         \"@com_google_absl//absl/log\",\n         \"@com_google_absl//absl/log:check\",\n         \"@com_google_absl//absl/status\","
        },
        {
            "sha": "36ede770efdedf2459ca35a2e40dbaa9aa890ef5",
            "filename": "third_party/xla/xla/service/cpu/cpu_layout_assignment.cc",
            "status": "modified",
            "additions": 11,
            "deletions": 5,
            "changes": 16,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_layout_assignment.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_layout_assignment.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fcpu_layout_assignment.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -24,13 +24,17 @@ limitations under the License.\n #include \"absl/container/flat_hash_map.h\"\n #include \"absl/log/check.h\"\n #include \"absl/status/status.h\"\n+#include \"xla/backends/cpu/codegen/target_machine_features.h\"\n #include \"xla/hlo/ir/hlo_casting_utils.h\"\n+#include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_instructions.h\"\n-#include \"xla/map_util.h\"\n+#include \"xla/hlo/ir/hlo_opcode.h\"\n+#include \"xla/layout_util.h\"\n #include \"xla/service/cpu/dot_op_emitter.h\"\n #include \"xla/service/cpu/ir_emission_utils.h\"\n+#include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n-#include \"tsl/platform/errors.h\"\n+#include \"xla/tsl/platform/errors.h\"\n \n namespace xla {\n namespace cpu {\n@@ -103,7 +107,7 @@ static Shape RowMajorShape(Shape shape) {\n static Shape ColMajorShape(const Shape& old_shape) {\n   Shape new_shape(old_shape);\n   std::vector<int64_t> dimension_order(new_shape.dimensions().size());\n-  std::iota(dimension_order.begin(), dimension_order.end(), 0);\n+  absl::c_iota(dimension_order, 0);\n   *new_shape.mutable_layout() = LayoutUtil::MakeLayout(dimension_order);\n   return new_shape;\n }\n@@ -114,10 +118,12 @@ static bool OperandsAndResultMustHaveRowMajorLayout(\n   if (instr.opcode() == HloOpcode::kConvolution) {\n     return PotentiallyImplementedAsEigenConvolution(instr,\n                                                     target_machine_features);\n-  } else if (instr.opcode() == HloOpcode::kDot) {\n+  }\n+  if (instr.opcode() == HloOpcode::kDot) {\n     return DotOperandsAndResultMustHaveRowMajorLayout(\n         instr, target_machine_features, /*allow_runtime_calls=*/true);\n-  } else if (instr.opcode() == HloOpcode::kCustomCall) {\n+  }\n+  if (instr.opcode() == HloOpcode::kCustomCall) {\n     return instr.custom_call_target() == \"TopK\";\n   }\n   return false;"
        },
        {
            "sha": "63cd3438763c9bb84c4de0a88a9b61b40dd88821",
            "filename": "third_party/xla/xla/service/cpu/onednn_matmul.cc",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fonednn_matmul.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fonednn_matmul.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fonednn_matmul.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -20,7 +20,6 @@ limitations under the License.\n #include <initializer_list>\n #include <iterator>\n #include <memory>\n-#include <numeric>\n #include <string>\n #include <unordered_map>\n #include <utility>\n@@ -68,7 +67,7 @@ void TransposeIfNecessary(\n     return;\n   }\n   std::vector<int> permutation(mem_desc.get_ndims());\n-  std::iota(permutation.begin(), permutation.end(), 0);\n+  absl::c_iota(permutation, 0);\n   int counter = 0;\n   for (auto it = dimensions.begin(); it != dimensions.end(); it++) {\n     permutation[*it - 1] = counter++;"
        },
        {
            "sha": "2233c84d814d38ccf45cb38a38f07d6ee73b8310",
            "filename": "third_party/xla/xla/service/cpu/onednn_memory_util.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fonednn_memory_util.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fonednn_memory_util.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fcpu%2Fonednn_memory_util.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -19,10 +19,10 @@ limitations under the License.\n #include <cstdint>\n #include <initializer_list>\n #include <iostream>\n-#include <numeric>\n #include <utility>\n #include <vector>\n \n+#include \"absl/algorithm/container.h\"\n #include \"absl/log/log.h\"\n #include \"absl/status/status.h\"\n #include \"absl/status/statusor.h\"\n@@ -203,7 +203,7 @@ absl::StatusOr<dnnl::memory::desc> TransposeLastTwoDims(\n     return absl::InvalidArgumentError(\"Requires at least 2D shape.\");\n   }\n   std::vector<int> permutation(ndims);\n-  std::iota(permutation.begin(), permutation.end(), 0);\n+  absl::c_iota(permutation, 0);\n   std::swap(permutation[ndims - 1], permutation[ndims - 2]);\n   return md.permute_axes(permutation);\n }"
        },
        {
            "sha": "d8bb81ecf182e87bec1f8bb3f511ebd18cb830b5",
            "filename": "third_party/xla/xla/service/gpu/transforms/BUILD",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2FBUILD?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -1569,6 +1569,7 @@ cc_library(\n         \"//xla/stream_executor:semantic_version\",\n         \"//xla/stream_executor/cuda:cuda_compute_capability\",\n         \"//xla/stream_executor/gpu:gpu_blas_lt\",\n+        \"//xla/stream_executor/rocm:rocm_compute_capability\",\n         \"//xla/tsl/platform:errors\",\n         \"//xla/tsl/platform:statusor\",\n         \"//xla/tsl/protobuf:dnn_proto_cc\","
        },
        {
            "sha": "ab70576b2e7d0602a072eac353c9827514c9915c",
            "filename": "third_party/xla/xla/service/gpu/transforms/conv_rewriter.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fconv_rewriter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fconv_rewriter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fconv_rewriter.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -18,7 +18,6 @@ limitations under the License.\n #include <cstdint>\n #include <cstdlib>\n #include <memory>\n-#include <numeric>\n #include <optional>\n #include <string>\n #include <tuple>\n@@ -682,7 +681,7 @@ ConvolutionMatch MatchBackwardInput(HloInstruction* conv) {\n   // Transpose [H, W, ..., G, in_depth/G, out_depth / G] -> [H, W, ...,\n   // in_depth/G, G, out_depth / G]\n   std::vector<int64_t> transpose_dims(rhs->shape().dimensions().size());\n-  std::iota(transpose_dims.begin(), transpose_dims.end(), 0);\n+  absl::c_iota(transpose_dims, 0);\n   transpose_dims.erase(transpose_dims.begin() + input_feature_dimension);\n   transpose_dims.insert(transpose_dims.begin() + output_feature_dimension,\n                         input_feature_dimension);\n@@ -781,7 +780,7 @@ HloInstruction* ConvertBatchGroupedToFeatureGroupedConvolution(\n   // Transpose G to the axis before C, For eg: [G, N/G, H, W, C ] -> [N/G, H,\n   // W, G, C]\n   std::vector<int64_t> transpose_dims(lhs->shape().dimensions().size());\n-  std::iota(transpose_dims.begin(), transpose_dims.end(), 0);\n+  absl::c_iota(transpose_dims, 0);\n   transpose_dims.erase(transpose_dims.begin() + input_batch_dimension);\n   transpose_dims.insert(transpose_dims.begin() + input_feature_dimension,\n                         input_batch_dimension);"
        },
        {
            "sha": "d420d471002a796c11396db7ce2f8c8a89abcc04",
            "filename": "third_party/xla/xla/service/gpu/transforms/gemm_rewriter.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fgemm_rewriter.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fgemm_rewriter.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fgpu%2Ftransforms%2Fgemm_rewriter.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -24,7 +24,6 @@ limitations under the License.\n #include <initializer_list>\n #include <limits>\n #include <memory>\n-#include <numeric>\n #include <optional>\n #include <tuple>\n #include <unordered_set>\n@@ -65,6 +64,7 @@ limitations under the License.\n #include \"xla/stream_executor/cuda/cuda_compute_capability.h\"\n #include \"xla/stream_executor/device_description.h\"\n #include \"xla/stream_executor/gpu/gpu_blas_lt.h\"\n+#include \"xla/stream_executor/rocm/rocm_compute_capability.h\"\n #include \"xla/stream_executor/semantic_version.h\"\n #include \"xla/tsl/platform/errors.h\"\n #include \"xla/tsl/platform/statusor.h\"\n@@ -1388,7 +1388,7 @@ class GemmRewriterVisitor : public DfsHloRewriteVisitor {\n     a.fp8_input = PadOperandToMultipleOf16(a_batch_dims, a.fp8_input);\n     b.fp8_input = PadOperandToMultipleOf16(b_batch_dims, b.fp8_input);\n     std::vector<int64_t> out_batch_dims(num_batch_dims);\n-    std::iota(out_batch_dims.begin(), out_batch_dims.end(), 0);\n+    absl::c_iota(out_batch_dims, 0);\n     Shape new_output_shape =\n         PadShapeToMultipleOf16(instr->shape(), out_batch_dims);\n "
        },
        {
            "sha": "3ec4581e391d0a2d5f5909220bcad0e98bc0492d",
            "filename": "third_party/xla/xla/service/hlo_creation_utils.cc",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_creation_utils.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_creation_utils.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fservice%2Fhlo_creation_utils.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -19,9 +19,9 @@ limitations under the License.\n #include <cstdint>\n #include <iterator>\n #include <memory>\n-#include <numeric>\n #include <optional>\n #include <string>\n+#include <utility>\n #include <vector>\n \n #include \"absl/algorithm/container.h\"\n@@ -39,18 +39,18 @@ limitations under the License.\n #include \"xla/hlo/ir/hlo_instruction.h\"\n #include \"xla/hlo/ir/hlo_module.h\"\n #include \"xla/hlo/ir/hlo_opcode.h\"\n+#include \"xla/literal.h\"\n #include \"xla/literal_util.h\"\n #include \"xla/primitive_util.h\"\n #include \"xla/service/hlo_module_config.h\"\n #include \"xla/service/shape_inference.h\"\n #include \"xla/shape.h\"\n #include \"xla/shape_util.h\"\n #include \"xla/status_macros.h\"\n+#include \"xla/tsl/platform/errors.h\"\n #include \"xla/tsl/platform/statusor.h\"\n #include \"xla/util.h\"\n #include \"xla/xla_data.pb.h\"\n-#include \"tsl/platform/errors.h\"\n-#include \"tsl/platform/statusor.h\"\n \n namespace xla {\n using absl::StrCat;\n@@ -439,7 +439,7 @@ absl::StatusOr<HloInstruction*> MakeMapHlo(\n                  static_cast<int64_t>(operand->shape().dimensions().size()));\n   }\n   std::vector<int64_t> map_dims(max_operand_rank);\n-  std::iota(map_dims.begin(), map_dims.end(), 0);\n+  absl::c_iota(map_dims, 0);\n   TF_ASSIGN_OR_RETURN(\n       Shape map_shape,\n       ShapeInference::InferMapShape(\n@@ -537,7 +537,7 @@ absl::StatusOr<HloInstruction*> MakeReduceHlo(\n     const FrontendAttributes* frontend_attributes) {\n   DCHECK_NE(nullptr, module);\n   std::vector<int64_t> all_dims(operand->shape().dimensions().size());\n-  std::iota(all_dims.begin(), all_dims.end(), 0);\n+  absl::c_iota(all_dims, 0);\n \n   HloComputation* reduce_computation = MakeBinaryScalarComputation(\n       binary_opcode, operand->shape().element_type(), operand, module);"
        },
        {
            "sha": "e1015ca2dc7778384cfd62fb264a95597f5c6e40",
            "filename": "third_party/xla/xla/shape_util_test.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fshape_util_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Fshape_util_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fshape_util_test.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -17,7 +17,6 @@ limitations under the License.\n \n #include <cstddef>\n #include <cstdint>\n-#include <numeric>\n #include <optional>\n #include <utility>\n #include <variant>\n@@ -1040,13 +1039,13 @@ TEST(ShapeUtilTest, PermuteDimensionsIgnoringLayout) {\n \n TEST(ShapeUtilTest, PermuteDimensionsLayout) {\n   std::vector<int64_t> layout(3);\n-  std::iota(layout.begin(), layout.end(), 0);\n+  absl::c_iota(layout, 0);\n   do {\n     Shape s = ShapeUtil::MakeShapeWithDenseLayout(F32, {10, 100, 1000}, layout);\n     SCOPED_TRACE(absl::StrCat(\"s=\", ShapeUtil::HumanString(s)));\n \n     std::vector<int64_t> permutation(3);\n-    std::iota(permutation.begin(), permutation.end(), 0);\n+    absl::c_iota(permutation, 0);\n     do {\n       SCOPED_TRACE(\n           absl::StrCat(\"permutation=\", absl::StrJoin(permutation, \",\")));\n@@ -1082,7 +1081,7 @@ TEST(ShapeUtilTest, PermuteDynamicDimensions) {\n   SCOPED_TRACE(absl::StrCat(\"shape=\", shape.ToString()));\n \n   std::vector<int64_t> permutation(3);\n-  std::iota(permutation.begin(), permutation.end(), 0);\n+  absl::c_iota(permutation, 0);\n   do {\n     SCOPED_TRACE(absl::StrCat(\"permutation=\", absl::StrJoin(permutation, \",\")));\n "
        },
        {
            "sha": "9c26daa5d1e7ed6f868184a17479921ce35e6c57",
            "filename": "third_party/xla/xla/util_test.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Futil_test.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/e8bf91905d0fd9caa3de12a202fd547fb4b5f400/third_party%2Fxla%2Fxla%2Futil_test.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Futil_test.cc?ref=e8bf91905d0fd9caa3de12a202fd547fb4b5f400",
            "patch": "@@ -20,14 +20,14 @@ limitations under the License.\n #include <limits>\n #include <list>\n #include <memory>\n-#include <numeric>\n #include <set>\n #include <string>\n #include <utility>\n #include <vector>\n \n #include <gmock/gmock.h>\n #include <gtest/gtest.h>\n+#include \"absl/algorithm/container.h\"\n #include \"absl/base/log_severity.h\"\n #include \"absl/container/inlined_vector.h\"\n #include \"absl/log/check.h\"\n@@ -391,7 +391,7 @@ void PackInt4(absl::Span<const char> input, absl::Span<char> output) {\n \n TEST(UtilTest, PackInt4) {\n   std::vector<char> input(7);\n-  std::iota(input.begin(), input.end(), 0);\n+  absl::c_iota(input, 0);\n \n   std::vector<char> output_ref(CeilOfRatio<int64_t>(input.size(), 2));\n   PackInt4(input, absl::MakeSpan(output_ref));"
        }
    ],
    "stats": {
        "total": 105,
        "additions": 57,
        "deletions": 48
    }
}