{
    "author": "superbobry",
    "message": "[jaxlib] Improved the type annotations for various nanobind-exported APIs\n\nThis change is necessary for nanobind stubgen to produce good type stubs\nautomatically.\n\nPiperOrigin-RevId: 813658923",
    "sha": "ab737b3a422e2eb3e56ed914243f92a79d8b9769",
    "files": [
        {
            "sha": "6358aae35d36b880d04fec14fe53413f97dafdc1",
            "filename": "third_party/xla/xla/python/nb_absl_span.h",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ab737b3a422e2eb3e56ed914243f92a79d8b9769/third_party%2Fxla%2Fxla%2Fpython%2Fnb_absl_span.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ab737b3a422e2eb3e56ed914243f92a79d8b9769/third_party%2Fxla%2Fxla%2Fpython%2Fnb_absl_span.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fnb_absl_span.h?ref=ab737b3a422e2eb3e56ed914243f92a79d8b9769",
            "patch": "@@ -29,14 +29,15 @@ namespace detail {\n \n template <typename T>\n struct type_caster<absl::Span<T const>> {\n-  NB_TYPE_CASTER(absl::Span<T const>,\n-                 const_name(\"Span[\") + make_caster<T>::Name + const_name(\"]\"))\n+  NB_TYPE_CASTER(absl::Span<T const>, const_name(\"collections.abc.Sequence[\") +\n+                                          make_caster<T>::Name +\n+                                          const_name(\"]\"))\n \n   using Caster = make_caster<T>;\n \n   list_caster<std::vector<T>, T> vec_caster;\n \n-  bool from_python(handle src, uint8_t flags, cleanup_list *cleanup) noexcept {\n+  bool from_python(handle src, uint8_t flags, cleanup_list* cleanup) noexcept {\n     if (!vec_caster.from_python(src, flags, cleanup)) {\n       return false;\n     }\n@@ -45,11 +46,11 @@ struct type_caster<absl::Span<T const>> {\n   }\n \n   static handle from_cpp(absl::Span<T const> src, rv_policy policy,\n-                         cleanup_list *cleanup) noexcept {\n+                         cleanup_list* cleanup) noexcept {\n     object ret = steal(PyList_New(src.size()));\n     if (ret.is_valid()) {\n       Py_ssize_t i = 0;\n-      for (const T &value : src) {\n+      for (const T& value : src) {\n         handle h = Caster::from_cpp(value, policy, cleanup);\n         if (!h.is_valid()) {\n           ret.reset();"
        },
        {
            "sha": "a88edfb8f931054258f3df56720ceeb350f1b3e8",
            "filename": "third_party/xla/xla/python/nb_numpy.h",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ab737b3a422e2eb3e56ed914243f92a79d8b9769/third_party%2Fxla%2Fxla%2Fpython%2Fnb_numpy.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ab737b3a422e2eb3e56ed914243f92a79d8b9769/third_party%2Fxla%2Fxla%2Fpython%2Fnb_numpy.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fnb_numpy.h?ref=ab737b3a422e2eb3e56ed914243f92a79d8b9769",
            "patch": "@@ -42,7 +42,8 @@ namespace xla {\n // initialization function. Otherwise PyArray_DescrCheck will be nullptr.\n class nb_dtype : public nanobind::object {\n  public:\n-  NB_OBJECT_DEFAULT(nb_dtype, object, \"dtype\", PyArray_DescrCheck);  // NOLINT\n+  NB_OBJECT_DEFAULT(nb_dtype, object, \"numpy.dtype\",\n+                    PyArray_DescrCheck);  // NOLINT\n \n   explicit nb_dtype(const nanobind::str& format)\n       : nb_dtype(from_args(format)) {}\n@@ -71,7 +72,7 @@ class nb_dtype : public nanobind::object {\n \n class nb_numpy_ndarray : public nanobind::object {\n  public:\n-  NB_OBJECT_DEFAULT(nb_numpy_ndarray, object, \"ndarray\",\n+  NB_OBJECT_DEFAULT(nb_numpy_ndarray, object, \"numpy.ndarray\",\n                     PyArray_Check);  // NOLINT\n \n   nb_numpy_ndarray(nb_dtype dtype, absl::Span<int64_t const> shape,"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 9,
        "deletions": 7
    }
}