{
    "author": "yashk2810",
    "message": "Allow outputting unreduced shardings from jit\n\nPiperOrigin-RevId: 805787890",
    "sha": "a7cfa419db4fcdbd9aca5a508406ca284c3e2723",
    "files": [
        {
            "sha": "4fcf2aef5ccf40e8ab8273a35bae58c82f697ff5",
            "filename": "third_party/xla/xla/python/pjrt_ifrt/xla_sharding.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7cfa419db4fcdbd9aca5a508406ca284c3e2723/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fxla_sharding.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7cfa419db4fcdbd9aca5a508406ca284c3e2723/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fxla_sharding.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fpjrt_ifrt%2Fxla_sharding.cc?ref=a7cfa419db4fcdbd9aca5a508406ca284c3e2723",
            "patch": "@@ -128,7 +128,7 @@ HloSharding::HloSharding(DeviceListRef devices, MemoryKind memory_kind,\n \n absl::StatusOr<Shape> HloSharding::GetShardShape(const Shape& shape) const {\n   if (xla_hlo_sharding_.IsTileMaximal() || xla_hlo_sharding_.IsManual() ||\n-      xla_hlo_sharding_.IsUnknown()) {\n+      xla_hlo_sharding_.IsUnreduced() || xla_hlo_sharding_.IsUnknown()) {\n     return shape;\n   }\n   if (xla_hlo_sharding_.TotalNumTiles() != devices_->size()) {\n@@ -193,7 +193,8 @@ HloSharding::Disassemble(\n     SingleDeviceShardSemantics single_device_shard_semantics) const {\n   DCHECK(this);\n   bool is_even_sharding = false;\n-  if (xla_hlo_sharding_.IsReplicated() || xla_hlo_sharding_.IsTileMaximal()) {\n+  if (xla_hlo_sharding_.IsReplicated() || xla_hlo_sharding_.IsTileMaximal() ||\n+      xla_hlo_sharding_.IsUnreduced()) {\n     is_even_sharding = true;\n   } else if (xla_hlo_sharding_.IsTiled()) {\n     const int64_t tiled_data_rank = xla_hlo_sharding_.TiledDataRank();"
        },
        {
            "sha": "20100e8ec30f8c22beb5c512a5f3ac34eb428fa0",
            "filename": "third_party/xla/xla/python/version.h",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/a7cfa419db4fcdbd9aca5a508406ca284c3e2723/third_party%2Fxla%2Fxla%2Fpython%2Fversion.h",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/a7cfa419db4fcdbd9aca5a508406ca284c3e2723/third_party%2Fxla%2Fxla%2Fpython%2Fversion.h",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fpython%2Fversion.h?ref=a7cfa419db4fcdbd9aca5a508406ca284c3e2723",
            "patch": "@@ -18,6 +18,6 @@ limitations under the License.\n \n // An increasing version number to protect jax code against breaking changes.\n // In JAX, reference this via jax._src.lib.ifrt_version.\n-#define JAX_IFRT_VERSION_NUMBER 26\n+#define JAX_IFRT_VERSION_NUMBER 27\n \n #endif  // XLA_PYTHON_VERSION_H_"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
    }
}