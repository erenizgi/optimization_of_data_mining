{
    "author": "tensorflower-gardener",
    "message": "Remove use of vector.splat\n\nRemoved in https://github.com/llvm/llvm-project/commit/ea291d0e8c93d47d7953eff5ca1048891a5fcc55. The replacement is vector.broadcast.\n\nPiperOrigin-RevId: 818680777",
    "sha": "66537d1bd8e853b6ceb2686c3ee63f455b45b9ce",
    "files": [
        {
            "sha": "256472197dae55cc147787c95b07e9e909710f6f",
            "filename": "third_party/xla/xla/codegen/emitters/elemental_hlo_to_mlir.cc",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/66537d1bd8e853b6ceb2686c3ee63f455b45b9ce/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Felemental_hlo_to_mlir.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/66537d1bd8e853b6ceb2686c3ee63f455b45b9ce/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Felemental_hlo_to_mlir.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fcodegen%2Femitters%2Felemental_hlo_to_mlir.cc?ref=66537d1bd8e853b6ceb2686c3ee63f455b45b9ce",
            "patch": "@@ -1553,7 +1553,7 @@ ValueRange EmitLoopNestImpl(\n     for (auto& init : vector_inits) {\n       if (!mlir::isa<mlir::ShapedType>(init.getType())) {\n         auto vector_ty = mlir::VectorType::get({vector_size}, init.getType());\n-        init = b.create<mlir::vector::SplatOp>(vector_ty, init);\n+        init = b.create<mlir::vector::BroadcastOp>(vector_ty, init);\n       }\n     }\n     iter_args_inits = vector_inits;\n@@ -1632,7 +1632,7 @@ ValueRange EmitXlaLoopOp(\n     for (auto& init : vector_inits) {\n       if (!mlir::isa<mlir::ShapedType>(init.getType())) {\n         auto vector_ty = mlir::VectorType::get({vector_size}, init.getType());\n-        init = b.create<mlir::vector::SplatOp>(vector_ty, init);\n+        init = b.create<mlir::vector::BroadcastOp>(vector_ty, init);\n       }\n     }\n     iter_args_inits = vector_inits;"
        },
        {
            "sha": "bfbb76b38af58ffd492ff8c046b3d6275be1bfaa",
            "filename": "third_party/xla/xla/mlir/tools/mlir_interpreter/dialects/tests/vector/splat.mlir",
            "status": "removed",
            "additions": 0,
            "deletions": 11,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/ec753f48a117ce21ce2320dd1bdcd997a8723d4d/third_party%2Fxla%2Fxla%2Fmlir%2Ftools%2Fmlir_interpreter%2Fdialects%2Ftests%2Fvector%2Fsplat.mlir",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/ec753f48a117ce21ce2320dd1bdcd997a8723d4d/third_party%2Fxla%2Fxla%2Fmlir%2Ftools%2Fmlir_interpreter%2Fdialects%2Ftests%2Fvector%2Fsplat.mlir",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fmlir%2Ftools%2Fmlir_interpreter%2Fdialects%2Ftests%2Fvector%2Fsplat.mlir?ref=ec753f48a117ce21ce2320dd1bdcd997a8723d4d",
            "patch": "@@ -1,11 +0,0 @@\n-// RUN: mlir-interpreter-runner %s -run-all | FileCheck %s\n-\n-func.func @splat() -> vector<2x4xi32> {\n-  %c42 = arith.constant 42 : i32\n-  %splat = vector.splat %c42 : vector<2x4xi32>\n-  return %splat : vector<2x4xi32>\n-}\n-\n-// CHECK-LABEL: @splat\n-// CHECK-NEXT: Results\n-// CHECK-NEXT{LITERAL}: vector<2x4xi32>: [[42, 42, 42, 42], [42, 42, 42, 42]]"
        },
        {
            "sha": "870b1216121a387b8ac46155cadc1906ed068d6a",
            "filename": "third_party/xla/xla/mlir/tools/mlir_interpreter/dialects/vector.cc",
            "status": "modified",
            "additions": 0,
            "deletions": 11,
            "changes": 11,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/66537d1bd8e853b6ceb2686c3ee63f455b45b9ce/third_party%2Fxla%2Fxla%2Fmlir%2Ftools%2Fmlir_interpreter%2Fdialects%2Fvector.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/66537d1bd8e853b6ceb2686c3ee63f455b45b9ce/third_party%2Fxla%2Fxla%2Fmlir%2Ftools%2Fmlir_interpreter%2Fdialects%2Fvector.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fmlir%2Ftools%2Fmlir_interpreter%2Fdialects%2Fvector.cc?ref=66537d1bd8e853b6ceb2686c3ee63f455b45b9ce",
            "patch": "@@ -607,16 +607,6 @@ InterpreterValue Shuffle(InterpreterState& state, vector::ShuffleOp shuffle,\n   return result;\n }\n \n-InterpreterValue Splat(InterpreterState&, vector::SplatOp op,\n-                       const InterpreterValue& in) {\n-  auto out = in.AsUnitTensor(/*is_vector=*/true);\n-  auto& view = out.View();\n-  view.sizes = llvm::to_vector(\n-      mlir::cast<ShapedType>(op->getResultTypes()[0]).getShape());\n-  view.strides = SmallVector<int64_t>(view.sizes.size(), 0);\n-  return out;\n-}\n-\n void Store(InterpreterState& state, vector::StoreOp,\n            const InterpreterValue& src, InterpreterValue dst,\n            ArrayRef<int64_t> offsets) {\n@@ -817,7 +807,6 @@ REGISTER_MLIR_INTERPRETER_OP(OuterProduct);\n REGISTER_MLIR_INTERPRETER_OP(Reduction);\n REGISTER_MLIR_INTERPRETER_OP(ShapeCast);\n REGISTER_MLIR_INTERPRETER_OP(Shuffle);\n-REGISTER_MLIR_INTERPRETER_OP(Splat);\n REGISTER_MLIR_INTERPRETER_OP(Store);\n REGISTER_MLIR_INTERPRETER_OP(TransferRead);\n REGISTER_MLIR_INTERPRETER_OP(TransferWrite);"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 2,
        "deletions": 24
    }
}