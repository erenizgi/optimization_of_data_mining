{
    "author": "penpornk",
    "message": "[xla:cpu:ynn] Add build macros for YNNPACK integration.\n\nWe won't build XLA with YNNPACK on Windows yet.\n\nPiperOrigin-RevId: 820744698",
    "sha": "8614a97d9807cfd819ee13949eb9a89dec91413b",
    "files": [
        {
            "sha": "3c413807167aebc8b0090f1e9772c25cc8ccf2b7",
            "filename": "third_party/xla/xla/tsl/xnnpack/BUILD",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8614a97d9807cfd819ee13949eb9a89dec91413b/third_party%2Fxla%2Fxla%2Ftsl%2Fxnnpack%2FBUILD",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8614a97d9807cfd819ee13949eb9a89dec91413b/third_party%2Fxla%2Fxla%2Ftsl%2Fxnnpack%2FBUILD",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fxnnpack%2FBUILD?ref=8614a97d9807cfd819ee13949eb9a89dec91413b",
            "patch": "@@ -0,0 +1 @@\n+# copybara:uncomment package(default_applicable_licenses = [\"//tensorflow:license\"])"
        },
        {
            "sha": "5aab05cadd11327f3fab0862ecb4089687933b55",
            "filename": "third_party/xla/xla/tsl/xnnpack/build_defs.bzl",
            "status": "added",
            "additions": 38,
            "deletions": 0,
            "changes": 38,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/8614a97d9807cfd819ee13949eb9a89dec91413b/third_party%2Fxla%2Fxla%2Ftsl%2Fxnnpack%2Fbuild_defs.bzl",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/8614a97d9807cfd819ee13949eb9a89dec91413b/third_party%2Fxla%2Fxla%2Ftsl%2Fxnnpack%2Fbuild_defs.bzl",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Ftsl%2Fxnnpack%2Fbuild_defs.bzl?ref=8614a97d9807cfd819ee13949eb9a89dec91413b",
            "patch": "@@ -0,0 +1,38 @@\n+\"\"\"Macros for XNNPACK and YNNPACK.\"\"\"\n+\n+load(\"//xla:xla.default.bzl\", \"xla_cc_test\")\n+load(\"//xla/tsl:package_groups.bzl\", \"DEFAULT_LOAD_VISIBILITY\")\n+\n+visibility(DEFAULT_LOAD_VISIBILITY)\n+\n+def if_ynnpack(if_true, if_false = []):\n+    \"\"\"Selection based on whether we are building XLA with YNNPACK integration.\n+\n+    Args:\n+      if_true: Expression to evaluate if building with YNNPACK.\n+      if_false: Expression to evaluate if building without YNNPACK.\n+\n+    Returns:\n+      A select evaluating to either if_true or if_false as appropriate.\n+    \"\"\"\n+    return select({\n+        # YNNPACK is not tested on Windows.\n+        \"//xla/tsl:windows\": if_false,\n+        \"//conditions:default\": if_true,\n+    })\n+\n+def ynn_cc_test(\n+        srcs = [],\n+        deps = [],\n+        **kwargs):\n+    \"\"\"xla_cc_test rule with empty src and deps if not building with YNNPACK.\"\"\"\n+    xla_cc_test(\n+        # CC_TEST_OK=Just defining `xla_cc_test` rule to be used in XLA.\n+        srcs = if_ynnpack(srcs),\n+        deps = if_ynnpack(if_true = deps, if_false = [\"@com_google_googletest//:gtest_main\"]),\n+        # If not building with YNNPACK, we don't have any tests linked.\n+        fail_if_no_test_linked = False,\n+        # If not building with YNNPACK, we don't have any tests defined either.\n+        fail_if_no_test_selected = False,\n+        **kwargs\n+    )"
        }
    ],
    "stats": {
        "total": 39,
        "additions": 39,
        "deletions": 0
    }
}