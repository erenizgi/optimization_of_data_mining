{
    "author": "bixia1",
    "message": "[xla] Fix Shape::FromProto to handle invalid buffer shapes.\n\nPiperOrigin-RevId: 804717536",
    "sha": "b2f2932a208b3794fb9f611cb60c1a3d0c15470a",
    "files": [
        {
            "sha": "d7434ab636f463a4e5715068b0d69ef8a7ec3ce2",
            "filename": "third_party/xla/xla/shape.cc",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/tensorflow/tensorflow/blob/b2f2932a208b3794fb9f611cb60c1a3d0c15470a/third_party%2Fxla%2Fxla%2Fshape.cc",
            "raw_url": "https://github.com/tensorflow/tensorflow/raw/b2f2932a208b3794fb9f611cb60c1a3d0c15470a/third_party%2Fxla%2Fxla%2Fshape.cc",
            "contents_url": "https://api.github.com/repos/tensorflow/tensorflow/contents/third_party%2Fxla%2Fxla%2Fshape.cc?ref=b2f2932a208b3794fb9f611cb60c1a3d0c15470a",
            "patch": "@@ -122,6 +122,9 @@ absl::StatusOr<Shape> Shape::FromProto(const ShapeProto& shape_proto) {\n     }\n     TF_ASSIGN_OR_RETURN(Shape buffer_shape,\n                         Shape::FromProto(shape_proto.tuple_shapes(0)));\n+    if (!buffer_shape.IsArrayExcludingBuffer()) {\n+      return absl::InvalidArgumentError(\"Buffer shape must have array shape.\");\n+    }\n     *state->buffer_shape = std::move(buffer_shape);\n   }\n   if (shape_proto.has_layout()) {"
        }
    ],
    "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
    }
}