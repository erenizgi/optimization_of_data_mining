{
    "author": "claudep",
    "message": "Fixed #20108 -- Fixed filepath_to_uri decoding error\n\nThis was a regression due to unicode_literals usage. Thanks Ivan\nVirabyan for the report and the initial patch.",
    "sha": "164528acc8752f33a3af4c1255b24702a4c81240",
    "files": [
        {
            "sha": "adab0d0712629fdc6b846e18e48b5b90394af614",
            "filename": "django/utils/encoding.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/164528acc8752f33a3af4c1255b24702a4c81240/django%2Futils%2Fencoding.py",
            "raw_url": "https://github.com/django/django/raw/164528acc8752f33a3af4c1255b24702a4c81240/django%2Futils%2Fencoding.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fencoding.py?ref=164528acc8752f33a3af4c1255b24702a4c81240",
            "patch": "@@ -234,7 +234,7 @@ def filepath_to_uri(path):\n         return path\n     # I know about `os.sep` and `os.altsep` but I want to leave\n     # some flexibility for hardcoding separators.\n-    return quote(force_bytes(path.replace(\"\\\\\", \"/\")), safe=b\"/~!*()'\")\n+    return quote(force_bytes(path).replace(b\"\\\\\", b\"/\"), safe=b\"/~!*()'\")\n \n def get_system_encoding():\n     \"\"\""
        },
        {
            "sha": "7aaba25a7ae5c908dbbdbee43db81d6ed590b640",
            "filename": "tests/utils_tests/encoding.py",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/164528acc8752f33a3af4c1255b24702a4c81240/tests%2Futils_tests%2Fencoding.py",
            "raw_url": "https://github.com/django/django/raw/164528acc8752f33a3af4c1255b24702a4c81240/tests%2Futils_tests%2Fencoding.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Futils_tests%2Fencoding.py?ref=164528acc8752f33a3af4c1255b24702a4c81240",
            "patch": "@@ -2,7 +2,7 @@\n from __future__ import unicode_literals\n \n from django.utils import unittest\n-from django.utils.encoding import force_bytes\n+from django.utils.encoding import force_bytes, filepath_to_uri\n \n \n class TestEncodingUtils(unittest.TestCase):\n@@ -15,3 +15,9 @@ def test_force_bytes_exception(self):\n         exc = ValueError(error_msg)\n         result = force_bytes(exc)\n         self.assertEqual(result, error_msg.encode('utf-8'))\n+\n+    def test_filepath_to_uri(self):\n+        self.assertEqual(filepath_to_uri('upload\\\\чубака.mp4'),\n+            'upload/%D1%87%D1%83%D0%B1%D0%B0%D0%BA%D0%B0.mp4')\n+        self.assertEqual(filepath_to_uri('upload\\\\чубака.mp4'.encode('utf-8')),\n+            'upload/%D1%87%D1%83%D0%B1%D0%B0%D0%BA%D0%B0.mp4')"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 8,
        "deletions": 2
    }
}