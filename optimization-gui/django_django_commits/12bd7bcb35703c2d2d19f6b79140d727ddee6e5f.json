{
    "author": "freakboy3742",
    "message": "Fixed #12004 -- Improved error reporting when an abstract class is registered with the admin. Thanks to Matt Smalley for the report, and to mk and Julien Phalip for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15636 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "12bd7bcb35703c2d2d19f6b79140d727ddee6e5f",
    "files": [
        {
            "sha": "4585627a0b08c893991ad28df5720f0bb6e413b1",
            "filename": "django/contrib/admin/sites.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/12bd7bcb35703c2d2d19f6b79140d727ddee6e5f/django%2Fcontrib%2Fadmin%2Fsites.py",
            "raw_url": "https://github.com/django/django/raw/12bd7bcb35703c2d2d19f6b79140d727ddee6e5f/django%2Fcontrib%2Fadmin%2Fsites.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fsites.py?ref=12bd7bcb35703c2d2d19f6b79140d727ddee6e5f",
            "patch": "@@ -61,6 +61,8 @@ def register(self, model_or_iterable, admin_class=None, **options):\n         they'll be applied as options to the admin class.\n \n         If a model is already registered, this will raise AlreadyRegistered.\n+\n+        If a model is abstract, this will raise ImproperlyConfigured.\n         \"\"\"\n         if not admin_class:\n             admin_class = ModelAdmin\n@@ -74,6 +76,10 @@ def register(self, model_or_iterable, admin_class=None, **options):\n         if isinstance(model_or_iterable, ModelBase):\n             model_or_iterable = [model_or_iterable]\n         for model in model_or_iterable:\n+            if model._meta.abstract:\n+                raise ImproperlyConfigured('The model %s is abstract, so it '\n+                      'cannot be registered with admin.' % model.__name__)\n+\n             if model in self._registry:\n                 raise AlreadyRegistered('The model %s is already registered' % model.__name__)\n "
        },
        {
            "sha": "61689f31b72918a444d3705555d37cfc79ed8ff9",
            "filename": "tests/regressiontests/admin_registration/models.py",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/12bd7bcb35703c2d2d19f6b79140d727ddee6e5f/tests%2Fregressiontests%2Fadmin_registration%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/12bd7bcb35703c2d2d19f6b79140d727ddee6e5f/tests%2Fregressiontests%2Fadmin_registration%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_registration%2Fmodels.py?ref=12bd7bcb35703c2d2d19f6b79140d727ddee6e5f",
            "patch": "@@ -7,5 +7,9 @@\n class Person(models.Model):\n     name = models.CharField(max_length=200)\n \n-class Place(models.Model):\n+class Location(models.Model):\n+    class Meta:\n+        abstract = True\n+\n+class Place(Location):\n     name = models.CharField(max_length=200)"
        },
        {
            "sha": "92e9d8a21e591953af4b40eb57b0baa9ad80cfd1",
            "filename": "tests/regressiontests/admin_registration/tests.py",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/12bd7bcb35703c2d2d19f6b79140d727ddee6e5f/tests%2Fregressiontests%2Fadmin_registration%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/12bd7bcb35703c2d2d19f6b79140d727ddee6e5f/tests%2Fregressiontests%2Fadmin_registration%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_registration%2Ftests.py?ref=12bd7bcb35703c2d2d19f6b79140d727ddee6e5f",
            "patch": "@@ -1,8 +1,8 @@\n from django.test import TestCase\n-\n+from django.core.exceptions import ImproperlyConfigured\n from django.contrib import admin\n \n-from models import Person, Place\n+from models import Person, Place, Location\n \n class NameAdmin(admin.ModelAdmin):\n     list_display = ['name']\n@@ -52,3 +52,10 @@ def test_iterable_registration(self):\n             isinstance(self.site._registry[Place], admin.options.ModelAdmin)\n         )\n         self.assertEqual(self.site._registry[Place].search_fields, ['name'])\n+\n+    def test_abstract_model(self):\n+        \"\"\"\n+        Exception is raised when trying to register an abstract model.\n+        Refs #12004.\n+        \"\"\"\n+        self.assertRaises(ImproperlyConfigured, self.site.register, Location)"
        }
    ],
    "stats": {
        "total": 23,
        "additions": 20,
        "deletions": 3
    }
}