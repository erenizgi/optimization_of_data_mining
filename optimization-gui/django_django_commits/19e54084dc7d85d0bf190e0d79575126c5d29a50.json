{
    "author": "aaugustin",
    "message": "Fixed #17114 -- Handled integer values 0 and 1 for checkboxes like other integer values, not like False and True.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17132 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "19e54084dc7d85d0bf190e0d79575126c5d29a50",
    "files": [
        {
            "sha": "57a6b4566a7adba81334b9634f9fe08ad31f237e",
            "filename": "django/forms/widgets.py",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/19e54084dc7d85d0bf190e0d79575126c5d29a50/django%2Fforms%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/19e54084dc7d85d0bf190e0d79575126c5d29a50/django%2Fforms%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fwidgets.py?ref=19e54084dc7d85d0bf190e0d79575126c5d29a50",
            "patch": "@@ -464,11 +464,14 @@ def _has_changed(self, initial, data):\n         return super(TimeInput, self)._has_changed(self._format_value(initial), data)\n \n class CheckboxInput(Widget):\n-    def __init__(self, attrs=None, check_test=bool):\n+    def __init__(self, attrs=None, check_test=None):\n         super(CheckboxInput, self).__init__(attrs)\n         # check_test is a callable that takes a value and returns True\n         # if the checkbox should be checked for that value.\n-        self.check_test = check_test\n+        if check_test is None:\n+            self.check_test = lambda v: not (v is False or v is None or v == '')\n+        else:\n+            self.check_test = check_test\n \n     def render(self, name, value, attrs=None):\n         final_attrs = self.build_attrs(attrs, type='checkbox', name=name)\n@@ -478,7 +481,7 @@ def render(self, name, value, attrs=None):\n             result = False\n         if result:\n             final_attrs['checked'] = 'checked'\n-        if value not in ('', True, False, None):\n+        if not (value is True or value is False or value is None or value == ''):\n             # Only add the 'value' attribute if a value is non-empty.\n             final_attrs['value'] = force_unicode(value)\n         return mark_safe(u'<input%s />' % flatatt(final_attrs))"
        },
        {
            "sha": "ac78ad701b58d7a6f19c0928b4e92ef418c55e1b",
            "filename": "tests/regressiontests/forms/tests/widgets.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/19e54084dc7d85d0bf190e0d79575126c5d29a50/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/19e54084dc7d85d0bf190e0d79575126c5d29a50/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py?ref=19e54084dc7d85d0bf190e0d79575126c5d29a50",
            "patch": "@@ -195,6 +195,10 @@ def test_checkboxinput(self):\n \n         self.assertEqual(w.render('is_cool', False, attrs={'class': 'pretty'}), u'<input type=\"checkbox\" name=\"is_cool\" class=\"pretty\" />')\n \n+        # regression for #17114\n+        self.assertEqual(w.render('is_cool', 0), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" value=\"0\" />')\n+        self.assertEqual(w.render('is_cool', 1), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" value=\"1\" />')\n+\n         # You can also pass 'attrs' to the constructor:\n         w = CheckboxInput(attrs={'class': 'pretty'})\n         self.assertEqual(w.render('is_cool', ''), u'<input type=\"checkbox\" class=\"pretty\" name=\"is_cool\" />')"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 10,
        "deletions": 3
    }
}