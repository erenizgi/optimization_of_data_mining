{
    "author": "unknown",
    "message": "Fixed #16319 -- added SuccessMessageMixin to contrib.messages\n\nThanks martinogden for the initial patch and d1ffuz0r for tests.",
    "sha": "9a85ad89c20e88340cdba85b8e9f5806c95835db",
    "files": [
        {
            "sha": "2790963abe337c5cc9ad0ba043cdd56c6aba8696",
            "filename": "AUTHORS",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/9a85ad89c20e88340cdba85b8e9f5806c95835db/AUTHORS",
            "raw_url": "https://github.com/django/django/raw/9a85ad89c20e88340cdba85b8e9f5806c95835db/AUTHORS",
            "contents_url": "https://api.github.com/repos/django/django/contents/AUTHORS?ref=9a85ad89c20e88340cdba85b8e9f5806c95835db",
            "patch": "@@ -607,6 +607,7 @@ answer newbie questions, and generally made Django that much better:\n     Cheng Zhang\n     Hannes Stru√ü <x@hannesstruss.de>\n     Deric Crago <deric.crago@gmail.com>\n+    Paul Collins <paul.collins.iii@gmail.com>\n \n A big THANK YOU goes to:\n "
        },
        {
            "sha": "25a0f9aa25738c1c2f5f68904be193d8e75ff27b",
            "filename": "django/contrib/messages/tests/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/9a85ad89c20e88340cdba85b8e9f5806c95835db/django%2Fcontrib%2Fmessages%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/9a85ad89c20e88340cdba85b8e9f5806c95835db/django%2Fcontrib%2Fmessages%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fmessages%2Ftests%2F__init__.py?ref=9a85ad89c20e88340cdba85b8e9f5806c95835db",
            "patch": "@@ -2,3 +2,4 @@\n from django.contrib.messages.tests.fallback import FallbackTest\n from django.contrib.messages.tests.middleware import MiddlewareTest\n from django.contrib.messages.tests.session import SessionTest\n+from django.contrib.messages.tests.mixins import SuccessMessageMixinTests"
        },
        {
            "sha": "8eef4cb3dcf96fd70197ef45e0f2b79994dbe6fa",
            "filename": "django/contrib/messages/tests/mixins.py",
            "status": "added",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/9a85ad89c20e88340cdba85b8e9f5806c95835db/django%2Fcontrib%2Fmessages%2Ftests%2Fmixins.py",
            "raw_url": "https://github.com/django/django/raw/9a85ad89c20e88340cdba85b8e9f5806c95835db/django%2Fcontrib%2Fmessages%2Ftests%2Fmixins.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fmessages%2Ftests%2Fmixins.py?ref=9a85ad89c20e88340cdba85b8e9f5806c95835db",
            "patch": "@@ -0,0 +1,14 @@\n+from django.test.testcases import TestCase\n+from django.contrib.messages.tests.urls import ContactFormViewWithMsg\n+from django.core.urlresolvers import reverse\n+\n+class SuccessMessageMixinTests(TestCase):\n+    urls = 'django.contrib.messages.tests.urls'\n+\n+    def test_set_messages_success(self):\n+        author = {'name': 'John Doe',\n+                  'slug': 'success-msg'}\n+        add_url = reverse('add_success_msg')\n+        req = self.client.post(add_url, author)\n+        self.assertIn(ContactFormViewWithMsg.success_message % author,\n+                      req.cookies['messages'].value)"
        },
        {
            "sha": "0541b5a336e15a1418797c91d87b7fdb31a2e565",
            "filename": "django/contrib/messages/tests/urls.py",
            "status": "modified",
            "additions": 17,
            "deletions": 1,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/9a85ad89c20e88340cdba85b8e9f5806c95835db/django%2Fcontrib%2Fmessages%2Ftests%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/9a85ad89c20e88340cdba85b8e9f5806c95835db/django%2Fcontrib%2Fmessages%2Ftests%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fmessages%2Ftests%2Furls.py?ref=9a85ad89c20e88340cdba85b8e9f5806c95835db",
            "patch": "@@ -1,10 +1,13 @@\n-from django.conf.urls import patterns\n+from django.conf.urls import patterns, url\n from django.contrib import messages\n from django.core.urlresolvers import reverse\n+from django import forms\n from django.http import HttpResponseRedirect, HttpResponse\n from django.template import RequestContext, Template\n from django.template.response import TemplateResponse\n from django.views.decorators.cache import never_cache\n+from django.contrib.messages.views import SuccessMessageMixin\n+from django.views.generic.edit import FormView\n \n TEMPLATE = \"\"\"{% if messages %}\n <ul class=\"messages\">\n@@ -49,8 +52,21 @@ def show(request):\n def show_template_response(request):\n     return TemplateResponse(request, Template(TEMPLATE))\n \n+\n+class ContactForm(forms.Form):\n+    name = forms.CharField(required=True)\n+    slug = forms.SlugField(required=True)\n+\n+\n+class ContactFormViewWithMsg(SuccessMessageMixin, FormView):\n+    form_class = ContactForm\n+    success_url = show\n+    success_message = \"%(name)s was created successfully\"\n+\n+\n urlpatterns = patterns('',\n     ('^add/(debug|info|success|warning|error)/$', add),\n+    url('^add/msg/$', ContactFormViewWithMsg.as_view(), name='add_success_msg'),\n     ('^show/$', show),\n     ('^template_response/add/(debug|info|success|warning|error)/$', add_template_response),\n     ('^template_response/show/$', show_template_response),"
        },
        {
            "sha": "d08804aa1d0caaa76f23c40e745b8e9fb359e624",
            "filename": "django/contrib/messages/views.py",
            "status": "added",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/django/django/blob/9a85ad89c20e88340cdba85b8e9f5806c95835db/django%2Fcontrib%2Fmessages%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/9a85ad89c20e88340cdba85b8e9f5806c95835db/django%2Fcontrib%2Fmessages%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fmessages%2Fviews.py?ref=9a85ad89c20e88340cdba85b8e9f5806c95835db",
            "patch": "@@ -0,0 +1,19 @@\n+from django.views.generic.edit import FormMixin\n+from django.contrib import messages\n+\n+\n+class SuccessMessageMixin(FormMixin):\n+    \"\"\"\n+    Adds a success message on successful form submission.\n+    \"\"\"\n+    success_message = ''\n+\n+    def form_valid(self, form):\n+        response = super(SuccessMessageMixin, self).form_valid(form)\n+        success_message = self.get_success_message(form.cleaned_data)\n+        if success_message:\n+            messages.success(self.request, success_message)\n+        return response\n+\n+    def get_success_message(self, cleaned_data):\n+        return self.success_message % cleaned_data"
        },
        {
            "sha": "0dd732bec2c42635eec05bf467429f6ee44d464d",
            "filename": "docs/ref/contrib/messages.txt",
            "status": "modified",
            "additions": 47,
            "deletions": 0,
            "changes": 47,
            "blob_url": "https://github.com/django/django/blob/9a85ad89c20e88340cdba85b8e9f5806c95835db/docs%2Fref%2Fcontrib%2Fmessages.txt",
            "raw_url": "https://github.com/django/django/raw/9a85ad89c20e88340cdba85b8e9f5806c95835db/docs%2Fref%2Fcontrib%2Fmessages.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fmessages.txt?ref=9a85ad89c20e88340cdba85b8e9f5806c95835db",
            "patch": "@@ -286,6 +286,53 @@ example::\n    use one of the ``add_message`` family of methods. It does not hide failures\n    that may occur for other reasons.\n \n+Adding messages in Class Based Views\n+------------------------------------\n+\n+.. versionadded:: 1.6\n+\n+.. class:: django.contrib.messages.views.SuccessMessageMixin\n+\n+    Adds a success message attribute to\n+    :class:`~django.views.generic.edit.FormView` based classes\n+\n+    .. method:: get_success_message(cleaned_data)\n+\n+        ``cleaned_data`` is the cleaned data from the form which is used for\n+        string formatting\n+\n+**Example views.py**::\n+\n+    from django.contrib.messages.views import SuccessMessageMixin\n+    from django.views.generic.edit import CreateView\n+    from myapp.models import Author\n+\n+    class AuthorCreate(SuccessMessageMixin, CreateView):\n+        model = Author\n+        success_url = '/success/'\n+        success_message = \"%(name)s was created successfully\"\n+\n+The cleaned data from the ``form`` is available for string interpolation using\n+the ``%(field_name)s`` syntax. For ModelForms, if you need access to fields\n+from the saved ``object`` override the\n+:meth:`~django.contrib.messages.views.SuccessMessageMixin.get_success_message`\n+method.\n+\n+**Example views.py for ModelForms**::\n+\n+    from django.contrib.messages.views import SuccessMessageMixin\n+    from django.views.generic.edit import CreateView\n+    from myapp.models import ComplicatedModel\n+\n+    class ComplicatedCreate(SuccessMessageMixin, CreateView):\n+        model = ComplicatedModel\n+        success_url = '/success/'\n+        success_message = \"%(calculated_field)s was created successfully\"\n+\n+        def get_success_message(self, cleaned_data):\n+            return self.success_message % dict(cleaned_data,\n+                                               calculated_field=self.object.calculated_field)\n+\n Expiration of messages\n ======================\n "
        },
        {
            "sha": "3e6c3b8bfb52363c8aa33f17954847d2f35ffbfc",
            "filename": "docs/releases/1.6.txt",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/9a85ad89c20e88340cdba85b8e9f5806c95835db/docs%2Freleases%2F1.6.txt",
            "raw_url": "https://github.com/django/django/raw/9a85ad89c20e88340cdba85b8e9f5806c95835db/docs%2Freleases%2F1.6.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.6.txt?ref=9a85ad89c20e88340cdba85b8e9f5806c95835db",
            "patch": "@@ -126,6 +126,10 @@ Minor features\n * The ``MemcachedCache`` cache backend now uses the latest :mod:`pickle`\n   protocol available.\n \n+* Added :class:`~django.contrib.messages.views.SuccessMessageMixin` which\n+  provides a ``success_message`` attribute for\n+  :class:`~django.view.generic.edit.FormView` based classes.\n+\n * Added the :attr:`django.db.models.ForeignKey.db_constraint` and\n   :attr:`django.db.models.ManyToManyField.db_constraint` options.\n "
        },
        {
            "sha": "856565a953dc590835be200f6dc4052d6938ec12",
            "filename": "tests/generic_views/views.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/9a85ad89c20e88340cdba85b8e9f5806c95835db/tests%2Fgeneric_views%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/9a85ad89c20e88340cdba85b8e9f5806c95835db/tests%2Fgeneric_views%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fgeneric_views%2Fviews.py?ref=9a85ad89c20e88340cdba85b8e9f5806c95835db",
            "patch": "@@ -1,6 +1,7 @@\n from __future__ import absolute_import\n \n from django.contrib.auth.decorators import login_required\n+from django.contrib.messages.views import SuccessMessageMixin\n from django.core.paginator import Paginator\n from django.core.urlresolvers import reverse, reverse_lazy\n from django.utils.decorators import method_decorator"
        }
    ],
    "stats": {
        "total": 105,
        "additions": 104,
        "deletions": 1
    }
}