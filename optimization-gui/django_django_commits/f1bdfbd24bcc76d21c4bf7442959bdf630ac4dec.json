{
    "author": "claudep",
    "message": "Document and test 'type' usage in Widget attrs\n\nRefs #16630.",
    "sha": "f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec",
    "files": [
        {
            "sha": "124e4f669adb750822338da51c0f5e4b8ae4e8d1",
            "filename": "django/forms/fields.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec/django%2Fforms%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec/django%2Fforms%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Ffields.py?ref=f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec",
            "patch": "@@ -199,7 +199,7 @@ def to_python(self, value):\n \n     def widget_attrs(self, widget):\n         attrs = super(CharField, self).widget_attrs(widget)\n-        if self.max_length is not None and isinstance(widget, (TextInput, PasswordInput)):\n+        if self.max_length is not None and isinstance(widget, TextInput):\n             # The HTML attribute is maxlength, not max_length.\n             attrs.update({'maxlength': str(self.max_length)})\n         return attrs"
        },
        {
            "sha": "763da0cff22aa0a5ea4261b35a8d5119e76c2129",
            "filename": "django/forms/widgets.py",
            "status": "modified",
            "additions": 11,
            "deletions": 7,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec/django%2Fforms%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec/django%2Fforms%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fwidgets.py?ref=f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec",
            "patch": "@@ -260,10 +260,17 @@ def render(self, name, value, attrs=None):\n             final_attrs['value'] = force_text(self._format_value(value))\n         return format_html('<input{0} />', flatatt(final_attrs))\n \n+\n class TextInput(Input):\n     input_type = 'text'\n \n-class PasswordInput(Input):\n+    def __init__(self, attrs=None):\n+        if attrs is not None:\n+            self.input_type = attrs.pop('type', self.input_type)\n+        super(TextInput, self).__init__(attrs)\n+\n+\n+class PasswordInput(TextInput):\n     input_type = 'password'\n \n     def __init__(self, attrs=None, render_value=False):\n@@ -400,9 +407,8 @@ def render(self, name, value, attrs=None):\n                            flatatt(final_attrs),\n                            force_text(value))\n \n-class DateInput(Input):\n-    input_type = 'text'\n \n+class DateInput(TextInput):\n     def __init__(self, attrs=None, format=None):\n         super(DateInput, self).__init__(attrs)\n         if format:\n@@ -431,9 +437,8 @@ def _has_changed(self, initial, data):\n             pass\n         return super(DateInput, self)._has_changed(self._format_value(initial), data)\n \n-class DateTimeInput(Input):\n-    input_type = 'text'\n \n+class DateTimeInput(TextInput):\n     def __init__(self, attrs=None, format=None):\n         super(DateTimeInput, self).__init__(attrs)\n         if format:\n@@ -462,9 +467,8 @@ def _has_changed(self, initial, data):\n             pass\n         return super(DateTimeInput, self)._has_changed(self._format_value(initial), data)\n \n-class TimeInput(Input):\n-    input_type = 'text'\n \n+class TimeInput(TextInput):\n     def __init__(self, attrs=None, format=None):\n         super(TimeInput, self).__init__(attrs)\n         if format:"
        },
        {
            "sha": "1935cb23bc1b38ba34c08da7e574c79046cb4e5c",
            "filename": "docs/ref/forms/widgets.txt",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec/docs%2Fref%2Fforms%2Fwidgets.txt",
            "raw_url": "https://github.com/django/django/raw/f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec/docs%2Fref%2Fforms%2Fwidgets.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fforms%2Fwidgets.txt?ref=f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec",
            "patch": "@@ -126,8 +126,9 @@ provided for each widget will be rendered exactly the same::\n \n On a real Web page, you probably don't want every widget to look the same. You\n might want a larger input element for the comment, and you might want the\n-'name' widget to have some special CSS class. To do this, you use the\n-:attr:`Widget.attrs` argument when creating the widget:\n+'name' widget to have some special CSS class. It is also possible to specify\n+the 'type' attribute to take advantage of the new HTML5 input types.  To do\n+this, you use the :attr:`Widget.attrs` argument when creating the widget:\n \n For example::\n \n@@ -245,7 +246,7 @@ commonly used groups of widgets:\n \n     Date input as a simple text box: ``<input type='text' ...>``\n \n-    Takes one optional argument:\n+    Takes same arguments as :class:`TextInput`, with one more optional argument:\n \n     .. attribute:: DateInput.format\n \n@@ -262,7 +263,7 @@ commonly used groups of widgets:\n \n     Date/time input as a simple text box: ``<input type='text' ...>``\n \n-    Takes one optional argument:\n+    Takes same arguments as :class:`TextInput`, with one more optional argument:\n \n     .. attribute:: DateTimeInput.format\n \n@@ -279,7 +280,7 @@ commonly used groups of widgets:\n \n     Time input as a simple text box: ``<input type='text' ...>``\n \n-    Takes one optional argument:\n+    Takes same arguments as :class:`TextInput`, with one more optional argument:\n \n     .. attribute:: TimeInput.format\n "
        },
        {
            "sha": "104144b288101d39daa074c5e0601cbcab61e51e",
            "filename": "tests/regressiontests/forms/tests/widgets.py",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py?ref=f1bdfbd24bcc76d21c4bf7442959bdf630ac4dec",
            "patch": "@@ -31,9 +31,9 @@ def test_textinput(self):\n         self.assertHTMLEqual(w.render('email', 'ŠĐĆŽćžšđ', attrs={'class': 'fun'}), '<input type=\"text\" name=\"email\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" class=\"fun\" />')\n \n         # You can also pass 'attrs' to the constructor:\n-        w = TextInput(attrs={'class': 'fun'})\n-        self.assertHTMLEqual(w.render('email', ''), '<input type=\"text\" class=\"fun\" name=\"email\" />')\n-        self.assertHTMLEqual(w.render('email', 'foo@example.com'), '<input type=\"text\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n+        w = TextInput(attrs={'class': 'fun', 'type': 'email'})\n+        self.assertHTMLEqual(w.render('email', ''), '<input type=\"email\" class=\"fun\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'foo@example.com'), '<input type=\"email\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n \n         # 'attrs' passed to render() get precedence over those passed to the constructor:\n         w = TextInput(attrs={'class': 'pretty'})\n@@ -915,8 +915,8 @@ def test_datetimeinput(self):\n         self.assertHTMLEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51)), '<input type=\"text\" name=\"date\" value=\"2007-09-17 12:51:00\" />')\n \n         # Use 'format' to change the way a value is displayed.\n-        w = DateTimeInput(format='%d/%m/%Y %H:%M')\n-        self.assertHTMLEqual(w.render('date', d), '<input type=\"text\" name=\"date\" value=\"17/09/2007 12:51\" />')\n+        w = DateTimeInput(format='%d/%m/%Y %H:%M', attrs={'type': 'datetime'})\n+        self.assertHTMLEqual(w.render('date', d), '<input type=\"datetime\" name=\"date\" value=\"17/09/2007 12:51\" />')\n         self.assertFalse(w._has_changed(d, '17/09/2007 12:51'))\n \n         # Make sure a custom format works with _has_changed. The hidden input will use\n@@ -938,8 +938,8 @@ def test_dateinput(self):\n         self.assertHTMLEqual(w.render('date', '2007-09-17'), '<input type=\"text\" name=\"date\" value=\"2007-09-17\" />')\n \n         # Use 'format' to change the way a value is displayed.\n-        w = DateInput(format='%d/%m/%Y')\n-        self.assertHTMLEqual(w.render('date', d), '<input type=\"text\" name=\"date\" value=\"17/09/2007\" />')\n+        w = DateInput(format='%d/%m/%Y', attrs={'type': 'date'})\n+        self.assertHTMLEqual(w.render('date', d), '<input type=\"date\" name=\"date\" value=\"17/09/2007\" />')\n         self.assertFalse(w._has_changed(d, '17/09/2007'))\n \n         # Make sure a custom format works with _has_changed. The hidden input will use\n@@ -963,8 +963,8 @@ def test_timeinput(self):\n         self.assertHTMLEqual(w.render('time', '13:12:11'), '<input type=\"text\" name=\"time\" value=\"13:12:11\" />')\n \n         # Use 'format' to change the way a value is displayed.\n-        w = TimeInput(format='%H:%M')\n-        self.assertHTMLEqual(w.render('time', t), '<input type=\"text\" name=\"time\" value=\"12:51\" />')\n+        w = TimeInput(format='%H:%M', attrs={'type': 'time'})\n+        self.assertHTMLEqual(w.render('time', t), '<input type=\"time\" name=\"time\" value=\"12:51\" />')\n         self.assertFalse(w._has_changed(t, '12:51'))\n \n         # Make sure a custom format works with _has_changed. The hidden input will use"
        }
    ],
    "stats": {
        "total": 49,
        "additions": 27,
        "deletions": 22
    }
}