{
    "author": "jphalip",
    "message": "Fixed #17278 -- Enabled the spatialite GIS tests to run without having to specify a database name in the settings. Thanks to Aymeric for the report and to Ramiro for the initial patch.",
    "sha": "675431dfaaa7fc9fbd89be2602332287489ee04f",
    "files": [
        {
            "sha": "27332b9b57f95eadf36fcd382f2b8916f4b9a74a",
            "filename": "django/contrib/gis/db/backends/spatialite/creation.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/675431dfaaa7fc9fbd89be2602332287489ee04f/django%2Fcontrib%2Fgis%2Fdb%2Fbackends%2Fspatialite%2Fcreation.py",
            "raw_url": "https://github.com/django/django/raw/675431dfaaa7fc9fbd89be2602332287489ee04f/django%2Fcontrib%2Fgis%2Fdb%2Fbackends%2Fspatialite%2Fcreation.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fdb%2Fbackends%2Fspatialite%2Fcreation.py?ref=675431dfaaa7fc9fbd89be2602332287489ee04f",
            "patch": "@@ -30,6 +30,7 @@ def create_test_db(self, verbosity=1, autoclobber=False):\n \n         self.connection.close()\n         self.connection.settings_dict[\"NAME\"] = test_database_name\n+        self.connection.ops.confirm_spatial_components_versions()\n \n         # Need to load the SpatiaLite initialization SQL before running `syncdb`.\n         self.load_spatialite_sql()"
        },
        {
            "sha": "80f05ef0762006547e1c5fa8ad05554d94274251",
            "filename": "django/contrib/gis/db/backends/spatialite/operations.py",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/675431dfaaa7fc9fbd89be2602332287489ee04f/django%2Fcontrib%2Fgis%2Fdb%2Fbackends%2Fspatialite%2Foperations.py",
            "raw_url": "https://github.com/django/django/raw/675431dfaaa7fc9fbd89be2602332287489ee04f/django%2Fcontrib%2Fgis%2Fdb%2Fbackends%2Fspatialite%2Foperations.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fdb%2Fbackends%2Fspatialite%2Foperations.py?ref=675431dfaaa7fc9fbd89be2602332287489ee04f",
            "patch": "@@ -113,6 +113,12 @@ class SpatiaLiteOperations(DatabaseOperations, BaseSpatialOperations):\n     def __init__(self, connection):\n         super(DatabaseOperations, self).__init__(connection)\n \n+        # Creating the GIS terms dictionary.\n+        gis_terms = ['isnull']\n+        gis_terms += self.geometry_functions.keys()\n+        self.gis_terms = dict([(term, None) for term in gis_terms])\n+\n+    def confirm_spatial_components_versions(self):\n         # Determine the version of the SpatiaLite library.\n         try:\n             vtup = self.spatialite_version_tuple()\n@@ -129,11 +135,6 @@ def __init__(self, connection):\n                                        'SQL loaded on this database?' %\n                                        (self.connection.settings_dict['NAME'], msg))\n \n-        # Creating the GIS terms dictionary.\n-        gis_terms = ['isnull']\n-        gis_terms += list(self.geometry_functions)\n-        self.gis_terms = dict([(term, None) for term in gis_terms])\n-\n         if version >= (2, 4, 0):\n             # Spatialite 2.4.0-RC4 added AsGML and AsKML, however both\n             # RC2 (shipped in popular Debian/Ubuntu packages) and RC4"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 7,
        "deletions": 5
    }
}