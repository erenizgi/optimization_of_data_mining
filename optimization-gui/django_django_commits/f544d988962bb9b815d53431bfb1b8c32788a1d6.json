{
    "author": "alex",
    "message": "2 small optimizations: a) move an import out of a function, b) remove a cache that did nothing, tiny tiny speed up on CPython, but a big one on PyPy\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15175 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "f544d988962bb9b815d53431bfb1b8c32788a1d6",
    "files": [
        {
            "sha": "d2d5c7d056cfd126e9bfe24ad49a3b3a64ea516a",
            "filename": "django/db/backends/__init__.py",
            "status": "modified",
            "additions": 6,
            "deletions": 7,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/f544d988962bb9b815d53431bfb1b8c32788a1d6/django%2Fdb%2Fbackends%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/f544d988962bb9b815d53431bfb1b8c32788a1d6/django%2Fdb%2Fbackends%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fbackends%2F__init__.py?ref=f544d988962bb9b815d53431bfb1b8c32788a1d6",
            "patch": "@@ -1,11 +1,13 @@\n import decimal\n from threading import local\n \n+from django.conf import settings\n from django.db import DEFAULT_DB_ALIAS\n from django.db.backends import util\n from django.utils import datetime_safe\n from django.utils.importlib import import_module\n \n+\n class BaseDatabaseWrapper(local):\n     \"\"\"\n     Represents a database connection.\n@@ -73,7 +75,6 @@ def close(self):\n             self.connection = None\n \n     def cursor(self):\n-        from django.conf import settings\n         cursor = self._cursor()\n         if (self.use_debug_cursor or\n             (self.use_debug_cursor is None and settings.DEBUG)):\n@@ -205,7 +206,7 @@ class BaseDatabaseOperations(object):\n     compiler_module = \"django.db.models.sql.compiler\"\n \n     def __init__(self):\n-        self._cache = {}\n+        self._cache = None\n \n     def autoinc_sql(self, table, column):\n         \"\"\"\n@@ -388,11 +389,9 @@ def compiler(self, compiler_name):\n         in the namespace corresponding to the `compiler_module` attribute\n         on this backend.\n         \"\"\"\n-        if compiler_name not in self._cache:\n-            self._cache[compiler_name] = getattr(\n-                import_module(self.compiler_module), compiler_name\n-            )\n-        return self._cache[compiler_name]\n+        if self._cache is None:\n+            self._cache = import_module(self.compiler_module)\n+        return getattr(self._cache, compiler_name)\n \n     def quote_name(self, name):\n         \"\"\""
        }
    ],
    "stats": {
        "total": 13,
        "additions": 6,
        "deletions": 7
    }
}