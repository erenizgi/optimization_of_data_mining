{
    "author": "claudep",
    "message": "Fixed #18463 -- Forced type() argument to be a byte string",
    "sha": "3dd5d726d1c3bf8f5901c992d7586e5ec146bc2d",
    "files": [
        {
            "sha": "a7c176fd8f6d710471cf324b851ab4a3f1fc05f5",
            "filename": "django/db/models/query_utils.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/3dd5d726d1c3bf8f5901c992d7586e5ec146bc2d/django%2Fdb%2Fmodels%2Fquery_utils.py",
            "raw_url": "https://github.com/django/django/raw/3dd5d726d1c3bf8f5901c992d7586e5ec146bc2d/django%2Fdb%2Fmodels%2Fquery_utils.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fquery_utils.py?ref=3dd5d726d1c3bf8f5901c992d7586e5ec146bc2d",
            "patch": "@@ -5,6 +5,7 @@\n large and/or so that they can be used by other modules without getting into\n circular import difficulties.\n \"\"\"\n+from __future__ import unicode_literals\n \n from django.db.backends import util\n from django.utils import tree\n@@ -177,7 +178,7 @@ class Meta:\n     overrides[\"Meta\"] = Meta\n     overrides[\"__module__\"] = model.__module__\n     overrides[\"_deferred\"] = True\n-    return type(name, (model,), overrides)\n+    return type(str(name), (model,), overrides)\n \n # The above function is also used to unpickle model instances with deferred\n # fields."
        },
        {
            "sha": "1f07d4c9a88c6d67e6373a6acf812165bdca5e26",
            "filename": "tests/regressiontests/defer_regress/tests.py",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/3dd5d726d1c3bf8f5901c992d7586e5ec146bc2d/tests%2Fregressiontests%2Fdefer_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/3dd5d726d1c3bf8f5901c992d7586e5ec146bc2d/tests%2Fregressiontests%2Fdefer_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fdefer_regress%2Ftests.py?ref=3dd5d726d1c3bf8f5901c992d7586e5ec146bc2d",
            "patch": "@@ -174,3 +174,10 @@ def test_resolve_columns(self):\n         qs = ResolveThis.objects.defer('num')\n         self.assertEqual(1, qs.count())\n         self.assertEqual('Foobar', qs[0].name)\n+\n+    def test_deferred_class_factory(self):\n+        from django.db.models.query_utils import deferred_class_factory\n+        new_class = deferred_class_factory(Item,\n+            ('this_is_some_very_long_attribute_name_so_modelname_truncation_is_triggered',))\n+        self.assertEqual(new_class.__name__,\n+            'Item_Deferred_this_is_some_very_long_attribute_nac34b1f495507dad6b02e2cb235c875e')"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 9,
        "deletions": 1
    }
}