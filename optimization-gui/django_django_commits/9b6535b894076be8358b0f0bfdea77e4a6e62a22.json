{
    "author": "jezdez",
    "message": "Fixed #7077 and #7431 -- Use getpass.getuser instead of pwd.getpwuid to determine the current system user's username in the createsuperuser management command to enable the feature on Windows. getpass.getuser automatically falls back to the previous method.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@14607 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "9b6535b894076be8358b0f0bfdea77e4a6e62a22",
    "files": [
        {
            "sha": "9939e3da77e65c4d27d91e5473bd950cef2f9851",
            "filename": "django/contrib/auth/management/commands/createsuperuser.py",
            "status": "modified",
            "additions": 8,
            "deletions": 10,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/9b6535b894076be8358b0f0bfdea77e4a6e62a22/django%2Fcontrib%2Fauth%2Fmanagement%2Fcommands%2Fcreatesuperuser.py",
            "raw_url": "https://github.com/django/django/raw/9b6535b894076be8358b0f0bfdea77e4a6e62a22/django%2Fcontrib%2Fauth%2Fmanagement%2Fcommands%2Fcreatesuperuser.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fmanagement%2Fcommands%2Fcreatesuperuser.py?ref=9b6535b894076be8358b0f0bfdea77e4a6e62a22",
            "patch": "@@ -3,7 +3,6 @@\n \"\"\"\n \n import getpass\n-import os\n import re\n import sys\n from optparse import make_option\n@@ -30,10 +29,10 @@ class Command(BaseCommand):\n         make_option('--email', dest='email', default=None,\n             help='Specifies the email address for the superuser.'),\n         make_option('--noinput', action='store_false', dest='interactive', default=True,\n-            help='Tells Django to NOT prompt the user for input of any kind. '    \\\n-                 'You must use --username and --email with --noinput, and '      \\\n-                 'superusers created with --noinput will not be able to log in '  \\\n-                 'until they\\'re given a valid password.'),\n+            help=('Tells Django to NOT prompt the user for input of any kind. '\n+                  'You must use --username and --email with --noinput, and '\n+                  'superusers created with --noinput will not be able to log '\n+                  'in until they\\'re given a valid password.')),\n     )\n     help = 'Used to create a superuser.'\n \n@@ -58,12 +57,11 @@ def handle(self, *args, **options):\n \n         # Try to determine the current system user's username to use as a default.\n         try:\n-            import pwd\n-            default_username = pwd.getpwuid(os.getuid())[0].replace(' ', '').lower()\n+            default_username = getpass.getuser().replace(' ', '').lower()\n         except (ImportError, KeyError):\n-            # KeyError will be raised by getpwuid() if there is no\n-            # corresponding entry in the /etc/passwd file (a very restricted\n-            # chroot environment, for example).\n+            # KeyError will be raised by os.getpwuid() (called by getuser())\n+            # if there is no corresponding entry in the /etc/passwd file\n+            # (a very restricted chroot environment, for example).\n             default_username = ''\n \n         # Determine whether the default username is taken, so we don't display"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 8,
        "deletions": 10
    }
}