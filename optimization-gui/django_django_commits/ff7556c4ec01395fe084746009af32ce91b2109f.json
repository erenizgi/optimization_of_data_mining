{
    "author": "ramiro",
    "message": "Fixed #11240 -- Made makemessages i18n command escape % symbols in literals passed to the trans tag.\n\nThis avoids problems with unintended automatic detection, marking and\nvalidation of Python string formatting specifiers performed by\nxgettext(1)/msgfmt(1) that stem from the fact that under the hood makemessages\nconverts templates to Python code before passing them to xgettext.\n\nThis also makes it consistent with its behavior on literals passed to the\nblocktrans tag.\n\nThanks Jannis and claude for reviewing and feedback.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17190 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ff7556c4ec01395fe084746009af32ce91b2109f",
    "files": [
        {
            "sha": "3addf1ddfb5f93307fdc284091672b9d5fca644d",
            "filename": "django/utils/translation/trans_real.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ff7556c4ec01395fe084746009af32ce91b2109f/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "raw_url": "https://github.com/django/django/raw/ff7556c4ec01395fe084746009af32ce91b2109f/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2Ftrans_real.py?ref=ff7556c4ec01395fe084746009af32ce91b2109f",
            "patch": "@@ -439,6 +439,7 @@ def blankout(src, char):\n endblock_re = re.compile(r\"\"\"^\\s*endblocktrans$\"\"\")\n plural_re = re.compile(r\"\"\"^\\s*plural$\"\"\")\n constant_re = re.compile(r\"\"\"_\\(((?:\".*?\")|(?:'.*?'))\\)\"\"\")\n+one_percent_re = re.compile(r\"\"\"(?<!%)%(?!%)\"\"\")\n \n \n def templatize(src, origin=None):\n@@ -529,6 +530,7 @@ def templatize(src, origin=None):\n                         g = g.strip('\"')\n                     elif g[0] == \"'\":\n                         g = g.strip(\"'\")\n+                    g = one_percent_re.sub('%%', g)\n                     if imatch.group(2):\n                         # A context is provided\n                         context_match = context_re.match(imatch.group(2))"
        },
        {
            "sha": "1f38910b61de4552c1d8300f60f5c26b1c82b36b",
            "filename": "tests/regressiontests/i18n/commands/compilation.py",
            "status": "modified",
            "additions": 55,
            "deletions": 8,
            "changes": 63,
            "blob_url": "https://github.com/django/django/blob/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fcompilation.py",
            "raw_url": "https://github.com/django/django/raw/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fcompilation.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fcompilation.py?ref=ff7556c4ec01395fe084746009af32ce91b2109f",
            "patch": "@@ -7,29 +7,76 @@\n from django.core.management import CommandError\n from django.core.management.commands.compilemessages import compile_messages\n from django.test import TestCase\n+from django.test.utils import override_settings\n+from django.utils import translation\n \n-\n-LOCALE='es_AR'\n+test_dir = os.path.abspath(os.path.dirname(__file__))\n \n class MessageCompilationTests(TestCase):\n \n-    MO_FILE='locale/%s/LC_MESSAGES/django.mo' % LOCALE\n-\n     def setUp(self):\n         self._cwd = os.getcwd()\n-        self.test_dir = os.path.abspath(os.path.dirname(__file__))\n \n     def tearDown(self):\n         os.chdir(self._cwd)\n \n \n class PoFileTests(MessageCompilationTests):\n \n+    LOCALE='es_AR'\n+    MO_FILE='locale/%s/LC_MESSAGES/django.mo' % LOCALE\n+\n     def test_bom_rejection(self):\n-        os.chdir(self.test_dir)\n-        # We don't use the django.core.management intrastructure (call_command()\n+        os.chdir(test_dir)\n+        # We don't use the django.core.management infrastructure (call_command()\n         # et al) because CommandError's cause exit(1) there. We test the\n         # underlying compile_messages function instead\n         out = StringIO()\n-        self.assertRaises(CommandError, compile_messages, out, locale=LOCALE)\n+        self.assertRaises(CommandError, compile_messages, out, locale=self.LOCALE)\n         self.assertFalse(os.path.exists(self.MO_FILE))\n+\n+\n+class PoFileContentsTests(MessageCompilationTests):\n+    # Ticket #11240\n+\n+    LOCALE='fr'\n+    MO_FILE='locale/%s/LC_MESSAGES/django.mo' % LOCALE\n+\n+    def setUp(self):\n+        super(PoFileContentsTests, self).setUp()\n+        self.addCleanup(os.unlink, os.path.join(test_dir, self.MO_FILE))\n+\n+    def test_percent_symbol_in_po_file(self):\n+        os.chdir(test_dir)\n+        # We don't use the django.core.management infrastructure (call_command()\n+        # et al) because CommandError's cause exit(1) there. We test the\n+        # underlying compile_messages function instead\n+        out = StringIO()\n+        compile_messages(out, locale=self.LOCALE)\n+        self.assertTrue(os.path.exists(self.MO_FILE))\n+\n+\n+class PercentRenderingTests(MessageCompilationTests):\n+    # Ticket #11240 -- Testing rendering doesn't belong here but we are trying\n+    # to keep tests for all the stack together\n+\n+    LOCALE='it'\n+    MO_FILE='locale/%s/LC_MESSAGES/django.mo' % LOCALE\n+\n+    @override_settings(LOCALE_PATHS=(os.path.join(test_dir, 'locale'),))\n+    def test_percent_symbol_escaping(self):\n+        from django.template import Template, Context\n+        os.chdir(test_dir)\n+        # We don't use the django.core.management infrastructure (call_command()\n+        # et al) because CommandError's cause exit(1) there. We test the\n+        # underlying compile_messages function instead\n+        out = StringIO()\n+        compile_messages(out, locale=self.LOCALE)\n+        with translation.override(self.LOCALE):\n+            t = Template('{% load i18n %}{% trans \"Looks like a str fmt spec %% o but shouldn\\'t be interpreted as such\" %}')\n+            rendered = t.render(Context({}))\n+            self.assertEqual(rendered, 'IT translation contains %% for the above string')\n+\n+            t = Template('{% load i18n %}{% trans \"Completed 50%% of all the tasks\" %}')\n+            rendered = t.render(Context({}))\n+            self.assertEqual(rendered, 'IT translation of Completed 50%% of all the tasks')"
        },
        {
            "sha": "e6796d47f4a0c9d95a9219ed2a83d93586c332ba",
            "filename": "tests/regressiontests/i18n/commands/extraction.py",
            "status": "modified",
            "additions": 114,
            "deletions": 71,
            "changes": 185,
            "blob_url": "https://github.com/django/django/blob/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fextraction.py",
            "raw_url": "https://github.com/django/django/raw/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fextraction.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fextraction.py?ref=ff7556c4ec01395fe084746009af32ce91b2109f",
            "patch": "@@ -31,10 +31,13 @@ def tearDown(self):\n         os.chdir(self._cwd)\n \n     def assertMsgId(self, msgid, s, use_quotes=True):\n+        q = '\"'\n         if use_quotes:\n             msgid = '\"%s\"' % msgid\n+            q = \"'\"\n+        needle = 'msgid %s' % msgid\n         msgid = re.escape(msgid)\n-        return self.assertTrue(re.search('^msgid %s' % msgid, s, re.MULTILINE))\n+        return self.assertTrue(re.search('^msgid %s' % msgid, s, re.MULTILINE), 'Could not find %(q)s%(n)s%(q)s in generated PO file' % {'n':needle, 'q':q})\n \n     def assertNotMsgId(self, msgid, s, use_quotes=True):\n         if use_quotes:\n@@ -49,35 +52,57 @@ def test_comments_extractor(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        self.assertTrue('#. Translators: This comment should be extracted' in po_contents)\n-        self.assertTrue('This comment should not be extracted' not in po_contents)\n-        # Comments in templates\n-        self.assertTrue('#. Translators: Django template comment for translators' in po_contents)\n-        self.assertTrue(\"#. Translators: Django comment block for translators\\n#. string's meaning unveiled\" in po_contents)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertTrue('#. Translators: This comment should be extracted' in po_contents)\n+            self.assertTrue('This comment should not be extracted' not in po_contents)\n+            # Comments in templates\n+            self.assertTrue('#. Translators: Django template comment for translators' in po_contents)\n+            self.assertTrue(\"#. Translators: Django comment block for translators\\n#. string's meaning unveiled\" in po_contents)\n \n-        self.assertTrue('#. Translators: One-line translator comment #1' in po_contents)\n-        self.assertTrue('#. Translators: Two-line translator comment #1\\n#. continued here.' in po_contents)\n+            self.assertTrue('#. Translators: One-line translator comment #1' in po_contents)\n+            self.assertTrue('#. Translators: Two-line translator comment #1\\n#. continued here.' in po_contents)\n \n-        self.assertTrue('#. Translators: One-line translator comment #2' in po_contents)\n-        self.assertTrue('#. Translators: Two-line translator comment #2\\n#. continued here.' in po_contents)\n+            self.assertTrue('#. Translators: One-line translator comment #2' in po_contents)\n+            self.assertTrue('#. Translators: Two-line translator comment #2\\n#. continued here.' in po_contents)\n \n-        self.assertTrue('#. Translators: One-line translator comment #3' in po_contents)\n-        self.assertTrue('#. Translators: Two-line translator comment #3\\n#. continued here.' in po_contents)\n+            self.assertTrue('#. Translators: One-line translator comment #3' in po_contents)\n+            self.assertTrue('#. Translators: Two-line translator comment #3\\n#. continued here.' in po_contents)\n \n-        self.assertTrue('#. Translators: One-line translator comment #4' in po_contents)\n-        self.assertTrue('#. Translators: Two-line translator comment #4\\n#. continued here.' in po_contents)\n+            self.assertTrue('#. Translators: One-line translator comment #4' in po_contents)\n+            self.assertTrue('#. Translators: Two-line translator comment #4\\n#. continued here.' in po_contents)\n \n-        self.assertTrue('#. Translators: One-line translator comment #5 -- with non ASCII characters: áéíóúö' in po_contents)\n-        self.assertTrue('#. Translators: Two-line translator comment #5 -- with non ASCII characters: áéíóúö\\n#. continued here.' in po_contents)\n+            self.assertTrue('#. Translators: One-line translator comment #5 -- with non ASCII characters: áéíóúö' in po_contents)\n+            self.assertTrue('#. Translators: Two-line translator comment #5 -- with non ASCII characters: áéíóúö\\n#. continued here.' in po_contents)\n \n-    def test_templatize(self):\n+    def test_templatize_trans_tag(self):\n+        # ticket #11240\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        self.assertMsgId('I think that 100%% is more that 50%% of anything.', po_contents)\n-        self.assertMsgId('I think that 100%% is more that 50%% of %(obj)s.', po_contents)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertMsgId('Literal with a percent symbol at the end %%', po_contents)\n+            self.assertMsgId('Literal with a percent %% symbol in the middle', po_contents)\n+            self.assertMsgId('Completed 50%% of all the tasks', po_contents)\n+            self.assertMsgId('Completed 99%% of all the tasks', po_contents)\n+            self.assertMsgId(\"Shouldn't double escape this sequence: %% (two percent signs)\", po_contents)\n+            self.assertMsgId(\"Shouldn't double escape this sequence %% either\", po_contents)\n+            self.assertMsgId(\"Looks like a str fmt spec %%s but shouldn't be interpreted as such\", po_contents)\n+            self.assertMsgId(\"Looks like a str fmt spec %% o but shouldn't be interpreted as such\", po_contents)\n+\n+    def test_templatize_blocktrans_tag(self):\n+        # ticket #11966\n+        os.chdir(self.test_dir)\n+        management.call_command('makemessages', locale=LOCALE, verbosity=0)\n+        self.assertTrue(os.path.exists(self.PO_FILE))\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertMsgId('I think that 100%% is more that 50%% of anything.', po_contents)\n+            self.assertMsgId('I think that 100%% is more that 50%% of %(obj)s.', po_contents)\n \n     def test_extraction_error(self):\n         os.chdir(self.test_dir)\n@@ -103,26 +128,28 @@ def test_template_message_context_extractor(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        # {% trans %}\n-        self.assertTrue('msgctxt \"Special trans context #1\"' in po_contents)\n-        self.assertTrue(\"Translatable literal #7a\" in po_contents)\n-        self.assertTrue('msgctxt \"Special trans context #2\"' in po_contents)\n-        self.assertTrue(\"Translatable literal #7b\" in po_contents)\n-        self.assertTrue('msgctxt \"Special trans context #3\"' in po_contents)\n-        self.assertTrue(\"Translatable literal #7c\" in po_contents)\n-\n-        # {% blocktrans %}\n-        self.assertTrue('msgctxt \"Special blocktrans context #1\"' in po_contents)\n-        self.assertTrue(\"Translatable literal #8a\" in po_contents)\n-        self.assertTrue('msgctxt \"Special blocktrans context #2\"' in po_contents)\n-        self.assertTrue(\"Translatable literal #8b-singular\" in po_contents)\n-        self.assertTrue(\"Translatable literal #8b-plural\" in po_contents)\n-        self.assertTrue('msgctxt \"Special blocktrans context #3\"' in po_contents)\n-        self.assertTrue(\"Translatable literal #8c-singular\" in po_contents)\n-        self.assertTrue(\"Translatable literal #8c-plural\" in po_contents)\n-        self.assertTrue('msgctxt \"Special blocktrans context #4\"' in po_contents)\n-        self.assertTrue(\"Translatable literal #8d\" in po_contents)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            # {% trans %}\n+            self.assertTrue('msgctxt \"Special trans context #1\"' in po_contents)\n+            self.assertTrue(\"Translatable literal #7a\" in po_contents)\n+            self.assertTrue('msgctxt \"Special trans context #2\"' in po_contents)\n+            self.assertTrue(\"Translatable literal #7b\" in po_contents)\n+            self.assertTrue('msgctxt \"Special trans context #3\"' in po_contents)\n+            self.assertTrue(\"Translatable literal #7c\" in po_contents)\n+\n+            # {% blocktrans %}\n+            self.assertTrue('msgctxt \"Special blocktrans context #1\"' in po_contents)\n+            self.assertTrue(\"Translatable literal #8a\" in po_contents)\n+            self.assertTrue('msgctxt \"Special blocktrans context #2\"' in po_contents)\n+            self.assertTrue(\"Translatable literal #8b-singular\" in po_contents)\n+            self.assertTrue(\"Translatable literal #8b-plural\" in po_contents)\n+            self.assertTrue('msgctxt \"Special blocktrans context #3\"' in po_contents)\n+            self.assertTrue(\"Translatable literal #8c-singular\" in po_contents)\n+            self.assertTrue(\"Translatable literal #8c-plural\" in po_contents)\n+            self.assertTrue('msgctxt \"Special blocktrans context #4\"' in po_contents)\n+            self.assertTrue(\"Translatable literal #8d\" in po_contents)\n \n class JavascriptExtractorTests(ExtractorTests):\n \n@@ -132,20 +159,22 @@ def test_javascript_literals(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', domain='djangojs', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        self.assertMsgId('This literal should be included.', po_contents)\n-        self.assertMsgId('This one as well.', po_contents)\n-        self.assertMsgId(r'He said, \\\"hello\\\".', po_contents)\n-        self.assertMsgId(\"okkkk\", po_contents)\n-        self.assertMsgId(\"TEXT\", po_contents)\n-        self.assertMsgId(\"It's at http://example.com\", po_contents)\n-        self.assertMsgId(\"String\", po_contents)\n-        self.assertMsgId(\"/* but this one will be too */ 'cause there is no way of telling...\", po_contents)\n-        self.assertMsgId(\"foo\", po_contents)\n-        self.assertMsgId(\"bar\", po_contents)\n-        self.assertMsgId(\"baz\", po_contents)\n-        self.assertMsgId(\"quz\", po_contents)\n-        self.assertMsgId(\"foobar\", po_contents)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertMsgId('This literal should be included.', po_contents)\n+            self.assertMsgId('This one as well.', po_contents)\n+            self.assertMsgId(r'He said, \\\"hello\\\".', po_contents)\n+            self.assertMsgId(\"okkkk\", po_contents)\n+            self.assertMsgId(\"TEXT\", po_contents)\n+            self.assertMsgId(\"It's at http://example.com\", po_contents)\n+            self.assertMsgId(\"String\", po_contents)\n+            self.assertMsgId(\"/* but this one will be too */ 'cause there is no way of telling...\", po_contents)\n+            self.assertMsgId(\"foo\", po_contents)\n+            self.assertMsgId(\"bar\", po_contents)\n+            self.assertMsgId(\"baz\", po_contents)\n+            self.assertMsgId(\"quz\", po_contents)\n+            self.assertMsgId(\"foobar\", po_contents)\n \n class IgnoredExtractorTests(ExtractorTests):\n \n@@ -154,9 +183,11 @@ def test_ignore_option(self):\n         pattern1 = os.path.join('ignore_dir', '*')\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, ignore_patterns=[pattern1])\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        self.assertMsgId('This literal should be included.', po_contents)\n-        self.assertNotMsgId('This should be ignored.', po_contents)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertMsgId('This literal should be included.', po_contents)\n+            self.assertNotMsgId('This should be ignored.', po_contents)\n \n \n class SymlinkExtractorTests(ExtractorTests):\n@@ -184,9 +215,11 @@ def test_symlink(self):\n             os.chdir(self.test_dir)\n             management.call_command('makemessages', locale=LOCALE, verbosity=0, symlinks=True)\n             self.assertTrue(os.path.exists(self.PO_FILE))\n-            po_contents = open(self.PO_FILE, 'r').read()\n-            self.assertMsgId('This literal should be included.', po_contents)\n-            self.assertTrue('templates_symlinked/test.html' in po_contents)\n+            #po_contents = open(self.PO_FILE, 'r').read()\n+            with open(self.PO_FILE, 'r') as fp:\n+                po_contents = fp.read()\n+                self.assertMsgId('This literal should be included.', po_contents)\n+                self.assertTrue('templates_symlinked/test.html' in po_contents)\n \n \n class CopyPluralFormsExtractorTests(ExtractorTests):\n@@ -195,8 +228,10 @@ def test_copy_plural_forms(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        self.assertTrue('Plural-Forms: nplurals=2; plural=(n != 1)' in po_contents)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertTrue('Plural-Forms: nplurals=2; plural=(n != 1)' in po_contents)\n \n \n class NoWrapExtractorTests(ExtractorTests):\n@@ -205,15 +240,19 @@ def test_no_wrap_enabled(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, no_wrap=True)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        self.assertMsgId('This literal should also be included wrapped or not wrapped depending on the use of the --no-wrap option.', po_contents)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertMsgId('This literal should also be included wrapped or not wrapped depending on the use of the --no-wrap option.', po_contents)\n \n     def test_no_wrap_disabled(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, no_wrap=False)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        self.assertMsgId('\"\"\\n\"This literal should also be included wrapped or not wrapped depending on the \"\\n\"use of the --no-wrap option.\"', po_contents, use_quotes=False)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertMsgId('\"\"\\n\"This literal should also be included wrapped or not wrapped depending on the \"\\n\"use of the --no-wrap option.\"', po_contents, use_quotes=False)\n \n \n class NoLocationExtractorTests(ExtractorTests):\n@@ -222,12 +261,16 @@ def test_no_location_enabled(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, no_location=True)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        self.assertFalse('#: templates/test.html:55' in po_contents)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertFalse('#: templates/test.html:55' in po_contents)\n \n     def test_no_location_disabled(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, no_location=False)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        po_contents = open(self.PO_FILE, 'r').read()\n-        self.assertTrue('#: templates/test.html:55' in po_contents)\n+        #po_contents = open(self.PO_FILE, 'r').read()\n+        with open(self.PO_FILE, 'r') as fp:\n+            po_contents = fp.read()\n+            self.assertTrue('#: templates/test.html:55' in po_contents)"
        },
        {
            "sha": "26bf6f133c1b366bcddb51bf2bb209f6280b3b41",
            "filename": "tests/regressiontests/i18n/commands/locale/fr/LC_MESSAGES/django.po",
            "status": "added",
            "additions": 71,
            "deletions": 0,
            "changes": 71,
            "blob_url": "https://github.com/django/django/blob/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Fcommands%2Flocale%2Ffr%2FLC_MESSAGES%2Fdjango.po",
            "raw_url": "https://github.com/django/django/raw/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Fcommands%2Flocale%2Ffr%2FLC_MESSAGES%2Fdjango.po",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fcommands%2Flocale%2Ffr%2FLC_MESSAGES%2Fdjango.po?ref=ff7556c4ec01395fe084746009af32ce91b2109f",
            "patch": "@@ -0,0 +1,71 @@\n+# SOME DESCRIPTIVE TITLE.\n+# Copyright (C) YEAR THE PACKAGE'S COPYRIGHT HOLDER\n+# This file is distributed under the same license as the PACKAGE package.\n+# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.\n+#\n+msgid \"\"\n+msgstr \"\"\n+\"Project-Id-Version: PACKAGE VERSION\\n\"\n+\"Report-Msgid-Bugs-To: \\n\"\n+\"POT-Creation-Date: 2011-12-04 04:59-0600\\n\"\n+\"PO-Revision-Date: 2011-12-10 19:12-0300\\n\"\n+\"Last-Translator: FULL NAME <EMAIL@ADDRESS>\\n\"\n+\"Language-Team: LANGUAGE <LL@li.org>\\n\"\n+\"Language: fr\\n\"\n+\"MIME-Version: 1.0\\n\"\n+\"Content-Type: text/plain; charset=UTF-8\\n\"\n+\"Content-Transfer-Encoding: 8bit\\n\"\n+\"Plural-Forms: nplurals=2; plural=(n != 1)\\n\"\n+\n+#. Translators: Django template comment for translators\n+#: templates/test.html:9\n+#, python-format\n+msgid \"I think that 100%% is more that 50%% of anything.\"\n+msgstr \"\"\n+\n+#: templates/test.html:10\n+#, python-format\n+msgid \"I think that 100%% is more that 50%% of %(obj)s.\"\n+msgstr \"\"\n+\n+#: templates/test.html:70\n+#, python-format\n+msgid \"Literal with a percent symbol at the end %%\"\n+msgstr \"\"\n+\n+#: templates/test.html:71\n+#, python-format\n+msgid \"Literal with a percent %% symbol in the middle\"\n+msgstr \"\"\n+\n+#: templates/test.html:72\n+#, python-format\n+msgid \"Completed 50%% of all the tasks\"\n+msgstr \"\"\n+\n+#: templates/test.html:73\n+#, python-format\n+msgctxt \"ctx0\"\n+msgid \"Completed 99%% of all the tasks\"\n+msgstr \"\"\n+\n+#: templates/test.html:74\n+#, python-format\n+msgid \"Shouldn't double escape this sequence: %% (two percent signs)\"\n+msgstr \"\"\n+\n+#: templates/test.html:75\n+#, python-format\n+msgctxt \"ctx1\"\n+msgid \"Shouldn't double escape this sequence %% either\"\n+msgstr \"\"\n+\n+#: templates/test.html:76\n+#, python-format\n+msgid \"Looks like a str fmt spec %%s but shouldn't be interpreted as such\"\n+msgstr \"Translation of the above string\"\n+\n+#: templates/test.html:77\n+#, python-format\n+msgid \"Looks like a str fmt spec %% o but shouldn't be interpreted as such\"\n+msgstr \"Translation contains %% for the above string\""
        },
        {
            "sha": "6f794af7891de612a0bb2eeb90e701fee410af1a",
            "filename": "tests/regressiontests/i18n/commands/templates/test.html",
            "status": "modified",
            "additions": 10,
            "deletions": 1,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Fcommands%2Ftemplates%2Ftest.html",
            "raw_url": "https://github.com/django/django/raw/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Fcommands%2Ftemplates%2Ftest.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fcommands%2Ftemplates%2Ftest.html?ref=ff7556c4ec01395fe084746009af32ce91b2109f",
            "patch": "@@ -65,4 +65,13 @@\n {% blocktrans context \"Special blocktrans context #1\" %}Translatable literal #8a{% endblocktrans %}\n {% blocktrans count 2 context \"Special blocktrans context #2\" %}Translatable literal #8b-singular{% plural %}Translatable literal #8b-plural{% endblocktrans %}\n {% blocktrans context \"Special blocktrans context #3\" count 2 %}Translatable literal #8c-singular{% plural %}Translatable literal #8c-plural{% endblocktrans %}\n-{% blocktrans with a=1 context \"Special blocktrans context #4\" %}Translatable literal #8d {{ a }}{% endblocktrans %}\n\\ No newline at end of file\n+{% blocktrans with a=1 context \"Special blocktrans context #4\" %}Translatable literal #8d {{ a }}{% endblocktrans %}\n+\n+{% trans \"Literal with a percent symbol at the end %\" %}\n+{% trans \"Literal with a percent % symbol in the middle\" %}\n+{% trans \"Completed 50% of all the tasks\" %}\n+{% trans \"Completed 99% of all the tasks\" context \"ctx0\" %}\n+{% trans \"Shouldn't double escape this sequence: %% (two percent signs)\" %}\n+{% trans \"Shouldn't double escape this sequence %% either\" context \"ctx1\" %}\n+{% trans \"Looks like a str fmt spec %s but shouldn't be interpreted as such\" %}\n+{% trans \"Looks like a str fmt spec % o but shouldn't be interpreted as such\" %}"
        },
        {
            "sha": "cc17d743150957fcc1c569c7f09c283ac6acdc32",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/ff7556c4ec01395fe084746009af32ce91b2109f/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=ff7556c4ec01395fe084746009af32ce91b2109f",
            "patch": "@@ -31,7 +31,8 @@\n         CopyPluralFormsExtractorTests, NoWrapExtractorTests,\n         NoLocationExtractorTests)\n if can_run_compilation_tests:\n-    from .commands.compilation import MessageCompilationTests, PoFileTests\n+    from .commands.compilation import (PoFileTests, PoFileContentsTests,\n+        PercentRenderingTests)\n from .contenttypes.tests import ContentTypeTests\n from .forms import I18nForm, SelectDateForm, SelectDateWidget, CompanyForm\n from .models import Company, TestModel"
        }
    ],
    "stats": {
        "total": 335,
        "additions": 254,
        "deletions": 81
    }
}