{
    "author": "jezdez",
    "message": "Fixed #15672 -- Refined changes made in r15918. Thanks, vung.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16082 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "12265410acda595bfbe65d790a7aa36038379e8c",
    "files": [
        {
            "sha": "f0c77015b49edca5388d34e0249ccd2ad0383921",
            "filename": "django/core/handlers/modpython.py",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/12265410acda595bfbe65d790a7aa36038379e8c/django%2Fcore%2Fhandlers%2Fmodpython.py",
            "raw_url": "https://github.com/django/django/raw/12265410acda595bfbe65d790a7aa36038379e8c/django%2Fcore%2Fhandlers%2Fmodpython.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fhandlers%2Fmodpython.py?ref=12265410acda595bfbe65d790a7aa36038379e8c",
            "patch": "@@ -179,11 +179,10 @@ def __call__(self, req):\n             try:\n                 request = self.request_class(req)\n             except UnicodeDecodeError:\n-                logger.warning('Bad Request (UnicodeDecodeError): %s' % request.path,\n+                logger.warning('Bad Request (UnicodeDecodeError)',\n                     exc_info=sys.exc_info(),\n                     extra={\n                         'status_code': 400,\n-                        'request': request\n                     }\n                 )\n                 response = http.HttpResponseBadRequest()"
        },
        {
            "sha": "434f91ccf3b28223fd05c7b6a732c4bbaa3d0fbd",
            "filename": "django/core/handlers/wsgi.py",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/12265410acda595bfbe65d790a7aa36038379e8c/django%2Fcore%2Fhandlers%2Fwsgi.py",
            "raw_url": "https://github.com/django/django/raw/12265410acda595bfbe65d790a7aa36038379e8c/django%2Fcore%2Fhandlers%2Fwsgi.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fhandlers%2Fwsgi.py?ref=12265410acda595bfbe65d790a7aa36038379e8c",
            "patch": "@@ -265,7 +265,6 @@ def __call__(self, environ, start_response):\n                     exc_info=sys.exc_info(),\n                     extra={\n                         'status_code': 400,\n-                        'request': request\n                     }\n                 )\n                 response = http.HttpResponseBadRequest()"
        },
        {
            "sha": "40b0a8375aba9a7ecd6e7c4aa04908c2ecff62df",
            "filename": "tests/regressiontests/handlers/tests.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/12265410acda595bfbe65d790a7aa36038379e8c/tests%2Fregressiontests%2Fhandlers%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/12265410acda595bfbe65d790a7aa36038379e8c/tests%2Fregressiontests%2Fhandlers%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fhandlers%2Ftests.py?ref=12265410acda595bfbe65d790a7aa36038379e8c",
            "patch": "@@ -1,6 +1,8 @@\n from django.utils import unittest\n from django.conf import settings\n from django.core.handlers.wsgi import WSGIHandler\n+from django.test import RequestFactory\n+\n \n class HandlerTests(unittest.TestCase):\n \n@@ -23,3 +25,10 @@ def test_lock_safety(self):\n         # Reset settings\n         settings.MIDDLEWARE_CLASSES = old_middleware_classes\n \n+    def test_bad_path_info(self):\n+        \"\"\"Tests for bug #15672 ('request' referenced before assignment)\"\"\"\n+        environ = RequestFactory().get('/').environ\n+        environ['PATH_INFO'] = '\\xed'\n+        handler = WSGIHandler()\n+        response = handler(environ, lambda *a, **k: None)\n+        self.assertEqual(response.status_code, 400)"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 10,
        "deletions": 3
    }
}