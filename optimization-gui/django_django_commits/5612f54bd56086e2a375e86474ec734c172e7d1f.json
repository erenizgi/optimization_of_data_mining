{
    "author": "unknown",
    "message": "Added more details about the various serialization formats.",
    "sha": "5612f54bd56086e2a375e86474ec734c172e7d1f",
    "files": [
        {
            "sha": "25884fa8748e049f20e7bdaf713428047a813986",
            "filename": "docs/topics/serialization.txt",
            "status": "modified",
            "additions": 91,
            "deletions": 5,
            "changes": 96,
            "blob_url": "https://github.com/django/django/blob/5612f54bd56086e2a375e86474ec734c172e7d1f/docs%2Ftopics%2Fserialization.txt",
            "raw_url": "https://github.com/django/django/raw/5612f54bd56086e2a375e86474ec734c172e7d1f/docs%2Ftopics%2Fserialization.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fserialization.txt?ref=5612f54bd56086e2a375e86474ec734c172e7d1f",
            "patch": "@@ -162,11 +162,82 @@ Identifier  Information\n .. _json: http://json.org/\n .. _PyYAML: http://www.pyyaml.org/\n \n-Notes for specific serialization formats\n-~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+XML\n+~~~\n+\n+The basic XML serialization format is quite simple::\n+    \n+    <?xml version=\"1.0\" encoding=\"utf-8\"?>\n+    <django-objects version=\"1.0\">\n+        <object pk=\"123\" model=\"sessions.session\">\n+            <field type=\"DateTimeField\" name=\"expire_date\">2013-01-16T08:16:59.844560+00:00</field>\n+            <!-- ... -->\n+        </object>\n+    </django-objects>\n+\n+The whole collection of objects that is either serialized or de-serialized is\n+represented by a ``<django-objects>``-tag which contains multiple\n+``<object>``-elements. Each such object has two attributes: \"pk\" and \"model\",\n+the latter being represented by the name of the app (\"sessions\") and the\n+lowercase name of the model (\"session\") separated by a dot.\n+\n+Each field of the object is serialized as a ``<field>``-element sporting the\n+fields \"type\" and \"name\". The text content of the element represents the value\n+that should be stored.\n+\n+Foreign keys and other relational fields are treated a little bit differently::\n+    \n+    <object pk=\"27\" model=\"auth.permission\">\n+        <!-- ... -->\n+        <field to=\"contenttypes.contenttype\" name=\"content_type\" rel=\"ManyToOneRel\">9</field>\n+        <!-- ... -->\n+    </object>\n+\n+In this example we specify that the auth.Permission object with the PK 24 has\n+a foreign key to the contenttypes.ContentType instance with the PK 9.\n+\n+ManyToMany-relations are exported for the model that binds them. For instance,\n+the auth.User model has such a relation to the auth.Permission model::\n+    \n+    <object pk=\"1\" model=\"auth.user\">\n+        <!-- ... -->\n+        <field to=\"auth.permission\" name=\"user_permissions\" rel=\"ManyToManyRel\">\n+            <object pk=\"46\"></object>\n+            <object pk=\"47\"></object>\n+        </field>\n+    </object>\n+\n+This example links the given user with the permission models with PKs 46 and 47.\n+\n+JSON\n+~~~~\n+\n+When staying with the same example data as before it would be serialized as\n+JSON in the following way::\n+    \n+    [\n+        {\n+            \"pk\": \"4b678b301dfd8a4e0dad910de3ae245b\",\n+            \"model\": \"sessions.session\",\n+            \"fields\": {\n+                \"expire_date\": \"2013-01-16T08:16:59.844Z\",\n+                ...\n+            }\n+        }\n+    ]\n+\n+The formatting here is a bit simpler than with XML. The whole collection\n+is just represented as an array and the objects are represented by JSON objects\n+with three properties: \"pk\", \"model\" and \"fields\". \"fields\" is again an object\n+containing each field's name and value as property and property-value\n+respectively.\n+\n+Foreign keys just have the PK of the linked object as property value. \n+ManyToMany-relations are serialized for the model that defines them and are\n+represented as a list of PKs.\n \n-json\n-^^^^\n+Date and datetime related types are treated in a special way by the JSON\n+serializer to make the format compatible with `ECMA-262`_.\n \n Be aware that not all Django output can be passed unmodified to :mod:`json`.\n In particular, :ref:`lazy translation objects <lazy-translations>` need a\n@@ -175,14 +246,29 @@ In particular, :ref:`lazy translation objects <lazy-translations>` need a\n     import json\n     from django.utils.functional import Promise\n     from django.utils.encoding import force_text\n+    from django.core.serializers.json import DjangoJSONEncoder\n \n-    class LazyEncoder(json.JSONEncoder):\n+    class LazyEncoder(DjangoJSONEncoder):\n         def default(self, obj):\n             if isinstance(obj, Promise):\n                 return force_text(obj)\n             return super(LazyEncoder, self).default(obj)\n \n .. _special encoder: http://docs.python.org/library/json.html#encoders-and-decoders\n+.. _ecma-262: http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15\n+\n+YAML\n+~~~~\n+\n+YAML serialization looks quite similar to JSON. The object list is serialized\n+as a sequence mappings with the keys \"pk\", \"model\" and \"fields\". Each field is\n+again a mapping with the key being name of the field and the value the value::\n+    \n+    -   fields: {expire_date: !!timestamp '2013-01-16 08:16:59.844560+00:00'}\n+        model: sessions.session\n+        pk: 4b678b301dfd8a4e0dad910de3ae245b\n+\n+Referential fields are again just represented by the PK or sequence of PKs.\n \n .. _topics-serialization-natural-keys:\n "
        }
    ],
    "stats": {
        "total": 96,
        "additions": 91,
        "deletions": 5
    }
}