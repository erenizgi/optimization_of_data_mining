{
    "author": "freakboy3742",
    "message": "Fixed #15299 -- Started the process of migrating the auth context processor support classes into the auth context processor module. Thanks to shailesh for the report, and v1v3kn for the draft patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15635 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "7aa84917a4ae8ca380fea1ae1937706d367389ed",
    "files": [
        {
            "sha": "7750ab75c230b0b6cbdca5dc1ca583f8f8f98129",
            "filename": "django/contrib/auth/context_processors.py",
            "status": "modified",
            "additions": 28,
            "deletions": 1,
            "changes": 29,
            "blob_url": "https://github.com/django/django/blob/7aa84917a4ae8ca380fea1ae1937706d367389ed/django%2Fcontrib%2Fauth%2Fcontext_processors.py",
            "raw_url": "https://github.com/django/django/raw/7aa84917a4ae8ca380fea1ae1937706d367389ed/django%2Fcontrib%2Fauth%2Fcontext_processors.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fcontext_processors.py?ref=7aa84917a4ae8ca380fea1ae1937706d367389ed",
            "patch": "@@ -1,7 +1,34 @@\n-from django.core.context_processors import PermWrapper\n from django.utils.functional import lazy, memoize, SimpleLazyObject\n from django.contrib import messages\n \n+# PermWrapper and PermLookupDict proxy the permissions system into objects that\n+# the template system can understand.\n+\n+class PermLookupDict(object):\n+    def __init__(self, user, module_name):\n+        self.user, self.module_name = user, module_name\n+\n+    def __repr__(self):\n+        return str(self.user.get_all_permissions())\n+\n+    def __getitem__(self, perm_name):\n+        return self.user.has_perm(\"%s.%s\" % (self.module_name, perm_name))\n+\n+    def __nonzero__(self):\n+        return self.user.has_module_perms(self.module_name)\n+\n+\n+class PermWrapper(object):\n+    def __init__(self, user):\n+        self.user = user\n+\n+    def __getitem__(self, module_name):\n+        return PermLookupDict(self.user, module_name)\n+\n+    def __iter__(self):\n+        # I am large, I contain multitudes.\n+        raise TypeError(\"PermWrapper is not iterable.\")\n+\n def auth(request):\n     \"\"\"\n     Returns context variables required by apps that use Django's authentication"
        },
        {
            "sha": "90e89b73d834e1e2295fa80ef53cb57b4eefb83a",
            "filename": "django/core/context_processors.py",
            "status": "modified",
            "additions": 27,
            "deletions": 25,
            "changes": 52,
            "blob_url": "https://github.com/django/django/blob/7aa84917a4ae8ca380fea1ae1937706d367389ed/django%2Fcore%2Fcontext_processors.py",
            "raw_url": "https://github.com/django/django/raw/7aa84917a4ae8ca380fea1ae1937706d367389ed/django%2Fcore%2Fcontext_processors.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fcontext_processors.py?ref=7aa84917a4ae8ca380fea1ae1937706d367389ed",
            "patch": "@@ -84,28 +84,30 @@ def request(request):\n     return {'request': request}\n \n # PermWrapper and PermLookupDict proxy the permissions system into objects that\n-# the template system can understand.\n-\n-class PermLookupDict(object):\n-    def __init__(self, user, module_name):\n-        self.user, self.module_name = user, module_name\n-\n-    def __repr__(self):\n-        return str(self.user.get_all_permissions())\n-\n-    def __getitem__(self, perm_name):\n-        return self.user.has_perm(\"%s.%s\" % (self.module_name, perm_name))\n-\n-    def __nonzero__(self):\n-        return self.user.has_module_perms(self.module_name)\n-\n-class PermWrapper(object):\n-    def __init__(self, user):\n-        self.user = user\n-\n-    def __getitem__(self, module_name):\n-        return PermLookupDict(self.user, module_name)\n-\n-    def __iter__(self):\n-        # I am large, I contain multitudes.\n-        raise TypeError(\"PermWrapper is not iterable.\")\n+# the template system can understand. They once lived here -- they have\n+# been moved to django.contrib.auth.context_processors.\n+\n+from django.contrib.auth.context_processors import PermLookupDict as RealPermLookupDict\n+from django.contrib.auth.context_processors import PermWrapper as RealPermWrapper\n+\n+class PermLookupDict(RealPermLookupDict):\n+    def __init__(self, *args, **kwargs):\n+        import warnings\n+        warnings.warn(\n+            \"`django.core.context_processors.PermLookupDict` is \" \\\n+            \"deprecated; use `django.contrib.auth.context_processors.PermLookupDict` \" \\\n+            \"instead.\",\n+            PendingDeprecationWarning\n+        )\n+        super(PermLookupDict, self).__init__(*args, **kwargs)\n+\n+class PermWrapper(RealPermWrapper):\n+    def __init__(self, *args, **kwargs):\n+        import warnings\n+        warnings.warn(\n+            \"`django.core.context_processors.PermWrapper` is \" \\\n+            \"deprecated; use `django.contrib.auth.context_processors.PermWrapper` \" \\\n+            \"instead.\",\n+            PendingDeprecationWarning\n+        )\n+        super(PermWrapper, self).__init__(*args, **kwargs)"
        },
        {
            "sha": "de62dc025e24f1e424e157fb8fdd160c7269a731",
            "filename": "docs/internals/deprecation.txt",
            "status": "modified",
            "additions": 8,
            "deletions": 2,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/7aa84917a4ae8ca380fea1ae1937706d367389ed/docs%2Finternals%2Fdeprecation.txt",
            "raw_url": "https://github.com/django/django/raw/7aa84917a4ae8ca380fea1ae1937706d367389ed/docs%2Finternals%2Fdeprecation.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Finternals%2Fdeprecation.txt?ref=7aa84917a4ae8ca380fea1ae1937706d367389ed",
            "patch": "@@ -151,13 +151,19 @@ their deprecation, as per the :ref:`Django deprecation policy\n           The ``supports_inactive_user`` variable is not checked any\n           longer and can be removed.\n \n-        * :meth:`~django.contrib.gis.geos.GEOSGeometry.transform` will raise \n-          a :class:`~django.contrib.gis.geos.GEOSException` when called \n+        * :meth:`~django.contrib.gis.geos.GEOSGeometry.transform` will raise\n+          a :class:`~django.contrib.gis.geos.GEOSException` when called\n           on a geometry with no SRID value.\n \n         * :class:`~django.http.CompatCookie` will be removed in favour of\n           :class:`~django.http.SimpleCookie`.\n \n+        * :class:`django.core.context_processors.PermWrapper` and\n+          :class:`django.core.context_processors.PermLookupDict`\n+          will be moved to :class:`django.contrib.auth.context_processors.PermWrapper`\n+          and :class:`django.contrib.auth.context_processors.PermLookupDict`,\n+          respectively.\n+\n     * 2.0\n         * ``django.views.defaults.shortcut()``. This function has been moved\n           to ``django.contrib.contenttypes.views.shortcut()`` as part of the"
        },
        {
            "sha": "ba78f15e81a2ffb8dc6c478ba33817b06ce7dcd9",
            "filename": "docs/ref/templates/api.txt",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/7aa84917a4ae8ca380fea1ae1937706d367389ed/docs%2Fref%2Ftemplates%2Fapi.txt",
            "raw_url": "https://github.com/django/django/raw/7aa84917a4ae8ca380fea1ae1937706d367389ed/docs%2Fref%2Ftemplates%2Fapi.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Ftemplates%2Fapi.txt?ref=7aa84917a4ae8ca380fea1ae1937706d367389ed",
            "patch": "@@ -423,7 +423,7 @@ If :setting:`TEMPLATE_CONTEXT_PROCESSORS` contains this processor, every\n       via the :doc:`messages framework </ref/contrib/messages>`.\n \n     * ``perms`` -- An instance of\n-      ``django.core.context_processors.PermWrapper``, representing the\n+      ``django.contrib.auth.context_processors.PermWrapper``, representing the\n       permissions that the currently logged-in user has.\n \n .. versionchanged:: 1.2\n@@ -435,6 +435,11 @@ If :setting:`TEMPLATE_CONTEXT_PROCESSORS` contains this processor, every\n    ``user.get_and_delete_messages()``. It has been changed to include any\n    messages added via the :doc:`messages framework </ref/contrib/messages>`.\n \n+.. versionchanged:: 1.3\n+    Prior to version 1.3, ``PermWrapper`` was located in\n+    ``django.contrib.auth.context_processors``.\n+\n+\n django.core.context_processors.debug\n ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n "
        },
        {
            "sha": "29e4fd46f55155641d8152aa122fc512dd15dfd9",
            "filename": "docs/releases/1.3.txt",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/7aa84917a4ae8ca380fea1ae1937706d367389ed/docs%2Freleases%2F1.3.txt",
            "raw_url": "https://github.com/django/django/raw/7aa84917a4ae8ca380fea1ae1937706d367389ed/docs%2Freleases%2F1.3.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.3.txt?ref=7aa84917a4ae8ca380fea1ae1937706d367389ed",
            "patch": "@@ -828,3 +828,15 @@ Rationale for this decision:\n \n  * This location wasn't included in the translation building process for\n    JavaScript literals.\n+\n+``PermWrapper`` moved to ``django.contrib.auth.context_processors``\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+In Django 1.2, we began the process of changing the location of the\n+``auth`` context processor from ``django.core.context_processors`` to\n+``django.contrib.auth.context_processors``. However, the\n+``PermWrapper`` support class was mistakenly omitted from that\n+migration. In Django 1.3, the ``PermWrapper`` class has also been\n+moved to ``django.contrib.auth.context_processors``, along with the\n+``PermLookupDict`` support class. The new classes are functionally\n+identical to their old versions; only the module location has changed."
        },
        {
            "sha": "52ddf22e7ba14791ba805f8d548b5b9becc874fd",
            "filename": "docs/topics/auth.txt",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/7aa84917a4ae8ca380fea1ae1937706d367389ed/docs%2Ftopics%2Fauth.txt",
            "raw_url": "https://github.com/django/django/raw/7aa84917a4ae8ca380fea1ae1937706d367389ed/docs%2Ftopics%2Fauth.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fauth.txt?ref=7aa84917a4ae8ca380fea1ae1937706d367389ed",
            "patch": "@@ -661,7 +661,7 @@ How to log a user out\n Login and logout signals\n ------------------------\n \n-.. versionadded:: 1.3 \n+.. versionadded:: 1.3\n \n The auth framework uses two :doc:`signals </topics/signals>` that can be used\n for notification when a user logs in or out.\n@@ -949,7 +949,7 @@ includes a few other useful built-in views located in\n     Allows a user to reset their password by generating a one-time use link\n     that can be used to reset the password, and sending that link to the\n     user's registered e-mail address.\n-    \n+\n     .. versionchanged:: 1.3\n         The ``from_email`` argument was added.\n \n@@ -1334,9 +1334,13 @@ Permissions\n \n The currently logged-in user's permissions are stored in the template variable\n ``{{ perms }}``. This is an instance of\n-:class:`django.core.context_processors.PermWrapper`, which is a\n+:class:`django.contrib.auth.context_processors.PermWrapper`, which is a\n template-friendly proxy of permissions.\n \n+.. versionchanged:: 1.3\n+    Prior to version 1.3, ``PermWrapper`` was located in\n+    ``django.contrib.auth.context_processors``.\n+\n In the ``{{ perms }}`` object, single-attribute lookup is a proxy to\n :meth:`User.has_module_perms <django.contrib.auth.models.User.has_module_perms>`.\n This example would display ``True`` if the logged-in user had any permissions"
        }
    ],
    "stats": {
        "total": 120,
        "additions": 88,
        "deletions": 32
    }
}