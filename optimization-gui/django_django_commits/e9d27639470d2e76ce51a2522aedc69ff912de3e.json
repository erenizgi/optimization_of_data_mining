{
    "author": "spookylukey",
    "message": "Fixed #15572 - include with \"only\" option discards context properties (such as autoescape)\n\nThanks to dfoerster for the report.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15795 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "e9d27639470d2e76ce51a2522aedc69ff912de3e",
    "files": [
        {
            "sha": "bcfaa3bf9ec53e505be5b833ecb9a7fa99fbe0b8",
            "filename": "django/template/context.py",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/e9d27639470d2e76ce51a2522aedc69ff912de3e/django%2Ftemplate%2Fcontext.py",
            "raw_url": "https://github.com/django/django/raw/e9d27639470d2e76ce51a2522aedc69ff912de3e/django%2Ftemplate%2Fcontext.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fcontext.py?ref=e9d27639470d2e76ce51a2522aedc69ff912de3e",
            "patch": "@@ -99,6 +99,14 @@ def update(self, other_dict):\n         self.dicts.append(other_dict)\n         return other_dict\n \n+    def new(self, values=None):\n+        \"\"\"\n+        Returns a new Context with the same 'autoescape' value etc, but with\n+        only the values given in 'values' stored.\n+        \"\"\"\n+        return self.__class__(dict_=values, autoescape=self.autoescape,\n+                              current_app=self.current_app, use_l10n=self.use_l10n)\n+\n class RenderContext(BaseContext):\n     \"\"\"\n     A stack container for storing Template state."
        },
        {
            "sha": "e289ef0d9ed385fd056ed1da7ac1a8bdb8c3967a",
            "filename": "django/template/loader_tags.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/e9d27639470d2e76ce51a2522aedc69ff912de3e/django%2Ftemplate%2Floader_tags.py",
            "raw_url": "https://github.com/django/django/raw/e9d27639470d2e76ce51a2522aedc69ff912de3e/django%2Ftemplate%2Floader_tags.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Floader_tags.py?ref=e9d27639470d2e76ce51a2522aedc69ff912de3e",
            "patch": "@@ -136,7 +136,7 @@ def render_template(self, template, context):\n         values = dict([(name, var.resolve(context)) for name, var\n                        in self.extra_context.iteritems()])\n         if self.isolated_context:\n-            return template.render(Context(values))\n+            return template.render(context.new(values))\n         context.update(values)\n         output = template.render(context)\n         context.pop()"
        },
        {
            "sha": "cb831348ce5e3a03607118497657e999b1b73327",
            "filename": "tests/regressiontests/templates/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/e9d27639470d2e76ce51a2522aedc69ff912de3e/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/e9d27639470d2e76ce51a2522aedc69ff912de3e/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftemplates%2Ftests.py?ref=e9d27639470d2e76ce51a2522aedc69ff912de3e",
            "patch": "@@ -1031,6 +1031,10 @@ def get_template_tests(self):\n             'include11': ('{% include \"basic-syntax03\" only with second=2 %}', {'first': '1'}, (' --- 2', 'INVALID --- 2')),\n             'include12': ('{% include \"basic-syntax03\" with first=1 only %}', {'second': '2'}, ('1 --- ', '1 --- INVALID')),\n \n+            # autoescape context\n+            'include13': ('{% autoescape off %}{% include \"basic-syntax03\" %}{% endautoescape %}', {'first': '&'}, ('& --- ', '& --- INVALID')),\n+            'include14': ('{% autoescape off %}{% include \"basic-syntax03\" with first=var1 only %}{% endautoescape %}', {'var1': '&'}, ('& --- ', '& --- INVALID')),\n+\n             'include-error01': ('{% include \"basic-syntax01\" with %}', {}, template.TemplateSyntaxError),\n             'include-error02': ('{% include \"basic-syntax01\" with \"no key\" %}', {}, template.TemplateSyntaxError),\n             'include-error03': ('{% include \"basic-syntax01\" with dotted.arg=\"error\" %}', {}, template.TemplateSyntaxError),"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 13,
        "deletions": 1
    }
}