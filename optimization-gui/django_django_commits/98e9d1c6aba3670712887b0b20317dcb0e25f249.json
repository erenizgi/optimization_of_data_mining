{
    "author": "aaugustin",
    "message": "Used the override_settings decorator in the tests of auth, flatpages, and formtools.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17851 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "98e9d1c6aba3670712887b0b20317dcb0e25f249",
    "files": [
        {
            "sha": "2c6e39578ef54447073ecead524298a2b0c6cc6c",
            "filename": "django/contrib/auth/tests/auth_backends.py",
            "status": "modified",
            "additions": 2,
            "deletions": 7,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fauth%2Ftests%2Fauth_backends.py",
            "raw_url": "https://github.com/django/django/raw/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fauth%2Ftests%2Fauth_backends.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Fauth_backends.py?ref=98e9d1c6aba3670712887b0b20317dcb0e25f249",
            "patch": "@@ -3,6 +3,7 @@\n from django.contrib.contenttypes.models import ContentType\n from django.core.exceptions import ImproperlyConfigured\n from django.test import TestCase\n+from django.test.utils import override_settings\n \n \n class BackendTest(TestCase):\n@@ -230,20 +231,14 @@ def test_get_all_permissions(self):\n         self.assertEqual(self.user1.get_all_permissions(TestObj()), set(['anon']))\n \n \n-\n-\n+@override_settings(AUTHENTICATION_BACKENDS=[])\n class NoBackendsTest(TestCase):\n     \"\"\"\n     Tests that an appropriate error is raised if no auth backends are provided.\n     \"\"\"\n     def setUp(self):\n-        self.old_AUTHENTICATION_BACKENDS = settings.AUTHENTICATION_BACKENDS\n-        settings.AUTHENTICATION_BACKENDS = []\n         self.user = User.objects.create_user('test', 'test@example.com', 'test')\n \n-    def tearDown(self):\n-        settings.AUTHENTICATION_BACKENDS = self.old_AUTHENTICATION_BACKENDS\n-\n     def test_raises_exception(self):\n         self.assertRaises(ImproperlyConfigured, self.user.has_perm, ('perm', TestObj(),))\n "
        },
        {
            "sha": "b8a16a8c17b190e8b01683a31aafc384dde30607",
            "filename": "django/contrib/auth/tests/views.py",
            "status": "modified",
            "additions": 10,
            "deletions": 16,
            "changes": 26,
            "blob_url": "https://github.com/django/django/blob/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fauth%2Ftests%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fauth%2Ftests%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Fviews.py?ref=98e9d1c6aba3670712887b0b20317dcb0e25f249",
            "patch": "@@ -18,29 +18,23 @@\n                 SetPasswordForm, PasswordResetForm)\n \n \n-@override_settings(USE_TZ=False)\n+@override_settings(\n+    LANGUAGES=(\n+        ('en', 'English'),\n+    ),\n+    LANGUAGE_CODE='en',\n+    TEMPLATE_DIRS = (\n+        os.path.join(os.path.dirname(__file__), 'templates'),\n+    ),\n+    USE_TZ=False,\n+)\n class AuthViewsTestCase(TestCase):\n     \"\"\"\n     Helper base class for all the follow test cases.\n     \"\"\"\n     fixtures = ['authtestdata.json']\n     urls = 'django.contrib.auth.tests.urls'\n \n-    def setUp(self):\n-        self.old_LANGUAGES = settings.LANGUAGES\n-        self.old_LANGUAGE_CODE = settings.LANGUAGE_CODE\n-        settings.LANGUAGES = (('en', 'English'),)\n-        settings.LANGUAGE_CODE = 'en'\n-        self.old_TEMPLATE_DIRS = settings.TEMPLATE_DIRS\n-        settings.TEMPLATE_DIRS = (\n-            os.path.join(os.path.dirname(__file__), 'templates'),\n-        )\n-\n-    def tearDown(self):\n-        settings.LANGUAGES = self.old_LANGUAGES\n-        settings.LANGUAGE_CODE = self.old_LANGUAGE_CODE\n-        settings.TEMPLATE_DIRS = self.old_TEMPLATE_DIRS\n-\n     def login(self, password='password'):\n         response = self.client.post('/login/', {\n             'username': 'testclient',"
        },
        {
            "sha": "a8b9c2804c4d31599b93acb94f1c5d4a92d85e32",
            "filename": "django/contrib/flatpages/tests/csrf.py",
            "status": "modified",
            "additions": 16,
            "deletions": 21,
            "changes": 37,
            "blob_url": "https://github.com/django/django/blob/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fflatpages%2Ftests%2Fcsrf.py",
            "raw_url": "https://github.com/django/django/raw/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fflatpages%2Ftests%2Fcsrf.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ftests%2Fcsrf.py?ref=98e9d1c6aba3670712887b0b20317dcb0e25f249",
            "patch": "@@ -2,34 +2,29 @@\n from django.conf import settings\n from django.contrib.auth.models import User\n from django.test import TestCase, Client\n+from django.test.utils import override_settings\n \n+\n+@override_settings(\n+    LOGIN_URL='/accounts/login/',\n+    MIDDLEWARE_CLASSES=(\n+        'django.middleware.common.CommonMiddleware',\n+        'django.contrib.sessions.middleware.SessionMiddleware',\n+        'django.middleware.csrf.CsrfViewMiddleware',\n+        'django.contrib.auth.middleware.AuthenticationMiddleware',\n+        'django.contrib.messages.middleware.MessageMiddleware',\n+        'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware',\n+    ),\n+    TEMPLATE_DIRS=(\n+        os.path.join(os.path.dirname(__file__), 'templates'),\n+    ),\n+)\n class FlatpageCSRFTests(TestCase):\n     fixtures = ['sample_flatpages']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n     def setUp(self):\n         self.client = Client(enforce_csrf_checks=True)\n-        self.old_MIDDLEWARE_CLASSES = settings.MIDDLEWARE_CLASSES\n-        flatpage_middleware_class = 'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware'\n-        csrf_middleware_class = 'django.middleware.csrf.CsrfViewMiddleware'\n-        if csrf_middleware_class not in settings.MIDDLEWARE_CLASSES:\n-            settings.MIDDLEWARE_CLASSES += (csrf_middleware_class,)\n-        if flatpage_middleware_class not in settings.MIDDLEWARE_CLASSES:\n-            settings.MIDDLEWARE_CLASSES += (flatpage_middleware_class,)\n-        self.old_TEMPLATE_DIRS = settings.TEMPLATE_DIRS\n-        settings.TEMPLATE_DIRS = (\n-            os.path.join(\n-                os.path.dirname(__file__),\n-                'templates'\n-            ),\n-        )\n-        self.old_LOGIN_URL = settings.LOGIN_URL\n-        settings.LOGIN_URL = '/accounts/login/'\n-\n-    def tearDown(self):\n-        settings.MIDDLEWARE_CLASSES = self.old_MIDDLEWARE_CLASSES\n-        settings.TEMPLATE_DIRS = self.old_TEMPLATE_DIRS\n-        settings.LOGIN_URL = self.old_LOGIN_URL\n \n     def test_view_flatpage(self):\n         \"A flatpage can be served through a view, even when the middleware is in use\""
        },
        {
            "sha": "fa9d735c0c8289bca591dba7591affc4cdb90d6b",
            "filename": "django/contrib/flatpages/tests/middleware.py",
            "status": "modified",
            "additions": 32,
            "deletions": 44,
            "changes": 76,
            "blob_url": "https://github.com/django/django/blob/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fflatpages%2Ftests%2Fmiddleware.py",
            "raw_url": "https://github.com/django/django/raw/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fflatpages%2Ftests%2Fmiddleware.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ftests%2Fmiddleware.py?ref=98e9d1c6aba3670712887b0b20317dcb0e25f249",
            "patch": "@@ -3,31 +3,27 @@\n from django.contrib.auth.models import User\n from django.contrib.flatpages.models import FlatPage\n from django.test import TestCase\n-\n+from django.test.utils import override_settings\n+\n+\n+@override_settings(\n+    LOGIN_URL='/accounts/login/',\n+    MIDDLEWARE_CLASSES=(\n+        'django.middleware.common.CommonMiddleware',\n+        'django.contrib.sessions.middleware.SessionMiddleware',\n+        'django.middleware.csrf.CsrfViewMiddleware',\n+        'django.contrib.auth.middleware.AuthenticationMiddleware',\n+        'django.contrib.messages.middleware.MessageMiddleware',\n+        'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware',\n+    ),\n+    TEMPLATE_DIRS=(\n+        os.path.join(os.path.dirname(__file__), 'templates'),\n+    ),\n+)\n class FlatpageMiddlewareTests(TestCase):\n     fixtures = ['sample_flatpages']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n-    def setUp(self):\n-        self.old_MIDDLEWARE_CLASSES = settings.MIDDLEWARE_CLASSES\n-        flatpage_middleware_class = 'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware'\n-        if flatpage_middleware_class not in settings.MIDDLEWARE_CLASSES:\n-            settings.MIDDLEWARE_CLASSES += (flatpage_middleware_class,)\n-        self.old_TEMPLATE_DIRS = settings.TEMPLATE_DIRS\n-        settings.TEMPLATE_DIRS = (\n-            os.path.join(\n-                os.path.dirname(__file__),\n-                'templates'\n-            ),\n-        )\n-        self.old_LOGIN_URL = settings.LOGIN_URL\n-        settings.LOGIN_URL = '/accounts/login/'\n-\n-    def tearDown(self):\n-        settings.MIDDLEWARE_CLASSES = self.old_MIDDLEWARE_CLASSES\n-        settings.TEMPLATE_DIRS = self.old_TEMPLATE_DIRS\n-        settings.LOGIN_URL = self.old_LOGIN_URL\n-\n     def test_view_flatpage(self):\n         \"A flatpage can be served through a view, even when the middleware is in use\"\n         response = self.client.get('/flatpage_root/flatpage/')\n@@ -86,33 +82,25 @@ def test_fallback_flatpage_special_chars(self):\n         self.assertContains(response, \"<p>Isn't it special!</p>\")\n \n \n+@override_settings(\n+    APPEND_SLASH = True,\n+    LOGIN_URL='/accounts/login/',\n+    MIDDLEWARE_CLASSES=(\n+        'django.middleware.common.CommonMiddleware',\n+        'django.contrib.sessions.middleware.SessionMiddleware',\n+        'django.middleware.csrf.CsrfViewMiddleware',\n+        'django.contrib.auth.middleware.AuthenticationMiddleware',\n+        'django.contrib.messages.middleware.MessageMiddleware',\n+        'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware',\n+    ),\n+    TEMPLATE_DIRS=(\n+        os.path.join(os.path.dirname(__file__), 'templates'),\n+    ),\n+)\n class FlatpageMiddlewareAppendSlashTests(TestCase):\n     fixtures = ['sample_flatpages']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n-    def setUp(self):\n-        self.old_MIDDLEWARE_CLASSES = settings.MIDDLEWARE_CLASSES\n-        flatpage_middleware_class = 'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware'\n-        if flatpage_middleware_class not in settings.MIDDLEWARE_CLASSES:\n-            settings.MIDDLEWARE_CLASSES += (flatpage_middleware_class,)\n-        self.old_TEMPLATE_DIRS = settings.TEMPLATE_DIRS\n-        settings.TEMPLATE_DIRS = (\n-            os.path.join(\n-                os.path.dirname(__file__),\n-                'templates'\n-            ),\n-        )\n-        self.old_LOGIN_URL = settings.LOGIN_URL\n-        settings.LOGIN_URL = '/accounts/login/'\n-        self.old_APPEND_SLASH = settings.APPEND_SLASH\n-        settings.APPEND_SLASH = True\n-\n-    def tearDown(self):\n-        settings.MIDDLEWARE_CLASSES = self.old_MIDDLEWARE_CLASSES\n-        settings.TEMPLATE_DIRS = self.old_TEMPLATE_DIRS\n-        settings.LOGIN_URL = self.old_LOGIN_URL\n-        settings.APPEND_SLASH = self.old_APPEND_SLASH\n-\n     def test_redirect_view_flatpage(self):\n         \"A flatpage can be served through a view and should add a slash\"\n         response = self.client.get('/flatpage_root/flatpage')"
        },
        {
            "sha": "de6a0a90fbc2c27b09cd69a089ed85c1bd2ecafb",
            "filename": "django/contrib/flatpages/tests/templatetags.py",
            "status": "modified",
            "additions": 15,
            "deletions": 15,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fflatpages%2Ftests%2Ftemplatetags.py",
            "raw_url": "https://github.com/django/django/raw/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fflatpages%2Ftests%2Ftemplatetags.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ftests%2Ftemplatetags.py?ref=98e9d1c6aba3670712887b0b20317dcb0e25f249",
            "patch": "@@ -3,29 +3,29 @@\n from django.contrib.auth.models import AnonymousUser, User\n from django.template import Template, Context, TemplateSyntaxError\n from django.test import TestCase\n+from django.test.utils import override_settings\n \n+\n+@override_settings(\n+    MIDDLEWARE_CLASSES=(\n+        'django.middleware.common.CommonMiddleware',\n+        'django.contrib.sessions.middleware.SessionMiddleware',\n+        'django.middleware.csrf.CsrfViewMiddleware',\n+        'django.contrib.auth.middleware.AuthenticationMiddleware',\n+        'django.contrib.messages.middleware.MessageMiddleware',\n+        'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware',\n+    ),\n+    TEMPLATE_DIRS=(\n+        os.path.join(os.path.dirname(__file__), 'templates'),\n+    ),\n+)\n class FlatpageTemplateTagTests(TestCase):\n     fixtures = ['sample_flatpages']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n     def setUp(self):\n-        self.old_MIDDLEWARE_CLASSES = settings.MIDDLEWARE_CLASSES\n-        flatpage_middleware_class = 'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware'\n-        if flatpage_middleware_class not in settings.MIDDLEWARE_CLASSES:\n-            settings.MIDDLEWARE_CLASSES += (flatpage_middleware_class,)\n-        self.old_TEMPLATE_DIRS = settings.TEMPLATE_DIRS\n-        settings.TEMPLATE_DIRS = (\n-            os.path.join(\n-                os.path.dirname(__file__),\n-                'templates'\n-            ),\n-        )\n         self.me = User.objects.create_user('testuser', 'test@example.com', 's3krit')\n \n-    def tearDown(self):\n-        settings.MIDDLEWARE_CLASSES = self.old_MIDDLEWARE_CLASSES\n-        settings.TEMPLATE_DIRS = self.old_TEMPLATE_DIRS\n-\n     def test_get_flatpages_tag(self):\n         \"The flatpage template tag retrives unregistered prefixed flatpages by default\"\n         out = Template("
        },
        {
            "sha": "997bfabec8659f862c378750b8dfe3e98529e7b2",
            "filename": "django/contrib/flatpages/tests/views.py",
            "status": "modified",
            "additions": 32,
            "deletions": 44,
            "changes": 76,
            "blob_url": "https://github.com/django/django/blob/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fflatpages%2Ftests%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fflatpages%2Ftests%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ftests%2Fviews.py?ref=98e9d1c6aba3670712887b0b20317dcb0e25f249",
            "patch": "@@ -3,31 +3,27 @@\n from django.contrib.auth.models import User\n from django.contrib.flatpages.models import FlatPage\n from django.test import TestCase\n-\n+from django.test.utils import override_settings\n+\n+\n+@override_settings(\n+    LOGIN_URL='/accounts/login/',\n+    MIDDLEWARE_CLASSES=(\n+        'django.middleware.common.CommonMiddleware',\n+        'django.contrib.sessions.middleware.SessionMiddleware',\n+        'django.middleware.csrf.CsrfViewMiddleware',\n+        'django.contrib.auth.middleware.AuthenticationMiddleware',\n+        'django.contrib.messages.middleware.MessageMiddleware',\n+        # no 'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware'\n+    ),\n+    TEMPLATE_DIRS=(\n+        os.path.join(os.path.dirname(__file__), 'templates'),\n+    ),\n+)\n class FlatpageViewTests(TestCase):\n     fixtures = ['sample_flatpages']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n-    def setUp(self):\n-        self.old_MIDDLEWARE_CLASSES = settings.MIDDLEWARE_CLASSES\n-        flatpage_middleware_class = 'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware'\n-        if flatpage_middleware_class in settings.MIDDLEWARE_CLASSES:\n-            settings.MIDDLEWARE_CLASSES = tuple(m for m in settings.MIDDLEWARE_CLASSES if m != flatpage_middleware_class)\n-        self.old_TEMPLATE_DIRS = settings.TEMPLATE_DIRS\n-        settings.TEMPLATE_DIRS = (\n-            os.path.join(\n-                os.path.dirname(__file__),\n-                'templates'\n-            ),\n-        )\n-        self.old_LOGIN_URL = settings.LOGIN_URL\n-        settings.LOGIN_URL = '/accounts/login/'\n-\n-    def tearDown(self):\n-        settings.MIDDLEWARE_CLASSES = self.old_MIDDLEWARE_CLASSES\n-        settings.TEMPLATE_DIRS = self.old_TEMPLATE_DIRS\n-        settings.LOGIN_URL = self.old_LOGIN_URL\n-\n     def test_view_flatpage(self):\n         \"A flatpage can be served through a view\"\n         response = self.client.get('/flatpage_root/flatpage/')\n@@ -75,33 +71,25 @@ def test_view_flatpage_special_chars(self):\n         self.assertContains(response, \"<p>Isn't it special!</p>\")\n \n \n+@override_settings(\n+    APPEND_SLASH = True,\n+    LOGIN_URL='/accounts/login/',\n+    MIDDLEWARE_CLASSES=(\n+        'django.middleware.common.CommonMiddleware',\n+        'django.contrib.sessions.middleware.SessionMiddleware',\n+        'django.middleware.csrf.CsrfViewMiddleware',\n+        'django.contrib.auth.middleware.AuthenticationMiddleware',\n+        'django.contrib.messages.middleware.MessageMiddleware',\n+        # no 'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware'\n+    ),\n+    TEMPLATE_DIRS=(\n+        os.path.join(os.path.dirname(__file__), 'templates'),\n+    ),\n+)\n class FlatpageViewAppendSlashTests(TestCase):\n     fixtures = ['sample_flatpages']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n-    def setUp(self):\n-        self.old_MIDDLEWARE_CLASSES = settings.MIDDLEWARE_CLASSES\n-        flatpage_middleware_class = 'django.contrib.flatpages.middleware.FlatpageFallbackMiddleware'\n-        if flatpage_middleware_class in settings.MIDDLEWARE_CLASSES:\n-            settings.MIDDLEWARE_CLASSES = tuple(m for m in settings.MIDDLEWARE_CLASSES if m != flatpage_middleware_class)\n-        self.old_TEMPLATE_DIRS = settings.TEMPLATE_DIRS\n-        settings.TEMPLATE_DIRS = (\n-            os.path.join(\n-                os.path.dirname(__file__),\n-                'templates'\n-            ),\n-        )\n-        self.old_LOGIN_URL = settings.LOGIN_URL\n-        settings.LOGIN_URL = '/accounts/login/'\n-        self.old_APPEND_SLASH = settings.APPEND_SLASH\n-        settings.APPEND_SLASH = True\n-\n-    def tearDown(self):\n-        settings.MIDDLEWARE_CLASSES = self.old_MIDDLEWARE_CLASSES\n-        settings.TEMPLATE_DIRS = self.old_TEMPLATE_DIRS\n-        settings.LOGIN_URL = self.old_LOGIN_URL\n-        settings.APPEND_SLASH = self.old_APPEND_SLASH\n-\n     def test_redirect_view_flatpage(self):\n         \"A flatpage can be served through a view and should add a slash\"\n         response = self.client.get('/flatpage_root/flatpage')"
        },
        {
            "sha": "4aa12038b56a6d92a07dc2517c43f421f8d6d52f",
            "filename": "django/contrib/formtools/templates/404.html",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fformtools%2Ftemplates%2F404.html",
            "raw_url": "https://github.com/django/django/raw/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fformtools%2Ftemplates%2F404.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Ftemplates%2F404.html?ref=98e9d1c6aba3670712887b0b20317dcb0e25f249",
            "patch": "@@ -0,0 +1 @@\n+Not found."
        },
        {
            "sha": "e628690491bc8c89aa36c05bcea4464894605664",
            "filename": "django/contrib/formtools/tests/__init__.py",
            "status": "modified",
            "additions": 14,
            "deletions": 24,
            "changes": 38,
            "blob_url": "https://github.com/django/django/blob/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fformtools%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/98e9d1c6aba3670712887b0b20317dcb0e25f249/django%2Fcontrib%2Fformtools%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Ftests%2F__init__.py?ref=98e9d1c6aba3670712887b0b20317dcb0e25f249",
            "patch": "@@ -7,6 +7,7 @@\n from django.contrib.formtools import preview, utils\n from django.contrib.formtools.wizard import FormWizard\n from django.test import TestCase\n+from django.test.utils import override_settings\n from django.utils import unittest\n \n from django.contrib.formtools.tests.wizard import *\n@@ -29,19 +30,12 @@ def get_initial(self, request):\n     def done(self, request, cleaned_data):\n         return http.HttpResponse(success_string)\n \n-\n-class FormToolsTestCase(TestCase):\n-    def setUp(self):\n-        # in the test runner use templates/tests/ to provide base.html\n-        self.old_TEMPLATE_DIRS = settings.TEMPLATE_DIRS\n-        settings.TEMPLATE_DIRS = list(settings.TEMPLATE_DIRS) + [\n-            os.path.join(os.path.dirname(__file__), 'templates')]\n-\n-    def tearDown(self):\n-        settings.TEMPLATE_DIRS = self.old_TEMPLATE_DIRS\n-\n-\n-class PreviewTests(FormToolsTestCase):\n+@override_settings(\n+    TEMPLATE_DIRS=(\n+        os.path.join(os.path.dirname(__file__), 'templates'),\n+    ),\n+)\n+class PreviewTests(TestCase):\n     urls = 'django.contrib.formtools.tests.urls'\n \n     def setUp(self):\n@@ -215,7 +209,13 @@ def __init__(self, POST=None):\n         self._dont_enforce_csrf_checks = True\n \n \n-class WizardTests(FormToolsTestCase):\n+@override_settings(\n+    SECRET_KEY=\"123\",\n+    TEMPLATE_DIRS=(\n+        os.path.join(os.path.dirname(__file__), 'templates'),\n+    ),\n+)\n+class WizardTests(TestCase):\n     urls = 'django.contrib.formtools.tests.urls'\n     input_re = re.compile('name=\"([^\"]+)\" value=\"([^\"]+)\"')\n     wizard_step_data = (\n@@ -232,16 +232,6 @@ class WizardTests(FormToolsTestCase):\n         }\n     )\n \n-    def setUp(self):\n-        super(WizardTests, self).setUp()\n-        # Use a known SECRET_KEY to make security_hash tests deterministic\n-        self.old_SECRET_KEY = settings.SECRET_KEY\n-        settings.SECRET_KEY = \"123\"\n-\n-    def tearDown(self):\n-        super(WizardTests, self).tearDown()\n-        settings.SECRET_KEY = self.old_SECRET_KEY\n-\n     def test_step_starts_at_zero(self):\n         \"\"\"\n         step should be zero for the first form"
        }
    ],
    "stats": {
        "total": 293,
        "additions": 122,
        "deletions": 171
    }
}