{
    "author": "ramiro",
    "message": "Changed name given to test applications in Django own test suite running tool from 'model' to 'module' or 'application'.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15257 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ccfd70c7ba4852bdd849a714917165b5c5b77f30",
    "files": [
        {
            "sha": "8b7def6323e34e6e1851f1b49ecd827a389d0bef",
            "filename": "tests/runtests.py",
            "status": "modified",
            "additions": 32,
            "deletions": 32,
            "changes": 64,
            "blob_url": "https://github.com/django/django/blob/ccfd70c7ba4852bdd849a714917165b5c5b77f30/tests%2Fruntests.py",
            "raw_url": "https://github.com/django/django/raw/ccfd70c7ba4852bdd849a714917165b5c5b77f30/tests%2Fruntests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fruntests.py?ref=ccfd70c7ba4852bdd849a714917165b5c5b77f30",
            "patch": "@@ -1,5 +1,5 @@\n #!/usr/bin/env python\n-import os, subprocess, sys, traceback\n+import os, subprocess, sys\n \n import django.contrib as contrib\n from django.utils import unittest\n@@ -36,39 +36,39 @@ def geodjango(settings):\n                    if db_dict['ENGINE'].startswith('django.contrib.gis')]\n     return len(spatial_dbs) == len(settings.DATABASES)\n \n-def get_test_models():\n-    models = []\n+def get_test_modules():\n+    modules = []\n     for loc, dirpath in (MODEL_TESTS_DIR_NAME, MODEL_TEST_DIR), (REGRESSION_TESTS_DIR_NAME, REGRESSION_TEST_DIR), (CONTRIB_DIR_NAME, CONTRIB_DIR):\n         for f in os.listdir(dirpath):\n             if f.startswith('__init__') or f.startswith('.') or \\\n                f.startswith('sql') or f.startswith('invalid') or \\\n                os.path.basename(f) in REGRESSION_SUBDIRS_TO_SKIP:\n                 continue\n-            models.append((loc, f))\n-    return models\n+            modules.append((loc, f))\n+    return modules\n \n-def get_invalid_models():\n-    models = []\n+def get_invalid_modules():\n+    modules = []\n     for loc, dirpath in (MODEL_TESTS_DIR_NAME, MODEL_TEST_DIR), (REGRESSION_TESTS_DIR_NAME, REGRESSION_TEST_DIR), (CONTRIB_DIR_NAME, CONTRIB_DIR):\n         for f in os.listdir(dirpath):\n             if f.startswith('__init__') or f.startswith('.') or f.startswith('sql'):\n                 continue\n             if f.startswith('invalid'):\n-                models.append((loc, f))\n-    return models\n+                modules.append((loc, f))\n+    return modules\n \n class InvalidModelTestCase(unittest.TestCase):\n-    def __init__(self, model_label):\n+    def __init__(self, module_label):\n         unittest.TestCase.__init__(self)\n-        self.model_label = model_label\n+        self.module_label = module_label\n \n     def runTest(self):\n         from django.core.management.validation import get_validation_errors\n         from django.db.models.loading import load_app\n         from cStringIO import StringIO\n \n         try:\n-            module = load_app(self.model_label)\n+            module = load_app(self.module_label)\n         except Exception, e:\n             self.fail('Unable to load invalid model module')\n \n@@ -130,26 +130,26 @@ def setup(verbosity, test_labels):\n \n     # Load all the test model apps.\n     test_labels_set = set([label.split('.')[0] for label in test_labels])\n-    test_models = get_test_models()\n+    test_modules = get_test_modules()\n \n     # If GeoDjango, then we'll want to add in the test applications\n     # that are a part of its test suite.\n     if geodjango(settings):\n         from django.contrib.gis.tests import geo_apps\n-        test_models.extend(geo_apps(runtests=True))\n-\n-    for model_dir, model_name in test_models:\n-        model_label = '.'.join([model_dir, model_name])\n-        # if the model was named on the command line, or\n-        # no models were named (i.e., run all), import\n-        # this model and add it to the list to test.\n-        if not test_labels or model_name in test_labels_set:\n+        test_modules.extend(geo_apps(runtests=True))\n+\n+    for module_dir, module_name in test_modules:\n+        module_label = '.'.join([module_dir, module_name])\n+        # if the module was named on the command line, or\n+        # no modules were named (i.e., run all), import\n+        # this module and add it to the list to test.\n+        if not test_labels or module_name in test_labels_set:\n             if verbosity >= 2:\n-                print \"Importing model %s\" % model_name\n-            mod = load_app(model_label)\n+                print \"Importing application %s\" % module_name\n+            mod = load_app(module_label)\n             if mod:\n-                if model_label not in settings.INSTALLED_APPS:\n-                    settings.INSTALLED_APPS.append(model_label)\n+                if module_label not in settings.INSTALLED_APPS:\n+                    settings.INSTALLED_APPS.append(module_label)\n \n     return state\n \n@@ -163,16 +163,16 @@ def django_tests(verbosity, interactive, failfast, test_labels):\n     from django.conf import settings\n     state = setup(verbosity, test_labels)\n \n-    # Add tests for invalid models.\n+    # Add tests for invalid models apps.\n     extra_tests = []\n-    for model_dir, model_name in get_invalid_models():\n-        model_label = '.'.join([model_dir, model_name])\n-        if not test_labels or model_name in test_labels:\n-            extra_tests.append(InvalidModelTestCase(model_label))\n+    for module_dir, module_name in get_invalid_modules():\n+        module_label = '.'.join([module_dir, module_name])\n+        if not test_labels or module_name in test_labels:\n+            extra_tests.append(InvalidModelTestCase(module_label))\n             try:\n                 # Invalid models are not working apps, so we cannot pass them into\n                 # the test runner with the other test_labels\n-                test_labels.remove(model_name)\n+                test_labels.remove(module_name)\n             except ValueError:\n                 pass\n \n@@ -304,7 +304,7 @@ def paired_tests(paired_test, options, test_labels):\n \n if __name__ == \"__main__\":\n     from optparse import OptionParser\n-    usage = \"%prog [options] [model model model ...]\"\n+    usage = \"%prog [options] [module module module ...]\"\n     parser = OptionParser(usage=usage)\n     parser.add_option('-v','--verbosity', action='store', dest='verbosity', default='1',\n         type='choice', choices=['0', '1', '2', '3'],"
        }
    ],
    "stats": {
        "total": 64,
        "additions": 32,
        "deletions": 32
    }
}