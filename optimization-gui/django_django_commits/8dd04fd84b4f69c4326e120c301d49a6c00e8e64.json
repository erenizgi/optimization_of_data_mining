{
    "author": "claudep",
    "message": "Fixed #15683 -- Prevented escaped string to be needlessly marked safe twice in force_escape filter. Thanks tyrion for the initial patch.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17876 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "8dd04fd84b4f69c4326e120c301d49a6c00e8e64",
    "files": [
        {
            "sha": "3efb73cf9685a90933bf7729b55336a023c38f3f",
            "filename": "django/template/defaultfilters.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/8dd04fd84b4f69c4326e120c301d49a6c00e8e64/django%2Ftemplate%2Fdefaultfilters.py",
            "raw_url": "https://github.com/django/django/raw/8dd04fd84b4f69c4326e120c301d49a6c00e8e64/django%2Ftemplate%2Fdefaultfilters.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fdefaultfilters.py?ref=8dd04fd84b4f69c4326e120c301d49a6c00e8e64",
            "patch": "@@ -419,7 +419,7 @@ def force_escape(value):\n     characters (as opposed to \"escape\", which marks the content for later\n     possible escaping).\n     \"\"\"\n-    return mark_safe(escape(value))\n+    return escape(value)\n \n @register.filter(\"linebreaks\", is_safe=True, needs_autoescape=True)\n @stringfilter"
        },
        {
            "sha": "88389be017a494d06e70b25224884745aced2b75",
            "filename": "tests/regressiontests/defaultfilters/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/8dd04fd84b4f69c4326e120c301d49a6c00e8e64/tests%2Fregressiontests%2Fdefaultfilters%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/8dd04fd84b4f69c4326e120c301d49a6c00e8e64/tests%2Fregressiontests%2Fdefaultfilters%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fdefaultfilters%2Ftests.py?ref=8dd04fd84b4f69c4326e120c301d49a6c00e8e64",
            "patch": "@@ -6,6 +6,7 @@\n from django.template.defaultfilters import *\n from django.test import TestCase\n from django.utils import unittest, translation\n+from django.utils.safestring import SafeData\n \n \n class DefaultFiltersTests(TestCase):\n@@ -328,9 +329,10 @@ def test_cut(self):\n                           u'a string to be mangled')\n \n     def test_force_escape(self):\n+        escaped = force_escape(u'<some html & special characters > here')\n         self.assertEqual(\n-            force_escape(u'<some html & special characters > here'),\n-            u'&lt;some html &amp; special characters &gt; here')\n+            escaped, u'&lt;some html &amp; special characters &gt; here')\n+        self.assertTrue(isinstance(escaped, SafeData))\n         self.assertEqual(\n             force_escape(u'<some html & special characters > here ĐÅ€£'),\n             u'&lt;some html &amp; special characters &gt; here'\\"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 5,
        "deletions": 3
    }
}