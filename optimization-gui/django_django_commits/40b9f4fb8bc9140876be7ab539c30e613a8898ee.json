{
    "author": "ambv",
    "message": "[py3] Always fed hashlib with bytes.",
    "sha": "40b9f4fb8bc9140876be7ab539c30e613a8898ee",
    "files": [
        {
            "sha": "fb987a5e3a28a3107b417187274d1948d4eead10",
            "filename": "django/template/loaders/cached.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/40b9f4fb8bc9140876be7ab539c30e613a8898ee/django%2Ftemplate%2Floaders%2Fcached.py",
            "raw_url": "https://github.com/django/django/raw/40b9f4fb8bc9140876be7ab539c30e613a8898ee/django%2Ftemplate%2Floaders%2Fcached.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Floaders%2Fcached.py?ref=40b9f4fb8bc9140876be7ab539c30e613a8898ee",
            "patch": "@@ -6,6 +6,7 @@\n import hashlib\n from django.template.base import TemplateDoesNotExist\n from django.template.loader import BaseLoader, get_template_from_string, find_template_loader, make_origin\n+from django.utils.encoding import force_bytes\n \n class Loader(BaseLoader):\n     is_usable = True\n@@ -40,7 +41,7 @@ def load_template(self, template_name, template_dirs=None):\n         key = template_name\n         if template_dirs:\n             # If template directories were specified, use a hash to differentiate\n-            key = '-'.join([template_name, hashlib.sha1('|'.join(template_dirs)).hexdigest()])\n+            key = '-'.join([template_name, hashlib.sha1(force_bytes('|'.join(template_dirs))).hexdigest()])\n \n         if key not in self.template_cache:\n             template, origin = self.find_template(template_name, template_dirs)"
        },
        {
            "sha": "917949d4d3f105bb7d79cf878448a7b4f290cfa9",
            "filename": "django/utils/cache.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/40b9f4fb8bc9140876be7ab539c30e613a8898ee/django%2Futils%2Fcache.py",
            "raw_url": "https://github.com/django/django/raw/40b9f4fb8bc9140876be7ab539c30e613a8898ee/django%2Futils%2Fcache.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fcache.py?ref=40b9f4fb8bc9140876be7ab539c30e613a8898ee",
            "patch": "@@ -181,7 +181,7 @@ def _generate_cache_key(request, method, headerlist, key_prefix):\n     for header in headerlist:\n         value = request.META.get(header, None)\n         if value is not None:\n-            ctx.update(value)\n+            ctx.update(force_bytes(value))\n     path = hashlib.md5(force_bytes(iri_to_uri(request.get_full_path())))\n     cache_key = 'views.decorators.cache.cache_page.%s.%s.%s.%s' % (\n         key_prefix, method, path.hexdigest(), ctx.hexdigest())"
        },
        {
            "sha": "94f717bb17158e1b9083dc6f713db96b7fa0ab5a",
            "filename": "django/utils/crypto.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/40b9f4fb8bc9140876be7ab539c30e613a8898ee/django%2Futils%2Fcrypto.py",
            "raw_url": "https://github.com/django/django/raw/40b9f4fb8bc9140876be7ab539c30e613a8898ee/django%2Futils%2Fcrypto.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fcrypto.py?ref=40b9f4fb8bc9140876be7ab539c30e613a8898ee",
            "patch": "@@ -72,10 +72,10 @@ def get_random_string(length=12,\n         # is better than absolute predictability.\n         random.seed(\n             hashlib.sha256(\n-                \"%s%s%s\" % (\n+                (\"%s%s%s\" % (\n                     random.getstate(),\n                     time.time(),\n-                    settings.SECRET_KEY)\n+                    settings.SECRET_KEY)).encode('utf-8')\n                 ).digest())\n     return ''.join([random.choice(allowed_chars) for i in range(length)])\n "
        },
        {
            "sha": "00c51638b72205d1e312162521ac7e113be53a79",
            "filename": "tests/cache/tests.py",
            "status": "modified",
            "additions": 11,
            "deletions": 11,
            "changes": 22,
            "blob_url": "https://github.com/django/django/blob/40b9f4fb8bc9140876be7ab539c30e613a8898ee/tests%2Fcache%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/40b9f4fb8bc9140876be7ab539c30e613a8898ee/tests%2Fcache%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fcache%2Ftests.py?ref=40b9f4fb8bc9140876be7ab539c30e613a8898ee",
            "patch": "@@ -1327,7 +1327,7 @@ def test_cache_key_i18n_translation(self):\n     def check_accept_language_vary(self, accept_language, vary, reference_key):\n         request = self._get_request()\n         request.META['HTTP_ACCEPT_LANGUAGE'] = accept_language\n-        request.META['HTTP_ACCEPT_ENCODING'] = b'gzip;q=1.0, identity; q=0.5, *;q=0'\n+        request.META['HTTP_ACCEPT_ENCODING'] = 'gzip;q=1.0, identity; q=0.5, *;q=0'\n         response = HttpResponse()\n         response['Vary'] = vary\n         key = learn_cache_key(request, response)\n@@ -1340,53 +1340,53 @@ def test_cache_key_i18n_translation_accept_language(self):\n         lang = translation.get_language()\n         self.assertEqual(lang, 'en')\n         request = self._get_request()\n-        request.META['HTTP_ACCEPT_ENCODING'] = b'gzip;q=1.0, identity; q=0.5, *;q=0'\n+        request.META['HTTP_ACCEPT_ENCODING'] = 'gzip;q=1.0, identity; q=0.5, *;q=0'\n         response = HttpResponse()\n         response['Vary'] = 'accept-encoding'\n         key = learn_cache_key(request, response)\n         self.assertIn(lang, key, \"Cache keys should include the language name when translation is active\")\n         self.check_accept_language_vary(\n-            b'en-us',\n+            'en-us',\n             'cookie, accept-language, accept-encoding',\n             key\n         )\n         self.check_accept_language_vary(\n-            b'en-US',\n+            'en-US',\n             'cookie, accept-encoding, accept-language',\n             key\n         )\n         self.check_accept_language_vary(\n-            b'en-US,en;q=0.8',\n+            'en-US,en;q=0.8',\n             'accept-encoding, accept-language, cookie',\n             key\n         )\n         self.check_accept_language_vary(\n-            b'en-US,en;q=0.8,ko;q=0.6',\n+            'en-US,en;q=0.8,ko;q=0.6',\n             'accept-language, cookie, accept-encoding',\n             key\n         )\n         self.check_accept_language_vary(\n-            b'ko-kr,ko;q=0.8,en-us;q=0.5,en;q=0.3 ',\n+            'ko-kr,ko;q=0.8,en-us;q=0.5,en;q=0.3 ',\n             'accept-encoding, cookie, accept-language',\n             key\n         )\n         self.check_accept_language_vary(\n-            b'ko-KR,ko;q=0.8,en-US;q=0.6,en;q=0.4',\n+            'ko-KR,ko;q=0.8,en-US;q=0.6,en;q=0.4',\n             'accept-language, accept-encoding, cookie',\n             key\n         )\n         self.check_accept_language_vary(\n-            b'ko;q=1.0,en;q=0.5',\n+            'ko;q=1.0,en;q=0.5',\n             'cookie, accept-language, accept-encoding',\n             key\n         )\n         self.check_accept_language_vary(\n-            b'ko, en',\n+            'ko, en',\n             'cookie, accept-encoding, accept-language',\n             key\n         )\n         self.check_accept_language_vary(\n-            b'ko-KR, en-US',\n+            'ko-KR, en-US',\n             'accept-encoding, accept-language, cookie',\n             key\n         )"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 16,
        "deletions": 15
    }
}