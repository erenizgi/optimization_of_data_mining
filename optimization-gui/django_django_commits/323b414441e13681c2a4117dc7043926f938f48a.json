{
    "author": "akaariai",
    "message": "Added tests for nested exclude/negate queries",
    "sha": "323b414441e13681c2a4117dc7043926f938f48a",
    "files": [
        {
            "sha": "1035a388402abab8df04a53815cb1cb29ed8f5af",
            "filename": "tests/regressiontests/queries/tests.py",
            "status": "modified",
            "additions": 33,
            "deletions": 0,
            "changes": 33,
            "blob_url": "https://github.com/django/django/blob/323b414441e13681c2a4117dc7043926f938f48a/tests%2Fregressiontests%2Fqueries%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/323b414441e13681c2a4117dc7043926f938f48a/tests%2Fregressiontests%2Fqueries%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fqueries%2Ftests.py?ref=323b414441e13681c2a4117dc7043926f938f48a",
            "patch": "@@ -844,6 +844,39 @@ def test_ticket17429(self):\n         )\n         Tag._meta.ordering = original_ordering\n \n+    def test_exclude(self):\n+        self.assertQuerysetEqual(\n+            Item.objects.exclude(tags__name='t4'),\n+            [repr(i) for i in Item.objects.filter(~Q(tags__name='t4'))])\n+        self.assertQuerysetEqual(\n+            Item.objects.exclude(Q(tags__name='t4')|Q(tags__name='t3')),\n+            [repr(i) for i in Item.objects.filter(~(Q(tags__name='t4')|Q(tags__name='t3')))])\n+        self.assertQuerysetEqual(\n+            Item.objects.exclude(Q(tags__name='t4')|~Q(tags__name='t3')),\n+            [repr(i) for i in Item.objects.filter(~(Q(tags__name='t4')|~Q(tags__name='t3')))])\n+\n+    def test_nested_exclude(self):\n+        self.assertQuerysetEqual(\n+            Item.objects.exclude(~Q(tags__name='t4')),\n+            [repr(i) for i in Item.objects.filter(~~Q(tags__name='t4'))])\n+\n+    def test_double_exclude(self):\n+        self.assertQuerysetEqual(\n+            Item.objects.filter(Q(tags__name='t4')),\n+            [repr(i) for i in Item.objects.filter(~~Q(tags__name='t4'))])\n+        self.assertQuerysetEqual(\n+            Item.objects.filter(Q(tags__name='t4')),\n+            [repr(i) for i in Item.objects.filter(~Q(~Q(tags__name='t4')))])\n+\n+    @unittest.expectedFailure\n+    def test_exclude_in(self):\n+        self.assertQuerysetEqual(\n+            Item.objects.exclude(Q(tags__name__in=['t4', 't3'])),\n+            [repr(i) for i in Item.objects.filter(~Q(tags__name__in=['t4', 't3']))])\n+        self.assertQuerysetEqual(\n+            Item.objects.filter(Q(tags__name__in=['t4', 't3'])),\n+            [repr(i) for i in Item.objects.filter(~~Q(tags__name__in=['t4', 't3']))])\n+\n class Queries2Tests(TestCase):\n     def setUp(self):\n         Number.objects.create(num=4)"
        }
    ],
    "stats": {
        "total": 33,
        "additions": 33,
        "deletions": 0
    }
}