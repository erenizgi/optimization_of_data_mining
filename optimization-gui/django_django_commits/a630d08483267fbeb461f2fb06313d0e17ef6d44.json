{
    "author": "apollo13",
    "message": "Merge pull request #360 from calebsmith/add-permalink-wraps-test\n\nTicket #12836 - Added a test to assure permalink wraps method attributes",
    "sha": "a630d08483267fbeb461f2fb06313d0e17ef6d44",
    "files": [
        {
            "sha": "dacf2a3fb3c2ac93c911b2aa94ce401b72634af3",
            "filename": "tests/regressiontests/model_permalink/models.py",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/a630d08483267fbeb461f2fb06313d0e17ef6d44/tests%2Fregressiontests%2Fmodel_permalink%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/a630d08483267fbeb461f2fb06313d0e17ef6d44/tests%2Fregressiontests%2Fmodel_permalink%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmodel_permalink%2Fmodels.py?ref=a630d08483267fbeb461f2fb06313d0e17ef6d44",
            "patch": "@@ -1,6 +1,13 @@\n from django.db import models\n \n \n+def set_attr(name, value):\n+    def wrapper(function):\n+        setattr(function, name, value)\n+        return function\n+    return wrapper\n+\n+\n class Guitarist(models.Model):\n     name = models.CharField(max_length=50)\n     slug = models.CharField(max_length=50)\n@@ -9,3 +16,9 @@ class Guitarist(models.Model):\n     def url(self):\n         \"Returns the URL for this guitarist.\"\n         return ('guitarist_detail', [self.slug])\n+\n+    @models.permalink\n+    @set_attr('attribute', 'value')\n+    def url_with_attribute(self):\n+        \"Returns the URL for this guitarist and holds an attribute\"\n+        return ('guitarist_detail', [self.slug])"
        },
        {
            "sha": "049f338c2ed98604027a695c9fdaaeb3ab761842",
            "filename": "tests/regressiontests/model_permalink/tests.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/a630d08483267fbeb461f2fb06313d0e17ef6d44/tests%2Fregressiontests%2Fmodel_permalink%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a630d08483267fbeb461f2fb06313d0e17ef6d44/tests%2Fregressiontests%2Fmodel_permalink%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmodel_permalink%2Ftests.py?ref=a630d08483267fbeb461f2fb06313d0e17ef6d44",
            "patch": "@@ -16,3 +16,12 @@ def test_wrapped_docstring(self):\n         \"Methods using the @permalink decorator retain their docstring.\"\n         g = Guitarist(name='Adrien Moignard', slug='adrienmoignard')\n         self.assertEqual(g.url.__doc__, \"Returns the URL for this guitarist.\")\n+\n+    def test_wrapped_attribute(self):\n+        \"\"\"\n+        Methods using the @permalink decorator can have attached attributes\n+        from other decorators\n+        \"\"\"\n+        g = Guitarist(name='Adrien Moignard', slug='adrienmoignard')\n+        self.assertTrue(hasattr(g.url_with_attribute, 'attribute'))\n+        self.assertEqual(g.url_with_attribute.attribute, 'value')"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 22,
        "deletions": 0
    }
}