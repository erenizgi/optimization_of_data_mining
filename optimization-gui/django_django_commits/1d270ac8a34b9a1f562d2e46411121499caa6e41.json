{
    "author": "ramiro",
    "message": "Reverted [14563] because it introduced a dependency from core on a contrib app (contenttypes). Fixes #16283, Refs #3055. Thanks TheRoSS for the report and Aymeric Augustin for finding the problem.\n\nThis caused models shipped with some contrib apps to pollute the namespace when user's apps had the same name (e.g. auth, sites), even when these contrib apps weren't installed.\n\nThis undesired loading of contrib apps happened when model validation was executed, for example when running management commands that set or inherit `requires_model_validation=True`:\ncleanup, dumpdata, flush, loaddata, reset, runfcgi, sql, sqlall, sqlclear, sqlcustom, sqlflush, sqlindexes, sqlinitialdata, sqlreset, sqlsequencereset, syncdb, createsuperusers, ping_google, collectstatic, findstatic.\n\nThis could also cause hard to diagnose problems e.g. when performing reverse URL resolving.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16493 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "1d270ac8a34b9a1f562d2e46411121499caa6e41",
    "files": [
        {
            "sha": "55665804c4a04b93c0aeeae62d8d366d681430f4",
            "filename": "django/core/management/validation.py",
            "status": "modified",
            "additions": 0,
            "deletions": 7,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/1d270ac8a34b9a1f562d2e46411121499caa6e41/django%2Fcore%2Fmanagement%2Fvalidation.py",
            "raw_url": "https://github.com/django/django/raw/1d270ac8a34b9a1f562d2e46411121499caa6e41/django%2Fcore%2Fmanagement%2Fvalidation.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fvalidation.py?ref=1d270ac8a34b9a1f562d2e46411121499caa6e41",
            "patch": "@@ -1,6 +1,5 @@\n import sys\n \n-from django.contrib.contenttypes.generic import GenericForeignKey, GenericRelation\n from django.core.management.color import color_style\n from django.utils.itercompat import is_iterable\n \n@@ -235,12 +234,6 @@ def get_validation_errors(outfile, app=None):\n                 e.add(opts, \"'%s' specifies an m2m relation through model %s, \"\n                     \"which has not been installed\" % (f.name, f.rel.through)\n                 )\n-            elif isinstance(f, GenericRelation):\n-                if not any([isinstance(vfield, GenericForeignKey) for vfield in f.rel.to._meta.virtual_fields]):\n-                    e.add(opts, \"Model '%s' must have a GenericForeignKey in \"\n-                        \"order to create a GenericRelation that points to it.\"\n-                        % f.rel.to.__name__\n-                    )\n \n             rel_opts = f.rel.to._meta\n             rel_name = RelatedObject(f.rel.to, cls, f).get_accessor_name()"
        },
        {
            "sha": "45f302413dda9a10646828bcec251addc07a146f",
            "filename": "tests/modeltests/invalid_models/models.py",
            "status": "modified",
            "additions": 0,
            "deletions": 17,
            "changes": 17,
            "blob_url": "https://github.com/django/django/blob/1d270ac8a34b9a1f562d2e46411121499caa6e41/tests%2Fmodeltests%2Finvalid_models%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/1d270ac8a34b9a1f562d2e46411121499caa6e41/tests%2Fmodeltests%2Finvalid_models%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Finvalid_models%2Fmodels.py?ref=1d270ac8a34b9a1f562d2e46411121499caa6e41",
            "patch": "@@ -4,7 +4,6 @@\n This example exists purely to point out errors in models.\n \"\"\"\n \n-from django.contrib.contenttypes import generic\n from django.db import models\n \n class FieldErrors(models.Model):\n@@ -219,21 +218,6 @@ class InvalidSetNull(models.Model):\n class InvalidSetDefault(models.Model):\n     fk = models.ForeignKey('self', on_delete=models.SET_DEFAULT)\n \n-class Tag(models.Model):\n-   name = models.CharField(\"name\", max_length=20)\n-\n-class TaggedObject(models.Model):\n-   object_id = models.PositiveIntegerField(\"Object ID\")\n-   tag = models.ForeignKey(Tag)\n-   content_object = generic.GenericForeignKey()\n-\n-class UserTaggedObject(models.Model):\n-   object_tag = models.ForeignKey(TaggedObject)\n-\n-class ArticleAttachment(models.Model):\n-   tags = generic.GenericRelation(TaggedObject)\n-   user_tags = generic.GenericRelation(UserTaggedObject)\n-\n model_errors = \"\"\"invalid_models.fielderrors: \"charfield\": CharFields require a \"max_length\" attribute that is a positive integer.\n invalid_models.fielderrors: \"charfield2\": CharFields require a \"max_length\" attribute that is a positive integer.\n invalid_models.fielderrors: \"charfield3\": CharFields require a \"max_length\" attribute that is a positive integer.\n@@ -343,5 +327,4 @@ class ArticleAttachment(models.Model):\n invalid_models.nonexistingorderingwithsingleunderscore: \"ordering\" refers to \"does_not_exist\", a field that doesn't exist.\n invalid_models.invalidsetnull: 'fk' specifies on_delete=SET_NULL, but cannot be null.\n invalid_models.invalidsetdefault: 'fk' specifies on_delete=SET_DEFAULT, but has no default value.\n-invalid_models.articleattachment: Model 'UserTaggedObject' must have a GenericForeignKey in order to create a GenericRelation that points to it.\n \"\"\""
        }
    ],
    "stats": {
        "total": 24,
        "additions": 0,
        "deletions": 24
    }
}