{
    "author": "kmtracey",
    "message": "Fixed #17134: Corrected Python 2.5 fallback code for parsing microseconds in time values. Thanks aaugustin and jcd.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17092 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "0db571b417ce9f9f10e30fae8513fbeaebd55fa7",
    "files": [
        {
            "sha": "4cd2911eaad46e4364c0be8da9066ccbf7f1cc40",
            "filename": "django/forms/fields.py",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/0db571b417ce9f9f10e30fae8513fbeaebd55fa7/django%2Fforms%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/0db571b417ce9f9f10e30fae8513fbeaebd55fa7/django%2Fforms%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Ffields.py?ref=0db571b417ce9f9f10e30fae8513fbeaebd55fa7",
            "patch": "@@ -340,11 +340,13 @@ def to_python(self, value):\n                     return self.strptime(value, format)\n                 except ValueError:\n                     if format.endswith('.%f'):\n-                        if value.count('.') != 1:\n+                        # Compatibility with datetime in pythons < 2.6.\n+                        # See: http://docs.python.org/library/datetime.html#strftime-and-strptime-behavior\n+                        if value.count('.') != format.count('.'):\n                             continue\n                         try:\n                             datetime_str, usecs_str = value.rsplit('.', 1)\n-                            usecs = int(usecs_str)\n+                            usecs = int(usecs_str[:6].ljust(6, '0'))\n                             dt = datetime.datetime.strptime(datetime_str, format[:-3])\n                             return dt.replace(microsecond=usecs)\n                         except ValueError:"
        },
        {
            "sha": "0f9e91a55e4f9e42f9af292cd026af27356e3a38",
            "filename": "tests/regressiontests/forms/tests/fields.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/0db571b417ce9f9f10e30fae8513fbeaebd55fa7/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/0db571b417ce9f9f10e30fae8513fbeaebd55fa7/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py?ref=0db571b417ce9f9f10e30fae8513fbeaebd55fa7",
            "patch": "@@ -407,6 +407,7 @@ def test_datetimefield_1(self):\n         self.assertEqual(datetime.datetime(2006, 10, 25, 14, 30, 59), f.clean(datetime.datetime(2006, 10, 25, 14, 30, 59)))\n         self.assertEqual(datetime.datetime(2006, 10, 25, 14, 30, 59, 200), f.clean(datetime.datetime(2006, 10, 25, 14, 30, 59, 200)))\n         self.assertEqual(datetime.datetime(2006, 10, 25, 14, 30, 45, 200), f.clean('2006-10-25 14:30:45.000200'))\n+        self.assertEqual(datetime.datetime(2006, 10, 25, 14, 30, 45, 200), f.clean('2006-10-25 14:30:45.0002'))\n         self.assertEqual(datetime.datetime(2006, 10, 25, 14, 30, 45), f.clean('2006-10-25 14:30:45'))\n         self.assertEqual(datetime.datetime(2006, 10, 25, 14, 30), f.clean('2006-10-25 14:30:00'))\n         self.assertEqual(datetime.datetime(2006, 10, 25, 14, 30), f.clean('2006-10-25 14:30'))\n@@ -452,6 +453,9 @@ def test_datetimefield_4(self):\n         self.assertEqual(datetime.datetime(2006, 10, 25, 0, 0), f.clean(' 10/25/06 '))\n         self.assertRaisesMessage(ValidationError, \"[u'Enter a valid date/time.']\", f.clean, '   ')\n \n+    def test_datetimefield_5(self):\n+        f = DateTimeField(input_formats=[u'%Y.%m.%d %H:%M:%S.%f'])\n+        self.assertEqual(datetime.datetime(2006, 10, 25, 14, 30, 45, 200), f.clean('2006.10.25 14:30:45.0002'))\n     # RegexField ##################################################################\n \n     def test_regexfield_1(self):"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 8,
        "deletions": 2
    }
}