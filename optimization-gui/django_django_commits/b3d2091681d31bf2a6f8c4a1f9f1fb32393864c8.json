{
    "author": "freakboy3742",
    "message": "Fixed #12816 -- Added a render() shortcut.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15008 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8",
    "files": [
        {
            "sha": "00e97b1107319990930e3d2214e2d0ebe724b670",
            "filename": "django/shortcuts/__init__.py",
            "status": "modified",
            "additions": 22,
            "deletions": 10,
            "changes": 32,
            "blob_url": "https://github.com/django/django/blob/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/django%2Fshortcuts%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/django%2Fshortcuts%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fshortcuts%2F__init__.py?ref=b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8",
            "patch": "@@ -4,7 +4,7 @@\n for convenience's sake.\n \"\"\"\n \n-from django.template import loader\n+from django.template import loader, RequestContext\n from django.http import HttpResponse, Http404\n from django.http import HttpResponseRedirect, HttpResponsePermanentRedirect\n from django.db.models.manager import Manager\n@@ -19,32 +19,43 @@ def render_to_response(*args, **kwargs):\n     httpresponse_kwargs = {'mimetype': kwargs.pop('mimetype', None)}\n     return HttpResponse(loader.render_to_string(*args, **kwargs), **httpresponse_kwargs)\n \n+def render(request, *args, **kwargs):\n+    \"\"\"\n+    Returns a HttpResponse whose content is filled with the result of calling\n+    django.template.loader.render_to_string() with the passed arguments.\n+    Uses a RequestContext by default.\n+    \"\"\"\n+    httpresponse_kwargs = {'mimetype': kwargs.pop('mimetype', None)}\n+    kwargs['context_instance'] = kwargs.get('context_instance', RequestContext(request))\n+    return HttpResponse(loader.render_to_string(*args, **kwargs),\n+                        **httpresponse_kwargs)\n+\n def redirect(to, *args, **kwargs):\n     \"\"\"\n     Returns an HttpResponseRedirect to the apropriate URL for the arguments\n     passed.\n-    \n+\n     The arguments could be:\n-    \n+\n         * A model: the model's `get_absolute_url()` function will be called.\n-    \n+\n         * A view name, possibly with arguments: `urlresolvers.reverse()` will\n           be used to reverse-resolve the name.\n-         \n+\n         * A URL, which will be used as-is for the redirect location.\n-        \n+\n     By default issues a temporary redirect; pass permanent=True to issue a\n     permanent redirect\n     \"\"\"\n     if kwargs.pop('permanent', False):\n         redirect_class = HttpResponsePermanentRedirect\n     else:\n         redirect_class = HttpResponseRedirect\n-    \n+\n     # If it's a model, use get_absolute_url()\n     if hasattr(to, 'get_absolute_url'):\n         return redirect_class(to.get_absolute_url())\n-    \n+\n     # Next try a reverse URL resolution.\n     try:\n         return redirect_class(urlresolvers.reverse(to, args=args, kwargs=kwargs))\n@@ -55,7 +66,7 @@ def redirect(to, *args, **kwargs):\n         # If this doesn't \"feel\" like a URL, re-raise.\n         if '/' not in to and '.' not in to:\n             raise\n-        \n+\n     # Finally, fall back and assume it's a URL\n     return redirect_class(to)\n \n@@ -101,4 +112,5 @@ def get_list_or_404(klass, *args, **kwargs):\n     obj_list = list(queryset.filter(*args, **kwargs))\n     if not obj_list:\n         raise Http404('No %s matches the given query.' % queryset.model._meta.object_name)\n-    return obj_list\n\\ No newline at end of file\n+    return obj_list\n+"
        },
        {
            "sha": "d111eaeffb25431630d63687e8d21e77d941ea95",
            "filename": "docs/releases/1.3.txt",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/docs%2Freleases%2F1.3.txt",
            "raw_url": "https://github.com/django/django/raw/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/docs%2Freleases%2F1.3.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.3.txt?ref=b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8",
            "patch": "@@ -215,6 +215,11 @@ requests. These include:\n       making it easier to write simple template tags that require\n       access to template context.\n \n+    * A new :meth:`~django.shortcuts.render()` shortcut -- an\n+      alternative to :meth:`~django.shortcuts.render_to_response()`\n+      providing a :class:`~django.template.RequestContext` by\n+      default.\n+\n .. _HTTPOnly: http://www.owasp.org/index.php/HTTPOnly\n \n .. _backwards-incompatible-changes-1.3:"
        },
        {
            "sha": "d99429dbce4d4fc327d001a6ffd55443d306a85b",
            "filename": "docs/topics/http/shortcuts.txt",
            "status": "modified",
            "additions": 64,
            "deletions": 0,
            "changes": 64,
            "blob_url": "https://github.com/django/django/blob/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/docs%2Ftopics%2Fhttp%2Fshortcuts.txt",
            "raw_url": "https://github.com/django/django/raw/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/docs%2Ftopics%2Fhttp%2Fshortcuts.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fhttp%2Fshortcuts.txt?ref=b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8",
            "patch": "@@ -12,6 +12,70 @@ The package ``django.shortcuts`` collects helper functions and classes that\n \"span\" multiple levels of MVC. In other words, these functions/classes\n introduce controlled coupling for convenience's sake.\n \n+``render``\n+==========\n+\n+.. function:: render(request, template[, dictionary][, context_instance][, mimetype])\n+\n+   Combines a given template with a given context dictionary and returns an\n+   :class:`~django.http.HttpResponse` object with that rendered text.\n+\n+   :func:`render()` is the same as a call to\n+   :func:`render_to_response()` with a context_instance argument that\n+   that forces the use of a :class:`RequestContext`.\n+\n+Required arguments\n+------------------\n+\n+``request``\n+    The request object used to generate this response.\n+\n+``template``\n+    The full name of a template to use or sequence of template names.\n+\n+Optional arguments\n+------------------\n+\n+``dictionary``\n+    A dictionary of values to add to the template context. By default, this\n+    is an empty dictionary. If a value in the dictionary is callable, the\n+    view will call it just before rendering the template.\n+\n+``context_instance``\n+    The context instance to render the template with. By default, the template\n+    will be rendered with a ``RequestContext`` instance (filled with values from\n+    ``request`` and ```dictionary``).\n+\n+``mimetype``\n+    The MIME type to use for the resulting document. Defaults to the value of\n+    the :setting:`DEFAULT_CONTENT_TYPE` setting.\n+\n+Example\n+-------\n+\n+The following example renders the template ``myapp/index.html`` with the\n+MIME type ``application/xhtml+xml``::\n+\n+    from django.shortcuts import render_to_response\n+\n+    def my_view(request):\n+        # View code here...\n+        return render_to_response('myapp/index.html', {\"foo\": \"bar\"},\n+            mimetype=\"application/xhtml+xml\")\n+\n+This example is equivalent to::\n+\n+    from django.http import HttpResponse\n+    from django.template import Context, loader\n+\n+    def my_view(request):\n+        # View code here...\n+        t = loader.get_template('myapp/template.html')\n+        c = RequestContext(request, {'foo': 'bar'})\n+        return HttpResponse(t.render(c),\n+            mimetype=\"application/xhtml+xml\")\n+\n+\n ``render_to_response``\n ======================\n "
        },
        {
            "sha": "1b2f47a0e36b0fa14fad06b2bc9b9c3e88686ce4",
            "filename": "tests/regressiontests/views/templates/debug/render_test.html",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Ftemplates%2Fdebug%2Frender_test.html",
            "raw_url": "https://github.com/django/django/raw/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Ftemplates%2Fdebug%2Frender_test.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftemplates%2Fdebug%2Frender_test.html?ref=b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8",
            "patch": "@@ -1 +1 @@\n-{{ foo }}.{{ bar }}.{{ baz }}.{{ processors }}\n+{{ foo }}.{{ bar }}.{{ baz }}.{{ STATIC_URL }}"
        },
        {
            "sha": "b888dde5dc86d8da2ff30663ce5a263d1900af7d",
            "filename": "tests/regressiontests/views/tests/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2F__init__.py?ref=b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8",
            "patch": "@@ -5,5 +5,6 @@\n from generic.object_list import *\n from generic.simple import *\n from i18n import *\n+from shortcuts import *\n from specials import *\n from static import *"
        },
        {
            "sha": "fe1ff5b49ef37acae3afb2d5186589b3d01a30bd",
            "filename": "tests/regressiontests/views/tests/shortcuts.py",
            "status": "added",
            "additions": 53,
            "deletions": 0,
            "changes": 53,
            "blob_url": "https://github.com/django/django/blob/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Ftests%2Fshortcuts.py",
            "raw_url": "https://github.com/django/django/raw/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Ftests%2Fshortcuts.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2Fshortcuts.py?ref=b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8",
            "patch": "@@ -0,0 +1,53 @@\n+from django.conf import settings\n+from django.test import TestCase\n+\n+class ShortcutTests(TestCase):\n+    def setUp(self):\n+        self.old_STATIC_URL = settings.STATIC_URL\n+        self.old_TEMPLATE_CONTEXT_PROCESSORS = settings.TEMPLATE_CONTEXT_PROCESSORS\n+\n+        settings.STATIC_URL = '/path/to/static/media'\n+        settings.TEMPLATE_CONTEXT_PROCESSORS = (\n+            'django.core.context_processors.static'\n+        )\n+\n+    def tearDown(self):\n+        settings.STATIC_URL = self.old_STATIC_URL\n+        settings.TEMPLATE_CONTEXT_PROCESSORS = self.old_TEMPLATE_CONTEXT_PROCESSORS\n+\n+    def test_render_to_response(self):\n+        response = self.client.get('/views/shortcuts/render_to_response/')\n+        self.assertEquals(response.status_code, 200)\n+        self.assertEquals(response.content, 'FOO.BAR..\\n')\n+        self.assertEquals(response['Content-Type'], 'text/html; charset=utf-8')\n+\n+    def test_render_to_response_with_request_context(self):\n+        response = self.client.get('/views/shortcuts/render_to_response/request_context/')\n+        self.assertEquals(response.status_code, 200)\n+        self.assertEquals(response.content, 'FOO.BAR../path/to/static/media\\n')\n+        self.assertEquals(response['Content-Type'], 'text/html; charset=utf-8')\n+\n+    def test_render_to_response_with_mimetype(self):\n+        response = self.client.get('/views/shortcuts/render_to_response/mimetype/')\n+        self.assertEquals(response.status_code, 200)\n+        self.assertEquals(response.content, 'FOO.BAR..\\n')\n+        self.assertEquals(response['Content-Type'], 'application/x-rendertest')\n+\n+    def test_render(self):\n+        response = self.client.get('/views/shortcuts/render/')\n+        self.assertEquals(response.status_code, 200)\n+        self.assertEquals(response.content, 'FOO.BAR../path/to/static/media\\n')\n+        self.assertEquals(response['Content-Type'], 'text/html; charset=utf-8')\n+\n+    def test_render_with_base_context(self):\n+        response = self.client.get('/views/shortcuts/render/base_context/')\n+        self.assertEquals(response.status_code, 200)\n+        self.assertEquals(response.content, 'FOO.BAR..\\n')\n+        self.assertEquals(response['Content-Type'], 'text/html; charset=utf-8')\n+\n+    def test_render_with_mimetype(self):\n+        response = self.client.get('/views/shortcuts/render/mimetype/')\n+        self.assertEquals(response.status_code, 200)\n+        self.assertEquals(response.content, 'FOO.BAR../path/to/static/media\\n')\n+        self.assertEquals(response['Content-Type'], 'application/x-rendertest')\n+"
        },
        {
            "sha": "b1ca432e9f1d52c10bbf07a9932ddef76176409d",
            "filename": "tests/regressiontests/views/urls.py",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Furls.py?ref=b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8",
            "patch": "@@ -143,6 +143,14 @@\n urlpatterns += patterns('regressiontests.views.views',\n     url(r'view_exception/(?P<n>\\d+)/$', 'view_exception', name='view_exception'),\n     url(r'template_exception/(?P<n>\\d+)/$', 'template_exception', name='template_exception'),\n+\n+    (r'^shortcuts/render_to_response/$', 'render_to_response_view'),\n+    (r'^shortcuts/render_to_response/request_context/$', 'render_to_response_view_with_request_context'),\n+    (r'^shortcuts/render_to_response/mimetype/$', 'render_to_response_view_with_mimetype'),\n+    (r'^shortcuts/render/$', 'render_view'),\n+    (r'^shortcuts/render/base_context/$', 'render_view_with_base_context'),\n+    (r'^shortcuts/render/mimetype/$', 'render_view_with_mimetype'),\n+\n )\n \n # simple generic views."
        },
        {
            "sha": "0705bd01886397014dd6e572e758d7987f7c3b43",
            "filename": "tests/regressiontests/views/views.py",
            "status": "modified",
            "additions": 41,
            "deletions": 3,
            "changes": 44,
            "blob_url": "https://github.com/django/django/blob/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8/tests%2Fregressiontests%2Fviews%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Fviews.py?ref=b3d2091681d31bf2a6f8c4a1f9f1fb32393864c8",
            "patch": "@@ -1,11 +1,12 @@\n import sys\n \n-from django.http import HttpResponse, HttpResponseRedirect\n from django import forms\n+from django.http import HttpResponse, HttpResponseRedirect\n+from django.core.urlresolvers import get_resolver\n+from django.shortcuts import render_to_response, render\n+from django.template import Context, RequestContext\n from django.views.debug import technical_500_response\n from django.views.generic.create_update import create_object\n-from django.core.urlresolvers import get_resolver\n-from django.shortcuts import render_to_response\n \n from regressiontests.views import BrokenException, except_args\n \n@@ -57,3 +58,40 @@ def template_exception(request, n):\n     return render_to_response('debug/template_exception.html',\n         {'arg': except_args[int(n)]})\n \n+# Some views to exercise the shortcuts\n+\n+def render_to_response_view(request):\n+    return render_to_response('debug/render_test.html', {\n+        'foo': 'FOO',\n+        'bar': 'BAR',\n+    })\n+\n+def render_to_response_view_with_request_context(request):\n+    return render_to_response('debug/render_test.html', {\n+        'foo': 'FOO',\n+        'bar': 'BAR',\n+    }, context_instance=RequestContext(request))\n+\n+def render_to_response_view_with_mimetype(request):\n+    return render_to_response('debug/render_test.html', {\n+        'foo': 'FOO',\n+        'bar': 'BAR',\n+    }, mimetype='application/x-rendertest')\n+\n+def render_view(request):\n+    return render(request, 'debug/render_test.html', {\n+        'foo': 'FOO',\n+        'bar': 'BAR',\n+    })\n+\n+def render_view_with_base_context(request):\n+    return render(request, 'debug/render_test.html', {\n+        'foo': 'FOO',\n+        'bar': 'BAR',\n+    }, context_instance=Context())\n+\n+def render_view_with_mimetype(request):\n+    return render(request, 'debug/render_test.html', {\n+        'foo': 'FOO',\n+        'bar': 'BAR',\n+    }, mimetype='application/x-rendertest')"
        }
    ],
    "stats": {
        "total": 209,
        "additions": 195,
        "deletions": 14
    }
}