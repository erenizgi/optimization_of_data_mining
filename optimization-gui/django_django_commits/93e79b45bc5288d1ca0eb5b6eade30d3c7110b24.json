{
    "author": "slurms",
    "message": "Fixed #17416 -- Added widgets argument to inlineformset_factory and modelformset_factory",
    "sha": "93e79b45bc5288d1ca0eb5b6eade30d3c7110b24",
    "files": [
        {
            "sha": "03a14dc9ff2f17bafdf76ad95e15f22d7fcb0ced",
            "filename": "django/forms/models.py",
            "status": "modified",
            "additions": 7,
            "deletions": 5,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/93e79b45bc5288d1ca0eb5b6eade30d3c7110b24/django%2Fforms%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/93e79b45bc5288d1ca0eb5b6eade30d3c7110b24/django%2Fforms%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fmodels.py?ref=93e79b45bc5288d1ca0eb5b6eade30d3c7110b24",
            "patch": "@@ -682,14 +682,15 @@ def pk_is_not_editable(pk):\n         super(BaseModelFormSet, self).add_fields(form, index)\n \n def modelformset_factory(model, form=ModelForm, formfield_callback=None,\n-                         formset=BaseModelFormSet,\n-                         extra=1, can_delete=False, can_order=False,\n-                         max_num=None, fields=None, exclude=None):\n+                         formset=BaseModelFormSet, extra=1, can_delete=False,\n+                         can_order=False, max_num=None, fields=None,\n+                         exclude=None, widgets=None):\n     \"\"\"\n     Returns a FormSet class for the given Django model class.\n     \"\"\"\n     form = modelform_factory(model, form=form, fields=fields, exclude=exclude,\n-                             formfield_callback=formfield_callback)\n+                             formfield_callback=formfield_callback,\n+                             widgets=widgets)\n     FormSet = formset_factory(form, formset, extra=extra, max_num=max_num,\n                               can_order=can_order, can_delete=can_delete)\n     FormSet.model = model\n@@ -827,7 +828,7 @@ def inlineformset_factory(parent_model, model, form=ModelForm,\n                           formset=BaseInlineFormSet, fk_name=None,\n                           fields=None, exclude=None,\n                           extra=3, can_order=False, can_delete=True, max_num=None,\n-                          formfield_callback=None):\n+                          formfield_callback=None, widgets=None):\n     \"\"\"\n     Returns an ``InlineFormSet`` for the given kwargs.\n \n@@ -848,6 +849,7 @@ def inlineformset_factory(parent_model, model, form=ModelForm,\n         'fields': fields,\n         'exclude': exclude,\n         'max_num': max_num,\n+        'widgets': widgets,\n     }\n     FormSet = modelformset_factory(model, **kwargs)\n     FormSet.fk = fk"
        },
        {
            "sha": "f3382d32c7501eb08ab56ceaf4f61dfad5d08a43",
            "filename": "docs/ref/forms/models.txt",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/93e79b45bc5288d1ca0eb5b6eade30d3c7110b24/docs%2Fref%2Fforms%2Fmodels.txt",
            "raw_url": "https://github.com/django/django/raw/93e79b45bc5288d1ca0eb5b6eade30d3c7110b24/docs%2Fref%2Fforms%2Fmodels.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fforms%2Fmodels.txt?ref=93e79b45bc5288d1ca0eb5b6eade30d3c7110b24",
            "patch": "@@ -25,12 +25,12 @@ Model Form Functions\n \n     See :ref:`modelforms-factory` for example usage.\n \n-.. function:: modelformset_factory(model, form=ModelForm, formfield_callback=None, formset=BaseModelFormSet, extra=1, can_delete=False, can_order=False, max_num=None, fields=None, exclude=None)\n+.. function:: modelformset_factory(model, form=ModelForm, formfield_callback=None, formset=BaseModelFormSet, extra=1, can_delete=False, can_order=False, max_num=None, fields=None, exclude=None, widgets=None)\n \n     Returns a ``FormSet`` class for the given ``model`` class.\n \n-    Arguments ``model``, ``form``, ``fields``, ``exclude``, and\n-    ``formfield_callback`` are all passed through to\n+    Arguments ``model``, ``form``, ``fields``, ``exclude``,\n+    ``formfield_callback`` and ``widgets`` are all passed through to\n     :func:`~django.forms.models.modelform_factory`.\n \n     Arguments ``formset``, ``extra``, ``max_num``, ``can_order``, and\n@@ -39,7 +39,11 @@ Model Form Functions\n \n     See :ref:`model-formsets` for example usage.\n \n-.. function:: inlineformset_factory(parent_model, model, form=ModelForm, formset=BaseInlineFormSet, fk_name=None, fields=None, exclude=None, extra=3, can_order=False, can_delete=True, max_num=None, formfield_callback=None)\n+    .. versionchanged:: 1.6\n+\n+    The widgets parameter was added.\n+\n+.. function:: inlineformset_factory(parent_model, model, form=ModelForm, formset=BaseInlineFormSet, fk_name=None, fields=None, exclude=None, extra=3, can_order=False, can_delete=True, max_num=None, formfield_callback=None, widgets=None)\n \n     Returns an ``InlineFormSet`` using :func:`modelformset_factory` with\n     defaults of ``formset=BaseInlineFormSet``, ``can_delete=True``, and\n@@ -49,3 +53,7 @@ Model Form Functions\n     the ``parent_model``, you must specify a ``fk_name``.\n \n     See :ref:`inline-formsets` for example usage.\n+\n+    .. versionchanged:: 1.6\n+\n+    The widgets parameter was added."
        },
        {
            "sha": "d9e00d86cfbf24bb77a3b5e037619fe313e07c1f",
            "filename": "docs/topics/forms/modelforms.txt",
            "status": "modified",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/django/django/blob/93e79b45bc5288d1ca0eb5b6eade30d3c7110b24/docs%2Ftopics%2Fforms%2Fmodelforms.txt",
            "raw_url": "https://github.com/django/django/raw/93e79b45bc5288d1ca0eb5b6eade30d3c7110b24/docs%2Ftopics%2Fforms%2Fmodelforms.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fforms%2Fmodelforms.txt?ref=93e79b45bc5288d1ca0eb5b6eade30d3c7110b24",
            "patch": "@@ -650,6 +650,19 @@ exclude::\n \n     >>> AuthorFormSet = modelformset_factory(Author, exclude=('birth_date',))\n \n+Specifying widgets to use in the form with ``widgets``\n+------------------------------------------------------\n+\n+.. versionadded:: 1.6\n+\n+Using the ``widgets`` parameter, you can specify a dictionary of values to\n+customize the ``ModelForm``'s widget class for a particular field. This\n+works the same way as the ``widgets`` dictionary on the inner ``Meta``\n+class of a ``ModelForm`` works::\n+\n+    >>> AuthorFormSet = modelformset_factory(\n+    ...     Author, widgets={'name': Textarea(attrs={'cols': 80, 'rows': 20})\n+\n Providing initial values\n ------------------------\n \n@@ -930,3 +943,13 @@ of a model. Here's how you can do that::\n         })\n \n Notice how we pass ``instance`` in both the ``POST`` and ``GET`` cases.\n+\n+Specifying widgets to use in the inline form\n+--------------------------------------------\n+\n+.. versionadded:: 1.6\n+\n+``inlineformset_factory`` uses ``modelformset_factory`` and passes most\n+of its arguments to ``modelformset_factory``. This means you can use\n+the ``widgets`` parameter in much the same way as passing it to\n+``modelformset_factory``. See `Specifying widgets to use in the form with widgets`_ above."
        },
        {
            "sha": "a028e65143748b58ff1dfaab6dde42a8bbdfa2fd",
            "filename": "tests/modeltests/model_formsets/tests.py",
            "status": "modified",
            "additions": 24,
            "deletions": 0,
            "changes": 24,
            "blob_url": "https://github.com/django/django/blob/93e79b45bc5288d1ca0eb5b6eade30d3c7110b24/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/93e79b45bc5288d1ca0eb5b6eade30d3c7110b24/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py?ref=93e79b45bc5288d1ca0eb5b6eade30d3c7110b24",
            "patch": "@@ -1190,3 +1190,27 @@ def test_prevent_duplicates_from_with_the_same_formset(self):\n         self.assertFalse(formset.is_valid())\n         self.assertEqual(formset._non_form_errors,\n             ['Please correct the duplicate data for subtitle which must be unique for the month in posted.'])\n+\n+\n+class TestModelFormsetWidgets(TestCase):\n+    def test_modelformset_factory_widgets(self):\n+        widgets = {\n+            'name': forms.TextInput(attrs={'class': 'poet'})\n+        }\n+        PoetFormSet = modelformset_factory(Poet, widgets=widgets)\n+        form = PoetFormSet.form()\n+        self.assertHTMLEqual(\n+            \"%s\" % form['name'],\n+            '<input id=\"id_name\" maxlength=\"100\" type=\"text\" class=\"poet\" name=\"name\" />'\n+        )\n+\n+    def test_inlineformset_factory_widgets(self):\n+        widgets = {\n+            'title': forms.TextInput(attrs={'class': 'book'})\n+        }\n+        BookFormSet = inlineformset_factory(Author, Book, widgets=widgets)\n+        form = BookFormSet.form()\n+        self.assertHTMLEqual(\n+            \"%s\" % form['title'],\n+            '<input class=\"book\" id=\"id_title\" maxlength=\"100\" name=\"title\" type=\"text\" />'\n+        )"
        }
    ],
    "stats": {
        "total": 75,
        "additions": 66,
        "deletions": 9
    }
}