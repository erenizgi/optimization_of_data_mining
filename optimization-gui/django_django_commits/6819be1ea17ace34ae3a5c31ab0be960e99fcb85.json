{
    "author": "alex",
    "message": "Fix a security issue in the auth system. Disclosure and new release forthcoming.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15032 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "6819be1ea17ace34ae3a5c31ab0be960e99fcb85",
    "files": [
        {
            "sha": "20b2ecbbc715a1ec863b8abafb928a24b16a15f2",
            "filename": "django/contrib/auth/tests/tokens.py",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/6819be1ea17ace34ae3a5c31ab0be960e99fcb85/django%2Fcontrib%2Fauth%2Ftests%2Ftokens.py",
            "raw_url": "https://github.com/django/django/raw/6819be1ea17ace34ae3a5c31ab0be960e99fcb85/django%2Fcontrib%2Fauth%2Ftests%2Ftokens.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Ftokens.py?ref=6819be1ea17ace34ae3a5c31ab0be960e99fcb85",
            "patch": "@@ -72,3 +72,14 @@ def _make_token(user):\n         p0 = PasswordResetTokenGenerator()\n         tk1 = _make_token(user)\n         self.assertTrue(p0.check_token(user, tk1))\n+\n+    def test_date_length(self):\n+        \"\"\"\n+        Make sure we don't allow overly long dates, causing a potential DoS.\n+        \"\"\"\n+        user = User.objects.create_user('ima1337h4x0r', 'test4@example.com', 'p4ssw0rd')\n+        p0 = PasswordResetTokenGenerator()\n+\n+        # This will put a 14-digit base36 timestamp into the token, which is too large.\n+        tk1 = p0._make_token_with_timestamp(user, 175455491841851871349)\n+        self.assertFalse(p0.check_token(user, tk1))"
        },
        {
            "sha": "42b4e8f212bd82caab0fe54dbfc2ff0049a9bdc9",
            "filename": "django/contrib/auth/urls.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/6819be1ea17ace34ae3a5c31ab0be960e99fcb85/django%2Fcontrib%2Fauth%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/6819be1ea17ace34ae3a5c31ab0be960e99fcb85/django%2Fcontrib%2Fauth%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Furls.py?ref=6819be1ea17ace34ae3a5c31ab0be960e99fcb85",
            "patch": "@@ -1,4 +1,4 @@\n-# These URLs are normally mapped to /admin/urls.py. This URLs file is \n+# These URLs are normally mapped to /admin/urls.py. This URLs file is\n # provided as a convenience to those who want to deploy these URLs elsewhere.\n # This file is also used to provide a reliable view deployment for test purposes.\n \n@@ -11,7 +11,7 @@\n     (r'^password_change/done/$', 'django.contrib.auth.views.password_change_done'),\n     (r'^password_reset/$', 'django.contrib.auth.views.password_reset'),\n     (r'^password_reset/done/$', 'django.contrib.auth.views.password_reset_done'),\n-    (r'^reset/(?P<uidb36>[0-9A-Za-z]+)-(?P<token>.+)/$', 'django.contrib.auth.views.password_reset_confirm'),\n+    (r'^reset/(?P<uidb36>[0-9A-Za-z]{1,13})-(?P<token>[0-9A-Za-z]{1,13}-[0-9A-Za-z]{1,20})/$', 'django.contrib.auth.views.password_reset_confirm'),\n     (r'^reset/done/$', 'django.contrib.auth.views.password_reset_complete'),\n )\n "
        },
        {
            "sha": "e18d8dd29c5cb80ac0b67fb3b1aaac886abfcc54",
            "filename": "django/utils/http.py",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/6819be1ea17ace34ae3a5c31ab0be960e99fcb85/django%2Futils%2Fhttp.py",
            "raw_url": "https://github.com/django/django/raw/6819be1ea17ace34ae3a5c31ab0be960e99fcb85/django%2Futils%2Fhttp.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fhttp.py?ref=6819be1ea17ace34ae3a5c31ab0be960e99fcb85",
            "patch": "@@ -73,8 +73,13 @@ def http_date(epoch_seconds=None):\n \n def base36_to_int(s):\n     \"\"\"\n-    Convertd a base 36 string to an integer\n+    Converts a base 36 string to an ``int``. To prevent\n+    overconsumption of server resources, raises ``ValueError` if the\n+    input is longer than 13 base36 digits (13 digits is sufficient to\n+    base36-encode any 64-bit integer).\n     \"\"\"\n+    if len(s) > 13:\n+        raise ValueError(\"Base36 input too large\")\n     return int(s, 36)\n \n def int_to_base36(i):"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 19,
        "deletions": 3
    }
}