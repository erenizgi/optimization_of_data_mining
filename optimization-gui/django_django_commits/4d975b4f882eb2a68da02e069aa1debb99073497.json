{
    "author": "PaulMcMillan",
    "message": "Fixed #16847. Session Cookies now default to httponly = True.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17135 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "4d975b4f882eb2a68da02e069aa1debb99073497",
    "files": [
        {
            "sha": "0aee63dbc383f916cb2d14c17c9edb9d0783a9de",
            "filename": "django/conf/global_settings.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/4d975b4f882eb2a68da02e069aa1debb99073497/django%2Fconf%2Fglobal_settings.py",
            "raw_url": "https://github.com/django/django/raw/4d975b4f882eb2a68da02e069aa1debb99073497/django%2Fconf%2Fglobal_settings.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fconf%2Fglobal_settings.py?ref=4d975b4f882eb2a68da02e069aa1debb99073497",
            "patch": "@@ -445,7 +445,7 @@\n SESSION_COOKIE_DOMAIN = None                            # A string like \".lawrence.com\", or None for standard domain cookie.\n SESSION_COOKIE_SECURE = False                           # Whether the session cookie should be secure (https:// only).\n SESSION_COOKIE_PATH = '/'                               # The path of the session cookie.\n-SESSION_COOKIE_HTTPONLY = False                         # Whether to use the non-RFC standard httpOnly flag (IE, FF3+, others)\n+SESSION_COOKIE_HTTPONLY = True                          # Whether to use the non-RFC standard httpOnly flag (IE, FF3+, others)\n SESSION_SAVE_EVERY_REQUEST = False                      # Whether to save the session data on every request.\n SESSION_EXPIRE_AT_BROWSER_CLOSE = False                 # Whether a user's session cookie expires when the Web browser is closed.\n SESSION_ENGINE = 'django.contrib.sessions.backends.db'  # The module to store session data"
        },
        {
            "sha": "58d052d67b4d84b1ec8d9cb6f36b5a6c4c52b5d1",
            "filename": "django/contrib/sessions/tests.py",
            "status": "modified",
            "additions": 23,
            "deletions": 2,
            "changes": 25,
            "blob_url": "https://github.com/django/django/blob/4d975b4f882eb2a68da02e069aa1debb99073497/django%2Fcontrib%2Fsessions%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/4d975b4f882eb2a68da02e069aa1debb99073497/django%2Fcontrib%2Fsessions%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Ftests.py?ref=4d975b4f882eb2a68da02e069aa1debb99073497",
            "patch": "@@ -343,7 +343,8 @@ def test_secure_session_cookie(self):\n \n         # Handle the response through the middleware\n         response = middleware.process_response(request, response)\n-        self.assertTrue(response.cookies[settings.SESSION_COOKIE_NAME]['secure'])\n+        self.assertTrue(\n+            response.cookies[settings.SESSION_COOKIE_NAME]['secure'])\n \n     @override_settings(SESSION_COOKIE_HTTPONLY=True)\n     def test_httponly_session_cookie(self):\n@@ -357,7 +358,27 @@ def test_httponly_session_cookie(self):\n \n         # Handle the response through the middleware\n         response = middleware.process_response(request, response)\n-        self.assertTrue(response.cookies[settings.SESSION_COOKIE_NAME]['httponly'])\n+        self.assertTrue(\n+            response.cookies[settings.SESSION_COOKIE_NAME]['httponly'])\n+        self.assertIn('httponly', \n+            str(response.cookies[settings.SESSION_COOKIE_NAME]))\n+\n+    @override_settings(SESSION_COOKIE_HTTPONLY=False)\n+    def test_no_httponly_session_cookie(self):\n+        request = RequestFactory().get('/')\n+        response = HttpResponse('Session test')\n+        middleware = SessionMiddleware()\n+\n+        # Simulate a request the modifies the session\n+        middleware.process_request(request)\n+        request.session['hello'] = 'world'\n+\n+        # Handle the response through the middleware\n+        response = middleware.process_response(request, response)\n+        self.assertFalse(\n+            response.cookies[settings.SESSION_COOKIE_NAME]['httponly'])\n+        self.assertNotIn('httponly', \n+            str(response.cookies[settings.SESSION_COOKIE_NAME]['httponly']))\n \n \n class CookieSessionTests(SessionTestsMixin, TestCase):"
        },
        {
            "sha": "228b69ebe25a67f27a3efc5175091710dd27ed70",
            "filename": "docs/ref/request-response.txt",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/4d975b4f882eb2a68da02e069aa1debb99073497/docs%2Fref%2Frequest-response.txt",
            "raw_url": "https://github.com/django/django/raw/4d975b4f882eb2a68da02e069aa1debb99073497/docs%2Fref%2Frequest-response.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Frequest-response.txt?ref=4d975b4f882eb2a68da02e069aa1debb99073497",
            "patch": "@@ -638,14 +638,18 @@ Methods\n     Returns ``True`` or ``False`` based on a case-insensitive check for a\n     header with the given name.\n \n-.. method:: HttpResponse.set_cookie(key, value='', max_age=None, expires=None, path='/', domain=None, secure=None, httponly=False)\n+.. method:: HttpResponse.set_cookie(key, value='', max_age=None, expires=None, path='/', domain=None, secure=None, httponly=True)\n \n     .. versionchanged:: 1.3\n \n     The possibility of specifying a ``datetime.datetime`` object in\n     ``expires``, and the auto-calculation of ``max_age`` in such case\n     was added. The ``httponly`` argument was also added.\n \n+    .. versionchanged:: 1.4\n+\n+    The default value for httponly was changed from ``False`` to ``True``.\n+\n     Sets a cookie. The parameters are the same as in the :class:`Cookie.Morsel`\n     object in the Python standard library.\n \n@@ -673,7 +677,7 @@ Methods\n \n     .. _HTTPOnly: http://www.owasp.org/index.php/HTTPOnly\n \n-.. method:: HttpResponse.set_signed_cookie(key, value='', salt='', max_age=None, expires=None, path='/', domain=None, secure=None, httponly=False)\n+.. method:: HttpResponse.set_signed_cookie(key, value='', salt='', max_age=None, expires=None, path='/', domain=None, secure=None, httponly=True)\n \n     .. versionadded:: 1.4\n "
        },
        {
            "sha": "b611626099f7b1e2d88d23c66fa05748a35e1e68",
            "filename": "docs/releases/1.4.txt",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/4d975b4f882eb2a68da02e069aa1debb99073497/docs%2Freleases%2F1.4.txt",
            "raw_url": "https://github.com/django/django/raw/4d975b4f882eb2a68da02e069aa1debb99073497/docs%2Freleases%2F1.4.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.4.txt?ref=4d975b4f882eb2a68da02e069aa1debb99073497",
            "patch": "@@ -451,10 +451,10 @@ Minor features\n \n Django 1.4 also includes several smaller improvements worth noting:\n \n-* A more usable stacktrace in the technical 500 page: frames in the stack\n-  trace which reference Django's code are dimmed out, while frames in user\n-  code are slightly emphasized. This change makes it easier to scan a stacktrace\n-  for issues in user code.\n+* A more usable stacktrace in the technical 500 page: frames in the\n+  stack trace which reference Django's code are dimmed out, while\n+  frames in user code are slightly emphasized. This change makes it\n+  easier to scan a stacktrace for issues in user code.\n \n * :doc:`Tablespace support </topics/db/tablespaces>` in PostgreSQL.\n \n@@ -498,6 +498,9 @@ Django 1.4 also includes several smaller improvements worth noting:\n * Added the :djadminopt:`--no-location` option to the :djadmin:`makemessages`\n   command.\n \n+* Changed the default value for ``httponly`` on session cookies to\n+  ``True`` to help reduce the impact of potential XSS attacks.\n+\n .. _backwards-incompatible-changes-1.4:\n \n Backwards incompatible changes in 1.4"
        },
        {
            "sha": "dcd4ea2c74fe16232bce79d8a6f9a967ec0640d2",
            "filename": "docs/topics/http/sessions.txt",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/4d975b4f882eb2a68da02e069aa1debb99073497/docs%2Ftopics%2Fhttp%2Fsessions.txt",
            "raw_url": "https://github.com/django/django/raw/4d975b4f882eb2a68da02e069aa1debb99073497/docs%2Ftopics%2Fhttp%2Fsessions.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fhttp%2Fsessions.txt?ref=4d975b4f882eb2a68da02e069aa1debb99073497",
            "patch": "@@ -110,8 +110,8 @@ and the :setting:`SECRET_KEY` setting.\n \n .. note::\n \n-    It's recommended to set the :setting:`SESSION_COOKIE_HTTPONLY` setting\n-    to ``True`` to prevent tampering of the stored data from JavaScript.\n+    It's recommended to leave the :setting:`SESSION_COOKIE_HTTPONLY` setting\n+    ``True`` to prevent tampering of the stored data from JavaScript.\n \n .. warning::\n \n@@ -504,7 +504,7 @@ The domain to use for session cookies. Set this to a string such as\n SESSION_COOKIE_HTTPONLY\n -----------------------\n \n-Default: ``False``\n+Default: ``True``\n \n Whether to use HTTPOnly flag on the session cookie. If this is set to\n ``True``, client-side JavaScript will not to be able to access the"
        }
    ],
    "stats": {
        "total": 52,
        "additions": 40,
        "deletions": 12
    }
}