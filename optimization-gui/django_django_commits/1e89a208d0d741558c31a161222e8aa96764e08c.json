{
    "author": "aaugustin",
    "message": "Fixed #18645 -- Clarified filesizeformat implementation\n\nThanks Jérôme Renard for the patch.",
    "sha": "1e89a208d0d741558c31a161222e8aa96764e08c",
    "files": [
        {
            "sha": "b9cdd942966208a50419d20f84897e15d4cc78f5",
            "filename": "django/template/defaultfilters.py",
            "status": "modified",
            "additions": 16,
            "deletions": 10,
            "changes": 26,
            "blob_url": "https://github.com/django/django/blob/1e89a208d0d741558c31a161222e8aa96764e08c/django%2Ftemplate%2Fdefaultfilters.py",
            "raw_url": "https://github.com/django/django/raw/1e89a208d0d741558c31a161222e8aa96764e08c/django%2Ftemplate%2Fdefaultfilters.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fdefaultfilters.py?ref=1e89a208d0d741558c31a161222e8aa96764e08c",
            "patch": "@@ -827,17 +827,23 @@ def filesizeformat(bytes):\n \n     filesize_number_format = lambda value: formats.number_format(round(value, 1), 1)\n \n-    if bytes < 1024:\n+    KB = 1<<10\n+    MB = 1<<20\n+    GB = 1<<30\n+    TB = 1<<40\n+    PB = 1<<50\n+\n+    if bytes < KB:\n         return ungettext(\"%(size)d byte\", \"%(size)d bytes\", bytes) % {'size': bytes}\n-    if bytes < 1024 * 1024:\n-        return ugettext(\"%s KB\") % filesize_number_format(bytes / 1024)\n-    if bytes < 1024 * 1024 * 1024:\n-        return ugettext(\"%s MB\") % filesize_number_format(bytes / (1024 * 1024))\n-    if bytes < 1024 * 1024 * 1024 * 1024:\n-        return ugettext(\"%s GB\") % filesize_number_format(bytes / (1024 * 1024 * 1024))\n-    if bytes < 1024 * 1024 * 1024 * 1024 * 1024:\n-        return ugettext(\"%s TB\") % filesize_number_format(bytes / (1024 * 1024 * 1024 * 1024))\n-    return ugettext(\"%s PB\") % filesize_number_format(bytes / (1024 * 1024 * 1024 * 1024 * 1024))\n+    if bytes < MB:\n+        return ugettext(\"%s KB\") % filesize_number_format(bytes / KB)\n+    if bytes < GB:\n+        return ugettext(\"%s MB\") % filesize_number_format(bytes / MB)\n+    if bytes < TB:\n+        return ugettext(\"%s GB\") % filesize_number_format(bytes / GB)\n+    if bytes < PB:\n+        return ugettext(\"%s TB\") % filesize_number_format(bytes / TB)\n+    return ugettext(\"%s PB\") % filesize_number_format(bytes / PB)\n \n @register.filter(is_safe=False)\n def pluralize(value, arg='s'):"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 16,
        "deletions": 10
    }
}