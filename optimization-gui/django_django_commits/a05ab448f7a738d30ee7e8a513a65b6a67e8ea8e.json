{
    "author": "honzakral",
    "message": "Merge pull request #781 from zsiciarz/ticket_19854\n\nFixed #19854 -- Added test runner option to skip Selenium tests",
    "sha": "a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e",
    "files": [
        {
            "sha": "30d63e44869403845ce475aad0cfb36bf872ab5e",
            "filename": "django/contrib/admin/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e/django%2Fcontrib%2Fadmin%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e/django%2Fcontrib%2Fadmin%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftests.py?ref=a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e",
            "patch": "@@ -1,3 +1,5 @@\n+import os\n+\n from django.test import LiveServerTestCase\n from django.utils.module_loading import import_by_path\n from django.utils.unittest import SkipTest\n@@ -8,6 +10,8 @@ class AdminSeleniumWebDriverTestCase(LiveServerTestCase):\n \n     @classmethod\n     def setUpClass(cls):\n+        if os.environ.get('DJANGO_SKIP_SELENIUM_TESTS', False):\n+            raise SkipTest('Selenium tests skipped by explicit request')\n         try:\n             cls.selenium = import_by_path(cls.webdriver_class)()\n         except Exception as e:"
        },
        {
            "sha": "59f4c97c92f092ef3cabc4044f49933f7f682c78",
            "filename": "docs/internals/contributing/writing-code/unit-tests.txt",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e/docs%2Finternals%2Fcontributing%2Fwriting-code%2Funit-tests.txt",
            "raw_url": "https://github.com/django/django/raw/a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e/docs%2Finternals%2Fcontributing%2Fwriting-code%2Funit-tests.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Finternals%2Fcontributing%2Fwriting-code%2Funit-tests.txt?ref=a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e",
            "patch": "@@ -136,6 +136,15 @@ Then, run the tests normally, for example:\n \n     ./runtests.py --settings=test_sqlite admin_inlines\n \n+If you have Selenium installed but for some reason don't want to run these tests\n+(for example to speed up the test suite), use the ``--skip-selenium`` option\n+of the test runner.\n+\n+.. code-block:: bash\n+\n+    ./runtests.py --settings=test_sqlite --skip-selenium admin_inlines\n+\n+\n .. _running-unit-tests-dependencies:\n \n Running all the tests"
        },
        {
            "sha": "206cf3d256fffe2dfceecf6d15632ea206d95d5c",
            "filename": "tests/regressiontests/views/tests/i18n.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e/tests%2Fregressiontests%2Fviews%2Ftests%2Fi18n.py",
            "raw_url": "https://github.com/django/django/raw/a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e/tests%2Fregressiontests%2Fviews%2Ftests%2Fi18n.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2Fi18n.py?ref=a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e",
            "patch": "@@ -2,6 +2,7 @@\n from __future__ import absolute_import\n \n import gettext\n+import os\n from os import path\n \n from django.conf import settings\n@@ -176,6 +177,10 @@ def testI18NWithLocalePaths(self):\n                     javascript_quote('este texto de app3 debe ser traducido'))\n \n \n+skip_selenium = os.environ.get('DJANGO_SKIP_SELENIUM_TESTS', False)\n+\n+\n+@unittest.skipIf(skip_selenium, 'Selenium tests skipped by explicit request')\n @unittest.skipUnless(firefox, 'Selenium not installed')\n class JavascriptI18nTests(LiveServerTestCase):\n     urls = 'regressiontests.views.urls'"
        },
        {
            "sha": "b9de137ea293fd36f52bd429a6a322b866d29bdb",
            "filename": "tests/runtests.py",
            "status": "modified",
            "additions": 9,
            "deletions": 1,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e/tests%2Fruntests.py",
            "raw_url": "https://github.com/django/django/raw/a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e/tests%2Fruntests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fruntests.py?ref=a05ab448f7a738d30ee7e8a513a65b6a67e8ea8e",
            "patch": "@@ -301,7 +301,12 @@ def paired_tests(paired_test, options, test_labels):\n         '--liveserver', action='store', dest='liveserver', default=None,\n         help='Overrides the default address where the live server (used with '\n              'LiveServerTestCase) is expected to run from. The default value '\n-             'is localhost:8081.'),\n+             'is localhost:8081.')\n+    parser.add_option(\n+        '--skip-selenium', action='store_true', dest='skip_selenium',\n+        default=False,\n+        help='Skip running Selenium tests even it Selenium itself is '\n+             'installed. By default these tests are not skipped.')\n     options, args = parser.parse_args()\n     if options.settings:\n         os.environ['DJANGO_SETTINGS_MODULE'] = options.settings\n@@ -314,6 +319,9 @@ def paired_tests(paired_test, options, test_labels):\n     if options.liveserver is not None:\n         os.environ['DJANGO_LIVE_TEST_SERVER_ADDRESS'] = options.liveserver\n \n+    if options.skip_selenium:\n+        os.environ['DJANGO_SKIP_SELENIUM_TESTS'] = '1'\n+\n     if options.bisect:\n         bisect_tests(options.bisect, options, args)\n     elif options.pair:"
        }
    ],
    "stats": {
        "total": 28,
        "additions": 27,
        "deletions": 1
    }
}