{
    "author": "jphalip",
    "message": "Fixed #6170 -- Ensured that a useful exception is raised when a regex is invalid in the URLConf.\nThanks to abrahamson.j for the report, to guettli for initial work on the patch, and to David Gouldin for the new patch and test.",
    "sha": "1af0271d7c6f5ecda2247a2b363d25f493c7b05a",
    "files": [
        {
            "sha": "58213a3a7307eb4702904ba7720ca094865c6448",
            "filename": "django/core/urlresolvers.py",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/1af0271d7c6f5ecda2247a2b363d25f493c7b05a/django%2Fcore%2Furlresolvers.py",
            "raw_url": "https://github.com/django/django/raw/1af0271d7c6f5ecda2247a2b363d25f493c7b05a/django%2Fcore%2Furlresolvers.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Furlresolvers.py?ref=1af0271d7c6f5ecda2247a2b363d25f493c7b05a",
            "patch": "@@ -160,10 +160,16 @@ def regex(self):\n         language_code = get_language()\n         if language_code not in self._regex_dict:\n             if isinstance(self._regex, basestring):\n-                compiled_regex = re.compile(self._regex, re.UNICODE)\n+                regex = self._regex\n             else:\n                 regex = force_unicode(self._regex)\n+            try:\n                 compiled_regex = re.compile(regex, re.UNICODE)\n+            except re.error, e:\n+                raise ImproperlyConfigured(\n+                    u'\"%s\" is not a valid regular expression: %s' %\n+                    (regex, unicode(e)))\n+\n             self._regex_dict[language_code] = compiled_regex\n         return self._regex_dict[language_code]\n "
        },
        {
            "sha": "d1e4f3db5d2ccfdad2428a5eca9c7fe2d1b35f9b",
            "filename": "tests/regressiontests/urlpatterns_reverse/erroneous_urls.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/1af0271d7c6f5ecda2247a2b363d25f493c7b05a/tests%2Fregressiontests%2Furlpatterns_reverse%2Ferroneous_urls.py",
            "raw_url": "https://github.com/django/django/raw/1af0271d7c6f5ecda2247a2b363d25f493c7b05a/tests%2Fregressiontests%2Furlpatterns_reverse%2Ferroneous_urls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Furlpatterns_reverse%2Ferroneous_urls.py?ref=1af0271d7c6f5ecda2247a2b363d25f493c7b05a",
            "patch": "@@ -11,4 +11,6 @@\n     url(r'uncallable/$', 'regressiontests.urlpatterns_reverse.views.uncallable'),\n     # Module does not exist\n     url(r'missing_outer/$', 'regressiontests.urlpatterns_reverse.missing_module.missing_view'),\n+    # Regex contains an error (refs #6170)\n+    url(r'(regex_error/$', 'regressiontestes.urlpatterns_reverse.views.empty_view'),\n )"
        },
        {
            "sha": "500a0e0327002aa4a84e3f7ac038dc009e4b510c",
            "filename": "tests/regressiontests/urlpatterns_reverse/tests.py",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/1af0271d7c6f5ecda2247a2b363d25f493c7b05a/tests%2Fregressiontests%2Furlpatterns_reverse%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/1af0271d7c6f5ecda2247a2b363d25f493c7b05a/tests%2Fregressiontests%2Furlpatterns_reverse%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Furlpatterns_reverse%2Ftests.py?ref=1af0271d7c6f5ecda2247a2b363d25f493c7b05a",
            "patch": "@@ -511,3 +511,11 @@ def test_erroneous_resolve(self):\n         self.assertRaises(ViewDoesNotExist, self.client.get, '/missing_outer/')\n         self.assertRaises(ViewDoesNotExist, self.client.get, '/uncallable/')\n \n+    def test_erroneous_reverse(self):\n+        \"\"\"\n+        Ensure that a useful exception is raised when a regex is invalid in the\n+        URLConf.\n+        Refs #6170.\n+        \"\"\"\n+        # The regex error will be hit before NoReverseMatch can be raised\n+        self.assertRaises(ImproperlyConfigured, reverse, 'whatever blah blah')"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 17,
        "deletions": 1
    }
}