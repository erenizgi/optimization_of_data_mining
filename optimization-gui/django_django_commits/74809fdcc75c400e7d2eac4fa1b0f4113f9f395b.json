{
    "author": "tominsam",
    "message": "cope with unsplittable urls in smarl_urlquote.",
    "sha": "74809fdcc75c400e7d2eac4fa1b0f4113f9f395b",
    "files": [
        {
            "sha": "25605bea0448a5a07c129f26563016b8c11d8094",
            "filename": "django/utils/html.py",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/74809fdcc75c400e7d2eac4fa1b0f4113f9f395b/django%2Futils%2Fhtml.py",
            "raw_url": "https://github.com/django/django/raw/74809fdcc75c400e7d2eac4fa1b0f4113f9f395b/django%2Futils%2Fhtml.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fhtml.py?ref=74809fdcc75c400e7d2eac4fa1b0f4113f9f395b",
            "patch": "@@ -150,13 +150,17 @@ def fix_ampersands(value):\n def smart_urlquote(url):\n     \"Quotes a URL if it isn't already quoted.\"\n     # Handle IDN before quoting.\n-    scheme, netloc, path, query, fragment = urlsplit(url)\n     try:\n-        netloc = netloc.encode('idna').decode('ascii') # IDN -> ACE\n-    except UnicodeError: # invalid domain part\n+        scheme, netloc, path, query, fragment = urlsplit(url)\n+        try:\n+            netloc = netloc.encode('idna').decode('ascii') # IDN -> ACE\n+        except UnicodeError: # invalid domain part\n+            pass\n+        else:\n+            url = urlunsplit((scheme, netloc, path, query, fragment))\n+    except ValueError:\n+        # invalid IPv6 URL (normally square brackets in hostname part).\n         pass\n-    else:\n-        url = urlunsplit((scheme, netloc, path, query, fragment))\n \n     # An URL is considered unquoted if it contains no % characters or\n     # contains a % not followed by two hexadecimal digits. See #9655."
        }
    ],
    "stats": {
        "total": 14,
        "additions": 9,
        "deletions": 5
    }
}