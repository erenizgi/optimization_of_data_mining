{
    "author": "andrewgodwin",
    "message": "Fixed #12295 -- Issue had already been fixed, but added test. Thanks tomevans222 and dpn.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15158 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "d216ff9b922aa246be5d199401494946f4a37ff7",
    "files": [
        {
            "sha": "cbff56f55eb530ddcde127ed25c116f8b9806d74",
            "filename": "tests/regressiontests/forms/tests/formsets.py",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/d216ff9b922aa246be5d199401494946f4a37ff7/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py",
            "raw_url": "https://github.com/django/django/raw/d216ff9b922aa246be5d199401494946f4a37ff7/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py?ref=d216ff9b922aa246be5d199401494946f4a37ff7",
            "patch": "@@ -29,6 +29,11 @@ def clean(self):\n             seen_drinks.append(drink['name'])\n \n \n+class EmptyFsetWontValidate(BaseFormSet):\n+    def clean(self):\n+        raise ValidationError(\"Clean method called\")\n+\n+\n # Let's define a FormSet that takes a list of favorite drinks, but raises an\n # error if there are any duplicates. Used in ``test_clean_hook``,\n # ``test_regression_6926`` & ``test_regression_12878``.\n@@ -872,3 +877,13 @@ def test_form_errors_are_cought_by_formset(self):\n         formset = ArticleFormSet(data)\n         self.assertFalse(formset.is_valid())\n         self.assertEquals([{}, {'pub_date': [u'This field is required.']}], formset.errors)\n+\n+class TestEmptyFormSet(TestCase): \n+    \"Test that an empty formset still calls clean()\"\n+    def test_empty_formset_is_valid(self): \n+        EmptyFsetWontValidateFormset = formset_factory(FavoriteDrinkForm, extra=0, formset=EmptyFsetWontValidate) \n+        formset = EmptyFsetWontValidateFormset(data={'form-INITIAL_FORMS':'0', 'form-TOTAL_FORMS':'0'},prefix=\"form\") \n+        formset2 = EmptyFsetWontValidateFormset(data={'form-INITIAL_FORMS':'0', 'form-TOTAL_FORMS':'1', 'form-0-name':'bah' },prefix=\"form\") \n+        self.assertFalse(formset.is_valid()) \n+        self.assertFalse(formset2.is_valid()) \n+"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 15,
        "deletions": 0
    }
}