{
    "author": "jbronn",
    "message": "Fixed #14133 -- Updated Windows installation instructions for GeoDjango, now recommend the OSGeo4W installer for spatial libraries.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15872 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "c70bdad8b476b457e217c3c444579a8b4b853cc8",
    "files": [
        {
            "sha": "b3e6cc6822ac78d2c51f1a7e4f83b638bd9f9ec5",
            "filename": "docs/ref/contrib/gis/geodjango_setup.bat",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/c70bdad8b476b457e217c3c444579a8b4b853cc8/docs%2Fref%2Fcontrib%2Fgis%2Fgeodjango_setup.bat",
            "raw_url": "https://github.com/django/django/raw/c70bdad8b476b457e217c3c444579a8b4b853cc8/docs%2Fref%2Fcontrib%2Fgis%2Fgeodjango_setup.bat",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fgis%2Fgeodjango_setup.bat?ref=c70bdad8b476b457e217c3c444579a8b4b853cc8",
            "patch": "@@ -0,0 +1,8 @@\n+set OSGEO4W_ROOT=C:\\OSGeo4W\n+set PYTHON_ROOT=C:\\Python27\n+set GDAL_DATA=%OSGEO4W_ROOT%\\share\\gdal\n+set PROJ_LIB=%OSGEO4W_ROOT%\\share\\proj\n+set PATH=%PATH%;%PYTHON_ROOT%;%OSGEO4W_ROOT%\\bin\n+reg ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\" /v Path /t REG_EXPAND_SZ /f /d \"%PATH%\"\n+reg ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\" /v GDAL_DATA /t REG_EXPAND_SZ /f /d \"%GDAL_DATA%\"\n+reg ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\" /v PROJ_LIB /t REG_EXPAND_SZ /f /d \"%PROJ_LIB%\""
        },
        {
            "sha": "8b785b874174f3c7e95eb7eeeeeff899fd7aa9d1",
            "filename": "docs/ref/contrib/gis/install.txt",
            "status": "modified",
            "additions": 110,
            "deletions": 54,
            "changes": 164,
            "blob_url": "https://github.com/django/django/blob/c70bdad8b476b457e217c3c444579a8b4b853cc8/docs%2Fref%2Fcontrib%2Fgis%2Finstall.txt",
            "raw_url": "https://github.com/django/django/raw/c70bdad8b476b457e217c3c444579a8b4b853cc8/docs%2Fref%2Fcontrib%2Fgis%2Finstall.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fgis%2Finstall.txt?ref=c70bdad8b476b457e217c3c444579a8b4b853cc8",
            "patch": "@@ -1093,101 +1093,159 @@ Debian 5.0 . Thus when :ref:`spatialdb_template` either:\n \n .. _windows:\n \n-Windows XP\n-----------\n+Windows\n+-------\n+\n+Proceed through the following sections sequentially in order to install\n+GeoDjango on Windows.\n+\n+.. note::\n+\n+    These instructions assume that you are using 32-bit versions of\n+    all programs.  While 64-bit versions of Python and PostgreSQL 9.0\n+    are available, 64-bit versions of spatial libraries, like\n+    GEOS and GDAL, are not yet provided by the :ref:`OSGeo4W` installer.\n \n Python\n ^^^^^^\n \n-First, download the `Python 2.6 installer`__ from the Python Web site.  Next,\n-execute the installer and use defaults, e.g., keep 'Install for all users'\n-checked and the installation path set as ``C:\\Python26``.\n+First, download the latest `Python 2.7 installer`__ from the Python Web site.\n+Next, run the installer and keep the defaults -- for example, keep \n+'Install for all users' checked and the installation path set as\n+``C:\\Python27``.\n \n .. note::\n \n     You may already have a version of Python installed in ``C:\\python`` as ESRI\n     products sometimes install a copy there.  *You should still install a\n-    fresh version of Python 2.6.*\n+    fresh version of Python 2.7.*\n \n-__ http://python.org/ftp/python/2.6.2/python-2.6.2.msi\n+__ http://python.org/download/\n \n PostgreSQL\n ^^^^^^^^^^\n \n-First, select a mirror and download the latest `PostgreSQL 8.3 installer`__ from\n-the EnterpriseDB Web site.\n+First, download the latest `PostgreSQL 9.0 installer`__ from the\n+`EnterpriseDB`__ Web site.  After downloading, simply run the installer,\n+follow the on-screen directions, and keep the default options unless\n+you know the consequences of changing them.\n \n .. note::\n \n-   PostgreSQL 8.3 is required because PostGIS is not available yet for 8.4.\n+    The PostgreSQL installer creates both a new Windows user to be the\n+    'postgres service account' and a ``postgres`` database superuser\n+    You will be prompted once to set the password for both accounts --\n+    make sure to remember it!\n \n-After downloading, simply click on the installer, follow the\n-on-screen directions, and keep the default options (e.g., keep the installation\n-path as ``C:\\Program Files\\PostgreSQL\\8.3``).\n+When the installer completes, it will ask to launch the Application Stack\n+Builder (ASB) on exit -- keep this checked, as it is necessary to\n+install :ref:`postgisasb`.\n \n .. note::\n \n-    This PostgreSQL installation process will create both a new windows user to be the\n-    'postgres service account' and a special 'postgres superuser' to own the database\n-    cluster. You will be prompted to set a password for both users (make sure to write\n-    them down!). To see basic details on the 'service user' account right click on\n-    'My Computer' and select 'Manage' or go to: Control Panel -> Administrative Tools ->\n-    Computer Management -> System Tools -> Local Users and Groups.\n+    If installed successfully, the PostgreSQL server will run in the\n+    background each time the system as started as a Windows service.\n+    A :menuselection:`PostgreSQL 9.0` start menu group will created\n+    and contains shortcuts for the ASB as well as the 'SQL Shell',\n+    which will launch a ``psql`` command window.\n \n-If installed successfully, the PostgreSQL server will run in the background each time\n-the system as started as a Windows service.  When finished, the installer should launch\n-the Application Stack Builder (ASB) -- use this to install PostGIS, see instructions\n-below for more details.  A 'PostgreSQL 8.3' start menu group should be created that\n-contains shortcuts for the ASB and 'Command Prompt', which launches a terminal window\n-in the PostgreSQL directory.\n+__ http://www.enterprisedb.com/products-services-training/pgdownload\n+__ http://www.enterprisedb.com\n \n-__ http://www.enterprisedb.com/products/pgdownload.do#windows\n+.. _postgisasb:\n \n PostGIS\n ^^^^^^^\n \n-From the Application Stack Builder (Programs -> PostgreSQL 8.3), select\n-'PostgreSQL Database Server 8.3 on port 5432' from the drop down menu.  Next,\n-select 'PostGIS 1.3.6 for PostgreSQL 8.3' from the 'Spatial Extensions' tree\n-in the list.  Select only the default options during install (do not uncheck\n-the option to create a default PostGIS database).\n+From within the Application Stack Builder (to run outside of the installer,\n+:menuselection:`Start --> Programs --> PostgreSQL 9.0`), select\n+:menuselection:`PostgreSQL Database Server 9.0 on port 5432` from the drop down\n+menu.  Next, expand the :menuselection:`Categories --> Spatial Extensions` menu\n+tree and select :menuselection:`PostGIS 1.5 for PostgreSQL 9.0`.\n+\n+After clicking next, you will be prompted to select your mirror, PostGIS\n+will be downloaded, and the PostGIS installer will begin.  Select only the\n+default options during install (e.g., do not uncheck the option to create a \n+default PostGIS database).\n \n .. note::\n \n-    You will be prompted to enter your 'postgres superuser' password in the\n-    'Database Connection Information' dialog.\n+    You will be prompted to enter your ``postgres`` database superuser\n+    password in the 'Database Connection Information' dialog.\n \n psycopg2\n ^^^^^^^^\n \n The ``psycopg2`` Python module provides the interface between Python and the\n-PostgreSQL database.  Download the `Windows installer`__ (v2.0.10) and run\n-using the default settings. [#]_\n+PostgreSQL database.  Download the latest `Windows installer`__ for your version\n+of Python and PostgreSQL and run using the default settings. [#]_\n \n-__ http://www.stickpeople.com/projects/python/win-psycopg/psycopg2-2.0.10.win32-py2.6-pg8.3.7-release.exe\n+__ http://www.stickpeople.com/projects/python/win-psycopg/\n \n-GeoDjango Installer\n-^^^^^^^^^^^^^^^^^^^\n+.. _osgeo4w:\n \n-Download the `GeoDjango Installer`__; this was created [#]_ to simplify the rest\n-of the process for installing GeoDjango on Windows platforms.  The installer\n-automatically installs Django 1.1, GDAL 1.6.0, PROJ 4.6.1 (including datum grid\n-files), and configures the necessary environment variables.\n+OSGeo4W\n+^^^^^^^\n+\n+The `OSGeo4W installer`_ makes it simple to install the PROJ.4, GDAL, and GEOS\n+libraries required by GeoDjango.  First, download the `OSGeo4W installer`_,\n+and run it.  Select :menuselection:`Express Web-GIS Install` and click next.\n+In the 'Select Packages' list, ensure that GDAL is selected; MapServer and\n+Apache are also enabled by default, but are not required by GeoDjango and\n+may be unchecked safely.  After clicking next, the packages will be\n+automatically downloaded and installed, after which you may exit the\n+installer.\n+\n+.. _OSGeo4W installer: http://trac.osgeo.org/osgeo4w/\n+\n+Modify Windows Environment\n+^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+In order to use GeoDjango, you will need to add your Python and OSGeo4W\n+directories to your Windows system ``Path``, as well as create ``GDAL_DATA``\n+and ``PROJ_LIB`` environment variables.  The following set of commands,\n+executable with ``cmd.exe``, will set this up::\n+\n+     set OSGEO4W_ROOT=C:\\OSGeo4W\n+     set PYTHON_ROOT=C:\\Python27\n+     set GDAL_DATA=%OSGEO4W_ROOT%\\share\\gdal\n+     set PROJ_LIB=%OSGEO4W_ROOT%\\share\\proj\n+     set PATH=%PATH%;%PYTHON_ROOT%;%OSGEO4W_ROOT%\\bin\n+     reg ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\" /v Path /t REG_EXPAND_SZ /f /d \"%PATH%\"\n+     reg ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\" /v GDAL_DATA /t REG_EXPAND_SZ /f /d \"%GDAL_DATA%\"\n+     reg ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\" /v PROJ_LIB /t REG_EXPAND_SZ /f /d \"%PROJ_LIB%\"\n+\n+For your convenience, these commands are available in the execuatble batch\n+script, :download:`geodjango_setup.bat`.  \n+\n+.. note::\n \n-Once the installer has completed, log out and log back in so that the\n-modifications to the system environment variables take effect, and you\n-should be good to go.\n+    Administrator privileges are required to execute these commands.\n+    To do this, right-click on :download:`geodjango_setup.bat` and select\n+    :menuselection:`Run as administrator`. You need to log out and log back in again\n+    for the settings to take effect.\n \n .. note::\n \n-    The installer modifies the system ``Path`` environment variable to\n-    include ``C:\\Program Files\\PostgreSQL\\8.3\\bin`` and\n-    ``C:\\Program Files\\GeoDjango\\bin``.  This is required so that Python\n-    may find the GEOS DLL provided by PostGIS and the GDAL DLL provided\n-    by the installer. The installer also sets the ``GDAL_DATA`` and\n-    ``PROJ_LIB`` environment variables.\n+    If you customized the Python or OSGeo4W installation directories,\n+    then you will need to modify the ``OSGEO4W_ROOT`` and/or ``PYTHON_ROOT``\n+    variables accordingly.\n+\n+Install Django and Setup Database\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+Finally, :ref:`install Django <installing-official-release>` on your system.\n+You do not need to create a spatial database template, as one named\n+``template_postgis`` is created for you when installing PostGIS.\n+\n+To administer the database, you can either use the pgAdmin III program\n+(:menuselection:`Start --> PostgreSQL 9.0 --> pgAdmin III`) or the\n+SQL Shell (:menuselection:`Start --> PostgreSQL 9.0 --> SQL Shell`).\n+For example, to create a ``geodjango`` spatial database and user, the following\n+may be executed from the SQL Shell as the ``postgres`` user::\n \n-__ http://geodjango.org/windows/GeoDjango_Installer.exe\n+    postgres# CREATE USER geodjango PASSWORD 'my_passwd';\n+    postgres# CREATE DATABASE geodjango OWNER geodjango TEMPLATE template_postgis ENCODING 'utf8';\n \n .. rubric:: Footnotes\n .. [#] The datum shifting files are needed for converting data to and from certain projections.\n@@ -1200,5 +1258,3 @@ __ http://geodjango.org/windows/GeoDjango_Installer.exe\n        routine from ``ctypes.util`` to locate shared libraries.\n .. [#] The ``psycopg2`` Windows installers are packaged and maintained by\n        `Jason Erickson <http://www.stickpeople.com/projects/python/win-psycopg/>`_.\n-.. [#] The source code for the installer is available in the `nsis_installer <http://geodjango.org/hg/nsis_installer/>`_\n-       GeoDjango mercurial repository."
        }
    ],
    "stats": {
        "total": 172,
        "additions": 118,
        "deletions": 54
    }
}