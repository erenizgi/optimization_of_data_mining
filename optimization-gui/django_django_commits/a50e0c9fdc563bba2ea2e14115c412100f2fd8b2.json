{
    "author": "aaugustin",
    "message": "Fixed a refactoring error in ba5138b1.\n\nThanks Florian for tracing the error.",
    "sha": "a50e0c9fdc563bba2ea2e14115c412100f2fd8b2",
    "files": [
        {
            "sha": "ab80d8aecece9e64d5a1e79741f1b0bf3382f61e",
            "filename": "django/core/management/commands/syncdb.py",
            "status": "modified",
            "additions": 12,
            "deletions": 14,
            "changes": 26,
            "blob_url": "https://github.com/django/django/blob/a50e0c9fdc563bba2ea2e14115c412100f2fd8b2/django%2Fcore%2Fmanagement%2Fcommands%2Fsyncdb.py",
            "raw_url": "https://github.com/django/django/raw/a50e0c9fdc563bba2ea2e14115c412100f2fd8b2/django%2Fcore%2Fmanagement%2Fcommands%2Fsyncdb.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fsyncdb.py?ref=a50e0c9fdc563bba2ea2e14115c412100f2fd8b2",
            "patch": "@@ -121,16 +121,15 @@ def model_installed(model):\n                     if custom_sql:\n                         if verbosity >= 2:\n                             self.stdout.write(\"Installing custom SQL for %s.%s model\\n\" % (app_name, model._meta.object_name))\n-                        with transaction.commit_on_success_unless_managed(using=db):\n-                            try:\n+                        try:\n+                            with transaction.commit_on_success_unless_managed(using=db):\n                                 for sql in custom_sql:\n                                     cursor.execute(sql)\n-                            except Exception as e:\n-                                self.stderr.write(\"Failed to install custom SQL for %s.%s model: %s\\n\" % \\\n-                                                    (app_name, model._meta.object_name, e))\n-                                if show_traceback:\n-                                    traceback.print_exc()\n-                                raise\n+                        except Exception as e:\n+                            self.stderr.write(\"Failed to install custom SQL for %s.%s model: %s\\n\" % \\\n+                                                (app_name, model._meta.object_name, e))\n+                            if show_traceback:\n+                                traceback.print_exc()\n                     else:\n                         if verbosity >= 3:\n                             self.stdout.write(\"No custom SQL for %s.%s model\\n\" % (app_name, model._meta.object_name))\n@@ -145,14 +144,13 @@ def model_installed(model):\n                     if index_sql:\n                         if verbosity >= 2:\n                             self.stdout.write(\"Installing index for %s.%s model\\n\" % (app_name, model._meta.object_name))\n-                        with transaction.commit_on_success_unless_managed(using=db):\n-                            try:\n+                        try:\n+                            with transaction.commit_on_success_unless_managed(using=db):\n                                 for sql in index_sql:\n                                     cursor.execute(sql)\n-                            except Exception as e:\n-                                self.stderr.write(\"Failed to install index for %s.%s model: %s\\n\" % \\\n-                                                    (app_name, model._meta.object_name, e))\n-                                raise\n+                        except Exception as e:\n+                            self.stderr.write(\"Failed to install index for %s.%s model: %s\\n\" % \\\n+                                                (app_name, model._meta.object_name, e))\n \n         # Load initial_data fixtures (unless that has been disabled)\n         if load_initial_data:"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 12,
        "deletions": 14
    }
}