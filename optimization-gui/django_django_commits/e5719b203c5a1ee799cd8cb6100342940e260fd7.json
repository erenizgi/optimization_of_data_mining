{
    "author": "aaugustin",
    "message": "Fixed #17496 -- Regression in the floatformat template filter, introduced by the fix for #15789.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17335 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "e5719b203c5a1ee799cd8cb6100342940e260fd7",
    "files": [
        {
            "sha": "9eabb6dd6008f5a483b45808f1c267a5e35dbb41",
            "filename": "django/template/defaultfilters.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/e5719b203c5a1ee799cd8cb6100342940e260fd7/django%2Ftemplate%2Fdefaultfilters.py",
            "raw_url": "https://github.com/django/django/raw/e5719b203c5a1ee799cd8cb6100342940e260fd7/django%2Ftemplate%2Fdefaultfilters.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fdefaultfilters.py?ref=e5719b203c5a1ee799cd8cb6100342940e260fd7",
            "patch": "@@ -169,7 +169,7 @@ def floatformat(text, arg=-1):\n         # Set the precision high enough to avoid an exception, see #15789.\n         tupl = d.as_tuple()\n         units = len(tupl[1]) - tupl[2]\n-        prec = abs(arg) + units + 1\n+        prec = abs(p) + units + 1\n \n         # Avoid conversion to scientific notation by accessing `sign`, `digits`\n         # and `exponent` from `Decimal.as_tuple()` directly."
        },
        {
            "sha": "5e8c8f1538122d2e81124236267dbe7ea5d91fe9",
            "filename": "tests/regressiontests/defaultfilters/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/e5719b203c5a1ee799cd8cb6100342940e260fd7/tests%2Fregressiontests%2Fdefaultfilters%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/e5719b203c5a1ee799cd8cb6100342940e260fd7/tests%2Fregressiontests%2Fdefaultfilters%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fdefaultfilters%2Ftests.py?ref=e5719b203c5a1ee799cd8cb6100342940e260fd7",
            "patch": "@@ -69,6 +69,8 @@ def __float__(self):\n         try:\n             self.assertEqual(floatformat(1.2345, 2), u'1.23')\n             self.assertEqual(floatformat(15.2042, -3), u'15.204')\n+            self.assertEqual(floatformat(1.2345, '2'), u'1.23')\n+            self.assertEqual(floatformat(15.2042, '-3'), u'15.204')\n             self.assertEqual(floatformat(decimal.Decimal('1.2345'), 2), u'1.23')\n             self.assertEqual(floatformat(decimal.Decimal('15.2042'), -3), u'15.204')\n         finally:"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 3,
        "deletions": 1
    }
}