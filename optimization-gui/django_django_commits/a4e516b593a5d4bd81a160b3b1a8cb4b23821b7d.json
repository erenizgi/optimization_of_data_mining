{
    "author": "aaugustin",
    "message": "Fixed #11166 -- {% widthratio %} should return 0 when the maximum is 0, no matter the value.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17224 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "a4e516b593a5d4bd81a160b3b1a8cb4b23821b7d",
    "files": [
        {
            "sha": "7e2ee6758ff4d6d7a48ed16dada9d450d71ceb88",
            "filename": "django/template/defaulttags.py",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/a4e516b593a5d4bd81a160b3b1a8cb4b23821b7d/django%2Ftemplate%2Fdefaulttags.py",
            "raw_url": "https://github.com/django/django/raw/a4e516b593a5d4bd81a160b3b1a8cb4b23821b7d/django%2Ftemplate%2Fdefaulttags.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fdefaulttags.py?ref=a4e516b593a5d4bd81a160b3b1a8cb4b23821b7d",
            "patch": "@@ -435,17 +435,19 @@ def __init__(self, val_expr, max_expr, max_width):\n     def render(self, context):\n         try:\n             value = self.val_expr.resolve(context)\n-            maxvalue = self.max_expr.resolve(context)\n+            max_value = self.max_expr.resolve(context)\n             max_width = int(self.max_width.resolve(context))\n         except VariableDoesNotExist:\n             return ''\n         except ValueError:\n             raise TemplateSyntaxError(\"widthratio final argument must be an number\")\n         try:\n             value = float(value)\n-            maxvalue = float(maxvalue)\n-            ratio = (value / maxvalue) * max_width\n-        except (ValueError, ZeroDivisionError):\n+            max_value = float(max_value)\n+            ratio = (value / max_value) * max_width\n+        except ZeroDivisionError:\n+            return '0'\n+        except ValueError:\n             return ''\n         return str(int(round(ratio)))\n "
        },
        {
            "sha": "1a1b360847892cdcd070ed8edbbc55dde0b4561e",
            "filename": "tests/regressiontests/templates/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a4e516b593a5d4bd81a160b3b1a8cb4b23821b7d/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a4e516b593a5d4bd81a160b3b1a8cb4b23821b7d/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftemplates%2Ftests.py?ref=a4e516b593a5d4bd81a160b3b1a8cb4b23821b7d",
            "patch": "@@ -1429,7 +1429,7 @@ def get_template_tests(self):\n \n             ### WIDTHRATIO TAG ########################################################\n             'widthratio01': ('{% widthratio a b 0 %}', {'a':50,'b':100}, '0'),\n-            'widthratio02': ('{% widthratio a b 100 %}', {'a':0,'b':0}, ''),\n+            'widthratio02': ('{% widthratio a b 100 %}', {'a':0,'b':0}, '0'),\n             'widthratio03': ('{% widthratio a b 100 %}', {'a':0,'b':100}, '0'),\n             'widthratio04': ('{% widthratio a b 100 %}', {'a':50,'b':100}, '50'),\n             'widthratio05': ('{% widthratio a b 100 %}', {'a':100,'b':100}, '100'),"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 7,
        "deletions": 5
    }
}