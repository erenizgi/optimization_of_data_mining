{
    "author": "ptone",
    "message": "Deprecated depth kwarg on select_related.\n\nThis is the start of a deprecation path for the depth kwarg on\nselect_related. Removing this will allow us to update select_related so\nit chains properly and have an API similar to prefetch_related.\n\nThanks to Marc Tamlyn for spearheading and initial patch.\n\nrefs #16855",
    "sha": "965cc0b1ffa27574e5684a18f9400577e5b4598d",
    "files": [
        {
            "sha": "c00080abeff141fff464c2aa96219aae5d7bb5d4",
            "filename": "django/db/models/query.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/965cc0b1ffa27574e5684a18f9400577e5b4598d/django%2Fdb%2Fmodels%2Fquery.py",
            "raw_url": "https://github.com/django/django/raw/965cc0b1ffa27574e5684a18f9400577e5b4598d/django%2Fdb%2Fmodels%2Fquery.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fquery.py?ref=965cc0b1ffa27574e5684a18f9400577e5b4598d",
            "patch": "@@ -5,6 +5,7 @@\n import copy\n import itertools\n import sys\n+import warnings\n \n from django.core import exceptions\n from django.db import connections, router, transaction, IntegrityError\n@@ -698,6 +699,9 @@ def select_related(self, *fields, **kwargs):\n         If fields are specified, they must be ForeignKey fields and only those\n         related objects are included in the selection.\n         \"\"\"\n+        if 'depth' in kwargs:\n+            warnings.warn('The \"depth\" keyword argument has been deprecated.\\n'\n+                    'Use related field names instead.', PendingDeprecationWarning)\n         depth = kwargs.pop('depth', 0)\n         if kwargs:\n             raise TypeError('Unexpected keyword arguments to select_related: %s'"
        },
        {
            "sha": "9fd92db2b4ebac31fba7275f4863c81bbb19b662",
            "filename": "docs/internals/deprecation.txt",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/965cc0b1ffa27574e5684a18f9400577e5b4598d/docs%2Finternals%2Fdeprecation.txt",
            "raw_url": "https://github.com/django/django/raw/965cc0b1ffa27574e5684a18f9400577e5b4598d/docs%2Finternals%2Fdeprecation.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Finternals%2Fdeprecation.txt?ref=965cc0b1ffa27574e5684a18f9400577e5b4598d",
            "patch": "@@ -298,6 +298,9 @@ these changes.\n \n * The ``daily_cleanup.py`` script will be removed.\n \n+* The ``depth`` keyword argument will be removed from\n+  :meth:`~django.db.models.query.QuerySet.select_related`.\n+\n 2.0\n ---\n "
        },
        {
            "sha": "295c996af45a8873768675b4bf24c89f61674b67",
            "filename": "docs/ref/models/querysets.txt",
            "status": "modified",
            "additions": 16,
            "deletions": 14,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/965cc0b1ffa27574e5684a18f9400577e5b4598d/docs%2Fref%2Fmodels%2Fquerysets.txt",
            "raw_url": "https://github.com/django/django/raw/965cc0b1ffa27574e5684a18f9400577e5b4598d/docs%2Fref%2Fmodels%2Fquerysets.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fmodels%2Fquerysets.txt?ref=965cc0b1ffa27574e5684a18f9400577e5b4598d",
            "patch": "@@ -676,21 +676,12 @@ Note that, by default, ``select_related()`` does not follow foreign keys that\n have ``null=True``.\n \n Usually, using ``select_related()`` can vastly improve performance because your\n-app can avoid many database calls. However, in situations with deeply nested\n-sets of relationships ``select_related()`` can sometimes end up following \"too\n-many\" relations, and can generate queries so large that they end up being slow.\n+app can avoid many database calls. However, there are times you are only\n+interested in specific related models, or have deeply nested sets of\n+relationships, and in these cases ``select_related()`` can can be optimized by\n+explicitly passing the related field names you are interested in. Only\n+the specified relations will be followed.\n \n-In these situations, you can use the ``depth`` argument to ``select_related()``\n-to control how many \"levels\" of relations ``select_related()`` will actually\n-follow::\n-\n-    b = Book.objects.select_related(depth=1).get(id=4)\n-    p = b.author         # Doesn't hit the database.\n-    c = p.hometown       # Requires a database call.\n-\n-Sometimes you only want to access specific models that are related to your root\n-model, not all of the related models. In these cases, you can pass the related\n-field names to ``select_related()`` and it will only follow those relations.\n You can even do this for models that are more than one relation away by\n separating the field names with double underscores, just as for filters. For\n example, if you have this model::\n@@ -730,6 +721,17 @@ You can also refer to the reverse direction of a\n is defined. Instead of specifying the field name, use the :attr:`related_name\n <django.db.models.ForeignKey.related_name>` for the field on the related object.\n \n+.. deprecated:: 1.5\n+    The ``depth`` parameter to ``select_related()`` has been deprecated. You\n+    should replace it with the use of the ``(*fields)`` listing specific\n+    related fields instead as documented above.\n+\n+A depth limit of relationships to follow can also be specified::\n+\n+    b = Book.objects.select_related(depth=1).get(id=4)\n+    p = b.author         # Doesn't hit the database.\n+    c = p.hometown       # Requires a database call.\n+\n A :class:`~django.db.models.OneToOneField` is not traversed in the reverse\n direction if you are performing a depth-based ``select_related()`` call.\n "
        },
        {
            "sha": "154f7115608fac8981888a8be512f67f23a85492",
            "filename": "docs/releases/1.5.txt",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/965cc0b1ffa27574e5684a18f9400577e5b4598d/docs%2Freleases%2F1.5.txt",
            "raw_url": "https://github.com/django/django/raw/965cc0b1ffa27574e5684a18f9400577e5b4598d/docs%2Freleases%2F1.5.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.5.txt?ref=965cc0b1ffa27574e5684a18f9400577e5b4598d",
            "patch": "@@ -638,3 +638,10 @@ The :djadmin:`cleanup` management command has been deprecated and replaced by\n \n The undocumented ``daily_cleanup.py`` script has been deprecated. Use the\n :djadmin:`clearsessions` management command instead.\n+\n+``depth`` keyword argument in ``select_related``\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+The ``depth`` keyword argument in\n+:meth:`~django.db.models.query.QuerySet.select_related` has been deprecated.\n+You should use field names instead."
        }
    ],
    "stats": {
        "total": 44,
        "additions": 30,
        "deletions": 14
    }
}