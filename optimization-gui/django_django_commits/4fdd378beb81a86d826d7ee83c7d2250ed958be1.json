{
    "author": "akaariai",
    "message": "Skip model validation when models are known good.\n\nIn some situations Django calls model validation when the models are\nalready known good. This is most visible in tests, which use flush\nand loaddata commands. This resulted in around 10% overhead when\nrunning tests under sqlite.",
    "sha": "4fdd378beb81a86d826d7ee83c7d2250ed958be1",
    "files": [
        {
            "sha": "a9368776f7b73aa53a436ed2c385f44aeedf1b23",
            "filename": "django/core/management/base.py",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/4fdd378beb81a86d826d7ee83c7d2250ed958be1/django%2Fcore%2Fmanagement%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/4fdd378beb81a86d826d7ee83c7d2250ed958be1/django%2Fcore%2Fmanagement%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fbase.py?ref=4fdd378beb81a86d826d7ee83c7d2250ed958be1",
            "patch": "@@ -198,9 +198,9 @@ def execute(self, *args, **options):\n         \"\"\"\n         Try to execute this command, performing model validation if\n         needed (as controlled by the attribute\n-        ``self.requires_model_validation``). If the command raises a\n-        ``CommandError``, intercept it and print it sensibly to\n-        stderr.\n+        ``self.requires_model_validation``, except if force-skipped). If the\n+        command raises a ``CommandError``, intercept it and print it sensibly\n+        to stderr.\n         \"\"\"\n         show_traceback = options.get('traceback', False)\n \n@@ -226,7 +226,7 @@ def execute(self, *args, **options):\n         try:\n             self.stdout = options.get('stdout', sys.stdout)\n             self.stderr = options.get('stderr', sys.stderr)\n-            if self.requires_model_validation:\n+            if self.requires_model_validation and not options.get('skip_validation'):\n                 self.validate()\n             output = self.handle(*args, **options)\n             if output:"
        },
        {
            "sha": "88caea152cc8b256affbc143f3c261356e5a32cb",
            "filename": "django/core/management/commands/syncdb.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/4fdd378beb81a86d826d7ee83c7d2250ed958be1/django%2Fcore%2Fmanagement%2Fcommands%2Fsyncdb.py",
            "raw_url": "https://github.com/django/django/raw/4fdd378beb81a86d826d7ee83c7d2250ed958be1/django%2Fcore%2Fmanagement%2Fcommands%2Fsyncdb.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fsyncdb.py?ref=4fdd378beb81a86d826d7ee83c7d2250ed958be1",
            "patch": "@@ -160,4 +160,5 @@ def model_installed(model):\n         # Load initial_data fixtures (unless that has been disabled)\n         if load_initial_data:\n             from django.core.management import call_command\n-            call_command('loaddata', 'initial_data', verbosity=verbosity, database=db)\n+            call_command('loaddata', 'initial_data', verbosity=verbosity,\n+                         database=db, skip_validation=True)"
        },
        {
            "sha": "e2d7b3f82e29416c55db4daaf83d1d30e029cc05",
            "filename": "django/test/testcases.py",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/4fdd378beb81a86d826d7ee83c7d2250ed958be1/django%2Ftest%2Ftestcases.py",
            "raw_url": "https://github.com/django/django/raw/4fdd378beb81a86d826d7ee83c7d2250ed958be1/django%2Ftest%2Ftestcases.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftest%2Ftestcases.py?ref=4fdd378beb81a86d826d7ee83c7d2250ed958be1",
            "patch": "@@ -468,13 +468,14 @@ def _fixture_setup(self):\n         else:\n             databases = [DEFAULT_DB_ALIAS]\n         for db in databases:\n-            call_command('flush', verbosity=0, interactive=False, database=db)\n+            call_command('flush', verbosity=0, interactive=False, database=db,\n+                         skip_validation=True)\n \n             if hasattr(self, 'fixtures'):\n                 # We have to use this slightly awkward syntax due to the fact\n                 # that we're using *args and **kwargs together.\n                 call_command('loaddata', *self.fixtures,\n-                             **{'verbosity': 0, 'database': db})\n+                             **{'verbosity': 0, 'database': db, 'skip_validation': True})\n \n     def _urlconf_setup(self):\n         if hasattr(self, 'urls'):\n@@ -826,7 +827,8 @@ def _fixture_setup(self):\n                              **{\n                                 'verbosity': 0,\n                                 'commit': False,\n-                                'database': db\n+                                'database': db,\n+                                'skip_validation': True,\n                              })\n \n     def _fixture_teardown(self):"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 11,
        "deletions": 8
    }
}