{
    "author": "aaugustin",
    "message": "Fixed #18963 -- Used a subclass-friendly pattern\n\nfor Python 2 object model compatibility methods.",
    "sha": "fc10418fba4fb906e4265650b62c510d526d63f7",
    "files": [
        {
            "sha": "3d17fe275484e1b414cf9cdced1f8a8c22008092",
            "filename": "django/contrib/auth/context_processors.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcontrib%2Fauth%2Fcontext_processors.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcontrib%2Fauth%2Fcontext_processors.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fcontext_processors.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -18,7 +18,9 @@ def __iter__(self):\n \n     def __bool__(self):\n         return self.user.has_module_perms(self.module_name)\n-    __nonzero__ = __bool__ # Python 2\n+\n+    def __nonzero__(self):      # Python 2 compatibility\n+        return type(self).__bool__(self)\n \n \n class PermWrapper(object):"
        },
        {
            "sha": "e2e6b6bca87463d7d9af17c9480db3172e8a8a98",
            "filename": "django/contrib/gis/measure.py",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcontrib%2Fgis%2Fmeasure.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcontrib%2Fgis%2Fmeasure.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fmeasure.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -151,19 +151,25 @@ def __truediv__(self, other):\n                 **{self.STANDARD_UNIT: (self.standard / other)})\n         else:\n             raise TypeError('%(class)s must be divided with number or %(class)s' % {\"class\":pretty_name(self)})\n-    __div__ = __truediv__ # Python 2 compatibility\n+\n+    def __div__(self, other):   # Python 2 compatibility\n+        return type(self).__truediv__(self, other)\n \n     def __itruediv__(self, other):\n         if isinstance(other, NUMERIC_TYPES):\n             self.standard /= float(other)\n             return self\n         else:\n             raise TypeError('%(class)s must be divided with number' % {\"class\":pretty_name(self)})\n-    __idiv__ = __itruediv__ # Python 2 compatibility\n+\n+    def __idiv__(self, other):  # Python 2 compatibility\n+        return type(self).__itruediv__(self, other)\n \n     def __bool__(self):\n         return bool(self.standard)\n-    __nonzero__ = __bool__ # Python 2 compatibility\n+\n+    def __nonzero__(self):      # Python 2 compatibility\n+        return type(self).__bool__(self)\n \n     def default_units(self, kwargs):\n         \"\"\"\n@@ -314,7 +320,9 @@ def __truediv__(self, other):\n                 **{self.STANDARD_UNIT: (self.standard / other)})\n         else:\n             raise TypeError('%(class)s must be divided by a number' % {\"class\":pretty_name(self)})\n-    __div__ = __truediv__ # Python 2 compatibility\n+\n+    def __div__(self, other):  # Python 2 compatibility\n+        return type(self).__truediv__(self, other)\n \n \n # Shortcuts"
        },
        {
            "sha": "71de5ab74124c3ec097275c2170e520be0bd4a0b",
            "filename": "django/core/files/base.py",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcore%2Ffiles%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcore%2Ffiles%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Ffiles%2Fbase.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -28,7 +28,9 @@ def __repr__(self):\n \n     def __bool__(self):\n         return bool(self.name)\n-    __nonzero__ = __bool__ # Python 2\n+\n+    def __nonzero__(self):      # Python 2 compatibility\n+        return type(self).__bool__(self)\n \n     def __len__(self):\n         return self.size\n@@ -142,7 +144,9 @@ def __str__(self):\n \n     def __bool__(self):\n         return True\n-    __nonzero__ = __bool__ # Python 2\n+\n+    def __nonzero__(self):      # Python 2 compatibility\n+        return type(self).__bool__(self)\n \n     def open(self, mode=None):\n         self.seek(0)"
        },
        {
            "sha": "294934a04a081d97554b0403b3d0a2ebe60719ad",
            "filename": "django/core/serializers/base.py",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcore%2Fserializers%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcore%2Fserializers%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fserializers%2Fbase.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -112,7 +112,7 @@ def getvalue(self):\n         if callable(getattr(self.stream, 'getvalue', None)):\n             return self.stream.getvalue()\n \n-class Deserializer(object):\n+class Deserializer(six.Iterator):\n     \"\"\"\n     Abstract base deserializer class.\n     \"\"\"\n@@ -138,8 +138,6 @@ def __next__(self):\n         \"\"\"Iteration iterface -- return the next item in the stream\"\"\"\n         raise NotImplementedError\n \n-    next = __next__             # Python 2 compatibility\n-\n class DeserializedObject(object):\n     \"\"\"\n     A deserialized model."
        },
        {
            "sha": "ea333a22bd0fa6293e94fbd8662ed6afdb2ce312",
            "filename": "django/core/serializers/xml_serializer.py",
            "status": "modified",
            "additions": 0,
            "deletions": 2,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcore%2Fserializers%2Fxml_serializer.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fcore%2Fserializers%2Fxml_serializer.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fserializers%2Fxml_serializer.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -161,8 +161,6 @@ def __next__(self):\n                 return self._handle_object(node)\n         raise StopIteration\n \n-    next = __next__             # Python 2 compatibility\n-\n     def _handle_object(self, node):\n         \"\"\"\n         Convert an <object> node to a DeserializedObject."
        },
        {
            "sha": "dfdfd4fd49869013bb1a7b395685153a2b09ad8a",
            "filename": "django/db/backends/oracle/base.py",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fdb%2Fbackends%2Foracle%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fdb%2Fbackends%2Foracle%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fbackends%2Foracle%2Fbase.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -774,7 +774,7 @@ def __iter__(self):\n         return CursorIterator(self.cursor)\n \n \n-class CursorIterator(object):\n+class CursorIterator(six.Iterator):\n \n     \"\"\"Cursor iterator wrapper that invokes our custom row factory.\"\"\"\n \n@@ -788,8 +788,6 @@ def __iter__(self):\n     def __next__(self):\n         return _rowfactory(next(self.iter), self.cursor)\n \n-    next = __next__             # Python 2 compatibility\n-\n \n def _rowfactory(row, cursor):\n     # Cast numeric values as the appropriate Python type based upon the"
        },
        {
            "sha": "3566d777c68cb2c817d7b479d4a7ea1521db50bd",
            "filename": "django/db/models/expressions.py",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fdb%2Fmodels%2Fexpressions.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fdb%2Fmodels%2Fexpressions.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fexpressions.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -62,7 +62,9 @@ def __mul__(self, other):\n \n     def __truediv__(self, other):\n         return self._combine(other, self.DIV, False)\n-    __div__ = __truediv__ # Python 2 compatibility\n+\n+    def __div__(self, other):  # Python 2 compatibility\n+        return type(self).__truediv__(self, other)\n \n     def __mod__(self, other):\n         return self._combine(other, self.MOD, False)\n@@ -94,7 +96,9 @@ def __rmul__(self, other):\n \n     def __rtruediv__(self, other):\n         return self._combine(other, self.DIV, True)\n-    __rdiv__ = __rtruediv__ # Python 2 compatibility\n+\n+    def __rdiv__(self, other):  # Python 2 compatibility\n+        return type(self).__rtruediv__(self, other)\n \n     def __rmod__(self, other):\n         return self._combine(other, self.MOD, True)\n@@ -151,10 +155,10 @@ class DateModifierNode(ExpressionNode):\n         (A custom function is used in order to preserve six digits of fractional\n         second information on sqlite, and to format both date and datetime values.)\n \n-    Note that microsecond comparisons are not well supported with MySQL, since \n+    Note that microsecond comparisons are not well supported with MySQL, since\n     MySQL does not store microsecond information.\n \n-    Only adding and subtracting timedeltas is supported, attempts to use other \n+    Only adding and subtracting timedeltas is supported, attempts to use other\n     operations raise a TypeError.\n     \"\"\"\n     def __init__(self, children, connector, negated=False):"
        },
        {
            "sha": "a3b28e9228959a7be1e0ad8cf9e2a3df634a4ae5",
            "filename": "django/db/models/query.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fdb%2Fmodels%2Fquery.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fdb%2Fmodels%2Fquery.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fquery.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -136,7 +136,9 @@ def __bool__(self):\n         except StopIteration:\n             return False\n         return True\n-    __nonzero__ = __bool__ # Python 2\n+\n+    def __nonzero__(self):      # Python 2 compatibility\n+        return type(self).__bool__(self)\n \n     def __contains__(self, val):\n         # The 'in' operator works without this method, due to __iter__. This"
        },
        {
            "sha": "7423669c968066984dbfaf3ded815858df16691f",
            "filename": "django/dispatch/saferef.py",
            "status": "modified",
            "additions": 9,
            "deletions": 7,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fdispatch%2Fsaferef.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fdispatch%2Fsaferef.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdispatch%2Fsaferef.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -67,9 +67,9 @@ class BoundMethodWeakref(object):\n             same BoundMethodWeakref instance.\n \n     \"\"\"\n-    \n+\n     _allInstances = weakref.WeakValueDictionary()\n-    \n+\n     def __new__( cls, target, onDelete=None, *arguments,**named ):\n         \"\"\"Create new instance or return current instance\n \n@@ -92,7 +92,7 @@ def __new__( cls, target, onDelete=None, *arguments,**named ):\n             cls._allInstances[key] = base\n             base.__init__( target, onDelete, *arguments,**named)\n             return base\n-    \n+\n     def __init__(self, target, onDelete=None):\n         \"\"\"Return a weak-reference-like instance for a bound method\n \n@@ -132,7 +132,7 @@ def remove(weak, self=self):\n         self.weakFunc = weakref.ref(target.__func__, remove)\n         self.selfName = str(target.__self__)\n         self.funcName = str(target.__func__.__name__)\n-    \n+\n     def calculateKey( cls, target ):\n         \"\"\"Calculate the reference key for this reference\n \n@@ -141,7 +141,7 @@ def calculateKey( cls, target ):\n         \"\"\"\n         return (id(target.__self__),id(target.__func__))\n     calculateKey = classmethod( calculateKey )\n-    \n+\n     def __str__(self):\n         \"\"\"Give a friendly representation of the object\"\"\"\n         return \"\"\"%s( %s.%s )\"\"\"%(\n@@ -157,14 +157,16 @@ def __str__(self):\n     def __bool__( self ):\n         \"\"\"Whether we are still a valid reference\"\"\"\n         return self() is not None\n-    __nonzero__ = __bool__ # Python 2\n+\n+    def __nonzero__(self):      # Python 2 compatibility\n+        return type(self).__bool__(self)\n \n     def __eq__(self, other):\n         \"\"\"Compare with another reference\"\"\"\n         if not isinstance(other, self.__class__):\n             return self.__class__ == type(other)\n         return self.key == other.key\n-    \n+\n     def __call__(self):\n         \"\"\"Return a strong reference to the bound method\n "
        },
        {
            "sha": "a0a38f336fe4bfe22ba795012475cc3e2011ecc9",
            "filename": "django/forms/formsets.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fforms%2Fformsets.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fforms%2Fformsets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fformsets.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -69,7 +69,9 @@ def __len__(self):\n     def __bool__(self):\n         \"\"\"All formsets have a management form which is not included in the length\"\"\"\n         return True\n-    __nonzero__ = __bool__ # Python 2\n+\n+    def __nonzero__(self):      # Python 2 compatibility\n+        return type(self).__bool__(self)\n \n     @property\n     def management_form(self):"
        },
        {
            "sha": "9413a1eabb8ea96ea5c54424c9a404a0ae377b61",
            "filename": "django/http/multipartparser.py",
            "status": "modified",
            "additions": 4,
            "deletions": 12,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fhttp%2Fmultipartparser.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fhttp%2Fmultipartparser.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fhttp%2Fmultipartparser.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -256,7 +256,7 @@ def IE_sanitize(self, filename):\n         \"\"\"Cleanup filename from Internet Explorer full paths.\"\"\"\n         return filename and filename[filename.rfind(\"\\\\\")+1:].strip()\n \n-class LazyStream(object):\n+class LazyStream(six.Iterator):\n     \"\"\"\n     The LazyStream wrapper allows one to get and \"unget\" bytes from a stream.\n \n@@ -323,8 +323,6 @@ def __next__(self):\n         self.position += len(output)\n         return output\n \n-    next = __next__             # Python 2 compatibility\n-\n     def close(self):\n         \"\"\"\n         Used to invalidate/disable this lazy stream.\n@@ -369,7 +367,7 @@ def _update_unget_history(self, num_bytes):\n                 \" if there is none, report this to the Django developers.\"\n             )\n \n-class ChunkIter(object):\n+class ChunkIter(six.Iterator):\n     \"\"\"\n     An iterable that will yield chunks of data. Given a file-like object as the\n     constructor, this object will yield chunks of read operations from that\n@@ -389,12 +387,10 @@ def __next__(self):\n         else:\n             raise StopIteration()\n \n-    next = __next__             # Python 2 compatibility\n-\n     def __iter__(self):\n         return self\n \n-class InterBoundaryIter(object):\n+class InterBoundaryIter(six.Iterator):\n     \"\"\"\n     A Producer that will iterate over boundaries.\n     \"\"\"\n@@ -411,9 +407,7 @@ def __next__(self):\n         except InputStreamExhausted:\n             raise StopIteration()\n \n-    next = __next__             # Python 2 compatibility\n-\n-class BoundaryIter(object):\n+class BoundaryIter(six.Iterator):\n     \"\"\"\n     A Producer that is sensitive to boundaries.\n \n@@ -489,8 +483,6 @@ def __next__(self):\n                 stream.unget(chunk[-rollback:])\n                 return chunk[:-rollback]\n \n-    next = __next__             # Python 2 compatibility\n-\n     def _find_boundary(self, data, eof = False):\n         \"\"\"\n         Finds a multipart boundary in data."
        },
        {
            "sha": "df0a955b181a76f22266a392819f0e0c8f64f39f",
            "filename": "django/http/response.py",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fhttp%2Fresponse.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Fhttp%2Fresponse.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fhttp%2Fresponse.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -23,7 +23,7 @@ class BadHeaderError(ValueError):\n     pass\n \n \n-class HttpResponseBase(object):\n+class HttpResponseBase(six.Iterator):\n     \"\"\"\n     An HTTP response base class with dictionary-accessed headers.\n \n@@ -218,8 +218,6 @@ def __next__(self):\n         # Subclasses must define self._iterator for this function.\n         return self.make_bytes(next(self._iterator))\n \n-    next = __next__             # Python 2 compatibility\n-\n     # These methods partially implement the file-like object interface.\n     # See http://docs.python.org/lib/bltin-file-objects.html\n "
        },
        {
            "sha": "ce490224e0211d60ae5d7dbfebce574c6b9898f2",
            "filename": "django/utils/tree.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Futils%2Ftree.py",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/django%2Futils%2Ftree.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftree.py?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -73,7 +73,9 @@ def __bool__(self):\n         For truth value testing.\n         \"\"\"\n         return bool(self.children)\n-    __nonzero__ = __bool__ # Python 2\n+\n+    def __nonzero__(self):      # Python 2 compatibility\n+        return type(self).__bool__(self)\n \n     def __contains__(self, other):\n         \"\"\""
        },
        {
            "sha": "e6dc165399b7c728ecddff8b6054f949bb493aef",
            "filename": "docs/topics/python3.txt",
            "status": "modified",
            "additions": 7,
            "deletions": 6,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/fc10418fba4fb906e4265650b62c510d526d63f7/docs%2Ftopics%2Fpython3.txt",
            "raw_url": "https://github.com/django/django/raw/fc10418fba4fb906e4265650b62c510d526d63f7/docs%2Ftopics%2Fpython3.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fpython3.txt?ref=fc10418fba4fb906e4265650b62c510d526d63f7",
            "patch": "@@ -278,15 +278,13 @@ Iterators\n \n ::\n \n-    class MyIterator(object):\n+    class MyIterator(six.Iterator):\n         def __iter__(self):\n             return self             # implement some logic here\n \n         def __next__(self):\n             raise StopIteration     # implement some logic here\n \n-        next = __next__             # Python 2 compatibility\n-\n Boolean evaluation\n ~~~~~~~~~~~~~~~~~~\n \n@@ -297,7 +295,8 @@ Boolean evaluation\n         def __bool__(self):\n             return True             # implement some logic here\n \n-        __nonzero__ = __bool__      # Python 2 compatibility\n+        def __nonzero__(self):      # Python 2 compatibility\n+            return type(self).__bool__(self)\n \n Division\n ~~~~~~~~\n@@ -309,12 +308,14 @@ Division\n         def __truediv__(self, other):\n             return self / other     # implement some logic here\n \n-        __div__ = __truediv__           # Python 2 compatibility\n+        def __div__(self, other):   # Python 2 compatibility\n+            return type(self).__truediv__(self, other)\n \n         def __itruediv__(self, other):\n             return self // other    # implement some logic here\n \n-        __idiv__ = __itruediv__         # Python 2 compatibility\n+        def __idiv__(self, other):  # Python 2 compatibility\n+            return type(self).__itruediv__(self, other)\n \n .. module: django.utils.six\n "
        }
    ],
    "stats": {
        "total": 111,
        "additions": 61,
        "deletions": 50
    }
}