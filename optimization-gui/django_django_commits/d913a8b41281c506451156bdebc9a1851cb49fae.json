{
    "author": "aaugustin",
    "message": "Fixed #19356 -- Increased session key entropy.",
    "sha": "d913a8b41281c506451156bdebc9a1851cb49fae",
    "files": [
        {
            "sha": "f79a2645004ab7016c2ddbf2012f647a9f643ba3",
            "filename": "django/contrib/sessions/backends/base.py",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/d913a8b41281c506451156bdebc9a1851cb49fae/django%2Fcontrib%2Fsessions%2Fbackends%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/d913a8b41281c506451156bdebc9a1851cb49fae/django%2Fcontrib%2Fsessions%2Fbackends%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Fbackends%2Fbase.py?ref=d913a8b41281c506451156bdebc9a1851cb49fae",
            "patch": "@@ -6,6 +6,7 @@\n     from django.utils.six.moves import cPickle as pickle\n except ImportError:\n     import pickle\n+import string\n \n from django.conf import settings\n from django.core.exceptions import SuspiciousOperation\n@@ -15,6 +16,10 @@\n from django.utils import timezone\n from django.utils.encoding import force_bytes\n \n+# session_key should not be case sensitive because some backends can store it\n+# on case insensitive file systems.\n+VALID_KEY_CHARS = string.ascii_lowercase + string.digits\n+\n class CreateError(Exception):\n     \"\"\"\n     Used internally as a consistent exception type to catch from save (see the\n@@ -132,12 +137,8 @@ def clear(self):\n \n     def _get_new_session_key(self):\n         \"Returns session key that isn't being used.\"\n-        # Todo: move to 0-9a-z charset in 1.5\n-        hex_chars = '1234567890abcdef'\n-        # session_key should not be case sensitive because some backends\n-        # can store it on case insensitive file systems.\n         while True:\n-            session_key = get_random_string(32, hex_chars)\n+            session_key = get_random_string(32, VALID_KEY_CHARS)\n             if not self.exists(session_key):\n                 break\n         return session_key"
        },
        {
            "sha": "7d933c678a191d2973e811bf038bbe4daa342e56",
            "filename": "django/contrib/sessions/backends/file.py",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/d913a8b41281c506451156bdebc9a1851cb49fae/django%2Fcontrib%2Fsessions%2Fbackends%2Ffile.py",
            "raw_url": "https://github.com/django/django/raw/d913a8b41281c506451156bdebc9a1851cb49fae/django%2Fcontrib%2Fsessions%2Fbackends%2Ffile.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Fbackends%2Ffile.py?ref=d913a8b41281c506451156bdebc9a1851cb49fae",
            "patch": "@@ -4,7 +4,7 @@\n import tempfile\n \n from django.conf import settings\n-from django.contrib.sessions.backends.base import SessionBase, CreateError\n+from django.contrib.sessions.backends.base import SessionBase, CreateError, VALID_KEY_CHARS\n from django.core.exceptions import SuspiciousOperation, ImproperlyConfigured\n from django.utils import timezone\n \n@@ -36,8 +36,6 @@ def _get_storage_path(cls):\n             cls._storage_path = storage_path\n             return storage_path\n \n-    VALID_KEY_CHARS = set(\"abcdef0123456789\")\n-\n     def _key_to_file(self, session_key=None):\n         \"\"\"\n         Get the file associated with this session key.\n@@ -48,7 +46,7 @@ def _key_to_file(self, session_key=None):\n         # Make sure we're not vulnerable to directory traversal. Session keys\n         # should always be md5s, so they should never contain directory\n         # components.\n-        if not set(session_key).issubset(self.VALID_KEY_CHARS):\n+        if not set(session_key).issubset(set(VALID_KEY_CHARS)):\n             raise SuspiciousOperation(\n                 \"Invalid characters in session key\")\n "
        }
    ],
    "stats": {
        "total": 17,
        "additions": 8,
        "deletions": 9
    }
}