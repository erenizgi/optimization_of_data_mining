{
    "author": "jphalip",
    "message": "Skip GeometryFieldTest if there's no spacial database.",
    "sha": "1794e36fa1facef40638f59012c2dac4ac4fa261",
    "files": [
        {
            "sha": "c62197f3854fb883cd614897e7f81fe679245356",
            "filename": "django/contrib/gis/gdal/__init__.py",
            "status": "modified",
            "additions": 18,
            "deletions": 6,
            "changes": 24,
            "blob_url": "https://github.com/django/django/blob/1794e36fa1facef40638f59012c2dac4ac4fa261/django%2Fcontrib%2Fgis%2Fgdal%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/1794e36fa1facef40638f59012c2dac4ac4fa261/django%2Fcontrib%2Fgis%2Fgdal%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgdal%2F__init__.py?ref=1794e36fa1facef40638f59012c2dac4ac4fa261",
            "patch": "@@ -6,7 +6,7 @@\n   reference system to another.\n \n  Driver: Wraps an OGR data source driver.\n-  \n+\n  DataSource: Wrapper for the OGR data source object, supports\n   OGR-supported data sources.\n \n@@ -20,15 +20,15 @@\n \n  SpatialReference: Represents OSR Spatial Reference objects.\n \n- The GDAL library will be imported from the system path using the default  \n+ The GDAL library will be imported from the system path using the default\n  library name for the current OS. The default library path may be overridden\n- by setting `GDAL_LIBRARY_PATH` in your settings with the path to the GDAL C \n- library on your system.  \n+ by setting `GDAL_LIBRARY_PATH` in your settings with the path to the GDAL C\n+ library on your system.\n \n- GDAL links to a large number of external libraries that consume RAM when \n+ GDAL links to a large number of external libraries that consume RAM when\n  loaded.  Thus, it may desirable to disable GDAL on systems with limited\n  RAM resources -- this may be accomplished by setting `GDAL_LIBRARY_PATH`\n- to a non-existant file location (e.g., `GDAL_LIBRARY_PATH='/null/path'`; \n+ to a non-existant file location (e.g., `GDAL_LIBRARY_PATH='/null/path'`;\n  setting to None/False/'' will not work as a string must be given).\n \"\"\"\n # Attempting to import objects that depend on the GDAL library.  The\n@@ -44,6 +44,18 @@\n except:\n     HAS_GDAL, GEOJSON = False, False\n \n+from django.contrib.gis.tests.utils import no_mysql, oracle, postgis, spatialite\n+HAS_SPATIALREFSYS = True\n+if oracle:\n+    from django.contrib.gis.db.backends.oracle.models import SpatialRefSys\n+elif postgis:\n+    from django.contrib.gis.db.backends.postgis.models import SpatialRefSys\n+elif spatialite:\n+    from django.contrib.gis.db.backends.spatialite.models import SpatialRefSys\n+else:\n+    HAS_SPATIALREFSYS = False\n+    SpatialRefSys = None\n+\n try:\n     from django.contrib.gis.gdal.envelope import Envelope\n except ImportError:"
        },
        {
            "sha": "913e2db975df8a376544794db2f72f90bd9c4cdf",
            "filename": "django/contrib/gis/tests/test_geoforms.py",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/1794e36fa1facef40638f59012c2dac4ac4fa261/django%2Fcontrib%2Fgis%2Ftests%2Ftest_geoforms.py",
            "raw_url": "https://github.com/django/django/raw/1794e36fa1facef40638f59012c2dac4ac4fa261/django%2Fcontrib%2Fgis%2Ftests%2Ftest_geoforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Ftest_geoforms.py?ref=1794e36fa1facef40638f59012c2dac4ac4fa261",
            "patch": "@@ -1,11 +1,13 @@\n from django.forms import ValidationError\n-from django.contrib.gis import forms\n-from django.contrib.gis.gdal import HAS_GDAL\n-from django.contrib.gis.geos import GEOSGeometry\n+from django.contrib.gis.gdal import HAS_GDAL, HAS_SPATIALREFSYS\n from django.utils import unittest\n \n \n-@unittest.skipUnless(HAS_GDAL, \"GeometryFieldTest needs gdal support\")\n+if HAS_SPATIALREFSYS:\n+    from django.contrib.gis import forms\n+    from django.contrib.gis.geos import GEOSGeometry\n+\n+@unittest.skipUnless(HAS_GDAL and HAS_SPATIALREFSYS, \"GeometryFieldTest needs gdal support and a spatial database\")\n class GeometryFieldTest(unittest.TestCase):\n \n     def test00_init(self):"
        },
        {
            "sha": "47e406066af0c9c15ea6de1d592d35c6b2cfbf83",
            "filename": "django/contrib/gis/tests/test_spatialrefsys.py",
            "status": "modified",
            "additions": 1,
            "deletions": 11,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/1794e36fa1facef40638f59012c2dac4ac4fa261/django%2Fcontrib%2Fgis%2Ftests%2Ftest_spatialrefsys.py",
            "raw_url": "https://github.com/django/django/raw/1794e36fa1facef40638f59012c2dac4ac4fa261/django%2Fcontrib%2Fgis%2Ftests%2Ftest_spatialrefsys.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Ftest_spatialrefsys.py?ref=1794e36fa1facef40638f59012c2dac4ac4fa261",
            "patch": "@@ -1,5 +1,5 @@\n from django.db import connection\n-from django.contrib.gis.gdal import HAS_GDAL\n+from django.contrib.gis.gdal import HAS_GDAL, HAS_SPATIALREFSYS, SpatialRefSys\n from django.contrib.gis.tests.utils import no_mysql, oracle, postgis, spatialite\n from django.utils import unittest\n \n@@ -28,16 +28,6 @@\n              },\n             )\n \n-HAS_SPATIALREFSYS = True\n-if oracle:\n-    from django.contrib.gis.db.backends.oracle.models import SpatialRefSys\n-elif postgis:\n-    from django.contrib.gis.db.backends.postgis.models import SpatialRefSys\n-elif spatialite:\n-    from django.contrib.gis.db.backends.spatialite.models import SpatialRefSys\n-else:\n-    HAS_SPATIALREFSYS = False\n-\n @unittest.skipUnless(HAS_GDAL and HAS_SPATIALREFSYS,\n     \"SpatialRefSysTest needs gdal support and a spatial database\")\n class SpatialRefSysTest(unittest.TestCase):"
        }
    ],
    "stats": {
        "total": 46,
        "additions": 25,
        "deletions": 21
    }
}