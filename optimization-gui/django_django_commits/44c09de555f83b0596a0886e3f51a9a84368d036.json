{
    "author": "claudep",
    "message": "Fixed #18678 -- HttpResponse init arguments allowed for subclasses\n\nThanks hp1337@gmail.com for the report.",
    "sha": "44c09de555f83b0596a0886e3f51a9a84368d036",
    "files": [
        {
            "sha": "c6f104695d0c1f36b28744f866380e96e17fd058",
            "filename": "django/http/__init__.py",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/44c09de555f83b0596a0886e3f51a9a84368d036/django%2Fhttp%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/44c09de555f83b0596a0886e3f51a9a84368d036/django%2Fhttp%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fhttp%2F__init__.py?ref=44c09de555f83b0596a0886e3f51a9a84368d036",
            "patch": "@@ -728,11 +728,11 @@ def tell(self):\n class HttpResponseRedirectBase(HttpResponse):\n     allowed_schemes = ['http', 'https', 'ftp']\n \n-    def __init__(self, redirect_to):\n+    def __init__(self, redirect_to, *args, **kwargs):\n         parsed = urlparse(redirect_to)\n         if parsed.scheme and parsed.scheme not in self.allowed_schemes:\n             raise SuspiciousOperation(\"Unsafe redirect to URL with protocol '%s'\" % parsed.scheme)\n-        super(HttpResponseRedirectBase, self).__init__()\n+        super(HttpResponseRedirectBase, self).__init__(*args, **kwargs)\n         self['Location'] = iri_to_uri(redirect_to)\n \n class HttpResponseRedirect(HttpResponseRedirectBase):\n@@ -766,8 +766,8 @@ class HttpResponseForbidden(HttpResponse):\n class HttpResponseNotAllowed(HttpResponse):\n     status_code = 405\n \n-    def __init__(self, permitted_methods):\n-        super(HttpResponseNotAllowed, self).__init__()\n+    def __init__(self, permitted_methods, *args, **kwargs):\n+        super(HttpResponseNotAllowed, self).__init__(*args, **kwargs)\n         self['Allow'] = ', '.join(permitted_methods)\n \n class HttpResponseGone(HttpResponse):"
        },
        {
            "sha": "21e99de10d93765d80319eb8e9a41fdba10cd54b",
            "filename": "docs/ref/request-response.txt",
            "status": "modified",
            "additions": 8,
            "deletions": 6,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/44c09de555f83b0596a0886e3f51a9a84368d036/docs%2Fref%2Frequest-response.txt",
            "raw_url": "https://github.com/django/django/raw/44c09de555f83b0596a0886e3f51a9a84368d036/docs%2Fref%2Frequest-response.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Frequest-response.txt?ref=44c09de555f83b0596a0886e3f51a9a84368d036",
            "patch": "@@ -731,10 +731,11 @@ types of HTTP responses. Like ``HttpResponse``, these subclasses live in\n \n .. class:: HttpResponseRedirect\n \n-    The constructor takes a single argument -- the path to redirect to. This\n-    can be a fully qualified URL (e.g. ``'http://www.yahoo.com/search/'``) or\n-    an absolute path with no domain (e.g. ``'/search/'``). Note that this\n-    returns an HTTP status code 302.\n+    The first argument to the constructor is required -- the path to redirect\n+    to. This can be a fully qualified URL\n+    (e.g. ``'http://www.yahoo.com/search/'``) or an absolute path with no\n+    domain (e.g. ``'/search/'``). See :class:`HttpResponse` for other optional\n+    constructor arguments. Note that this returns an HTTP status code 302.\n \n .. class:: HttpResponsePermanentRedirect\n \n@@ -761,8 +762,9 @@ types of HTTP responses. Like ``HttpResponse``, these subclasses live in\n \n .. class:: HttpResponseNotAllowed\n \n-    Like :class:`HttpResponse`, but uses a 405 status code. Takes a single,\n-    required argument: a list of permitted methods (e.g. ``['GET', 'POST']``).\n+    Like :class:`HttpResponse`, but uses a 405 status code. The first argument\n+    to the constructor is required: a list of permitted methods (e.g.\n+    ``['GET', 'POST']``).\n \n .. class:: HttpResponseGone\n "
        },
        {
            "sha": "21ba198bc38a8bb24a244e5fd74d2f5775be3e8a",
            "filename": "tests/regressiontests/httpwrappers/tests.py",
            "status": "modified",
            "additions": 21,
            "deletions": 2,
            "changes": 23,
            "blob_url": "https://github.com/django/django/blob/44c09de555f83b0596a0886e3f51a9a84368d036/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/44c09de555f83b0596a0886e3f51a9a84368d036/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py?ref=44c09de555f83b0596a0886e3f51a9a84368d036",
            "patch": "@@ -6,9 +6,11 @@\n \n from django.core.exceptions import SuspiciousOperation\n from django.http import (QueryDict, HttpResponse, HttpResponseRedirect,\n-                         HttpResponsePermanentRedirect, HttpResponseNotModified,\n+                         HttpResponsePermanentRedirect, HttpResponseNotAllowed,\n+                         HttpResponseNotModified,\n                          SimpleCookie, BadHeaderError,\n                          parse_cookie)\n+from django.test import TestCase\n from django.utils import six\n from django.utils import unittest\n \n@@ -330,7 +332,16 @@ def test_unsafe_redirect(self):\n                               HttpResponsePermanentRedirect, url)\n \n \n-class HttpResponseSubclassesTests(unittest.TestCase):\n+class HttpResponseSubclassesTests(TestCase):\n+    def test_redirect(self):\n+        response = HttpResponseRedirect('/redirected/')\n+        self.assertEqual(response.status_code, 302)\n+        # Test that standard HttpResponse init args can be used\n+        response = HttpResponseRedirect('/redirected/',\n+            content='The resource has temporarily moved',\n+            content_type='text/html')\n+        self.assertContains(response, 'The resource has temporarily moved', status_code=302)\n+\n     def test_not_modified(self):\n         response = HttpResponseNotModified()\n         self.assertEqual(response.status_code, 304)\n@@ -339,6 +350,14 @@ def test_not_modified(self):\n             response.content = \"Hello dear\"\n         self.assertNotIn('content-type', response)\n \n+    def test_not_allowed(self):\n+        response = HttpResponseNotAllowed(['GET'])\n+        self.assertEqual(response.status_code, 405)\n+        # Test that standard HttpResponse init args can be used\n+        response = HttpResponseNotAllowed(['GET'],\n+            content='Only the GET method is allowed',\n+            content_type='text/html')\n+        self.assertContains(response, 'Only the GET method is allowed', status_code=405)\n \n class CookieTests(unittest.TestCase):\n     def test_encode(self):"
        }
    ],
    "stats": {
        "total": 45,
        "additions": 33,
        "deletions": 12
    }
}