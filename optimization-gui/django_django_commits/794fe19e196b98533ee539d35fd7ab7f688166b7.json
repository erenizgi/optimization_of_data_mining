{
    "author": "jphalip",
    "message": "Made the Selenium tests for the admin horizontal/vertical filter widgets a bit more thorough.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17649 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "794fe19e196b98533ee539d35fd7ab7f688166b7",
    "files": [
        {
            "sha": "94ee5a9fe9d493d273008c7586feba784f7282ea",
            "filename": "tests/regressiontests/admin_widgets/tests.py",
            "status": "modified",
            "additions": 25,
            "deletions": 5,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/794fe19e196b98533ee539d35fd7ab7f688166b7/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/794fe19e196b98533ee539d35fd7ab7f688166b7/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py?ref=794fe19e196b98533ee539d35fd7ab7f688166b7",
            "patch": "@@ -624,7 +624,8 @@ def test_filter(self):\n         for field_name in ['students', 'alumni']:\n             from_box = '#id_%s_from' % field_name\n             to_box = '#id_%s_to' % field_name\n-            choose_link = 'id_%s_add_link' % field_name\n+            choose_link = '#id_%s_add_link' % field_name\n+            remove_link = '#id_%s_remove_link' % field_name\n             input = self.selenium.find_element_by_css_selector('#id_%s_input' % field_name)\n \n             # Initial values\n@@ -648,21 +649,40 @@ def test_filter(self):\n                          str(self.cliff.id), str(self.jason.id),\n                          str(self.jenny.id), str(self.john.id)])\n \n+            # -----------------------------------------------------------------\n             # Check that chosing a filtered option sends it properly to the\n             # 'to' box.\n             input.send_keys('a')\n             self.assertSelectOptions(from_box, [str(self.arthur.id), str(self.jason.id)])\n             self.get_select_option(from_box, str(self.jason.id)).click()\n-            self.selenium.find_element_by_id(choose_link).click()\n+            self.selenium.find_element_by_css_selector(choose_link).click()\n             self.assertSelectOptions(from_box, [str(self.arthur.id)])\n+            self.assertSelectOptions(to_box,\n+                        [str(self.lisa.id), str(self.peter.id),\n+                         str(self.jason.id)])\n+\n+            self.get_select_option(to_box, str(self.lisa.id)).click()\n+            self.selenium.find_element_by_css_selector(remove_link).click()\n+            self.assertSelectOptions(from_box,\n+                        [str(self.arthur.id), str(self.lisa.id)])\n+            self.assertSelectOptions(to_box,\n+                        [str(self.peter.id), str(self.jason.id)])\n+\n             input.send_keys([Keys.BACK_SPACE]) # Clear text box\n             self.assertSelectOptions(from_box,\n                         [str(self.arthur.id), str(self.bob.id),\n                          str(self.cliff.id), str(self.jenny.id),\n-                         str(self.john.id)])\n+                         str(self.john.id), str(self.lisa.id)])\n             self.assertSelectOptions(to_box,\n-                        [str(self.lisa.id), str(self.peter.id),\n-                         str(self.jason.id)])\n+                        [str(self.peter.id), str(self.jason.id)])\n+\n+        # Save and check that everything is properly stored in the database ---\n+        self.selenium.find_element_by_xpath('//input[@value=\"Save\"]').click()\n+        self.school = models.School.objects.get(id=self.school.id) # Reload from database\n+        self.assertEqual(list(self.school.students.all()),\n+                         [self.jason, self.peter])\n+        self.assertEqual(list(self.school.alumni.all()),\n+                         [self.jason, self.peter])\n \n class HorizontalVerticalFilterSeleniumChromeTests(HorizontalVerticalFilterSeleniumFirefoxTests):\n     webdriver_class = 'selenium.webdriver.chrome.webdriver.WebDriver'\n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 30,
        "additions": 25,
        "deletions": 5
    }
}