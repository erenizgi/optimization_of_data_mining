{
    "author": "claudep",
    "message": "Fixed #19020 -- Do not depend on dict order in formtools tests\n\nThanks metzen for the report and initial patch, and ≈Åukasz Rekucki\nfor an inspirational patch on his randomhash_fixes branch.",
    "sha": "1f84b042f1c3fab0f806de814d668917dd86236a",
    "files": [
        {
            "sha": "a21ffde533a58b94aa630420674442b4bc49c467",
            "filename": "django/contrib/formtools/tests/__init__.py",
            "status": "modified",
            "additions": 5,
            "deletions": 7,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/1f84b042f1c3fab0f806de814d668917dd86236a/django%2Fcontrib%2Fformtools%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/1f84b042f1c3fab0f806de814d668917dd86236a/django%2Fcontrib%2Fformtools%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Ftests%2F__init__.py?ref=1f84b042f1c3fab0f806de814d668917dd86236a",
            "patch": "@@ -12,6 +12,7 @@\n from django.contrib.formtools import preview, utils\n from django.contrib.formtools.wizard import FormWizard\n from django.test import TestCase\n+from django.test.html import parse_html\n from django.test.utils import override_settings\n from django.utils import unittest\n \n@@ -218,7 +219,6 @@ def __init__(self, POST=None):\n )\n class WizardTests(TestCase):\n     urls = 'django.contrib.formtools.tests.urls'\n-    input_re = re.compile('name=\"([^\"]+)\" value=\"([^\"]+)\"')\n     wizard_step_data = (\n         {\n             '0-name': 'Pony',\n@@ -409,14 +409,13 @@ def grab_field_data(self, response):\n         \"\"\"\n         Pull the appropriate field data from the context to pass to the next wizard step\n         \"\"\"\n-        previous_fields = response.context['previous_fields']\n+        previous_fields = parse_html(response.context['previous_fields'])\n         fields = {'wizard_step': response.context['step0']}\n \n-        def grab(m):\n-            fields[m.group(1)] = m.group(2)\n-            return ''\n+        for input_field in previous_fields:\n+            input_attrs = dict(input_field.attributes)\n+            fields[input_attrs[\"name\"]] = input_attrs[\"value\"]\n \n-        self.input_re.sub(grab, previous_fields)\n         return fields\n \n     def check_wizard_step(self, response, step_no):\n@@ -428,7 +427,6 @@ def check_wizard_step(self, response, step_no):\n         \"\"\"\n         step_count = len(self.wizard_step_data)\n \n-        self.assertEqual(response.status_code, 200)\n         self.assertContains(response, 'Step %d of %d' % (step_no, step_count))\n \n         data = self.grab_field_data(response)"
        },
        {
            "sha": "d450f478614c29567e750592f23fbb2b40c3bad0",
            "filename": "django/contrib/formtools/tests/wizard/cookiestorage.py",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/1f84b042f1c3fab0f806de814d668917dd86236a/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fcookiestorage.py",
            "raw_url": "https://github.com/django/django/raw/1f84b042f1c3fab0f806de814d668917dd86236a/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fcookiestorage.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fcookiestorage.py?ref=1f84b042f1c3fab0f806de814d668917dd86236a",
            "patch": "@@ -1,3 +1,5 @@\n+import json\n+\n from django.test import TestCase\n from django.core import signing\n from django.core.exceptions import SuspiciousOperation\n@@ -41,4 +43,5 @@ def test_reset_cookie(self):\n         storage.init_data()\n         storage.update_response(response)\n         unsigned_cookie_data = cookie_signer.unsign(response.cookies[storage.prefix].value)\n-        self.assertEqual(unsigned_cookie_data, '{\"step_files\":{},\"step\":null,\"extra_data\":{},\"step_data\":{}}')\n+        self.assertEqual(json.loads(unsigned_cookie_data),\n+            {\"step_files\": {}, \"step\": None, \"extra_data\": {}, \"step_data\": {}})"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 9,
        "deletions": 8
    }
}