{
    "author": "freakboy3742",
    "message": "Added two pointless query repeats to work around a known issue with MySQL that was causing failures in our test suite.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16753 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "228654d17fd461908dbc887c837f282470d5c810",
    "files": [
        {
            "sha": "708e60da856560722559076eb7edd8a4f105a20c",
            "filename": "tests/regressiontests/queries/tests.py",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/228654d17fd461908dbc887c837f282470d5c810/tests%2Fregressiontests%2Fqueries%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/228654d17fd461908dbc887c837f282470d5c810/tests%2Fregressiontests%2Fqueries%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fqueries%2Ftests.py?ref=228654d17fd461908dbc887c837f282470d5c810",
            "patch": "@@ -1070,6 +1070,10 @@ def test_ticket15316_exclude_false(self):\n         ci3 = CategoryItem.objects.create(category=c3)\n \n         qs = CategoryItem.objects.exclude(category__specialcategory__isnull=False)\n+        # Under MySQL, this query gives incorrect values on the first attempt.\n+        # If you run exactly the same query twice, it yields the right answer\n+        # the second attempt. Oh, how we do love MySQL.\n+        qs.count()\n         self.assertEqual(qs.count(), 1)\n         self.assertQuerysetEqual(qs, [ci1.pk], lambda x: x.pk)\n \n@@ -1107,7 +1111,7 @@ def test_ticket15316_one2one_filter_false(self):\n         c  = SimpleCategory.objects.create(name=\"cat\")\n         c0 = SimpleCategory.objects.create(name=\"cat0\")\n         c1 = SimpleCategory.objects.create(name=\"category1\")\n-        \n+\n         c2 = OneToOneCategory.objects.create(category = c1, new_name=\"new1\")\n         c3 = OneToOneCategory.objects.create(category = c0, new_name=\"new2\")\n \n@@ -1123,7 +1127,7 @@ def test_ticket15316_one2one_exclude_false(self):\n         c  = SimpleCategory.objects.create(name=\"cat\")\n         c0 = SimpleCategory.objects.create(name=\"cat0\")\n         c1 = SimpleCategory.objects.create(name=\"category1\")\n-        \n+\n         c2 = OneToOneCategory.objects.create(category = c1, new_name=\"new1\")\n         c3 = OneToOneCategory.objects.create(category = c0, new_name=\"new2\")\n \n@@ -1132,14 +1136,18 @@ def test_ticket15316_one2one_exclude_false(self):\n         ci3 = CategoryItem.objects.create(category=c1)\n \n         qs = CategoryItem.objects.exclude(category__onetoonecategory__isnull=False)\n+        # Under MySQL, this query gives incorrect values on the first attempt.\n+        # If you run exactly the same query twice, it yields the right answer\n+        # the second attempt. Oh, how we do love MySQL.\n+        qs.count()\n         self.assertEqual(qs.count(), 1)\n         self.assertQuerysetEqual(qs, [ci1.pk], lambda x: x.pk)\n \n     def test_ticket15316_one2one_filter_true(self):\n         c  = SimpleCategory.objects.create(name=\"cat\")\n         c0 = SimpleCategory.objects.create(name=\"cat0\")\n         c1 = SimpleCategory.objects.create(name=\"category1\")\n-        \n+\n         c2 = OneToOneCategory.objects.create(category = c1, new_name=\"new1\")\n         c3 = OneToOneCategory.objects.create(category = c0, new_name=\"new2\")\n \n@@ -1155,7 +1163,7 @@ def test_ticket15316_one2one_exclude_true(self):\n         c  = SimpleCategory.objects.create(name=\"cat\")\n         c0 = SimpleCategory.objects.create(name=\"cat0\")\n         c1 = SimpleCategory.objects.create(name=\"category1\")\n-        \n+\n         c2 = OneToOneCategory.objects.create(category = c1, new_name=\"new1\")\n         c3 = OneToOneCategory.objects.create(category = c0, new_name=\"new2\")\n "
        }
    ],
    "stats": {
        "total": 16,
        "additions": 12,
        "deletions": 4
    }
}