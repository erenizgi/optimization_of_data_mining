{
    "author": "aaugustin",
    "message": "Tweak a test to avoid hitting a limit with SQLite.\n\nDjango cannot delete more than 999 objects at a time with SQLite.\n\nRefs #16426, #16039.",
    "sha": "2875b5dcab23c027d019656b08da8b911bc60711",
    "files": [
        {
            "sha": "a903ea11a00ae1825ab4b0aa8be4082dceebe77e",
            "filename": "tests/regressiontests/multiple_database/tests.py",
            "status": "modified",
            "additions": 9,
            "deletions": 6,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/2875b5dcab23c027d019656b08da8b911bc60711/tests%2Fregressiontests%2Fmultiple_database%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/2875b5dcab23c027d019656b08da8b911bc60711/tests%2Fregressiontests%2Fmultiple_database%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmultiple_database%2Ftests.py?ref=2875b5dcab23c027d019656b08da8b911bc60711",
            "patch": "@@ -1912,18 +1912,21 @@ class SyncDBTestCase(TestCase):\n \n     def test_syncdb_to_other_database(self):\n         \"\"\"Regression test for #16039: syncdb with --database option.\"\"\"\n-        count = ContentType.objects.count()\n+        cts = ContentType.objects.using('other').filter(app_label='multiple_database')\n+\n+        count = cts.count()\n         self.assertGreater(count, 0)\n \n-        ContentType.objects.using('other').delete()\n+        cts.delete()\n         management.call_command('syncdb', verbosity=0, interactive=False,\n             load_initial_data=False, database='other')\n-\n-        self.assertEqual(ContentType.objects.using(\"other\").count(), count)\n+        self.assertEqual(cts.count(), count)\n \n     def test_syncdb_to_other_database_with_router(self):\n         \"\"\"Regression test for #16039: syncdb with --database option.\"\"\"\n-        ContentType.objects.using('other').delete()\n+        cts = ContentType.objects.using('other').filter(app_label='multiple_database')\n+\n+        cts.delete()\n         try:\n             old_routers = router.routers\n             router.routers = [SyncOnlyDefaultDatabaseRouter()]\n@@ -1932,4 +1935,4 @@ def test_syncdb_to_other_database_with_router(self):\n         finally:\n             router.routers = old_routers\n \n-        self.assertEqual(ContentType.objects.using(\"other\").count(), 0)\n+        self.assertEqual(cts.count(), 0)"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 9,
        "deletions": 6
    }
}