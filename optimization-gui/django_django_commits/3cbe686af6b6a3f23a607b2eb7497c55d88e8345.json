{
    "author": "claudep",
    "message": "Fixed #18675 -- Fixed was_modified_since with floating-point mtime\n\nThanks Simon Charette for the patch.",
    "sha": "3cbe686af6b6a3f23a607b2eb7497c55d88e8345",
    "files": [
        {
            "sha": "7dd44c5772c30f4e48b4f9566e8181e0ce9021e6",
            "filename": "django/views/static.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/3cbe686af6b6a3f23a607b2eb7497c55d88e8345/django%2Fviews%2Fstatic.py",
            "raw_url": "https://github.com/django/django/raw/3cbe686af6b6a3f23a607b2eb7497c55d88e8345/django%2Fviews%2Fstatic.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fviews%2Fstatic.py?ref=3cbe686af6b6a3f23a607b2eb7497c55d88e8345",
            "patch": "@@ -138,7 +138,7 @@ def was_modified_since(header=None, mtime=0, size=0):\n         header_len = matches.group(3)\n         if header_len and int(header_len) != size:\n             raise ValueError\n-        if mtime > header_mtime:\n+        if int(mtime) > header_mtime:\n             raise ValueError\n     except (AttributeError, ValueError, OverflowError):\n         return True"
        },
        {
            "sha": "12d0c59014a8f9d827e9514931ba4058e32ce3c4",
            "filename": "tests/regressiontests/views/tests/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/3cbe686af6b6a3f23a607b2eb7497c55d88e8345/tests%2Fregressiontests%2Fviews%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/3cbe686af6b6a3f23a607b2eb7497c55d88e8345/tests%2Fregressiontests%2Fviews%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2F__init__.py?ref=3cbe686af6b6a3f23a607b2eb7497c55d88e8345",
            "patch": "@@ -7,4 +7,4 @@\n from .i18n import JsI18NTests, I18NTests, JsI18NTestsMultiPackage\n from .shortcuts import ShortcutTests\n from .specials import URLHandling\n-from .static import StaticHelperTest, StaticTests\n+from .static import StaticHelperTest, StaticUtilsTests, StaticTests"
        },
        {
            "sha": "38cf38ce467613d110f09cbb5d66738ccf34d66d",
            "filename": "tests/regressiontests/views/tests/static.py",
            "status": "modified",
            "additions": 15,
            "deletions": 1,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/3cbe686af6b6a3f23a607b2eb7497c55d88e8345/tests%2Fregressiontests%2Fviews%2Ftests%2Fstatic.py",
            "raw_url": "https://github.com/django/django/raw/3cbe686af6b6a3f23a607b2eb7497c55d88e8345/tests%2Fregressiontests%2Fviews%2Ftests%2Fstatic.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2Fstatic.py?ref=3cbe686af6b6a3f23a607b2eb7497c55d88e8345",
            "patch": "@@ -2,11 +2,14 @@\n \n import mimetypes\n from os import path\n+import unittest\n \n from django.conf import settings\n from django.conf.urls.static import static\n-from django.test import TestCase\n from django.http import HttpResponseNotModified\n+from django.test import TestCase\n+from django.utils.http import http_date\n+from django.views.static import was_modified_since\n \n from .. import urls\n from ..urls import media_dir\n@@ -105,3 +108,14 @@ def setUp(self):\n     def tearDown(self):\n         super(StaticHelperTest, self).tearDown()\n         urls.urlpatterns = self._old_views_urlpatterns\n+\n+\n+class StaticUtilsTests(unittest.TestCase):\n+    def test_was_modified_since_fp(self):\n+        \"\"\"\n+        Test that a floating point mtime does not disturb was_modified_since.\n+        (#18675)\n+        \"\"\"\n+        mtime = 1343416141.107817\n+        header = http_date(mtime)\n+        self.assertFalse(was_modified_since(header, mtime))"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 17,
        "deletions": 3
    }
}