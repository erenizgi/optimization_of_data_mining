{
    "author": "aaugustin",
    "message": "Added tests for conditional_content_removal.\n\nRefs #7581. Thanks mrmachine.",
    "sha": "5e629a015e96a5564a0b0a273e1374b9651ce8e9",
    "files": [
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "tests/regressiontests/http_utils/__init__.py",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/5e629a015e96a5564a0b0a273e1374b9651ce8e9/tests%2Fregressiontests%2Fhttp_utils%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/5e629a015e96a5564a0b0a273e1374b9651ce8e9/tests%2Fregressiontests%2Fhttp_utils%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fhttp_utils%2F__init__.py?ref=5e629a015e96a5564a0b0a273e1374b9651ce8e9"
        },
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "tests/regressiontests/http_utils/models.py",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/5e629a015e96a5564a0b0a273e1374b9651ce8e9/tests%2Fregressiontests%2Fhttp_utils%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/5e629a015e96a5564a0b0a273e1374b9651ce8e9/tests%2Fregressiontests%2Fhttp_utils%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fhttp_utils%2Fmodels.py?ref=5e629a015e96a5564a0b0a273e1374b9651ce8e9"
        },
        {
            "sha": "7dfd24d721bceb0f7d701f176405afd264c4fe2d",
            "filename": "tests/regressiontests/http_utils/tests.py",
            "status": "added",
            "additions": 45,
            "deletions": 0,
            "changes": 45,
            "blob_url": "https://github.com/django/django/blob/5e629a015e96a5564a0b0a273e1374b9651ce8e9/tests%2Fregressiontests%2Fhttp_utils%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/5e629a015e96a5564a0b0a273e1374b9651ce8e9/tests%2Fregressiontests%2Fhttp_utils%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fhttp_utils%2Ftests.py?ref=5e629a015e96a5564a0b0a273e1374b9651ce8e9",
            "patch": "@@ -0,0 +1,45 @@\n+from __future__ import unicode_literals\n+\n+from django.http import HttpRequest, HttpResponse, StreamingHttpResponse\n+from django.http.utils import conditional_content_removal\n+from django.test import TestCase\n+\n+\n+class HttpUtilTests(TestCase):\n+\n+    def test_conditional_content_removal(self):\n+        \"\"\"\n+        Tests that content is removed from regular and streaming responses with\n+        a status_code of 100-199, 204, 304 or a method of \"HEAD\".\n+        \"\"\"\n+        req = HttpRequest()\n+\n+        # Do nothing for 200 responses.\n+        res = HttpResponse('abc')\n+        conditional_content_removal(req, res)\n+        self.assertEqual(res.content, b'abc')\n+\n+        res = StreamingHttpResponse(['abc'])\n+        conditional_content_removal(req, res)\n+        self.assertEqual(b''.join(res), b'abc')\n+\n+        # Strip content for some status codes.\n+        for status_code in (100, 150, 199, 204, 304):\n+            res = HttpResponse('abc', status=status_code)\n+            conditional_content_removal(req, res)\n+            self.assertEqual(res.content, b'')\n+\n+            res = StreamingHttpResponse(['abc'], status=status_code)\n+            conditional_content_removal(req, res)\n+            self.assertEqual(b''.join(res), b'')\n+\n+        # Strip content for HEAD requests.\n+        req.method = 'HEAD'\n+\n+        res = HttpResponse('abc')\n+        conditional_content_removal(req, res)\n+        self.assertEqual(res.content, b'')\n+\n+        res = StreamingHttpResponse(['abc'])\n+        conditional_content_removal(req, res)\n+        self.assertEqual(b''.join(res), b'')"
        }
    ],
    "stats": {
        "total": 45,
        "additions": 45,
        "deletions": 0
    }
}