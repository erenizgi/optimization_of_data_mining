{
    "author": "claudep",
    "message": "Fixed #17448 -- Improved test and documented raw-sql gis query",
    "sha": "62e1c5a441d957e44d7527a6d901587b40203a51",
    "files": [
        {
            "sha": "fbe30e884101dae3a0f76b18a18a7e0a4f27ebbb",
            "filename": "django/contrib/gis/tests/geoapp/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/62e1c5a441d957e44d7527a6d901587b40203a51/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/62e1c5a441d957e44d7527a6d901587b40203a51/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftests.py?ref=62e1c5a441d957e44d7527a6d901587b40203a51",
            "patch": "@@ -189,7 +189,9 @@ def test_inherited_geofields(self):\n     def test_raw_sql_query(self):\n         \"Testing raw SQL query.\"\n         cities1 = City.objects.all()\n-        cities2 = City.objects.raw('select * from geoapp_city')\n+        # Only PostGIS would support a 'select *' query because of its recognized\n+        # HEXEWKB format for geometry fields\n+        cities2 = City.objects.raw('select id, name, asText(point) from geoapp_city')\n         self.assertEqual(len(cities1), len(list(cities2)))\n         self.assertTrue(isinstance(cities2[0].point, Point))\n "
        },
        {
            "sha": "15863aee7b6dd461eebded22c7e68e42d1de5c85",
            "filename": "docs/ref/contrib/gis/tutorial.txt",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/62e1c5a441d957e44d7527a6d901587b40203a51/docs%2Fref%2Fcontrib%2Fgis%2Ftutorial.txt",
            "raw_url": "https://github.com/django/django/raw/62e1c5a441d957e44d7527a6d901587b40203a51/docs%2Fref%2Fcontrib%2Fgis%2Ftutorial.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fgis%2Ftutorial.txt?ref=62e1c5a441d957e44d7527a6d901587b40203a51",
            "patch": "@@ -671,6 +671,17 @@ of abstraction::\n \n __ http://spatialreference.org/ref/epsg/32140/\n \n+.. admonition:: Raw queries\n+\n+    When using :doc:`raw queries </topics/db/sql>`, you should generally wrap\n+    your geometry fields with the ``asText()`` SQL function so as the field\n+    value will be recognized by GEOS::\n+\n+        City.objects.raw('SELECT id, name, asText(point) from myapp_city')\n+\n+    This is not absolutely required by PostGIS, but generally you should only\n+    use raw queries when you know exactly what you are doing.\n+\n Lazy Geometries\n ---------------\n Geometries come to GeoDjango in a standardized textual representation.  Upon"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 14,
        "deletions": 1
    }
}