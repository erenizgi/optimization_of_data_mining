{
    "author": "akaariai",
    "message": "Made Query.clear_ordering force_empty arg mandatory\n\nPreviously it was possible to call clear_ordering without the\nforce_empty argument. The result was that the query was still ordered\nby model's meta ordering if that was defined. By making the arg\nmandatory it will be easier to spot possible errors caused by assuming\nclear_ordering will remove all ordering.\n\nThanks to Dylan Klomparens for the suggestion. Refs #19720.",
    "sha": "5cc0f5f8c1f35218ee4bce2d8c943a86f1888b96",
    "files": [
        {
            "sha": "87bc6205a8850d89d0620ac7d584caa67f7287a6",
            "filename": "django/db/models/query.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/5cc0f5f8c1f35218ee4bce2d8c943a86f1888b96/django%2Fdb%2Fmodels%2Fquery.py",
            "raw_url": "https://github.com/django/django/raw/5cc0f5f8c1f35218ee4bce2d8c943a86f1888b96/django%2Fdb%2Fmodels%2Fquery.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fquery.py?ref=5cc0f5f8c1f35218ee4bce2d8c943a86f1888b96",
            "patch": "@@ -500,7 +500,7 @@ def _earliest_or_latest(self, field_name=None, direction=\"-\"):\n             \"Cannot change a query once a slice has been taken.\"\n         obj = self._clone()\n         obj.query.set_limits(high=1)\n-        obj.query.clear_ordering()\n+        obj.query.clear_ordering(force_empty=True)\n         obj.query.add_ordering('%s%s' % (direction, order_by))\n         return obj.get()\n \n@@ -793,7 +793,7 @@ def order_by(self, *field_names):\n         assert self.query.can_filter(), \\\n                 \"Cannot reorder a query once a slice has been taken.\"\n         obj = self._clone()\n-        obj.query.clear_ordering()\n+        obj.query.clear_ordering(force_empty=False)\n         obj.query.add_ordering(*field_names)\n         return obj\n "
        },
        {
            "sha": "fb0f09efded2dfbb45e9b9862fbe279832408e84",
            "filename": "django/db/models/sql/query.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/5cc0f5f8c1f35218ee4bce2d8c943a86f1888b96/django%2Fdb%2Fmodels%2Fsql%2Fquery.py",
            "raw_url": "https://github.com/django/django/raw/5cc0f5f8c1f35218ee4bce2d8c943a86f1888b96/django%2Fdb%2Fmodels%2Fsql%2Fquery.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fsql%2Fquery.py?ref=5cc0f5f8c1f35218ee4bce2d8c943a86f1888b96",
            "patch": "@@ -1638,7 +1638,7 @@ def add_ordering(self, *ordering):\n         else:\n             self.default_ordering = False\n \n-    def clear_ordering(self, force_empty=False):\n+    def clear_ordering(self, force_empty):\n         \"\"\"\n         Removes any ordering settings. If 'force_empty' is True, there will be\n         no ordering in the resulting query (not even the model's default)."
        }
    ],
    "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
    }
}