{
    "author": "jphalip",
    "message": "Fixed a couple of `assert` syntax warnings mistakingly introduced in r16966 and added some tests to prevent future regressions. Thanks to Anssi Kääriäinen for the report.\nRefs #12467.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16971 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e",
    "files": [
        {
            "sha": "67acbbae762b0b98dc014a699c7f215108d14df2",
            "filename": "django/db/models/fields/__init__.py",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e/django%2Fdb%2Fmodels%2Ffields%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e/django%2Fdb%2Fmodels%2Ffields%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Ffields%2F__init__.py?ref=c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e",
            "patch": "@@ -510,8 +510,8 @@ class AutoField(Field):\n         'invalid': _(u\"'%s' value must be an integer.\"),\n     }\n     def __init__(self, *args, **kwargs):\n-        assert (kwargs.get('primary_key', False) is True,\n-                \"%ss must have primary_key=True.\" % self.__class__.__name__)\n+        assert kwargs.get('primary_key', False) is True, \\\n+               \"%ss must have primary_key=True.\" % self.__class__.__name__\n         kwargs['blank'] = True\n         Field.__init__(self, *args, **kwargs)\n \n@@ -536,8 +536,8 @@ def get_prep_value(self, value):\n         return int(value)\n \n     def contribute_to_class(self, cls, name):\n-        assert (not cls._meta.has_auto_field,\n-                \"A model can't have more than one AutoField.\")\n+        assert not cls._meta.has_auto_field, \\\n+               \"A model can't have more than one AutoField.\"\n         super(AutoField, self).contribute_to_class(cls, name)\n         cls._meta.has_auto_field = True\n         cls._meta.auto_field = self"
        },
        {
            "sha": "182e739daf3df1f027c9ceddc2dde08e1048264b",
            "filename": "tests/modeltests/validation/models.py",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e/tests%2Fmodeltests%2Fvalidation%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e/tests%2Fmodeltests%2Fvalidation%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fvalidation%2Fmodels.py?ref=c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e",
            "patch": "@@ -90,3 +90,13 @@ class GenericIPAddressTestModel(models.Model):\n \n class GenericIPAddrUnpackUniqueTest(models.Model):\n     generic_v4unpack_ip = models.GenericIPAddressField(blank=True, unique=True, unpack_ipv4=True)\n+\n+\n+try:\n+    # A model can't have multiple AutoFields\n+    # Refs #12467.\n+    class MultipleAutoFields(models.Model):\n+        auto1 = models.AutoField(primary_key=True)\n+        auto2 = models.AutoField(primary_key=True)\n+except AssertionError, e:\n+    assert e.message == u\"A model can't have more than one AutoField.\"\n\\ No newline at end of file"
        },
        {
            "sha": "299a93a41a02bca974a5c554263eda1bea001fda",
            "filename": "tests/modeltests/validation/test_error_messages.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e/tests%2Fmodeltests%2Fvalidation%2Ftest_error_messages.py",
            "raw_url": "https://github.com/django/django/raw/c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e/tests%2Fmodeltests%2Fvalidation%2Ftest_error_messages.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fvalidation%2Ftest_error_messages.py?ref=c58e5724bcebc74ccfbc49a4a29de6fd0fa6103e",
            "patch": "@@ -12,6 +12,12 @@ def test_autofield_field_raises_error_message(self):\n             f.clean('foo', None)\n         except ValidationError, e:\n             self.assertEqual(e.messages, [u\"'foo' value must be an integer.\"])\n+        # primary_key must be True. Refs #12467.\n+        self.assertRaises(AssertionError, models.AutoField, 'primary_key', False)\n+        try:\n+            models.AutoField(primary_key=False)\n+        except AssertionError, e:\n+            self.assertEqual(e.message, u\"AutoFields must have primary_key=True.\")\n \n     def test_integer_field_raises_error_message(self):\n         f = models.IntegerField()"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 20,
        "deletions": 4
    }
}