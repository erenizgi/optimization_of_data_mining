{
    "author": "timgraham",
    "message": "Fixed #17006 - Documented ModelAdmin get_form() and get_formsets()",
    "sha": "eed4faf16f37a8b0af06a52eada05b84dead4c0d",
    "files": [
        {
            "sha": "971db199254075d4ae2dbf0579a4b02bac3bb7b2",
            "filename": "docs/ref/contrib/admin/index.txt",
            "status": "modified",
            "additions": 37,
            "deletions": 4,
            "changes": 41,
            "blob_url": "https://github.com/django/django/blob/eed4faf16f37a8b0af06a52eada05b84dead4c0d/docs%2Fref%2Fcontrib%2Fadmin%2Findex.txt",
            "raw_url": "https://github.com/django/django/raw/eed4faf16f37a8b0af06a52eada05b84dead4c0d/docs%2Fref%2Fcontrib%2Fadmin%2Findex.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fadmin%2Findex.txt?ref=eed4faf16f37a8b0af06a52eada05b84dead4c0d",
            "patch": "@@ -307,7 +307,9 @@ subclass::\n     By default a ``ModelForm`` is dynamically created for your model. It is\n     used to create the form presented on both the add/change pages. You can\n     easily provide your own ``ModelForm`` to override any default form behavior\n-    on the add/change pages.\n+    on the add/change pages. Alternatively, you can customize the default\n+    form rather than specifying an entirely new one by using the\n+    :meth:`ModelAdmin.get_form` method.\n \n     For an example see the section `Adding custom validation to the admin`_.\n \n@@ -373,7 +375,8 @@ subclass::\n \n .. attribute:: ModelAdmin.inlines\n \n-    See :class:`InlineModelAdmin` objects below.\n+    See :class:`InlineModelAdmin` objects below as well as\n+    :meth:`ModelAdmin.get_formsets`.\n \n .. attribute:: ModelAdmin.list_display\n \n@@ -1109,6 +1112,38 @@ templates used by the :class:`ModelAdmin` views:\n \n         (r'^my_view/$', self.admin_site.admin_view(self.my_view, cacheable=True))\n \n+.. method:: ModelAdmin.get_form(self, request, obj=None, **kwargs)\n+\n+    Returns a :class:`~django.forms.ModelForm` class for use in the admin add\n+    and change views, see :meth:`add_view` and :meth:`change_view`.\n+\n+    If you wanted to hide a field from non-superusers, for example, you could\n+    override ``get_form`` as follows::\n+\n+        class MyModelAdmin(admin.ModelAdmin):\n+            def get_form(self, request, obj=None, **kwargs):\n+                self.exclude = []\n+                if not request.user.is_superuser:\n+                    self.exclude.append('field_to_hide')\n+                return super(MyModelAdmin, self).get_form(request, obj, **kwargs)\n+\n+.. method:: ModelAdmin.get_formsets(self, request, obj=None)\n+\n+    Yields :class:`InlineModelAdmin`\\s for use in admin add and change views.\n+\n+    For example if you wanted to display a particular inline only in the change\n+    view, you could override ``get_formsets`` as follows::\n+\n+        class MyModelAdmin(admin.ModelAdmin):\n+            inlines = [MyInline, SomeOtherInline]\n+\n+            def get_formsets(self, request, obj=None):\n+                for inline in self.get_inline_instances():\n+                    # hide MyInline in the add view\n+                    if isinstance(inline, MyInline) and obj is None:\n+                        continue\n+                    yield inline.get_formset(request, obj)\n+\n .. method:: ModelAdmin.formfield_for_foreignkey(self, db_field, request, **kwargs)\n \n     The ``formfield_for_foreignkey`` method on a ``ModelAdmin`` allows you to\n@@ -1423,8 +1458,6 @@ The ``InlineModelAdmin`` class adds:\n     through to ``inlineformset_factory`` when creating the formset for this\n     inline.\n \n-    .. _ref-contrib-admin-inline-extra:\n-\n .. attribute:: InlineModelAdmin.extra\n \n     This controls the number of extra forms the formset will display in"
        }
    ],
    "stats": {
        "total": 41,
        "additions": 37,
        "deletions": 4
    }
}