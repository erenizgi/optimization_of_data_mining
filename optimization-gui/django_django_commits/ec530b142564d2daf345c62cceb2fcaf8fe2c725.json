{
    "author": "timgraham",
    "message": "Fixed #16610 - Added more docs for template contexts in contrib.auth views; thanks Elvard!\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16632 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ec530b142564d2daf345c62cceb2fcaf8fe2c725",
    "files": [
        {
            "sha": "69f6fd7753545f5a864871696c23d2437cb3eba6",
            "filename": "docs/topics/auth.txt",
            "status": "modified",
            "additions": 90,
            "deletions": 29,
            "changes": 119,
            "blob_url": "https://github.com/django/django/blob/ec530b142564d2daf345c62cceb2fcaf8fe2c725/docs%2Ftopics%2Fauth.txt",
            "raw_url": "https://github.com/django/django/raw/ec530b142564d2daf345c62cceb2fcaf8fe2c725/docs%2Ftopics%2Fauth.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fauth.txt?ref=ec530b142564d2daf345c62cceb2fcaf8fe2c725",
            "patch": "@@ -943,7 +943,7 @@ includes a few other useful built-in views located in\n         * ``next_page``: The URL to redirect to after logout.\n \n         * ``template_name``: The full name of a template to display after\n-          logging the user out. This will default to\n+          logging the user out. Defaults to\n           :file:`registration/logged_out.html` if no argument is supplied.\n \n         * ``redirect_field_name``: The name of a ``GET`` field containing the\n@@ -954,14 +954,26 @@ includes a few other useful built-in views located in\n \n         * ``title``: The string \"Logged out\", localized.\n \n+        * ``site``: The current :class:`~django.contrib.sites.models.Site`,\n+          according to the :setting:`SITE_ID` setting. If you don't have the\n+          site framework installed, this will be set to an instance of\n+          :class:`~django.contrib.sites.models.RequestSite`, which derives the\n+          site name and domain from the current\n+          :class:`~django.http.HttpRequest`.\n+\n+        * ``site_name``: An alias for ``site.name``. If you don't have the site\n+          framework installed, this will be set to the value of\n+          :attr:`request.META['SERVER_NAME'] <django.http.HttpRequest.META>`.\n+          For more on sites, see :doc:`/ref/contrib/sites`.\n+\n .. function:: logout_then_login(request[, login_url])\n \n     Logs a user out, then redirects to the login page.\n \n     **Optional arguments:**\n \n-        * ``login_url``: The URL of the login page to redirect to. This will\n-          default to :setting:`settings.LOGIN_URL <LOGIN_URL>` if not supplied.\n+        * ``login_url``: The URL of the login page to redirect to.\n+          Defaults to :setting:`settings.LOGIN_URL <LOGIN_URL>` if not supplied.\n \n .. function:: password_change(request[, template_name, post_change_redirect, password_change_form])\n \n@@ -970,31 +982,31 @@ includes a few other useful built-in views located in\n     **Optional arguments:**\n \n         * ``template_name``: The full name of a template to use for\n-          displaying the password change form. This will default to\n+          displaying the password change form. Defaults to\n           :file:`registration/password_change_form.html` if not supplied.\n \n         * ``post_change_redirect``: The URL to redirect to after a successful\n           password change.\n \n-        * .. versionadded:: 1.2\n+          .. versionadded:: 1.2\n \n-          ``password_change_form``: A custom \"change password\" form which must\n+        * ``password_change_form``: A custom \"change password\" form which must\n           accept a ``user`` keyword argument. The form is responsible for\n-          actually changing the user's password.\n-\n+          actually changing the user's password. Defaults to\n+          :class:`~django.contrib.auth.forms.PasswordChangeForm`.\n \n     **Template context:**\n \n-        * ``form``: The password change form.\n+        * ``form``: The password change form (see ``password_change_form`` above).\n \n .. function:: password_change_done(request[, template_name])\n \n     The page shown after a user has changed their password.\n \n     **Optional arguments:**\n \n-        * ``template_name``: The full name of a template to use. This will\n-          default to :file:`registration/password_change_done.html` if not\n+        * ``template_name``: The full name of a template to use.\n+          Defaults to :file:`registration/password_change_done.html` if not\n           supplied.\n \n .. function:: password_reset(request[, is_admin_site, template_name, email_template_name, password_reset_form, token_generator, post_reset_redirect, from_email])\n@@ -1006,18 +1018,24 @@ includes a few other useful built-in views located in\n     .. versionchanged:: 1.3\n         The ``from_email`` argument was added.\n \n+    .. versionchanged:: 1.4\n+        Users flagged with an unusable password (see\n+        :meth:`~django.contrib.auth.models.User.set_unusable_password()`\n+        will not be able to request a password reset to prevent misuse\n+        when using an external authentication source like LDAP.\n+\n     **Optional arguments:**\n \n         * ``template_name``: The full name of a template to use for\n-          displaying the password reset form. This will default to\n+          displaying the password reset form. Defaults to\n           :file:`registration/password_reset_form.html` if not supplied.\n \n         * ``email_template_name``: The full name of a template to use for\n-          generating the email with the new password. This will default to\n+          generating the email with the new password. Defaults to\n           :file:`registration/password_reset_email.html` if not supplied.\n \n         * ``subject_template_name``: The full name of a template to use for\n-          the subject of the email with the new password. This will default\n+          the subject of the email with the new password. Defaults\n           to :file:`registration/password_reset_subject.txt` if not supplied.\n \n           .. versionadded:: 1.4\n@@ -1037,13 +1055,43 @@ includes a few other useful built-in views located in\n \n     **Template context:**\n \n-        * ``form``: The form for resetting the user's password.\n+        * ``form``: The form (see ``password_reset_form`` above) for resetting\n+          the user's password.\n+\n+    **Email template context:**\n+\n+        * ``email``: An alias for ``user.email``\n+\n+        * ``user``: The current :class:`~django.contrib.auth.models.User`,\n+          according to the ``email`` form field. Only active users are able to\n+          reset their passwords (``User.is_active is True``).\n+\n+        * ``site_name``: An alias for ``site.name``. If you don't have the site\n+          framework installed, this will be set to the value of\n+          :attr:`request.META['SERVER_NAME'] <django.http.HttpRequest.META>`.\n+          For more on sites, see :doc:`/ref/contrib/sites`.\n+\n+        * ``domain``: An alias for ``site.domain``. If you don't have the site\n+          framework installed, this will be set to the value of\n+          ``request.get_host()``.\n+\n+        * ``protocol``: http or https\n+\n+        * ``uid``: The user's id encoded in base 36.\n+\n+        * ``token``: Token to check that the password is valid.\n+\n+    Sample ``registration/password_reset_email.html`` (email body template):\n+\n+    .. code-block:: html+django\n+\n+        {% load url from future %}\n+        Someone asked for password reset for email {{ email }}. Follow the link below:\n+        {{ protocol}}://{{ site_name }}{% url 'auth_password_reset_confirm' uidb36=uid token=token %}\n+\n+    The same template context is used for subject template. Subject must be\n+    single line plain text string.\n \n-        .. versionchanged:: 1.4\n-            Users flagged with an unusable password (see\n-            :meth:`~django.contrib.auth.models.User.set_unusable_password()`\n-            will not be able to request a password reset to prevent misuse\n-            when using an external authentication source like LDAP.\n \n .. function:: password_reset_done(request[, template_name])\n \n@@ -1053,8 +1101,8 @@ includes a few other useful built-in views located in\n \n     **Optional arguments:**\n \n-        * ``template_name``: The full name of a template to use. This will\n-          default to :file:`registration/password_reset_done.html` if not\n+        * ``template_name``: The full name of a template to use.\n+          Defaults to :file:`registration/password_reset_done.html` if not\n           supplied.\n \n .. function:: password_reset_confirm(request[, uidb36, token, template_name, token_generator, set_password_form, post_reset_redirect])\n@@ -1063,18 +1111,31 @@ includes a few other useful built-in views located in\n \n     **Optional arguments:**\n \n-        * ``uidb36``: The user's id encoded in base 36. This will default to\n+        * ``uidb36``: The user's id encoded in base 36. Defaults to ``None``.\n+\n+        * ``token``: Token to check that the password is valid. Defaults to\n           ``None``.\n-        * ``token``: Token to check that the password is valid. This will default to ``None``.\n+\n         * ``template_name``: The full name of a template to display the confirm\n           password view. Default value is :file:`registration/password_reset_confirm.html`.\n+\n         * ``token_generator``: Instance of the class to check the password. This\n           will default to ``default_token_generator``, it's an instance of\n           ``django.contrib.auth.tokens.PasswordResetTokenGenerator``.\n+\n         * ``set_password_form``: Form that will be used to set the password.\n-          This will default to ``SetPasswordForm``.\n+          Defaults to :class:`~django.contrib.auth.forms.SetPasswordForm`\n+\n         * ``post_reset_redirect``: URL to redirect after the password reset\n-          done. This will default to ``None``.\n+          done. Defaults to ``None``.\n+\n+    **Template context:**\n+\n+        * ``form``: The form (see ``set_password_form`` above) for setting the\n+          new user's password.\n+\n+        * ``validlink``: Boolean, True if the link (combination of uidb36 and\n+          token) is valid or unused yet.\n \n .. function:: password_reset_complete(request[,template_name])\n \n@@ -1084,7 +1145,7 @@ includes a few other useful built-in views located in\n    **Optional arguments:**\n \n        * ``template_name``: The full name of a template to display the view.\n-         This will default to :file:`registration/password_reset_complete.html`.\n+         Defaults to :file:`registration/password_reset_complete.html`.\n \n Helper functions\n ----------------\n@@ -1102,8 +1163,8 @@ Helper functions\n \n     **Optional arguments:**\n \n-        * ``login_url``: The URL of the login page to redirect to. This will\n-          default to :setting:`settings.LOGIN_URL <LOGIN_URL>` if not supplied.\n+        * ``login_url``: The URL of the login page to redirect to.\n+          Defaults to :setting:`settings.LOGIN_URL <LOGIN_URL>` if not supplied.\n \n         * ``redirect_field_name``: The name of a ``GET`` field containing the\n           URL to redirect to after log out. Overrides ``next`` if the given"
        }
    ],
    "stats": {
        "total": 119,
        "additions": 90,
        "deletions": 29
    }
}