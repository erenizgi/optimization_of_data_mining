{
    "author": "alex",
    "message": "Fixed #14593 -- change this warning to be a PendingDeprecationWarning.  Also converted the Czech localflavor tests to be unittests.  We have always been at war with doctests.  Thanks to Idan Gazit.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15062 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "c00c377e5402fcb658baff982cf908138974a2b5",
    "files": [
        {
            "sha": "320a2a8c490fc04ec3681bad0153c7fe3839f92a",
            "filename": "django/contrib/localflavor/cz/forms.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/c00c377e5402fcb658baff982cf908138974a2b5/django%2Fcontrib%2Flocalflavor%2Fcz%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/c00c377e5402fcb658baff982cf908138974a2b5/django%2Fcontrib%2Flocalflavor%2Fcz%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Flocalflavor%2Fcz%2Fforms.py?ref=c00c377e5402fcb658baff982cf908138974a2b5",
            "patch": "@@ -73,7 +73,7 @@ def clean(self, value, gender=None):\n             import warnings\n             warnings.warn(\n                 \"Support for validating the gender of a CZ Birth number has been deprecated.\",\n-                DeprecationWarning)\n+                PendingDeprecationWarning)\n             if gender == 'f':\n                 female_const = 50\n             elif gender == 'm':"
        },
        {
            "sha": "4a5631e2643c848aa3772002dbd46b7ffad96dcb",
            "filename": "docs/releases/1.3.txt",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/c00c377e5402fcb658baff982cf908138974a2b5/docs%2Freleases%2F1.3.txt",
            "raw_url": "https://github.com/django/django/raw/c00c377e5402fcb658baff982cf908138974a2b5/docs%2Freleases%2F1.3.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.3.txt?ref=c00c377e5402fcb658baff982cf908138974a2b5",
            "patch": "@@ -539,3 +539,11 @@ GeoDjango\n     to indicate possible faulty application code.  A warning is now raised\n     if :meth:`~django.contrib.gis.geos.GEOSGeometry.transform` is called when\n     the SRID of the geometry is less than 0 or ``None``.\n+\n+``CZBirthNumberField.clean``\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Previously this field's ``clean()`` method accepted a second, gender, argument\n+which allowed stronger validation checks to be made, however since this\n+argument could never actually be passed from the Django form machinery it is\n+now pending deprecation."
        },
        {
            "sha": "e9419d39e73e7881be5e5758231778e6cd6f6345",
            "filename": "tests/regressiontests/forms/localflavor/cz.py",
            "status": "modified",
            "additions": 97,
            "deletions": 118,
            "changes": 215,
            "blob_url": "https://github.com/django/django/blob/c00c377e5402fcb658baff982cf908138974a2b5/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fcz.py",
            "raw_url": "https://github.com/django/django/raw/c00c377e5402fcb658baff982cf908138974a2b5/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fcz.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fcz.py?ref=c00c377e5402fcb658baff982cf908138974a2b5",
            "patch": "@@ -1,126 +1,105 @@\n-# -*- coding: utf-8 -*-\n-# Tests for the contrib/localflavor/ CZ Form Fields\n+import warnings\n \n-tests = r\"\"\"\n-# CZPostalCodeField #########################################################\n+from django.contrib.localflavor.cz.forms import (CZPostalCodeField,\n+    CZRegionSelect, CZBirthNumberField, CZICNumberField)\n \n->>> from django.contrib.localflavor.cz.forms import CZPostalCodeField\n->>> f = CZPostalCodeField()\n->>> f.clean('84545x')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXXXX or XXX XX.']\n->>> f.clean('91909')\n-u'91909'\n->>> f.clean('917 01')\n-u'91701'\n->>> f.clean('12345')\n-u'12345'\n->>> f.clean('123456')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXXXX or XXX XX.']\n->>> f.clean('1234')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXXXX or XXX XX.']\n->>> f.clean('123 4')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXXXX or XXX XX.']\n+from django.core.exceptions import ValidationError\n+from utils import LocalFlavorTestCase\n \n-# CZRegionSelect ############################################################\n \n->>> from django.contrib.localflavor.cz.forms import CZRegionSelect\n->>> w = CZRegionSelect()\n->>> w.render('regions', 'TT')\n-u'<select name=\"regions\">\\n<option value=\"PR\">Prague</option>\\n<option value=\"CE\">Central Bohemian Region</option>\\n<option value=\"SO\">South Bohemian Region</option>\\n<option value=\"PI\">Pilsen Region</option>\\n<option value=\"CA\">Carlsbad Region</option>\\n<option value=\"US\">Usti Region</option>\\n<option value=\"LB\">Liberec Region</option>\\n<option value=\"HK\">Hradec Region</option>\\n<option value=\"PA\">Pardubice Region</option>\\n<option value=\"VY\">Vysocina Region</option>\\n<option value=\"SM\">South Moravian Region</option>\\n<option value=\"OL\">Olomouc Region</option>\\n<option value=\"ZL\">Zlin Region</option>\\n<option value=\"MS\">Moravian-Silesian Region</option>\\n</select>'\n+class CZLocalFlavorTests(LocalFlavorTestCase):\n+    def setUp(self):\n+        self.save_warnings_state()\n+        warnings.filterwarnings(\n+            \"ignore\",\n+            category=PendingDeprecationWarning,\n+            module='django.contrib.localflavor.cz.forms'\n+        )\n \n-# CZBirthNumberField ########################################################\n+    def tearDown(self):\n+        self.restore_warnings_state()\n \n->>> from django.contrib.localflavor.cz.forms import CZBirthNumberField\n->>> f = CZBirthNumberField()\n->>> f.clean('880523/1237')\n-u'880523/1237'\n->>> f.clean('8805231237')\n-u'8805231237'\n->>> f.clean('880523/000')\n-u'880523/000'\n->>> f.clean('880523000')\n-u'880523000'\n->>> f.clean('882101/0011')\n-u'882101/0011'\n->>> f.clean('880523/1237', 'm')\n-u'880523/1237'\n->>> f.clean('885523/1231', 'f')\n-u'885523/1231'\n->>> f.clean('123456/12')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a birth number in the format XXXXXX/XXXX or XXXXXXXXXX.']\n->>> f.clean('123456/12345')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a birth number in the format XXXXXX/XXXX or XXXXXXXXXX.']\n->>> f.clean('12345612')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a birth number in the format XXXXXX/XXXX or XXXXXXXXXX.']\n->>> f.clean('12345612345')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a birth number in the format XXXXXX/XXXX or XXXXXXXXXX.']\n->>> f.clean('881523/0000', 'm')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid birth number.']\n->>> f.clean('885223/0000', 'm')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid birth number.']\n->>> f.clean('881223/0000', 'f')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid birth number.']\n->>> f.clean('886523/0000', 'f')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid birth number.']\n->>> f.clean('880523/1239')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid birth number.']\n->>> f.clean('8805231239')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid birth number.']\n->>> f.clean('990101/0011')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid birth number.']\n+    def test_CZRegionSelect(self):\n+        f = CZRegionSelect()\n+        out = u'''<select name=\"regions\">\n+<option value=\"PR\">Prague</option>\n+<option value=\"CE\">Central Bohemian Region</option>\n+<option value=\"SO\">South Bohemian Region</option>\n+<option value=\"PI\">Pilsen Region</option>\n+<option value=\"CA\">Carlsbad Region</option>\n+<option value=\"US\">Usti Region</option>\n+<option value=\"LB\">Liberec Region</option>\n+<option value=\"HK\">Hradec Region</option>\n+<option value=\"PA\">Pardubice Region</option>\n+<option value=\"VY\">Vysocina Region</option>\n+<option value=\"SM\">South Moravian Region</option>\n+<option value=\"OL\">Olomouc Region</option>\n+<option value=\"ZL\">Zlin Region</option>\n+<option value=\"MS\">Moravian-Silesian Region</option>\n+</select>'''\n+        self.assertEqual(f.render('regions', 'TT'), out)\n \n-# CZICNumberField ########################################################\n+    def test_CZPostalCodeField(self):\n+        error_format = [u'Enter a postal code in the format XXXXX or XXX XX.']\n+        valid = {\n+            '91909': '91909',\n+            '917 01': '91701',\n+            '12345': '12345',\n+        }\n+        invalid = {\n+            '84545x': error_format,\n+            '123456': error_format,\n+            '1234': error_format,\n+            '123 4': error_format,\n+        }\n+        self.assertFieldOutput(CZPostalCodeField, valid, invalid)\n \n->>> from django.contrib.localflavor.cz.forms import CZICNumberField\n->>> f = CZICNumberField()\n->>> f.clean('12345679')\n-u'12345679'\n->>> f.clean('12345601')\n-u'12345601'\n->>> f.clean('12345661')\n-u'12345661'\n->>> f.clean('12345610')\n-u'12345610'\n->>> f.clean('1234567')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid IC number.']\n->>> f.clean('12345660')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid IC number.']\n->>> f.clean('12345600')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid IC number.']\n-\"\"\"\n+    def test_CZBirthNumberField(self):\n+        error_format = [u'Enter a birth number in the format XXXXXX/XXXX or XXXXXXXXXX.']\n+        error_invalid = [u'Enter a valid birth number.']\n+        valid = {\n+            '880523/1237': '880523/1237',\n+            '8805231237': '8805231237',\n+            '880523/000': '880523/000',\n+            '880523000': '880523000',\n+            '882101/0011': '882101/0011',\n+        }\n+        invalid = {\n+            '123456/12': error_format,\n+            '123456/12345': error_format,\n+            '12345612': error_format,\n+            '12345612345': error_format,\n+            '880523/1239': error_invalid,\n+            '8805231239': error_invalid,\n+            '990101/0011': error_invalid,\n+        }\n+        self.assertFieldOutput(CZBirthNumberField, valid, invalid)\n+\n+        # These tests should go away in 1.4.\n+        # http://code.djangoproject.com/ticket/14593\n+        f = CZBirthNumberField()\n+        self.assertEqual(f.clean('880523/1237', 'm'), '880523/1237'),\n+        self.assertEqual(f.clean('885523/1231', 'f'), '885523/1231')\n+        self.assertRaisesRegexp(ValidationError, unicode(error_invalid),\n+            f.clean, '881523/0000', 'm')\n+        self.assertRaisesRegexp(ValidationError, unicode(error_invalid),\n+            f.clean, '885223/0000', 'm')\n+        self.assertRaisesRegexp(ValidationError, unicode(error_invalid),\n+            f.clean, '881523/0000', 'f')\n+        self.assertRaisesRegexp(ValidationError, unicode(error_invalid),\n+            f.clean, '885223/0000', 'f')\n+\n+    def test_CZICNumberField(self):\n+        error_invalid = [u'Enter a valid IC number.']\n+        valid ={\n+            '12345679': '12345679',\n+            '12345601': '12345601',\n+            '12345661': '12345661',\n+            '12345610': '12345610',\n+        }\n+        invalid = {\n+            '1234567': error_invalid,\n+            '12345660': error_invalid,\n+            '12345600': error_invalid,\n+        }\n+        self.assertFieldOutput(CZICNumberField, valid, invalid)"
        },
        {
            "sha": "5ee1c32acc6986af6b2e6c5ac46a4d197c38ea9f",
            "filename": "tests/regressiontests/forms/localflavortests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 7,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/c00c377e5402fcb658baff982cf908138974a2b5/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "raw_url": "https://github.com/django/django/raw/c00c377e5402fcb658baff982cf908138974a2b5/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py?ref=c00c377e5402fcb658baff982cf908138974a2b5",
            "patch": "@@ -1,6 +1,3 @@\n-# -*- coding: utf-8 -*-\n-from localflavor.cz import tests as localflavor_cz_tests\n-\n from localflavor.ar import ARLocalFlavorTests\n from localflavor.at import ATLocalFlavorTests\n from localflavor.au import AULocalFlavorTests\n@@ -9,6 +6,7 @@\n from localflavor.ca import CALocalFlavorTests\n from localflavor.ch import CHLocalFlavorTests\n from localflavor.cl import CLLocalFlavorTests\n+from localflavor.cz import CZLocalFlavorTests\n from localflavor.de import DELocalFlavorTests\n from localflavor.es import ESLocalFlavorTests\n from localflavor.fi import FILocalFlavorTests\n@@ -33,7 +31,3 @@\n from localflavor.uy import UYLocalFlavorTests\n from localflavor.za import ZALocalFlavorTests\n \n-\n-__test__ = {\n-    'localflavor_cz_tests': localflavor_cz_tests,\n-}"
        },
        {
            "sha": "2d96b2fae8aa7d4cfae35dea5b9f73d263310f32",
            "filename": "tests/regressiontests/forms/tests/__init__.py",
            "status": "modified",
            "additions": 11,
            "deletions": 32,
            "changes": 43,
            "blob_url": "https://github.com/django/django/blob/c00c377e5402fcb658baff982cf908138974a2b5/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/c00c377e5402fcb658baff982cf908138974a2b5/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py?ref=c00c377e5402fcb658baff982cf908138974a2b5",
            "patch": "@@ -12,36 +12,15 @@\n from widgets import *\n \n from regressiontests.forms.localflavortests import (\n-    __test__,\n-    ARLocalFlavorTests,\n-    ATLocalFlavorTests,\n-    AULocalFlavorTests,\n-    BELocalFlavorTests,\n-    BRLocalFlavorTests,\n-    CALocalFlavorTests,\n-    CHLocalFlavorTests,\n-    CLLocalFlavorTests,\n-    DELocalFlavorTests,\n-    ESLocalFlavorTests,\n-    FILocalFlavorTests,\n-    FRLocalFlavorTests,\n-    GenericLocalFlavorTests,\n-    IDLocalFlavorTests,\n-    IELocalFlavorTests,\n-    ILLocalFlavorTests,\n-    ISLocalFlavorTests,\n-    ITLocalFlavorTests,\n-    JPLocalFlavorTests,\n-    KWLocalFlavorTests,\n-    NLLocalFlavorTests,\n-    PLLocalFlavorTests,\n-    PTLocalFlavorTests,\n-    ROLocalFlavorTests,\n-    SELocalFlavorTests,\n-    SKLocalFlavorTests,\n-    TRLocalFlavorTests,\n-    UKLocalFlavorTests,\n-    USLocalFlavorTests,\n-    UYLocalFlavorTests,\n-    ZALocalFlavorTests,\n+    ARLocalFlavorTests, ATLocalFlavorTests, AULocalFlavorTests,\n+    BELocalFlavorTests, BRLocalFlavorTests, CALocalFlavorTests,\n+    CHLocalFlavorTests, CLLocalFlavorTests, CZLocalFlavorTests,\n+    DELocalFlavorTests, ESLocalFlavorTests, FILocalFlavorTests,\n+    FRLocalFlavorTests, GenericLocalFlavorTests, IDLocalFlavorTests,\n+    IELocalFlavorTests, ILLocalFlavorTests, ISLocalFlavorTests,\n+    ITLocalFlavorTests, JPLocalFlavorTests, KWLocalFlavorTests,\n+    NLLocalFlavorTests, PLLocalFlavorTests, PTLocalFlavorTests,\n+    ROLocalFlavorTests, SELocalFlavorTests, SKLocalFlavorTests,\n+    TRLocalFlavorTests, UKLocalFlavorTests, USLocalFlavorTests,\n+    UYLocalFlavorTests, ZALocalFlavorTests\n )"
        }
    ],
    "stats": {
        "total": 276,
        "additions": 118,
        "deletions": 158
    }
}