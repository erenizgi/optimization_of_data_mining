{
    "author": "carljm",
    "message": "Poured a little more perfectionism into the delete-confirmation templates.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15250 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "53dac996efedf9138938ad4aa5647cb68006937c",
    "files": [
        {
            "sha": "c68184a7682b744c1d8e93c19ef3a17fbba328cd",
            "filename": "django/contrib/admin/actions.py",
            "status": "modified",
            "additions": 12,
            "deletions": 2,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/53dac996efedf9138938ad4aa5647cb68006937c/django%2Fcontrib%2Fadmin%2Factions.py",
            "raw_url": "https://github.com/django/django/raw/53dac996efedf9138938ad4aa5647cb68006937c/django%2Fcontrib%2Fadmin%2Factions.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Factions.py?ref=53dac996efedf9138938ad4aa5647cb68006937c",
            "patch": "@@ -52,9 +52,19 @@ def delete_selected(modeladmin, request, queryset):\n         # Return None to display the change list page again.\n         return None\n \n+    if len(queryset) == 1:\n+        objects_name = force_unicode(opts.verbose_name)\n+    else:\n+        objects_name = force_unicode(opts.verbose_name_plural)\n+\n+    if perms_needed or protected:\n+        title = _(\"Cannot delete %(name)s\") % {\"name\": objects_name}\n+    else:\n+        title = _(\"Are you sure?\")\n+\n     context = {\n-        \"title\": _(\"Are you sure?\"),\n-        \"object_name\": force_unicode(opts.verbose_name),\n+        \"title\": title,\n+        \"objects_name\": objects_name,\n         \"deletable_objects\": [deletable_objects],\n         'queryset': queryset,\n         \"perms_lacking\": perms_needed,"
        },
        {
            "sha": "4ad21eb42b98fdba3222e9370873391b3da23dad",
            "filename": "django/contrib/admin/options.py",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/53dac996efedf9138938ad4aa5647cb68006937c/django%2Fcontrib%2Fadmin%2Foptions.py",
            "raw_url": "https://github.com/django/django/raw/53dac996efedf9138938ad4aa5647cb68006937c/django%2Fcontrib%2Fadmin%2Foptions.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Foptions.py?ref=53dac996efedf9138938ad4aa5647cb68006937c",
            "patch": "@@ -1193,9 +1193,16 @@ def delete_view(self, request, object_id, extra_context=None):\n                 return HttpResponseRedirect(\"../../../../\")\n             return HttpResponseRedirect(\"../../\")\n \n+        object_name = force_unicode(opts.verbose_name)\n+\n+        if perms_needed or protected:\n+            title = _(\"Cannot delete %(name)s\") % {\"name\": object_name}\n+        else:\n+            title = _(\"Are you sure?\")\n+\n         context = {\n-            \"title\": _(\"Are you sure?\"),\n-            \"object_name\": force_unicode(opts.verbose_name),\n+            \"title\": title,\n+            \"object_name\": object_name,\n             \"object\": obj,\n             \"deleted_objects\": deleted_objects,\n             \"perms_lacking\": perms_needed,"
        },
        {
            "sha": "0e6d47e68d15b2b78f4baef33b9e30d0173ae9c4",
            "filename": "django/contrib/admin/templates/admin/delete_confirmation.html",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/53dac996efedf9138938ad4aa5647cb68006937c/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fdelete_confirmation.html",
            "raw_url": "https://github.com/django/django/raw/53dac996efedf9138938ad4aa5647cb68006937c/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fdelete_confirmation.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fdelete_confirmation.html?ref=53dac996efedf9138938ad4aa5647cb68006937c",
            "patch": "@@ -22,7 +22,7 @@\n         </ul>\n     {% endif %}\n     {% if protected %}\n-        <p>{% blocktrans with object as escaped_object %}Deleting the {{ object_name }} '{{ escaped_object }}' is not possible, because it would require deleting the following protected related objects:{% endblocktrans %}</p>\n+        <p>{% blocktrans with object as escaped_object %}Deleting the {{ object_name }} '{{ escaped_object }}' would require deleting the following protected related objects:{% endblocktrans %}</p>\n         <ul>\n         {% for obj in protected %}\n             <li>{{ obj }}</li>"
        },
        {
            "sha": "2bb4fb47426320638ad2522f5f1fbe5ade3f7502",
            "filename": "django/contrib/admin/templates/admin/delete_selected_confirmation.html",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/53dac996efedf9138938ad4aa5647cb68006937c/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fdelete_selected_confirmation.html",
            "raw_url": "https://github.com/django/django/raw/53dac996efedf9138938ad4aa5647cb68006937c/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fdelete_selected_confirmation.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fdelete_selected_confirmation.html?ref=53dac996efedf9138938ad4aa5647cb68006937c",
            "patch": "@@ -13,23 +13,23 @@\n {% block content %}\n {% if perms_lacking or protected %}\n     {% if perms_lacking %}\n-        <p>{% blocktrans %}Deleting the {{ object_name }} would result in deleting related objects, but your account doesn't have permission to delete the following types of objects:{% endblocktrans %}</p>\n+        <p>{% blocktrans %}Deleting the selected {{ objects_name }} would result in deleting related objects, but your account doesn't have permission to delete the following types of objects:{% endblocktrans %}</p>\n         <ul>\n         {% for obj in perms_lacking %}\n             <li>{{ obj }}</li>\n         {% endfor %}\n         </ul>\n     {% endif %}\n     {% if protected %}\n-        <p>{% blocktrans %}Deleting the {{ object_name }} is not possible, because it would require deleting the following protected related objects:{% endblocktrans %}</p>\n+        <p>{% blocktrans %}Deleting the selected {{ objects_name }} would require deleting the following protected related objects:{% endblocktrans %}</p>\n         <ul>\n         {% for obj in protected %}\n             <li>{{ obj }}</li>\n         {% endfor %}\n         </ul>\n     {% endif %}\n {% else %}\n-    <p>{% blocktrans %}Are you sure you want to delete the selected {{ object_name }} objects? All of the following objects and their related items will be deleted:{% endblocktrans %}</p>\n+    <p>{% blocktrans %}Are you sure you want to delete the selected {{ objects_name }}? All of the following objects and their related items will be deleted:{% endblocktrans %}</p>\n     {% for deletable_object in deletable_objects %}\n         <ul>{{ deletable_object|unordered_list }}</ul>\n     {% endfor %}"
        },
        {
            "sha": "661954c7ec500353ddba4b6720971bd1b23e6510",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/53dac996efedf9138938ad4aa5647cb68006937c/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/53dac996efedf9138938ad4aa5647cb68006937c/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=53dac996efedf9138938ad4aa5647cb68006937c",
            "patch": "@@ -1632,7 +1632,7 @@ def test_model_admin_default_delete_action(self):\n             'post': 'yes',\n         }\n         confirmation = self.client.post('/test_admin/admin/admin_views/subscriber/', action_data)\n-        self.assertContains(confirmation, \"Are you sure you want to delete the selected subscriber objects\")\n+        self.assertContains(confirmation, \"Are you sure you want to delete the selected subscribers\")\n         self.assertTrue(confirmation.content.count(ACTION_CHECKBOX_NAME) == 2)\n         response = self.client.post('/test_admin/admin/admin_views/subscriber/', delete_confirmation_data)\n         self.assertEqual(Subscriber.objects.count(), 0)"
        }
    ],
    "stats": {
        "total": 35,
        "additions": 26,
        "deletions": 9
    }
}