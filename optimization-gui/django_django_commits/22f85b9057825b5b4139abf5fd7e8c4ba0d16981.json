{
    "author": "claudep",
    "message": "Fixed #18824 -- Allow deleting a setting from overriden settings",
    "sha": "22f85b9057825b5b4139abf5fd7e8c4ba0d16981",
    "files": [
        {
            "sha": "f4d17ca9f3a0bdfba80ad1ce281da6a6f1fcc71c",
            "filename": "django/conf/__init__.py",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/22f85b9057825b5b4139abf5fd7e8c4ba0d16981/django%2Fconf%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/22f85b9057825b5b4139abf5fd7e8c4ba0d16981/django%2Fconf%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fconf%2F__init__.py?ref=22f85b9057825b5b4139abf5fd7e8c4ba0d16981",
            "patch": "@@ -152,11 +152,22 @@ def __init__(self, default_settings):\n         Requests for configuration variables not in this class are satisfied\n         from the module specified in default_settings (if possible).\n         \"\"\"\n+        self.__dict__['_deleted'] = set()\n         self.default_settings = default_settings\n \n     def __getattr__(self, name):\n+        if name in self._deleted:\n+            raise AttributeError\n         return getattr(self.default_settings, name)\n \n+    def __setattr__(self, name, value):\n+        self._deleted.discard(name)\n+        return super(UserSettingsHolder, self).__setattr__(name, value)\n+\n+    def __delattr__(self, name):\n+        self._deleted.add(name)\n+        return super(UserSettingsHolder, self).__delattr__(name)\n+\n     def __dir__(self):\n         return list(self.__dict__) + dir(self.default_settings)\n "
        },
        {
            "sha": "7225fb03ef8ec014c0fd954ed6d4a4e1c4bb3ed3",
            "filename": "tests/regressiontests/settings_tests/tests.py",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/22f85b9057825b5b4139abf5fd7e8c4ba0d16981/tests%2Fregressiontests%2Fsettings_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/22f85b9057825b5b4139abf5fd7e8c4ba0d16981/tests%2Fregressiontests%2Fsettings_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fsettings_tests%2Ftests.py?ref=22f85b9057825b5b4139abf5fd7e8c4ba0d16981",
            "patch": "@@ -148,6 +148,16 @@ def test_settings_delete(self):\n     def test_settings_delete_wrapped(self):\n         self.assertRaises(TypeError, delattr, settings, '_wrapped')\n \n+    def test_override_settings_delete(self):\n+        \"\"\"\n+        Allow deletion of a setting in an overriden settings set (#18824)\n+        \"\"\"\n+        previous_i18n = settings.USE_I18N\n+        with self.settings(USE_I18N=False):\n+            del settings.USE_I18N\n+            self.assertRaises(AttributeError, getattr, settings, 'USE_I18N')\n+        self.assertEqual(settings.USE_I18N, previous_i18n)\n+\n     def test_allowed_include_roots_string(self):\n         \"\"\"\n         ALLOWED_INCLUDE_ROOTS is not allowed to be incorrectly set to a string"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 21,
        "deletions": 0
    }
}