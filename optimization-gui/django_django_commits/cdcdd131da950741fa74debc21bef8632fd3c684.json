{
    "author": "claudep",
    "message": "Dropped support for GDAL < 1.5\n\nGDAL 1.5 has been released in December 2007.",
    "sha": "cdcdd131da950741fa74debc21bef8632fd3c684",
    "files": [
        {
            "sha": "adff96b47aba8d924858816938e906b003fe1c6d",
            "filename": "django/contrib/gis/gdal/__init__.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgdal%2F__init__.py?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -37,12 +37,12 @@\n try:\n     from django.contrib.gis.gdal.driver import Driver\n     from django.contrib.gis.gdal.datasource import DataSource\n-    from django.contrib.gis.gdal.libgdal import gdal_version, gdal_full_version, gdal_release_date, GEOJSON, GDAL_VERSION\n+    from django.contrib.gis.gdal.libgdal import gdal_version, gdal_full_version, gdal_release_date, GDAL_VERSION\n     from django.contrib.gis.gdal.srs import SpatialReference, CoordTransform\n     from django.contrib.gis.gdal.geometries import OGRGeometry\n     HAS_GDAL = True\n except:\n-    HAS_GDAL, GEOJSON = False, False\n+    HAS_GDAL = False\n \n try:\n     from django.contrib.gis.gdal.envelope import Envelope"
        },
        {
            "sha": "3feb18a923bea75968f65dfaede99de93c33dffc",
            "filename": "django/contrib/gis/gdal/geometries.py",
            "status": "modified",
            "additions": 5,
            "deletions": 15,
            "changes": 20,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2Fgeometries.py",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2Fgeometries.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgdal%2Fgeometries.py?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -48,7 +48,7 @@\n from django.contrib.gis.gdal.envelope import Envelope, OGREnvelope\n from django.contrib.gis.gdal.error import OGRException, OGRIndexError, SRSException\n from django.contrib.gis.gdal.geomtype import OGRGeomType\n-from django.contrib.gis.gdal.libgdal import GEOJSON, GDAL_VERSION\n+from django.contrib.gis.gdal.libgdal import GDAL_VERSION\n from django.contrib.gis.gdal.srs import SpatialReference, CoordTransform\n \n # Getting the ctypes prototype functions that interface w/the GDAL C library.\n@@ -97,10 +97,7 @@ def __init__(self, geom_input, srs=None):\n                 else:\n                     g = capi.from_wkt(byref(c_char_p(wkt_m.group('wkt'))), None, byref(c_void_p()))\n             elif json_m:\n-                if GEOJSON:\n-                    g = capi.from_json(geom_input)\n-                else:\n-                    raise NotImplementedError('GeoJSON input only supported on GDAL 1.5+.')\n+                g = capi.from_json(geom_input)\n             else:\n                 # Seeing if the input is a valid short-hand string\n                 # (e.g., 'Point', 'POLYGON').\n@@ -328,22 +325,15 @@ def hex(self):\n     @property\n     def json(self):\n         \"\"\"\n-        Returns the GeoJSON representation of this Geometry (requires\n-        GDAL 1.5+).\n+        Returns the GeoJSON representation of this Geometry.\n         \"\"\"\n-        if GEOJSON:\n-            return capi.to_json(self.ptr)\n-        else:\n-            raise NotImplementedError('GeoJSON output only supported on GDAL 1.5+.')\n+        return capi.to_json(self.ptr)\n     geojson = json\n \n     @property\n     def kml(self):\n         \"Returns the KML representation of the Geometry.\"\n-        if GEOJSON:\n-            return capi.to_kml(self.ptr, None)\n-        else:\n-            raise NotImplementedError('KML output only supported on GDAL 1.5+.')\n+        return capi.to_kml(self.ptr, None)\n \n     @property\n     def wkb_size(self):"
        },
        {
            "sha": "27a5b8172e6c652524e4085c0dea488e52b26e23",
            "filename": "django/contrib/gis/gdal/libgdal.py",
            "status": "modified",
            "additions": 1,
            "deletions": 8,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2Flibgdal.py",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2Flibgdal.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgdal%2Flibgdal.py?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -19,7 +19,7 @@\n elif os.name == 'posix':\n     # *NIX library names.\n     lib_names = ['gdal', 'GDAL', 'gdal1.9.0', 'gdal1.8.0', 'gdal1.7.0',\n-        'gdal1.6.0', 'gdal1.5.0', 'gdal1.4.0']\n+        'gdal1.6.0', 'gdal1.5.0']\n else:\n     raise OGRException('Unsupported OS \"%s\"' % os.name)\n \n@@ -97,10 +97,3 @@ def gdal_version_info():\n GDAL_SUBMINOR_VERSION = _verinfo['subminor'] and int(_verinfo['subminor'])\n GDAL_VERSION = (GDAL_MAJOR_VERSION, GDAL_MINOR_VERSION, GDAL_SUBMINOR_VERSION)\n del _verinfo\n-\n-# GeoJSON support is available only in GDAL 1.5+.\n-if GDAL_VERSION >= (1, 5):\n-    GEOJSON = True\n-else:\n-    GEOJSON = False\n-"
        },
        {
            "sha": "f2c833d5764df298616bd19c9b9cb25ff3e607a4",
            "filename": "django/contrib/gis/gdal/prototypes/geom.py",
            "status": "modified",
            "additions": 5,
            "deletions": 10,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2Fprototypes%2Fgeom.py",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2Fprototypes%2Fgeom.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgdal%2Fprototypes%2Fgeom.py?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -1,6 +1,6 @@\n from ctypes import c_char_p, c_double, c_int, c_void_p, POINTER\n from django.contrib.gis.gdal.envelope import OGREnvelope\n-from django.contrib.gis.gdal.libgdal import lgdal, GEOJSON\n+from django.contrib.gis.gdal.libgdal import lgdal\n from django.contrib.gis.gdal.prototypes.errcheck import check_bool, check_envelope\n from django.contrib.gis.gdal.prototypes.generation import (const_string_output,\n     double_output, geom_output, int_output, srs_output, string_output, void_output)\n@@ -25,15 +25,10 @@ def topology_func(f):\n \n ### OGR_G ctypes function prototypes ###\n \n-# GeoJSON routines, if supported.\n-if GEOJSON:\n-    from_json = geom_output(lgdal.OGR_G_CreateGeometryFromJson, [c_char_p])\n-    to_json = string_output(lgdal.OGR_G_ExportToJson, [c_void_p], str_result=True)\n-    to_kml = string_output(lgdal.OGR_G_ExportToKML, [c_void_p, c_char_p], str_result=True) \n-else:\n-    from_json = False\n-    to_json = False\n-    to_kml = False\n+# GeoJSON routines.\n+from_json = geom_output(lgdal.OGR_G_CreateGeometryFromJson, [c_char_p])\n+to_json = string_output(lgdal.OGR_G_ExportToJson, [c_void_p], str_result=True)\n+to_kml = string_output(lgdal.OGR_G_ExportToKML, [c_void_p, c_char_p], str_result=True)\n \n # GetX, GetY, GetZ all return doubles.\n getx = pnt_func(lgdal.OGR_G_GetX)"
        },
        {
            "sha": "20e25946b02029b3e1260c634b5438dfe8e79f8a",
            "filename": "django/contrib/gis/gdal/tests/test_geom.py",
            "status": "modified",
            "additions": 0,
            "deletions": 5,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2Ftests%2Ftest_geom.py",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgdal%2Ftests%2Ftest_geom.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgdal%2Ftests%2Ftest_geom.py?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -6,7 +6,6 @@\n \n from django.contrib.gis.gdal import (OGRGeometry, OGRGeomType, OGRException,\n     OGRIndexError, SpatialReference, CoordTransform, GDAL_VERSION)\n-from django.contrib.gis.gdal.prototypes.geom import GEOJSON\n from django.contrib.gis.geometry.test_data import TestDataMixin\n from django.utils import unittest\n \n@@ -108,7 +107,6 @@ def test01d_wkb(self):\n \n     def test01e_json(self):\n         \"Testing GeoJSON input/output.\"\n-        if not GEOJSON: return\n         for g in self.geometries.json_geoms:\n             geom = OGRGeometry(g.wkt)\n             if not hasattr(g, 'not_equal'):\n@@ -244,9 +242,6 @@ def test07b_closepolygons(self):\n             self.fail('Should have raised an OGRException!')\n         print(\"\\nEND - expecting IllegalArgumentException; safe to ignore.\\n\")\n \n-        # Closing the rings -- doesn't work on GDAL versions 1.4.1 and below:\n-        # http://trac.osgeo.org/gdal/ticket/1673\n-        if GDAL_VERSION <= (1, 4, 1): return\n         poly.close_rings()\n         self.assertEqual(10, poly.point_count) # Two closing points should've been added\n         self.assertEqual(OGRGeometry('POINT(2.5 2.5)'), poly.centroid)"
        },
        {
            "sha": "fd2693ed59dd5cc994ab10cc526971dabfb8bec9",
            "filename": "django/contrib/gis/geos/base.py",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgeos%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgeos%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgeos%2Fbase.py?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -10,7 +10,6 @@\n     # A 'dummy' gdal module.\n     class GDALInfo(object):\n         HAS_GDAL = False\n-        GEOJSON = False\n     gdal = GDALInfo()\n \n # NumPy supported?"
        },
        {
            "sha": "2d8ac53dbd59110cf641b60cf6c07dd485eecb23",
            "filename": "django/contrib/gis/geos/geometry.py",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgeos%2Fgeometry.py",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgeos%2Fgeometry.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgeos%2Fgeometry.py?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -65,7 +65,7 @@ def __init__(self, geo_input, srid=None):\n             elif hex_regex.match(geo_input):\n                 # Handling HEXEWKB input.\n                 g = wkb_r().read(geo_input)\n-            elif gdal.GEOJSON and json_regex.match(geo_input):\n+            elif gdal.HAS_GDAL and json_regex.match(geo_input):\n                 # Handling GeoJSON input.\n                 g = wkb_r().read(gdal.OGRGeometry(geo_input).wkb)\n             else:\n@@ -409,13 +409,12 @@ def hexewkb(self):\n     @property\n     def json(self):\n         \"\"\"\n-        Returns GeoJSON representation of this Geometry if GDAL 1.5+\n-        is installed.\n+        Returns GeoJSON representation of this Geometry if GDAL is installed.\n         \"\"\"\n-        if gdal.GEOJSON:\n+        if gdal.HAS_GDAL:\n             return self.ogr.json\n         else:\n-            raise GEOSException('GeoJSON output only supported on GDAL 1.5+.')\n+            raise GEOSException('GeoJSON output only supported when GDAL is installed.')\n     geojson = json\n \n     @property"
        },
        {
            "sha": "18f1fb65be07f42edd32722b46a481c03284c551",
            "filename": "django/contrib/gis/geos/tests/test_geos.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos.py",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos.py?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -196,7 +196,7 @@ def test_ewkt(self):\n                 self.assertEqual(srid, poly.shell.srid)\n                 self.assertEqual(srid, fromstr(poly.ewkt).srid) # Checking export\n \n-    @unittest.skipUnless(gdal.HAS_GDAL and gdal.GEOJSON, \"gdal >= 1.5 is required\")\n+    @unittest.skipUnless(gdal.HAS_GDAL, \"gdal is required\")\n     def test_json(self):\n         \"Testing GeoJSON input/output (via GDAL).\"\n         for g in self.geometries.json_geoms:"
        },
        {
            "sha": "79a3ae85a21c7c4342f6dd2e2ab04ed780a340c2",
            "filename": "django/contrib/gis/tests/test_geoforms.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Ftests%2Ftest_geoforms.py",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/django%2Fcontrib%2Fgis%2Ftests%2Ftest_geoforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Ftest_geoforms.py?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -71,6 +71,7 @@ def test04_to_python(self):\n         for wkt in ('POINT(5 23)', 'MULTIPOLYGON(((0 0, 0 1, 1 1, 1 0, 0 0)))', 'LINESTRING(0 0, 1 1)'):\n             self.assertEqual(GEOSGeometry(wkt), fld.to_python(wkt))\n         # but raises a ValidationError for any other string\n+        import pdb; pdb.set_trace()\n         for wkt in ('POINT(5)', 'MULTI   POLYGON(((0 0, 0 1, 1 1, 1 0, 0 0)))', 'BLAH(0 0, 1 1)'):\n             self.assertRaises(forms.ValidationError, fld.to_python, wkt)\n "
        },
        {
            "sha": "c4b29bead725e5a09f56edf485ab5883b9ddc7d4",
            "filename": "docs/ref/contrib/gis/gdal.txt",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/docs%2Fref%2Fcontrib%2Fgis%2Fgdal.txt",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/docs%2Fref%2Fcontrib%2Fgis%2Fgdal.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fgis%2Fgdal.txt?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -447,7 +447,7 @@ systems and coordinate transformation::\n \n    This object is a wrapper for the `OGR Geometry`__ class.\n    These objects are instantiated directly from the given ``geom_input`` \n-   parameter, which may be a string containing WKT or HEX, a ``buffer``\n+   parameter, which may be a string containing WKT, HEX, GeoJSON, a ``buffer``\n    containing WKB data, or an :class:`OGRGeomType` object. These objects\n    are also returned from the :class:`Feature.geom` attribute, when \n    reading vector data from :class:`Layer` (which is in turn a part of"
        },
        {
            "sha": "5ee6d5153d837691aceaa5d88773a7bec45a4f3a",
            "filename": "docs/ref/contrib/gis/install.txt",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/docs%2Fref%2Fcontrib%2Fgis%2Finstall.txt",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/docs%2Fref%2Fcontrib%2Fgis%2Finstall.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fgis%2Finstall.txt?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -81,7 +81,7 @@ Program                   Description                           Required\n ========================  ====================================  ================================  ==========================\n :ref:`GEOS <ref-geos>`    Geometry Engine Open Source           Yes                               3.3, 3.2, 3.1, 3.0\n `PROJ.4`_                 Cartographic Projections library      Yes (PostgreSQL and SQLite only)  4.7, 4.6, 4.5, 4.4\n-:ref:`GDAL <ref-gdal>`    Geospatial Data Abstraction Library   No (but, required for SQLite)     1.8, 1.7, 1.6, 1.5, 1.4\n+:ref:`GDAL <ref-gdal>`    Geospatial Data Abstraction Library   No (but, required for SQLite)     1.9, 1.8, 1.7, 1.6, 1.5\n :ref:`GeoIP <ref-geoip>`  IP-based geolocation library          No                                1.4\n `PostGIS`__               Spatial extensions for PostgreSQL     Yes (PostgreSQL only)             1.5, 1.4, 1.3\n `SpatiaLite`__            Spatial extensions for SQLite         Yes (SQLite only)                 3.0, 2.4, 2.3\n@@ -270,9 +270,9 @@ supports :ref:`GDAL's vector data <ref-gdal>` capabilities [#]_.\n \n First download the latest GDAL release version and untar the archive::\n \n-    $ wget http://download.osgeo.org/gdal/gdal-1.8.1.tar.gz\n-    $ tar xzf gdal-1.8.1.tar.gz\n-    $ cd gdal-1.8.1\n+    $ wget http://download.osgeo.org/gdal/gdal-1.9.1.tar.gz\n+    $ tar xzf gdal-1.9.1.tar.gz\n+    $ cd gdal-1.9.1\n \n Configure, make and install::\n "
        },
        {
            "sha": "4275fbae52b1976e59c561b71517cd9101e6dc41",
            "filename": "docs/releases/1.5.txt",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/cdcdd131da950741fa74debc21bef8632fd3c684/docs%2Freleases%2F1.5.txt",
            "raw_url": "https://github.com/django/django/raw/cdcdd131da950741fa74debc21bef8632fd3c684/docs%2Freleases%2F1.5.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.5.txt?ref=cdcdd131da950741fa74debc21bef8632fd3c684",
            "patch": "@@ -177,6 +177,11 @@ autocommit behavior was never restored. This bug is now fixed in 1.5. While\n this is only a bug fix, it is worth checking your applications behavior if\n you are using PostgreSQL together with the autocommit option.\n \n+Miscellaneous\n+~~~~~~~~~~~~~\n+\n+* GeoDjango dropped support for GDAL < 1.5\n+\n Features deprecated in 1.5\n ==========================\n "
        }
    ],
    "stats": {
        "total": 81,
        "additions": 29,
        "deletions": 52
    }
}