{
    "author": "aaugustin",
    "message": "Extended TrailingSlashURLTests to cover STATIC_URL as well as MEDIA_URL.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17846 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "800e3941c50139347ab48e6d6731d445875357ed",
    "files": [
        {
            "sha": "1dbd5bd849abfb43cc5246eca63f544912ac2aad",
            "filename": "tests/regressiontests/settings_tests/tests.py",
            "status": "modified",
            "additions": 39,
            "deletions": 19,
            "changes": 58,
            "blob_url": "https://github.com/django/django/blob/800e3941c50139347ab48e6d6731d445875357ed/tests%2Fregressiontests%2Fsettings_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/800e3941c50139347ab48e6d6731d445875357ed/tests%2Fregressiontests%2Fsettings_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fsettings_tests%2Ftests.py?ref=800e3941c50139347ab48e6d6731d445875357ed",
            "patch": "@@ -157,25 +157,35 @@ def test_allowed_include_roots_string(self):\n \n \n class TrailingSlashURLTests(TestCase):\n+    \"\"\"\n+    Tests for the MEDIA_URL and STATIC_URL settings.\n+\n+    They must end with a slash to ensure there's a deterministic way to build\n+    paths in templates.\n+    \"\"\"\n     settings_module = settings\n \n     def setUp(self):\n         self._original_media_url = self.settings_module.MEDIA_URL\n+        self._original_static_url = self.settings_module.STATIC_URL\n \n     def tearDown(self):\n         self.settings_module.MEDIA_URL = self._original_media_url\n+        self.settings_module.STATIC_URL = self._original_static_url\n \n     def test_blank(self):\n         \"\"\"\n-        If blank, no DeprecationWarning error will be raised, even though it\n-        doesn't end in a slash.\n+        The empty string is accepted, even though it doesn't end in a slash.\n         \"\"\"\n         self.settings_module.MEDIA_URL = ''\n         self.assertEqual('', self.settings_module.MEDIA_URL)\n \n+        self.settings_module.STATIC_URL = ''\n+        self.assertEqual('', self.settings_module.STATIC_URL)\n+\n     def test_end_slash(self):\n         \"\"\"\n-        MEDIA_URL works if you end in a slash.\n+        It works if the value ends in a slash.\n         \"\"\"\n         self.settings_module.MEDIA_URL = '/foo/'\n         self.assertEqual('/foo/', self.settings_module.MEDIA_URL)\n@@ -184,31 +194,33 @@ def test_end_slash(self):\n         self.assertEqual('http://media.foo.com/',\n                          self.settings_module.MEDIA_URL)\n \n+        self.settings_module.STATIC_URL = '/foo/'\n+        self.assertEqual('/foo/', self.settings_module.STATIC_URL)\n+\n+        self.settings_module.STATIC_URL = 'http://static.foo.com/'\n+        self.assertEqual('http://static.foo.com/',\n+                         self.settings_module.STATIC_URL)\n+\n     def test_no_end_slash(self):\n         \"\"\"\n-        MEDIA_URL and STATIC_URL raise an ImproperlyConfigured exception\n-        if they doesn't end in a slash.\n+        An ImproperlyConfigured exception is raised if the value doesn't end\n+        in a slash.\n         \"\"\"\n-        def setattr_settings(settings_module, attr, value):\n-            setattr(settings_module, attr, value)\n-\n-        self.assertRaises(ImproperlyConfigured, setattr_settings,\n-                          self.settings_module, 'MEDIA_URL', '/foo')\n+        with self.assertRaises(ImproperlyConfigured):\n+            self.settings_module.MEDIA_URL = '/foo'\n \n-        self.assertRaises(ImproperlyConfigured, setattr_settings,\n-                          self.settings_module, 'MEDIA_URL',\n-                          'http://media.foo.com')\n+        with self.assertRaises(ImproperlyConfigured):\n+            self.settings_module.MEDIA_URL = 'http://media.foo.com'\n \n-        self.assertRaises(ImproperlyConfigured, setattr_settings,\n-                          self.settings_module, 'STATIC_URL', '/foo')\n+        with self.assertRaises(ImproperlyConfigured):\n+            self.settings_module.STATIC_URL = '/foo'\n \n-        self.assertRaises(ImproperlyConfigured, setattr_settings,\n-                          self.settings_module, 'STATIC_URL',\n-                          'http://static.foo.com')\n+        with self.assertRaises(ImproperlyConfigured):\n+            self.settings_module.STATIC_URL = 'http://static.foo.com'\n \n     def test_double_slash(self):\n         \"\"\"\n-        If a MEDIA_URL ends in more than one slash, presume they know what\n+        If the value ends in more than one slash, presume they know what\n         they're doing.\n         \"\"\"\n         self.settings_module.MEDIA_URL = '/stupid//'\n@@ -218,6 +230,14 @@ def test_double_slash(self):\n         self.assertEqual('http://media.foo.com/stupid//',\n                          self.settings_module.MEDIA_URL)\n \n+        self.settings_module.STATIC_URL = '/stupid//'\n+        self.assertEqual('/stupid//', self.settings_module.STATIC_URL)\n+\n+        self.settings_module.STATIC_URL = 'http://static.foo.com/stupid//'\n+        self.assertEqual('http://static.foo.com/stupid//',\n+                         self.settings_module.STATIC_URL)\n+\n+\n class SecureProxySslHeaderTest(TestCase):\n     settings_module = settings\n "
        }
    ],
    "stats": {
        "total": 58,
        "additions": 39,
        "deletions": 19
    }
}