{
    "author": "claudep",
    "message": "Fixed #5423 -- Made dumpdata output one row at a time.\n\nThis should prevent storing all rows in memory when big sets of\ndata are dumped.\nSee ticket for heroic contributors.",
    "sha": "3b5083bee5e96539dec599106aece9889e70ce05",
    "files": [
        {
            "sha": "6e06991bf0e4f261a1aa8590180a0d4660a0735f",
            "filename": "django/core/management/base.py",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fmanagement%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fmanagement%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fbase.py?ref=3b5083bee5e96539dec599106aece9889e70ce05",
            "patch": "@@ -49,23 +49,23 @@ class OutputWrapper(object):\n     \"\"\"\n     Wrapper around stdout/stderr\n     \"\"\"\n-    def __init__(self, out, style_func=None):\n+    def __init__(self, out, style_func=None, ending='\\n'):\n         self._out = out\n         self.style_func = None\n         if hasattr(out, 'isatty') and out.isatty():\n             self.style_func = style_func\n+        self.ending = ending\n \n     def __getattr__(self, name):\n         return getattr(self._out, name)\n \n-    def write(self, msg, style_func=None, ending='\\n'):\n+    def write(self, msg, style_func=None, ending=None):\n+        ending = ending is None and self.ending or ending\n         if ending and not msg.endswith(ending):\n             msg += ending\n-        if style_func is not None:\n-            msg = style_func(msg)\n-        elif self.style_func is not None:\n-            msg = self.style_func(msg)\n-        self._out.write(smart_str(msg))\n+        style_func = [f for f in (style_func, self.style_func, lambda x:x)\n+                      if f is not None][0]\n+        self._out.write(smart_str(style_func(msg)))\n \n \n class BaseCommand(object):"
        },
        {
            "sha": "b1a46cec3c7a189e56ae3dbf8b34933d270e234a",
            "filename": "django/core/management/commands/dumpdata.py",
            "status": "modified",
            "additions": 17,
            "deletions": 13,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fmanagement%2Fcommands%2Fdumpdata.py",
            "raw_url": "https://github.com/django/django/raw/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fmanagement%2Fcommands%2Fdumpdata.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fdumpdata.py?ref=3b5083bee5e96539dec599106aece9889e70ce05",
            "patch": "@@ -4,6 +4,7 @@\n from django.db import router, DEFAULT_DB_ALIAS\n from django.utils.datastructures import SortedDict\n \n+import sys\n from optparse import make_option\n \n class Command(BaseCommand):\n@@ -97,21 +98,24 @@ def handle(self, *app_labels, **options):\n         except KeyError:\n             raise CommandError(\"Unknown serialization format: %s\" % format)\n \n-        # Now collate the objects to be serialized.\n-        objects = []\n-        for model in sort_dependencies(app_list.items()):\n-            if model in excluded_models:\n-                continue\n-            if not model._meta.proxy and router.allow_syncdb(using, model):\n-                if use_base_manager:\n-                    objects.extend(model._base_manager.using(using).all())\n-                else:\n-                    objects.extend(model._default_manager.using(using).all())\n+        def get_objects():\n+            # Collate the objects to be serialized.\n+            for model in sort_dependencies(app_list.items()):\n+                if model in excluded_models:\n+                    continue\n+                if not model._meta.proxy and router.allow_syncdb(using, model):\n+                    if use_base_manager:\n+                        objects = model._base_manager\n+                    else:\n+                        objects = model._default_manager\n+                    for obj in objects.using(using).\\\n+                            order_by(model._meta.pk.name).iterator():\n+                        yield obj\n \n         try:\n-            self.stdout.write(serializers.serialize(format, objects,\n-                              indent=indent, use_natural_keys=use_natural_keys),\n-                              ending='')\n+            self.stdout.ending = None\n+            serializers.serialize(format, get_objects(), indent=indent,\n+                    use_natural_keys=use_natural_keys, stream=self.stdout)\n         except Exception as e:\n             if show_traceback:\n                 raise"
        },
        {
            "sha": "04053c1f8fa8ac6e12ebefa1e7a9354bd874d597",
            "filename": "django/core/serializers/base.py",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fserializers%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fserializers%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fserializers%2Fbase.py?ref=3b5083bee5e96539dec599106aece9889e70ce05",
            "patch": "@@ -39,6 +39,7 @@ def serialize(self, queryset, **options):\n         self.use_natural_keys = options.pop(\"use_natural_keys\", False)\n \n         self.start_serialization()\n+        self.first = True\n         for obj in queryset:\n             self.start_object(obj)\n             # Use the concrete parent class' _meta instead of the object's _meta\n@@ -57,6 +58,8 @@ def serialize(self, queryset, **options):\n                     if self.selected_fields is None or field.attname in self.selected_fields:\n                         self.handle_m2m_field(obj, field)\n             self.end_object(obj)\n+            if self.first:\n+                self.first = False\n         self.end_serialization()\n         return self.getvalue()\n "
        },
        {
            "sha": "fce00600f4a802ddc3aca6c2086321175d3de0f8",
            "filename": "django/core/serializers/json.py",
            "status": "modified",
            "additions": 27,
            "deletions": 2,
            "changes": 29,
            "blob_url": "https://github.com/django/django/blob/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fserializers%2Fjson.py",
            "raw_url": "https://github.com/django/django/raw/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fserializers%2Fjson.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fserializers%2Fjson.py?ref=3b5083bee5e96539dec599106aece9889e70ce05",
            "patch": "@@ -21,13 +21,38 @@ class Serializer(PythonSerializer):\n     \"\"\"\n     internal_use_only = False\n \n-    def end_serialization(self):\n+    def start_serialization(self):\n         if json.__version__.split('.') >= ['2', '1', '3']:\n             # Use JS strings to represent Python Decimal instances (ticket #16850)\n             self.options.update({'use_decimal': False})\n-        json.dump(self.objects, self.stream, cls=DjangoJSONEncoder, **self.options)\n+        self._current = None\n+        self.json_kwargs = self.options.copy()\n+        self.json_kwargs.pop('stream', None)\n+        self.json_kwargs.pop('fields', None)\n+        self.stream.write(\"[\")\n+\n+    def end_serialization(self):\n+        if self.options.get(\"indent\"):\n+            self.stream.write(\"\\n\")\n+        self.stream.write(\"]\")\n+        if self.options.get(\"indent\"):\n+            self.stream.write(\"\\n\")\n+\n+    def end_object(self, obj):\n+        # self._current has the field data\n+        indent = self.options.get(\"indent\")\n+        if not self.first:\n+            self.stream.write(\",\")\n+            if not indent:\n+                self.stream.write(\" \")\n+        if indent:\n+            self.stream.write(\"\\n\")\n+        json.dump(self.get_dump_object(obj), self.stream,\n+                  cls=DjangoJSONEncoder, **self.json_kwargs)\n+        self._current = None\n \n     def getvalue(self):\n+        # overwrite PythonSerializer.getvalue() with base Serializer.getvalue()\n         if callable(getattr(self.stream, 'getvalue', None)):\n             return self.stream.getvalue()\n "
        },
        {
            "sha": "49120434ebe8d8aa73ff283daa3a311c9a99b94b",
            "filename": "django/core/serializers/python.py",
            "status": "modified",
            "additions": 8,
            "deletions": 5,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fserializers%2Fpython.py",
            "raw_url": "https://github.com/django/django/raw/3b5083bee5e96539dec599106aece9889e70ce05/django%2Fcore%2Fserializers%2Fpython.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fserializers%2Fpython.py?ref=3b5083bee5e96539dec599106aece9889e70ce05",
            "patch": "@@ -27,13 +27,16 @@ def start_object(self, obj):\n         self._current = {}\n \n     def end_object(self, obj):\n-        self.objects.append({\n-            \"model\"  : smart_unicode(obj._meta),\n-            \"pk\"     : smart_unicode(obj._get_pk_val(), strings_only=True),\n-            \"fields\" : self._current\n-        })\n+        self.objects.append(self.get_dump_object(obj))\n         self._current = None\n \n+    def get_dump_object(self, obj):\n+        return {\n+            \"pk\": smart_unicode(obj._get_pk_val(), strings_only=True),\n+            \"model\": smart_unicode(obj._meta),\n+            \"fields\": self._current\n+        }\n+\n     def handle_field(self, obj, field):\n         value = field._get_val_from_obj(obj)\n         # Protected types (i.e., primitives like None, numbers, dates,"
        },
        {
            "sha": "48a5fe7f168d01d3940c0865806e5e54df25419a",
            "filename": "tests/modeltests/fixtures/tests.py",
            "status": "modified",
            "additions": 13,
            "deletions": 13,
            "changes": 26,
            "blob_url": "https://github.com/django/django/blob/3b5083bee5e96539dec599106aece9889e70ce05/tests%2Fmodeltests%2Ffixtures%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/3b5083bee5e96539dec599106aece9889e70ce05/tests%2Fmodeltests%2Ffixtures%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ffixtures%2Ftests.py?ref=3b5083bee5e96539dec599106aece9889e70ce05",
            "patch": "@@ -54,25 +54,25 @@ def test_loading_and_dumping(self):\n         ])\n \n         # Dump the current contents of the database as a JSON fixture\n-        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]')\n+        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]')\n \n         # Try just dumping the contents of fixtures.Category\n         self._dumpdata_assert(['fixtures.Category'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}]')\n \n         # ...and just fixtures.Article\n-        self._dumpdata_assert(['fixtures.Article'], '[{\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}]')\n+        self._dumpdata_assert(['fixtures.Article'], '[{\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}]')\n \n         # ...and both\n-        self._dumpdata_assert(['fixtures.Category', 'fixtures.Article'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}]')\n+        self._dumpdata_assert(['fixtures.Category', 'fixtures.Article'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}]')\n \n         # Specify a specific model twice\n-        self._dumpdata_assert(['fixtures.Article', 'fixtures.Article'], '[{\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}]')\n+        self._dumpdata_assert(['fixtures.Article', 'fixtures.Article'], '[{\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}]')\n \n         # Specify a dump that specifies Article both explicitly and implicitly\n-        self._dumpdata_assert(['fixtures.Article', 'fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]')\n+        self._dumpdata_assert(['fixtures.Article', 'fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]')\n \n         # Same again, but specify in the reverse order\n-        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]')\n+        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]')\n \n         # Specify one model from one application, and an entire other application.\n         self._dumpdata_assert(['fixtures.Category', 'sites'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 1, \"model\": \"sites.site\", \"fields\": {\"domain\": \"example.com\", \"name\": \"example.com\"}}]')\n@@ -143,17 +143,17 @@ def test_loading_and_dumping(self):\n         ])\n \n         # By default, you get raw keys on dumpdata\n-        self._dumpdata_assert(['fixtures.book'], '[{\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}, {\"pk\": 1, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Music for all ages\", \"authors\": [3, 1]}}]')\n+        self._dumpdata_assert(['fixtures.book'], '[{\"pk\": 1, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Music for all ages\", \"authors\": [3, 1]}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]')\n \n         # But you can get natural keys if you ask for them and they are available\n-        self._dumpdata_assert(['fixtures.book'], '[{\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}, {\"pk\": 1, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Music for all ages\", \"authors\": [[\"Artist formerly known as \\\\\"Prince\\\\\"\"], [\"Django Reinhardt\"]]}}]', natural_keys=True)\n+        self._dumpdata_assert(['fixtures.book'], '[{\"pk\": 1, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Music for all ages\", \"authors\": [[\"Artist formerly known as \\\\\"Prince\\\\\"\"], [\"Django Reinhardt\"]]}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]', natural_keys=True)\n \n         # Dump the current contents of the database as a JSON fixture\n-        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 5, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"XML identified as leading cause of cancer\", \"pub_date\": \"2006-06-16T16:00:00\"}}, {\"pk\": 4, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Django conquers world!\", \"pub_date\": \"2006-06-16T15:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Copyright is fine the way it is\", \"pub_date\": \"2006-06-16T14:00:00\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker on TV is great!\", \"pub_date\": \"2006-06-16T11:00:00\"}}, {\"pk\": 1, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"copyright\", \"tagged_id\": 3}}, {\"pk\": 2, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"legal\", \"tagged_id\": 3}}, {\"pk\": 3, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"django\", \"tagged_id\": 4}}, {\"pk\": 4, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"world domination\", \"tagged_id\": 4}}, {\"pk\": 3, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Artist formerly known as \\\\\"Prince\\\\\"\"}}, {\"pk\": 1, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Django Reinhardt\"}}, {\"pk\": 2, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Stephane Grappelli\"}}, {\"pk\": 1, \"model\": \"fixtures.visa\", \"fields\": {\"person\": [\"Django Reinhardt\"], \"permissions\": [[\"add_user\", \"auth\", \"user\"], [\"change_user\", \"auth\", \"user\"], [\"delete_user\", \"auth\", \"user\"]]}}, {\"pk\": 2, \"model\": \"fixtures.visa\", \"fields\": {\"person\": [\"Stephane Grappelli\"], \"permissions\": [[\"add_user\", \"auth\", \"user\"], [\"delete_user\", \"auth\", \"user\"]]}}, {\"pk\": 3, \"model\": \"fixtures.visa\", \"fields\": {\"person\": [\"Artist formerly known as \\\\\"Prince\\\\\"\"], \"permissions\": [[\"change_user\", \"auth\", \"user\"]]}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}, {\"pk\": 1, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Music for all ages\", \"authors\": [[\"Artist formerly known as \\\\\"Prince\\\\\"\"], [\"Django Reinhardt\"]]}}]', natural_keys=True)\n+        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker on TV is great!\", \"pub_date\": \"2006-06-16T11:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Copyright is fine the way it is\", \"pub_date\": \"2006-06-16T14:00:00\"}}, {\"pk\": 4, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Django conquers world!\", \"pub_date\": \"2006-06-16T15:00:00\"}}, {\"pk\": 5, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"XML identified as leading cause of cancer\", \"pub_date\": \"2006-06-16T16:00:00\"}}, {\"pk\": 1, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"copyright\", \"tagged_id\": 3}}, {\"pk\": 2, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"legal\", \"tagged_id\": 3}}, {\"pk\": 3, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"django\", \"tagged_id\": 4}}, {\"pk\": 4, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"world domination\", \"tagged_id\": 4}}, {\"pk\": 1, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Django Reinhardt\"}}, {\"pk\": 2, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Stephane Grappelli\"}}, {\"pk\": 3, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Artist formerly known as \\\\\"Prince\\\\\"\"}}, {\"pk\": 1, \"model\": \"fixtures.visa\", \"fields\": {\"person\": [\"Django Reinhardt\"], \"permissions\": [[\"add_user\", \"auth\", \"user\"], [\"change_user\", \"auth\", \"user\"], [\"delete_user\", \"auth\", \"user\"]]}}, {\"pk\": 2, \"model\": \"fixtures.visa\", \"fields\": {\"person\": [\"Stephane Grappelli\"], \"permissions\": [[\"add_user\", \"auth\", \"user\"], [\"delete_user\", \"auth\", \"user\"]]}}, {\"pk\": 3, \"model\": \"fixtures.visa\", \"fields\": {\"person\": [\"Artist formerly known as \\\\\"Prince\\\\\"\"], \"permissions\": [[\"change_user\", \"auth\", \"user\"]]}}, {\"pk\": 1, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Music for all ages\", \"authors\": [[\"Artist formerly known as \\\\\"Prince\\\\\"\"], [\"Django Reinhardt\"]]}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]', natural_keys=True)\n \n         # Dump the current contents of the database as an XML fixture\n         self._dumpdata_assert(['fixtures'], \"\"\"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n-<django-objects version=\"1.0\"><object pk=\"1\" model=\"fixtures.category\"><field type=\"CharField\" name=\"title\">News Stories</field><field type=\"TextField\" name=\"description\">Latest news stories</field></object><object pk=\"5\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">XML identified as leading cause of cancer</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T16:00:00</field></object><object pk=\"4\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Django conquers world!</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T15:00:00</field></object><object pk=\"3\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Copyright is fine the way it is</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T14:00:00</field></object><object pk=\"2\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Poker on TV is great!</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T11:00:00</field></object><object pk=\"1\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">copyright</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"2\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">legal</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"3\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">django</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">4</field></object><object pk=\"4\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">world domination</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">4</field></object><object pk=\"3\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Artist formerly known as \"Prince\"</field></object><object pk=\"1\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Django Reinhardt</field></object><object pk=\"2\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Stephane Grappelli</field></object><object pk=\"1\" model=\"fixtures.visa\"><field to=\"fixtures.person\" name=\"person\" rel=\"ManyToOneRel\"><natural>Django Reinhardt</natural></field><field to=\"auth.permission\" name=\"permissions\" rel=\"ManyToManyRel\"><object><natural>add_user</natural><natural>auth</natural><natural>user</natural></object><object><natural>change_user</natural><natural>auth</natural><natural>user</natural></object><object><natural>delete_user</natural><natural>auth</natural><natural>user</natural></object></field></object><object pk=\"2\" model=\"fixtures.visa\"><field to=\"fixtures.person\" name=\"person\" rel=\"ManyToOneRel\"><natural>Stephane Grappelli</natural></field><field to=\"auth.permission\" name=\"permissions\" rel=\"ManyToManyRel\"><object><natural>add_user</natural><natural>auth</natural><natural>user</natural></object><object><natural>delete_user</natural><natural>auth</natural><natural>user</natural></object></field></object><object pk=\"3\" model=\"fixtures.visa\"><field to=\"fixtures.person\" name=\"person\" rel=\"ManyToOneRel\"><natural>Artist formerly known as \"Prince\"</natural></field><field to=\"auth.permission\" name=\"permissions\" rel=\"ManyToManyRel\"><object><natural>change_user</natural><natural>auth</natural><natural>user</natural></object></field></object><object pk=\"10\" model=\"fixtures.book\"><field type=\"CharField\" name=\"name\">Achieving self-awareness of Python programs</field><field to=\"fixtures.person\" name=\"authors\" rel=\"ManyToManyRel\"></field></object><object pk=\"1\" model=\"fixtures.book\"><field type=\"CharField\" name=\"name\">Music for all ages</field><field to=\"fixtures.person\" name=\"authors\" rel=\"ManyToManyRel\"><object><natural>Artist formerly known as \"Prince\"</natural></object><object><natural>Django Reinhardt</natural></object></field></object></django-objects>\"\"\", format='xml', natural_keys=True)\n+<django-objects version=\"1.0\"><object pk=\"1\" model=\"fixtures.category\"><field type=\"CharField\" name=\"title\">News Stories</field><field type=\"TextField\" name=\"description\">Latest news stories</field></object><object pk=\"2\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Poker on TV is great!</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T11:00:00</field></object><object pk=\"3\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Copyright is fine the way it is</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T14:00:00</field></object><object pk=\"4\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Django conquers world!</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T15:00:00</field></object><object pk=\"5\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">XML identified as leading cause of cancer</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T16:00:00</field></object><object pk=\"1\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">copyright</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"2\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">legal</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"3\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">django</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">4</field></object><object pk=\"4\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">world domination</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">4</field></object><object pk=\"1\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Django Reinhardt</field></object><object pk=\"2\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Stephane Grappelli</field></object><object pk=\"3\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Artist formerly known as \"Prince\"</field></object><object pk=\"1\" model=\"fixtures.visa\"><field to=\"fixtures.person\" name=\"person\" rel=\"ManyToOneRel\"><natural>Django Reinhardt</natural></field><field to=\"auth.permission\" name=\"permissions\" rel=\"ManyToManyRel\"><object><natural>add_user</natural><natural>auth</natural><natural>user</natural></object><object><natural>change_user</natural><natural>auth</natural><natural>user</natural></object><object><natural>delete_user</natural><natural>auth</natural><natural>user</natural></object></field></object><object pk=\"2\" model=\"fixtures.visa\"><field to=\"fixtures.person\" name=\"person\" rel=\"ManyToOneRel\"><natural>Stephane Grappelli</natural></field><field to=\"auth.permission\" name=\"permissions\" rel=\"ManyToManyRel\"><object><natural>add_user</natural><natural>auth</natural><natural>user</natural></object><object><natural>delete_user</natural><natural>auth</natural><natural>user</natural></object></field></object><object pk=\"3\" model=\"fixtures.visa\"><field to=\"fixtures.person\" name=\"person\" rel=\"ManyToOneRel\"><natural>Artist formerly known as \"Prince\"</natural></field><field to=\"auth.permission\" name=\"permissions\" rel=\"ManyToManyRel\"><object><natural>change_user</natural><natural>auth</natural><natural>user</natural></object></field></object><object pk=\"1\" model=\"fixtures.book\"><field type=\"CharField\" name=\"name\">Music for all ages</field><field to=\"fixtures.person\" name=\"authors\" rel=\"ManyToManyRel\"><object><natural>Artist formerly known as \"Prince\"</natural></object><object><natural>Django Reinhardt</natural></object></field></object><object pk=\"10\" model=\"fixtures.book\"><field type=\"CharField\" name=\"name\">Achieving self-awareness of Python programs</field><field to=\"fixtures.person\" name=\"authors\" rel=\"ManyToManyRel\"></field></object></django-objects>\"\"\", format='xml', natural_keys=True)\n \n     def test_dumpdata_with_excludes(self):\n         # Load fixture1 which has a site, two articles, and a category\n@@ -292,11 +292,11 @@ def test_output_formats(self):\n         ])\n \n         # Dump the current contents of the database as a JSON fixture\n-        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 1, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"copyright\", \"tagged_id\": 3}}, {\"pk\": 2, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"law\", \"tagged_id\": 3}}, {\"pk\": 1, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Django Reinhardt\"}}, {\"pk\": 3, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Prince\"}}, {\"pk\": 2, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Stephane Grappelli\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]', natural_keys=True)\n+        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 1, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"copyright\", \"tagged_id\": 3}}, {\"pk\": 2, \"model\": \"fixtures.tag\", \"fields\": {\"tagged_type\": [\"fixtures\", \"article\"], \"name\": \"law\", \"tagged_id\": 3}}, {\"pk\": 1, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Django Reinhardt\"}}, {\"pk\": 2, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Stephane Grappelli\"}}, {\"pk\": 3, \"model\": \"fixtures.person\", \"fields\": {\"name\": \"Prince\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]', natural_keys=True)\n \n         # Dump the current contents of the database as an XML fixture\n         self._dumpdata_assert(['fixtures'], \"\"\"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n-<django-objects version=\"1.0\"><object pk=\"1\" model=\"fixtures.category\"><field type=\"CharField\" name=\"title\">News Stories</field><field type=\"TextField\" name=\"description\">Latest news stories</field></object><object pk=\"3\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Time to reform copyright</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T13:00:00</field></object><object pk=\"2\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Poker has no place on ESPN</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T12:00:00</field></object><object pk=\"1\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">copyright</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"2\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">law</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"1\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Django Reinhardt</field></object><object pk=\"3\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Prince</field></object><object pk=\"2\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Stephane Grappelli</field></object><object pk=\"10\" model=\"fixtures.book\"><field type=\"CharField\" name=\"name\">Achieving self-awareness of Python programs</field><field to=\"fixtures.person\" name=\"authors\" rel=\"ManyToManyRel\"></field></object></django-objects>\"\"\", format='xml', natural_keys=True)\n+<django-objects version=\"1.0\"><object pk=\"1\" model=\"fixtures.category\"><field type=\"CharField\" name=\"title\">News Stories</field><field type=\"TextField\" name=\"description\">Latest news stories</field></object><object pk=\"2\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Poker has no place on ESPN</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T12:00:00</field></object><object pk=\"3\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Time to reform copyright</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T13:00:00</field></object><object pk=\"1\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">copyright</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"2\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">law</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"1\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Django Reinhardt</field></object><object pk=\"2\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Stephane Grappelli</field></object><object pk=\"3\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Prince</field></object><object pk=\"10\" model=\"fixtures.book\"><field type=\"CharField\" name=\"name\">Achieving self-awareness of Python programs</field><field to=\"fixtures.person\" name=\"authors\" rel=\"ManyToManyRel\"></field></object></django-objects>\"\"\", format='xml', natural_keys=True)\n \n class FixtureTransactionTests(TransactionTestCase):\n     def _dumpdata_assert(self, args, output, format='json'):\n@@ -329,7 +329,7 @@ def test_format_discovery(self):\n         ])\n \n         # Dump the current contents of the database as a JSON fixture\n-        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]')\n+        self._dumpdata_assert(['fixtures'], '[{\"pk\": 1, \"model\": \"fixtures.category\", \"fields\": {\"description\": \"Latest news stories\", \"title\": \"News Stories\"}}, {\"pk\": 2, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Poker has no place on ESPN\", \"pub_date\": \"2006-06-16T12:00:00\"}}, {\"pk\": 3, \"model\": \"fixtures.article\", \"fields\": {\"headline\": \"Time to reform copyright\", \"pub_date\": \"2006-06-16T13:00:00\"}}, {\"pk\": 10, \"model\": \"fixtures.book\", \"fields\": {\"name\": \"Achieving self-awareness of Python programs\", \"authors\": []}}]')\n \n         # Load fixture 4 (compressed), using format discovery\n         management.call_command('loaddata', 'fixture4', verbosity=0, commit=False)"
        }
    ],
    "stats": {
        "total": 115,
        "additions": 75,
        "deletions": 40
    }
}