{
    "author": "jakul",
    "message": "Made (make|compile)messages commands accept multiple locales at once.\n\nThanks Craig Blaszczyk for the initial patch. Refs #17181.",
    "sha": "6158c79dbef832bc8530107ab2d34f04a04471da",
    "files": [
        {
            "sha": "16bfa574c92552fe3eb2323dac1f44bd67fa1331",
            "filename": "AUTHORS",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/6158c79dbef832bc8530107ab2d34f04a04471da/AUTHORS",
            "raw_url": "https://github.com/django/django/raw/6158c79dbef832bc8530107ab2d34f04a04471da/AUTHORS",
            "contents_url": "https://api.github.com/repos/django/django/contents/AUTHORS?ref=6158c79dbef832bc8530107ab2d34f04a04471da",
            "patch": "@@ -98,6 +98,7 @@ answer newbie questions, and generally made Django that much better:\n     Mark Biggers <biggers@utsl.com>\n     Paul Bissex <http://e-scribe.com/>\n     Simon Blanchard\n+    Craig Blaszczyk <masterjakul@gmail.com>\n     David Blewett <david@dawninglight.net>\n     Matt Boersma <matt@sprout.org>\n     Artem Gnilov <boobsd@gmail.com>"
        },
        {
            "sha": "684ef3514cc5a5cbebad04b1c72625609cfc1c9e",
            "filename": "django/core/management/commands/compilemessages.py",
            "status": "modified",
            "additions": 10,
            "deletions": 6,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/6158c79dbef832bc8530107ab2d34f04a04471da/django%2Fcore%2Fmanagement%2Fcommands%2Fcompilemessages.py",
            "raw_url": "https://github.com/django/django/raw/6158c79dbef832bc8530107ab2d34f04a04471da/django%2Fcore%2Fmanagement%2Fcommands%2Fcompilemessages.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fcompilemessages.py?ref=6158c79dbef832bc8530107ab2d34f04a04471da",
            "patch": "@@ -28,10 +28,14 @@ def compile_messages(stderr, locale=None):\n \n     for basedir in basedirs:\n         if locale:\n-            basedir = os.path.join(basedir, locale, 'LC_MESSAGES')\n-        for dirpath, dirnames, filenames in os.walk(basedir):\n-            for f in filenames:\n-                if f.endswith('.po'):\n+            dirs = [os.path.join(basedir, l, 'LC_MESSAGES') for l in (locale if isinstance(locale, list) else [locale])]\n+        else:\n+            dirs = [basedir]\n+        for ldir in dirs:\n+            for dirpath, dirnames, filenames in os.walk(ldir):\n+                for f in filenames:\n+                    if not f.endswith('.po'):\n+                        continue\n                     stderr.write('processing file %s in %s\\n' % (f, dirpath))\n                     fn = os.path.join(dirpath, f)\n                     if has_bom(fn):\n@@ -53,8 +57,8 @@ def compile_messages(stderr, locale=None):\n \n class Command(BaseCommand):\n     option_list = BaseCommand.option_list + (\n-        make_option('--locale', '-l', dest='locale',\n-            help='The locale to process. Default is to process all.'),\n+        make_option('--locale', '-l', dest='locale', action='append',\n+                    help='locale(s) to process (e.g. de_AT). Default is to process all. Can be used multiple times, accepts a comma-separated list of locale names.'),\n     )\n     help = 'Compiles .po files to .mo files for use with builtin gettext support.'\n "
        },
        {
            "sha": "31971a9101744797aba5b20925b53c1bc37138b6",
            "filename": "django/core/management/commands/makemessages.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/6158c79dbef832bc8530107ab2d34f04a04471da/django%2Fcore%2Fmanagement%2Fcommands%2Fmakemessages.py",
            "raw_url": "https://github.com/django/django/raw/6158c79dbef832bc8530107ab2d34f04a04471da/django%2Fcore%2Fmanagement%2Fcommands%2Fmakemessages.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fmakemessages.py?ref=6158c79dbef832bc8530107ab2d34f04a04471da",
            "patch": "@@ -304,7 +304,7 @@ def make_messages(locale=None, domain='django', verbosity=1, all=False,\n \n     locales = []\n     if locale is not None:\n-        locales.append(str(locale))\n+        locales += locale.split(',') if not isinstance(locale, list) else locale\n     elif all:\n         locale_dirs = filter(os.path.isdir, glob.glob('%s/*' % localedir))\n         locales = [os.path.basename(l) for l in locale_dirs]\n@@ -341,8 +341,8 @@ def make_messages(locale=None, domain='django', verbosity=1, all=False,\n \n class Command(NoArgsCommand):\n     option_list = NoArgsCommand.option_list + (\n-        make_option('--locale', '-l', default=None, dest='locale',\n-            help='Creates or updates the message files for the given locale (e.g. pt_BR).'),\n+        make_option('--locale', '-l', default=None, dest='locale', action='append',\n+            help='Creates or updates the message files for the given locale(s) (e.g. pt_BR). Can be used multiple times, accepts a comma-separated list of locale names.'),\n         make_option('--domain', '-d', default='django', dest='domain',\n             help='The domain of the message files (default: \"django\").'),\n         make_option('--all', '-a', action='store_true', dest='all',"
        },
        {
            "sha": "06ec8e203182fdaa048de9d76fdf720f4f106d3a",
            "filename": "docs/ref/django-admin.txt",
            "status": "modified",
            "additions": 25,
            "deletions": 3,
            "changes": 28,
            "blob_url": "https://github.com/django/django/blob/6158c79dbef832bc8530107ab2d34f04a04471da/docs%2Fref%2Fdjango-admin.txt",
            "raw_url": "https://github.com/django/django/raw/6158c79dbef832bc8530107ab2d34f04a04471da/docs%2Fref%2Fdjango-admin.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fdjango-admin.txt?ref=6158c79dbef832bc8530107ab2d34f04a04471da",
            "patch": "@@ -107,12 +107,21 @@ compilemessages\n Compiles .po files created with ``makemessages`` to .mo files for use with\n the builtin gettext support. See :doc:`/topics/i18n/index`.\n \n-Use the :djadminopt:`--locale` option to specify the locale to process.\n-If not provided, all locales are processed.\n+Use the :djadminopt:`--locale` option (or its shorter version ``-l``) to\n+specify the locale(s) to process. If not provided, all locales are processed.\n \n Example usage::\n \n     django-admin.py compilemessages --locale=pt_BR\n+    django-admin.py compilemessages --locale=pt_BR --locale=fr\n+    django-admin.py compilemessages -l pt_BR\n+    django-admin.py compilemessages -l pt_BR -l fr\n+    django-admin.py compilemessages --locale=pt_BR,fr\n+    django-admin.py compilemessages -l pt_BR,fr\n+\n+.. versionchanged:: 1.6\n+\n+Added the ability to specify multiple locales.\n \n createcachetable\n ----------------\n@@ -422,11 +431,24 @@ Separate multiple extensions with commas or use -e or --extension multiple times\n \n     django-admin.py makemessages --locale=de --extension=html,txt --extension xml\n \n-Use the :djadminopt:`--locale` option to specify the locale to process.\n+Use the :djadminopt:`--locale` option (or its shorter version ``-l``) to\n+specify the locale(s) to process.\n \n Example usage::\n \n     django-admin.py makemessages --locale=pt_BR\n+    django-admin.py makemessages --locale=pt_BR --locale=fr\n+    django-admin.py makemessages -l pt_BR\n+    django-admin.py makemessages -l pt_BR -l fr\n+\n+You can also use commas to separate multiple locales::\n+\n+    django-admin.py makemessages --locale=de,fr,pt_BR\n+    django-admin.py makemessages -l de,fr,pt_BR\n+\n+.. versionchanged:: 1.6\n+\n+Added the ability to specify multiple locales.\n \n .. django-admin-option:: --domain\n "
        },
        {
            "sha": "c15b95eb0e36d62fd7d790fbe22f9c4103982636",
            "filename": "tests/regressiontests/i18n/commands/compilation.py",
            "status": "modified",
            "additions": 31,
            "deletions": 0,
            "changes": 31,
            "blob_url": "https://github.com/django/django/blob/6158c79dbef832bc8530107ab2d34f04a04471da/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fcompilation.py",
            "raw_url": "https://github.com/django/django/raw/6158c79dbef832bc8530107ab2d34f04a04471da/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fcompilation.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fcompilation.py?ref=6158c79dbef832bc8530107ab2d34f04a04471da",
            "patch": "@@ -68,3 +68,34 @@ def test_percent_symbol_escaping(self):\n             t = Template('{% load i18n %}{% trans \"Completed 50%% of all the tasks\" %}')\n             rendered = t.render(Context({}))\n             self.assertEqual(rendered, 'IT translation of Completed 50%% of all the tasks')\n+\n+\n+@override_settings(LOCALE_PATHS=(os.path.join(test_dir, 'locale'),))\n+class MultipleLocaleCompilationTests(MessageCompilationTests):\n+    MO_FILE_HR = None\n+    MO_FILE_FR = None\n+\n+    def setUp(self):\n+        super(MultipleLocaleCompilationTests, self).setUp()\n+        self.localedir = os.path.join(test_dir, 'locale')\n+        self.MO_FILE_HR = os.path.join(self.localedir, 'hr/LC_MESSAGES/django.mo')\n+        self.MO_FILE_FR = os.path.join(self.localedir, 'fr/LC_MESSAGES/django.mo')\n+        self.addCleanup(self._rmfile, os.path.join(self.localedir, self.MO_FILE_HR))\n+        self.addCleanup(self._rmfile, os.path.join(self.localedir, self.MO_FILE_FR))\n+\n+    def _rmfile(self, filepath):\n+        if os.path.exists(filepath):\n+            os.remove(filepath)\n+\n+    def test_one_locale(self):\n+        os.chdir(test_dir)\n+        call_command('compilemessages', locale='hr', stderr=StringIO())\n+\n+        self.assertTrue(os.path.exists(self.MO_FILE_HR))\n+\n+    def test_multiple_locales(self):\n+        os.chdir(test_dir)\n+        call_command('compilemessages', locale=['hr', 'fr'], stderr=StringIO())\n+\n+        self.assertTrue(os.path.exists(self.MO_FILE_HR))\n+        self.assertTrue(os.path.exists(self.MO_FILE_FR))"
        },
        {
            "sha": "1d6a72d725c2bbafb5c3596d446e8645971cd5b4",
            "filename": "tests/regressiontests/i18n/commands/extraction.py",
            "status": "modified",
            "additions": 27,
            "deletions": 0,
            "changes": 27,
            "blob_url": "https://github.com/django/django/blob/6158c79dbef832bc8530107ab2d34f04a04471da/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fextraction.py",
            "raw_url": "https://github.com/django/django/raw/6158c79dbef832bc8530107ab2d34f04a04471da/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fextraction.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fextraction.py?ref=6158c79dbef832bc8530107ab2d34f04a04471da",
            "patch": "@@ -327,3 +327,30 @@ def test_keep_pot_enabled(self):\n         management.call_command('makemessages', locale=LOCALE, verbosity=0,\n                                 keep_pot=True)\n         self.assertTrue(os.path.exists(self.POT_FILE))\n+\n+\n+class MultipleLocaleExtractionTests(ExtractorTests):\n+    PO_FILE_PT = 'locale/pt/LC_MESSAGES/django.po'\n+    PO_FILE_DE = 'locale/de/LC_MESSAGES/django.po'\n+    LOCALES = ['pt', 'de', 'ch']\n+\n+    def tearDown(self):\n+        os.chdir(self.test_dir)\n+        for locale in self.LOCALES:\n+            try:\n+                self._rmrf('locale/%s' % locale)\n+            except OSError:\n+                pass\n+        os.chdir(self._cwd)\n+\n+    def test_multiple_locales(self):\n+        os.chdir(self.test_dir)\n+        management.call_command('makemessages', locale=['pt','de'], verbosity=0)\n+        self.assertTrue(os.path.exists(self.PO_FILE_PT))\n+        self.assertTrue(os.path.exists(self.PO_FILE_DE))\n+\n+    def test_comma_separated_locales(self):\n+        os.chdir(self.test_dir)\n+        management.call_command('makemessages', locale='pt,de,ch', verbosity=0)\n+        self.assertTrue(os.path.exists(self.PO_FILE_PT))\n+        self.assertTrue(os.path.exists(self.PO_FILE_DE))"
        },
        {
            "sha": "663ca0000f9a82b35877a396e7794cfd76ad0840",
            "filename": "tests/regressiontests/i18n/commands/locale/hr/LC_MESSAGES/django.po",
            "status": "added",
            "additions": 71,
            "deletions": 0,
            "changes": 71,
            "blob_url": "https://github.com/django/django/blob/6158c79dbef832bc8530107ab2d34f04a04471da/tests%2Fregressiontests%2Fi18n%2Fcommands%2Flocale%2Fhr%2FLC_MESSAGES%2Fdjango.po",
            "raw_url": "https://github.com/django/django/raw/6158c79dbef832bc8530107ab2d34f04a04471da/tests%2Fregressiontests%2Fi18n%2Fcommands%2Flocale%2Fhr%2FLC_MESSAGES%2Fdjango.po",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fcommands%2Flocale%2Fhr%2FLC_MESSAGES%2Fdjango.po?ref=6158c79dbef832bc8530107ab2d34f04a04471da",
            "patch": "@@ -0,0 +1,71 @@\n+# SOME DESCRIPTIVE TITLE.\n+# Copyright (C) YEAR THE PACKAGE'S COPYRIGHT HOLDER\n+# This file is distributed under the same license as the PACKAGE package.\n+# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.\n+#\n+msgid \"\"\n+msgstr \"\"\n+\"Project-Id-Version: PACKAGE VERSION\\n\"\n+\"Report-Msgid-Bugs-To: \\n\"\n+\"POT-Creation-Date: 2011-12-04 04:59-0600\\n\"\n+\"PO-Revision-Date: 2013-01-16 22:53-0300\\n\"\n+\"Last-Translator: FULL NAME <EMAIL@ADDRESS>\\n\"\n+\"Language-Team: LANGUAGE <LL@li.org>\\n\"\n+\"Language: fr\\n\"\n+\"MIME-Version: 1.0\\n\"\n+\"Content-Type: text/plain; charset=UTF-8\\n\"\n+\"Content-Transfer-Encoding: 8bit\\n\"\n+\"Plural-Forms: nplurals=2; plural=(n != 1)\\n\"\n+\n+#. Translators: Django template comment for translators\n+#: templates/test.html:9\n+#, python-format\n+msgid \"I think that 100%% is more that 50%% of anything.\"\n+msgstr \"\"\n+\n+#: templates/test.html:10\n+#, python-format\n+msgid \"I think that 100%% is more that 50%% of %(obj)s.\"\n+msgstr \"\"\n+\n+#: templates/test.html:70\n+#, python-format\n+msgid \"Literal with a percent symbol at the end %%\"\n+msgstr \"\"\n+\n+#: templates/test.html:71\n+#, python-format\n+msgid \"Literal with a percent %% symbol in the middle\"\n+msgstr \"\"\n+\n+#: templates/test.html:72\n+#, python-format\n+msgid \"Completed 50%% of all the tasks\"\n+msgstr \"\"\n+\n+#: templates/test.html:73\n+#, python-format\n+msgctxt \"ctx0\"\n+msgid \"Completed 99%% of all the tasks\"\n+msgstr \"\"\n+\n+#: templates/test.html:74\n+#, python-format\n+msgid \"Shouldn't double escape this sequence: %% (two percent signs)\"\n+msgstr \"\"\n+\n+#: templates/test.html:75\n+#, python-format\n+msgctxt \"ctx1\"\n+msgid \"Shouldn't double escape this sequence %% either\"\n+msgstr \"\"\n+\n+#: templates/test.html:76\n+#, python-format\n+msgid \"Looks like a str fmt spec %%s but shouldn't be interpreted as such\"\n+msgstr \"Translation of the above string\"\n+\n+#: templates/test.html:77\n+#, python-format\n+msgid \"Looks like a str fmt spec %% o but shouldn't be interpreted as such\"\n+msgstr \"Translation contains %% for the above string\""
        },
        {
            "sha": "d9843c228a10deb03b97bfeb4831fa5d5f0a20c7",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/6158c79dbef832bc8530107ab2d34f04a04471da/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/6158c79dbef832bc8530107ab2d34f04a04471da/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=6158c79dbef832bc8530107ab2d34f04a04471da",
            "patch": "@@ -32,10 +32,11 @@\n     from .commands.extraction import (ExtractorTests, BasicExtractorTests,\n         JavascriptExtractorTests, IgnoredExtractorTests, SymlinkExtractorTests,\n         CopyPluralFormsExtractorTests, NoWrapExtractorTests,\n-        NoLocationExtractorTests, KeepPotFileExtractorTests)\n+        NoLocationExtractorTests, KeepPotFileExtractorTests,\n+        MultipleLocaleExtractionTests)\n if can_run_compilation_tests:\n     from .commands.compilation import (PoFileTests, PoFileContentsTests,\n-        PercentRenderingTests)\n+        PercentRenderingTests, MultipleLocaleCompilationTests)\n from .contenttypes.tests import ContentTypeTests\n from .forms import I18nForm, SelectDateForm, SelectDateWidget, CompanyForm\n from .models import Company, TestModel"
        }
    ],
    "stats": {
        "total": 185,
        "additions": 171,
        "deletions": 14
    }
}