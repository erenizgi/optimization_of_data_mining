{
    "author": "alex",
    "message": "Converted Canadian localflavor doctests to unittests.  We have always been at war with doctests.  Thanks to Idan Gazit.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@14934 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "3ed85841d1928bce2ce68b7e70c63ae8b48dd206",
    "files": [
        {
            "sha": "575f41c8bea2772a95b93d133f6040e537194535",
            "filename": "tests/regressiontests/forms/localflavor/ca.py",
            "status": "modified",
            "additions": 78,
            "deletions": 252,
            "changes": 330,
            "blob_url": "https://github.com/django/django/blob/3ed85841d1928bce2ce68b7e70c63ae8b48dd206/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fca.py",
            "raw_url": "https://github.com/django/django/raw/3ed85841d1928bce2ce68b7e70c63ae8b48dd206/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fca.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fca.py?ref=3ed85841d1928bce2ce68b7e70c63ae8b48dd206",
            "patch": "@@ -1,239 +1,14 @@\n-# -*- coding: utf-8 -*-\n-# Tests for the contrib/localflavor/ CA form fields.\n+from django.contrib.localflavor.ca.forms import (CAPostalCodeField,\n+        CAPhoneNumberField, CAProvinceField, CAProvinceSelect,\n+        CASocialInsuranceNumberField)\n \n-tests = r\"\"\"\n-# CAPostalCodeField ##############################################################\n+from utils import LocalFlavorTestCase\n \n-CAPostalCodeField validates that the data is a six-character Canadian postal code.\n->>> from django.contrib.localflavor.ca.forms import CAPostalCodeField\n->>> f = CAPostalCodeField()\n->>> f.clean('T2S 2H7')\n-u'T2S 2H7'\n->>> f.clean('T2S 2H')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('2T6 H8I')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('T2S2H')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean(90210)\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean(None)\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n->>> f.clean('')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n->>> f = CAPostalCodeField(required=False)\n->>> f.clean('T2S 2H7')\n-u'T2S 2H7'\n->>> f.clean('T2S2H7')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('T2S 2H')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('2T6 H8I')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('T2S2H')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean(90210)\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean(None)\n-u''\n->>> f.clean('')\n-u''\n->>> f.clean('W2S 2H3')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('T2W 2H7')\n-u'T2W 2H7'\n->>> f.clean('T2S 2W7')\n-u'T2S 2W7'\n->>> f.clean('Z2S 2H3')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('T2Z 2H7')\n-u'T2Z 2H7'\n->>> f.clean('T2S 2Z7')\n-u'T2S 2Z7'\n->>> f.clean('F2S 2H3')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('A2S 2D3')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('A2I 2R3')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('A2I 2R3')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('A2Q 2R3')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('U2B 2R3')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n->>> f.clean('O2B 2R3')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a postal code in the format XXX XXX.']\n \n-# CAPhoneNumberField ##########################################################\n-\n-CAPhoneNumberField validates that the data is a valid Canadian phone number,\n-including the area code. It's normalized to XXX-XXX-XXXX format.\n-Note: This test is exactly the same as the USPhoneNumberField except using a real\n-Candian area code\n-\n->>> from django.contrib.localflavor.ca.forms import CAPhoneNumberField\n->>> f = CAPhoneNumberField()\n->>> f.clean('403-555-1212')\n-u'403-555-1212'\n->>> f.clean('4035551212')\n-u'403-555-1212'\n->>> f.clean('403 555-1212')\n-u'403-555-1212'\n->>> f.clean('(403) 555-1212')\n-u'403-555-1212'\n->>> f.clean('403 555 1212')\n-u'403-555-1212'\n->>> f.clean('403.555.1212')\n-u'403-555-1212'\n->>> f.clean('403.555-1212')\n-u'403-555-1212'\n->>> f.clean(' (403) 555.1212 ')\n-u'403-555-1212'\n->>> f.clean('555-1212')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Phone numbers must be in XXX-XXX-XXXX format.']\n->>> f.clean('403-55-1212')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Phone numbers must be in XXX-XXX-XXXX format.']\n->>> f.clean(None)\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n->>> f.clean('')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n-\n->>> f = CAPhoneNumberField(required=False)\n->>> f.clean('403-555-1212')\n-u'403-555-1212'\n->>> f.clean('4035551212')\n-u'403-555-1212'\n->>> f.clean('403 555-1212')\n-u'403-555-1212'\n->>> f.clean('(403) 555-1212')\n-u'403-555-1212'\n->>> f.clean('403 555 1212')\n-u'403-555-1212'\n->>> f.clean('403.555.1212')\n-u'403-555-1212'\n->>> f.clean('403.555-1212')\n-u'403-555-1212'\n->>> f.clean(' (403) 555.1212 ')\n-u'403-555-1212'\n->>> f.clean('555-1212')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Phone numbers must be in XXX-XXX-XXXX format.']\n->>> f.clean('403-55-1212')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Phone numbers must be in XXX-XXX-XXXX format.']\n->>> f.clean(None)\n-u''\n->>> f.clean('')\n-u''\n-\n-# CAProvinceField ################################################################\n-\n-CAProvinceField validates that the data is either an abbreviation or name of a\n-Canadian province.\n->>> from django.contrib.localflavor.ca.forms import CAProvinceField\n->>> f = CAProvinceField()\n->>> f.clean('ab')\n-u'AB'\n->>> f.clean('BC')\n-u'BC'\n->>> f.clean('nova scotia')\n-u'NS'\n->>> f.clean('  manitoba ')\n-u'MB'\n->>> f.clean(' new brunswick ')\n-u'NB'\n->>> f.clean('NB')\n-u'NB'\n->>> f.clean('T2S 2H7')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a Canadian province or territory.']\n->>> f.clean(None)\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n->>> f.clean('')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n-\n->>> f = CAProvinceField(required=False)\n->>> f.clean('ab')\n-u'AB'\n->>> f.clean('BC')\n-u'BC'\n->>> f.clean('nova scotia')\n-u'NS'\n->>> f.clean('  manitoba ')\n-u'MB'\n->>> f.clean('T2S 2H7')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a Canadian province or territory.']\n->>> f.clean(None)\n-u''\n->>> f.clean('')\n-u''\n-\n-# CAProvinceSelect ###############################################################\n-\n-CAProvinceSelect is a Select widget that uses a list of Canadian provinces/territories\n-as its choices.\n->>> from django.contrib.localflavor.ca.forms import CAProvinceSelect\n->>> w = CAProvinceSelect()\n->>> print w.render('province', 'AB')\n-<select name=\"province\">\n+class CALocalFlavorTests(LocalFlavorTestCase):\n+    def test_CAProvinceSelect(self):\n+        f = CAProvinceSelect()\n+        out = u'''<select name=\"province\">\n <option value=\"AB\" selected=\"selected\">Alberta</option>\n <option value=\"BC\">British Columbia</option>\n <option value=\"MB\">Manitoba</option>\n@@ -247,23 +22,74 @@\n <option value=\"QC\">Quebec</option>\n <option value=\"SK\">Saskatchewan</option>\n <option value=\"YK\">Yukon</option>\n-</select>\n+</select>'''\n+        self.assertEqual(f.render('province', 'AB'), out)\n+\n+    def test_CAPostalCodeField(self):\n+        error_format = [u'Enter a postal code in the format XXX XXX.']\n+        valid = {\n+            'T2S 2H7': 'T2S 2H7',\n+            'T2S 2W7': 'T2S 2W7',\n+            'T2S 2Z7': 'T2S 2Z7',\n+            'T2Z 2H7': 'T2Z 2H7',\n+\n+        }\n+        invalid = {\n+            'T2S2H7' : error_format,\n+            'T2S 2H' : error_format,\n+            '2T6 H8I': error_format,\n+            'T2S2H' : error_format,\n+            90210 : error_format,\n+            'W2S 2H3': error_format,\n+            'Z2S 2H3': error_format,\n+            'F2S 2H3': error_format,\n+            'A2S 2D3': error_format,\n+            'A2I 2R3': error_format,\n+            'A2Q 2R3': error_format,\n+            'U2B 2R3': error_format,\n+            'O2B 2R3': error_format,\n+        }\n+        self.assertFieldOutput(CAPostalCodeField, valid, invalid)\n+\n+    def test_CAPhoneNumberField(self):\n+        error_format = [u'Phone numbers must be in XXX-XXX-XXXX format.']\n+        valid = {\n+            '403-555-1212': '403-555-1212',\n+            '4035551212': '403-555-1212',\n+            '403 555-1212': '403-555-1212',\n+            '(403) 555-1212': '403-555-1212',\n+            '403 555 1212': '403-555-1212',\n+            '403.555.1212': '403-555-1212',\n+            '403.555-1212': '403-555-1212',\n+            ' (403) 555.1212 ': '403-555-1212',\n+        }\n+        invalid = {\n+           '555-1212': error_format,\n+           '403-55-1212': error_format,\n+        }\n+        self.assertFieldOutput(CAPhoneNumberField, valid, invalid)\n+\n+    def test_CAProvinceField(self):\n+        error_format = [u'Enter a Canadian province or territory.']\n+        valid = {\n+            'ab': 'AB',\n+            'BC': 'BC',\n+            'nova scotia': 'NS',\n+            '  manitoba ': 'MB',\n+        }\n+        invalid = {\n+            'T2S 2H7': error_format,\n+        }\n+        self.assertFieldOutput(CAProvinceField, valid, invalid)\n \n-# CASocialInsuranceNumberField #################################################\n->>> from django.contrib.localflavor.ca.forms import CASocialInsuranceNumberField\n->>> f = CASocialInsuranceNumberField()\n->>> f.clean('046-454-286')\n-u'046-454-286'\n->>> f.clean('046-454-287')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid Canadian Social Insurance number in XXX-XXX-XXX format.']\n->>> f.clean('046 454 286')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid Canadian Social Insurance number in XXX-XXX-XXX format.']\n->>> f.clean('046-44-286')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid Canadian Social Insurance number in XXX-XXX-XXX format.']\n-\"\"\"\n+    def test_CASocialInsuranceField(self):\n+        error_format = [u'Enter a valid Canadian Social Insurance number in XXX-XXX-XXX format.']\n+        valid = {\n+            '046-454-286': '046-454-286',\n+        }\n+        invalid = {\n+            '046-454-287': error_format,\n+            '046 454 286': error_format,\n+            '046-44-286': error_format,\n+        }\n+        self.assertFieldOutput(CASocialInsuranceNumberField, valid, invalid)"
        },
        {
            "sha": "51d51765ad83b714a889997099b6cfa3e3d8779e",
            "filename": "tests/regressiontests/forms/localflavortests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/3ed85841d1928bce2ce68b7e70c63ae8b48dd206/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "raw_url": "https://github.com/django/django/raw/3ed85841d1928bce2ce68b7e70c63ae8b48dd206/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py?ref=3ed85841d1928bce2ce68b7e70c63ae8b48dd206",
            "patch": "@@ -1,5 +1,4 @@\n # -*- coding: utf-8 -*-\n-from localflavor.ca import tests as localflavor_ca_tests\n from localflavor.ch import tests as localflavor_ch_tests\n from localflavor.cl import tests as localflavor_cl_tests\n from localflavor.cz import tests as localflavor_cz_tests\n@@ -30,12 +29,12 @@\n from localflavor.au import AULocalFlavorTests\n from localflavor.be import BELocalFlavorTests\n from localflavor.br import BRLocalFlavorTests\n+from localflavor.ca import CALocalFlavorTests\n from localflavor.il import ILLocalFlavorTests\n from localflavor.tr import TRLocalFlavorTests\n \n \n __test__ = {\n-    'localflavor_ca_tests': localflavor_ca_tests,\n     'localflavor_ch_tests': localflavor_ch_tests,\n     'localflavor_cl_tests': localflavor_cl_tests,\n     'localflavor_cz_tests': localflavor_cz_tests,"
        },
        {
            "sha": "9969a68628da1a7fbf087a4b08dd9739d6b73dba",
            "filename": "tests/regressiontests/forms/tests/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/3ed85841d1928bce2ce68b7e70c63ae8b48dd206/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/3ed85841d1928bce2ce68b7e70c63ae8b48dd206/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py?ref=3ed85841d1928bce2ce68b7e70c63ae8b48dd206",
            "patch": "@@ -18,6 +18,7 @@\n     AULocalFlavorTests,\n     BELocalFlavorTests,\n     BRLocalFlavorTests,\n+    CALocalFlavorTests,\n     DELocalFlavorTests,\n     ILLocalFlavorTests,\n     TRLocalFlavorTests,"
        }
    ],
    "stats": {
        "total": 334,
        "additions": 80,
        "deletions": 254
    }
}