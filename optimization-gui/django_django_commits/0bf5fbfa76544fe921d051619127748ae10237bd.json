{
    "author": "carljm",
    "message": "Some tweaks to the staticfiles docs to clarify things for new users. Thanks Jannis and brutasse for review and discussion.\n\n* Rearranged 'in a nutshell' usage docs to clarify app-dirs vs STATICFILES_DIRS, initially focus on the simplest path to working local dev, and remove the need for repetitive 'you don't need this in local dev' notes.\n* Added docs on using staticfiles serve view for non-staticfiles (e.g. user-uploaded files).\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15380 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "0bf5fbfa76544fe921d051619127748ae10237bd",
    "files": [
        {
            "sha": "94e04bb738e39c32bdf951ebc77c436ff03ef302",
            "filename": "docs/howto/static-files.txt",
            "status": "modified",
            "additions": 48,
            "deletions": 58,
            "changes": 106,
            "blob_url": "https://github.com/django/django/blob/0bf5fbfa76544fe921d051619127748ae10237bd/docs%2Fhowto%2Fstatic-files.txt",
            "raw_url": "https://github.com/django/django/raw/0bf5fbfa76544fe921d051619127748ae10237bd/docs%2Fhowto%2Fstatic-files.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fhowto%2Fstatic-files.txt?ref=0bf5fbfa76544fe921d051619127748ae10237bd",
            "patch": "@@ -7,7 +7,7 @@ Managing static files\n .. versionadded:: 1.3\n \n Django developers mostly concern themselves with the dynamic parts of web\n-applications -- the views and templates that render new for each request. But\n+applications -- the views and templates that render anew for each request. But\n web applications have other parts: the static files (images, CSS,\n Javascript, etc.) that are needed to render a complete web page.\n \n@@ -38,76 +38,62 @@ Using ``django.contrib.staticfiles``\n \n Here's the basic usage in a nutshell:\n \n-    1. Put your static files somewhere that staticfiles will find it.\n+    1. Put your static files somewhere that ``staticfiles`` will find them.\n \n-       Most of the time this place will be in a ``static`` directory within\n-       your application, but it could also be a specific directory you've put\n-       into your settings file. See the the documentation for the\n-       :setting:`STATICFILES_DIRS` and :setting:`STATICFILES_FINDERS` settings\n-       for details on where you can put static files.\n+       By default, this means within ``static/`` subdirectories of apps in your\n+       :setting:`INSTALLED_APPS`.\n \n-    2. Add some ``staticfiles``-related settings to your settings file.\n+       Many projects will also have static assets that aren't tied to a\n+       particular app; you can give ``staticfiles`` additional directories to\n+       search via the :setting:`STATICFILES_DIRS` setting .\n \n-       First, you'll need to make sure that ``django.contrib.staticfiles``\n-       is in your :setting:`INSTALLED_APPS`.\n+       See the documentation for the :setting:`STATICFILES_FINDERS` setting for\n+       details on how ``staticfiles`` finds your files.\n \n-       Next, you'll need to set the :setting:`STATIC_URL` setting, though\n-       the default value (of ``'/static/'``) is perfect for local development.\n-       See also the :setting:`STATIC_URL` documentation.\n+    2. Make sure that ``django.contrib.staticfiles`` is in your\n+       :setting:`INSTALLED_APPS`.\n \n-       Then, edit the :setting:`STATIC_ROOT` setting to point to where\n-       you'd like your static files collected at (when using the\n-       :djadmin:`collectstatic`, see below). For example::\n+       For :ref:`local development<staticfiles-development>`, if you are using\n+       :ref:`runserver<staticfiles-runserver>` or adding\n+       :ref:`staticfiles_urlpatterns<staticfiles-development>` to your URLconf,\n+       you're done! Your static files will automatically be served at the\n+       default :setting:`STATIC_URL` of ``/static/``.\n \n-            STATIC_ROOT = \"/home/jacob/projects/mysite.com/sitestatic\"\n-\n-       There are a number of other options available that let you control\n-       *how* static files are stored, where ``staticfiles`` searches for\n-       files, and how files will be served; see :ref:`the staticfiles\n-       settings reference <staticfiles-settings>` for details.\n-\n-    3. Run the :djadmin:`collectstatic` management command::\n-\n-            ./manage.py collectstatic\n+    3. You'll probably need to refer to these files in your templates. The\n+       easiest method is to use the included context processor which will allow\n+       template code like:\n \n-       This'll churn through your static file storage and move them into the\n-       directory given by :setting:`STATIC_ROOT`.\n+          .. code-block:: html+django\n \n-       .. note:: This is **not necessary in local development** if you are\n-           using :djadmin:`runserver<staticfiles-runserver>` or adding\n-           ``staticfiles_urlpatterns`` to your URLconf; see below).\n+               <img src=\"{{ STATIC_URL }}images/hi.jpg />\n \n-    4. Deploy those files.\n+       See :ref:`staticfiles-in-templates` for more details, including an\n+       alternate method (using a template tag).\n \n-       If you're using the built-in development server (the\n-       :djadmin:`runserver` management command) and have the :setting:`DEBUG`\n-       setting set to ``True``, your staticfiles will automatically be served\n-       from :setting:`STATIC_URL` in development. You don't need to run\n-       :djadmin:`collectstatic` in that case because ``staticfiles``'s\n-       runserver command handle the serving of static files.\n+When you're ready to move out of local development and deploy your project:\n \n-       But, in case you are using some other server for local development,\n-       you can quickly serve static files locally by adding::\n+    1. Set the :setting:`STATIC_URL` setting to the public URL for your static\n+       files (in some cases, the default value of ``/static/`` may still be\n+       fine).\n \n-            from django.contrib.staticfiles.urls import staticfiles_urlpatterns\n-            urlpatterns += staticfiles_urlpatterns()\n+    2. Set the :setting:`STATIC_ROOT` setting to point to where you'd like your\n+       static files collected to when you use the :djadmin:`collectstatic`\n+       management command. For example::\n \n-       to the bottom of your URLconf. See :ref:`staticfiles-development` for\n-       details.\n+            STATIC_ROOT = \"/home/jacob/projects/mysite.com/sitestatic\"\n \n-       When it comes time to deploy to production, :ref:`staticfiles-production`\n-       covers some common deployment strategies for static files.\n+    3. Run the :djadmin:`collectstatic` management command::\n \n-       However you choose to deploy those files, you'll probably need to refer\n-       to them in your templates. The easiest method is to use the included\n-       context processor which will allow template code like:\n+            ./manage.py collectstatic\n \n-          .. code-block:: html+django\n+       This'll churn through your static file storage and copy them into the\n+       directory given by :setting:`STATIC_ROOT`.\n \n-               <img src=\"{{ STATIC_URL }}images/hi.jpg />\n+    4. Deploy those files by configuring your webserver of choice to serve the\n+       files in :setting:`STATIC_ROOT` at :setting:`STATIC_URL`.\n \n-       See :ref:`staticfiles-in-templates` for more details, including an\n-       alternate method (using a template tag).\n+       :ref:`staticfiles-production` covers some common deployment strategies\n+       for static files.\n \n Those are the basics. For more details on common configuration options, read on;\n for a detailed reference of the settings, commands, and other bits included with\n@@ -123,7 +109,10 @@ the framework see :doc:`the staticfiles reference </ref/contrib/staticfiles>`.\n    :setting:`MEDIA_URL` different from your :setting:`STATIC_ROOT` and\n    :setting:`STATIC_URL`. You will need to arrange for serving of files in\n    :setting:`MEDIA_ROOT` yourself; ``staticfiles`` does not deal with\n-   user-uploaded files at all.\n+   user-uploaded files at all. You can, however, use ``staticfiles``'\n+   :func:`~django.contrib.staticfiles.views.serve` view for serving\n+   :setting:`MEDIA_ROOT` in development; see\n+   :ref:`staticfiles-serve-other-directories`.\n \n .. _staticfiles-in-templates:\n \n@@ -221,7 +210,8 @@ developing locally. Thus, the ``staticfiles`` app ships with a\n development.\n \n This view is automatically enabled and will serve your static files at\n-:setting:`STATIC_URL` when you use the built-in :djadmin:`runserver`.\n+:setting:`STATIC_URL` when you use the built-in\n+:ref:`runserver<staticfiles-runserver>` management command.\n \n To enable this view if you are using some other server for local development,\n you'll add a couple of lines to your URLconf. The first line goes at the top\n@@ -275,7 +265,7 @@ If you want to serve your static files from the same server that's already\n serving your site, the basic outline gets modified to look something like:\n \n     * Push your code up to the deployment server.\n-    * On the server, run :djadmin:`collectstatic` to move all the static files\n+    * On the server, run :djadmin:`collectstatic` to copy all the static files\n       into :setting:`STATIC_ROOT`.\n     * Point your web server at :setting:`STATIC_ROOT`. For example, here's\n       :ref:`how to do this under Apache and mod_wsgi <serving-media-files>`.\n@@ -426,8 +416,8 @@ you're upgrading from `django-staticfiles`_ < ``1.0``` (e.g. ``0.3.4``) to\n       ``staticfiles.storage.StaticFileStorage`` to\n       ``staticfiles.storage.StaticFilesStorage``\n \n-    * If using :djadmin:`runserver` for local development (and the\n-      :setting:`DEBUG` setting is ``True``), you no longer need to add\n+    * If using :ref:`runserver<staticfiles-runserver>` for local development\n+      (and the :setting:`DEBUG` setting is ``True``), you no longer need to add\n       anything to your URLconf for serving static files in development.\n \n Learn more"
        },
        {
            "sha": "4944c284d2c464492164c45e405b5b7b9ad25746",
            "filename": "docs/ref/contrib/staticfiles.txt",
            "status": "modified",
            "additions": 31,
            "deletions": 1,
            "changes": 32,
            "blob_url": "https://github.com/django/django/blob/0bf5fbfa76544fe921d051619127748ae10237bd/docs%2Fref%2Fcontrib%2Fstaticfiles.txt",
            "raw_url": "https://github.com/django/django/raw/0bf5fbfa76544fe921d051619127748ae10237bd/docs%2Fref%2Fcontrib%2Fstaticfiles.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fstaticfiles.txt?ref=0bf5fbfa76544fe921d051619127748ae10237bd",
            "patch": "@@ -189,10 +189,12 @@ for each relative path, use the ``--first`` option::\n This is a debugging aid; it'll show you exactly which static file will be\n collected for a given path.\n \n+.. _staticfiles-runserver:\n+\n runserver\n ---------\n \n-.. django-admin:: staticfiles-runserver\n+.. django-admin:: runserver\n \n Overrides the core :djadmin:`runserver` command if the ``staticfiles`` app\n is :setting:`installed<INSTALLED_APPS>` and adds automatic serving of static\n@@ -317,3 +319,31 @@ already defined pattern list. Use it like this::\n     This helper function will only work if :setting:`DEBUG` is ``True``\n     and your :setting:`STATIC_URL` setting is neither empty nor a full\n     URL such as ``http://static.example.com/``.\n+\n+.. _staticfiles-serve-other-directories:\n+\n+Serving other directories\n+\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n+\n+There may be files other than your project's static assets that, for\n+convenience, you'd like to have Django serve for you in local development. The\n+:func:`~django.contrib.staticfiles.views.serve` view can be used to serve any\n+directory you give it. (Again, this view is **not** hardened for production\n+use, and should be used only as a development aid; you should serve these files\n+in production using a real front-end webserver).\n+\n+The most likely example is user-uploaded content in :setting:`MEDIA_ROOT`.\n+``staticfiles`` is intended for static assets and has no built-in handling for\n+user-uploaded files, but you can have Django serve your :setting:`MEDIA_ROOT`\n+by appending something like this to your URLconf::\n+\n+   from django.conf import settings\n+\n+   if settings.DEBUG:\n+       urlpatterns += patterns('django.contrib.staticfiles.views',\n+           url(r'^media/(?P<path>.*)$', 'serve',\n+               {'document_root': settings.MEDIA_ROOT}),\n+       )\n+\n+This snippet assumes you've also set your :setting:`MEDIA_URL` (in development)\n+to ``/media/``."
        }
    ],
    "stats": {
        "total": 138,
        "additions": 79,
        "deletions": 59
    }
}