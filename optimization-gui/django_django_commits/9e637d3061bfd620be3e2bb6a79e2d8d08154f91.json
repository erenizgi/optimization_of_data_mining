{
    "author": "unknown",
    "message": "Fixed a number of tests that were failing in Oracle due to false assumptions about the primary keys of objects.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15779 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "9e637d3061bfd620be3e2bb6a79e2d8d08154f91",
    "files": [
        {
            "sha": "6303e6d086cfdb1678d7cbc6f4cc1d803ae30859",
            "filename": "tests/modeltests/model_formsets/tests.py",
            "status": "modified",
            "additions": 31,
            "deletions": 26,
            "changes": 57,
            "blob_url": "https://github.com/django/django/blob/9e637d3061bfd620be3e2bb6a79e2d8d08154f91/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/9e637d3061bfd620be3e2bb6a79e2d8d08154f91/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py?ref=9e637d3061bfd620be3e2bb6a79e2d8d08154f91",
            "patch": "@@ -70,7 +70,7 @@ def test_change_form_deletion_when_invalid(self):\n             'form-TOTAL_FORMS': u'1',\n             'form-INITIAL_FORMS': u'1',\n             'form-MAX_NUM_FORMS': u'0',\n-            'form-0-id': u'1',\n+            'form-0-id': unicode(poet.id),\n             'form-0-name': u'x' * 1000,\n         }\n         formset = PoetFormSet(data, queryset=Poet.objects.all())\n@@ -250,9 +250,9 @@ def test_commit_false(self):\n             'form-TOTAL_FORMS': '2', # the number of forms rendered\n             'form-INITIAL_FORMS': '1', # the number of forms with initial data\n             'form-MAX_NUM_FORMS': '', # the max number of forms\n-            'form-0-id': '1',\n+            'form-0-id': str(meeting.id),\n             'form-0-name': '2nd Tuesday of the Week Meeting',\n-            'form-0-authors': [2, 1, 3, 4],\n+            'form-0-authors': [author2.id, author1.id, author3.id, author4.id],\n             'form-1-name': '',\n             'form-1-authors': '',\n             'form-1-DELETE': '',\n@@ -457,7 +457,7 @@ def test_inline_formsets(self):\n             'book_set-TOTAL_FORMS': '3', # the number of forms rendered\n             'book_set-INITIAL_FORMS': '1', # the number of forms with initial data\n             'book_set-MAX_NUM_FORMS': '', # the max number of forms\n-            'book_set-0-id': '1',\n+            'book_set-0-id': str(book1.id),\n             'book_set-0-title': 'Les Fleurs du Mal',\n             'book_set-1-title': 'Les Paradis Artificiels',\n             'book_set-2-title': '',\n@@ -730,14 +730,15 @@ def test_custom_pk(self):\n         self.assertTrue(formset.is_valid())\n         saved = formset.save()\n         self.assertEqual(len(saved), 1)\n-        owner, = saved\n-        self.assertEqual(owner.name, 'Joe Perry')\n-        self.assertEqual(owner.place.name, 'Giordanos')\n+        owner1, = saved\n+        self.assertEqual(owner1.name, 'Joe Perry')\n+        self.assertEqual(owner1.place.name, 'Giordanos')\n \n         formset = FormSet(instance=place)\n         self.assertEqual(len(formset.forms), 3)\n         self.assertEqual(formset.forms[0].as_p(),\n-            '<p><label for=\"id_owner_set-0-name\">Name:</label> <input id=\"id_owner_set-0-name\" type=\"text\" name=\"owner_set-0-name\" value=\"Joe Perry\" maxlength=\"100\" /><input type=\"hidden\" name=\"owner_set-0-place\" value=\"1\" id=\"id_owner_set-0-place\" /><input type=\"hidden\" name=\"owner_set-0-auto_id\" value=\"1\" id=\"id_owner_set-0-auto_id\" /></p>')\n+            '<p><label for=\"id_owner_set-0-name\">Name:</label> <input id=\"id_owner_set-0-name\" type=\"text\" name=\"owner_set-0-name\" value=\"Joe Perry\" maxlength=\"100\" /><input type=\"hidden\" name=\"owner_set-0-place\" value=\"1\" id=\"id_owner_set-0-place\" /><input type=\"hidden\" name=\"owner_set-0-auto_id\" value=\"%d\" id=\"id_owner_set-0-auto_id\" /></p>'\n+            % owner1.auto_id)\n         self.assertEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_owner_set-1-name\">Name:</label> <input id=\"id_owner_set-1-name\" type=\"text\" name=\"owner_set-1-name\" maxlength=\"100\" /><input type=\"hidden\" name=\"owner_set-1-place\" value=\"1\" id=\"id_owner_set-1-place\" /><input type=\"hidden\" name=\"owner_set-1-auto_id\" id=\"id_owner_set-1-auto_id\" /></p>')\n         self.assertEqual(formset.forms[2].as_p(),\n@@ -747,7 +748,7 @@ def test_custom_pk(self):\n             'owner_set-TOTAL_FORMS': '3',\n             'owner_set-INITIAL_FORMS': '1',\n             'owner_set-MAX_NUM_FORMS': '',\n-            'owner_set-0-auto_id': u'1',\n+            'owner_set-0-auto_id': unicode(owner1.auto_id),\n             'owner_set-0-name': u'Joe Perry',\n             'owner_set-1-auto_id': '',\n             'owner_set-1-name': u'Jack Berry',\n@@ -758,9 +759,9 @@ def test_custom_pk(self):\n         self.assertTrue(formset.is_valid())\n         saved = formset.save()\n         self.assertEqual(len(saved), 1)\n-        owner, = saved\n-        self.assertEqual(owner.name, 'Jack Berry')\n-        self.assertEqual(owner.place.name, 'Giordanos')\n+        owner2, = saved\n+        self.assertEqual(owner2.name, 'Jack Berry')\n+        self.assertEqual(owner2.place.name, 'Giordanos')\n \n         # Ensure a custom primary key that is a ForeignKey or OneToOneField get rendered for the user to choose.\n \n@@ -769,19 +770,21 @@ def test_custom_pk(self):\n         self.assertEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_form-0-owner\">Owner:</label> <select name=\"form-0-owner\" id=\"id_form-0-owner\">\\n'\n             '<option value=\"\" selected=\"selected\">---------</option>\\n'\n-            '<option value=\"1\">Joe Perry at Giordanos</option>\\n'\n-            '<option value=\"2\">Jack Berry at Giordanos</option>\\n'\n+            '<option value=\"%d\">Joe Perry at Giordanos</option>\\n'\n+            '<option value=\"%d\">Jack Berry at Giordanos</option>\\n'\n             '</select></p>\\n'\n-            '<p><label for=\"id_form-0-age\">Age:</label> <input type=\"text\" name=\"form-0-age\" id=\"id_form-0-age\" /></p>')\n+            '<p><label for=\"id_form-0-age\">Age:</label> <input type=\"text\" name=\"form-0-age\" id=\"id_form-0-age\" /></p>'\n+            % (owner1.auto_id, owner2.auto_id))\n \n-        owner = Owner.objects.get(name=u'Joe Perry')\n+        owner1 = Owner.objects.get(name=u'Joe Perry')\n         FormSet = inlineformset_factory(Owner, OwnerProfile, max_num=1, can_delete=False)\n         self.assertEqual(FormSet.max_num, 1)\n \n-        formset = FormSet(instance=owner)\n+        formset = FormSet(instance=owner1)\n         self.assertEqual(len(formset.forms), 1)\n         self.assertEqual(formset.forms[0].as_p(),\n-            '<p><label for=\"id_ownerprofile-0-age\">Age:</label> <input type=\"text\" name=\"ownerprofile-0-age\" id=\"id_ownerprofile-0-age\" /><input type=\"hidden\" name=\"ownerprofile-0-owner\" value=\"1\" id=\"id_ownerprofile-0-owner\" /></p>')\n+            '<p><label for=\"id_ownerprofile-0-age\">Age:</label> <input type=\"text\" name=\"ownerprofile-0-age\" id=\"id_ownerprofile-0-age\" /><input type=\"hidden\" name=\"ownerprofile-0-owner\" value=\"%d\" id=\"id_ownerprofile-0-owner\" /></p>'\n+            % owner1.auto_id)\n \n         data = {\n             'ownerprofile-TOTAL_FORMS': '1',\n@@ -790,32 +793,33 @@ def test_custom_pk(self):\n             'ownerprofile-0-owner': '',\n             'ownerprofile-0-age': u'54',\n         }\n-        formset = FormSet(data, instance=owner)\n+        formset = FormSet(data, instance=owner1)\n         self.assertTrue(formset.is_valid())\n         saved = formset.save()\n         self.assertEqual(len(saved), 1)\n         profile1, = saved\n-        self.assertEqual(profile1.owner, owner)\n+        self.assertEqual(profile1.owner, owner1)\n         self.assertEqual(profile1.age, 54)\n \n-        formset = FormSet(instance=owner)\n+        formset = FormSet(instance=owner1)\n         self.assertEqual(len(formset.forms), 1)\n         self.assertEqual(formset.forms[0].as_p(),\n-            '<p><label for=\"id_ownerprofile-0-age\">Age:</label> <input type=\"text\" name=\"ownerprofile-0-age\" value=\"54\" id=\"id_ownerprofile-0-age\" /><input type=\"hidden\" name=\"ownerprofile-0-owner\" value=\"1\" id=\"id_ownerprofile-0-owner\" /></p>')\n+            '<p><label for=\"id_ownerprofile-0-age\">Age:</label> <input type=\"text\" name=\"ownerprofile-0-age\" value=\"54\" id=\"id_ownerprofile-0-age\" /><input type=\"hidden\" name=\"ownerprofile-0-owner\" value=\"%d\" id=\"id_ownerprofile-0-owner\" /></p>'\n+            % owner1.auto_id)\n \n         data = {\n             'ownerprofile-TOTAL_FORMS': '1',\n             'ownerprofile-INITIAL_FORMS': '1',\n             'ownerprofile-MAX_NUM_FORMS': '1',\n-            'ownerprofile-0-owner': u'1',\n+            'ownerprofile-0-owner': unicode(owner1.auto_id),\n             'ownerprofile-0-age': u'55',\n         }\n-        formset = FormSet(data, instance=owner)\n+        formset = FormSet(data, instance=owner1)\n         self.assertTrue(formset.is_valid())\n         saved = formset.save()\n         self.assertEqual(len(saved), 1)\n         profile1, = saved\n-        self.assertEqual(profile1.owner, owner)\n+        self.assertEqual(profile1.owner, owner1)\n         self.assertEqual(profile1.age, 55)\n \n     def test_unique_true_enforces_max_num_one(self):\n@@ -956,7 +960,8 @@ def test_callable_defaults(self):\n         result = re.sub(r'\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?', '__DATETIME__', result)\n         self.assertEqual(result,\n             '<p><label for=\"id_membership_set-0-date_joined\">Date joined:</label> <input type=\"text\" name=\"membership_set-0-date_joined\" value=\"__DATETIME__\" id=\"id_membership_set-0-date_joined\" /><input type=\"hidden\" name=\"initial-membership_set-0-date_joined\" value=\"__DATETIME__\" id=\"initial-membership_set-0-id_membership_set-0-date_joined\" /></p>\\n'\n-            '<p><label for=\"id_membership_set-0-karma\">Karma:</label> <input type=\"text\" name=\"membership_set-0-karma\" id=\"id_membership_set-0-karma\" /><input type=\"hidden\" name=\"membership_set-0-person\" value=\"1\" id=\"id_membership_set-0-person\" /><input type=\"hidden\" name=\"membership_set-0-id\" id=\"id_membership_set-0-id\" /></p>')\n+            '<p><label for=\"id_membership_set-0-karma\">Karma:</label> <input type=\"text\" name=\"membership_set-0-karma\" id=\"id_membership_set-0-karma\" /><input type=\"hidden\" name=\"membership_set-0-person\" value=\"%d\" id=\"id_membership_set-0-person\" /><input type=\"hidden\" name=\"membership_set-0-id\" id=\"id_membership_set-0-id\" /></p>'\n+            % person.id)\n \n         # test for validation with callable defaults. Validations rely on hidden fields\n "
        },
        {
            "sha": "57bd87f8e673872e28a616c13d5ce73356a4ce6b",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 71,
            "deletions": 61,
            "changes": 132,
            "blob_url": "https://github.com/django/django/blob/9e637d3061bfd620be3e2bb6a79e2d8d08154f91/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/9e637d3061bfd620be3e2bb6a79e2d8d08154f91/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=9e637d3061bfd620be3e2bb6a79e2d8d08154f91",
            "patch": "@@ -794,8 +794,8 @@ def testChangeView(self):\n         self.client.get('/test_admin/admin/logout/')\n \n         # Test redirection when using row-level change permissions. Refs #11513.\n-        RowLevelChangePermissionModel.objects.create(name=\"odd id\")\n-        RowLevelChangePermissionModel.objects.create(name=\"even id\")\n+        RowLevelChangePermissionModel.objects.create(id=1, name=\"odd id\")\n+        RowLevelChangePermissionModel.objects.create(id=2, name=\"even id\")\n         for login_dict in [self.super_login, self.changeuser_login, self.adduser_login, self.deleteuser_login]:\n             self.client.post('/test_admin/admin/', login_dict)\n             request = self.client.get('/test_admin/admin/admin_views/rowlevelchangepermissionmodel/1/')\n@@ -871,20 +871,21 @@ def testCustomModelAdminTemplates(self):\n         })\n         self.assertRedirects(post, '/test_admin/admin/admin_views/customarticle/')\n         self.assertEqual(CustomArticle.objects.all().count(), 1)\n+        article_pk = CustomArticle.objects.all()[0].pk\n \n         # Test custom delete, change, and object history templates\n         # Test custom change form template\n-        request = self.client.get('/test_admin/admin/admin_views/customarticle/1/')\n+        request = self.client.get('/test_admin/admin/admin_views/customarticle/%d/' % article_pk)\n         self.assertTemplateUsed(request, 'custom_admin/change_form.html')\n-        request = self.client.get('/test_admin/admin/admin_views/customarticle/1/delete/')\n+        request = self.client.get('/test_admin/admin/admin_views/customarticle/%d/delete/' % article_pk)\n         self.assertTemplateUsed(request, 'custom_admin/delete_confirmation.html')\n         request = self.client.post('/test_admin/admin/admin_views/customarticle/', data={\n                 'index': 0,\n                 'action': ['delete_selected'],\n                 '_selected_action': ['1'],\n             })\n         self.assertTemplateUsed(request, 'custom_admin/delete_selected_confirmation.html')\n-        request = self.client.get('/test_admin/admin/admin_views/customarticle/1/history/')\n+        request = self.client.get('/test_admin/admin/admin_views/customarticle/%d/history/' % article_pk)\n         self.assertTemplateUsed(request, 'custom_admin/object_history.html')\n \n         self.client.get('/test_admin/admin/logout/')\n@@ -1478,27 +1479,27 @@ def test_non_field_errors(self):\n         ''' Ensure that non field errors are displayed for each of the\n             forms in the changelist's formset. Refs #13126.\n         '''\n-        FoodDelivery.objects.create(reference='123', driver='bill', restaurant='thai')\n-        FoodDelivery.objects.create(reference='456', driver='bill', restaurant='india')\n-        FoodDelivery.objects.create(reference='789', driver='bill', restaurant='pizza')\n+        fd1 = FoodDelivery.objects.create(reference='123', driver='bill', restaurant='thai')\n+        fd2 = FoodDelivery.objects.create(reference='456', driver='bill', restaurant='india')\n+        fd3 = FoodDelivery.objects.create(reference='789', driver='bill', restaurant='pizza')\n \n         data = {\n             \"form-TOTAL_FORMS\": \"3\",\n             \"form-INITIAL_FORMS\": \"3\",\n             \"form-MAX_NUM_FORMS\": \"0\",\n \n-            \"form-0-id\": \"1\",\n+            \"form-0-id\": str(fd1.id),\n             \"form-0-reference\": \"123\",\n             \"form-0-driver\": \"bill\",\n             \"form-0-restaurant\": \"thai\",\n \n             # Same data as above: Forbidden because of unique_together!\n-            \"form-1-id\": \"2\",\n+            \"form-1-id\": str(fd2.id),\n             \"form-1-reference\": \"456\",\n             \"form-1-driver\": \"bill\",\n             \"form-1-restaurant\": \"thai\",\n \n-            \"form-2-id\": \"3\",\n+            \"form-2-id\": str(fd3.id),\n             \"form-2-reference\": \"789\",\n             \"form-2-driver\": \"bill\",\n             \"form-2-restaurant\": \"pizza\",\n@@ -1513,19 +1514,19 @@ def test_non_field_errors(self):\n             \"form-INITIAL_FORMS\": \"3\",\n             \"form-MAX_NUM_FORMS\": \"0\",\n \n-            \"form-0-id\": \"1\",\n+            \"form-0-id\": str(fd1.id),\n             \"form-0-reference\": \"123\",\n             \"form-0-driver\": \"bill\",\n             \"form-0-restaurant\": \"thai\",\n \n             # Same data as above: Forbidden because of unique_together!\n-            \"form-1-id\": \"2\",\n+            \"form-1-id\": str(fd2.id),\n             \"form-1-reference\": \"456\",\n             \"form-1-driver\": \"bill\",\n             \"form-1-restaurant\": \"thai\",\n \n             # Same data also.\n-            \"form-2-id\": \"3\",\n+            \"form-2-id\": str(fd3.id),\n             \"form-2-reference\": \"789\",\n             \"form-2-driver\": \"bill\",\n             \"form-2-restaurant\": \"thai\",\n@@ -1685,28 +1686,28 @@ def test_pk_hidden_fields(self):\n             separately (not in the table), and only once.\n             Refs #12475.\n         \"\"\"\n-        Story.objects.create(title='The adventures of Guido', content='Once upon a time in Djangoland...')\n-        Story.objects.create(title='Crouching Tiger, Hidden Python', content='The Python was sneaking into...')\n+        story1 = Story.objects.create(title='The adventures of Guido', content='Once upon a time in Djangoland...')\n+        story2 = Story.objects.create(title='Crouching Tiger, Hidden Python', content='The Python was sneaking into...')\n         response = self.client.get('/test_admin/admin/admin_views/story/')\n         self.assertContains(response, 'id=\"id_form-0-id\"', 1) # Only one hidden field, in a separate place than the table.\n         self.assertContains(response, 'id=\"id_form-1-id\"', 1)\n-        self.assertContains(response, '<div class=\"hiddenfields\">\\n<input type=\"hidden\" name=\"form-0-id\" value=\"2\" id=\"id_form-0-id\" /><input type=\"hidden\" name=\"form-1-id\" value=\"1\" id=\"id_form-1-id\" />\\n</div>')\n-        self.assertContains(response, '<td>1</td>', 1)\n-        self.assertContains(response, '<td>2</td>', 1)\n+        self.assertContains(response, '<div class=\"hiddenfields\">\\n<input type=\"hidden\" name=\"form-0-id\" value=\"%d\" id=\"id_form-0-id\" /><input type=\"hidden\" name=\"form-1-id\" value=\"%d\" id=\"id_form-1-id\" />\\n</div>' % (story2.id, story1.id))\n+        self.assertContains(response, '<td>%d</td>' % story1.id, 1)\n+        self.assertContains(response, '<td>%d</td>' % story2.id, 1)\n \n     def test_pk_hidden_fields_with_list_display_links(self):\n         \"\"\" Similarly as test_pk_hidden_fields, but when the hidden pk fields are\n             referenced in list_display_links.\n             Refs #12475.\n         \"\"\"\n-        OtherStory.objects.create(title='The adventures of Guido', content='Once upon a time in Djangoland...')\n-        OtherStory.objects.create(title='Crouching Tiger, Hidden Python', content='The Python was sneaking into...')\n+        story1 = OtherStory.objects.create(title='The adventures of Guido', content='Once upon a time in Djangoland...')\n+        story2 = OtherStory.objects.create(title='Crouching Tiger, Hidden Python', content='The Python was sneaking into...')\n         response = self.client.get('/test_admin/admin/admin_views/otherstory/')\n         self.assertContains(response, 'id=\"id_form-0-id\"', 1) # Only one hidden field, in a separate place than the table.\n         self.assertContains(response, 'id=\"id_form-1-id\"', 1)\n-        self.assertContains(response, '<div class=\"hiddenfields\">\\n<input type=\"hidden\" name=\"form-0-id\" value=\"2\" id=\"id_form-0-id\" /><input type=\"hidden\" name=\"form-1-id\" value=\"1\" id=\"id_form-1-id\" />\\n</div>')\n-        self.assertContains(response, '<th><a href=\"1/\">1</a></th>', 1)\n-        self.assertContains(response, '<th><a href=\"2/\">2</a></th>', 1)\n+        self.assertContains(response, '<div class=\"hiddenfields\">\\n<input type=\"hidden\" name=\"form-0-id\" value=\"%d\" id=\"id_form-0-id\" /><input type=\"hidden\" name=\"form-1-id\" value=\"%d\" id=\"id_form-1-id\" />\\n</div>' % (story2.id, story1.id))\n+        self.assertContains(response, '<th><a href=\"%d/\">%d</a></th>' % (story1.id, story1.id), 1)\n+        self.assertContains(response, '<th><a href=\"%d/\">%d</a></th>' % (story2.id, story2.id), 1)\n \n \n class AdminSearchTest(TestCase):\n@@ -1801,9 +1802,13 @@ def testInline(self):\n         self.assertEqual(BarAccount.objects.all()[0].username, bar_user)\n         self.assertEqual(Persona.objects.all()[0].accounts.count(), 2)\n \n+        persona_id = Persona.objects.all()[0].id\n+        foo_id = FooAccount.objects.all()[0].id\n+        bar_id = BarAccount.objects.all()[0].id\n+\n         # test the edit case\n \n-        response = self.client.get('/test_admin/admin/admin_views/persona/1/')\n+        response = self.client.get('/test_admin/admin/admin_views/persona/%d/' % persona_id)\n         names = name_re.findall(response.content)\n         # make sure we have no duplicate HTML names\n         self.assertEqual(len(names), len(set(names)))\n@@ -1816,18 +1821,18 @@ def testInline(self):\n             \"accounts-MAX_NUM_FORMS\": u\"0\",\n \n             \"accounts-0-username\": \"%s-1\" % foo_user,\n-            \"accounts-0-account_ptr\": \"1\",\n-            \"accounts-0-persona\": \"1\",\n+            \"accounts-0-account_ptr\": str(foo_id),\n+            \"accounts-0-persona\": str(persona_id),\n \n             \"accounts-2-TOTAL_FORMS\": u\"2\",\n             \"accounts-2-INITIAL_FORMS\": u\"1\",\n             \"accounts-2-MAX_NUM_FORMS\": u\"0\",\n \n             \"accounts-2-0-username\": \"%s-1\" % bar_user,\n-            \"accounts-2-0-account_ptr\": \"2\",\n-            \"accounts-2-0-persona\": \"1\",\n+            \"accounts-2-0-account_ptr\": str(bar_id),\n+            \"accounts-2-0-persona\": str(persona_id),\n         }\n-        response = self.client.post('/test_admin/admin/admin_views/persona/1/', post_data)\n+        response = self.client.post('/test_admin/admin/admin_views/persona/%d/' % persona_id, post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(Persona.objects.count(), 1)\n         self.assertEqual(FooAccount.objects.count(), 1)\n@@ -2155,10 +2160,10 @@ def setUp(self):\n         file1.write('a' * (2 ** 21))\n         filename = file1.name\n         file1.close()\n-        g = Gallery(name=\"Test Gallery\")\n-        g.save()\n-        p = Picture(name=\"Test Picture\", image=filename, gallery=g)\n-        p.save()\n+        self.gallery = Gallery(name=\"Test Gallery\")\n+        self.gallery.save()\n+        self.picture = Picture(name=\"Test Picture\", image=filename, gallery=self.gallery)\n+        self.picture.save()\n \n     def tearDown(self):\n         self.client.logout()\n@@ -2172,16 +2177,16 @@ def test_inline_file_upload_edit_validation_error_post(self):\n             \"pictures-TOTAL_FORMS\": u\"2\",\n             \"pictures-INITIAL_FORMS\": u\"1\",\n             \"pictures-MAX_NUM_FORMS\": u\"0\",\n-            \"pictures-0-id\": u\"1\",\n-            \"pictures-0-gallery\": u\"1\",\n+            \"pictures-0-id\": unicode(self.picture.id),\n+            \"pictures-0-gallery\": unicode(self.gallery.id),\n             \"pictures-0-name\": \"Test Picture\",\n             \"pictures-0-image\": \"\",\n             \"pictures-1-id\": \"\",\n-            \"pictures-1-gallery\": \"1\",\n+            \"pictures-1-gallery\": str(self.gallery.id),\n             \"pictures-1-name\": \"Test Picture 2\",\n             \"pictures-1-image\": \"\",\n         }\n-        response = self.client.post('/test_admin/%s/admin_views/gallery/1/' % self.urlbit, post_data)\n+        response = self.client.post('/test_admin/%s/admin_views/gallery/%d/' % (self.urlbit, self.gallery.id), post_data)\n         self.assertTrue(response._container[0].find(\"Currently:\") > -1)\n \n \n@@ -2286,29 +2291,31 @@ def test_simple_inline(self):\n         \"A simple model can be saved as inlines\"\n         # First add a new inline\n         self.post_data['widget_set-0-name'] = \"Widget 1\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        collector_url = '/test_admin/admin/admin_views/collector/%d/' % self.collector.pk\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(Widget.objects.count(), 1)\n         self.assertEqual(Widget.objects.all()[0].name, \"Widget 1\")\n+        widget_id = Widget.objects.all()[0].id\n \n         # Check that the PK link exists on the rendered form\n-        response = self.client.get('/test_admin/admin/admin_views/collector/1/')\n+        response = self.client.get(collector_url)\n         self.assertContains(response, 'name=\"widget_set-0-id\"')\n \n         # Now resave that inline\n         self.post_data['widget_set-INITIAL_FORMS'] = \"1\"\n-        self.post_data['widget_set-0-id'] = \"1\"\n+        self.post_data['widget_set-0-id'] = str(widget_id)\n         self.post_data['widget_set-0-name'] = \"Widget 1\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(Widget.objects.count(), 1)\n         self.assertEqual(Widget.objects.all()[0].name, \"Widget 1\")\n \n         # Now modify that inline\n         self.post_data['widget_set-INITIAL_FORMS'] = \"1\"\n-        self.post_data['widget_set-0-id'] = \"1\"\n+        self.post_data['widget_set-0-id'] = str(widget_id)\n         self.post_data['widget_set-0-name'] = \"Widget 1 Updated\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(Widget.objects.count(), 1)\n         self.assertEqual(Widget.objects.all()[0].name, \"Widget 1 Updated\")\n@@ -2317,29 +2324,30 @@ def test_explicit_autofield_inline(self):\n         \"A model with an explicit autofield primary key can be saved as inlines. Regression for #8093\"\n         # First add a new inline\n         self.post_data['grommet_set-0-name'] = \"Grommet 1\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        collector_url = '/test_admin/admin/admin_views/collector/%d/' % self.collector.pk\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(Grommet.objects.count(), 1)\n         self.assertEqual(Grommet.objects.all()[0].name, \"Grommet 1\")\n \n         # Check that the PK link exists on the rendered form\n-        response = self.client.get('/test_admin/admin/admin_views/collector/1/')\n+        response = self.client.get(collector_url)\n         self.assertContains(response, 'name=\"grommet_set-0-code\"')\n \n         # Now resave that inline\n         self.post_data['grommet_set-INITIAL_FORMS'] = \"1\"\n-        self.post_data['grommet_set-0-code'] = \"1\"\n+        self.post_data['grommet_set-0-code'] = str(Grommet.objects.all()[0].code)\n         self.post_data['grommet_set-0-name'] = \"Grommet 1\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(Grommet.objects.count(), 1)\n         self.assertEqual(Grommet.objects.all()[0].name, \"Grommet 1\")\n \n         # Now modify that inline\n         self.post_data['grommet_set-INITIAL_FORMS'] = \"1\"\n-        self.post_data['grommet_set-0-code'] = \"1\"\n+        self.post_data['grommet_set-0-code'] = str(Grommet.objects.all()[0].code)\n         self.post_data['grommet_set-0-name'] = \"Grommet 1 Updated\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(Grommet.objects.count(), 1)\n         self.assertEqual(Grommet.objects.all()[0].name, \"Grommet 1 Updated\")\n@@ -2349,20 +2357,21 @@ def test_char_pk_inline(self):\n         # First add a new inline\n         self.post_data['doohickey_set-0-code'] = \"DH1\"\n         self.post_data['doohickey_set-0-name'] = \"Doohickey 1\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        collector_url = '/test_admin/admin/admin_views/collector/%d/' % self.collector.pk\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(DooHickey.objects.count(), 1)\n         self.assertEqual(DooHickey.objects.all()[0].name, \"Doohickey 1\")\n \n         # Check that the PK link exists on the rendered form\n-        response = self.client.get('/test_admin/admin/admin_views/collector/1/')\n+        response = self.client.get(collector_url)\n         self.assertContains(response, 'name=\"doohickey_set-0-code\"')\n \n         # Now resave that inline\n         self.post_data['doohickey_set-INITIAL_FORMS'] = \"1\"\n         self.post_data['doohickey_set-0-code'] = \"DH1\"\n         self.post_data['doohickey_set-0-name'] = \"Doohickey 1\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(DooHickey.objects.count(), 1)\n         self.assertEqual(DooHickey.objects.all()[0].name, \"Doohickey 1\")\n@@ -2371,7 +2380,7 @@ def test_char_pk_inline(self):\n         self.post_data['doohickey_set-INITIAL_FORMS'] = \"1\"\n         self.post_data['doohickey_set-0-code'] = \"DH1\"\n         self.post_data['doohickey_set-0-name'] = \"Doohickey 1 Updated\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(DooHickey.objects.count(), 1)\n         self.assertEqual(DooHickey.objects.all()[0].name, \"Doohickey 1 Updated\")\n@@ -2412,29 +2421,31 @@ def test_inherited_inline(self):\n         \"An inherited model can be saved as inlines. Regression for #11042\"\n         # First add a new inline\n         self.post_data['fancydoodad_set-0-name'] = \"Fancy Doodad 1\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        collector_url = '/test_admin/admin/admin_views/collector/%d/' % self.collector.pk\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(FancyDoodad.objects.count(), 1)\n         self.assertEqual(FancyDoodad.objects.all()[0].name, \"Fancy Doodad 1\")\n+        doodad_pk = FancyDoodad.objects.all()[0].pk\n \n         # Check that the PK link exists on the rendered form\n-        response = self.client.get('/test_admin/admin/admin_views/collector/1/')\n+        response = self.client.get(collector_url)\n         self.assertContains(response, 'name=\"fancydoodad_set-0-doodad_ptr\"')\n \n         # Now resave that inline\n         self.post_data['fancydoodad_set-INITIAL_FORMS'] = \"1\"\n-        self.post_data['fancydoodad_set-0-doodad_ptr'] = \"1\"\n+        self.post_data['fancydoodad_set-0-doodad_ptr'] = str(doodad_pk)\n         self.post_data['fancydoodad_set-0-name'] = \"Fancy Doodad 1\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(FancyDoodad.objects.count(), 1)\n         self.assertEqual(FancyDoodad.objects.all()[0].name, \"Fancy Doodad 1\")\n \n         # Now modify that inline\n         self.post_data['fancydoodad_set-INITIAL_FORMS'] = \"1\"\n-        self.post_data['fancydoodad_set-0-doodad_ptr'] = \"1\"\n+        self.post_data['fancydoodad_set-0-doodad_ptr'] = str(doodad_pk)\n         self.post_data['fancydoodad_set-0-name'] = \"Fancy Doodad 1 Updated\"\n-        response = self.client.post('/test_admin/admin/admin_views/collector/1/', self.post_data)\n+        response = self.client.post(collector_url, self.post_data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(FancyDoodad.objects.count(), 1)\n         self.assertEqual(FancyDoodad.objects.all()[0].name, \"Fancy Doodad 1 Updated\")\n@@ -2952,4 +2963,3 @@ def test_multiple_years(self):\n             self.assert_non_localized_year(response, 2000)\n             self.assert_non_localized_year(response, 2003)\n             self.assert_non_localized_year(response, 2005)\n-"
        },
        {
            "sha": "b47967971a1a216c2addc3c274c8b54505ccf026",
            "filename": "tests/regressiontests/inline_formsets/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/9e637d3061bfd620be3e2bb6a79e2d8d08154f91/tests%2Fregressiontests%2Finline_formsets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/9e637d3061bfd620be3e2bb6a79e2d8d08154f91/tests%2Fregressiontests%2Finline_formsets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Finline_formsets%2Ftests.py?ref=9e637d3061bfd620be3e2bb6a79e2d8d08154f91",
            "patch": "@@ -59,13 +59,13 @@ def test_change_form_deletion_when_invalid(self):\n         \"\"\"\n         PoemFormSet = inlineformset_factory(Poet, Poem, can_delete=True)\n         poet = Poet.objects.create(name='test')\n-        poet.poem_set.create(name='test poem')\n+        poem = poet.poem_set.create(name='test poem')\n         data = {\n             'poem_set-TOTAL_FORMS': u'1',\n             'poem_set-INITIAL_FORMS': u'1',\n             'poem_set-MAX_NUM_FORMS': u'0',\n-            'poem_set-0-id': u'1',\n-            'poem_set-0-poem': u'1',\n+            'poem_set-0-id': unicode(poem.id),\n+            'poem_set-0-poem': unicode(poem.id),\n             'poem_set-0-name': u'x' * 1000,\n         }\n         formset = PoemFormSet(data, instance=poet)"
        }
    ],
    "stats": {
        "total": 195,
        "additions": 105,
        "deletions": 90
    }
}