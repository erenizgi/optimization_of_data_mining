{
    "author": "spookylukey",
    "message": "Made GenericRelatedObjectManager consistent with other related managers w.r.t. use of core_filters attribute.\n\nPreviously it had an unused keyword argument.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16914 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ec5bfed57ad86ec17a9169c279c967abbfbe52f9",
    "files": [
        {
            "sha": "12f7dc81259178b5105943c3f3b7395163f75d3a",
            "filename": "django/contrib/contenttypes/generic.py",
            "status": "modified",
            "additions": 10,
            "deletions": 8,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/ec5bfed57ad86ec17a9169c279c967abbfbe52f9/django%2Fcontrib%2Fcontenttypes%2Fgeneric.py",
            "raw_url": "https://github.com/django/django/raw/ec5bfed57ad86ec17a9169c279c967abbfbe52f9/django%2Fcontrib%2Fcontenttypes%2Fgeneric.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fcontenttypes%2Fgeneric.py?ref=ec5bfed57ad86ec17a9169c279c967abbfbe52f9",
            "patch": "@@ -214,16 +214,22 @@ def __get__(self, instance, instance_type=None):\n         RelatedManager = create_generic_related_manager(superclass)\n \n         qn = connection.ops.quote_name\n+        content_type = ContentType.objects.db_manager(instance._state.db).get_for_model(instance)\n \n         manager = RelatedManager(\n             model = rel_model,\n             instance = instance,\n             symmetrical = (self.field.rel.symmetrical and instance.__class__ == rel_model),\n             source_col_name = qn(self.field.m2m_column_name()),\n             target_col_name = qn(self.field.m2m_reverse_name()),\n-            content_type = ContentType.objects.db_manager(instance._state.db).get_for_model(instance),\n+            content_type = content_type,\n             content_type_field_name = self.field.content_type_field_name,\n-            object_id_field_name = self.field.object_id_field_name\n+            object_id_field_name = self.field.object_id_field_name,\n+            core_filters = {\n+                '%s__pk' % self.field.content_type_field_name: content_type.id,\n+                '%s__exact' % self.field.object_id_field_name: instance._get_pk_val(),\n+            }\n+\n         )\n \n         return manager\n@@ -249,7 +255,7 @@ def __init__(self, model=None, core_filters=None, instance=None, symmetrical=Non\n                      content_type_field_name=None, object_id_field_name=None):\n \n             super(GenericRelatedObjectManager, self).__init__()\n-            self.core_filters = core_filters or {}\n+            self.core_filters = core_filters\n             self.model = model\n             self.content_type = content_type\n             self.symmetrical = symmetrical\n@@ -262,11 +268,7 @@ def __init__(self, model=None, core_filters=None, instance=None, symmetrical=Non\n \n         def get_query_set(self):\n             db = self._db or router.db_for_read(self.model, instance=self.instance)\n-            query = {\n-                '%s__pk' % self.content_type_field_name : self.content_type.id,\n-                '%s__exact' % self.object_id_field_name : self.pk_val,\n-            }\n-            return super(GenericRelatedObjectManager, self).get_query_set().using(db).filter(**query)\n+            return super(GenericRelatedObjectManager, self).get_query_set().using(db).filter(**self.core_filters)\n \n         def add(self, *objs):\n             for obj in objs:"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 10,
        "deletions": 8
    }
}