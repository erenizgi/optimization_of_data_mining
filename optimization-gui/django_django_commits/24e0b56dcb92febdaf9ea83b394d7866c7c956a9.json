{
    "author": "jezdez",
    "message": "Moved the test added in r15504 to a different case where it doesn't actually verify the existence of the URL by calling urlopen but only validates it.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15551 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "24e0b56dcb92febdaf9ea83b394d7866c7c956a9",
    "files": [
        {
            "sha": "f76e7327eb8cd76356dfdb900fc4872f6a1772ca",
            "filename": "tests/regressiontests/forms/tests/fields.py",
            "status": "modified",
            "additions": 13,
            "deletions": 2,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/24e0b56dcb92febdaf9ea83b394d7866c7c956a9/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/24e0b56dcb92febdaf9ea83b394d7866c7c956a9/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py?ref=24e0b56dcb92febdaf9ea83b394d7866c7c956a9",
            "patch": "@@ -28,6 +28,7 @@\n import time\n import re\n import os\n+import urllib2\n from decimal import Decimal\n \n from django.core.files.uploadedfile import SimpleUploadedFile\n@@ -571,8 +572,6 @@ def test_urlfield_3(self):\n             f.clean('http://google.com/we-love-microsoft.html') # good domain, bad page\n         except ValidationError, e:\n             self.assertEqual(\"[u'This URL appears to be a broken link.']\", str(e))\n-        # UTF-8 char in path\n-        self.assertEqual(u'http://de.wikipedia.org/wiki/T\\xfcr', f.clean(u'http://de.wikipedia.org/wiki/T\\xfcr'))\n \n     def test_urlfield_4(self):\n         f = URLField(verify_exists=True, required=False)\n@@ -626,6 +625,18 @@ def test_urlfield_9(self):\n         except ValidationError, e:\n             self.assertEqual(\"[u'This URL appears to be a broken link.']\", str(e))\n \n+    def test_urlfield_10(self):\n+        # UTF-8 char in path, enclosed by a monkey-patch to make sure\n+        # the encoding is passed to urllib2.urlopen\n+        f = URLField(verify_exists=True)\n+        try:\n+            _orig_urlopen = urllib2.urlopen\n+            urllib2.urlopen = lambda req: True\n+            url = u'http://t\\xfcr.djangoproject.com/'\n+            self.assertEqual(url, f.clean(url))\n+        finally:\n+            urllib2.urlopen = _orig_urlopen\n+\n     # BooleanField ################################################################\n \n     def test_booleanfield_1(self):"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 13,
        "deletions": 2
    }
}