{
    "author": "aaugustin",
    "message": "Avoided firing the request_finished signal in tests.\n\n* Avoided calling BaseHttpResponse.close(). The test client take care of\n  that since acc5396e.\n* Disconnected the request_finished signal when this method must be\n  called. The test client has a similar implementation since bacb097a.",
    "sha": "92837ae56999a6f602d22130bfb3c49cd9b40242",
    "files": [
        {
            "sha": "2964a86034691074616763ddb0bc0d0851bbcbd2",
            "filename": "tests/regressiontests/httpwrappers/tests.py",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/92837ae56999a6f602d22130bfb3c49cd9b40242/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/92837ae56999a6f602d22130bfb3c49cd9b40242/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py?ref=92837ae56999a6f602d22130bfb3c49cd9b40242",
            "patch": "@@ -7,6 +7,8 @@\n import warnings\n \n from django.core.exceptions import SuspiciousOperation\n+from django.core.signals import request_finished\n+from django.db import close_connection\n from django.http import (QueryDict, HttpResponse, HttpResponseRedirect,\n                          HttpResponsePermanentRedirect, HttpResponseNotAllowed,\n                          HttpResponseNotModified, StreamingHttpResponse,\n@@ -484,6 +486,15 @@ def test_streaming_response(self):\n             r.tell()\n \n class FileCloseTests(TestCase):\n+\n+    def setUp(self):\n+        # Disable the request_finished signal during this test\n+        # to avoid interfering with the database connection.\n+        request_finished.disconnect(close_connection)\n+\n+    def tearDown(self):\n+        request_finished.connect(close_connection)\n+\n     def test_response(self):\n         filename = os.path.join(os.path.dirname(upath(__file__)), 'abc.txt')\n "
        },
        {
            "sha": "67aec08af2c616cc812a6884bd51de1f68b59099",
            "filename": "tests/regressiontests/serializers_regress/tests.py",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/92837ae56999a6f602d22130bfb3c49cd9b40242/tests%2Fregressiontests%2Fserializers_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/92837ae56999a6f602d22130bfb3c49cd9b40242/tests%2Fregressiontests%2Fserializers_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fserializers_regress%2Ftests.py?ref=92837ae56999a6f602d22130bfb3c49cd9b40242",
            "patch": "@@ -506,7 +506,6 @@ def streamTest(format, self):\n             self.assertEqual(string_data, stream.getvalue())\n         else:\n             self.assertEqual(string_data, stream.content.decode('utf-8'))\n-        stream.close()\n \n for format in serializers.get_serializer_formats():\n     setattr(SerializerTests, 'test_' + format + '_serializer', curry(serializerTest, format))"
        },
        {
            "sha": "bdd9fbfc0bc7a473b1a4eaa8bf2c4647fddfd623",
            "filename": "tests/regressiontests/views/tests/static.py",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/92837ae56999a6f602d22130bfb3c49cd9b40242/tests%2Fregressiontests%2Fviews%2Ftests%2Fstatic.py",
            "raw_url": "https://github.com/django/django/raw/92837ae56999a6f602d22130bfb3c49cd9b40242/tests%2Fregressiontests%2Fviews%2Ftests%2Fstatic.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2Fstatic.py?ref=92837ae56999a6f602d22130bfb3c49cd9b40242",
            "patch": "@@ -27,7 +27,6 @@ def test_serve(self):\n         for filename in media_files:\n             response = self.client.get('/views/%s/%s' % (self.prefix, filename))\n             response_content = b''.join(response)\n-            response.close()\n             file_path = path.join(media_dir, filename)\n             with open(file_path, 'rb') as fp:\n                 self.assertEqual(fp.read(), response_content)\n@@ -36,14 +35,12 @@ def test_serve(self):\n \n     def test_unknown_mime_type(self):\n         response = self.client.get('/views/%s/file.unknown' % self.prefix)\n-        response.close()\n         self.assertEqual('application/octet-stream', response['Content-Type'])\n \n     def test_copes_with_empty_path_component(self):\n         file_name = 'file.txt'\n         response = self.client.get('/views/%s//%s' % (self.prefix, file_name))\n         response_content = b''.join(response)\n-        response.close()\n         with open(path.join(media_dir, file_name), 'rb') as fp:\n             self.assertEqual(fp.read(), response_content)\n \n@@ -52,7 +49,6 @@ def test_is_modified_since(self):\n         response = self.client.get('/views/%s/%s' % (self.prefix, file_name),\n             HTTP_IF_MODIFIED_SINCE='Thu, 1 Jan 1970 00:00:00 GMT')\n         response_content = b''.join(response)\n-        response.close()\n         with open(path.join(media_dir, file_name), 'rb') as fp:\n             self.assertEqual(fp.read(), response_content)\n \n@@ -77,7 +73,6 @@ def test_invalid_if_modified_since(self):\n         response = self.client.get('/views/%s/%s' % (self.prefix, file_name),\n                                    HTTP_IF_MODIFIED_SINCE=invalid_date)\n         response_content = b''.join(response)\n-        response.close()\n         with open(path.join(media_dir, file_name), 'rb') as fp:\n             self.assertEqual(fp.read(), response_content)\n         self.assertEqual(len(response_content),\n@@ -94,7 +89,6 @@ def test_invalid_if_modified_since2(self):\n         response = self.client.get('/views/%s/%s' % (self.prefix, file_name),\n                                    HTTP_IF_MODIFIED_SINCE=invalid_date)\n         response_content = b''.join(response)\n-        response.close()\n         with open(path.join(media_dir, file_name), 'rb') as fp:\n             self.assertEqual(fp.read(), response_content)\n         self.assertEqual(len(response_content),"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 11,
        "deletions": 7
    }
}