{
    "author": "adrianholovaty",
    "message": "Removed a bunch of Python 2.4 workarounds now that we don't support it. Refs #15702 -- thanks to jonash for the patch. Splitting this over muliple commits to make it more manageable.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15926 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "a87be3554fc73a567b926ea51c13ea844b5113f8",
    "files": [
        {
            "sha": "fbda8b7a35bbd4a7dc10fba6f903aa98f53ee214",
            "filename": "django/contrib/admin/options.py",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fadmin%2Foptions.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fadmin%2Foptions.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Foptions.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,3 +1,4 @@\n+from functools import update_wrapper, partial\n from django import forms, template\n from django.forms.formsets import all_valid\n from django.forms.models import (modelform_factory, modelformset_factory,\n@@ -17,10 +18,8 @@\n from django.shortcuts import get_object_or_404, render_to_response\n from django.utils.decorators import method_decorator\n from django.utils.datastructures import SortedDict\n-from django.utils.functional import update_wrapper\n from django.utils.html import escape, escapejs\n from django.utils.safestring import mark_safe\n-from django.utils.functional import curry\n from django.utils.text import capfirst, get_text_list\n from django.utils.translation import ugettext as _\n from django.utils.translation import ungettext\n@@ -426,7 +425,7 @@ def get_form(self, request, obj=None, **kwargs):\n             \"form\": self.form,\n             \"fields\": fields,\n             \"exclude\": exclude,\n-            \"formfield_callback\": curry(self.formfield_for_dbfield, request=request),\n+            \"formfield_callback\": partial(self.formfield_for_dbfield, request=request),\n         }\n         defaults.update(kwargs)\n         return modelform_factory(self.model, **defaults)\n@@ -457,7 +456,7 @@ def get_changelist_form(self, request, **kwargs):\n         Returns a Form class for use in the Formset on the changelist page.\n         \"\"\"\n         defaults = {\n-            \"formfield_callback\": curry(self.formfield_for_dbfield, request=request),\n+            \"formfield_callback\": partial(self.formfield_for_dbfield, request=request),\n         }\n         defaults.update(kwargs)\n         return modelform_factory(self.model, **defaults)\n@@ -468,7 +467,7 @@ def get_changelist_formset(self, request, **kwargs):\n         is used.\n         \"\"\"\n         defaults = {\n-            \"formfield_callback\": curry(self.formfield_for_dbfield, request=request),\n+            \"formfield_callback\": partial(self.formfield_for_dbfield, request=request),\n         }\n         defaults.update(kwargs)\n         return modelformset_factory(self.model,\n@@ -1327,7 +1326,7 @@ def get_formset(self, request, obj=None, **kwargs):\n             \"fk_name\": self.fk_name,\n             \"fields\": fields,\n             \"exclude\": exclude,\n-            \"formfield_callback\": curry(self.formfield_for_dbfield, request=request),\n+            \"formfield_callback\": partial(self.formfield_for_dbfield, request=request),\n             \"extra\": self.extra,\n             \"max_num\": self.max_num,\n             \"can_delete\": self.can_delete,"
        },
        {
            "sha": "1f98db8abc00f6af9454e3438c42b5839302f135",
            "filename": "django/contrib/admin/sites.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fadmin%2Fsites.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fadmin%2Fsites.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fsites.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,4 +1,5 @@\n import re\n+from functools import update_wrapper\n from django import http, template\n from django.contrib.admin import ModelAdmin, actions\n from django.contrib.admin.forms import AdminAuthenticationForm\n@@ -9,7 +10,6 @@\n from django.core.exceptions import ImproperlyConfigured\n from django.core.urlresolvers import reverse\n from django.shortcuts import render_to_response\n-from django.utils.functional import update_wrapper\n from django.utils.safestring import mark_safe\n from django.utils.text import capfirst\n from django.utils.translation import ugettext as _"
        },
        {
            "sha": "9fabe64a6a26469c69be00012c1bbfa1667ea13f",
            "filename": "django/contrib/admin/views/decorators.py",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fadmin%2Fviews%2Fdecorators.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fadmin%2Fviews%2Fdecorators.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fviews%2Fdecorators.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,8 +1,4 @@\n-try:\n-    from functools import wraps\n-except ImportError:\n-    from django.utils.functional import wraps  # Python 2.4 fallback.\n-\n+from functools import wraps\n from django.utils.translation import ugettext as _\n from django.contrib.admin.forms import AdminAuthenticationForm\n from django.contrib.auth.views import login"
        },
        {
            "sha": "f210d4ec79783a2331b8bdb514a577dacb8b525c",
            "filename": "django/contrib/admin/widgets.py",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fadmin%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fadmin%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fwidgets.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -2,8 +2,7 @@\n Form Widget classes specific to the Django admin site.\n \"\"\"\n \n-import django.utils.copycompat as copy\n-\n+import copy\n from django import forms\n from django.forms.widgets import RadioFieldRenderer\n from django.forms.util import flatatt"
        },
        {
            "sha": "00a6bce17d682d49110a4faf9f1df8e363e5e778",
            "filename": "django/contrib/auth/decorators.py",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fauth%2Fdecorators.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fauth%2Fdecorators.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fdecorators.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,9 +1,5 @@\n import urlparse\n-try:\n-    from functools import wraps\n-except ImportError:\n-    from django.utils.functional import wraps  # Python 2.4 fallback.\n-\n+from functools import wraps\n from django.conf import settings\n from django.contrib.auth import REDIRECT_FIELD_NAME\n from django.utils.decorators import available_attrs"
        },
        {
            "sha": "4fceca840a1f3af5e0d9786d0dfd2cad09145aa8",
            "filename": "django/contrib/auth/models.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fauth%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fauth%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fmodels.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,4 +1,5 @@\n import datetime\n+import hashlib\n import urllib\n \n from django.contrib import auth\n@@ -8,7 +9,6 @@\n from django.db.models.manager import EmptyManager\n from django.contrib.contenttypes.models import ContentType\n from django.utils.encoding import smart_str\n-from django.utils.hashcompat import md5_constructor, sha_constructor\n from django.utils.translation import ugettext_lazy as _\n from django.utils.crypto import constant_time_compare\n \n@@ -29,9 +29,9 @@ def get_hexdigest(algorithm, salt, raw_password):\n         return crypt.crypt(raw_password, salt)\n \n     if algorithm == 'md5':\n-        return md5_constructor(salt + raw_password).hexdigest()\n+        return hashlib.md5(salt + raw_password).hexdigest()\n     elif algorithm == 'sha1':\n-        return sha_constructor(salt + raw_password).hexdigest()\n+        return hashlib.sha1(salt + raw_password).hexdigest()\n     raise ValueError(\"Got unknown password algorithm type in password.\")\n \n def check_password(raw_password, enc_password):"
        },
        {
            "sha": "c9baff2261ab762b4ed56b669a234499dbc190f3",
            "filename": "django/contrib/auth/tests/tokens.py",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fauth%2Ftests%2Ftokens.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fauth%2Ftests%2Ftokens.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Ftokens.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -58,14 +58,14 @@ def test_django12_hash(self):\n         # Hard code in the Django 1.2 algorithm (not the result, as it is time\n         # dependent)\n         def _make_token(user):\n-            from django.utils.hashcompat import sha_constructor\n+            import hashlib\n             from django.utils.http import int_to_base36\n \n             timestamp = (date.today() - date(2001,1,1)).days\n             ts_b36 = int_to_base36(timestamp)\n-            hash = sha_constructor(settings.SECRET_KEY + unicode(user.id) +\n-                                   user.password + user.last_login.strftime('%Y-%m-%d %H:%M:%S') +\n-                                   unicode(timestamp)).hexdigest()[::2]\n+            hash = hashlib.sha1(settings.SECRET_KEY + unicode(user.id) +\n+                               user.password + user.last_login.strftime('%Y-%m-%d %H:%M:%S') +\n+                               unicode(timestamp)).hexdigest()[::2]\n             return \"%s-%s\" % (ts_b36, hash)\n \n         user = User.objects.create_user('tokentestuser', 'test2@example.com', 'testpw')"
        },
        {
            "sha": "483c4838a74c54ace3975c4547e7484b60a3a5c4",
            "filename": "django/contrib/auth/tokens.py",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fauth%2Ftokens.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fauth%2Ftokens.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftokens.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,7 +1,6 @@\n from datetime import date\n-\n+import hashlib\n from django.conf import settings\n-from django.utils.hashcompat import sha_constructor\n from django.utils.http import int_to_base36, base36_to_int\n from django.utils.crypto import constant_time_compare, salted_hmac\n \n@@ -67,9 +66,9 @@ def _make_token_with_timestamp(self, user, timestamp):\n     def _make_token_with_timestamp_old(self, user, timestamp):\n         # The Django 1.2 method\n         ts_b36 = int_to_base36(timestamp)\n-        hash = sha_constructor(settings.SECRET_KEY + unicode(user.id) +\n-                               user.password + user.last_login.strftime('%Y-%m-%d %H:%M:%S') +\n-                               unicode(timestamp)).hexdigest()[::2]\n+        hash = hashlib.sha1(settings.SECRET_KEY + unicode(user.id) +\n+                           user.password + user.last_login.strftime('%Y-%m-%d %H:%M:%S') +\n+                           unicode(timestamp)).hexdigest()[::2]\n         return \"%s-%s\" % (ts_b36, hash)\n \n     def _num_days(self, dt):"
        },
        {
            "sha": "a0cfc2452c07cd62ed6b2c8d22e5340119e8e9d1",
            "filename": "django/contrib/comments/forms.py",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fcomments%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fcomments%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fcomments%2Fforms.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,14 +1,13 @@\n-import time\n import datetime\n-\n+import hashlib\n+import time\n from django import forms\n from django.forms.util import ErrorDict\n from django.conf import settings\n from django.contrib.contenttypes.models import ContentType\n from models import Comment\n from django.utils.crypto import salted_hmac, constant_time_compare\n from django.utils.encoding import force_unicode\n-from django.utils.hashcompat import sha_constructor\n from django.utils.text import get_text_list\n from django.utils.translation import ungettext, ugettext_lazy as _\n \n@@ -100,7 +99,7 @@ def _generate_security_hash_old(self, content_type, object_pk, timestamp):\n         \"\"\"Generate a (SHA1) security hash from the provided info.\"\"\"\n         # Django 1.2 compatibility\n         info = (content_type, object_pk, timestamp, settings.SECRET_KEY)\n-        return sha_constructor(\"\".join(info)).hexdigest()\n+        return hashlib.sha1(\"\".join(info)).hexdigest()\n \n class CommentDetailsForm(CommentSecurityForm):\n     \"\"\""
        },
        {
            "sha": "64c1f8b420090513a5699b1b015f53f741ad271f",
            "filename": "django/contrib/contenttypes/generic.py",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fcontenttypes%2Fgeneric.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fcontenttypes%2Fgeneric.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fcontenttypes%2Fgeneric.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -2,6 +2,7 @@\n Classes allowing \"generic\" relations through ContentType and object-id fields.\n \"\"\"\n \n+from functools import partial\n from django.core.exceptions import ObjectDoesNotExist\n from django.db import connection\n from django.db.models import signals\n@@ -11,11 +12,8 @@\n from django.forms import ModelForm\n from django.forms.models import BaseModelFormSet, modelformset_factory, save_instance\n from django.contrib.admin.options import InlineModelAdmin, flatten_fieldsets\n-from django.utils.encoding import smart_unicode\n-from django.utils.functional import curry\n-\n from django.contrib.contenttypes.models import ContentType\n-\n+from django.utils.encoding import smart_unicode\n \n class GenericForeignKey(object):\n     \"\"\"\n@@ -414,7 +412,7 @@ def get_formset(self, request, obj=None):\n             \"ct_field\": self.ct_field,\n             \"fk_field\": self.ct_fk_field,\n             \"form\": self.form,\n-            \"formfield_callback\": curry(self.formfield_for_dbfield, request=request),\n+            \"formfield_callback\": partial(self.formfield_for_dbfield, request=request),\n             \"formset\": self.formset,\n             \"extra\": self.extra,\n             \"can_delete\": self.can_delete,"
        },
        {
            "sha": "7d6398c9a65576c3b5fa86ae5c1fa64a9ff7b3f6",
            "filename": "django/contrib/formtools/preview.py",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fformtools%2Fpreview.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fformtools%2Fpreview.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Fpreview.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -2,13 +2,15 @@\n Formtools Preview application.\n \"\"\"\n \n-import cPickle as pickle\n+try:\n+    import cPickle as pickle\n+except ImportError:\n+    import pickle\n \n from django.conf import settings\n from django.http import Http404\n from django.shortcuts import render_to_response\n from django.template.context import RequestContext\n-from django.utils.hashcompat import md5_constructor\n from django.utils.crypto import constant_time_compare\n from django.contrib.formtools.utils import security_hash\n "
        },
        {
            "sha": "974850dc6e2d568ab1b2fe97a069078acef5bc7e",
            "filename": "django/contrib/formtools/utils.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fformtools%2Futils.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fformtools%2Futils.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Futils.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -3,10 +3,10 @@\n except ImportError:\n     import pickle\n \n+import hashlib\n from django.conf import settings\n from django.forms import BooleanField\n from django.utils.crypto import salted_hmac\n-from django.utils.hashcompat import md5_constructor\n \n \n def security_hash(request, form, *args):\n@@ -39,7 +39,7 @@ def security_hash(request, form, *args):\n     # Python 2.3, but Django requires 2.4 anyway, so that's OK.\n     pickled = pickle.dumps(data, pickle.HIGHEST_PROTOCOL)\n \n-    return md5_constructor(pickled).hexdigest()\n+    return hashlib.md5(pickled).hexdigest()\n \n \n def form_hmac(form):"
        },
        {
            "sha": "d581f0df83a099bf592b68f7012af66add409d5f",
            "filename": "django/contrib/formtools/wizard.py",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fformtools%2Fwizard.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fformtools%2Fwizard.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Fwizard.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -4,7 +4,10 @@\n stored on the server side.\n \"\"\"\n \n-import cPickle as pickle\n+try:\n+    import cPickle as pickle\n+except ImportError:\n+    import pickle\n \n from django import forms\n from django.conf import settings\n@@ -13,7 +16,6 @@\n from django.shortcuts import render_to_response\n from django.template.context import RequestContext\n from django.utils.crypto import constant_time_compare\n-from django.utils.hashcompat import md5_constructor\n from django.utils.translation import ugettext_lazy as _\n from django.utils.decorators import method_decorator\n from django.views.decorators.csrf import csrf_protect"
        },
        {
            "sha": "4620a9fb528913d2fd90d2562eebb0964c0cdeb3",
            "filename": "django/contrib/gis/geos/tests/test_geos.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -820,7 +820,7 @@ def test21_test_gdal(self):\n \n     def test22_copy(self):\n         \"Testing use with the Python `copy` module.\"\n-        import django.utils.copycompat as copy\n+        import copy\n         poly = GEOSGeometry('POLYGON((0 0, 0 23, 23 23, 23 0, 0 0), (5 5, 5 10, 10 10, 10 5, 5 5))')\n         cpy1 = copy.copy(poly)\n         cpy2 = copy.deepcopy(poly)"
        },
        {
            "sha": "c8f7e658adf94c5aed2955caba98a4698ccdb0a6",
            "filename": "django/contrib/gis/geos/tests/test_geos_mutation.py",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos_mutation.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos_mutation.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos_mutation.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -2,8 +2,7 @@\n # Modified from original contribution by Aryeh Leib Taurog, which was\n # released under the New BSD license.\n \n-import django.utils.copycompat as copy\n-\n+import copy\n from django.contrib.gis.geos import *\n from django.contrib.gis.geos.error import GEOSIndexError\n from django.utils import unittest"
        },
        {
            "sha": "3caa22d09bda3019c8a0a70326bad6dfdfb24ade",
            "filename": "django/contrib/gis/tests/layermap/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Ftests.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,7 +1,7 @@\n+import copy\n import os\n from decimal import Decimal\n \n-from django.utils.copycompat import copy\n from django.utils.unittest import TestCase\n \n from django.contrib.gis.gdal import DataSource, OGRException"
        },
        {
            "sha": "7dfc39e6cb3a7de3afd5d7a94d2a7e84167b538e",
            "filename": "django/contrib/sessions/backends/base.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fsessions%2Fbackends%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fsessions%2Fbackends%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Fbackends%2Fbase.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,4 +1,5 @@\n import base64\n+import hashlib\n import os\n import random\n import sys\n@@ -11,7 +12,6 @@\n \n from django.conf import settings\n from django.core.exceptions import SuspiciousOperation\n-from django.utils.hashcompat import md5_constructor\n from django.utils.crypto import constant_time_compare, salted_hmac\n \n # Use the system (hardware-based) random number generator if it exists.\n@@ -119,7 +119,7 @@ def decode(self, session_data):\n     def _decode_old(self, session_data):\n         encoded_data = base64.decodestring(session_data)\n         pickled, tamper_check = encoded_data[:-32], encoded_data[-32:]\n-        if not constant_time_compare(md5_constructor(pickled + settings.SECRET_KEY).hexdigest(),\n+        if not constant_time_compare(hashlib.md5(pickled + settings.SECRET_KEY).hexdigest(),\n                                      tamper_check):\n             raise SuspiciousOperation(\"User tampered with session cookie.\")\n         return pickle.loads(pickled)\n@@ -161,7 +161,7 @@ def _get_new_session_key(self):\n             # No getpid() in Jython, for example\n             pid = 1\n         while 1:\n-            session_key = md5_constructor(\"%s%s%s%s\"\n+            session_key = hashlib.md5(\"%s%s%s%s\"\n                     % (randrange(0, MAX_SESSION_KEY), pid, time.time(),\n                        settings.SECRET_KEY)).hexdigest()\n             if not self.exists(session_key):"
        },
        {
            "sha": "9cce3549acc33025028d8cb0a680d07e303421ad",
            "filename": "django/contrib/sessions/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fsessions%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcontrib%2Fsessions%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Ftests.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,5 +1,6 @@\n import base64\n from datetime import datetime, timedelta\n+import hashlib\n import pickle\n import shutil\n import tempfile\n@@ -15,7 +16,6 @@\n from django.http import HttpResponse\n from django.test import TestCase, RequestFactory\n from django.utils import unittest\n-from django.utils.hashcompat import md5_constructor\n \n \n class SessionTestsMixin(object):\n@@ -257,7 +257,7 @@ def test_decode_django12(self):\n         # Hard code the Django 1.2 method here:\n         def encode(session_dict):\n             pickled = pickle.dumps(session_dict, pickle.HIGHEST_PROTOCOL)\n-            pickled_md5 = md5_constructor(pickled + settings.SECRET_KEY).hexdigest()\n+            pickled_md5 = hashlib.md5(pickled + settings.SECRET_KEY).hexdigest()\n             return base64.encodestring(pickled + pickled_md5)\n \n         data = {'a test key': 'a test value'}"
        },
        {
            "sha": "57bb63eedcbe54cac5da5b467942b7c9a4b1ff24",
            "filename": "django/core/cache/backends/filebased.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcore%2Fcache%2Fbackends%2Ffilebased.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcore%2Fcache%2Fbackends%2Ffilebased.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fcache%2Fbackends%2Ffilebased.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -1,15 +1,15 @@\n \"File-based cache backend\"\n \n+import hashlib\n import os\n-import time\n import shutil\n+import time\n try:\n     import cPickle as pickle\n except ImportError:\n     import pickle\n \n from django.core.cache.backends.base import BaseCache\n-from django.utils.hashcompat import md5_constructor\n \n class FileBasedCache(BaseCache):\n     def __init__(self, dir, params):\n@@ -145,7 +145,7 @@ def _key_to_file(self, key):\n         Thus, a cache key of \"foo\" gets turnned into a file named\n         ``{cache-dir}ac/bd/18db4cc2f85cedef654fccc4a4d8``.\n         \"\"\"\n-        path = md5_constructor(key).hexdigest()\n+        path = hashlib.md5(key).hexdigest()\n         path = os.path.join(path[:2], path[2:4], path[4:])\n         return os.path.join(self._dir, path)\n "
        },
        {
            "sha": "fa3b4b7f180cedada92b01c5cc277acec3fad4cd",
            "filename": "django/core/cache/backends/locmem.py",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcore%2Fcache%2Fbackends%2Flocmem.py",
            "raw_url": "https://github.com/django/django/raw/a87be3554fc73a567b926ea51c13ea844b5113f8/django%2Fcore%2Fcache%2Fbackends%2Flocmem.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fcache%2Fbackends%2Flocmem.py?ref=a87be3554fc73a567b926ea51c13ea844b5113f8",
            "patch": "@@ -77,12 +77,10 @@ def set(self, key, value, timeout=None, version=None):\n         key = self.make_key(key, version=version)\n         self.validate_key(key)\n         self._lock.writer_enters()\n-        # Python 2.4 doesn't allow combined try-except-finally blocks.\n         try:\n-            try:\n-                self._set(key, pickle.dumps(value), timeout)\n-            except pickle.PickleError:\n-                pass\n+            self._set(key, pickle.dumps(value), timeout)\n+        except pickle.PickleError:\n+            pass\n         finally:\n             self._lock.writer_leaves()\n "
        }
    ],
    "stats": {
        "total": 113,
        "additions": 50,
        "deletions": 63
    }
}