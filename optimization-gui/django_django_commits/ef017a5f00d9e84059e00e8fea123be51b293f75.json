{
    "author": "aaugustin",
    "message": "Advanced pending deprecation warnings.\n\nAlso added stacklevel argument, fixed #18127.",
    "sha": "ef017a5f00d9e84059e00e8fea123be51b293f75",
    "files": [
        {
            "sha": "5a2ce210f403ce4de577568cf3de95ebcfb94d42",
            "filename": "django/bin/daily_cleanup.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fbin%2Fdaily_cleanup.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fbin%2Fdaily_cleanup.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fbin%2Fdaily_cleanup.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -15,5 +15,5 @@\n     warnings.warn(\n         \"The `daily_cleanup` script has been deprecated \"\n         \"in favor of `django-admin.py clearsessions`.\",\n-        PendingDeprecationWarning)\n+        DeprecationWarning)\n     management.call_command('clearsessions')"
        },
        {
            "sha": "bbcc16e12098b914a125d0e6ea661f3b8d7b7667",
            "filename": "django/conf/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fconf%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fconf%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fconf%2F__init__.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -139,7 +139,7 @@ def __init__(self, settings_module):\n                         isinstance(setting_value, six.string_types):\n                     warnings.warn(\"The %s setting must be a tuple. Please fix your \"\n                                   \"settings, as auto-correction is now deprecated.\" % setting,\n-                        PendingDeprecationWarning)\n+                                  DeprecationWarning, stacklevel=2)\n                     setting_value = (setting_value,) # In case the user forgot the comma.\n                 setattr(self, setting, setting_value)\n "
        },
        {
            "sha": "6f20981ca6349e18139e86354333330ea4706683",
            "filename": "django/contrib/auth/models.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fcontrib%2Fauth%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fcontrib%2Fauth%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fmodels.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -427,7 +427,7 @@ def get_profile(self):\n         SiteProfileNotAvailable if this site does not allow profiles.\n         \"\"\"\n         warnings.warn(\"The use of AUTH_PROFILE_MODULE to define user profiles has been deprecated.\",\n-            PendingDeprecationWarning)\n+            DeprecationWarning, stacklevel=2)\n         if not hasattr(self, '_profile_cache'):\n             from django.conf import settings\n             if not getattr(settings, 'AUTH_PROFILE_MODULE', False):"
        },
        {
            "sha": "e158ebb54152d8e569d9343eff8876ba8857258b",
            "filename": "django/core/management/commands/cleanup.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fcore%2Fmanagement%2Fcommands%2Fcleanup.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fcore%2Fmanagement%2Fcommands%2Fcleanup.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fcleanup.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -7,5 +7,5 @@ class Command(clearsessions.Command):\n     def handle_noargs(self, **options):\n         warnings.warn(\n             \"The `cleanup` command has been deprecated in favor of `clearsessions`.\",\n-            PendingDeprecationWarning)\n+            DeprecationWarning)\n         super(Command, self).handle_noargs(**options)"
        },
        {
            "sha": "ee58a77886ebbbe20c518a273fb197f762ffacd6",
            "filename": "django/db/models/query.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fdb%2Fmodels%2Fquery.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fdb%2Fmodels%2Fquery.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fquery.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -703,7 +703,7 @@ def select_related(self, *fields, **kwargs):\n         \"\"\"\n         if 'depth' in kwargs:\n             warnings.warn('The \"depth\" keyword argument has been deprecated.\\n'\n-                    'Use related field names instead.', PendingDeprecationWarning)\n+                    'Use related field names instead.', DeprecationWarning, stacklevel=2)\n         depth = kwargs.pop('depth', 0)\n         if kwargs:\n             raise TypeError('Unexpected keyword arguments to select_related: %s'"
        },
        {
            "sha": "d667ba6eed91a19e655cd1fb60f1ba4359b1bbad",
            "filename": "django/http/response.py",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fhttp%2Fresponse.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Fhttp%2Fresponse.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fhttp%2Fresponse.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -42,7 +42,8 @@ def __init__(self, content_type=None, status=None, mimetype=None):\n         self._closable_objects = []\n         if mimetype:\n             warnings.warn(\"Using mimetype keyword argument is deprecated, use\"\n-                          \" content_type instead\", PendingDeprecationWarning)\n+                          \" content_type instead\",\n+                          DeprecationWarning, stacklevel=2)\n             content_type = mimetype\n         if not content_type:\n             content_type = \"%s; charset=%s\" % (settings.DEFAULT_CONTENT_TYPE,\n@@ -296,7 +297,7 @@ def __iter__(self):\n                 'Creating streaming responses with `HttpResponse` is '\n                 'deprecated. Use `StreamingHttpResponse` instead '\n                 'if you need the streaming behavior.',\n-                PendingDeprecationWarning, stacklevel=2)\n+                DeprecationWarning, stacklevel=2)\n         if not hasattr(self, '_iterator'):\n             self._iterator = iter(self._container)\n         return self\n@@ -352,14 +353,14 @@ class CompatibleStreamingHttpResponse(StreamingHttpResponse):\n \n     These responses will stream only if no middleware attempts to access the\n     `content` attribute. Otherwise, they will behave like a regular response,\n-    and raise a `PendingDeprecationWarning`.\n+    and raise a `DeprecationWarning`.\n     \"\"\"\n     @property\n     def content(self):\n         warnings.warn(\n             'Accessing the `content` attribute on a streaming response is '\n             'deprecated. Use the `streaming_content` attribute instead.',\n-            PendingDeprecationWarning)\n+            DeprecationWarning, stacklevel=2)\n         content = b''.join(self)\n         self.streaming_content = [content]\n         return content\n@@ -369,7 +370,7 @@ def content(self, content):\n         warnings.warn(\n             'Accessing the `content` attribute on a streaming response is '\n             'deprecated. Use the `streaming_content` attribute instead.',\n-            PendingDeprecationWarning)\n+            DeprecationWarning, stacklevel=2)\n         self.streaming_content = [content]\n \n "
        },
        {
            "sha": "64c218fe43d4e26775805e163b653b95d38291d8",
            "filename": "django/utils/datastructures.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Futils%2Fdatastructures.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Futils%2Fdatastructures.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fdatastructures.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -217,15 +217,15 @@ def value_for_index(self, index):\n         # using collections.OrderedDict (Python 2.7 and up), which we'll\n         # eventually switch to\n         warnings.warn(\n-            \"SortedDict.value_for_index is deprecated\", PendingDeprecationWarning,\n+            \"SortedDict.value_for_index is deprecated\", DeprecationWarning,\n             stacklevel=2\n         )\n         return self[self.keyOrder[index]]\n \n     def insert(self, index, key, value):\n         \"\"\"Inserts the key, value pair before the item with the given index.\"\"\"\n         warnings.warn(\n-            \"SortedDict.insert is deprecated\", PendingDeprecationWarning,\n+            \"SortedDict.insert is deprecated\", DeprecationWarning,\n             stacklevel=2\n         )\n         if key in self.keyOrder:"
        },
        {
            "sha": "68929cc0e5b02d0c321e2d1544cb3ffa3d978f6a",
            "filename": "django/utils/encoding.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Futils%2Fencoding.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Futils%2Fencoding.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fencoding.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -36,7 +36,7 @@ class StrAndUnicode(object):\n     def __init__(self, *args, **kwargs):\n         warnings.warn(\"StrAndUnicode is deprecated. Define a __str__ method \"\n                       \"and apply the @python_2_unicode_compatible decorator \"\n-                      \"instead.\", PendingDeprecationWarning, stacklevel=2)\n+                      \"instead.\", DeprecationWarning, stacklevel=2)\n         super(StrAndUnicode, self).__init__(*args, **kwargs)\n \n     if six.PY3:"
        },
        {
            "sha": "e7ea3265360d137a7adcb13f762fd45708563958",
            "filename": "django/utils/itercompat.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Futils%2Fitercompat.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Futils%2Fitercompat.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fitercompat.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -19,5 +19,5 @@ def is_iterable(x):\n \n def product(*args, **kwds):\n     warnings.warn(\"django.utils.itercompat.product is deprecated; use the native version instead\",\n-                  PendingDeprecationWarning)\n+                  DeprecationWarning, stacklevel=2)\n     return itertools.product(*args, **kwds)"
        },
        {
            "sha": "d4032a6b349009261a0cbdf96888e1d50aef3541",
            "filename": "django/utils/simplejson.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Futils%2Fsimplejson.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/django%2Futils%2Fsimplejson.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fsimplejson.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -9,7 +9,7 @@\n \n import warnings\n warnings.warn(\"django.utils.simplejson is deprecated; use json instead.\",\n-              PendingDeprecationWarning)\n+              DeprecationWarning, stacklevel=2)\n \n try:\n     import simplejson"
        },
        {
            "sha": "67172d963cc22cb08a98c89360a75b254f5e9d4e",
            "filename": "tests/regressiontests/httpwrappers/tests.py",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -326,13 +326,13 @@ def test_iter_content(self):\n         r = HttpResponse()\n         r.content = ['1', '2', 3, '\\u079e']\n         with warnings.catch_warnings(record=True) as w:\n-            warnings.simplefilter(\"always\", PendingDeprecationWarning)\n+            warnings.simplefilter(\"always\", DeprecationWarning)\n             my_iter = iter(r)\n-            self.assertEqual(w[0].category, PendingDeprecationWarning)\n+            self.assertEqual(w[0].category, DeprecationWarning)\n         with warnings.catch_warnings(record=True) as w:\n-            warnings.simplefilter(\"always\", PendingDeprecationWarning)\n+            warnings.simplefilter(\"always\", DeprecationWarning)\n             result = list(my_iter)\n-            self.assertEqual(w[0].category, PendingDeprecationWarning)\n+            self.assertEqual(w[0].category, DeprecationWarning)\n         #'\\xde\\x9e' == unichr(1950).encode('utf-8')\n         self.assertEqual(result, [b'1', b'2', b'3', b'\\xde\\x9e'])\n         self.assertEqual(r.content, b'123\\xde\\x9e')\n@@ -360,7 +360,7 @@ def test_iter_content(self):\n         # XXX change this when the deprecation completes in HttpResponse\n         r = HttpResponse(iter(['hello', 'world']))\n         with warnings.catch_warnings():\n-            warnings.simplefilter(\"ignore\", PendingDeprecationWarning)\n+            warnings.simplefilter(\"ignore\", DeprecationWarning)\n             self.assertEqual(b''.join(r), b'helloworld')\n         self.assertEqual(r.content, b'')                # not the expected result!\n \n@@ -497,7 +497,7 @@ def test_response(self):\n         r = HttpResponse(file1)\n         self.assertFalse(file1.closed)\n         with warnings.catch_warnings():\n-            warnings.simplefilter(\"ignore\", PendingDeprecationWarning)\n+            warnings.simplefilter(\"ignore\", DeprecationWarning)\n             list(r)\n         self.assertFalse(file1.closed)\n         r.close()"
        },
        {
            "sha": "3161c04f97265ea827a19bc6eb44e0b4885d5af4",
            "filename": "tests/regressiontests/utils/datastructures.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/ef017a5f00d9e84059e00e8fea123be51b293f75/tests%2Fregressiontests%2Futils%2Fdatastructures.py",
            "raw_url": "https://github.com/django/django/raw/ef017a5f00d9e84059e00e8fea123be51b293f75/tests%2Fregressiontests%2Futils%2Fdatastructures.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Futils%2Fdatastructures.py?ref=ef017a5f00d9e84059e00e8fea123be51b293f75",
            "patch": "@@ -139,14 +139,14 @@ def test_insert(self):\n         with warnings.catch_warnings(record=True) as w:\n             warnings.simplefilter(\"always\")\n             d.insert(0, \"hello\", \"world\")\n-        assert w[0].category is PendingDeprecationWarning\n+        assert w[0].category is DeprecationWarning\n \n     def test_value_for_index(self):\n         d = SortedDict({\"a\": 3})\n         with warnings.catch_warnings(record=True) as w:\n             warnings.simplefilter(\"always\")\n             self.assertEqual(d.value_for_index(0), 3)\n-        assert w[0].category is PendingDeprecationWarning\n+        assert w[0].category is DeprecationWarning\n \n \n class MergeDictTests(SimpleTestCase):"
        }
    ],
    "stats": {
        "total": 47,
        "additions": 24,
        "deletions": 23
    }
}