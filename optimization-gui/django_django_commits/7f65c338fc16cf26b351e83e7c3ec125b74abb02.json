{
    "author": "freakboy3742",
    "message": "Fixed #14303 -- Ensure that the ids created for new inlines are unique after interstitial deletions have occurred. Thanks to m0nonoke for the report, and Julien Phalip for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15422 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "7f65c338fc16cf26b351e83e7c3ec125b74abb02",
    "files": [
        {
            "sha": "ddaf3557afed47e8ba1b3fa836ea8832be47552c",
            "filename": "django/contrib/admin/media/js/inlines.js",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/7f65c338fc16cf26b351e83e7c3ec125b74abb02/django%2Fcontrib%2Fadmin%2Fmedia%2Fjs%2Finlines.js",
            "raw_url": "https://github.com/django/django/raw/7f65c338fc16cf26b351e83e7c3ec125b74abb02/django%2Fcontrib%2Fadmin%2Fmedia%2Fjs%2Finlines.js",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fmedia%2Fjs%2Finlines.js?ref=7f65c338fc16cf26b351e83e7c3ec125b74abb02",
            "patch": "@@ -31,6 +31,7 @@\n \t\t\t}\n \t\t};\n \t\tvar totalForms = $(\"#id_\" + options.prefix + \"-TOTAL_FORMS\").attr(\"autocomplete\", \"off\");\n+\t\tvar nextIndex = parseInt(totalForms.val());\n \t\tvar maxForms = $(\"#id_\" + options.prefix + \"-MAX_NUM_FORMS\").attr(\"autocomplete\", \"off\");\n \t\t// only show the add button if we are allowed to add more items,\n         // note that max_num = None translates to a blank string.\n@@ -53,12 +54,12 @@\n \t\t\t}\n \t\t\taddButton.click(function() {\n \t\t\t\tvar totalForms = $(\"#id_\" + options.prefix + \"-TOTAL_FORMS\");\n-\t\t\t\tvar nextIndex = parseInt(totalForms.val());\n \t\t\t\tvar template = $(\"#\" + options.prefix + \"-empty\");\n \t\t\t\tvar row = template.clone(true);\n \t\t\t\trow.removeClass(options.emptyCssClass)\n \t\t\t\t    .addClass(options.formCssClass)\n \t\t\t\t    .attr(\"id\", options.prefix + \"-\" + nextIndex);\n+\t\t\t\tnextIndex += 1;\n \t\t\t\trow.find(\"*\")\n \t\t\t\t    .filter(function() {\n \t\t\t\t        var el = $(this);\n@@ -94,7 +95,7 @@\n \t\t\t\t// Insert the new form when it has been fully edited\n \t\t\t\trow.insertBefore($(template));\n \t\t\t\t// Update number of total forms\n-\t\t\t\t$(totalForms).val(nextIndex + 1);\n+\t\t\t\t$(totalForms).val(parseInt(totalForms.val()) + 1);\n \t\t\t\t// Hide add button in case we've hit the max, except we want to add infinitely\n \t\t\t\tif ((maxForms.val() != '') && (maxForms.val()-totalForms.val()) <= 0) {\n \t\t\t\t\taddButton.parent().hide();"
        },
        {
            "sha": "c3336d004d082b98da6b3b51832191e654413962",
            "filename": "django/contrib/admin/media/js/inlines.min.js",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/7f65c338fc16cf26b351e83e7c3ec125b74abb02/django%2Fcontrib%2Fadmin%2Fmedia%2Fjs%2Finlines.min.js",
            "raw_url": "https://github.com/django/django/raw/7f65c338fc16cf26b351e83e7c3ec125b74abb02/django%2Fcontrib%2Fadmin%2Fmedia%2Fjs%2Finlines.min.js",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fmedia%2Fjs%2Finlines.min.js?ref=7f65c338fc16cf26b351e83e7c3ec125b74abb02",
            "patch": "@@ -1,6 +1,6 @@\n-(function(a){a.fn.formset=function(g){var b=a.extend({},a.fn.formset.defaults,g),l=function(e,f,j){var d=RegExp(\"(\"+f+\"-\\\\d+)\");f=f+\"-\"+j;a(e).attr(\"for\")&&a(e).attr(\"for\",a(e).attr(\"for\").replace(d,f));if(e.id)e.id=e.id.replace(d,f);if(e.name)e.name=e.name.replace(d,f)};g=a(\"#id_\"+b.prefix+\"-TOTAL_FORMS\").attr(\"autocomplete\",\"off\");var h=a(\"#id_\"+b.prefix+\"-MAX_NUM_FORMS\").attr(\"autocomplete\",\"off\");g=h.val()==\"\"||h.val()-g.val()>0;a(this).each(function(){a(this).not(\".\"+b.emptyCssClass).addClass(b.formCssClass)});\n-if(a(this).length&&g){var i;if(a(this).attr(\"tagName\")==\"TR\"){g=this.eq(0).children().length;a(this).parent().append('<tr class=\"'+b.addCssClass+'\"><td colspan=\"'+g+'\"><a href=\"javascript:void(0)\">'+b.addText+\"</a></tr>\");i=a(this).parent().find(\"tr:last a\")}else{a(this).filter(\":last\").after('<div class=\"'+b.addCssClass+'\"><a href=\"javascript:void(0)\">'+b.addText+\"</a></div>\");i=a(this).filter(\":last\").next().find(\"a\")}i.click(function(){var e=a(\"#id_\"+b.prefix+\"-TOTAL_FORMS\"),f=parseInt(e.val()),\n-j=a(\"#\"+b.prefix+\"-empty\"),d=j.clone(true);d.removeClass(b.emptyCssClass).addClass(b.formCssClass).attr(\"id\",b.prefix+\"-\"+f);d.find(\"*\").filter(function(){var c=a(this);return c.attr(\"id\")&&c.attr(\"id\").search(/__prefix__/)>=0}).each(function(){var c=a(this);c.attr(\"id\",c.attr(\"id\").replace(/__prefix__/g,f))}).end().filter(function(){var c=a(this);return c.attr(\"name\")&&c.attr(\"name\").search(/__prefix__/)>=0}).each(function(){var c=a(this);c.attr(\"name\",c.attr(\"name\").replace(/__prefix__/g,f))});\n-if(d.is(\"tr\"))d.children(\":last\").append('<div><a class=\"'+b.deleteCssClass+'\" href=\"javascript:void(0)\">'+b.deleteText+\"</a></div>\");else d.is(\"ul\")||d.is(\"ol\")?d.append('<li><a class=\"'+b.deleteCssClass+'\" href=\"javascript:void(0)\">'+b.deleteText+\"</a></li>\"):d.children(\":first\").append('<span><a class=\"'+b.deleteCssClass+'\" href=\"javascript:void(0)\">'+b.deleteText+\"</a></span>\");d.find(\"input,select,textarea,label,a\").each(function(){l(this,b.prefix,e.val())});d.insertBefore(a(j));a(e).val(f+1);\n-h.val()!=\"\"&&h.val()-e.val()<=0&&i.parent().hide();d.find(\"a.\"+b.deleteCssClass).click(function(){var c=a(this).parents(\".\"+b.formCssClass);c.remove();b.removed&&b.removed(c);c=a(\".\"+b.formCssClass);a(\"#id_\"+b.prefix+\"-TOTAL_FORMS\").val(c.length);if(h.val()==\"\"||h.val()-c.length>0)i.parent().show();for(var k=0,m=c.length;k<m;k++)a(c.get(k)).find(\"input,select,textarea,label,a\").each(function(){l(this,b.prefix,k)});return false});b.added&&b.added(d);return false})}return this};a.fn.formset.defaults=\n+(function(a){a.fn.formset=function(g){var b=a.extend({},a.fn.formset.defaults,g),l=function(d,f,e){var c=new RegExp(\"(\"+f+\"-\\\\d+)\");f=f+\"-\"+e;a(d).attr(\"for\")&&a(d).attr(\"for\",a(d).attr(\"for\").replace(c,f));if(d.id)d.id=d.id.replace(c,f);if(d.name)d.name=d.name.replace(c,f)};g=a(\"#id_\"+b.prefix+\"-TOTAL_FORMS\").attr(\"autocomplete\",\"off\");var j=parseInt(g.val()),h=a(\"#id_\"+b.prefix+\"-MAX_NUM_FORMS\").attr(\"autocomplete\",\"off\");g=h.val()==\"\"||h.val()-g.val()>0;a(this).each(function(){a(this).not(\".\"+\n+b.emptyCssClass).addClass(b.formCssClass)});if(a(this).length&&g){var i;if(a(this).attr(\"tagName\")==\"TR\"){g=this.eq(0).children().length;a(this).parent().append('<tr class=\"'+b.addCssClass+'\"><td colspan=\"'+g+'\"><a href=\"javascript:void(0)\">'+b.addText+\"</a></tr>\");i=a(this).parent().find(\"tr:last a\")}else{a(this).filter(\":last\").after('<div class=\"'+b.addCssClass+'\"><a href=\"javascript:void(0)\">'+b.addText+\"</a></div>\");i=a(this).filter(\":last\").next().find(\"a\")}i.click(function(){var d=a(\"#id_\"+\n+b.prefix+\"-TOTAL_FORMS\"),f=a(\"#\"+b.prefix+\"-empty\"),e=f.clone(true);e.removeClass(b.emptyCssClass).addClass(b.formCssClass).attr(\"id\",b.prefix+\"-\"+j);j+=1;e.find(\"*\").filter(function(){var c=a(this);return c.attr(\"id\")&&c.attr(\"id\").search(/__prefix__/)>=0}).each(function(){var c=a(this);c.attr(\"id\",c.attr(\"id\").replace(/__prefix__/g,j))}).end().filter(function(){var c=a(this);return c.attr(\"name\")&&c.attr(\"name\").search(/__prefix__/)>=0}).each(function(){var c=a(this);c.attr(\"name\",c.attr(\"name\").replace(/__prefix__/g,\n+j))});if(e.is(\"tr\"))e.children(\":last\").append('<div><a class=\"'+b.deleteCssClass+'\" href=\"javascript:void(0)\">'+b.deleteText+\"</a></div>\");else e.is(\"ul\")||e.is(\"ol\")?e.append('<li><a class=\"'+b.deleteCssClass+'\" href=\"javascript:void(0)\">'+b.deleteText+\"</a></li>\"):e.children(\":first\").append('<span><a class=\"'+b.deleteCssClass+'\" href=\"javascript:void(0)\">'+b.deleteText+\"</a></span>\");e.find(\"input,select,textarea,label,a\").each(function(){l(this,b.prefix,d.val())});e.insertBefore(a(f));a(d).val(parseInt(d.val())+\n+1);h.val()!=\"\"&&h.val()-d.val()<=0&&i.parent().hide();e.find(\"a.\"+b.deleteCssClass).click(function(){var c=a(this).parents(\".\"+b.formCssClass);c.remove();b.removed&&b.removed(c);c=a(\".\"+b.formCssClass);a(\"#id_\"+b.prefix+\"-TOTAL_FORMS\").val(c.length);if(h.val()==\"\"||h.val()-c.length>0)i.parent().show();for(var k=0,m=c.length;k<m;k++)a(c.get(k)).find(\"input,select,textarea,label,a\").each(function(){l(this,b.prefix,k)});return false});b.added&&b.added(e);return false})}return this};a.fn.formset.defaults=\n {prefix:\"form\",addText:\"add another\",deleteText:\"remove\",addCssClass:\"add-row\",deleteCssClass:\"delete-row\",emptyCssClass:\"empty-row\",formCssClass:\"dynamic-form\",added:null,removed:null}})(django.jQuery);"
        },
        {
            "sha": "aa94937963eb83e0aed79c6615d6a5609ebb2438",
            "filename": "django/contrib/admin/media/js/prepopulate.min.js",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/7f65c338fc16cf26b351e83e7c3ec125b74abb02/django%2Fcontrib%2Fadmin%2Fmedia%2Fjs%2Fprepopulate.min.js",
            "raw_url": "https://github.com/django/django/raw/7f65c338fc16cf26b351e83e7c3ec125b74abb02/django%2Fcontrib%2Fadmin%2Fmedia%2Fjs%2Fprepopulate.min.js",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fmedia%2Fjs%2Fprepopulate.min.js?ref=7f65c338fc16cf26b351e83e7c3ec125b74abb02",
            "patch": "@@ -1 +1 @@\n-(function(a){a.fn.prepopulate=function(d,g){return this.each(function(){var b=a(this);b.data(\"_changed\",false);b.change(function(){b.data(\"_changed\",true)});var c=function(){if(b.data(\"_changed\")!=true){var e=[];a.each(d,function(h,f){a(f).val().length>0&&e.push(a(f).val())});b.val(URLify(e.join(\" \"),g))}};a(d.join(\",\")).keyup(c).change(c).focus(c)})}})(django.jQuery);\n\\ No newline at end of file\n+(function(a){a.fn.prepopulate=function(d,g){return this.each(function(){var b=a(this);b.data(\"_changed\",false);b.change(function(){b.data(\"_changed\",true)});var c=function(){if(b.data(\"_changed\")!=true){var e=[];a.each(d,function(h,f){a(f).val().length>0&&e.push(a(f).val())});b.val(URLify(e.join(\" \"),g))}};a(d.join(\",\")).keyup(c).change(c).focus(c)})}})(django.jQuery);"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 9,
        "deletions": 8
    }
}