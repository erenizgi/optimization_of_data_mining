{
    "author": "claudep",
    "message": "Fixed #18367 -- Allowed LayerMapping to store strings in TextField.\n\nThanks geoffhing@gmail.com for the report.",
    "sha": "f4abba5200e3164003781698c0854383bbc210be",
    "files": [
        {
            "sha": "b58dccdf37e3b808f45f8cfaed5ff2e8c6a1990e",
            "filename": "django/contrib/gis/tests/layermap/models.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/f4abba5200e3164003781698c0854383bbc210be/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/f4abba5200e3164003781698c0854383bbc210be/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Fmodels.py?ref=f4abba5200e3164003781698c0854383bbc210be",
            "patch": "@@ -17,6 +17,7 @@ class CountyFeat(models.Model):\n \n class City(models.Model):\n     name = models.CharField(max_length=25)\n+    name_txt = models.TextField(default='')\n     population = models.IntegerField()\n     density = models.DecimalField(max_digits=7, decimal_places=1)\n     dt = models.DateField()"
        },
        {
            "sha": "85b8d0c8b5dc0f56fc90ad7da4e37cbaa9b2bb3d",
            "filename": "django/contrib/gis/tests/layermap/tests.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/f4abba5200e3164003781698c0854383bbc210be/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/f4abba5200e3164003781698c0854383bbc210be/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Ftests.py?ref=f4abba5200e3164003781698c0854383bbc210be",
            "patch": "@@ -272,3 +272,12 @@ def test_invalid_layer(self):\n         lm = LayerMapping(Invalid, invalid_shp, invalid_mapping,\n                           source_srs=4326)\n         lm.save(silent=True)\n+\n+    def test_textfield(self):\n+        \"Tests that String content fits also in a TextField\"\n+        mapping = copy(city_mapping)\n+        mapping['name_txt'] = 'Name'\n+        lm = LayerMapping(City, city_shp, mapping)\n+        lm.save(silent=True, strict=True)\n+        self.assertEqual(City.objects.count(), 3)\n+        self.assertEqual(City.objects.all().order_by('name_txt')[0].name_txt, \"Houston\")"
        },
        {
            "sha": "48d6c1b70e219d004049d99c7b2c341cfeb34587",
            "filename": "django/contrib/gis/utils/layermapping.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/f4abba5200e3164003781698c0854383bbc210be/django%2Fcontrib%2Fgis%2Futils%2Flayermapping.py",
            "raw_url": "https://github.com/django/django/raw/f4abba5200e3164003781698c0854383bbc210be/django%2Fcontrib%2Fgis%2Futils%2Flayermapping.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Futils%2Flayermapping.py?ref=f4abba5200e3164003781698c0854383bbc210be",
            "patch": "@@ -332,7 +332,7 @@ def verify_ogr_field(self, ogr_field, model_field):\n                 val = unicode(ogr_field.value, self.encoding)\n             else:\n                 val = ogr_field.value\n-                if len(val) > model_field.max_length:\n+                if model_field.max_length and len(val) > model_field.max_length:\n                     raise InvalidString('%s model field maximum string length is %s, given %s characters.' %\n                                         (model_field.name, model_field.max_length, len(val)))\n         elif isinstance(ogr_field, OFTReal) and isinstance(model_field, models.DecimalField):"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 11,
        "deletions": 1
    }
}