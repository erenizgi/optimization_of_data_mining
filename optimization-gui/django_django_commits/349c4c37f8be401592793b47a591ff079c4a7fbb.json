{
    "author": "claudep",
    "message": "Fixed #19015 -- Add ISO input formats to all formats",
    "sha": "349c4c37f8be401592793b47a591ff079c4a7fbb",
    "files": [
        {
            "sha": "97b99c9245e4f1324f8c8f34cbb888e1721b7b5f",
            "filename": "django/conf/locale/de/formats.py",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/349c4c37f8be401592793b47a591ff079c4a7fbb/django%2Fconf%2Flocale%2Fde%2Fformats.py",
            "raw_url": "https://github.com/django/django/raw/349c4c37f8be401592793b47a591ff079c4a7fbb/django%2Fconf%2Flocale%2Fde%2Fformats.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fconf%2Flocale%2Fde%2Fformats.py?ref=349c4c37f8be401592793b47a591ff079c4a7fbb",
            "patch": "@@ -17,7 +17,6 @@\n # see http://docs.python.org/library/datetime.html#strftime-strptime-behavior\n DATE_INPUT_FORMATS = (\n     '%d.%m.%Y', '%d.%m.%y',     # '25.10.2006', '25.10.06'\n-    '%Y-%m-%d', '%y-%m-%d',     # '2006-10-25', '06-10-25'\n     # '%d. %B %Y', '%d. %b. %Y',  # '25. October 2006', '25. Oct. 2006'\n )\n TIME_INPUT_FORMATS = (\n@@ -28,9 +27,6 @@\n     '%d.%m.%Y %H:%M:%S',    # '25.10.2006 14:30:59'\n     '%d.%m.%Y %H:%M',       # '25.10.2006 14:30'\n     '%d.%m.%Y',             # '25.10.2006'\n-    '%Y-%m-%d %H:%M:%S',    # '2006-10-25 14:30:59'\n-    '%Y-%m-%d %H:%M',       # '2006-10-25 14:30'\n-    '%Y-%m-%d',             # '2006-10-25'\n )\n DECIMAL_SEPARATOR = ','\n THOUSAND_SEPARATOR = '.'"
        },
        {
            "sha": "03b9918edfcfa16f0cb5c6876e058588efdb3cb4",
            "filename": "django/utils/formats.py",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/349c4c37f8be401592793b47a591ff079c4a7fbb/django%2Futils%2Fformats.py",
            "raw_url": "https://github.com/django/django/raw/349c4c37f8be401592793b47a591ff079c4a7fbb/django%2Futils%2Fformats.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fformats.py?ref=349c4c37f8be401592793b47a591ff079c4a7fbb",
            "patch": "@@ -16,6 +16,17 @@\n _format_cache = {}\n _format_modules_cache = {}\n \n+ISO_INPUT_FORMATS = {\n+    'DATE_INPUT_FORMATS': ('%Y-%m-%d',),\n+    'TIME_INPUT_FORMATS': ('%H:%M:%S', '%H:%M'),\n+    'DATETIME_INPUT_FORMATS': (\n+        '%Y-%m-%d %H:%M:%S',\n+        '%Y-%m-%d %H:%M:%S.%f',\n+        '%Y-%m-%d %H:%M',\n+        '%Y-%m-%d'\n+    ),\n+}\n+\n def reset_format_cache():\n     \"\"\"Clear any cached formats.\n \n@@ -82,6 +93,11 @@ def get_format(format_type, lang=None, use_l10n=None):\n             for module in get_format_modules(lang):\n                 try:\n                     val = getattr(module, format_type)\n+                    for iso_input in ISO_INPUT_FORMATS.get(format_type, ()):\n+                        if iso_input not in val:\n+                            if isinstance(val, tuple):\n+                                val = list(val)\n+                            val.append(iso_input)\n                     _format_cache[cache_key] = val\n                     return val\n                 except AttributeError:"
        },
        {
            "sha": "7a305dbc2b7e67d67dd242bfd50c295db54d055d",
            "filename": "tests/regressiontests/forms/tests/input_formats.py",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/349c4c37f8be401592793b47a591ff079c4a7fbb/tests%2Fregressiontests%2Fforms%2Ftests%2Finput_formats.py",
            "raw_url": "https://github.com/django/django/raw/349c4c37f8be401592793b47a591ff079c4a7fbb/tests%2Fregressiontests%2Fforms%2Ftests%2Finput_formats.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Finput_formats.py?ref=349c4c37f8be401592793b47a591ff079c4a7fbb",
            "patch": "@@ -9,7 +9,8 @@\n @override_settings(TIME_INPUT_FORMATS=[\"%I:%M:%S %p\", \"%I:%M %p\"], USE_L10N=True)\n class LocalizedTimeTests(SimpleTestCase):\n     def setUp(self):\n-        activate('de')\n+        # nl/formats.py has customized TIME_INPUT_FORMATS\n+        activate('nl')\n \n     def tearDown(self):\n         deactivate()\n@@ -92,7 +93,7 @@ def test_localized_timeField_with_inputformat(self):\n         result = f.clean('13.30.05')\n         self.assertEqual(result, time(13,30,5))\n \n-        # # Check that the parsed result does a round trip to the same format\n+        # Check that the parsed result does a round trip to the same format\n         text = f.widget._format_value(result)\n         self.assertEqual(text, \"13:30:05\")\n \n@@ -302,6 +303,9 @@ def test_dateField(self):\n         # Parse a date in an unaccepted format; get an error\n         self.assertRaises(forms.ValidationError, f.clean, '21/12/2010')\n \n+        # ISO formats are accepted, even if not specified in formats.py\n+        self.assertEqual(f.clean('2010-12-21'), date(2010,12,21))\n+\n         # Parse a date in a valid format, get a parsed result\n         result = f.clean('21.12.2010')\n         self.assertEqual(result, date(2010,12,21))\n@@ -585,6 +589,9 @@ def test_dateTimeField(self):\n         # Parse a date in an unaccepted format; get an error\n         self.assertRaises(forms.ValidationError, f.clean, '1:30:05 PM 21/12/2010')\n \n+        # ISO formats are accepted, even if not specified in formats.py\n+        self.assertEqual(f.clean('2010-12-21 13:30:05'), datetime(2010,12,21,13,30,5))\n+\n         # Parse a date in a valid format, get a parsed result\n         result = f.clean('21.12.2010 13:30:05')\n         self.assertEqual(result, datetime(2010,12,21,13,30,5))"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 25,
        "deletions": 6
    }
}