{
    "author": "aaugustin",
    "message": "Fixed a test that relied on the database to reject invalid data; MySQL doesn't. Refs #17055.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16996 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "b7f2aba56608fc65843abf50d1c1cc32af533a72",
    "files": [
        {
            "sha": "16c5bfe0d73168d35d5c29d6b76e095fa70ac33e",
            "filename": "tests/modeltests/fixtures/tests.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/b7f2aba56608fc65843abf50d1c1cc32af533a72/tests%2Fmodeltests%2Ffixtures%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/b7f2aba56608fc65843abf50d1c1cc32af533a72/tests%2Fmodeltests%2Ffixtures%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ffixtures%2Ftests.py?ref=b7f2aba56608fc65843abf50d1c1cc32af533a72",
            "patch": "@@ -4,6 +4,7 @@\n \n from django.contrib.sites.models import Site\n from django.core import management\n+from django.db import connection\n from django.test import TestCase, TransactionTestCase, skipUnlessDBFeature\n \n from .models import Article, Book, Spy, Tag, Visa\n@@ -260,6 +261,11 @@ def test_loaddata_error_message(self):\n         outputs an error message which contains the pk of the object\n         that triggered the error.\n         \"\"\"\n+        # MySQL needs a little prodding to reject invalid data.\n+        # This won't affect other tests because the database connection\n+        # is closed at the end of each test.\n+        if connection.vendor == 'mysql':\n+            connection.cursor().execute(\"SET sql_mode = 'TRADITIONAL'\")\n         new_io = StringIO.StringIO()\n         management.call_command('loaddata', 'invalid.json', verbosity=0, stderr=new_io, commit=False)\n         output = new_io.getvalue().strip().split('\\n')"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
    }
}