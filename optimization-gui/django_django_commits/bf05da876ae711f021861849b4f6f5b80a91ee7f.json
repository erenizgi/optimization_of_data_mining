{
    "author": "ramiro",
    "message": "Fixed #8160 -- Made sure `modelformset_factory` takes in account `fields' and `exclude` ModelForm options.\n\nThanks Andrew McMurry for the report and Claude Paroz for creating these tests.\n\n(Actually, this had been fixed in r10619 but the tests added then exercise the\ncode in the context of ModelAdmin. This commit adds more generic tests.)\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16918 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "bf05da876ae711f021861849b4f6f5b80a91ee7f",
    "files": [
        {
            "sha": "0e4f2f5991b5396eeb28d628306ccb72a7f6e9d9",
            "filename": "tests/modeltests/model_formsets/tests.py",
            "status": "modified",
            "additions": 23,
            "deletions": 1,
            "changes": 24,
            "blob_url": "https://github.com/django/django/blob/bf05da876ae711f021861849b4f6f5b80a91ee7f/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/bf05da876ae711f021861849b4f6f5b80a91ee7f/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py?ref=bf05da876ae711f021861849b4f6f5b80a91ee7f",
            "patch": "@@ -6,7 +6,7 @@\n from django import forms\n from django.db import models\n from django.forms.models import (_get_foreign_key, inlineformset_factory,\n-    modelformset_factory, modelformset_factory)\n+    modelformset_factory)\n from django.test import TestCase, skipUnlessDBFeature\n \n from modeltests.model_formsets.models import (\n@@ -353,6 +353,28 @@ def save(self, commit=True):\n         self.assertEqual(poet1.name, 'Vladimir Mayakovsky')\n         self.assertEqual(poet2.name, 'Vladimir Mayakovsky')\n \n+    def test_custom_form(self):\n+        \"\"\" Test that model_formset respects fields and exclude parameters of\n+            custom form\n+        \"\"\"\n+        class PostForm1(forms.ModelForm):\n+            class Meta:\n+                model = Post\n+                fields = ('title', 'posted')\n+\n+        class PostForm2(forms.ModelForm):\n+            class Meta:\n+                model = Post\n+                exclude = ('subtitle',)\n+\n+        PostFormSet = modelformset_factory(Post, form=PostForm1)\n+        formset = PostFormSet()\n+        self.assertFalse(\"subtitle\" in formset.forms[0].fields)\n+\n+        PostFormSet = modelformset_factory(Post, form=PostForm2)\n+        formset = PostFormSet()\n+        self.assertFalse(\"subtitle\" in formset.forms[0].fields)\n+\n     def test_model_inheritance(self):\n         BetterAuthorFormSet = modelformset_factory(BetterAuthor)\n         formset = BetterAuthorFormSet()"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 23,
        "deletions": 1
    }
}