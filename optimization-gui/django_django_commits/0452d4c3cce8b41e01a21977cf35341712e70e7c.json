{
    "author": "ramiro",
    "message": "Fixed #16480 -- Modified test added in r16522 so it doesn't use a query not supported under Oracle (`GROUP BY` a NCLOB field). Thanks Aymeric for the report. Refs #4186\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16546 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "0452d4c3cce8b41e01a21977cf35341712e70e7c",
    "files": [
        {
            "sha": "73cefb130d376d98384c58514ff432896a453d88",
            "filename": "tests/regressiontests/defer_regress/models.py",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/0452d4c3cce8b41e01a21977cf35341712e70e7c/tests%2Fregressiontests%2Fdefer_regress%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/0452d4c3cce8b41e01a21977cf35341712e70e7c/tests%2Fregressiontests%2Fdefer_regress%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fdefer_regress%2Fmodels.py?ref=0452d4c3cce8b41e01a21977cf35341712e70e7c",
            "patch": "@@ -36,3 +36,13 @@ class ResolveThis(models.Model):\n class Proxy(Item):\n     class Meta:\n         proxy = True\n+\n+class SimpleItem(models.Model):\n+    name = models.CharField(max_length=15)\n+    value = models.IntegerField()\n+\n+    def __unicode__(self):\n+        return self.name\n+\n+class Feature(models.Model):\n+    item = models.ForeignKey(SimpleItem)"
        },
        {
            "sha": "14fa13395d382566b4c0822b9411aea31e19497a",
            "filename": "tests/regressiontests/defer_regress/tests.py",
            "status": "modified",
            "additions": 8,
            "deletions": 3,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/0452d4c3cce8b41e01a21977cf35341712e70e7c/tests%2Fregressiontests%2Fdefer_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0452d4c3cce8b41e01a21977cf35341712e70e7c/tests%2Fregressiontests%2Fdefer_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fdefer_regress%2Ftests.py?ref=0452d4c3cce8b41e01a21977cf35341712e70e7c",
            "patch": "@@ -6,7 +6,8 @@\n from django.db.models.loading import cache\n from django.test import TestCase\n \n-from models import ResolveThis, Item, RelatedItem, Child, Leaf, Proxy\n+from models import (ResolveThis, Item, RelatedItem, Child, Leaf, Proxy,\n+        SimpleItem, Feature)\n \n \n class DeferRegressionTest(TestCase):\n@@ -108,11 +109,13 @@ def test():\n         self.assertEqual(\n             klasses, [\n                 Child,\n+                Feature,\n                 Item,\n                 Leaf,\n                 Proxy,\n                 RelatedItem,\n                 ResolveThis,\n+                SimpleItem,\n             ]\n         )\n \n@@ -128,6 +131,7 @@ def test():\n             klasses, [\n                 \"Child\",\n                 \"Child_Deferred_value\",\n+                \"Feature\",\n                 \"Item\",\n                 \"Item_Deferred_name\",\n                 \"Item_Deferred_name_other_value_text\",\n@@ -144,12 +148,13 @@ def test():\n                 \"RelatedItem_Deferred_\",\n                 \"RelatedItem_Deferred_item_id\",\n                 \"ResolveThis\",\n+                \"SimpleItem\",\n             ]\n         )\n \n         # Regression for #16409 - make sure defer() and only() work with annotate()\n-        self.assertIsInstance(list(Item.objects.annotate(Count('relateditem')).defer('name')), list)\n-        self.assertIsInstance(list(Item.objects.annotate(Count('relateditem')).only('name')), list)\n+        self.assertIsInstance(list(SimpleItem.objects.annotate(Count('feature')).defer('name')), list)\n+        self.assertIsInstance(list(SimpleItem.objects.annotate(Count('feature')).only('name')), list)\n \n     def test_only_and_defer_usage_on_proxy_models(self):\n         # Regression for #15790 - only() broken for proxy models"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 18,
        "deletions": 3
    }
}