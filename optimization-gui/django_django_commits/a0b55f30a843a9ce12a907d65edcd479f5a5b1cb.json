{
    "author": "jphalip",
    "message": "Fixed #18086 -- Restored '-pk' as the default order in the admin changelist. This rectifies a slight change in behavior introduced in Django 1.4 and r17635.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17881 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "a0b55f30a843a9ce12a907d65edcd479f5a5b1cb",
    "files": [
        {
            "sha": "9d5c30434d7388c65e8bfec3433b5cac7caebda2",
            "filename": "django/contrib/admin/views/main.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/django%2Fcontrib%2Fadmin%2Fviews%2Fmain.py",
            "raw_url": "https://github.com/django/django/raw/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/django%2Fcontrib%2Fadmin%2Fviews%2Fmain.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fviews%2Fmain.py?ref=a0b55f30a843a9ce12a907d65edcd479f5a5b1cb",
            "patch": "@@ -258,7 +258,7 @@ def get_ordering(self, request, queryset):\n         if not (set(ordering) & set(['pk', '-pk', pk_name, '-' + pk_name])):\n             # The two sets do not intersect, meaning the pk isn't present. So\n             # we add it.\n-            ordering.append('pk')\n+            ordering.append('-pk')\n \n         return ordering\n "
        },
        {
            "sha": "1c615eab19493307c0fc162cc487a7dc111900b1",
            "filename": "tests/regressiontests/admin_changelist/models.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/tests%2Fregressiontests%2Fadmin_changelist%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/tests%2Fregressiontests%2Fadmin_changelist%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_changelist%2Fmodels.py?ref=a0b55f30a843a9ce12a907d65edcd479f5a5b1cb",
            "patch": "@@ -69,7 +69,7 @@ class UnorderedObject(models.Model):\n \n class OrderedObjectManager(models.Manager):\n     def get_query_set(self):\n-        return super(OrderedObjectManager, self).get_query_set().order_by('-number')\n+        return super(OrderedObjectManager, self).get_query_set().order_by('number')\n \n class OrderedObject(models.Model):\n     \"\"\""
        },
        {
            "sha": "f4cdbde4fb594e36684b4e4e307b9d4723af707d",
            "filename": "tests/regressiontests/admin_changelist/tests.py",
            "status": "modified",
            "additions": 19,
            "deletions": 19,
            "changes": 38,
            "blob_url": "https://github.com/django/django/blob/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/tests%2Fregressiontests%2Fadmin_changelist%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/tests%2Fregressiontests%2Fadmin_changelist%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_changelist%2Ftests.py?ref=a0b55f30a843a9ce12a907d65edcd479f5a5b1cb",
            "patch": "@@ -446,35 +446,35 @@ def test_deterministic_order_for_unordered_model(self):\n         class UnorderedObjectAdmin(admin.ModelAdmin):\n             list_per_page = 10\n \n-        def check_results_order(reverse=False):\n+        def check_results_order(ascending=False):\n             admin.site.register(UnorderedObject, UnorderedObjectAdmin)\n             model_admin = UnorderedObjectAdmin(UnorderedObject, admin.site)\n-            counter = 51 if reverse else 0\n+            counter = 0 if ascending else 51\n             for page in range (0, 5):\n                 request = self._mocked_authenticated_request('/unorderedobject/?p=%s' % page, superuser)\n                 response = model_admin.changelist_view(request)\n                 for result in response.context_data['cl'].result_list:\n-                    counter += -1 if reverse else 1\n+                    counter += 1 if ascending else -1\n                     self.assertEqual(result.id, counter)\n             admin.site.unregister(UnorderedObject)\n \n-        # When no order is defined at all, everything is ordered by 'pk'.\n+        # When no order is defined at all, everything is ordered by '-pk'.\n         check_results_order()\n \n         # When an order field is defined but multiple records have the same\n-        # value for that field, make sure everything gets ordered by pk as well.\n+        # value for that field, make sure everything gets ordered by -pk as well.\n         UnorderedObjectAdmin.ordering = ['bool']\n         check_results_order()\n \n         # When order fields are defined, including the pk itself, use them.\n         UnorderedObjectAdmin.ordering = ['bool', '-pk']\n-        check_results_order(reverse=True)\n-        UnorderedObjectAdmin.ordering = ['bool', 'pk']\n         check_results_order()\n+        UnorderedObjectAdmin.ordering = ['bool', 'pk']\n+        check_results_order(ascending=True)\n         UnorderedObjectAdmin.ordering = ['-id', 'bool']\n-        check_results_order(reverse=True)\n-        UnorderedObjectAdmin.ordering = ['id', 'bool']\n         check_results_order()\n+        UnorderedObjectAdmin.ordering = ['id', 'bool']\n+        check_results_order(ascending=True)\n \n     def test_deterministic_order_for_model_ordered_by_its_manager(self):\n         \"\"\"\n@@ -491,32 +491,32 @@ def test_deterministic_order_for_model_ordered_by_its_manager(self):\n         class OrderedObjectAdmin(admin.ModelAdmin):\n             list_per_page = 10\n \n-        def check_results_order(reverse=False):\n+        def check_results_order(ascending=False):\n             admin.site.register(OrderedObject, OrderedObjectAdmin)\n             model_admin = OrderedObjectAdmin(OrderedObject, admin.site)\n-            counter = 51 if reverse else 0\n+            counter = 0 if ascending else 51\n             for page in range (0, 5):\n                 request = self._mocked_authenticated_request('/orderedobject/?p=%s' % page, superuser)\n                 response = model_admin.changelist_view(request)\n                 for result in response.context_data['cl'].result_list:\n-                    counter += -1 if reverse else 1\n+                    counter += 1 if ascending else -1\n                     self.assertEqual(result.id, counter)\n             admin.site.unregister(OrderedObject)\n \n-        # When no order is defined at all, use the model's default ordering (i.e. '-number')\n-        check_results_order(reverse=True)\n+        # When no order is defined at all, use the model's default ordering (i.e. 'number')\n+        check_results_order(ascending=True)\n \n         # When an order field is defined but multiple records have the same\n-        # value for that field, make sure everything gets ordered by pk as well.\n+        # value for that field, make sure everything gets ordered by -pk as well.\n         OrderedObjectAdmin.ordering = ['bool']\n         check_results_order()\n \n         # When order fields are defined, including the pk itself, use them.\n         OrderedObjectAdmin.ordering = ['bool', '-pk']\n-        check_results_order(reverse=True)\n-        OrderedObjectAdmin.ordering = ['bool', 'pk']\n         check_results_order()\n+        OrderedObjectAdmin.ordering = ['bool', 'pk']\n+        check_results_order(ascending=True)\n         OrderedObjectAdmin.ordering = ['-id', 'bool']\n-        check_results_order(reverse=True)\n+        check_results_order()\n         OrderedObjectAdmin.ordering = ['id', 'bool']\n-        check_results_order()\n\\ No newline at end of file\n+        check_results_order(ascending=True)\n\\ No newline at end of file"
        },
        {
            "sha": "e2a12c966339ebc7dce75c9456110951cade0d05",
            "filename": "tests/regressiontests/admin_filters/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/tests%2Fregressiontests%2Fadmin_filters%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/tests%2Fregressiontests%2Fadmin_filters%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_filters%2Ftests.py?ref=a0b55f30a843a9ce12a907d65edcd479f5a5b1cb",
            "patch": "@@ -654,7 +654,7 @@ def test_fk_with_to_field(self):\n \n         # Make sure the correct queryset is returned\n         queryset = changelist.get_query_set(request)\n-        self.assertEqual(list(queryset), [john, jack])\n+        self.assertEqual(list(queryset), [jack, john])\n \n         filterspec = changelist.get_filters(request)[0][-1]\n         self.assertEqual(force_unicode(filterspec.title), u'department')"
        },
        {
            "sha": "2a389fd5ec79e96c898d7667b26fd454965b7918",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a0b55f30a843a9ce12a907d65edcd479f5a5b1cb/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=a0b55f30a843a9ce12a907d65edcd479f5a5b1cb",
            "patch": "@@ -1894,13 +1894,13 @@ def test_list_editable_pagination(self):\n         UnorderedObject.objects.create(id=2, name='Unordered object #2')\n         UnorderedObject.objects.create(id=3, name='Unordered object #3')\n         response = self.client.get('/test_admin/admin/admin_views/unorderedobject/')\n-        self.assertContains(response, 'Unordered object #1')\n+        self.assertContains(response, 'Unordered object #3')\n         self.assertContains(response, 'Unordered object #2')\n-        self.assertNotContains(response, 'Unordered object #3')\n-        response = self.client.get('/test_admin/admin/admin_views/unorderedobject/?p=1')\n         self.assertNotContains(response, 'Unordered object #1')\n+        response = self.client.get('/test_admin/admin/admin_views/unorderedobject/?p=1')\n+        self.assertNotContains(response, 'Unordered object #3')\n         self.assertNotContains(response, 'Unordered object #2')\n-        self.assertContains(response, 'Unordered object #3')\n+        self.assertContains(response, 'Unordered object #1')\n \n     def test_list_editable_action_submit(self):\n         # List editable changes should not be executed if the action \"Go\" button is"
        }
    ],
    "stats": {
        "total": 52,
        "additions": 26,
        "deletions": 26
    }
}