{
    "author": "timgraham",
    "message": "Fixed #17312 - Warned about database side effects in tests.\n\nThanks jcspray for the suggestion.",
    "sha": "7df03268a467a9aec9c4c574c85317a738ca33ae",
    "files": [
        {
            "sha": "b4645c236ba0f7617c8c45ab097bde5224e13e11",
            "filename": "docs/topics/testing.txt",
            "status": "modified",
            "additions": 18,
            "deletions": 3,
            "changes": 21,
            "blob_url": "https://github.com/django/django/blob/7df03268a467a9aec9c4c574c85317a738ca33ae/docs%2Ftopics%2Ftesting.txt",
            "raw_url": "https://github.com/django/django/raw/7df03268a467a9aec9c4c574c85317a738ca33ae/docs%2Ftopics%2Ftesting.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Ftesting.txt?ref=7df03268a467a9aec9c4c574c85317a738ca33ae",
            "patch": "@@ -115,8 +115,8 @@ Here is an example :class:`unittest.TestCase` subclass::\n \n     class AnimalTestCase(unittest.TestCase):\n         def setUp(self):\n-            self.lion = Animal.objects.create(name=\"lion\", sound=\"roar\")\n-            self.cat = Animal.objects.create(name=\"cat\", sound=\"meow\")\n+            self.lion = Animal(name=\"lion\", sound=\"roar\")\n+            self.cat = Animal(name=\"cat\", sound=\"meow\")\n \n         def test_animals_can_speak(self):\n             \"\"\"Animals that can speak are correctly identified\"\"\"\n@@ -139,6 +139,18 @@ For more details about :mod:`unittest`, see the Python documentation.\n \n .. _suggested organization: http://docs.python.org/library/unittest.html#organizing-tests\n \n+.. warning::\n+\n+    If your tests rely on database access such as creating or querying models,\n+    be sure to create your test classes as subclasses of\n+    :class:`django.test.TestCase` rather than :class:`unittest.TestCase`.\n+\n+    In the example above, we instantiate some models but do not save them to\n+    the database. Using :class:`unittest.TestCase` avoids the cost of running\n+    each test in a transaction and flushing the database, but for most\n+    applications the scope of tests you will be able to write this way will\n+    be fairly limited, so it's easiest to use :class:`django.test.TestCase`.\n+\n Writing doctests\n ----------------\n \n@@ -343,7 +355,7 @@ This convenience method sets up the test database, and puts other\n Django features into modes that allow for repeatable testing.\n \n The call to :meth:`~django.test.utils.setup_test_environment` is made\n-automatically as part of the setup of `./manage.py test`. You only\n+automatically as part of the setup of ``./manage.py test``. You only\n need to manually invoke this method if you're not using running your\n tests via Django's test runner.\n \n@@ -1191,6 +1203,8 @@ Normal Python unit test classes extend a base class of\n    :width: 508\n    :height: 391\n \n+   Hierarchy of Django unit testing classes\n+\n Regardless of the version of Python you're using, if you've installed\n :mod:`unittest2`, :mod:`django.utils.unittest` will point to that library.\n \n@@ -1385,6 +1399,7 @@ attribute::\n \n         def test_my_stuff(self):\n             # Here self.client is an instance of MyTestClient...\n+            call_some_test_code()\n \n .. _topics-testing-fixtures:\n "
        }
    ],
    "stats": {
        "total": 21,
        "additions": 18,
        "deletions": 3
    }
}