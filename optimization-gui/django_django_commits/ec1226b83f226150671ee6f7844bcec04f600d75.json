{
    "author": "malcolmt",
    "message": "Added another test to confirm fix in r16663.\n\nThis is the test case from #6045, which was fixed by the above commit.\nRefs #6045, #16299\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16679 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ec1226b83f226150671ee6f7844bcec04f600d75",
    "files": [
        {
            "sha": "6072bd4c5ec4c5a70155c546c7fd10337365614e",
            "filename": "tests/modeltests/m2m_and_m2o/models.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/ec1226b83f226150671ee6f7844bcec04f600d75/tests%2Fmodeltests%2Fm2m_and_m2o%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/ec1226b83f226150671ee6f7844bcec04f600d75/tests%2Fmodeltests%2Fm2m_and_m2o%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fm2m_and_m2o%2Fmodels.py?ref=ec1226b83f226150671ee6f7844bcec04f600d75",
            "patch": "@@ -19,3 +19,7 @@ def __unicode__(self):\n \n     class Meta:\n         ordering = ('num',)\n+\n+class UnicodeReferenceModel(models.Model): \n+    others = models.ManyToManyField(u\"UnicodeReferenceModel\") \n+"
        },
        {
            "sha": "cb3dcc86bbe0703399059f0d1984092305b5b2c2",
            "filename": "tests/modeltests/m2m_and_m2o/tests.py",
            "status": "modified",
            "additions": 14,
            "deletions": 1,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/ec1226b83f226150671ee6f7844bcec04f600d75/tests%2Fmodeltests%2Fm2m_and_m2o%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/ec1226b83f226150671ee6f7844bcec04f600d75/tests%2Fmodeltests%2Fm2m_and_m2o%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fm2m_and_m2o%2Ftests.py?ref=ec1226b83f226150671ee6f7844bcec04f600d75",
            "patch": "@@ -1,7 +1,7 @@\n from django.db.models import Q\n from django.test import TestCase\n \n-from models import Issue, User\n+from models import Issue, User, UnicodeReferenceModel\n \n \n class RelatedObjectTests(TestCase):\n@@ -73,3 +73,16 @@ def test_m2m_and_m2o(self):\n             ],\n             lambda i: i.num\n         )\n+\n+class RelatedObjectTests(TestCase): \n+    def test_m2m_with_unicode_reference(self): \n+        \"\"\"\n+        Regression test for #6045: references to other models can be unicode\n+        strings, providing they are directly convertible to ASCII.\n+        \"\"\"\n+        m1=UnicodeReferenceModel.objects.create() \n+        m2=UnicodeReferenceModel.objects.create() \n+        m2.others.add(m1) # used to cause an error (see ticket #6045) \n+        m2.save() \n+        list(m2.others.all()) # Force retrieval.\n+"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 18,
        "deletions": 1
    }
}