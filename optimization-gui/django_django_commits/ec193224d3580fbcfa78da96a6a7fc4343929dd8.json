{
    "author": "jezdez",
    "message": "Fixed #12534 -- Loosened the the security check for \"next\" redirects after logins slightly to allow paths that contain spaces. Thanks for the patch, jnns and aaugustin.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15702 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ec193224d3580fbcfa78da96a6a7fc4343929dd8",
    "files": [
        {
            "sha": "530956ae45e5f9e1246ace6ec293e05469932168",
            "filename": "django/contrib/auth/tests/views.py",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/ec193224d3580fbcfa78da96a6a7fc4343929dd8/django%2Fcontrib%2Fauth%2Ftests%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/ec193224d3580fbcfa78da96a6a7fc4343929dd8/django%2Fcontrib%2Fauth%2Ftests%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Fviews.py?ref=ec193224d3580fbcfa78da96a6a7fc4343929dd8",
            "patch": "@@ -236,7 +236,9 @@ def test_security_check(self, password='password'):\n                          '/view?param=ftp://exampel.com',\n                          'view/?param=//example.com',\n                          'https:///',\n-                         '//testserver/'):\n+                         '//testserver/',\n+                         '/url%20with%20spaces/', # see ticket #12534\n+                         ):\n             safe_url = '%(url)s?%(next)s=%(good_url)s' % {\n                 'url': login_url,\n                 'next': REDIRECT_FIELD_NAME,\n@@ -251,6 +253,7 @@ def test_security_check(self, password='password'):\n             self.assertTrue(good_url in response['Location'],\n                             \"%s should be allowed\" % good_url)\n \n+\n class LoginURLSettings(AuthViewsTestCase):\n     urls = 'django.contrib.auth.tests.urls'\n     "
        },
        {
            "sha": "c34a4a377e08242f1764db66470921b358ed7481",
            "filename": "django/contrib/auth/views.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/ec193224d3580fbcfa78da96a6a7fc4343929dd8/django%2Fcontrib%2Fauth%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/ec193224d3580fbcfa78da96a6a7fc4343929dd8/django%2Fcontrib%2Fauth%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fviews.py?ref=ec193224d3580fbcfa78da96a6a7fc4343929dd8",
            "patch": "@@ -34,11 +34,11 @@ def login(request, template_name='registration/login.html',\n         if form.is_valid():\n             netloc = urlparse.urlparse(redirect_to)[1]\n \n-            # Light security check -- make sure redirect_to isn't garbage.\n-            if not redirect_to or ' ' in redirect_to:\n+            # Use default setting if redirect_to is empty\n+            if not redirect_to:\n                 redirect_to = settings.LOGIN_REDIRECT_URL\n \n-            # Heavier security check -- don't allow redirection to a different\n+            # Security check -- don't allow redirection to a different\n             # host.\n             elif netloc and netloc != request.get_host():\n                 redirect_to = settings.LOGIN_REDIRECT_URL"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 7,
        "deletions": 4
    }
}