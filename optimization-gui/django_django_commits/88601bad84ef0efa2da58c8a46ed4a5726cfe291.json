{
    "author": "claudep",
    "message": "Discovered some geodjango tests with standard mechanism\n\nNo need to special case tests discovery for regular first-level\ngis tests.",
    "sha": "88601bad84ef0efa2da58c8a46ed4a5726cfe291",
    "files": [
        {
            "sha": "765c03018bdcbf3957d8f894e30cecc50ef50ac5",
            "filename": "django/contrib/gis/tests/__init__.py",
            "status": "modified",
            "additions": 4,
            "deletions": 8,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/88601bad84ef0efa2da58c8a46ed4a5726cfe291/django%2Fcontrib%2Fgis%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/88601bad84ef0efa2da58c8a46ed4a5726cfe291/django%2Fcontrib%2Fgis%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2F__init__.py?ref=88601bad84ef0efa2da58c8a46ed4a5726cfe291",
            "patch": "@@ -2,6 +2,10 @@\n from django.test.simple import build_suite, DjangoTestSuiteRunner\n from django.utils import unittest\n \n+from .test_geoforms import GeometryFieldTest\n+from .test_measure import DistanceTest, AreaTest\n+from .test_spatialrefsys import SpatialRefSysTest\n+\n \n def geo_apps(namespace=True, runtests=False):\n     \"\"\"\n@@ -54,20 +58,12 @@ def geodjango_suite(apps=True):\n     from django.contrib.gis.geos import tests as geos_tests\n     suite.addTest(geos_tests.suite())\n \n-    # Adding the measurment tests.\n-    from django.contrib.gis.tests import test_measure\n-    suite.addTest(test_measure.suite())\n-\n     # Adding GDAL tests, and any test suite that depends on GDAL, to the\n     # suite if GDAL is available.\n     from django.contrib.gis.gdal import HAS_GDAL\n     if HAS_GDAL:\n         from django.contrib.gis.gdal import tests as gdal_tests\n         suite.addTest(gdal_tests.suite())\n-\n-        from django.contrib.gis.tests import test_spatialrefsys, test_geoforms\n-        suite.addTest(test_spatialrefsys.suite())\n-        suite.addTest(test_geoforms.suite())\n     else:\n         sys.stderr.write('GDAL not available - no tests requiring GDAL will be run.\\n')\n "
        },
        {
            "sha": "1af3dec5e92a4efbdc34b715d5b82949c2e41e46",
            "filename": "django/contrib/gis/tests/test_geoforms.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/88601bad84ef0efa2da58c8a46ed4a5726cfe291/django%2Fcontrib%2Fgis%2Ftests%2Ftest_geoforms.py",
            "raw_url": "https://github.com/django/django/raw/88601bad84ef0efa2da58c8a46ed4a5726cfe291/django%2Fcontrib%2Fgis%2Ftests%2Ftest_geoforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Ftest_geoforms.py?ref=88601bad84ef0efa2da58c8a46ed4a5726cfe291",
            "patch": "@@ -1,9 +1,11 @@\n from django.forms import ValidationError\n from django.contrib.gis import forms\n+from django.contrib.gis.gdal import HAS_GDAL\n from django.contrib.gis.geos import GEOSGeometry\n from django.utils import unittest\n \n \n+@unittest.skipUnless(HAS_GDAL, \"GeometryFieldTest needs gdal support\")\n class GeometryFieldTest(unittest.TestCase):\n \n     def test00_init(self):"
        },
        {
            "sha": "b91d03c2e5ea41888222943533550ee1b2ca1b32",
            "filename": "django/contrib/gis/tests/test_spatialrefsys.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/88601bad84ef0efa2da58c8a46ed4a5726cfe291/django%2Fcontrib%2Fgis%2Ftests%2Ftest_spatialrefsys.py",
            "raw_url": "https://github.com/django/django/raw/88601bad84ef0efa2da58c8a46ed4a5726cfe291/django%2Fcontrib%2Fgis%2Ftests%2Ftest_spatialrefsys.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Ftest_spatialrefsys.py?ref=88601bad84ef0efa2da58c8a46ed4a5726cfe291",
            "patch": "@@ -1,5 +1,5 @@\n from django.db import connection\n-from django.contrib.gis.gdal import GDAL_VERSION\n+from django.contrib.gis.gdal import HAS_GDAL\n from django.contrib.gis.tests.utils import no_mysql, oracle, postgis, spatialite\n from django.utils import unittest\n \n@@ -35,6 +35,7 @@\n elif spatialite:\n     from django.contrib.gis.db.backends.spatialite.models import SpatialRefSys\n \n+@unittest.skipUnless(HAS_GDAL, \"SpatialRefSysTest needs gdal support\")\n class SpatialRefSysTest(unittest.TestCase):\n \n     @no_mysql\n@@ -65,6 +66,7 @@ def test01_retrieve(self):\n     @no_mysql\n     def test02_osr(self):\n         \"Testing getting OSR objects from SpatialRefSys model objects.\"\n+        from django.contrib.gis.gdal import GDAL_VERSION\n         for sd in test_srs:\n             sr = SpatialRefSys.objects.get(srid=sd['srid'])\n             self.assertEqual(True, sr.spheroid.startswith(sd['spheroid']))"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 9,
        "deletions": 9
    }
}