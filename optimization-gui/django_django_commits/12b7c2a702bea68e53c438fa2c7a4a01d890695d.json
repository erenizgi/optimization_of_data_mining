{
    "author": "jezdez",
    "message": "Fixed #15707 -- Made the GIS feed compatible to the class based feeds and introduced a little helper view that works like the previous feed view in the syndication app which was removed in r15976.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16540 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "12b7c2a702bea68e53c438fa2c7a4a01d890695d",
    "files": [
        {
            "sha": "ccb7dc2e91eff67b5f4cbabade482c4ca7a76571",
            "filename": "django/contrib/gis/sitemaps/georss.py",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/12b7c2a702bea68e53c438fa2c7a4a01d890695d/django%2Fcontrib%2Fgis%2Fsitemaps%2Fgeorss.py",
            "raw_url": "https://github.com/django/django/raw/12b7c2a702bea68e53c438fa2c7a4a01d890695d/django%2Fcontrib%2Fgis%2Fsitemaps%2Fgeorss.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fsitemaps%2Fgeorss.py?ref=12b7c2a702bea68e53c438fa2c7a4a01d890695d",
            "patch": "@@ -8,13 +8,13 @@ class GeoRSSSitemap(Sitemap):\n     def __init__(self, feed_dict, slug_dict=None):\n         \"\"\"\n         This sitemap object initializes on a feed dictionary (as would be passed\n-        to `django.contrib.syndication.views.feed`) and a slug dictionary.  \n+        to `django.contrib.gis.views.feed`) and a slug dictionary.\n         If the slug dictionary is not defined, then it's assumed the keys provide\n         the URL parameter to the feed.  However, if you have a complex feed (e.g.,\n         you override `get_object`, then you'll need to provide a slug dictionary.\n-        The slug dictionary should have the same keys as the feed dictionary, but \n-        each value in the slug dictionary should be a sequence of slugs that may \n-        be used for valid feeds.  For example, let's say we have a feed that \n+        The slug dictionary should have the same keys as the feed dictionary, but\n+        each value in the slug dictionary should be a sequence of slugs that may\n+        be used for valid feeds.  For example, let's say we have a feed that\n         returns objects for a specific ZIP code in our feed dictionary:\n \n             feed_dict = {'zipcode' : ZipFeed}\n@@ -35,7 +35,7 @@ def __init__(self, feed_dict, slug_dict=None):\n                     self.locations.append('%s/%s' % (section, slug))\n             else:\n                 self.locations.append(section)\n- \n+\n     def get_urls(self, page=1, site=None):\n         \"\"\"\n         This method is overrridden so the appropriate `geo_format` attribute\n@@ -49,5 +49,5 @@ def items(self):\n         return self.locations\n \n     def location(self, obj):\n-        return urlresolvers.reverse('django.contrib.syndication.views.feed', args=(obj,))\n+        return urlresolvers.reverse('django.contrib.gis.views.feed', args=(obj,))\n "
        },
        {
            "sha": "3d04242fa8d804176938730b371e4ba2dd6ec124",
            "filename": "django/contrib/gis/tests/__init__.py",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/12b7c2a702bea68e53c438fa2c7a4a01d890695d/django%2Fcontrib%2Fgis%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/12b7c2a702bea68e53c438fa2c7a4a01d890695d/django%2Fcontrib%2Fgis%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2F__init__.py?ref=12b7c2a702bea68e53c438fa2c7a4a01d890695d",
            "patch": "@@ -100,15 +100,16 @@ def setup_test_environment(self, **kwargs):\n \n         # Constructing the new INSTALLED_APPS, and including applications\n         # within the GeoDjango test namespace.\n-        new_installed =  ['django.contrib.sites',\n-                          'django.contrib.sitemaps',\n-                          'django.contrib.gis',\n-                          ]\n+        new_installed =  [\n+            'django.contrib.sites',\n+            'django.contrib.sitemaps',\n+            'django.contrib.gis',\n+        ]\n \n         # Calling out to `geo_apps` to get GeoDjango applications supported\n         # for testing.\n         new_installed.extend(geo_apps())\n-        settings.INSTALLED_APPS = new_installed\n+        settings.INSTALLED_APPS = list(self.old_installed) + new_installed\n \n         # SITE_ID needs to be set\n         settings.SITE_ID = 1"
        },
        {
            "sha": "b3604c7aa02d12ff9ef7e8bf2dfa67063cf7ba2a",
            "filename": "django/contrib/gis/tests/geoapp/urls.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/12b7c2a702bea68e53c438fa2c7a4a01d890695d/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/12b7c2a702bea68e53c438fa2c7a4a01d890695d/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Furls.py?ref=12b7c2a702bea68e53c438fa2c7a4a01d890695d",
            "patch": "@@ -2,13 +2,13 @@\n from feeds import feed_dict\n \n urlpatterns = patterns('',\n-    (r'^feeds/(?P<url>.*)/$', 'django.contrib.syndication.views.feed', {'feed_dict': feed_dict}),\n+    (r'^feeds/(?P<url>.*)/$', 'django.contrib.gis.views.feed', {'feed_dict': feed_dict}),\n )\n \n from sitemaps import sitemaps\n urlpatterns += patterns('django.contrib.gis.sitemaps.views',\n     (r'^sitemap.xml$', 'index', {'sitemaps' : sitemaps}),\n     (r'^sitemaps/(?P<section>\\w+)\\.xml$', 'sitemap', {'sitemaps' : sitemaps}),\n     (r'^sitemaps/kml/(?P<label>\\w+)/(?P<model>\\w+)/(?P<field_name>\\w+)\\.kml$', 'kml'),\n-    (r'^sitemaps/kml/(?P<label>\\w+)/(?P<model>\\w+)/(?P<field_name>\\w+)\\.kmz$', 'kmz'),                \n+    (r'^sitemaps/kml/(?P<label>\\w+)/(?P<model>\\w+)/(?P<field_name>\\w+)\\.kmz$', 'kmz'),\n )"
        },
        {
            "sha": "0e1721093b9e48f0baf813958917ccf9ddbad7ac",
            "filename": "django/contrib/gis/views.py",
            "status": "added",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/django/django/blob/12b7c2a702bea68e53c438fa2c7a4a01d890695d/django%2Fcontrib%2Fgis%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/12b7c2a702bea68e53c438fa2c7a4a01d890695d/django%2Fcontrib%2Fgis%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fviews.py?ref=12b7c2a702bea68e53c438fa2c7a4a01d890695d",
            "patch": "@@ -0,0 +1,22 @@\n+from django.http import Http404\n+\n+def feed(request, url, feed_dict=None):\n+    \"\"\"Provided for backwards compatibility.\"\"\"\n+    if not feed_dict:\n+        raise Http404(\"No feeds are registered.\")\n+\n+    try:\n+        slug, param = url.split('/', 1)\n+    except ValueError:\n+        slug, param = url, ''\n+\n+    try:\n+        f = feed_dict[slug]\n+    except KeyError:\n+        raise Http404(\"Slug %r isn't registered.\" % slug)\n+\n+    instance = f()\n+    instance.feed_url = getattr(f, 'feed_url', None) or request.path\n+    instance.title_template = f.title_template or ('feeds/%s_title.html' % slug)\n+    instance.description_template = f.description_template or ('feeds/%s_description.html' % slug)\n+    return instance(request)"
        }
    ],
    "stats": {
        "total": 49,
        "additions": 36,
        "deletions": 13
    }
}