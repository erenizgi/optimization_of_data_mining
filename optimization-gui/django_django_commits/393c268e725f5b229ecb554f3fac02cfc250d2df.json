{
    "author": "mattrobenolt",
    "message": "Fixed #19715 -- Simplified findstatic output when verbosity set to 0",
    "sha": "393c268e725f5b229ecb554f3fac02cfc250d2df",
    "files": [
        {
            "sha": "8eb500d3e18b1816439f0b3e1c0d9bfa743fc0cd",
            "filename": "AUTHORS",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/393c268e725f5b229ecb554f3fac02cfc250d2df/AUTHORS",
            "raw_url": "https://github.com/django/django/raw/393c268e725f5b229ecb554f3fac02cfc250d2df/AUTHORS",
            "contents_url": "https://api.github.com/repos/django/django/contents/AUTHORS?ref=393c268e725f5b229ecb554f3fac02cfc250d2df",
            "patch": "@@ -464,6 +464,7 @@ answer newbie questions, and generally made Django that much better:\n     Mike Richardson\n     Matt Riggott\n     Alex Robbins <alexander.j.robbins@gmail.com>\n+    Matt Robenolt <m@robenolt.com>\n     Henrique Romano <onaiort@gmail.com>\n     Armin Ronacher\n     Daniel Roseman <http://roseman.org.uk/>"
        },
        {
            "sha": "eaf63f7179d19527cc7c07dbd6c058693b578fce",
            "filename": "django/contrib/staticfiles/management/commands/findstatic.py",
            "status": "modified",
            "additions": 8,
            "deletions": 5,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/393c268e725f5b229ecb554f3fac02cfc250d2df/django%2Fcontrib%2Fstaticfiles%2Fmanagement%2Fcommands%2Ffindstatic.py",
            "raw_url": "https://github.com/django/django/raw/393c268e725f5b229ecb554f3fac02cfc250d2df/django%2Fcontrib%2Fstaticfiles%2Fmanagement%2Fcommands%2Ffindstatic.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fstaticfiles%2Fmanagement%2Fcommands%2Ffindstatic.py?ref=393c268e725f5b229ecb554f3fac02cfc250d2df",
            "patch": "@@ -3,7 +3,7 @@\n import os\n from optparse import make_option\n from django.core.management.base import LabelCommand\n-from django.utils.encoding import smart_text\n+from django.utils.encoding import force_text\n \n from django.contrib.staticfiles import finders\n \n@@ -19,13 +19,16 @@ class Command(LabelCommand):\n     def handle_label(self, path, **options):\n         verbosity = int(options.get('verbosity', 1))\n         result = finders.find(path, all=options['all'])\n-        path = smart_text(path)\n+        path = force_text(path)\n         if result:\n             if not isinstance(result, (list, tuple)):\n                 result = [result]\n-            output = '\\n  '.join(\n-                (smart_text(os.path.realpath(path)) for path in result))\n-            self.stdout.write(\"Found '%s' here:\\n  %s\" % (path, output))\n+            result = (force_text(os.path.realpath(path)) for path in result)\n+            if verbosity >= 1:\n+                output = '\\n  '.join(result)\n+                return \"Found '%s' here:\\n  %s\" % (path, output)\n+            else:\n+                return '\\n'.join(result)\n         else:\n             if verbosity >= 1:\n                 self.stderr.write(\"No matching file found for '%s'.\" % path)"
        },
        {
            "sha": "fa740f4e2c13bc73eaa180726503e27ad0a59ed9",
            "filename": "docs/ref/contrib/staticfiles.txt",
            "status": "modified",
            "additions": 14,
            "deletions": 4,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/393c268e725f5b229ecb554f3fac02cfc250d2df/docs%2Fref%2Fcontrib%2Fstaticfiles.txt",
            "raw_url": "https://github.com/django/django/raw/393c268e725f5b229ecb554f3fac02cfc250d2df/docs%2Fref%2Fcontrib%2Fstaticfiles.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fstaticfiles.txt?ref=393c268e725f5b229ecb554f3fac02cfc250d2df",
            "patch": "@@ -112,19 +112,29 @@ Searches for one or more relative paths with the enabled finders.\n For example::\n \n    $ python manage.py findstatic css/base.css admin/js/core.js\n-   /home/special.polls.com/core/static/css/base.css\n-   /home/polls.com/core/static/css/base.css\n-   /home/polls.com/src/django/contrib/admin/media/js/core.js\n+   Found 'css/base.css' here:\n+     /home/special.polls.com/core/static/css/base.css\n+     /home/polls.com/core/static/css/base.css\n+   Found 'admin/js/core.js' here:\n+     /home/polls.com/src/django/contrib/admin/media/js/core.js\n \n By default, all matching locations are found. To only return the first match\n for each relative path, use the ``--first`` option::\n \n    $ python manage.py findstatic css/base.css --first\n-   /home/special.polls.com/core/static/css/base.css\n+   Found 'css/base.css' here:\n+     /home/special.polls.com/core/static/css/base.css\n \n This is a debugging aid; it'll show you exactly which static file will be\n collected for a given path.\n \n+By setting the :djadminopt:`--verbosity` flag to 0, you can suppress the extra\n+output and just get the path names::\n+\n+   $ python manage.py findstatic css/base.css --verbosity 0\n+   /home/special.polls.com/core/static/css/base.css\n+   /home/polls.com/core/static/css/base.css\n+\n .. _staticfiles-runserver:\n \n runserver"
        },
        {
            "sha": "35d5683a0cdbe6379de882e6a563fec53c2b92d1",
            "filename": "tests/regressiontests/staticfiles_tests/tests.py",
            "status": "modified",
            "additions": 15,
            "deletions": 3,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/393c268e725f5b229ecb554f3fac02cfc250d2df/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/393c268e725f5b229ecb554f3fac02cfc250d2df/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py?ref=393c268e725f5b229ecb554f3fac02cfc250d2df",
            "patch": "@@ -195,21 +195,33 @@ def _get_file(self, filepath):\n         call_command('findstatic', filepath, all=False, verbosity=0, stdout=out)\n         out.seek(0)\n         lines = [l.strip() for l in out.readlines()]\n-        with codecs.open(force_text(lines[1].strip()), \"r\", \"utf-8\") as f:\n+        with codecs.open(force_text(lines[0].strip()), \"r\", \"utf-8\") as f:\n             return f.read()\n \n     def test_all_files(self):\n         \"\"\"\n-        Test that findstatic returns all candidate files if run without --first.\n+        Test that findstatic returns all candidate files if run without --first and -v1.\n         \"\"\"\n         out = six.StringIO()\n-        call_command('findstatic', 'test/file.txt', verbosity=0, stdout=out)\n+        call_command('findstatic', 'test/file.txt', verbosity=1, stdout=out)\n         out.seek(0)\n         lines = [l.strip() for l in out.readlines()]\n         self.assertEqual(len(lines), 3)  # three because there is also the \"Found <file> here\" line\n         self.assertIn('project', force_text(lines[1]))\n         self.assertIn('apps', force_text(lines[2]))\n \n+    def test_all_files_less_verbose(self):\n+        \"\"\"\n+        Test that findstatic returns all candidate files if run without --first and -v0.\n+        \"\"\"\n+        out = six.StringIO()\n+        call_command('findstatic', 'test/file.txt', verbosity=0, stdout=out)\n+        out.seek(0)\n+        lines = [l.strip() for l in out.readlines()]\n+        self.assertEqual(len(lines), 2)\n+        self.assertIn('project', force_text(lines[0]))\n+        self.assertIn('apps', force_text(lines[1]))\n+\n \n class TestCollection(CollectionTestCase, TestDefaults):\n     \"\"\""
        }
    ],
    "stats": {
        "total": 50,
        "additions": 38,
        "deletions": 12
    }
}