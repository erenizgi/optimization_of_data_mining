{
    "author": "aaugustin",
    "message": "Fixed #19510 -- Race condition in template loading.\n\nThanks Kronuz and regebro.",
    "sha": "68905695b897e62b0c18d9edd87171a0eae4e67e",
    "files": [
        {
            "sha": "c61045de06f6443048328f5c2dc6619232efcf29",
            "filename": "django/template/loaders/cached.py",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/68905695b897e62b0c18d9edd87171a0eae4e67e/django%2Ftemplate%2Floaders%2Fcached.py",
            "raw_url": "https://github.com/django/django/raw/68905695b897e62b0c18d9edd87171a0eae4e67e/django%2Ftemplate%2Floaders%2Fcached.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Floaders%2Fcached.py?ref=68905695b897e62b0c18d9edd87171a0eae4e67e",
            "patch": "@@ -43,7 +43,9 @@ def load_template(self, template_name, template_dirs=None):\n             # If template directories were specified, use a hash to differentiate\n             key = '-'.join([template_name, hashlib.sha1(force_bytes('|'.join(template_dirs))).hexdigest()])\n \n-        if key not in self.template_cache:\n+        try:\n+            template = self.template_cache[key]\n+        except KeyError:\n             template, origin = self.find_template(template_name, template_dirs)\n             if not hasattr(template, 'render'):\n                 try:\n@@ -55,7 +57,7 @@ def load_template(self, template_name, template_dirs=None):\n                     # of the actual template that does not exist.\n                     return template, origin\n             self.template_cache[key] = template\n-        return self.template_cache[key], None\n+        return template, None\n \n     def reset(self):\n         \"Empty the template cache.\""
        }
    ],
    "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
    }
}