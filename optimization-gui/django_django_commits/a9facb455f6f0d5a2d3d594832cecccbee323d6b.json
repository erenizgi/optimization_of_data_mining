{
    "author": "claudep",
    "message": "[py3] Fix some more encoding issues in tests",
    "sha": "a9facb455f6f0d5a2d3d594832cecccbee323d6b",
    "files": [
        {
            "sha": "3c7c2115ed0fe783bc46f0db33887f9db52e7837",
            "filename": "tests/regressiontests/cache/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/a9facb455f6f0d5a2d3d594832cecccbee323d6b/tests%2Fregressiontests%2Fcache%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a9facb455f6f0d5a2d3d594832cecccbee323d6b/tests%2Fregressiontests%2Fcache%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fcache%2Ftests.py?ref=a9facb455f6f0d5a2d3d594832cecccbee323d6b",
            "patch": "@@ -774,13 +774,13 @@ def test_cache_write_unpickable_object(self):\n \n         get_cache_data = fetch_middleware.process_request(request)\n         self.assertNotEqual(get_cache_data, None)\n-        self.assertEqual(get_cache_data.content, content)\n+        self.assertEqual(get_cache_data.content, content.encode('utf-8'))\n         self.assertEqual(get_cache_data.cookies, response.cookies)\n \n         update_middleware.process_response(request, get_cache_data)\n         get_cache_data = fetch_middleware.process_request(request)\n         self.assertNotEqual(get_cache_data, None)\n-        self.assertEqual(get_cache_data.content, content)\n+        self.assertEqual(get_cache_data.content, content.encode('utf-8'))\n         self.assertEqual(get_cache_data.cookies, response.cookies)\n \n def custom_key_func(key, key_prefix, version):"
        },
        {
            "sha": "681de276f73fb74fe9bd8d72e13207dc7c865e8d",
            "filename": "tests/regressiontests/middleware/tests.py",
            "status": "modified",
            "additions": 6,
            "deletions": 5,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/a9facb455f6f0d5a2d3d594832cecccbee323d6b/tests%2Fregressiontests%2Fmiddleware%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a9facb455f6f0d5a2d3d594832cecccbee323d6b/tests%2Fregressiontests%2Fmiddleware%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmiddleware%2Ftests.py?ref=a9facb455f6f0d5a2d3d594832cecccbee323d6b",
            "patch": "@@ -3,6 +3,7 @@\n import gzip\n import re\n import random\n+from io import BytesIO\n \n from django.conf import settings\n from django.core import mail\n@@ -15,7 +16,7 @@\n from django.test import TestCase, RequestFactory\n from django.test.utils import override_settings\n from django.utils.six.moves import xrange\n-from django.utils.six import StringIO\n+\n \n class CommonMiddlewareTest(TestCase):\n     def setUp(self):\n@@ -526,14 +527,14 @@ def setUp(self):\n \n     @staticmethod\n     def decompress(gzipped_string):\n-        return gzip.GzipFile(mode='rb', fileobj=StringIO(gzipped_string)).read()\n+        return gzip.GzipFile(mode='rb', fileobj=BytesIO(gzipped_string)).read()\n \n     def test_compress_response(self):\n         \"\"\"\n         Tests that compression is performed on responses with compressible content.\n         \"\"\"\n         r = GZipMiddleware().process_response(self.req, self.resp)\n-        self.assertEqual(self.decompress(r.content), self.compressible_string)\n+        self.assertEqual(self.decompress(r.content), self.compressible_string.encode('utf-8'))\n         self.assertEqual(r.get('Content-Encoding'), 'gzip')\n         self.assertEqual(r.get('Content-Length'), str(len(r.content)))\n \n@@ -544,7 +545,7 @@ def test_compress_non_200_response(self):\n         \"\"\"\n         self.resp.status_code = 404\n         r = GZipMiddleware().process_response(self.req, self.resp)\n-        self.assertEqual(self.decompress(r.content), self.compressible_string)\n+        self.assertEqual(self.decompress(r.content), self.compressible_string.encode('utf-8'))\n         self.assertEqual(r.get('Content-Encoding'), 'gzip')\n \n     def test_no_compress_short_response(self):\n@@ -572,7 +573,7 @@ def test_no_compress_ie_js_requests(self):\n         self.req.META['HTTP_USER_AGENT'] = 'Mozilla/4.0 (compatible; MSIE 5.00; Windows 98)'\n         self.resp['Content-Type'] = 'application/javascript; charset=UTF-8'\n         r = GZipMiddleware().process_response(self.req, self.resp)\n-        self.assertEqual(r.content, self.compressible_string)\n+        self.assertEqual(r.content, self.compressible_string.encode('utf-8'))\n         self.assertEqual(r.get('Content-Encoding'), None)\n \n     def test_no_compress_uncompressible_response(self):"
        },
        {
            "sha": "c90c785a6ed29e00931826c9f9c65d3910557c4b",
            "filename": "tests/regressiontests/servers/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a9facb455f6f0d5a2d3d594832cecccbee323d6b/tests%2Fregressiontests%2Fservers%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a9facb455f6f0d5a2d3d594832cecccbee323d6b/tests%2Fregressiontests%2Fservers%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fservers%2Ftests.py?ref=a9facb455f6f0d5a2d3d594832cecccbee323d6b",
            "patch": "@@ -144,7 +144,7 @@ def test_fixtures_loaded(self):\n         Refs #2879.\n         \"\"\"\n         f = self.urlopen('/model_view/')\n-        self.assertEqual(f.read().splitlines(), ['jane', 'robert'])\n+        self.assertEqual(f.read().splitlines(), [b'jane', b'robert'])\n \n     def test_database_writes(self):\n         \"\"\""
        },
        {
            "sha": "56383ac196ce23530bd3c11a9469c0c8b37971cb",
            "filename": "tests/regressiontests/views/tests/debug.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a9facb455f6f0d5a2d3d594832cecccbee323d6b/tests%2Fregressiontests%2Fviews%2Ftests%2Fdebug.py",
            "raw_url": "https://github.com/django/django/raw/a9facb455f6f0d5a2d3d594832cecccbee323d6b/tests%2Fregressiontests%2Fviews%2Ftests%2Fdebug.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2Fdebug.py?ref=a9facb455f6f0d5a2d3d594832cecccbee323d6b",
            "patch": "@@ -36,7 +36,7 @@ def test_files(self):\n         self.assertEqual(response.status_code, 500)\n \n         data = {\n-            'file_data.txt': SimpleUploadedFile('file_data.txt', 'haha'),\n+            'file_data.txt': SimpleUploadedFile('file_data.txt', b'haha'),\n         }\n         response = self.client.post('/raises/', data)\n         self.assertContains(response, 'file_data.txt', status_code=500)"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 10,
        "deletions": 9
    }
}