{
    "author": "ramiro",
    "message": "Fixed #15852 -- Modified cookie parsing so it can handle duplicate invalid cookie names. Thanks goes to Fredrik St√•lnacke for the report and to vung for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16452 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "c159374a33caee14d9903de58a9f4fe879e5741c",
    "files": [
        {
            "sha": "cf1eb0d9e2a28a4b72152e4327b7811dacf9a4bf",
            "filename": "django/http/__init__.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/c159374a33caee14d9903de58a9f4fe879e5741c/django%2Fhttp%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/c159374a33caee14d9903de58a9f4fe879e5741c/django%2Fhttp%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fhttp%2F__init__.py?ref=c159374a33caee14d9903de58a9f4fe879e5741c",
            "patch": "@@ -91,7 +91,7 @@ def value_encode(self, val):\n         if not _cookie_allows_colon_in_names:\n             def load(self, rawdata, ignore_parse_errors=False):\n                 if ignore_parse_errors:\n-                    self.bad_cookies = []\n+                    self.bad_cookies = set()\n                     self._BaseCookie__set = self._loose_set\n                 super(SimpleCookie, self).load(rawdata)\n                 if ignore_parse_errors:\n@@ -105,8 +105,8 @@ def _loose_set(self, key, real_value, coded_value):\n                 try:\n                     self._strict_set(key, real_value, coded_value)\n                 except Cookie.CookieError:\n-                    self.bad_cookies.append(key)\n-                    dict.__setitem__(self, key, None)\n+                    self.bad_cookies.add(key)\n+                    dict.__setitem__(self, key, Cookie.Morsel())\n \n \n class CompatCookie(SimpleCookie):"
        },
        {
            "sha": "2a5eddc661dca56c6e492076614bf495d13e73f8",
            "filename": "tests/regressiontests/httpwrappers/tests.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/c159374a33caee14d9903de58a9f4fe879e5741c/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/c159374a33caee14d9903de58a9f4fe879e5741c/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fhttpwrappers%2Ftests.py?ref=c159374a33caee14d9903de58a9f4fe879e5741c",
            "patch": "@@ -285,3 +285,9 @@ def test_nonstandard_keys(self):\n         Test that a single non-standard cookie name doesn't affect all cookies. Ticket #13007.\n         \"\"\"\n         self.assertTrue('good_cookie' in parse_cookie('good_cookie=yes;bad:cookie=yes').keys())\n+\n+    def test_repeated_nonstandard_keys(self):\n+        \"\"\"\n+        Test that a repeated non-standard name doesn't affect all cookies. Ticket #15852\n+        \"\"\"\n+        self.assertTrue('good_cookie' in parse_cookie('a,=b; a,=c; good_cookie=yes').keys())"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 9,
        "deletions": 3
    }
}