{
    "author": "claudep",
    "message": "Specified when open should use binary mode.\n\nThanks Vinaj Sajip for the help of his django3 branch.",
    "sha": "edfa95c22ffe8f58060bb985ad1b6fbca9506f5e",
    "files": [
        {
            "sha": "37913fa078e7f03b4fc275b9576831c690c21bcd",
            "filename": "django/contrib/formtools/tests/wizard/namedwizardtests/tests.py",
            "status": "modified",
            "additions": 8,
            "deletions": 6,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fnamedwizardtests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fnamedwizardtests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fnamedwizardtests%2Ftests.py?ref=edfa95c22ffe8f58060bb985ad1b6fbca9506f5e",
            "patch": "@@ -120,7 +120,7 @@ def test_form_finish(self):\n         self.assertEqual(response.context['wizard']['steps'].current, 'form2')\n \n         post_data = self.wizard_step_data[1]\n-        post_data['form2-file1'] = open(__file__)\n+        post_data['form2-file1'] = open(__file__, 'rb')\n         response = self.client.post(\n             reverse(self.wizard_urlname,\n                     kwargs={'step': response.context['wizard']['steps'].current}),\n@@ -147,7 +147,7 @@ def test_form_finish(self):\n         self.assertEqual(response.status_code, 200)\n \n         all_data = response.context['form_list']\n-        self.assertEqual(all_data[1]['file1'].read(), open(__file__).read())\n+        self.assertEqual(all_data[1]['file1'].read(), open(__file__, 'rb').read())\n         del all_data[1]['file1']\n         self.assertEqual(all_data, [\n             {'name': u'Pony', 'thirsty': True, 'user': self.testuser},\n@@ -168,7 +168,7 @@ def test_cleaned_data(self):\n         self.assertEqual(response.status_code, 200)\n \n         post_data = self.wizard_step_data[1]\n-        post_data['form2-file1'] = open(__file__)\n+        post_data['form2-file1'] = open(__file__, 'rb')\n         response = self.client.post(\n             reverse(self.wizard_urlname,\n                     kwargs={'step': response.context['wizard']['steps'].current}),\n@@ -180,7 +180,9 @@ def test_cleaned_data(self):\n         response = self.client.get(step2_url)\n         self.assertEqual(response.status_code, 200)\n         self.assertEqual(response.context['wizard']['steps'].current, 'form2')\n-        self.assertEqual(response.context['wizard']['form'].files['form2-file1'].read(), open(__file__).read())\n+        self.assertEqual(\n+            response.context['wizard']['form'].files['form2-file1'].read(),\n+            open(__file__, 'rb').read())\n \n         response = self.client.post(\n             reverse(self.wizard_urlname,\n@@ -197,7 +199,7 @@ def test_cleaned_data(self):\n         self.assertEqual(response.status_code, 200)\n \n         all_data = response.context['all_cleaned_data']\n-        self.assertEqual(all_data['file1'].read(), open(__file__).read())\n+        self.assertEqual(all_data['file1'].read(), open(__file__, 'rb').read())\n         del all_data['file1']\n         self.assertEqual(\n             all_data,\n@@ -221,7 +223,7 @@ def test_manipulated_data(self):\n         self.assertEqual(response.status_code, 200)\n \n         post_data = self.wizard_step_data[1]\n-        post_data['form2-file1'] = open(__file__)\n+        post_data['form2-file1'] = open(__file__, 'rb')\n         response = self.client.post(\n             reverse(self.wizard_urlname,\n                     kwargs={'step': response.context['wizard']['steps'].current}),"
        },
        {
            "sha": "a9a81ba70fd52d9121fff47ae22ab9079d66dfc4",
            "filename": "django/contrib/formtools/tests/wizard/wizardtests/tests.py",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fwizardtests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fwizardtests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fwizardtests%2Ftests.py?ref=edfa95c22ffe8f58060bb985ad1b6fbca9506f5e",
            "patch": "@@ -80,7 +80,7 @@ def test_form_finish(self):\n         self.assertEqual(response.context['wizard']['steps'].current, 'form2')\n \n         post_data = self.wizard_step_data[1]\n-        post_data['form2-file1'] = open(__file__)\n+        post_data['form2-file1'] = open(__file__, 'rb')\n         response = self.client.post(self.wizard_url, post_data)\n         self.assertEqual(response.status_code, 200)\n         self.assertEqual(response.context['wizard']['steps'].current, 'form3')\n@@ -93,7 +93,7 @@ def test_form_finish(self):\n         self.assertEqual(response.status_code, 200)\n \n         all_data = response.context['form_list']\n-        self.assertEqual(all_data[1]['file1'].read(), open(__file__).read())\n+        self.assertEqual(all_data[1]['file1'].read(), open(__file__, 'rb').read())\n         del all_data[1]['file1']\n         self.assertEqual(all_data, [\n             {'name': u'Pony', 'thirsty': True, 'user': self.testuser},\n@@ -110,7 +110,7 @@ def test_cleaned_data(self):\n         self.assertEqual(response.status_code, 200)\n \n         post_data = self.wizard_step_data[1]\n-        post_data['form2-file1'] = open(__file__)\n+        post_data['form2-file1'] = open(__file__, 'rb')\n         response = self.client.post(self.wizard_url, post_data)\n         self.assertEqual(response.status_code, 200)\n \n@@ -121,7 +121,7 @@ def test_cleaned_data(self):\n         self.assertEqual(response.status_code, 200)\n \n         all_data = response.context['all_cleaned_data']\n-        self.assertEqual(all_data['file1'].read(), open(__file__).read())\n+        self.assertEqual(all_data['file1'].read(), open(__file__, 'rb').read())\n         del all_data['file1']\n         self.assertEqual(all_data, {\n             'name': u'Pony', 'thirsty': True, 'user': self.testuser,\n@@ -138,7 +138,7 @@ def test_manipulated_data(self):\n         self.assertEqual(response.status_code, 200)\n \n         post_data = self.wizard_step_data[1]\n-        post_data['form2-file1'] = open(__file__)\n+        post_data['form2-file1'] = open(__file__, 'rb')\n         response = self.client.post(self.wizard_url, post_data)\n         self.assertEqual(response.status_code, 200)\n \n@@ -165,7 +165,7 @@ def test_form_refresh(self):\n         self.assertEqual(response.context['wizard']['steps'].current, 'form2')\n \n         post_data = self.wizard_step_data[1]\n-        post_data['form2-file1'] = open(__file__)\n+        post_data['form2-file1'] = open(__file__, 'rb')\n         response = self.client.post(self.wizard_url, post_data)\n         self.assertEqual(response.status_code, 200)\n         self.assertEqual(response.context['wizard']['steps'].current, 'form3')"
        },
        {
            "sha": "fdc3535cf663c700cf7726ee9f479b2297d7d585",
            "filename": "django/core/management/commands/compilemessages.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Fcore%2Fmanagement%2Fcommands%2Fcompilemessages.py",
            "raw_url": "https://github.com/django/django/raw/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Fcore%2Fmanagement%2Fcommands%2Fcompilemessages.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fcompilemessages.py?ref=edfa95c22ffe8f58060bb985ad1b6fbca9506f5e",
            "patch": "@@ -5,7 +5,7 @@\n from django.core.management.base import BaseCommand, CommandError\n \n def has_bom(fn):\n-    with open(fn, 'r') as f:\n+    with open(fn, 'rb') as f:\n         sample = f.read(4)\n     return sample[:3] == '\\xef\\xbb\\xbf' or \\\n             sample.startswith(codecs.BOM_UTF16_LE) or \\"
        },
        {
            "sha": "6e0f079de7a63352cda24fcf4168f2d64ac9183f",
            "filename": "django/template/loaders/app_directories.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Ftemplate%2Floaders%2Fapp_directories.py",
            "raw_url": "https://github.com/django/django/raw/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Ftemplate%2Floaders%2Fapp_directories.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Floaders%2Fapp_directories.py?ref=edfa95c22ffe8f58060bb985ad1b6fbca9506f5e",
            "patch": "@@ -52,7 +52,7 @@ def get_template_sources(self, template_name, template_dirs=None):\n     def load_template_source(self, template_name, template_dirs=None):\n         for filepath in self.get_template_sources(template_name, template_dirs):\n             try:\n-                with open(filepath) as fp:\n+                with open(filepath, 'rb') as fp:\n                     return (fp.read().decode(settings.FILE_CHARSET), filepath)\n             except IOError:\n                 pass"
        },
        {
            "sha": "e87cfef987ef4009dc85f83f2d96d192bedc71c5",
            "filename": "django/template/loaders/filesystem.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Ftemplate%2Floaders%2Ffilesystem.py",
            "raw_url": "https://github.com/django/django/raw/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/django%2Ftemplate%2Floaders%2Ffilesystem.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Floaders%2Ffilesystem.py?ref=edfa95c22ffe8f58060bb985ad1b6fbca9506f5e",
            "patch": "@@ -34,7 +34,7 @@ def load_template_source(self, template_name, template_dirs=None):\n         tried = []\n         for filepath in self.get_template_sources(template_name, template_dirs):\n             try:\n-                with open(filepath) as fp:\n+                with open(filepath, 'rb') as fp:\n                     return (fp.read().decode(settings.FILE_CHARSET), filepath)\n             except IOError:\n                 tried.append(filepath)"
        },
        {
            "sha": "9d87ade13787852fcce278d78dba11b6282ec427",
            "filename": "tests/regressiontests/views/tests/static.py",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/tests%2Fregressiontests%2Fviews%2Ftests%2Fstatic.py",
            "raw_url": "https://github.com/django/django/raw/edfa95c22ffe8f58060bb985ad1b6fbca9506f5e/tests%2Fregressiontests%2Fviews%2Ftests%2Fstatic.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2Fstatic.py?ref=edfa95c22ffe8f58060bb985ad1b6fbca9506f5e",
            "patch": "@@ -29,7 +29,7 @@ def test_serve(self):\n         for filename in media_files:\n             response = self.client.get('/views/%s/%s' % (self.prefix, filename))\n             file_path = path.join(media_dir, filename)\n-            with open(file_path) as fp:\n+            with open(file_path, 'rb') as fp:\n                 self.assertEqual(fp.read(), response.content)\n             self.assertEqual(len(response.content), int(response['Content-Length']))\n             self.assertEqual(mimetypes.guess_type(file_path)[1], response.get('Content-Encoding', None))\n@@ -41,14 +41,14 @@ def test_unknown_mime_type(self):\n     def test_copes_with_empty_path_component(self):\n         file_name = 'file.txt'\n         response = self.client.get('/views/%s//%s' % (self.prefix, file_name))\n-        with open(path.join(media_dir, file_name)) as fp:\n+        with open(path.join(media_dir, file_name), 'rb') as fp:\n             self.assertEqual(fp.read(), response.content)\n \n     def test_is_modified_since(self):\n         file_name = 'file.txt'\n         response = self.client.get('/views/%s/%s' % (self.prefix, file_name),\n             HTTP_IF_MODIFIED_SINCE='Thu, 1 Jan 1970 00:00:00 GMT')\n-        with open(path.join(media_dir, file_name)) as fp:\n+        with open(path.join(media_dir, file_name), 'rb') as fp:\n             self.assertEqual(fp.read(), response.content)\n \n     def test_not_modified_since(self):\n@@ -71,7 +71,7 @@ def test_invalid_if_modified_since(self):\n         invalid_date = 'Mon, 28 May 999999999999 28:25:26 GMT'\n         response = self.client.get('/views/%s/%s' % (self.prefix, file_name),\n                                    HTTP_IF_MODIFIED_SINCE=invalid_date)\n-        with open(path.join(media_dir, file_name)) as fp:\n+        with open(path.join(media_dir, file_name), 'rb') as fp:\n             self.assertEqual(fp.read(), response.content)\n         self.assertEqual(len(response.content),\n                           int(response['Content-Length']))\n@@ -86,7 +86,7 @@ def test_invalid_if_modified_since2(self):\n         invalid_date = ': 1291108438, Wed, 20 Oct 2010 14:05:00 GMT'\n         response = self.client.get('/views/%s/%s' % (self.prefix, file_name),\n                                    HTTP_IF_MODIFIED_SINCE=invalid_date)\n-        with open(path.join(media_dir, file_name)) as fp:\n+        with open(path.join(media_dir, file_name), 'rb') as fp:\n             self.assertEqual(fp.read(), response.content)\n         self.assertEqual(len(response.content),\n                           int(response['Content-Length']))"
        }
    ],
    "stats": {
        "total": 42,
        "additions": 22,
        "deletions": 20
    }
}