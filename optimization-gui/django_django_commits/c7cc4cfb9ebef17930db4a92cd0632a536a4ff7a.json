{
    "author": "claudep",
    "message": "Fixed #16138 -- Made FormMixin get_initial return a copy of the 'initial' class variable. Thanks hanson2010, wilfred@potatolondon.com and agriffis for their work on the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17765 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a",
    "files": [
        {
            "sha": "d107e9a732948d280eedeb664d9f20323fb64847",
            "filename": "django/views/generic/edit.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/django%2Fviews%2Fgeneric%2Fedit.py",
            "raw_url": "https://github.com/django/django/raw/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/django%2Fviews%2Fgeneric%2Fedit.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fviews%2Fgeneric%2Fedit.py?ref=c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a",
            "patch": "@@ -19,7 +19,7 @@ def get_initial(self):\n         \"\"\"\n         Returns the initial data to use for forms on this view.\n         \"\"\"\n-        return self.initial\n+        return self.initial.copy()\n \n     def get_form_class(self):\n         \"\"\""
        },
        {
            "sha": "5223aee0180ced85d1bcff2c8c4e46f4137a01d5",
            "filename": "docs/ref/class-based-views.txt",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/docs%2Fref%2Fclass-based-views.txt",
            "raw_url": "https://github.com/django/django/raw/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/docs%2Fref%2Fclass-based-views.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fclass-based-views.txt?ref=c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a",
            "patch": "@@ -431,9 +431,14 @@ FormMixin\n \n     .. method:: get_initial()\n \n-        Retrieve initial data for the form. By default, returns\n+        Retrieve initial data for the form. By default, returns a copy of\n         :attr:`.initial`.\n \n+    .. admonition:: Changed in 1.4\n+\n+        In Django 1.3, this method was returning the :attr:`initial` class\n+        variable itself.\n+\n     .. method:: get_form_class()\n \n         Retrieve the form class to instantiate. By default"
        },
        {
            "sha": "211d1362c8baf78850345915eebdd956e2f0e2db",
            "filename": "docs/releases/1.4.txt",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/docs%2Freleases%2F1.4.txt",
            "raw_url": "https://github.com/django/django/raw/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/docs%2Freleases%2F1.4.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.4.txt?ref=c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a",
            "patch": "@@ -1107,6 +1107,15 @@ passed to the markdown filter, both the ``safe_mode=True`` and\n Python-Markdown library less than 2.1, a warning is issued that the output is\n insecure.\n \n+FormMixin get_initial returns an instance-specific dictionary\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+In Django 1.3, the ``get_initial`` method of the\n+:class:`django.views.generic.edit.FormMixin` class was returning the\n+class ``initial`` dictionary. This has been fixed to return a copy of this\n+dictionary, so form instances can modify their initial data without messing\n+with the class variable.\n+\n Features deprecated in 1.4\n ==========================\n "
        },
        {
            "sha": "651e14fff32e3827686e8ce56e76c75a6fa59cb8",
            "filename": "tests/regressiontests/generic_views/edit.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/tests%2Fregressiontests%2Fgeneric_views%2Fedit.py",
            "raw_url": "https://github.com/django/django/raw/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/tests%2Fregressiontests%2Fgeneric_views%2Fedit.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Fedit.py?ref=c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a",
            "patch": "@@ -5,11 +5,20 @@\n from django import forms\n from django.test import TestCase\n from django.utils.unittest import expectedFailure\n+from django.views.generic.edit import FormMixin\n \n from . import views\n from .models import Artist, Author\n \n \n+class FormMixinTests(TestCase):\n+     def test_initial_data(self):\n+         \"\"\" Test instance independence of initial data dict (see #16138) \"\"\"\n+         initial_1 = FormMixin().get_initial()\n+         initial_1['foo'] = 'bar'\n+         initial_2 = FormMixin().get_initial()\n+         self.assertNotEqual(initial_1, initial_2)\n+\n class ModelFormMixinTests(TestCase):\n     def test_get_form(self):\n         form_class = views.AuthorGetQuerySetFormView().get_form_class()"
        },
        {
            "sha": "72aab035a8476551e7522e9b8a401062434a7cd1",
            "filename": "tests/regressiontests/generic_views/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/tests%2Fregressiontests%2Fgeneric_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a/tests%2Fregressiontests%2Fgeneric_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Ftests.py?ref=c7cc4cfb9ebef17930db4a92cd0632a536a4ff7a",
            "patch": "@@ -5,6 +5,6 @@\n     MonthArchiveViewTests, WeekArchiveViewTests, DayArchiveViewTests,\n     DateDetailViewTests)\n from .detail import DetailViewTest\n-from .edit import (ModelFormMixinTests, CreateViewTests, UpdateViewTests,\n-    DeleteViewTests)\n+from .edit import (FormMixinTests, ModelFormMixinTests, CreateViewTests,\n+    UpdateViewTests, DeleteViewTests)\n from .list import ListViewTests"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 27,
        "deletions": 4
    }
}