{
    "author": "ramiro",
    "message": "Added test to demonstrate issue 11387 isn't there anymore.\n\nThanks adurdin for the report and patch. Fixes #11387.",
    "sha": "2ca37af621c077ab805b8fcb0fb18aef0cfe802d",
    "files": [
        {
            "sha": "bdd8ec5eda79aaef0882c45fbbd608b901aa8053",
            "filename": "tests/regressiontests/generic_relations_regress/models.py",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/2ca37af621c077ab805b8fcb0fb18aef0cfe802d/tests%2Fregressiontests%2Fgeneric_relations_regress%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/2ca37af621c077ab805b8fcb0fb18aef0cfe802d/tests%2Fregressiontests%2Fgeneric_relations_regress%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_relations_regress%2Fmodels.py?ref=2ca37af621c077ab805b8fcb0fb18aef0cfe802d",
            "patch": "@@ -6,7 +6,7 @@\n \n __all__ = ('Link', 'Place', 'Restaurant', 'Person', 'Address',\n            'CharLink', 'TextLink', 'OddRelation1', 'OddRelation2',\n-           'Contact', 'Organization', 'Note')\n+           'Contact', 'Organization', 'Note', 'Company')\n \n @python_2_unicode_compatible\n class Link(models.Model):\n@@ -84,3 +84,10 @@ class Organization(models.Model):\n     name = models.CharField(max_length=255)\n     contacts = models.ManyToManyField(Contact, related_name='organizations')\n \n+@python_2_unicode_compatible\n+class Company(models.Model):\n+    name = models.CharField(max_length=100)\n+    links = generic.GenericRelation(Link)\n+\n+    def __str__(self):\n+        return \"Company: %s\" % self.name"
        },
        {
            "sha": "7690fd560a8d5463c18bbf4a5d2b6142bbc68295",
            "filename": "tests/regressiontests/generic_relations_regress/tests.py",
            "status": "modified",
            "additions": 19,
            "deletions": 1,
            "changes": 20,
            "blob_url": "https://github.com/django/django/blob/2ca37af621c077ab805b8fcb0fb18aef0cfe802d/tests%2Fregressiontests%2Fgeneric_relations_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/2ca37af621c077ab805b8fcb0fb18aef0cfe802d/tests%2Fregressiontests%2Fgeneric_relations_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_relations_regress%2Ftests.py?ref=2ca37af621c077ab805b8fcb0fb18aef0cfe802d",
            "patch": "@@ -2,7 +2,7 @@\n from django.test import TestCase\n \n from .models import (Address, Place, Restaurant, Link, CharLink, TextLink,\n-    Person, Contact, Note, Organization, OddRelation1, OddRelation2)\n+    Person, Contact, Note, Organization, OddRelation1, OddRelation2, Company)\n \n \n class GenericRelationTests(TestCase):\n@@ -80,3 +80,21 @@ def test_join_reuse(self):\n         )\n         self.assertEqual(str(qs.query).count('JOIN'), 2)\n \n+    def test_generic_relation_ordering(self):\n+        \"\"\"\n+        Test that ordering over a generic relation does not include extraneous\n+        duplicate results, nor excludes rows not participating in the relation.\n+        \"\"\"\n+        p1 = Place.objects.create(name=\"South Park\")\n+        p2 = Place.objects.create(name=\"The City\")\n+        c = Company.objects.create(name=\"Chubby's Intl.\")\n+        l1 = Link.objects.create(content_object=p1)\n+        l2 = Link.objects.create(content_object=c)\n+\n+        places = list(Place.objects.order_by('links__id'))\n+        def count_places(place):\n+            return len(filter(lambda p: p.id == place.id, places))\n+\n+        self.assertEqual(len(places), 2)\n+        self.assertEqual(count_places(p1), 1)\n+        self.assertEqual(count_places(p2), 1)"
        }
    ],
    "stats": {
        "total": 29,
        "additions": 27,
        "deletions": 2
    }
}