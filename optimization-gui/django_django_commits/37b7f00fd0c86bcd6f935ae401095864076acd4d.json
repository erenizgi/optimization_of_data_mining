{
    "author": "aaugustin",
    "message": "Ensured that the warning added at r17117 also applies to queryset filter arguments. Refs #17263.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17126 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "37b7f00fd0c86bcd6f935ae401095864076acd4d",
    "files": [
        {
            "sha": "a2f4ad2029eea0d8e82d2b1f36ad401121e0e075",
            "filename": "tests/modeltests/timezones/tests.py",
            "status": "modified",
            "additions": 19,
            "deletions": 0,
            "changes": 19,
            "blob_url": "https://github.com/django/django/blob/37b7f00fd0c86bcd6f935ae401095864076acd4d/tests%2Fmodeltests%2Ftimezones%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/37b7f00fd0c86bcd6f935ae401095864076acd4d/tests%2Fmodeltests%2Ftimezones%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ftimezones%2Ftests.py?ref=37b7f00fd0c86bcd6f935ae401095864076acd4d",
            "patch": "@@ -242,6 +242,7 @@ class NewDatabaseTests(BaseDateTimeTests):\n     def test_naive_datetime(self):\n         dt = datetime.datetime(2011, 9, 1, 13, 20, 30)\n         with warnings.catch_warnings(record=True) as recorded:\n+            warnings.simplefilter('always')\n             Event.objects.create(dt=dt)\n             self.assertEqual(len(recorded), 1)\n             msg = str(recorded[0].message)\n@@ -255,6 +256,7 @@ def test_naive_datetime(self):\n     def test_naive_datetime_with_microsecond(self):\n         dt = datetime.datetime(2011, 9, 1, 13, 20, 30, 405060)\n         with warnings.catch_warnings(record=True) as recorded:\n+            warnings.simplefilter('always')\n             Event.objects.create(dt=dt)\n             self.assertEqual(len(recorded), 1)\n             msg = str(recorded[0].message)\n@@ -268,6 +270,7 @@ def test_naive_datetime_with_microsecond(self):\n     def test_naive_datetime_with_microsecond_unsupported(self):\n         dt = datetime.datetime(2011, 9, 1, 13, 20, 30, 405060)\n         with warnings.catch_warnings(record=True) as recorded:\n+            warnings.simplefilter('always')\n             Event.objects.create(dt=dt)\n             self.assertEqual(len(recorded), 1)\n             msg = str(recorded[0].message)\n@@ -344,6 +347,22 @@ def test_query_filter_with_pytz_timezones(self):\n         self.assertEqual(Event.objects.filter(dt__in=(prev, dt, next)).count(), 1)\n         self.assertEqual(Event.objects.filter(dt__range=(prev, next)).count(), 1)\n \n+    @skipIf(sys.version_info < (2, 6), \"this test requires Python >= 2.6\")\n+    def test_query_filter_with_naive_datetime(self):\n+        dt = datetime.datetime(2011, 9, 1, 12, 20, 30, tzinfo=EAT)\n+        Event.objects.create(dt=dt)\n+        dt = dt.replace(tzinfo=None)\n+        with warnings.catch_warnings(record=True) as recorded:\n+            warnings.simplefilter('always')\n+            # naive datetimes are interpreted in local time\n+            self.assertEqual(Event.objects.filter(dt__exact=dt).count(), 1)\n+            self.assertEqual(Event.objects.filter(dt__lte=dt).count(), 1)\n+            self.assertEqual(Event.objects.filter(dt__gt=dt).count(), 0)\n+            self.assertEqual(len(recorded), 3)\n+            for warning in recorded:\n+                msg = str(warning.message)\n+                self.assertTrue(msg.startswith(\"DateTimeField received a naive datetime\"))\n+\n     def test_query_date_related_filters(self):\n         # These two dates fall in the same day in EAT, but in different days,\n         # years and months in UTC, and aggregation is performed in UTC when"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 19,
        "deletions": 0
    }
}