{
    "author": "claudep",
    "message": "Fixed #18038 -- Removed the 'supports_inactive_user' backwards-compatibility flag. Thanks Aymeric Augustin for the initial patch and Ramiro Morales for the review.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17938 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "be12c9e9082c12e0510b88d08e735ea2af939b07",
    "files": [
        {
            "sha": "dd816ce72631c39bd20e7eff2e4fde159f2f94db",
            "filename": "django/contrib/auth/__init__.py",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2F__init__.py?ref=be12c9e9082c12e0510b88d08e735ea2af939b07",
            "patch": "@@ -1,4 +1,3 @@\n-from warnings import warn\n from django.core.exceptions import ImproperlyConfigured\n from django.utils.importlib import import_module\n from django.contrib.auth.signals import user_logged_in, user_logged_out\n@@ -20,11 +19,6 @@ def load_backend(path):\n         cls = getattr(mod, attr)\n     except AttributeError:\n         raise ImproperlyConfigured('Module \"%s\" does not define a \"%s\" authentication backend' % (module, attr))\n-\n-    if not hasattr(cls, 'supports_inactive_user'):\n-        warn(\"Authentication backends without a `supports_inactive_user` attribute are deprecated. Please define it in %s.\" % cls,\n-             DeprecationWarning)\n-        cls.supports_inactive_user = False\n     return cls()\n \n def get_backends():"
        },
        {
            "sha": "04fbef4788eea4ab2b566111352f0eb1f52c0b73",
            "filename": "django/contrib/auth/backends.py",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2Fbackends.py",
            "raw_url": "https://github.com/django/django/raw/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2Fbackends.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fbackends.py?ref=be12c9e9082c12e0510b88d08e735ea2af939b07",
            "patch": "@@ -5,7 +5,6 @@ class ModelBackend(object):\n     \"\"\"\n     Authenticates against django.contrib.auth.models.User.\n     \"\"\"\n-    supports_inactive_user = True\n \n     # TODO: Model, login attribute name and password attribute name should be\n     # configurable."
        },
        {
            "sha": "042420aa8aafe0aac1f8db2021927dd8bf9cce37",
            "filename": "django/contrib/auth/models.py",
            "status": "modified",
            "additions": 10,
            "deletions": 12,
            "changes": 22,
            "blob_url": "https://github.com/django/django/blob/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fmodels.py?ref=be12c9e9082c12e0510b88d08e735ea2af939b07",
            "patch": "@@ -200,25 +200,23 @@ def _user_has_perm(user, perm, obj):\n     anon = user.is_anonymous()\n     active = user.is_active\n     for backend in auth.get_backends():\n-        if anon or active or backend.supports_inactive_user:\n-            if hasattr(backend, \"has_perm\"):\n-                if obj is not None:\n-                    if backend.has_perm(user, perm, obj):\n-                            return True\n-                else:\n-                    if backend.has_perm(user, perm):\n-                        return True\n+        if hasattr(backend, \"has_perm\"):\n+            if obj is not None:\n+                if backend.has_perm(user, perm, obj):\n+                    return True\n+            else:\n+                if backend.has_perm(user, perm):\n+                    return True\n     return False\n \n \n def _user_has_module_perms(user, app_label):\n     anon = user.is_anonymous()\n     active = user.is_active\n     for backend in auth.get_backends():\n-        if anon or active or backend.supports_inactive_user:\n-            if hasattr(backend, \"has_module_perms\"):\n-                if backend.has_module_perms(user, app_label):\n-                    return True\n+        if hasattr(backend, \"has_module_perms\"):\n+            if backend.has_module_perms(user, app_label):\n+                return True\n     return False\n \n "
        },
        {
            "sha": "16eaa5c5b40d27c69f2a0f030dec09b3892a8141",
            "filename": "django/contrib/auth/tests/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2F__init__.py?ref=be12c9e9082c12e0510b88d08e735ea2af939b07",
            "patch": "@@ -1,6 +1,6 @@\n from django.contrib.auth.tests.auth_backends import (BackendTest,\n     RowlevelBackendTest, AnonymousUserBackendTest, NoBackendsTest,\n-    InActiveUserBackendTest, NoInActiveUserBackendTest)\n+    InActiveUserBackendTest)\n from django.contrib.auth.tests.basic import BasicTestCase\n from django.contrib.auth.tests.context_processors import AuthContextProcessorTests\n from django.contrib.auth.tests.decorators import LoginRequiredTestCase"
        },
        {
            "sha": "7b38acfa50e2a3178eed313a5cea519da1c460b0",
            "filename": "django/contrib/auth/tests/auth_backends.py",
            "status": "modified",
            "additions": 3,
            "deletions": 48,
            "changes": 51,
            "blob_url": "https://github.com/django/django/blob/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2Ftests%2Fauth_backends.py",
            "raw_url": "https://github.com/django/django/raw/be12c9e9082c12e0510b88d08e735ea2af939b07/django%2Fcontrib%2Fauth%2Ftests%2Fauth_backends.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Fauth_backends.py?ref=be12c9e9082c12e0510b88d08e735ea2af939b07",
            "patch": "@@ -104,12 +104,6 @@ class TestObj(object):\n \n \n class SimpleRowlevelBackend(object):\n-    supports_inactive_user = False\n-\n-    # This class also supports tests for anonymous user permissions, and\n-    # inactive user permissions via subclasses which just set the\n-    # 'supports_anonymous_user' or 'supports_inactive_user' attribute.\n-\n     def has_perm(self, user, perm, obj=None):\n         if not obj:\n             return # We only support row level perms\n@@ -196,16 +190,12 @@ def test_get_group_permissions(self):\n         self.assertEqual(self.user3.get_group_permissions(TestObj()), set(['group_perm']))\n \n \n-class AnonymousUserBackend(SimpleRowlevelBackend):\n-    supports_inactive_user = False\n-\n-\n class AnonymousUserBackendTest(TestCase):\n     \"\"\"\n     Tests for AnonymousUser delegating to backend.\n     \"\"\"\n \n-    backend = 'django.contrib.auth.tests.auth_backends.AnonymousUserBackend'\n+    backend = 'django.contrib.auth.tests.auth_backends.SimpleRowlevelBackend'\n \n     def setUp(self):\n         self.curr_auth = settings.AUTHENTICATION_BACKENDS\n@@ -243,20 +233,11 @@ def test_raises_exception(self):\n         self.assertRaises(ImproperlyConfigured, self.user.has_perm, ('perm', TestObj(),))\n \n \n-class InActiveUserBackend(SimpleRowlevelBackend):\n-    supports_inactive_user = True\n-\n-\n-class NoInActiveUserBackend(SimpleRowlevelBackend):\n-    supports_inactive_user = False\n-\n-\n class InActiveUserBackendTest(TestCase):\n     \"\"\"\n-    Tests for a inactive user delegating to backend if it has 'supports_inactive_user' = True\n+    Tests for a inactive user\n     \"\"\"\n-\n-    backend = 'django.contrib.auth.tests.auth_backends.InActiveUserBackend'\n+    backend = 'django.contrib.auth.tests.auth_backends.SimpleRowlevelBackend'\n \n     def setUp(self):\n         self.curr_auth = settings.AUTHENTICATION_BACKENDS\n@@ -275,29 +256,3 @@ def test_has_perm(self):\n     def test_has_module_perms(self):\n         self.assertEqual(self.user1.has_module_perms(\"app1\"), False)\n         self.assertEqual(self.user1.has_module_perms(\"app2\"), False)\n-\n-\n-class NoInActiveUserBackendTest(TestCase):\n-    \"\"\"\n-    Tests that an inactive user does not delegate to backend if it has 'supports_inactive_user' = False\n-    \"\"\"\n-    backend = 'django.contrib.auth.tests.auth_backends.NoInActiveUserBackend'\n-\n-    def setUp(self):\n-        self.curr_auth = settings.AUTHENTICATION_BACKENDS\n-        settings.AUTHENTICATION_BACKENDS = tuple(self.curr_auth) + (self.backend,)\n-        self.user1 = User.objects.create_user('test', 'test@example.com', 'test')\n-        self.user1.is_active = False\n-        self.user1.save()\n-\n-    def tearDown(self):\n-        settings.AUTHENTICATION_BACKENDS = self.curr_auth\n-\n-    def test_has_perm(self):\n-        self.assertEqual(self.user1.has_perm('perm', TestObj()), False)\n-        self.assertEqual(self.user1.has_perm('inactive', TestObj()), False)\n-\n-    def test_has_module_perms(self):\n-        self.assertEqual(self.user1.has_module_perms(\"app1\"), False)\n-        self.assertEqual(self.user1.has_module_perms(\"app2\"), False)\n-"
        },
        {
            "sha": "8690b832e2f2de1617b2dd037ef782f79e26a4e6",
            "filename": "docs/topics/auth.txt",
            "status": "modified",
            "additions": 2,
            "deletions": 11,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/be12c9e9082c12e0510b88d08e735ea2af939b07/docs%2Ftopics%2Fauth.txt",
            "raw_url": "https://github.com/django/django/raw/be12c9e9082c12e0510b88d08e735ea2af939b07/docs%2Ftopics%2Fauth.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fauth.txt?ref=be12c9e9082c12e0510b88d08e735ea2af939b07",
            "patch": "@@ -1831,8 +1831,6 @@ object the first time a user authenticates::\n         ADMIN_PASSWORD = 'sha1$4e987$afbcf42e21bd417fb71db8c66b321e9fc33051de'\n         \"\"\"\n \n-        supports_inactive_user = False\n-\n         def authenticate(self, username=None, password=None):\n             login_valid = (settings.ADMIN_LOGIN == username)\n             pwd_valid = check_password(password, settings.ADMIN_PASSWORD)\n@@ -1931,15 +1929,8 @@ The support for anonymous users in the permission system allows for\n anonymous users to have permissions to do something while inactive\n authenticated users do not.\n \n-To enable this on your own backend, you must set the class attribute\n-``supports_inactive_user`` to ``True``.\n-\n-A nonexisting ``supports_inactive_user`` attribute will raise a\n-``PendingDeprecationWarning`` if used in Django 1.3. In Django 1.4, this\n-warning will be updated to a ``DeprecationWarning`` which will be displayed\n-loudly. Additionally ``supports_inactive_user`` will be set to ``False``.\n-Django 1.5 will assume that every backend supports inactive users being\n-passed to the authorization methods.\n+Do not forget to test for the ``is_active`` attribute of the user in your own\n+backend permission methods.\n \n \n Handling object permissions"
        }
    ],
    "stats": {
        "total": 95,
        "additions": 16,
        "deletions": 79
    }
}