{
    "author": "ramiro",
    "message": "Removed unused code from admindocs app now that it supports reversing URLs.\n\nAs a consequence the undocumented `ADMIN_SITE_ROOT_URL` setting isn't used anymore.\n\nRefs r8718 and r16857.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16898 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "b1c3174cfaf2e850da86c7649f64bf62f60046dc",
    "files": [
        {
            "sha": "a16cfe975516710da83d79b1c40012885c071f9d",
            "filename": "django/contrib/admindocs/views.py",
            "status": "modified",
            "additions": 11,
            "deletions": 17,
            "changes": 28,
            "blob_url": "https://github.com/django/django/blob/b1c3174cfaf2e850da86c7649f64bf62f60046dc/django%2Fcontrib%2Fadmindocs%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/b1c3174cfaf2e850da86c7649f64bf62f60046dc/django%2Fcontrib%2Fadmindocs%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmindocs%2Fviews.py?ref=b1c3174cfaf2e850da86c7649f64bf62f60046dc",
            "patch": "@@ -24,23 +24,17 @@ class GenericSite(object):\n     domain = 'example.com'\n     name = 'my site'\n \n-def get_root_path():\n-    try:\n-        return urlresolvers.reverse('admin:index')\n-    except urlresolvers.NoReverseMatch:\n-        return getattr(settings, \"ADMIN_SITE_ROOT_URL\", \"/admin/\")\n-\n @staff_member_required\n def doc_index(request):\n     if not utils.docutils_is_available:\n         return missing_docutils_page(request)\n     return render_to_response('admin_doc/index.html', {\n-        'root_path': get_root_path(),\n+        'root_path': urlresolvers.reverse('admin:index'),\n     }, context_instance=RequestContext(request))\n \n @staff_member_required\n def bookmarklets(request):\n-    admin_root = get_root_path()\n+    admin_root = urlresolvers.reverse('admin:index')\n     return render_to_response('admin_doc/bookmarklets.html', {\n         'root_path': admin_root,\n         'admin_url': mark_safe(\"%s://%s%s\" % (request.is_secure() and 'https' or 'http', request.get_host(), admin_root)),\n@@ -77,7 +71,7 @@ def template_tag_index(request):\n                 'library': tag_library,\n             })\n     return render_to_response('admin_doc/template_tag_index.html', {\n-        'root_path': get_root_path(),\n+        'root_path': urlresolvers.reverse('admin:index'),\n         'tags': tags\n     }, context_instance=RequestContext(request))\n \n@@ -112,7 +106,7 @@ def template_filter_index(request):\n                 'library': tag_library,\n             })\n     return render_to_response('admin_doc/template_filter_index.html', {\n-        'root_path': get_root_path(),\n+        'root_path': urlresolvers.reverse('admin:index'),\n         'filters': filters\n     }, context_instance=RequestContext(request))\n \n@@ -142,7 +136,7 @@ def view_index(request):\n                 'url': simplify_regex(regex),\n             })\n     return render_to_response('admin_doc/view_index.html', {\n-        'root_path': get_root_path(),\n+        'root_path': urlresolvers.reverse('admin:index'),\n         'views': views\n     }, context_instance=RequestContext(request))\n \n@@ -164,7 +158,7 @@ def view_detail(request, view):\n     for key in metadata:\n         metadata[key] = utils.parse_rst(metadata[key], 'model', _('view:') + view)\n     return render_to_response('admin_doc/view_detail.html', {\n-        'root_path': get_root_path(),\n+        'root_path': urlresolvers.reverse('admin:index'),\n         'name': view,\n         'summary': title,\n         'body': body,\n@@ -177,7 +171,7 @@ def model_index(request):\n         return missing_docutils_page(request)\n     m_list = [m._meta for m in models.get_models()]\n     return render_to_response('admin_doc/model_index.html', {\n-        'root_path': get_root_path(),\n+        'root_path': urlresolvers.reverse('admin:index'),\n         'models': m_list\n     }, context_instance=RequestContext(request))\n \n@@ -207,7 +201,7 @@ def model_detail(request, app_label, model_name):\n         # ForeignKey is a special case since the field will actually be a\n         # descriptor that returns the other object\n         if isinstance(field, models.ForeignKey):\n-            data_type = related_object_name = field.rel.to.__name__\n+            data_type = field.rel.to.__name__\n             app_label = field.rel.to._meta.app_label\n             verbose = utils.parse_rst((_(\"the related `%(app_label)s.%(data_type)s` object\")  % {'app_label': app_label, 'data_type': data_type}), 'model', _('model:') + data_type)\n         else:\n@@ -222,7 +216,7 @@ def model_detail(request, app_label, model_name):\n \n     # Gather many-to-many fields.\n     for field in opts.many_to_many:\n-        data_type = related_object_name = field.rel.to.__name__\n+        data_type = field.rel.to.__name__\n         app_label = field.rel.to._meta.app_label\n         verbose = _(\"related `%(app_label)s.%(object_name)s` objects\") % {'app_label': app_label, 'object_name': data_type}\n         fields.append({\n@@ -269,7 +263,7 @@ def model_detail(request, app_label, model_name):\n             'verbose'   : utils.parse_rst(_(\"number of %s\") % verbose , 'model', _('model:') + opts.module_name),\n         })\n     return render_to_response('admin_doc/model_detail.html', {\n-        'root_path': get_root_path(),\n+        'root_path': urlresolvers.reverse('admin:index'),\n         'name': '%s.%s' % (opts.app_label, opts.object_name),\n         'summary': _(\"Fields on %s objects\") % opts.object_name,\n         'description': model.__doc__,\n@@ -296,7 +290,7 @@ def template_detail(request, template):\n                 'order': list(settings_mod.TEMPLATE_DIRS).index(dir),\n             })\n     return render_to_response('admin_doc/template_detail.html', {\n-        'root_path': get_root_path(),\n+        'root_path': urlresolvers.reverse('admin:index'),\n         'name': template,\n         'templates': templates,\n     }, context_instance=RequestContext(request))"
        }
    ],
    "stats": {
        "total": 28,
        "additions": 11,
        "deletions": 17
    }
}