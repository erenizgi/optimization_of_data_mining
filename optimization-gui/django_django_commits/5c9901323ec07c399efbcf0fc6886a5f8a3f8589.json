{
    "author": "jphalip",
    "message": "Fixed #12073 -- Made `AdminDateWidget` and `AdminTimeWidget` consider user-supplied `attrs`. Thanks to elliss for the report and to koenb for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17125 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "5c9901323ec07c399efbcf0fc6886a5f8a3f8589",
    "files": [
        {
            "sha": "29958b27a4d09577368593ec7eea9785b9054069",
            "filename": "django/contrib/admin/widgets.py",
            "status": "modified",
            "additions": 10,
            "deletions": 4,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/5c9901323ec07c399efbcf0fc6886a5f8a3f8589/django%2Fcontrib%2Fadmin%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/5c9901323ec07c399efbcf0fc6886a5f8a3f8589/django%2Fcontrib%2Fadmin%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fwidgets.py?ref=5c9901323ec07c399efbcf0fc6886a5f8a3f8589",
            "patch": "@@ -53,8 +53,11 @@ def media(self):\n         js = [\"calendar.js\", \"admin/DateTimeShortcuts.js\"]\n         return forms.Media(js=[static(\"admin/js/%s\" % path) for path in js])\n \n-    def __init__(self, attrs={}, format=None):\n-        super(AdminDateWidget, self).__init__(attrs={'class': 'vDateField', 'size': '10'}, format=format)\n+    def __init__(self, attrs=None, format=None):\n+        final_attrs = {'class': 'vDateField', 'size': '10'}\n+        if attrs is not None:\n+            final_attrs.update(attrs)\n+        super(AdminDateWidget, self).__init__(attrs=final_attrs, format=format)\n \n class AdminTimeWidget(forms.TimeInput):\n \n@@ -63,8 +66,11 @@ def media(self):\n         js = [\"calendar.js\", \"admin/DateTimeShortcuts.js\"]\n         return forms.Media(js=[static(\"admin/js/%s\" % path) for path in js])\n \n-    def __init__(self, attrs={}, format=None):\n-        super(AdminTimeWidget, self).__init__(attrs={'class': 'vTimeField', 'size': '8'}, format=format)\n+    def __init__(self, attrs=None, format=None):\n+        final_attrs = {'class': 'vTimeField', 'size': '8'}\n+        if attrs is not None:\n+            final_attrs.update(attrs)\n+        super(AdminTimeWidget, self).__init__(attrs=final_attrs, format=format)\n \n class AdminSplitDateTime(forms.SplitDateTimeWidget):\n     \"\"\""
        },
        {
            "sha": "37fa7bc8efe54fa3d2feb59feae4432348ff8edf",
            "filename": "tests/regressiontests/admin_widgets/tests.py",
            "status": "modified",
            "additions": 35,
            "deletions": 0,
            "changes": 35,
            "blob_url": "https://github.com/django/django/blob/5c9901323ec07c399efbcf0fc6886a5f8a3f8589/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/5c9901323ec07c399efbcf0fc6886a5f8a3f8589/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py?ref=5c9901323ec07c399efbcf0fc6886a5f8a3f8589",
            "patch": "@@ -205,6 +205,41 @@ def test_stacked_render(self):\n             '<select multiple=\"multiple\" name=\"test\" class=\"selectfilterstacked\">\\n</select><script type=\"text/javascript\">addEvent(window, \"load\", function(e) {SelectFilter.init(\"id_test\", \"test\", 1, \"%(ADMIN_MEDIA_PREFIX)s\"); });</script>\\n' % admin_media_prefix()\n         )\n \n+class AdminDateWidgetTest(DjangoTestCase):\n+    def test_attrs(self):\n+        \"\"\"\n+        Ensure that user-supplied attrs are used.\n+        Refs #12073.\n+        \"\"\"\n+        w = widgets.AdminDateWidget()\n+        self.assertEqual(\n+            conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n+            '<input value=\"2007-12-01\" type=\"text\" class=\"vDateField\" name=\"test\" size=\"10\" />',\n+        )\n+        # pass attrs to widget\n+        w = widgets.AdminDateWidget(attrs={'size': 20, 'class': 'myDateField'})\n+        self.assertEqual(\n+            conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n+            '<input value=\"2007-12-01\" type=\"text\" class=\"myDateField\" name=\"test\" size=\"20\" />',\n+        )\n+\n+class AdminTimeWidgetTest(DjangoTestCase):\n+    def test_attrs(self):\n+        \"\"\"\n+        Ensure that user-supplied attrs are used.\n+        Refs #12073.\n+        \"\"\"\n+        w = widgets.AdminTimeWidget()\n+        self.assertEqual(\n+            conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n+            '<input value=\"09:30:00\" type=\"text\" class=\"vTimeField\" name=\"test\" size=\"8\" />',\n+        )\n+        # pass attrs to widget\n+        w = widgets.AdminTimeWidget(attrs={'size': 20, 'class': 'myTimeField'})\n+        self.assertEqual(\n+            conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n+            '<input value=\"09:30:00\" type=\"text\" class=\"myTimeField\" name=\"test\" size=\"20\" />',\n+        )\n \n class AdminSplitDateTimeWidgetTest(DjangoTestCase):\n     def test_render(self):"
        }
    ],
    "stats": {
        "total": 49,
        "additions": 45,
        "deletions": 4
    }
}