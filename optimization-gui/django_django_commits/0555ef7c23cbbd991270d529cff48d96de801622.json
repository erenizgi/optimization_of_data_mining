{
    "author": "aaugustin",
    "message": "Added structure in the 1.6 release notes.\n\nThe backwards-incompatible changes section wasn't structured in sections\nlike it is in release notes for previous versions.",
    "sha": "0555ef7c23cbbd991270d529cff48d96de801622",
    "files": [
        {
            "sha": "abb4dff811398d3fcf7cc1dbdd4186676f680189",
            "filename": "docs/releases/1.6.txt",
            "status": "modified",
            "additions": 120,
            "deletions": 62,
            "changes": 182,
            "blob_url": "https://github.com/django/django/blob/0555ef7c23cbbd991270d529cff48d96de801622/docs%2Freleases%2F1.6.txt",
            "raw_url": "https://github.com/django/django/raw/0555ef7c23cbbd991270d529cff48d96de801622/docs%2Freleases%2F1.6.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.6.txt?ref=0555ef7c23cbbd991270d529cff48d96de801622",
            "patch": "@@ -165,98 +165,156 @@ Backwards incompatible changes in 1.6\n     deprecation timeline for a given feature, its removal may appear as a\n     backwards incompatible change.\n \n-* Database-level autocommit is enabled by default in Django 1.6. While this\n-  doesn't change the general spirit of Django's transaction management, there\n-  are a few known backwards-incompatibities, described in the :ref:`transaction\n-  management docs <transactions-upgrading-from-1.5>`. You should review your code\n-  to determine if you're affected.\n+New transaction management model\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Database-level autocommit is enabled by default in Django 1.6. While this\n+doesn't change the general spirit of Django's transaction management, there\n+are a few known backwards-incompatibities, described in the :ref:`transaction\n+management docs <transactions-upgrading-from-1.5>`. You should review your\n+code to determine if you're affected.\n+\n+In previous versions, database-level autocommit was only an option for\n+PostgreSQL, and it was disabled by default. This option is now :ref:`ignored\n+<postgresql-autocommit-mode>` and can be removed.\n+\n+Addition of ``QuerySet.datetimes()``\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+When the :doc:`time zone support </topics/i18n/timezones>` added in Django 1.4\n+was active, :meth:`QuerySet.dates() <django.db.models.query.QuerySet.dates>`\n+lookups returned unexpected results, because the aggregation was performed in\n+UTC. To fix this, Django 1.6 introduces a new API, :meth:`QuerySet.datetimes()\n+<django.db.models.query.QuerySet.datetimes>`. This requires a few changes in\n+your code.\n \n-* In previous versions, database-level autocommit was only an option for\n-  PostgreSQL, and it was disabled by default. This option is now\n-  :ref:`ignored <postgresql-autocommit-mode>`.\n+``QuerySet.dates()`` returns ``date`` objects\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-* The ``django.db.models.query.EmptyQuerySet`` can't be instantiated any more -\n-  it is only usable as a marker class for checking if\n-  :meth:`~django.db.models.query.QuerySet.none` has been called:\n-  ``isinstance(qs.none(), EmptyQuerySet)``\n+:meth:`QuerySet.dates() <django.db.models.query.QuerySet.dates>` now returns a\n+list of :class:`~datetime.date`. It used to return a list of\n+:class:`~datetime.datetime`.\n \n-* :meth:`QuerySet.dates() <django.db.models.query.QuerySet.dates>` raises an\n-  error if it's used on :class:`~django.db.models.DateTimeField` when time\n-  zone support is active. Use :meth:`QuerySet.datetimes()\n-  <django.db.models.query.QuerySet.datetimes>` instead.\n+:meth:`QuerySet.datetimes() <django.db.models.query.QuerySet.datetimes>`\n+returns a list of :class:`~datetime.datetime`.\n \n-* :meth:`QuerySet.dates() <django.db.models.query.QuerySet.dates>` returns a\n-  list of :class:`~datetime.date`. It used to return a list of\n-  :class:`~datetime.datetime`.\n+``QuerySet.dates()`` no longer usable on ``DateTimeField``\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-* The :attr:`~django.contrib.admin.ModelAdmin.date_hierarchy` feature of the\n-  admin on a :class:`~django.db.models.DateTimeField` requires time zone\n-  definitions in the database when :setting:`USE_TZ` is ``True``.\n-  :ref:`Learn more <database-time-zone-definitions>`.\n+:meth:`QuerySet.dates() <django.db.models.query.QuerySet.dates>` raises an\n+error if it's used on :class:`~django.db.models.DateTimeField` when time\n+zone support is active. Use :meth:`QuerySet.datetimes()\n+<django.db.models.query.QuerySet.datetimes>` instead.\n \n-* Accessing ``date_list`` in the context of a date-based generic view requires\n-  time zone definitions in the database when the view is based on a\n-  :class:`~django.db.models.DateTimeField` and :setting:`USE_TZ` is ``True``.\n-  :ref:`Learn more <database-time-zone-definitions>`.\n+``date_hierarchy`` requires time zone definitions\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-* Model fields named ``hour``, ``minute`` or ``second`` may clash with the new\n-  lookups. Append an explicit :lookup:`exact` lookup if this is an issue.\n+The :attr:`~django.contrib.admin.ModelAdmin.date_hierarchy` feature of the\n+admin now relies on :meth:`QuerySet.datetimes()\n+<django.db.models.query.QuerySet.datetimes>` when it's used on a\n+:class:`~django.db.models.DateTimeField`.\n \n-* When Django establishes a connection to the database, it sets up appropriate\n-  parameters, depending on the backend being used. Since `persistent database\n-  connections <persistent-database-connections>`_ are enabled by default in\n-  Django 1.6, this setup isn't repeated at every request any more. If you\n-  modifiy parameters such as the connection's isolation level or time zone,\n-  you should either restore Django's defaults at the end of each request, or\n-  force an appropriate value at the beginning of each request.\n+This requires time zone definitions in the database when :setting:`USE_TZ` is\n+``True``. :ref:`Learn more <database-time-zone-definitions>`.\n \n-* If your CSS/Javascript code used to access HTML input widgets by type, you\n-  should review it as ``type='text'`` widgets might be now output as\n-  ``type='email'``, ``type='url'`` or ``type='number'`` depending on their\n-  corresponding field type.\n+``date_list`` in generic views requires time zone definitions\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-* Extraction of translatable literals from templates with the\n-  :djadmin:`makemessages` command now correctly detects i18n constructs when\n-  they are located after a ``{#`` / ``#}``-type comment on the same line. E.g.:\n+For the same reason, accessing ``date_list`` in the context of a date-based\n+generic view requires time zone definitions in the database when the view is\n+based on a :class:`~django.db.models.DateTimeField` and :setting:`USE_TZ` is\n+``True``. :ref:`Learn more <database-time-zone-definitions>`.\n \n-  .. code-block:: html+django\n+New lookups may clash with model fields\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Django 1.6 introduces ``hour``, ``minute``, and ``second`` lookups on\n+:class:`~django.db.models.DateTimeField`. If you had model fields called\n+``hour``, ``minute``, or ``second``, the new lookups will clash with you field\n+names. Append an explicit :lookup:`exact` lookup if this is an issue.\n+\n+Persistent database connections\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Connection setup not repeated for each request\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+When Django establishes a connection to the database, it sets up appropriate\n+parameters, depending on the backend being used. Since `persistent database\n+connections <persistent-database-connections>`_ are enabled by default in\n+Django 1.6, this setup isn't repeated at every request any more. If you\n+modifiy parameters such as the connection's isolation level or time zone, you\n+should either restore Django's defaults at the end of each request, force an\n+appropriate value at the beginning of each request, or disable persistent\n+connections.\n+\n+Translations and comments in templates\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Extraction of translations after comments\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+Extraction of translatable literals from templates with the\n+:djadmin:`makemessages` command now correctly detects i18n constructs when\n+they are located after a ``{#`` / ``#}``-type comment on the same line. E.g.:\n+\n+.. code-block:: html+django\n \n     {# A comment #}{% trans \"This literal was incorrectly ignored. Not anymore\" %}\n \n-* (Related to the above item.) Validation of the placement of\n-  :ref:`translator-comments-in-templates` specified using ``{#`` / ``#}`` is now\n-  stricter. All translator comments not located at the end of their respective\n-  lines in a template are ignored and a warning is generated by\n-  :djadmin:`makemessages` when it finds them. E.g.:\n+Location of translator comments\n+^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n+\n+Validation of the placement of :ref:`translator-comments-in-templates`\n+specified using ``{#`` / ``#}`` is now stricter. All translator comments not\n+located at the end of their respective lines in a template are ignored and a\n+warning is generated by :djadmin:`makemessages` when it finds them. E.g.:\n \n   .. code-block:: html+django\n \n     {# Translators: This is ignored #}{% trans \"Translate me\" %}\n     {{ title }}{# Translators: Extracted and associated with 'Welcome' below #}\n     <h1>{% trans \"Welcome\" %}</h1>\n \n-* The :doc:`comments </ref/contrib/comments/index>` app now uses a ``GenericIPAddressField``\n-  for storing commenters' IP addresses, to support comments submitted from IPv6 addresses.\n-  Until now, it stored them in an ``IPAddressField``, which is only meant to support IPv4.\n-  When saving a comment made from an IPv6 address, the address would be silently truncated\n-  on MySQL databases, and raise an exception on Oracle.\n-  You will need to change the column type in your database to benefit from this change.\n+Storage of IP addresses in the comments app\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n \n-  For MySQL, execute this query on your project's database:\n+The :doc:`comments </ref/contrib/comments/index>` app now uses a\n+``GenericIPAddressField`` for storing commenters' IP addresses, to support\n+comments submitted from IPv6 addresses. Until now, it stored them in an\n+``IPAddressField``, which is only meant to support IPv4. When saving a comment\n+made from an IPv6 address, the address would be silently truncated on MySQL\n+databases, and raise an exception on Oracle. You will need to change the\n+column type in your database to benefit from this change.\n \n-  .. code-block:: sql\n+For MySQL, execute this query on your project's database:\n+\n+.. code-block:: sql\n \n     ALTER TABLE django_comments MODIFY ip_address VARCHAR(39);\n \n-  For Oracle, execute this query:\n+For Oracle, execute this query:\n \n-  .. code-block:: sql\n+.. code-block:: sql\n \n     ALTER TABLE DJANGO_COMMENTS MODIFY (ip_address VARCHAR2(39));\n \n-  If you do not apply this change, the behaviour is unchanged: on MySQL, IPv6 addresses\n-  are silently truncated; on Oracle, an exception is generated. No database\n-  change is needed for SQLite or PostgreSQL databases.\n+If you do not apply this change, the behaviour is unchanged: on MySQL, IPv6\n+addresses are silently truncated; on Oracle, an exception is generated. No\n+database change is needed for SQLite or PostgreSQL databases.\n+\n+Miscellaneous\n+~~~~~~~~~~~~~\n+\n+* The ``django.db.models.query.EmptyQuerySet`` can't be instantiated any more -\n+  it is only usable as a marker class for checking if\n+  :meth:`~django.db.models.query.QuerySet.none` has been called:\n+  ``isinstance(qs.none(), EmptyQuerySet)``\n+\n+* If your CSS/Javascript code used to access HTML input widgets by type, you\n+  should review it as ``type='text'`` widgets might be now output as\n+  ``type='email'``, ``type='url'`` or ``type='number'`` depending on their\n+  corresponding field type.\n \n Features deprecated in 1.6\n =========================="
        }
    ],
    "stats": {
        "total": 182,
        "additions": 120,
        "deletions": 62
    }
}