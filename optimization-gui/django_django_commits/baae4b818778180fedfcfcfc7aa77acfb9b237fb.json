{
    "author": "aaugustin",
    "message": "Fixed #19397 -- Crash on binary files in project templates.\n\nThanks gw 2012 at tnode com for the report.",
    "sha": "baae4b818778180fedfcfcfc7aa77acfb9b237fb",
    "files": [
        {
            "sha": "f522097b8cc8fdb962a4591fd18330ba423aff14",
            "filename": "django/core/management/templates.py",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/baae4b818778180fedfcfcfc7aa77acfb9b237fb/django%2Fcore%2Fmanagement%2Ftemplates.py",
            "raw_url": "https://github.com/django/django/raw/baae4b818778180fedfcfcfc7aa77acfb9b237fb/django%2Fcore%2Fmanagement%2Ftemplates.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Ftemplates.py?ref=baae4b818778180fedfcfcfc7aa77acfb9b237fb",
            "patch": "@@ -8,8 +8,6 @@\n import stat\n import sys\n import tempfile\n-import codecs\n-\n try:\n     from urllib.request import urlretrieve\n except ImportError:     # Python 2\n@@ -156,12 +154,14 @@ def handle(self, app_or_project, name, target=None, **options):\n \n                 # Only render the Python files, as we don't want to\n                 # accidentally render Django templates files\n-                with codecs.open(old_path, 'r', 'utf-8') as template_file:\n+                with open(old_path, 'rb') as template_file:\n                     content = template_file.read()\n                 if filename.endswith(extensions) or filename in extra_files:\n+                    content = content.decode('utf-8')\n                     template = Template(content)\n                     content = template.render(context)\n-                with codecs.open(new_path, 'w', 'utf-8') as new_file:\n+                    content = content.encode('utf-8')\n+                with open(new_path, 'wb') as new_file:\n                     new_file.write(content)\n \n                 if self.verbosity >= 2:"
        },
        {
            "sha": "1db49645b557569b7cd290a84eaf8048cc052ad0",
            "filename": "tests/regressiontests/admin_scripts/custom_templates/project_template/ticket-19397-binary-file.ico",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/baae4b818778180fedfcfcfc7aa77acfb9b237fb/tests%2Fregressiontests%2Fadmin_scripts%2Fcustom_templates%2Fproject_template%2Fticket-19397-binary-file.ico",
            "raw_url": "https://github.com/django/django/raw/baae4b818778180fedfcfcfc7aa77acfb9b237fb/tests%2Fregressiontests%2Fadmin_scripts%2Fcustom_templates%2Fproject_template%2Fticket-19397-binary-file.ico",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_scripts%2Fcustom_templates%2Fproject_template%2Fticket-19397-binary-file.ico?ref=baae4b818778180fedfcfcfc7aa77acfb9b237fb"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
    }
}