{
    "author": "jphalip",
    "message": "Fixed #18550 -- Ensured that the admin history view works with escaped primary keys.\nThanks to josh.oosterman for the report and patch.",
    "sha": "2cd4cf58d32c5d4b163a466f608dff31bac66b87",
    "files": [
        {
            "sha": "665e3f76b824b0ef7a9959d419d18beacb3cd183",
            "filename": "django/contrib/admin/options.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/2cd4cf58d32c5d4b163a466f608dff31bac66b87/django%2Fcontrib%2Fadmin%2Foptions.py",
            "raw_url": "https://github.com/django/django/raw/2cd4cf58d32c5d4b163a466f608dff31bac66b87/django%2Fcontrib%2Fadmin%2Foptions.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Foptions.py?ref=2cd4cf58d32c5d4b163a466f608dff31bac66b87",
            "patch": "@@ -1321,7 +1321,7 @@ def history_view(self, request, object_id, extra_context=None):\n         opts = model._meta\n         app_label = opts.app_label\n         action_list = LogEntry.objects.filter(\n-            object_id = object_id,\n+            object_id = unquote(object_id),\n             content_type__id__exact = ContentType.objects.get_for_model(model).id\n         ).select_related().order_by('action_time')\n         # If no history was found, see whether this object even exists."
        },
        {
            "sha": "937b086d406a76ba5f8f8076bf95b4f3ab839baa",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/2cd4cf58d32c5d4b163a466f608dff31bac66b87/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/2cd4cf58d32c5d4b163a466f608dff31bac66b87/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=2cd4cf58d32c5d4b163a466f608dff31bac66b87",
            "patch": "@@ -1344,15 +1344,20 @@ def __init__(self, *args):\n     def setUp(self):\n         self.client.login(username='super', password='secret')\n         content_type_pk = ContentType.objects.get_for_model(ModelWithStringPrimaryKey).pk\n-        LogEntry.objects.log_action(100, content_type_pk, self.pk, self.pk, 2, change_message='')\n+        LogEntry.objects.log_action(100, content_type_pk, self.pk, self.pk, 2, change_message='Changed something')\n \n     def tearDown(self):\n         self.client.logout()\n \n     def test_get_history_view(self):\n-        \"Retrieving the history for the object using urlencoded form of primary key should work\"\n+        \"\"\"\n+        Retrieving the history for an object using urlencoded form of primary\n+        key should work.\n+        Refs #12349, #18550.\n+        \"\"\"\n         response = self.client.get('/test_admin/admin/admin_views/modelwithstringprimarykey/%s/history/' % quote(self.pk))\n         self.assertContains(response, escape(self.pk))\n+        self.assertContains(response, 'Changed something')\n         self.assertEqual(response.status_code, 200)\n \n     def test_get_change_view(self):"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 8,
        "deletions": 3
    }
}