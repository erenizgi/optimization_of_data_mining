{
    "author": "freakboy3742",
    "message": "Fixed #15026 -- Added cleanup to the invalid key session tests; when using Memcached as a cache backend, the cache-backed session backends would fail on the second run due to leftover cache artefacts. Thanks to jsdalton for the report and patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15235 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "993612c84d3c04c516486a99fa813cec1caa5488",
    "files": [
        {
            "sha": "9b669211db24217d8c3063ebdb4e35a2d62126f9",
            "filename": "django/contrib/sessions/tests.py",
            "status": "modified",
            "additions": 10,
            "deletions": 5,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/993612c84d3c04c516486a99fa813cec1caa5488/django%2Fcontrib%2Fsessions%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/993612c84d3c04c516486a99fa813cec1caa5488/django%2Fcontrib%2Fsessions%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Ftests.py?ref=993612c84d3c04c516486a99fa813cec1caa5488",
            "patch": "@@ -160,11 +160,16 @@ def test_cycle(self):\n     def test_invalid_key(self):\n         # Submitting an invalid session key (either by guessing, or if the db has\n         # removed the key) results in a new key being generated.\n-        session = self.backend('1')\n-        session.save()\n-        self.assertNotEqual(session.session_key, '1')\n-        self.assertEqual(session.get('cat'), None)\n-        session.delete()\n+        try:\n+            session = self.backend('1')\n+            session.save()\n+            self.assertNotEqual(session.session_key, '1')\n+            self.assertEqual(session.get('cat'), None)\n+            session.delete()\n+        finally:\n+            # Some backends leave a stale cache entry for the invalid\n+            # session key; make sure that entry is manually deleted\n+            session.delete('1')\n \n     # Custom session expiry\n     def test_default_expiry(self):"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 10,
        "deletions": 5
    }
}