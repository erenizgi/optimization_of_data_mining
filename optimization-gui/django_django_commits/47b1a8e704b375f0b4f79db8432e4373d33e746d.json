{
    "author": "jezdez",
    "message": "Fixed #12988 -- Extended regular expression of the URLValidator to fully support IDN-URLs, especially the long TLDs.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15502 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "47b1a8e704b375f0b4f79db8432e4373d33e746d",
    "files": [
        {
            "sha": "233c0886aced568f0dc0d0ecb25c03b120413f89",
            "filename": "django/core/validators.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/47b1a8e704b375f0b4f79db8432e4373d33e746d/django%2Fcore%2Fvalidators.py",
            "raw_url": "https://github.com/django/django/raw/47b1a8e704b375f0b4f79db8432e4373d33e746d/django%2Fcore%2Fvalidators.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fvalidators.py?ref=47b1a8e704b375f0b4f79db8432e4373d33e746d",
            "patch": "@@ -46,7 +46,7 @@ def get_method(self):\n class URLValidator(RegexValidator):\n     regex = re.compile(\n         r'^https?://' # http:// or https://\n-        r'(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+[A-Z]{2,6}\\.?|' #domain...\n+        r'(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+(?:[A-Z]{2,6}\\.?|[A-Z0-9-]{2,}\\.?)|' #domain...\n         r'localhost|' #localhost...\n         r'\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})' # ...or ip\n         r'(?::\\d+)?' # optional port"
        },
        {
            "sha": "26b1c70825ce7e18810d89ae467b04959518ab3d",
            "filename": "tests/regressiontests/forms/tests/fields.py",
            "status": "modified",
            "additions": 27,
            "deletions": 8,
            "changes": 35,
            "blob_url": "https://github.com/django/django/blob/47b1a8e704b375f0b4f79db8432e4373d33e746d/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/47b1a8e704b375f0b4f79db8432e4373d33e746d/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py?ref=47b1a8e704b375f0b4f79db8432e4373d33e746d",
            "patch": "@@ -571,13 +571,6 @@ def test_urlfield_3(self):\n             f.clean('http://google.com/we-love-microsoft.html') # good domain, bad page\n         except ValidationError, e:\n             self.assertEqual(\"[u'This URL appears to be a broken link.']\", str(e))\n-        # Valid and existent IDN\n-        self.assertEqual(u'http://\\u05e2\\u05d1\\u05e8\\u05d9\\u05ea.idn.icann.org/', f.clean(u'http://עברית.idn.icann.org/'))\n-        # Valid but non-existent IDN\n-        try:\n-            f.clean(u'http://broken.עברית.idn.icann.org/')\n-        except ValidationError, e:\n-            self.assertEqual(\"[u'This URL appears to be a broken link.']\", str(e))\n \n     def test_urlfield_4(self):\n         f = URLField(verify_exists=True, required=False)\n@@ -601,10 +594,36 @@ def test_urlfield_7(self):\n         self.assertEqual(u'http://example.com/', f.clean('http://example.com'))\n         self.assertEqual(u'http://example.com/test', f.clean('http://example.com/test'))\n \n-    def test_urlfield_ticket11826(self):\n+    def test_urlfield_8(self):\n+        # ticket #11826\n         f = URLField()\n         self.assertEqual(u'http://example.com/?some_param=some_value', f.clean('http://example.com?some_param=some_value'))\n \n+    def test_urlfield_9(self):\n+        f = URLField(verify_exists=False)\n+        urls = (\n+            u'http://עברית.idn.icann.org/',\n+            u'http://sãopaulo.com/',\n+            u'http://sãopaulo.com.br/',\n+            u'http://пример.испытание/',\n+            u'http://مثال.إختبار/',\n+            u'http://例子.测试/',\n+            u'http://例子.測試/',\n+            u'http://उदाहरण.परीक्षा/',\n+            u'http://例え.テスト/',\n+            u'http://مثال.آزمایشی/',\n+            u'http://실례.테스트/',\n+            u'http://العربية.idn.icann.org/',\n+        )\n+        for url in urls:\n+            # Valid and existent IDN\n+            self.assertEqual(url, f.clean(url))\n+        # Valid but non-existent IDN\n+        try:\n+            f.clean(u'http://broken.עברית.idn.icann.org/')\n+        except ValidationError, e:\n+            self.assertEqual(\"[u'This URL appears to be a broken link.']\", str(e))\n+\n     # BooleanField ################################################################\n \n     def test_booleanfield_1(self):"
        }
    ],
    "stats": {
        "total": 37,
        "additions": 28,
        "deletions": 9
    }
}