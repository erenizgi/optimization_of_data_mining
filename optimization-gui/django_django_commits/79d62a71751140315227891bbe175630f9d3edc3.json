{
    "author": "aaugustin",
    "message": "[py3] Added fixer for python_2_unicode_compatible.\n\nThis doesn't deal with classes that define both __unicode__ and\n__str__; the definition of __str__ should be removed first. It\ndoesn't guarantee that __str__ will return a str (rather than bytes)\nunder Python 3 either.",
    "sha": "79d62a71751140315227891bbe175630f9d3edc3",
    "files": [
        {
            "sha": "35566abb943cef11911065fd1922e81b706c538e",
            "filename": "django/bin/django-2to3.py",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/79d62a71751140315227891bbe175630f9d3edc3/django%2Fbin%2Fdjango-2to3.py",
            "raw_url": "https://github.com/django/django/raw/79d62a71751140315227891bbe175630f9d3edc3/django%2Fbin%2Fdjango-2to3.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fbin%2Fdjango-2to3.py?ref=79d62a71751140315227891bbe175630f9d3edc3",
            "patch": "@@ -0,0 +1,10 @@\n+#!/usr/bin/env python\n+\n+# This works exactly like 2to3, except that it uses Django's fixers rather\n+# than 2to3's built-in fixers.\n+\n+import sys\n+from lib2to3.main import main\n+\n+sys.exit(main(\"django.utils.2to3_fixes\"))\n+"
        },
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "django/utils/2to3_fixes/__init__.py",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/79d62a71751140315227891bbe175630f9d3edc3/django%2Futils%2F2to3_fixes%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/79d62a71751140315227891bbe175630f9d3edc3/django%2Futils%2F2to3_fixes%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2F2to3_fixes%2F__init__.py?ref=79d62a71751140315227891bbe175630f9d3edc3"
        },
        {
            "sha": "613734ca867d9ec9f5c1d5a903d7dc9c73e83884",
            "filename": "django/utils/2to3_fixes/fix_unicode.py",
            "status": "added",
            "additions": 36,
            "deletions": 0,
            "changes": 36,
            "blob_url": "https://github.com/django/django/blob/79d62a71751140315227891bbe175630f9d3edc3/django%2Futils%2F2to3_fixes%2Ffix_unicode.py",
            "raw_url": "https://github.com/django/django/raw/79d62a71751140315227891bbe175630f9d3edc3/django%2Futils%2F2to3_fixes%2Ffix_unicode.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2F2to3_fixes%2Ffix_unicode.py?ref=79d62a71751140315227891bbe175630f9d3edc3",
            "patch": "@@ -0,0 +1,36 @@\n+\"\"\"Fixer for __unicode__ methods.\n+\n+Uses the django.utils.encoding.python_2_unicode_compatible decorator.\n+\"\"\"\n+\n+from __future__ import unicode_literals\n+\n+from lib2to3 import fixer_base\n+from lib2to3.fixer_util import find_indentation, Name, syms, touch_import\n+from lib2to3.pgen2 import token\n+from lib2to3.pytree import Leaf, Node\n+\n+\n+class FixUnicode(fixer_base.BaseFix):\n+\n+    BM_compatible = True\n+    PATTERN = \"\"\"\n+    classdef< 'class' any+ ':'\n+              suite< any*\n+                     funcdef< 'def' unifunc='__unicode__'\n+                              parameters< '(' NAME ')' > any+ >\n+                     any* > >\n+    \"\"\"\n+\n+    def transform(self, node, results):\n+        unifunc = results[\"unifunc\"]\n+        strfunc = Name(\"__str__\", prefix=unifunc.prefix)\n+        unifunc.replace(strfunc)\n+\n+        klass = node.clone()\n+        klass.prefix = '\\n' + find_indentation(node)\n+        decorator = Node(syms.decorator, [Leaf(token.AT, \"@\"), Name('python_2_unicode_compatible')])\n+        decorated = Node(syms.decorated, [decorator, klass], prefix=node.prefix)\n+        node.replace(decorated)\n+\n+        touch_import('django.utils.encoding', 'python_2_unicode_compatible', decorated)"
        }
    ],
    "stats": {
        "total": 46,
        "additions": 46,
        "deletions": 0
    }
}