{
    "author": "jdunck",
    "message": "Fixed #18980 -- Fixed assertContains regression when passed an object",
    "sha": "40e62a5ccd08f241e977c9ffcb96005b9f2d95e6",
    "files": [
        {
            "sha": "d37be58a71ceb338b3fccfa94550795a1de0c0d9",
            "filename": "django/test/testcases.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/40e62a5ccd08f241e977c9ffcb96005b9f2d95e6/django%2Ftest%2Ftestcases.py",
            "raw_url": "https://github.com/django/django/raw/40e62a5ccd08f241e977c9ffcb96005b9f2d95e6/django%2Ftest%2Ftestcases.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftest%2Ftestcases.py?ref=40e62a5ccd08f241e977c9ffcb96005b9f2d95e6",
            "patch": "@@ -647,6 +647,7 @@ def assertContains(self, response, text, count=None, status_code=200,\n         self.assertEqual(response.status_code, status_code,\n             msg_prefix + \"Couldn't retrieve content: Response code was %d\"\n             \" (expected %d)\" % (response.status_code, status_code))\n+        text = force_text(text, encoding=response._charset)\n         content = response.content.decode(response._charset)\n         if html:\n             content = assert_and_parse_html(self, content, None,\n@@ -682,6 +683,7 @@ def assertNotContains(self, response, text, status_code=200,\n         self.assertEqual(response.status_code, status_code,\n             msg_prefix + \"Couldn't retrieve content: Response code was %d\"\n             \" (expected %d)\" % (response.status_code, status_code))\n+        text = force_text(text, encoding=response._charset)\n         content = response.content.decode(response._charset)\n         if html:\n             content = assert_and_parse_html(self, content, None,"
        },
        {
            "sha": "9deb8a4755bdb94d1fbda47f21e94ba714f46058",
            "filename": "tests/regressiontests/test_client_regress/tests.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/40e62a5ccd08f241e977c9ffcb96005b9f2d95e6/tests%2Fregressiontests%2Ftest_client_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/40e62a5ccd08f241e977c9ffcb96005b9f2d95e6/tests%2Fregressiontests%2Ftest_client_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftest_client_regress%2Ftests.py?ref=40e62a5ccd08f241e977c9ffcb96005b9f2d95e6",
            "patch": "@@ -16,6 +16,7 @@\n from django.test.client import encode_file, RequestFactory\n from django.test.utils import ContextList, override_settings, str_prefix\n from django.template.response import SimpleTemplateResponse\n+from django.utils.translation import ugettext_lazy\n from django.http import HttpResponse\n \n \n@@ -129,6 +130,14 @@ def test_unicode_not_contains(self):\n         self.assertNotContains(r, 'はたけ')\n         self.assertNotContains(r, b'\\xe3\\x81\\xaf\\xe3\\x81\\x9f\\xe3\\x81\\x91'.decode('utf-8'))\n \n+    def test_nontext_contains(self):\n+        r = self.client.get('/test_client_regress/no_template_view/')\n+        self.assertContains(r, ugettext_lazy('once'))\n+\n+    def test_nontext_not_contains(self):\n+        r = self.client.get('/test_client_regress/no_template_view/')\n+        self.assertNotContains(r, ugettext_lazy('never'))\n+\n     def test_assert_contains_renders_template_response(self):\n         \"\"\" Test that we can pass in an unrendered SimpleTemplateReponse\n             without throwing an error."
        }
    ],
    "stats": {
        "total": 11,
        "additions": 11,
        "deletions": 0
    }
}