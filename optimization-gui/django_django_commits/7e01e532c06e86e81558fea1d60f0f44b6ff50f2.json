{
    "author": "aaugustin",
    "message": "[py3] Ported django.utils.feedgenerator.",
    "sha": "7e01e532c06e86e81558fea1d60f0f44b6ff50f2",
    "files": [
        {
            "sha": "f9126a67829c10dd43384c57ccb528f2572446c1",
            "filename": "django/utils/feedgenerator.py",
            "status": "modified",
            "additions": 15,
            "deletions": 10,
            "changes": 25,
            "blob_url": "https://github.com/django/django/blob/7e01e532c06e86e81558fea1d60f0f44b6ff50f2/django%2Futils%2Ffeedgenerator.py",
            "raw_url": "https://github.com/django/django/raw/7e01e532c06e86e81558fea1d60f0f44b6ff50f2/django%2Futils%2Ffeedgenerator.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ffeedgenerator.py?ref=7e01e532c06e86e81558fea1d60f0f44b6ff50f2",
            "patch": "@@ -31,6 +31,8 @@\n from django.utils.xmlutils import SimplerXMLGenerator\n from django.utils.encoding import force_text, iri_to_uri\n from django.utils import datetime_safe\n+from django.utils import six\n+from django.utils.six import StringIO\n from django.utils.timezone import is_aware\n \n def rfc2822_date(date):\n@@ -44,25 +46,29 @@ def rfc2822_date(date):\n     dow = days[date.weekday()]\n     month = months[date.month - 1]\n     time_str = date.strftime('%s, %%d %s %%Y %%H:%%M:%%S ' % (dow, month))\n+    if not six.PY3:             # strftime returns a byte string in Python 2\n+        time_str = time_str.decode('utf-8')\n     if is_aware(date):\n         offset = date.tzinfo.utcoffset(date)\n         timezone = (offset.days * 24 * 60) + (offset.seconds // 60)\n         hour, minute = divmod(timezone, 60)\n-        return time_str + \"%+03d%02d\" % (hour, minute)\n+        return time_str + '%+03d%02d' % (hour, minute)\n     else:\n         return time_str + '-0000'\n \n def rfc3339_date(date):\n     # Support datetime objects older than 1900\n     date = datetime_safe.new_datetime(date)\n+    time_str = date.strftime('%Y-%m-%dT%H:%M:%S')\n+    if not six.PY3:             # strftime returns a byte string in Python 2\n+        time_str = time_str.decode('utf-8')\n     if is_aware(date):\n-        time_str = date.strftime('%Y-%m-%dT%H:%M:%S')\n         offset = date.tzinfo.utcoffset(date)\n         timezone = (offset.days * 24 * 60) + (offset.seconds // 60)\n         hour, minute = divmod(timezone, 60)\n-        return time_str + \"%+03d:%02d\" % (hour, minute)\n+        return time_str + '%+03d:%02d' % (hour, minute)\n     else:\n-        return date.strftime('%Y-%m-%dT%H:%M:%SZ')\n+        return time_str + 'Z'\n \n def get_tag_uri(url, date):\n     \"\"\"\n@@ -178,8 +184,7 @@ def writeString(self, encoding):\n         \"\"\"\n         Returns the feed in the given encoding as a string.\n         \"\"\"\n-        from io import BytesIO\n-        s = BytesIO()\n+        s = StringIO()\n         self.write(s, encoding)\n         return s.getvalue()\n \n@@ -237,7 +242,7 @@ def add_root_elements(self, handler):\n             handler.addQuickElement(\"category\", cat)\n         if self.feed['feed_copyright'] is not None:\n             handler.addQuickElement(\"copyright\", self.feed['feed_copyright'])\n-        handler.addQuickElement(\"lastBuildDate\", rfc2822_date(self.latest_post_date()).decode('utf-8'))\n+        handler.addQuickElement(\"lastBuildDate\", rfc2822_date(self.latest_post_date()))\n         if self.feed['ttl'] is not None:\n             handler.addQuickElement(\"ttl\", self.feed['ttl'])\n \n@@ -271,7 +276,7 @@ def add_item_elements(self, handler, item):\n             handler.addQuickElement(\"dc:creator\", item[\"author_name\"], {\"xmlns:dc\": \"http://purl.org/dc/elements/1.1/\"})\n \n         if item['pubdate'] is not None:\n-            handler.addQuickElement(\"pubDate\", rfc2822_date(item['pubdate']).decode('utf-8'))\n+            handler.addQuickElement(\"pubDate\", rfc2822_date(item['pubdate']))\n         if item['comments'] is not None:\n             handler.addQuickElement(\"comments\", item['comments'])\n         if item['unique_id'] is not None:\n@@ -314,7 +319,7 @@ def add_root_elements(self, handler):\n         if self.feed['feed_url'] is not None:\n             handler.addQuickElement(\"link\", \"\", {\"rel\": \"self\", \"href\": self.feed['feed_url']})\n         handler.addQuickElement(\"id\", self.feed['id'])\n-        handler.addQuickElement(\"updated\", rfc3339_date(self.latest_post_date()).decode('utf-8'))\n+        handler.addQuickElement(\"updated\", rfc3339_date(self.latest_post_date()))\n         if self.feed['author_name'] is not None:\n             handler.startElement(\"author\", {})\n             handler.addQuickElement(\"name\", self.feed['author_name'])\n@@ -340,7 +345,7 @@ def add_item_elements(self, handler, item):\n         handler.addQuickElement(\"title\", item['title'])\n         handler.addQuickElement(\"link\", \"\", {\"href\": item['link'], \"rel\": \"alternate\"})\n         if item['pubdate'] is not None:\n-            handler.addQuickElement(\"updated\", rfc3339_date(item['pubdate']).decode('utf-8'))\n+            handler.addQuickElement(\"updated\", rfc3339_date(item['pubdate']))\n \n         # Author information.\n         if item['author_name'] is not None:"
        }
    ],
    "stats": {
        "total": 25,
        "additions": 15,
        "deletions": 10
    }
}