{
    "author": "ramiro",
    "message": "Fixed #16644 -- Fixed one additional test that was failing in Oracle due to false assumptions about the primary keys of objects. Thanks Aymeric Augustin for report and patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16636 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "4df45418f2b27dde75364ab5803ebbc4b0cc9c0a",
    "files": [
        {
            "sha": "09a9d3f591a2a4701ba0e4d57648e7aa7388f50c",
            "filename": "tests/modeltests/model_forms/tests.py",
            "status": "modified",
            "additions": 76,
            "deletions": 75,
            "changes": 151,
            "blob_url": "https://github.com/django/django/blob/4df45418f2b27dde75364ab5803ebbc4b0cc9c0a/tests%2Fmodeltests%2Fmodel_forms%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/4df45418f2b27dde75364ab5803ebbc4b0cc9c0a/tests%2Fmodeltests%2Fmodel_forms%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fmodel_forms%2Ftests.py?ref=4df45418f2b27dde75364ab5803ebbc4b0cc9c0a",
            "patch": "@@ -658,21 +658,21 @@ def test_with_data(self):\n <tr><th>Pub date:</th><td><input type=\"text\" name=\"pub_date\" /></td></tr>\n <tr><th>Writer:</th><td><select name=\"writer\">\n <option value=\"\" selected=\"selected\">---------</option>\n-<option value=\"2\">Bob Woodward</option>\n-<option value=\"1\">Mike Royko</option>\n+<option value=\"%s\">Bob Woodward</option>\n+<option value=\"%s\">Mike Royko</option>\n </select></td></tr>\n <tr><th>Article:</th><td><textarea rows=\"10\" cols=\"40\" name=\"article\"></textarea></td></tr>\n <tr><th>Categories:</th><td><select multiple=\"multiple\" name=\"categories\">\n-<option value=\"1\">Entertainment</option>\n-<option value=\"2\">It&#39;s a test</option>\n-<option value=\"3\">Third test</option>\n+<option value=\"%s\">Entertainment</option>\n+<option value=\"%s\">It&#39;s a test</option>\n+<option value=\"%s\">Third test</option>\n </select><br /><span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></td></tr>\n <tr><th>Status:</th><td><select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n-</select></td></tr>''')\n+</select></td></tr>''' % (w_woodward.pk, w_royko.pk, c1.pk, c2.pk, c3.pk))\n \n         # You can restrict a form to a subset of the complete list of fields\n         # by providing a 'fields' argument. If you try to save a\n@@ -706,21 +706,21 @@ def test_with_data(self):\n <li>Pub date: <input type=\"text\" name=\"pub_date\" value=\"1988-01-04\" /></li>\n <li>Writer: <select name=\"writer\">\n <option value=\"\">---------</option>\n-<option value=\"2\">Bob Woodward</option>\n-<option value=\"1\" selected=\"selected\">Mike Royko</option>\n+<option value=\"%s\">Bob Woodward</option>\n+<option value=\"%s\" selected=\"selected\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\">Hello.</textarea></li>\n <li>Categories: <select multiple=\"multiple\" name=\"categories\">\n-<option value=\"1\">Entertainment</option>\n-<option value=\"2\">It&#39;s a test</option>\n-<option value=\"3\">Third test</option>\n+<option value=\"%s\">Entertainment</option>\n+<option value=\"%s\">It&#39;s a test</option>\n+<option value=\"%s\">Third test</option>\n </select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n <li>Status: <select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n-</select></li>''')\n+</select></li>''' % (w_woodward.pk, w_royko.pk, c1.pk, c2.pk, c3.pk))\n         f = TestArticleForm({\n                 'headline': u'Test headline',\n                 'slug': 'test-headline',\n@@ -760,21 +760,21 @@ def test_with_data(self):\n <li>Pub date: <input type=\"text\" name=\"pub_date\" value=\"1988-01-04\" /></li>\n <li>Writer: <select name=\"writer\">\n <option value=\"\">---------</option>\n-<option value=\"2\">Bob Woodward</option>\n-<option value=\"1\" selected=\"selected\">Mike Royko</option>\n+<option value=\"%s\">Bob Woodward</option>\n+<option value=\"%s\" selected=\"selected\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\">Hello.</textarea></li>\n <li>Categories: <select multiple=\"multiple\" name=\"categories\">\n-<option value=\"1\" selected=\"selected\">Entertainment</option>\n-<option value=\"2\">It&#39;s a test</option>\n-<option value=\"3\">Third test</option>\n+<option value=\"%s\" selected=\"selected\">Entertainment</option>\n+<option value=\"%s\">It&#39;s a test</option>\n+<option value=\"%s\">Third test</option>\n </select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n <li>Status: <select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n-</select></li>''')\n+</select></li>''' % (w_woodward.pk, w_royko.pk, c1.pk, c2.pk, c3.pk))\n \n         # Initial values can be provided for model forms\n         f = TestArticleForm(\n@@ -788,21 +788,21 @@ def test_with_data(self):\n <li>Pub date: <input type=\"text\" name=\"pub_date\" /></li>\n <li>Writer: <select name=\"writer\">\n <option value=\"\" selected=\"selected\">---------</option>\n-<option value=\"2\">Bob Woodward</option>\n-<option value=\"1\">Mike Royko</option>\n+<option value=\"%s\">Bob Woodward</option>\n+<option value=\"%s\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\"></textarea></li>\n <li>Categories: <select multiple=\"multiple\" name=\"categories\">\n-<option value=\"1\" selected=\"selected\">Entertainment</option>\n-<option value=\"2\" selected=\"selected\">It&#39;s a test</option>\n-<option value=\"3\">Third test</option>\n+<option value=\"%s\" selected=\"selected\">Entertainment</option>\n+<option value=\"%s\" selected=\"selected\">It&#39;s a test</option>\n+<option value=\"%s\">Third test</option>\n </select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n <li>Status: <select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n-</select></li>''')\n+</select></li>''' % (w_woodward.pk, w_royko.pk, c1.pk, c2.pk, c3.pk))\n \n         f = TestArticleForm({\n                 'headline': u'New headline',\n@@ -882,57 +882,58 @@ def test_with_data(self):\n <li>Pub date: <input type=\"text\" name=\"pub_date\" /></li>\n <li>Writer: <select name=\"writer\">\n <option value=\"\" selected=\"selected\">---------</option>\n-<option value=\"2\">Bob Woodward</option>\n-<option value=\"1\">Mike Royko</option>\n+<option value=\"%s\">Bob Woodward</option>\n+<option value=\"%s\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\"></textarea></li>\n <li>Categories: <select multiple=\"multiple\" name=\"categories\">\n-<option value=\"1\">Entertainment</option>\n-<option value=\"2\">It&#39;s a test</option>\n-<option value=\"3\">Third</option>\n+<option value=\"%s\">Entertainment</option>\n+<option value=\"%s\">It&#39;s a test</option>\n+<option value=\"%s\">Third</option>\n </select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n <li>Status: <select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n-</select></li>''')\n+</select></li>''' % (w_woodward.pk, w_royko.pk, c1.pk, c2.pk, c3.pk))\n \n         c4 = Category.objects.create(name='Fourth', url='4th')\n         self.assertEqual(c4.name, 'Fourth')\n-        self.assertEqual(Writer.objects.create(name='Carl Bernstein').name, 'Carl Bernstein')\n+        w_bernstein = Writer.objects.create(name='Carl Bernstein')\n+        self.assertEqual(w_bernstein.name, 'Carl Bernstein')\n         self.assertEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" maxlength=\"50\" /></li>\n <li>Slug: <input type=\"text\" name=\"slug\" maxlength=\"50\" /></li>\n <li>Pub date: <input type=\"text\" name=\"pub_date\" /></li>\n <li>Writer: <select name=\"writer\">\n <option value=\"\" selected=\"selected\">---------</option>\n-<option value=\"2\">Bob Woodward</option>\n-<option value=\"3\">Carl Bernstein</option>\n-<option value=\"1\">Mike Royko</option>\n+<option value=\"%s\">Bob Woodward</option>\n+<option value=\"%s\">Carl Bernstein</option>\n+<option value=\"%s\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\"></textarea></li>\n <li>Categories: <select multiple=\"multiple\" name=\"categories\">\n-<option value=\"1\">Entertainment</option>\n-<option value=\"2\">It&#39;s a test</option>\n-<option value=\"3\">Third</option>\n-<option value=\"4\">Fourth</option>\n+<option value=\"%s\">Entertainment</option>\n+<option value=\"%s\">It&#39;s a test</option>\n+<option value=\"%s\">Third</option>\n+<option value=\"%s\">Fourth</option>\n </select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n <li>Status: <select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n-</select></li>''')\n+</select></li>''' % (w_woodward.pk, w_bernstein.pk, w_royko.pk, c1.pk, c2.pk, c3.pk, c4.pk))\n \n         # ModelChoiceField ############################################################\n \n         f = forms.ModelChoiceField(Category.objects.all())\n         self.assertEqual(list(f.choices), [\n             (u'', u'---------'),\n-            (1, u'Entertainment'),\n-            (2, u\"It's a test\"),\n-            (3, u'Third'),\n-            (4, u'Fourth')])\n+            (c1.pk, u'Entertainment'),\n+            (c2.pk, u\"It's a test\"),\n+            (c3.pk, u'Third'),\n+            (c4.pk, u'Fourth')])\n         with self.assertRaises(ValidationError):\n             f.clean('')\n         with self.assertRaises(ValidationError):\n@@ -967,41 +968,41 @@ def test_with_data(self):\n         f.queryset = Category.objects.exclude(name='Fourth')\n         self.assertEqual(list(f.choices), [\n             (u'', u'---------'),\n-            (1, u'Entertainment'),\n-            (2, u\"It's a test\"),\n-            (3, u'Third')])\n+            (c1.pk, u'Entertainment'),\n+            (c2.pk, u\"It's a test\"),\n+            (c3.pk, u'Third')])\n         self.assertEqual(f.clean(c3.id).name, 'Third')\n         with self.assertRaises(ValidationError):\n             f.clean(c4.id)\n \n         # check that we can safely iterate choices repeatedly\n         gen_one = list(f.choices)\n         gen_two = f.choices\n-        self.assertEqual(gen_one[2], (2, u\"It's a test\"))\n+        self.assertEqual(gen_one[2], (c2.pk, u\"It's a test\"))\n         self.assertEqual(list(gen_two), [\n             (u'', u'---------'),\n-            (1, u'Entertainment'),\n-            (2, u\"It's a test\"),\n-            (3, u'Third')])\n+            (c1.pk, u'Entertainment'),\n+            (c2.pk, u\"It's a test\"),\n+            (c3.pk, u'Third')])\n \n         # check that we can override the label_from_instance method to print custom labels (#4620)\n         f.queryset = Category.objects.all()\n         f.label_from_instance = lambda obj: \"category \" + str(obj)\n         self.assertEqual(list(f.choices), [\n             (u'', u'---------'),\n-            (1, 'category Entertainment'),\n-            (2, \"category It's a test\"),\n-            (3, 'category Third'),\n-            (4, 'category Fourth')])\n+            (c1.pk, 'category Entertainment'),\n+            (c2.pk, \"category It's a test\"),\n+            (c3.pk, 'category Third'),\n+            (c4.pk, 'category Fourth')])\n \n         # ModelMultipleChoiceField ####################################################\n \n         f = forms.ModelMultipleChoiceField(Category.objects.all())\n         self.assertEqual(list(f.choices), [\n-            (1, u'Entertainment'),\n-            (2, u\"It's a test\"),\n-            (3, u'Third'),\n-            (4, u'Fourth')])\n+            (c1.pk, u'Entertainment'),\n+            (c2.pk, u\"It's a test\"),\n+            (c3.pk, u'Third'),\n+            (c4.pk, u'Fourth')])\n         with self.assertRaises(ValidationError):\n             f.clean(None)\n         with self.assertRaises(ValidationError):\n@@ -1046,9 +1047,9 @@ def test_with_data(self):\n         # queryset can be changed after the field is created.\n         f.queryset = Category.objects.exclude(name='Fourth')\n         self.assertEqual(list(f.choices), [\n-            (1, u'Entertainment'),\n-            (2, u\"It's a test\"),\n-            (3, u'Third')])\n+            (c1.pk, u'Entertainment'),\n+            (c2.pk, u\"It's a test\"),\n+            (c3.pk, u'Third')])\n         self.assertEqual(map(lambda o: o.name, f.clean([c3.id])), [\"Third\"])\n         with self.assertRaises(ValidationError):\n             f.clean([c4.id])\n@@ -1058,10 +1059,10 @@ def test_with_data(self):\n         f.queryset = Category.objects.all()\n         f.label_from_instance = lambda obj: \"multicategory \" + str(obj)\n         self.assertEqual(list(f.choices), [\n-            (1, 'multicategory Entertainment'),\n-            (2, \"multicategory It's a test\"),\n-            (3, 'multicategory Third'),\n-            (4, 'multicategory Fourth')])\n+            (c1.pk, 'multicategory Entertainment'),\n+            (c2.pk, \"multicategory It's a test\"),\n+            (c3.pk, 'multicategory Third'),\n+            (c4.pk, 'multicategory Fourth')])\n \n         # OneToOneField ###############################################################\n \n@@ -1082,12 +1083,12 @@ def test_with_data(self):\n         form = WriterProfileForm()\n         self.assertEqual(form.as_p(), '''<p><label for=\"id_writer\">Writer:</label> <select name=\"writer\" id=\"id_writer\">\n <option value=\"\" selected=\"selected\">---------</option>\n-<option value=\"2\">Bob Woodward</option>\n-<option value=\"3\">Carl Bernstein</option>\n-<option value=\"4\">Joe Better</option>\n-<option value=\"1\">Mike Royko</option>\n+<option value=\"%s\">Bob Woodward</option>\n+<option value=\"%s\">Carl Bernstein</option>\n+<option value=\"%s\">Joe Better</option>\n+<option value=\"%s\">Mike Royko</option>\n </select></p>\n-<p><label for=\"id_age\">Age:</label> <input type=\"text\" name=\"age\" id=\"id_age\" /></p>''')\n+<p><label for=\"id_age\">Age:</label> <input type=\"text\" name=\"age\" id=\"id_age\" /></p>''' % (w_woodward.pk, w_bernstein.pk, bw.pk, w_royko.pk))\n \n         data = {\n             'writer': unicode(w_woodward.pk),\n@@ -1100,12 +1101,12 @@ def test_with_data(self):\n         form = WriterProfileForm(instance=instance)\n         self.assertEqual(form.as_p(), '''<p><label for=\"id_writer\">Writer:</label> <select name=\"writer\" id=\"id_writer\">\n <option value=\"\">---------</option>\n-<option value=\"2\" selected=\"selected\">Bob Woodward</option>\n-<option value=\"3\">Carl Bernstein</option>\n-<option value=\"4\">Joe Better</option>\n-<option value=\"1\">Mike Royko</option>\n+<option value=\"%s\" selected=\"selected\">Bob Woodward</option>\n+<option value=\"%s\">Carl Bernstein</option>\n+<option value=\"%s\">Joe Better</option>\n+<option value=\"%s\">Mike Royko</option>\n </select></p>\n-<p><label for=\"id_age\">Age:</label> <input type=\"text\" name=\"age\" value=\"65\" id=\"id_age\" /></p>''')\n+<p><label for=\"id_age\">Age:</label> <input type=\"text\" name=\"age\" value=\"65\" id=\"id_age\" /></p>''' % (w_woodward.pk, w_bernstein.pk, bw.pk, w_royko.pk))\n \n     def test_phone_number_field(self):\n         f = PhoneNumberForm({'phone': '(312) 555-1212', 'description': 'Assistance'})"
        }
    ],
    "stats": {
        "total": 151,
        "additions": 76,
        "deletions": 75
    }
}