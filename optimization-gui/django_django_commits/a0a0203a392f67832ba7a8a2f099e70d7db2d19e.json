{
    "author": "aaugustin",
    "message": "[py3] Added python_2_unicode_compatible decorator.",
    "sha": "a0a0203a392f67832ba7a8a2f099e70d7db2d19e",
    "files": [
        {
            "sha": "7030ab1db01e4173dbba1daf73cb5c33a76f27e0",
            "filename": "django/utils/encoding.py",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/a0a0203a392f67832ba7a8a2f099e70d7db2d19e/django%2Futils%2Fencoding.py",
            "raw_url": "https://github.com/django/django/raw/a0a0203a392f67832ba7a8a2f099e70d7db2d19e/django%2Futils%2Fencoding.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fencoding.py?ref=a0a0203a392f67832ba7a8a2f099e70d7db2d19e",
            "patch": "@@ -39,6 +39,19 @@ def __str__(self):\n         def __str__(self):\n             return self.__unicode__().encode('utf-8')\n \n+def python_2_unicode_compatible(klass):\n+    \"\"\"\n+    A decorator that defines __unicode__ and __str__ methods under Python 2.\n+    Under Python 3 it does nothing.\n+\n+    To support Python 2 and 3 with a single code base, define a __str__ method\n+    returning text and apply this decorator to the class.\n+    \"\"\"\n+    if not six.PY3:\n+        klass.__unicode__ = klass.__str__\n+        klass.__str__ = lambda self: self.__unicode__().encode('utf-8')\n+    return klass\n+\n def smart_text(s, encoding='utf-8', strings_only=False, errors='strict'):\n     \"\"\"\n     Returns a text object representing 's' -- unicode on Python 2 and str on"
        },
        {
            "sha": "97643c29e998156cd0f7a605eec9c25d7ed420ce",
            "filename": "docs/ref/utils.txt",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/a0a0203a392f67832ba7a8a2f099e70d7db2d19e/docs%2Fref%2Futils.txt",
            "raw_url": "https://github.com/django/django/raw/a0a0203a392f67832ba7a8a2f099e70d7db2d19e/docs%2Fref%2Futils.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Futils.txt?ref=a0a0203a392f67832ba7a8a2f099e70d7db2d19e",
            "patch": "@@ -187,6 +187,14 @@ The functions defined in this module share the following properties:\n     Useful as a mix-in. If you support Python 2 and 3 with a single code base,\n     you can inherit this mix-in and just define ``__unicode__``.\n \n+.. function:: python_2_unicode_compatible\n+\n+    A decorator that defines ``__unicode__`` and ``__str__`` methods under\n+    Python 2. Under Python 3 it does nothing.\n+\n+    To support Python 2 and 3 with a single code base, define a ``__str__``\n+    method returning text and apply this decorator to the class.\n+\n .. function:: smart_text(s, encoding='utf-8', strings_only=False, errors='strict')\n \n     .. versionadded:: 1.5"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 21,
        "deletions": 0
    }
}