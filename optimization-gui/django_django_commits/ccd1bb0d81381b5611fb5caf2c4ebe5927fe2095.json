{
    "author": "tswicegood",
    "message": "Remove Admin's swallowing of AttributeError (#16655, #18593, #18747)\n\nDuring the new-admin changes, catching of AttributeError was added to\nthe admin.  This patch removes that as it's no longer possible to add a\nvalue to a ModelAdmin that is not available.  Adding an attribute that\ncan not be called causes an ImproperlyConfigured exception to be raised.",
    "sha": "ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095",
    "files": [
        {
            "sha": "ce435dea81858eb81b83fc9cf6c9029ee477f3fd",
            "filename": "django/contrib/admin/templatetags/admin_list.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/django%2Fcontrib%2Fadmin%2Ftemplatetags%2Fadmin_list.py",
            "raw_url": "https://github.com/django/django/raw/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/django%2Fcontrib%2Fadmin%2Ftemplatetags%2Fadmin_list.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplatetags%2Fadmin_list.py?ref=ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095",
            "patch": "@@ -182,7 +182,7 @@ def items_for_result(cl, result, form):\n         row_class = ''\n         try:\n             f, attr, value = lookup_field(field_name, result, cl.model_admin)\n-        except (AttributeError, ObjectDoesNotExist):\n+        except ObjectDoesNotExist:\n             result_repr = EMPTY_CHANGELIST_VALUE\n         else:\n             if f is None:"
        },
        {
            "sha": "fe291ebfb8ef66e7614e781d45d65d505e4e45f8",
            "filename": "tests/regressiontests/admin_views/admin.py",
            "status": "modified",
            "additions": 14,
            "deletions": 2,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/tests%2Fregressiontests%2Fadmin_views%2Fadmin.py",
            "raw_url": "https://github.com/django/django/raw/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/tests%2Fregressiontests%2Fadmin_views%2Fadmin.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Fadmin.py?ref=ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095",
            "patch": "@@ -27,11 +27,14 @@\n     Album, Question, Answer, ComplexSortedPerson, PrePopulatedPostLargeSlug,\n     AdminOrderedField, AdminOrderedModelMethod, AdminOrderedAdminMethod,\n     AdminOrderedCallable, Report, Color2, UnorderedObject, MainPrepopulated,\n-    RelatedPrepopulated, UndeletableObject)\n+    RelatedPrepopulated, UndeletableObject, Simple)\n \n \n def callable_year(dt_value):\n-    return dt_value.year\n+    try:\n+        return dt_value.year\n+    except AttributeError:\n+        return None\n callable_year.admin_order_field = 'date'\n \n \n@@ -575,6 +578,14 @@ def change_view(self, *args, **kwargs):\n         return super(UndeletableObjectAdmin, self).change_view(*args, **kwargs)\n \n \n+def callable_on_unknown(obj):\n+    return obj.unknown\n+\n+\n+class AttributeErrorRaisingAdmin(admin.ModelAdmin):\n+    list_display = [callable_on_unknown, ]\n+\n+\n site = admin.AdminSite(name=\"admin\")\n site.register(Article, ArticleAdmin)\n site.register(CustomArticle, CustomArticleAdmin)\n@@ -648,6 +659,7 @@ def change_view(self, *args, **kwargs):\n site.register(AdminOrderedAdminMethod, AdminOrderedAdminMethodAdmin)\n site.register(AdminOrderedCallable, AdminOrderedCallableAdmin)\n site.register(Color2, CustomTemplateFilterColorAdmin)\n+site.register(Simple, AttributeErrorRaisingAdmin)\n \n # Register core models we need in our tests\n from django.contrib.auth.models import User, Group"
        },
        {
            "sha": "031fb50f0f3b8d17c55753e8c45f83c08487db3a",
            "filename": "tests/regressiontests/admin_views/customadmin.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/tests%2Fregressiontests%2Fadmin_views%2Fcustomadmin.py",
            "raw_url": "https://github.com/django/django/raw/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/tests%2Fregressiontests%2Fadmin_views%2Fcustomadmin.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Fcustomadmin.py?ref=ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095",
            "patch": "@@ -49,3 +49,4 @@ def queryset(self, request):\n site.register(models.ChapterXtra1, base_admin.ChapterXtra1Admin)\n site.register(User, UserLimitedAdmin)\n site.register(models.UndeletableObject, base_admin.UndeletableObjectAdmin)\n+site.register(models.Simple, base_admin.AttributeErrorRaisingAdmin)"
        },
        {
            "sha": "2c935c05a5de1945896523d8dcecbf1028c0ac32",
            "filename": "tests/regressiontests/admin_views/models.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/tests%2Fregressiontests%2Fadmin_views%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/tests%2Fregressiontests%2Fadmin_views%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Fmodels.py?ref=ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095",
            "patch": "@@ -649,3 +649,9 @@ class UndeletableObject(models.Model):\n     Refs #10057.\n     \"\"\"\n     name = models.CharField(max_length=255)\n+\n+\n+class Simple(models.Model):\n+    \"\"\"\n+    Simple model with nothing on it for use in testing\n+    \"\"\""
        },
        {
            "sha": "9f56daa74393be95f68c477666496ce55aae5684",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 15,
            "deletions": 1,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=ccd1bb0d81381b5611fb5caf2c4ebe5927fe2095",
            "patch": "@@ -46,7 +46,7 @@\n     OtherStory, ComplexSortedPerson, Parent, Child, AdminOrderedField,\n     AdminOrderedModelMethod, AdminOrderedAdminMethod, AdminOrderedCallable,\n     Report, MainPrepopulated, RelatedPrepopulated, UnorderedObject,\n-    UndeletableObject)\n+    Simple, UndeletableObject)\n \n \n ERROR_MESSAGE = \"Please enter the correct username and password \\\n@@ -578,6 +578,20 @@ def test_change_view_with_show_delete_extra_context(self):\n                                    (self.urlbit, instance.pk))\n         self.assertNotContains(response, 'deletelink')\n \n+    def test_allows_attributeerror_to_bubble_up(self):\n+        \"\"\"\n+        Ensure that AttributeErrors are allowed to bubble when raised inside\n+        a change list view.\n+\n+        Requires a model to be created so there's something to be displayed\n+\n+        Refs: #16655, #18593, and #18747\n+        \"\"\"\n+        Simple.objects.create()\n+        with self.assertRaises(AttributeError):\n+            self.client.get('/test_admin/%s/admin_views/simple/' % self.urlbit)\n+\n+\n @override_settings(PASSWORD_HASHERS=('django.contrib.auth.hashers.SHA1PasswordHasher',))\n class AdminViewFormUrlTest(TestCase):\n     urls = \"regressiontests.admin_views.urls\""
        }
    ],
    "stats": {
        "total": 41,
        "additions": 37,
        "deletions": 4
    }
}