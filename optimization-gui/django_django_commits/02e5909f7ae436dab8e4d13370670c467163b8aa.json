{
    "author": "claudep",
    "message": "Fixed #19807 -- Sanitized getpass input in createsuperuser\n\nPython 2 getpass on Windows doesn't accept unicode, even when\ncontaining only ascii chars.\nThanks Semmel for the report and tests.",
    "sha": "02e5909f7ae436dab8e4d13370670c467163b8aa",
    "files": [
        {
            "sha": "ac2835d6b3119d16d9145f91ee67305272e24615",
            "filename": "django/contrib/auth/management/commands/createsuperuser.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/02e5909f7ae436dab8e4d13370670c467163b8aa/django%2Fcontrib%2Fauth%2Fmanagement%2Fcommands%2Fcreatesuperuser.py",
            "raw_url": "https://github.com/django/django/raw/02e5909f7ae436dab8e4d13370670c467163b8aa/django%2Fcontrib%2Fauth%2Fmanagement%2Fcommands%2Fcreatesuperuser.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fmanagement%2Fcommands%2Fcreatesuperuser.py?ref=02e5909f7ae436dab8e4d13370670c467163b8aa",
            "patch": "@@ -122,7 +122,7 @@ def handle(self, *args, **options):\n                 while password is None:\n                     if not password:\n                         password = getpass.getpass()\n-                        password2 = getpass.getpass('Password (again): ')\n+                        password2 = getpass.getpass(force_str('Password (again): '))\n                         if password != password2:\n                             self.stderr.write(\"Error: Your passwords didn't match.\")\n                             password = None"
        },
        {
            "sha": "3c7bcffc7d6af68ac123c4e12b9042a79dfeea5b",
            "filename": "django/contrib/auth/tests/basic.py",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/02e5909f7ae436dab8e4d13370670c467163b8aa/django%2Fcontrib%2Fauth%2Ftests%2Fbasic.py",
            "raw_url": "https://github.com/django/django/raw/02e5909f7ae436dab8e4d13370670c467163b8aa/django%2Fcontrib%2Fauth%2Ftests%2Fbasic.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Fbasic.py?ref=02e5909f7ae436dab8e4d13370670c467163b8aa",
            "patch": "@@ -13,7 +13,7 @@\n from django.test import TestCase\n from django.test.utils import override_settings\n from django.utils.encoding import force_str\n-from django.utils.six import StringIO\n+from django.utils.six import binary_type, StringIO\n \n \n def mock_inputs(inputs):\n@@ -24,8 +24,11 @@ def mock_inputs(inputs):\n     def inner(test_func):\n         def wrapped(*args):\n             class mock_getpass:\n-                pass\n-            mock_getpass.getpass = staticmethod(lambda p=None: inputs['password'])\n+                @staticmethod\n+                def getpass(prompt=b'Password: ', stream=None):\n+                    # getpass on Windows only supports prompt as bytestring (#19807)\n+                    assert isinstance(prompt, binary_type)\n+                    return inputs['password']\n \n             def mock_input(prompt):\n                 # prompt should be encoded in Python 2. This line will raise an"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 7,
        "deletions": 4
    }
}