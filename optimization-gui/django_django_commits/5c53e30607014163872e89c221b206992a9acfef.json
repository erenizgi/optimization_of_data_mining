{
    "author": "claudep",
    "message": "Fixed #18035 -- Removed deprecated AdminMediaHandler, as per official deprecation timeline. Thanks Jannis Leidel and Ramiro Morales for the review.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17879 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "5c53e30607014163872e89c221b206992a9acfef",
    "files": [
        {
            "sha": "24d88f7cc80405ce44cd7b6f7e8ad4c68a59a8d3",
            "filename": "django/contrib/admin/static/admin/js/SelectFilter2.js",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/django%2Fcontrib%2Fadmin%2Fstatic%2Fadmin%2Fjs%2FSelectFilter2.js",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/django%2Fcontrib%2Fadmin%2Fstatic%2Fadmin%2Fjs%2FSelectFilter2.js",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fstatic%2Fadmin%2Fjs%2FSelectFilter2.js?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -13,7 +13,7 @@ function findForm(node) {\n }\n \n window.SelectFilter = {\n-    init: function(field_id, field_name, is_stacked, admin_media_prefix) {\n+    init: function(field_id, field_name, is_stacked, admin_static_prefix) {\n         if (field_id.match(/__prefix__/)){\n             // Don't intialize on empty forms.\n             return;\n@@ -43,14 +43,14 @@ window.SelectFilter = {\n         var selector_available = quickElement('div', selector_div, '');\n         selector_available.className = 'selector-available';\n         var title_available = quickElement('h2', selector_available, interpolate(gettext('Available %s') + ' ', [field_name]));\n-        quickElement('img', title_available, '', 'src', admin_media_prefix + 'img/icon-unknown.gif', 'width', '10', 'height', '10', 'class', 'help help-tooltip', 'title', interpolate(gettext('This is the list of available %s. You may choose some by selecting them in the box below and then clicking the \"Choose\" arrow between the two boxes.'), [field_name]));\n+        quickElement('img', title_available, '', 'src', admin_static_prefix + 'img/icon-unknown.gif', 'width', '10', 'height', '10', 'class', 'help help-tooltip', 'title', interpolate(gettext('This is the list of available %s. You may choose some by selecting them in the box below and then clicking the \"Choose\" arrow between the two boxes.'), [field_name]));\n \n         var filter_p = quickElement('p', selector_available, '', 'id', field_id + '_filter');\n         filter_p.className = 'selector-filter';\n \n         var search_filter_label = quickElement('label', filter_p, '', 'for', field_id + \"_input\");\n \n-        var search_selector_img = quickElement('img', search_filter_label, '', 'src', admin_media_prefix + 'img/selector-search.gif', 'class', 'help-tooltip', 'alt', '', 'title', interpolate(gettext(\"Type into this box to filter down the list of available %s.\"), [field_name]));\n+        var search_selector_img = quickElement('img', search_filter_label, '', 'src', admin_static_prefix + 'img/selector-search.gif', 'class', 'help-tooltip', 'alt', '', 'title', interpolate(gettext(\"Type into this box to filter down the list of available %s.\"), [field_name]));\n \n         filter_p.appendChild(document.createTextNode(' '));\n \n@@ -73,7 +73,7 @@ window.SelectFilter = {\n         var selector_chosen = quickElement('div', selector_div, '');\n         selector_chosen.className = 'selector-chosen';\n         var title_chosen = quickElement('h2', selector_chosen, interpolate(gettext('Chosen %s') + ' ', [field_name]));\n-        quickElement('img', title_chosen, '', 'src', admin_media_prefix + 'img/icon-unknown.gif', 'width', '10', 'height', '10', 'class', 'help help-tooltip', 'title', interpolate(gettext('This is the list of chosen %s. You may remove some by selecting them in the box below and then clicking the \"Remove\" arrow between the two boxes.'), [field_name]));\n+        quickElement('img', title_chosen, '', 'src', admin_static_prefix + 'img/icon-unknown.gif', 'width', '10', 'height', '10', 'class', 'help help-tooltip', 'title', interpolate(gettext('This is the list of chosen %s. You may remove some by selecting them in the box below and then clicking the \"Remove\" arrow between the two boxes.'), [field_name]));\n \n         var to_box = quickElement('select', selector_chosen, '', 'id', field_id + '_to', 'multiple', 'multiple', 'size', from_box.size, 'name', from_box.getAttribute('name'));\n         to_box.className = 'filtered';"
        },
        {
            "sha": "aaffae8f5f5b19c7cefe6658e8bb9aa7a8ef0daa",
            "filename": "django/contrib/gis/admin/widgets.py",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/django%2Fcontrib%2Fgis%2Fadmin%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/django%2Fcontrib%2Fgis%2Fadmin%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fadmin%2Fwidgets.py?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -8,8 +8,7 @@\n \n # Creating a template context that contains Django settings\n # values needed by admin map templates.\n-geo_context = Context({'ADMIN_MEDIA_PREFIX' : static('admin/'),\n-                       'LANGUAGE_BIDI' : translation.get_language_bidi()})\n+geo_context = Context({'LANGUAGE_BIDI' : translation.get_language_bidi()})\n \n class OpenLayersWidget(Textarea):\n     \"\"\""
        },
        {
            "sha": "0f9e39f7c0dfc12f25b026e12879910e7c4eea4f",
            "filename": "django/contrib/staticfiles/management/commands/runserver.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/django%2Fcontrib%2Fstaticfiles%2Fmanagement%2Fcommands%2Frunserver.py",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/django%2Fcontrib%2Fstaticfiles%2Fmanagement%2Fcommands%2Frunserver.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fstaticfiles%2Fmanagement%2Fcommands%2Frunserver.py?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -1,12 +1,12 @@\n from optparse import make_option\n \n from django.conf import settings\n-from django.core.management.commands.runserver import BaseRunserverCommand\n+from django.core.management.commands.runserver import Command as RunserverCommand\n \n from django.contrib.staticfiles.handlers import StaticFilesHandler\n \n-class Command(BaseRunserverCommand):\n-    option_list = BaseRunserverCommand.option_list + (\n+class Command(RunserverCommand):\n+    option_list = RunserverCommand.option_list + (\n         make_option('--nostatic', action=\"store_false\", dest='use_static_handler', default=True,\n             help='Tells Django to NOT automatically serve static files at STATIC_URL.'),\n         make_option('--insecure', action=\"store_true\", dest='insecure_serving', default=False,"
        },
        {
            "sha": "3007d0fd307e3341319eeb4874ad94b918b1a4ef",
            "filename": "django/core/management/commands/runserver.py",
            "status": "modified",
            "additions": 4,
            "deletions": 13,
            "changes": 17,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/django%2Fcore%2Fmanagement%2Fcommands%2Frunserver.py",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/django%2Fcore%2Fmanagement%2Fcommands%2Frunserver.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Frunserver.py?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -5,7 +5,7 @@\n import socket\n \n from django.core.management.base import BaseCommand, CommandError\n-from django.core.servers.basehttp import AdminMediaHandler, run, WSGIServerException, get_internal_wsgi_application\n+from django.core.servers.basehttp import run, WSGIServerException, get_internal_wsgi_application\n from django.utils import autoreload\n \n naiveip_re = re.compile(r\"\"\"^(?:\n@@ -17,7 +17,7 @@\n DEFAULT_PORT = \"8000\"\n \n \n-class BaseRunserverCommand(BaseCommand):\n+class Command(BaseCommand):\n     option_list = BaseCommand.option_list + (\n         make_option('--ipv6', '-6', action='store_true', dest='use_ipv6', default=False,\n             help='Tells Django to use a IPv6 address.'),\n@@ -128,15 +128,6 @@ def inner_run(self, *args, **options):\n                 self.stdout.write(\"%s\\n\" % shutdown_message)\n             sys.exit(0)\n \n-class Command(BaseRunserverCommand):\n-    option_list = BaseRunserverCommand.option_list + (\n-        make_option('--adminmedia', dest='admin_media_path', default='',\n-            help='Specifies the directory from which to serve admin media.'),\n-    )\n \n-    def get_handler(self, *args, **options):\n-        \"\"\"\n-        Serves admin media like old-school (deprecation pending).\n-        \"\"\"\n-        handler = super(Command, self).get_handler(*args, **options)\n-        return AdminMediaHandler(handler, options.get('admin_media_path'))\n+# Kept for backward compatibility\n+BaseRunserverCommand = Command"
        },
        {
            "sha": "d538ce70e86f3d8227b705dc10fd7ae44cebae59",
            "filename": "django/core/servers/basehttp.py",
            "status": "modified",
            "additions": 2,
            "deletions": 48,
            "changes": 50,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/django%2Fcore%2Fservers%2Fbasehttp.py",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/django%2Fcore%2Fservers%2Fbasehttp.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fservers%2Fbasehttp.py?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -22,10 +22,6 @@\n from django.core.management.color import color_style\n from django.core.wsgi import get_wsgi_application\n from django.utils.importlib import import_module\n-from django.utils._os import safe_join\n-from django.views import static\n-\n-from django.contrib.staticfiles import handlers\n \n __all__ = ['WSGIServer', 'WSGIRequestHandler']\n \n@@ -131,7 +127,7 @@ class WSGIRequestHandler(simple_server.WSGIRequestHandler, object):\n \n     def __init__(self, *args, **kwargs):\n         from django.conf import settings\n-        self.admin_media_prefix = urlparse.urljoin(settings.STATIC_URL, 'admin/')\n+        self.admin_static_prefix = urlparse.urljoin(settings.STATIC_URL, 'admin/')\n         # We set self.path to avoid crashes in log_message() on unsupported\n         # requests (like \"OPTIONS\").\n         self.path = ''\n@@ -173,7 +169,7 @@ def get_environ(self):\n \n     def log_message(self, format, *args):\n         # Don't bother logging requests for admin images or the favicon.\n-        if (self.path.startswith(self.admin_media_prefix)\n+        if (self.path.startswith(self.admin_static_prefix)\n                 or self.path == '/favicon.ico'):\n             return\n \n@@ -200,48 +196,6 @@ def log_message(self, format, *args):\n         sys.stderr.write(msg)\n \n \n-class AdminMediaHandler(handlers.StaticFilesHandler):\n-    \"\"\"\n-    WSGI middleware that intercepts calls to the admin media directory, as\n-    defined by the STATIC_URL setting, and serves those images.\n-    Use this ONLY LOCALLY, for development! This hasn't been tested for\n-    security and is not super efficient.\n-\n-    This is pending for deprecation since 1.3.\n-    \"\"\"\n-    def get_base_dir(self):\n-        return os.path.join(django.__path__[0], 'contrib', 'admin', 'static', 'admin')\n-\n-    def get_base_url(self):\n-        from django.conf import settings\n-        return urlparse.urljoin(settings.STATIC_URL, 'admin/')\n-\n-    def file_path(self, url):\n-        \"\"\"\n-        Returns the path to the media file on disk for the given URL.\n-\n-        The passed URL is assumed to begin with ``self.base_url``.  If the\n-        resulting file path is outside the media directory, then a ValueError\n-        is raised.\n-        \"\"\"\n-        relative_url = url[len(self.base_url[2]):]\n-        relative_path = urllib.url2pathname(relative_url)\n-        return safe_join(self.base_dir, relative_path)\n-\n-    def serve(self, request):\n-        document_root, path = os.path.split(self.file_path(request.path))\n-        return static.serve(request, path, document_root=document_root)\n-\n-    def _should_handle(self, path):\n-        \"\"\"\n-        Checks if the path should be handled. Ignores the path if:\n-\n-        * the host is provided as part of the base_url\n-        * the request's path isn't under the base path\n-        \"\"\"\n-        return path.startswith(self.base_url[2]) and not self.base_url[1]\n-\n-\n def run(addr, port, wsgi_handler, ipv6=False, threading=False):\n     server_address = (addr, port)\n     if threading:"
        },
        {
            "sha": "13d4043e37c001d47f4429e4c1471f227b42c12a",
            "filename": "docs/howto/deployment/wsgi/gunicorn.txt",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/docs%2Fhowto%2Fdeployment%2Fwsgi%2Fgunicorn.txt",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/docs%2Fhowto%2Fdeployment%2Fwsgi%2Fgunicorn.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fhowto%2Fdeployment%2Fwsgi%2Fgunicorn.txt?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -58,7 +58,7 @@ This provides a few Django-specific niceties:\n * validates installed models\n \n * allows an ``--adminmedia`` option for passing in the location of the\n-  admin media files, mimicing the behavior of runserver.\n+  admin media files.\n \n See Gunicorn's `deployment documentation`_ for additional tips on starting and\n maintaining the Gunicorn server."
        },
        {
            "sha": "4d937b488b8c1a997b410978a20ddc0c8a641226",
            "filename": "docs/man/django-admin.1",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/docs%2Fman%2Fdjango-admin.1",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/docs%2Fman%2Fdjango-admin.1",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fman%2Fdjango-admin.1?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -70,7 +70,7 @@ Runs this project as a FastCGI application. Requires flup. Use\n .B runfcgi help\n for help on the KEY=val pairs.\n .TP\n-.BI \"runserver [\" \"\\-\\-noreload\" \"] [\" \"\\-\\-nothreading\" \"] [\" \"\\-\\-nostatic\" \"] [\" \"\\-\\-insecure\" \"] [\" \"\\-\\-ipv6\" \"] [\" \"\\-\\-adminmedia=ADMIN_MEDIA_PATH\" \"] [\" \"port|ipaddr:port\" \"]\"\n+.BI \"runserver [\" \"\\-\\-noreload\" \"] [\" \"\\-\\-nothreading\" \"] [\" \"\\-\\-nostatic\" \"] [\" \"\\-\\-insecure\" \"] [\" \"\\-\\-ipv6\" \"] [\" \"port|ipaddr:port\" \"]\"\n Starts a lightweight Web server for development.\n .TP\n .BI \"shell [\" \"\\-\\-plain\" \"]\"\n@@ -169,9 +169,6 @@ Enables IPv6 addresses.\n .I \\-\\-verbosity=VERBOSITY\n Verbosity level: 0=minimal output, 1=normal output, 2=all output.\n .TP\n-.I \\-\\-adminmedia=ADMIN_MEDIA_PATH\n-Specifies the directory from which to serve admin media when using the development server.\n-.TP\n .I \\-\\-traceback\n By default, django-admin.py will show a simple error message whenever an\n error occurs. If you specify this option, django-admin.py  will"
        },
        {
            "sha": "63e471df0e7d8650295e71420e8d131759993cf7",
            "filename": "docs/ref/django-admin.txt",
            "status": "modified",
            "additions": 1,
            "deletions": 13,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/docs%2Fref%2Fdjango-admin.txt",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/docs%2Fref%2Fdjango-admin.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fdjango-admin.txt?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -655,23 +655,11 @@ You can provide an IPv6 address surrounded by brackets\n \n A hostname containing ASCII-only characters can also be used.\n \n-.. django-admin-option:: --adminmedia\n-\n-Use the ``--adminmedia`` option to tell Django where to find the various CSS\n-and JavaScript files for the Django admin interface. Normally, the development\n-server serves these files out of the Django source tree magically, but you'd\n-want to use this if you made any changes to those files for your own site.\n-\n-Example usage::\n-\n-    django-admin.py runserver --adminmedia=/tmp/new-admin-style/\n-\n .. versionchanged:: 1.3\n \n If the :doc:`staticfiles</ref/contrib/staticfiles>` contrib app is enabled\n (default in new projects) the :djadmin:`runserver` command will be overriden\n-with an own :djadmin:`runserver<staticfiles-runserver>` command which doesn't\n-have the :djadminopt:`--adminmedia` option due to deprecation.\n+with an own :djadmin:`runserver<staticfiles-runserver>` command.\n \n .. django-admin-option:: --noreload\n "
        },
        {
            "sha": "4c4edbbb711eb79d954dff1ccdb4ab2cc9f00864",
            "filename": "tests/regressiontests/admin_scripts/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/tests%2Fregressiontests%2Fadmin_scripts%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/tests%2Fregressiontests%2Fadmin_scripts%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_scripts%2Ftests.py?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -1095,12 +1095,12 @@ def test_liveserver(self):\n \n class ManageRunserver(AdminScriptTestCase):\n     def setUp(self):\n-        from django.core.management.commands.runserver import BaseRunserverCommand\n+        from django.core.management.commands.runserver import Command\n \n         def monkey_run(*args, **options):\n             return\n \n-        self.cmd = BaseRunserverCommand()\n+        self.cmd = Command()\n         self.cmd.run = monkey_run\n \n     def assertServerSettings(self, addr, port, ipv6=None, raw_ipv6=False):"
        },
        {
            "sha": "c1116ba35a2c7f2de14cc8cc6b92c1fecf17d27b",
            "filename": "tests/regressiontests/admin_widgets/tests.py",
            "status": "modified",
            "additions": 10,
            "deletions": 10,
            "changes": 20,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -20,8 +20,8 @@\n from .widgetadmin import site as widget_admin_site\n \n \n-admin_media_prefix = lambda: {\n-    'ADMIN_MEDIA_PREFIX': \"%sadmin/\" % settings.STATIC_URL,\n+admin_static_prefix = lambda: {\n+    'ADMIN_STATIC_PREFIX': \"%sadmin/\" % settings.STATIC_URL,\n }\n \n class AdminFormfieldForDBFieldTests(TestCase):\n@@ -196,14 +196,14 @@ def test_render(self):\n         w = widgets.FilteredSelectMultiple('test', False)\n         self.assertHTMLEqual(\n             conditional_escape(w.render('test', 'test')),\n-            '<select multiple=\"multiple\" name=\"test\" class=\"selectfilter\">\\n</select><script type=\"text/javascript\">addEvent(window, \"load\", function(e) {SelectFilter.init(\"id_test\", \"test\", 0, \"%(ADMIN_MEDIA_PREFIX)s\"); });</script>\\n' % admin_media_prefix()\n+            '<select multiple=\"multiple\" name=\"test\" class=\"selectfilter\">\\n</select><script type=\"text/javascript\">addEvent(window, \"load\", function(e) {SelectFilter.init(\"id_test\", \"test\", 0, \"%(ADMIN_STATIC_PREFIX)s\"); });</script>\\n' % admin_static_prefix()\n         )\n \n     def test_stacked_render(self):\n         w = widgets.FilteredSelectMultiple('test', True)\n         self.assertHTMLEqual(\n             conditional_escape(w.render('test', 'test')),\n-            '<select multiple=\"multiple\" name=\"test\" class=\"selectfilterstacked\">\\n</select><script type=\"text/javascript\">addEvent(window, \"load\", function(e) {SelectFilter.init(\"id_test\", \"test\", 1, \"%(ADMIN_MEDIA_PREFIX)s\"); });</script>\\n' % admin_media_prefix()\n+            '<select multiple=\"multiple\" name=\"test\" class=\"selectfilterstacked\">\\n</select><script type=\"text/javascript\">addEvent(window, \"load\", function(e) {SelectFilter.init(\"id_test\", \"test\", 1, \"%(ADMIN_STATIC_PREFIX)s\"); });</script>\\n' % admin_static_prefix()\n         )\n \n class AdminDateWidgetTest(DjangoTestCase):\n@@ -292,7 +292,7 @@ def test_render(self):\n         w = widgets.ForeignKeyRawIdWidget(rel, widget_admin_site)\n         self.assertHTMLEqual(\n             conditional_escape(w.render('test', band.pk, attrs={})),\n-            '<input type=\"text\" name=\"test\" value=\"%(bandpk)s\" class=\"vForeignKeyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/band/?t=id\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_MEDIA_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>&nbsp;<strong>Linkin Park</strong>' % dict(admin_media_prefix(), bandpk=band.pk)\n+            '<input type=\"text\" name=\"test\" value=\"%(bandpk)s\" class=\"vForeignKeyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/band/?t=id\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_STATIC_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>&nbsp;<strong>Linkin Park</strong>' % dict(admin_static_prefix(), bandpk=band.pk)\n         )\n \n     def test_relations_to_non_primary_key(self):\n@@ -307,7 +307,7 @@ def test_relations_to_non_primary_key(self):\n         w = widgets.ForeignKeyRawIdWidget(rel, widget_admin_site)\n         self.assertHTMLEqual(\n             w.render('test', core.parent_id, attrs={}),\n-            '<input type=\"text\" name=\"test\" value=\"86\" class=\"vForeignKeyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/inventory/?t=barcode\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_MEDIA_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>&nbsp;<strong>Apple</strong>' % admin_media_prefix()\n+            '<input type=\"text\" name=\"test\" value=\"86\" class=\"vForeignKeyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/inventory/?t=barcode\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_STATIC_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>&nbsp;<strong>Apple</strong>' % admin_static_prefix()\n         )\n \n     def test_fk_related_model_not_in_admin(self):\n@@ -349,7 +349,7 @@ def test_proper_manager_for_label_lookup(self):\n         )\n         self.assertHTMLEqual(\n             w.render('test', child_of_hidden.parent_id, attrs={}),\n-            '<input type=\"text\" name=\"test\" value=\"93\" class=\"vForeignKeyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/inventory/?t=barcode\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_MEDIA_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>&nbsp;<strong>Hidden</strong>' % admin_media_prefix()\n+            '<input type=\"text\" name=\"test\" value=\"93\" class=\"vForeignKeyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/inventory/?t=barcode\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_STATIC_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>&nbsp;<strong>Hidden</strong>' % admin_static_prefix()\n         )\n \n \n@@ -365,12 +365,12 @@ def test_render(self):\n         w = widgets.ManyToManyRawIdWidget(rel, widget_admin_site)\n         self.assertHTMLEqual(\n             conditional_escape(w.render('test', [m1.pk, m2.pk], attrs={})),\n-            '<input type=\"text\" name=\"test\" value=\"%(m1pk)s,%(m2pk)s\" class=\"vManyToManyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/member/\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"/static/admin/img/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>' % dict(admin_media_prefix(), m1pk=m1.pk, m2pk=m2.pk)\n+            '<input type=\"text\" name=\"test\" value=\"%(m1pk)s,%(m2pk)s\" class=\"vManyToManyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/member/\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"/static/admin/img/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>' % dict(admin_static_prefix(), m1pk=m1.pk, m2pk=m2.pk)\n         )\n \n         self.assertHTMLEqual(\n             conditional_escape(w.render('test', [m1.pk])),\n-            '<input type=\"text\" name=\"test\" value=\"%(m1pk)s\" class=\"vManyToManyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/member/\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_MEDIA_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>' % dict(admin_media_prefix(), m1pk=m1.pk)\n+            '<input type=\"text\" name=\"test\" value=\"%(m1pk)s\" class=\"vManyToManyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/member/\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_STATIC_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>' % dict(admin_static_prefix(), m1pk=m1.pk)\n         )\n \n         self.assertEqual(w._has_changed(None, None), False)\n@@ -691,4 +691,4 @@ class HorizontalVerticalFilterSeleniumChromeTests(HorizontalVerticalFilterSeleni\n     webdriver_class = 'selenium.webdriver.chrome.webdriver.WebDriver'\n \n class HorizontalVerticalFilterSeleniumIETests(HorizontalVerticalFilterSeleniumFirefoxTests):\n-    webdriver_class = 'selenium.webdriver.ie.webdriver.WebDriver'\n\\ No newline at end of file\n+    webdriver_class = 'selenium.webdriver.ie.webdriver.WebDriver'"
        },
        {
            "sha": "3a725500117583c1e09c1b1acf27a7b9c0dbb85b",
            "filename": "tests/regressiontests/servers/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 64,
            "changes": 66,
            "blob_url": "https://github.com/django/django/blob/5c53e30607014163872e89c221b206992a9acfef/tests%2Fregressiontests%2Fservers%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/5c53e30607014163872e89c221b206992a9acfef/tests%2Fregressiontests%2Fservers%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fservers%2Ftests.py?ref=5c53e30607014163872e89c221b206992a9acfef",
            "patch": "@@ -2,77 +2,15 @@\n Tests for django.core.servers.\n \"\"\"\n import os\n-from urlparse import urljoin\n import urllib2\n \n-import django\n-from django.conf import settings\n from django.core.exceptions import ImproperlyConfigured\n-from django.test import TestCase, LiveServerTestCase\n-from django.core.handlers.wsgi import WSGIHandler\n-from django.core.servers.basehttp import AdminMediaHandler, WSGIServerException\n+from django.test import LiveServerTestCase\n+from django.core.servers.basehttp import WSGIServerException\n from django.test.utils import override_settings\n \n from .models import Person\n \n-class AdminMediaHandlerTests(TestCase):\n-\n-    def setUp(self):\n-        self.admin_media_url = urljoin(settings.STATIC_URL, 'admin/')\n-        self.admin_media_file_path = os.path.abspath(\n-            os.path.join(django.__path__[0], 'contrib', 'admin', 'static', 'admin')\n-        )\n-        self.handler = AdminMediaHandler(WSGIHandler())\n-\n-    def test_media_urls(self):\n-        \"\"\"\n-        Tests that URLs that look like absolute file paths after the\n-        settings.STATIC_URL don't turn into absolute file paths.\n-        \"\"\"\n-        # Cases that should work on all platforms.\n-        data = (\n-            ('%scss/base.css' % self.admin_media_url, ('css', 'base.css')),\n-        )\n-        # Cases that should raise an exception.\n-        bad_data = ()\n-\n-        # Add platform-specific cases.\n-        if os.sep == '/':\n-            data += (\n-                # URL, tuple of relative path parts.\n-                ('%s\\\\css/base.css' % self.admin_media_url, ('\\\\css', 'base.css')),\n-            )\n-            bad_data += (\n-                '%s/css/base.css' % self.admin_media_url,\n-                '%s///css/base.css' % self.admin_media_url,\n-                '%s../css/base.css' % self.admin_media_url,\n-            )\n-        elif os.sep == '\\\\':\n-            bad_data += (\n-                '%sC:\\css/base.css' % self.admin_media_url,\n-                '%s/\\\\css/base.css' % self.admin_media_url,\n-                '%s\\\\css/base.css' % self.admin_media_url,\n-                '%s\\\\\\\\css/base.css' % self.admin_media_url\n-            )\n-        for url, path_tuple in data:\n-            try:\n-                output = self.handler.file_path(url)\n-            except ValueError:\n-                self.fail(\"Got a ValueError exception, but wasn't expecting\"\n-                          \" one. URL was: %s\" % url)\n-            rel_path = os.path.join(*path_tuple)\n-            desired = os.path.join(self.admin_media_file_path, rel_path)\n-            self.assertEqual(\n-                os.path.normcase(output), os.path.normcase(desired),\n-                \"Got: %s, Expected: %s, URL was: %s\" % (output, desired, url))\n-        for url in bad_data:\n-            try:\n-                output = self.handler.file_path(url)\n-            except ValueError:\n-                continue\n-            self.fail('URL: %s should have caused a ValueError exception.'\n-                      % url)\n-\n \n TEST_ROOT = os.path.dirname(__file__)\n TEST_SETTINGS = {"
        }
    ],
    "stats": {
        "total": 195,
        "additions": 31,
        "deletions": 164
    }
}