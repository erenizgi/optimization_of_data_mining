{
    "author": "freakboy3742",
    "message": "Fixed #15315 -- Added support for the 'widget' argument to modelform_factory. Thanks to SardarNL and Will Hardy for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16659 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "a5cbb892f8206c8f4ae8fd1bcff93b8251e6264e",
    "files": [
        {
            "sha": "254cca3db80e838637cc24b6904f92e2a537849b",
            "filename": "django/forms/models.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/a5cbb892f8206c8f4ae8fd1bcff93b8251e6264e/django%2Fforms%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/a5cbb892f8206c8f4ae8fd1bcff93b8251e6264e/django%2Fforms%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fmodels.py?ref=a5cbb892f8206c8f4ae8fd1bcff93b8251e6264e",
            "patch": "@@ -368,7 +368,7 @@ class ModelForm(BaseModelForm):\n     __metaclass__ = ModelFormMetaclass\n \n def modelform_factory(model, form=ModelForm, fields=None, exclude=None,\n-                       formfield_callback=None):\n+                      formfield_callback=None,  widgets=None):\n     # Create the inner Meta class. FIXME: ideally, we should be able to\n     # construct a ModelForm without creating and passing in a temporary\n     # inner class.\n@@ -379,6 +379,8 @@ def modelform_factory(model, form=ModelForm, fields=None, exclude=None,\n         attrs['fields'] = fields\n     if exclude is not None:\n         attrs['exclude'] = exclude\n+    if widgets is not None:\n+        attrs['widgets'] = widgets\n \n     # If parent form class already has an inner Meta, the Meta we're\n     # creating needs to inherit from the parent's inner meta."
        },
        {
            "sha": "05b8abd4d3e1053e8df851475287f2d1cd37909a",
            "filename": "tests/regressiontests/model_forms_regress/tests.py",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/a5cbb892f8206c8f4ae8fd1bcff93b8251e6264e/tests%2Fregressiontests%2Fmodel_forms_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a5cbb892f8206c8f4ae8fd1bcff93b8251e6264e/tests%2Fregressiontests%2Fmodel_forms_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmodel_forms_regress%2Ftests.py?ref=a5cbb892f8206c8f4ae8fd1bcff93b8251e6264e",
            "patch": "@@ -275,6 +275,20 @@ class Meta:\n         Form = modelform_factory(Person, form=BaseForm)\n         self.assertTrue(Form.base_fields['name'].widget is widget)\n \n+    def test_factory_with_widget_argument(self):\n+        \"\"\" Regression for #15315: modelform_factory should accept widgets\n+            argument\n+        \"\"\"\n+        widget = forms.Textarea()\n+\n+        # Without a widget should not set the widget to textarea\n+        Form = modelform_factory(Person)\n+        self.assertNotEqual(Form.base_fields['name'].widget.__class__, forms.Textarea)\n+\n+        # With a widget should not set the widget to textarea\n+        Form = modelform_factory(Person, widgets={'name':widget})\n+        self.assertEqual(Form.base_fields['name'].widget.__class__, forms.Textarea)\n+\n     def test_custom_callback(self):\n         \"\"\"Test that a custom formfield_callback is used if provided\"\"\"\n "
        }
    ],
    "stats": {
        "total": 18,
        "additions": 17,
        "deletions": 1
    }
}