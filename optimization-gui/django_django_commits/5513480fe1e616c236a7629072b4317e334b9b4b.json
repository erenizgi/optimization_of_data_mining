{
    "author": "claudep",
    "message": "[py3] Always convert values from sqlite3 to unicode strings\n\nThanks Aymeric Augustin for the review.",
    "sha": "5513480fe1e616c236a7629072b4317e334b9b4b",
    "files": [
        {
            "sha": "775ca20e45f2094c0dccc0bfdeb46730461c562b",
            "filename": "django/db/backends/sqlite3/base.py",
            "status": "modified",
            "additions": 15,
            "deletions": 7,
            "changes": 22,
            "blob_url": "https://github.com/django/django/blob/5513480fe1e616c236a7629072b4317e334b9b4b/django%2Fdb%2Fbackends%2Fsqlite3%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/5513480fe1e616c236a7629072b4317e334b9b4b/django%2Fdb%2Fbackends%2Fsqlite3%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fbackends%2Fsqlite3%2Fbase.py?ref=5513480fe1e616c236a7629072b4317e334b9b4b",
            "patch": "@@ -56,13 +56,21 @@ def adapt_datetime_with_timezone_support(value):\n         value = value.astimezone(timezone.utc).replace(tzinfo=None)\n     return value.isoformat(str(\" \"))\n \n-Database.register_converter(str(\"bool\"), lambda s: str(s) == '1')\n-Database.register_converter(str(\"time\"), parse_time)\n-Database.register_converter(str(\"date\"), parse_date)\n-Database.register_converter(str(\"datetime\"), parse_datetime_with_timezone_support)\n-Database.register_converter(str(\"timestamp\"), parse_datetime_with_timezone_support)\n-Database.register_converter(str(\"TIMESTAMP\"), parse_datetime_with_timezone_support)\n-Database.register_converter(str(\"decimal\"), util.typecast_decimal)\n+def decoder(conv_func):\n+    \"\"\" The Python sqlite3 interface returns always byte strings.\n+        This function converts the received value to a regular string before\n+        passing it to the receiver function.\n+    \"\"\"\n+    return lambda s: conv_func(s.decode('utf-8'))\n+\n+Database.register_converter(str(\"bool\"), decoder(lambda s: s == '1'))\n+Database.register_converter(str(\"time\"), decoder(parse_time))\n+Database.register_converter(str(\"date\"), decoder(parse_date))\n+Database.register_converter(str(\"datetime\"), decoder(parse_datetime_with_timezone_support))\n+Database.register_converter(str(\"timestamp\"), decoder(parse_datetime_with_timezone_support))\n+Database.register_converter(str(\"TIMESTAMP\"), decoder(parse_datetime_with_timezone_support))\n+Database.register_converter(str(\"decimal\"), decoder(util.typecast_decimal))\n+\n Database.register_adapter(datetime.datetime, adapt_datetime_with_timezone_support)\n Database.register_adapter(decimal.Decimal, util.rev_typecast_decimal)\n if Database.version_info >= (2, 4, 1):"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 15,
        "deletions": 7
    }
}