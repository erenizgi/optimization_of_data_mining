{
    "author": "jbronn",
    "message": "GeoDjango test suite housekeeping.  Moved data into fixtures for `relatedapp` and `distapp` tests, and made both use Django's `TestCase`; moved functionality out of `GeoDjangoTestSuiteRunner` to allow future re-use in `runtests.py` (refs #10420); compressed test app fixtures and cleaned up imports.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@14776 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "0f879195a6bf2778359020e2f8afff4b6e670ca1",
    "files": [
        {
            "sha": "cf8e746ed31e1a0c3d39daa669f5fe9f6123b6c8",
            "filename": "django/contrib/gis/tests/__init__.py",
            "status": "modified",
            "additions": 95,
            "deletions": 71,
            "changes": 166,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2F__init__.py?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1",
            "patch": "@@ -1,15 +1,12 @@\n-import sys\n-\n from django.conf import settings\n-from django.db.models import get_app\n from django.test.simple import build_suite, DjangoTestSuiteRunner\n from django.utils import unittest\n \n-\n def run_tests(*args, **kwargs):\n     from django.test.simple import run_tests as base_run_tests\n     return base_run_tests(*args, **kwargs)\n \n+\n def run_gis_tests(test_labels, verbosity=1, interactive=True, failfast=False, extra_tests=None):\n     import warnings\n     warnings.warn(\n@@ -19,94 +16,121 @@ def run_gis_tests(test_labels, verbosity=1, interactive=True, failfast=False, ex\n     test_runner = GeoDjangoTestSuiteRunner(verbosity=verbosity, interactive=interactive, failfast=failfast)\n     return test_runner.run_tests(test_labels, extra_tests=extra_tests)\n \n-class GeoDjangoTestSuiteRunner(DjangoTestSuiteRunner):\n \n-    def setup_test_environment(self, **kwargs):\n-        super(GeoDjangoTestSuiteRunner, self).setup_test_environment(**kwargs)\n+def geo_apps(namespace=True):\n+    \"\"\"\n+    Returns a list of GeoDjango test applications that reside in\n+    `django.contrib.gis.tests` that can be used with the current\n+    database and the spatial libraries that are installed.\n+    \"\"\"\n+    from django.db import connection\n+    from django.contrib.gis.geos import GEOS_PREPARE\n+    from django.contrib.gis.gdal import HAS_GDAL\n \n-        from django.db import connection\n-        from django.contrib.gis.geos import GEOS_PREPARE\n-        from django.contrib.gis.gdal import HAS_GDAL\n+    apps = ['geoapp', 'relatedapp']\n \n-        # Getting and storing the original values of INSTALLED_APPS and\n-        # the ROOT_URLCONF.\n-        self.old_installed = getattr(settings, 'INSTALLED_APPS', None)\n-        self.old_root_urlconf = getattr(settings, 'ROOT_URLCONF', None)\n-        self.old_site_id = getattr(settings, 'SITE_ID', None)\n+    # No distance queries on MySQL.\n+    if not connection.ops.mysql:\n+        apps.append('distapp')\n+\n+    # Test geography support with PostGIS 1.5+.\n+    if connection.ops.postgis and connection.ops.geography:\n+        apps.append('geogapp')\n+\n+    # The following GeoDjango test apps depend on GDAL support.\n+    if HAS_GDAL:\n+        # 3D apps use LayerMapping, which uses GDAL.\n+        if connection.ops.postgis and GEOS_PREPARE:\n+            apps.append('geo3d')\n+\n+        apps.append('layermap')\n+\n+    if namespace:\n+        return ['django.contrib.gis.tests.%s' % app\n+                for app in apps]\n+    else:\n+        return apps\n+\n+\n+def geodjango_suite():\n+    \"\"\"\n+    Returns a TestSuite consisting only of GeoDjango tests that can be run.\n+    \"\"\"\n+    import sys\n+    from django.db.models import get_app\n+\n+    suite = unittest.TestSuite()\n+\n+    # Adding the GEOS tests.\n+    from django.contrib.gis.geos import tests as geos_tests\n+    suite.addTest(geos_tests.suite())\n \n-        # Tests that require use of a spatial database (e.g., creation of models)\n-        self.geo_apps = ['geoapp', 'relatedapp']\n-        if connection.ops.postgis and connection.ops.geography:\n-            # Test geography support with PostGIS 1.5+.\n-            self.geo_apps.append('geogapp')\n+    # Adding the measurment tests.\n+    from django.contrib.gis.tests import test_measure\n+    suite.addTest(test_measure.suite())\n \n-        if HAS_GDAL:\n-            # The following GeoDjango test apps depend on GDAL support.\n-            if not connection.ops.mysql:\n-                self.geo_apps.append('distapp')\n+    # Adding GDAL tests, and any test suite that depends on GDAL, to the\n+    # suite if GDAL is available.\n+    from django.contrib.gis.gdal import HAS_GDAL\n+    if HAS_GDAL:\n+        from django.contrib.gis.gdal import tests as gdal_tests\n+        suite.addTest(gdal_tests.suite())\n \n-            # 3D apps use LayerMapping, which uses GDAL.\n-            if connection.ops.postgis and GEOS_PREPARE:\n-                self.geo_apps.append('geo3d')\n+        from django.contrib.gis.tests import test_spatialrefsys, test_geoforms\n+        suite.addTest(test_spatialrefsys.suite())\n+        suite.addTest(test_geoforms.suite())\n+    else:\n+        sys.stderr.write('GDAL not available - no tests requiring GDAL will be run.\\n')\n \n-            self.geo_apps.append('layermap')\n+    # Add GeoIP tests to the suite, if the library and data is available.\n+    from django.contrib.gis.utils import HAS_GEOIP\n+    if HAS_GEOIP and hasattr(settings, 'GEOIP_PATH'):\n+        from django.contrib.gis.tests import test_geoip\n+        suite.addTest(test_geoip.suite())\n+\n+    # Finally, adding the suites for each of the GeoDjango test apps.\n+    for app_name in geo_apps(namespace=False):\n+        suite.addTest(build_suite(get_app(app_name)))\n+\n+    return suite\n+\n+\n+class GeoDjangoTestSuiteRunner(DjangoTestSuiteRunner):\n+\n+    def setup_test_environment(self, **kwargs):\n+        super(GeoDjangoTestSuiteRunner, self).setup_test_environment(**kwargs)\n+\n+        # Saving original values of INSTALLED_APPS, ROOT_URLCONF, and SITE_ID.\n+        self.old_installed = getattr(settings, 'INSTALLED_APPS', None)\n+        self.old_root_urlconf = getattr(settings, 'ROOT_URLCONF', '')\n+        self.old_site_id = getattr(settings, 'SITE_ID', None)\n \n         # Constructing the new INSTALLED_APPS, and including applications\n-        # within the GeoDjango test namespace (`self.geo_apps`).\n+        # within the GeoDjango test namespace.\n         new_installed =  ['django.contrib.sites',\n                           'django.contrib.sitemaps',\n                           'django.contrib.gis',\n                           ]\n-        new_installed.extend(['django.contrib.gis.tests.%s' % app\n-                              for app in self.geo_apps])\n+\n+        # Calling out to `geo_apps` to get GeoDjango applications supported\n+        # for testing.\n+        new_installed.extend(geo_apps())\n         settings.INSTALLED_APPS = new_installed\n \n-        # Setting the URLs.\n-        settings.ROOT_URLCONF = 'django.contrib.gis.tests.urls'\n+        # SITE_ID needs to be set\n         settings.SITE_ID = 1\n \n+        # ROOT_URLCONF needs to be set, else `AttributeErrors` are raised\n+        # when TestCases are torn down that have `urls` defined.\n+        settings.ROOT_URLCONF = ''\n+\n+\n     def teardown_test_environment(self, **kwargs):\n         super(GeoDjangoTestSuiteRunner, self).teardown_test_environment(**kwargs)\n         settings.INSTALLED_APPS = self.old_installed\n         settings.ROOT_URLCONF = self.old_root_urlconf\n         settings.SITE_ID = self.old_site_id\n \n+\n     def build_suite(self, test_labels, extra_tests=None, **kwargs):\n-        \"\"\"\n-        This method is overridden to construct a suite consisting only of tests\n-        for GeoDjango.\n-        \"\"\"\n-        suite = unittest.TestSuite()\n-\n-        # Adding the GEOS tests.\n-        from django.contrib.gis.geos import tests as geos_tests\n-        suite.addTest(geos_tests.suite())\n-\n-        # Adding the measurment tests.\n-        from django.contrib.gis.tests import test_measure\n-        suite.addTest(test_measure.suite())\n-\n-        # Adding GDAL tests, and any test suite that depends on GDAL, to the\n-        # suite if GDAL is available.\n-        from django.contrib.gis.gdal import HAS_GDAL\n-        if HAS_GDAL:\n-            from django.contrib.gis.gdal import tests as gdal_tests\n-            suite.addTest(gdal_tests.suite())\n-\n-            from django.contrib.gis.tests import test_spatialrefsys, test_geoforms\n-            suite.addTest(test_spatialrefsys.suite())\n-            suite.addTest(test_geoforms.suite())\n-        else:\n-            sys.stderr.write('GDAL not available - no tests requiring GDAL will be run.\\n')\n-\n-        # Add GeoIP tests to the suite, if the library and data is available.\n-        from django.contrib.gis.utils import HAS_GEOIP\n-        if HAS_GEOIP and hasattr(settings, 'GEOIP_PATH'):\n-            from django.contrib.gis.tests import test_geoip\n-            suite.addTest(test_geoip.suite())\n-\n-        # Finally, adding the suites for each of the GeoDjango test apps.\n-        for app_name in self.geo_apps:\n-            suite.addTest(build_suite(get_app(app_name)))\n-\n-        return suite\n+        return geodjango_suite()"
        },
        {
            "sha": "77c06d65d86736a14fa6ca62ce9f1e59a286ce57",
            "filename": "django/contrib/gis/tests/distapp/data.py",
            "status": "removed",
            "additions": 0,
            "deletions": 36,
            "changes": 36,
            "blob_url": "https://github.com/django/django/blob/fb391b8b98e9e6a3dc89cfb43892f96cf70d199c/django%2Fcontrib%2Fgis%2Ftests%2Fdistapp%2Fdata.py",
            "raw_url": "https://github.com/django/django/raw/fb391b8b98e9e6a3dc89cfb43892f96cf70d199c/django%2Fcontrib%2Fgis%2Ftests%2Fdistapp%2Fdata.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fdistapp%2Fdata.py?ref=fb391b8b98e9e6a3dc89cfb43892f96cf70d199c",
            "patch": "@@ -1,36 +0,0 @@\n-au_cities = (('Wollongong', 150.902, -34.4245),\n-             ('Shellharbour', 150.87, -34.5789),\n-             ('Thirroul', 150.924, -34.3147),\n-             ('Mittagong', 150.449, -34.4509),\n-             ('Batemans Bay', 150.175, -35.7082),\n-             ('Canberra', 144.963, -37.8143),\n-             ('Melbourne', 145.963, -37.8143),\n-             ('Sydney', 151.26071, -33.887034),\n-             ('Hobart', 147.33, -42.8827),\n-             ('Adelaide', 138.6, -34.9258),\n-             ('Hillsdale', 151.231341, -33.952685),\n-             )\n-\n-stx_cities = (('Downtown Houston', -95.363151, 29.763374),\n-              ('West University Place', -95.448601, 29.713803),\n-              ('Southside Place', -95.436920, 29.705777),\n-              ('Bellaire', -95.458732, 29.705614),\n-              ('Pearland', -95.287303, 29.563568),\n-              ('Galveston', -94.797489, 29.301336),\n-              ('Sealy', -96.156952, 29.780918),\n-              ('San Antonio', -98.493183, 29.424170),\n-              ('Saint Hedwig', -98.199820, 29.414197),\n-              )\n-\n-# Data from U.S. Census ZCTA cartographic boundary file for Texas (`zt48_d00.shp`).\n-stx_zips = (('77002', 'POLYGON ((-95.365015 29.772327, -95.362415 29.772327, -95.360915 29.771827, -95.354615 29.771827, -95.351515 29.772527, -95.350915 29.765327, -95.351015 29.762436, -95.350115 29.760328, -95.347515 29.758528, -95.352315 29.753928, -95.356415 29.756328, -95.358215 29.754028, -95.360215 29.756328, -95.363415 29.757128, -95.364014 29.75638, -95.363415 29.753928, -95.360015 29.751828, -95.361815 29.749528, -95.362715 29.750028, -95.367516 29.744128, -95.369316 29.745128, -95.373916 29.744128, -95.380116 29.738028, -95.387916 29.727929, -95.388516 29.729629, -95.387916 29.732129, -95.382916 29.737428, -95.376616 29.742228, -95.372616 29.747228, -95.378601 29.750846, -95.378616 29.752028, -95.378616 29.754428, -95.376016 29.754528, -95.374616 29.759828, -95.373616 29.761128, -95.371916 29.763928, -95.372316 29.768727, -95.365884 29.76791, -95.366015 29.767127, -95.358715 29.765327, -95.358615 29.766327, -95.359115 29.767227, -95.360215 29.767027, -95.362783 29.768267, -95.365315 29.770527, -95.365015 29.772327))'),\n-            ('77005', 'POLYGON ((-95.447918 29.727275, -95.428017 29.728729, -95.421117 29.729029, -95.418617 29.727629, -95.418517 29.726429, -95.402117 29.726629, -95.402117 29.725729, -95.395316 29.725729, -95.391916 29.726229, -95.389716 29.725829, -95.396517 29.715429, -95.397517 29.715929, -95.400917 29.711429, -95.411417 29.715029, -95.418417 29.714729, -95.418317 29.70623, -95.440818 29.70593, -95.445018 29.70683, -95.446618 29.70763, -95.447418 29.71003, -95.447918 29.727275))'),\n-            ('77025', 'POLYGON ((-95.418317 29.70623, -95.414717 29.706129, -95.414617 29.70533, -95.418217 29.70533, -95.419817 29.69533, -95.419484 29.694196, -95.417166 29.690901, -95.414517 29.69433, -95.413317 29.69263, -95.412617 29.68973, -95.412817 29.68753, -95.414087 29.685055, -95.419165 29.685428, -95.421617 29.68513, -95.425717 29.67983, -95.425017 29.67923, -95.424517 29.67763, -95.427418 29.67763, -95.438018 29.664631, -95.436713 29.664411, -95.440118 29.662231, -95.439218 29.661031, -95.437718 29.660131, -95.435718 29.659731, -95.431818 29.660331, -95.441418 29.656631, -95.441318 29.656331, -95.441818 29.656131, -95.441718 29.659031, -95.441118 29.661031, -95.446718 29.656431, -95.446518 29.673431, -95.446918 29.69013, -95.447418 29.71003, -95.446618 29.70763, -95.445018 29.70683, -95.440818 29.70593, -95.418317 29.70623))'),\n-            ('77401', 'POLYGON ((-95.447918 29.727275, -95.447418 29.71003, -95.446918 29.69013, -95.454318 29.68893, -95.475819 29.68903, -95.475819 29.69113, -95.484419 29.69103, -95.484519 29.69903, -95.480419 29.70133, -95.480419 29.69833, -95.474119 29.69833, -95.474119 29.70453, -95.472719 29.71283, -95.468019 29.71293, -95.468219 29.720229, -95.464018 29.720229, -95.464118 29.724529, -95.463018 29.725929, -95.459818 29.726129, -95.459918 29.720329, -95.451418 29.720429, -95.451775 29.726303, -95.451318 29.727029, -95.447918 29.727275))'),\n-            )\n-\n-interstates = (('I-25', 'LINESTRING(-104.4780170766108 36.66698791870694, -104.4468522338495 36.79925409393386, -104.46212692626 36.9372149776075, -104.5126119783768 37.08163268820887, -104.5247764602161 37.29300499892048, -104.7084397427668 37.49150259925398, -104.8126599016282 37.69514285621863, -104.8452887035466 37.87613395659479, -104.7160169341003 38.05951763337799, -104.6165437927668 38.30432045855106, -104.6437227858174 38.53979986564737, -104.7596170387259 38.7322907594295, -104.8380078676822 38.89998460604341, -104.8501253693506 39.09980189213358, -104.8791648316464 39.24368776457503, -104.8635041274215 39.3785278162751, -104.8894471170052 39.5929228239605, -104.9721242843344 39.69528482419685, -105.0112104500356 39.7273080432394, -105.0010368577104 39.76677607811571, -104.981835619 39.81466504121967, -104.9858891550477 39.88806911250832, -104.9873548059578 39.98117234571016, -104.9766220487419 40.09796423450692, -104.9818565932953 40.36056530662884, -104.9912746373997 40.74904484447656)'),\n-               )\n-\n-stx_interstates = (('I-10', 'LINESTRING(924952.5 4220931.6,925065.3 4220931.6,929568.4 4221057.8)'),\n-                   )"
        },
        {
            "sha": "5151d33977869ccdbcb5abff36adca77b4d7e647",
            "filename": "django/contrib/gis/tests/distapp/fixtures/initial_data.json.gz",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fdistapp%2Ffixtures%2Finitial_data.json.gz",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fdistapp%2Ffixtures%2Finitial_data.json.gz",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fdistapp%2Ffixtures%2Finitial_data.json.gz?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1"
        },
        {
            "sha": "4f81a91d000894ecc32487237d3a03f1860a38ab",
            "filename": "django/contrib/gis/tests/distapp/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 35,
            "changes": 39,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fdistapp%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fdistapp%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fdistapp%2Ftests.py?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1",
            "patch": "@@ -1,18 +1,17 @@\n-import os, unittest\n+import os\n from decimal import Decimal\n \n from django.db import connection\n from django.db.models import Q\n-from django.contrib.gis.gdal import DataSource\n from django.contrib.gis.geos import GEOSGeometry, Point, LineString\n from django.contrib.gis.measure import D # alias for Distance\n from django.contrib.gis.tests.utils import oracle, postgis, spatialite, no_oracle, no_spatialite\n+from django.test import TestCase\n \n from models import AustraliaCity, Interstate, SouthTexasInterstate, \\\n     SouthTexasCity, SouthTexasCityFt, CensusZipcode, SouthTexasZipcode\n-from data import au_cities, interstates, stx_interstates, stx_cities, stx_zips\n \n-class DistanceTest(unittest.TestCase):\n+class DistanceTest(TestCase):\n \n     # A point we are testing distances with -- using a WGS84\n     # coordinate that'll be implicitly transormed to that to\n@@ -28,37 +27,12 @@ def get_names(self, qs):\n         return cities\n \n     def test01_init(self):\n-        \"Initialization of distance models.\"\n-\n-        # Loading up the cities.\n-        def load_cities(city_model, data_tup):\n-            for name, x, y in data_tup:\n-                city_model(name=name, point=Point(x, y, srid=4326)).save()\n-\n-        def load_interstates(imodel, data_tup):\n-            for name, wkt in data_tup:\n-                imodel(name=name, path=wkt).save()\n-\n-        load_cities(SouthTexasCity, stx_cities)\n-        load_cities(SouthTexasCityFt, stx_cities)\n-        load_cities(AustraliaCity, au_cities)\n-\n+        \"Test initialization of distance models.\"\n         self.assertEqual(9, SouthTexasCity.objects.count())\n         self.assertEqual(9, SouthTexasCityFt.objects.count())\n         self.assertEqual(11, AustraliaCity.objects.count())\n-\n-        # Loading up the South Texas Zip Codes.\n-        for name, wkt in stx_zips:\n-            poly = GEOSGeometry(wkt, srid=4269)\n-            SouthTexasZipcode(name=name, poly=poly).save()\n-            CensusZipcode(name=name, poly=poly).save()\n         self.assertEqual(4, SouthTexasZipcode.objects.count())\n         self.assertEqual(4, CensusZipcode.objects.count())\n-\n-        # Loading up the Interstates.\n-        load_interstates(Interstate, interstates)\n-        load_interstates(SouthTexasInterstate, stx_interstates)\n-\n         self.assertEqual(1, Interstate.objects.count())\n         self.assertEqual(1, SouthTexasInterstate.objects.count())\n \n@@ -382,8 +356,3 @@ def test09_measurement_null_fields(self):\n         z = SouthTexasZipcode.objects.distance(htown.point).area().get(name='78212')\n         self.assertEqual(None, z.distance)\n         self.assertEqual(None, z.area)\n-\n-def suite():\n-    s = unittest.TestSuite()\n-    s.addTest(unittest.makeSuite(DistanceTest))\n-    return s"
        },
        {
            "sha": "f57445c4ebd7d330dc7afe41baa4715fb0815da0",
            "filename": "django/contrib/gis/tests/geo3d/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 7,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeo3d%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeo3d%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fgeo3d%2Ftests.py?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1",
            "patch": "@@ -1,4 +1,6 @@\n-import os, re, unittest\n+import os\n+import re\n+from django.utils.unittest import TestCase\n from django.contrib.gis.db.models import Union, Extent3D\n from django.contrib.gis.geos import GEOSGeometry, Point, Polygon\n from django.contrib.gis.utils import LayerMapping, LayerMapError\n@@ -49,7 +51,7 @@ def gen_bbox():\n     bbox_3d = Polygon(tuple((x, y, z) for (x, y), z in zip(bbox_2d[0].coords, bbox_z)), srid=32140)    \n     return bbox_2d, bbox_3d\n \n-class Geo3DTest(unittest.TestCase):\n+class Geo3DTest(TestCase):\n     \"\"\"\n     Only a subset of the PostGIS routines are 3D-enabled, and this TestCase\n     tries to test the features that can handle 3D and that are also \n@@ -227,8 +229,3 @@ def test07_translate(self):\n         for ztrans in ztranslations:\n             for city in City3D.objects.translate(0, 0, ztrans):\n                 self.assertEqual(city_dict[city.name][2] + ztrans, city.translate.z)\n-\n-def suite():\n-    s = unittest.TestSuite()\n-    s.addTest(unittest.makeSuite(Geo3DTest))\n-    return s"
        },
        {
            "sha": "d8bf70b85a328eca9d6b540d800b4093686ccd7e",
            "filename": "django/contrib/gis/tests/geoapp/fixtures/initial_data.json",
            "status": "removed",
            "additions": 0,
            "deletions": 97,
            "changes": 97,
            "blob_url": "https://github.com/django/django/blob/fb391b8b98e9e6a3dc89cfb43892f96cf70d199c/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ffixtures%2Finitial_data.json",
            "raw_url": "https://github.com/django/django/raw/fb391b8b98e9e6a3dc89cfb43892f96cf70d199c/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ffixtures%2Finitial_data.json",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ffixtures%2Finitial_data.json?ref=fb391b8b98e9e6a3dc89cfb43892f96cf70d199c"
        },
        {
            "sha": "c6950822cfb0bf2ea4f1e8315a7a4786a7b56fd9",
            "filename": "django/contrib/gis/tests/geoapp/fixtures/initial_data.json.gz",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ffixtures%2Finitial_data.json.gz",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ffixtures%2Finitial_data.json.gz",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ffixtures%2Finitial_data.json.gz?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1"
        },
        {
            "sha": "28ee3a02d01b78bc491c1e02ff011eb7814f37d5",
            "filename": "django/contrib/gis/tests/geoapp/test_feeds.py",
            "status": "modified",
            "additions": 11,
            "deletions": 12,
            "changes": 23,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftest_feeds.py",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftest_feeds.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftest_feeds.py?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1",
            "patch": "@@ -1,13 +1,12 @@\n from xml.dom import minidom\n-\n-from django.test import Client\n-from django.utils import unittest\n+from django.test import TestCase\n \n from models import City\n \n \n-class GeoFeedTest(unittest.TestCase):\n-    client = Client()\n+class GeoFeedTest(TestCase):\n+\n+    urls = 'django.contrib.gis.tests.geoapp.urls'\n \n     def assertChildNodes(self, elem, expected):\n         \"Taken from regressiontests/syndication/tests.py.\"\n@@ -18,9 +17,9 @@ def assertChildNodes(self, elem, expected):\n     def test_geofeed_rss(self):\n         \"Tests geographic feeds using GeoRSS over RSSv2.\"\n         # Uses `GEOSGeometry` in `item_geometry`\n-        doc1 = minidom.parseString(self.client.get('/geoapp/feeds/rss1/').content)\n+        doc1 = minidom.parseString(self.client.get('/feeds/rss1/').content)\n         # Uses a 2-tuple in `item_geometry`\n-        doc2 = minidom.parseString(self.client.get('/geoapp/feeds/rss2/').content)\n+        doc2 = minidom.parseString(self.client.get('/feeds/rss2/').content)\n         feed1, feed2 = doc1.firstChild, doc2.firstChild\n \n         # Making sure the box got added to the second GeoRSS feed.\n@@ -43,8 +42,8 @@ def test_geofeed_rss(self):\n \n     def test_geofeed_atom(self):\n         \"Testing geographic feeds using GeoRSS over Atom.\"\n-        doc1 = minidom.parseString(self.client.get('/geoapp/feeds/atom1/').content)\n-        doc2 = minidom.parseString(self.client.get('/geoapp/feeds/atom2/').content)\n+        doc1 = minidom.parseString(self.client.get('/feeds/atom1/').content)\n+        doc2 = minidom.parseString(self.client.get('/feeds/atom2/').content)\n         feed1, feed2 = doc1.firstChild, doc2.firstChild\n \n         # Making sure the box got added to the second GeoRSS feed.\n@@ -62,7 +61,7 @@ def test_geofeed_atom(self):\n \n     def test_geofeed_w3c(self):\n         \"Testing geographic feeds using W3C Geo.\"\n-        doc = minidom.parseString(self.client.get('/geoapp/feeds/w3cgeo1/').content)\n+        doc = minidom.parseString(self.client.get('/feeds/w3cgeo1/').content)\n         feed = doc.firstChild\n         # Ensuring the geo namespace was added to the <feed> element.\n         self.assertEqual(feed.getAttribute(u'xmlns:geo'), u'http://www.w3.org/2003/01/geo/wgs84_pos#')\n@@ -75,5 +74,5 @@ def test_geofeed_w3c(self):\n             self.assertChildNodes(item, ['title', 'link', 'description', 'guid', 'geo:lat', 'geo:lon'])\n \n         # Boxes and Polygons aren't allowed in W3C Geo feeds.\n-        self.assertRaises(ValueError, self.client.get, '/geoapp/feeds/w3cgeo2/') # Box in <channel>\n-        self.assertRaises(ValueError, self.client.get, '/geoapp/feeds/w3cgeo3/') # Polygons in <entry>\n+        self.assertRaises(ValueError, self.client.get, '/feeds/w3cgeo2/') # Box in <channel>\n+        self.assertRaises(ValueError, self.client.get, '/feeds/w3cgeo3/') # Polygons in <entry>"
        },
        {
            "sha": "c8c43f41fc39fc3be9fd89beb5b6b8a6ad913f8f",
            "filename": "django/contrib/gis/tests/geoapp/test_sitemaps.py",
            "status": "modified",
            "additions": 7,
            "deletions": 8,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftest_sitemaps.py",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftest_sitemaps.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftest_sitemaps.py?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1",
            "patch": "@@ -1,15 +1,14 @@\n import cStringIO\n from xml.dom import minidom\n import zipfile\n-\n-from django.test import Client\n-from django.utils import unittest\n+from django.test import TestCase\n \n from models import City, Country\n \n \n-class GeoSitemapTest(unittest.TestCase):\n-    client = Client()\n+class GeoSitemapTest(TestCase):\n+\n+    urls = 'django.contrib.gis.tests.geoapp.urls'\n \n     def assertChildNodes(self, elem, expected):\n         \"Taken from regressiontests/syndication/tests.py.\"\n@@ -20,15 +19,15 @@ def assertChildNodes(self, elem, expected):\n     def test_geositemap_index(self):\n         \"Tests geographic sitemap index.\"\n         # Getting the geo index.\n-        doc = minidom.parseString(self.client.get('/geoapp/sitemap.xml').content)\n+        doc = minidom.parseString(self.client.get('/sitemap.xml').content)\n         index = doc.firstChild\n         self.assertEqual(index.getAttribute(u'xmlns'), u'http://www.sitemaps.org/schemas/sitemap/0.9')\n         self.assertEqual(3, len(index.getElementsByTagName('sitemap')))\n \n     def test_geositemap_kml(self):\n         \"Tests KML/KMZ geographic sitemaps.\"\n         for kml_type in ('kml', 'kmz'):\n-            doc = minidom.parseString(self.client.get('/geoapp/sitemaps/%s.xml' % kml_type).content)\n+            doc = minidom.parseString(self.client.get('/sitemaps/%s.xml' % kml_type).content)\n \n             # Ensuring the right sitemaps namespaces are present.\n             urlset = doc.firstChild\n@@ -68,7 +67,7 @@ def test_geositemap_georss(self):\n         \"Tests GeoRSS geographic sitemaps.\"\n         from feeds import feed_dict\n \n-        doc = minidom.parseString(self.client.get('/geoapp/sitemaps/georss.xml').content)\n+        doc = minidom.parseString(self.client.get('/sitemaps/georss.xml').content)\n \n         # Ensuring the right sitemaps namespaces are present.\n         urlset = doc.firstChild"
        },
        {
            "sha": "a2b81c64a209a4636b3afd2630e3f25a3bcbc5f6",
            "filename": "django/contrib/gis/tests/geoapp/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 11,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftests.py?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1",
            "patch": "@@ -1,10 +1,11 @@\n-import re, os, unittest\n+import re\n from django.db import connection\n from django.contrib.gis import gdal\n-from django.contrib.gis.geos import *\n+from django.contrib.gis.geos import fromstr, GEOSGeometry, \\\n+    Point, LineString, LinearRing, Polygon, GeometryCollection\n from django.contrib.gis.measure import Distance\n from django.contrib.gis.tests.utils import \\\n-    no_mysql, no_oracle, no_postgis, no_spatialite, \\\n+    no_mysql, no_oracle, no_spatialite, \\\n     mysql, oracle, postgis, spatialite\n from django.test import TestCase\n \n@@ -732,11 +733,3 @@ def test29_force_rhr(self):\n from test_feeds import GeoFeedTest\n from test_regress import GeoRegressionTests\n from test_sitemaps import GeoSitemapTest\n-\n-def suite():\n-    s = unittest.TestSuite()\n-    s.addTest(unittest.makeSuite(GeoModelTest))\n-    s.addTest(unittest.makeSuite(GeoFeedTest))\n-    s.addTest(unittest.makeSuite(GeoSitemapTest))\n-    s.addTest(unittest.makeSuite(GeoRegressionTests))\n-    return s"
        },
        {
            "sha": "a11752a28204d235f1dd6c991bc232426899c9dc",
            "filename": "django/contrib/gis/tests/layermap/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 8,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Flayermap%2Ftests.py?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1",
            "patch": "@@ -1,16 +1,16 @@\n import os\n from decimal import Decimal\n \n-from django.utils import unittest\n from django.utils.copycompat import copy\n+from django.utils.unittest import TestCase\n \n from django.contrib.gis.gdal import DataSource\n from django.contrib.gis.tests.utils import mysql\n from django.contrib.gis.utils.layermapping import LayerMapping, LayerMapError, InvalidDecimal, MissingForeignKey\n \n from models import City, County, CountyFeat, Interstate, ICity1, ICity2, State, city_mapping, co_mapping, cofeat_mapping, inter_mapping\n \n-shp_path = os.path.realpath(os.path.join(os.path.dirname(__file__), '..', 'data'))\n+shp_path = os.path.realpath(os.path.join(os.path.dirname(__file__), os.pardir, 'data'))\n city_shp = os.path.join(shp_path, 'cities', 'cities.shp')\n co_shp = os.path.join(shp_path, 'counties', 'counties.shp')\n inter_shp = os.path.join(shp_path, 'interstates', 'interstates.shp')\n@@ -20,7 +20,7 @@\n NUMS   = [1, 2, 1, 19, 1] # Number of polygons for each.\n STATES = ['Texas', 'Texas', 'Texas', 'Hawaii', 'Colorado']\n \n-class LayerMapTest(unittest.TestCase):\n+class LayerMapTest(TestCase):\n \n     def test01_init(self):\n         \"Testing LayerMapping initialization.\"\n@@ -265,8 +265,3 @@ def test06_model_inheritance(self):\n \n         self.assertEqual(6, ICity1.objects.count())\n         self.assertEqual(3, ICity2.objects.count())\n-\n-def suite():\n-    s = unittest.TestSuite()\n-    s.addTest(unittest.makeSuite(LayerMapTest))\n-    return s"
        },
        {
            "sha": "68bf54c1b0d196a4e3b35d1b9045a6d8bf3f416e",
            "filename": "django/contrib/gis/tests/relatedapp/fixtures/initial_data.json.gz",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Frelatedapp%2Ffixtures%2Finitial_data.json.gz",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Frelatedapp%2Ffixtures%2Finitial_data.json.gz",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Frelatedapp%2Ffixtures%2Finitial_data.json.gz?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1"
        },
        {
            "sha": "c8aeb28d2a3f1d936e14cd4fb996f3fe94c43af7",
            "filename": "django/contrib/gis/tests/relatedapp/tests.py",
            "status": "modified",
            "additions": 32,
            "deletions": 55,
            "changes": 87,
            "blob_url": "https://github.com/django/django/blob/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Frelatedapp%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0f879195a6bf2778359020e2f8afff4b6e670ca1/django%2Fcontrib%2Fgis%2Ftests%2Frelatedapp%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Frelatedapp%2Ftests.py?ref=0f879195a6bf2778359020e2f8afff4b6e670ca1",
            "patch": "@@ -1,30 +1,27 @@\n-import os, unittest\n-from django.contrib.gis.geos import *\n+from django.test import TestCase\n+\n+from django.contrib.gis.geos import GEOSGeometry, Point, MultiPoint\n from django.contrib.gis.db.models import Collect, Count, Extent, F, Union\n from django.contrib.gis.geometry.backend import Geometry\n-from django.contrib.gis.tests.utils import mysql, oracle, postgis, spatialite, no_mysql, no_oracle, no_spatialite\n-from django.conf import settings\n-from models import City, Location, DirectoryEntry, Parcel, Book, Author, Article\n-\n-cities = (('Aurora', 'TX', -97.516111, 33.058333),\n-          ('Roswell', 'NM', -104.528056, 33.387222),\n-          ('Kecksburg', 'PA',  -79.460734, 40.18476),\n-           )\n+from django.contrib.gis.tests.utils import mysql, oracle, no_mysql, no_oracle, no_spatialite\n \n-class RelatedGeoModelTest(unittest.TestCase):\n+from models import City, Location, DirectoryEntry, Parcel, Book, Author, Article\n \n-    def test01_setup(self):\n-        \"Setting up for related model tests.\"\n-        for name, state, lon, lat in cities:\n-            loc = Location.objects.create(point=Point(lon, lat))\n-            c = City.objects.create(name=name, state=state, location=loc)\n+class RelatedGeoModelTest(TestCase):\n \n     def test02_select_related(self):\n         \"Testing `select_related` on geographic models (see #7126).\"\n         qs1 = City.objects.all()\n         qs2 = City.objects.select_related()\n         qs3 = City.objects.select_related('location')\n \n+        # Reference data for what's in the fixtures.\n+        cities = (\n+            ('Aurora', 'TX', -97.516111, 33.058333),\n+            ('Roswell', 'NM', -104.528056, 33.387222),\n+            ('Kecksburg', 'PA',  -79.460734, 40.18476),\n+        )\n+\n         for qs in (qs1, qs2, qs3):\n             for ref, c in zip(cities, qs):\n                 nm, st, lon, lat = ref\n@@ -63,11 +60,11 @@ def test04a_related_extent_aggregate(self):\n         # This combines the Extent and Union aggregates into one query\n         aggs = City.objects.aggregate(Extent('location__point'))\n \n-        # One for all locations, one that excludes Roswell.\n-        all_extent = (-104.528060913086, 33.0583305358887,-79.4607315063477, 40.1847610473633)\n-        txpa_extent = (-97.51611328125, 33.0583305358887,-79.4607315063477, 40.1847610473633)\n+        # One for all locations, one that excludes New Mexico (Roswell).\n+        all_extent = (-104.528056, 29.763374, -79.460734, 40.18476)\n+        txpa_extent = (-97.516111, 29.763374, -79.460734, 40.18476)\n         e1 = City.objects.extent(field_name='location__point')\n-        e2 = City.objects.exclude(name='Roswell').extent(field_name='location__point')\n+        e2 = City.objects.exclude(state='NM').extent(field_name='location__point')\n         e3 = aggs['location__point__extent']\n \n         # The tolerance value is to four decimal places because of differences\n@@ -83,25 +80,28 @@ def test04b_related_union_aggregate(self):\n         aggs = City.objects.aggregate(Union('location__point'))\n \n         # These are the points that are components of the aggregate geographic\n-        # union that is returned.\n+        # union that is returned.  Each point # corresponds to City PK.\n         p1 = Point(-104.528056, 33.387222)\n         p2 = Point(-97.516111, 33.058333)\n         p3 = Point(-79.460734, 40.18476)\n+        p4 = Point(-96.801611, 32.782057)\n+        p5 = Point(-95.363151, 29.763374)\n \n         # Creating the reference union geometry depending on the spatial backend,\n         # as Oracle will have a different internal ordering of the component\n         # geometries than PostGIS.  The second union aggregate is for a union\n         # query that includes limiting information in the WHERE clause (in other\n         # words a `.filter()` precedes the call to `.unionagg()`).\n         if oracle:\n-            ref_u1 = MultiPoint(p3, p1, p2, srid=4326)\n+            ref_u1 = MultiPoint(p4, p5, p3, p1, p2, srid=4326)\n             ref_u2 = MultiPoint(p3, p2, srid=4326)\n         else:\n-            ref_u1 = MultiPoint(p1, p2, p3, srid=4326)\n+            # Looks like PostGIS points by longitude value.\n+            ref_u1 = MultiPoint(p1, p2, p4, p5, p3, srid=4326)\n             ref_u2 = MultiPoint(p2, p3, srid=4326)\n \n         u1 = City.objects.unionagg(field_name='location__point')\n-        u2 = City.objects.exclude(name='Roswell').unionagg(field_name='location__point')\n+        u2 = City.objects.exclude(name__in=('Roswell', 'Houston', 'Dallas', 'Fort Worth')).unionagg(field_name='location__point')\n         u3 = aggs['location__point__union']\n \n         self.assertEqual(ref_u1, u1)\n@@ -187,17 +187,10 @@ def test08_defer_only(self):\n \n     def test09_pk_relations(self):\n         \"Ensuring correct primary key column is selected across relations. See #10757.\"\n-        # Adding two more cities, but this time making sure that their location\n-        # ID values do not match their City ID values.\n-        loc1 = Location.objects.create(point='POINT (-95.363151 29.763374)')\n-        loc2 = Location.objects.create(point='POINT (-96.801611 32.782057)')\n-        dallas = City.objects.create(name='Dallas', state='TX', location=loc2)\n-        houston = City.objects.create(name='Houston', state='TX', location=loc1)\n-\n         # The expected ID values -- notice the last two location IDs\n-        # are out of order.  We want to make sure that the related\n-        # location ID column is selected instead of ID column for\n-        # the city.\n+        # are out of order.  Dallas and Houston have location IDs that differ\n+        # from their PKs -- this is done to ensure that the related location\n+        # ID column is selected instead of ID column for the city.\n         city_ids = (1, 2, 3, 4, 5)\n         loc_ids = (1, 2, 3, 5, 4)\n         ids_qs = City.objects.order_by('id').values('id', 'location__id')\n@@ -232,29 +225,18 @@ def test11_geoquery_pickle(self):\n     @no_oracle\n     def test12a_count(self):\n         \"Testing `Count` aggregate use with the `GeoManager` on geo-fields.\"\n-        # Creating a new City, 'Fort Worth', that uses the same location\n-        # as Dallas.\n+        # The City, 'Fort Worth' uses the same location as Dallas.\n         dallas = City.objects.get(name='Dallas')\n-        ftworth = City.objects.create(name='Fort Worth', state='TX', location=dallas.location)\n \n         # Count annotation should be 2 for the Dallas location now.\n         loc = Location.objects.annotate(num_cities=Count('city')).get(id=dallas.location.id)\n         self.assertEqual(2, loc.num_cities)\n \n     def test12b_count(self):\n         \"Testing `Count` aggregate use with the `GeoManager` on non geo-fields. See #11087.\"\n-        # Creating some data for the Book/Author non-geo models that\n-        # use GeoManager.  See #11087.\n-        tp = Author.objects.create(name='Trevor Paglen')\n-        Book.objects.create(title='Torture Taxi', author=tp)\n-        Book.objects.create(title='I Could Tell You But Then You Would Have to be Destroyed by Me', author=tp)\n-        Book.objects.create(title='Blank Spots on the Map', author=tp)\n-        wp = Author.objects.create(name='William Patry')\n-        Book.objects.create(title='Patry on Copyright', author=wp)\n-\n         # Should only be one author (Trevor Paglen) returned by this query, and\n-        # the annotation should have 3 for the number of books.  Also testing\n-        # with a `GeoValuesQuerySet` (see #11489).\n+        # the annotation should have 3 for the number of books, see #11087.\n+        # Also testing with a `GeoValuesQuerySet`, see #11489.\n         qs = Author.objects.annotate(num_books=Count('books')).filter(num_books__gt=1)\n         vqs = Author.objects.values('name').annotate(num_books=Count('books')).filter(num_books__gt=1)\n         self.assertEqual(1, len(qs))\n@@ -280,7 +262,7 @@ def test14_collect(self):\n         # SELECT AsText(ST_Collect(\"relatedapp_location\".\"point\")) FROM \"relatedapp_city\" LEFT OUTER JOIN\n         #    \"relatedapp_location\" ON (\"relatedapp_city\".\"location_id\" = \"relatedapp_location\".\"id\")\n         #    WHERE \"relatedapp_city\".\"state\" = 'TX';\n-        ref_geom = fromstr('MULTIPOINT(-97.516111 33.058333,-96.801611 32.782057,-95.363151 29.763374,-96.801611 32.782057)')\n+        ref_geom = GEOSGeometry('MULTIPOINT(-97.516111 33.058333,-96.801611 32.782057,-95.363151 29.763374,-96.801611 32.782057)')\n \n         c1 = City.objects.filter(state='TX').collect(field_name='location__point')\n         c2 = City.objects.filter(state='TX').aggregate(Collect('location__point'))['location__point__collect']\n@@ -298,10 +280,5 @@ def test15_invalid_select_related(self):\n         # keyword.  The TypeError is swallowed if QuerySet is actually\n         # evaluated as list generation swallows TypeError in CPython.\n         sql = str(qs.query)\n-        \n-    # TODO: Related tests for KML, GML, and distance lookups.\n \n-def suite():\n-    s = unittest.TestSuite()\n-    s.addTest(unittest.makeSuite(RelatedGeoModelTest))\n-    return s\n+    # TODO: Related tests for KML, GML, and distance lookups."
        },
        {
            "sha": "95e36c22a480ce1b227cb45c93f8aa76d2231466",
            "filename": "django/contrib/gis/tests/urls.py",
            "status": "removed",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/fb391b8b98e9e6a3dc89cfb43892f96cf70d199c/django%2Fcontrib%2Fgis%2Ftests%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/fb391b8b98e9e6a3dc89cfb43892f96cf70d199c/django%2Fcontrib%2Fgis%2Ftests%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Furls.py?ref=fb391b8b98e9e6a3dc89cfb43892f96cf70d199c",
            "patch": "@@ -1,6 +0,0 @@\n-from django.conf.urls.defaults import *\n-\n-urlpatterns = patterns('',\n-                       (r'^geoapp/', include('django.contrib.gis.tests.geoapp.urls')),\n-                       )\n-                        "
        }
    ],
    "stats": {
        "total": 506,
        "additions": 160,
        "deletions": 346
    }
}