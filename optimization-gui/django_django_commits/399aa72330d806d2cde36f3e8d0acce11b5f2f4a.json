{
    "author": "jphalip",
    "message": "Enabled the existing admin Selenium tests to be run with Internet Explorer. Note that some tweaks had to be made, in particular as IE7 has limited capabilities regarding CSS selectors.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17666 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "399aa72330d806d2cde36f3e8d0acce11b5f2f4a",
    "files": [
        {
            "sha": "2491fc65b1922c19dd3e0255344b0969d5b8c32a",
            "filename": "django/contrib/admin/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/399aa72330d806d2cde36f3e8d0acce11b5f2f4a/django%2Fcontrib%2Fadmin%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/399aa72330d806d2cde36f3e8d0acce11b5f2f4a/django%2Fcontrib%2Fadmin%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftests.py?ref=399aa72330d806d2cde36f3e8d0acce11b5f2f4a",
            "patch": "@@ -79,7 +79,7 @@ def get_select_option(self, selector, value):\n         identified by the CSS selector `selector`.\n         \"\"\"\n         from selenium.common.exceptions import NoSuchElementException\n-        options = self.selenium.find_elements_by_css_selector('%s option' % selector)\n+        options = self.selenium.find_elements_by_css_selector('%s > option' % selector)\n         for option in options:\n             if option.get_attribute('value') == value:\n                 return option\n@@ -90,7 +90,7 @@ def assertSelectOptions(self, selector, values):\n         Asserts that the <SELECT> widget identified by `selector` has the\n         options with the given `values`.\n         \"\"\"\n-        options = self.selenium.find_elements_by_css_selector('%s option' % selector)\n+        options = self.selenium.find_elements_by_css_selector('%s > option' % selector)\n         actual_values = []\n         for option in options:\n             actual_values.append(option.get_attribute('value'))"
        },
        {
            "sha": "8b620cc57d6a1e489fcec4e8db05e8ba37ae67eb",
            "filename": "tests/regressiontests/admin_inlines/tests.py",
            "status": "modified",
            "additions": 29,
            "deletions": 18,
            "changes": 47,
            "blob_url": "https://github.com/django/django/blob/399aa72330d806d2cde36f3e8d0acce11b5f2f4a/tests%2Fregressiontests%2Fadmin_inlines%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/399aa72330d806d2cde36f3e8d0acce11b5f2f4a/tests%2Fregressiontests%2Fadmin_inlines%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_inlines%2Ftests.py?ref=399aa72330d806d2cde36f3e8d0acce11b5f2f4a",
            "patch": "@@ -394,46 +394,47 @@ def test_add_inlines(self):\n         Ensure that the \"Add another XXX\" link correctly adds items to the\n         inline form.\n         \"\"\"\n+        from selenium.common.exceptions import TimeoutException\n         self.admin_login(username='super', password='secret')\n         self.selenium.get('%s%s' % (self.live_server_url,\n             '/admin/admin_inlines/profilecollection/add/'))\n \n         # Check that there's only one inline to start with and that it has the\n         # correct ID.\n         self.failUnlessEqual(len(self.selenium.find_elements_by_css_selector(\n-            '#profile_set-group table tr.dynamic-profile_set')), 1)\n-        self.failUnlessEqual(self.selenium.find_element_by_css_selector(\n-            '.dynamic-profile_set:nth-of-type(1)').get_attribute('id'),\n+            '.dynamic-profile_set')), 1)\n+        self.failUnlessEqual(self.selenium.find_elements_by_css_selector(\n+            '.dynamic-profile_set')[0].get_attribute('id'),\n             'profile_set-0')\n         self.failUnlessEqual(len(self.selenium.find_elements_by_css_selector(\n-            'form#profilecollection_form tr.dynamic-profile_set#profile_set-0 input[name=profile_set-0-first_name]')), 1)\n+            '.dynamic-profile_set#profile_set-0 input[name=profile_set-0-first_name]')), 1)\n         self.failUnlessEqual(len(self.selenium.find_elements_by_css_selector(\n-            'form#profilecollection_form tr.dynamic-profile_set#profile_set-0 input[name=profile_set-0-last_name]')), 1)\n+            '.dynamic-profile_set#profile_set-0 input[name=profile_set-0-last_name]')), 1)\n \n         # Add an inline\n         self.selenium.find_element_by_link_text('Add another Profile').click()\n \n         # Check that the inline has been added, that it has the right id, and\n         # that it contains the right fields.\n         self.failUnlessEqual(len(self.selenium.find_elements_by_css_selector(\n-            '#profile_set-group table tr.dynamic-profile_set')), 2)\n-        self.failUnlessEqual(self.selenium.find_element_by_css_selector(\n-            '.dynamic-profile_set:nth-of-type(2)').get_attribute('id'), 'profile_set-1')\n+            '.dynamic-profile_set')), 2)\n+        self.failUnlessEqual(self.selenium.find_elements_by_css_selector(\n+            '.dynamic-profile_set')[1].get_attribute('id'), 'profile_set-1')\n         self.failUnlessEqual(len(self.selenium.find_elements_by_css_selector(\n-            'form#profilecollection_form tr.dynamic-profile_set#profile_set-1 input[name=profile_set-1-first_name]')), 1)\n+            '.dynamic-profile_set#profile_set-1 input[name=profile_set-1-first_name]')), 1)\n         self.failUnlessEqual(len(self.selenium.find_elements_by_css_selector(\n-            'form#profilecollection_form tr.dynamic-profile_set#profile_set-1 input[name=profile_set-1-last_name]')), 1)\n+            '.dynamic-profile_set#profile_set-1 input[name=profile_set-1-last_name]')), 1)\n \n         # Let's add another one to be sure\n         self.selenium.find_element_by_link_text('Add another Profile').click()\n         self.failUnlessEqual(len(self.selenium.find_elements_by_css_selector(\n-            '#profile_set-group table tr.dynamic-profile_set')), 3)\n-        self.failUnlessEqual(self.selenium.find_element_by_css_selector(\n-            '.dynamic-profile_set:nth-of-type(3)').get_attribute('id'), 'profile_set-2')\n+            '.dynamic-profile_set')), 3)\n+        self.failUnlessEqual(self.selenium.find_elements_by_css_selector(\n+            '.dynamic-profile_set')[2].get_attribute('id'), 'profile_set-2')\n         self.failUnlessEqual(len(self.selenium.find_elements_by_css_selector(\n-            'form#profilecollection_form tr.dynamic-profile_set#profile_set-2 input[name=profile_set-2-first_name]')), 1)\n+            '.dynamic-profile_set#profile_set-2 input[name=profile_set-2-first_name]')), 1)\n         self.failUnlessEqual(len(self.selenium.find_elements_by_css_selector(\n-            'form#profilecollection_form tr.dynamic-profile_set#profile_set-2 input[name=profile_set-2-last_name]')), 1)\n+            '.dynamic-profile_set#profile_set-2 input[name=profile_set-2-last_name]')), 1)\n \n         # Enter some data and click 'Save'\n         self.selenium.find_element_by_name('profile_set-0-first_name').send_keys('0 first name 1')\n@@ -442,10 +443,17 @@ def test_add_inlines(self):\n         self.selenium.find_element_by_name('profile_set-1-last_name').send_keys('1 last name 2')\n         self.selenium.find_element_by_name('profile_set-2-first_name').send_keys('2 first name 1')\n         self.selenium.find_element_by_name('profile_set-2-last_name').send_keys('2 last name 2')\n+\n         self.selenium.find_element_by_xpath('//input[@value=\"Save\"]').click()\n \n-        # Wait for the next page to be loaded.\n-        self.wait_loaded_tag('body')\n+        try:\n+            # Wait for the next page to be loaded.\n+            self.wait_loaded_tag('body')\n+        except TimeoutException:\n+            # IE7 occasionnally returns an error \"Internet Explorer cannot\n+            # display the webpage\" and doesn't load the next page. We just\n+            # ignore it.\n+            pass\n \n         # Check that the objects have been created in the database\n         self.assertEqual(ProfileCollection.objects.all().count(), 1)\n@@ -491,4 +499,7 @@ def test_delete_inlines(self):\n \n \n class SeleniumChromeTests(SeleniumFirefoxTests):\n-    webdriver_class = 'selenium.webdriver.chrome.webdriver.WebDriver'\n\\ No newline at end of file\n+    webdriver_class = 'selenium.webdriver.chrome.webdriver.WebDriver'\n+\n+class SeleniumIETests(SeleniumFirefoxTests):\n+    webdriver_class = 'selenium.webdriver.ie.webdriver.WebDriver'\n\\ No newline at end of file"
        },
        {
            "sha": "12f1c677af73db17969256a52b52916fbc2f2bf1",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 16,
            "deletions": 2,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/399aa72330d806d2cde36f3e8d0acce11b5f2f4a/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/399aa72330d806d2cde36f3e8d0acce11b5f2f4a/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=399aa72330d806d2cde36f3e8d0acce11b5f2f4a",
            "patch": "@@ -2934,6 +2934,7 @@ def test_basic(self):\n         main form and with stacked and tabular inlines.\n         Refs #13068, #9264, #9983, #9784.\n         \"\"\"\n+        from selenium.common.exceptions import TimeoutException\n         self.admin_login(username='super', password='secret', login_url='/test_admin/admin/')\n         self.selenium.get('%s%s' % (self.live_server_url,\n             '/test_admin/admin/admin_views/mainprepopulated/add/'))\n@@ -2958,7 +2959,7 @@ def test_basic(self):\n         self.assertEqual(slug2, 'option-one-here-stacked-inline')\n \n         # Add an inline\n-        self.selenium.find_element_by_css_selector('#relatedprepopulated_set-group .add-row a').click()\n+        self.selenium.find_elements_by_link_text('Add another Related Prepopulated')[0].click()\n         self.selenium.find_element_by_css_selector('#id_relatedprepopulated_set-1-pubdate').send_keys('1999-01-25')\n         self.get_select_option('#id_relatedprepopulated_set-1-status', 'option two').click()\n         self.selenium.find_element_by_css_selector('#id_relatedprepopulated_set-1-name').send_keys(u' now you haVe anöther   sŤāÇkeð  inline with a very ... loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooog text... ')\n@@ -2978,7 +2979,7 @@ def test_basic(self):\n         self.assertEqual(slug2, 'option-two-and-now-tabular-inline')\n \n         # Add an inline\n-        self.selenium.find_element_by_css_selector('#relatedprepopulated_set-2-group .add-row a').click()\n+        self.selenium.find_elements_by_link_text('Add another Related Prepopulated')[1].click()\n         self.selenium.find_element_by_css_selector('#id_relatedprepopulated_set-2-1-pubdate').send_keys('1981-08-22')\n         self.get_select_option('#id_relatedprepopulated_set-2-1-status', 'option one').click()\n         self.selenium.find_element_by_css_selector('#id_relatedprepopulated_set-2-1-name').send_keys(u'a tÃbűlaŘ inline with ignored ;\"&*^\\%$#@-/`~ characters')\n@@ -2989,6 +2990,16 @@ def test_basic(self):\n \n         # Save and check that everything is properly stored in the database\n         self.selenium.find_element_by_xpath('//input[@value=\"Save\"]').click()\n+\n+        try:\n+            # Wait for the next page to be loaded.\n+            self.wait_loaded_tag('body')\n+        except TimeoutException:\n+            # IE7 occasionnally returns an error \"Internet Explorer cannot\n+            # display the webpage\" and doesn't load the next page. We just\n+            # ignore it.\n+            pass\n+\n         self.assertEqual(MainPrepopulated.objects.all().count(), 1)\n         MainPrepopulated.objects.get(\n             name=u' this is the mAin nÀMë and it\\'s awεšome',\n@@ -3031,6 +3042,9 @@ def test_basic(self):\n class SeleniumPrePopulatedChromeTests(SeleniumPrePopulatedFirefoxTests):\n     webdriver_class = 'selenium.webdriver.chrome.webdriver.WebDriver'\n \n+class SeleniumPrePopulatedIETests(SeleniumPrePopulatedFirefoxTests):\n+    webdriver_class = 'selenium.webdriver.ie.webdriver.WebDriver'\n+\n \n class ReadonlyTest(TestCase):\n     urls = \"regressiontests.admin_views.urls\""
        },
        {
            "sha": "87e0309ddcb8708b06de90f81f250dd8f7a3347c",
            "filename": "tests/regressiontests/admin_widgets/tests.py",
            "status": "modified",
            "additions": 9,
            "deletions": 3,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/399aa72330d806d2cde36f3e8d0acce11b5f2f4a/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/399aa72330d806d2cde36f3e8d0acce11b5f2f4a/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py?ref=399aa72330d806d2cde36f3e8d0acce11b5f2f4a",
            "patch": "@@ -462,6 +462,9 @@ def test_show_hide_date_time_picker_widgets(self):\n class DateTimePickerSeleniumChromeTests(DateTimePickerSeleniumFirefoxTests):\n     webdriver_class = 'selenium.webdriver.chrome.webdriver.WebDriver'\n \n+class DateTimePickerSeleniumIETests(DateTimePickerSeleniumFirefoxTests):\n+    webdriver_class = 'selenium.webdriver.ie.webdriver.WebDriver'\n+\n \n class HorizontalVerticalFilterSeleniumFirefoxTests(AdminSeleniumWebDriverTestCase):\n     webdriver_class = 'selenium.webdriver.firefox.webdriver.WebDriver'\n@@ -515,7 +518,7 @@ def execute_basic_operations(self, mode, field_name):\n         elif mode == 'vertical':\n             # There 's no 'Choose all' button in vertical mode, so individually\n             # select all options and click 'Choose'.\n-            for option in self.selenium.find_elements_by_css_selector(from_box + ' option'):\n+            for option in self.selenium.find_elements_by_css_selector(from_box + ' > option'):\n                 option.click()\n             self.selenium.find_element_by_id(choose_link).click()\n         self.assertSelectOptions(from_box, [])\n@@ -532,7 +535,7 @@ def execute_basic_operations(self, mode, field_name):\n         elif mode == 'vertical':\n             # There 's no 'Remove all' button in vertical mode, so individually\n             # select all options and click 'Remove'.\n-            for option in self.selenium.find_elements_by_css_selector(to_box + ' option'):\n+            for option in self.selenium.find_elements_by_css_selector(to_box + ' > option'):\n                 option.click()\n             self.selenium.find_element_by_id(remove_link).click()\n         self.assertSelectOptions(from_box,\n@@ -685,4 +688,7 @@ def test_filter(self):\n                          [self.jason, self.peter])\n \n class HorizontalVerticalFilterSeleniumChromeTests(HorizontalVerticalFilterSeleniumFirefoxTests):\n-    webdriver_class = 'selenium.webdriver.chrome.webdriver.WebDriver'\n\\ No newline at end of file\n+    webdriver_class = 'selenium.webdriver.chrome.webdriver.WebDriver'\n+\n+class HorizontalVerticalFilterSeleniumIETests(HorizontalVerticalFilterSeleniumFirefoxTests):\n+    webdriver_class = 'selenium.webdriver.ie.webdriver.WebDriver'\n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 81,
        "additions": 56,
        "deletions": 25
    }
}