{
    "author": "ramiro",
    "message": "Enhanced tests for r14857 added in r15185. Refs #14870. Thanks Harm Geerts.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15201 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "7916c754aa91f83a96b2b8b3c54a2f32bdeca740",
    "files": [
        {
            "sha": "a0a05b72b8d19a68f0dd207e2d16e5ae13590be9",
            "filename": "tests/regressiontests/multiple_database/tests.py",
            "status": "modified",
            "additions": 29,
            "deletions": 1,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/7916c754aa91f83a96b2b8b3c54a2f32bdeca740/tests%2Fregressiontests%2Fmultiple_database%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/7916c754aa91f83a96b2b8b3c54a2f32bdeca740/tests%2Fregressiontests%2Fmultiple_database%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmultiple_database%2Ftests.py?ref=7916c754aa91f83a96b2b8b3c54a2f32bdeca740",
            "patch": "@@ -1810,13 +1810,41 @@ def setUp(self):\n     def tearDown(self):\n         router.routers = self.old_routers\n \n-    def test_attribute_error(self):\n+    def test_attribute_error_read(self):\n+        \"Check that the AttributeError from AttributeErrorRouter bubbles up\"\n+        router.routers = [] # Reset routers so we can save a Book instance\n+        b = Book.objects.create(title=\"Pro Django\",\n+                                published=datetime.date(2008, 12, 16))\n+        router.routers = [AttributeErrorRouter()] # Install our router\n+        self.assertRaises(AttributeError, Book.objects.get, pk=b.pk)\n+\n+    def test_attribute_error_save(self):\n         \"Check that the AttributeError from AttributeErrorRouter bubbles up\"\n         dive = Book()\n         dive.title=\"Dive into Python\"\n         dive.published = datetime.date(2009, 5, 4)\n         self.assertRaises(AttributeError, dive.save)\n \n+    def test_attribute_error_delete(self):\n+        \"Check that the AttributeError from AttributeErrorRouter bubbles up\"\n+        router.routers = [] # Reset routers so we can save our Book, Person instances\n+        b = Book.objects.create(title=\"Pro Django\",\n+                                published=datetime.date(2008, 12, 16))\n+        p = Person.objects.create(name=\"Marty Alchin\")\n+        b.authors = [p]\n+        b.editor = p\n+        router.routers = [AttributeErrorRouter()] # Install our router\n+        self.assertRaises(AttributeError, b.delete)\n+\n+    def test_attribute_error_m2m(self):\n+        \"Check that the AttributeError from AttributeErrorRouter bubbles up\"\n+        router.routers = [] # Reset routers so we can save our Book, Person instances\n+        b = Book.objects.create(title=\"Pro Django\",\n+                                published=datetime.date(2008, 12, 16))\n+        p = Person.objects.create(name=\"Marty Alchin\")\n+        router.routers = [AttributeErrorRouter()] # Install our router\n+        self.assertRaises(AttributeError, setattr, b, 'authors', [p])\n+\n class ModelMetaRouter(object):\n     \"A router to ensure model arguments are real model classes\"\n     def db_for_write(self, model, **hints):"
        }
    ],
    "stats": {
        "total": 30,
        "additions": 29,
        "deletions": 1
    }
}