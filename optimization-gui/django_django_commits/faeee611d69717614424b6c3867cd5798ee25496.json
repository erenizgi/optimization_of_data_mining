{
    "author": "jezdez",
    "message": "Fixed #17517 -- Added `--name` option to startproject and startapp management commands to be able to render files without a file extension. Thanks, Florian Apolloner.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17432 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "faeee611d69717614424b6c3867cd5798ee25496",
    "files": [
        {
            "sha": "1d26e97961413755598b61a1125999dffde2783a",
            "filename": "django/core/management/templates.py",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/faeee611d69717614424b6c3867cd5798ee25496/django%2Fcore%2Fmanagement%2Ftemplates.py",
            "raw_url": "https://github.com/django/django/raw/faeee611d69717614424b6c3867cd5798ee25496/django%2Fcore%2Fmanagement%2Ftemplates.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Ftemplates.py?ref=faeee611d69717614424b6c3867cd5798ee25496",
            "patch": "@@ -48,6 +48,11 @@ class TemplateCommand(BaseCommand):\n                     help='The file extension(s) to render (default: \"py\") '\n                          'Separate multiple extensions with commas, or use '\n                          '-e multiple times.'),\n+        make_option('--name', '-n', dest='files',\n+                    action='append', default=[],\n+                    help='The file name(s) to render '\n+                         'Separate multiple extensions with commas, or use '\n+                         '-n multiple times.')\n         )\n     requires_model_validation = False\n     # Can't import settings during this command, because they haven't\n@@ -89,10 +94,16 @@ def handle(self, app_or_project, name, target=None, **options):\n \n         extensions = tuple(\n             handle_extensions(options.get('extensions'), ignored=()))\n+        extra_files = []\n+        for file in options.get('files'):\n+            extra_files.extend(map(lambda x: x.strip(), file.split(',')))\n         if self.verbosity >= 2:\n             self.stdout.write(\"Rendering %s template files with \"\n                               \"extensions: %s\\n\" %\n                               (app_or_project, ', '.join(extensions)))\n+            self.stdout.write(\"Rendering %s template files with \"\n+                              \"filenames: %s\\n\" %\n+                              (app_or_project, ', '.join(extra_files)))\n \n         base_name = '%s_name' % app_or_project\n         base_subdir = '%s_template' % app_or_project\n@@ -142,7 +153,7 @@ def handle(self, app_or_project, name, target=None, **options):\n                 # accidentally render Django templates files\n                 with open(old_path, 'r') as template_file:\n                     content = template_file.read()\n-                if filename.endswith(extensions):\n+                if filename.endswith(extensions) or filename in extra_files:\n                     template = Template(content)\n                     content = template.render(context)\n                 with open(new_path, 'w') as new_file:"
        },
        {
            "sha": "af710ff5fe8b335d962949bef415e82f053df768",
            "filename": "docs/man/django-admin.1",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/faeee611d69717614424b6c3867cd5798ee25496/docs%2Fman%2Fdjango-admin.1",
            "raw_url": "https://github.com/django/django/raw/faeee611d69717614424b6c3867cd5798ee25496/docs%2Fman%2Fdjango-admin.1",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fman%2Fdjango-admin.1?ref=faeee611d69717614424b6c3867cd5798ee25496",
            "patch": "@@ -115,11 +115,11 @@ name(s).\n Prints the SQL statements for resetting PostgreSQL sequences for the\n given app name(s).\n .TP\n-.BI \"startapp [\" \"\\-\\-template=PATH_OR_URL\" \"] [\" \"\\-\\-extension=EXTENSION\" \"] [\" \"appname\" \"] [\" \"destination\" \"]\"\n+.BI \"startapp [\" \"\\-\\-template=PATH_OR_URL\" \"] [\" \"\\-\\-extension=EXTENSION\" \"] [\" \"\\-\\-name=FILENAME\" \"] [\" \"appname\" \"] [\" \"destination\" \"]\"\n Creates a Django app directory structure for the given app name in\n the current directory or the optional destination.\n .TP\n-.BI \"startproject [\" \"\\-\\-template=PATH_OR_URL\" \"] [\" \"\\-\\-extension=EXTENSION\" \"] [\" \"projectname\" \"] [\" \"destination\" \"]\"\n+.BI \"startproject [\" \"\\-\\-template=PATH_OR_URL\" \"] [\" \"\\-\\-extension=EXTENSION\" \"] [\" \"\\-\\-name=FILENAME\" \"] [\" \"projectname\" \"] [\" \"destination\" \"]\"\n Creates a Django project directory structure for the given project name\n in the current directory or the optional destination.\n .TP\n@@ -213,9 +213,12 @@ Don't break long message lines into several lines.\n .I \\-a, \\-\\-all\n Process all available locales when using makemessages..SH \"ENVIRONMENT\"\n .TP\n-.I \\-a, \\-\\-template=PATH_OR_URL\n+.I \\-\\-template=PATH_OR_URL\n The file or directory path or URL to load the project and app templates from.\n .TP\n+.I \\-n, \\-\\-name=FILENAME\n+The name of an additional file to render when using app and project templates.\n+.TP\n .I DJANGO_SETTINGS_MODULE\n In the absence of the\n .BI \\-\\-settings"
        },
        {
            "sha": "aa514606e28beefa5462a0976833f049184c1214",
            "filename": "docs/ref/django-admin.txt",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/faeee611d69717614424b6c3867cd5798ee25496/docs%2Fref%2Fdjango-admin.txt",
            "raw_url": "https://github.com/django/django/raw/faeee611d69717614424b6c3867cd5798ee25496/docs%2Fref%2Fdjango-admin.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fdjango-admin.txt?ref=faeee611d69717614424b6c3867cd5798ee25496",
            "patch": "@@ -951,7 +951,8 @@ creating the ``myapp`` app::\n \n When Django copies the app template files, it also renders the files\n whose extension matches those passed with the ``--extension`` option (``py``\n-by default) using the template engine. The :class:`template context\n+by default) and those files which names are passed with the ``--name`` option\n+using the template engine. The :class:`template context\n <django.template.Context>` used is:\n \n - Any option passed to the startapp command\n@@ -1013,7 +1014,8 @@ when creating the ``myproject`` project::\n \n When Django copies the project template files, it will also render the files\n whose extension matches those passed with the ``--extension`` option (``py``\n-by default) using the template engine. The :class:`template context\n+by default) and those files which names are passed with the ``--name`` option\n+using the template engine. The :class:`template context\n <django.template.Context>` used is:\n \n - Any option passed to the startproject command"
        },
        {
            "sha": "032f0bcd72d9455b967400ac176b79af575b3af0",
            "filename": "tests/regressiontests/admin_scripts/custom_templates/project_template/additional_dir/Procfile",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/faeee611d69717614424b6c3867cd5798ee25496/tests%2Fregressiontests%2Fadmin_scripts%2Fcustom_templates%2Fproject_template%2Fadditional_dir%2FProcfile",
            "raw_url": "https://github.com/django/django/raw/faeee611d69717614424b6c3867cd5798ee25496/tests%2Fregressiontests%2Fadmin_scripts%2Fcustom_templates%2Fproject_template%2Fadditional_dir%2FProcfile",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_scripts%2Fcustom_templates%2Fproject_template%2Fadditional_dir%2FProcfile?ref=faeee611d69717614424b6c3867cd5798ee25496",
            "patch": "@@ -0,0 +1 @@\n+# some file for {{ project_name }} test project\n\\ No newline at end of file"
        },
        {
            "sha": "032f0bcd72d9455b967400ac176b79af575b3af0",
            "filename": "tests/regressiontests/admin_scripts/custom_templates/project_template/additional_dir/requirements.txt",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/faeee611d69717614424b6c3867cd5798ee25496/tests%2Fregressiontests%2Fadmin_scripts%2Fcustom_templates%2Fproject_template%2Fadditional_dir%2Frequirements.txt",
            "raw_url": "https://github.com/django/django/raw/faeee611d69717614424b6c3867cd5798ee25496/tests%2Fregressiontests%2Fadmin_scripts%2Fcustom_templates%2Fproject_template%2Fadditional_dir%2Frequirements.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_scripts%2Fcustom_templates%2Fproject_template%2Fadditional_dir%2Frequirements.txt?ref=faeee611d69717614424b6c3867cd5798ee25496",
            "patch": "@@ -0,0 +1 @@\n+# some file for {{ project_name }} test project\n\\ No newline at end of file"
        },
        {
            "sha": "e981f54c23c444d7d84177ac3fdb4f4e7ed0b18f",
            "filename": "tests/regressiontests/admin_scripts/tests.py",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/faeee611d69717614424b6c3867cd5798ee25496/tests%2Fregressiontests%2Fadmin_scripts%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/faeee611d69717614424b6c3867cd5798ee25496/tests%2Fregressiontests%2Fadmin_scripts%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_scripts%2Ftests.py?ref=faeee611d69717614424b6c3867cd5798ee25496",
            "patch": "@@ -1489,3 +1489,21 @@ def test_project_template_tarball_url(self):\n         self.assertNoOutput(err)\n         self.assertTrue(os.path.isdir(testproject_dir))\n         self.assertTrue(os.path.exists(os.path.join(testproject_dir, 'run.py')))\n+\n+    def test_file_without_extension(self):\n+        \"Make sure the startproject management command is able to render custom files\"\n+        template_path = os.path.join(test_dir, 'admin_scripts', 'custom_templates', 'project_template')\n+        args = ['startproject', '--template', template_path, 'customtestproject', '-e', 'txt', '-n', 'Procfile']\n+        testproject_dir = os.path.join(test_dir, 'customtestproject')\n+\n+        out, err = self.run_django_admin(args)\n+        self.addCleanup(shutil.rmtree, testproject_dir)\n+        self.assertNoOutput(err)\n+        self.assertTrue(os.path.isdir(testproject_dir))\n+        self.assertTrue(os.path.exists(os.path.join(testproject_dir, 'additional_dir')))\n+        base_path = os.path.join(testproject_dir, 'additional_dir')\n+        for f in ('Procfile', 'additional_file.py', 'requirements.txt'):\n+            self.assertTrue(os.path.exists(os.path.join(base_path, f)))\n+            with open(os.path.join(base_path, f)) as fh:\n+                self.assertEqual(fh.read(),\n+                    '# some file for customtestproject test project')"
        }
    ],
    "stats": {
        "total": 48,
        "additions": 42,
        "deletions": 6
    }
}