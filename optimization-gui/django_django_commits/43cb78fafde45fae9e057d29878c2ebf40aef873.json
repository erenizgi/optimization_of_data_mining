{
    "author": "jezdez",
    "message": "Fixed #14506 -- Added an assertion to XViewMiddleware about the dependency on the authentication middleware. Thanks, vanschelven.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16496 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "43cb78fafde45fae9e057d29878c2ebf40aef873",
    "files": [
        {
            "sha": "ee3fe2cb2f7d079b770979bf0e5af8852222f6a9",
            "filename": "django/middleware/doc.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/43cb78fafde45fae9e057d29878c2ebf40aef873/django%2Fmiddleware%2Fdoc.py",
            "raw_url": "https://github.com/django/django/raw/43cb78fafde45fae9e057d29878c2ebf40aef873/django%2Fmiddleware%2Fdoc.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fmiddleware%2Fdoc.py?ref=43cb78fafde45fae9e057d29878c2ebf40aef873",
            "patch": "@@ -12,6 +12,10 @@ def process_view(self, request, view_func, view_args, view_kwargs):\n         indicating the view function.  This is used by the documentation module\n         to lookup the view function for an arbitrary page.\n         \"\"\"\n+        assert hasattr(request, 'user'), (\n+            \"The XView middleware requires authentication middleware to be \"\n+            \"installed. Edit your MIDDLEWARE_CLASSES setting to insert \"\n+            \"'django.contrib.auth.middleware.AuthenticationMiddleware'.\")\n         if request.method == 'HEAD' and (request.META.get('REMOTE_ADDR') in settings.INTERNAL_IPS or\n                                          (request.user.is_active and request.user.is_staff)):\n             response = http.HttpResponse()"
        },
        {
            "sha": "07873219ff28e61f5b1b3595a409b66badbcc87d",
            "filename": "docs/ref/middleware.txt",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/43cb78fafde45fae9e057d29878c2ebf40aef873/docs%2Fref%2Fmiddleware.txt",
            "raw_url": "https://github.com/django/django/raw/43cb78fafde45fae9e057d29878c2ebf40aef873/docs%2Fref%2Fmiddleware.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fmiddleware.txt?ref=43cb78fafde45fae9e057d29878c2ebf40aef873",
            "patch": "@@ -80,6 +80,7 @@ View metadata middleware\n Sends custom ``X-View`` HTTP headers to HEAD requests that come from IP\n addresses defined in the :setting:`INTERNAL_IPS` setting. This is used by\n Django's :doc:`automatic documentation system </ref/contrib/admin/admindocs>`.\n+Depends on :class:`~django.contrib.auth.middleware.AuthenticationMiddleware`.\n \n GZIP middleware\n ---------------"
        },
        {
            "sha": "96f4dd4e7a3f616ed0a3b94275fa1e7f0f773b4c",
            "filename": "tests/regressiontests/utils/decorators.py",
            "status": "modified",
            "additions": 10,
            "deletions": 8,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/43cb78fafde45fae9e057d29878c2ebf40aef873/tests%2Fregressiontests%2Futils%2Fdecorators.py",
            "raw_url": "https://github.com/django/django/raw/43cb78fafde45fae9e057d29878c2ebf40aef873/tests%2Fregressiontests%2Futils%2Fdecorators.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Futils%2Fdecorators.py?ref=43cb78fafde45fae9e057d29878c2ebf40aef873",
            "patch": "@@ -1,24 +1,26 @@\n from django.http import HttpResponse\n-from django.middleware.doc import XViewMiddleware\n from django.template import Template, Context\n from django.template.response import TemplateResponse\n from django.test import TestCase, RequestFactory\n from django.utils.decorators import decorator_from_middleware\n \n \n-xview_dec = decorator_from_middleware(XViewMiddleware)\n+class ProcessViewMiddleware(object):\n+    def process_view(self, request, view_func, view_args, view_kwargs):\n+        pass\n \n+process_view_dec = decorator_from_middleware(ProcessViewMiddleware)\n \n-@xview_dec\n-def xview(request):\n+@process_view_dec\n+def process_view(request):\n     return HttpResponse()\n \n \n-class ClassXView(object):\n+class ClassProcessView(object):\n     def __call__(self, request):\n         return HttpResponse()\n \n-class_xview = xview_dec(ClassXView())\n+class_process_view = process_view_dec(ClassProcessView())\n \n \n class FullMiddleware(object):\n@@ -52,13 +54,13 @@ def test_process_view_middleware(self):\n         \"\"\"\n         Test a middleware that implements process_view.\n         \"\"\"\n-        xview(self.rf.get('/'))\n+        process_view(self.rf.get('/'))\n \n     def test_callable_process_view_middleware(self):\n         \"\"\"\n         Test a middleware that implements process_view, operating on a callable class.\n         \"\"\"\n-        class_xview(self.rf.get('/'))\n+        class_process_view(self.rf.get('/'))\n \n     def test_full_dec_normal(self):\n         \"\"\""
        }
    ],
    "stats": {
        "total": 23,
        "additions": 15,
        "deletions": 8
    }
}