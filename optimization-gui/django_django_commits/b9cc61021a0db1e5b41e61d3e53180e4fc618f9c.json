{
    "author": "joeribekker",
    "message": "Fixed #9084 - Best approach for an OS to atomically rename the session file.",
    "sha": "b9cc61021a0db1e5b41e61d3e53180e4fc618f9c",
    "files": [
        {
            "sha": "9588680fea29af9fb365b8034d2b58b8fb03022e",
            "filename": "django/contrib/sessions/backends/file.py",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/b9cc61021a0db1e5b41e61d3e53180e4fc618f9c/django%2Fcontrib%2Fsessions%2Fbackends%2Ffile.py",
            "raw_url": "https://github.com/django/django/raw/b9cc61021a0db1e5b41e61d3e53180e4fc618f9c/django%2Fcontrib%2Fsessions%2Fbackends%2Ffile.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Fbackends%2Ffile.py?ref=b9cc61021a0db1e5b41e61d3e53180e4fc618f9c",
            "patch": "@@ -1,6 +1,7 @@\n import datetime\n import errno\n import os\n+import shutil\n import tempfile\n \n from django.conf import settings\n@@ -147,7 +148,11 @@ def save(self, must_create=False):\n                     os.write(output_file_fd, self.encode(session_data).encode())\n                 finally:\n                     os.close(output_file_fd)\n-                os.rename(output_file_name, session_file_name)\n+\n+                # This will atomically rename the file (os.rename) if the OS\n+                # supports it. Otherwise this will result in a shutil.copy2\n+                # and os.unlink (for example on Windows). See #9084.\n+                shutil.move(output_file_name, session_file_name)\n                 renamed = True\n             finally:\n                 if not renamed:"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
    }
}