{
    "author": "konradhalas",
    "message": "Fixed #19811 - Added language code fallback in get_language_info.",
    "sha": "6bd6a568960e9ddebd78da8e008b235b3b76c5a2",
    "files": [
        {
            "sha": "4645f142ceb3ba763d1e53fa140baf67b6b95cf6",
            "filename": "django/utils/translation/__init__.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/6bd6a568960e9ddebd78da8e008b235b3b76c5a2/django%2Futils%2Ftranslation%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/6bd6a568960e9ddebd78da8e008b235b3b76c5a2/django%2Futils%2Ftranslation%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2F__init__.py?ref=6bd6a568960e9ddebd78da8e008b235b3b76c5a2",
            "patch": "@@ -187,4 +187,10 @@ def get_language_info(lang_code):\n     try:\n         return LANG_INFO[lang_code]\n     except KeyError:\n+        if '-' in lang_code:\n+            splited_lang_code = lang_code.split('-')[0]\n+            try:\n+                return LANG_INFO[splited_lang_code]\n+            except KeyError:\n+                raise KeyError(\"Unknown language code %r and %r.\" % (lang_code, splited_lang_code))\n         raise KeyError(\"Unknown language code %r.\" % lang_code)"
        },
        {
            "sha": "9e79f35d74494a4fd94b1bc00c5484fca2c7e7dd",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/6bd6a568960e9ddebd78da8e008b235b3b76c5a2/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/6bd6a568960e9ddebd78da8e008b235b3b76c5a2/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=6bd6a568960e9ddebd78da8e008b235b3b76c5a2",
            "patch": "@@ -956,6 +956,21 @@ def test_localized_language_info(self):\n         self.assertEqual(li['name'], 'German')\n         self.assertEqual(li['bidi'], False)\n \n+    def test_unknown_language_code(self):\n+        with self.assertRaisesRegexp(KeyError, \"Unknown language code u\\'xx\\'.\"):\n+            get_language_info('xx')\n+\n+    def test_unknown_only_country_code(self):\n+        li = get_language_info('de-xx')\n+        self.assertEqual(li['code'], 'de')\n+        self.assertEqual(li['name_local'], 'Deutsch')\n+        self.assertEqual(li['name'], 'German')\n+        self.assertEqual(li['bidi'], False)\n+\n+    def test_unknown_language_code_and_country_code(self):\n+        with self.assertRaisesRegexp(KeyError, \"Unknown language code u\\'xx-xx\\' and u\\'xx\\'.\"):\n+            get_language_info('xx-xx')\n+\n \n class MultipleLocaleActivationTests(TestCase):\n     \"\"\""
        }
    ],
    "stats": {
        "total": 21,
        "additions": 21,
        "deletions": 0
    }
}