{
    "author": "jezdez",
    "message": "Fixes #15270 -- Moved back the serve view to django.views.static due to dependency conflicts with the contrib app staticfiles (reverts parts of r14293). Added a helper function that generates URL patterns for serving static and media files during development. Thanks to Carl for reviewing the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15530 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "a26034ffbf8951276b79ccb298423bc809246637",
    "files": [
        {
            "sha": "f90b8b5cab277039ce605b53e3979e79285324d7",
            "filename": "django/conf/urls/static.py",
            "status": "added",
            "additions": 26,
            "deletions": 0,
            "changes": 26,
            "blob_url": "https://github.com/django/django/blob/a26034ffbf8951276b79ccb298423bc809246637/django%2Fconf%2Furls%2Fstatic.py",
            "raw_url": "https://github.com/django/django/raw/a26034ffbf8951276b79ccb298423bc809246637/django%2Fconf%2Furls%2Fstatic.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fconf%2Furls%2Fstatic.py?ref=a26034ffbf8951276b79ccb298423bc809246637",
            "patch": "@@ -0,0 +1,26 @@\n+import re\n+from django.conf import settings\n+from django.conf.urls.defaults import patterns, url\n+from django.core.exceptions import ImproperlyConfigured\n+\n+def static(prefix, view='django.views.static.serve', **kwargs):\n+    \"\"\"\n+    Helper function to return a URL pattern for serving files in debug mode.\n+\n+    from django.conf import settings\n+    from django.conf.urls.static import static\n+\n+    urlpatterns = patterns('',\n+        # ... the rest of your URLconf goes here ...\n+    ) + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)\n+\n+    \"\"\"\n+    if not settings.DEBUG:\n+        return []\n+    elif not prefix:\n+        raise ImproperlyConfigured(\"Empty static prefix not permitted\")\n+    elif '://' in prefix:\n+        raise ImproperlyConfigured(\"URL '%s' not allowed as static prefix\" % prefix)\n+    return patterns('',\n+        url(r'^%s(?P<path>.*)$' % re.escape(prefix.lstrip('/')), view, **kwargs),\n+    )"
        },
        {
            "sha": "04062c1162b5aa62d9995f4804e94dd12feea121",
            "filename": "django/contrib/staticfiles/urls.py",
            "status": "modified",
            "additions": 6,
            "deletions": 18,
            "changes": 24,
            "blob_url": "https://github.com/django/django/blob/a26034ffbf8951276b79ccb298423bc809246637/django%2Fcontrib%2Fstaticfiles%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/a26034ffbf8951276b79ccb298423bc809246637/django%2Fcontrib%2Fstaticfiles%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fstaticfiles%2Furls.py?ref=a26034ffbf8951276b79ccb298423bc809246637",
            "patch": "@@ -1,28 +1,16 @@\n-import re\n from django.conf import settings\n-from django.conf.urls.defaults import patterns, url, include\n-from django.core.exceptions import ImproperlyConfigured\n+from django.conf.urls.static import static\n \n urlpatterns = []\n \n-# only serve non-fqdn URLs\n-if settings.DEBUG:\n-    urlpatterns += patterns('',\n-        url(r'^(?P<path>.*)$', 'django.contrib.staticfiles.views.serve'),\n-    )\n-\n def staticfiles_urlpatterns(prefix=None):\n     \"\"\"\n     Helper function to return a URL pattern for serving static files.\n     \"\"\"\n-    if not settings.DEBUG:\n-        return []\n     if prefix is None:\n         prefix = settings.STATIC_URL\n-    if not prefix or '://' in prefix:\n-        raise ImproperlyConfigured(\n-            \"The prefix for the 'staticfiles_urlpatterns' helper is invalid.\")\n-    if prefix.startswith(\"/\"):\n-        prefix = prefix[1:]\n-    return patterns('',\n-        url(r'^%s' % re.escape(prefix), include(urlpatterns)),)\n+    return static(prefix, view='django.contrib.staticfiles.views.serve')\n+\n+# Only append if urlpatterns are empty\n+if settings.DEBUG and not urlpatterns:\n+    urlpatterns += staticfiles_urlpatterns()"
        },
        {
            "sha": "123a01a557200c37c38ca977d372396e550da37b",
            "filename": "django/contrib/staticfiles/views.py",
            "status": "modified",
            "additions": 13,
            "deletions": 140,
            "changes": 153,
            "blob_url": "https://github.com/django/django/blob/a26034ffbf8951276b79ccb298423bc809246637/django%2Fcontrib%2Fstaticfiles%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/a26034ffbf8951276b79ccb298423bc809246637/django%2Fcontrib%2Fstaticfiles%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fstaticfiles%2Fviews.py?ref=a26034ffbf8951276b79ccb298423bc809246637",
            "patch": "@@ -3,163 +3,36 @@\n development, and SHOULD NOT be used in a production setting.\n \n \"\"\"\n-import mimetypes\n import os\n import posixpath\n-import re\n-import stat\n import urllib\n-from email.Utils import parsedate_tz, mktime_tz\n \n from django.conf import settings\n from django.core.exceptions import ImproperlyConfigured\n-from django.http import Http404, HttpResponse, HttpResponseRedirect, HttpResponseNotModified\n-from django.template import loader, Template, Context, TemplateDoesNotExist\n-from django.utils.http import http_date\n+from django.http import Http404\n+from django.views import static\n \n-from django.contrib.staticfiles import finders, utils\n+from django.contrib.staticfiles import finders\n \n-\n-def serve(request, path, document_root=None, show_indexes=False, insecure=False):\n+def serve(request, path, document_root=None, insecure=False, **kwargs):\n     \"\"\"\n     Serve static files below a given point in the directory structure or\n-    from locations inferred from the static files finders.\n+    from locations inferred from the staticfiles finders.\n \n     To use, put a URL pattern such as::\n \n         (r'^(?P<path>.*)$', 'django.contrib.staticfiles.views.serve')\n \n     in your URLconf.\n \n-    If you provide the ``document_root`` parameter, the file won't be looked\n-    up with the staticfiles finders, but in the given filesystem path, e.g.::\n-\n-    (r'^(?P<path>.*)$', 'django.contrib.staticfiles.views.serve', {'document_root' : '/path/to/my/files/'})\n-\n-    You may also set ``show_indexes`` to ``True`` if you'd like to serve a\n-    basic index of the directory.  This index view will use the\n-    template hardcoded below, but if you'd like to override it, you can create\n-    a template called ``static/directory_index.html``.\n+    It automatically falls back to django.views.static\n     \"\"\"\n     if not settings.DEBUG and not insecure:\n-        raise ImproperlyConfigured(\"The view to serve static files can only \"\n-                                   \"be used if the DEBUG setting is True or \"\n-                                   \"the --insecure option of 'runserver' is \"\n-                                   \"used\")\n-    if not document_root:\n-        path = os.path.normpath(path)\n-        absolute_path = finders.find(path)\n-        if not absolute_path:\n-            raise Http404('\"%s\" could not be found' % path)\n+        raise ImproperlyConfigured(\"The staticfiles view can only be used in \"\n+                                   \"debug mode or if the the --insecure \"\n+                                   \"option of 'runserver' is used\")\n+    normalized_path = posixpath.normpath(urllib.unquote(path)).lstrip('/')\n+    absolute_path = finders.find(normalized_path)\n+    if absolute_path:\n         document_root, path = os.path.split(absolute_path)\n-    # Clean up given path to only allow serving files below document_root.\n-    path = posixpath.normpath(urllib.unquote(path))\n-    path = path.lstrip('/')\n-    newpath = ''\n-    for part in path.split('/'):\n-        if not part:\n-            # Strip empty path components.\n-            continue\n-        drive, part = os.path.splitdrive(part)\n-        head, part = os.path.split(part)\n-        if part in (os.curdir, os.pardir):\n-            # Strip '.' and '..' in path.\n-            continue\n-        newpath = os.path.join(newpath, part).replace('\\\\', '/')\n-    if newpath and path != newpath:\n-        return HttpResponseRedirect(newpath)\n-    fullpath = os.path.join(document_root, newpath)\n-    if os.path.isdir(fullpath):\n-        if show_indexes:\n-            return directory_index(newpath, fullpath)\n-        raise Http404(\"Directory indexes are not allowed here.\")\n-    if not os.path.exists(fullpath):\n-        raise Http404('\"%s\" does not exist' % fullpath)\n-    # Respect the If-Modified-Since header.\n-    statobj = os.stat(fullpath)\n-    mimetype, encoding = mimetypes.guess_type(fullpath)\n-    mimetype = mimetype or 'application/octet-stream'\n-    if not was_modified_since(request.META.get('HTTP_IF_MODIFIED_SINCE'),\n-                              statobj[stat.ST_MTIME], statobj[stat.ST_SIZE]):\n-        return HttpResponseNotModified(mimetype=mimetype)\n-    contents = open(fullpath, 'rb').read()\n-    response = HttpResponse(contents, mimetype=mimetype)\n-    response[\"Last-Modified\"] = http_date(statobj[stat.ST_MTIME])\n-    response[\"Content-Length\"] = len(contents)\n-    if encoding:\n-        response[\"Content-Encoding\"] = encoding\n-    return response\n-\n-\n-DEFAULT_DIRECTORY_INDEX_TEMPLATE = \"\"\"\n-<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n-<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n-  <head>\n-    <meta http-equiv=\"Content-type\" content=\"text/html; charset=utf-8\" />\n-    <meta http-equiv=\"Content-Language\" content=\"en-us\" />\n-    <meta name=\"robots\" content=\"NONE,NOARCHIVE\" />\n-    <title>Index of {{ directory }}</title>\n-  </head>\n-  <body>\n-    <h1>Index of {{ directory }}</h1>\n-    <ul>\n-      {% ifnotequal directory \"/\" %}\n-      <li><a href=\"../\">../</a></li>\n-      {% endifnotequal %}\n-      {% for f in file_list %}\n-      <li><a href=\"{{ f|urlencode }}\">{{ f }}</a></li>\n-      {% endfor %}\n-    </ul>\n-  </body>\n-</html>\n-\"\"\"\n-\n-def directory_index(path, fullpath):\n-    try:\n-        t = loader.select_template(['static/directory_index.html',\n-                'static/directory_index'])\n-    except TemplateDoesNotExist:\n-        t = Template(DEFAULT_DIRECTORY_INDEX_TEMPLATE, name='Default directory index template')\n-    files = []\n-    for f in os.listdir(fullpath):\n-        if not f.startswith('.'):\n-            if os.path.isdir(os.path.join(fullpath, f)):\n-                f += '/'\n-            files.append(f)\n-    c = Context({\n-        'directory' : path + '/',\n-        'file_list' : files,\n-    })\n-    return HttpResponse(t.render(c))\n-\n-def was_modified_since(header=None, mtime=0, size=0):\n-    \"\"\"\n-    Was something modified since the user last downloaded it?\n-\n-    header\n-      This is the value of the If-Modified-Since header.  If this is None,\n-      I'll just return True.\n-\n-    mtime\n-      This is the modification time of the item we're talking about.\n-\n-    size\n-      This is the size of the item we're talking about.\n-    \"\"\"\n-    try:\n-        if header is None:\n-            raise ValueError\n-        matches = re.match(r\"^([^;]+)(; length=([0-9]+))?$\", header,\n-                           re.IGNORECASE)\n-        header_date = parsedate_tz(matches.group(1))\n-        if header_date is None:\n-            raise ValueError\n-        header_mtime = mktime_tz(header_date)\n-        header_len = matches.group(3)\n-        if header_len and int(header_len) != size:\n-            raise ValueError\n-        if mtime > header_mtime:\n-            raise ValueError\n-    except (AttributeError, ValueError, OverflowError):\n-        return True\n-    return False\n+    return static.serve(request, path, document_root=document_root, **kwargs)"
        },
        {
            "sha": "4e179dc7c0d5a2e5471857cce64a1f273f25132f",
            "filename": "django/core/servers/basehttp.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/a26034ffbf8951276b79ccb298423bc809246637/django%2Fcore%2Fservers%2Fbasehttp.py",
            "raw_url": "https://github.com/django/django/raw/a26034ffbf8951276b79ccb298423bc809246637/django%2Fcore%2Fservers%2Fbasehttp.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fservers%2Fbasehttp.py?ref=a26034ffbf8951276b79ccb298423bc809246637",
            "patch": "@@ -18,8 +18,9 @@\n from django.core.management.color import color_style\n from django.utils.http import http_date\n from django.utils._os import safe_join\n+from django.views import static\n \n-from django.contrib.staticfiles import handlers, views as static\n+from django.contrib.staticfiles import handlers\n \n __version__ = \"0.1\"\n __all__ = ['WSGIServer','WSGIRequestHandler']\n@@ -677,8 +678,7 @@ def file_path(self, url):\n \n     def serve(self, request):\n         document_root, path = os.path.split(self.file_path(request.path))\n-        return static.serve(request, path,\n-            document_root=document_root, insecure=True)\n+        return static.serve(request, path, document_root=document_root)\n \n     def _should_handle(self, path):\n         \"\"\""
        },
        {
            "sha": "da1158d9d25ea209d28303a8e59f1bc26b14edee",
            "filename": "django/views/static.py",
            "status": "modified",
            "additions": 111,
            "deletions": 10,
            "changes": 121,
            "blob_url": "https://github.com/django/django/blob/a26034ffbf8951276b79ccb298423bc809246637/django%2Fviews%2Fstatic.py",
            "raw_url": "https://github.com/django/django/raw/a26034ffbf8951276b79ccb298423bc809246637/django%2Fviews%2Fstatic.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fviews%2Fstatic.py?ref=a26034ffbf8951276b79ccb298423bc809246637",
            "patch": "@@ -9,19 +9,14 @@\n import re\n import stat\n import urllib\n-import warnings\n from email.Utils import parsedate_tz, mktime_tz\n \n from django.template import loader\n from django.http import Http404, HttpResponse, HttpResponseRedirect, HttpResponseNotModified\n from django.template import Template, Context, TemplateDoesNotExist\n from django.utils.http import http_date\n \n-from django.contrib.staticfiles.views import (directory_index,\n-    was_modified_since, serve as staticfiles_serve)\n-\n-\n-def serve(request, path, document_root=None, show_indexes=False, insecure=False):\n+def serve(request, path, document_root=None, show_indexes=False):\n     \"\"\"\n     Serve static files below a given point in the directory structure.\n \n@@ -35,7 +30,113 @@ def serve(request, path, document_root=None, show_indexes=False, insecure=False)\n     but if you'd like to override it, you can create a template called\n     ``static/directory_index.html``.\n     \"\"\"\n-    warnings.warn(\"The view at `django.views.static.serve` is deprecated; \"\n-                  \"use the path `django.contrib.staticfiles.views.serve` \"\n-                  \"instead.\", PendingDeprecationWarning)\n-    return staticfiles_serve(request, path, document_root, show_indexes, insecure)\n+    path = posixpath.normpath(urllib.unquote(path))\n+    path = path.lstrip('/')\n+    newpath = ''\n+    for part in path.split('/'):\n+        if not part:\n+            # Strip empty path components.\n+            continue\n+        drive, part = os.path.splitdrive(part)\n+        head, part = os.path.split(part)\n+        if part in (os.curdir, os.pardir):\n+            # Strip '.' and '..' in path.\n+            continue\n+        newpath = os.path.join(newpath, part).replace('\\\\', '/')\n+    if newpath and path != newpath:\n+        return HttpResponseRedirect(newpath)\n+    fullpath = os.path.join(document_root, newpath)\n+    if os.path.isdir(fullpath):\n+        if show_indexes:\n+            return directory_index(newpath, fullpath)\n+        raise Http404(\"Directory indexes are not allowed here.\")\n+    if not os.path.exists(fullpath):\n+        raise Http404('\"%s\" does not exist' % fullpath)\n+    # Respect the If-Modified-Since header.\n+    statobj = os.stat(fullpath)\n+    mimetype, encoding = mimetypes.guess_type(fullpath)\n+    mimetype = mimetype or 'application/octet-stream'\n+    if not was_modified_since(request.META.get('HTTP_IF_MODIFIED_SINCE'),\n+                              statobj[stat.ST_MTIME], statobj[stat.ST_SIZE]):\n+        return HttpResponseNotModified(mimetype=mimetype)\n+    contents = open(fullpath, 'rb').read()\n+    response = HttpResponse(contents, mimetype=mimetype)\n+    response[\"Last-Modified\"] = http_date(statobj[stat.ST_MTIME])\n+    response[\"Content-Length\"] = len(contents)\n+    if encoding:\n+        response[\"Content-Encoding\"] = encoding\n+    return response\n+\n+\n+DEFAULT_DIRECTORY_INDEX_TEMPLATE = \"\"\"\n+<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n+<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n+  <head>\n+    <meta http-equiv=\"Content-type\" content=\"text/html; charset=utf-8\" />\n+    <meta http-equiv=\"Content-Language\" content=\"en-us\" />\n+    <meta name=\"robots\" content=\"NONE,NOARCHIVE\" />\n+    <title>Index of {{ directory }}</title>\n+  </head>\n+  <body>\n+    <h1>Index of {{ directory }}</h1>\n+    <ul>\n+      {% ifnotequal directory \"/\" %}\n+      <li><a href=\"../\">../</a></li>\n+      {% endifnotequal %}\n+      {% for f in file_list %}\n+      <li><a href=\"{{ f|urlencode }}\">{{ f }}</a></li>\n+      {% endfor %}\n+    </ul>\n+  </body>\n+</html>\n+\"\"\"\n+\n+def directory_index(path, fullpath):\n+    try:\n+        t = loader.select_template(['static/directory_index.html',\n+                'static/directory_index'])\n+    except TemplateDoesNotExist:\n+        t = Template(DEFAULT_DIRECTORY_INDEX_TEMPLATE, name='Default directory index template')\n+    files = []\n+    for f in os.listdir(fullpath):\n+        if not f.startswith('.'):\n+            if os.path.isdir(os.path.join(fullpath, f)):\n+                f += '/'\n+            files.append(f)\n+    c = Context({\n+        'directory' : path + '/',\n+        'file_list' : files,\n+    })\n+    return HttpResponse(t.render(c))\n+\n+def was_modified_since(header=None, mtime=0, size=0):\n+    \"\"\"\n+    Was something modified since the user last downloaded it?\n+\n+    header\n+      This is the value of the If-Modified-Since header.  If this is None,\n+      I'll just return True.\n+\n+    mtime\n+      This is the modification time of the item we're talking about.\n+\n+    size\n+      This is the size of the item we're talking about.\n+    \"\"\"\n+    try:\n+        if header is None:\n+            raise ValueError\n+        matches = re.match(r\"^([^;]+)(; length=([0-9]+))?$\", header,\n+                           re.IGNORECASE)\n+        header_date = parsedate_tz(matches.group(1))\n+        if header_date is None:\n+            raise ValueError\n+        header_mtime = mktime_tz(header_date)\n+        header_len = matches.group(3)\n+        if header_len and int(header_len) != size:\n+            raise ValueError\n+        if mtime > header_mtime:\n+            raise ValueError\n+    except (AttributeError, ValueError, OverflowError):\n+        return True\n+    return False"
        },
        {
            "sha": "3faeaeba4157b55451f613ba8ac6066fe446b67e",
            "filename": "docs/howto/static-files.txt",
            "status": "modified",
            "additions": 62,
            "deletions": 9,
            "changes": 71,
            "blob_url": "https://github.com/django/django/blob/a26034ffbf8951276b79ccb298423bc809246637/docs%2Fhowto%2Fstatic-files.txt",
            "raw_url": "https://github.com/django/django/raw/a26034ffbf8951276b79ccb298423bc809246637/docs%2Fhowto%2Fstatic-files.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fhowto%2Fstatic-files.txt?ref=a26034ffbf8951276b79ccb298423bc809246637",
            "patch": "@@ -2,8 +2,6 @@\n Managing static files\n =====================\n \n-.. currentmodule:: django.contrib.staticfiles\n-\n .. versionadded:: 1.3\n \n Django developers mostly concern themselves with the dynamic parts of web\n@@ -109,10 +107,9 @@ the framework see :doc:`the staticfiles reference </ref/contrib/staticfiles>`.\n    :setting:`MEDIA_URL` different from your :setting:`STATIC_ROOT` and\n    :setting:`STATIC_URL`. You will need to arrange for serving of files in\n    :setting:`MEDIA_ROOT` yourself; ``staticfiles`` does not deal with\n-   user-uploaded files at all. You can, however, use ``staticfiles``'\n-   :func:`~django.contrib.staticfiles.views.serve` view for serving\n-   :setting:`MEDIA_ROOT` in development; see\n-   :ref:`staticfiles-serve-other-directories`.\n+   user-uploaded files at all. You can, however, use\n+   :func:`~django.views.static.serve` view for serving :setting:`MEDIA_ROOT`\n+   in development; see :ref:`staticfiles-other-directories`.\n \n .. _staticfiles-in-templates:\n \n@@ -241,8 +238,64 @@ files in app directories.\n     :setting:`STATIC_URL` setting can't be empty or a full URL, such as\n     ``http://static.example.com/``.\n \n-For a few more details, including an alternate method of enabling this view,\n-see :ref:`staticfiles-development-view`.\n+For a few more details on how the ``staticfiles`` can be used during\n+development, see :ref:`staticfiles-development-view`.\n+\n+.. _staticfiles-other-directories:\n+\n+Serving other directories\n+-------------------------\n+\n+.. currentmodule:: django.views.static\n+.. function:: serve(request, path, document_root, show_indexes=False)\n+\n+There may be files other than your project's static assets that, for\n+convenience, you'd like to have Django serve for you in local development.\n+The :func:`~django.views.static.serve` view can be used to serve any directory\n+you give it. (Again, this view is **not** hardened for production\n+use, and should be used only as a development aid; you should serve these files\n+in production using a real front-end webserver).\n+\n+The most likely example is user-uploaded content in :setting:`MEDIA_ROOT`.\n+``staticfiles`` is intended for static assets and has no built-in handling\n+for user-uploaded files, but you can have Django serve your\n+:setting:`MEDIA_ROOT` by appending something like this to your URLconf::\n+\n+    from django.conf import settings\n+\n+    # ... the rest of your URLconf goes here ...\n+\n+    if settings.DEBUG:\n+        urlpatterns += patterns('',\n+            url(r'^media/(?P<path>.*)$', 'django.views.static', {\n+                'document_root': settings.MEDIA_ROOT,\n+            }),\n+       )\n+\n+Note, the snippet assumes your :setting:`MEDIA_URL` has a value of\n+``'/media/'``. This will call the :func:`~django.views.static.serve` view,\n+passing in the path from the URLconf and the (required) ``document_root``\n+parameter.\n+\n+.. currentmodule:: django.conf.urls.static\n+.. function:: static(prefix, view='django.views.static.serve', **kwargs)\n+\n+Since it can become a bit cumbersome to define this URL pattern, Django\n+ships with a small URL helper function\n+:func:`~django.conf.urls.static.static` that taks as parameters the prefix\n+such as :setting:`MEDIA_URL` and a dotted path to a view, such as\n+``'django.views.static.serve'``. Any other function parameter will be\n+transparently passed to the view.\n+\n+An example for serving :setting:`MEDIA_URL` (``'/media/'``) during\n+development::\n+\n+    from django.conf import settings\n+    from django.conf.urls.static import static\n+\n+    urlpatterns = patterns('',\n+        # ... the rest of your URLconf goes here ...\n+    ) + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)\n \n .. _staticfiles-production:\n \n@@ -395,7 +448,7 @@ Upgrading from ``django-staticfiles``\n =====================================\n \n ``django.contrib.staticfiles`` began its life as `django-staticfiles`_. If\n-you're upgrading from `django-staticfiles`_ < ``1.0``` (e.g. ``0.3.4``) to\n+you're upgrading from `django-staticfiles`_ older than 1.0 (e.g. 0.3.4) to\n ``django.contrib.staticfiles``, you'll need to make a few changes:\n \n     * Application files should now live in a ``static`` directory in each app"
        },
        {
            "sha": "b06620d0854ee9bd4cb41ef2a1fc03ab0dae6b76",
            "filename": "docs/ref/contrib/staticfiles.txt",
            "status": "modified",
            "additions": 0,
            "deletions": 28,
            "changes": 28,
            "blob_url": "https://github.com/django/django/blob/a26034ffbf8951276b79ccb298423bc809246637/docs%2Fref%2Fcontrib%2Fstaticfiles.txt",
            "raw_url": "https://github.com/django/django/raw/a26034ffbf8951276b79ccb298423bc809246637/docs%2Fref%2Fcontrib%2Fstaticfiles.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fstaticfiles.txt?ref=a26034ffbf8951276b79ccb298423bc809246637",
            "patch": "@@ -317,31 +317,3 @@ already defined pattern list. Use it like this::\n     This helper function will only work if :setting:`DEBUG` is ``True``\n     and your :setting:`STATIC_URL` setting is neither empty nor a full\n     URL such as ``http://static.example.com/``.\n-\n-.. _staticfiles-serve-other-directories:\n-\n-Serving other directories\n-\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n-\n-There may be files other than your project's static assets that, for\n-convenience, you'd like to have Django serve for you in local development. The\n-:func:`~django.contrib.staticfiles.views.serve` view can be used to serve any\n-directory you give it. (Again, this view is **not** hardened for production\n-use, and should be used only as a development aid; you should serve these files\n-in production using a real front-end webserver).\n-\n-The most likely example is user-uploaded content in :setting:`MEDIA_ROOT`.\n-``staticfiles`` is intended for static assets and has no built-in handling for\n-user-uploaded files, but you can have Django serve your :setting:`MEDIA_ROOT`\n-by appending something like this to your URLconf::\n-\n-   from django.conf import settings\n-\n-   if settings.DEBUG:\n-       urlpatterns += patterns('django.contrib.staticfiles.views',\n-           url(r'^media/(?P<path>.*)$', 'serve',\n-               {'document_root': settings.MEDIA_ROOT}),\n-       )\n-\n-This snippet assumes you've also set your :setting:`MEDIA_URL` (in development)\n-to ``/media/``."
        },
        {
            "sha": "0ceb11bafdbd5587d9b38a8156a5e81665409eb0",
            "filename": "tests/regressiontests/staticfiles_tests/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/a26034ffbf8951276b79ccb298423bc809246637/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a26034ffbf8951276b79ccb298423bc809246637/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py?ref=a26034ffbf8951276b79ccb298423bc809246637",
            "patch": "@@ -293,9 +293,8 @@ def setUp(self):\n         settings.DEBUG = False\n \n     def test_disabled_serving(self):\n-        self.assertRaisesRegexp(ImproperlyConfigured, 'The view to serve '\n-            'static files can only be used if the DEBUG setting is True',\n-            self._response, 'test.txt')\n+        self.assertRaisesRegexp(ImproperlyConfigured, 'The staticfiles view '\n+            'can only be used in debug mode ', self._response, 'test.txt')\n \n \n class TestServeStaticWithDefaultURL(TestServeStatic, TestDefaults):"
        }
    ],
    "stats": {
        "total": 434,
        "additions": 223,
        "deletions": 211
    }
}