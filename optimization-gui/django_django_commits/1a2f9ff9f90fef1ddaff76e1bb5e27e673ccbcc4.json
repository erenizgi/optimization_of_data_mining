{
    "author": "ramiro",
    "message": "Modified a few tests methods to make sure no leaks of activated locale or USE_I10N setting value happen between tests.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15411 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "1a2f9ff9f90fef1ddaff76e1bb5e27e673ccbcc4",
    "files": [
        {
            "sha": "442fb1ef80c33165bcb02bb7f70986629c01ce20",
            "filename": "tests/regressiontests/admin_widgets/tests.py",
            "status": "modified",
            "additions": 10,
            "deletions": 8,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/1a2f9ff9f90fef1ddaff76e1bb5e27e673ccbcc4/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/1a2f9ff9f90fef1ddaff76e1bb5e27e673ccbcc4/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py?ref=1a2f9ff9f90fef1ddaff76e1bb5e27e673ccbcc4",
            "patch": "@@ -210,14 +210,16 @@ def test_localization(self):\n \n         activate('de-at')\n         old_USE_L10N = settings.USE_L10N\n-        settings.USE_L10N = True\n-        w.is_localized = True\n-        self.assertEqual(\n-            conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n-            '<p class=\"datetime\">Datum: <input value=\"01.12.2007\" type=\"text\" class=\"vDateField\" name=\"test_0\" size=\"10\" /><br />Zeit: <input value=\"09:30:00\" type=\"text\" class=\"vTimeField\" name=\"test_1\" size=\"8\" /></p>',\n-        )\n-        deactivate()\n-        settings.USE_L10N = old_USE_L10N\n+        try:\n+            settings.USE_L10N = True\n+            w.is_localized = True\n+            self.assertEqual(\n+                conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n+                '<p class=\"datetime\">Datum: <input value=\"01.12.2007\" type=\"text\" class=\"vDateField\" name=\"test_0\" size=\"10\" /><br />Zeit: <input value=\"09:30:00\" type=\"text\" class=\"vTimeField\" name=\"test_1\" size=\"8\" /></p>',\n+            )\n+        finally:\n+            deactivate()\n+            settings.USE_L10N = old_USE_L10N\n \n \n class AdminFileWidgetTest(DjangoTestCase):"
        },
        {
            "sha": "f3fda9ae23896e52df49a4c9113ce35d3e73413d",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 12,
            "deletions": 17,
            "changes": 29,
            "blob_url": "https://github.com/django/django/blob/1a2f9ff9f90fef1ddaff76e1bb5e27e673ccbcc4/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/1a2f9ff9f90fef1ddaff76e1bb5e27e673ccbcc4/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=1a2f9ff9f90fef1ddaff76e1bb5e27e673ccbcc4",
            "patch": "@@ -253,10 +253,8 @@ def test_l10n_disabled(self):\n             deactivate()\n \n     def test_l10n_enabled(self):\n-        \"\"\"\n-        Catalan locale\n-        \"\"\"\n         settings.USE_L10N = True\n+        # Catalan locale\n         activate('ca')\n         try:\n             self.assertEqual('j \\de F \\de Y', get_format('DATE_FORMAT'))\n@@ -345,15 +343,15 @@ def test_l10n_enabled(self):\n \n         # Russian locale (with E as month)\n         activate('ru')\n-        self.assertEqual(\n-                u'<select name=\"mydate_day\" id=\"id_mydate_day\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"4\">4</option>\\n<option value=\"5\">5</option>\\n<option value=\"6\">6</option>\\n<option value=\"7\">7</option>\\n<option value=\"8\">8</option>\\n<option value=\"9\">9</option>\\n<option value=\"10\">10</option>\\n<option value=\"11\">11</option>\\n<option value=\"12\">12</option>\\n<option value=\"13\">13</option>\\n<option value=\"14\">14</option>\\n<option value=\"15\">15</option>\\n<option value=\"16\">16</option>\\n<option value=\"17\">17</option>\\n<option value=\"18\">18</option>\\n<option value=\"19\">19</option>\\n<option value=\"20\">20</option>\\n<option value=\"21\">21</option>\\n<option value=\"22\">22</option>\\n<option value=\"23\">23</option>\\n<option value=\"24\">24</option>\\n<option value=\"25\">25</option>\\n<option value=\"26\">26</option>\\n<option value=\"27\">27</option>\\n<option value=\"28\">28</option>\\n<option value=\"29\">29</option>\\n<option value=\"30\">30</option>\\n<option value=\"31\" selected=\"selected\">31</option>\\n</select>\\n<select name=\"mydate_month\" id=\"id_mydate_month\">\\n<option value=\"1\">\\u042f\\u043d\\u0432\\u0430\\u0440\\u044c</option>\\n<option value=\"2\">\\u0424\\u0435\\u0432\\u0440\\u0430\\u043b\\u044c</option>\\n<option value=\"3\">\\u041c\\u0430\\u0440\\u0442</option>\\n<option value=\"4\">\\u0410\\u043f\\u0440\\u0435\\u043b\\u044c</option>\\n<option value=\"5\">\\u041c\\u0430\\u0439</option>\\n<option value=\"6\">\\u0418\\u044e\\u043d\\u044c</option>\\n<option value=\"7\">\\u0418\\u044e\\u043b\\u044c</option>\\n<option value=\"8\">\\u0410\\u0432\\u0433\\u0443\\u0441\\u0442</option>\\n<option value=\"9\">\\u0421\\u0435\\u043d\\u0442\\u044f\\u0431\\u0440\\u044c</option>\\n<option value=\"10\">\\u041e\\u043a\\u0442\\u044f\\u0431\\u0440\\u044c</option>\\n<option value=\"11\">\\u041d\\u043e\\u044f\\u0431\\u0440\\u044c</option>\\n<option value=\"12\" selected=\"selected\">\\u0414\\u0435\\u043a\\u0430\\u0431\\u0440\\u044c</option>\\n</select>\\n<select name=\"mydate_year\" id=\"id_mydate_year\">\\n<option value=\"2009\" selected=\"selected\">2009</option>\\n<option value=\"2010\">2010</option>\\n<option value=\"2011\">2011</option>\\n<option value=\"2012\">2012</option>\\n<option value=\"2013\">2013</option>\\n<option value=\"2014\">2014</option>\\n<option value=\"2015\">2015</option>\\n<option value=\"2016\">2016</option>\\n<option value=\"2017\">2017</option>\\n<option value=\"2018\">2018</option>\\n</select>',\n-                SelectDateWidget(years=range(2009, 2019)).render('mydate', datetime.date(2009, 12, 31))\n-        )\n-        deactivate()\n+        try:\n+            self.assertEqual(\n+                    u'<select name=\"mydate_day\" id=\"id_mydate_day\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"4\">4</option>\\n<option value=\"5\">5</option>\\n<option value=\"6\">6</option>\\n<option value=\"7\">7</option>\\n<option value=\"8\">8</option>\\n<option value=\"9\">9</option>\\n<option value=\"10\">10</option>\\n<option value=\"11\">11</option>\\n<option value=\"12\">12</option>\\n<option value=\"13\">13</option>\\n<option value=\"14\">14</option>\\n<option value=\"15\">15</option>\\n<option value=\"16\">16</option>\\n<option value=\"17\">17</option>\\n<option value=\"18\">18</option>\\n<option value=\"19\">19</option>\\n<option value=\"20\">20</option>\\n<option value=\"21\">21</option>\\n<option value=\"22\">22</option>\\n<option value=\"23\">23</option>\\n<option value=\"24\">24</option>\\n<option value=\"25\">25</option>\\n<option value=\"26\">26</option>\\n<option value=\"27\">27</option>\\n<option value=\"28\">28</option>\\n<option value=\"29\">29</option>\\n<option value=\"30\">30</option>\\n<option value=\"31\" selected=\"selected\">31</option>\\n</select>\\n<select name=\"mydate_month\" id=\"id_mydate_month\">\\n<option value=\"1\">\\u042f\\u043d\\u0432\\u0430\\u0440\\u044c</option>\\n<option value=\"2\">\\u0424\\u0435\\u0432\\u0440\\u0430\\u043b\\u044c</option>\\n<option value=\"3\">\\u041c\\u0430\\u0440\\u0442</option>\\n<option value=\"4\">\\u0410\\u043f\\u0440\\u0435\\u043b\\u044c</option>\\n<option value=\"5\">\\u041c\\u0430\\u0439</option>\\n<option value=\"6\">\\u0418\\u044e\\u043d\\u044c</option>\\n<option value=\"7\">\\u0418\\u044e\\u043b\\u044c</option>\\n<option value=\"8\">\\u0410\\u0432\\u0433\\u0443\\u0441\\u0442</option>\\n<option value=\"9\">\\u0421\\u0435\\u043d\\u0442\\u044f\\u0431\\u0440\\u044c</option>\\n<option value=\"10\">\\u041e\\u043a\\u0442\\u044f\\u0431\\u0440\\u044c</option>\\n<option value=\"11\">\\u041d\\u043e\\u044f\\u0431\\u0440\\u044c</option>\\n<option value=\"12\" selected=\"selected\">\\u0414\\u0435\\u043a\\u0430\\u0431\\u0440\\u044c</option>\\n</select>\\n<select name=\"mydate_year\" id=\"id_mydate_year\">\\n<option value=\"2009\" selected=\"selected\">2009</option>\\n<option value=\"2010\">2010</option>\\n<option value=\"2011\">2011</option>\\n<option value=\"2012\">2012</option>\\n<option value=\"2013\">2013</option>\\n<option value=\"2014\">2014</option>\\n<option value=\"2015\">2015</option>\\n<option value=\"2016\">2016</option>\\n<option value=\"2017\">2017</option>\\n<option value=\"2018\">2018</option>\\n</select>',\n+                    SelectDateWidget(years=range(2009, 2019)).render('mydate', datetime.date(2009, 12, 31))\n+            )\n+        finally:\n+            deactivate()\n \n         # English locale\n-\n-        settings.USE_L10N = True\n         activate('en')\n         try:\n             self.assertEqual('N j, Y', get_format('DATE_FORMAT'))\n@@ -487,13 +485,10 @@ def test_iter_format_modules_stability(self):\n         Tests the iter_format_modules function always yields format modules in\n         a stable and correct order in presence of both base ll and ll_CC formats.\n         \"\"\"\n-        try:\n-            old_l10n, settings.USE_L10N = settings.USE_L10N, True\n-            en_format_mod = import_module('django.conf.locale.en.formats')\n-            en_gb_format_mod = import_module('django.conf.locale.en_GB.formats')\n-            self.assertEqual(list(iter_format_modules('en-gb')), [en_gb_format_mod, en_format_mod])\n-        finally:\n-            settings.USE_L10N = old_l10n\n+        settings.USE_L10N = True\n+        en_format_mod = import_module('django.conf.locale.en.formats')\n+        en_gb_format_mod = import_module('django.conf.locale.en_GB.formats')\n+        self.assertEqual(list(iter_format_modules('en-gb')), [en_gb_format_mod, en_format_mod])\n \n     def test_get_format_modules_stability(self):\n         activate('de')"
        }
    ],
    "stats": {
        "total": 47,
        "additions": 22,
        "deletions": 25
    }
}