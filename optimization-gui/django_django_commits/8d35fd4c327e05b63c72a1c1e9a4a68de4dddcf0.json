{
    "author": "clelland",
    "message": "Use new TestCase methods for equality comparisons",
    "sha": "8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0",
    "files": [
        {
            "sha": "3f26b85f7d3d9a0423c3b80ea6fafecd8f048576",
            "filename": "django/contrib/formtools/tests/wizard/cookiestorage.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fcookiestorage.py",
            "raw_url": "https://github.com/django/django/raw/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fcookiestorage.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fcookiestorage.py?ref=8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0",
            "patch": "@@ -43,5 +43,5 @@ def test_reset_cookie(self):\n         storage.init_data()\n         storage.update_response(response)\n         unsigned_cookie_data = cookie_signer.unsign(response.cookies[storage.prefix].value)\n-        self.assertEqual(json.loads(unsigned_cookie_data),\n+        self.assertJSONEqual(unsigned_cookie_data,\n             {\"step_files\": {}, \"step\": None, \"extra_data\": {}, \"step_data\": {}})"
        },
        {
            "sha": "9331ff2f3fd17430e1929ef18109acf33c189ff9",
            "filename": "tests/modeltests/field_subclassing/tests.py",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fmodeltests%2Ffield_subclassing%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fmodeltests%2Ffield_subclassing%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ffield_subclassing%2Ftests.py?ref=8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0",
            "patch": "@@ -61,7 +61,11 @@ def test_custom_field(self):\n \n         # Serialization works, too.\n         stream = serializers.serialize(\"json\", MyModel.objects.all())\n-        self.assertEqual(stream, '[{\"pk\": %d, \"model\": \"field_subclassing.mymodel\", \"fields\": {\"data\": \"12\", \"name\": \"m\"}}]' % m1.pk)\n+        self.assertJSONEqual(stream, [{\n+            \"pk\": m1.pk,\n+            \"model\": \"field_subclassing.mymodel\",\n+            \"fields\": {\"data\": \"12\", \"name\": \"m\"}\n+        }])\n \n         obj = list(serializers.deserialize(\"json\", stream))[0]\n         self.assertEqual(obj.object, m)"
        },
        {
            "sha": "103612198ef59a60cdbc02b318eb404c15ba233d",
            "filename": "tests/modeltests/fixtures/tests.py",
            "status": "modified",
            "additions": 11,
            "deletions": 8,
            "changes": 19,
            "blob_url": "https://github.com/django/django/blob/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fmodeltests%2Ffixtures%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fmodeltests%2Ffixtures%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ffixtures%2Ftests.py?ref=8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0",
            "patch": "@@ -22,7 +22,7 @@ def testClassFixtures(self):\n         ])\n \n \n-class FixtureLoadingTests(TestCase):\n+class DumpDataAssertMixin(object):\n \n     def _dumpdata_assert(self, args, output, format='json', natural_keys=False,\n                          use_base_manager=False, exclude_list=[]):\n@@ -34,7 +34,15 @@ def _dumpdata_assert(self, args, output, format='json', natural_keys=False,\n                                                       'use_base_manager': use_base_manager,\n                                                       'exclude': exclude_list})\n         command_output = new_io.getvalue().strip()\n-        self.assertEqual(command_output, output)\n+        if format == \"json\":\n+            self.assertJSONEqual(command_output, output)\n+        elif format == \"xml\":\n+            self.assertXMLEqual(command_output, output)\n+        else:\n+            self.assertEqual(command_output, output)\n+\n+\n+class FixtureLoadingTests(DumpDataAssertMixin, TestCase):\n \n     def test_initial_data(self):\n         # syncdb introduces 1 initial data object from initial_data.json.\n@@ -290,12 +298,7 @@ def test_output_formats(self):\n <django-objects version=\"1.0\"><object pk=\"1\" model=\"fixtures.category\"><field type=\"CharField\" name=\"title\">News Stories</field><field type=\"TextField\" name=\"description\">Latest news stories</field></object><object pk=\"2\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Poker has no place on ESPN</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T12:00:00</field></object><object pk=\"3\" model=\"fixtures.article\"><field type=\"CharField\" name=\"headline\">Time to reform copyright</field><field type=\"DateTimeField\" name=\"pub_date\">2006-06-16T13:00:00</field></object><object pk=\"1\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">copyright</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"2\" model=\"fixtures.tag\"><field type=\"CharField\" name=\"name\">law</field><field to=\"contenttypes.contenttype\" name=\"tagged_type\" rel=\"ManyToOneRel\"><natural>fixtures</natural><natural>article</natural></field><field type=\"PositiveIntegerField\" name=\"tagged_id\">3</field></object><object pk=\"1\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Django Reinhardt</field></object><object pk=\"2\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Stephane Grappelli</field></object><object pk=\"3\" model=\"fixtures.person\"><field type=\"CharField\" name=\"name\">Prince</field></object><object pk=\"10\" model=\"fixtures.book\"><field type=\"CharField\" name=\"name\">Achieving self-awareness of Python programs</field><field to=\"fixtures.person\" name=\"authors\" rel=\"ManyToManyRel\"></field></object></django-objects>\"\"\", format='xml', natural_keys=True)\n \n \n-class FixtureTransactionTests(TransactionTestCase):\n-    def _dumpdata_assert(self, args, output, format='json'):\n-        new_io = six.StringIO()\n-        management.call_command('dumpdata', *args, **{'format': format, 'stdout': new_io})\n-        command_output = new_io.getvalue().strip()\n-        self.assertEqual(command_output, output)\n+class FixtureTransactionTests(DumpDataAssertMixin, TransactionTestCase):\n \n     @skipUnlessDBFeature('supports_forward_references')\n     def test_format_discovery(self):"
        },
        {
            "sha": "7a3a5c0e031545a0be838f451fd15bd1c250c903",
            "filename": "tests/regressiontests/admin_changelist/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 4,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fregressiontests%2Fadmin_changelist%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fregressiontests%2Fadmin_changelist%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_changelist%2Ftests.py?ref=8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0",
            "patch": "@@ -122,12 +122,11 @@ def test_result_list_editable_html(self):\n         table_output = template.render(context)\n         # make sure that hidden fields are in the correct place\n         hiddenfields_div = '<div class=\"hiddenfields\"><input type=\"hidden\" name=\"form-0-id\" value=\"%d\" id=\"id_form-0-id\" /></div>' % new_child.id\n-        self.assertFalse(table_output.find(hiddenfields_div) == -1,\n-            'Failed to find hidden fields in: %s' % table_output)\n+        self.assertInHTML(hiddenfields_div, table_output, msg_prefix='Failed to find hidden fields')\n+\n         # make sure that list editable fields are rendered in divs correctly\n         editable_name_field = '<input name=\"form-0-name\" value=\"name\" class=\"vTextField\" maxlength=\"30\" type=\"text\" id=\"id_form-0-name\" />'\n-        self.assertFalse('<td>%s</td>' % editable_name_field == -1,\n-            'Failed to find \"name\" list_editable field in: %s' % table_output)\n+        self.assertInHTML('<td>%s</td>' % editable_name_field, table_output, msg_prefix='Failed to find \"name\" list_editable field')\n \n     def test_result_list_editable(self):\n         \"\"\""
        },
        {
            "sha": "67911434730ce417ada958a3c1f26525ef543de3",
            "filename": "tests/regressiontests/fixtures_regress/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py?ref=8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0",
            "patch": "@@ -358,7 +358,7 @@ def test_proxy_model_included(self):\n             format='json',\n             stdout=stdout\n         )\n-        self.assertEqual(\n+        self.assertJSONEqual(\n             stdout.getvalue(),\n             \"\"\"[{\"pk\": %d, \"model\": \"fixtures_regress.widget\", \"fields\": {\"name\": \"grommet\"}}]\"\"\"\n             % widget.pk\n@@ -519,7 +519,7 @@ def test_nk_on_serialize(self):\n             use_natural_keys=True,\n             stdout=stdout,\n         )\n-        self.assertEqual(\n+        self.assertJSONEqual(\n             stdout.getvalue(),\n             \"\"\"[{\"pk\": 2, \"model\": \"fixtures_regress.store\", \"fields\": {\"main\": null, \"name\": \"Amazon\"}}, {\"pk\": 3, \"model\": \"fixtures_regress.store\", \"fields\": {\"main\": null, \"name\": \"Borders\"}}, {\"pk\": 4, \"model\": \"fixtures_regress.person\", \"fields\": {\"name\": \"Neal Stephenson\"}}, {\"pk\": 1, \"model\": \"fixtures_regress.book\", \"fields\": {\"stores\": [[\"Amazon\"], [\"Borders\"]], \"name\": \"Cryptonomicon\", \"author\": [\"Neal Stephenson\"]}}]\"\"\"\n         )"
        },
        {
            "sha": "44d84f91432715bc580a22fff7498c486e3e9559",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0",
            "patch": "@@ -634,7 +634,7 @@ def test_localized_input(self):\n             self.assertEqual(datetime.datetime(2009, 12, 31, 6, 0, 0), form6.cleaned_data['date_added'])\n             with self.settings(USE_THOUSAND_SEPARATOR=True):\n                 # Checking for the localized \"products_delivered\" field\n-                self.assertTrue('<input type=\"text\" name=\"products_delivered\" value=\"12.000\" id=\"id_products_delivered\" />' in form6.as_ul())\n+                self.assertInHTML('<input type=\"text\" name=\"products_delivered\" value=\"12.000\" id=\"id_products_delivered\" />', form6.as_ul())\n \n     def test_iter_format_modules(self):\n         \"\"\""
        },
        {
            "sha": "5ac10462facd34d69297c301d56ad3a44ca1303e",
            "filename": "tests/regressiontests/m2m_through_regress/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fregressiontests%2Fm2m_through_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0/tests%2Fregressiontests%2Fm2m_through_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fm2m_through_regress%2Ftests.py?ref=8d35fd4c327e05b63c72a1c1e9a4a68de4dddcf0",
            "patch": "@@ -73,12 +73,12 @@ def test_serialization(self):\n \n         out = StringIO()\n         management.call_command(\"dumpdata\", \"m2m_through_regress\", format=\"json\", stdout=out)\n-        self.assertEqual(out.getvalue().strip(), \"\"\"[{\"pk\": %(m_pk)s, \"model\": \"m2m_through_regress.membership\", \"fields\": {\"person\": %(p_pk)s, \"price\": 100, \"group\": %(g_pk)s}}, {\"pk\": %(p_pk)s, \"model\": \"m2m_through_regress.person\", \"fields\": {\"name\": \"Bob\"}}, {\"pk\": %(g_pk)s, \"model\": \"m2m_through_regress.group\", \"fields\": {\"name\": \"Roll\"}}]\"\"\" % pks)\n+        self.assertJSONEqual(out.getvalue().strip(), \"\"\"[{\"pk\": %(m_pk)s, \"model\": \"m2m_through_regress.membership\", \"fields\": {\"person\": %(p_pk)s, \"price\": 100, \"group\": %(g_pk)s}}, {\"pk\": %(p_pk)s, \"model\": \"m2m_through_regress.person\", \"fields\": {\"name\": \"Bob\"}}, {\"pk\": %(g_pk)s, \"model\": \"m2m_through_regress.group\", \"fields\": {\"name\": \"Roll\"}}]\"\"\" % pks)\n \n         out = StringIO()\n         management.call_command(\"dumpdata\", \"m2m_through_regress\", format=\"xml\",\n             indent=2, stdout=out)\n-        self.assertEqual(out.getvalue().strip(), \"\"\"\n+        self.assertXMLEqual(out.getvalue().strip(), \"\"\"\n <?xml version=\"1.0\" encoding=\"utf-8\"?>\n <django-objects version=\"1.0\">\n   <object pk=\"%(m_pk)s\" model=\"m2m_through_regress.membership\">\n@@ -232,4 +232,4 @@ def test_sequence_creation(self):\n         \"Check that sequences on an m2m_through are created for the through model, not a phantom auto-generated m2m table. Refs #11107\"\n         out = StringIO()\n         management.call_command(\"dumpdata\", \"m2m_through_regress\", format=\"json\", stdout=out)\n-        self.assertEqual(out.getvalue().strip(), \"\"\"[{\"pk\": 1, \"model\": \"m2m_through_regress.usermembership\", \"fields\": {\"price\": 100, \"group\": 1, \"user\": 1}}, {\"pk\": 1, \"model\": \"m2m_through_regress.person\", \"fields\": {\"name\": \"Guido\"}}, {\"pk\": 1, \"model\": \"m2m_through_regress.group\", \"fields\": {\"name\": \"Python Core Group\"}}]\"\"\")\n+        self.assertJSONEqual(out.getvalue().strip(), \"\"\"[{\"pk\": 1, \"model\": \"m2m_through_regress.usermembership\", \"fields\": {\"price\": 100, \"group\": 1, \"user\": 1}}, {\"pk\": 1, \"model\": \"m2m_through_regress.person\", \"fields\": {\"name\": \"Guido\"}}, {\"pk\": 1, \"model\": \"m2m_through_regress.group\", \"fields\": {\"name\": \"Python Core Group\"}}]\"\"\")"
        }
    ],
    "stats": {
        "total": 46,
        "additions": 26,
        "deletions": 20
    }
}