{
    "author": "jezdez",
    "message": "Fixed #10793 -- Stopped caching paginator instances in sitemap classes to prevent stale sitemaps. Thanks, gnosek, krzysiumed and adam_przybyla.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17468 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "75a9c8a5ef6408cd51fd75fc8aefb2e812e353a1",
    "files": [
        {
            "sha": "53b375a48b9a00a338a91758abc0e6ae82970f9c",
            "filename": "django/contrib/sitemaps/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/75a9c8a5ef6408cd51fd75fc8aefb2e812e353a1/django%2Fcontrib%2Fsitemaps%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/75a9c8a5ef6408cd51fd75fc8aefb2e812e353a1/django%2Fcontrib%2Fsitemaps%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsitemaps%2F__init__.py?ref=75a9c8a5ef6408cd51fd75fc8aefb2e812e353a1",
            "patch": "@@ -60,9 +60,7 @@ def location(self, obj):\n         return obj.get_absolute_url()\n \n     def _get_paginator(self):\n-        if not hasattr(self, \"_paginator\"):\n-            self._paginator = paginator.Paginator(self.items(), self.limit)\n-        return self._paginator\n+        return paginator.Paginator(self.items(), self.limit)\n     paginator = property(_get_paginator)\n \n     def get_urls(self, page=1, site=None, protocol=None):"
        },
        {
            "sha": "e0bef0b56e2bdcf4c8f227281170e56adaad3a3d",
            "filename": "docs/releases/1.4.txt",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/75a9c8a5ef6408cd51fd75fc8aefb2e812e353a1/docs%2Freleases%2F1.4.txt",
            "raw_url": "https://github.com/django/django/raw/75a9c8a5ef6408cd51fd75fc8aefb2e812e353a1/docs%2Freleases%2F1.4.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.4.txt?ref=75a9c8a5ef6408cd51fd75fc8aefb2e812e353a1",
            "patch": "@@ -1150,3 +1150,18 @@ settings file to list all your applications explicitly.\n This attribute was confusingly named ``HttpRequest.raw_post_data``, but it\n actually provided the body of the HTTP request. It's been renamed to\n ``HttpRequest.body``, and ``HttpRequest.raw_post_data`` has been deprecated.\n+\n+``django.contrib.sitemaps`` bugfix with potential performance implications\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+In previous versions the Paginator objects used in sitemap classes were\n+cached and could result in stale sitemap indexes. Removing this cache causes\n+new Paginator objects to be created and the\n+:attr:`~django.contrib.sitemaps.Sitemap.items()` method of the\n+:class:`~django.contrib.sitemaps.Sitemap` subclass to be called during every\n+sitemap-related request.\n+\n+If the :attr:`django.contrib.sitemaps.Sitemap.items()` method returns a\n+``QuerySet`` its length will be evaluated which may lead to extra database\n+queries. To mitigate the performance impact consider using the :doc:`caching\n+framework </topics/cache>`."
        }
    ],
    "stats": {
        "total": 19,
        "additions": 16,
        "deletions": 3
    }
}