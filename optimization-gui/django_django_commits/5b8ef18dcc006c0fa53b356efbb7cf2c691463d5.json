{
    "author": "freakboy3742",
    "message": "Fixed #14795 -- Ensure that get_all_permissions() returns the right result (i.e., all permissions) for superusers. Thanks to jay.halleaux@gmail.com for the report, and Brett Haydon for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@14797 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "5b8ef18dcc006c0fa53b356efbb7cf2c691463d5",
    "files": [
        {
            "sha": "2f608043cb73839a0c076b696e39caf056f131ba",
            "filename": "django/contrib/auth/backends.py",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/5b8ef18dcc006c0fa53b356efbb7cf2c691463d5/django%2Fcontrib%2Fauth%2Fbackends.py",
            "raw_url": "https://github.com/django/django/raw/5b8ef18dcc006c0fa53b356efbb7cf2c691463d5/django%2Fcontrib%2Fauth%2Fbackends.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fbackends.py?ref=5b8ef18dcc006c0fa53b356efbb7cf2c691463d5",
            "patch": "@@ -25,9 +25,11 @@ def get_group_permissions(self, user_obj):\n         groups.\n         \"\"\"\n         if not hasattr(user_obj, '_group_perm_cache'):\n-            perms = Permission.objects.filter(group__user=user_obj\n-                ).values_list('content_type__app_label', 'codename'\n-                ).order_by()\n+            if user_obj.is_superuser:\n+                perms = Permission.objects.all()\n+            else:\n+                perms = Permission.objects.filter(group__user=user_obj)\n+            perms = perms.values_list('content_type__app_label', 'codename').order_by()\n             user_obj._group_perm_cache = set([\"%s.%s\" % (ct, name) for ct, name in perms])\n         return user_obj._group_perm_cache\n "
        },
        {
            "sha": "e931152f77a1b5a23497cc945c11dd35b9f31ff4",
            "filename": "django/contrib/auth/tests/auth_backends.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/5b8ef18dcc006c0fa53b356efbb7cf2c691463d5/django%2Fcontrib%2Fauth%2Ftests%2Fauth_backends.py",
            "raw_url": "https://github.com/django/django/raw/5b8ef18dcc006c0fa53b356efbb7cf2c691463d5/django%2Fcontrib%2Fauth%2Ftests%2Fauth_backends.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Fauth_backends.py?ref=5b8ef18dcc006c0fa53b356efbb7cf2c691463d5",
            "patch": "@@ -15,6 +15,7 @@ def setUp(self):\n         self.curr_auth = settings.AUTHENTICATION_BACKENDS\n         settings.AUTHENTICATION_BACKENDS = (self.backend,)\n         User.objects.create_user('test', 'test@example.com', 'test')\n+        User.objects.create_superuser('test2', 'test2@example.com', 'test')\n \n     def tearDown(self):\n         settings.AUTHENTICATION_BACKENDS = self.curr_auth\n@@ -90,6 +91,10 @@ def test_has_no_object_perm(self):\n         self.assertEqual(user.has_perm('auth.test'), True)\n         self.assertEqual(user.get_all_permissions(), set(['auth.test']))\n \n+    def test_get_all_superuser_permissions(self):\n+        \"A superuser has all permissions. Refs #14795\"\n+        user = User.objects.get(username='test2')\n+        self.assertEqual(len(user.get_all_permissions()), len(Permission.objects.all()))\n \n class TestObj(object):\n     pass"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 10,
        "deletions": 3
    }
}