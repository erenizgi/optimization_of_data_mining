{
    "author": "adrianholovaty",
    "message": "Fixed #15603 -- Changed the traceback error e-mails not to use HTML by default. It's now configurable with an 'include_html' parameter to AdminEmailHandler. Thanks, kmtracey\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15850 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "304a50d8cac1d185685d212867a2d449c5378e9e",
    "files": [
        {
            "sha": "763e667c570f4a404c053ddc705e0ce7e63c3a59",
            "filename": "django/utils/log.py",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/304a50d8cac1d185685d212867a2d449c5378e9e/django%2Futils%2Flog.py",
            "raw_url": "https://github.com/django/django/raw/304a50d8cac1d185685d212867a2d449c5378e9e/django%2Futils%2Flog.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Flog.py?ref=304a50d8cac1d185685d212867a2d449c5378e9e",
            "patch": "@@ -48,7 +48,11 @@ def getLogger(name=None):\n     logger.addHandler(NullHandler())\n \n class AdminEmailHandler(logging.Handler):\n-    \"\"\"An exception log handler that emails log entries to site admins\n+    def __init__(self, include_html=False):\n+        logging.Handler.__init__(self)        \n+        self.include_html = include_html\n+\n+    \"\"\"An exception log handler that e-mails log entries to site admins.\n \n     If the request is passed as the first argument to the log record,\n     request data will be provided in the\n@@ -88,6 +92,6 @@ def emit(self, record):\n \n         message = \"%s\\n\\n%s\" % (stack_trace, request_repr)\n         reporter = ExceptionReporter(request, is_email=True, *exc_info)\n-        html_message = reporter.get_traceback_html()\n+        html_message = self.include_html and reporter.get_traceback_html() or None\n         mail.mail_admins(subject, message, fail_silently=True,\n                          html_message=html_message)"
        },
        {
            "sha": "309ea364b44b6ad27b5e09d117a4ec76d00e4f38",
            "filename": "docs/topics/logging.txt",
            "status": "modified",
            "additions": 27,
            "deletions": 2,
            "changes": 29,
            "blob_url": "https://github.com/django/django/blob/304a50d8cac1d185685d212867a2d449c5378e9e/docs%2Ftopics%2Flogging.txt",
            "raw_url": "https://github.com/django/django/raw/304a50d8cac1d185685d212867a2d449c5378e9e/docs%2Ftopics%2Flogging.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Flogging.txt?ref=304a50d8cac1d185685d212867a2d449c5378e9e",
            "patch": "@@ -468,13 +468,38 @@ Handlers\n Django provides one log handler in addition to those provided by the\n Python logging module.\n \n-.. class:: AdminEmailHandler()\n+.. class:: AdminEmailHandler([include_html=False])\n \n     This handler sends an e-mail to the site admins for each log\n     message it receives.\n \n-    If the log record contains a 'request' attribute, the full details\n+    If the log record contains a ``request`` attribute, the full details\n     of the request will be included in the e-mail.\n \n     If the log record contains stack trace information, that stack\n     trace will be included in the e-mail.\n+\n+    The ``include_html`` argument of ``AdminEmailHandler`` is used to\n+    control whether the traceback e-mail includes an HTML attachment\n+    containing the full content of the debug Web page that would have been\n+    produced if ``DEBUG`` were ``True``. To set this value in your\n+    configuration, include it in the handler definition for\n+    ``django.utils.log.AdminEmailHandler``, like this::\n+\n+        'handlers': {\n+            'mail_admins': {\n+                'level': 'ERROR',\n+                'class': 'django.utils.log.AdminEmailHandler',\n+                'include_html': True,\n+            }\n+        },\n+\n+    Note that this HTML version of the e-mail contains a full traceback,\n+    with names and values of local variables at each level of the stack, plus\n+    the values of your Django settings. This information is potentially very\n+    sensitive, and you may not want to send it over e-mail. Consider using\n+    something such as `django-sentry`_ to get the best of both worlds -- the\n+    rich information of full tracebacks plus the security of *not* sending the\n+    information over e-mail.\n+\n+.. _django-sentry: http://pypi.python.org/pypi/django-sentry"
        }
    ],
    "stats": {
        "total": 37,
        "additions": 33,
        "deletions": 4
    }
}