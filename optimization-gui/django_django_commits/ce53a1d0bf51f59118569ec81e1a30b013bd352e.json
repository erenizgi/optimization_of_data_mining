{
    "author": "aaugustin",
    "message": "Clarified the messages documentation.\n\n* Stated upfront that the messages framework is enabled by default.\n* Explained why FallbackStorage, despites its unattractive name, is the\n  default and likely the most efficient message storage class.\n\nThanks Jeremy Dunck for the review.\n\nCloses #17026 (again).",
    "sha": "ce53a1d0bf51f59118569ec81e1a30b013bd352e",
    "files": [
        {
            "sha": "bc921a9d33db5aaab5f8384cbede63bab63a3efd",
            "filename": "docs/ref/contrib/messages.txt",
            "status": "modified",
            "additions": 47,
            "deletions": 49,
            "changes": 96,
            "blob_url": "https://github.com/django/django/blob/ce53a1d0bf51f59118569ec81e1a30b013bd352e/docs%2Fref%2Fcontrib%2Fmessages.txt",
            "raw_url": "https://github.com/django/django/raw/ce53a1d0bf51f59118569ec81e1a30b013bd352e/docs%2Fref%2Fcontrib%2Fmessages.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fmessages.txt?ref=ce53a1d0bf51f59118569ec81e1a30b013bd352e",
            "patch": "@@ -5,47 +5,44 @@ The messages framework\n .. module:: django.contrib.messages\n    :synopsis: Provides cookie- and session-based temporary message storage.\n \n-Quite commonly in web applications, you may need to display a one-time\n-notification message (also know as \"flash message\") to the user after\n-processing a form or some other types of user input. For this, Django provides\n-full support for cookie- and session-based messaging, for both anonymous and\n-authenticated users. The messages framework allows you to temporarily store\n-messages in one request and retrieve them for display in a subsequent request\n-(usually the next one). Every message is tagged with a specific ``level`` that\n-determines its priority (e.g., ``info``, ``warning``, or ``error``).\n+Quite commonly in web applications, you need to display a one-time\n+notification message (also known as \"flash message\") to the user after\n+processing a form or some other types of user input.\n+\n+For this, Django provides full support for cookie- and session-based\n+messaging, for both anonymous and authenticated users. The messages framework\n+allows you to temporarily store messages in one request and retrieve them for\n+display in a subsequent request (usually the next one). Every message is\n+tagged with a specific ``level`` that determines its priority (e.g., ``info``,\n+``warning``, or ``error``).\n \n Enabling messages\n =================\n \n Messages are implemented through a :doc:`middleware </ref/middleware>`\n class and corresponding :doc:`context processor </ref/templates/api>`.\n \n-To enable message functionality, do the following:\n-\n-* Edit the :setting:`MIDDLEWARE_CLASSES` setting and make sure\n-  it contains ``'django.contrib.messages.middleware.MessageMiddleware'``.\n+The default ``settings.py`` created by ``django-admin.py startproject``\n+already contains all the settings required to enable message functionality:\n \n-  If you are using a :ref:`storage backend <message-storage-backends>` that\n-  relies on :doc:`sessions </topics/http/sessions>` (the default),\n-  ``'django.contrib.sessions.middleware.SessionMiddleware'`` must be\n-  enabled and appear before ``MessageMiddleware`` in your\n-  :setting:`MIDDLEWARE_CLASSES`.\n+* ``'django.contrib.messages'`` is in :setting:`INSTALLED_APPS`.\n \n-* Edit the :setting:`TEMPLATE_CONTEXT_PROCESSORS` setting and make sure\n-  it contains ``'django.contrib.messages.context_processors.messages'``.\n+* :setting:`MIDDLEWARE_CLASSES` contains\n+  ``'django.contrib.sessions.middleware.SessionMiddleware'`` and\n+  ``'django.contrib.messages.middleware.MessageMiddleware'``.\n \n-* Add ``'django.contrib.messages'`` to your :setting:`INSTALLED_APPS`\n-  setting\n+  The default :ref:`storage backend <message-storage-backends>` relies on\n+  :doc:`sessions </topics/http/sessions>`. That's why ``SessionMiddleware``\n+  must be enabled and appear before ``MessageMiddleware`` in\n+  :setting:`MIDDLEWARE_CLASSES`.\n \n-The default ``settings.py`` created by ``django-admin.py startproject`` has\n-``MessageMiddleware`` activated and the ``django.contrib.messages`` app\n-installed. Also, the default value for :setting:`TEMPLATE_CONTEXT_PROCESSORS`\n-contains ``'django.contrib.messages.context_processors.messages'``.\n+* :setting:`TEMPLATE_CONTEXT_PROCESSORS`   contains\n+  ``'django.contrib.messages.context_processors.messages'``.\n \n-If you don't want to use messages, you can remove the\n-``MessageMiddleware`` line from :setting:`MIDDLEWARE_CLASSES`, the ``messages``\n-context processor from :setting:`TEMPLATE_CONTEXT_PROCESSORS` and\n-``'django.contrib.messages'`` from your :setting:`INSTALLED_APPS`.\n+If you don't want to use messages, you can remove\n+``'django.contrib.messages'`` from your :setting:`INSTALLED_APPS`, the\n+``MessageMiddleware`` line from :setting:`MIDDLEWARE_CLASSES`, and the\n+``messages`` context processor from :setting:`TEMPLATE_CONTEXT_PROCESSORS`.\n \n Configuring the message engine\n ==============================\n@@ -56,34 +53,35 @@ Storage backends\n ----------------\n \n The messages framework can use different backends to store temporary messages.\n-If the default FallbackStorage isn't suitable to your needs, you can change\n-which backend is being used by adding a `MESSAGE_STORAGE`_ to your\n-settings, referencing the module and class of the storage class. For\n-example::\n \n-    MESSAGE_STORAGE = 'django.contrib.messages.storage.cookie.CookieStorage'\n+Django provides three built-in storage classes:\n \n-The value should be the full path of the desired storage class.\n+.. class:: django.contrib.messages.storage.session.SessionStorage\n \n-Three storage classes are available:\n+    This class stores all messages inside of the request's session. Therefore\n+    it requires Django's ``contrib.sessions`` application.\n \n-``'django.contrib.messages.storage.session.SessionStorage'``\n-    This class stores all messages inside of the request's session. It\n-    requires Django's ``contrib.sessions`` application.\n+.. class:: django.contrib.messages.storage.cookie.CookieStorage\n \n-``'django.contrib.messages.storage.cookie.CookieStorage'``\n     This class stores the message data in a cookie (signed with a secret hash\n     to prevent manipulation) to persist notifications across requests. Old\n-    messages are dropped if the cookie data size would exceed 4096 bytes.\n+    messages are dropped if the cookie data size would exceed 2048 bytes.\n+\n+.. class:: django.contrib.messages.storage.fallback.FallbackStorage\n \n-``'django.contrib.messages.storage.fallback.FallbackStorage'``\n-    This is the default storage class.\n+    This class first uses ``CookieStorage``, and falls back to using\n+    ``SessionStorage`` for the messages that could not fit in a single cookie.\n+    It also requires Django's ``contrib.sessions`` application.\n \n-    This class first uses CookieStorage for all messages, falling back to using\n-    SessionStorage for the messages that could not fit in a single cookie.\n+    This behavior avoids writing to the session whenever possible. It should\n+    provide the best performance in the general case.\n \n-    Since it is uses SessionStorage, it also requires Django's\n-    ``contrib.sessions`` application.\n+:class:`~django.contrib.messages.storage.fallback.FallbackStorage` is the\n+default storage class. If it isn't suitable to your needs, you can select\n+another storage class by setting `MESSAGE_STORAGE`_ to its full import path,\n+for example::\n+\n+    MESSAGE_STORAGE = 'django.contrib.messages.storage.cookie.CookieStorage'\n \n To write your own storage class, subclass the ``BaseStorage`` class in\n ``django.contrib.messages.storage.base`` and implement the ``_get`` and\n@@ -97,8 +95,8 @@ to that of the Python logging module. Message levels allow you to group\n messages by type so they can be filtered or displayed differently in views and\n templates.\n \n-The built-in levels (which can be imported from ``django.contrib.messages``\n-directly) are:\n+The built-in levels, which can be imported from ``django.contrib.messages``\n+directly, are:\n \n =========== ========\n Constant    Purpose"
        }
    ],
    "stats": {
        "total": 96,
        "additions": 47,
        "deletions": 49
    }
}