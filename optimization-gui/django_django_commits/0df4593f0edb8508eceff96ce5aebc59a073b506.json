{
    "author": "akaariai",
    "message": "Fixed #18319 -- Added 'supports_sequence_reset' DB feature\n\nAdded a new feature to allow 3rd party backends to skip tests which\ntest sequence resetting.\n\nThanks to manfre for report and patch.",
    "sha": "0df4593f0edb8508eceff96ce5aebc59a073b506",
    "files": [
        {
            "sha": "f26653f7b44996def9943f5ff8ef4396c1e2ed3e",
            "filename": "django/db/backends/__init__.py",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/0df4593f0edb8508eceff96ce5aebc59a073b506/django%2Fdb%2Fbackends%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/0df4593f0edb8508eceff96ce5aebc59a073b506/django%2Fdb%2Fbackends%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fbackends%2F__init__.py?ref=0df4593f0edb8508eceff96ce5aebc59a073b506",
            "patch": "@@ -399,6 +399,9 @@ class BaseDatabaseFeatures(object):\n     # in the SQL standard.\n     supports_tablespaces = False\n \n+    # Does the backend reset sequences between tests?\n+    supports_sequence_reset = True\n+\n     # Features that need to be confirmed at runtime\n     # Cache whether the confirmation has been performed.\n     _confirmed = False"
        },
        {
            "sha": "fe512dfee5791f30579f1b0aa6ae0ef3e353caa2",
            "filename": "django/db/backends/oracle/base.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/0df4593f0edb8508eceff96ce5aebc59a073b506/django%2Fdb%2Fbackends%2Foracle%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/0df4593f0edb8508eceff96ce5aebc59a073b506/django%2Fdb%2Fbackends%2Foracle%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fbackends%2Foracle%2Fbase.py?ref=0df4593f0edb8508eceff96ce5aebc59a073b506",
            "patch": "@@ -83,6 +83,7 @@ class DatabaseFeatures(BaseDatabaseFeatures):\n     ignores_nulls_in_unique_constraints = False\n     has_bulk_insert = True\n     supports_tablespaces = True\n+    supports_sequence_reset = False\n \n class DatabaseOperations(BaseDatabaseOperations):\n     compiler_module = \"django.db.backends.oracle.compiler\""
        },
        {
            "sha": "05f99105aa4d0705332c9ce4626022d959d21cea",
            "filename": "tests/regressiontests/test_runner/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 8,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/0df4593f0edb8508eceff96ce5aebc59a073b506/tests%2Fregressiontests%2Ftest_runner%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0df4593f0edb8508eceff96ce5aebc59a073b506/tests%2Fregressiontests%2Ftest_runner%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftest_runner%2Ftests.py?ref=0df4593f0edb8508eceff96ce5aebc59a073b506",
            "patch": "@@ -8,8 +8,7 @@\n from django.core.exceptions import ImproperlyConfigured\n from django.core.management import call_command\n from django import db\n-from django.db import connection\n-from django.test import simple, TransactionTestCase\n+from django.test import simple, TransactionTestCase, skipUnlessDBFeature\n from django.test.simple import DjangoTestSuiteRunner, get_tests\n from django.test.testcases import connections_support_transactions\n from django.utils import unittest\n@@ -291,16 +290,12 @@ class AutoIncrementResetTest(TransactionTestCase):\n     and check that both times they get \"1\" as their PK value. That is, we test\n     that AutoField values start from 1 for each transactional test case.\n     \"\"\"\n-    @unittest.skipIf(connection.vendor == 'oracle',\n-                     \"Oracle's auto-increment fields are not reset between \"\n-                     \"tests\")\n+    @skipUnlessDBFeature('supports_sequence_reset')\n     def test_autoincrement_reset1(self):\n         p = Person.objects.create(first_name='Jack', last_name='Smith')\n         self.assertEqual(p.pk, 1)\n \n-    @unittest.skipIf(connection.vendor == 'oracle',\n-                     \"Oracle's auto-increment fields are not reset between \"\n-                     \"tests\")\n+    @skipUnlessDBFeature('supports_sequence_reset')\n     def test_autoincrement_reset2(self):\n         p = Person.objects.create(first_name='Jack', last_name='Smith')\n         self.assertEqual(p.pk, 1)"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 7,
        "deletions": 8
    }
}