{
    "author": "carljm",
    "message": "Fixed #16921 -- Added assertHTMLEqual and assertHTMLNotEqual assertions, and converted Django tests to use them where appropriate. Thanks Greg MÃ¼llegger.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17414 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "844a24bbb97af663ebf8dbeab4499acafe105943",
    "files": [
        {
            "sha": "ff073ba728fe4f8089af8c838ae6d6f0d3bbc09c",
            "filename": "django/test/html.py",
            "status": "added",
            "additions": 221,
            "deletions": 0,
            "changes": 221,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/django%2Ftest%2Fhtml.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/django%2Ftest%2Fhtml.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftest%2Fhtml.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -0,0 +1,221 @@\n+\"\"\"\n+Comparing two html documents.\n+\"\"\"\n+import re\n+from HTMLParser import HTMLParseError\n+from django.utils.encoding import force_unicode\n+from django.utils.htmlparser import HTMLParser\n+\n+\n+WHITESPACE = re.compile('\\s+')\n+\n+\n+def normalize_whitespace(string):\n+    return WHITESPACE.sub(' ', string)\n+\n+\n+class Element(object):\n+    def __init__(self, name, attributes):\n+        self.name = name\n+        self.attributes = sorted(attributes)\n+        self.children = []\n+\n+    def append(self, element):\n+        if isinstance(element, basestring):\n+            element = force_unicode(element)\n+            element = normalize_whitespace(element)\n+            if self.children:\n+                if isinstance(self.children[-1], basestring):\n+                    self.children[-1] += element\n+                    self.children[-1] = normalize_whitespace(self.children[-1])\n+                    return\n+        elif self.children:\n+            # removing last children if it is only whitespace\n+            # this can result in incorrect dom representations since\n+            # whitespace between inline tags like <span> is significant\n+            if isinstance(self.children[-1], basestring):\n+                if self.children[-1].isspace():\n+                    self.children.pop()\n+        if element:\n+            self.children.append(element)\n+\n+    def finalize(self):\n+        def rstrip_last_element(children):\n+            if children:\n+                if isinstance(children[-1], basestring):\n+                    children[-1] = children[-1].rstrip()\n+                    if not children[-1]:\n+                        children.pop()\n+                        children = rstrip_last_element(children)\n+            return children\n+\n+        rstrip_last_element(self.children)\n+        for i, child in enumerate(self.children):\n+            if isinstance(child, basestring):\n+                self.children[i] = child.strip()\n+            elif hasattr(child, 'finalize'):\n+                child.finalize()\n+\n+    def __eq__(self, element):\n+        if not hasattr(element, 'name'):\n+            return False\n+        if hasattr(element, 'name') and self.name != element.name:\n+            return False\n+        if len(self.attributes) != len(element.attributes):\n+            return False\n+        if self.attributes != element.attributes:\n+            # attributes without a value is same as attribute with value that\n+            # equals the attributes name:\n+            # <input checked> == <input checked=\"checked\">\n+            for i in range(len(self.attributes)):\n+                attr, value = self.attributes[i]\n+                other_attr, other_value = element.attributes[i]\n+                if value is None:\n+                    value = attr\n+                if other_value is None:\n+                    other_value = other_attr\n+                if attr != other_attr or value != other_value:\n+                    return False\n+        if self.children != element.children:\n+            return False\n+        return True\n+\n+    def __ne__(self, element):\n+        return not self.__eq__(element)\n+\n+    def _count(self, element, count=True):\n+        if not isinstance(element, basestring):\n+            if self == element:\n+                return 1\n+        i = 0\n+        for child in self.children:\n+            # child is text content and element is also text content, then\n+            # make a simple \"text\" in \"text\"\n+            if isinstance(child, basestring):\n+                if isinstance(element, basestring):\n+                    if count:\n+                        i += child.count(element)\n+                    elif element in child:\n+                        return 1\n+            else:\n+                i += child._count(element, count=count)\n+                if not count and i:\n+                    return i\n+        return i\n+\n+    def __contains__(self, element):\n+        return self._count(element, count=False) > 0\n+\n+    def count(self, element):\n+        return self._count(element, count=True)\n+\n+    def __getitem__(self, key):\n+        return self.children[key]\n+\n+    def __unicode__(self):\n+        output = u'<%s' % self.name\n+        for key, value in self.attributes:\n+            if value:\n+                output += u' %s=\"%s\"' % (key, value)\n+            else:\n+                output += u' %s' % key\n+        if self.children:\n+            output += u'>\\n'\n+            output += u''.join(unicode(c) for c in self.children)\n+            output += u'\\n</%s>' % self.name\n+        else:\n+            output += u' />'\n+        return output\n+\n+    def __repr__(self):\n+        return unicode(self)\n+\n+\n+class RootElement(Element):\n+    def __init__(self):\n+        super(RootElement, self).__init__(None, ())\n+\n+    def __unicode__(self):\n+        return u''.join(unicode(c) for c in self.children)\n+\n+\n+class Parser(HTMLParser):\n+    SELF_CLOSING_TAGS = ('br' , 'hr', 'input', 'img', 'meta', 'spacer',\n+        'link', 'frame', 'base', 'col')\n+\n+    def __init__(self):\n+        HTMLParser.__init__(self)\n+        self.root = RootElement()\n+        self.open_tags = []\n+        self.element_positions = {}\n+\n+    def error(self, msg):\n+        raise HTMLParseError(msg, self.getpos())\n+\n+    def format_position(self, position=None, element=None):\n+        if not position and element:\n+            position = self.element_positions[element]\n+        if position is None:\n+            position = self.getpos()\n+        if hasattr(position, 'lineno'):\n+            position = position.lineno, position.offset\n+        return 'Line %d, Column %d' % position\n+\n+    @property\n+    def current(self):\n+        if self.open_tags:\n+            return self.open_tags[-1]\n+        else:\n+            return self.root\n+\n+    def handle_startendtag(self, tag, attrs):\n+        self.handle_starttag(tag, attrs)\n+        if tag not in self.SELF_CLOSING_TAGS:\n+            self.handle_endtag(tag)\n+\n+    def handle_starttag(self, tag, attrs):\n+        element = Element(tag, attrs)\n+        self.current.append(element)\n+        if tag not in self.SELF_CLOSING_TAGS:\n+            self.open_tags.append(element)\n+        self.element_positions[element] = self.getpos()\n+\n+    def handle_endtag(self, tag):\n+        if not self.open_tags:\n+            self.error(\"Unexpected end tag `%s` (%s)\" % (\n+                tag, self.format_position()))\n+        element = self.open_tags.pop()\n+        while element.name != tag:\n+            if not self.open_tags:\n+                self.error(\"Unexpected end tag `%s` (%s)\" % (\n+                    tag, self.format_position()))\n+            element = self.open_tags.pop()\n+\n+    def handle_data(self, data):\n+        self.current.append(data)\n+\n+    def handle_charref(self, name):\n+        self.current.append('&%s;' % name)\n+\n+    def handle_entityref(self, name):\n+        self.current.append('&%s;' % name)\n+\n+\n+def parse_html(html):\n+    \"\"\"\n+    Takes a string that contains *valid* HTML and turns it into a Python object\n+    structure that can be easily compared against other HTML on semantic\n+    equivilance. Syntactical differences like which quotation is used on\n+    arguments will be ignored.\n+\n+    \"\"\"\n+    parser = Parser()\n+    parser.feed(html)\n+    parser.close()\n+    document = parser.root\n+    document.finalize()\n+    # Removing ROOT element if it's not necessary\n+    if len(document.children) == 1:\n+        if not isinstance(document.children[0], basestring):\n+            document = document.children[0]\n+    return document"
        },
        {
            "sha": "0110d5e24d3839338f7d4833c6a427496917de69",
            "filename": "django/test/testcases.py",
            "status": "modified",
            "additions": 62,
            "deletions": 4,
            "changes": 66,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/django%2Ftest%2Ftestcases.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/django%2Ftest%2Ftestcases.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftest%2Ftestcases.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -1,5 +1,6 @@\n from __future__ import with_statement\n \n+import difflib\n import os\n import re\n import sys\n@@ -29,12 +30,14 @@\n from django.http import QueryDict\n from django.test import _doctest as doctest\n from django.test.client import Client\n+from django.test.html import HTMLParseError, parse_html\n from django.test.signals import template_rendered\n from django.test.utils import (get_warnings_state, restore_warnings_state,\n     override_settings)\n from django.test.utils import ContextList\n from django.utils import simplejson, unittest as ut2\n from django.utils.encoding import smart_str, force_unicode\n+from django.utils.unittest.util import safe_repr\n from django.views.static import serve\n \n __all__ = ('DocTestRunner', 'OutputChecker', 'TestCase', 'TransactionTestCase',\n@@ -78,6 +81,16 @@ def restore_transaction_methods():\n     transaction.leave_transaction_management = real_leave_transaction_management\n     transaction.managed = real_managed\n \n+\n+def assert_and_parse_html(self, html, user_msg, msg):\n+    try:\n+        dom = parse_html(html)\n+    except HTMLParseError, e:\n+        standardMsg = u'%s\\n%s' % (msg, e.msg)\n+        self.fail(self._formatMessage(user_msg, standardMsg))\n+    return dom\n+\n+\n class OutputChecker(doctest.OutputChecker):\n     def check_output(self, want, got, optionflags):\n         \"\"\"\n@@ -396,6 +409,39 @@ def assertFieldOutput(self, fieldclass, valid, invalid, field_args=None,\n             self.assertTrue(isinstance(fieldclass(*field_args, **field_kwargs),\n                                        fieldclass))\n \n+    def assertHTMLEqual(self, html1, html2, msg=None):\n+        \"\"\"\n+        Asserts that two html snippets are semantically the same,\n+        e.g. whitespace in most cases is ignored, attribute ordering is not\n+        significant. The passed in arguments must be valid HTML.\n+\n+        \"\"\"\n+        dom1 = assert_and_parse_html(self, html1, msg,\n+            u'First argument is not valid html:')\n+        dom2 = assert_and_parse_html(self, html2, msg,\n+            u'Second argument is not valid html:')\n+\n+        if dom1 != dom2:\n+            standardMsg = '%s != %s' % (\n+                safe_repr(dom1, True), safe_repr(dom2, True))\n+            diff = ('\\n' + '\\n'.join(difflib.ndiff(\n+                           unicode(dom1).splitlines(),\n+                           unicode(dom2).splitlines())))\n+            standardMsg = self._truncateMessage(standardMsg, diff)\n+            self.fail(self._formatMessage(msg, standardMsg))\n+\n+    def assertHTMLNotEqual(self, html1, html2, msg=None):\n+        \"\"\"Asserts that two HTML snippets are not semantically equivalent.\"\"\"\n+        dom1 = assert_and_parse_html(self, html1, msg,\n+            u'First argument is not valid html:')\n+        dom2 = assert_and_parse_html(self, html2, msg,\n+            u'Second argument is not valid html:')\n+\n+        if dom1 == dom2:\n+            standardMsg = '%s == %s' % (\n+                safe_repr(dom1, True), safe_repr(dom2, True))\n+            self.fail(self._formatMessage(msg, standardMsg))\n+\n \n class TransactionTestCase(SimpleTestCase):\n     # The class we'll use for the test client self.client.\n@@ -554,7 +600,7 @@ def assertRedirects(self, response, expected_url, status_code=302,\n                 (url, expected_url))\n \n     def assertContains(self, response, text, count=None, status_code=200,\n-                       msg_prefix=''):\n+                       msg_prefix='', html=False):\n         \"\"\"\n         Asserts that a response indicates that some content was retrieved\n         successfully, (i.e., the HTTP status code was as expected), and that\n@@ -576,7 +622,13 @@ def assertContains(self, response, text, count=None, status_code=200,\n             msg_prefix + \"Couldn't retrieve content: Response code was %d\"\n             \" (expected %d)\" % (response.status_code, status_code))\n         text = smart_str(text, response._charset)\n-        real_count = response.content.count(text)\n+        content = response.content\n+        if html:\n+            content = assert_and_parse_html(self, content, None,\n+                u\"Response's content is not valid html:\")\n+            text = assert_and_parse_html(self, text, None,\n+                u\"Second argument is not valid html:\")\n+        real_count = content.count(text)\n         if count is not None:\n             self.assertEqual(real_count, count,\n                 msg_prefix + \"Found %d instances of '%s' in response\"\n@@ -586,7 +638,7 @@ def assertContains(self, response, text, count=None, status_code=200,\n                 msg_prefix + \"Couldn't find '%s' in response\" % text)\n \n     def assertNotContains(self, response, text, status_code=200,\n-                          msg_prefix=''):\n+                          msg_prefix='', html=False):\n         \"\"\"\n         Asserts that a response indicates that some content was retrieved\n         successfully, (i.e., the HTTP status code was as expected), and that\n@@ -606,7 +658,13 @@ def assertNotContains(self, response, text, status_code=200,\n             msg_prefix + \"Couldn't retrieve content: Response code was %d\"\n             \" (expected %d)\" % (response.status_code, status_code))\n         text = smart_str(text, response._charset)\n-        self.assertEqual(response.content.count(text), 0,\n+        content = response.content\n+        if html:\n+            content = assert_and_parse_html(self, content, None,\n+                u'Response\\'s content is no valid html:')\n+            text = assert_and_parse_html(self, text, None,\n+                u'Second argument is no valid html:')\n+        self.assertEqual(content.count(text), 0,\n             msg_prefix + \"Response should not contain '%s'\" % text)\n \n     def assertFormError(self, response, form, field, errors, msg_prefix=''):"
        },
        {
            "sha": "ed743f5679accfc1bde7bb0e7e5f8d57007336b8",
            "filename": "django/utils/htmlparser.py",
            "status": "added",
            "additions": 94,
            "deletions": 0,
            "changes": 94,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/django%2Futils%2Fhtmlparser.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/django%2Futils%2Fhtmlparser.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fhtmlparser.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -0,0 +1,94 @@\n+import HTMLParser as _HTMLParser\n+\n+\n+class HTMLParser(_HTMLParser.HTMLParser):\n+    \"\"\"\n+    Patched version of stdlib's HTMLParser with patch from:\n+    http://bugs.python.org/issue670664\n+    \"\"\"\n+    def __init__(self):\n+        _HTMLParser.HTMLParser.__init__(self)\n+        self.cdata_tag = None\n+\n+    def set_cdata_mode(self, tag):\n+        self.interesting = _HTMLParser.interesting_cdata\n+        self.cdata_tag = tag.lower()\n+\n+    def clear_cdata_mode(self):\n+        self.interesting = _HTMLParser.interesting_normal\n+        self.cdata_tag = None\n+\n+    # Internal -- handle starttag, return end or -1 if not terminated\n+    def parse_starttag(self, i):\n+        self.__starttag_text = None\n+        endpos = self.check_for_whole_start_tag(i)\n+        if endpos < 0:\n+            return endpos\n+        rawdata = self.rawdata\n+        self.__starttag_text = rawdata[i:endpos]\n+\n+        # Now parse the data between i+1 and j into a tag and attrs\n+        attrs = []\n+        match = _HTMLParser.tagfind.match(rawdata, i + 1)\n+        assert match, 'unexpected call to parse_starttag()'\n+        k = match.end()\n+        self.lasttag = tag = rawdata[i + 1:k].lower()\n+\n+        while k < endpos:\n+            m = _HTMLParser.attrfind.match(rawdata, k)\n+            if not m:\n+                break\n+            attrname, rest, attrvalue = m.group(1, 2, 3)\n+            if not rest:\n+                attrvalue = None\n+            elif attrvalue[:1] == '\\'' == attrvalue[-1:] or \\\n+                 attrvalue[:1] == '\"' == attrvalue[-1:]:\n+                attrvalue = attrvalue[1:-1]\n+                attrvalue = self.unescape(attrvalue)\n+            attrs.append((attrname.lower(), attrvalue))\n+            k = m.end()\n+\n+        end = rawdata[k:endpos].strip()\n+        if end not in (\">\", \"/>\"):\n+            lineno, offset = self.getpos()\n+            if \"\\n\" in self.__starttag_text:\n+                lineno = lineno + self.__starttag_text.count(\"\\n\")\n+                offset = len(self.__starttag_text) \\\n+                         - self.__starttag_text.rfind(\"\\n\")\n+            else:\n+                offset = offset + len(self.__starttag_text)\n+            self.error(\"junk characters in start tag: %r\"\n+                       % (rawdata[k:endpos][:20],))\n+        if end.endswith('/>'):\n+            # XHTML-style empty tag: <span attr=\"value\" />\n+            self.handle_startendtag(tag, attrs)\n+        else:\n+            self.handle_starttag(tag, attrs)\n+            if tag in self.CDATA_CONTENT_ELEMENTS:\n+                self.set_cdata_mode(tag) # <--------------------------- Changed\n+        return endpos\n+\n+    # Internal -- parse endtag, return end or -1 if incomplete\n+    def parse_endtag(self, i):\n+        rawdata = self.rawdata\n+        assert rawdata[i:i + 2] == \"</\", \"unexpected call to parse_endtag\"\n+        match = _HTMLParser.endendtag.search(rawdata, i + 1) # >\n+        if not match:\n+            return -1\n+        j = match.end()\n+        match = _HTMLParser.endtagfind.match(rawdata, i) # </ + tag + >\n+        if not match:\n+            if self.cdata_tag is not None: # *** add ***\n+                self.handle_data(rawdata[i:j]) # *** add ***\n+                return j # *** add ***\n+            self.error(\"bad end tag: %r\" % (rawdata[i:j],))\n+        # --- changed start ---------------------------------------------------\n+        tag = match.group(1).strip()\n+        if self.cdata_tag is not None:\n+            if tag.lower() != self.cdata_tag:\n+                self.handle_data(rawdata[i:j])\n+                return j\n+        # --- changed end -----------------------------------------------------\n+        self.handle_endtag(tag.lower())\n+        self.clear_cdata_mode()\n+        return j"
        },
        {
            "sha": "cb0f01ed7d1bab9ad804a19221593a9a49f5b0fa",
            "filename": "docs/releases/1.4.txt",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/docs%2Freleases%2F1.4.txt",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/docs%2Freleases%2F1.4.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.4.txt?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -475,6 +475,21 @@ Time zone support is enabled by default in new projects created with\n :djadmin:`startproject`. If you want to use this feature in an existing\n project, read the :ref:`migration guide <time-zones-migration-guide>`.\n \n+HTML comparisons in tests\n+~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+The :class:`~django.test.testcase.TestCase` base class now has some helpers to\n+compare HTML without tripping over irrelevant differences in whitespace,\n+argument quoting and ordering, and closing of self-closing tags. HTML can\n+either be compared directly with the new\n+:meth:`~django.test.testcase.TestCase.assertHTMLEqual` and\n+:meth:`~django.test.testcase.TestCase.assertHTMLNotEqual` assertions, or use\n+the ``html=True`` flag with\n+:meth:`~django.test.testcase.TestCase.assertContains` and\n+:meth:`~django.test.testcase.TestCase.assertNotContains` to test if the test\n+client's response contains a given HTML fragment. See the :ref:`assertion\n+documentation<assertions>` for more information.\n+\n Minor features\n ~~~~~~~~~~~~~~\n "
        },
        {
            "sha": "ebc9f1ab28a9a8a5485a92d67151321da4d4379e",
            "filename": "docs/topics/testing.txt",
            "status": "modified",
            "additions": 60,
            "deletions": 2,
            "changes": 62,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/docs%2Ftopics%2Ftesting.txt",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/docs%2Ftopics%2Ftesting.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Ftesting.txt?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -1542,17 +1542,33 @@ your test suite.\n         self.assertFieldOutput(EmailField, {'a@a.com': 'a@a.com'}, {'aaa': [u'Enter a valid e-mail address.']})\n \n \n-.. method:: TestCase.assertContains(response, text, count=None, status_code=200, msg_prefix='')\n+.. method:: TestCase.assertContains(response, text, count=None, status_code=200, msg_prefix='', html=False)\n \n     Asserts that a ``Response`` instance produced the given ``status_code`` and\n     that ``text`` appears in the content of the response. If ``count`` is\n     provided, ``text`` must occur exactly ``count`` times in the response.\n \n-.. method:: TestCase.assertNotContains(response, text, status_code=200, msg_prefix='')\n+    .. versionadded:: 1.4\n+\n+    Set ``html`` to ``True`` to handle ``text`` as HTML. The comparison with\n+    the response content will be based on HTML semantics instead of\n+    character-by-character equality. Whitespace is ignored in most cases,\n+    attribute ordering is not significant. See\n+    :func:`~TestCase.assertHTMLEqual` for more details.\n+\n+.. method:: TestCase.assertNotContains(response, text, status_code=200, msg_prefix='', html=False)\n \n     Asserts that a ``Response`` instance produced the given ``status_code`` and\n     that ``text`` does not appears in the content of the response.\n \n+    .. versionadded:: 1.4\n+\n+    Set ``html`` to ``True`` to handle ``text`` as HTML. The comparison with\n+    the response content will be based on HTML semantics instead of\n+    character-by-character equality. Whitespace is ignored in most cases,\n+    attribute ordering is not significant. See\n+    :func:`~TestCase.assertHTMLEqual` for more details.\n+\n .. method:: TestCase.assertFormError(response, form, field, errors, msg_prefix='')\n \n     Asserts that a field on a form raises the provided list of errors when\n@@ -1656,6 +1672,48 @@ your test suite.\n             Person.objects.create(name=\"Aaron\")\n             Person.objects.create(name=\"Daniel\")\n \n+.. method:: TestCase.assertHTMLEqual(html1, html2, msg=None)\n+\n+    .. versionadded:: 1.4\n+\n+    Asserts that the strings ``html1`` and ``html2`` are equal. The comparison\n+    is based on HTML semantics. The comparison takes following things into\n+    account:\n+\n+    * Whitespace before and after HTML tags is ignored\n+    * All types of whitespace are considered equivalent\n+    * All open tags are closed implicitly, i.e. when a surrounding tag is\n+      closed or the HTML document ends\n+    * Empty tags are equivalent to their self-closing version\n+    * The ordering of attributes of an HTML element is not significant\n+    * Attributes without an argument are equal to attributes that equal in\n+      name and value (see the examples)\n+\n+    The following examples are valid tests and don't raise any\n+    ``AssertionError``::\n+\n+        self.assertHTMLEqual('<p>Hello <b>world!</p>',\n+            '''<p>\n+                Hello   <b>world! <b/>\n+            </p>''')\n+        self.assertHTMLEqual(\n+            '<input type=\"checkbox\" checked=\"checked\" id=\"id_accept_terms\" />',\n+            '<input id=\"id_accept_terms\" type='checkbox' checked>')\n+\n+    ``html1`` and ``html2`` must be valid HTML. An ``AssertionError`` will be\n+    raised if one of them cannot be parsed.\n+\n+.. method:: TestCase.assertHTMLNotEqual(html1, html2, msg=None)\n+\n+    .. versionadded:: 1.4\n+\n+    Asserts that the strings ``html1`` and ``html2`` are *not* equal. The\n+    comparison is based on HTML semantics. See\n+    :func:`~TestCase.assertHTMLEqual` for details.\n+\n+    ``html1`` and ``html2`` must be valid HTML. An ``AssertionError`` will be\n+    raised if one of them cannot be parsed.\n+\n \n .. _topics-testing-email:\n "
        },
        {
            "sha": "0ac552cf77099c2f78c5a6c9d211ff30e2404fb9",
            "filename": "tests/modeltests/generic_relations/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fmodeltests%2Fgeneric_relations%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fmodeltests%2Fgeneric_relations%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fgeneric_relations%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -200,11 +200,11 @@ def test_gfk_subclasses(self):\n     def test_generic_inline_formsets(self):\n         GenericFormSet = generic_inlineformset_factory(TaggedItem, extra=1)\n         formset = GenericFormSet()\n-        self.assertEqual(u''.join(form.as_p() for form in formset.forms), u\"\"\"<p><label for=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\">Tag:</label> <input id=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\" type=\"text\" name=\"generic_relations-taggeditem-content_type-object_id-0-tag\" maxlength=\"50\" /></p>\n+        self.assertHTMLEqual(u''.join(form.as_p() for form in formset.forms), u\"\"\"<p><label for=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\">Tag:</label> <input id=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\" type=\"text\" name=\"generic_relations-taggeditem-content_type-object_id-0-tag\" maxlength=\"50\" /></p>\n <p><label for=\"id_generic_relations-taggeditem-content_type-object_id-0-DELETE\">Delete:</label> <input type=\"checkbox\" name=\"generic_relations-taggeditem-content_type-object_id-0-DELETE\" id=\"id_generic_relations-taggeditem-content_type-object_id-0-DELETE\" /><input type=\"hidden\" name=\"generic_relations-taggeditem-content_type-object_id-0-id\" id=\"id_generic_relations-taggeditem-content_type-object_id-0-id\" /></p>\"\"\")\n \n         formset = GenericFormSet(instance=Animal())\n-        self.assertEqual(u''.join(form.as_p() for form in formset.forms), u\"\"\"<p><label for=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\">Tag:</label> <input id=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\" type=\"text\" name=\"generic_relations-taggeditem-content_type-object_id-0-tag\" maxlength=\"50\" /></p>\n+        self.assertHTMLEqual(u''.join(form.as_p() for form in formset.forms), u\"\"\"<p><label for=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\">Tag:</label> <input id=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\" type=\"text\" name=\"generic_relations-taggeditem-content_type-object_id-0-tag\" maxlength=\"50\" /></p>\n <p><label for=\"id_generic_relations-taggeditem-content_type-object_id-0-DELETE\">Delete:</label> <input type=\"checkbox\" name=\"generic_relations-taggeditem-content_type-object_id-0-DELETE\" id=\"id_generic_relations-taggeditem-content_type-object_id-0-DELETE\" /><input type=\"hidden\" name=\"generic_relations-taggeditem-content_type-object_id-0-id\" id=\"id_generic_relations-taggeditem-content_type-object_id-0-id\" /></p>\"\"\")\n \n         platypus = Animal.objects.create(\n@@ -216,13 +216,13 @@ def test_generic_inline_formsets(self):\n         tagged_item_id = TaggedItem.objects.get(\n             tag='shiny', object_id=platypus.id\n         ).id\n-        self.assertEqual(u''.join(form.as_p() for form in formset.forms), u\"\"\"<p><label for=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\">Tag:</label> <input id=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\" type=\"text\" name=\"generic_relations-taggeditem-content_type-object_id-0-tag\" value=\"shiny\" maxlength=\"50\" /></p>\n+        self.assertHTMLEqual(u''.join(form.as_p() for form in formset.forms), u\"\"\"<p><label for=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\">Tag:</label> <input id=\"id_generic_relations-taggeditem-content_type-object_id-0-tag\" type=\"text\" name=\"generic_relations-taggeditem-content_type-object_id-0-tag\" value=\"shiny\" maxlength=\"50\" /></p>\n <p><label for=\"id_generic_relations-taggeditem-content_type-object_id-0-DELETE\">Delete:</label> <input type=\"checkbox\" name=\"generic_relations-taggeditem-content_type-object_id-0-DELETE\" id=\"id_generic_relations-taggeditem-content_type-object_id-0-DELETE\" /><input type=\"hidden\" name=\"generic_relations-taggeditem-content_type-object_id-0-id\" value=\"%s\" id=\"id_generic_relations-taggeditem-content_type-object_id-0-id\" /></p><p><label for=\"id_generic_relations-taggeditem-content_type-object_id-1-tag\">Tag:</label> <input id=\"id_generic_relations-taggeditem-content_type-object_id-1-tag\" type=\"text\" name=\"generic_relations-taggeditem-content_type-object_id-1-tag\" maxlength=\"50\" /></p>\n <p><label for=\"id_generic_relations-taggeditem-content_type-object_id-1-DELETE\">Delete:</label> <input type=\"checkbox\" name=\"generic_relations-taggeditem-content_type-object_id-1-DELETE\" id=\"id_generic_relations-taggeditem-content_type-object_id-1-DELETE\" /><input type=\"hidden\" name=\"generic_relations-taggeditem-content_type-object_id-1-id\" id=\"id_generic_relations-taggeditem-content_type-object_id-1-id\" /></p>\"\"\" % tagged_item_id)\n \n         lion = Animal.objects.create(common_name=\"Lion\", latin_name=\"Panthera leo\")\n         formset = GenericFormSet(instance=lion, prefix='x')\n-        self.assertEqual(u''.join(form.as_p() for form in formset.forms), u\"\"\"<p><label for=\"id_x-0-tag\">Tag:</label> <input id=\"id_x-0-tag\" type=\"text\" name=\"x-0-tag\" maxlength=\"50\" /></p>\n+        self.assertHTMLEqual(u''.join(form.as_p() for form in formset.forms), u\"\"\"<p><label for=\"id_x-0-tag\">Tag:</label> <input id=\"id_x-0-tag\" type=\"text\" name=\"x-0-tag\" maxlength=\"50\" /></p>\n <p><label for=\"id_x-0-DELETE\">Delete:</label> <input type=\"checkbox\" name=\"x-0-DELETE\" id=\"id_x-0-DELETE\" /><input type=\"hidden\" name=\"x-0-id\" id=\"id_x-0-id\" /></p>\"\"\")\n \n     def test_gfk_manager(self):"
        },
        {
            "sha": "a2ad02482724b84f5e62c5e70c303cab4a80772f",
            "filename": "tests/modeltests/model_forms/tests.py",
            "status": "modified",
            "additions": 24,
            "deletions": 24,
            "changes": 48,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fmodeltests%2Fmodel_forms%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fmodeltests%2Fmodel_forms%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fmodel_forms%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -298,7 +298,7 @@ class SubclassMeta(SomeCategoryForm):\n             class Meta(SomeCategoryForm.Meta):\n                 exclude = ['url']\n \n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             str(SubclassMeta()),\n             \"\"\"<tr><th><label for=\"id_name\">Name:</label></th><td><input id=\"id_name\" type=\"text\" name=\"name\" maxlength=\"20\" /></td></tr>\n <tr><th><label for=\"id_slug\">Slug:</label></th><td><input id=\"id_slug\" type=\"text\" name=\"slug\" maxlength=\"20\" /></td></tr>\n@@ -313,7 +313,7 @@ class Meta:\n \n         self.assertEqual(OrderFields.base_fields.keys(),\n                          ['url', 'name'])\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             str(OrderFields()),\n             \"\"\"<tr><th><label for=\"id_url\">The URL:</label></th><td><input id=\"id_url\" type=\"text\" name=\"url\" maxlength=\"40\" /></td></tr>\n <tr><th><label for=\"id_name\">Name:</label></th><td><input id=\"id_name\" type=\"text\" name=\"name\" maxlength=\"20\" /></td></tr>\"\"\"\n@@ -344,15 +344,15 @@ class Meta:\n class TestWidgets(TestCase):\n     def test_base_widgets(self):\n         frm = TestWidgetForm()\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             str(frm['name']),\n             '<textarea id=\"id_name\" rows=\"10\" cols=\"40\" name=\"name\"></textarea>'\n         )\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             str(frm['url']),\n             '<input id=\"id_url\" type=\"text\" class=\"url\" name=\"url\" maxlength=\"40\" />'\n         )\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             str(frm['slug']),\n             '<input id=\"id_slug\" type=\"text\" name=\"slug\" maxlength=\"20\" />'\n         )\n@@ -563,25 +563,25 @@ class OldFormForXTests(TestCase):\n     def test_base_form(self):\n         self.assertEqual(Category.objects.count(), 0)\n         f = BaseCategoryForm()\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             str(f),\n             \"\"\"<tr><th><label for=\"id_name\">Name:</label></th><td><input id=\"id_name\" type=\"text\" name=\"name\" maxlength=\"20\" /></td></tr>\n <tr><th><label for=\"id_slug\">Slug:</label></th><td><input id=\"id_slug\" type=\"text\" name=\"slug\" maxlength=\"20\" /></td></tr>\n <tr><th><label for=\"id_url\">The URL:</label></th><td><input id=\"id_url\" type=\"text\" name=\"url\" maxlength=\"40\" /></td></tr>\"\"\"\n             )\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             str(f.as_ul()),\n             \"\"\"<li><label for=\"id_name\">Name:</label> <input id=\"id_name\" type=\"text\" name=\"name\" maxlength=\"20\" /></li>\n <li><label for=\"id_slug\">Slug:</label> <input id=\"id_slug\" type=\"text\" name=\"slug\" maxlength=\"20\" /></li>\n <li><label for=\"id_url\">The URL:</label> <input id=\"id_url\" type=\"text\" name=\"url\" maxlength=\"40\" /></li>\"\"\"\n             )\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             str(f[\"name\"]),\n             \"\"\"<input id=\"id_name\" type=\"text\" name=\"name\" maxlength=\"20\" />\"\"\")\n \n     def test_auto_id(self):\n         f = BaseCategoryForm(auto_id=False)\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             str(f.as_ul()),\n             \"\"\"<li>Name: <input type=\"text\" name=\"name\" maxlength=\"20\" /></li>\n <li>Slug: <input type=\"text\" name=\"slug\" maxlength=\"20\" /></li>\n@@ -653,7 +653,7 @@ def test_with_data(self):\n         # ManyToManyFields are represented by a MultipleChoiceField, ForeignKeys and any\n         # fields with the 'choices' attribute are represented by a ChoiceField.\n         f = ArticleForm(auto_id=False)\n-        self.assertEqual(unicode(f), '''<tr><th>Headline:</th><td><input type=\"text\" name=\"headline\" maxlength=\"50\" /></td></tr>\n+        self.assertHTMLEqual(unicode(f), '''<tr><th>Headline:</th><td><input type=\"text\" name=\"headline\" maxlength=\"50\" /></td></tr>\n <tr><th>Slug:</th><td><input type=\"text\" name=\"slug\" maxlength=\"50\" /></td></tr>\n <tr><th>Pub date:</th><td><input type=\"text\" name=\"pub_date\" /></td></tr>\n <tr><th>Writer:</th><td><select name=\"writer\">\n@@ -681,14 +681,14 @@ def test_with_data(self):\n         # a value of None. If a field isn't specified on a form, the object created\n         # from the form can't provide a value for that field!\n         f = PartialArticleForm(auto_id=False)\n-        self.assertEqual(unicode(f), '''<tr><th>Headline:</th><td><input type=\"text\" name=\"headline\" maxlength=\"50\" /></td></tr>\n+        self.assertHTMLEqual(unicode(f), '''<tr><th>Headline:</th><td><input type=\"text\" name=\"headline\" maxlength=\"50\" /></td></tr>\n <tr><th>Pub date:</th><td><input type=\"text\" name=\"pub_date\" /></td></tr>''')\n \n         # When the ModelForm is passed an instance, that instance's current values are\n         # inserted as 'initial' data in each Field.\n         w = Writer.objects.get(name='Mike Royko')\n         f = RoykoForm(auto_id=False, instance=w)\n-        self.assertEqual(unicode(f), '''<tr><th>Name:</th><td><input type=\"text\" name=\"name\" value=\"Mike Royko\" maxlength=\"50\" /><br /><span class=\"helptext\">Use both first and last names.</span></td></tr>''')\n+        self.assertHTMLEqual(unicode(f), '''<tr><th>Name:</th><td><input type=\"text\" name=\"name\" value=\"Mike Royko\" maxlength=\"50\" /><br /><span class=\"helptext\">Use both first and last names.</span></td></tr>''')\n \n         art = Article(\n                     headline='Test article',\n@@ -701,7 +701,7 @@ def test_with_data(self):\n         art_id_1 = art.id\n         self.assertEqual(art_id_1 is not None, True)\n         f = TestArticleForm(auto_id=False, instance=art)\n-        self.assertEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" value=\"Test article\" maxlength=\"50\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" value=\"Test article\" maxlength=\"50\" /></li>\n <li>Slug: <input type=\"text\" name=\"slug\" value=\"test-article\" maxlength=\"50\" /></li>\n <li>Pub date: <input type=\"text\" name=\"pub_date\" value=\"1988-01-04\" /></li>\n <li>Writer: <select name=\"writer\">\n@@ -741,7 +741,7 @@ def test_with_data(self):\n                 'slug': 'new-headline',\n                 'pub_date': u'1988-01-04'\n             }, auto_id=False, instance=art)\n-        self.assertEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" value=\"New headline\" maxlength=\"50\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" value=\"New headline\" maxlength=\"50\" /></li>\n <li>Slug: <input type=\"text\" name=\"slug\" value=\"new-headline\" maxlength=\"50\" /></li>\n <li>Pub date: <input type=\"text\" name=\"pub_date\" value=\"1988-01-04\" /></li>''')\n         self.assertEqual(f.is_valid(), True)\n@@ -755,7 +755,7 @@ def test_with_data(self):\n         new_art.categories.add(Category.objects.get(name='Entertainment'))\n         self.assertEqual(map(lambda o: o.name, new_art.categories.all()), [\"Entertainment\"])\n         f = TestArticleForm(auto_id=False, instance=new_art)\n-        self.assertEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" value=\"New headline\" maxlength=\"50\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" value=\"New headline\" maxlength=\"50\" /></li>\n <li>Slug: <input type=\"text\" name=\"slug\" value=\"new-headline\" maxlength=\"50\" /></li>\n <li>Pub date: <input type=\"text\" name=\"pub_date\" value=\"1988-01-04\" /></li>\n <li>Writer: <select name=\"writer\">\n@@ -783,7 +783,7 @@ def test_with_data(self):\n                     'headline': 'Your headline here',\n                     'categories': [str(c1.id), str(c2.id)]\n                 })\n-        self.assertEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" value=\"Your headline here\" maxlength=\"50\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" value=\"Your headline here\" maxlength=\"50\" /></li>\n <li>Slug: <input type=\"text\" name=\"slug\" maxlength=\"50\" /></li>\n <li>Pub date: <input type=\"text\" name=\"pub_date\" /></li>\n <li>Writer: <select name=\"writer\">\n@@ -877,7 +877,7 @@ def test_with_data(self):\n         # at runtime, based on the data in the database when the form is displayed, not\n         # the data in the database when the form is instantiated.\n         f = ArticleForm(auto_id=False)\n-        self.assertEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" maxlength=\"50\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" maxlength=\"50\" /></li>\n <li>Slug: <input type=\"text\" name=\"slug\" maxlength=\"50\" /></li>\n <li>Pub date: <input type=\"text\" name=\"pub_date\" /></li>\n <li>Writer: <select name=\"writer\">\n@@ -902,7 +902,7 @@ def test_with_data(self):\n         self.assertEqual(c4.name, 'Fourth')\n         w_bernstein = Writer.objects.create(name='Carl Bernstein')\n         self.assertEqual(w_bernstein.name, 'Carl Bernstein')\n-        self.assertEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" maxlength=\"50\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), '''<li>Headline: <input type=\"text\" name=\"headline\" maxlength=\"50\" /></li>\n <li>Slug: <input type=\"text\" name=\"slug\" maxlength=\"50\" /></li>\n <li>Pub date: <input type=\"text\" name=\"pub_date\" /></li>\n <li>Writer: <select name=\"writer\">\n@@ -1081,7 +1081,7 @@ def test_with_data(self):\n         bw2.delete()\n \n         form = WriterProfileForm()\n-        self.assertEqual(form.as_p(), '''<p><label for=\"id_writer\">Writer:</label> <select name=\"writer\" id=\"id_writer\">\n+        self.assertHTMLEqual(form.as_p(), '''<p><label for=\"id_writer\">Writer:</label> <select name=\"writer\" id=\"id_writer\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"%s\">Bob Woodward</option>\n <option value=\"%s\">Carl Bernstein</option>\n@@ -1099,7 +1099,7 @@ def test_with_data(self):\n         self.assertEqual(unicode(instance), 'Bob Woodward is 65')\n \n         form = WriterProfileForm(instance=instance)\n-        self.assertEqual(form.as_p(), '''<p><label for=\"id_writer\">Writer:</label> <select name=\"writer\" id=\"id_writer\">\n+        self.assertHTMLEqual(form.as_p(), '''<p><label for=\"id_writer\">Writer:</label> <select name=\"writer\" id=\"id_writer\">\n <option value=\"\">---------</option>\n <option value=\"%s\" selected=\"selected\">Bob Woodward</option>\n <option value=\"%s\">Carl Bernstein</option>\n@@ -1374,7 +1374,7 @@ def test_media_on_modelform(self):\n         # Similar to a regular Form class you can define custom media to be used on\n         # the ModelForm.\n         f = ModelFormWithMedia()\n-        self.assertEqual(unicode(f.media), '''<link href=\"/some/form/css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\" />\n+        self.assertHTMLEqual(unicode(f.media), '''<link href=\"/some/form/css\" type=\"text/css\" media=\"all\" rel=\"stylesheet\" />\n <script type=\"text/javascript\" src=\"/some/form/javascript\"></script>''')\n \n         f = CommaSeparatedIntegerForm({'field': '1,2,3'})\n@@ -1443,7 +1443,7 @@ def test_foreignkeys_which_use_to_field(self):\n             (22, u'Pear')))\n \n         form = InventoryForm(instance=core)\n-        self.assertEqual(unicode(form['parent']), '''<select name=\"parent\" id=\"id_parent\">\n+        self.assertHTMLEqual(unicode(form['parent']), '''<select name=\"parent\" id=\"id_parent\">\n <option value=\"\">---------</option>\n <option value=\"86\" selected=\"selected\">Apple</option>\n <option value=\"87\">Core</option>\n@@ -1464,7 +1464,7 @@ class Meta:\n         self.assertEqual(CategoryForm.base_fields.keys(),\n                          ['description', 'url'])\n \n-        self.assertEqual(unicode(CategoryForm()), '''<tr><th><label for=\"id_description\">Description:</label></th><td><input type=\"text\" name=\"description\" id=\"id_description\" /></td></tr>\n+        self.assertHTMLEqual(unicode(CategoryForm()), '''<tr><th><label for=\"id_description\">Description:</label></th><td><input type=\"text\" name=\"description\" id=\"id_description\" /></td></tr>\n <tr><th><label for=\"id_url\">The URL:</label></th><td><input id=\"id_url\" type=\"text\" name=\"url\" maxlength=\"40\" /></td></tr>''')\n         # to_field_name should also work on ModelMultipleChoiceField ##################\n \n@@ -1479,5 +1479,5 @@ class Meta:\n \n     def test_model_field_that_returns_none_to_exclude_itself_with_explicit_fields(self):\n         self.assertEqual(CustomFieldForExclusionForm.base_fields.keys(), ['name'])\n-        self.assertEqual(unicode(CustomFieldForExclusionForm()),\n+        self.assertHTMLEqual(unicode(CustomFieldForExclusionForm()),\n                          '''<tr><th><label for=\"id_name\">Name:</label></th><td><input id=\"id_name\" type=\"text\" name=\"name\" maxlength=\"10\" /></td></tr>''')"
        },
        {
            "sha": "46941471b1e1f26112032e4a9f8433124057c6fc",
            "filename": "tests/modeltests/model_formsets/tests.py",
            "status": "modified",
            "additions": 42,
            "deletions": 42,
            "changes": 84,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fmodel_formsets%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -95,11 +95,11 @@ def test_simple_save(self):\n \n         formset = AuthorFormSet(queryset=qs)\n         self.assertEqual(len(formset.forms), 3)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_form-0-name\">Name:</label> <input id=\"id_form-0-name\" type=\"text\" name=\"form-0-name\" maxlength=\"100\" /><input type=\"hidden\" name=\"form-0-id\" id=\"id_form-0-id\" /></p>')\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_form-1-name\">Name:</label> <input id=\"id_form-1-name\" type=\"text\" name=\"form-1-name\" maxlength=\"100\" /><input type=\"hidden\" name=\"form-1-id\" id=\"id_form-1-id\" /></p>')\n-        self.assertEqual(formset.forms[2].as_p(),\n+        self.assertHTMLEqual(formset.forms[2].as_p(),\n             '<p><label for=\"id_form-2-name\">Name:</label> <input id=\"id_form-2-name\" type=\"text\" name=\"form-2-name\" maxlength=\"100\" /><input type=\"hidden\" name=\"form-2-id\" id=\"id_form-2-id\" /></p>')\n \n         data = {\n@@ -133,11 +133,11 @@ def test_simple_save(self):\n \n         formset = AuthorFormSet(queryset=qs)\n         self.assertEqual(len(formset.forms), 3)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_form-0-name\">Name:</label> <input id=\"id_form-0-name\" type=\"text\" name=\"form-0-name\" value=\"Arthur Rimbaud\" maxlength=\"100\" /><input type=\"hidden\" name=\"form-0-id\" value=\"%d\" id=\"id_form-0-id\" /></p>' % author2.id)\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_form-1-name\">Name:</label> <input id=\"id_form-1-name\" type=\"text\" name=\"form-1-name\" value=\"Charles Baudelaire\" maxlength=\"100\" /><input type=\"hidden\" name=\"form-1-id\" value=\"%d\" id=\"id_form-1-id\" /></p>' % author1.id)\n-        self.assertEqual(formset.forms[2].as_p(),\n+        self.assertHTMLEqual(formset.forms[2].as_p(),\n             '<p><label for=\"id_form-2-name\">Name:</label> <input id=\"id_form-2-name\" type=\"text\" name=\"form-2-name\" maxlength=\"100\" /><input type=\"hidden\" name=\"form-2-id\" id=\"id_form-2-id\" /></p>')\n \n         data = {\n@@ -171,16 +171,16 @@ def test_simple_save(self):\n \n         formset = AuthorFormSet(queryset=qs)\n         self.assertEqual(len(formset.forms), 4)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_form-0-name\">Name:</label> <input id=\"id_form-0-name\" type=\"text\" name=\"form-0-name\" value=\"Arthur Rimbaud\" maxlength=\"100\" /></p>\\n'\n             '<p><label for=\"id_form-0-DELETE\">Delete:</label> <input type=\"checkbox\" name=\"form-0-DELETE\" id=\"id_form-0-DELETE\" /><input type=\"hidden\" name=\"form-0-id\" value=\"%d\" id=\"id_form-0-id\" /></p>' % author2.id)\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_form-1-name\">Name:</label> <input id=\"id_form-1-name\" type=\"text\" name=\"form-1-name\" value=\"Charles Baudelaire\" maxlength=\"100\" /></p>\\n'\n             '<p><label for=\"id_form-1-DELETE\">Delete:</label> <input type=\"checkbox\" name=\"form-1-DELETE\" id=\"id_form-1-DELETE\" /><input type=\"hidden\" name=\"form-1-id\" value=\"%d\" id=\"id_form-1-id\" /></p>' % author1.id)\n-        self.assertEqual(formset.forms[2].as_p(),\n+        self.assertHTMLEqual(formset.forms[2].as_p(),\n             '<p><label for=\"id_form-2-name\">Name:</label> <input id=\"id_form-2-name\" type=\"text\" name=\"form-2-name\" value=\"Paul Verlaine\" maxlength=\"100\" /></p>\\n'\n             '<p><label for=\"id_form-2-DELETE\">Delete:</label> <input type=\"checkbox\" name=\"form-2-DELETE\" id=\"id_form-2-DELETE\" /><input type=\"hidden\" name=\"form-2-id\" value=\"%d\" id=\"id_form-2-id\" /></p>' % author3.id)\n-        self.assertEqual(formset.forms[3].as_p(),\n+        self.assertHTMLEqual(formset.forms[3].as_p(),\n             '<p><label for=\"id_form-3-name\">Name:</label> <input id=\"id_form-3-name\" type=\"text\" name=\"form-3-name\" maxlength=\"100\" /></p>\\n'\n             '<p><label for=\"id_form-3-DELETE\">Delete:</label> <input type=\"checkbox\" name=\"form-3-DELETE\" id=\"id_form-3-DELETE\" /><input type=\"hidden\" name=\"form-3-id\" id=\"id_form-3-id\" /></p>')\n \n@@ -381,7 +381,7 @@ def test_model_inheritance(self):\n         BetterAuthorFormSet = modelformset_factory(BetterAuthor)\n         formset = BetterAuthorFormSet()\n         self.assertEqual(len(formset.forms), 1)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_form-0-name\">Name:</label> <input id=\"id_form-0-name\" type=\"text\" name=\"form-0-name\" maxlength=\"100\" /></p>\\n'\n             '<p><label for=\"id_form-0-write_speed\">Write speed:</label> <input type=\"text\" name=\"form-0-write_speed\" id=\"id_form-0-write_speed\" /><input type=\"hidden\" name=\"form-0-author_ptr\" id=\"id_form-0-author_ptr\" /></p>')\n \n@@ -404,10 +404,10 @@ def test_model_inheritance(self):\n \n         formset = BetterAuthorFormSet()\n         self.assertEqual(len(formset.forms), 2)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_form-0-name\">Name:</label> <input id=\"id_form-0-name\" type=\"text\" name=\"form-0-name\" value=\"Ernest Hemingway\" maxlength=\"100\" /></p>\\n'\n             '<p><label for=\"id_form-0-write_speed\">Write speed:</label> <input type=\"text\" name=\"form-0-write_speed\" value=\"10\" id=\"id_form-0-write_speed\" /><input type=\"hidden\" name=\"form-0-author_ptr\" value=\"%d\" id=\"id_form-0-author_ptr\" /></p>' % hemingway_id)\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_form-1-name\">Name:</label> <input id=\"id_form-1-name\" type=\"text\" name=\"form-1-name\" maxlength=\"100\" /></p>\\n'\n             '<p><label for=\"id_form-1-write_speed\">Write speed:</label> <input type=\"text\" name=\"form-1-write_speed\" id=\"id_form-1-write_speed\" /><input type=\"hidden\" name=\"form-1-author_ptr\" id=\"id_form-1-author_ptr\" /></p>')\n \n@@ -436,11 +436,11 @@ def test_inline_formsets(self):\n \n         formset = AuthorBooksFormSet(instance=author)\n         self.assertEqual(len(formset.forms), 3)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_book_set-0-title\">Title:</label> <input id=\"id_book_set-0-title\" type=\"text\" name=\"book_set-0-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-0-author\" value=\"%d\" id=\"id_book_set-0-author\" /><input type=\"hidden\" name=\"book_set-0-id\" id=\"id_book_set-0-id\" /></p>'  % author.id)\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_book_set-1-title\">Title:</label> <input id=\"id_book_set-1-title\" type=\"text\" name=\"book_set-1-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-1-author\" value=\"%d\" id=\"id_book_set-1-author\" /><input type=\"hidden\" name=\"book_set-1-id\" id=\"id_book_set-1-id\" /></p>' % author.id)\n-        self.assertEqual(formset.forms[2].as_p(),\n+        self.assertHTMLEqual(formset.forms[2].as_p(),\n             '<p><label for=\"id_book_set-2-title\">Title:</label> <input id=\"id_book_set-2-title\" type=\"text\" name=\"book_set-2-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-2-author\" value=\"%d\" id=\"id_book_set-2-author\" /><input type=\"hidden\" name=\"book_set-2-id\" id=\"id_book_set-2-id\" /></p>' % author.id)\n \n         data = {\n@@ -470,11 +470,11 @@ def test_inline_formsets(self):\n \n         formset = AuthorBooksFormSet(instance=author)\n         self.assertEqual(len(formset.forms), 3)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_book_set-0-title\">Title:</label> <input id=\"id_book_set-0-title\" type=\"text\" name=\"book_set-0-title\" value=\"Les Fleurs du Mal\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-0-author\" value=\"%d\" id=\"id_book_set-0-author\" /><input type=\"hidden\" name=\"book_set-0-id\" value=\"%d\" id=\"id_book_set-0-id\" /></p>' % (author.id, book1.id))\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_book_set-1-title\">Title:</label> <input id=\"id_book_set-1-title\" type=\"text\" name=\"book_set-1-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-1-author\" value=\"%d\" id=\"id_book_set-1-author\" /><input type=\"hidden\" name=\"book_set-1-id\" id=\"id_book_set-1-id\" /></p>' % author.id)\n-        self.assertEqual(formset.forms[2].as_p(),\n+        self.assertHTMLEqual(formset.forms[2].as_p(),\n             '<p><label for=\"id_book_set-2-title\">Title:</label> <input id=\"id_book_set-2-title\" type=\"text\" name=\"book_set-2-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-2-author\" value=\"%d\" id=\"id_book_set-2-author\" /><input type=\"hidden\" name=\"book_set-2-id\" id=\"id_book_set-2-id\" /></p>' % author.id)\n \n         data = {\n@@ -534,9 +534,9 @@ def test_inline_formsets_save_as_new(self):\n \n         formset = AuthorBooksFormSet(prefix=\"test\")\n         self.assertEqual(len(formset.forms), 2)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_test-0-title\">Title:</label> <input id=\"id_test-0-title\" type=\"text\" name=\"test-0-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"test-0-author\" id=\"id_test-0-author\" /><input type=\"hidden\" name=\"test-0-id\" id=\"id_test-0-id\" /></p>')\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_test-1-title\">Title:</label> <input id=\"id_test-1-title\" type=\"text\" name=\"test-1-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"test-1-author\" id=\"id_test-1-author\" /><input type=\"hidden\" name=\"test-1-id\" id=\"id_test-1-id\" /></p>')\n \n     def test_inline_formsets_with_custom_pk(self):\n@@ -548,7 +548,7 @@ def test_inline_formsets_with_custom_pk(self):\n \n         formset = AuthorBooksFormSet2(instance=author)\n         self.assertEqual(len(formset.forms), 1)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_bookwithcustompk_set-0-my_pk\">My pk:</label> <input type=\"text\" name=\"bookwithcustompk_set-0-my_pk\" id=\"id_bookwithcustompk_set-0-my_pk\" /></p>\\n'\n             '<p><label for=\"id_bookwithcustompk_set-0-title\">Title:</label> <input id=\"id_bookwithcustompk_set-0-title\" type=\"text\" name=\"bookwithcustompk_set-0-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"bookwithcustompk_set-0-author\" value=\"1\" id=\"id_bookwithcustompk_set-0-author\" /></p>')\n \n@@ -580,7 +580,7 @@ def test_inline_formsets_with_multi_table_inheritance(self):\n \n         formset = AuthorBooksFormSet3(instance=author)\n         self.assertEqual(len(formset.forms), 1)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_alternatebook_set-0-title\">Title:</label> <input id=\"id_alternatebook_set-0-title\" type=\"text\" name=\"alternatebook_set-0-title\" maxlength=\"100\" /></p>\\n'\n             '<p><label for=\"id_alternatebook_set-0-notes\">Notes:</label> <input id=\"id_alternatebook_set-0-notes\" type=\"text\" name=\"alternatebook_set-0-notes\" maxlength=\"100\" /><input type=\"hidden\" name=\"alternatebook_set-0-author\" value=\"1\" id=\"id_alternatebook_set-0-author\" /><input type=\"hidden\" name=\"alternatebook_set-0-book_ptr\" id=\"id_alternatebook_set-0-book_ptr\" /></p>')\n \n@@ -671,15 +671,15 @@ def save(self, commit=True):\n         custom_qs = Book.objects.order_by('-title')\n         formset = AuthorBooksFormSet(instance=author, queryset=custom_qs)\n         self.assertEqual(len(formset.forms), 5)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_book_set-0-title\">Title:</label> <input id=\"id_book_set-0-title\" type=\"text\" name=\"book_set-0-title\" value=\"Les Paradis Artificiels\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-0-author\" value=\"1\" id=\"id_book_set-0-author\" /><input type=\"hidden\" name=\"book_set-0-id\" value=\"1\" id=\"id_book_set-0-id\" /></p>')\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_book_set-1-title\">Title:</label> <input id=\"id_book_set-1-title\" type=\"text\" name=\"book_set-1-title\" value=\"Les Fleurs du Mal\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-1-author\" value=\"1\" id=\"id_book_set-1-author\" /><input type=\"hidden\" name=\"book_set-1-id\" value=\"2\" id=\"id_book_set-1-id\" /></p>')\n-        self.assertEqual(formset.forms[2].as_p(),\n+        self.assertHTMLEqual(formset.forms[2].as_p(),\n             '<p><label for=\"id_book_set-2-title\">Title:</label> <input id=\"id_book_set-2-title\" type=\"text\" name=\"book_set-2-title\" value=\"Flowers of Evil\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-2-author\" value=\"1\" id=\"id_book_set-2-author\" /><input type=\"hidden\" name=\"book_set-2-id\" value=\"3\" id=\"id_book_set-2-id\" /></p>')\n-        self.assertEqual(formset.forms[3].as_p(),\n+        self.assertHTMLEqual(formset.forms[3].as_p(),\n             '<p><label for=\"id_book_set-3-title\">Title:</label> <input id=\"id_book_set-3-title\" type=\"text\" name=\"book_set-3-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-3-author\" value=\"1\" id=\"id_book_set-3-author\" /><input type=\"hidden\" name=\"book_set-3-id\" id=\"id_book_set-3-id\" /></p>')\n-        self.assertEqual(formset.forms[4].as_p(),\n+        self.assertHTMLEqual(formset.forms[4].as_p(),\n             '<p><label for=\"id_book_set-4-title\">Title:</label> <input id=\"id_book_set-4-title\" type=\"text\" name=\"book_set-4-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-4-author\" value=\"1\" id=\"id_book_set-4-author\" /><input type=\"hidden\" name=\"book_set-4-id\" id=\"id_book_set-4-id\" /></p>')\n \n         data = {\n@@ -700,11 +700,11 @@ def save(self, commit=True):\n \n         custom_qs = Book.objects.filter(title__startswith='F')\n         formset = AuthorBooksFormSet(instance=author, queryset=custom_qs)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_book_set-0-title\">Title:</label> <input id=\"id_book_set-0-title\" type=\"text\" name=\"book_set-0-title\" value=\"Flowers of Evil\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-0-author\" value=\"1\" id=\"id_book_set-0-author\" /><input type=\"hidden\" name=\"book_set-0-id\" value=\"3\" id=\"id_book_set-0-id\" /></p>')\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_book_set-1-title\">Title:</label> <input id=\"id_book_set-1-title\" type=\"text\" name=\"book_set-1-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-1-author\" value=\"1\" id=\"id_book_set-1-author\" /><input type=\"hidden\" name=\"book_set-1-id\" id=\"id_book_set-1-id\" /></p>')\n-        self.assertEqual(formset.forms[2].as_p(),\n+        self.assertHTMLEqual(formset.forms[2].as_p(),\n             '<p><label for=\"id_book_set-2-title\">Title:</label> <input id=\"id_book_set-2-title\" type=\"text\" name=\"book_set-2-title\" maxlength=\"100\" /><input type=\"hidden\" name=\"book_set-2-author\" value=\"1\" id=\"id_book_set-2-author\" /><input type=\"hidden\" name=\"book_set-2-id\" id=\"id_book_set-2-id\" /></p>')\n \n         data = {\n@@ -725,7 +725,7 @@ def test_custom_pk(self):\n         CustomPrimaryKeyFormSet = modelformset_factory(CustomPrimaryKey)\n         formset = CustomPrimaryKeyFormSet()\n         self.assertEqual(len(formset.forms), 1)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_form-0-my_pk\">My pk:</label> <input id=\"id_form-0-my_pk\" type=\"text\" name=\"form-0-my_pk\" maxlength=\"10\" /></p>\\n'\n             '<p><label for=\"id_form-0-some_field\">Some field:</label> <input id=\"id_form-0-some_field\" type=\"text\" name=\"form-0-some_field\" maxlength=\"100\" /></p>')\n \n@@ -736,9 +736,9 @@ def test_custom_pk(self):\n         FormSet = inlineformset_factory(Place, Owner, extra=2, can_delete=False)\n         formset = FormSet(instance=place)\n         self.assertEqual(len(formset.forms), 2)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_owner_set-0-name\">Name:</label> <input id=\"id_owner_set-0-name\" type=\"text\" name=\"owner_set-0-name\" maxlength=\"100\" /><input type=\"hidden\" name=\"owner_set-0-place\" value=\"1\" id=\"id_owner_set-0-place\" /><input type=\"hidden\" name=\"owner_set-0-auto_id\" id=\"id_owner_set-0-auto_id\" /></p>')\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_owner_set-1-name\">Name:</label> <input id=\"id_owner_set-1-name\" type=\"text\" name=\"owner_set-1-name\" maxlength=\"100\" /><input type=\"hidden\" name=\"owner_set-1-place\" value=\"1\" id=\"id_owner_set-1-place\" /><input type=\"hidden\" name=\"owner_set-1-auto_id\" id=\"id_owner_set-1-auto_id\" /></p>')\n \n         data = {\n@@ -760,12 +760,12 @@ def test_custom_pk(self):\n \n         formset = FormSet(instance=place)\n         self.assertEqual(len(formset.forms), 3)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_owner_set-0-name\">Name:</label> <input id=\"id_owner_set-0-name\" type=\"text\" name=\"owner_set-0-name\" value=\"Joe Perry\" maxlength=\"100\" /><input type=\"hidden\" name=\"owner_set-0-place\" value=\"1\" id=\"id_owner_set-0-place\" /><input type=\"hidden\" name=\"owner_set-0-auto_id\" value=\"%d\" id=\"id_owner_set-0-auto_id\" /></p>'\n             % owner1.auto_id)\n-        self.assertEqual(formset.forms[1].as_p(),\n+        self.assertHTMLEqual(formset.forms[1].as_p(),\n             '<p><label for=\"id_owner_set-1-name\">Name:</label> <input id=\"id_owner_set-1-name\" type=\"text\" name=\"owner_set-1-name\" maxlength=\"100\" /><input type=\"hidden\" name=\"owner_set-1-place\" value=\"1\" id=\"id_owner_set-1-place\" /><input type=\"hidden\" name=\"owner_set-1-auto_id\" id=\"id_owner_set-1-auto_id\" /></p>')\n-        self.assertEqual(formset.forms[2].as_p(),\n+        self.assertHTMLEqual(formset.forms[2].as_p(),\n             '<p><label for=\"id_owner_set-2-name\">Name:</label> <input id=\"id_owner_set-2-name\" type=\"text\" name=\"owner_set-2-name\" maxlength=\"100\" /><input type=\"hidden\" name=\"owner_set-2-place\" value=\"1\" id=\"id_owner_set-2-place\" /><input type=\"hidden\" name=\"owner_set-2-auto_id\" id=\"id_owner_set-2-auto_id\" /></p>')\n \n         data = {\n@@ -791,7 +791,7 @@ def test_custom_pk(self):\n \n         FormSet = modelformset_factory(OwnerProfile)\n         formset = FormSet()\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_form-0-owner\">Owner:</label> <select name=\"form-0-owner\" id=\"id_form-0-owner\">\\n'\n             '<option value=\"\" selected=\"selected\">---------</option>\\n'\n             '<option value=\"%d\">Joe Perry at Giordanos</option>\\n'\n@@ -806,7 +806,7 @@ def test_custom_pk(self):\n \n         formset = FormSet(instance=owner1)\n         self.assertEqual(len(formset.forms), 1)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_ownerprofile-0-age\">Age:</label> <input type=\"text\" name=\"ownerprofile-0-age\" id=\"id_ownerprofile-0-age\" /><input type=\"hidden\" name=\"ownerprofile-0-owner\" value=\"%d\" id=\"id_ownerprofile-0-owner\" /></p>'\n             % owner1.auto_id)\n \n@@ -827,7 +827,7 @@ def test_custom_pk(self):\n \n         formset = FormSet(instance=owner1)\n         self.assertEqual(len(formset.forms), 1)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_ownerprofile-0-age\">Age:</label> <input type=\"text\" name=\"ownerprofile-0-age\" value=\"54\" id=\"id_ownerprofile-0-age\" /><input type=\"hidden\" name=\"ownerprofile-0-owner\" value=\"%d\" id=\"id_ownerprofile-0-owner\" /></p>'\n             % owner1.auto_id)\n \n@@ -856,7 +856,7 @@ def test_unique_true_enforces_max_num_one(self):\n \n         formset = FormSet(instance=place)\n         self.assertEqual(len(formset.forms), 1)\n-        self.assertEqual(formset.forms[0].as_p(),\n+        self.assertHTMLEqual(formset.forms[0].as_p(),\n             '<p><label for=\"id_location_set-0-lat\">Lat:</label> <input id=\"id_location_set-0-lat\" type=\"text\" name=\"location_set-0-lat\" maxlength=\"100\" /></p>\\n'\n             '<p><label for=\"id_location_set-0-lon\">Lon:</label> <input id=\"id_location_set-0-lon\" type=\"text\" name=\"location_set-0-lon\" maxlength=\"100\" /><input type=\"hidden\" name=\"location_set-0-place\" value=\"1\" id=\"id_location_set-0-place\" /><input type=\"hidden\" name=\"location_set-0-id\" id=\"id_location_set-0-id\" /></p>')\n \n@@ -982,7 +982,7 @@ def test_callable_defaults(self):\n         now = form.fields['date_joined'].initial()\n         result = form.as_p()\n         result = re.sub(r'\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?', '__DATETIME__', result)\n-        self.assertEqual(result,\n+        self.assertHTMLEqual(result,\n             '<p><label for=\"id_membership_set-0-date_joined\">Date joined:</label> <input type=\"text\" name=\"membership_set-0-date_joined\" value=\"__DATETIME__\" id=\"id_membership_set-0-date_joined\" /><input type=\"hidden\" name=\"initial-membership_set-0-date_joined\" value=\"__DATETIME__\" id=\"initial-membership_set-0-id_membership_set-0-date_joined\" /></p>\\n'\n             '<p><label for=\"id_membership_set-0-karma\">Karma:</label> <input type=\"text\" name=\"membership_set-0-karma\" id=\"id_membership_set-0-karma\" /><input type=\"hidden\" name=\"membership_set-0-person\" value=\"%d\" id=\"id_membership_set-0-person\" /><input type=\"hidden\" name=\"membership_set-0-id\" id=\"id_membership_set-0-id\" /></p>'\n             % person.id)"
        },
        {
            "sha": "e00a56d36487d9e08c7814c40543affb9f052b73",
            "filename": "tests/regressiontests/admin_inlines/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fadmin_inlines%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fadmin_inlines%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_inlines%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -34,7 +34,7 @@ def test_can_delete(self):\n         can_delete should be passed to inlineformset factory.\n         \"\"\"\n         response = self.client.get(self.change_url)\n-        inner_formset = response.context[-1]['inline_admin_formsets'][0].formset\n+        inner_formset = response.context['inline_admin_formsets'][0].formset\n         expected = InnerInline.can_delete\n         actual = inner_formset.can_delete\n         self.assertEqual(expected, actual, 'can_delete must be equal')\n@@ -134,7 +134,7 @@ def test_non_related_name_inline(self):\n                 'id=\"id_-1-0-capo_famiglia\" />')\n         self.assertContains(response,\n                 '<input id=\"id_-1-0-name\" type=\"text\" class=\"vTextField\" '\n-                'name=\"-1-0-name\" maxlength=\"100\" />')\n+                'name=\"-1-0-name\" maxlength=\"100\" />', html=True)\n \n         self.assertContains(response,\n                 '<input type=\"hidden\" name=\"-2-0-id\" id=\"id_-2-0-id\" />')\n@@ -143,7 +143,7 @@ def test_non_related_name_inline(self):\n                 'id=\"id_-2-0-capo_famiglia\" />')\n         self.assertContains(response,\n                 '<input id=\"id_-2-0-name\" type=\"text\" class=\"vTextField\" '\n-                'name=\"-2-0-name\" maxlength=\"100\" />')\n+                'name=\"-2-0-name\" maxlength=\"100\" />', html=True)\n \n class TestInlineMedia(TestCase):\n     urls = \"regressiontests.admin_inlines.urls\""
        },
        {
            "sha": "b0120cef1d4e0dbf12edc8ce7cccf9ad47fb84f6",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 25,
            "deletions": 26,
            "changes": 51,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -1696,7 +1696,7 @@ def test_non_field_errors(self):\n             \"_save\": \"Save\",\n         }\n         response = self.client.post('/test_admin/admin/admin_views/fooddelivery/', data)\n-        self.assertContains(response, '<tr><td colspan=\"4\"><ul class=\"errorlist\"><li>Food delivery with this Driver and Restaurant already exists.</li></ul></td></tr>', 1)\n+        self.assertContains(response, '<tr><td colspan=\"4\"><ul class=\"errorlist\"><li>Food delivery with this Driver and Restaurant already exists.</li></ul></td></tr>', 1, html=True)\n \n         data = {\n             \"form-TOTAL_FORMS\": \"3\",\n@@ -1723,7 +1723,7 @@ def test_non_field_errors(self):\n             \"_save\": \"Save\",\n         }\n         response = self.client.post('/test_admin/admin/admin_views/fooddelivery/', data)\n-        self.assertContains(response, '<tr><td colspan=\"4\"><ul class=\"errorlist\"><li>Food delivery with this Driver and Restaurant already exists.</li></ul></td></tr>', 2)\n+        self.assertContains(response, '<tr><td colspan=\"4\"><ul class=\"errorlist\"><li>Food delivery with this Driver and Restaurant already exists.</li></ul></td></tr>', 2, html=True)\n \n     def test_non_form_errors(self):\n         # test if non-form errors are handled; ticket #12716\n@@ -1880,7 +1880,7 @@ def test_pk_hidden_fields(self):\n         response = self.client.get('/test_admin/admin/admin_views/story/')\n         self.assertContains(response, 'id=\"id_form-0-id\"', 1) # Only one hidden field, in a separate place than the table.\n         self.assertContains(response, 'id=\"id_form-1-id\"', 1)\n-        self.assertContains(response, '<div class=\"hiddenfields\">\\n<input type=\"hidden\" name=\"form-0-id\" value=\"%d\" id=\"id_form-0-id\" /><input type=\"hidden\" name=\"form-1-id\" value=\"%d\" id=\"id_form-1-id\" />\\n</div>' % (story2.id, story1.id))\n+        self.assertContains(response, '<div class=\"hiddenfields\">\\n<input type=\"hidden\" name=\"form-0-id\" value=\"%d\" id=\"id_form-0-id\" /><input type=\"hidden\" name=\"form-1-id\" value=\"%d\" id=\"id_form-1-id\" />\\n</div>' % (story2.id, story1.id), html=True)\n         self.assertContains(response, '<td>%d</td>' % story1.id, 1)\n         self.assertContains(response, '<td>%d</td>' % story2.id, 1)\n \n@@ -1894,7 +1894,7 @@ def test_pk_hidden_fields_with_list_display_links(self):\n         response = self.client.get('/test_admin/admin/admin_views/otherstory/')\n         self.assertContains(response, 'id=\"id_form-0-id\"', 1) # Only one hidden field, in a separate place than the table.\n         self.assertContains(response, 'id=\"id_form-1-id\"', 1)\n-        self.assertContains(response, '<div class=\"hiddenfields\">\\n<input type=\"hidden\" name=\"form-0-id\" value=\"%d\" id=\"id_form-0-id\" /><input type=\"hidden\" name=\"form-1-id\" value=\"%d\" id=\"id_form-1-id\" />\\n</div>' % (story2.id, story1.id))\n+        self.assertContains(response, '<div class=\"hiddenfields\">\\n<input type=\"hidden\" name=\"form-0-id\" value=\"%d\" id=\"id_form-0-id\" /><input type=\"hidden\" name=\"form-1-id\" value=\"%d\" id=\"id_form-1-id\" />\\n</div>' % (story2.id, story1.id), html=True)\n         self.assertContains(response, '<th><a href=\"%d/\">%d</a></th>' % (story1.id, story1.id), 1)\n         self.assertContains(response, '<th><a href=\"%d/\">%d</a></th>' % (story2.id, story2.id), 1)\n \n@@ -1923,7 +1923,7 @@ def test_with_fk_to_field(self):\n         from django.contrib.admin.views.main import TO_FIELD_VAR\n         response = self.client.get('/test_admin/admin/auth/user/?q=joe&%s=username' % TO_FIELD_VAR)\n         self.assertContains(response, \"\\n1 user\\n\")\n-        self.assertContains(response, '<input type=\"hidden\" name=\"t\" value=\"username\"/>')\n+        self.assertContains(response, '<input type=\"hidden\" name=\"t\" value=\"username\"/>', html=True)\n \n     def test_exact_matches(self):\n         response = self.client.get('/test_admin/admin/admin_views/recommendation/?q=bar')\n@@ -2114,8 +2114,8 @@ def test_model_admin_default_delete_action_protected(self):\n         response = self.client.post(\"/test_admin/admin/admin_views/question/\", action_data)\n \n         self.assertContains(response, \"would require deleting the following protected related objects\")\n-        self.assertContains(response, '<li>Answer: <a href=\"/test_admin/admin/admin_views/answer/%s/\">Because.</a></li>' % a1.pk)\n-        self.assertContains(response, '<li>Answer: <a href=\"/test_admin/admin/admin_views/answer/%s/\">Yes.</a></li>' % a2.pk)\n+        self.assertContains(response, '<li>Answer: <a href=\"/test_admin/admin/admin_views/answer/%s/\">Because.</a></li>' % a1.pk, html=True)\n+        self.assertContains(response, '<li>Answer: <a href=\"/test_admin/admin/admin_views/answer/%s/\">Yes.</a></li>' % a2.pk, html=True)\n \n     def test_custom_function_mail_action(self):\n         \"Tests a custom action defined in a function\"\n@@ -2159,13 +2159,12 @@ def test_actions_ordering(self):\n         Refs #15964.\n         \"\"\"\n         response = self.client.get('/test_admin/admin/admin_views/externalsubscriber/')\n-        self.assertTrue('''<label>Action: <select name=\"action\">\n+        self.assertContains(response, '''<label>Action: <select name=\"action\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"delete_selected\">Delete selected external subscribers</option>\n <option value=\"redirect_to\">Redirect to (Awesome action)</option>\n <option value=\"external_mail\">External mail (Another awesome action)</option>\n-</select>'''in response.content,\n-        )\n+</select>''', html=True)\n \n     def test_model_without_action(self):\n         \"Tests a ModelAdmin without any action\"\n@@ -2338,7 +2337,7 @@ def test_add_model_modeladmin_only_qs(self):\n                 post_data, follow=True)\n         self.assertEqual(response.status_code, 200)\n         # Message should contain non-ugly model name. Instance representation is set by unicode() (ugly)\n-        self.assertContains(response, '<li class=\"info\">The paper &quot;Paper_Deferred_author object&quot; was changed successfully.</li>')\n+        self.assertContains(response, '<li class=\"info\">The paper &quot;Paper_Deferred_author object&quot; was changed successfully.</li>', html=True)\n \n         # defer() is used in ModelAdmin.queryset()\n         cl = CoverLetter.objects.create(author=u\"John Doe\")\n@@ -2353,7 +2352,7 @@ def test_add_model_modeladmin_only_qs(self):\n                 post_data, follow=True)\n         self.assertEqual(response.status_code, 200)\n         # Message should contain non-ugly model name. Instance representation is set by model's __unicode__()\n-        self.assertContains(response, '<li class=\"info\">The cover letter &quot;John Doe II&quot; was changed successfully.</li>')\n+        self.assertContains(response, '<li class=\"info\">The cover letter &quot;John Doe II&quot; was changed successfully.</li>', html=True)\n \n class AdminInlineFileUploadTest(TestCase):\n     urls = \"regressiontests.admin_views.urls\"\n@@ -2859,9 +2858,9 @@ def test_readonly_get(self):\n         self.assertContains(response, '<div class=\"form-row field-value\">')\n         self.assertContains(response, '<div class=\"form-row\">')\n         self.assertContains(response, '<p class=\"help\">', 3)\n-        self.assertContains(response, '<p class=\"help\">Some help text for the title (with unicode Å ÄÄÅ½ÄÅ¾Å¡Ä)</p>')\n-        self.assertContains(response, '<p class=\"help\">Some help text for the content (with unicode Å ÄÄÅ½ÄÅ¾Å¡Ä)</p>')\n-        self.assertContains(response, '<p class=\"help\">Some help text for the date (with unicode Å ÄÄÅ½ÄÅ¾Å¡Ä)</p>')\n+        self.assertContains(response, '<p class=\"help\">Some help text for the title (with unicode Å ÄÄÅ½ÄÅ¾Å¡Ä)</p>', html=True)\n+        self.assertContains(response, '<p class=\"help\">Some help text for the content (with unicode Å ÄÄÅ½ÄÅ¾Å¡Ä)</p>', html=True)\n+        self.assertContains(response, '<p class=\"help\">Some help text for the date (with unicode Å ÄÄÅ½ÄÅ¾Å¡Ä)</p>', html=True)\n \n         p = Post.objects.create(title=\"I worked on readonly_fields\", content=\"Its good stuff\")\n         response = self.client.get('/test_admin/admin/admin_views/post/%d/' % p.pk)\n@@ -3099,32 +3098,32 @@ def test_tags(self):\n         response = self.client.get('/test_admin/admin/doc/tags/')\n \n         # The builtin tag group exists\n-        self.assertContains(response, \"<h2>Built-in tags</h2>\", count=2)\n+        self.assertContains(response, \"<h2>Built-in tags</h2>\", count=2, html=True)\n \n         # A builtin tag exists in both the index and detail\n-        self.assertContains(response, '<h3 id=\"built_in-autoescape\">autoescape</h3>')\n-        self.assertContains(response, '<li><a href=\"#built_in-autoescape\">autoescape</a></li>')\n+        self.assertContains(response, '<h3 id=\"built_in-autoescape\">autoescape</h3>', html=True)\n+        self.assertContains(response, '<li><a href=\"#built_in-autoescape\">autoescape</a></li>', html=True)\n \n         # An app tag exists in both the index and detail\n-        self.assertContains(response, '<h3 id=\"flatpages-get_flatpages\">get_flatpages</h3>')\n-        self.assertContains(response, '<li><a href=\"#flatpages-get_flatpages\">get_flatpages</a></li>')\n+        self.assertContains(response, '<h3 id=\"flatpages-get_flatpages\">get_flatpages</h3>', html=True)\n+        self.assertContains(response, '<li><a href=\"#flatpages-get_flatpages\">get_flatpages</a></li>', html=True)\n \n         # The admin list tag group exists\n-        self.assertContains(response, \"<h2>admin_list</h2>\", count=2)\n+        self.assertContains(response, \"<h2>admin_list</h2>\", count=2, html=True)\n \n         # An admin list tag exists in both the index and detail\n-        self.assertContains(response, '<h3 id=\"admin_list-admin_actions\">admin_actions</h3>')\n-        self.assertContains(response, '<li><a href=\"#admin_list-admin_actions\">admin_actions</a></li>')\n+        self.assertContains(response, '<h3 id=\"admin_list-admin_actions\">admin_actions</h3>', html=True)\n+        self.assertContains(response, '<li><a href=\"#admin_list-admin_actions\">admin_actions</a></li>', html=True)\n \n     def test_filters(self):\n         response = self.client.get('/test_admin/admin/doc/filters/')\n \n         # The builtin filter group exists\n-        self.assertContains(response, \"<h2>Built-in filters</h2>\", count=2)\n+        self.assertContains(response, \"<h2>Built-in filters</h2>\", count=2, html=True)\n \n         # A builtin filter exists in both the index and detail\n-        self.assertContains(response, '<h3 id=\"built_in-add\">add</h3>')\n-        self.assertContains(response, '<li><a href=\"#built_in-add\">add</a></li>')\n+        self.assertContains(response, '<h3 id=\"built_in-add\">add</h3>', html=True)\n+        self.assertContains(response, '<li><a href=\"#built_in-add\">add</a></li>', html=True)\n \n AdminDocsTest = unittest.skipUnless(docutils, \"no docutils installed.\")(AdminDocsTest)\n "
        },
        {
            "sha": "b678bb7e122e2bcbb7259f92deed31d032d40b44",
            "filename": "tests/regressiontests/admin_widgets/tests.py",
            "status": "modified",
            "additions": 19,
            "deletions": 19,
            "changes": 38,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_widgets%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -194,14 +194,14 @@ def test_url_params_from_lookup_dict_any_iterable(self):\n class FilteredSelectMultipleWidgetTest(DjangoTestCase):\n     def test_render(self):\n         w = widgets.FilteredSelectMultiple('test', False)\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', 'test')),\n             '<select multiple=\"multiple\" name=\"test\" class=\"selectfilter\">\\n</select><script type=\"text/javascript\">addEvent(window, \"load\", function(e) {SelectFilter.init(\"id_test\", \"test\", 0, \"%(ADMIN_MEDIA_PREFIX)s\"); });</script>\\n' % admin_media_prefix()\n         )\n \n     def test_stacked_render(self):\n         w = widgets.FilteredSelectMultiple('test', True)\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', 'test')),\n             '<select multiple=\"multiple\" name=\"test\" class=\"selectfilterstacked\">\\n</select><script type=\"text/javascript\">addEvent(window, \"load\", function(e) {SelectFilter.init(\"id_test\", \"test\", 1, \"%(ADMIN_MEDIA_PREFIX)s\"); });</script>\\n' % admin_media_prefix()\n         )\n@@ -213,13 +213,13 @@ def test_attrs(self):\n         Refs #12073.\n         \"\"\"\n         w = widgets.AdminDateWidget()\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n             '<input value=\"2007-12-01\" type=\"text\" class=\"vDateField\" name=\"test\" size=\"10\" />',\n         )\n         # pass attrs to widget\n         w = widgets.AdminDateWidget(attrs={'size': 20, 'class': 'myDateField'})\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n             '<input value=\"2007-12-01\" type=\"text\" class=\"myDateField\" name=\"test\" size=\"20\" />',\n         )\n@@ -231,21 +231,21 @@ def test_attrs(self):\n         Refs #12073.\n         \"\"\"\n         w = widgets.AdminTimeWidget()\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n             '<input value=\"09:30:00\" type=\"text\" class=\"vTimeField\" name=\"test\" size=\"8\" />',\n         )\n         # pass attrs to widget\n         w = widgets.AdminTimeWidget(attrs={'size': 20, 'class': 'myTimeField'})\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n             '<input value=\"09:30:00\" type=\"text\" class=\"myTimeField\" name=\"test\" size=\"20\" />',\n         )\n \n class AdminSplitDateTimeWidgetTest(DjangoTestCase):\n     def test_render(self):\n         w = widgets.AdminSplitDateTime()\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n             '<p class=\"datetime\">Date: <input value=\"2007-12-01\" type=\"text\" class=\"vDateField\" name=\"test_0\" size=\"10\" /><br />Time: <input value=\"09:30:00\" type=\"text\" class=\"vTimeField\" name=\"test_1\" size=\"8\" /></p>',\n         )\n@@ -256,7 +256,7 @@ def test_localization(self):\n         with self.settings(USE_L10N=True):\n             with translation.override('de-at'):\n                 w.is_localized = True\n-                self.assertEqual(\n+                self.assertHTMLEqual(\n                     conditional_escape(w.render('test', datetime(2007, 12, 1, 9, 30))),\n                     '<p class=\"datetime\">Datum: <input value=\"01.12.2007\" type=\"text\" class=\"vDateField\" name=\"test_0\" size=\"10\" /><br />Zeit: <input value=\"09:30:00\" type=\"text\" class=\"vTimeField\" name=\"test_1\" size=\"8\" /></p>',\n                 )\n@@ -270,12 +270,12 @@ def test_render(self):\n         )\n \n         w = widgets.AdminFileWidget()\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', album.cover_art)),\n             '<p class=\"file-upload\">Currently: <a href=\"%(STORAGE_URL)salbums/hybrid_theory.jpg\">albums\\hybrid_theory.jpg</a> <span class=\"clearable-file-input\"><input type=\"checkbox\" name=\"test-clear\" id=\"test-clear_id\" /> <label for=\"test-clear_id\">Clear</label></span><br />Change: <input type=\"file\" name=\"test\" /></p>' % { 'STORAGE_URL': default_storage.url('') },\n         )\n \n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', SimpleUploadedFile('test', 'content'))),\n             '<input type=\"file\" name=\"test\" />',\n         )\n@@ -290,7 +290,7 @@ def test_render(self):\n         rel = models.Album._meta.get_field('band').rel\n \n         w = widgets.ForeignKeyRawIdWidget(rel, widget_admin_site)\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', band.pk, attrs={})),\n             '<input type=\"text\" name=\"test\" value=\"%(bandpk)s\" class=\"vForeignKeyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/band/?t=id\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_MEDIA_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>&nbsp;<strong>Linkin Park</strong>' % dict(admin_media_prefix(), bandpk=band.pk)\n         )\n@@ -305,7 +305,7 @@ def test_relations_to_non_primary_key(self):\n         )\n         rel = models.Inventory._meta.get_field('parent').rel\n         w = widgets.ForeignKeyRawIdWidget(rel, widget_admin_site)\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             w.render('test', core.parent_id, attrs={}),\n             '<input type=\"text\" name=\"test\" value=\"86\" class=\"vForeignKeyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/inventory/?t=barcode\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_MEDIA_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>&nbsp;<strong>Apple</strong>' % admin_media_prefix()\n         )\n@@ -318,7 +318,7 @@ def test_fk_related_model_not_in_admin(self):\n         rel = models.Bee._meta.get_field('honeycomb').rel\n \n         w = widgets.ForeignKeyRawIdWidget(rel, widget_admin_site)\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('honeycomb_widget', big_honeycomb.pk, attrs={})),\n             '<input type=\"text\" name=\"honeycomb_widget\" value=\"%(hcombpk)s\" />&nbsp;<strong>Honeycomb object</strong>' % {'hcombpk': big_honeycomb.pk}\n         )\n@@ -331,7 +331,7 @@ def test_fk_to_self_model_not_in_admin(self):\n         rel = models.Individual._meta.get_field('parent').rel\n \n         w = widgets.ForeignKeyRawIdWidget(rel, widget_admin_site)\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('individual_widget', subject1.pk, attrs={})),\n             '<input type=\"text\" name=\"individual_widget\" value=\"%(subj1pk)s\" />&nbsp;<strong>Individual object</strong>' % {'subj1pk': subject1.pk}\n         )\n@@ -347,7 +347,7 @@ def test_proper_manager_for_label_lookup(self):\n         child_of_hidden = models.Inventory.objects.create(\n             barcode=94, name='Child of hidden', parent=hidden\n         )\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             w.render('test', child_of_hidden.parent_id, attrs={}),\n             '<input type=\"text\" name=\"test\" value=\"93\" class=\"vForeignKeyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/inventory/?t=barcode\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_MEDIA_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>&nbsp;<strong>Hidden</strong>' % admin_media_prefix()\n         )\n@@ -363,12 +363,12 @@ def test_render(self):\n         rel = models.Band._meta.get_field('members').rel\n \n         w = widgets.ManyToManyRawIdWidget(rel, widget_admin_site)\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', [m1.pk, m2.pk], attrs={})),\n             '<input type=\"text\" name=\"test\" value=\"%(m1pk)s,%(m2pk)s\" class=\"vManyToManyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/member/\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"/static/admin/img/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>' % dict(admin_media_prefix(), m1pk=m1.pk, m2pk=m2.pk)\n         )\n \n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('test', [m1.pk])),\n             '<input type=\"text\" name=\"test\" value=\"%(m1pk)s\" class=\"vManyToManyRawIdAdminField\" /><a href=\"/widget_admin/admin_widgets/member/\" class=\"related-lookup\" id=\"lookup_id_test\" onclick=\"return showRelatedObjectLookupPopup(this);\"> <img src=\"%(ADMIN_MEDIA_PREFIX)simg/selector-search.gif\" width=\"16\" height=\"16\" alt=\"Lookup\" /></a>' % dict(admin_media_prefix(), m1pk=m1.pk)\n         )\n@@ -391,12 +391,12 @@ def test_m2m_related_model_not_in_admin(self):\n         rel = models.Advisor._meta.get_field('companies').rel\n \n         w = widgets.ManyToManyRawIdWidget(rel, widget_admin_site)\n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('company_widget1', [c1.pk, c2.pk], attrs={})),\n             '<input type=\"text\" name=\"company_widget1\" value=\"%(c1pk)s,%(c2pk)s\" />' % {'c1pk': c1.pk, 'c2pk': c2.pk}\n         )\n \n-        self.assertEqual(\n+        self.assertHTMLEqual(\n             conditional_escape(w.render('company_widget2', [c1.pk])),\n             '<input type=\"text\" name=\"company_widget2\" value=\"%(c1pk)s\" />' % {'c1pk': c1.pk}\n         )"
        },
        {
            "sha": "b7b4e986b30ff90e6ae82dafb6b2ca7a16cd3086",
            "filename": "tests/regressiontests/forms/tests/error_messages.py",
            "status": "modified",
            "additions": 5,
            "deletions": 6,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Ferror_messages.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Ferror_messages.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Ferror_messages.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -5,7 +5,6 @@\n from django.core.files.uploadedfile import SimpleUploadedFile\n from django.forms import *\n from django.test import TestCase\n-from django.utils import unittest\n from django.utils.safestring import mark_safe\n \n from .fields import verify_exists_urls\n@@ -19,7 +18,7 @@ def assertFormErrors(self, expected, the_callable, *args, **kwargs):\n         except ValidationError, e:\n             self.assertEqual(e.messages, expected)\n \n-class FormsErrorMessagesTestCase(unittest.TestCase, AssertFormErrorsMixin):\n+class FormsErrorMessagesTestCase(TestCase, AssertFormErrorsMixin):\n     def test_charfield(self):\n         e = {\n             'required': 'REQUIRED',\n@@ -230,13 +229,13 @@ def as_divs(self):\n \n         # This form should print errors the default way.\n         form1 = TestForm({'first_name': 'John'})\n-        self.assertEqual(str(form1['last_name'].errors), '<ul class=\"errorlist\"><li>This field is required.</li></ul>')\n-        self.assertEqual(str(form1.errors['__all__']), '<ul class=\"errorlist\"><li>I like to be awkward.</li></ul>')\n+        self.assertHTMLEqual(str(form1['last_name'].errors), '<ul class=\"errorlist\"><li>This field is required.</li></ul>')\n+        self.assertHTMLEqual(str(form1.errors['__all__']), '<ul class=\"errorlist\"><li>I like to be awkward.</li></ul>')\n \n         # This one should wrap error groups in the customized way.\n         form2 = TestForm({'first_name': 'John'}, error_class=CustomErrorList)\n-        self.assertEqual(str(form2['last_name'].errors), '<div class=\"error\"><p>This field is required.</p></div>')\n-        self.assertEqual(str(form2.errors['__all__']), '<div class=\"error\"><p>I like to be awkward.</p></div>')\n+        self.assertHTMLEqual(str(form2['last_name'].errors), '<div class=\"error\"><p>This field is required.</p></div>')\n+        self.assertHTMLEqual(str(form2.errors['__all__']), '<div class=\"error\"><p>I like to be awkward.</p></div>')\n \n \n class ModelChoiceFieldErrorMessagesTestCase(TestCase, AssertFormErrorsMixin):"
        },
        {
            "sha": "3c5dfabb615ca05096140b53f6bd42351db1e5bd",
            "filename": "tests/regressiontests/forms/tests/extra.py",
            "status": "modified",
            "additions": 19,
            "deletions": 16,
            "changes": 35,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fextra.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fextra.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fextra.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -8,7 +8,8 @@\n from django.forms import *\n from django.forms.extras import SelectDateWidget\n from django.forms.util import ErrorList\n-from django.utils import translation, unittest\n+from django.test import TestCase\n+from django.utils import translation\n from django.utils.encoding import force_unicode, smart_unicode\n \n from .error_messages import AssertFormErrorsMixin\n@@ -20,15 +21,15 @@ class GetDate(Form):\n class GetDateShowHiddenInitial(Form):\n     mydate = DateField(widget=SelectDateWidget, show_hidden_initial=True)\n \n-class FormsExtraTestCase(unittest.TestCase, AssertFormErrorsMixin):\n+class FormsExtraTestCase(TestCase, AssertFormErrorsMixin):\n     ###############\n     # Extra stuff #\n     ###############\n \n     # The forms library comes with some extra, higher-level Field and Widget\n     def test_selectdate(self):\n         w = SelectDateWidget(years=('2007','2008','2009','2010','2011','2012','2013','2014','2015','2016'))\n-        self.assertEqual(w.render('mydate', ''), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n+        self.assertHTMLEqual(w.render('mydate', ''), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n <option value=\"0\">---</option>\n <option value=\"1\">January</option>\n <option value=\"2\">February</option>\n@@ -43,6 +44,7 @@ def test_selectdate(self):\n <option value=\"11\">November</option>\n <option value=\"12\">December</option>\n </select>\n+\n <select name=\"mydate_day\" id=\"id_mydate_day\">\n <option value=\"0\">---</option>\n <option value=\"1\">1</option>\n@@ -77,6 +79,7 @@ def test_selectdate(self):\n <option value=\"30\">30</option>\n <option value=\"31\">31</option>\n </select>\n+\n <select name=\"mydate_year\" id=\"id_mydate_year\">\n <option value=\"0\">---</option>\n <option value=\"2007\">2007</option>\n@@ -90,9 +93,9 @@ def test_selectdate(self):\n <option value=\"2015\">2015</option>\n <option value=\"2016\">2016</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('mydate', None), w.render('mydate', ''))\n+        self.assertHTMLEqual(w.render('mydate', None), w.render('mydate', ''))\n \n-        self.assertEqual(w.render('mydate', '2010-04-15'), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n+        self.assertHTMLEqual(w.render('mydate', '2010-04-15'), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n <option value=\"1\">January</option>\n <option value=\"2\">February</option>\n <option value=\"3\">March</option>\n@@ -153,10 +156,10 @@ def test_selectdate(self):\n </select>\"\"\")\n \n         # Accepts a datetime or a string:\n-        self.assertEqual(w.render('mydate', datetime.date(2010, 4, 15)), w.render('mydate', '2010-04-15'))\n+        self.assertHTMLEqual(w.render('mydate', datetime.date(2010, 4, 15)), w.render('mydate', '2010-04-15'))\n \n         # Invalid dates still render the failed date:\n-        self.assertEqual(w.render('mydate', '2010-02-31'), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n+        self.assertHTMLEqual(w.render('mydate', '2010-02-31'), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n <option value=\"1\">January</option>\n <option value=\"2\" selected=\"selected\">February</option>\n <option value=\"3\">March</option>\n@@ -218,7 +221,7 @@ def test_selectdate(self):\n \n         # Using a SelectDateWidget in a form:\n         w = SelectDateWidget(years=('2007','2008','2009','2010','2011','2012','2013','2014','2015','2016'), required=False)\n-        self.assertEqual(w.render('mydate', ''), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n+        self.assertHTMLEqual(w.render('mydate', ''), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n <option value=\"0\">---</option>\n <option value=\"1\">January</option>\n <option value=\"2\">February</option>\n@@ -280,7 +283,7 @@ def test_selectdate(self):\n <option value=\"2015\">2015</option>\n <option value=\"2016\">2016</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('mydate', '2010-04-15'), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n+        self.assertHTMLEqual(w.render('mydate', '2010-04-15'), \"\"\"<select name=\"mydate_month\" id=\"id_mydate_month\">\n <option value=\"0\">---</option>\n <option value=\"1\">January</option>\n <option value=\"2\">February</option>\n@@ -351,7 +354,7 @@ def test_selectdate(self):\n         # we must be prepared to accept the input from the \"as_hidden\"\n         # rendering as well.\n \n-        self.assertEqual(a['mydate'].as_hidden(), '<input type=\"hidden\" name=\"mydate\" value=\"2008-4-1\" id=\"id_mydate\" />')\n+        self.assertHTMLEqual(a['mydate'].as_hidden(), '<input type=\"hidden\" name=\"mydate\" value=\"2008-4-1\" id=\"id_mydate\" />')\n \n         b = GetDate({'mydate':'2008-4-1'})\n         self.assertTrue(b.is_valid())\n@@ -392,7 +395,7 @@ def format_output(self, rendered_widgets):\n                 return u'\\n'.join(rendered_widgets)\n \n         w = ComplexMultiWidget()\n-        self.assertEqual(w.render('name', 'some text,JP,2007-04-25 06:24:00'), \"\"\"<input type=\"text\" name=\"name_0\" value=\"some text\" />\n+        self.assertHTMLEqual(w.render('name', 'some text,JP,2007-04-25 06:24:00'), \"\"\"<input type=\"text\" name=\"name_0\" value=\"some text\" />\n <select multiple=\"multiple\" name=\"name_1\">\n <option value=\"J\" selected=\"selected\">John</option>\n <option value=\"P\" selected=\"selected\">Paul</option>\n@@ -426,7 +429,7 @@ class ComplexFieldForm(Form):\n             field1 = ComplexField(widget=w)\n \n         f = ComplexFieldForm()\n-        self.assertEqual(f.as_table(), \"\"\"<tr><th><label for=\"id_field1_0\">Field1:</label></th><td><input type=\"text\" name=\"field1_0\" id=\"id_field1_0\" />\n+        self.assertHTMLEqual(f.as_table(), \"\"\"<tr><th><label for=\"id_field1_0\">Field1:</label></th><td><input type=\"text\" name=\"field1_0\" id=\"id_field1_0\" />\n <select multiple=\"multiple\" name=\"field1_1\" id=\"id_field1_1\">\n <option value=\"J\">John</option>\n <option value=\"P\">Paul</option>\n@@ -436,7 +439,7 @@ class ComplexFieldForm(Form):\n <input type=\"text\" name=\"field1_2_0\" id=\"id_field1_2_0\" /><input type=\"text\" name=\"field1_2_1\" id=\"id_field1_2_1\" /></td></tr>\"\"\")\n \n         f = ComplexFieldForm({'field1_0':'some text','field1_1':['J','P'], 'field1_2_0':'2007-04-25', 'field1_2_1':'06:24:00'})\n-        self.assertEqual(f.as_table(), \"\"\"<tr><th><label for=\"id_field1_0\">Field1:</label></th><td><input type=\"text\" name=\"field1_0\" value=\"some text\" id=\"id_field1_0\" />\n+        self.assertHTMLEqual(f.as_table(), \"\"\"<tr><th><label for=\"id_field1_0\">Field1:</label></th><td><input type=\"text\" name=\"field1_0\" value=\"some text\" id=\"id_field1_0\" />\n <select multiple=\"multiple\" name=\"field1_1\" id=\"id_field1_1\">\n <option value=\"J\" selected=\"selected\">John</option>\n <option value=\"P\" selected=\"selected\">Paul</option>\n@@ -595,7 +598,7 @@ class CommentForm(Form):\n \n         data = dict(email='invalid')\n         f = CommentForm(data, auto_id=False, error_class=DivErrorList)\n-        self.assertEqual(f.as_p(), \"\"\"<p>Name: <input type=\"text\" name=\"name\" maxlength=\"50\" /></p>\n+        self.assertHTMLEqual(f.as_p(), \"\"\"<p>Name: <input type=\"text\" name=\"name\" maxlength=\"50\" /></p>\n <div class=\"errorlist\"><div class=\"error\">Enter a valid e-mail address.</div></div>\n <p>Email: <input type=\"text\" name=\"email\" value=\"invalid\" /></p>\n <div class=\"errorlist\"><div class=\"error\">This field is required.</div></div>\n@@ -617,7 +620,7 @@ class FormWithImage(Form):\n         self.assertTrue(FormWithImage().is_multipart())\n \n \n-class FormsExtraL10NTestCase(unittest.TestCase):\n+class FormsExtraL10NTestCase(TestCase):\n     def setUp(self):\n         super(FormsExtraL10NTestCase, self).setUp()\n         self.old_use_l10n = getattr(settings, 'USE_L10N', False)\n@@ -633,7 +636,7 @@ def test_l10n(self):\n         w = SelectDateWidget(years=('2007','2008','2009','2010','2011','2012','2013','2014','2015','2016'), required=False)\n         self.assertEqual(w.value_from_datadict({'date_year': '2010', 'date_month': '8', 'date_day': '13'}, {}, 'date'), '13-08-2010')\n \n-        self.assertEqual(w.render('date', '13-08-2010'), \"\"\"<select name=\"date_day\" id=\"id_date_day\">\n+        self.assertHTMLEqual(w.render('date', '13-08-2010'), \"\"\"<select name=\"date_day\" id=\"id_date_day\">\n <option value=\"0\">---</option>\n <option value=\"1\">1</option>\n <option value=\"2\">2</option>"
        },
        {
            "sha": "03e0ff65a36af28753f1c85dc34c76c977667d12",
            "filename": "tests/regressiontests/forms/tests/fields.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -674,6 +674,7 @@ def test_urlfield_4(self):\n         self.assertEqual(u'', f.clean(''))\n         self.assertEqual(u'http://www.google.com/', f.clean('http://www.google.com'))\n \n+    @verify_exists_urls(('http://example.com/',))\n     def test_urlfield_5(self):\n         f = URLField(min_length=15, max_length=20)\n         self.assertRaisesMessage(ValidationError, \"[u'Ensure this value has at least 15 characters (it has 13).']\", f.clean, 'http://f.com')\n@@ -852,7 +853,7 @@ class HiddenNullBooleanForm(Form):\n             hidden_nullbool1 = NullBooleanField(widget=HiddenInput, initial=True)\n             hidden_nullbool2 = NullBooleanField(widget=HiddenInput, initial=False)\n         f = HiddenNullBooleanForm()\n-        self.assertEqual('<input type=\"hidden\" name=\"hidden_nullbool1\" value=\"True\" id=\"id_hidden_nullbool1\" /><input type=\"hidden\" name=\"hidden_nullbool2\" value=\"False\" id=\"id_hidden_nullbool2\" />', str(f))\n+        self.assertHTMLEqual('<input type=\"hidden\" name=\"hidden_nullbool1\" value=\"True\" id=\"id_hidden_nullbool1\" /><input type=\"hidden\" name=\"hidden_nullbool2\" value=\"False\" id=\"id_hidden_nullbool2\" />', str(f))\n \n     def test_nullbooleanfield_3(self):\n         class HiddenNullBooleanForm(Form):"
        },
        {
            "sha": "6425a007d17d4fd33ccd92a09412ca8bbb2681e8",
            "filename": "tests/regressiontests/forms/tests/forms.py",
            "status": "modified",
            "additions": 180,
            "deletions": 177,
            "changes": 357,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fforms.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -5,9 +5,9 @@\n from django.forms import *\n from django.http import QueryDict\n from django.template import Template, Context\n+from django.test import TestCase\n from django.utils.datastructures import MultiValueDict, MergeDict\n from django.utils.safestring import mark_safe\n-from django.utils.unittest import TestCase\n \n \n class Person(Form):\n@@ -34,14 +34,14 @@ def test_form(self):\n         self.assertTrue(p.is_bound)\n         self.assertEqual(p.errors, {})\n         self.assertTrue(p.is_valid())\n-        self.assertEqual(p.errors.as_ul(), u'')\n+        self.assertHTMLEqual(p.errors.as_ul(), u'')\n         self.assertEqual(p.errors.as_text(), u'')\n         self.assertEqual(p.cleaned_data[\"first_name\"], u'John')\n         self.assertEqual(p.cleaned_data[\"last_name\"], u'Lennon')\n         self.assertEqual(p.cleaned_data[\"birthday\"], datetime.date(1940, 10, 9))\n-        self.assertEqual(str(p['first_name']), '<input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" />')\n-        self.assertEqual(str(p['last_name']), '<input type=\"text\" name=\"last_name\" value=\"Lennon\" id=\"id_last_name\" />')\n-        self.assertEqual(str(p['birthday']), '<input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" />')\n+        self.assertHTMLEqual(str(p['first_name']), '<input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" />')\n+        self.assertHTMLEqual(str(p['last_name']), '<input type=\"text\" name=\"last_name\" value=\"Lennon\" id=\"id_last_name\" />')\n+        self.assertHTMLEqual(str(p['birthday']), '<input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" />')\n         try:\n             p['nonexistentfield']\n             self.fail('Attempts to access non-existent fields should fail.')\n@@ -53,7 +53,7 @@ def test_form(self):\n         for boundfield in p:\n             form_output.append(str(boundfield))\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" />\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" />\n <input type=\"text\" name=\"last_name\" value=\"Lennon\" id=\"id_last_name\" />\n <input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" />\"\"\")\n \n@@ -67,7 +67,7 @@ def test_form(self):\n             ['Last name', u'Lennon'],\n             ['Birthday', u'1940-10-9']\n         ])\n-        self.assertEqual(str(p), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" /></td></tr>\n+        self.assertHTMLEqual(str(p), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" /></td></tr>\n <tr><th><label for=\"id_last_name\">Last name:</label></th><td><input type=\"text\" name=\"last_name\" value=\"Lennon\" id=\"id_last_name\" /></td></tr>\n <tr><th><label for=\"id_birthday\">Birthday:</label></th><td><input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" /></td></tr>\"\"\")\n \n@@ -84,16 +84,16 @@ def test_empty_dict(self):\n             self.fail('Attempts to access cleaned_data when validation fails should fail.')\n         except AttributeError:\n             pass\n-        self.assertEqual(str(p), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n+        self.assertHTMLEqual(str(p), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n <tr><th><label for=\"id_last_name\">Last name:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></td></tr>\n <tr><th><label for=\"id_birthday\">Birthday:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"birthday\" id=\"id_birthday\" /></td></tr>\"\"\")\n-        self.assertEqual(p.as_table(), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n <tr><th><label for=\"id_last_name\">Last name:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></td></tr>\n <tr><th><label for=\"id_birthday\">Birthday:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"birthday\" id=\"id_birthday\" /></td></tr>\"\"\")\n-        self.assertEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul><label for=\"id_birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" id=\"id_birthday\" /></li>\"\"\")\n-        self.assertEqual(p.as_p(), \"\"\"<ul class=\"errorlist\"><li>This field is required.</li></ul>\n+        self.assertHTMLEqual(p.as_p(), \"\"\"<ul class=\"errorlist\"><li>This field is required.</li></ul>\n <p><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></p>\n <ul class=\"errorlist\"><li>This field is required.</li></ul>\n <p><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></p>\n@@ -113,31 +113,31 @@ def test_unbound_form(self):\n             self.fail('Attempts to access cleaned_data when validation fails should fail.')\n         except AttributeError:\n             pass\n-        self.assertEqual(str(p), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n+        self.assertHTMLEqual(str(p), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n <tr><th><label for=\"id_last_name\">Last name:</label></th><td><input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></td></tr>\n <tr><th><label for=\"id_birthday\">Birthday:</label></th><td><input type=\"text\" name=\"birthday\" id=\"id_birthday\" /></td></tr>\"\"\")\n-        self.assertEqual(p.as_table(), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n <tr><th><label for=\"id_last_name\">Last name:</label></th><td><input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></td></tr>\n <tr><th><label for=\"id_birthday\">Birthday:</label></th><td><input type=\"text\" name=\"birthday\" id=\"id_birthday\" /></td></tr>\"\"\")\n-        self.assertEqual(p.as_ul(), \"\"\"<li><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></li>\n <li><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></li>\n <li><label for=\"id_birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" id=\"id_birthday\" /></li>\"\"\")\n-        self.assertEqual(p.as_p(), \"\"\"<p><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></p>\n+        self.assertHTMLEqual(p.as_p(), \"\"\"<p><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></p>\n <p><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></p>\n <p><label for=\"id_birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" id=\"id_birthday\" /></p>\"\"\")\n \n     def test_unicode_values(self):\n         # Unicode values are handled properly.\n         p = Person({'first_name': u'John', 'last_name': u'\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111', 'birthday': '1940-10-9'})\n-        self.assertEqual(p.as_table(), u'<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" /></td></tr>\\n<tr><th><label for=\"id_last_name\">Last name:</label></th><td><input type=\"text\" name=\"last_name\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" id=\"id_last_name\" /></td></tr>\\n<tr><th><label for=\"id_birthday\">Birthday:</label></th><td><input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" /></td></tr>')\n-        self.assertEqual(p.as_ul(), u'<li><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" /></li>\\n<li><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" id=\"id_last_name\" /></li>\\n<li><label for=\"id_birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" /></li>')\n-        self.assertEqual(p.as_p(), u'<p><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" /></p>\\n<p><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" id=\"id_last_name\" /></p>\\n<p><label for=\"id_birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" /></p>')\n+        self.assertHTMLEqual(p.as_table(), u'<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" /></td></tr>\\n<tr><th><label for=\"id_last_name\">Last name:</label></th><td><input type=\"text\" name=\"last_name\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" id=\"id_last_name\" /></td></tr>\\n<tr><th><label for=\"id_birthday\">Birthday:</label></th><td><input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" /></td></tr>')\n+        self.assertHTMLEqual(p.as_ul(), u'<li><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" /></li>\\n<li><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" id=\"id_last_name\" /></li>\\n<li><label for=\"id_birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" /></li>')\n+        self.assertHTMLEqual(p.as_p(), u'<p><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" /></p>\\n<p><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" id=\"id_last_name\" /></p>\\n<p><label for=\"id_birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" /></p>')\n \n         p = Person({'last_name': u'Lennon'})\n         self.assertEqual(p.errors['first_name'], [u'This field is required.'])\n         self.assertEqual(p.errors['birthday'], [u'This field is required.'])\n         self.assertFalse(p.is_valid())\n-        self.assertEqual(p.errors.as_ul(), u'<ul class=\"errorlist\"><li>first_name<ul class=\"errorlist\"><li>This field is required.</li></ul></li><li>birthday<ul class=\"errorlist\"><li>This field is required.</li></ul></li></ul>')\n+        self.assertHTMLEqual(p.errors.as_ul(), u'<ul class=\"errorlist\"><li>first_name<ul class=\"errorlist\"><li>This field is required.</li></ul></li><li>birthday<ul class=\"errorlist\"><li>This field is required.</li></ul></li></ul>')\n         self.assertEqual(p.errors.as_text(), \"\"\"* first_name\n   * This field is required.\n * birthday\n@@ -148,13 +148,13 @@ def test_unicode_values(self):\n         except AttributeError:\n             pass\n         self.assertEqual(p['first_name'].errors, [u'This field is required.'])\n-        self.assertEqual(p['first_name'].errors.as_ul(), u'<ul class=\"errorlist\"><li>This field is required.</li></ul>')\n+        self.assertHTMLEqual(p['first_name'].errors.as_ul(), u'<ul class=\"errorlist\"><li>This field is required.</li></ul>')\n         self.assertEqual(p['first_name'].errors.as_text(), u'* This field is required.')\n \n         p = Person()\n-        self.assertEqual(str(p['first_name']), '<input type=\"text\" name=\"first_name\" id=\"id_first_name\" />')\n-        self.assertEqual(str(p['last_name']), '<input type=\"text\" name=\"last_name\" id=\"id_last_name\" />')\n-        self.assertEqual(str(p['birthday']), '<input type=\"text\" name=\"birthday\" id=\"id_birthday\" />')\n+        self.assertHTMLEqual(str(p['first_name']), '<input type=\"text\" name=\"first_name\" id=\"id_first_name\" />')\n+        self.assertHTMLEqual(str(p['last_name']), '<input type=\"text\" name=\"last_name\" id=\"id_last_name\" />')\n+        self.assertHTMLEqual(str(p['birthday']), '<input type=\"text\" name=\"birthday\" id=\"id_birthday\" />')\n \n     def test_cleaned_data_only_fields(self):\n         # cleaned_data will always *only* contain a key for fields defined in the\n@@ -205,45 +205,45 @@ def test_auto_id(self):\n         # into which the field's name will be inserted. It will also put a <label> around\n         # the human-readable labels for a field.\n         p = Person(auto_id='%s_id')\n-        self.assertEqual(p.as_table(), \"\"\"<tr><th><label for=\"first_name_id\">First name:</label></th><td><input type=\"text\" name=\"first_name\" id=\"first_name_id\" /></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr><th><label for=\"first_name_id\">First name:</label></th><td><input type=\"text\" name=\"first_name\" id=\"first_name_id\" /></td></tr>\n <tr><th><label for=\"last_name_id\">Last name:</label></th><td><input type=\"text\" name=\"last_name\" id=\"last_name_id\" /></td></tr>\n <tr><th><label for=\"birthday_id\">Birthday:</label></th><td><input type=\"text\" name=\"birthday\" id=\"birthday_id\" /></td></tr>\"\"\")\n-        self.assertEqual(p.as_ul(), \"\"\"<li><label for=\"first_name_id\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"first_name_id\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><label for=\"first_name_id\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"first_name_id\" /></li>\n <li><label for=\"last_name_id\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"last_name_id\" /></li>\n <li><label for=\"birthday_id\">Birthday:</label> <input type=\"text\" name=\"birthday\" id=\"birthday_id\" /></li>\"\"\")\n-        self.assertEqual(p.as_p(), \"\"\"<p><label for=\"first_name_id\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"first_name_id\" /></p>\n+        self.assertHTMLEqual(p.as_p(), \"\"\"<p><label for=\"first_name_id\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"first_name_id\" /></p>\n <p><label for=\"last_name_id\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"last_name_id\" /></p>\n <p><label for=\"birthday_id\">Birthday:</label> <input type=\"text\" name=\"birthday\" id=\"birthday_id\" /></p>\"\"\")\n \n     def test_auto_id_true(self):\n         # If auto_id is any True value whose str() does not contain '%s', the \"id\"\n         # attribute will be the name of the field.\n         p = Person(auto_id=True)\n-        self.assertEqual(p.as_ul(), \"\"\"<li><label for=\"first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><label for=\"first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"first_name\" /></li>\n <li><label for=\"last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"last_name\" /></li>\n <li><label for=\"birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" id=\"birthday\" /></li>\"\"\")\n \n     def test_auto_id_false(self):\n         # If auto_id is any False value, an \"id\" attribute won't be output unless it\n         # was manually entered.\n         p = Person(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n <li>Last name: <input type=\"text\" name=\"last_name\" /></li>\n <li>Birthday: <input type=\"text\" name=\"birthday\" /></li>\"\"\")\n \n     def test_id_on_field(self):\n         # In this example, auto_id is False, but the \"id\" attribute for the \"first_name\"\n         # field is given. Also note that field gets a <label>, while the others don't.\n         p = PersonNew(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li><label for=\"first_name_id\">First name:</label> <input type=\"text\" id=\"first_name_id\" name=\"first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><label for=\"first_name_id\">First name:</label> <input type=\"text\" id=\"first_name_id\" name=\"first_name\" /></li>\n <li>Last name: <input type=\"text\" name=\"last_name\" /></li>\n <li>Birthday: <input type=\"text\" name=\"birthday\" /></li>\"\"\")\n \n     def test_auto_id_on_form_and_field(self):\n         # If the \"id\" attribute is specified in the Form and auto_id is True, the \"id\"\n         # attribute in the Form gets precedence.\n         p = PersonNew(auto_id=True)\n-        self.assertEqual(p.as_ul(), \"\"\"<li><label for=\"first_name_id\">First name:</label> <input type=\"text\" id=\"first_name_id\" name=\"first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><label for=\"first_name_id\">First name:</label> <input type=\"text\" id=\"first_name_id\" name=\"first_name\" /></li>\n <li><label for=\"last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"last_name\" /></li>\n <li><label for=\"birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" id=\"birthday\" /></li>\"\"\")\n \n@@ -253,26 +253,26 @@ class SignupForm(Form):\n             get_spam = BooleanField()\n \n         f = SignupForm(auto_id=False)\n-        self.assertEqual(str(f['email']), '<input type=\"text\" name=\"email\" />')\n-        self.assertEqual(str(f['get_spam']), '<input type=\"checkbox\" name=\"get_spam\" />')\n+        self.assertHTMLEqual(str(f['email']), '<input type=\"text\" name=\"email\" />')\n+        self.assertHTMLEqual(str(f['get_spam']), '<input type=\"checkbox\" name=\"get_spam\" />')\n \n         f = SignupForm({'email': 'test@example.com', 'get_spam': True}, auto_id=False)\n-        self.assertEqual(str(f['email']), '<input type=\"text\" name=\"email\" value=\"test@example.com\" />')\n-        self.assertEqual(str(f['get_spam']), '<input checked=\"checked\" type=\"checkbox\" name=\"get_spam\" />')\n+        self.assertHTMLEqual(str(f['email']), '<input type=\"text\" name=\"email\" value=\"test@example.com\" />')\n+        self.assertHTMLEqual(str(f['get_spam']), '<input checked=\"checked\" type=\"checkbox\" name=\"get_spam\" />')\n \n         # 'True' or 'true' should be rendered without a value attribute\n         f = SignupForm({'email': 'test@example.com', 'get_spam': 'True'}, auto_id=False)\n-        self.assertEqual(str(f['get_spam']), '<input checked=\"checked\" type=\"checkbox\" name=\"get_spam\" />')\n+        self.assertHTMLEqual(str(f['get_spam']), '<input checked=\"checked\" type=\"checkbox\" name=\"get_spam\" />')\n \n         f = SignupForm({'email': 'test@example.com', 'get_spam': 'true'}, auto_id=False)\n-        self.assertEqual(str(f['get_spam']), '<input checked=\"checked\" type=\"checkbox\" name=\"get_spam\" />')\n+        self.assertHTMLEqual(str(f['get_spam']), '<input checked=\"checked\" type=\"checkbox\" name=\"get_spam\" />')\n \n         # A value of 'False' or 'false' should be rendered unchecked\n         f = SignupForm({'email': 'test@example.com', 'get_spam': 'False'}, auto_id=False)\n-        self.assertEqual(str(f['get_spam']), '<input type=\"checkbox\" name=\"get_spam\" />')\n+        self.assertHTMLEqual(str(f['get_spam']), '<input type=\"checkbox\" name=\"get_spam\" />')\n \n         f = SignupForm({'email': 'test@example.com', 'get_spam': 'false'}, auto_id=False)\n-        self.assertEqual(str(f['get_spam']), '<input type=\"checkbox\" name=\"get_spam\" />')\n+        self.assertHTMLEqual(str(f['get_spam']), '<input type=\"checkbox\" name=\"get_spam\" />')\n \n     def test_widget_output(self):\n         # Any Field can have a Widget class passed to its constructor:\n@@ -281,30 +281,30 @@ class ContactForm(Form):\n             message = CharField(widget=Textarea)\n \n         f = ContactForm(auto_id=False)\n-        self.assertEqual(str(f['subject']), '<input type=\"text\" name=\"subject\" />')\n-        self.assertEqual(str(f['message']), '<textarea rows=\"10\" cols=\"40\" name=\"message\"></textarea>')\n+        self.assertHTMLEqual(str(f['subject']), '<input type=\"text\" name=\"subject\" />')\n+        self.assertHTMLEqual(str(f['message']), '<textarea name=\"message\" rows=\"10\" cols=\"40\"></textarea>')\n \n         # as_textarea(), as_text() and as_hidden() are shortcuts for changing the output\n         # widget type:\n-        self.assertEqual(f['subject'].as_textarea(), u'<textarea rows=\"10\" cols=\"40\" name=\"subject\"></textarea>')\n-        self.assertEqual(f['message'].as_text(), u'<input type=\"text\" name=\"message\" />')\n-        self.assertEqual(f['message'].as_hidden(), u'<input type=\"hidden\" name=\"message\" />')\n+        self.assertHTMLEqual(f['subject'].as_textarea(), u'<textarea name=\"subject\" rows=\"10\" cols=\"40\"></textarea>')\n+        self.assertHTMLEqual(f['message'].as_text(), u'<input type=\"text\" name=\"message\" />')\n+        self.assertHTMLEqual(f['message'].as_hidden(), u'<input type=\"hidden\" name=\"message\" />')\n \n         # The 'widget' parameter to a Field can also be an instance:\n         class ContactForm(Form):\n             subject = CharField()\n             message = CharField(widget=Textarea(attrs={'rows': 80, 'cols': 20}))\n \n         f = ContactForm(auto_id=False)\n-        self.assertEqual(str(f['message']), '<textarea rows=\"80\" cols=\"20\" name=\"message\"></textarea>')\n+        self.assertHTMLEqual(str(f['message']), '<textarea name=\"message\" rows=\"80\" cols=\"20\"></textarea>')\n \n         # Instance-level attrs are *not* carried over to as_textarea(), as_text() and\n         # as_hidden():\n-        self.assertEqual(f['message'].as_text(), u'<input type=\"text\" name=\"message\" />')\n+        self.assertHTMLEqual(f['message'].as_text(), u'<input type=\"text\" name=\"message\" />')\n         f = ContactForm({'subject': 'Hello', 'message': 'I love you.'}, auto_id=False)\n-        self.assertEqual(f['subject'].as_textarea(), u'<textarea rows=\"10\" cols=\"40\" name=\"subject\">Hello</textarea>')\n-        self.assertEqual(f['message'].as_text(), u'<input type=\"text\" name=\"message\" value=\"I love you.\" />')\n-        self.assertEqual(f['message'].as_hidden(), u'<input type=\"hidden\" name=\"message\" value=\"I love you.\" />')\n+        self.assertHTMLEqual(f['subject'].as_textarea(), u'<textarea rows=\"10\" cols=\"40\" name=\"subject\">Hello</textarea>')\n+        self.assertHTMLEqual(f['message'].as_text(), u'<input type=\"text\" name=\"message\" value=\"I love you.\" />')\n+        self.assertHTMLEqual(f['message'].as_hidden(), u'<input type=\"hidden\" name=\"message\" value=\"I love you.\" />')\n \n     def test_forms_with_choices(self):\n         # For a form with a <select>, use ChoiceField:\n@@ -313,12 +313,12 @@ class FrameworkForm(Form):\n             language = ChoiceField(choices=[('P', 'Python'), ('J', 'Java')])\n \n         f = FrameworkForm(auto_id=False)\n-        self.assertEqual(str(f['language']), \"\"\"<select name=\"language\">\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<select name=\"language\">\n <option value=\"P\">Python</option>\n <option value=\"J\">Java</option>\n </select>\"\"\")\n         f = FrameworkForm({'name': 'Django', 'language': 'P'}, auto_id=False)\n-        self.assertEqual(str(f['language']), \"\"\"<select name=\"language\">\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<select name=\"language\">\n <option value=\"P\" selected=\"selected\">Python</option>\n <option value=\"J\">Java</option>\n </select>\"\"\")\n@@ -330,7 +330,7 @@ class FrameworkForm(Form):\n             language = ChoiceField(choices=[('', '------'), ('P', 'Python'), ('J', 'Java')])\n \n         f = FrameworkForm(auto_id=False)\n-        self.assertEqual(str(f['language']), \"\"\"<select name=\"language\">\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<select name=\"language\">\n <option value=\"\" selected=\"selected\">------</option>\n <option value=\"P\">Python</option>\n <option value=\"J\">Java</option>\n@@ -342,12 +342,12 @@ class FrameworkForm(Form):\n             language = ChoiceField(choices=[('P', 'Python'), ('J', 'Java')], widget=Select(attrs={'class': 'foo'}))\n \n         f = FrameworkForm(auto_id=False)\n-        self.assertEqual(str(f['language']), \"\"\"<select class=\"foo\" name=\"language\">\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<select class=\"foo\" name=\"language\">\n <option value=\"P\">Python</option>\n <option value=\"J\">Java</option>\n </select>\"\"\")\n         f = FrameworkForm({'name': 'Django', 'language': 'P'}, auto_id=False)\n-        self.assertEqual(str(f['language']), \"\"\"<select class=\"foo\" name=\"language\">\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<select class=\"foo\" name=\"language\">\n <option value=\"P\" selected=\"selected\">Python</option>\n <option value=\"J\">Java</option>\n </select>\"\"\")\n@@ -360,12 +360,12 @@ class FrameworkForm(Form):\n             language = ChoiceField(choices=[('P', 'Python'), ('J', 'Java')], widget=Select(choices=[('R', 'Ruby'), ('P', 'Perl')], attrs={'class': 'foo'}))\n \n         f = FrameworkForm(auto_id=False)\n-        self.assertEqual(str(f['language']), \"\"\"<select class=\"foo\" name=\"language\">\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<select class=\"foo\" name=\"language\">\n <option value=\"P\">Python</option>\n <option value=\"J\">Java</option>\n </select>\"\"\")\n         f = FrameworkForm({'name': 'Django', 'language': 'P'}, auto_id=False)\n-        self.assertEqual(str(f['language']), \"\"\"<select class=\"foo\" name=\"language\">\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<select class=\"foo\" name=\"language\">\n <option value=\"P\" selected=\"selected\">Python</option>\n <option value=\"J\">Java</option>\n </select>\"\"\")\n@@ -376,10 +376,10 @@ class FrameworkForm(Form):\n             language = ChoiceField()\n \n         f = FrameworkForm(auto_id=False)\n-        self.assertEqual(str(f['language']), \"\"\"<select name=\"language\">\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<select name=\"language\">\n </select>\"\"\")\n         f.fields['language'].choices = [('P', 'Python'), ('J', 'Java')]\n-        self.assertEqual(str(f['language']), \"\"\"<select name=\"language\">\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<select name=\"language\">\n <option value=\"P\">Python</option>\n <option value=\"J\">Java</option>\n </select>\"\"\")\n@@ -391,16 +391,16 @@ class FrameworkForm(Form):\n             language = ChoiceField(choices=[('P', 'Python'), ('J', 'Java')], widget=RadioSelect)\n \n         f = FrameworkForm(auto_id=False)\n-        self.assertEqual(str(f['language']), \"\"\"<ul>\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"language\" value=\"P\" /> Python</label></li>\n <li><label><input type=\"radio\" name=\"language\" value=\"J\" /> Java</label></li>\n </ul>\"\"\")\n-        self.assertEqual(f.as_table(), \"\"\"<tr><th>Name:</th><td><input type=\"text\" name=\"name\" /></td></tr>\n+        self.assertHTMLEqual(f.as_table(), \"\"\"<tr><th>Name:</th><td><input type=\"text\" name=\"name\" /></td></tr>\n <tr><th>Language:</th><td><ul>\n <li><label><input type=\"radio\" name=\"language\" value=\"P\" /> Python</label></li>\n <li><label><input type=\"radio\" name=\"language\" value=\"J\" /> Java</label></li>\n </ul></td></tr>\"\"\")\n-        self.assertEqual(f.as_ul(), \"\"\"<li>Name: <input type=\"text\" name=\"name\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), \"\"\"<li>Name: <input type=\"text\" name=\"name\" /></li>\n <li>Language: <ul>\n <li><label><input type=\"radio\" name=\"language\" value=\"P\" /> Python</label></li>\n <li><label><input type=\"radio\" name=\"language\" value=\"J\" /> Java</label></li>\n@@ -410,25 +410,25 @@ class FrameworkForm(Form):\n         # gets a distinct ID, formed by appending an underscore plus the button's\n         # zero-based index.\n         f = FrameworkForm(auto_id='id_%s')\n-        self.assertEqual(str(f['language']), \"\"\"<ul>\n+        self.assertHTMLEqual(str(f['language']), \"\"\"<ul>\n <li><label for=\"id_language_0\"><input type=\"radio\" id=\"id_language_0\" value=\"P\" name=\"language\" /> Python</label></li>\n <li><label for=\"id_language_1\"><input type=\"radio\" id=\"id_language_1\" value=\"J\" name=\"language\" /> Java</label></li>\n </ul>\"\"\")\n \n         # When RadioSelect is used with auto_id, and the whole form is printed using\n         # either as_table() or as_ul(), the label for the RadioSelect will point to the\n         # ID of the *first* radio button.\n-        self.assertEqual(f.as_table(), \"\"\"<tr><th><label for=\"id_name\">Name:</label></th><td><input type=\"text\" name=\"name\" id=\"id_name\" /></td></tr>\n+        self.assertHTMLEqual(f.as_table(), \"\"\"<tr><th><label for=\"id_name\">Name:</label></th><td><input type=\"text\" name=\"name\" id=\"id_name\" /></td></tr>\n <tr><th><label for=\"id_language_0\">Language:</label></th><td><ul>\n <li><label for=\"id_language_0\"><input type=\"radio\" id=\"id_language_0\" value=\"P\" name=\"language\" /> Python</label></li>\n <li><label for=\"id_language_1\"><input type=\"radio\" id=\"id_language_1\" value=\"J\" name=\"language\" /> Java</label></li>\n </ul></td></tr>\"\"\")\n-        self.assertEqual(f.as_ul(), \"\"\"<li><label for=\"id_name\">Name:</label> <input type=\"text\" name=\"name\" id=\"id_name\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), \"\"\"<li><label for=\"id_name\">Name:</label> <input type=\"text\" name=\"name\" id=\"id_name\" /></li>\n <li><label for=\"id_language_0\">Language:</label> <ul>\n <li><label for=\"id_language_0\"><input type=\"radio\" id=\"id_language_0\" value=\"P\" name=\"language\" /> Python</label></li>\n <li><label for=\"id_language_1\"><input type=\"radio\" id=\"id_language_1\" value=\"J\" name=\"language\" /> Java</label></li>\n </ul></li>\"\"\")\n-        self.assertEqual(f.as_p(), \"\"\"<p><label for=\"id_name\">Name:</label> <input type=\"text\" name=\"name\" id=\"id_name\" /></p>\n+        self.assertHTMLEqual(f.as_p(), \"\"\"<p><label for=\"id_name\">Name:</label> <input type=\"text\" name=\"name\" id=\"id_name\" /></p>\n <p><label for=\"id_language_0\">Language:</label> <ul>\n <li><label for=\"id_language_0\"><input type=\"radio\" id=\"id_language_0\" value=\"P\" name=\"language\" /> Python</label></li>\n <li><label for=\"id_language_1\"><input type=\"radio\" id=\"id_language_1\" value=\"J\" name=\"language\" /> Java</label></li>\n@@ -439,11 +439,11 @@ class BeatleForm(Form):\n             name = ChoiceField(choices=[('john', 'John'), ('paul', 'Paul'), ('george', 'George'), ('ringo', 'Ringo')], widget=RadioSelect)\n \n         f = BeatleForm(auto_id=False)\n-        self.assertEqual('\\n'.join([str(bf) for bf in f['name']]), \"\"\"<label><input type=\"radio\" name=\"name\" value=\"john\" /> John</label>\n+        self.assertHTMLEqual('\\n'.join([str(bf) for bf in f['name']]), \"\"\"<label><input type=\"radio\" name=\"name\" value=\"john\" /> John</label>\n <label><input type=\"radio\" name=\"name\" value=\"paul\" /> Paul</label>\n <label><input type=\"radio\" name=\"name\" value=\"george\" /> George</label>\n <label><input type=\"radio\" name=\"name\" value=\"ringo\" /> Ringo</label>\"\"\")\n-        self.assertEqual('\\n'.join(['<div>%s</div>' % bf for bf in f['name']]), \"\"\"<div><label><input type=\"radio\" name=\"name\" value=\"john\" /> John</label></div>\n+        self.assertHTMLEqual('\\n'.join(['<div>%s</div>' % bf for bf in f['name']]), \"\"\"<div><label><input type=\"radio\" name=\"name\" value=\"john\" /> John</label></div>\n <div><label><input type=\"radio\" name=\"name\" value=\"paul\" /> Paul</label></div>\n <div><label><input type=\"radio\" name=\"name\" value=\"george\" /> George</label></div>\n <div><label><input type=\"radio\" name=\"name\" value=\"ringo\" /> Ringo</label></div>\"\"\")\n@@ -454,7 +454,7 @@ class BeatleForm(Form):\n             name = CharField()\n \n         f = BeatleForm(auto_id=False)\n-        self.assertEqual('\\n'.join([str(bf) for bf in f['name']]), u'<input type=\"text\" name=\"name\" />')\n+        self.assertHTMLEqual('\\n'.join([str(bf) for bf in f['name']]), u'<input type=\"text\" name=\"name\" />')\n \n     def test_forms_with_multiple_choice(self):\n         # MultipleChoiceField is a special case, as its data is required to be a list:\n@@ -463,21 +463,21 @@ class SongForm(Form):\n             composers = MultipleChoiceField()\n \n         f = SongForm(auto_id=False)\n-        self.assertEqual(str(f['composers']), \"\"\"<select multiple=\"multiple\" name=\"composers\">\n+        self.assertHTMLEqual(str(f['composers']), \"\"\"<select multiple=\"multiple\" name=\"composers\">\n </select>\"\"\")\n \n         class SongForm(Form):\n             name = CharField()\n             composers = MultipleChoiceField(choices=[('J', 'John Lennon'), ('P', 'Paul McCartney')])\n \n         f = SongForm(auto_id=False)\n-        self.assertEqual(str(f['composers']), \"\"\"<select multiple=\"multiple\" name=\"composers\">\n+        self.assertHTMLEqual(str(f['composers']), \"\"\"<select multiple=\"multiple\" name=\"composers\">\n <option value=\"J\">John Lennon</option>\n <option value=\"P\">Paul McCartney</option>\n </select>\"\"\")\n         f = SongForm({'name': 'Yesterday', 'composers': ['P']}, auto_id=False)\n-        self.assertEqual(str(f['name']), '<input type=\"text\" name=\"name\" value=\"Yesterday\" />')\n-        self.assertEqual(str(f['composers']), \"\"\"<select multiple=\"multiple\" name=\"composers\">\n+        self.assertHTMLEqual(str(f['name']), '<input type=\"text\" name=\"name\" value=\"Yesterday\" />')\n+        self.assertHTMLEqual(str(f['composers']), \"\"\"<select multiple=\"multiple\" name=\"composers\">\n <option value=\"J\">John Lennon</option>\n <option value=\"P\" selected=\"selected\">Paul McCartney</option>\n </select>\"\"\")\n@@ -491,9 +491,9 @@ class SongForm(Form):\n         # have multiple values, its as_hidden() renders multiple <input type=\"hidden\">\n         # tags.\n         f = SongForm({'name': 'Yesterday', 'composers': ['P']}, auto_id=False)\n-        self.assertEqual(f['composers'].as_hidden(), '<input type=\"hidden\" name=\"composers\" value=\"P\" />')\n+        self.assertHTMLEqual(f['composers'].as_hidden(), '<input type=\"hidden\" name=\"composers\" value=\"P\" />')\n         f = SongForm({'name': 'From Me To You', 'composers': ['P', 'J']}, auto_id=False)\n-        self.assertEqual(f['composers'].as_hidden(), \"\"\"<input type=\"hidden\" name=\"composers\" value=\"P\" />\n+        self.assertHTMLEqual(f['composers'].as_hidden(), \"\"\"<input type=\"hidden\" name=\"composers\" value=\"P\" />\n <input type=\"hidden\" name=\"composers\" value=\"J\" />\"\"\")\n \n         # DateTimeField rendered as_hidden() is special too\n@@ -502,8 +502,8 @@ class MessageForm(Form):\n \n         f = MessageForm({'when_0': '1992-01-01', 'when_1': '01:01'})\n         self.assertTrue(f.is_valid())\n-        self.assertEqual(str(f['when']), '<input type=\"text\" name=\"when_0\" value=\"1992-01-01\" id=\"id_when_0\" /><input type=\"text\" name=\"when_1\" value=\"01:01\" id=\"id_when_1\" />')\n-        self.assertEqual(f['when'].as_hidden(), '<input type=\"hidden\" name=\"when_0\" value=\"1992-01-01\" id=\"id_when_0\" /><input type=\"hidden\" name=\"when_1\" value=\"01:01\" id=\"id_when_1\" />')\n+        self.assertHTMLEqual(str(f['when']), '<input type=\"text\" name=\"when_0\" value=\"1992-01-01\" id=\"id_when_0\" /><input type=\"text\" name=\"when_1\" value=\"01:01\" id=\"id_when_1\" />')\n+        self.assertHTMLEqual(f['when'].as_hidden(), '<input type=\"hidden\" name=\"when_0\" value=\"1992-01-01\" id=\"id_when_0\" /><input type=\"hidden\" name=\"when_1\" value=\"01:01\" id=\"id_when_1\" />')\n \n     def test_mulitple_choice_checkbox(self):\n         # MultipleChoiceField can also be used with the CheckboxSelectMultiple widget.\n@@ -512,17 +512,17 @@ class SongForm(Form):\n             composers = MultipleChoiceField(choices=[('J', 'John Lennon'), ('P', 'Paul McCartney')], widget=CheckboxSelectMultiple)\n \n         f = SongForm(auto_id=False)\n-        self.assertEqual(str(f['composers']), \"\"\"<ul>\n+        self.assertHTMLEqual(str(f['composers']), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"composers\" value=\"J\" /> John Lennon</label></li>\n <li><label><input type=\"checkbox\" name=\"composers\" value=\"P\" /> Paul McCartney</label></li>\n </ul>\"\"\")\n         f = SongForm({'composers': ['J']}, auto_id=False)\n-        self.assertEqual(str(f['composers']), \"\"\"<ul>\n+        self.assertHTMLEqual(str(f['composers']), \"\"\"<ul>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"composers\" value=\"J\" /> John Lennon</label></li>\n <li><label><input type=\"checkbox\" name=\"composers\" value=\"P\" /> Paul McCartney</label></li>\n </ul>\"\"\")\n         f = SongForm({'composers': ['J', 'P']}, auto_id=False)\n-        self.assertEqual(str(f['composers']), \"\"\"<ul>\n+        self.assertHTMLEqual(str(f['composers']), \"\"\"<ul>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"composers\" value=\"J\" /> John Lennon</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"composers\" value=\"P\" /> Paul McCartney</label></li>\n </ul>\"\"\")\n@@ -536,7 +536,7 @@ class SongForm(Form):\n             composers = MultipleChoiceField(choices=[('J', 'John Lennon'), ('P', 'Paul McCartney')], widget=CheckboxSelectMultiple)\n \n         f = SongForm(auto_id='%s_id')\n-        self.assertEqual(str(f['composers']), \"\"\"<ul>\n+        self.assertHTMLEqual(str(f['composers']), \"\"\"<ul>\n <li><label for=\"composers_id_0\"><input type=\"checkbox\" name=\"composers\" value=\"J\" id=\"composers_id_0\" /> John Lennon</label></li>\n <li><label for=\"composers_id_1\"><input type=\"checkbox\" name=\"composers\" value=\"P\" id=\"composers_id_1\" /> Paul McCartney</label></li>\n </ul>\"\"\")\n@@ -576,7 +576,7 @@ class SongFormHidden(Form):\n             composers = MultipleChoiceField(choices=[('J', 'John Lennon'), ('P', 'Paul McCartney')], widget=MultipleHiddenInput)\n \n         f = SongFormHidden(MultiValueDict(dict(name=['Yesterday'], composers=['J', 'P'])), auto_id=False)\n-        self.assertEqual(f.as_ul(), \"\"\"<li>Name: <input type=\"text\" name=\"name\" value=\"Yesterday\" /><input type=\"hidden\" name=\"composers\" value=\"J\" />\n+        self.assertHTMLEqual(f.as_ul(), \"\"\"<li>Name: <input type=\"text\" name=\"name\" value=\"Yesterday\" /><input type=\"hidden\" name=\"composers\" value=\"J\" />\n <input type=\"hidden\" name=\"composers\" value=\"P\" /></li>\"\"\")\n \n         # When using CheckboxSelectMultiple, the framework expects a list of input and\n@@ -605,13 +605,13 @@ def clean_special_safe_name(self):\n                 raise ValidationError(mark_safe(\"'<b>%s</b>' is a safe string\" % self.cleaned_data['special_safe_name']))\n \n         f = EscapingForm({'special_name': \"Nothing to escape\", 'special_safe_name': \"Nothing to escape\"}, auto_id=False)\n-        self.assertEqual(f.as_table(), \"\"\"<tr><th>&lt;em&gt;Special&lt;/em&gt; Field:</th><td><ul class=\"errorlist\"><li>Something&#39;s wrong with &#39;Nothing to escape&#39;</li></ul><input type=\"text\" name=\"special_name\" value=\"Nothing to escape\" /></td></tr>\n+        self.assertHTMLEqual(f.as_table(), \"\"\"<tr><th>&lt;em&gt;Special&lt;/em&gt; Field:</th><td><ul class=\"errorlist\"><li>Something&#39;s wrong with &#39;Nothing to escape&#39;</li></ul><input type=\"text\" name=\"special_name\" value=\"Nothing to escape\" /></td></tr>\n <tr><th><em>Special</em> Field:</th><td><ul class=\"errorlist\"><li>'<b>Nothing to escape</b>' is a safe string</li></ul><input type=\"text\" name=\"special_safe_name\" value=\"Nothing to escape\" /></td></tr>\"\"\")\n         f = EscapingForm({\n             'special_name': \"Should escape < & > and <script>alert('xss')</script>\",\n             'special_safe_name': \"<i>Do not escape</i>\"\n         }, auto_id=False)\n-        self.assertEqual(f.as_table(), \"\"\"<tr><th>&lt;em&gt;Special&lt;/em&gt; Field:</th><td><ul class=\"errorlist\"><li>Something&#39;s wrong with &#39;Should escape &lt; &amp; &gt; and &lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&#39;</li></ul><input type=\"text\" name=\"special_name\" value=\"Should escape &lt; &amp; &gt; and &lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;\" /></td></tr>\n+        self.assertHTMLEqual(f.as_table(), \"\"\"<tr><th>&lt;em&gt;Special&lt;/em&gt; Field:</th><td><ul class=\"errorlist\"><li>Something&#39;s wrong with &#39;Should escape &lt; &amp; &gt; and &lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&#39;</li></ul><input type=\"text\" name=\"special_name\" value=\"Should escape &lt; &amp; &gt; and &lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;\" /></td></tr>\n <tr><th><em>Special</em> Field:</th><td><ul class=\"errorlist\"><li>'<b><i>Do not escape</i></b>' is a safe string</li></ul><input type=\"text\" name=\"special_safe_name\" value=\"&lt;i&gt;Do not escape&lt;/i&gt;\" /></td></tr>\"\"\")\n \n     def test_validating_multiple_fields(self):\n@@ -668,19 +668,19 @@ def clean(self):\n         f = UserRegistration(auto_id=False)\n         self.assertEqual(f.errors, {})\n         f = UserRegistration({}, auto_id=False)\n-        self.assertEqual(f.as_table(), \"\"\"<tr><th>Username:</th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"username\" maxlength=\"10\" /></td></tr>\n+        self.assertHTMLEqual(f.as_table(), \"\"\"<tr><th>Username:</th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"username\" maxlength=\"10\" /></td></tr>\n <tr><th>Password1:</th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"password\" name=\"password1\" /></td></tr>\n <tr><th>Password2:</th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"password\" name=\"password2\" /></td></tr>\"\"\")\n         self.assertEqual(f.errors['username'], [u'This field is required.'])\n         self.assertEqual(f.errors['password1'], [u'This field is required.'])\n         self.assertEqual(f.errors['password2'], [u'This field is required.'])\n         f = UserRegistration({'username': 'adrian', 'password1': 'foo', 'password2': 'bar'}, auto_id=False)\n         self.assertEqual(f.errors['__all__'], [u'Please make sure your passwords match.'])\n-        self.assertEqual(f.as_table(), \"\"\"<tr><td colspan=\"2\"><ul class=\"errorlist\"><li>Please make sure your passwords match.</li></ul></td></tr>\n+        self.assertHTMLEqual(f.as_table(), \"\"\"<tr><td colspan=\"2\"><ul class=\"errorlist\"><li>Please make sure your passwords match.</li></ul></td></tr>\n <tr><th>Username:</th><td><input type=\"text\" name=\"username\" value=\"adrian\" maxlength=\"10\" /></td></tr>\n <tr><th>Password1:</th><td><input type=\"password\" name=\"password1\" /></td></tr>\n <tr><th>Password2:</th><td><input type=\"password\" name=\"password2\" /></td></tr>\"\"\")\n-        self.assertEqual(f.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>Please make sure your passwords match.</li></ul></li>\n+        self.assertHTMLEqual(f.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>Please make sure your passwords match.</li></ul></li>\n <li>Username: <input type=\"text\" name=\"username\" value=\"adrian\" maxlength=\"10\" /></li>\n <li>Password1: <input type=\"password\" name=\"password1\" /></li>\n <li>Password2: <input type=\"password\" name=\"password2\" /></li>\"\"\")\n@@ -703,7 +703,7 @@ def __init__(self, *args, **kwargs):\n                 self.fields['birthday'] = DateField()\n \n         p = Person(auto_id=False)\n-        self.assertEqual(p.as_table(), \"\"\"<tr><th>First name:</th><td><input type=\"text\" name=\"first_name\" /></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr><th>First name:</th><td><input type=\"text\" name=\"first_name\" /></td></tr>\n <tr><th>Last name:</th><td><input type=\"text\" name=\"last_name\" /></td></tr>\n <tr><th>Birthday:</th><td><input type=\"text\" name=\"birthday\" /></td></tr>\"\"\")\n \n@@ -718,11 +718,11 @@ def __init__(self, data=None, auto_id=False, field_list=[]):\n \n         field_list = [('field1', CharField()), ('field2', CharField())]\n         my_form = MyForm(field_list=field_list)\n-        self.assertEqual(my_form.as_table(), \"\"\"<tr><th>Field1:</th><td><input type=\"text\" name=\"field1\" /></td></tr>\n+        self.assertHTMLEqual(my_form.as_table(), \"\"\"<tr><th>Field1:</th><td><input type=\"text\" name=\"field1\" /></td></tr>\n <tr><th>Field2:</th><td><input type=\"text\" name=\"field2\" /></td></tr>\"\"\")\n         field_list = [('field3', CharField()), ('field4', CharField())]\n         my_form = MyForm(field_list=field_list)\n-        self.assertEqual(my_form.as_table(), \"\"\"<tr><th>Field3:</th><td><input type=\"text\" name=\"field3\" /></td></tr>\n+        self.assertHTMLEqual(my_form.as_table(), \"\"\"<tr><th>Field3:</th><td><input type=\"text\" name=\"field3\" /></td></tr>\n <tr><th>Field4:</th><td><input type=\"text\" name=\"field4\" /></td></tr>\"\"\")\n \n         class MyForm(Form):\n@@ -737,13 +737,13 @@ def __init__(self, data=None, auto_id=False, field_list=[]):\n \n         field_list = [('field1', CharField()), ('field2', CharField())]\n         my_form = MyForm(field_list=field_list)\n-        self.assertEqual(my_form.as_table(), \"\"\"<tr><th>Default field 1:</th><td><input type=\"text\" name=\"default_field_1\" /></td></tr>\n+        self.assertHTMLEqual(my_form.as_table(), \"\"\"<tr><th>Default field 1:</th><td><input type=\"text\" name=\"default_field_1\" /></td></tr>\n <tr><th>Default field 2:</th><td><input type=\"text\" name=\"default_field_2\" /></td></tr>\n <tr><th>Field1:</th><td><input type=\"text\" name=\"field1\" /></td></tr>\n <tr><th>Field2:</th><td><input type=\"text\" name=\"field2\" /></td></tr>\"\"\")\n         field_list = [('field3', CharField()), ('field4', CharField())]\n         my_form = MyForm(field_list=field_list)\n-        self.assertEqual(my_form.as_table(), \"\"\"<tr><th>Default field 1:</th><td><input type=\"text\" name=\"default_field_1\" /></td></tr>\n+        self.assertHTMLEqual(my_form.as_table(), \"\"\"<tr><th>Default field 1:</th><td><input type=\"text\" name=\"default_field_1\" /></td></tr>\n <tr><th>Default field 2:</th><td><input type=\"text\" name=\"default_field_2\" /></td></tr>\n <tr><th>Field3:</th><td><input type=\"text\" name=\"field3\" /></td></tr>\n <tr><th>Field4:</th><td><input type=\"text\" name=\"field4\" /></td></tr>\"\"\")\n@@ -836,25 +836,25 @@ class Person(Form):\n             birthday = DateField()\n \n         p = Person(auto_id=False)\n-        self.assertEqual(p.as_table(), \"\"\"<tr><th>First name:</th><td><input type=\"text\" name=\"first_name\" /></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr><th>First name:</th><td><input type=\"text\" name=\"first_name\" /></td></tr>\n <tr><th>Last name:</th><td><input type=\"text\" name=\"last_name\" /></td></tr>\n <tr><th>Birthday:</th><td><input type=\"text\" name=\"birthday\" /><input type=\"hidden\" name=\"hidden_text\" /></td></tr>\"\"\")\n-        self.assertEqual(p.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n <li>Last name: <input type=\"text\" name=\"last_name\" /></li>\n <li>Birthday: <input type=\"text\" name=\"birthday\" /><input type=\"hidden\" name=\"hidden_text\" /></li>\"\"\")\n-        self.assertEqual(p.as_p(), \"\"\"<p>First name: <input type=\"text\" name=\"first_name\" /></p>\n+        self.assertHTMLEqual(p.as_p(), \"\"\"<p>First name: <input type=\"text\" name=\"first_name\" /></p>\n <p>Last name: <input type=\"text\" name=\"last_name\" /></p>\n <p>Birthday: <input type=\"text\" name=\"birthday\" /><input type=\"hidden\" name=\"hidden_text\" /></p>\"\"\")\n \n         # With auto_id set, a HiddenInput still gets an ID, but it doesn't get a label.\n         p = Person(auto_id='id_%s')\n-        self.assertEqual(p.as_table(), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></td></tr>\n <tr><th><label for=\"id_last_name\">Last name:</label></th><td><input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></td></tr>\n <tr><th><label for=\"id_birthday\">Birthday:</label></th><td><input type=\"text\" name=\"birthday\" id=\"id_birthday\" /><input type=\"hidden\" name=\"hidden_text\" id=\"id_hidden_text\" /></td></tr>\"\"\")\n-        self.assertEqual(p.as_ul(), \"\"\"<li><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></li>\n <li><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></li>\n <li><label for=\"id_birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" id=\"id_birthday\" /><input type=\"hidden\" name=\"hidden_text\" id=\"id_hidden_text\" /></li>\"\"\")\n-        self.assertEqual(p.as_p(), \"\"\"<p><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></p>\n+        self.assertHTMLEqual(p.as_p(), \"\"\"<p><label for=\"id_first_name\">First name:</label> <input type=\"text\" name=\"first_name\" id=\"id_first_name\" /></p>\n <p><label for=\"id_last_name\">Last name:</label> <input type=\"text\" name=\"last_name\" id=\"id_last_name\" /></p>\n <p><label for=\"id_birthday\">Birthday:</label> <input type=\"text\" name=\"birthday\" id=\"id_birthday\" /><input type=\"hidden\" name=\"hidden_text\" id=\"id_hidden_text\" /></p>\"\"\")\n \n@@ -863,15 +863,15 @@ class Person(Form):\n         # prepended. This message is displayed at the top of the output, regardless of\n         # its field's order in the form.\n         p = Person({'first_name': 'John', 'last_name': 'Lennon', 'birthday': '1940-10-9'}, auto_id=False)\n-        self.assertEqual(p.as_table(), \"\"\"<tr><td colspan=\"2\"><ul class=\"errorlist\"><li>(Hidden field hidden_text) This field is required.</li></ul></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr><td colspan=\"2\"><ul class=\"errorlist\"><li>(Hidden field hidden_text) This field is required.</li></ul></td></tr>\n <tr><th>First name:</th><td><input type=\"text\" name=\"first_name\" value=\"John\" /></td></tr>\n <tr><th>Last name:</th><td><input type=\"text\" name=\"last_name\" value=\"Lennon\" /></td></tr>\n <tr><th>Birthday:</th><td><input type=\"text\" name=\"birthday\" value=\"1940-10-9\" /><input type=\"hidden\" name=\"hidden_text\" /></td></tr>\"\"\")\n-        self.assertEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>(Hidden field hidden_text) This field is required.</li></ul></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>(Hidden field hidden_text) This field is required.</li></ul></li>\n <li>First name: <input type=\"text\" name=\"first_name\" value=\"John\" /></li>\n <li>Last name: <input type=\"text\" name=\"last_name\" value=\"Lennon\" /></li>\n <li>Birthday: <input type=\"text\" name=\"birthday\" value=\"1940-10-9\" /><input type=\"hidden\" name=\"hidden_text\" /></li>\"\"\")\n-        self.assertEqual(p.as_p(), \"\"\"<ul class=\"errorlist\"><li>(Hidden field hidden_text) This field is required.</li></ul>\n+        self.assertHTMLEqual(p.as_p(), \"\"\"<ul class=\"errorlist\"><li>(Hidden field hidden_text) This field is required.</li></ul>\n <p>First name: <input type=\"text\" name=\"first_name\" value=\"John\" /></p>\n <p>Last name: <input type=\"text\" name=\"last_name\" value=\"Lennon\" /></p>\n <p>Birthday: <input type=\"text\" name=\"birthday\" value=\"1940-10-9\" /><input type=\"hidden\" name=\"hidden_text\" /></p>\"\"\")\n@@ -882,9 +882,9 @@ class TestForm(Form):\n             bar = CharField(widget=HiddenInput)\n \n         p = TestForm(auto_id=False)\n-        self.assertEqual(p.as_table(), '<input type=\"hidden\" name=\"foo\" /><input type=\"hidden\" name=\"bar\" />')\n-        self.assertEqual(p.as_ul(), '<input type=\"hidden\" name=\"foo\" /><input type=\"hidden\" name=\"bar\" />')\n-        self.assertEqual(p.as_p(), '<input type=\"hidden\" name=\"foo\" /><input type=\"hidden\" name=\"bar\" />')\n+        self.assertHTMLEqual(p.as_table(), '<input type=\"hidden\" name=\"foo\" /><input type=\"hidden\" name=\"bar\" />')\n+        self.assertHTMLEqual(p.as_ul(), '<input type=\"hidden\" name=\"foo\" /><input type=\"hidden\" name=\"bar\" />')\n+        self.assertHTMLEqual(p.as_p(), '<input type=\"hidden\" name=\"foo\" /><input type=\"hidden\" name=\"bar\" />')\n \n     def test_field_order(self):\n         # A Form's fields are displayed in the same order in which they were defined.\n@@ -905,7 +905,7 @@ class TestForm(Form):\n             field14 = CharField()\n \n         p = TestForm(auto_id=False)\n-        self.assertEqual(p.as_table(), \"\"\"<tr><th>Field1:</th><td><input type=\"text\" name=\"field1\" /></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr><th>Field1:</th><td><input type=\"text\" name=\"field1\" /></td></tr>\n <tr><th>Field2:</th><td><input type=\"text\" name=\"field2\" /></td></tr>\n <tr><th>Field3:</th><td><input type=\"text\" name=\"field3\" /></td></tr>\n <tr><th>Field4:</th><td><input type=\"text\" name=\"field4\" /></td></tr>\n@@ -932,7 +932,7 @@ class UserRegistration(Form):\n             address = CharField()                                 # no max_length defined here\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" maxlength=\"10\" /></li>\n <li>Realname: <input type=\"text\" name=\"realname\" maxlength=\"10\" /></li>\n <li>Address: <input type=\"text\" name=\"address\" /></li>\"\"\")\n@@ -945,7 +945,7 @@ class UserRegistration(Form):\n             password = CharField(max_length=10, widget=PasswordInput)\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" maxlength=\"10\" /></li>\"\"\")\n \n     def test_specifying_labels(self):\n@@ -958,7 +958,7 @@ class UserRegistration(Form):\n             password2 = CharField(widget=PasswordInput, label='Password (again)')\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Your username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Your username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li>Password1: <input type=\"password\" name=\"password1\" /></li>\n <li>Password (again): <input type=\"password\" name=\"password2\" /></li>\"\"\")\n \n@@ -971,12 +971,12 @@ class Questions(Form):\n             q4 = CharField(label='Answer this question!')\n             q5 = CharField(label='The last question. Period.')\n \n-        self.assertEqual(Questions(auto_id=False).as_p(), \"\"\"<p>The first question: <input type=\"text\" name=\"q1\" /></p>\n+        self.assertHTMLEqual(Questions(auto_id=False).as_p(), \"\"\"<p>The first question: <input type=\"text\" name=\"q1\" /></p>\n <p>What is your name? <input type=\"text\" name=\"q2\" /></p>\n <p>The answer to life is: <input type=\"text\" name=\"q3\" /></p>\n <p>Answer this question! <input type=\"text\" name=\"q4\" /></p>\n <p>The last question. Period. <input type=\"text\" name=\"q5\" /></p>\"\"\")\n-        self.assertEqual(Questions().as_p(), \"\"\"<p><label for=\"id_q1\">The first question:</label> <input type=\"text\" name=\"q1\" id=\"id_q1\" /></p>\n+        self.assertHTMLEqual(Questions().as_p(), \"\"\"<p><label for=\"id_q1\">The first question:</label> <input type=\"text\" name=\"q1\" id=\"id_q1\" /></p>\n <p><label for=\"id_q2\">What is your name?</label> <input type=\"text\" name=\"q2\" id=\"id_q2\" /></p>\n <p><label for=\"id_q3\">The answer to life is:</label> <input type=\"text\" name=\"q3\" id=\"id_q3\" /></p>\n <p><label for=\"id_q4\">Answer this question!</label> <input type=\"text\" name=\"q4\" id=\"id_q4\" /></p>\n@@ -988,18 +988,18 @@ class UserRegistration(Form):\n             password = CharField(widget=PasswordInput, label=u'\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111')\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), u'<li>\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\\n<li>\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111: <input type=\"password\" name=\"password\" /></li>')\n+        self.assertHTMLEqual(p.as_ul(), u'<li>\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\\n<li>\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111: <input type=\"password\" name=\"password\" /></li>')\n \n         # If a label is set to the empty string for a field, that field won't get a label.\n         class UserRegistration(Form):\n             username = CharField(max_length=10, label='')\n             password = CharField(widget=PasswordInput)\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li> <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li> <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n         p = UserRegistration(auto_id='id_%s')\n-        self.assertEqual(p.as_ul(), \"\"\"<li> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li><label for=\"id_password\">Password:</label> <input type=\"password\" name=\"password\" id=\"id_password\" /></li>\"\"\")\n \n         # If label is None, Django will auto-create the label from the field name. This\n@@ -1009,10 +1009,10 @@ class UserRegistration(Form):\n             password = CharField(widget=PasswordInput)\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n         p = UserRegistration(auto_id='id_%s')\n-        self.assertEqual(p.as_ul(), \"\"\"<li><label for=\"id_username\">Username:</label> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><label for=\"id_username\">Username:</label> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li><label for=\"id_password\">Password:</label> <input type=\"password\" name=\"password\" id=\"id_password\" /></li>\"\"\")\n \n     def test_label_suffix(self):\n@@ -1026,16 +1026,16 @@ class FavoriteForm(Form):\n             animal = CharField(label='Favorite animal')\n \n         f = FavoriteForm(auto_id=False)\n-        self.assertEqual(f.as_ul(), \"\"\"<li>Favorite color? <input type=\"text\" name=\"color\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), \"\"\"<li>Favorite color? <input type=\"text\" name=\"color\" /></li>\n <li>Favorite animal: <input type=\"text\" name=\"animal\" /></li>\"\"\")\n         f = FavoriteForm(auto_id=False, label_suffix='?')\n-        self.assertEqual(f.as_ul(), \"\"\"<li>Favorite color? <input type=\"text\" name=\"color\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), \"\"\"<li>Favorite color? <input type=\"text\" name=\"color\" /></li>\n <li>Favorite animal? <input type=\"text\" name=\"animal\" /></li>\"\"\")\n         f = FavoriteForm(auto_id=False, label_suffix='')\n-        self.assertEqual(f.as_ul(), \"\"\"<li>Favorite color? <input type=\"text\" name=\"color\" /></li>\n+        self.assertHTMLEqual(f.as_ul(), \"\"\"<li>Favorite color? <input type=\"text\" name=\"color\" /></li>\n <li>Favorite animal <input type=\"text\" name=\"animal\" /></li>\"\"\")\n         f = FavoriteForm(auto_id=False, label_suffix=u'\\u2192')\n-        self.assertEqual(f.as_ul(), u'<li>Favorite color? <input type=\"text\" name=\"color\" /></li>\\n<li>Favorite animal\\u2192 <input type=\"text\" name=\"animal\" /></li>')\n+        self.assertHTMLEqual(f.as_ul(), u'<li>Favorite color? <input type=\"text\" name=\"color\" /></li>\\n<li>Favorite animal\\u2192 <input type=\"text\" name=\"animal\" /></li>')\n \n     def test_initial_data(self):\n         # You can specify initial data for a field by using the 'initial' argument to a\n@@ -1049,18 +1049,18 @@ class UserRegistration(Form):\n \n         # Here, we're not submitting any data, so the initial value will be displayed.)\n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n \n         # Here, we're submitting data, so the initial value will *not* be displayed.\n         p = UserRegistration({}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n         p = UserRegistration({'username': u''}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n         p = UserRegistration({'username': u'foo'}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"foo\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"foo\" maxlength=\"10\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n \n         # An 'initial' value is *not* used as a fallback if data is not provided. In this\n@@ -1082,21 +1082,21 @@ class UserRegistration(Form):\n \n         # Here, we're not submitting any data, so the initial value will be displayed.)\n         p = UserRegistration(initial={'username': 'django'}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n         p = UserRegistration(initial={'username': 'stephane'}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"stephane\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"stephane\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n \n         # The 'initial' parameter is meaningless if you pass data.\n         p = UserRegistration({}, initial={'username': 'django'}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n         p = UserRegistration({'username': u''}, initial={'username': 'django'}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n         p = UserRegistration({'username': u'foo'}, initial={'username': 'django'}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"foo\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"foo\" maxlength=\"10\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n \n         # A dynamic 'initial' value is *not* used as a fallback if data is not provided.\n@@ -1113,7 +1113,7 @@ class UserRegistration(Form):\n             password = CharField(widget=PasswordInput)\n \n         p = UserRegistration(initial={'username': 'babik'}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"babik\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"babik\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" /></li>\"\"\")\n \n     def test_callable_initial_data(self):\n@@ -1139,7 +1139,7 @@ def initial_other_options():\n \n         # Here, we're not submitting any data, so the initial value will be displayed.)\n         p = UserRegistration(initial={'username': initial_django, 'options': initial_options}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" /></li>\n <li>Options: <select multiple=\"multiple\" name=\"options\">\n <option value=\"f\" selected=\"selected\">foo</option>\n@@ -1149,23 +1149,23 @@ def initial_other_options():\n \n         # The 'initial' parameter is meaningless if you pass data.\n         p = UserRegistration({}, initial={'username': initial_django, 'options': initial_options}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Options: <select multiple=\"multiple\" name=\"options\">\n <option value=\"f\">foo</option>\n <option value=\"b\">bar</option>\n <option value=\"w\">whiz</option>\n </select></li>\"\"\")\n         p = UserRegistration({'username': u''}, initial={'username': initial_django}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><ul class=\"errorlist\"><li>This field is required.</li></ul>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Options: <select multiple=\"multiple\" name=\"options\">\n <option value=\"f\">foo</option>\n <option value=\"b\">bar</option>\n <option value=\"w\">whiz</option>\n </select></li>\"\"\")\n         p = UserRegistration({'username': u'foo', 'options':['f','b']}, initial={'username': initial_django}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"foo\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"foo\" maxlength=\"10\" /></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /></li>\n <li>Options: <select multiple=\"multiple\" name=\"options\">\n <option value=\"f\" selected=\"selected\">foo</option>\n@@ -1188,15 +1188,15 @@ class UserRegistration(Form):\n            options = MultipleChoiceField(choices=[('f','foo'),('b','bar'),('w','whiz')], initial=initial_other_options)\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" /></li>\n <li>Options: <select multiple=\"multiple\" name=\"options\">\n <option value=\"f\">foo</option>\n <option value=\"b\" selected=\"selected\">bar</option>\n <option value=\"w\" selected=\"selected\">whiz</option>\n </select></li>\"\"\")\n         p = UserRegistration(initial={'username': initial_stephane, 'options': initial_options}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"stephane\" maxlength=\"10\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"stephane\" maxlength=\"10\" /></li>\n <li>Password: <input type=\"password\" name=\"password\" /></li>\n <li>Options: <select multiple=\"multiple\" name=\"options\">\n <option value=\"f\" selected=\"selected\">foo</option>\n@@ -1226,16 +1226,16 @@ class UserRegistration(Form):\n             password = CharField(widget=PasswordInput, help_text='Choose wisely.')\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /> <span class=\"helptext\">e.g., user@example.com</span></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /> <span class=\"helptext\">e.g., user@example.com</span></li>\n <li>Password: <input type=\"password\" name=\"password\" /> <span class=\"helptext\">Choose wisely.</span></li>\"\"\")\n-        self.assertEqual(p.as_p(), \"\"\"<p>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /> <span class=\"helptext\">e.g., user@example.com</span></p>\n+        self.assertHTMLEqual(p.as_p(), \"\"\"<p>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /> <span class=\"helptext\">e.g., user@example.com</span></p>\n <p>Password: <input type=\"password\" name=\"password\" /> <span class=\"helptext\">Choose wisely.</span></p>\"\"\")\n-        self.assertEqual(p.as_table(), \"\"\"<tr><th>Username:</th><td><input type=\"text\" name=\"username\" maxlength=\"10\" /><br /><span class=\"helptext\">e.g., user@example.com</span></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr><th>Username:</th><td><input type=\"text\" name=\"username\" maxlength=\"10\" /><br /><span class=\"helptext\">e.g., user@example.com</span></td></tr>\n <tr><th>Password:</th><td><input type=\"password\" name=\"password\" /><br /><span class=\"helptext\">Choose wisely.</span></td></tr>\"\"\")\n \n         # The help text is displayed whether or not data is provided for the form.\n         p = UserRegistration({'username': u'foo'}, auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"foo\" maxlength=\"10\" /> <span class=\"helptext\">e.g., user@example.com</span></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" value=\"foo\" maxlength=\"10\" /> <span class=\"helptext\">e.g., user@example.com</span></li>\n <li><ul class=\"errorlist\"><li>This field is required.</li></ul>Password: <input type=\"password\" name=\"password\" /> <span class=\"helptext\">Choose wisely.</span></li>\"\"\")\n \n         # help_text is not displayed for hidden fields. It can be used for documentation\n@@ -1246,15 +1246,15 @@ class UserRegistration(Form):\n             next = CharField(widget=HiddenInput, initial='/', help_text='Redirect destination')\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /> <span class=\"helptext\">e.g., user@example.com</span></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /> <span class=\"helptext\">e.g., user@example.com</span></li>\n <li>Password: <input type=\"password\" name=\"password\" /><input type=\"hidden\" name=\"next\" value=\"/\" /></li>\"\"\")\n \n         # Help text can include arbitrary Unicode characters.\n         class UserRegistration(Form):\n             username = CharField(max_length=10, help_text='Å ÄÄÅ½ÄÅ¾Å¡Ä')\n \n         p = UserRegistration(auto_id=False)\n-        self.assertEqual(p.as_ul(), u'<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /> <span class=\"helptext\">\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</span></li>')\n+        self.assertHTMLEqual(p.as_ul(), u'<li>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /> <span class=\"helptext\">\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</span></li>')\n \n     def test_subclassing_forms(self):\n         # You can subclass a Form to add fields. The resulting form subclass will have\n@@ -1269,11 +1269,11 @@ class Musician(Person):\n             instrument = CharField()\n \n         p = Person(auto_id=False)\n-        self.assertEqual(p.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n <li>Last name: <input type=\"text\" name=\"last_name\" /></li>\n <li>Birthday: <input type=\"text\" name=\"birthday\" /></li>\"\"\")\n         m = Musician(auto_id=False)\n-        self.assertEqual(m.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n+        self.assertHTMLEqual(m.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n <li>Last name: <input type=\"text\" name=\"last_name\" /></li>\n <li>Birthday: <input type=\"text\" name=\"birthday\" /></li>\n <li>Instrument: <input type=\"text\" name=\"instrument\" /></li>\"\"\")\n@@ -1292,7 +1292,7 @@ class Beatle(Person, Instrument):\n             haircut_type = CharField()\n \n         b = Beatle(auto_id=False)\n-        self.assertEqual(b.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n+        self.assertHTMLEqual(b.as_ul(), \"\"\"<li>First name: <input type=\"text\" name=\"first_name\" /></li>\n <li>Last name: <input type=\"text\" name=\"last_name\" /></li>\n <li>Birthday: <input type=\"text\" name=\"birthday\" /></li>\n <li>Instrument: <input type=\"text\" name=\"instrument\" /></li>\n@@ -1317,12 +1317,12 @@ class Person(Form):\n             'person1-birthday': u'1940-10-9'\n         }\n         p = Person(data, prefix='person1')\n-        self.assertEqual(p.as_ul(), \"\"\"<li><label for=\"id_person1-first_name\">First name:</label> <input type=\"text\" name=\"person1-first_name\" value=\"John\" id=\"id_person1-first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><label for=\"id_person1-first_name\">First name:</label> <input type=\"text\" name=\"person1-first_name\" value=\"John\" id=\"id_person1-first_name\" /></li>\n <li><label for=\"id_person1-last_name\">Last name:</label> <input type=\"text\" name=\"person1-last_name\" value=\"Lennon\" id=\"id_person1-last_name\" /></li>\n <li><label for=\"id_person1-birthday\">Birthday:</label> <input type=\"text\" name=\"person1-birthday\" value=\"1940-10-9\" id=\"id_person1-birthday\" /></li>\"\"\")\n-        self.assertEqual(str(p['first_name']), '<input type=\"text\" name=\"person1-first_name\" value=\"John\" id=\"id_person1-first_name\" />')\n-        self.assertEqual(str(p['last_name']), '<input type=\"text\" name=\"person1-last_name\" value=\"Lennon\" id=\"id_person1-last_name\" />')\n-        self.assertEqual(str(p['birthday']), '<input type=\"text\" name=\"person1-birthday\" value=\"1940-10-9\" id=\"id_person1-birthday\" />')\n+        self.assertHTMLEqual(str(p['first_name']), '<input type=\"text\" name=\"person1-first_name\" value=\"John\" id=\"id_person1-first_name\" />')\n+        self.assertHTMLEqual(str(p['last_name']), '<input type=\"text\" name=\"person1-last_name\" value=\"Lennon\" id=\"id_person1-last_name\" />')\n+        self.assertHTMLEqual(str(p['birthday']), '<input type=\"text\" name=\"person1-birthday\" value=\"1940-10-9\" id=\"id_person1-birthday\" />')\n         self.assertEqual(p.errors, {})\n         self.assertTrue(p.is_valid())\n         self.assertEqual(p.cleaned_data['first_name'], u'John')\n@@ -1393,7 +1393,7 @@ def add_prefix(self, field_name):\n                 return self.prefix and '%s-prefix-%s' % (self.prefix, field_name) or field_name\n \n         p = Person(prefix='foo')\n-        self.assertEqual(p.as_ul(), \"\"\"<li><label for=\"id_foo-prefix-first_name\">First name:</label> <input type=\"text\" name=\"foo-prefix-first_name\" id=\"id_foo-prefix-first_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li><label for=\"id_foo-prefix-first_name\">First name:</label> <input type=\"text\" name=\"foo-prefix-first_name\" id=\"id_foo-prefix-first_name\" /></li>\n <li><label for=\"id_foo-prefix-last_name\">Last name:</label> <input type=\"text\" name=\"foo-prefix-last_name\" id=\"id_foo-prefix-last_name\" /></li>\n <li><label for=\"id_foo-prefix-birthday\">Birthday:</label> <input type=\"text\" name=\"foo-prefix-birthday\" id=\"id_foo-prefix-birthday\" /></li>\"\"\")\n         data = {\n@@ -1415,37 +1415,37 @@ class Person(Form):\n             is_cool = NullBooleanField()\n \n         p = Person({'name': u'Joe'}, auto_id=False)\n-        self.assertEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n <option value=\"1\" selected=\"selected\">Unknown</option>\n <option value=\"2\">Yes</option>\n <option value=\"3\">No</option>\n </select>\"\"\")\n         p = Person({'name': u'Joe', 'is_cool': u'1'}, auto_id=False)\n-        self.assertEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n <option value=\"1\" selected=\"selected\">Unknown</option>\n <option value=\"2\">Yes</option>\n <option value=\"3\">No</option>\n </select>\"\"\")\n         p = Person({'name': u'Joe', 'is_cool': u'2'}, auto_id=False)\n-        self.assertEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n <option value=\"1\">Unknown</option>\n <option value=\"2\" selected=\"selected\">Yes</option>\n <option value=\"3\">No</option>\n </select>\"\"\")\n         p = Person({'name': u'Joe', 'is_cool': u'3'}, auto_id=False)\n-        self.assertEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n <option value=\"1\">Unknown</option>\n <option value=\"2\">Yes</option>\n <option value=\"3\" selected=\"selected\">No</option>\n </select>\"\"\")\n         p = Person({'name': u'Joe', 'is_cool': True}, auto_id=False)\n-        self.assertEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n <option value=\"1\">Unknown</option>\n <option value=\"2\" selected=\"selected\">Yes</option>\n <option value=\"3\">No</option>\n </select>\"\"\")\n         p = Person({'name': u'Joe', 'is_cool': False}, auto_id=False)\n-        self.assertEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(str(p['is_cool']), \"\"\"<select name=\"is_cool\">\n <option value=\"1\">Unknown</option>\n <option value=\"2\">Yes</option>\n <option value=\"3\" selected=\"selected\">No</option>\n@@ -1458,23 +1458,23 @@ class FileForm(Form):\n             file1 = FileField()\n \n         f = FileForm(auto_id=False)\n-        self.assertEqual(f.as_table(), '<tr><th>File1:</th><td><input type=\"file\" name=\"file1\" /></td></tr>')\n+        self.assertHTMLEqual(f.as_table(), '<tr><th>File1:</th><td><input type=\"file\" name=\"file1\" /></td></tr>')\n \n         f = FileForm(data={}, files={}, auto_id=False)\n-        self.assertEqual(f.as_table(), '<tr><th>File1:</th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"file\" name=\"file1\" /></td></tr>')\n+        self.assertHTMLEqual(f.as_table(), '<tr><th>File1:</th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"file\" name=\"file1\" /></td></tr>')\n \n         f = FileForm(data={}, files={'file1': SimpleUploadedFile('name', '')}, auto_id=False)\n-        self.assertEqual(f.as_table(), '<tr><th>File1:</th><td><ul class=\"errorlist\"><li>The submitted file is empty.</li></ul><input type=\"file\" name=\"file1\" /></td></tr>')\n+        self.assertHTMLEqual(f.as_table(), '<tr><th>File1:</th><td><ul class=\"errorlist\"><li>The submitted file is empty.</li></ul><input type=\"file\" name=\"file1\" /></td></tr>')\n \n         f = FileForm(data={}, files={'file1': 'something that is not a file'}, auto_id=False)\n-        self.assertEqual(f.as_table(), '<tr><th>File1:</th><td><ul class=\"errorlist\"><li>No file was submitted. Check the encoding type on the form.</li></ul><input type=\"file\" name=\"file1\" /></td></tr>')\n+        self.assertHTMLEqual(f.as_table(), '<tr><th>File1:</th><td><ul class=\"errorlist\"><li>No file was submitted. Check the encoding type on the form.</li></ul><input type=\"file\" name=\"file1\" /></td></tr>')\n \n         f = FileForm(data={}, files={'file1': SimpleUploadedFile('name', 'some content')}, auto_id=False)\n-        self.assertEqual(f.as_table(), '<tr><th>File1:</th><td><input type=\"file\" name=\"file1\" /></td></tr>')\n+        self.assertHTMLEqual(f.as_table(), '<tr><th>File1:</th><td><input type=\"file\" name=\"file1\" /></td></tr>')\n         self.assertTrue(f.is_valid())\n \n         f = FileForm(data={}, files={'file1': SimpleUploadedFile('æé»æ°£å¢è¹è£æ»¿æé±.txt', 'à¤®à¥à¤°à¥ à¤®à¤à¤¡à¤°à¤¾à¤¨à¥ à¤µà¤¾à¤²à¥ à¤¨à¤¾à¤µ à¤¸à¤°à¥à¤ªà¤®à¥à¤¨à¥à¤ à¤¸à¥ à¤­à¤°à¥ à¤¹')}, auto_id=False)\n-        self.assertEqual(f.as_table(), '<tr><th>File1:</th><td><input type=\"file\" name=\"file1\" /></td></tr>')\n+        self.assertHTMLEqual(f.as_table(), '<tr><th>File1:</th><td><input type=\"file\" name=\"file1\" /></td></tr>')\n \n     def test_basic_processing_in_view(self):\n         class UserRegistration(Form):\n@@ -1501,7 +1501,7 @@ def my_function(method, post_data):\n             return t.render(Context({'form': form}))\n \n         # Case 1: GET (an empty form, with no errors).)\n-        self.assertEqual(my_function('GET', {}), \"\"\"<form action=\"\" method=\"post\">\n+        self.assertHTMLEqual(my_function('GET', {}), \"\"\"<form action=\"\" method=\"post\">\n <table>\n <tr><th>Username:</th><td><input type=\"text\" name=\"username\" maxlength=\"10\" /></td></tr>\n <tr><th>Password1:</th><td><input type=\"password\" name=\"password1\" /></td></tr>\n@@ -1510,7 +1510,7 @@ def my_function(method, post_data):\n <input type=\"submit\" />\n </form>\"\"\")\n         # Case 2: POST with erroneous data (a redisplayed form, with errors).)\n-        self.assertEqual(my_function('POST', {'username': 'this-is-a-long-username', 'password1': 'foo', 'password2': 'bar'}), \"\"\"<form action=\"\" method=\"post\">\n+        self.assertHTMLEqual(my_function('POST', {'username': 'this-is-a-long-username', 'password1': 'foo', 'password2': 'bar'}), \"\"\"<form action=\"\" method=\"post\">\n <table>\n <tr><td colspan=\"2\"><ul class=\"errorlist\"><li>Please make sure your passwords match.</li></ul></td></tr>\n <tr><th>Username:</th><td><ul class=\"errorlist\"><li>Ensure this value has at most 10 characters (it has 23).</li></ul><input type=\"text\" name=\"username\" value=\"this-is-a-long-username\" maxlength=\"10\" /></td></tr>\n@@ -1520,7 +1520,7 @@ def my_function(method, post_data):\n <input type=\"submit\" />\n </form>\"\"\")\n         # Case 3: POST with valid data (the success message).)\n-        self.assertEqual(my_function('POST', {'username': 'adrian', 'password1': 'secret', 'password2': 'secret'}), \"VALID: {'username': u'adrian', 'password1': u'secret', 'password2': u'secret'}\")\n+        self.assertHTMLEqual(my_function('POST', {'username': 'adrian', 'password1': 'secret', 'password2': 'secret'}), \"VALID: {'username': u'adrian', 'password1': u'secret', 'password2': u'secret'}\")\n \n     def test_templates_with_forms(self):\n         class UserRegistration(Form):\n@@ -1545,13 +1545,13 @@ def clean(self):\n {{ form.password2.errors.as_ul }}<p><label>Password (again): {{ form.password2 }}</label></p>\n <input type=\"submit\" />\n </form>''')\n-        self.assertEqual(t.render(Context({'form': UserRegistration(auto_id=False)})), \"\"\"<form action=\"\">\n+        self.assertHTMLEqual(t.render(Context({'form': UserRegistration(auto_id=False)})), \"\"\"<form action=\"\">\n <p><label>Your username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></label></p>\n <p><label>Password: <input type=\"password\" name=\"password1\" /></label></p>\n <p><label>Password (again): <input type=\"password\" name=\"password2\" /></label></p>\n <input type=\"submit\" />\n </form>\"\"\")\n-        self.assertEqual(t.render(Context({'form': UserRegistration({'username': 'django'}, auto_id=False)})), \"\"\"<form action=\"\">\n+        self.assertHTMLEqual(t.render(Context({'form': UserRegistration({'username': 'django'}, auto_id=False)})), \"\"\"<form action=\"\">\n <p><label>Your username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></label></p>\n <ul class=\"errorlist\"><li>This field is required.</li></ul><p><label>Password: <input type=\"password\" name=\"password1\" /></label></p>\n <ul class=\"errorlist\"><li>This field is required.</li></ul><p><label>Password (again): <input type=\"password\" name=\"password2\" /></label></p>\n@@ -1568,7 +1568,7 @@ def clean(self):\n <p><label>{{ form.password2.label }}: {{ form.password2 }}</label></p>\n <input type=\"submit\" />\n </form>''')\n-        self.assertEqual(t.render(Context({'form': UserRegistration(auto_id=False)})), \"\"\"<form action=\"\">\n+        self.assertHTMLEqual(t.render(Context({'form': UserRegistration(auto_id=False)})), \"\"\"<form action=\"\">\n <p><label>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></label></p>\n <p><label>Password1: <input type=\"password\" name=\"password1\" /></label></p>\n <p><label>Password2: <input type=\"password\" name=\"password2\" /></label></p>\n@@ -1585,13 +1585,13 @@ def clean(self):\n <p>{{ form.password2.label_tag }}: {{ form.password2 }}</p>\n <input type=\"submit\" />\n </form>''')\n-        self.assertEqual(t.render(Context({'form': UserRegistration(auto_id=False)})), \"\"\"<form action=\"\">\n+        self.assertHTMLEqual(t.render(Context({'form': UserRegistration(auto_id=False)})), \"\"\"<form action=\"\">\n <p>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /></p>\n <p>Password1: <input type=\"password\" name=\"password1\" /></p>\n <p>Password2: <input type=\"password\" name=\"password2\" /></p>\n <input type=\"submit\" />\n </form>\"\"\")\n-        self.assertEqual(t.render(Context({'form': UserRegistration(auto_id='id_%s')})), \"\"\"<form action=\"\">\n+        self.assertHTMLEqual(t.render(Context({'form': UserRegistration(auto_id='id_%s')})), \"\"\"<form action=\"\">\n <p><label for=\"id_username\">Username</label>: <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></p>\n <p><label for=\"id_password1\">Password1</label>: <input type=\"password\" name=\"password1\" id=\"id_password1\" /></p>\n <p><label for=\"id_password2\">Password2</label>: <input type=\"password\" name=\"password2\" id=\"id_password2\" /></p>\n@@ -1606,7 +1606,7 @@ def clean(self):\n <p>{{ form.password2.label_tag }}: {{ form.password2 }}</p>\n <input type=\"submit\" />\n </form>''')\n-        self.assertEqual(t.render(Context({'form': UserRegistration(auto_id=False)})), \"\"\"<form action=\"\">\n+        self.assertHTMLEqual(t.render(Context({'form': UserRegistration(auto_id=False)})), \"\"\"<form action=\"\">\n <p>Username: <input type=\"text\" name=\"username\" maxlength=\"10\" /><br />Good luck picking a username that doesn&#39;t already exist.</p>\n <p>Password1: <input type=\"password\" name=\"password1\" /></p>\n <p>Password2: <input type=\"password\" name=\"password2\" /></p>\n@@ -1622,11 +1622,14 @@ def clean(self):\n         for bf in f:\n             form_output.append(bf.label_tag(attrs={'class': 'pretty'}))\n \n-        self.assertEqual(form_output, [\n+        expected_form_output = [\n             '<label for=\"id_username\" class=\"pretty\">Username</label>',\n             '<label for=\"id_password1\" class=\"pretty\">Password1</label>',\n             '<label for=\"id_password2\" class=\"pretty\">Password2</label>',\n-        ])\n+        ]\n+        self.assertEqual(len(form_output), len(expected_form_output))\n+        for i in range(len(form_output)):\n+            self.assertHTMLEqual(form_output[i], expected_form_output[i])\n \n         # To display the errors that aren't associated with a particular field -- e.g.,\n         # the errors caused by Form.clean() -- use {{ form.non_field_errors }} in the\n@@ -1638,7 +1641,7 @@ def clean(self):\n {{ form.password2.errors.as_ul }}<p><label>Password (again): {{ form.password2 }}</label></p>\n <input type=\"submit\" />\n </form>''')\n-        self.assertEqual(t.render(Context({'form': UserRegistration({'username': 'django', 'password1': 'foo', 'password2': 'bar'}, auto_id=False)})), \"\"\"<form action=\"\">\n+        self.assertHTMLEqual(t.render(Context({'form': UserRegistration({'username': 'django', 'password1': 'foo', 'password2': 'bar'}, auto_id=False)})), \"\"\"<form action=\"\">\n <p><label>Your username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></label></p>\n <p><label>Password: <input type=\"password\" name=\"password1\" /></label></p>\n <p><label>Password (again): <input type=\"password\" name=\"password2\" /></label></p>\n@@ -1651,7 +1654,7 @@ def clean(self):\n {{ form.password2.errors.as_ul }}<p><label>Password (again): {{ form.password2 }}</label></p>\n <input type=\"submit\" />\n </form>''')\n-        self.assertEqual(t.render(Context({'form': UserRegistration({'username': 'django', 'password1': 'foo', 'password2': 'bar'}, auto_id=False)})), \"\"\"<form action=\"\">\n+        self.assertHTMLEqual(t.render(Context({'form': UserRegistration({'username': 'django', 'password1': 'foo', 'password2': 'bar'}, auto_id=False)})), \"\"\"<form action=\"\">\n <ul class=\"errorlist\"><li>Please make sure your passwords match.</li></ul>\n <p><label>Your username: <input type=\"text\" name=\"username\" value=\"django\" maxlength=\"10\" /></label></p>\n <p><label>Password: <input type=\"password\" name=\"password1\" /></label></p>\n@@ -1727,7 +1730,7 @@ def test_hidden_initial_gets_id(self):\n         class MyForm(Form):\n             field1 = CharField(max_length=50, show_hidden_initial=True)\n \n-        self.assertEqual(MyForm().as_table(), '<tr><th><label for=\"id_field1\">Field1:</label></th><td><input id=\"id_field1\" type=\"text\" name=\"field1\" maxlength=\"50\" /><input type=\"hidden\" name=\"initial-field1\" id=\"initial-id_field1\" /></td></tr>')\n+        self.assertHTMLEqual(MyForm().as_table(), '<tr><th><label for=\"id_field1\">Field1:</label></th><td><input id=\"id_field1\" type=\"text\" name=\"field1\" maxlength=\"50\" /><input type=\"hidden\" name=\"initial-field1\" id=\"initial-id_field1\" /></td></tr>')\n \n     def test_error_html_required_html_classes(self):\n         class Person(Form):\n@@ -1740,7 +1743,7 @@ class Person(Form):\n         p.error_css_class = 'error'\n         p.required_css_class = 'required'\n \n-        self.assertEqual(p.as_ul(), \"\"\"<li class=\"required error\"><ul class=\"errorlist\"><li>This field is required.</li></ul><label for=\"id_name\">Name:</label> <input type=\"text\" name=\"name\" id=\"id_name\" /></li>\n+        self.assertHTMLEqual(p.as_ul(), \"\"\"<li class=\"required error\"><ul class=\"errorlist\"><li>This field is required.</li></ul><label for=\"id_name\">Name:</label> <input type=\"text\" name=\"name\" id=\"id_name\" /></li>\n <li class=\"required\"><label for=\"id_is_cool\">Is cool:</label> <select name=\"is_cool\" id=\"id_is_cool\">\n <option value=\"1\" selected=\"selected\">Unknown</option>\n <option value=\"2\">Yes</option>\n@@ -1749,7 +1752,7 @@ class Person(Form):\n <li><label for=\"id_email\">Email:</label> <input type=\"text\" name=\"email\" id=\"id_email\" /></li>\n <li class=\"required error\"><ul class=\"errorlist\"><li>This field is required.</li></ul><label for=\"id_age\">Age:</label> <input type=\"text\" name=\"age\" id=\"id_age\" /></li>\"\"\")\n \n-        self.assertEqual(p.as_p(), \"\"\"<ul class=\"errorlist\"><li>This field is required.</li></ul>\n+        self.assertHTMLEqual(p.as_p(), \"\"\"<ul class=\"errorlist\"><li>This field is required.</li></ul>\n <p class=\"required error\"><label for=\"id_name\">Name:</label> <input type=\"text\" name=\"name\" id=\"id_name\" /></p>\n <p class=\"required\"><label for=\"id_is_cool\">Is cool:</label> <select name=\"is_cool\" id=\"id_is_cool\">\n <option value=\"1\" selected=\"selected\">Unknown</option>\n@@ -1760,7 +1763,7 @@ class Person(Form):\n <ul class=\"errorlist\"><li>This field is required.</li></ul>\n <p class=\"required error\"><label for=\"id_age\">Age:</label> <input type=\"text\" name=\"age\" id=\"id_age\" /></p>\"\"\")\n \n-        self.assertEqual(p.as_table(), \"\"\"<tr class=\"required error\"><th><label for=\"id_name\">Name:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"name\" id=\"id_name\" /></td></tr>\n+        self.assertHTMLEqual(p.as_table(), \"\"\"<tr class=\"required error\"><th><label for=\"id_name\">Name:</label></th><td><ul class=\"errorlist\"><li>This field is required.</li></ul><input type=\"text\" name=\"name\" id=\"id_name\" /></td></tr>\n <tr class=\"required\"><th><label for=\"id_is_cool\">Is cool:</label></th><td><select name=\"is_cool\" id=\"id_is_cool\">\n <option value=\"1\" selected=\"selected\">Unknown</option>\n <option value=\"2\">Yes</option>\n@@ -1774,4 +1777,4 @@ class EventForm(Form):\n             happened_at = SplitDateTimeField(widget=widgets.SplitHiddenDateTimeWidget)\n \n         form = EventForm()\n-        self.assertEqual(form.as_ul(), u'<input type=\"hidden\" name=\"happened_at_0\" id=\"id_happened_at_0\" /><input type=\"hidden\" name=\"happened_at_1\" id=\"id_happened_at_1\" />')\n+        self.assertHTMLEqual(form.as_ul(), u'<input type=\"hidden\" name=\"happened_at_0\" id=\"id_happened_at_0\" /><input type=\"hidden\" name=\"happened_at_1\" id=\"id_happened_at_1\" />')"
        },
        {
            "sha": "05ef978c4504581924d935b5b0aecd7ef07977be",
            "filename": "tests/regressiontests/forms/tests/formsets.py",
            "status": "modified",
            "additions": 19,
            "deletions": 19,
            "changes": 38,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -1,7 +1,7 @@\n # -*- coding: utf-8 -*-\n from django.forms import Form, CharField, IntegerField, ValidationError, DateField\n from django.forms.formsets import formset_factory, BaseFormSet\n-from django.utils.unittest import TestCase\n+from django.test import TestCase\n \n \n class Choice(Form):\n@@ -47,7 +47,7 @@ def test_basic_formset(self):\n         # for adding data. By default, it displays 1 blank form. It can display more,\n         # but we'll look at how to do so later.\n         formset = ChoiceFormSet(auto_id=False, prefix='choices')\n-        self.assertEqual(str(formset), \"\"\"<input type=\"hidden\" name=\"choices-TOTAL_FORMS\" value=\"1\" /><input type=\"hidden\" name=\"choices-INITIAL_FORMS\" value=\"0\" /><input type=\"hidden\" name=\"choices-MAX_NUM_FORMS\" />\n+        self.assertHTMLEqual(str(formset), \"\"\"<input type=\"hidden\" name=\"choices-TOTAL_FORMS\" value=\"1\" /><input type=\"hidden\" name=\"choices-INITIAL_FORMS\" value=\"0\" /><input type=\"hidden\" name=\"choices-MAX_NUM_FORMS\" />\n <tr><th>Choice:</th><td><input type=\"text\" name=\"choices-0-choice\" /></td></tr>\n <tr><th>Votes:</th><td><input type=\"text\" name=\"choices-0-votes\" /></td></tr>\"\"\")\n \n@@ -132,7 +132,7 @@ def test_formset_initial_data(self):\n         for form in formset.forms:\n             form_output.append(form.as_ul())\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-0-votes\" value=\"100\" /></li>\n <li>Choice: <input type=\"text\" name=\"choices-1-choice\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-1-votes\" /></li>\"\"\")\n@@ -205,7 +205,7 @@ def test_displaying_more_than_one_blank_form(self):\n         for form in formset.forms:\n             form_output.append(form.as_ul())\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" /></li>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-0-votes\" /></li>\n <li>Choice: <input type=\"text\" name=\"choices-1-choice\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-1-votes\" /></li>\n@@ -296,7 +296,7 @@ def test_more_initial_data(self):\n         for form in formset.forms:\n             form_output.append(form.as_ul())\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-0-votes\" value=\"100\" /></li>\n <li>Choice: <input type=\"text\" name=\"choices-1-choice\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-1-votes\" /></li>\n@@ -308,7 +308,7 @@ def test_more_initial_data(self):\n         # Make sure retrieving an empty form works, and it shows up in the form list\n \n         self.assertTrue(formset.empty_form.empty_permitted)\n-        self.assertEqual(formset.empty_form.as_ul(), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-__prefix__-choice\" /></li>\n+        self.assertHTMLEqual(formset.empty_form.as_ul(), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-__prefix__-choice\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-__prefix__-votes\" /></li>\"\"\")\n \n     def test_formset_with_deletion(self):\n@@ -326,7 +326,7 @@ def test_formset_with_deletion(self):\n         for form in formset.forms:\n             form_output.append(form.as_ul())\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-0-votes\" value=\"100\" /></li>\n <li>Delete: <input type=\"checkbox\" name=\"choices-0-DELETE\" /></li>\n <li>Choice: <input type=\"text\" name=\"choices-1-choice\" value=\"Fergie\" /></li>\n@@ -423,7 +423,7 @@ def test_formsets_with_ordering(self):\n         for form in formset.forms:\n             form_output.append(form.as_ul())\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-0-votes\" value=\"100\" /></li>\n <li>Order: <input type=\"text\" name=\"choices-0-ORDER\" value=\"1\" /></li>\n <li>Choice: <input type=\"text\" name=\"choices-1-choice\" value=\"Fergie\" /></li>\n@@ -534,7 +534,7 @@ def test_formset_with_ordering_and_deletion(self):\n         for form in formset.forms:\n             form_output.append(form.as_ul())\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-0-votes\" value=\"100\" /></li>\n <li>Order: <input type=\"text\" name=\"choices-0-ORDER\" value=\"1\" /></li>\n <li>Delete: <input type=\"checkbox\" name=\"choices-0-DELETE\" /></li>\n@@ -660,7 +660,7 @@ def test_limiting_max_forms(self):\n         for form in formset.forms:\n             form_output.append(str(form))\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" id=\"id_form-0-name\" /></td></tr>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" id=\"id_form-0-name\" /></td></tr>\n <tr><th><label for=\"id_form-1-name\">Name:</label></th><td><input type=\"text\" name=\"form-1-name\" id=\"id_form-1-name\" /></td></tr>\n <tr><th><label for=\"id_form-2-name\">Name:</label></th><td><input type=\"text\" name=\"form-2-name\" id=\"id_form-2-name\" /></td></tr>\"\"\")\n \n@@ -681,7 +681,7 @@ def test_limiting_max_forms(self):\n         for form in formset.forms:\n             form_output.append(str(form))\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" id=\"id_form-0-name\" /></td></tr>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" id=\"id_form-0-name\" /></td></tr>\n <tr><th><label for=\"id_form-1-name\">Name:</label></th><td><input type=\"text\" name=\"form-1-name\" id=\"id_form-1-name\" /></td></tr>\"\"\")\n \n         # Ensure that max_num has no effect when extra is less than max_num.\n@@ -693,7 +693,7 @@ def test_limiting_max_forms(self):\n         for form in formset.forms:\n             form_output.append(str(form))\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" id=\"id_form-0-name\" /></td></tr>\"\"\")\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" id=\"id_form-0-name\" /></td></tr>\"\"\")\n \n     def test_max_num_with_initial_data(self):\n         # max_num with initial data\n@@ -712,7 +712,7 @@ def test_max_num_with_initial_data(self):\n         for form in formset.forms:\n             form_output.append(str(form))\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" value=\"Fernet and Coke\" id=\"id_form-0-name\" /></td></tr>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" value=\"Fernet and Coke\" id=\"id_form-0-name\" /></td></tr>\n <tr><th><label for=\"id_form-1-name\">Name:</label></th><td><input type=\"text\" name=\"form-1-name\" id=\"id_form-1-name\" /></td></tr>\"\"\")\n \n     def test_max_num_zero(self):\n@@ -748,7 +748,7 @@ def test_more_initial_than_max_num(self):\n         for form in formset.forms:\n             form_output.append(str(form))\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" value=\"Gin Tonic\" id=\"id_form-0-name\" /></td></tr>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" value=\"Gin Tonic\" id=\"id_form-0-name\" /></td></tr>\n <tr><th><label for=\"id_form-1-name\">Name:</label></th><td><input type=\"text\" name=\"form-1-name\" value=\"Bloody Mary\" id=\"id_form-1-name\" /></td></tr>\"\"\")\n \n         # One form from initial and extra=3 with max_num=2 should result in the one\n@@ -763,7 +763,7 @@ def test_more_initial_than_max_num(self):\n         for form in formset.forms:\n             form_output.append(str(form))\n \n-        self.assertEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" value=\"Gin Tonic\" id=\"id_form-0-name\" /></td></tr>\n+        self.assertHTMLEqual('\\n'.join(form_output), \"\"\"<tr><th><label for=\"id_form-0-name\">Name:</label></th><td><input type=\"text\" name=\"form-0-name\" value=\"Gin Tonic\" id=\"id_form-0-name\" /></td></tr>\n <tr><th><label for=\"id_form-1-name\">Name:</label></th><td><input type=\"text\" name=\"form-1-name\" id=\"id_form-1-name\" /></td></tr>\"\"\")\n \n     def test_regression_6926(self):\n@@ -862,19 +862,19 @@ class Choice(Form):\n class FormsetAsFooTests(TestCase):\n     def test_as_table(self):\n         formset = ChoiceFormSet(data, auto_id=False, prefix='choices')\n-        self.assertEqual(formset.as_table(),\"\"\"<input type=\"hidden\" name=\"choices-TOTAL_FORMS\" value=\"1\" /><input type=\"hidden\" name=\"choices-INITIAL_FORMS\" value=\"0\" /><input type=\"hidden\" name=\"choices-MAX_NUM_FORMS\" value=\"0\" />\n+        self.assertHTMLEqual(formset.as_table(),\"\"\"<input type=\"hidden\" name=\"choices-TOTAL_FORMS\" value=\"1\" /><input type=\"hidden\" name=\"choices-INITIAL_FORMS\" value=\"0\" /><input type=\"hidden\" name=\"choices-MAX_NUM_FORMS\" value=\"0\" />\n <tr><th>Choice:</th><td><input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></td></tr>\n <tr><th>Votes:</th><td><input type=\"text\" name=\"choices-0-votes\" value=\"100\" /></td></tr>\"\"\")\n \n     def test_as_p(self):\n         formset = ChoiceFormSet(data, auto_id=False, prefix='choices')\n-        self.assertEqual(formset.as_p(),\"\"\"<input type=\"hidden\" name=\"choices-TOTAL_FORMS\" value=\"1\" /><input type=\"hidden\" name=\"choices-INITIAL_FORMS\" value=\"0\" /><input type=\"hidden\" name=\"choices-MAX_NUM_FORMS\" value=\"0\" />\n+        self.assertHTMLEqual(formset.as_p(),\"\"\"<input type=\"hidden\" name=\"choices-TOTAL_FORMS\" value=\"1\" /><input type=\"hidden\" name=\"choices-INITIAL_FORMS\" value=\"0\" /><input type=\"hidden\" name=\"choices-MAX_NUM_FORMS\" value=\"0\" />\n <p>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></p>\n <p>Votes: <input type=\"text\" name=\"choices-0-votes\" value=\"100\" /></p>\"\"\")\n \n     def test_as_ul(self):\n         formset = ChoiceFormSet(data, auto_id=False, prefix='choices')\n-        self.assertEqual(formset.as_ul(),\"\"\"<input type=\"hidden\" name=\"choices-TOTAL_FORMS\" value=\"1\" /><input type=\"hidden\" name=\"choices-INITIAL_FORMS\" value=\"0\" /><input type=\"hidden\" name=\"choices-MAX_NUM_FORMS\" value=\"0\" />\n+        self.assertHTMLEqual(formset.as_ul(),\"\"\"<input type=\"hidden\" name=\"choices-TOTAL_FORMS\" value=\"1\" /><input type=\"hidden\" name=\"choices-INITIAL_FORMS\" value=\"0\" /><input type=\"hidden\" name=\"choices-MAX_NUM_FORMS\" value=\"0\" />\n <li>Choice: <input type=\"text\" name=\"choices-0-choice\" value=\"Calexico\" /></li>\n <li>Votes: <input type=\"text\" name=\"choices-0-votes\" value=\"100\" /></li>\"\"\")\n \n@@ -938,7 +938,7 @@ def test_empty_forms_are_unbound(self):\n         self.assertFalse(empty_forms[1].is_bound)\n \n         # The empty forms should be equal.\n-        self.assertEqual(empty_forms[0].as_p(), empty_forms[1].as_p())\n+        self.assertHTMLEqual(empty_forms[0].as_p(), empty_forms[1].as_p())\n \n class TestEmptyFormSet(TestCase):\n     \"Test that an empty formset still calls clean()\""
        },
        {
            "sha": "b5e2c3a885b47472c6bfc620f9d02bb2437ed6a7",
            "filename": "tests/regressiontests/forms/tests/models.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fmodels.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -47,7 +47,7 @@ def test_callable_initial_value(self):\n         obj1 = ChoiceOptionModel.objects.create(id=1, name='default')\n         obj2 = ChoiceOptionModel.objects.create(id=2, name='option 2')\n         obj3 = ChoiceOptionModel.objects.create(id=3, name='option 3')\n-        self.assertEqual(ChoiceFieldForm().as_p(), \"\"\"<p><label for=\"id_choice\">Choice:</label> <select name=\"choice\" id=\"id_choice\">\n+        self.assertHTMLEqual(ChoiceFieldForm().as_p(), \"\"\"<p><label for=\"id_choice\">Choice:</label> <select name=\"choice\" id=\"id_choice\">\n <option value=\"1\" selected=\"selected\">ChoiceOption 1</option>\n <option value=\"2\">ChoiceOption 2</option>\n <option value=\"3\">ChoiceOption 3</option>\n@@ -73,7 +73,7 @@ def test_initial_instance_value(self):\n         obj1 = ChoiceOptionModel.objects.create(id=1, name='default')\n         obj2 = ChoiceOptionModel.objects.create(id=2, name='option 2')\n         obj3 = ChoiceOptionModel.objects.create(id=3, name='option 3')\n-        self.assertEqual(ChoiceFieldForm(initial={\n+        self.assertHTMLEqual(ChoiceFieldForm(initial={\n                 'choice': obj2,\n                 'choice_int': obj2,\n                 'multi_choice': [obj2,obj3],"
        },
        {
            "sha": "a93781da20b57fe2de008f8ee194066e802cf47c",
            "filename": "tests/regressiontests/forms/tests/regressions.py",
            "status": "modified",
            "additions": 14,
            "deletions": 14,
            "changes": 28,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fregressions.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fregressions.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fregressions.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -1,7 +1,7 @@\n # -*- coding: utf-8 -*-\n from __future__ import with_statement\n from django.forms import *\n-from django.utils.unittest import TestCase\n+from django.test import TestCase\n from django.utils.translation import ugettext_lazy, override\n \n from regressiontests.forms.models import Cheese\n@@ -16,7 +16,7 @@ class TestForm(Form):\n             f1 = CharField(max_length=10, widget=TextInput(attrs=extra_attrs))\n             f2 = CharField(widget=TextInput(attrs=extra_attrs))\n \n-        self.assertEqual(TestForm(auto_id=False).as_p(), u'<p>F1: <input type=\"text\" class=\"special\" name=\"f1\" maxlength=\"10\" /></p>\\n<p>F2: <input type=\"text\" class=\"special\" name=\"f2\" /></p>')\n+        self.assertHTMLEqual(TestForm(auto_id=False).as_p(), u'<p>F1: <input type=\"text\" class=\"special\" name=\"f1\" maxlength=\"10\" /></p>\\n<p>F2: <input type=\"text\" class=\"special\" name=\"f2\" /></p>')\n \n     def test_regression_3600(self):\n         # Tests for form i18n #\n@@ -26,13 +26,13 @@ class SomeForm(Form):\n             username = CharField(max_length=10, label=ugettext_lazy('Username'))\n \n         f = SomeForm()\n-        self.assertEqual(f.as_p(), '<p><label for=\"id_username\">Username:</label> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></p>')\n+        self.assertHTMLEqual(f.as_p(), '<p><label for=\"id_username\">Username:</label> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></p>')\n \n         # Translations are done at rendering time, so multi-lingual apps can define forms)\n         with override('de'):\n-            self.assertEqual(f.as_p(), '<p><label for=\"id_username\">Benutzername:</label> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></p>')\n+            self.assertHTMLEqual(f.as_p(), '<p><label for=\"id_username\">Benutzername:</label> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></p>')\n         with override('pl', deactivate=True):\n-            self.assertEqual(f.as_p(), u'<p><label for=\"id_username\">Nazwa u\\u017cytkownika:</label> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></p>')\n+            self.assertHTMLEqual(f.as_p(), u'<p><label for=\"id_username\">Nazwa u\\u017cytkownika:</label> <input id=\"id_username\" type=\"text\" name=\"username\" maxlength=\"10\" /></p>')\n \n     def test_regression_5216(self):\n         # There was some problems with form translations in #5216\n@@ -41,8 +41,8 @@ class SomeForm(Form):\n             field_2 = CharField(max_length=10, label=ugettext_lazy('field_2'), widget=TextInput(attrs={'id': 'field_2_id'}))\n \n         f = SomeForm()\n-        self.assertEqual(f['field_1'].label_tag(), '<label for=\"id_field_1\">field_1</label>')\n-        self.assertEqual(f['field_2'].label_tag(), '<label for=\"field_2_id\">field_2</label>')\n+        self.assertHTMLEqual(f['field_1'].label_tag(), '<label for=\"id_field_1\">field_1</label>')\n+        self.assertHTMLEqual(f['field_2'].label_tag(), '<label for=\"field_2_id\">field_2</label>')\n \n         # Unicode decoding problems...\n         GENDERS = ((u'\\xc5', u'En tied\\xe4'), (u'\\xf8', u'Mies'), (u'\\xdf', u'Nainen'))\n@@ -51,7 +51,7 @@ class SomeForm(Form):\n             somechoice = ChoiceField(choices=GENDERS, widget=RadioSelect(), label=u'\\xc5\\xf8\\xdf')\n \n         f = SomeForm()\n-        self.assertEqual(f.as_p(), u'<p><label for=\"id_somechoice_0\">\\xc5\\xf8\\xdf:</label> <ul>\\n<li><label for=\"id_somechoice_0\"><input type=\"radio\" id=\"id_somechoice_0\" value=\"\\xc5\" name=\"somechoice\" /> En tied\\xe4</label></li>\\n<li><label for=\"id_somechoice_1\"><input type=\"radio\" id=\"id_somechoice_1\" value=\"\\xf8\" name=\"somechoice\" /> Mies</label></li>\\n<li><label for=\"id_somechoice_2\"><input type=\"radio\" id=\"id_somechoice_2\" value=\"\\xdf\" name=\"somechoice\" /> Nainen</label></li>\\n</ul></p>')\n+        self.assertHTMLEqual(f.as_p(), u'<p><label for=\"id_somechoice_0\">\\xc5\\xf8\\xdf:</label> <ul>\\n<li><label for=\"id_somechoice_0\"><input type=\"radio\" id=\"id_somechoice_0\" value=\"\\xc5\" name=\"somechoice\" /> En tied\\xe4</label></li>\\n<li><label for=\"id_somechoice_1\"><input type=\"radio\" id=\"id_somechoice_1\" value=\"\\xf8\" name=\"somechoice\" /> Mies</label></li>\\n<li><label for=\"id_somechoice_2\"><input type=\"radio\" id=\"id_somechoice_2\" value=\"\\xdf\" name=\"somechoice\" /> Nainen</label></li>\\n</ul></p>')\n \n         # Testing choice validation with UTF-8 bytestrings as input (these are the\n         # Russian abbreviations \"Ð¼ÐµÑ.\" and \"ÑÑ.\".\n@@ -63,7 +63,7 @@ class SomeForm(Form):\n         # Translated error messages used to be buggy.\n         with override('ru'):\n             f = SomeForm({})\n-            self.assertEqual(f.as_p(), u'<ul class=\"errorlist\"><li>\\u041e\\u0431\\u044f\\u0437\\u0430\\u0442\\u0435\\u043b\\u044c\\u043d\\u043e\\u0435 \\u043f\\u043e\\u043b\\u0435.</li></ul>\\n<p><label for=\"id_somechoice_0\">\\xc5\\xf8\\xdf:</label> <ul>\\n<li><label for=\"id_somechoice_0\"><input type=\"radio\" id=\"id_somechoice_0\" value=\"\\xc5\" name=\"somechoice\" /> En tied\\xe4</label></li>\\n<li><label for=\"id_somechoice_1\"><input type=\"radio\" id=\"id_somechoice_1\" value=\"\\xf8\" name=\"somechoice\" /> Mies</label></li>\\n<li><label for=\"id_somechoice_2\"><input type=\"radio\" id=\"id_somechoice_2\" value=\"\\xdf\" name=\"somechoice\" /> Nainen</label></li>\\n</ul></p>')\n+            self.assertHTMLEqual(f.as_p(), u'<ul class=\"errorlist\"><li>\\u041e\\u0431\\u044f\\u0437\\u0430\\u0442\\u0435\\u043b\\u044c\\u043d\\u043e\\u0435 \\u043f\\u043e\\u043b\\u0435.</li></ul>\\n<p><label for=\"id_somechoice_0\">\\xc5\\xf8\\xdf:</label> <ul>\\n<li><label for=\"id_somechoice_0\"><input type=\"radio\" id=\"id_somechoice_0\" value=\"\\xc5\" name=\"somechoice\" /> En tied\\xe4</label></li>\\n<li><label for=\"id_somechoice_1\"><input type=\"radio\" id=\"id_somechoice_1\" value=\"\\xf8\" name=\"somechoice\" /> Mies</label></li>\\n<li><label for=\"id_somechoice_2\"><input type=\"radio\" id=\"id_somechoice_2\" value=\"\\xdf\" name=\"somechoice\" /> Nainen</label></li>\\n</ul></p>')\n \n         # Deep copying translated text shouldn't raise an error)\n         from django.utils.translation import gettext_lazy\n@@ -88,8 +88,8 @@ class HiddenForm(Form):\n             data = IntegerField(widget=HiddenInput)\n \n         f = HiddenForm({})\n-        self.assertEqual(f.as_p(), u'<ul class=\"errorlist\"><li>(Hidden field data) This field is required.</li></ul>\\n<p> <input type=\"hidden\" name=\"data\" id=\"id_data\" /></p>')\n-        self.assertEqual(f.as_table(), u'<tr><td colspan=\"2\"><ul class=\"errorlist\"><li>(Hidden field data) This field is required.</li></ul><input type=\"hidden\" name=\"data\" id=\"id_data\" /></td></tr>')\n+        self.assertHTMLEqual(f.as_p(), u'<ul class=\"errorlist\"><li>(Hidden field data) This field is required.</li></ul>\\n<p> <input type=\"hidden\" name=\"data\" id=\"id_data\" /></p>')\n+        self.assertHTMLEqual(f.as_table(), u'<tr><td colspan=\"2\"><ul class=\"errorlist\"><li>(Hidden field data) This field is required.</li></ul><input type=\"hidden\" name=\"data\" id=\"id_data\" /></td></tr>')\n \n     def test_xss_error_messages(self):\n         ###################################################\n@@ -107,21 +107,21 @@ class SomeForm(Form):\n             field = ChoiceField(choices=[('one', 'One')])\n \n         f = SomeForm({'field': '<script>'})\n-        self.assertEqual(t.render(Context({'form': f})), u'<ul class=\"errorlist\"><li>field<ul class=\"errorlist\"><li>Select a valid choice. &lt;script&gt; is not one of the available choices.</li></ul></li></ul>')\n+        self.assertHTMLEqual(t.render(Context({'form': f})), u'<ul class=\"errorlist\"><li>field<ul class=\"errorlist\"><li>Select a valid choice. &lt;script&gt; is not one of the available choices.</li></ul></li></ul>')\n \n         class SomeForm(Form):\n             field = MultipleChoiceField(choices=[('one', 'One')])\n \n         f = SomeForm({'field': ['<script>']})\n-        self.assertEqual(t.render(Context({'form': f})), u'<ul class=\"errorlist\"><li>field<ul class=\"errorlist\"><li>Select a valid choice. &lt;script&gt; is not one of the available choices.</li></ul></li></ul>')\n+        self.assertHTMLEqual(t.render(Context({'form': f})), u'<ul class=\"errorlist\"><li>field<ul class=\"errorlist\"><li>Select a valid choice. &lt;script&gt; is not one of the available choices.</li></ul></li></ul>')\n \n         from regressiontests.forms.models import ChoiceModel\n \n         class SomeForm(Form):\n             field = ModelMultipleChoiceField(ChoiceModel.objects.all())\n \n         f = SomeForm({'field': ['<script>']})\n-        self.assertEqual(t.render(Context({'form': f})), u'<ul class=\"errorlist\"><li>field<ul class=\"errorlist\"><li>&quot;&lt;script&gt;&quot; is not a valid value for a primary key.</li></ul></li></ul>')\n+        self.assertHTMLEqual(t.render(Context({'form': f})), u'<ul class=\"errorlist\"><li>field<ul class=\"errorlist\"><li>&quot;&lt;script&gt;&quot; is not a valid value for a primary key.</li></ul></li></ul>')\n \n     def test_regression_14234(self):\n         \"\"\""
        },
        {
            "sha": "dddb8c7e56d862f43a320ea78812accb2041a635",
            "filename": "tests/regressiontests/forms/tests/util.py",
            "status": "modified",
            "additions": 14,
            "deletions": 13,
            "changes": 27,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Futil.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Futil.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Futil.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -1,8 +1,9 @@\n # -*- coding: utf-8 -*-\n from django.core.exceptions import ValidationError\n-from django.forms.util import *\n+from django.forms.util import flatatt, ErrorDict, ErrorList\n+from django.test import TestCase\n+from django.utils.safestring import mark_safe\n from django.utils.translation import ugettext_lazy\n-from django.utils.unittest import TestCase\n \n \n class FormsUtilTestCase(TestCase):\n@@ -23,39 +24,39 @@ def test_validation_error(self):\n         ###################\n \n         # Can take a string.\n-        self.assertEqual(str(ErrorList(ValidationError(\"There was an error.\").messages)),\n+        self.assertHTMLEqual(str(ErrorList(ValidationError(\"There was an error.\").messages)),\n                          '<ul class=\"errorlist\"><li>There was an error.</li></ul>')\n \n         # Can take a unicode string.\n-        self.assertEqual(str(ErrorList(ValidationError(u\"Not \\u03C0.\").messages)),\n-                         '<ul class=\"errorlist\"><li>Not Ï.</li></ul>')\n+        self.assertHTMLEqual(unicode(ErrorList(ValidationError(u\"Not \\u03C0.\").messages)),\n+                         u'<ul class=\"errorlist\"><li>Not Ï.</li></ul>')\n \n         # Can take a lazy string.\n-        self.assertEqual(str(ErrorList(ValidationError(ugettext_lazy(\"Error.\")).messages)),\n+        self.assertHTMLEqual(str(ErrorList(ValidationError(ugettext_lazy(\"Error.\")).messages)),\n                          '<ul class=\"errorlist\"><li>Error.</li></ul>')\n \n         # Can take a list.\n-        self.assertEqual(str(ErrorList(ValidationError([\"Error one.\", \"Error two.\"]).messages)),\n+        self.assertHTMLEqual(str(ErrorList(ValidationError([\"Error one.\", \"Error two.\"]).messages)),\n                          '<ul class=\"errorlist\"><li>Error one.</li><li>Error two.</li></ul>')\n \n         # Can take a mixture in a list.\n-        self.assertEqual(str(ErrorList(ValidationError([\"First error.\", u\"Not \\u03C0.\", ugettext_lazy(\"Error.\")]).messages)),\n+        self.assertHTMLEqual(str(ErrorList(ValidationError([\"First error.\", u\"Not \\u03C0.\", ugettext_lazy(\"Error.\")]).messages)),\n                          '<ul class=\"errorlist\"><li>First error.</li><li>Not Ï.</li><li>Error.</li></ul>')\n \n         class VeryBadError:\n             def __unicode__(self): return u\"A very bad error.\"\n \n         # Can take a non-string.\n-        self.assertEqual(str(ErrorList(ValidationError(VeryBadError()).messages)),\n+        self.assertHTMLEqual(str(ErrorList(ValidationError(VeryBadError()).messages)),\n                          '<ul class=\"errorlist\"><li>A very bad error.</li></ul>')\n \n         # Escapes non-safe input but not input marked safe.\n         example = 'Example of link: <a href=\"http://www.example.com/\">example</a>'\n-        self.assertEqual(str(ErrorList([example])),\n+        self.assertHTMLEqual(str(ErrorList([example])),\n                          '<ul class=\"errorlist\"><li>Example of link: &lt;a href=&quot;http://www.example.com/&quot;&gt;example&lt;/a&gt;</li></ul>')\n-        self.assertEqual(str(ErrorList([mark_safe(example)])),\n+        self.assertHTMLEqual(str(ErrorList([mark_safe(example)])),\n                          '<ul class=\"errorlist\"><li>Example of link: <a href=\"http://www.example.com/\">example</a></li></ul>')\n-        self.assertEqual(str(ErrorDict({'name': example})),\n+        self.assertHTMLEqual(str(ErrorDict({'name': example})),\n                          '<ul class=\"errorlist\"><li>nameExample of link: &lt;a href=&quot;http://www.example.com/&quot;&gt;example&lt;/a&gt;</li></ul>')\n-        self.assertEqual(str(ErrorDict({'name': mark_safe(example)})),\n+        self.assertHTMLEqual(str(ErrorDict({'name': mark_safe(example)})),\n                          '<ul class=\"errorlist\"><li>nameExample of link: <a href=\"http://www.example.com/\">example</a></li></ul>')"
        },
        {
            "sha": "ce15b8b708aebbf793f525fd6d509041866b74fd",
            "filename": "tests/regressiontests/forms/tests/widgets.py",
            "status": "modified",
            "additions": 202,
            "deletions": 202,
            "changes": 404,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -10,7 +10,7 @@\n from django.utils import formats\n from django.utils.safestring import mark_safe\n from django.utils.translation import activate, deactivate\n-from django.utils.unittest import TestCase\n+from django.test import TestCase\n \n \n class FormsWidgetTestCase(TestCase):\n@@ -19,129 +19,129 @@ class FormsWidgetTestCase(TestCase):\n     # validation.\n     def test_textinput(self):\n         w = TextInput()\n-        self.assertEqual(w.render('email', ''), u'<input type=\"text\" name=\"email\" />')\n-        self.assertEqual(w.render('email', None), u'<input type=\"text\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'test@example.com'), u'<input type=\"text\" name=\"email\" value=\"test@example.com\" />')\n-        self.assertEqual(w.render('email', 'some \"quoted\" & ampersanded value'), u'<input type=\"text\" name=\"email\" value=\"some &quot;quoted&quot; &amp; ampersanded value\" />')\n-        self.assertEqual(w.render('email', 'test@example.com', attrs={'class': 'fun'}), u'<input type=\"text\" name=\"email\" value=\"test@example.com\" class=\"fun\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input type=\"text\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', None), u'<input type=\"text\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'test@example.com'), u'<input type=\"text\" name=\"email\" value=\"test@example.com\" />')\n+        self.assertHTMLEqual(w.render('email', 'some \"quoted\" & ampersanded value'), u'<input type=\"text\" name=\"email\" value=\"some &quot;quoted&quot; &amp; ampersanded value\" />')\n+        self.assertHTMLEqual(w.render('email', 'test@example.com', attrs={'class': 'fun'}), u'<input type=\"text\" name=\"email\" value=\"test@example.com\" class=\"fun\" />')\n \n         # Note that doctest in Python 2.4 (and maybe 2.5?) doesn't support non-ascii\n         # characters in output, so we're displaying the repr() here.\n-        self.assertEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<input type=\"text\" name=\"email\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" class=\"fun\" />')\n+        self.assertHTMLEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<input type=\"text\" name=\"email\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" class=\"fun\" />')\n \n         # You can also pass 'attrs' to the constructor:\n         w = TextInput(attrs={'class': 'fun'})\n-        self.assertEqual(w.render('email', ''), u'<input type=\"text\" class=\"fun\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'foo@example.com'), u'<input type=\"text\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input type=\"text\" class=\"fun\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'foo@example.com'), u'<input type=\"text\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n \n         # 'attrs' passed to render() get precedence over those passed to the constructor:\n         w = TextInput(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('email', '', attrs={'class': 'special'}), u'<input type=\"text\" class=\"special\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', '', attrs={'class': 'special'}), u'<input type=\"text\" class=\"special\" name=\"email\" />')\n \n         # 'attrs' can be safe-strings if needed)\n         w = TextInput(attrs={'onBlur': mark_safe(\"function('foo')\")})\n-        self.assertEqual(w.render('email', ''), u'<input onBlur=\"function(\\'foo\\')\" type=\"text\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input onBlur=\"function(\\'foo\\')\" type=\"text\" name=\"email\" />')\n \n     def test_passwordinput(self):\n         w = PasswordInput()\n-        self.assertEqual(w.render('email', ''), u'<input type=\"password\" name=\"email\" />')\n-        self.assertEqual(w.render('email', None), u'<input type=\"password\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'secret'), u'<input type=\"password\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input type=\"password\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', None), u'<input type=\"password\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'secret'), u'<input type=\"password\" name=\"email\" />')\n \n         # The render_value argument lets you specify whether the widget should render\n         # its value. For security reasons, this is off by default.\n         w = PasswordInput(render_value=True)\n-        self.assertEqual(w.render('email', ''), u'<input type=\"password\" name=\"email\" />')\n-        self.assertEqual(w.render('email', None), u'<input type=\"password\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'test@example.com'), u'<input type=\"password\" name=\"email\" value=\"test@example.com\" />')\n-        self.assertEqual(w.render('email', 'some \"quoted\" & ampersanded value'), u'<input type=\"password\" name=\"email\" value=\"some &quot;quoted&quot; &amp; ampersanded value\" />')\n-        self.assertEqual(w.render('email', 'test@example.com', attrs={'class': 'fun'}), u'<input type=\"password\" name=\"email\" value=\"test@example.com\" class=\"fun\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input type=\"password\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', None), u'<input type=\"password\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'test@example.com'), u'<input type=\"password\" name=\"email\" value=\"test@example.com\" />')\n+        self.assertHTMLEqual(w.render('email', 'some \"quoted\" & ampersanded value'), u'<input type=\"password\" name=\"email\" value=\"some &quot;quoted&quot; &amp; ampersanded value\" />')\n+        self.assertHTMLEqual(w.render('email', 'test@example.com', attrs={'class': 'fun'}), u'<input type=\"password\" name=\"email\" value=\"test@example.com\" class=\"fun\" />')\n \n         # You can also pass 'attrs' to the constructor:\n         w = PasswordInput(attrs={'class': 'fun'}, render_value=True)\n-        self.assertEqual(w.render('email', ''), u'<input type=\"password\" class=\"fun\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'foo@example.com'), u'<input type=\"password\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input type=\"password\" class=\"fun\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'foo@example.com'), u'<input type=\"password\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n \n         # 'attrs' passed to render() get precedence over those passed to the constructor:\n         w = PasswordInput(attrs={'class': 'pretty'}, render_value=True)\n-        self.assertEqual(w.render('email', '', attrs={'class': 'special'}), u'<input type=\"password\" class=\"special\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', '', attrs={'class': 'special'}), u'<input type=\"password\" class=\"special\" name=\"email\" />')\n \n-        self.assertEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<input type=\"password\" class=\"fun\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<input type=\"password\" class=\"fun\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" name=\"email\" />')\n \n     def test_hiddeninput(self):\n         w = HiddenInput()\n-        self.assertEqual(w.render('email', ''), u'<input type=\"hidden\" name=\"email\" />')\n-        self.assertEqual(w.render('email', None), u'<input type=\"hidden\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'test@example.com'), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" />')\n-        self.assertEqual(w.render('email', 'some \"quoted\" & ampersanded value'), u'<input type=\"hidden\" name=\"email\" value=\"some &quot;quoted&quot; &amp; ampersanded value\" />')\n-        self.assertEqual(w.render('email', 'test@example.com', attrs={'class': 'fun'}), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" class=\"fun\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input type=\"hidden\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', None), u'<input type=\"hidden\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'test@example.com'), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" />')\n+        self.assertHTMLEqual(w.render('email', 'some \"quoted\" & ampersanded value'), u'<input type=\"hidden\" name=\"email\" value=\"some &quot;quoted&quot; &amp; ampersanded value\" />')\n+        self.assertHTMLEqual(w.render('email', 'test@example.com', attrs={'class': 'fun'}), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" class=\"fun\" />')\n \n         # You can also pass 'attrs' to the constructor:\n         w = HiddenInput(attrs={'class': 'fun'})\n-        self.assertEqual(w.render('email', ''), u'<input type=\"hidden\" class=\"fun\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'foo@example.com'), u'<input type=\"hidden\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input type=\"hidden\" class=\"fun\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'foo@example.com'), u'<input type=\"hidden\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n \n         # 'attrs' passed to render() get precedence over those passed to the constructor:\n         w = HiddenInput(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('email', '', attrs={'class': 'special'}), u'<input type=\"hidden\" class=\"special\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', '', attrs={'class': 'special'}), u'<input type=\"hidden\" class=\"special\" name=\"email\" />')\n \n-        self.assertEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<input type=\"hidden\" class=\"fun\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<input type=\"hidden\" class=\"fun\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" name=\"email\" />')\n \n         # 'attrs' passed to render() get precedence over those passed to the constructor:\n         w = HiddenInput(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('email', '', attrs={'class': 'special'}), u'<input type=\"hidden\" class=\"special\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', '', attrs={'class': 'special'}), u'<input type=\"hidden\" class=\"special\" name=\"email\" />')\n \n         # Boolean values are rendered to their string forms (\"True\" and \"False\").\n         w = HiddenInput()\n-        self.assertEqual(w.render('get_spam', False), u'<input type=\"hidden\" name=\"get_spam\" value=\"False\" />')\n-        self.assertEqual(w.render('get_spam', True), u'<input type=\"hidden\" name=\"get_spam\" value=\"True\" />')\n+        self.assertHTMLEqual(w.render('get_spam', False), u'<input type=\"hidden\" name=\"get_spam\" value=\"False\" />')\n+        self.assertHTMLEqual(w.render('get_spam', True), u'<input type=\"hidden\" name=\"get_spam\" value=\"True\" />')\n \n     def test_multiplehiddeninput(self):\n         w = MultipleHiddenInput()\n-        self.assertEqual(w.render('email', []), u'')\n-        self.assertEqual(w.render('email', None), u'')\n-        self.assertEqual(w.render('email', ['test@example.com']), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" />')\n-        self.assertEqual(w.render('email', ['some \"quoted\" & ampersanded value']), u'<input type=\"hidden\" name=\"email\" value=\"some &quot;quoted&quot; &amp; ampersanded value\" />')\n-        self.assertEqual(w.render('email', ['test@example.com', 'foo@example.com']), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" />\\n<input type=\"hidden\" name=\"email\" value=\"foo@example.com\" />')\n-        self.assertEqual(w.render('email', ['test@example.com'], attrs={'class': 'fun'}), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" class=\"fun\" />')\n-        self.assertEqual(w.render('email', ['test@example.com', 'foo@example.com'], attrs={'class': 'fun'}), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" class=\"fun\" />\\n<input type=\"hidden\" name=\"email\" value=\"foo@example.com\" class=\"fun\" />')\n+        self.assertHTMLEqual(w.render('email', []), u'')\n+        self.assertHTMLEqual(w.render('email', None), u'')\n+        self.assertHTMLEqual(w.render('email', ['test@example.com']), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" />')\n+        self.assertHTMLEqual(w.render('email', ['some \"quoted\" & ampersanded value']), u'<input type=\"hidden\" name=\"email\" value=\"some &quot;quoted&quot; &amp; ampersanded value\" />')\n+        self.assertHTMLEqual(w.render('email', ['test@example.com', 'foo@example.com']), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" />\\n<input type=\"hidden\" name=\"email\" value=\"foo@example.com\" />')\n+        self.assertHTMLEqual(w.render('email', ['test@example.com'], attrs={'class': 'fun'}), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" class=\"fun\" />')\n+        self.assertHTMLEqual(w.render('email', ['test@example.com', 'foo@example.com'], attrs={'class': 'fun'}), u'<input type=\"hidden\" name=\"email\" value=\"test@example.com\" class=\"fun\" />\\n<input type=\"hidden\" name=\"email\" value=\"foo@example.com\" class=\"fun\" />')\n \n         # You can also pass 'attrs' to the constructor:\n         w = MultipleHiddenInput(attrs={'class': 'fun'})\n-        self.assertEqual(w.render('email', []), u'')\n-        self.assertEqual(w.render('email', ['foo@example.com']), u'<input type=\"hidden\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n-        self.assertEqual(w.render('email', ['foo@example.com', 'test@example.com']), u'<input type=\"hidden\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />\\n<input type=\"hidden\" class=\"fun\" value=\"test@example.com\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', []), u'')\n+        self.assertHTMLEqual(w.render('email', ['foo@example.com']), u'<input type=\"hidden\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ['foo@example.com', 'test@example.com']), u'<input type=\"hidden\" class=\"fun\" value=\"foo@example.com\" name=\"email\" />\\n<input type=\"hidden\" class=\"fun\" value=\"test@example.com\" name=\"email\" />')\n \n         # 'attrs' passed to render() get precedence over those passed to the constructor:\n         w = MultipleHiddenInput(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('email', ['foo@example.com'], attrs={'class': 'special'}), u'<input type=\"hidden\" class=\"special\" value=\"foo@example.com\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ['foo@example.com'], attrs={'class': 'special'}), u'<input type=\"hidden\" class=\"special\" value=\"foo@example.com\" name=\"email\" />')\n \n-        self.assertEqual(w.render('email', ['Å ÄÄÅ½ÄÅ¾Å¡Ä'], attrs={'class': 'fun'}), u'<input type=\"hidden\" class=\"fun\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ['Å ÄÄÅ½ÄÅ¾Å¡Ä'], attrs={'class': 'fun'}), u'<input type=\"hidden\" class=\"fun\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" name=\"email\" />')\n \n         # 'attrs' passed to render() get precedence over those passed to the constructor:\n         w = MultipleHiddenInput(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('email', ['foo@example.com'], attrs={'class': 'special'}), u'<input type=\"hidden\" class=\"special\" value=\"foo@example.com\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ['foo@example.com'], attrs={'class': 'special'}), u'<input type=\"hidden\" class=\"special\" value=\"foo@example.com\" name=\"email\" />')\n \n         # Each input gets a separate ID.\n         w = MultipleHiddenInput()\n-        self.assertEqual(w.render('letters', list('abc'), attrs={'id': 'hideme'}), u'<input type=\"hidden\" name=\"letters\" value=\"a\" id=\"hideme_0\" />\\n<input type=\"hidden\" name=\"letters\" value=\"b\" id=\"hideme_1\" />\\n<input type=\"hidden\" name=\"letters\" value=\"c\" id=\"hideme_2\" />')\n+        self.assertHTMLEqual(w.render('letters', list('abc'), attrs={'id': 'hideme'}), u'<input type=\"hidden\" name=\"letters\" value=\"a\" id=\"hideme_0\" />\\n<input type=\"hidden\" name=\"letters\" value=\"b\" id=\"hideme_1\" />\\n<input type=\"hidden\" name=\"letters\" value=\"c\" id=\"hideme_2\" />')\n \n     def test_fileinput(self):\n         # FileInput widgets don't ever show the value, because the old value is of no use\n         # if you are updating the form or if the provided file generated an error.\n         w = FileInput()\n-        self.assertEqual(w.render('email', ''), u'<input type=\"file\" name=\"email\" />')\n-        self.assertEqual(w.render('email', None), u'<input type=\"file\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'test@example.com'), u'<input type=\"file\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'some \"quoted\" & ampersanded value'), u'<input type=\"file\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'test@example.com', attrs={'class': 'fun'}), u'<input type=\"file\" name=\"email\" class=\"fun\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input type=\"file\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', None), u'<input type=\"file\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'test@example.com'), u'<input type=\"file\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'some \"quoted\" & ampersanded value'), u'<input type=\"file\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'test@example.com', attrs={'class': 'fun'}), u'<input type=\"file\" name=\"email\" class=\"fun\" />')\n \n         # You can also pass 'attrs' to the constructor:\n         w = FileInput(attrs={'class': 'fun'})\n-        self.assertEqual(w.render('email', ''), u'<input type=\"file\" class=\"fun\" name=\"email\" />')\n-        self.assertEqual(w.render('email', 'foo@example.com'), u'<input type=\"file\" class=\"fun\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', ''), u'<input type=\"file\" class=\"fun\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'foo@example.com'), u'<input type=\"file\" class=\"fun\" name=\"email\" />')\n \n-        self.assertEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<input type=\"file\" class=\"fun\" name=\"email\" />')\n+        self.assertHTMLEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<input type=\"file\" class=\"fun\" name=\"email\" />')\n \n         # Test for the behavior of _has_changed for FileInput. The value of data will\n         # more than likely come from request.FILES. The value of initial data will\n@@ -164,64 +164,64 @@ def test_fileinput(self):\n \n     def test_textarea(self):\n         w = Textarea()\n-        self.assertEqual(w.render('msg', ''), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\"></textarea>')\n-        self.assertEqual(w.render('msg', None), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\"></textarea>')\n-        self.assertEqual(w.render('msg', 'value'), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\">value</textarea>')\n-        self.assertEqual(w.render('msg', 'some \"quoted\" & ampersanded value'), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\">some &quot;quoted&quot; &amp; ampersanded value</textarea>')\n-        self.assertEqual(w.render('msg', mark_safe('pre &quot;quoted&quot; value')), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\">pre &quot;quoted&quot; value</textarea>')\n-        self.assertEqual(w.render('msg', 'value', attrs={'class': 'pretty', 'rows': 20}), u'<textarea class=\"pretty\" rows=\"20\" cols=\"40\" name=\"msg\">value</textarea>')\n+        self.assertHTMLEqual(w.render('msg', ''), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\"></textarea>')\n+        self.assertHTMLEqual(w.render('msg', None), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\"></textarea>')\n+        self.assertHTMLEqual(w.render('msg', 'value'), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\">value</textarea>')\n+        self.assertHTMLEqual(w.render('msg', 'some \"quoted\" & ampersanded value'), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\">some &quot;quoted&quot; &amp; ampersanded value</textarea>')\n+        self.assertHTMLEqual(w.render('msg', mark_safe('pre &quot;quoted&quot; value')), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\">pre &quot;quoted&quot; value</textarea>')\n+        self.assertHTMLEqual(w.render('msg', 'value', attrs={'class': 'pretty', 'rows': 20}), u'<textarea class=\"pretty\" rows=\"20\" cols=\"40\" name=\"msg\">value</textarea>')\n \n         # You can also pass 'attrs' to the constructor:\n         w = Textarea(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('msg', ''), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\" class=\"pretty\"></textarea>')\n-        self.assertEqual(w.render('msg', 'example'), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\" class=\"pretty\">example</textarea>')\n+        self.assertHTMLEqual(w.render('msg', ''), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\" class=\"pretty\"></textarea>')\n+        self.assertHTMLEqual(w.render('msg', 'example'), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\" class=\"pretty\">example</textarea>')\n \n         # 'attrs' passed to render() get precedence over those passed to the constructor:\n         w = Textarea(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('msg', '', attrs={'class': 'special'}), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\" class=\"special\"></textarea>')\n+        self.assertHTMLEqual(w.render('msg', '', attrs={'class': 'special'}), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\" class=\"special\"></textarea>')\n \n-        self.assertEqual(w.render('msg', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\" class=\"fun\">\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</textarea>')\n+        self.assertHTMLEqual(w.render('msg', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', attrs={'class': 'fun'}), u'<textarea rows=\"10\" cols=\"40\" name=\"msg\" class=\"fun\">\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</textarea>')\n \n     def test_checkboxinput(self):\n         w = CheckboxInput()\n-        self.assertEqual(w.render('is_cool', ''), u'<input type=\"checkbox\" name=\"is_cool\" />')\n-        self.assertEqual(w.render('is_cool', None), u'<input type=\"checkbox\" name=\"is_cool\" />')\n-        self.assertEqual(w.render('is_cool', False), u'<input type=\"checkbox\" name=\"is_cool\" />')\n-        self.assertEqual(w.render('is_cool', True), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" />')\n+        self.assertHTMLEqual(w.render('is_cool', ''), u'<input type=\"checkbox\" name=\"is_cool\" />')\n+        self.assertHTMLEqual(w.render('is_cool', None), u'<input type=\"checkbox\" name=\"is_cool\" />')\n+        self.assertHTMLEqual(w.render('is_cool', False), u'<input type=\"checkbox\" name=\"is_cool\" />')\n+        self.assertHTMLEqual(w.render('is_cool', True), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" />')\n \n         # Using any value that's not in ('', None, False, True) will check the checkbox\n         # and set the 'value' attribute.\n-        self.assertEqual(w.render('is_cool', 'foo'), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" value=\"foo\" />')\n+        self.assertHTMLEqual(w.render('is_cool', 'foo'), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" value=\"foo\" />')\n \n-        self.assertEqual(w.render('is_cool', False, attrs={'class': 'pretty'}), u'<input type=\"checkbox\" name=\"is_cool\" class=\"pretty\" />')\n+        self.assertHTMLEqual(w.render('is_cool', False, attrs={'class': 'pretty'}), u'<input type=\"checkbox\" name=\"is_cool\" class=\"pretty\" />')\n \n         # regression for #17114\n-        self.assertEqual(w.render('is_cool', 0), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" value=\"0\" />')\n-        self.assertEqual(w.render('is_cool', 1), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" value=\"1\" />')\n+        self.assertHTMLEqual(w.render('is_cool', 0), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" value=\"0\" />')\n+        self.assertHTMLEqual(w.render('is_cool', 1), u'<input checked=\"checked\" type=\"checkbox\" name=\"is_cool\" value=\"1\" />')\n \n         # You can also pass 'attrs' to the constructor:\n         w = CheckboxInput(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('is_cool', ''), u'<input type=\"checkbox\" class=\"pretty\" name=\"is_cool\" />')\n+        self.assertHTMLEqual(w.render('is_cool', ''), u'<input type=\"checkbox\" class=\"pretty\" name=\"is_cool\" />')\n \n         # 'attrs' passed to render() get precedence over those passed to the constructor:\n         w = CheckboxInput(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('is_cool', '', attrs={'class': 'special'}), u'<input type=\"checkbox\" class=\"special\" name=\"is_cool\" />')\n+        self.assertHTMLEqual(w.render('is_cool', '', attrs={'class': 'special'}), u'<input type=\"checkbox\" class=\"special\" name=\"is_cool\" />')\n \n         # You can pass 'check_test' to the constructor. This is a callable that takes the\n         # value and returns True if the box should be checked.\n         w = CheckboxInput(check_test=lambda value: value.startswith('hello'))\n-        self.assertEqual(w.render('greeting', ''), u'<input type=\"checkbox\" name=\"greeting\" />')\n-        self.assertEqual(w.render('greeting', 'hello'), u'<input checked=\"checked\" type=\"checkbox\" name=\"greeting\" value=\"hello\" />')\n-        self.assertEqual(w.render('greeting', 'hello there'), u'<input checked=\"checked\" type=\"checkbox\" name=\"greeting\" value=\"hello there\" />')\n-        self.assertEqual(w.render('greeting', 'hello & goodbye'), u'<input checked=\"checked\" type=\"checkbox\" name=\"greeting\" value=\"hello &amp; goodbye\" />')\n+        self.assertHTMLEqual(w.render('greeting', ''), u'<input type=\"checkbox\" name=\"greeting\" />')\n+        self.assertHTMLEqual(w.render('greeting', 'hello'), u'<input checked=\"checked\" type=\"checkbox\" name=\"greeting\" value=\"hello\" />')\n+        self.assertHTMLEqual(w.render('greeting', 'hello there'), u'<input checked=\"checked\" type=\"checkbox\" name=\"greeting\" value=\"hello there\" />')\n+        self.assertHTMLEqual(w.render('greeting', 'hello & goodbye'), u'<input checked=\"checked\" type=\"checkbox\" name=\"greeting\" value=\"hello &amp; goodbye\" />')\n \n         # A subtlety: If the 'check_test' argument cannot handle a value and raises any\n         # exception during its __call__, then the exception will be swallowed and the box\n         # will not be checked. In this example, the 'check_test' assumes the value has a\n         # startswith() method, which fails for the values True, False and None.\n-        self.assertEqual(w.render('greeting', True), u'<input type=\"checkbox\" name=\"greeting\" />')\n-        self.assertEqual(w.render('greeting', False), u'<input type=\"checkbox\" name=\"greeting\" />')\n-        self.assertEqual(w.render('greeting', None), u'<input type=\"checkbox\" name=\"greeting\" />')\n+        self.assertHTMLEqual(w.render('greeting', True), u'<input type=\"checkbox\" name=\"greeting\" />')\n+        self.assertHTMLEqual(w.render('greeting', False), u'<input type=\"checkbox\" name=\"greeting\" />')\n+        self.assertHTMLEqual(w.render('greeting', None), u'<input type=\"checkbox\" name=\"greeting\" />')\n \n         # The CheckboxInput widget will return False if the key is not found in the data\n         # dictionary (because HTML form submission doesn't send any result for unchecked\n@@ -238,31 +238,31 @@ def test_checkboxinput(self):\n \n     def test_select(self):\n         w = Select()\n-        self.assertEqual(w.render('beatle', 'J', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select name=\"beatle\">\n+        self.assertHTMLEqual(w.render('beatle', 'J', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select name=\"beatle\">\n <option value=\"J\" selected=\"selected\">John</option>\n <option value=\"P\">Paul</option>\n <option value=\"G\">George</option>\n <option value=\"R\">Ringo</option>\n </select>\"\"\")\n \n         # If the value is None, none of the options are selected:\n-        self.assertEqual(w.render('beatle', None, choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select name=\"beatle\">\n+        self.assertHTMLEqual(w.render('beatle', None, choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select name=\"beatle\">\n <option value=\"J\">John</option>\n <option value=\"P\">Paul</option>\n <option value=\"G\">George</option>\n <option value=\"R\">Ringo</option>\n </select>\"\"\")\n \n         # If the value corresponds to a label (but not to an option value), none of the options are selected:\n-        self.assertEqual(w.render('beatle', 'John', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select name=\"beatle\">\n+        self.assertHTMLEqual(w.render('beatle', 'John', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select name=\"beatle\">\n <option value=\"J\">John</option>\n <option value=\"P\">Paul</option>\n <option value=\"G\">George</option>\n <option value=\"R\">Ringo</option>\n </select>\"\"\")\n \n         # Only one option can be selected, see #8103:\n-        self.assertEqual(w.render('choices', '0', choices=(('0', '0'), ('1', '1'), ('2', '2'), ('3', '3'), ('0', 'extra'))), \"\"\"<select name=\"choices\">\n+        self.assertHTMLEqual(w.render('choices', '0', choices=(('0', '0'), ('1', '1'), ('2', '2'), ('3', '3'), ('0', 'extra'))), \"\"\"<select name=\"choices\">\n <option value=\"0\" selected=\"selected\">0</option>\n <option value=\"1\">1</option>\n <option value=\"2\">2</option>\n@@ -271,17 +271,17 @@ def test_select(self):\n </select>\"\"\")\n \n         # The value is compared to its str():\n-        self.assertEqual(w.render('num', 2, choices=[('1', '1'), ('2', '2'), ('3', '3')]), \"\"\"<select name=\"num\">\n+        self.assertHTMLEqual(w.render('num', 2, choices=[('1', '1'), ('2', '2'), ('3', '3')]), \"\"\"<select name=\"num\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('num', '2', choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<select name=\"num\">\n+        self.assertHTMLEqual(w.render('num', '2', choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<select name=\"num\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('num', 2, choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<select name=\"num\">\n+        self.assertHTMLEqual(w.render('num', 2, choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<select name=\"num\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n@@ -292,7 +292,7 @@ def test_select(self):\n         def get_choices():\n             for i in range(5):\n                 yield (i, i)\n-        self.assertEqual(w.render('num', 2, choices=get_choices()), \"\"\"<select name=\"num\">\n+        self.assertHTMLEqual(w.render('num', 2, choices=get_choices()), \"\"\"<select name=\"num\">\n <option value=\"0\">0</option>\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n@@ -303,21 +303,21 @@ def get_choices():\n         class SomeForm(Form):\n             somechoice = ChoiceField(choices=chain((('', '-'*9),), [(thing['id'], thing['name']) for thing in things]))\n         f = SomeForm()\n-        self.assertEqual(f.as_table(), u'<tr><th><label for=\"id_somechoice\">Somechoice:</label></th><td><select name=\"somechoice\" id=\"id_somechoice\">\\n<option value=\"\" selected=\"selected\">---------</option>\\n<option value=\"1\">And Boom</option>\\n<option value=\"2\">One More Thing!</option>\\n</select></td></tr>')\n-        self.assertEqual(f.as_table(), u'<tr><th><label for=\"id_somechoice\">Somechoice:</label></th><td><select name=\"somechoice\" id=\"id_somechoice\">\\n<option value=\"\" selected=\"selected\">---------</option>\\n<option value=\"1\">And Boom</option>\\n<option value=\"2\">One More Thing!</option>\\n</select></td></tr>')\n+        self.assertHTMLEqual(f.as_table(), u'<tr><th><label for=\"id_somechoice\">Somechoice:</label></th><td><select name=\"somechoice\" id=\"id_somechoice\">\\n<option value=\"\" selected=\"selected\">---------</option>\\n<option value=\"1\">And Boom</option>\\n<option value=\"2\">One More Thing!</option>\\n</select></td></tr>')\n+        self.assertHTMLEqual(f.as_table(), u'<tr><th><label for=\"id_somechoice\">Somechoice:</label></th><td><select name=\"somechoice\" id=\"id_somechoice\">\\n<option value=\"\" selected=\"selected\">---------</option>\\n<option value=\"1\">And Boom</option>\\n<option value=\"2\">One More Thing!</option>\\n</select></td></tr>')\n         f = SomeForm({'somechoice': 2})\n-        self.assertEqual(f.as_table(), u'<tr><th><label for=\"id_somechoice\">Somechoice:</label></th><td><select name=\"somechoice\" id=\"id_somechoice\">\\n<option value=\"\">---------</option>\\n<option value=\"1\">And Boom</option>\\n<option value=\"2\" selected=\"selected\">One More Thing!</option>\\n</select></td></tr>')\n+        self.assertHTMLEqual(f.as_table(), u'<tr><th><label for=\"id_somechoice\">Somechoice:</label></th><td><select name=\"somechoice\" id=\"id_somechoice\">\\n<option value=\"\">---------</option>\\n<option value=\"1\">And Boom</option>\\n<option value=\"2\" selected=\"selected\">One More Thing!</option>\\n</select></td></tr>')\n \n         # You can also pass 'choices' to the constructor:\n         w = Select(choices=[(1, 1), (2, 2), (3, 3)])\n-        self.assertEqual(w.render('num', 2), \"\"\"<select name=\"num\">\n+        self.assertHTMLEqual(w.render('num', 2), \"\"\"<select name=\"num\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n </select>\"\"\")\n \n         # If 'choices' is passed to both the constructor and render(), then they'll both be in the output:\n-        self.assertEqual(w.render('num', 2, choices=[(4, 4), (5, 5)]), \"\"\"<select name=\"num\">\n+        self.assertHTMLEqual(w.render('num', 2, choices=[(4, 4), (5, 5)]), \"\"\"<select name=\"num\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n@@ -326,7 +326,7 @@ class SomeForm(Form):\n </select>\"\"\")\n \n         # Choices are escaped correctly\n-        self.assertEqual(w.render('escape', None, choices=(('bad', 'you & me'), ('good', mark_safe('you &gt; me')))), \"\"\"<select name=\"escape\">\n+        self.assertHTMLEqual(w.render('escape', None, choices=(('bad', 'you & me'), ('good', mark_safe('you &gt; me')))), \"\"\"<select name=\"escape\">\n <option value=\"1\">1</option>\n <option value=\"2\">2</option>\n <option value=\"3\">3</option>\n@@ -335,19 +335,19 @@ class SomeForm(Form):\n </select>\"\"\")\n \n         # Unicode choices are correctly rendered as HTML\n-        self.assertEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', choices=[('Å ÄÄÅ½ÄÅ¾Å¡Ä', 'Å ÄabcÄÅ½ÄÅ¾Å¡Ä'), ('ÄÅ¾Å¡Ä', 'abcÄÅ¾Å¡Ä')]), u'<select name=\"email\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" selected=\"selected\">\\u0160\\u0110abc\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</option>\\n<option value=\"\\u0107\\u017e\\u0161\\u0111\">abc\\u0107\\u017e\\u0161\\u0111</option>\\n</select>')\n+        self.assertHTMLEqual(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', choices=[('Å ÄÄÅ½ÄÅ¾Å¡Ä', 'Å ÄabcÄÅ½ÄÅ¾Å¡Ä'), ('ÄÅ¾Å¡Ä', 'abcÄÅ¾Å¡Ä')]), u'<select name=\"email\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" selected=\"selected\">\\u0160\\u0110abc\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</option>\\n<option value=\"\\u0107\\u017e\\u0161\\u0111\">abc\\u0107\\u017e\\u0161\\u0111</option>\\n</select>')\n \n         # If choices is passed to the constructor and is a generator, it can be iterated\n         # over multiple times without getting consumed:\n         w = Select(choices=get_choices())\n-        self.assertEqual(w.render('num', 2), \"\"\"<select name=\"num\">\n+        self.assertHTMLEqual(w.render('num', 2), \"\"\"<select name=\"num\">\n <option value=\"0\">0</option>\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n <option value=\"4\">4</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('num', 3), \"\"\"<select name=\"num\">\n+        self.assertHTMLEqual(w.render('num', 3), \"\"\"<select name=\"num\">\n <option value=\"0\">0</option>\n <option value=\"1\">1</option>\n <option value=\"2\">2</option>\n@@ -357,23 +357,23 @@ class SomeForm(Form):\n \n         # Choices can be nested one level in order to create HTML optgroups:\n         w.choices=(('outer1', 'Outer 1'), ('Group \"1\"', (('inner1', 'Inner 1'), ('inner2', 'Inner 2'))))\n-        self.assertEqual(w.render('nestchoice', None), \"\"\"<select name=\"nestchoice\">\n+        self.assertHTMLEqual(w.render('nestchoice', None), \"\"\"<select name=\"nestchoice\">\n <option value=\"outer1\">Outer 1</option>\n <optgroup label=\"Group &quot;1&quot;\">\n <option value=\"inner1\">Inner 1</option>\n <option value=\"inner2\">Inner 2</option>\n </optgroup>\n </select>\"\"\")\n \n-        self.assertEqual(w.render('nestchoice', 'outer1'), \"\"\"<select name=\"nestchoice\">\n+        self.assertHTMLEqual(w.render('nestchoice', 'outer1'), \"\"\"<select name=\"nestchoice\">\n <option value=\"outer1\" selected=\"selected\">Outer 1</option>\n <optgroup label=\"Group &quot;1&quot;\">\n <option value=\"inner1\">Inner 1</option>\n <option value=\"inner2\">Inner 2</option>\n </optgroup>\n </select>\"\"\")\n \n-        self.assertEqual(w.render('nestchoice', 'inner1'), \"\"\"<select name=\"nestchoice\">\n+        self.assertHTMLEqual(w.render('nestchoice', 'inner1'), \"\"\"<select name=\"nestchoice\">\n <option value=\"outer1\">Outer 1</option>\n <optgroup label=\"Group &quot;1&quot;\">\n <option value=\"inner1\" selected=\"selected\">Inner 1</option>\n@@ -388,22 +388,22 @@ def test_nullbooleanselect(self):\n <option value=\"2\" selected=\"selected\">Yes</option>\n <option value=\"3\">No</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('is_cool', False), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(w.render('is_cool', False), \"\"\"<select name=\"is_cool\">\n <option value=\"1\">Unknown</option>\n <option value=\"2\">Yes</option>\n <option value=\"3\" selected=\"selected\">No</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('is_cool', None), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(w.render('is_cool', None), \"\"\"<select name=\"is_cool\">\n <option value=\"1\" selected=\"selected\">Unknown</option>\n <option value=\"2\">Yes</option>\n <option value=\"3\">No</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('is_cool', '2'), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(w.render('is_cool', '2'), \"\"\"<select name=\"is_cool\">\n <option value=\"1\">Unknown</option>\n <option value=\"2\" selected=\"selected\">Yes</option>\n <option value=\"3\">No</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('is_cool', '3'), \"\"\"<select name=\"is_cool\">\n+        self.assertHTMLEqual(w.render('is_cool', '3'), \"\"\"<select name=\"is_cool\">\n <option value=\"1\">Unknown</option>\n <option value=\"2\">Yes</option>\n <option value=\"3\" selected=\"selected\">No</option>\n@@ -418,43 +418,43 @@ def test_nullbooleanselect(self):\n \n     def test_selectmultiple(self):\n         w = SelectMultiple()\n-        self.assertEqual(w.render('beatles', ['J'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n+        self.assertHTMLEqual(w.render('beatles', ['J'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n <option value=\"J\" selected=\"selected\">John</option>\n <option value=\"P\">Paul</option>\n <option value=\"G\">George</option>\n <option value=\"R\">Ringo</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('beatles', ['J', 'P'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n+        self.assertHTMLEqual(w.render('beatles', ['J', 'P'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n <option value=\"J\" selected=\"selected\">John</option>\n <option value=\"P\" selected=\"selected\">Paul</option>\n <option value=\"G\">George</option>\n <option value=\"R\">Ringo</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('beatles', ['J', 'P', 'R'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n+        self.assertHTMLEqual(w.render('beatles', ['J', 'P', 'R'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n <option value=\"J\" selected=\"selected\">John</option>\n <option value=\"P\" selected=\"selected\">Paul</option>\n <option value=\"G\">George</option>\n <option value=\"R\" selected=\"selected\">Ringo</option>\n </select>\"\"\")\n \n         # If the value is None, none of the options are selected:\n-        self.assertEqual(w.render('beatles', None, choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n+        self.assertHTMLEqual(w.render('beatles', None, choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n <option value=\"J\">John</option>\n <option value=\"P\">Paul</option>\n <option value=\"G\">George</option>\n <option value=\"R\">Ringo</option>\n </select>\"\"\")\n \n         # If the value corresponds to a label (but not to an option value), none of the options are selected:\n-        self.assertEqual(w.render('beatles', ['John'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n+        self.assertHTMLEqual(w.render('beatles', ['John'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n <option value=\"J\">John</option>\n <option value=\"P\">Paul</option>\n <option value=\"G\">George</option>\n <option value=\"R\">Ringo</option>\n </select>\"\"\")\n \n         # Multiple options (with the same value) can be selected, see #8103:\n-        self.assertEqual(w.render('choices', ['0'], choices=(('0', '0'), ('1', '1'), ('2', '2'), ('3', '3'), ('0', 'extra'))), \"\"\"<select multiple=\"multiple\" name=\"choices\">\n+        self.assertHTMLEqual(w.render('choices', ['0'], choices=(('0', '0'), ('1', '1'), ('2', '2'), ('3', '3'), ('0', 'extra'))), \"\"\"<select multiple=\"multiple\" name=\"choices\">\n <option value=\"0\" selected=\"selected\">0</option>\n <option value=\"1\">1</option>\n <option value=\"2\">2</option>\n@@ -463,25 +463,25 @@ def test_selectmultiple(self):\n </select>\"\"\")\n \n         # If multiple values are given, but some of them are not valid, the valid ones are selected:\n-        self.assertEqual(w.render('beatles', ['J', 'G', 'foo'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n+        self.assertHTMLEqual(w.render('beatles', ['J', 'G', 'foo'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<select multiple=\"multiple\" name=\"beatles\">\n <option value=\"J\" selected=\"selected\">John</option>\n <option value=\"P\">Paul</option>\n <option value=\"G\" selected=\"selected\">George</option>\n <option value=\"R\">Ringo</option>\n </select>\"\"\")\n \n         # The value is compared to its str():\n-        self.assertEqual(w.render('nums', [2], choices=[('1', '1'), ('2', '2'), ('3', '3')]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n+        self.assertHTMLEqual(w.render('nums', [2], choices=[('1', '1'), ('2', '2'), ('3', '3')]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('nums', ['2'], choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n+        self.assertHTMLEqual(w.render('nums', ['2'], choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n </select>\"\"\")\n-        self.assertEqual(w.render('nums', [2], choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n+        self.assertHTMLEqual(w.render('nums', [2], choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n@@ -491,7 +491,7 @@ def test_selectmultiple(self):\n         def get_choices():\n             for i in range(5):\n                 yield (i, i)\n-        self.assertEqual(w.render('nums', [2], choices=get_choices()), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n+        self.assertHTMLEqual(w.render('nums', [2], choices=get_choices()), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n <option value=\"0\">0</option>\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n@@ -501,14 +501,14 @@ def get_choices():\n \n         # You can also pass 'choices' to the constructor:\n         w = SelectMultiple(choices=[(1, 1), (2, 2), (3, 3)])\n-        self.assertEqual(w.render('nums', [2]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n+        self.assertHTMLEqual(w.render('nums', [2]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n </select>\"\"\")\n \n         # If 'choices' is passed to both the constructor and render(), then they'll both be in the output:\n-        self.assertEqual(w.render('nums', [2], choices=[(4, 4), (5, 5)]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n+        self.assertHTMLEqual(w.render('nums', [2], choices=[(4, 4), (5, 5)]), \"\"\"<select multiple=\"multiple\" name=\"nums\">\n <option value=\"1\">1</option>\n <option value=\"2\" selected=\"selected\">2</option>\n <option value=\"3\">3</option>\n@@ -517,7 +517,7 @@ def get_choices():\n </select>\"\"\")\n \n         # Choices are escaped correctly\n-        self.assertEqual(w.render('escape', None, choices=(('bad', 'you & me'), ('good', mark_safe('you &gt; me')))), \"\"\"<select multiple=\"multiple\" name=\"escape\">\n+        self.assertHTMLEqual(w.render('escape', None, choices=(('bad', 'you & me'), ('good', mark_safe('you &gt; me')))), \"\"\"<select multiple=\"multiple\" name=\"escape\">\n <option value=\"1\">1</option>\n <option value=\"2\">2</option>\n <option value=\"3\">3</option>\n@@ -526,7 +526,7 @@ def get_choices():\n </select>\"\"\")\n \n         # Unicode choices are correctly rendered as HTML\n-        self.assertEqual(w.render('nums', ['Å ÄÄÅ½ÄÅ¾Å¡Ä'], choices=[('Å ÄÄÅ½ÄÅ¾Å¡Ä', 'Å ÄabcÄÅ½ÄÅ¾Å¡Ä'), ('ÄÅ¾Å¡Ä', 'abcÄÅ¾Å¡Ä')]), u'<select multiple=\"multiple\" name=\"nums\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" selected=\"selected\">\\u0160\\u0110abc\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</option>\\n<option value=\"\\u0107\\u017e\\u0161\\u0111\">abc\\u0107\\u017e\\u0161\\u0111</option>\\n</select>')\n+        self.assertHTMLEqual(w.render('nums', ['Å ÄÄÅ½ÄÅ¾Å¡Ä'], choices=[('Å ÄÄÅ½ÄÅ¾Å¡Ä', 'Å ÄabcÄÅ½ÄÅ¾Å¡Ä'), ('ÄÅ¾Å¡Ä', 'abcÄÅ¾Å¡Ä')]), u'<select multiple=\"multiple\" name=\"nums\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" selected=\"selected\">\\u0160\\u0110abc\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</option>\\n<option value=\"\\u0107\\u017e\\u0161\\u0111\">abc\\u0107\\u017e\\u0161\\u0111</option>\\n</select>')\n \n         # Test the usage of _has_changed\n         self.assertFalse(w._has_changed(None, None))\n@@ -538,31 +538,31 @@ def get_choices():\n \n         # Choices can be nested one level in order to create HTML optgroups:\n         w.choices = (('outer1', 'Outer 1'), ('Group \"1\"', (('inner1', 'Inner 1'), ('inner2', 'Inner 2'))))\n-        self.assertEqual(w.render('nestchoice', None), \"\"\"<select multiple=\"multiple\" name=\"nestchoice\">\n+        self.assertHTMLEqual(w.render('nestchoice', None), \"\"\"<select multiple=\"multiple\" name=\"nestchoice\">\n <option value=\"outer1\">Outer 1</option>\n <optgroup label=\"Group &quot;1&quot;\">\n <option value=\"inner1\">Inner 1</option>\n <option value=\"inner2\">Inner 2</option>\n </optgroup>\n </select>\"\"\")\n \n-        self.assertEqual(w.render('nestchoice', ['outer1']), \"\"\"<select multiple=\"multiple\" name=\"nestchoice\">\n+        self.assertHTMLEqual(w.render('nestchoice', ['outer1']), \"\"\"<select multiple=\"multiple\" name=\"nestchoice\">\n <option value=\"outer1\" selected=\"selected\">Outer 1</option>\n <optgroup label=\"Group &quot;1&quot;\">\n <option value=\"inner1\">Inner 1</option>\n <option value=\"inner2\">Inner 2</option>\n </optgroup>\n </select>\"\"\")\n \n-        self.assertEqual(w.render('nestchoice', ['inner1']), \"\"\"<select multiple=\"multiple\" name=\"nestchoice\">\n+        self.assertHTMLEqual(w.render('nestchoice', ['inner1']), \"\"\"<select multiple=\"multiple\" name=\"nestchoice\">\n <option value=\"outer1\">Outer 1</option>\n <optgroup label=\"Group &quot;1&quot;\">\n <option value=\"inner1\" selected=\"selected\">Inner 1</option>\n <option value=\"inner2\">Inner 2</option>\n </optgroup>\n </select>\"\"\")\n \n-        self.assertEqual(w.render('nestchoice', ['outer1', 'inner2']), \"\"\"<select multiple=\"multiple\" name=\"nestchoice\">\n+        self.assertHTMLEqual(w.render('nestchoice', ['outer1', 'inner2']), \"\"\"<select multiple=\"multiple\" name=\"nestchoice\">\n <option value=\"outer1\" selected=\"selected\">Outer 1</option>\n <optgroup label=\"Group &quot;1&quot;\">\n <option value=\"inner1\">Inner 1</option>\n@@ -572,41 +572,41 @@ def get_choices():\n \n     def test_radioselect(self):\n         w = RadioSelect()\n-        self.assertEqual(w.render('beatle', 'J', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatle', 'J', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"J\" /> John</label></li>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</label></li>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"G\" /> George</label></li>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"R\" /> Ringo</label></li>\n </ul>\"\"\")\n \n         # If the value is None, none of the options are checked:\n-        self.assertEqual(w.render('beatle', None, choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatle', None, choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"J\" /> John</label></li>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</label></li>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"G\" /> George</label></li>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"R\" /> Ringo</label></li>\n </ul>\"\"\")\n \n         # If the value corresponds to a label (but not to an option value), none of the options are checked:\n-        self.assertEqual(w.render('beatle', 'John', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatle', 'John', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"J\" /> John</label></li>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</label></li>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"G\" /> George</label></li>\n <li><label><input type=\"radio\" name=\"beatle\" value=\"R\" /> Ringo</label></li>\n </ul>\"\"\")\n \n         # The value is compared to its str():\n-        self.assertEqual(w.render('num', 2, choices=[('1', '1'), ('2', '2'), ('3', '3')]), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('num', 2, choices=[('1', '1'), ('2', '2'), ('3', '3')]), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"num\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"radio\" name=\"num\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"radio\" name=\"num\" value=\"3\" /> 3</label></li>\n </ul>\"\"\")\n-        self.assertEqual(w.render('num', '2', choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('num', '2', choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"num\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"radio\" name=\"num\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"radio\" name=\"num\" value=\"3\" /> 3</label></li>\n </ul>\"\"\")\n-        self.assertEqual(w.render('num', 2, choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('num', 2, choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"num\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"radio\" name=\"num\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"radio\" name=\"num\" value=\"3\" /> 3</label></li>\n@@ -616,7 +616,7 @@ def test_radioselect(self):\n         def get_choices():\n             for i in range(5):\n                 yield (i, i)\n-        self.assertEqual(w.render('num', 2, choices=get_choices()), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('num', 2, choices=get_choices()), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"num\" value=\"0\" /> 0</label></li>\n <li><label><input type=\"radio\" name=\"num\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"radio\" name=\"num\" value=\"2\" /> 2</label></li>\n@@ -626,14 +626,14 @@ def get_choices():\n \n         # You can also pass 'choices' to the constructor:\n         w = RadioSelect(choices=[(1, 1), (2, 2), (3, 3)])\n-        self.assertEqual(w.render('num', 2), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('num', 2), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"num\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"radio\" name=\"num\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"radio\" name=\"num\" value=\"3\" /> 3</label></li>\n </ul>\"\"\")\n \n         # If 'choices' is passed to both the constructor and render(), then they'll both be in the output:\n-        self.assertEqual(w.render('num', 2, choices=[(4, 4), (5, 5)]), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('num', 2, choices=[(4, 4), (5, 5)]), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"num\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"radio\" name=\"num\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"radio\" name=\"num\" value=\"3\" /> 3</label></li>\n@@ -657,19 +657,19 @@ def get_choices():\n             inp_set3.append('<p>%s %s</p>' % (inp.tag(), inp.choice_label))\n             inp_set4.append('%s %s %s %s %s' % (inp.name, inp.value, inp.choice_value, inp.choice_label, inp.is_checked()))\n \n-        self.assertEqual('\\n'.join(inp_set1), \"\"\"<label><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"J\" /> John</label>\n+        self.assertHTMLEqual('\\n'.join(inp_set1), \"\"\"<label><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"J\" /> John</label>\n <label><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</label>\n <label><input type=\"radio\" name=\"beatle\" value=\"G\" /> George</label>\n <label><input type=\"radio\" name=\"beatle\" value=\"R\" /> Ringo</label>\"\"\")\n-        self.assertEqual('\\n'.join(inp_set2), \"\"\"<label><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"J\" /> John</label><br />\n+        self.assertHTMLEqual('\\n'.join(inp_set2), \"\"\"<label><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"J\" /> John</label><br />\n <label><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</label><br />\n <label><input type=\"radio\" name=\"beatle\" value=\"G\" /> George</label><br />\n <label><input type=\"radio\" name=\"beatle\" value=\"R\" /> Ringo</label><br />\"\"\")\n-        self.assertEqual('\\n'.join(inp_set3), \"\"\"<p><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"J\" /> John</p>\n+        self.assertHTMLEqual('\\n'.join(inp_set3), \"\"\"<p><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"J\" /> John</p>\n <p><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</p>\n <p><input type=\"radio\" name=\"beatle\" value=\"G\" /> George</p>\n <p><input type=\"radio\" name=\"beatle\" value=\"R\" /> Ringo</p>\"\"\")\n-        self.assertEqual('\\n'.join(inp_set4), \"\"\"beatle J J John True\n+        self.assertHTMLEqual('\\n'.join(inp_set4), \"\"\"beatle J J John True\n beatle J P Paul False\n beatle J G George False\n beatle J R Ringo False\"\"\")\n@@ -679,7 +679,7 @@ class MyRenderer(RadioFieldRenderer):\n            def render(self):\n                return u'<br />\\n'.join([unicode(choice) for choice in self])\n         w = RadioSelect(renderer=MyRenderer)\n-        self.assertEqual(w.render('beatle', 'G', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<label><input type=\"radio\" name=\"beatle\" value=\"J\" /> John</label><br />\n+        self.assertHTMLEqual(w.render('beatle', 'G', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<label><input type=\"radio\" name=\"beatle\" value=\"J\" /> John</label><br />\n <label><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</label><br />\n <label><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"G\" /> George</label><br />\n <label><input type=\"radio\" name=\"beatle\" value=\"R\" /> Ringo</label>\"\"\")\n@@ -688,16 +688,16 @@ def render(self):\n         class CustomRadioSelect(RadioSelect):\n            renderer = MyRenderer\n         w = CustomRadioSelect()\n-        self.assertEqual(w.render('beatle', 'G', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<label><input type=\"radio\" name=\"beatle\" value=\"J\" /> John</label><br />\n+        self.assertHTMLEqual(w.render('beatle', 'G', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<label><input type=\"radio\" name=\"beatle\" value=\"J\" /> John</label><br />\n <label><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</label><br />\n <label><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"G\" /> George</label><br />\n <label><input type=\"radio\" name=\"beatle\" value=\"R\" /> Ringo</label>\"\"\")\n \n         # A RadioFieldRenderer object also allows index access to individual RadioInput\n         w = RadioSelect()\n         r = w.get_renderer('beatle', 'J', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo')))\n-        self.assertEqual(str(r[1]), '<label><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</label>')\n-        self.assertEqual(str(r[0]), '<label><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"J\" /> John</label>')\n+        self.assertHTMLEqual(str(r[1]), '<label><input type=\"radio\" name=\"beatle\" value=\"P\" /> Paul</label>')\n+        self.assertHTMLEqual(str(r[0]), '<label><input checked=\"checked\" type=\"radio\" name=\"beatle\" value=\"J\" /> John</label>')\n         self.assertTrue(r[0].is_checked())\n         self.assertFalse(r[1].is_checked())\n         self.assertEqual((r[1].name, r[1].value, r[1].choice_value, r[1].choice_label), ('beatle', u'J', u'P', u'Paul'))\n@@ -710,18 +710,18 @@ class CustomRadioSelect(RadioSelect):\n \n         # Choices are escaped correctly\n         w = RadioSelect()\n-        self.assertEqual(w.render('escape', None, choices=(('bad', 'you & me'), ('good', mark_safe('you &gt; me')))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('escape', None, choices=(('bad', 'you & me'), ('good', mark_safe('you &gt; me')))), \"\"\"<ul>\n <li><label><input type=\"radio\" name=\"escape\" value=\"bad\" /> you &amp; me</label></li>\n <li><label><input type=\"radio\" name=\"escape\" value=\"good\" /> you &gt; me</label></li>\n </ul>\"\"\")\n \n         # Unicode choices are correctly rendered as HTML\n         w = RadioSelect()\n-        self.assertEqual(unicode(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', choices=[('Å ÄÄÅ½ÄÅ¾Å¡Ä', 'Å ÄabcÄÅ½ÄÅ¾Å¡Ä'), ('ÄÅ¾Å¡Ä', 'abcÄÅ¾Å¡Ä')])), u'<ul>\\n<li><label><input checked=\"checked\" type=\"radio\" name=\"email\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" /> \\u0160\\u0110abc\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</label></li>\\n<li><label><input type=\"radio\" name=\"email\" value=\"\\u0107\\u017e\\u0161\\u0111\" /> abc\\u0107\\u017e\\u0161\\u0111</label></li>\\n</ul>')\n+        self.assertHTMLEqual(unicode(w.render('email', 'Å ÄÄÅ½ÄÅ¾Å¡Ä', choices=[('Å ÄÄÅ½ÄÅ¾Å¡Ä', 'Å ÄabcÄÅ½ÄÅ¾Å¡Ä'), ('ÄÅ¾Å¡Ä', 'abcÄÅ¾Å¡Ä')])), u'<ul>\\n<li><label><input checked=\"checked\" type=\"radio\" name=\"email\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" /> \\u0160\\u0110abc\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</label></li>\\n<li><label><input type=\"radio\" name=\"email\" value=\"\\u0107\\u017e\\u0161\\u0111\" /> abc\\u0107\\u017e\\u0161\\u0111</label></li>\\n</ul>')\n \n         # Attributes provided at instantiation are passed to the constituent inputs\n         w = RadioSelect(attrs={'id':'foo'})\n-        self.assertEqual(w.render('beatle', 'J', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatle', 'J', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label for=\"foo_0\"><input checked=\"checked\" type=\"radio\" id=\"foo_0\" value=\"J\" name=\"beatle\" /> John</label></li>\n <li><label for=\"foo_1\"><input type=\"radio\" id=\"foo_1\" value=\"P\" name=\"beatle\" /> Paul</label></li>\n <li><label for=\"foo_2\"><input type=\"radio\" id=\"foo_2\" value=\"G\" name=\"beatle\" /> George</label></li>\n@@ -730,7 +730,7 @@ class CustomRadioSelect(RadioSelect):\n \n         # Attributes provided at render-time are passed to the constituent inputs\n         w = RadioSelect()\n-        self.assertEqual(w.render('beatle', 'J', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo')), attrs={'id':'bar'}), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatle', 'J', choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo')), attrs={'id':'bar'}), \"\"\"<ul>\n <li><label for=\"bar_0\"><input checked=\"checked\" type=\"radio\" id=\"bar_0\" value=\"J\" name=\"beatle\" /> John</label></li>\n <li><label for=\"bar_1\"><input type=\"radio\" id=\"bar_1\" value=\"P\" name=\"beatle\" /> Paul</label></li>\n <li><label for=\"bar_2\"><input type=\"radio\" id=\"bar_2\" value=\"G\" name=\"beatle\" /> George</label></li>\n@@ -739,61 +739,61 @@ class CustomRadioSelect(RadioSelect):\n \n     def test_checkboxselectmultiple(self):\n         w = CheckboxSelectMultiple()\n-        self.assertEqual(w.render('beatles', ['J'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatles', ['J'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"beatles\" value=\"J\" /> John</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"P\" /> Paul</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"G\" /> George</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"R\" /> Ringo</label></li>\n </ul>\"\"\")\n-        self.assertEqual(w.render('beatles', ['J', 'P'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatles', ['J', 'P'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"beatles\" value=\"J\" /> John</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"beatles\" value=\"P\" /> Paul</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"G\" /> George</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"R\" /> Ringo</label></li>\n </ul>\"\"\")\n-        self.assertEqual(w.render('beatles', ['J', 'P', 'R'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatles', ['J', 'P', 'R'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"beatles\" value=\"J\" /> John</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"beatles\" value=\"P\" /> Paul</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"G\" /> George</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"beatles\" value=\"R\" /> Ringo</label></li>\n </ul>\"\"\")\n \n         # If the value is None, none of the options are selected:\n-        self.assertEqual(w.render('beatles', None, choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatles', None, choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"J\" /> John</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"P\" /> Paul</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"G\" /> George</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"R\" /> Ringo</label></li>\n </ul>\"\"\")\n \n         # If the value corresponds to a label (but not to an option value), none of the options are selected:\n-        self.assertEqual(w.render('beatles', ['John'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatles', ['John'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"J\" /> John</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"P\" /> Paul</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"G\" /> George</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"R\" /> Ringo</label></li>\n </ul>\"\"\")\n \n         # If multiple values are given, but some of them are not valid, the valid ones are selected:\n-        self.assertEqual(w.render('beatles', ['J', 'G', 'foo'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('beatles', ['J', 'G', 'foo'], choices=(('J', 'John'), ('P', 'Paul'), ('G', 'George'), ('R', 'Ringo'))), \"\"\"<ul>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"beatles\" value=\"J\" /> John</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"P\" /> Paul</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"beatles\" value=\"G\" /> George</label></li>\n <li><label><input type=\"checkbox\" name=\"beatles\" value=\"R\" /> Ringo</label></li>\n </ul>\"\"\")\n \n         # The value is compared to its str():\n-        self.assertEqual(w.render('nums', [2], choices=[('1', '1'), ('2', '2'), ('3', '3')]), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('nums', [2], choices=[('1', '1'), ('2', '2'), ('3', '3')]), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"nums\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"3\" /> 3</label></li>\n </ul>\"\"\")\n-        self.assertEqual(w.render('nums', ['2'], choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('nums', ['2'], choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"nums\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"3\" /> 3</label></li>\n </ul>\"\"\")\n-        self.assertEqual(w.render('nums', [2], choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('nums', [2], choices=[(1, 1), (2, 2), (3, 3)]), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"nums\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"3\" /> 3</label></li>\n@@ -803,7 +803,7 @@ def test_checkboxselectmultiple(self):\n         def get_choices():\n             for i in range(5):\n                 yield (i, i)\n-        self.assertEqual(w.render('nums', [2], choices=get_choices()), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('nums', [2], choices=get_choices()), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"0\" /> 0</label></li>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"nums\" value=\"2\" /> 2</label></li>\n@@ -813,14 +813,14 @@ def get_choices():\n \n         # You can also pass 'choices' to the constructor:\n         w = CheckboxSelectMultiple(choices=[(1, 1), (2, 2), (3, 3)])\n-        self.assertEqual(w.render('nums', [2]), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('nums', [2]), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"nums\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"3\" /> 3</label></li>\n </ul>\"\"\")\n \n         # If 'choices' is passed to both the constructor and render(), then they'll both be in the output:\n-        self.assertEqual(w.render('nums', [2], choices=[(4, 4), (5, 5)]), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('nums', [2], choices=[(4, 4), (5, 5)]), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"1\" /> 1</label></li>\n <li><label><input checked=\"checked\" type=\"checkbox\" name=\"nums\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"checkbox\" name=\"nums\" value=\"3\" /> 3</label></li>\n@@ -829,7 +829,7 @@ def get_choices():\n </ul>\"\"\")\n \n         # Choices are escaped correctly\n-        self.assertEqual(w.render('escape', None, choices=(('bad', 'you & me'), ('good', mark_safe('you &gt; me')))), \"\"\"<ul>\n+        self.assertHTMLEqual(w.render('escape', None, choices=(('bad', 'you & me'), ('good', mark_safe('you &gt; me')))), \"\"\"<ul>\n <li><label><input type=\"checkbox\" name=\"escape\" value=\"1\" /> 1</label></li>\n <li><label><input type=\"checkbox\" name=\"escape\" value=\"2\" /> 2</label></li>\n <li><label><input type=\"checkbox\" name=\"escape\" value=\"3\" /> 3</label></li>\n@@ -847,10 +847,10 @@ def get_choices():\n         self.assertFalse(w._has_changed([2, 1], [u'1', u'2']))\n \n         # Unicode choices are correctly rendered as HTML\n-        self.assertEqual(w.render('nums', ['Å ÄÄÅ½ÄÅ¾Å¡Ä'], choices=[('Å ÄÄÅ½ÄÅ¾Å¡Ä', 'Å ÄabcÄÅ½ÄÅ¾Å¡Ä'), ('ÄÅ¾Å¡Ä', 'abcÄÅ¾Å¡Ä')]), u'<ul>\\n<li><label><input type=\"checkbox\" name=\"nums\" value=\"1\" /> 1</label></li>\\n<li><label><input type=\"checkbox\" name=\"nums\" value=\"2\" /> 2</label></li>\\n<li><label><input type=\"checkbox\" name=\"nums\" value=\"3\" /> 3</label></li>\\n<li><label><input checked=\"checked\" type=\"checkbox\" name=\"nums\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" /> \\u0160\\u0110abc\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</label></li>\\n<li><label><input type=\"checkbox\" name=\"nums\" value=\"\\u0107\\u017e\\u0161\\u0111\" /> abc\\u0107\\u017e\\u0161\\u0111</label></li>\\n</ul>')\n+        self.assertHTMLEqual(w.render('nums', ['Å ÄÄÅ½ÄÅ¾Å¡Ä'], choices=[('Å ÄÄÅ½ÄÅ¾Å¡Ä', 'Å ÄabcÄÅ½ÄÅ¾Å¡Ä'), ('ÄÅ¾Å¡Ä', 'abcÄÅ¾Å¡Ä')]), u'<ul>\\n<li><label><input type=\"checkbox\" name=\"nums\" value=\"1\" /> 1</label></li>\\n<li><label><input type=\"checkbox\" name=\"nums\" value=\"2\" /> 2</label></li>\\n<li><label><input type=\"checkbox\" name=\"nums\" value=\"3\" /> 3</label></li>\\n<li><label><input checked=\"checked\" type=\"checkbox\" name=\"nums\" value=\"\\u0160\\u0110\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111\" /> \\u0160\\u0110abc\\u0106\\u017d\\u0107\\u017e\\u0161\\u0111</label></li>\\n<li><label><input type=\"checkbox\" name=\"nums\" value=\"\\u0107\\u017e\\u0161\\u0111\" /> abc\\u0107\\u017e\\u0161\\u0111</label></li>\\n</ul>')\n \n         # Each input gets a separate ID\n-        self.assertEqual(CheckboxSelectMultiple().render('letters', list('ac'), choices=zip(list('abc'), list('ABC')), attrs={'id': 'abc'}), \"\"\"<ul>\n+        self.assertHTMLEqual(CheckboxSelectMultiple().render('letters', list('ac'), choices=zip(list('abc'), list('ABC')), attrs={'id': 'abc'}), \"\"\"<ul>\n <li><label for=\"abc_0\"><input checked=\"checked\" type=\"checkbox\" name=\"letters\" value=\"a\" id=\"abc_0\" /> A</label></li>\n <li><label for=\"abc_1\"><input type=\"checkbox\" name=\"letters\" value=\"b\" id=\"abc_1\" /> B</label></li>\n <li><label for=\"abc_2\"><input checked=\"checked\" type=\"checkbox\" name=\"letters\" value=\"c\" id=\"abc_2\" /> C</label></li>\n@@ -866,11 +866,11 @@ def format_output(self, rendered_widgets):\n                 return u'<br />'.join(rendered_widgets)\n \n         w = MyMultiWidget(widgets=(TextInput(attrs={'class': 'big'}), TextInput(attrs={'class': 'small'})))\n-        self.assertEqual(w.render('name', ['john', 'lennon']), u'<input type=\"text\" class=\"big\" value=\"john\" name=\"name_0\" /><br /><input type=\"text\" class=\"small\" value=\"lennon\" name=\"name_1\" />')\n-        self.assertEqual(w.render('name', 'john__lennon'), u'<input type=\"text\" class=\"big\" value=\"john\" name=\"name_0\" /><br /><input type=\"text\" class=\"small\" value=\"lennon\" name=\"name_1\" />')\n-        self.assertEqual(w.render('name', 'john__lennon', attrs={'id':'foo'}), u'<input id=\"foo_0\" type=\"text\" class=\"big\" value=\"john\" name=\"name_0\" /><br /><input id=\"foo_1\" type=\"text\" class=\"small\" value=\"lennon\" name=\"name_1\" />')\n+        self.assertHTMLEqual(w.render('name', ['john', 'lennon']), u'<input type=\"text\" class=\"big\" value=\"john\" name=\"name_0\" /><br /><input type=\"text\" class=\"small\" value=\"lennon\" name=\"name_1\" />')\n+        self.assertHTMLEqual(w.render('name', 'john__lennon'), u'<input type=\"text\" class=\"big\" value=\"john\" name=\"name_0\" /><br /><input type=\"text\" class=\"small\" value=\"lennon\" name=\"name_1\" />')\n+        self.assertHTMLEqual(w.render('name', 'john__lennon', attrs={'id':'foo'}), u'<input id=\"foo_0\" type=\"text\" class=\"big\" value=\"john\" name=\"name_0\" /><br /><input id=\"foo_1\" type=\"text\" class=\"small\" value=\"lennon\" name=\"name_1\" />')\n         w = MyMultiWidget(widgets=(TextInput(attrs={'class': 'big'}), TextInput(attrs={'class': 'small'})), attrs={'id': 'bar'})\n-        self.assertEqual(w.render('name', ['john', 'lennon']), u'<input id=\"bar_0\" type=\"text\" class=\"big\" value=\"john\" name=\"name_0\" /><br /><input id=\"bar_1\" type=\"text\" class=\"small\" value=\"lennon\" name=\"name_1\" />')\n+        self.assertHTMLEqual(w.render('name', ['john', 'lennon']), u'<input id=\"bar_0\" type=\"text\" class=\"big\" value=\"john\" name=\"name_0\" /><br /><input id=\"bar_1\" type=\"text\" class=\"small\" value=\"lennon\" name=\"name_1\" />')\n \n         w = MyMultiWidget(widgets=(TextInput(), TextInput()))\n \n@@ -889,37 +889,37 @@ def format_output(self, rendered_widgets):\n \n     def test_splitdatetime(self):\n         w = SplitDateTimeWidget()\n-        self.assertEqual(w.render('date', ''), u'<input type=\"text\" name=\"date_0\" /><input type=\"text\" name=\"date_1\" />')\n-        self.assertEqual(w.render('date', None), u'<input type=\"text\" name=\"date_0\" /><input type=\"text\" name=\"date_1\" />')\n-        self.assertEqual(w.render('date', datetime.datetime(2006, 1, 10, 7, 30)), u'<input type=\"text\" name=\"date_0\" value=\"2006-01-10\" /><input type=\"text\" name=\"date_1\" value=\"07:30:00\" />')\n-        self.assertEqual(w.render('date', [datetime.date(2006, 1, 10), datetime.time(7, 30)]), u'<input type=\"text\" name=\"date_0\" value=\"2006-01-10\" /><input type=\"text\" name=\"date_1\" value=\"07:30:00\" />')\n+        self.assertHTMLEqual(w.render('date', ''), u'<input type=\"text\" name=\"date_0\" /><input type=\"text\" name=\"date_1\" />')\n+        self.assertHTMLEqual(w.render('date', None), u'<input type=\"text\" name=\"date_0\" /><input type=\"text\" name=\"date_1\" />')\n+        self.assertHTMLEqual(w.render('date', datetime.datetime(2006, 1, 10, 7, 30)), u'<input type=\"text\" name=\"date_0\" value=\"2006-01-10\" /><input type=\"text\" name=\"date_1\" value=\"07:30:00\" />')\n+        self.assertHTMLEqual(w.render('date', [datetime.date(2006, 1, 10), datetime.time(7, 30)]), u'<input type=\"text\" name=\"date_0\" value=\"2006-01-10\" /><input type=\"text\" name=\"date_1\" value=\"07:30:00\" />')\n \n         # You can also pass 'attrs' to the constructor. In this case, the attrs will be\n         w = SplitDateTimeWidget(attrs={'class': 'pretty'})\n-        self.assertEqual(w.render('date', datetime.datetime(2006, 1, 10, 7, 30)), u'<input type=\"text\" class=\"pretty\" value=\"2006-01-10\" name=\"date_0\" /><input type=\"text\" class=\"pretty\" value=\"07:30:00\" name=\"date_1\" />')\n+        self.assertHTMLEqual(w.render('date', datetime.datetime(2006, 1, 10, 7, 30)), u'<input type=\"text\" class=\"pretty\" value=\"2006-01-10\" name=\"date_0\" /><input type=\"text\" class=\"pretty\" value=\"07:30:00\" name=\"date_1\" />')\n \n         # Use 'date_format' and 'time_format' to change the way a value is displayed.\n         w = SplitDateTimeWidget(date_format='%d/%m/%Y', time_format='%H:%M')\n-        self.assertEqual(w.render('date', datetime.datetime(2006, 1, 10, 7, 30)), u'<input type=\"text\" name=\"date_0\" value=\"10/01/2006\" /><input type=\"text\" name=\"date_1\" value=\"07:30\" />')\n+        self.assertHTMLEqual(w.render('date', datetime.datetime(2006, 1, 10, 7, 30)), u'<input type=\"text\" name=\"date_0\" value=\"10/01/2006\" /><input type=\"text\" name=\"date_1\" value=\"07:30\" />')\n \n         self.assertTrue(w._has_changed(datetime.datetime(2008, 5, 6, 12, 40, 00), [u'2008-05-06', u'12:40:00']))\n         self.assertFalse(w._has_changed(datetime.datetime(2008, 5, 6, 12, 40, 00), [u'06/05/2008', u'12:40']))\n         self.assertTrue(w._has_changed(datetime.datetime(2008, 5, 6, 12, 40, 00), [u'06/05/2008', u'12:41']))\n \n     def test_datetimeinput(self):\n         w = DateTimeInput()\n-        self.assertEqual(w.render('date', None), u'<input type=\"text\" name=\"date\" />')\n+        self.assertHTMLEqual(w.render('date', None), u'<input type=\"text\" name=\"date\" />')\n         d = datetime.datetime(2007, 9, 17, 12, 51, 34, 482548)\n         self.assertEqual(str(d), '2007-09-17 12:51:34.482548')\n \n         # The microseconds are trimmed on display, by default.\n-        self.assertEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"2007-09-17 12:51:34\" />')\n-        self.assertEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51, 34)), u'<input type=\"text\" name=\"date\" value=\"2007-09-17 12:51:34\" />')\n-        self.assertEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51)), u'<input type=\"text\" name=\"date\" value=\"2007-09-17 12:51:00\" />')\n+        self.assertHTMLEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"2007-09-17 12:51:34\" />')\n+        self.assertHTMLEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51, 34)), u'<input type=\"text\" name=\"date\" value=\"2007-09-17 12:51:34\" />')\n+        self.assertHTMLEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51)), u'<input type=\"text\" name=\"date\" value=\"2007-09-17 12:51:00\" />')\n \n         # Use 'format' to change the way a value is displayed.\n         w = DateTimeInput(format='%d/%m/%Y %H:%M')\n-        self.assertEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"17/09/2007 12:51\" />')\n+        self.assertHTMLEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"17/09/2007 12:51\" />')\n         self.assertFalse(w._has_changed(d, '17/09/2007 12:51'))\n \n         # Make sure a custom format works with _has_changed. The hidden input will use\n@@ -930,19 +930,19 @@ def test_datetimeinput(self):\n \n     def test_dateinput(self):\n         w = DateInput()\n-        self.assertEqual(w.render('date', None), u'<input type=\"text\" name=\"date\" />')\n+        self.assertHTMLEqual(w.render('date', None), u'<input type=\"text\" name=\"date\" />')\n         d = datetime.date(2007, 9, 17)\n         self.assertEqual(str(d), '2007-09-17')\n \n-        self.assertEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"2007-09-17\" />')\n-        self.assertEqual(w.render('date', datetime.date(2007, 9, 17)), u'<input type=\"text\" name=\"date\" value=\"2007-09-17\" />')\n+        self.assertHTMLEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"2007-09-17\" />')\n+        self.assertHTMLEqual(w.render('date', datetime.date(2007, 9, 17)), u'<input type=\"text\" name=\"date\" value=\"2007-09-17\" />')\n \n         # We should be able to initialize from a unicode value.\n-        self.assertEqual(w.render('date', u'2007-09-17'), u'<input type=\"text\" name=\"date\" value=\"2007-09-17\" />')\n+        self.assertHTMLEqual(w.render('date', u'2007-09-17'), u'<input type=\"text\" name=\"date\" value=\"2007-09-17\" />')\n \n         # Use 'format' to change the way a value is displayed.\n         w = DateInput(format='%d/%m/%Y')\n-        self.assertEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"17/09/2007\" />')\n+        self.assertHTMLEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"17/09/2007\" />')\n         self.assertFalse(w._has_changed(d, '17/09/2007'))\n \n         # Make sure a custom format works with _has_changed. The hidden input will use\n@@ -953,21 +953,21 @@ def test_dateinput(self):\n \n     def test_timeinput(self):\n         w = TimeInput()\n-        self.assertEqual(w.render('time', None), u'<input type=\"text\" name=\"time\" />')\n+        self.assertHTMLEqual(w.render('time', None), u'<input type=\"text\" name=\"time\" />')\n         t = datetime.time(12, 51, 34, 482548)\n         self.assertEqual(str(t), '12:51:34.482548')\n \n         # The microseconds are trimmed on display, by default.\n-        self.assertEqual(w.render('time', t), u'<input type=\"text\" name=\"time\" value=\"12:51:34\" />')\n-        self.assertEqual(w.render('time', datetime.time(12, 51, 34)), u'<input type=\"text\" name=\"time\" value=\"12:51:34\" />')\n-        self.assertEqual(w.render('time', datetime.time(12, 51)), u'<input type=\"text\" name=\"time\" value=\"12:51:00\" />')\n+        self.assertHTMLEqual(w.render('time', t), u'<input type=\"text\" name=\"time\" value=\"12:51:34\" />')\n+        self.assertHTMLEqual(w.render('time', datetime.time(12, 51, 34)), u'<input type=\"text\" name=\"time\" value=\"12:51:34\" />')\n+        self.assertHTMLEqual(w.render('time', datetime.time(12, 51)), u'<input type=\"text\" name=\"time\" value=\"12:51:00\" />')\n \n         # We should be able to initialize from a unicode value.\n-        self.assertEqual(w.render('time', u'13:12:11'), u'<input type=\"text\" name=\"time\" value=\"13:12:11\" />')\n+        self.assertHTMLEqual(w.render('time', u'13:12:11'), u'<input type=\"text\" name=\"time\" value=\"13:12:11\" />')\n \n         # Use 'format' to change the way a value is displayed.\n         w = TimeInput(format='%H:%M')\n-        self.assertEqual(w.render('time', t), u'<input type=\"text\" name=\"time\" value=\"12:51\" />')\n+        self.assertHTMLEqual(w.render('time', t), u'<input type=\"text\" name=\"time\" value=\"12:51\" />')\n         self.assertFalse(w._has_changed(t, '12:51'))\n \n         # Make sure a custom format works with _has_changed. The hidden input will use\n@@ -980,12 +980,12 @@ def test_splithiddendatetime(self):\n         from django.forms.widgets import SplitHiddenDateTimeWidget\n \n         w = SplitHiddenDateTimeWidget()\n-        self.assertEqual(w.render('date', ''), u'<input type=\"hidden\" name=\"date_0\" /><input type=\"hidden\" name=\"date_1\" />')\n+        self.assertHTMLEqual(w.render('date', ''), u'<input type=\"hidden\" name=\"date_0\" /><input type=\"hidden\" name=\"date_1\" />')\n         d = datetime.datetime(2007, 9, 17, 12, 51, 34, 482548)\n-        self.assertEqual(str(d), '2007-09-17 12:51:34.482548')\n-        self.assertEqual(w.render('date', d), u'<input type=\"hidden\" name=\"date_0\" value=\"2007-09-17\" /><input type=\"hidden\" name=\"date_1\" value=\"12:51:34\" />')\n-        self.assertEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51, 34)), u'<input type=\"hidden\" name=\"date_0\" value=\"2007-09-17\" /><input type=\"hidden\" name=\"date_1\" value=\"12:51:34\" />')\n-        self.assertEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51)), u'<input type=\"hidden\" name=\"date_0\" value=\"2007-09-17\" /><input type=\"hidden\" name=\"date_1\" value=\"12:51:00\" />')\n+        self.assertHTMLEqual(str(d), '2007-09-17 12:51:34.482548')\n+        self.assertHTMLEqual(w.render('date', d), u'<input type=\"hidden\" name=\"date_0\" value=\"2007-09-17\" /><input type=\"hidden\" name=\"date_1\" value=\"12:51:34\" />')\n+        self.assertHTMLEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51, 34)), u'<input type=\"hidden\" name=\"date_0\" value=\"2007-09-17\" /><input type=\"hidden\" name=\"date_1\" value=\"12:51:34\" />')\n+        self.assertHTMLEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51)), u'<input type=\"hidden\" name=\"date_0\" value=\"2007-09-17\" /><input type=\"hidden\" name=\"date_1\" value=\"12:51:00\" />')\n \n \n class NullBooleanSelectLazyForm(Form):\n@@ -1012,26 +1012,26 @@ def test_datetimeinput(self):\n         w = DateTimeInput()\n         d = datetime.datetime(2007, 9, 17, 12, 51, 34, 482548)\n         w.is_localized = True\n-        self.assertEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"17.09.2007 12:51:34\" />')\n+        self.assertHTMLEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"17.09.2007 12:51:34\" />')\n \n     def test_dateinput(self):\n         w = DateInput()\n         d = datetime.date(2007, 9, 17)\n         w.is_localized = True\n-        self.assertEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"17.09.2007\" />')\n+        self.assertHTMLEqual(w.render('date', d), u'<input type=\"text\" name=\"date\" value=\"17.09.2007\" />')\n \n     def test_timeinput(self):\n         w = TimeInput()\n         t = datetime.time(12, 51, 34, 482548)\n         w.is_localized = True\n-        self.assertEqual(w.render('time', t), u'<input type=\"text\" name=\"time\" value=\"12:51:34\" />')\n+        self.assertHTMLEqual(w.render('time', t), u'<input type=\"text\" name=\"time\" value=\"12:51:34\" />')\n \n     def test_splithiddendatetime(self):\n         from django.forms.widgets import SplitHiddenDateTimeWidget\n \n         w = SplitHiddenDateTimeWidget()\n         w.is_localized = True\n-        self.assertEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51)), u'<input type=\"hidden\" name=\"date_0\" value=\"17.09.2007\" /><input type=\"hidden\" name=\"date_1\" value=\"12:51:00\" />')\n+        self.assertHTMLEqual(w.render('date', datetime.datetime(2007, 9, 17, 12, 51)), u'<input type=\"hidden\" name=\"date_0\" value=\"17.09.2007\" /><input type=\"hidden\" name=\"date_1\" value=\"12:51:00\" />')\n \n     def test_nullbooleanselect(self):\n         \"\"\"\n@@ -1040,7 +1040,7 @@ def test_nullbooleanselect(self):\n         Refs #17190\n         \"\"\"\n         f = NullBooleanSelectLazyForm()\n-        self.assertEqual(f.fields['bool'].widget.render('id_bool', True), u'<select name=\"id_bool\">\\n<option value=\"1\">Unbekannt</option>\\n<option value=\"2\" selected=\"selected\">Ja</option>\\n<option value=\"3\">Nein</option>\\n</select>')\n+        self.assertHTMLEqual(f.fields['bool'].widget.render('id_bool', True), u'<select name=\"id_bool\">\\n<option value=\"1\">Unbekannt</option>\\n<option value=\"2\" selected=\"selected\">Ja</option>\\n<option value=\"3\">Nein</option>\\n</select>')\n \n \n class SelectAndTextWidget(MultiWidget):\n@@ -1116,7 +1116,7 @@ def test_clear_input_renders(self):\n         \"\"\"\n         widget = ClearableFileInput()\n         widget.is_required = False\n-        self.assertEqual(widget.render('myfile', FakeFieldFile()),\n+        self.assertHTMLEqual(widget.render('myfile', FakeFieldFile()),\n                          u'Currently: <a href=\"something\">something</a> <input type=\"checkbox\" name=\"myfile-clear\" id=\"myfile-clear_id\" /> <label for=\"myfile-clear_id\">Clear</label><br />Change: <input type=\"file\" name=\"myfile\" />')\n \n     def test_html_escaped(self):\n@@ -1149,7 +1149,7 @@ def test_clear_input_renders_only_if_not_required(self):\n         \"\"\"\n         widget = ClearableFileInput()\n         widget.is_required = True\n-        self.assertEqual(widget.render('myfile', FakeFieldFile()),\n+        self.assertHTMLEqual(widget.render('myfile', FakeFieldFile()),\n                          u'Currently: <a href=\"something\">something</a> <br />Change: <input type=\"file\" name=\"myfile\" />')\n \n     def test_clear_input_renders_only_if_initial(self):\n@@ -1160,7 +1160,7 @@ def test_clear_input_renders_only_if_initial(self):\n         \"\"\"\n         widget = ClearableFileInput()\n         widget.is_required = False\n-        self.assertEqual(widget.render('myfile', None),\n+        self.assertHTMLEqual(widget.render('myfile', None),\n                          u'<input type=\"file\" name=\"myfile\" />')\n \n     def test_clear_input_checked_returns_false(self):"
        },
        {
            "sha": "db81eec47aa2a1819144d84be71720ffd6e62a36",
            "filename": "tests/regressiontests/generic_inline_admin/tests.py",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fgeneric_inline_admin%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fgeneric_inline_admin%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_inline_admin%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -101,22 +101,22 @@ def testGenericInlineFormset(self):\n         # Works with no queryset\n         formset = EpisodeMediaFormSet(instance=e)\n         self.assertEqual(len(formset.forms), 5)\n-        self.assertEqual(formset.forms[0].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-0-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-0-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-0-url\" value=\"http://example.com/podcast.mp3\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-0-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-0-id\" /></p>' % self.mp3_media_pk)\n-        self.assertEqual(formset.forms[1].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-1-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-1-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-1-url\" value=\"http://example.com/logo.png\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-1-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-1-id\" /></p>' % self.png_media_pk)\n-        self.assertEqual(formset.forms[2].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-2-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-2-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-2-url\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-2-id\" id=\"id_generic_inline_admin-media-content_type-object_id-2-id\" /></p>')\n+        self.assertHTMLEqual(formset.forms[0].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-0-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-0-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-0-url\" value=\"http://example.com/podcast.mp3\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-0-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-0-id\" /></p>' % self.mp3_media_pk)\n+        self.assertHTMLEqual(formset.forms[1].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-1-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-1-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-1-url\" value=\"http://example.com/logo.png\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-1-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-1-id\" /></p>' % self.png_media_pk)\n+        self.assertHTMLEqual(formset.forms[2].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-2-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-2-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-2-url\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-2-id\" id=\"id_generic_inline_admin-media-content_type-object_id-2-id\" /></p>')\n \n         # A queryset can be used to alter display ordering\n         formset = EpisodeMediaFormSet(instance=e, queryset=Media.objects.order_by('url'))\n         self.assertEqual(len(formset.forms), 5)\n-        self.assertEqual(formset.forms[0].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-0-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-0-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-0-url\" value=\"http://example.com/logo.png\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-0-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-0-id\" /></p>' % self.png_media_pk)\n-        self.assertEqual(formset.forms[1].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-1-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-1-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-1-url\" value=\"http://example.com/podcast.mp3\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-1-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-1-id\" /></p>' % self.mp3_media_pk)\n-        self.assertEqual(formset.forms[2].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-2-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-2-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-2-url\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-2-id\" id=\"id_generic_inline_admin-media-content_type-object_id-2-id\" /></p>')\n+        self.assertHTMLEqual(formset.forms[0].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-0-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-0-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-0-url\" value=\"http://example.com/logo.png\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-0-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-0-id\" /></p>' % self.png_media_pk)\n+        self.assertHTMLEqual(formset.forms[1].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-1-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-1-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-1-url\" value=\"http://example.com/podcast.mp3\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-1-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-1-id\" /></p>' % self.mp3_media_pk)\n+        self.assertHTMLEqual(formset.forms[2].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-2-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-2-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-2-url\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-2-id\" id=\"id_generic_inline_admin-media-content_type-object_id-2-id\" /></p>')\n \n         # Works with a queryset that omits items\n         formset = EpisodeMediaFormSet(instance=e, queryset=Media.objects.filter(url__endswith=\".png\"))\n         self.assertEqual(len(formset.forms), 4)\n-        self.assertEqual(formset.forms[0].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-0-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-0-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-0-url\" value=\"http://example.com/logo.png\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-0-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-0-id\" /></p>' % self.png_media_pk)\n-        self.assertEqual(formset.forms[1].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-1-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-1-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-1-url\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-1-id\" id=\"id_generic_inline_admin-media-content_type-object_id-1-id\" /></p>')\n+        self.assertHTMLEqual(formset.forms[0].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-0-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-0-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-0-url\" value=\"http://example.com/logo.png\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-0-id\" value=\"%s\" id=\"id_generic_inline_admin-media-content_type-object_id-0-id\" /></p>' % self.png_media_pk)\n+        self.assertHTMLEqual(formset.forms[1].as_p(), '<p><label for=\"id_generic_inline_admin-media-content_type-object_id-1-url\">Url:</label> <input id=\"id_generic_inline_admin-media-content_type-object_id-1-url\" type=\"text\" name=\"generic_inline_admin-media-content_type-object_id-1-url\" maxlength=\"200\" /><input type=\"hidden\" name=\"generic_inline_admin-media-content_type-object_id-1-id\" id=\"id_generic_inline_admin-media-content_type-object_id-1-id\" /></p>')\n \n     def testGenericInlineFormsetFactory(self):\n         # Regression test for #10522."
        },
        {
            "sha": "77bd35bab1d6254b203b8f5c662a9087a19da27c",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -388,7 +388,7 @@ def test_l10n_disabled(self):\n             })\n             self.assertEqual(True, form2.is_valid())\n             self.assertEqual(datetime.date(2009, 12, 31), form2.cleaned_data['date_field'])\n-            self.assertEqual(\n+            self.assertHTMLEqual(\n                 u'<select name=\"mydate_month\" id=\"id_mydate_month\">\\n<option value=\"1\">gener</option>\\n<option value=\"2\">febrer</option>\\n<option value=\"3\">mar\\xe7</option>\\n<option value=\"4\">abril</option>\\n<option value=\"5\">maig</option>\\n<option value=\"6\">juny</option>\\n<option value=\"7\">juliol</option>\\n<option value=\"8\">agost</option>\\n<option value=\"9\">setembre</option>\\n<option value=\"10\">octubre</option>\\n<option value=\"11\">novembre</option>\\n<option value=\"12\" selected=\"selected\">desembre</option>\\n</select>\\n<select name=\"mydate_day\" id=\"id_mydate_day\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"4\">4</option>\\n<option value=\"5\">5</option>\\n<option value=\"6\">6</option>\\n<option value=\"7\">7</option>\\n<option value=\"8\">8</option>\\n<option value=\"9\">9</option>\\n<option value=\"10\">10</option>\\n<option value=\"11\">11</option>\\n<option value=\"12\">12</option>\\n<option value=\"13\">13</option>\\n<option value=\"14\">14</option>\\n<option value=\"15\">15</option>\\n<option value=\"16\">16</option>\\n<option value=\"17\">17</option>\\n<option value=\"18\">18</option>\\n<option value=\"19\">19</option>\\n<option value=\"20\">20</option>\\n<option value=\"21\">21</option>\\n<option value=\"22\">22</option>\\n<option value=\"23\">23</option>\\n<option value=\"24\">24</option>\\n<option value=\"25\">25</option>\\n<option value=\"26\">26</option>\\n<option value=\"27\">27</option>\\n<option value=\"28\">28</option>\\n<option value=\"29\">29</option>\\n<option value=\"30\">30</option>\\n<option value=\"31\" selected=\"selected\">31</option>\\n</select>\\n<select name=\"mydate_year\" id=\"id_mydate_year\">\\n<option value=\"2009\" selected=\"selected\">2009</option>\\n<option value=\"2010\">2010</option>\\n<option value=\"2011\">2011</option>\\n<option value=\"2012\">2012</option>\\n<option value=\"2013\">2013</option>\\n<option value=\"2014\">2014</option>\\n<option value=\"2015\">2015</option>\\n<option value=\"2016\">2016</option>\\n<option value=\"2017\">2017</option>\\n<option value=\"2018\">2018</option>\\n</select>',\n                 SelectDateWidget(years=range(2009, 2019)).render('mydate', datetime.date(2009, 12, 31))\n             )\n@@ -517,14 +517,14 @@ def test_l10n_enabled(self):\n             })\n             self.assertEqual(True, form5.is_valid())\n             self.assertEqual(datetime.date(2009, 12, 31), form5.cleaned_data['date_field'])\n-            self.assertEqual(\n+            self.assertHTMLEqual(\n                 u'<select name=\"mydate_day\" id=\"id_mydate_day\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"4\">4</option>\\n<option value=\"5\">5</option>\\n<option value=\"6\">6</option>\\n<option value=\"7\">7</option>\\n<option value=\"8\">8</option>\\n<option value=\"9\">9</option>\\n<option value=\"10\">10</option>\\n<option value=\"11\">11</option>\\n<option value=\"12\">12</option>\\n<option value=\"13\">13</option>\\n<option value=\"14\">14</option>\\n<option value=\"15\">15</option>\\n<option value=\"16\">16</option>\\n<option value=\"17\">17</option>\\n<option value=\"18\">18</option>\\n<option value=\"19\">19</option>\\n<option value=\"20\">20</option>\\n<option value=\"21\">21</option>\\n<option value=\"22\">22</option>\\n<option value=\"23\">23</option>\\n<option value=\"24\">24</option>\\n<option value=\"25\">25</option>\\n<option value=\"26\">26</option>\\n<option value=\"27\">27</option>\\n<option value=\"28\">28</option>\\n<option value=\"29\">29</option>\\n<option value=\"30\">30</option>\\n<option value=\"31\" selected=\"selected\">31</option>\\n</select>\\n<select name=\"mydate_month\" id=\"id_mydate_month\">\\n<option value=\"1\">gener</option>\\n<option value=\"2\">febrer</option>\\n<option value=\"3\">mar\\xe7</option>\\n<option value=\"4\">abril</option>\\n<option value=\"5\">maig</option>\\n<option value=\"6\">juny</option>\\n<option value=\"7\">juliol</option>\\n<option value=\"8\">agost</option>\\n<option value=\"9\">setembre</option>\\n<option value=\"10\">octubre</option>\\n<option value=\"11\">novembre</option>\\n<option value=\"12\" selected=\"selected\">desembre</option>\\n</select>\\n<select name=\"mydate_year\" id=\"id_mydate_year\">\\n<option value=\"2009\" selected=\"selected\">2009</option>\\n<option value=\"2010\">2010</option>\\n<option value=\"2011\">2011</option>\\n<option value=\"2012\">2012</option>\\n<option value=\"2013\">2013</option>\\n<option value=\"2014\">2014</option>\\n<option value=\"2015\">2015</option>\\n<option value=\"2016\">2016</option>\\n<option value=\"2017\">2017</option>\\n<option value=\"2018\">2018</option>\\n</select>',\n                 SelectDateWidget(years=range(2009, 2019)).render('mydate', datetime.date(2009, 12, 31))\n             )\n \n         # Russian locale (with E as month)\n         with translation.override('ru', deactivate=True):\n-            self.assertEqual(\n+            self.assertHTMLEqual(\n                     u'<select name=\"mydate_day\" id=\"id_mydate_day\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"4\">4</option>\\n<option value=\"5\">5</option>\\n<option value=\"6\">6</option>\\n<option value=\"7\">7</option>\\n<option value=\"8\">8</option>\\n<option value=\"9\">9</option>\\n<option value=\"10\">10</option>\\n<option value=\"11\">11</option>\\n<option value=\"12\">12</option>\\n<option value=\"13\">13</option>\\n<option value=\"14\">14</option>\\n<option value=\"15\">15</option>\\n<option value=\"16\">16</option>\\n<option value=\"17\">17</option>\\n<option value=\"18\">18</option>\\n<option value=\"19\">19</option>\\n<option value=\"20\">20</option>\\n<option value=\"21\">21</option>\\n<option value=\"22\">22</option>\\n<option value=\"23\">23</option>\\n<option value=\"24\">24</option>\\n<option value=\"25\">25</option>\\n<option value=\"26\">26</option>\\n<option value=\"27\">27</option>\\n<option value=\"28\">28</option>\\n<option value=\"29\">29</option>\\n<option value=\"30\">30</option>\\n<option value=\"31\" selected=\"selected\">31</option>\\n</select>\\n<select name=\"mydate_month\" id=\"id_mydate_month\">\\n<option value=\"1\">\\u042f\\u043d\\u0432\\u0430\\u0440\\u044c</option>\\n<option value=\"2\">\\u0424\\u0435\\u0432\\u0440\\u0430\\u043b\\u044c</option>\\n<option value=\"3\">\\u041c\\u0430\\u0440\\u0442</option>\\n<option value=\"4\">\\u0410\\u043f\\u0440\\u0435\\u043b\\u044c</option>\\n<option value=\"5\">\\u041c\\u0430\\u0439</option>\\n<option value=\"6\">\\u0418\\u044e\\u043d\\u044c</option>\\n<option value=\"7\">\\u0418\\u044e\\u043b\\u044c</option>\\n<option value=\"8\">\\u0410\\u0432\\u0433\\u0443\\u0441\\u0442</option>\\n<option value=\"9\">\\u0421\\u0435\\u043d\\u0442\\u044f\\u0431\\u0440\\u044c</option>\\n<option value=\"10\">\\u041e\\u043a\\u0442\\u044f\\u0431\\u0440\\u044c</option>\\n<option value=\"11\">\\u041d\\u043e\\u044f\\u0431\\u0440\\u044c</option>\\n<option value=\"12\" selected=\"selected\">\\u0414\\u0435\\u043a\\u0430\\u0431\\u0440\\u044c</option>\\n</select>\\n<select name=\"mydate_year\" id=\"id_mydate_year\">\\n<option value=\"2009\" selected=\"selected\">2009</option>\\n<option value=\"2010\">2010</option>\\n<option value=\"2011\">2011</option>\\n<option value=\"2012\">2012</option>\\n<option value=\"2013\">2013</option>\\n<option value=\"2014\">2014</option>\\n<option value=\"2015\">2015</option>\\n<option value=\"2016\">2016</option>\\n<option value=\"2017\">2017</option>\\n<option value=\"2018\">2018</option>\\n</select>',\n                     SelectDateWidget(years=range(2009, 2019)).render('mydate', datetime.date(2009, 12, 31))\n             )\n@@ -589,7 +589,7 @@ def test_l10n_enabled(self):\n             })\n             self.assertEqual(True, form6.is_valid())\n             self.assertEqual(datetime.date(2009, 12, 31), form6.cleaned_data['date_field'])\n-            self.assertEqual(\n+            self.assertHTMLEqual(\n                 u'<select name=\"mydate_month\" id=\"id_mydate_month\">\\n<option value=\"1\">January</option>\\n<option value=\"2\">February</option>\\n<option value=\"3\">March</option>\\n<option value=\"4\">April</option>\\n<option value=\"5\">May</option>\\n<option value=\"6\">June</option>\\n<option value=\"7\">July</option>\\n<option value=\"8\">August</option>\\n<option value=\"9\">September</option>\\n<option value=\"10\">October</option>\\n<option value=\"11\">November</option>\\n<option value=\"12\" selected=\"selected\">December</option>\\n</select>\\n<select name=\"mydate_day\" id=\"id_mydate_day\">\\n<option value=\"1\">1</option>\\n<option value=\"2\">2</option>\\n<option value=\"3\">3</option>\\n<option value=\"4\">4</option>\\n<option value=\"5\">5</option>\\n<option value=\"6\">6</option>\\n<option value=\"7\">7</option>\\n<option value=\"8\">8</option>\\n<option value=\"9\">9</option>\\n<option value=\"10\">10</option>\\n<option value=\"11\">11</option>\\n<option value=\"12\">12</option>\\n<option value=\"13\">13</option>\\n<option value=\"14\">14</option>\\n<option value=\"15\">15</option>\\n<option value=\"16\">16</option>\\n<option value=\"17\">17</option>\\n<option value=\"18\">18</option>\\n<option value=\"19\">19</option>\\n<option value=\"20\">20</option>\\n<option value=\"21\">21</option>\\n<option value=\"22\">22</option>\\n<option value=\"23\">23</option>\\n<option value=\"24\">24</option>\\n<option value=\"25\">25</option>\\n<option value=\"26\">26</option>\\n<option value=\"27\">27</option>\\n<option value=\"28\">28</option>\\n<option value=\"29\">29</option>\\n<option value=\"30\">30</option>\\n<option value=\"31\" selected=\"selected\">31</option>\\n</select>\\n<select name=\"mydate_year\" id=\"id_mydate_year\">\\n<option value=\"2009\" selected=\"selected\">2009</option>\\n<option value=\"2010\">2010</option>\\n<option value=\"2011\">2011</option>\\n<option value=\"2012\">2012</option>\\n<option value=\"2013\">2013</option>\\n<option value=\"2014\">2014</option>\\n<option value=\"2015\">2015</option>\\n<option value=\"2016\">2016</option>\\n<option value=\"2017\">2017</option>\\n<option value=\"2018\">2018</option>\\n</select>',\n                 SelectDateWidget(years=range(2009, 2019)).render('mydate', datetime.date(2009, 12, 31))\n             )\n@@ -617,7 +617,7 @@ def test_localized_input(self):\n                 'products_delivered': 12000,\n             })\n             self.assertEqual(True, form6.is_valid())\n-            self.assertEqual(\n+            self.assertHTMLEqual(\n                 form6.as_ul(),\n                 u'<li><label for=\"id_name\">Name:</label> <input id=\"id_name\" type=\"text\" name=\"name\" value=\"acme\" maxlength=\"50\" /></li>\\n<li><label for=\"id_date_added\">Date added:</label> <input type=\"text\" name=\"date_added\" value=\"31.12.2009 06:00:00\" id=\"id_date_added\" /></li>\\n<li><label for=\"id_cents_paid\">Cents paid:</label> <input type=\"text\" name=\"cents_paid\" value=\"59,47\" id=\"id_cents_paid\" /></li>\\n<li><label for=\"id_products_delivered\">Products delivered:</label> <input type=\"text\" name=\"products_delivered\" value=\"12000\" id=\"id_products_delivered\" /></li>'\n             )"
        },
        {
            "sha": "b48fb7cff3abad8775c6714654526590efcf1854",
            "filename": "tests/regressiontests/localflavor/ar/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Far%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Far%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Far%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -33,7 +33,7 @@ def test_ARProvinceSelect(self):\n <option value=\"V\">Tierra del Fuego, Ant\\xe1rtida e Islas del Atl\\xe1ntico Sur</option>\n <option value=\"T\">Tucum\\xe1n</option>\n </select>'''\n-        self.assertEqual(f.render('provincias', 'A'), out)\n+        self.assertHTMLEqual(f.render('provincias', 'A'), out)\n \n     def test_ARPostalCodeField(self):\n         error_format = [u'Enter a postal code in the format NNNN or ANNNNAAA.']"
        },
        {
            "sha": "d47e97012368fbb2b01d99bf901fc23d09f49554",
            "filename": "tests/regressiontests/localflavor/at/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fat%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fat%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fat%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -18,7 +18,7 @@ def test_ATStateSelect(self):\n <option value=\"VO\">Vorarlberg</option>\n <option value=\"WI\" selected=\"selected\">Vienna</option>\n </select>'''\n-        self.assertEqual(f.render('bundesland', 'WI'), out)\n+        self.assertHTMLEqual(f.render('bundesland', 'WI'), out)\n \n     def test_ATZipCodeField(self):\n         error_format = [u'Enter a zip code in the format XXXX.']"
        },
        {
            "sha": "42673a902b7fd132c82ccac0d1c9807eb85af083",
            "filename": "tests/regressiontests/localflavor/au/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fau%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fau%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fau%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -76,7 +76,7 @@ def test_AUStateSelect(self):\n <option value=\"VIC\">Victoria</option>\n <option value=\"WA\">Western Australia</option>\n </select>'''\n-        self.assertEqual(f.render('state', 'NSW'), out)\n+        self.assertHTMLEqual(f.render('state', 'NSW'), out)\n \n     def test_AUPostCodeField(self):\n         error_format = [u'Enter a 4 digit postcode.']"
        },
        {
            "sha": "6cfdfb3ffabaf8e75fec09ab9cdf72223fe98df7",
            "filename": "tests/regressiontests/localflavor/be/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fbe%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fbe%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fbe%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -59,7 +59,7 @@ def test_BERegionSelect(self):\n <option value=\"VLG\" selected=\"selected\">Flemish Region</option>\n <option value=\"WAL\">Wallonia</option>\n </select>'''\n-        self.assertEqual(f.render('regions', 'VLG'), out)\n+        self.assertHTMLEqual(f.render('regions', 'VLG'), out)\n \n     def test_BEProvinceSelect(self):\n         f = BEProvinceSelect()\n@@ -76,4 +76,4 @@ def test_BEProvinceSelect(self):\n <option value=\"WBR\">Walloon Brabant</option>\n <option value=\"VWV\">West Flanders</option>\n </select>'''\n-        self.assertEqual(f.render('provinces', 'WLG'), out)\n+        self.assertHTMLEqual(f.render('provinces', 'WLG'), out)"
        },
        {
            "sha": "5777bc350071f47f10c8bbe1b7747168d6aad3ac",
            "filename": "tests/regressiontests/localflavor/br/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fbr%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fbr%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fbr%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -105,7 +105,7 @@ def test_BRStateSelect(self):\n <option value=\"SE\">Sergipe</option>\n <option value=\"TO\">Tocantins</option>\n </select>'''\n-        self.assertEqual(f.render('states', 'PR'), out)\n+        self.assertHTMLEqual(f.render('states', 'PR'), out)\n \n     def test_BRStateChoiceField(self):\n         error_invalid = [u'Select a valid brazilian state. That state is not one of the available states.']"
        },
        {
            "sha": "05d2fe2ac4a0bc137c03e7cee3a8c38ef6e7232b",
            "filename": "tests/regressiontests/localflavor/ca/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fca%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fca%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fca%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -36,7 +36,7 @@ def test_CAProvinceSelect(self):\n <option value=\"SK\">Saskatchewan</option>\n <option value=\"YT\">Yukon</option>\n </select>'''\n-        self.assertEqual(f.render('province', 'AB'), out)\n+        self.assertHTMLEqual(f.render('province', 'AB'), out)\n \n     def test_CAPostalCodeField(self):\n         error_format = [u'Enter a postal code in the format XXX XXX.']"
        },
        {
            "sha": "17660a46d232631bf2cea51f564405a8eda506c0",
            "filename": "tests/regressiontests/localflavor/ch/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fch%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fch%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fch%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -35,7 +35,7 @@ def test_CHStateSelect(self):\n <option value=\"ZG\">Zug</option>\n <option value=\"ZH\">Zurich</option>\n </select>'''\n-        self.assertEqual(f.render('state', 'AG'), out)\n+        self.assertHTMLEqual(f.render('state', 'AG'), out)\n \n     def test_CHZipCodeField(self):\n         error_format = [u'Enter a zip code in the format XXXX.']"
        },
        {
            "sha": "250f5645a0cff52427e92ec21dee3ae6a54c25bf",
            "filename": "tests/regressiontests/localflavor/cl/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fcl%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fcl%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fcl%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -23,7 +23,7 @@ def test_CLRegionSelect(self):\n <option value=\"XIV\">Regi\\xf3n de Los R\\xedos</option>\n <option value=\"XV\">Regi\\xf3n de Arica-Parinacota</option>\n </select>'''\n-        self.assertEqual(f.render('foo', 'bar'), out)\n+        self.assertHTMLEqual(f.render('foo', 'bar'), out)\n \n     def test_CLRutField(self):\n         error_invalid =  [u'The Chilean RUT is not valid.']"
        },
        {
            "sha": "ac4331cca99c562bbb64dd252cda3f6aa97e4241",
            "filename": "tests/regressiontests/localflavor/cn/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fcn%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fcn%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fcn%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -43,7 +43,7 @@ def test_CNProvinceSelect(self):\n <option value=\"yunnan\">\\u4e91\\u5357</option>\n <option value=\"zhejiang\">\\u6d59\\u6c5f</option>\n </select>'''\n-        self.assertEqual(f.render('provinces', 'hubei'), correct_output)\n+        self.assertHTMLEqual(f.render('provinces', 'hubei'), correct_output)\n \n     def test_CNPostCodeField(self):\n         error_format = [u'Enter a post code in the format XXXXXX.']"
        },
        {
            "sha": "4ab17680824dd08af432586f66e8f16a75a5366c",
            "filename": "tests/regressiontests/localflavor/co/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fco%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fco%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fco%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -40,4 +40,4 @@ def test_CODepartmentSelect(self):\n <option value=\"VAU\">Vaup\\xe9s</option>\n <option value=\"VID\">Vichada</option>\n </select>\"\"\"\n-        self.assertEqual(d.render('department', 'COR'), out)\n+        self.assertHTMLEqual(d.render('department', 'COR'), out)"
        },
        {
            "sha": "becc02ba9cf06f274f5da544139363f862fba5a3",
            "filename": "tests/regressiontests/localflavor/cz/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fcz%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fcz%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fcz%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -37,7 +37,7 @@ def test_CZRegionSelect(self):\n <option value=\"ZL\">Zlin Region</option>\n <option value=\"MS\">Moravian-Silesian Region</option>\n </select>'''\n-        self.assertEqual(f.render('regions', 'TT'), out)\n+        self.assertHTMLEqual(f.render('regions', 'TT'), out)\n \n     def test_CZPostalCodeField(self):\n         error_format = [u'Enter a postal code in the format XXXXX or XXX XX.']"
        },
        {
            "sha": "a3f75ce2f1fb09d22032faea1595414b7b29cddc",
            "filename": "tests/regressiontests/localflavor/de/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fde%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fde%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fde%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -25,7 +25,7 @@ def test_DEStateSelect(self):\n <option value=\"SH\">Schleswig-Holstein</option>\n <option value=\"TH\" selected=\"selected\">Thuringia</option>\n </select>'''\n-        self.assertEqual(f.render('states', 'TH'), out)\n+        self.assertHTMLEqual(f.render('states', 'TH'), out)\n \n     def test_DEZipCodeField(self):\n         error_format = [u'Enter a zip code in the format XXXXX.']"
        },
        {
            "sha": "0ebe2f396d417ad38ed3e551eda95980dab3fdcd",
            "filename": "tests/regressiontests/localflavor/ec/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fec%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fec%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fec%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -31,4 +31,4 @@ def test_ECProvinceSelect(self):\n <option value=\"T\">Tungurahua</option>\n <option value=\"Z\">Zamora Chinchipe</option>\n </select>\"\"\"\n-        self.assertEqual(p.render('province', 'U'), out)\n+        self.assertHTMLEqual(p.render('province', 'U'), out)"
        },
        {
            "sha": "c989e3e9cac4fff3ccca8ceb3508cab49e7bf8f0",
            "filename": "tests/regressiontests/localflavor/es/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fes%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fes%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fes%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -26,7 +26,7 @@ def test_ESRegionSelect(self):\n <option value=\"NA\">Foral Community of Navarre</option>\n <option value=\"VC\">Valencian Community</option>\n </select>'''\n-        self.assertEqual(f.render('regions', 'CT'), out)\n+        self.assertHTMLEqual(f.render('regions', 'CT'), out)\n \n     def test_ESProvinceSelect(self):\n         f = ESProvinceSelect()\n@@ -84,7 +84,7 @@ def test_ESProvinceSelect(self):\n <option value=\"51\">Ceuta</option>\n <option value=\"52\">Melilla</option>\n </select>'''\n-        self.assertEqual(f.render('provinces', '08'), out)\n+        self.assertHTMLEqual(f.render('provinces', '08'), out)\n \n     def test_ESPostalCodeField(self):\n         error_invalid = [u'Enter a valid postal code in the range and format 01XXX - 52XXX.']"
        },
        {
            "sha": "70fce29f45b68a7aa6ada94b72a7b692180f38ef",
            "filename": "tests/regressiontests/localflavor/fi/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Ffi%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Ffi%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Ffi%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -351,7 +351,7 @@ def test_FIMunicipalitySelect(self):\n <option value=\"ahtari\">\\xc4ht\\xe4ri</option>\n <option value=\"aanekoski\">\\xc4\\xe4nekoski</option>\n </select>'''\n-        self.assertEqual(f.render('municipalities', 'turku'), out)\n+        self.assertHTMLEqual(f.render('municipalities', 'turku'), out)\n \n     def test_FIZipCodeField(self):\n         error_format = [u'Enter a zip code in the format XXXXX.']"
        },
        {
            "sha": "2ada11c25a9512f6a6f8d77ae6cb781fceb480fa",
            "filename": "tests/regressiontests/localflavor/fr/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Ffr%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Ffr%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Ffr%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -142,4 +142,4 @@ def test_FRDepartmentSelect(self):\n <option value=\"987\">987 - Polynesie Francaise</option>\n <option value=\"988\">988 - Nouvelle-Caledonie</option>\n </select>'''\n-        self.assertEqual(f.render('dep', 'Paris'), out)\n+        self.assertHTMLEqual(f.render('dep', 'Paris'), out)"
        },
        {
            "sha": "7050d7c5c2d9074e15739cfc3a98144c13367690",
            "filename": "tests/regressiontests/localflavor/hr/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fhr%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fhr%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fhr%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -32,7 +32,7 @@ def test_HRCountySelect(self):\n <option value=\"ZDÅ½\">Zadarska Å¾upanija</option>\n <option value=\"ZGÅ½\">ZagrebaÄka Å¾upanija</option>\n </select>'''\n-        self.assertEqual(f.render('county', 'GZG'), out)\n+        self.assertHTMLEqual(f.render('county', 'GZG'), out)\n \n     def test_HRPhoneNumberPrefixSelect(self):\n         f = HRPhoneNumberPrefixSelect()\n@@ -64,7 +64,7 @@ def test_HRPhoneNumberPrefixSelect(self):\n <option value=\"98\">098</option>\n <option value=\"99\">099</option>\n </select>'''\n-        self.assertEqual(f.render('phone', '1'), out)\n+        self.assertHTMLEqual(f.render('phone', '1'), out)\n \n     def test_HRLicensePlatePrefixSelect(self):\n         f = HRLicensePlatePrefixSelect()\n@@ -104,7 +104,7 @@ def test_HRLicensePlatePrefixSelect(self):\n <option value=\"ZG\">ZG</option>\n <option value=\"Å½U\">Å½U</option>\n </select>'''\n-        self.assertEqual(f.render('license', 'BJ'), out)\n+        self.assertHTMLEqual(f.render('license', 'BJ'), out)\n \n     def test_HRPhoneNumberField(self):\n         error_invalid = [u'Enter a valid phone number']"
        },
        {
            "sha": "580083d3bfb609ad4826f36479869c35c917e955",
            "filename": "tests/regressiontests/localflavor/id/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fid%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fid%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fid%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -56,7 +56,7 @@ def test_IDProvinceSelect(self):\n <option value=\"SMS\">Sumatera Selatan</option>\n <option value=\"SMU\">Sumatera Utara</option>\n </select>'''\n-        self.assertEqual(f.render('provinces', 'LPG'), out)\n+        self.assertHTMLEqual(f.render('provinces', 'LPG'), out)\n \n     def test_IDLicensePlatePrefixSelect(self):\n         f = IDLicensePlatePrefixSelect()\n@@ -118,7 +118,7 @@ def test_IDLicensePlatePrefixSelect(self):\n <option value=\"W\">Sidoarjo</option>\n <option value=\"Z\">Garut</option>\n </select>'''\n-        self.assertEqual(f.render('codes', 'BE'), out)\n+        self.assertHTMLEqual(f.render('codes', 'BE'), out)\n \n     def test_IDPhoneNumberField(self):\n         error_invalid = [u'Enter a valid phone number']"
        },
        {
            "sha": "712f492a6545fb682fd86a7eadfca2ed78740cc3",
            "filename": "tests/regressiontests/localflavor/ie/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fie%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fie%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fie%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -40,4 +40,4 @@ def test_IECountySelect(self):\n <option value=\"wexford\">Wexford</option>\n <option value=\"wicklow\">Wicklow</option>\n </select>'''\n-        self.assertEqual(f.render('counties', 'dublin'), out)\n+        self.assertHTMLEqual(f.render('counties', 'dublin'), out)"
        },
        {
            "sha": "d079aed1f52449d33df3901c7768e941b2d50c44",
            "filename": "tests/regressiontests/localflavor/in_/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fin_%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fin_%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fin_%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -64,7 +64,7 @@ def test_INPStateSelect(self):\n <option value=\"LD\">Lakshadweep</option>\n <option value=\"PY\">Pondicherry</option>\n </select>'''\n-        self.assertEqual(f.render('state', 'AP'), out)\n+        self.assertHTMLEqual(f.render('state', 'AP'), out)\n \n     def test_INZipCodeField(self):\n         error_format = [u'Enter a zip code in the format XXXXXX or XXX XXX.']"
        },
        {
            "sha": "835df6a8a72aec6bafbb99edfc7ff0d1b96aa9e5",
            "filename": "tests/regressiontests/localflavor/is_/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fis_%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fis_%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fis_%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -156,7 +156,7 @@ def test_ISPostalCodeSelect(self):\n <option value=\"900\">900 Vestmannaeyjar</option>\n <option value=\"902\">902 Vestmannaeyjar</option>\n </select>'''\n-        self.assertEqual(f.render('foo', 'bar'), out)\n+        self.assertHTMLEqual(f.render('foo', 'bar'), out)\n \n     def test_ISIdNumberField(self):\n         error_atleast = [u'Ensure this value has at least 10 characters (it has 9).']"
        },
        {
            "sha": "b774141c2d93451f4cf4733eaa9a934e8b12b2e0",
            "filename": "tests/regressiontests/localflavor/it/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fit%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fit%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fit%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -29,7 +29,7 @@ def test_ITRegionSelect(self):\n <option value=\"VAO\">Valle d\\u2019Aosta</option>\n <option value=\"VEN\">Veneto</option>\n </select>'''\n-        self.assertEqual(f.render('regions', 'PMN'), out)\n+        self.assertHTMLEqual(f.render('regions', 'PMN'), out)\n \n     def test_ITZipCodeField(self):\n         error_invalid = [u'Enter a valid zip code.']"
        },
        {
            "sha": "7f0e8be184d94275bda4ff90b9afeed2782a6bb8",
            "filename": "tests/regressiontests/localflavor/jp/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fjp%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fjp%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fjp%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -56,7 +56,7 @@ def test_JPPrefectureSelect(self):\n <option value=\"kagoshima\">Kagoshima</option>\n <option value=\"okinawa\">Okinawa</option>\n </select>'''\n-        self.assertEqual(f.render('prefecture', 'kanagawa'), out)\n+        self.assertHTMLEqual(f.render('prefecture', 'kanagawa'), out)\n \n     def test_JPPostalCodeField(self):\n         error_format = [u'Enter a postal code in the format XXXXXXX or XXX-XXXX.']"
        },
        {
            "sha": "f78dbdd440a28a3dafcd83637a5c2ed9e5145165",
            "filename": "tests/regressiontests/localflavor/mk/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fmk%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fmk%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fmk%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -180,7 +180,7 @@ def test_field_blank_option(self):\n <option value=\"ST\">\\xc5\\xa0tip</option>\n <option value=\"SO\">\\xc5\\xa0uto Orizari</option>\n </select>\"\"\"\n-        self.assertEqual(str(self.form['municipality']), municipality_select_html)\n+        self.assertHTMLEqual(str(self.form['municipality']), municipality_select_html)\n \n     def test_MKIdentityCardNumberField(self):\n         error_invalid  = [u'Identity card numbers must contain either 4 to 7 '\n@@ -284,7 +284,7 @@ def test_MKMunicipalitySelect(self):\n <option value=\"ST\">\\u0160tip</option>\n <option value=\"SO\">\\u0160uto Orizari</option>\n </select>'''\n-        self.assertEqual(f.render('municipality', 'DL' ), out)\n+        self.assertHTMLEqual(f.render('municipality', 'DL' ), out)\n \n     def test_UMCNField(self):\n         error_invalid = [u'This field should contain exactly 13 digits.']"
        },
        {
            "sha": "1657596223fe7b2cf80d3b3a3cacbd0b06bd4107",
            "filename": "tests/regressiontests/localflavor/mx/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -75,7 +75,7 @@ def test_field_blank_option(self):\n <option value=\"YUC\">YucatÃ¡n</option>\n <option value=\"ZAC\">Zacatecas</option>\n </select>\"\"\"\n-        self.assertEqual(str(self.form['state']), state_select_html)\n+        self.assertHTMLEqual(str(self.form['state']), state_select_html)\n \n     def test_MXStateSelect(self):\n         f = MXStateSelect()\n@@ -113,7 +113,7 @@ def test_MXStateSelect(self):\n <option value=\"YUC\">YucatÃ¡n</option>\n <option value=\"ZAC\">Zacatecas</option>\n </select>'''\n-        self.assertEqual(f.render('state', 'MIC'), out)\n+        self.assertHTMLEqual(f.render('state', 'MIC'), out)\n \n     def test_MXZipCodeField(self):\n         error_format = [u'Enter a valid zip code in the format XXXXX.']"
        },
        {
            "sha": "ebe4cc138f95046659f6701ddb40ebf26299380b",
            "filename": "tests/regressiontests/localflavor/nl/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fnl%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fnl%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fnl%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -21,7 +21,7 @@ def test_NLProvinceSelect(self):\n <option value=\"ZE\">Zeeland</option>\n <option value=\"ZH\">Zuid-Holland</option>\n </select>'''\n-        self.assertEqual(f.render('provinces', 'OV'), out)\n+        self.assertHTMLEqual(f.render('provinces', 'OV'), out)\n \n     def test_NLPhoneNumberField(self):\n         error_invalid = [u'Enter a valid phone number']"
        },
        {
            "sha": "bc4d260abc75a5449226da15b3da2105f9957dc3",
            "filename": "tests/regressiontests/localflavor/pl/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fpl%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fpl%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fpl%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -25,7 +25,7 @@ def test_PLProvinceSelect(self):\n <option value=\"greater_poland\">Greater Poland</option>\n <option value=\"west_pomerania\">West Pomerania</option>\n </select>'''\n-        self.assertEqual(f.render('voivodeships', 'pomerania'), out)\n+        self.assertHTMLEqual(f.render('voivodeships', 'pomerania'), out)\n \n     def test_PLCountrySelect(self):\n         f = PLCountySelect()\n@@ -407,7 +407,7 @@ def test_PLCountrySelect(self):\n <option value=\"swidwinski\">\\u015bwidwi\\u0144ski</option>\n <option value=\"walecki\">wa\\u0142ecki</option>\n </select>'''\n-        self.assertEqual(f.render('administrativeunit', 'katowice'), out)\n+        self.assertHTMLEqual(f.render('administrativeunit', 'katowice'), out)\n \n     def test_PLPostalCodeField(self):\n         error_format = [u'Enter a postal code in the format XX-XXX.']"
        },
        {
            "sha": "772039d3efa628e7a86eb41df86f5c08e957aef0",
            "filename": "tests/regressiontests/localflavor/py/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fpy%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fpy%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fpy%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -26,7 +26,7 @@ def test_PyDepartmentSelect(self):\n <option value=\"PH\">Pdte. Hayes</option>\n <option value=\"SP\">San Pedro</option>\n </select>'''\n-        self.assertEqual(py.render('department', 'M'), out)\n+        self.assertHTMLEqual(py.render('department', 'M'), out)\n \n     def test_PyNumberedDepartmentSelect(self):\n         py = PyNumberedDepartmentSelect()\n@@ -50,4 +50,4 @@ def test_PyNumberedDepartmentSelect(self):\n <option value=\"BQ\">XVII Boquer\\xf3n</option>\n <option value=\"AS\">XVIII Asunci\\xf3n</option>\n </select>'''\n-        self.assertEqual(py.render('department', 'AM'), out)\n+        self.assertHTMLEqual(py.render('department', 'AM'), out)"
        },
        {
            "sha": "407e614b3e26611068a0f58e8b537a659ac1c4ac",
            "filename": "tests/regressiontests/localflavor/ro/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fro%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fro%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fro%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -53,7 +53,7 @@ def test_ROCountySelect(self):\n <option value=\"VL\">V\\xe2lcea</option>\n <option value=\"VN\">Vrancea</option>\n </select>'''\n-        self.assertEqual(f.render('county', 'CJ'), out)\n+        self.assertHTMLEqual(f.render('county', 'CJ'), out)\n \n     def test_ROCIFField(self):\n         error_invalid = [u'Enter a valid CIF.']"
        },
        {
            "sha": "bb85fe8181556ea42d9d6ee4c5ae435ba15e8909",
            "filename": "tests/regressiontests/localflavor/ru/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fru%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fru%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fru%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -56,7 +56,7 @@ def test_RUCountySelect(self):\n <option value=\"Privolzhsky Federal County\">Privolzhsky Federal County</option>\n <option value=\"North-Caucasian Federal County\">North-Caucasian Federal County</option>\n </select>'''\n-        self.assertEqual(f.render('county', None), out)\n+        self.assertHTMLEqual(f.render('county', None), out)\n \n     def test_RURegionSelect(self):\n         f = RURegionSelect()\n@@ -145,4 +145,4 @@ def test_RURegionSelect(self):\n <option value=\"87\">Chukotskiy avtonomnyy okrug</option>\n <option value=\"89\">Yamalo-Neneckiy avtonomnyy okrug</option>\n </select>'''\n-        self.assertEqual(f.render('region', '67'), out)\n+        self.assertHTMLEqual(f.render('region', '67'), out)"
        },
        {
            "sha": "ead9053ea251bea1669e10f8a85953411efaa9b7",
            "filename": "tests/regressiontests/localflavor/se/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fse%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fse%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fse%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -47,7 +47,7 @@ def test_SECountySelect(self):\n <option value=\"Y\">V\\xe4sternorrland</option>\n <option value=\"Z\">J\\xe4mtland</option>\n </select>'''\n-        self.assertEqual(f.render('swedish_county', 'E'), out)\n+        self.assertHTMLEqual(f.render('swedish_county', 'E'), out)\n \n     def test_SEOrganizationNumberField(self):\n         error_invalid = [u'Enter a valid Swedish organisation number.']"
        },
        {
            "sha": "4e8fe25c47f34728b90a7fc7deaabd5ea713ee4e",
            "filename": "tests/regressiontests/localflavor/si/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fsi%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fsi%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fsi%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -553,4 +553,4 @@ def test_SIPostalCodeSelect(self):\n <option value=\"4274\">\\u017dirovnica</option>\n <option value=\"8360\">\\u017du\\u017eemberk</option>\n </select>'''\n-        self.assertEqual(f.render('Kranj', '4000'), out)\n+        self.assertHTMLEqual(f.render('Kranj', '4000'), out)"
        },
        {
            "sha": "319fd827be703006f1630c1ff582ae4da2fda2fe",
            "filename": "tests/regressiontests/localflavor/sk/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fsk%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fsk%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fsk%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -17,7 +17,7 @@ def test_SKRegionSelect(self):\n <option value=\"TT\" selected=\"selected\">Trnava region</option>\n <option value=\"ZA\">Zilina region</option>\n </select>'''\n-        self.assertEqual(f.render('regions', 'TT'), out)\n+        self.assertHTMLEqual(f.render('regions', 'TT'), out)\n \n     def test_SKDistrictSelect(self):\n         f = SKDistrictSelect()\n@@ -102,7 +102,7 @@ def test_SKDistrictSelect(self):\n <option value=\"ZH\">Ziar nad Hronom</option>\n <option value=\"ZA\">Zilina</option>\n </select>'''\n-        self.assertEqual(f.render('Districts', 'RK'), out)\n+        self.assertHTMLEqual(f.render('Districts', 'RK'), out)\n \n     def test_SKPostalCodeField(self):\n         error_format = [u'Enter a postal code in the format XXXXX or XXX XX.']"
        },
        {
            "sha": "a7f84ac4ae2c811dfbef8250f300f9de6a263d0a",
            "filename": "tests/regressiontests/localflavor/us/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fus%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fus%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fus%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -90,7 +90,7 @@ def test_field_blank_option(self):\n <option value=\"WI\">Wisconsin</option>\n <option value=\"WY\">Wyoming</option>\n </select>\"\"\"\n-        self.assertEqual(str(self.form['state']), state_select_html)\n+        self.assertHTMLEqual(str(self.form['state']), state_select_html)\n \n     def test_full_postal_code_list(self):\n         \"\"\"Test that the full USPS code field is really the full list.\"\"\"\n@@ -160,7 +160,7 @@ def test_full_postal_code_list(self):\n <option value=\"WI\">Wisconsin</option>\n <option value=\"WY\">Wyoming</option>\n </select>\"\"\"\n-        self.assertEqual(str(self.form['postal_code']), usps_select_html)\n+        self.assertHTMLEqual(str(self.form['postal_code']), usps_select_html)\n \n     def test_USStateSelect(self):\n         f = USStateSelect()\n@@ -225,7 +225,7 @@ def test_USStateSelect(self):\n <option value=\"WI\">Wisconsin</option>\n <option value=\"WY\">Wyoming</option>\n </select>'''\n-        self.assertEqual(f.render('state', 'IL'), out)\n+        self.assertHTMLEqual(f.render('state', 'IL'), out)\n \n     def test_USZipCodeField(self):\n         error_format = [u'Enter a zip code in the format XXXXX or XXXXX-XXXX.']"
        },
        {
            "sha": "eda0068d3e55e37ccc6f83b85e5137652ee46d03",
            "filename": "tests/regressiontests/localflavor/uy/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fuy%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Flocalflavor%2Fuy%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fuy%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -28,7 +28,7 @@ def test_UYDepartmentSelect(self):\n <option value=\"R\">Tacuaremb\\xf3</option>\n <option value=\"D\">Treinta y Tres</option>\n </select>'''\n-        self.assertEqual(f.render('departamentos', 'S'), out)\n+        self.assertHTMLEqual(f.render('departamentos', 'S'), out)\n \n     def test_UYCIField(self):\n         error_format = [u'Enter a valid CI number in X.XXX.XXX-X,XXXXXXX-X or XXXXXXXX format.']"
        },
        {
            "sha": "caf24d336ceef5309974804334ed1d2409b4889a",
            "filename": "tests/regressiontests/model_forms_regress/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fmodel_forms_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fmodel_forms_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmodel_forms_regress%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -134,7 +134,7 @@ def formfield_for_dbfield(db_field, **kwargs):\n         # Create a ModelForm, instantiate it, and check that the output is as expected\n         ModelForm = modelform_factory(Article, formfield_callback=formfield_for_dbfield)\n         form = ModelForm()\n-        self.assertEqual(form.as_ul(), u\"\"\"<li><label for=\"id_headline\">Headline:</label> <input id=\"id_headline\" type=\"text\" name=\"headline\" maxlength=\"100\" /></li>\n+        self.assertHTMLEqual(form.as_ul(), u\"\"\"<li><label for=\"id_headline\">Headline:</label> <input id=\"id_headline\" type=\"text\" name=\"headline\" maxlength=\"100\" /></li>\n <li><label for=\"id_publications\">Publications:</label> <select multiple=\"multiple\" name=\"publications\" id=\"id_publications\">\n <option value=\"%d\" selected=\"selected\">First Book</option>\n <option value=\"%d\" selected=\"selected\">Second Book</option>"
        },
        {
            "sha": "799d4f5901793ccd2cfc25637c1842c307860371",
            "filename": "tests/regressiontests/modeladmin/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fmodeladmin%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fmodeladmin%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmodeladmin%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -310,7 +310,7 @@ class ConcertAdmin(ModelAdmin):\n         ma = ConcertAdmin(Concert, self.site)\n         form = ma.get_form(request)()\n \n-        self.assertEqual(str(form[\"main_band\"]),\n+        self.assertHTMLEqual(str(form[\"main_band\"]),\n             '<select name=\"main_band\" id=\"id_main_band\">\\n'\n             '<option value=\"\" selected=\"selected\">---------</option>\\n'\n             '<option value=\"%d\">The Beatles</option>\\n'\n@@ -331,7 +331,7 @@ class ConcertAdmin(ModelAdmin):\n         ma = ConcertAdmin(Concert, self.site)\n         form = ma.get_form(request)()\n \n-        self.assertEqual(str(form[\"main_band\"]),\n+        self.assertHTMLEqual(str(form[\"main_band\"]),\n             '<select name=\"main_band\" id=\"id_main_band\">\\n'\n             '<option value=\"\" selected=\"selected\">---------</option>\\n'\n             '<option value=\"%d\">The Doors</option>\\n'"
        },
        {
            "sha": "19f35f9dbd46303deb1d1a0a2262407cd6c65f90",
            "filename": "tests/regressiontests/test_utils/tests.py",
            "status": "modified",
            "additions": 254,
            "deletions": 0,
            "changes": 254,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Ftest_utils%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Ftest_utils%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftest_utils%2Ftests.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -1,6 +1,8 @@\n+# -*- coding: utf-8 -*-\n from __future__ import with_statement, absolute_import\n \n from django.forms import EmailField, IntegerField\n+from django.http import HttpResponse\n from django.template.loader import render_to_string\n from django.test import SimpleTestCase, TestCase, skipUnlessDBFeature\n from django.utils.unittest import skip\n@@ -204,6 +206,258 @@ class MyWarning(Warning):\n         self.restore_warnings_state()\n \n \n+class HTMLEqualTests(TestCase):\n+    def test_html_parser(self):\n+        from django.test.html import parse_html\n+        element = parse_html('<div><p>Hello</p></div>')\n+        self.assertEqual(len(element.children), 1)\n+        self.assertEqual(element.children[0].name, 'p')\n+        self.assertEqual(element.children[0].children[0], 'Hello')\n+\n+        parse_html('<p>')\n+        parse_html('<p attr>')\n+        dom = parse_html('<p>foo')\n+        self.assertEqual(len(dom.children), 1)\n+        self.assertEqual(dom.name, 'p')\n+        self.assertEqual(dom[0], 'foo')\n+\n+    def test_parse_html_in_script(self):\n+        from django.test.html import parse_html\n+        parse_html('<script>var a = \"<p\" + \">\";</script>');\n+        parse_html('''\n+            <script>\n+            var js_sha_link='<p>***</p>';\n+            </script>\n+        ''')\n+\n+        # script content will be parsed to text\n+        dom = parse_html('''\n+            <script><p>foo</p> '</scr'+'ipt>' <span>bar</span></script>\n+        ''')\n+        self.assertEqual(len(dom.children), 1)\n+        self.assertEqual(dom.children[0], \"<p>foo</p> '</scr'+'ipt>' <span>bar</span>\")\n+\n+    def test_self_closing_tags(self):\n+        from django.test.html import parse_html\n+\n+        self_closing_tags = ('br' , 'hr', 'input', 'img', 'meta', 'spacer',\n+            'link', 'frame', 'base', 'col')\n+        for tag in self_closing_tags:\n+            dom = parse_html('<p>Hello <%s> world</p>' % tag)\n+            self.assertEqual(len(dom.children), 3)\n+            self.assertEqual(dom[0], 'Hello')\n+            self.assertEqual(dom[1].name, tag)\n+            self.assertEqual(dom[2], 'world')\n+\n+            dom = parse_html('<p>Hello <%s /> world</p>' % tag)\n+            self.assertEqual(len(dom.children), 3)\n+            self.assertEqual(dom[0], 'Hello')\n+            self.assertEqual(dom[1].name, tag)\n+            self.assertEqual(dom[2], 'world')\n+\n+    def test_simple_equal_html(self):\n+        self.assertHTMLEqual('', '')\n+        self.assertHTMLEqual('<p></p>', '<p></p>')\n+        self.assertHTMLEqual('<p></p>', ' <p> </p> ')\n+        self.assertHTMLEqual(\n+            '<div><p>Hello</p></div>',\n+            '<div><p>Hello</p></div>')\n+        self.assertHTMLEqual(\n+            '<div><p>Hello</p></div>',\n+            '<div> <p>Hello</p> </div>')\n+        self.assertHTMLEqual(\n+            '<div>\\n<p>Hello</p></div>',\n+            '<div><p>Hello</p></div>\\n')\n+        self.assertHTMLEqual(\n+            '<div><p>Hello\\nWorld !</p></div>',\n+            '<div><p>Hello World\\n!</p></div>')\n+        self.assertHTMLEqual(\n+            '<div><p>Hello\\nWorld !</p></div>',\n+            '<div><p>Hello World\\n!</p></div>')\n+        self.assertHTMLEqual(\n+            '<p>Hello  World   !</p>',\n+            '<p>Hello World\\n\\n!</p>')\n+        self.assertHTMLEqual('<p> </p>', '<p></p>')\n+        self.assertHTMLEqual('<p/>', '<p></p>')\n+        self.assertHTMLEqual('<p />', '<p></p>')\n+        self.assertHTMLEqual('<input checked>', '<input checked=\"checked\">')\n+        self.assertHTMLEqual('<p>Hello', '<p> Hello')\n+        self.assertHTMLEqual('<p>Hello</p>World', '<p>Hello</p> World')\n+\n+    def test_ignore_comments(self):\n+        self.assertHTMLEqual(\n+            '<div>Hello<!-- this is a comment --> World!</div>',\n+            '<div>Hello World!</div>')\n+\n+    def test_unequal_html(self):\n+        self.assertHTMLNotEqual('<p>Hello</p>', '<p>Hello!</p>')\n+        self.assertHTMLNotEqual('<p>foo&#20;bar</p>', '<p>foo&nbsp;bar</p>')\n+        self.assertHTMLNotEqual('<p>foo bar</p>', '<p>foo &nbsp;bar</p>')\n+        self.assertHTMLNotEqual('<p>foo nbsp</p>', '<p>foo &nbsp;</p>')\n+        self.assertHTMLNotEqual('<p>foo #20</p>', '<p>foo &#20;</p>')\n+        self.assertHTMLNotEqual(\n+            '<p><span>Hello</span><span>World</span></p>',\n+            '<p><span>Hello</span>World</p>')\n+        self.assertHTMLNotEqual(\n+            '<p><span>Hello</span>World</p>',\n+            '<p><span>Hello</span><span>World</span></p>')\n+\n+    def test_attributes(self):\n+        self.assertHTMLEqual(\n+            '<input type=\"text\" id=\"id_name\" />',\n+            '<input id=\"id_name\" type=\"text\" />')\n+        self.assertHTMLEqual(\n+            '''<input type='text' id=\"id_name\" />''',\n+            '<input id=\"id_name\" type=\"text\" />')\n+        self.assertHTMLNotEqual(\n+            '<input type=\"text\" id=\"id_name\" />',\n+            '<input type=\"password\" id=\"id_name\" />')\n+\n+    def test_complex_examples(self):\n+        self.assertHTMLEqual(\n+        \"\"\"<tr><th><label for=\"id_first_name\">First name:</label></th>\n+<td><input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" /></td></tr>\n+<tr><th><label for=\"id_last_name\">Last name:</label></th>\n+<td><input type=\"text\" id=\"id_last_name\" name=\"last_name\" value=\"Lennon\" /></td></tr>\n+<tr><th><label for=\"id_birthday\">Birthday:</label></th>\n+<td><input type=\"text\" value=\"1940-10-9\" name=\"birthday\" id=\"id_birthday\" /></td></tr>\"\"\",\n+        \"\"\"\n+        <tr><th>\n+            <label for=\"id_first_name\">First name:</label></th><td><input type=\"text\" name=\"first_name\" value=\"John\" id=\"id_first_name\" />\n+        </td></tr>\n+        <tr><th>\n+            <label for=\"id_last_name\">Last name:</label></th><td><input type=\"text\" name=\"last_name\" value=\"Lennon\" id=\"id_last_name\" />\n+        </td></tr>\n+        <tr><th>\n+            <label for=\"id_birthday\">Birthday:</label></th><td><input type=\"text\" name=\"birthday\" value=\"1940-10-9\" id=\"id_birthday\" />\n+        </td></tr>\n+        \"\"\")\n+\n+        self.assertHTMLEqual(\n+        \"\"\"<!DOCTYPE html>\n+        <html>\n+        <head>\n+            <link rel=\"stylesheet\">\n+            <title>Document</title>\n+            <meta attribute=\"value\">\n+        </head>\n+        <body>\n+            <p>\n+            This is a valid paragraph\n+            <div> this is a div AFTER the p</div>\n+        </body>\n+        </html>\"\"\", \"\"\"\n+        <html>\n+        <head>\n+            <link rel=\"stylesheet\">\n+            <title>Document</title>\n+            <meta attribute=\"value\">\n+        </head>\n+        <body>\n+            <p> This is a valid paragraph\n+            <!-- browsers would close the p tag here -->\n+            <div> this is a div AFTER the p</div>\n+            </p> <!-- this is invalid html parsing however it should make no\n+            difference in most cases -->\n+        </body>\n+        </html>\"\"\")\n+\n+    def test_html_contain(self):\n+        from django.test.html import parse_html\n+        # equal html contains each other\n+        dom1 = parse_html('<p>foo')\n+        dom2 = parse_html('<p>foo</p>')\n+        self.assertTrue(dom1 in dom2)\n+        self.assertTrue(dom2 in dom1)\n+\n+        dom2 = parse_html('<div><p>foo</p></div>')\n+        self.assertTrue(dom1 in dom2)\n+        self.assertTrue(dom2 not in dom1)\n+\n+        self.assertFalse('<p>foo</p>' in dom2)\n+        self.assertTrue('foo' in dom2)\n+\n+        # when a root element is used ...\n+        dom1 = parse_html('<p>foo</p><p>bar</p>')\n+        dom2 = parse_html('<p>foo</p><p>bar</p>')\n+        self.assertTrue(dom1 in dom2)\n+        dom1 = parse_html('<p>foo</p>')\n+        self.assertTrue(dom1 in dom2)\n+        dom1 = parse_html('<p>bar</p>')\n+        self.assertTrue(dom1 in dom2)\n+\n+    def test_count(self):\n+        from django.test.html import parse_html\n+        # equal html contains each other one time\n+        dom1 = parse_html('<p>foo')\n+        dom2 = parse_html('<p>foo</p>')\n+        self.assertEqual(dom1.count(dom2), 1)\n+        self.assertEqual(dom2.count(dom1), 1)\n+\n+        dom2 = parse_html('<p>foo</p><p>bar</p>')\n+        self.assertEqual(dom2.count(dom1), 1)\n+\n+        dom2 = parse_html('<p>foo foo</p><p>foo</p>')\n+        self.assertEqual(dom2.count('foo'), 3)\n+\n+        dom2 = parse_html('<p class=\"bar\">foo</p>')\n+        self.assertEqual(dom2.count('bar'), 0)\n+        self.assertEqual(dom2.count('class'), 0)\n+        self.assertEqual(dom2.count('p'), 0)\n+        self.assertEqual(dom2.count('o'), 2)\n+\n+        dom2 = parse_html('<p>foo</p><p>foo</p>')\n+        self.assertEqual(dom2.count(dom1), 2)\n+\n+        dom2 = parse_html('<div><p>foo<input type=\"\"></p><p>foo</p></div>')\n+        self.assertEqual(dom2.count(dom1), 1)\n+\n+        dom2 = parse_html('<div><div><p>foo</p></div></div>')\n+        self.assertEqual(dom2.count(dom1), 1)\n+\n+        dom2 = parse_html('<p>foo<p>foo</p></p>')\n+        self.assertEqual(dom2.count(dom1), 1)\n+\n+        dom2 = parse_html('<p>foo<p>bar</p></p>')\n+        self.assertEqual(dom2.count(dom1), 0)\n+\n+    def test_parsing_errors(self):\n+        from django.test.html import HTMLParseError, parse_html\n+        with self.assertRaises(AssertionError):\n+            self.assertHTMLEqual('<p>', '')\n+        with self.assertRaises(AssertionError):\n+            self.assertHTMLEqual('', '<p>')\n+        with self.assertRaises(HTMLParseError):\n+            parse_html('</p>')\n+        with self.assertRaises(HTMLParseError):\n+            parse_html('<!--')\n+\n+    def test_contains_html(self):\n+        response = HttpResponse('''<body>\n+        This is a form: <form action=\"\" method=\"get\">\n+            <input type=\"text\" name=\"Hello\" />\n+        </form></body>''')\n+\n+        self.assertNotContains(response, \"<input name='Hello' type='text'>\")\n+        self.assertContains(response, '<form action=\"\" method=\"get\">')\n+\n+        self.assertContains(response, \"<input name='Hello' type='text'>\", html=True)\n+        self.assertNotContains(response, '<form action=\"\" method=\"get\">', html=True)\n+\n+        invalid_response = HttpResponse('''<body <bad>>''')\n+\n+        with self.assertRaises(AssertionError):\n+            self.assertContains(invalid_response, '<p></p>')\n+\n+        with self.assertRaises(AssertionError):\n+            self.assertContains(response, '<p \"whats\" that>')\n+\n+    def test_unicode_handling(self):\n+        from django.http import HttpResponse\n+        response = HttpResponse('<p class=\"help\">Some help text for the title (with unicode Å ÄÄÅ½ÄÅ¾Å¡Ä)</p>')\n+        self.assertContains(response, '<p class=\"help\">Some help text for the title (with unicode Å ÄÄÅ½ÄÅ¾Å¡Ä)</p>', html=True)\n+\n+\n class SkippingExtraTests(TestCase):\n     fixtures = ['should_not_be_loaded.json']\n "
        },
        {
            "sha": "2abcfb41f0643431470c298a09dc356cd2ea9b1e",
            "filename": "tests/regressiontests/views/tests/generic/create_update.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fviews%2Ftests%2Fgeneric%2Fcreate_update.py",
            "raw_url": "https://github.com/django/django/raw/844a24bbb97af663ebf8dbeab4499acafe105943/tests%2Fregressiontests%2Fviews%2Ftests%2Fgeneric%2Fcreate_update.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2Fgeneric%2Fcreate_update.py?ref=844a24bbb97af663ebf8dbeab4499acafe105943",
            "patch": "@@ -92,7 +92,7 @@ def test_update_object_form_display(self):\n         \"\"\"\n         response = self.client.get('/create_update/update/article/old_article/')\n         self.assertTemplateUsed(response, 'views/article_form.html')\n-        self.assertEqual(unicode(response.context['form']['title']),\n+        self.assertHTMLEqual(unicode(response.context['form']['title']),\n             u'<input id=\"id_title\" type=\"text\" name=\"title\" value=\"Old Article\" maxlength=\"100\" />')\n \n     def test_update_object(self):"
        }
    ],
    "stats": {
        "total": 1984,
        "additions": 1345,
        "deletions": 639
    }
}