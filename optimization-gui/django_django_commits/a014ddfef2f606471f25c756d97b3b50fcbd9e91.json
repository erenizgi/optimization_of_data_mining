{
    "author": "claudep",
    "message": "Combined Django DEFAULT_LOGGING with user LOGGING config\n\nRefs #18993.",
    "sha": "a014ddfef2f606471f25c756d97b3b50fcbd9e91",
    "files": [
        {
            "sha": "74520136715714e4cf551c660a4e6d327b69f3de",
            "filename": "django/conf/__init__.py",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/a014ddfef2f606471f25c756d97b3b50fcbd9e91/django%2Fconf%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/a014ddfef2f606471f25c756d97b3b50fcbd9e91/django%2Fconf%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fconf%2F__init__.py?ref=a014ddfef2f606471f25c756d97b3b50fcbd9e91",
            "patch": "@@ -55,16 +55,20 @@ def _configure_logging(self):\n         Setup logging from LOGGING_CONFIG and LOGGING settings.\n         \"\"\"\n         if self.LOGGING_CONFIG:\n+            from django.utils.log import DEFAULT_LOGGING\n             # First find the logging configuration function ...\n             logging_config_path, logging_config_func_name = self.LOGGING_CONFIG.rsplit('.', 1)\n             logging_config_module = importlib.import_module(logging_config_path)\n             logging_config_func = getattr(logging_config_module, logging_config_func_name)\n \n-            # Backwards-compatibility shim for #16288 fix\n-            compat_patch_logging_config(self.LOGGING)\n+            logging_config_func(DEFAULT_LOGGING)\n \n-            # ... then invoke it with the logging settings\n-            logging_config_func(self.LOGGING)\n+            if self.LOGGING:\n+                # Backwards-compatibility shim for #16288 fix\n+                compat_patch_logging_config(self.LOGGING)\n+\n+                # ... then invoke it with the logging settings\n+                logging_config_func(self.LOGGING)\n \n     def configure(self, default_settings=global_settings, **options):\n         \"\"\""
        },
        {
            "sha": "f1cbb22880f98bdb8f65d6d27f35a0b16664222a",
            "filename": "django/conf/global_settings.py",
            "status": "modified",
            "additions": 2,
            "deletions": 27,
            "changes": 29,
            "blob_url": "https://github.com/django/django/blob/a014ddfef2f606471f25c756d97b3b50fcbd9e91/django%2Fconf%2Fglobal_settings.py",
            "raw_url": "https://github.com/django/django/raw/a014ddfef2f606471f25c756d97b3b50fcbd9e91/django%2Fconf%2Fglobal_settings.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fconf%2Fglobal_settings.py?ref=a014ddfef2f606471f25c756d97b3b50fcbd9e91",
            "patch": "@@ -551,33 +551,8 @@\n # The callable to use to configure logging\n LOGGING_CONFIG = 'django.utils.log.dictConfig'\n \n-# The default logging configuration. This sends an email to\n-# the site admins on every HTTP 500 error. All other log\n-# records are sent to the bit bucket.\n-\n-LOGGING = {\n-    'version': 1,\n-    'disable_existing_loggers': False,\n-    'filters': {\n-        'require_debug_false': {\n-            '()': 'django.utils.log.RequireDebugFalse',\n-        }\n-    },\n-    'handlers': {\n-        'mail_admins': {\n-            'level': 'ERROR',\n-            'filters': ['require_debug_false'],\n-            'class': 'django.utils.log.AdminEmailHandler'\n-        }\n-    },\n-    'loggers': {\n-        'django.request': {\n-            'handlers': ['mail_admins'],\n-            'level': 'ERROR',\n-            'propagate': True,\n-        },\n-    }\n-}\n+# Custom logging configuration.\n+LOGGING = {}\n \n # Default exception reporter filter class used in case none has been\n # specifically assigned to the HttpRequest instance."
        },
        {
            "sha": "c111512fe8d57be7ffd40349a12760521fb92b67",
            "filename": "django/utils/log.py",
            "status": "modified",
            "additions": 33,
            "deletions": 6,
            "changes": 39,
            "blob_url": "https://github.com/django/django/blob/a014ddfef2f606471f25c756d97b3b50fcbd9e91/django%2Futils%2Flog.py",
            "raw_url": "https://github.com/django/django/raw/a014ddfef2f606471f25c756d97b3b50fcbd9e91/django%2Futils%2Flog.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Flog.py?ref=a014ddfef2f606471f25c756d97b3b50fcbd9e91",
            "patch": "@@ -5,6 +5,7 @@\n from django.core import mail\n from django.views.debug import ExceptionReporter, get_exception_reporter_filter\n \n+\n # Make sure a NullHandler is available\n # This was added in Python 2.7/3.2\n try:\n@@ -23,12 +24,38 @@ def emit(self, record):\n \n getLogger = logging.getLogger\n \n-# Ensure the creation of the Django logger\n-# with a null handler. This ensures we don't get any\n-# 'No handlers could be found for logger \"django\"' messages\n-logger = getLogger('django')\n-if not logger.handlers:\n-    logger.addHandler(NullHandler())\n+# Default logging for Django. This sends an email to\n+# the site admins on every HTTP 500 error. All other log\n+# records are sent to the bit bucket.\n+DEFAULT_LOGGING = {\n+    'version': 1,\n+    'disable_existing_loggers': False,\n+    'filters': {\n+        'require_debug_false': {\n+            '()': 'django.utils.log.RequireDebugFalse',\n+        }\n+    },\n+    'handlers': {\n+        'null': {\n+            'class': 'django.utils.log.NullHandler',\n+        },\n+        'mail_admins': {\n+            'level': 'ERROR',\n+            'filters': ['require_debug_false'],\n+            'class': 'django.utils.log.AdminEmailHandler'\n+        }\n+    },\n+    'loggers': {\n+        'django': {\n+            'handlers': ['null'],\n+        },\n+        'django.request': {\n+            'handlers': ['mail_admins'],\n+            'level': 'ERROR',\n+            'propagate': True,\n+        },\n+    }\n+}\n \n \n class AdminEmailHandler(logging.Handler):"
        },
        {
            "sha": "a7f0a14b5bb4ae2e6ce308e9a6f168a1acd09b3c",
            "filename": "docs/topics/logging.txt",
            "status": "modified",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/django/django/blob/a014ddfef2f606471f25c756d97b3b50fcbd9e91/docs%2Ftopics%2Flogging.txt",
            "raw_url": "https://github.com/django/django/raw/a014ddfef2f606471f25c756d97b3b50fcbd9e91/docs%2Ftopics%2Flogging.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Flogging.txt?ref=a014ddfef2f606471f25c756d97b3b50fcbd9e91",
            "patch": "@@ -192,6 +192,8 @@ There are two other logging calls available:\n * ``logger.exception()``: Creates an ``ERROR`` level logging\n   message wrapping the current exception stack frame.\n \n+.. _configuring-logging:\n+\n Configuring logging\n ===================\n \n@@ -216,6 +218,14 @@ handlers, filters and formatters that you want in your logging setup,\n and the log levels and other properties that you want those components\n to have.\n \n+Prior to Django 1.5, the :setting:`LOGGING` setting overwrote the :ref:`default\n+Django logging configuration <default-logging-configuration>`. From Django\n+1.5 forward, the project's logging configuration is merged with Django's\n+defaults, hence you can decide if you want to add to, or replace the existing\n+configuration. To completely override the default configuration, set the\n+``disable_existing_loggers`` key to True in the :setting:`LOGGING`\n+dictConfig. Alternatively you can redefine some or all of the loggers.\n+\n Logging is configured as soon as settings have been loaded\n (either manually using :func:`~django.conf.settings.configure` or when at least\n one setting is accessed). Since the loading of settings is one of the first\n@@ -535,3 +545,15 @@ logging module.\n                 'class': 'django.utils.log.AdminEmailHandler'\n             }\n         },\n+\n+.. _default-logging-configuration:\n+\n+Django's default logging configuration\n+======================================\n+\n+By default, Django configures the ``django.request`` logger so that all messages\n+with ``ERROR`` or ``CRITICAL`` level are sent to :class:`AdminEmailHandler`, as\n+long as the :setting:`DEBUG` setting is set to ``False``.\n+\n+All messages reaching the ``django`` catch-all logger are discarded\n+(sent to ``NullHandler``)."
        }
    ],
    "stats": {
        "total": 102,
        "additions": 65,
        "deletions": 37
    }
}