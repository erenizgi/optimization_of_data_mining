{
    "author": "timgraham",
    "message": "Fixed #10078 - Document use of locales in management commands. Thanks gregoire for the suggestion and ramiro for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15141 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "60470e8ac2dabff507e54f073ac1284047987feb",
    "files": [
        {
            "sha": "1a8ba63a24b030adf420eb09876d0b1115a7178d",
            "filename": "docs/howto/custom-management-commands.txt",
            "status": "modified",
            "additions": 49,
            "deletions": 0,
            "changes": 49,
            "blob_url": "https://github.com/django/django/blob/60470e8ac2dabff507e54f073ac1284047987feb/docs%2Fhowto%2Fcustom-management-commands.txt",
            "raw_url": "https://github.com/django/django/raw/60470e8ac2dabff507e54f073ac1284047987feb/docs%2Fhowto%2Fcustom-management-commands.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fhowto%2Fcustom-management-commands.txt?ref=60470e8ac2dabff507e54f073ac1284047987feb",
            "patch": "@@ -98,6 +98,55 @@ In addition to being able to add custom command line options, all\n :doc:`management commands</ref/django-admin>` can accept some\n default options such as :djadminopt:`--verbosity` and :djadminopt:`--traceback`.\n \n+.. admonition:: Management commands and locales\n+\n+    The :meth:`BaseCommand.execute` method sets the hardcoded ``en-us`` locale\n+    because the commands shipped with Django perform several tasks\n+    (for example, user-visible content and database population) that require\n+    a system-neutral string language (for which we use ``en-us``).\n+\n+    If your custom management command uses another locale, you should manually\n+    activate and deactivate it in your :meth:`~BaseCommand.handle` or\n+    :meth:`~NoArgsCommand.handle_noargs` method using the functions provided by\n+    the I18N support code:\n+\n+    .. code-block:: python\n+\n+        from django.core.management.base import BaseCommand, CommandError\n+        from django.utils import translation\n+\n+        class Command(BaseCommand):\n+            ...\n+            self.can_import_settings = True\n+\n+            def handle(self, *args, **options):\n+\n+                # Activate a fixed locale, e.g. Russian\n+                translation.activate('ru')\n+\n+                # Or you can activate the LANGUAGE_CODE\n+                # chosen in the settings:\n+                #\n+                #from django.conf import settings\n+                #translation.activate(settings.LANGUAGE_CODE)\n+\n+                # Your command logic here\n+                # ...\n+\n+                translation.deactivate()\n+\n+    Take into account though, that system management commands typically have to\n+    be very careful about running in non-uniform locales, so:\n+\n+    * Make sure the :setting:`USE_I18N` setting is always ``True`` when running\n+      the command (this is one good example of the potential problems stemming\n+      from a dynamic runtime environment that Django commands avoid offhand by\n+      always using a fixed locale).\n+\n+    * Review the code of your command and the code it calls for behavioral\n+      differences when locales are changed and evaluate its impact on\n+      predictable behavior of your command.\n+\n Command objects\n ===============\n "
        }
    ],
    "stats": {
        "total": 49,
        "additions": 49,
        "deletions": 0
    }
}