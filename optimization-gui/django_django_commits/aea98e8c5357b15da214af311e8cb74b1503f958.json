{
    "author": "aaugustin",
    "message": "Simplified MySQL version checking.\n\nDjango used to check the version of MySQL before handling the first\nrequest, which required:\n- opening a connection\n- closing it, to avoid holding it idle until the first request.\n\nThis code isn't necessary any longer since Django dropped support for\nsome versions of MySQL, and other database backends don't implement a\nsimilar dance. For consistency and maintenability, remove it.\n\nReverts 4423757c0c50afbe2470434778c8d5e5b4a70925.\n\nCloses #18135.",
    "sha": "aea98e8c5357b15da214af311e8cb74b1503f958",
    "files": [
        {
            "sha": "754e876701cbf78647c163962a6066b2969a2619",
            "filename": "django/db/backends/mysql/base.py",
            "status": "modified",
            "additions": 0,
            "deletions": 9,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/aea98e8c5357b15da214af311e8cb74b1503f958/django%2Fdb%2Fbackends%2Fmysql%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/aea98e8c5357b15da214af311e8cb74b1503f958/django%2Fdb%2Fbackends%2Fmysql%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fbackends%2Fmysql%2Fbase.py?ref=aea98e8c5357b15da214af311e8cb74b1503f958",
            "patch": "@@ -464,16 +464,7 @@ def _rollback(self):\n     @cached_property\n     def mysql_version(self):\n         if not self.server_version:\n-            new_connection = False\n-            if not self._valid_connection():\n-                # Ensure we have a connection with the DB by using a temporary\n-                # cursor\n-                new_connection = True\n-                self.cursor().close()\n             server_info = self.connection.get_server_info()\n-            if new_connection:\n-                # Make sure we close the connection\n-                self.close()\n             m = server_version_re.match(server_info)\n             if not m:\n                 raise Exception('Unable to determine MySQL version from version string %r' % server_info)"
        },
        {
            "sha": "ed6f07691a8c8a693038b72b5d33cc444d8102ad",
            "filename": "tests/regressiontests/backends/tests.py",
            "status": "modified",
            "additions": 0,
            "deletions": 6,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/aea98e8c5357b15da214af311e8cb74b1503f958/tests%2Fregressiontests%2Fbackends%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/aea98e8c5357b15da214af311e8cb74b1503f958/tests%2Fregressiontests%2Fbackends%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fbackends%2Ftests.py?ref=aea98e8c5357b15da214af311e8cb74b1503f958",
            "patch": "@@ -123,12 +123,6 @@ def test_autoincrement(self):\n         else:\n             self.assertFalse(found_reset)\n \n-    @unittest.skipUnless(connection.vendor == 'mysql',\n-                        \"Test valid only for MySQL\")\n-    def test_server_version_connections(self):\n-        connection.close()\n-        connection.mysql_version\n-        self.assertTrue(connection.connection is None)\n \n class DateQuotingTest(TestCase):\n "
        }
    ],
    "stats": {
        "total": 15,
        "additions": 0,
        "deletions": 15
    }
}