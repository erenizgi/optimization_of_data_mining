{
    "author": "claudep",
    "message": "Removed some pre-1.3.0 postgis compatibility code",
    "sha": "2407c45c180703f935a2280cb3325beadc2ac8cc",
    "files": [
        {
            "sha": "bd249df179d02b3a58421608b03913b7a7029707",
            "filename": "django/contrib/gis/db/backends/postgis/operations.py",
            "status": "modified",
            "additions": 9,
            "deletions": 28,
            "changes": 37,
            "blob_url": "https://github.com/django/django/blob/2407c45c180703f935a2280cb3325beadc2ac8cc/django%2Fcontrib%2Fgis%2Fdb%2Fbackends%2Fpostgis%2Foperations.py",
            "raw_url": "https://github.com/django/django/raw/2407c45c180703f935a2280cb3325beadc2ac8cc/django%2Fcontrib%2Fgis%2Fdb%2Fbackends%2Fpostgis%2Foperations.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fdb%2Fbackends%2Fpostgis%2Foperations.py?ref=2407c45c180703f935a2280cb3325beadc2ac8cc",
            "patch": "@@ -163,7 +163,9 @@ def __init__(self, connection):\n             'contains' : PostGISFunction(prefix, 'Contains'),\n             'intersects' : PostGISFunction(prefix, 'Intersects'),\n             'relate' : (PostGISRelate, six.string_types),\n-            }\n+            'coveredby' : PostGISFunction(prefix, 'CoveredBy'),\n+            'covers' : PostGISFunction(prefix, 'Covers'),\n+        }\n \n         # Valid distance types and substitutions\n         dtypes = (Decimal, Distance, float) + six.integer_types\n@@ -178,33 +180,12 @@ def get_dist_ops(operator):\n             'distance_gte' : (get_dist_ops('>='), dtypes),\n             'distance_lt' : (get_dist_ops('<'), dtypes),\n             'distance_lte' : (get_dist_ops('<='), dtypes),\n-            }\n-\n-        # Versions 1.2.2+ have KML serialization support.\n-        if version < (1, 2, 2):\n-            ASKML = False\n-        else:\n-            ASKML = 'ST_AsKML'\n-            self.geometry_functions.update(\n-                {'coveredby' : PostGISFunction(prefix, 'CoveredBy'),\n-                 'covers' : PostGISFunction(prefix, 'Covers'),\n-                 })\n-            self.distance_functions['dwithin'] = (PostGISFunctionParam(prefix, 'DWithin'), dtypes)\n+            'dwithin' : (PostGISFunctionParam(prefix, 'DWithin'), dtypes)\n+        }\n \n         # Adding the distance functions to the geometries lookup.\n         self.geometry_functions.update(self.distance_functions)\n \n-        # The union aggregate and topology operation use the same signature\n-        # in versions 1.3+.\n-        if version < (1, 3, 0):\n-            UNIONAGG = 'GeomUnion'\n-            UNION = 'Union'\n-            MAKELINE = False\n-        else:\n-            UNIONAGG = 'ST_Union'\n-            UNION = 'ST_Union'\n-            MAKELINE = 'ST_MakeLine'\n-\n         # Only PostGIS versions 1.3.4+ have GeoJSON serialization support.\n         if version < (1, 3, 4):\n             GEOJSON = False\n@@ -256,11 +237,11 @@ def get_dist_ops(operator):\n         self.geojson = GEOJSON\n         self.gml = prefix + 'AsGML'\n         self.intersection = prefix + 'Intersection'\n-        self.kml = ASKML\n+        self.kml = prefix + 'AsKML'\n         self.length = prefix + 'Length'\n         self.length3d = prefix + 'Length3D'\n         self.length_spheroid = prefix + 'length_spheroid'\n-        self.makeline = MAKELINE\n+        self.makeline = prefix + 'MakeLine'\n         self.mem_size = prefix + 'mem_size'\n         self.num_geom = prefix + 'NumGeometries'\n         self.num_points =prefix + 'npoints'\n@@ -275,8 +256,8 @@ def get_dist_ops(operator):\n         self.sym_difference = prefix + 'SymDifference'\n         self.transform = prefix + 'Transform'\n         self.translate = prefix + 'Translate'\n-        self.union = UNION\n-        self.unionagg = UNIONAGG\n+        self.union = prefix + 'Union'\n+        self.unionagg = prefix + 'Union'\n \n     def check_aggregate_support(self, aggregate):\n         \"\"\""
        }
    ],
    "stats": {
        "total": 37,
        "additions": 9,
        "deletions": 28
    }
}