{
    "author": "bmispelon",
    "message": "Fix #20058: Make compilemessages use stdout instead of stderr.",
    "sha": "d5683bd06bdac923f73954020c760a4adb496be8",
    "files": [
        {
            "sha": "cb4149200412a160df77f90eb04d5cbd8e265a85",
            "filename": "django/core/management/commands/compilemessages.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/d5683bd06bdac923f73954020c760a4adb496be8/django%2Fcore%2Fmanagement%2Fcommands%2Fcompilemessages.py",
            "raw_url": "https://github.com/django/django/raw/d5683bd06bdac923f73954020c760a4adb496be8/django%2Fcore%2Fmanagement%2Fcommands%2Fcompilemessages.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fcompilemessages.py?ref=d5683bd06bdac923f73954020c760a4adb496be8",
            "patch": "@@ -15,7 +15,7 @@ def has_bom(fn):\n             sample.startswith(codecs.BOM_UTF16_LE) or \\\n             sample.startswith(codecs.BOM_UTF16_BE)\n \n-def compile_messages(stderr, locale=None):\n+def compile_messages(stdout, locale=None):\n     program = 'msgfmt'\n     if find_command(program) is None:\n         raise CommandError(\"Can't find %s. Make sure you have GNU gettext tools 0.15 or newer installed.\" % program)\n@@ -41,7 +41,7 @@ def compile_messages(stderr, locale=None):\n                 for f in filenames:\n                     if not f.endswith('.po'):\n                         continue\n-                    stderr.write('processing file %s in %s\\n' % (f, dirpath))\n+                    stdout.write('processing file %s in %s\\n' % (f, dirpath))\n                     fn = os.path.join(dirpath, f)\n                     if has_bom(fn):\n                         raise CommandError(\"The %s file has a BOM (Byte Order Mark). Django only supports .po files encoded in UTF-8 and without any BOM.\" % fn)\n@@ -68,4 +68,4 @@ class Command(BaseCommand):\n \n     def handle(self, **options):\n         locale = options.get('locale')\n-        compile_messages(self.stderr, locale=locale)\n+        compile_messages(self.stdout, locale=locale)"
        },
        {
            "sha": "12bb89ed08431f8d79f9c949dcd7d1f0236a67f2",
            "filename": "tests/i18n/commands/compilation.py",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/d5683bd06bdac923f73954020c760a4adb496be8/tests%2Fi18n%2Fcommands%2Fcompilation.py",
            "raw_url": "https://github.com/django/django/raw/d5683bd06bdac923f73954020c760a4adb496be8/tests%2Fi18n%2Fcommands%2Fcompilation.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fi18n%2Fcommands%2Fcompilation.py?ref=d5683bd06bdac923f73954020c760a4adb496be8",
            "patch": "@@ -29,7 +29,7 @@ class PoFileTests(MessageCompilationTests):\n \n     def test_bom_rejection(self):\n         with self.assertRaises(CommandError) as cm:\n-            call_command('compilemessages', locale=self.LOCALE, stderr=StringIO())\n+            call_command('compilemessages', locale=self.LOCALE, stdout=StringIO())\n         self.assertIn(\"file has a BOM (Byte Order Mark)\", cm.exception.args[0])\n         self.assertFalse(os.path.exists(self.MO_FILE))\n \n@@ -45,7 +45,7 @@ def setUp(self):\n         self.addCleanup(os.unlink, os.path.join(test_dir, self.MO_FILE))\n \n     def test_percent_symbol_in_po_file(self):\n-        call_command('compilemessages', locale=self.LOCALE, stderr=StringIO())\n+        call_command('compilemessages', locale=self.LOCALE, stdout=StringIO())\n         self.assertTrue(os.path.exists(self.MO_FILE))\n \n \n@@ -63,7 +63,7 @@ def setUp(self):\n     @override_settings(LOCALE_PATHS=(os.path.join(test_dir, 'locale'),))\n     def test_percent_symbol_escaping(self):\n         from django.template import Template, Context\n-        call_command('compilemessages', locale=self.LOCALE, stderr=StringIO())\n+        call_command('compilemessages', locale=self.LOCALE, stdout=StringIO())\n         with translation.override(self.LOCALE):\n             t = Template('{% load i18n %}{% trans \"Looks like a str fmt spec %% o but shouldn\\'t be interpreted as such\" %}')\n             rendered = t.render(Context({}))\n@@ -88,12 +88,12 @@ def setUp(self):\n         self.addCleanup(self.rmfile, os.path.join(localedir, self.MO_FILE_FR))\n \n     def test_one_locale(self):\n-        call_command('compilemessages', locale='hr', stderr=StringIO())\n+        call_command('compilemessages', locale='hr', stdout=StringIO())\n \n         self.assertTrue(os.path.exists(self.MO_FILE_HR))\n \n     def test_multiple_locales(self):\n-        call_command('compilemessages', locale=['hr', 'fr'], stderr=StringIO())\n+        call_command('compilemessages', locale=['hr', 'fr'], stdout=StringIO())\n \n         self.assertTrue(os.path.exists(self.MO_FILE_HR))\n         self.assertTrue(os.path.exists(self.MO_FILE_FR))\n@@ -110,4 +110,4 @@ def setUp(self):\n \n     def test_error_reported_by_msgfmt(self):\n         with self.assertRaises(CommandError):\n-            call_command('compilemessages', locale=self.LOCALE, stderr=StringIO())\n+            call_command('compilemessages', locale=self.LOCALE, stdout=StringIO())"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 9,
        "deletions": 9
    }
}