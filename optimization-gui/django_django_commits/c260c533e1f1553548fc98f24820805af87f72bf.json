{
    "author": "freakboy3742",
    "message": "Fixed #15570 -- Corrected a flaw in the design of the silent flag on {% cycle %}. Thanks to Brian Neal for the report, and to Andrew and Jannis for the design consult.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15773 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "c260c533e1f1553548fc98f24820805af87f72bf",
    "files": [
        {
            "sha": "ff97d92d75cd5682f8bb1332074fe7682fe763ba",
            "filename": "django/template/defaulttags.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/c260c533e1f1553548fc98f24820805af87f72bf/django%2Ftemplate%2Fdefaulttags.py",
            "raw_url": "https://github.com/django/django/raw/c260c533e1f1553548fc98f24820805af87f72bf/django%2Ftemplate%2Fdefaulttags.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fdefaulttags.py?ref=c260c533e1f1553548fc98f24820805af87f72bf",
            "patch": "@@ -111,12 +111,12 @@ def render(self, context):\n         if self not in context.render_context:\n             # First time the node is rendered in template\n             context.render_context[self] = itertools_cycle(self.cyclevars)\n-            if self.silent:\n-                return ''\n         cycle_iter = context.render_context[self]\n         value = cycle_iter.next().resolve(context)\n         if self.variable_name:\n             context[self.variable_name] = value\n+        if self.silent:\n+            return ''\n         return value\n \n class DebugNode(Node):"
        },
        {
            "sha": "1fa495e51a9e1d77ebe08683ba735cb5ed6293e7",
            "filename": "docs/ref/templates/builtins.txt",
            "status": "modified",
            "additions": 40,
            "deletions": 11,
            "changes": 51,
            "blob_url": "https://github.com/django/django/blob/c260c533e1f1553548fc98f24820805af87f72bf/docs%2Fref%2Ftemplates%2Fbuiltins.txt",
            "raw_url": "https://github.com/django/django/raw/c260c533e1f1553548fc98f24820805af87f72bf/docs%2Fref%2Ftemplates%2Fbuiltins.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Ftemplates%2Fbuiltins.txt?ref=c260c533e1f1553548fc98f24820805af87f72bf",
            "patch": "@@ -102,11 +102,31 @@ outside of a loop. To do this, just give the ``{% cycle %}`` tag a name, using\n \n     {% cycle 'row1' 'row2' as rowcolors %}\n \n-From then on, you can insert the current value of the cycle wherever you'd like\n-in your template::\n-\n-    <tr class=\"{% cycle rowcolors %}\">...</tr>\n-    <tr class=\"{% cycle rowcolors %}\">...</tr>\n+From then on, you can insert the current value of the cycle wherever\n+you'd like in your template by referencing the cycle name as a context\n+variable. If you want to move the cycle onto the next value, you use\n+the cycle tag again, using the name of the variable. So, the following\n+template::\n+\n+    <tr>\n+        <td class=\"{% cycle 'row1' 'row2' as rowcolors %}\">...</td>\n+        <td class=\"{{ rowcolors }}\">...</td>\n+    </tr>\n+    <tr>\n+        <td class=\"{% cycle rowcolors %}\">...</td>\n+        <td class=\"{{ rowcolors }}\">...</td>\n+    </tr>\n+\n+would output::\n+\n+    <tr>\n+        <td class=\"row1\">...</td>\n+        <td class=\"row1\">...</td>\n+    </tr>\n+    <tr>\n+        <td class=\"row2\">...</td>\n+        <td class=\"row2\">...</td>\n+    </tr>\n \n You can use any number of values in a ``{% cycle %}`` tag, separated by spaces.\n Values enclosed in single (``'``) or double quotes (``\"``) are treated as\n@@ -144,16 +164,25 @@ use the value in a nested loop or an included template. If you want to\n just declare the cycle, but not output the first value, you can add a\n ``silent`` keyword as the last keyword in the tag. For example::\n \n-    {% cycle 'row1' 'row2' as rowcolors silent %}\n     {% for obj in some_list %}\n-        <tr class=\"{% cycle rowcolors %}\">{{ obj }}</tr>\n+        {% cycle 'row1' 'row2' as rowcolors silent %}\n+        <tr class=\"{{ rowcolors }}\">{% include \"subtemplate.html \" %}</tr>\n     {% endfor %}\n \n This will output a list of ``<tr>`` elements with ``class``\n-alternating between ``row1`` and ``row2``. If the ``silent`` keyword\n-were to be omitted, ``row1`` would be emitted as normal text, outside\n-the list of ``<tr>`` elements, and the first ``<tr>`` would have a\n-class of ``row2``.\n+alternating between ``row1`` and ``row2``; the subtemplate will have\n+access to ``rowcolors`` in it's context that matches the class of the\n+``<tr>`` that encloses it. If the ``silent`` keyword were to be\n+omitted, ``row1`` would be emitted as normal text, outside the\n+``<tr>`` element.\n+\n+When the silent keyword is used on a cycle definition, the silence\n+automatically applies to all subsequent uses of the cycle tag. In,\n+the following template would output *nothing*, even though the second\n+call to ``{% cycle %}`` doesn't specify silent::\n+\n+    {% cycle 'row1' 'row2' as rowcolors silent %}\n+    {% cycle rowcolors %}\n \n .. templatetag:: debug\n "
        },
        {
            "sha": "46aedb3da6cee836b6e5fe3cf2fe837b2d185892",
            "filename": "tests/regressiontests/templates/tests.py",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/c260c533e1f1553548fc98f24820805af87f72bf/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/c260c533e1f1553548fc98f24820805af87f72bf/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftemplates%2Ftests.py?ref=c260c533e1f1553548fc98f24820805af87f72bf",
            "patch": "@@ -735,11 +735,15 @@ def get_template_tests(self):\n             'cycle14': (\"{% cycle one two as foo %}{% cycle foo %}\", {'one': '1','two': '2'}, '12'),\n             'cycle15': (\"{% for i in test %}{% cycle aye bee %}{{ i }},{% endfor %}\", {'test': range(5), 'aye': 'a', 'bee': 'b'}, 'a0,b1,a2,b3,a4,'),\n             'cycle16': (\"{% cycle one|lower two as foo %}{% cycle foo %}\", {'one': 'A','two': '2'}, 'a2'),\n-            'cycle17': (\"{% cycle 'a' 'b' 'c' as abc silent %}{% cycle abc %}{% cycle abc %}{% cycle abc %}{% cycle abc %}\", {}, \"abca\"),\n+            'cycle17': (\"{% cycle 'a' 'b' 'c' as abc silent %}{% cycle abc %}{% cycle abc %}{% cycle abc %}{% cycle abc %}\", {}, \"\"),\n             'cycle18': (\"{% cycle 'a' 'b' 'c' as foo invalid_flag %}\", {}, template.TemplateSyntaxError),\n             'cycle19': (\"{% cycle 'a' 'b' as silent %}{% cycle silent %}\", {}, \"ab\"),\n             'cycle20': (\"{% cycle one two as foo %} &amp; {% cycle foo %}\", {'one' : 'A & B', 'two' : 'C & D'}, \"A & B &amp; C & D\"),\n             'cycle21': (\"{% filter force_escape %}{% cycle one two as foo %} & {% cycle foo %}{% endfilter %}\", {'one' : 'A & B', 'two' : 'C & D'}, \"A &amp; B &amp; C &amp; D\"),\n+            'cycle22': (\"{% for x in values %}{% cycle 'a' 'b' 'c' as abc silent %}{{ x }}{% endfor %}\", {'values': [1,2,3,4]}, \"1234\"),\n+            'cycle23': (\"{% for x in values %}{% cycle 'a' 'b' 'c' as abc silent %}{{ abc }}{{ x }}{% endfor %}\", {'values': [1,2,3,4]}, \"a1b2c3a4\"),\n+            'included-cycle': ('{{ abc }}', {'abc': 'xxx'}, 'xxx'),\n+            'cycle24': (\"{% for x in values %}{% cycle 'a' 'b' 'c' as abc silent %}{% include 'included-cycle' %}{% endfor %}\", {'values': [1,2,3,4]}, \"abca\"),\n \n             ### EXCEPTIONS ############################################################\n "
        }
    ],
    "stats": {
        "total": 61,
        "additions": 47,
        "deletions": 14
    }
}