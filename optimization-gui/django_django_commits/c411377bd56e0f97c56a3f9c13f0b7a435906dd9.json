{
    "author": "spookylukey",
    "message": "Fixed #15349 - Bound FormSet produces bound empty_form\n\nThanks to hidde-jan for the report and patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15614 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "c411377bd56e0f97c56a3f9c13f0b7a435906dd9",
    "files": [
        {
            "sha": "da92fbd408c61295962ef12cbadd63c27e476c80",
            "filename": "django/forms/formsets.py",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/c411377bd56e0f97c56a3f9c13f0b7a435906dd9/django%2Fforms%2Fformsets.py",
            "raw_url": "https://github.com/django/django/raw/c411377bd56e0f97c56a3f9c13f0b7a435906dd9/django%2Fforms%2Fformsets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fformsets.py?ref=c411377bd56e0f97c56a3f9c13f0b7a435906dd9",
            "patch": "@@ -144,9 +144,6 @@ def _get_empty_form(self, **kwargs):\n             'prefix': self.add_prefix('__prefix__'),\n             'empty_permitted': True,\n         }\n-        if self.is_bound:\n-            defaults['data'] = self.data\n-            defaults['files'] = self.files\n         defaults.update(kwargs)\n         form = self.form(**defaults)\n         self.add_fields(form, None)"
        },
        {
            "sha": "fd854ecabad125bf86e750ffcb6ff35982148366",
            "filename": "tests/regressiontests/forms/tests/formsets.py",
            "status": "modified",
            "additions": 22,
            "deletions": 0,
            "changes": 22,
            "blob_url": "https://github.com/django/django/blob/c411377bd56e0f97c56a3f9c13f0b7a435906dd9/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py",
            "raw_url": "https://github.com/django/django/raw/c411377bd56e0f97c56a3f9c13f0b7a435906dd9/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py?ref=c411377bd56e0f97c56a3f9c13f0b7a435906dd9",
            "patch": "@@ -878,6 +878,28 @@ def test_form_errors_are_cought_by_formset(self):\n         self.assertFalse(formset.is_valid())\n         self.assertEquals([{}, {'pub_date': [u'This field is required.']}], formset.errors)\n \n+    def test_empty_forms_are_unbound(self):\n+        data = {\n+            'form-TOTAL_FORMS': u'1',\n+            'form-INITIAL_FORMS': u'0',\n+            'form-0-title': u'Test',\n+            'form-0-pub_date': u'1904-06-16',\n+        }\n+        unbound_formset = ArticleFormSet()\n+        bound_formset = ArticleFormSet(data)\n+\n+        empty_forms = []\n+\n+        empty_forms.append(unbound_formset.empty_form)\n+        empty_forms.append(bound_formset.empty_form)\n+\n+        # Empty forms should be unbound\n+        self.assertFalse(empty_forms[0].is_bound)\n+        self.assertFalse(empty_forms[1].is_bound)\n+\n+        # The empty forms should be equal.\n+        self.assertEqual(empty_forms[0].as_p(), empty_forms[1].as_p())\n+\n class TestEmptyFormSet(TestCase): \n     \"Test that an empty formset still calls clean()\"\n     def test_empty_formset_is_valid(self): "
        }
    ],
    "stats": {
        "total": 25,
        "additions": 22,
        "deletions": 3
    }
}