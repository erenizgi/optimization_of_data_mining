{
    "author": "unknown",
    "message": "Fixed #17320 -- Added whitespace validation to the Site.domain field",
    "sha": "c7294614795a3c0b3a872707bbea93733ef2077d",
    "files": [
        {
            "sha": "1ce9bf3185cd9c1d792905547458f5a780e446d5",
            "filename": "django/contrib/sites/models.py",
            "status": "modified",
            "additions": 18,
            "deletions": 1,
            "changes": 19,
            "blob_url": "https://github.com/django/django/blob/c7294614795a3c0b3a872707bbea93733ef2077d/django%2Fcontrib%2Fsites%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/c7294614795a3c0b3a872707bbea93733ef2077d/django%2Fcontrib%2Fsites%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsites%2Fmodels.py?ref=c7294614795a3c0b3a872707bbea93733ef2077d",
            "patch": "@@ -1,12 +1,28 @@\n+import string\n+\n from django.db import models\n from django.db.models.signals import pre_save, pre_delete\n from django.utils.translation import ugettext_lazy as _\n from django.utils.encoding import python_2_unicode_compatible\n+from django.core.exceptions import ValidationError\n \n \n SITE_CACHE = {}\n \n \n+def _simple_domain_name_validator(value):\n+    \"\"\"\n+    Validates that the given value contains no whitespaces to prevent common\n+    typos.\n+    \"\"\"\n+    if not value:\n+        return\n+    checks = ((s in value) for s in string.whitespace)\n+    if any(checks):\n+        raise ValidationError(\n+            _(u\"The domain name cannot contain any spaces or tabs.\"))\n+\n+\n class SiteManager(models.Manager):\n \n     def get_current(self):\n@@ -37,7 +53,8 @@ def clear_cache(self):\n @python_2_unicode_compatible\n class Site(models.Model):\n \n-    domain = models.CharField(_('domain name'), max_length=100)\n+    domain = models.CharField(_('domain name'), max_length=100,\n+        validators=[_simple_domain_name_validator])\n     name = models.CharField(_('display name'), max_length=50)\n     objects = SiteManager()\n "
        },
        {
            "sha": "6bfbfd7cf267f025ad165c688213cfb8afc75887",
            "filename": "django/contrib/sites/tests.py",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/c7294614795a3c0b3a872707bbea93733ef2077d/django%2Fcontrib%2Fsites%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/c7294614795a3c0b3a872707bbea93733ef2077d/django%2Fcontrib%2Fsites%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsites%2Ftests.py?ref=c7294614795a3c0b3a872707bbea93733ef2077d",
            "patch": "@@ -2,7 +2,7 @@\n \n from django.conf import settings\n from django.contrib.sites.models import Site, RequestSite, get_current_site\n-from django.core.exceptions import ObjectDoesNotExist\n+from django.core.exceptions import ObjectDoesNotExist, ValidationError\n from django.http import HttpRequest\n from django.test import TestCase\n from django.test.utils import override_settings\n@@ -71,3 +71,13 @@ def test_get_current_site(self):\n         site = get_current_site(request)\n         self.assertTrue(isinstance(site, RequestSite))\n         self.assertEqual(site.name, \"example.com\")\n+\n+    def test_domain_name_with_whitespaces(self):\n+        # Regression for #17320\n+        # Domain names are not allowed contain whitespace characters\n+        site = Site(name=\"test name\", domain=\"test test\")\n+        self.assertRaises(ValidationError, site.full_clean)\n+        site.domain = \"test\\ttest\"\n+        self.assertRaises(ValidationError, site.full_clean)\n+        site.domain = \"test\\ntest\"\n+        self.assertRaises(ValidationError, site.full_clean)"
        }
    ],
    "stats": {
        "total": 31,
        "additions": 29,
        "deletions": 2
    }
}