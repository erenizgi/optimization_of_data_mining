{
    "author": "aaugustin",
    "message": "Fixed #18023 -- Documented simplejson issues.\n\nThanks Luke Plant for reporting the issue and Alex Ogier for thoroughly\ninvestigating it.",
    "sha": "610746f6cb89c13b364c27fc41ecc9592cbe1605",
    "files": [
        {
            "sha": "6042569cea1538ea2fc210b770c47a8383d34f03",
            "filename": "docs/releases/1.5.txt",
            "status": "modified",
            "additions": 59,
            "deletions": 3,
            "changes": 62,
            "blob_url": "https://github.com/django/django/blob/610746f6cb89c13b364c27fc41ecc9592cbe1605/docs%2Freleases%2F1.5.txt",
            "raw_url": "https://github.com/django/django/raw/610746f6cb89c13b364c27fc41ecc9592cbe1605/docs%2Freleases%2F1.5.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.5.txt?ref=610746f6cb89c13b364c27fc41ecc9592cbe1605",
            "patch": "@@ -172,6 +172,54 @@ If you were using the ``data`` parameter in a PUT request without a\n ``content_type``, you must encode your data before passing it to the test\n client and set the ``content_type`` argument.\n \n+.. _simplejson-incompatibilities:\n+\n+System version of :mod:`simplejson` no longer used\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+:ref:`As explained below <simplejson-deprecation>`, Django 1.5 deprecates\n+:mod:`django.utils.simplejson` in favor of Python 2.6's built-in :mod:`json`\n+module. In theory, this change is harmless. Unfortunately, because of\n+incompatibilities between versions of :mod:`simplejson`, it may trigger errors\n+in some circumstances.\n+\n+JSON-related features in Django 1.4 always used :mod:`django.utils.simplejson`.\n+This module was actually:\n+\n+- A system version of :mod:`simplejson`, if one was available (ie. ``import\n+  simplejson`` works), if it was more recent than Django's built-in copy or it\n+  had the C speedups, or\n+- The :mod:`json` module from the standard library, if it was available (ie.\n+  Python 2.6 or greater), or\n+- A built-in copy of version 2.0.7 of :mod:`simplejson`.\n+\n+In Django 1.5, those features use Python's :mod:`json` module, which is based\n+on version 2.0.9 of :mod:`simplejson`.\n+\n+There are no known incompatibilities between Django's copy of version 2.0.7 and\n+Python's copy of version 2.0.9. However, there are some incompatibilities\n+between other versions of :mod:`simplejson`:\n+\n+- While the :mod:`simplejson` API is documented as always returning unicode\n+  strings, the optional C implementation can return a byte string. This was\n+  fixed in Python 2.7.\n+- :class:`simplejson.JSONEncoder` gained a ``namedtuple_as_object`` keyword\n+  argument in version 2.2.\n+\n+More information on these incompatibilities is available in `ticket #18023`_.\n+\n+The net result is that, if you have installed :mod:`simplejson` and your code\n+uses Django's serialization internals directly -- for instance\n+:class:`django.core.serializers.json.DjangoJSONEncoder`, the switch from\n+:mod:`simplejson` to :mod:`json` could break your code. (In general, changes to\n+internals aren't documented; we're making an exception here.)\n+\n+At this point, the maintainers of Django believe that using :mod:`json` from\n+the standard library offers the strongest guarantee of backwards-compatibility.\n+They recommend to use it from now on.\n+\n+.. _ticket #18023: https://code.djangoproject.com/ticket/18023#comment:10\n+\n String types of hasher method parameters\n ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n \n@@ -282,13 +330,21 @@ Miscellaneous\n Features deprecated in 1.5\n ==========================\n \n+.. _simplejson-deprecation:\n+\n ``django.utils.simplejson``\n ~~~~~~~~~~~~~~~~~~~~~~~~~~~\n \n Since Django 1.5 drops support for Python 2.5, we can now rely on the\n-:mod:`json` module being in Python's standard library -- so we've removed\n-our own copy of ``simplejson``. You can safely change any use of\n-:mod:`django.utils.simplejson` to :mod:`json`.\n+:mod:`json` module being available in Python's standard library, so we've\n+removed our own copy of :mod:`simplejson`. You should now import :mod:`json`\n+instead :mod:`django.utils.simplejson`.\n+\n+Unfortunately, this change might have unwanted side-effects, because of\n+incompatibilities between versions of :mod:`simplejson` -- see the\n+:ref:`backwards-incompatible changes <simplejson-incompatibilities>` section.\n+If you rely on features added to :mod:`simplejson` after it became Python's\n+:mod:`json`, you should import :mod:`simplejson` explicitly.\n \n ``itercompat.product``\n ~~~~~~~~~~~~~~~~~~~~~~"
        }
    ],
    "stats": {
        "total": 62,
        "additions": 59,
        "deletions": 3
    }
}