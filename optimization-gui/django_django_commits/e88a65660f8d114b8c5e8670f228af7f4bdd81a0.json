{
    "author": "jezdez",
    "message": "Fixed #17806 -- Fixed off-by-n error in the CachedStaticFilesStorage that prevented it from finding files in nested directories. Many thanks to lpetre.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17622 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "e88a65660f8d114b8c5e8670f228af7f4bdd81a0",
    "files": [
        {
            "sha": "fe35a3163ea0a60a79f7f40cd8bb553894faedc2",
            "filename": "django/contrib/staticfiles/storage.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/e88a65660f8d114b8c5e8670f228af7f4bdd81a0/django%2Fcontrib%2Fstaticfiles%2Fstorage.py",
            "raw_url": "https://github.com/django/django/raw/e88a65660f8d114b8c5e8670f228af7f4bdd81a0/django%2Fcontrib%2Fstaticfiles%2Fstorage.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fstaticfiles%2Fstorage.py?ref=e88a65660f8d114b8c5e8670f228af7f4bdd81a0",
            "patch": "@@ -160,7 +160,7 @@ def converter(matchobj):\n                 if sub_level:\n                     if sub_level == 1:\n                         parent_level -= 1\n-                    start, end = parent_level, sub_level - 1\n+                    start, end = parent_level, 1\n                 else:\n                     start, end = 1, sub_level - 1\n             joined_result = '/'.join(name_parts[:-start] + url_parts[end:])"
        },
        {
            "sha": "54467a362d013554e1a18793d69d8685585dc100",
            "filename": "tests/regressiontests/staticfiles_tests/project/documents/cached/absolute.css",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/e88a65660f8d114b8c5e8670f228af7f4bdd81a0/tests%2Fregressiontests%2Fstaticfiles_tests%2Fproject%2Fdocuments%2Fcached%2Fabsolute.css",
            "raw_url": "https://github.com/django/django/raw/e88a65660f8d114b8c5e8670f228af7f4bdd81a0/tests%2Fregressiontests%2Fstaticfiles_tests%2Fproject%2Fdocuments%2Fcached%2Fabsolute.css",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fstaticfiles_tests%2Fproject%2Fdocuments%2Fcached%2Fabsolute.css?ref=e88a65660f8d114b8c5e8670f228af7f4bdd81a0",
            "patch": "@@ -1 +1,4 @@\n @import url(\"/static/cached/styles.css\");\n+body {\n+    background: #d3d6d8 url(/static/cached/img/relative.png);\n+}\n\\ No newline at end of file"
        },
        {
            "sha": "050ba0e9e9877c2e9997c4110d0d880e87937eed",
            "filename": "tests/regressiontests/staticfiles_tests/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/e88a65660f8d114b8c5e8670f228af7f4bdd81a0/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/e88a65660f8d114b8c5e8670f228af7f4bdd81a0/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py?ref=e88a65660f8d114b8c5e8670f228af7f4bdd81a0",
            "patch": "@@ -416,11 +416,12 @@ def test_path_with_querystring_and_fragment(self):\n \n     def test_template_tag_absolute(self):\n         relpath = self.cached_file_path(\"cached/absolute.css\")\n-        self.assertEqual(relpath, \"cached/absolute.cc80cb5e2eb1.css\")\n+        self.assertEqual(relpath, \"cached/absolute.23f087ad823a.css\")\n         with storage.staticfiles_storage.open(relpath) as relfile:\n             content = relfile.read()\n             self.assertNotIn(\"/static/cached/styles.css\", content)\n             self.assertIn(\"/static/cached/styles.93b1147e8552.css\", content)\n+            self.assertIn('/static/cached/img/relative.acae32e4532b.png', content)\n \n     def test_template_tag_denorm(self):\n         relpath = self.cached_file_path(\"cached/denorm.css\")"
        }
    ],
    "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
    }
}