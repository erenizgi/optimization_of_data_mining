{
    "author": "jphalip",
    "message": "Fixed #17125 -- Made it possible to change a `RegexField`'s regular expression validator after it has been initialized. Thanks to Claude Paroz for the report and patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17076 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "90d369741727dbf0cf1c94b23fb2340c7edb8b02",
    "files": [
        {
            "sha": "45cc8185c0dc159f40cef34f249254282ef0a3c8",
            "filename": "django/forms/fields.py",
            "status": "modified",
            "additions": 13,
            "deletions": 2,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/90d369741727dbf0cf1c94b23fb2340c7edb8b02/django%2Fforms%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/90d369741727dbf0cf1c94b23fb2340c7edb8b02/django%2Fforms%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Ffields.py?ref=90d369741727dbf0cf1c94b23fb2340c7edb8b02",
            "patch": "@@ -442,10 +442,21 @@ def __init__(self, regex, max_length=None, min_length=None, error_message=None,\n             error_messages['invalid'] = error_message\n             kwargs['error_messages'] = error_messages\n         super(RegexField, self).__init__(max_length, min_length, *args, **kwargs)\n+        self._set_regex(regex)\n+\n+    def _get_regex(self):\n+        return self._regex\n+\n+    def _set_regex(self, regex):\n         if isinstance(regex, basestring):\n             regex = re.compile(regex)\n-        self.regex = regex\n-        self.validators.append(validators.RegexValidator(regex=regex))\n+        self._regex = regex\n+        if hasattr(self, '_regex_validator') and self._regex_validator in self.validators:\n+            self.validators.remove(self._regex_validator)\n+        self._regex_validator = validators.RegexValidator(regex=regex)\n+        self.validators.append(self._regex_validator)\n+\n+    regex = property(_get_regex, _set_regex)\n \n class EmailField(CharField):\n     default_error_messages = {"
        },
        {
            "sha": "dd55c9011110c6928b985af0afd1a234388f840b",
            "filename": "tests/regressiontests/forms/tests/fields.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/90d369741727dbf0cf1c94b23fb2340c7edb8b02/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/90d369741727dbf0cf1c94b23fb2340c7edb8b02/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py?ref=90d369741727dbf0cf1c94b23fb2340c7edb8b02",
            "patch": "@@ -493,6 +493,12 @@ def test_regexfield_5(self):\n         self.assertRaisesMessage(ValidationError, \"[u'Ensure this value has at most 10 characters (it has 11).']\", f.clean, '12345678901')\n         self.assertRaisesMessage(ValidationError, \"[u'Enter a valid value.']\", f.clean, '12345a')\n \n+    def test_change_regex_after_init(self):\n+        f = RegexField('^[a-z]+$')\n+        f.regex = '^\\d+$'\n+        self.assertEqual(u'1234', f.clean('1234'))\n+        self.assertRaisesMessage(ValidationError, \"[u'Enter a valid value.']\", f.clean, 'abcd')\n+\n     # EmailField ##################################################################\n \n     def test_emailfield_1(self):"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 19,
        "deletions": 2
    }
}