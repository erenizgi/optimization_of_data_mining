{
    "author": "jbronn",
    "message": "Fixed #15533 -- Now use 3857 as spherical mercator projection instead of deprecated 900913 on platforms that support it.  Thanks to cnorthwood for bug report and Christopher Schmidt for OpenLayers JavaScript workaround.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15845 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ebd5682989f5929bdfc645bcbd36f57d182be233",
    "files": [
        {
            "sha": "8e1faf23746f9dc7d71556cf34c06607cb7fcf0d",
            "filename": "django/contrib/gis/admin/options.py",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/ebd5682989f5929bdfc645bcbd36f57d182be233/django%2Fcontrib%2Fgis%2Fadmin%2Foptions.py",
            "raw_url": "https://github.com/django/django/raw/ebd5682989f5929bdfc645bcbd36f57d182be233/django%2Fcontrib%2Fgis%2Fadmin%2Foptions.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fadmin%2Foptions.py?ref=ebd5682989f5929bdfc645bcbd36f57d182be233",
            "patch": "@@ -113,11 +113,18 @@ class OLMap(self.widget):\n \n from django.contrib.gis import gdal\n if gdal.HAS_GDAL:\n+    # Use the official spherical mercator projection SRID on versions\n+    # of GDAL that support it; otherwise, fallback to 900913.\n+    if gdal.GDAL_VERSION >= (1, 7):\n+        spherical_mercator_srid = 3857\n+    else:\n+        spherical_mercator_srid = 900913\n+\n     class OSMGeoAdmin(GeoModelAdmin):\n         map_template = 'gis/admin/osm.html'\n         extra_js = ['http://www.openstreetmap.org/openlayers/OpenStreetMap.js']\n         num_zoom = 20\n-        map_srid = 900913\n+        map_srid = spherical_mercator_srid\n         max_extent = '-20037508,-20037508,20037508,20037508'\n         max_resolution = '156543.0339'\n         point_zoom = num_zoom - 6"
        },
        {
            "sha": "c455bffd58dd05bd181da82008619b78ff9c44a6",
            "filename": "django/contrib/gis/templates/gis/admin/openlayers.js",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/ebd5682989f5929bdfc645bcbd36f57d182be233/django%2Fcontrib%2Fgis%2Ftemplates%2Fgis%2Fadmin%2Fopenlayers.js",
            "raw_url": "https://github.com/django/django/raw/ebd5682989f5929bdfc645bcbd36f57d182be233/django%2Fcontrib%2Fgis%2Ftemplates%2Fgis%2Fadmin%2Fopenlayers.js",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftemplates%2Fgis%2Fadmin%2Fopenlayers.js?ref=ebd5682989f5929bdfc645bcbd36f57d182be233",
            "patch": "@@ -1,4 +1,5 @@\n {# Author: Justin Bronn, Travis Pinney & Dane Springmeyer #}\n+OpenLayers.Projection.addTransform(\"EPSG:4326\", \"EPSG:3857\", OpenLayers.Layer.SphericalMercator.projectForward);\n {% block vars %}var {{ module }} = {};\n {{ module }}.map = null; {{ module }}.controls = null; {{ module }}.panel = null; {{ module }}.re = new RegExp(\"^SRID=\\d+;(.+)\", \"i\"); {{ module }}.layers = {};\n {{ module }}.modifiable = {{ modifiable|yesno:\"true,false\" }};"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 9,
        "deletions": 1
    }
}