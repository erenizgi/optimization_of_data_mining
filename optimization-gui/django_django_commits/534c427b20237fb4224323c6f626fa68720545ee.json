{
    "author": "SmileyChris",
    "message": "Fixed #13584 -- Optionally allow empty files with django.forms.FileField. Thanks for the patch erickr and closedbracket.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16090 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "534c427b20237fb4224323c6f626fa68720545ee",
    "files": [
        {
            "sha": "9538e27fbec68b7f1beef8ce81fbe0670dbff88c",
            "filename": "django/forms/fields.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/534c427b20237fb4224323c6f626fa68720545ee/django%2Fforms%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/534c427b20237fb4224323c6f626fa68720545ee/django%2Fforms%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Ffields.py?ref=534c427b20237fb4224323c6f626fa68720545ee",
            "patch": "@@ -450,6 +450,7 @@ class FileField(Field):\n \n     def __init__(self, *args, **kwargs):\n         self.max_length = kwargs.pop('max_length', None)\n+        self.allow_empty_file = kwargs.pop('allow_empty_file', False)\n         super(FileField, self).__init__(*args, **kwargs)\n \n     def to_python(self, data):\n@@ -468,7 +469,7 @@ def to_python(self, data):\n             raise ValidationError(self.error_messages['max_length'] % error_values)\n         if not file_name:\n             raise ValidationError(self.error_messages['invalid'])\n-        if not file_size:\n+        if not self.allow_empty_file and not file_size:\n             raise ValidationError(self.error_messages['empty'])\n \n         return data"
        },
        {
            "sha": "3bc0659c3d215e373f5f2c857b9791e7d3323abb",
            "filename": "docs/ref/forms/fields.txt",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/534c427b20237fb4224323c6f626fa68720545ee/docs%2Fref%2Fforms%2Ffields.txt",
            "raw_url": "https://github.com/django/django/raw/534c427b20237fb4224323c6f626fa68720545ee/docs%2Fref%2Fforms%2Ffields.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fforms%2Ffields.txt?ref=534c427b20237fb4224323c6f626fa68720545ee",
            "patch": "@@ -503,10 +503,15 @@ given length.\n     * Empty value: ``None``\n     * Normalizes to: An ``UploadedFile`` object that wraps the file content\n       and file name into a single object.\n-    * Validates that non-empty file data has been bound to the form.\n+    * Can validate that non-empty file data has been bound to the form.\n     * Error message keys: ``required``, ``invalid``, ``missing``, ``empty``,\n       ``max_length``\n \n+Has two optional arguments for validation, ''max_length'' and \n+''allow_empty_file''. If provided, these ensure that the file name is at \n+most the given length, and that validation will succeed even if the file \n+content is empty.\n+\n To learn more about the ``UploadedFile`` object, see the :doc:`file uploads\n documentation </topics/http/file-uploads>`.\n "
        },
        {
            "sha": "f5bb4637fd88ca15b4f1e762e050a6cd3a4e9d0b",
            "filename": "tests/regressiontests/forms/tests/fields.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/534c427b20237fb4224323c6f626fa68720545ee/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/534c427b20237fb4224323c6f626fa68720545ee/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py?ref=534c427b20237fb4224323c6f626fa68720545ee",
            "patch": "@@ -506,6 +506,11 @@ def test_filefield_2(self):\n         self.assertEqual('files/test2.pdf', f.clean(None, 'files/test2.pdf'))\n         self.assertEqual(SimpleUploadedFile, type(f.clean(SimpleUploadedFile('name', 'Some File Content'))))\n \n+    def test_filefield_3(self):\n+        f = FileField(allow_empty_file=True)\n+        self.assertEqual(SimpleUploadedFile,\n+                         type(f.clean(SimpleUploadedFile('name', ''))))\n+\n     # URLField ##################################################################\n \n     def test_urlfield_1(self):"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 13,
        "deletions": 2
    }
}