{
    "author": "ramiro",
    "message": "Fixed #17676 -- Fixed introspection of column names that start with digit(s).\n\nThanks Gandalfar for the report and patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17509 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "a411242e947c2c330a87ec5149510114312c8b8d",
    "files": [
        {
            "sha": "8da0d7e84fdac993f4aea8e08668f909738f04d4",
            "filename": "django/core/management/commands/inspectdb.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/a411242e947c2c330a87ec5149510114312c8b8d/django%2Fcore%2Fmanagement%2Fcommands%2Finspectdb.py",
            "raw_url": "https://github.com/django/django/raw/a411242e947c2c330a87ec5149510114312c8b8d/django%2Fcore%2Fmanagement%2Fcommands%2Finspectdb.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Finspectdb.py?ref=a411242e947c2c330a87ec5149510114312c8b8d",
            "patch": "@@ -101,8 +101,8 @@ def handle_inspection(self, options):\n                     att_name += '_field'\n                     comment_notes.append('Field renamed because it was a Python reserved word.')\n \n-                if att_name.isdigit():\n-                    att_name = 'number_%d' % int(att_name)\n+                if att_name[0].isdigit():\n+                    att_name = 'number_%s' % att_name\n                     extra_params['db_column'] = unicode(column_name)\n                     comment_notes.append(\"Field renamed because it wasn't a \"\n                         \"valid Python identifier.\")"
        },
        {
            "sha": "9f815855b63999ef29105478ed064e4932f45577",
            "filename": "tests/regressiontests/inspectdb/models.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/a411242e947c2c330a87ec5149510114312c8b8d/tests%2Fregressiontests%2Finspectdb%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/a411242e947c2c330a87ec5149510114312c8b8d/tests%2Fregressiontests%2Finspectdb%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Finspectdb%2Fmodels.py?ref=a411242e947c2c330a87ec5149510114312c8b8d",
            "patch": "@@ -15,3 +15,7 @@ class PeopleMoreData(models.Model):\n     people_unique = models.ForeignKey(People, unique=True)\n     license = models.CharField(max_length=255)\n \n+class DigitsInColumnName(models.Model):\n+    all_digits = models.CharField(max_length=11, db_column='123')\n+    leading_digit = models.CharField(max_length=11, db_column='4extra')\n+    leading_digits = models.CharField(max_length=11, db_column='45extra')"
        },
        {
            "sha": "944eb64568d395a92c4fbd2ba8e75810c173ea5d",
            "filename": "tests/regressiontests/inspectdb/tests.py",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/a411242e947c2c330a87ec5149510114312c8b8d/tests%2Fregressiontests%2Finspectdb%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a411242e947c2c330a87ec5149510114312c8b8d/tests%2Fregressiontests%2Finspectdb%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Finspectdb%2Ftests.py?ref=a411242e947c2c330a87ec5149510114312c8b8d",
            "patch": "@@ -18,3 +18,18 @@ def test_attribute_name_not_python_keyword(self):\n         self.assertIn(\"people_unique = models.ForeignKey(InspectdbPeople, unique=True)\",\n             out.getvalue())\n         out.close()\n+\n+    def test_digits_column_name_introspection(self):\n+        \"\"\"Introspection of column names consist/start with digits (#16536/#17676)\"\"\"\n+        out = StringIO()\n+        call_command('inspectdb', stdout=out)\n+        error_message = \"inspectdb generated a model field name which is a number\"\n+        self.assertNotIn(\"    123 = models.CharField\", out.getvalue(), msg=error_message)\n+        self.assertIn(\"number_123 = models.CharField\", out.getvalue())\n+\n+        error_message = \"inspectdb generated a model field name which starts with a digit\"\n+        self.assertNotIn(\"    4extra = models.CharField\", out.getvalue(), msg=error_message)\n+        self.assertIn(\"number_4extra = models.CharField\", out.getvalue())\n+\n+        self.assertNotIn(\"    45extra = models.CharField\", out.getvalue(), msg=error_message)\n+        self.assertIn(\"number_45extra = models.CharField\", out.getvalue())"
        }
    ],
    "stats": {
        "total": 23,
        "additions": 21,
        "deletions": 2
    }
}