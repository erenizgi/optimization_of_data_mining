{
    "author": "freakboy3742",
    "message": "Fixed #14878 -- Clarified the way verbose_name_plural is used in generic list views as a context variable. Thanks to diegueus9 for the report.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15133 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
    "files": [
        {
            "sha": "3fc21c1f4958e3fed0e57347ae54b5419a8f9568",
            "filename": "django/views/generic/detail.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/django%2Fviews%2Fgeneric%2Fdetail.py",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/django%2Fviews%2Fgeneric%2Fdetail.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fviews%2Fgeneric%2Fdetail.py?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -2,6 +2,7 @@\n \n from django.core.exceptions import ImproperlyConfigured, ObjectDoesNotExist\n from django.http import Http404\n+from django.utils.encoding import smart_str\n from django.views.generic.base import TemplateResponseMixin, View\n \n \n@@ -79,8 +80,8 @@ def get_context_object_name(self, obj):\n         if self.context_object_name:\n             return self.context_object_name\n         elif hasattr(obj, '_meta'):\n-            return re.sub('[^a-zA-Z0-9]+', '_',\n-                    obj._meta.verbose_name.lower())\n+            return smart_str(re.sub('[^a-zA-Z0-9]+', '_',\n+                    obj._meta.verbose_name.lower()))\n         else:\n             return None\n "
        },
        {
            "sha": "cd7f9f6ae8e16990c3516804248e54a55f5e64d2",
            "filename": "django/views/generic/list.py",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/django%2Fviews%2Fgeneric%2Flist.py",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/django%2Fviews%2Fgeneric%2Flist.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fviews%2Fgeneric%2Flist.py?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -1,9 +1,12 @@\n+import re\n+\n from django.core.paginator import Paginator, InvalidPage\n from django.core.exceptions import ImproperlyConfigured\n from django.http import Http404\n from django.utils.encoding import smart_str\n from django.views.generic.base import TemplateResponseMixin, View\n \n+\n class MultipleObjectMixin(object):\n     allow_empty = True\n     queryset = None\n@@ -76,7 +79,8 @@ def get_context_object_name(self, object_list):\n         if self.context_object_name:\n             return self.context_object_name\n         elif hasattr(object_list, 'model'):\n-            return smart_str(object_list.model._meta.verbose_name_plural)\n+            return smart_str(re.sub('[^a-zA-Z0-9]+', '_',\n+                    object_list.model._meta.verbose_name_plural.lower()))\n         else:\n             return None\n "
        },
        {
            "sha": "8350fd22b24bad391d2b726fd52d7970e3954a51",
            "filename": "docs/ref/class-based-views.txt",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/docs%2Fref%2Fclass-based-views.txt",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/docs%2Fref%2Fclass-based-views.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fclass-based-views.txt?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -428,7 +428,7 @@ FormMixin\n     .. method:: get_form_kwargs()\n \n         Build the keyword arguments requried to instanciate an the form.\n-        \n+\n         The ``initial`` argument is set to :meth:`.get_initial`. If the\n         request is a ``POST`` or ``PUT``, the request data (``request.POST``\n         and ``request.FILES``) will also be provided."
        },
        {
            "sha": "516a3150ed46d0aabf917ccc55e8f0cda9adda43",
            "filename": "docs/topics/class-based-views.txt",
            "status": "modified",
            "additions": 17,
            "deletions": 8,
            "changes": 25,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/docs%2Ftopics%2Fclass-based-views.txt",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/docs%2Ftopics%2Fclass-based-views.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fclass-based-views.txt?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -206,14 +206,23 @@ their attributes or methods.\n Making \"friendly\" template contexts\n -----------------------------------\n \n-You might have noticed that our sample publisher list template stores all the\n-publishers in a variable named ``object_list``. While this works just fine, it\n-isn't all that \"friendly\" to template authors: they have to \"just know\" that\n-they're dealing with publishers here. A more obvious name for that variable\n-would be ``publisher_list``.\n-\n-We can change the name of that variable easily with the ``context_object_name``\n-attribute - here, we'll override it in the URLconf, since it's a simple change:\n+You might have noticed that our sample publisher list template stores\n+all the publishers in a variable named ``object_list``. While this\n+works just fine, it isn't all that \"friendly\" to template authors:\n+they have to \"just know\" that they're dealing with publishers here.\n+\n+Well, if you're dealing with a Django object, this is already done for\n+you. When you are dealing with an object or queryset, Django is able\n+to populate the context using the verbose name (or the plural verbose\n+name, in the case of a list of objects) of the object being displayed.\n+This is provided in addition to the default ``object_list`` entry, but\n+contains exactly the same data.\n+\n+If the verbose name (or plural verbose name) still isn't a good match,\n+you can manually set the name of the context variable. The\n+``context_object_name`` attribute on a generic view specifies the\n+context variable to use. In this example, we'll override it in the\n+URLconf, since it's a simple change:\n \n .. parsed-literal::\n "
        },
        {
            "sha": "c26ca67bd1e2fd113922d1e3ac136b2a619ed192",
            "filename": "tests/regressiontests/generic_views/detail.py",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Fdetail.py",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Fdetail.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Fdetail.py?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -1,7 +1,7 @@\n from django.core.exceptions import ImproperlyConfigured\n from django.test import TestCase\n \n-from regressiontests.generic_views.models import Author, Page\n+from regressiontests.generic_views.models import Artist, Author, Page\n \n \n class DetailViewTest(TestCase):\n@@ -28,6 +28,13 @@ def test_detail_by_slug(self):\n         self.assertEqual(res.context['author'], Author.objects.get(slug='scott-rosenberg'))\n         self.assertTemplateUsed(res, 'generic_views/author_detail.html')\n \n+    def test_verbose_name(self):\n+        res = self.client.get('/detail/artist/1/')\n+        self.assertEqual(res.status_code, 200)\n+        self.assertEqual(res.context['object'], Artist.objects.get(pk=1))\n+        self.assertEqual(res.context['professional_artist'], Artist.objects.get(pk=1))\n+        self.assertTemplateUsed(res, 'generic_views/artist_detail.html')\n+\n     def test_template_name(self):\n         res = self.client.get('/detail/author/1/template_name/')\n         self.assertEqual(res.status_code, 200)"
        },
        {
            "sha": "dfffbbf8d836dfcef852b41295c78243c2a15868",
            "filename": "tests/regressiontests/generic_views/fixtures/generic-views-test-data.json",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Ffixtures%2Fgeneric-views-test-data.json",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Ffixtures%2Fgeneric-views-test-data.json",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Ffixtures%2Fgeneric-views-test-data.json?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -1,4 +1,11 @@\n [\n+ {\n+   \"model\": \"generic_views.artist\",\n+   \"pk\": 1,\n+   \"fields\": {\n+     \"name\": \"Rene Magritte\"\n+   }\n+ },\n  {\n    \"model\": \"generic_views.author\",\n    \"pk\": 1,"
        },
        {
            "sha": "7414c62d3a2172b4964661b668bfef874e18b87e",
            "filename": "tests/regressiontests/generic_views/list.py",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Flist.py",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Flist.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Flist.py?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -1,7 +1,7 @@\n from django.core.exceptions import ImproperlyConfigured\n from django.test import TestCase\n \n-from regressiontests.generic_views.models import Author\n+from regressiontests.generic_views.models import Author, Artist\n from regressiontests.generic_views.views import CustomPaginator\n \n class ListViewTests(TestCase):\n@@ -106,6 +106,16 @@ def test_paginated_non_queryset(self):\n         self.assertEqual(res.status_code, 200)\n         self.assertEqual(len(res.context['object_list']), 1)\n \n+    def test_verbose_name(self):\n+        res = self.client.get('/list/artists/')\n+        self.assertEqual(res.status_code, 200)\n+        self.assertTemplateUsed(res, 'generic_views/list.html')\n+        self.assertEqual(list(res.context['object_list']), list(Artist.objects.all()))\n+        self.assertIs(res.context['professional_artists'], res.context['object_list'])\n+        self.assertIsNone(res.context['paginator'])\n+        self.assertIsNone(res.context['page_obj'])\n+        self.assertFalse(res.context['is_paginated'])\n+\n     def test_allow_empty_false(self):\n         res = self.client.get('/list/authors/notempty/')\n         self.assertEqual(res.status_code, 200)"
        },
        {
            "sha": "5445e24cee6d1d896eb98b5876b55fb45fc267a8",
            "filename": "tests/regressiontests/generic_views/models.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Fmodels.py?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -5,6 +5,8 @@ class Artist(models.Model):\n \n     class Meta:\n         ordering = ['name']\n+        verbose_name = 'professional artist'\n+        verbose_name_plural = 'professional artists'\n \n     def __unicode__(self):\n         return self.name"
        },
        {
            "sha": "bd997e7e6d4713245c5bbfa88ef2329b067decdb",
            "filename": "tests/regressiontests/generic_views/urls.py",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Furls.py?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -100,6 +100,9 @@\n         views.DictList.as_view()),\n     (r'^list/dict/paginated/$',\n         views.DictList.as_view(paginate_by=1)),\n+    url(r'^list/artists/$',\n+        views.ArtistList.as_view(),\n+        name=\"artists_list\"),\n     url(r'^list/authors/$',\n         views.AuthorList.as_view(),\n         name=\"authors_list\"),"
        },
        {
            "sha": "e9be7c7ca9c3e08131050b118d7015a57f693be8",
            "filename": "tests/regressiontests/generic_views/views.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b/tests%2Fregressiontests%2Fgeneric_views%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Fviews.py?ref=a00e8d4e4204bfb730ba3eac2ee11ad83c8ec91b",
            "patch": "@@ -47,6 +47,11 @@ class DictList(generic.ListView):\n     template_name = 'generic_views/list.html'\n \n \n+class ArtistList(generic.ListView):\n+    template_name = 'generic_views/list.html'\n+    queryset = Artist.objects.all()\n+\n+\n class AuthorList(generic.ListView):\n     queryset = Author.objects.all()\n "
        }
    ],
    "stats": {
        "total": 76,
        "additions": 62,
        "deletions": 14
    }
}