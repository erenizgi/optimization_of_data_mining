{
    "author": "ramiro",
    "message": "Fixed #18040 -- Removed so-called project-level locale trees from the list of paths the translation loading process takes in account.\n\nDeprecated in Django 1.3. Removed completely for Django 1.5.\n\nThanks Claude for the review.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17861 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "b41ebcf1b9454bf0905c69594fa2dd1af19e7a60",
    "files": [
        {
            "sha": "ac062823a4a7b2a14acdd4cf29be683c898ecda4",
            "filename": "django/utils/translation/__init__.py",
            "status": "modified",
            "additions": 0,
            "deletions": 18,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/django%2Futils%2Ftranslation%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/django%2Futils%2Ftranslation%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2F__init__.py?ref=b41ebcf1b9454bf0905c69594fa2dd1af19e7a60",
            "patch": "@@ -1,12 +1,8 @@\n \"\"\"\n Internationalization support.\n \"\"\"\n-import warnings\n-from os import path\n-\n from django.utils.encoding import force_unicode\n from django.utils.functional import lazy\n-from django.utils.importlib import import_module\n \n \n __all__ = [\n@@ -47,20 +43,6 @@ def __getattr__(self, real_name):\n         from django.conf import settings\n         if settings.USE_I18N:\n             from django.utils.translation import trans_real as trans\n-            # Make sure the project's locale dir isn't in LOCALE_PATHS\n-            if settings.SETTINGS_MODULE is not None:\n-                parts = settings.SETTINGS_MODULE.split('.')\n-                project = import_module(parts[0])\n-                project_locale_path = path.normpath(\n-                    path.join(path.dirname(project.__file__), 'locale'))\n-                normalized_locale_paths = [path.normpath(locale_path)\n-                    for locale_path in settings.LOCALE_PATHS]\n-                if (path.isdir(project_locale_path) and\n-                        not project_locale_path in normalized_locale_paths):\n-                    warnings.warn(\"Translations in the project directory \"\n-                                  \"aren't supported anymore. Use the \"\n-                                  \"LOCALE_PATHS setting instead.\",\n-                                  DeprecationWarning)\n         else:\n             from django.utils.translation import trans_null as trans\n         setattr(self, real_name, getattr(trans, real_name))"
        },
        {
            "sha": "76c9bfc1ea5f90b51e534c0c6d948f7232241005",
            "filename": "django/utils/translation/trans_real.py",
            "status": "modified",
            "additions": 0,
            "deletions": 12,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "raw_url": "https://github.com/django/django/raw/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2Ftrans_real.py?ref=b41ebcf1b9454bf0905c69594fa2dd1af19e7a60",
            "patch": "@@ -111,13 +111,6 @@ def translation(language):\n \n     globalpath = os.path.join(os.path.dirname(sys.modules[settings.__module__].__file__), 'locale')\n \n-    if settings.SETTINGS_MODULE is not None:\n-        parts = settings.SETTINGS_MODULE.split('.')\n-        project = import_module(parts[0])\n-        projectpath = os.path.join(os.path.dirname(project.__file__), 'locale')\n-    else:\n-        projectpath = None\n-\n     def _fetch(lang, fallback=None):\n \n         global _translations\n@@ -163,11 +156,6 @@ def _merge(path):\n             if os.path.isdir(apppath):\n                 res = _merge(apppath)\n \n-        localepaths = [os.path.normpath(path) for path in settings.LOCALE_PATHS]\n-        if (projectpath and os.path.isdir(projectpath) and\n-                os.path.normpath(projectpath) not in localepaths):\n-            res = _merge(projectpath)\n-\n         for localepath in reversed(settings.LOCALE_PATHS):\n             if os.path.isdir(localepath):\n                 res = _merge(localepath)"
        },
        {
            "sha": "052109b72c0494d255add716d867be8cf7ea2aa9",
            "filename": "docs/topics/i18n/translation.txt",
            "status": "modified",
            "additions": 2,
            "deletions": 22,
            "changes": 24,
            "blob_url": "https://github.com/django/django/blob/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/docs%2Ftopics%2Fi18n%2Ftranslation.txt",
            "raw_url": "https://github.com/django/django/raw/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/docs%2Ftopics%2Fi18n%2Ftranslation.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fi18n%2Ftranslation.txt?ref=b41ebcf1b9454bf0905c69594fa2dd1af19e7a60",
            "patch": "@@ -1503,18 +1503,9 @@ translations for the same literal:\n 2. Then, it looks for and uses if it exists a ``locale`` directory in each\n    of the installed apps listed in :setting:`INSTALLED_APPS`.  The ones\n    appearing first have higher precedence than the ones appearing later.\n-3. Then, it looks for a ``locale`` directory in the project directory, or\n-   more accurately, in the directory containing your settings file.\n-4. Finally, the Django-provided base translation in ``django/conf/locale``\n+3. Finally, the Django-provided base translation in ``django/conf/locale``\n    is used as a fallback.\n \n-.. deprecated:: 1.3\n-    Lookup in the ``locale`` subdirectory of the directory containing your\n-    settings file (item 3 above) is deprecated since the 1.3 release and will be\n-    removed in Django 1.5. You can use the :setting:`LOCALE_PATHS` setting\n-    instead, by listing the absolute filesystem path of such ``locale``\n-    directory in the setting value.\n-\n .. seealso::\n \n     The translations for literals included in JavaScript assets are looked up\n@@ -1527,25 +1518,14 @@ be named using :term:`locale name` notation. E.g. ``de``, ``pt_BR``, ``es_AR``,\n etc.\n \n This way, you can write applications that include their own translations, and\n-you can override base translations in your project path. Or, you can just build\n+you can override base translations in your project. Or, you can just build\n a big project out of several apps and put all translations into one big common\n message file specific to the project you are composing. The choice is yours.\n \n-.. note::\n-\n-    If you're using manually configured settings, as described in\n-    :ref:`settings-without-django-settings-module`, the ``locale`` directory in\n-    the project directory will not be examined, since Django loses the ability\n-    to work out the location of the project directory. (Django normally uses the\n-    location of the settings file to determine this, and a settings file doesn't\n-    exist if you're manually configuring your settings.)\n-\n All message file repositories are structured the same way. They are:\n \n * All paths listed in :setting:`LOCALE_PATHS` in your settings file are\n   searched for ``<language>/LC_MESSAGES/django.(po|mo)``\n-* ``$PROJECTPATH/locale/<language>/LC_MESSAGES/django.(po|mo)`` --\n-  deprecated, see above.\n * ``$APPPATH/locale/<language>/LC_MESSAGES/django.(po|mo)``\n * ``$PYTHONPATH/django/conf/locale/<language>/LC_MESSAGES/django.(po|mo)``\n "
        },
        {
            "sha": "68ebda064a0ba145ffdcd8e9d2f1ac25b120e3ab",
            "filename": "tests/regressiontests/admin_scripts/tests.py",
            "status": "modified",
            "additions": 0,
            "deletions": 10,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/tests%2Fregressiontests%2Fadmin_scripts%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/tests%2Fregressiontests%2Fadmin_scripts%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_scripts%2Ftests.py?ref=b41ebcf1b9454bf0905c69594fa2dd1af19e7a60",
            "patch": "@@ -157,16 +157,6 @@ def run_manage(self, args, settings_file=None):\n \n     def assertNoOutput(self, stream):\n         \"Utility assertion: assert that the given stream is empty\"\n-        # HACK: Under Windows, ignore warnings of the form:\n-        # 'warning: Not loading directory '...\\tests\\regressiontests\\locale': missing __init__.py'\n-        # It has been impossible to filter them out using other means like:\n-        # * Using warning.filterwarnings() (for the Python interpreter running the\n-        #   tests) and/or\n-        # * Using -Wignore:... (for the python interpreter spawned in self.run_test())\n-        # Instead use a strategy copied from Mercurial's setup.py\n-        if sys.platform == 'win32':\n-            stream = [e for e in stream.splitlines()\n-                if not e.startswith('warning: Not importing directory')]\n         self.assertEqual(len(stream), 0, \"Stream should be empty: actually contains '%s'\" % stream)\n \n     def assertOutput(self, stream, msg):"
        },
        {
            "sha": "faed4e55c7215864e3491bfe7cd4fd32c2a85ad7",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 0,
            "deletions": 24,
            "changes": 24,
            "blob_url": "https://github.com/django/django/blob/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=b41ebcf1b9454bf0905c69594fa2dd1af19e7a60",
            "patch": "@@ -40,7 +40,6 @@\n     URLTranslationTests, URLDisabledTests, URLTagTests, URLTestCaseBase,\n     URLRedirectWithoutTrailingSlashSettingTests, URLNamespaceTests,\n     URLPrefixTests, URLResponseTests, URLRedirectTests, PathUnusedTests)\n-from .test_warnings import DeprecationWarningTests\n \n \n here = os.path.dirname(os.path.abspath(__file__))\n@@ -869,29 +868,6 @@ def test_locale_paths_override_app_translation(self):\n         with self.settings(INSTALLED_APPS=extended_apps):\n             self.assertUgettext('Time', 'LOCALE_PATHS')\n \n-    def test_locale_paths_override_project_translation(self):\n-        with self.settings(SETTINGS_MODULE='regressiontests'):\n-            self.assertUgettext('Date/time', 'LOCALE_PATHS')\n-\n-class ProjectResolutionOrderI18NTests(ResolutionOrderI18NTests):\n-\n-    def setUp(self):\n-        self.old_settings_module = settings.SETTINGS_MODULE\n-        settings.SETTINGS_MODULE = 'regressiontests'\n-        super(ProjectResolutionOrderI18NTests, self).setUp()\n-\n-    def tearDown(self):\n-        settings.SETTINGS_MODULE = self.old_settings_module\n-        super(ProjectResolutionOrderI18NTests, self).tearDown()\n-\n-    def test_project_translation(self):\n-        self.assertUgettext('Date/time', 'PROJECT')\n-\n-    def test_project_override_app_translation(self):\n-        extended_apps = list(settings.INSTALLED_APPS) + ['regressiontests.i18n.resolution']\n-        with self.settings(INSTALLED_APPS=extended_apps):\n-            self.assertUgettext('Date/time', 'PROJECT')\n-\n class DjangoFallbackResolutionOrderI18NTests(ResolutionOrderI18NTests):\n \n     def test_django_fallback(self):"
        },
        {
            "sha": "c53908bf3d1a892f619b64a000892a5026bf1778",
            "filename": "tests/regressiontests/locale/de/LC_MESSAGES/django.mo",
            "status": "removed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/f38cf60c35bc9427ad14e261eea40acf91bc2c49/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo",
            "raw_url": "https://github.com/django/django/raw/f38cf60c35bc9427ad14e261eea40acf91bc2c49/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo?ref=f38cf60c35bc9427ad14e261eea40acf91bc2c49"
        },
        {
            "sha": "001b595d4d6e89a23494d6059ee7290a7da44834",
            "filename": "tests/regressiontests/locale/de/LC_MESSAGES/django.po",
            "status": "removed",
            "additions": 0,
            "deletions": 25,
            "changes": 25,
            "blob_url": "https://github.com/django/django/blob/f38cf60c35bc9427ad14e261eea40acf91bc2c49/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po",
            "raw_url": "https://github.com/django/django/raw/f38cf60c35bc9427ad14e261eea40acf91bc2c49/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po?ref=f38cf60c35bc9427ad14e261eea40acf91bc2c49",
            "patch": "@@ -1,25 +0,0 @@\n-# SOME DESCRIPTIVE TITLE.\n-# Copyright (C) YEAR THE PACKAGE'S COPYRIGHT HOLDER\n-# This file is distributed under the same license as the PACKAGE package.\n-# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.\n-#\n-msgid \"\"\n-msgstr \"\"\n-\"Project-Id-Version: django tests\\n\"\n-\"Report-Msgid-Bugs-To: \\n\"\n-\"POT-Creation-Date: 2010-02-14 17:33+0100\\n\"\n-\"PO-Revision-Date: 2011-02-07 13:13-0300\\n\"\n-\"Last-Translator: FULL NAME <EMAIL@ADDRESS>\\n\"\n-\"Language-Team: LANGUAGE <LL@li.org>\\n\"\n-\"MIME-Version: 1.0\\n\"\n-\"Content-Type: text/plain; charset=UTF-8\\n\"\n-\"Content-Transfer-Encoding: 8bit\\n\"\n-\"Plural-Forms: nplurals=2; plural=(n != 1)\\n\"\n-\n-#: models.py:3\n-msgid \"Time\"\n-msgstr \"Zeit (PROJECT)\"\n-\n-#: models.py:5\n-msgid \"Date/time\"\n-msgstr \"Datum/Zeit (PROJECT)\""
        },
        {
            "sha": "257aa3083d9ff5730134ee1e34536b8f4583745d",
            "filename": "tests/runtests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/tests%2Fruntests.py",
            "raw_url": "https://github.com/django/django/raw/b41ebcf1b9454bf0905c69594fa2dd1af19e7a60/tests%2Fruntests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fruntests.py?ref=b41ebcf1b9454bf0905c69594fa2dd1af19e7a60",
            "patch": "@@ -25,7 +25,7 @@\n TEMP_DIR = tempfile.mkdtemp(prefix='django_')\n os.environ['DJANGO_TEST_TEMP_DIR'] = TEMP_DIR\n \n-REGRESSION_SUBDIRS_TO_SKIP = ['locale']\n+REGRESSION_SUBDIRS_TO_SKIP = []\n \n ALWAYS_INSTALLED_APPS = [\n     'django.contrib.contenttypes',"
        }
    ],
    "stats": {
        "total": 115,
        "additions": 3,
        "deletions": 112
    }
}