{
    "author": "claudep",
    "message": "Added tests for some sql_* management commands",
    "sha": "718afcafc202940cd15799459178a2534b8217d5",
    "files": [
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "tests/regressiontests/commands_sql/__init__.py",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/718afcafc202940cd15799459178a2534b8217d5/tests%2Fregressiontests%2Fcommands_sql%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/718afcafc202940cd15799459178a2534b8217d5/tests%2Fregressiontests%2Fcommands_sql%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fcommands_sql%2F__init__.py?ref=718afcafc202940cd15799459178a2534b8217d5"
        },
        {
            "sha": "089aa96f300128ec8c429bb3923048b0bc737690",
            "filename": "tests/regressiontests/commands_sql/models.py",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/718afcafc202940cd15799459178a2534b8217d5/tests%2Fregressiontests%2Fcommands_sql%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/718afcafc202940cd15799459178a2534b8217d5/tests%2Fregressiontests%2Fcommands_sql%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fcommands_sql%2Fmodels.py?ref=718afcafc202940cd15799459178a2534b8217d5",
            "patch": "@@ -0,0 +1,7 @@\n+from django.db import models\n+from django.utils.encoding import python_2_unicode_compatible\n+\n+\n+@python_2_unicode_compatible\n+class Book(models.Model):\n+    title = models.CharField(max_length=100, db_index=True)"
        },
        {
            "sha": "205a295cfe02c2b1eba33485b3ca2b0890c10178",
            "filename": "tests/regressiontests/commands_sql/tests.py",
            "status": "added",
            "additions": 38,
            "deletions": 0,
            "changes": 38,
            "blob_url": "https://github.com/django/django/blob/718afcafc202940cd15799459178a2534b8217d5/tests%2Fregressiontests%2Fcommands_sql%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/718afcafc202940cd15799459178a2534b8217d5/tests%2Fregressiontests%2Fcommands_sql%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fcommands_sql%2Ftests.py?ref=718afcafc202940cd15799459178a2534b8217d5",
            "patch": "@@ -0,0 +1,38 @@\n+from __future__ import unicode_literals\n+\n+from django.core.management.color import no_style\n+from django.core.management.sql import (sql_create, sql_delete, sql_indexes,\n+    sql_all)\n+from django.db import connections, DEFAULT_DB_ALIAS, models\n+from django.test import TestCase\n+from django.utils import six\n+\n+# See also regressiontests/initial_sql_regress for 'custom_sql_for_model' tests\n+\n+\n+class SQLCommandsTestCase(TestCase):\n+    \"\"\"Tests for several functions in django/core/management/sql.py\"\"\"\n+    def test_sql_create(self):\n+        app = models.get_app('commands_sql')\n+        output = sql_create(app, no_style(), connections[DEFAULT_DB_ALIAS])\n+        six.assertRegex(self, output[0], r'^CREATE TABLE .commands_sql_book.*')\n+\n+    def test_sql_delete(self):\n+        app = models.get_app('commands_sql')\n+        output = sql_delete(app, no_style(), connections[DEFAULT_DB_ALIAS])\n+        six.assertRegex(self, output[0], r'^DROP TABLE .commands_sql_book.*')\n+\n+    def test_sql_indexes(self):\n+        app = models.get_app('commands_sql')\n+        output = sql_indexes(app, no_style(), connections[DEFAULT_DB_ALIAS])\n+        # PostgreSQL creates two indexes\n+        self.assertIn(len(output), [1, 2])\n+        self.assertTrue(output[0].startswith(\"CREATE INDEX\"))\n+\n+    def test_sql_all(self):\n+        app = models.get_app('commands_sql')\n+        output = sql_all(app, no_style(), connections[DEFAULT_DB_ALIAS])\n+        # PostgreSQL creates two indexes\n+        self.assertIn(len(output), [2, 3])\n+        self.assertTrue(output[0].startswith('CREATE TABLE'))\n+        self.assertTrue(output[1].startswith('CREATE INDEX'))"
        }
    ],
    "stats": {
        "total": 45,
        "additions": 45,
        "deletions": 0
    }
}