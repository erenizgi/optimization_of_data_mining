{
    "author": "claudep",
    "message": "Fixed #19272 -- Fixed gettext_lazy returned type on Python 2\n\nThanks tyrion for the report.",
    "sha": "550ddc66b496473c8ee282c7ab6be5885a359d75",
    "files": [
        {
            "sha": "1bcef2d8de7e4c41e4ffac6bac15d11e1a66a93b",
            "filename": "django/utils/translation/trans_real.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/550ddc66b496473c8ee282c7ab6be5885a359d75/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "raw_url": "https://github.com/django/django/raw/550ddc66b496473c8ee282c7ab6be5885a359d75/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2Ftrans_real.py?ref=550ddc66b496473c8ee282c7ab6be5885a359d75",
            "patch": "@@ -246,7 +246,8 @@ def do_translate(message, translation_function):\n     \"\"\"\n     global _default\n \n-    eol_message = message.replace('\\r\\n', '\\n').replace('\\r', '\\n')\n+    # str() is allowing a bytestring message to remain bytestring on Python 2\n+    eol_message = message.replace(str('\\r\\n'), str('\\n')).replace(str('\\r'), str('\\n'))\n     t = getattr(_active, \"value\", None)\n     if t is not None:\n         result = getattr(t, translation_function)(eol_message)"
        },
        {
            "sha": "2e0c097a192db5824d80e591610e2eb1232b790f",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/550ddc66b496473c8ee282c7ab6be5885a359d75/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/550ddc66b496473c8ee282c7ab6be5885a359d75/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=550ddc66b496473c8ee282c7ab6be5885a359d75",
            "patch": "@@ -83,6 +83,10 @@ def test_lazy_objects(self):\n         s4 = ugettext_lazy('Some other string')\n         self.assertEqual(False, s == s4)\n \n+        if not six.PY3:\n+            # On Python 2, gettext_lazy should not transform a bytestring to unicode\n+            self.assertEqual(gettext_lazy(b\"test\").upper(), b\"TEST\")\n+\n     def test_lazy_pickle(self):\n         s1 = ugettext_lazy(\"test\")\n         self.assertEqual(six.text_type(s1), \"test\")"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
    }
}