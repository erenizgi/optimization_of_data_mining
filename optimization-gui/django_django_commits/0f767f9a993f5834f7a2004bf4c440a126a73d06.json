{
    "author": "freakboy3742",
    "message": "Fixed #16672 -- Ensure that test classes decorated with @override_setings gets the right name when running the tests. Thanks to Julien Phalip for the report and initial patch\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16650 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "0f767f9a993f5834f7a2004bf4c440a126a73d06",
    "files": [
        {
            "sha": "9673a26b98e6ab2cbc5839895374afd430df3bcf",
            "filename": "django/test/utils.py",
            "status": "modified",
            "additions": 16,
            "deletions": 7,
            "changes": 23,
            "blob_url": "https://github.com/django/django/blob/0f767f9a993f5834f7a2004bf4c440a126a73d06/django%2Ftest%2Futils.py",
            "raw_url": "https://github.com/django/django/raw/0f767f9a993f5834f7a2004bf4c440a126a73d06/django%2Ftest%2Futils.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftest%2Futils.py?ref=0f767f9a993f5834f7a2004bf4c440a126a73d06",
            "patch": "@@ -196,13 +196,22 @@ def __exit__(self, exc_type, exc_value, traceback):\n     def __call__(self, test_func):\n         from django.test import TransactionTestCase\n         if isinstance(test_func, type) and issubclass(test_func, TransactionTestCase):\n-            class inner(test_func):\n-                def _pre_setup(innerself):\n-                    self.enable()\n-                    super(inner, innerself)._pre_setup()\n-                def _post_teardown(innerself):\n-                    super(inner, innerself)._post_teardown()\n-                    self.disable()\n+            # When decorating a class, we need to construct a new class\n+            # with the same name so that the test discovery tools can\n+            # get a useful name.\n+            def _pre_setup(innerself):\n+                self.enable()\n+                test_func._pre_setup(innerself)\n+            def _post_teardown(innerself):\n+                test_func._post_teardown(innerself)\n+                self.disable()\n+            inner = type(\n+                test_func.__name__,\n+                (test_func,),\n+                {\n+                    '_pre_setup': _pre_setup,\n+                    '_post_teardown': _post_teardown,\n+                })\n         else:\n             @wraps(test_func)\n             def inner(*args, **kwargs):"
        },
        {
            "sha": "6af2ed307b9e6c1cb6314c0bce97cfbc4e5e1931",
            "filename": "tests/regressiontests/settings_tests/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/0f767f9a993f5834f7a2004bf4c440a126a73d06/tests%2Fregressiontests%2Fsettings_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0f767f9a993f5834f7a2004bf4c440a126a73d06/tests%2Fregressiontests%2Fsettings_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fsettings_tests%2Ftests.py?ref=0f767f9a993f5834f7a2004bf4c440a126a73d06",
            "patch": "@@ -15,6 +15,9 @@ def test_override(self):\n     def test_method_override(self):\n         self.assertEqual(settings.TEST, 'override2')\n \n+    def test_decorated_testcase_name(self):\n+        self.assertEquals(FullyDecoratedTranTestCase.__name__, 'FullyDecoratedTranTestCase')\n+\n FullyDecoratedTranTestCase = override_settings(TEST='override')(FullyDecoratedTranTestCase)\n \n # @override_settings(TEST='override')"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 19,
        "deletions": 7
    }
}