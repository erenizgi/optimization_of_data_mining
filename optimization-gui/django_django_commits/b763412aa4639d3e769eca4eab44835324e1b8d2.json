{
    "author": "spookylukey",
    "message": "Removed ForeignRelatedObjectsDescriptor.RelatedManager.delete_manager, which has been unused since [14507]\n\nAnd cleaned up the result, allowing more consistency with the other related\ndescriptors.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16931 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "b763412aa4639d3e769eca4eab44835324e1b8d2",
    "files": [
        {
            "sha": "7bcae2ee542355c664fbbb3746449bb6a5ef905c",
            "filename": "django/db/models/fields/related.py",
            "status": "modified",
            "additions": 7,
            "deletions": 22,
            "changes": 29,
            "blob_url": "https://github.com/django/django/blob/b763412aa4639d3e769eca4eab44835324e1b8d2/django%2Fdb%2Fmodels%2Ffields%2Frelated.py",
            "raw_url": "https://github.com/django/django/raw/b763412aa4639d3e769eca4eab44835324e1b8d2/django%2Fdb%2Fmodels%2Ffields%2Frelated.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Ffields%2Frelated.py?ref=b763412aa4639d3e769eca4eab44835324e1b8d2",
            "patch": "@@ -9,7 +9,7 @@\n from django.db.models.deletion import CASCADE\n from django.utils.encoding import smart_unicode\n from django.utils.translation import ugettext_lazy as _, string_concat\n-from django.utils.functional import curry, memoize, cached_property\n+from django.utils.functional import curry, cached_property\n from django.core import exceptions\n from django import forms\n \n@@ -386,8 +386,7 @@ def __get__(self, instance, instance_type=None):\n         if instance is None:\n             return self\n \n-        manager = self.create_manager(self.related.model._default_manager.__class__)\n-        return manager(instance)\n+        return self.related_manager_cls(instance)\n \n     def __set__(self, instance, value):\n         if instance is None:\n@@ -400,24 +399,11 @@ def __set__(self, instance, value):\n             manager.clear()\n         manager.add(*value)\n \n-    def delete_manager(self, instance):\n-        \"\"\"\n-        Returns a queryset based on the related model's base manager (rather\n-        than the default manager, as returned by __get__). Used by\n-        Model.delete().\n-        \"\"\"\n-        manager = self.create_manager(self.related.model._base_manager.__class__)\n-        return manager(instance)\n-\n-    def create_manager(self, superclass):\n-        \"\"\"\n-        Creates the managers used by other methods (__get__() and delete()).\n-        \"\"\"\n-\n-        # We use closures for these values so that we only need to memoize this\n-        # function on the one argument of 'superclass', and the two places that\n-        # call create_manager simply need to pass instance to the manager\n-        # __init__\n+    @cached_property\n+    def related_manager_cls(self):\n+        # Dynamically create a class that subclasses the related model's default\n+        # manager.\n+        superclass = self.related.model._default_manager.__class__\n         rel_field = self.related.field\n         rel_model = self.related.model\n         attname = rel_field.rel.get_related_field().attname\n@@ -489,7 +475,6 @@ def clear(self):\n                 clear.alters_data = True\n \n         return RelatedManager\n-    create_manager = memoize(create_manager, {}, 2)\n \n \n def create_many_related_manager(superclass, rel):"
        }
    ],
    "stats": {
        "total": 29,
        "additions": 7,
        "deletions": 22
    }
}