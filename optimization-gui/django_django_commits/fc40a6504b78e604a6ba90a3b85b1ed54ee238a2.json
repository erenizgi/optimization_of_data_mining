{
    "author": "claudep",
    "message": "Fixed #17159 -- Validated returned number of next|previous_page_number\n\nThanks mehta.apurva at gmail.com for the report and the initial patch\nand neaf for the complete patch.",
    "sha": "fc40a6504b78e604a6ba90a3b85b1ed54ee238a2",
    "files": [
        {
            "sha": "6b0b3542f89244cfd127c57f7af0f5bfd686acb7",
            "filename": "django/core/paginator.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fc40a6504b78e604a6ba90a3b85b1ed54ee238a2/django%2Fcore%2Fpaginator.py",
            "raw_url": "https://github.com/django/django/raw/fc40a6504b78e604a6ba90a3b85b1ed54ee238a2/django%2Fcore%2Fpaginator.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fpaginator.py?ref=fc40a6504b78e604a6ba90a3b85b1ed54ee238a2",
            "patch": "@@ -132,10 +132,10 @@ def has_other_pages(self):\n         return self.has_previous() or self.has_next()\n \n     def next_page_number(self):\n-        return self.number + 1\n+        return self.paginator.validate_number(self.number + 1)\n \n     def previous_page_number(self):\n-        return self.number - 1\n+        return self.paginator.validate_number(self.number - 1)\n \n     def start_index(self):\n         \"\"\""
        },
        {
            "sha": "3e274b5d98e66aa63fca79e57b67df2c5d1f5fbb",
            "filename": "docs/releases/1.5.txt",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/fc40a6504b78e604a6ba90a3b85b1ed54ee238a2/docs%2Freleases%2F1.5.txt",
            "raw_url": "https://github.com/django/django/raw/fc40a6504b78e604a6ba90a3b85b1ed54ee238a2/docs%2Freleases%2F1.5.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.5.txt?ref=fc40a6504b78e604a6ba90a3b85b1ed54ee238a2",
            "patch": "@@ -154,6 +154,16 @@ Unicode parameters (``password``, ``salt`` or ``encoded``). If any of the\n hashing methods need byte strings, you can use the\n :func:`~django.utils.encoding.smart_str` utility to encode the strings.\n \n+Validation of previous_page_number and next_page_number\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+When using :doc:`object pagination </topics/pagination>`,\n+the ``previous_page_number()`` and ``next_page_number()`` methods of the\n+:class:`~django.core.paginator.Page` object did not check if the returned\n+number was inside the existing page range.\n+It does check it now and raises an :exc:`InvalidPage` exception when the number\n+is either too low or too high.\n+\n Features deprecated in 1.5\n ==========================\n "
        },
        {
            "sha": "72560469a872ad105fae1ae79e85682a1e8946dc",
            "filename": "docs/topics/pagination.txt",
            "status": "modified",
            "additions": 10,
            "deletions": 4,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/fc40a6504b78e604a6ba90a3b85b1ed54ee238a2/docs%2Ftopics%2Fpagination.txt",
            "raw_url": "https://github.com/django/django/raw/fc40a6504b78e604a6ba90a3b85b1ed54ee238a2/docs%2Ftopics%2Fpagination.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fpagination.txt?ref=fc40a6504b78e604a6ba90a3b85b1ed54ee238a2",
            "patch": "@@ -253,13 +253,19 @@ Methods\n \n .. method:: Page.next_page_number()\n \n-    Returns the next page number. Note that this is \"dumb\" and will return the\n-    next page number regardless of whether a subsequent page exists.\n+    Returns the next page number.\n+\n+    .. versionchanged:: 1.5\n+\n+    Raises :exc:`InvalidPage` if next page doesn't exist.\n \n .. method:: Page.previous_page_number()\n \n-    Returns the previous page number. Note that this is \"dumb\" and will return\n-    the previous page number regardless of whether a previous page exists.\n+    Returns the previous page number.\n+\n+    .. versionchanged:: 1.5\n+\n+    Raises :exc:`InvalidPage` if previous page doesn't exist.\n \n .. method:: Page.start_index()\n "
        },
        {
            "sha": "4d5d8680e4b37e359546b04dd11ef2a89f6e35bc",
            "filename": "tests/modeltests/pagination/tests.py",
            "status": "modified",
            "additions": 13,
            "deletions": 13,
            "changes": 26,
            "blob_url": "https://github.com/django/django/blob/fc40a6504b78e604a6ba90a3b85b1ed54ee238a2/tests%2Fmodeltests%2Fpagination%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/fc40a6504b78e604a6ba90a3b85b1ed54ee238a2/tests%2Fmodeltests%2Fpagination%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fpagination%2Ftests.py?ref=fc40a6504b78e604a6ba90a3b85b1ed54ee238a2",
            "patch": "@@ -45,7 +45,7 @@ def test_first_page(self):\n         self.assertFalse(p.has_previous())\n         self.assertTrue(p.has_other_pages())\n         self.assertEqual(2, p.next_page_number())\n-        self.assertEqual(0, p.previous_page_number())\n+        self.assertRaises(InvalidPage, p.previous_page_number)\n         self.assertEqual(1, p.start_index())\n         self.assertEqual(5, p.end_index())\n \n@@ -63,7 +63,7 @@ def test_last_page(self):\n         self.assertFalse(p.has_next())\n         self.assertTrue(p.has_previous())\n         self.assertTrue(p.has_other_pages())\n-        self.assertEqual(3, p.next_page_number())\n+        self.assertRaises(InvalidPage, p.next_page_number)\n         self.assertEqual(1, p.previous_page_number())\n         self.assertEqual(6, p.start_index())\n         self.assertEqual(9, p.end_index())\n@@ -104,20 +104,20 @@ def test_orphans(self):\n \n     def test_paginate_list(self):\n         # Paginators work with regular lists/tuples, too -- not just with QuerySets.\n-        paginator = Paginator([1, 2, 3, 4, 5, 6, 7, 8, 9], 5)\n+        paginator = Paginator([1, 2, 3, 4, 5, 6, 7, 8, 9], 3)\n         self.assertEqual(9, paginator.count)\n-        self.assertEqual(2, paginator.num_pages)\n-        self.assertEqual([1, 2], paginator.page_range)\n-        p = paginator.page(1)\n-        self.assertEqual(\"<Page 1 of 2>\", unicode(p))\n-        self.assertEqual([1, 2, 3, 4, 5], p.object_list)\n+        self.assertEqual(3, paginator.num_pages)\n+        self.assertEqual([1, 2, 3], paginator.page_range)\n+        p = paginator.page(2)\n+        self.assertEqual(\"<Page 2 of 3>\", unicode(p))\n+        self.assertEqual([4, 5, 6], p.object_list)\n         self.assertTrue(p.has_next())\n-        self.assertFalse(p.has_previous())\n+        self.assertTrue(p.has_previous())\n         self.assertTrue(p.has_other_pages())\n-        self.assertEqual(2, p.next_page_number())\n-        self.assertEqual(0, p.previous_page_number())\n-        self.assertEqual(1, p.start_index())\n-        self.assertEqual(5, p.end_index())\n+        self.assertEqual(3, p.next_page_number())\n+        self.assertEqual(1, p.previous_page_number())\n+        self.assertEqual(4, p.start_index())\n+        self.assertEqual(6, p.end_index())\n \n     def test_paginate_misc_classes(self):\n         # Paginator can be passed other objects with a count() method."
        }
    ],
    "stats": {
        "total": 54,
        "additions": 35,
        "deletions": 19
    }
}