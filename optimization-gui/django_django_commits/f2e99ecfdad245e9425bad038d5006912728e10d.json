{
    "author": "ramiro",
    "message": "Made makemessages leave `'%%'` sequences untouched when extracting translatable literals from blocktrans template tags.\n\nThis makes it consistent with behavior introduced when fixing #11240 in\nprocessing of literal passed to the trans tag to avoid double escaping\n(i.e. `'%%%%'` sequences in resulting PO files.)\n\nAlso, cleaned up tests changes from r17190 (removed commented out code and\nimplemented compatibility with Python 2.5.)\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17192 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "f2e99ecfdad245e9425bad038d5006912728e10d",
    "files": [
        {
            "sha": "28d20127c8fcfc3b60679210a3064056570a1089",
            "filename": "django/utils/translation/trans_real.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/f2e99ecfdad245e9425bad038d5006912728e10d/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "raw_url": "https://github.com/django/django/raw/f2e99ecfdad245e9425bad038d5006912728e10d/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2Ftrans_real.py?ref=f2e99ecfdad245e9425bad038d5006912728e10d",
            "patch": "@@ -514,7 +514,7 @@ def templatize(src, origin=None):\n                 else:\n                     singular.append('%%(%s)s' % t.contents)\n             elif t.token_type == TOKEN_TEXT:\n-                contents = t.contents.replace('%', '%%')\n+                contents = one_percent_re.sub('%%', t.contents)\n                 if inplural:\n                     plural.append(contents)\n                 else:"
        },
        {
            "sha": "6566ef4808b145cc99ec58e5727994fd61690e5a",
            "filename": "tests/regressiontests/i18n/commands/extraction.py",
            "status": "modified",
            "additions": 3,
            "deletions": 12,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/f2e99ecfdad245e9425bad038d5006912728e10d/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fextraction.py",
            "raw_url": "https://github.com/django/django/raw/f2e99ecfdad245e9425bad038d5006912728e10d/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fextraction.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fcommands%2Fextraction.py?ref=f2e99ecfdad245e9425bad038d5006912728e10d",
            "patch": "@@ -1,4 +1,6 @@\n # -*- encoding: utf-8 -*-\n+from __future__ import with_statement\n+\n import os\n import re\n import shutil\n@@ -52,7 +54,6 @@ def test_comments_extractor(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertTrue('#. Translators: This comment should be extracted' in po_contents)\n@@ -81,7 +82,6 @@ def test_templatize_trans_tag(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertMsgId('Literal with a percent symbol at the end %%', po_contents)\n@@ -98,11 +98,11 @@ def test_templatize_blocktrans_tag(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertMsgId('I think that 100%% is more that 50%% of anything.', po_contents)\n             self.assertMsgId('I think that 100%% is more that 50%% of %(obj)s.', po_contents)\n+            self.assertMsgId(\"Blocktrans extraction shouldn't double escape this: %%, a=%(a)s\", po_contents)\n \n     def test_extraction_error(self):\n         os.chdir(self.test_dir)\n@@ -128,7 +128,6 @@ def test_template_message_context_extractor(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             # {% trans %}\n@@ -159,7 +158,6 @@ def test_javascript_literals(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', domain='djangojs', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertMsgId('This literal should be included.', po_contents)\n@@ -183,7 +181,6 @@ def test_ignore_option(self):\n         pattern1 = os.path.join('ignore_dir', '*')\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, ignore_patterns=[pattern1])\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertMsgId('This literal should be included.', po_contents)\n@@ -215,7 +212,6 @@ def test_symlink(self):\n             os.chdir(self.test_dir)\n             management.call_command('makemessages', locale=LOCALE, verbosity=0, symlinks=True)\n             self.assertTrue(os.path.exists(self.PO_FILE))\n-            #po_contents = open(self.PO_FILE, 'r').read()\n             with open(self.PO_FILE, 'r') as fp:\n                 po_contents = fp.read()\n                 self.assertMsgId('This literal should be included.', po_contents)\n@@ -228,7 +224,6 @@ def test_copy_plural_forms(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertTrue('Plural-Forms: nplurals=2; plural=(n != 1)' in po_contents)\n@@ -240,7 +235,6 @@ def test_no_wrap_enabled(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, no_wrap=True)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertMsgId('This literal should also be included wrapped or not wrapped depending on the use of the --no-wrap option.', po_contents)\n@@ -249,7 +243,6 @@ def test_no_wrap_disabled(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, no_wrap=False)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertMsgId('\"\"\\n\"This literal should also be included wrapped or not wrapped depending on the \"\\n\"use of the --no-wrap option.\"', po_contents, use_quotes=False)\n@@ -261,7 +254,6 @@ def test_no_location_enabled(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, no_location=True)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertFalse('#: templates/test.html:55' in po_contents)\n@@ -270,7 +262,6 @@ def test_no_location_disabled(self):\n         os.chdir(self.test_dir)\n         management.call_command('makemessages', locale=LOCALE, verbosity=0, no_location=False)\n         self.assertTrue(os.path.exists(self.PO_FILE))\n-        #po_contents = open(self.PO_FILE, 'r').read()\n         with open(self.PO_FILE, 'r') as fp:\n             po_contents = fp.read()\n             self.assertTrue('#: templates/test.html:55' in po_contents)"
        },
        {
            "sha": "57893469840bb91cba6368ef1624369394a2a98a",
            "filename": "tests/regressiontests/i18n/commands/templates/test.html",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/f2e99ecfdad245e9425bad038d5006912728e10d/tests%2Fregressiontests%2Fi18n%2Fcommands%2Ftemplates%2Ftest.html",
            "raw_url": "https://github.com/django/django/raw/f2e99ecfdad245e9425bad038d5006912728e10d/tests%2Fregressiontests%2Fi18n%2Fcommands%2Ftemplates%2Ftest.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fcommands%2Ftemplates%2Ftest.html?ref=f2e99ecfdad245e9425bad038d5006912728e10d",
            "patch": "@@ -67,6 +67,8 @@\n {% blocktrans context \"Special blocktrans context #3\" count 2 %}Translatable literal #8c-singular{% plural %}Translatable literal #8c-plural{% endblocktrans %}\n {% blocktrans with a=1 context \"Special blocktrans context #4\" %}Translatable literal #8d {{ a }}{% endblocktrans %}\n \n+{% blocktrans with a=1 %}Blocktrans extraction shouldn't double escape this: %%, a={{ a }}{% endblocktrans %}\n+\n {% trans \"Literal with a percent symbol at the end %\" %}\n {% trans \"Literal with a percent % symbol in the middle\" %}\n {% trans \"Completed 50% of all the tasks\" %}"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 6,
        "deletions": 13
    }
}