{
    "author": "jphalip",
    "message": "Fixed #19505 -- A more flexible implementation for customizable admin redirect urls.\n\nWork by Julien Phalip.\n\nRefs #8001, #18310, #19505. See also 0b908b92a2ca4fb74a103e96bb75c53c05d0a428.",
    "sha": "35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415",
    "files": [
        {
            "sha": "fa6d288f5848ebc06b5157b84671c27275586312",
            "filename": "django/contrib/admin/options.py",
            "status": "modified",
            "additions": 58,
            "deletions": 109,
            "changes": 167,
            "blob_url": "https://github.com/django/django/blob/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/django%2Fcontrib%2Fadmin%2Foptions.py",
            "raw_url": "https://github.com/django/django/raw/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/django%2Fcontrib%2Fadmin%2Foptions.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Foptions.py?ref=35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415",
            "patch": "@@ -9,7 +9,7 @@\n     inlineformset_factory, BaseInlineFormSet)\n from django.contrib.contenttypes.models import ContentType\n from django.contrib.admin import widgets, helpers\n-from django.contrib.admin.util import quote, unquote, flatten_fieldsets, get_deleted_objects, model_format_dict\n+from django.contrib.admin.util import unquote, flatten_fieldsets, get_deleted_objects, model_format_dict\n from django.contrib.admin.templatetags.admin_static import static\n from django.contrib import messages\n from django.views.decorators.csrf import csrf_protect\n@@ -38,6 +38,7 @@\n # returns the <ul> class for a given radio_admin field\n get_ul_class = lambda x: 'radiolist%s' % ((x == HORIZONTAL) and ' inline' or '')\n \n+\n class IncorrectLookupParameters(Exception):\n     pass\n \n@@ -62,6 +63,7 @@ class IncorrectLookupParameters(Exception):\n \n csrf_protect_m = method_decorator(csrf_protect)\n \n+\n class BaseModelAdmin(six.with_metaclass(forms.MediaDefiningClass)):\n     \"\"\"Functionality common to both ModelAdmin and InlineAdmin.\"\"\"\n \n@@ -150,7 +152,7 @@ def formfield_for_choice_field(self, db_field, request=None, **kwargs):\n                 })\n             if 'choices' not in kwargs:\n                 kwargs['choices'] = db_field.get_choices(\n-                    include_blank = db_field.blank,\n+                    include_blank=db_field.blank,\n                     blank_choice=[('', _('None'))]\n                 )\n         return db_field.formfield(**kwargs)\n@@ -787,49 +789,37 @@ def render_change_form(self, request, context, add=False, change=False, form_url\n             \"admin/change_form.html\"\n         ], context, current_app=self.admin_site.name)\n \n-    def response_add(self, request, obj, post_url_continue='../%s/',\n-                     continue_editing_url=None, add_another_url=None,\n-                     hasperm_url=None, noperm_url=None):\n+    def response_add(self, request, obj, post_url_continue=None):\n         \"\"\"\n         Determines the HttpResponse for the add_view stage.\n-\n-        :param request: HttpRequest instance.\n-        :param obj: Object just added.\n-        :param post_url_continue: Deprecated/undocumented.\n-        :param continue_editing_url: URL where user will be redirected after\n-                                     pressing 'Save and continue editing'.\n-        :param add_another_url: URL where user will be redirected after\n-                                pressing 'Save and add another'.\n-        :param hasperm_url: URL to redirect after a successful object creation\n-                            when the user has change permissions.\n-        :param noperm_url: URL to redirect after a successful object creation\n-                           when the user has no change permissions.\n-        \"\"\"\n-        if post_url_continue != '../%s/':\n-            warnings.warn(\"The undocumented 'post_url_continue' argument to \"\n-                          \"ModelAdmin.response_add() is deprecated, use the new \"\n-                          \"*_url arguments instead.\", DeprecationWarning,\n-                          stacklevel=2)\n+        \"\"\"\n         opts = obj._meta\n-        pk_value = obj.pk\n-        app_label = opts.app_label\n-        model_name = opts.module_name\n-        site_name = self.admin_site.name\n+        pk_value = obj._get_pk_val()\n \n         msg_dict = {'name': force_text(opts.verbose_name), 'obj': force_text(obj)}\n-\n         # Here, we distinguish between different save types by checking for\n         # the presence of keys in request.POST.\n         if \"_continue\" in request.POST:\n             msg = _('The %(name)s \"%(obj)s\" was added successfully. You may edit it again below.') % msg_dict\n             self.message_user(request, msg)\n-            if continue_editing_url is None:\n-                continue_editing_url = 'admin:%s_%s_change' % (app_label, model_name)\n-            url = reverse(continue_editing_url, args=(quote(pk_value),),\n-                          current_app=site_name)\n+            if post_url_continue is None:\n+                post_url_continue = reverse('admin:%s_%s_change' %\n+                                            (opts.app_label, opts.module_name),\n+                                            args=(pk_value,),\n+                                            current_app=self.admin_site.name)\n+            else:\n+                try:\n+                    post_url_continue = post_url_continue % pk_value\n+                    warnings.warn(\n+                        \"The use of string formats for post_url_continue \"\n+                        \"in ModelAdmin.response_add() is deprecated. Provide \"\n+                        \"a pre-formatted url instead.\",\n+                        DeprecationWarning, stacklevel=2)\n+                except TypeError:\n+                    pass\n             if \"_popup\" in request.POST:\n-                url += \"?_popup=1\"\n-            return HttpResponseRedirect(url)\n+                post_url_continue += \"?_popup=1\"\n+            return HttpResponseRedirect(post_url_continue)\n \n         if \"_popup\" in request.POST:\n             return HttpResponse(\n@@ -840,102 +830,61 @@ def response_add(self, request, obj, post_url_continue='../%s/',\n         elif \"_addanother\" in request.POST:\n             msg = _('The %(name)s \"%(obj)s\" was added successfully. You may add another %(name)s below.') % msg_dict\n             self.message_user(request, msg)\n-            if add_another_url is None:\n-                add_another_url = 'admin:%s_%s_add' % (app_label, model_name)\n-            url = reverse(add_another_url, current_app=site_name)\n-            return HttpResponseRedirect(url)\n+            return HttpResponseRedirect(request.path)\n         else:\n             msg = _('The %(name)s \"%(obj)s\" was added successfully.') % msg_dict\n             self.message_user(request, msg)\n+            return self.response_post_save(request, obj)\n \n-            # Figure out where to redirect. If the user has change permission,\n-            # redirect to the change-list page for this object. Otherwise,\n-            # redirect to the admin index.\n-            if self.has_change_permission(request, None):\n-                if hasperm_url is None:\n-                    hasperm_url = 'admin:%s_%s_changelist' % (app_label, model_name)\n-                url = reverse(hasperm_url, current_app=site_name)\n-            else:\n-                if noperm_url is None:\n-                    noperm_url = 'admin:index'\n-                url = reverse(noperm_url, current_app=site_name)\n-            return HttpResponseRedirect(url)\n-\n-    def response_change(self, request, obj, continue_editing_url=None,\n-                        save_as_new_url=None, add_another_url=None,\n-                        hasperm_url=None, noperm_url=None):\n+    def response_change(self, request, obj):\n         \"\"\"\n         Determines the HttpResponse for the change_view stage.\n-\n-        :param request: HttpRequest instance.\n-        :param obj: Object just modified.\n-        :param continue_editing_url: URL where user will be redirected after\n-                                     pressing 'Save and continue editing'.\n-        :param save_as_new_url: URL where user will be redirected after pressing\n-                                'Save as new' (when applicable).\n-        :param add_another_url: URL where user will be redirected after pressing\n-                                'Save and add another'.\n-        :param hasperm_url: URL to redirect after a successful object edition when\n-                            the user has change permissions.\n-        :param noperm_url: URL to redirect after a successful object edition when\n-                           the user has no change permissions.\n         \"\"\"\n-        opts = obj._meta\n+        opts = self.model._meta\n \n-        app_label = opts.app_label\n-        model_name = opts.module_name\n-        site_name = self.admin_site.name\n-        verbose_name = opts.verbose_name\n-        # Handle proxy models automatically created by .only() or .defer().\n-        # Refs #14529\n-        if obj._deferred:\n-            opts_ = opts.proxy_for_model._meta\n-            verbose_name = opts_.verbose_name\n-            model_name = opts_.module_name\n-\n-        msg_dict = {'name': force_text(verbose_name), 'obj': force_text(obj)}\n+        pk_value = obj._get_pk_val()\n \n+        msg_dict = {'name': force_text(opts.verbose_name), 'obj': force_text(obj)}\n         if \"_continue\" in request.POST:\n             msg = _('The %(name)s \"%(obj)s\" was changed successfully. You may edit it again below.') % msg_dict\n             self.message_user(request, msg)\n-            if continue_editing_url is None:\n-                continue_editing_url = 'admin:%s_%s_change' % (app_label, model_name)\n-            url = reverse(continue_editing_url, args=(quote(obj.pk),),\n-                          current_app=site_name)\n-            if \"_popup\" in request.POST:\n-                url += \"?_popup=1\"\n-            return HttpResponseRedirect(url)\n+            if \"_popup\" in request.REQUEST:\n+                return HttpResponseRedirect(request.path + \"?_popup=1\")\n+            else:\n+                return HttpResponseRedirect(request.path)\n         elif \"_saveasnew\" in request.POST:\n             msg = _('The %(name)s \"%(obj)s\" was added successfully. You may edit it again below.') % msg_dict\n             self.message_user(request, msg)\n-            if save_as_new_url is None:\n-                save_as_new_url = 'admin:%s_%s_change' % (app_label, model_name)\n-            url = reverse(save_as_new_url, args=(quote(obj.pk),),\n-                          current_app=site_name)\n-            return HttpResponseRedirect(url)\n+            return HttpResponseRedirect(reverse('admin:%s_%s_change' %\n+                                        (opts.app_label, opts.module_name),\n+                                        args=(pk_value,),\n+                                        current_app=self.admin_site.name))\n         elif \"_addanother\" in request.POST:\n             msg = _('The %(name)s \"%(obj)s\" was changed successfully. You may add another %(name)s below.') % msg_dict\n             self.message_user(request, msg)\n-            if add_another_url is None:\n-                add_another_url = 'admin:%s_%s_add' % (app_label, model_name)\n-            url = reverse(add_another_url, current_app=site_name)\n-            return HttpResponseRedirect(url)\n+            return HttpResponseRedirect(reverse('admin:%s_%s_add' %\n+                                        (opts.app_label, opts.module_name),\n+                                        current_app=self.admin_site.name))\n         else:\n             msg = _('The %(name)s \"%(obj)s\" was changed successfully.') % msg_dict\n             self.message_user(request, msg)\n-            # Figure out where to redirect. If the user has change permission,\n-            # redirect to the change-list page for this object. Otherwise,\n-            # redirect to the admin index.\n-            if self.has_change_permission(request, None):\n-                if hasperm_url is None:\n-                    hasperm_url = 'admin:%s_%s_changelist' % (app_label,\n-                                                              model_name)\n-                url = reverse(hasperm_url, current_app=site_name)\n-            else:\n-                if noperm_url is None:\n-                    noperm_url = 'admin:index'\n-                url = reverse(noperm_url, current_app=site_name)\n-            return HttpResponseRedirect(url)\n+            return self.response_post_save(request, obj)\n+\n+    def response_post_save(self, request, obj):\n+        \"\"\"\n+        Figure out where to redirect after the 'Save' button has been pressed.\n+        If the user has change permission, redirect to the change-list page for\n+        this object. Otherwise, redirect to the admin index.\n+        \"\"\"\n+        opts = self.model._meta\n+        if self.has_change_permission(request, None):\n+            post_url = reverse('admin:%s_%s_changelist' %\n+                               (opts.app_label, opts.module_name),\n+                               current_app=self.admin_site.name)\n+        else:\n+            post_url = reverse('admin:index',\n+                               current_app=self.admin_site.name)\n+        return HttpResponseRedirect(post_url)\n \n     def response_action(self, request, queryset):\n         \"\"\""
        },
        {
            "sha": "7b816674d34c1f95cd867d939d247f6a14a09113",
            "filename": "django/contrib/auth/admin.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/django%2Fcontrib%2Fauth%2Fadmin.py",
            "raw_url": "https://github.com/django/django/raw/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/django%2Fcontrib%2Fauth%2Fadmin.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fadmin.py?ref=35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415",
            "patch": "@@ -153,7 +153,7 @@ def user_change_password(self, request, id, form_url=''):\n             'admin/auth/user/change_password.html',\n             context, current_app=self.admin_site.name)\n \n-    def response_add(self, request, obj, **kwargs):\n+    def response_add(self, request, obj, post_url_continue=None):\n         \"\"\"\n         Determines the HttpResponse for the add_view stage. It mostly defers to\n         its superclass implementation but is customized because the User model\n@@ -166,7 +166,8 @@ def response_add(self, request, obj, **kwargs):\n         # * We are adding a user in a popup\n         if '_addanother' not in request.POST and '_popup' not in request.POST:\n             request.POST['_continue'] = 1\n-        return super(UserAdmin, self).response_add(request, obj, **kwargs)\n+        return super(UserAdmin, self).response_add(request, obj,\n+                                                   post_url_continue)\n \n admin.site.register(Group, GroupAdmin)\n admin.site.register(User, UserAdmin)"
        },
        {
            "sha": "386dfc0b00c299ded751a1c1a7ad3e0bc723a49b",
            "filename": "docs/internals/deprecation.txt",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/docs%2Finternals%2Fdeprecation.txt",
            "raw_url": "https://github.com/django/django/raw/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/docs%2Finternals%2Fdeprecation.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Finternals%2Fdeprecation.txt?ref=35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415",
            "patch": "@@ -268,6 +268,12 @@ these changes.\n * ``django.contrib.markup`` will be removed following an accelerated\n   deprecation.\n \n+* The value for the ``post_url_continue`` parameter in\n+  ``ModelAdmin.response_add()`` will have to be either ``None`` (to redirect\n+  to the newly created object's edit page) or a pre-formatted url. String\n+  formats, such as the previous default ``'../%s/'``, will not be accepted any\n+  more.\n+\n 1.7\n ---\n "
        },
        {
            "sha": "cc8e730c26ff2b58bb1eeb536f1916ef719cadbb",
            "filename": "tests/regressiontests/admin_custom_urls/models.py",
            "status": "modified",
            "additions": 25,
            "deletions": 26,
            "changes": 51,
            "blob_url": "https://github.com/django/django/blob/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/tests%2Fregressiontests%2Fadmin_custom_urls%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/tests%2Fregressiontests%2Fadmin_custom_urls%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_custom_urls%2Fmodels.py?ref=35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415",
            "patch": "@@ -1,7 +1,9 @@\n from functools import update_wrapper\n \n from django.contrib import admin\n+from django.core.urlresolvers import reverse\n from django.db import models\n+from django.http import HttpResponseRedirect\n from django.utils.encoding import python_2_unicode_compatible\n \n \n@@ -49,41 +51,38 @@ def wrapper(*args, **kwargs):\n         ) + self.remove_url(view_name)\n \n \n-admin.site.register(Action, ActionAdmin)\n+class Person(models.Model):\n+    name = models.CharField(max_length=20)\n \n+class PersonAdmin(admin.ModelAdmin):\n \n-class Person(models.Model):\n-    nick = models.CharField(max_length=20)\n+    def response_post_save(self, request, obj):\n+        return HttpResponseRedirect(\n+            reverse('admin:admin_custom_urls_person_history', args=[obj.pk]))\n \n \n-class PersonAdmin(admin.ModelAdmin):\n-    \"\"\"A custom ModelAdmin that customizes the deprecated post_url_continue\n-    argument to response_add()\"\"\"\n-    def response_add(self, request, obj, post_url_continue='../%s/continue/',\n-                     continue_url=None, add_url=None, hasperm_url=None,\n-                     noperm_url=None):\n-        return super(PersonAdmin, self).response_add(request, obj,\n-                                                     post_url_continue,\n-                                                     continue_url, add_url,\n-                                                     hasperm_url, noperm_url)\n+class Car(models.Model):\n+    name = models.CharField(max_length=20)\n \n+class CarAdmin(admin.ModelAdmin):\n \n-admin.site.register(Person, PersonAdmin)\n+    def response_add(self, request, obj, post_url_continue=None):\n+        return super(CarAdmin, self).response_add(\n+            request, obj, post_url_continue=reverse('admin:admin_custom_urls_car_history', args=[obj.pk]))\n \n \n-class City(models.Model):\n+class CarDeprecated(models.Model):\n+    \"\"\" This class must be removed in Django 1.6 \"\"\"\n     name = models.CharField(max_length=20)\n \n-\n-class CityAdmin(admin.ModelAdmin):\n-    \"\"\"A custom ModelAdmin that redirects to the changelist when the user\n-    presses the 'Save and add another' button when adding a model instance.\"\"\"\n-    def response_add(self, request, obj,\n-                     add_another_url='admin:admin_custom_urls_city_changelist',\n-                     **kwargs):\n-        return super(CityAdmin, self).response_add(request, obj,\n-                                                   add_another_url=add_another_url,\n-                                                   **kwargs)\n+class CarDeprecatedAdmin(admin.ModelAdmin):\n+    \"\"\" This class must be removed in Django 1.6 \"\"\"\n+    def response_add(self, request, obj, post_url_continue=None):\n+        return super(CarDeprecatedAdmin, self).response_add(\n+            request, obj, post_url_continue='../%s/history/')\n \n \n-admin.site.register(City, CityAdmin)\n+admin.site.register(Action, ActionAdmin)\n+admin.site.register(Person, PersonAdmin)\n+admin.site.register(Car, CarAdmin)\n+admin.site.register(CarDeprecated, CarDeprecatedAdmin)\n\\ No newline at end of file"
        },
        {
            "sha": "d691a9755738dc7c5a2dcb7a4b9eab0edb825b06",
            "filename": "tests/regressiontests/admin_custom_urls/tests.py",
            "status": "modified",
            "additions": 48,
            "deletions": 33,
            "changes": 81,
            "blob_url": "https://github.com/django/django/blob/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/tests%2Fregressiontests%2Fadmin_custom_urls%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415/tests%2Fregressiontests%2Fadmin_custom_urls%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_custom_urls%2Ftests.py?ref=35d1cd0b28d1d9cd7bffbfbc6cc2e02b58404415",
            "patch": "@@ -1,5 +1,4 @@\n from __future__ import absolute_import, unicode_literals\n-\n import warnings\n \n from django.contrib.admin.util import quote\n@@ -8,7 +7,7 @@\n from django.test import TestCase\n from django.test.utils import override_settings\n \n-from .models import Action, Person, City\n+from .models import Action, Person, Car, CarDeprecated\n \n \n @override_settings(PASSWORD_HASHERS=('django.contrib.auth.hashers.SHA1PasswordHasher',))\n@@ -86,42 +85,58 @@ def testAdminUrlsNoClash(self):\n \n \n @override_settings(PASSWORD_HASHERS=('django.contrib.auth.hashers.SHA1PasswordHasher',))\n-class CustomUrlsWorkflowTests(TestCase):\n-    fixtures = ['users.json']\n+class CustomRedirects(TestCase):\n+    fixtures = ['users.json', 'actions.json']\n \n     def setUp(self):\n         self.client.login(username='super', password='secret')\n \n     def tearDown(self):\n         self.client.logout()\n \n-    def test_old_argument_deprecation(self):\n-        \"\"\"Test reporting of post_url_continue deprecation.\"\"\"\n-        post_data = {\n-            'nick': 'johndoe',\n-        }\n-        cnt = Person.objects.count()\n-        with warnings.catch_warnings(record=True) as w:\n-            warnings.simplefilter(\"always\")\n-            response = self.client.post(reverse('admin:admin_custom_urls_person_add'), post_data)\n-            self.assertEqual(response.status_code, 302)\n-            self.assertEqual(Person.objects.count(), cnt + 1)\n-            # We should get a DeprecationWarning\n-            self.assertEqual(len(w), 1)\n-            self.assertTrue(isinstance(w[0].message, DeprecationWarning))\n-\n-    def test_custom_add_another_redirect(self):\n-        \"\"\"Test customizability of post-object-creation redirect URL.\"\"\"\n-        post_data = {\n-            'name': 'Rome',\n-            '_addanother': '1',\n-        }\n-        cnt = City.objects.count()\n+    def test_post_save_redirect(self):\n+        \"\"\"\n+        Ensures that ModelAdmin.response_post_save() controls the redirection\n+        after the 'Save' button has been pressed.\n+        Refs 8001, 18310, 19505.\n+        \"\"\"\n+        post_data = { 'name': 'John Doe', }\n+        self.assertEqual(Person.objects.count(), 0)\n+        response = self.client.post(\n+            reverse('admin:admin_custom_urls_person_add'), post_data)\n+        persons = Person.objects.all()\n+        self.assertEqual(len(persons), 1)\n+        self.assertRedirects(\n+            response, reverse('admin:admin_custom_urls_person_history', args=[persons[0].pk]))\n+\n+    def test_post_url_continue(self):\n+        \"\"\"\n+        Ensures that the ModelAdmin.response_add()'s parameter `post_url_continue`\n+        controls the redirection after an object has been created.\n+        \"\"\"\n+        post_data = { 'name': 'SuperFast', '_continue': '1' }\n+        self.assertEqual(Car.objects.count(), 0)\n+        response = self.client.post(\n+            reverse('admin:admin_custom_urls_car_add'), post_data)\n+        cars = Car.objects.all()\n+        self.assertEqual(len(cars), 1)\n+        self.assertRedirects(\n+            response, reverse('admin:admin_custom_urls_car_history', args=[cars[0].pk]))\n+\n+    def test_post_url_continue_string_formats(self):\n+        \"\"\"\n+        Ensures that string formats are accepted for post_url_continue. This\n+        is a deprecated functionality that will be removed in Django 1.6 along\n+        with this test.\n+        \"\"\"\n         with warnings.catch_warnings(record=True) as w:\n-            # POST to the view whose post-object-creation redir URL argument we\n-            # are customizing (object creation)\n-            response = self.client.post(reverse('admin:admin_custom_urls_city_add'), post_data)\n-            self.assertEqual(City.objects.count(), cnt + 1)\n-            # Check that it redirected to the URL we set\n-            self.assertRedirects(response, reverse('admin:admin_custom_urls_city_changelist'))\n-            self.assertEqual(len(w), 0) # We should get no DeprecationWarning\n+            post_data = { 'name': 'SuperFast', '_continue': '1' }\n+            self.assertEqual(Car.objects.count(), 0)\n+            response = self.client.post(\n+                reverse('admin:admin_custom_urls_cardeprecated_add'), post_data)\n+            cars = CarDeprecated.objects.all()\n+            self.assertEqual(len(cars), 1)\n+            self.assertRedirects(\n+                response, reverse('admin:admin_custom_urls_cardeprecated_history', args=[cars[0].pk]))\n+        self.assertEqual(len(w), 1)\n+        self.assertTrue(isinstance(w[0].message, DeprecationWarning))\n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 310,
        "additions": 140,
        "deletions": 170
    }
}