{
    "author": "claudep",
    "message": "Replaced 'next' testing by collections.Iterator testing.\n\nThe new construct is also Python 3 compatible (where 'next' has\nbeen renamed to '__next__').",
    "sha": "df7a65ac4ba36dd155e80b8bcfe607390976ad47",
    "files": [
        {
            "sha": "50976db3392813f5cf854afdc35525c7b6bcf8a7",
            "filename": "django/db/models/fields/__init__.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/df7a65ac4ba36dd155e80b8bcfe607390976ad47/django%2Fdb%2Fmodels%2Ffields%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/df7a65ac4ba36dd155e80b8bcfe607390976ad47/django%2Fdb%2Fmodels%2Ffields%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Ffields%2F__init__.py?ref=df7a65ac4ba36dd155e80b8bcfe607390976ad47",
            "patch": "@@ -1,3 +1,4 @@\n+import collections\n import copy\n import datetime\n import decimal\n@@ -436,7 +437,7 @@ def bind(self, fieldmapping, original, bound_field_class):\n         return bound_field_class(self, fieldmapping, original)\n \n     def _get_choices(self):\n-        if hasattr(self._choices, 'next'):\n+        if isinstance(self._choices, collections.Iterator):\n             choices, self._choices = tee(self._choices)\n             return choices\n         else:"
        },
        {
            "sha": "5515bc4f839009f73628efeb5351b835d0bf3fc9",
            "filename": "django/db/models/sql/where.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/df7a65ac4ba36dd155e80b8bcfe607390976ad47/django%2Fdb%2Fmodels%2Fsql%2Fwhere.py",
            "raw_url": "https://github.com/django/django/raw/df7a65ac4ba36dd155e80b8bcfe607390976ad47/django%2Fdb%2Fmodels%2Fsql%2Fwhere.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fsql%2Fwhere.py?ref=df7a65ac4ba36dd155e80b8bcfe607390976ad47",
            "patch": "@@ -4,6 +4,7 @@\n \n from __future__ import absolute_import\n \n+import collections\n import datetime\n from itertools import repeat\n \n@@ -49,7 +50,7 @@ def add(self, data, connector):\n             return\n \n         obj, lookup_type, value = data\n-        if hasattr(value, '__iter__') and hasattr(value, 'next'):\n+        if isinstance(value, collections.Iterator):\n             # Consume any generators immediately, so that we can determine\n             # emptiness and transform any non-empty values correctly.\n             value = list(value)"
        }
    ],
    "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
    }
}