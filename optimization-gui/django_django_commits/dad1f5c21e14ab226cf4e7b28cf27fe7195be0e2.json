{
    "author": "ubernostrum",
    "message": "Fixed #17605: Restored deleted query documentation that used to live in doctests. Thanks zsiciarz for work on the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17737 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2",
    "files": [
        {
            "sha": "321e539e4a371293ebf0509440fff65b10efa4c7",
            "filename": "docs/topics/db/examples/index.txt",
            "status": "added",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fexamples%2Findex.txt",
            "raw_url": "https://github.com/django/django/raw/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fexamples%2Findex.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fdb%2Fexamples%2Findex.txt?ref=dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2",
            "patch": "@@ -0,0 +1,10 @@\n+========================================\n+Examples of model relationship API usage\n+========================================\n+\n+.. toctree::\n+   :maxdepth: 1\n+\n+   many_to_many\n+   many_to_one\n+   one_to_one"
        },
        {
            "sha": "1ad89e71bf891e01e11d3012118714f66f64f1c0",
            "filename": "docs/topics/db/examples/many_to_many.txt",
            "status": "added",
            "additions": 289,
            "deletions": 0,
            "changes": 289,
            "blob_url": "https://github.com/django/django/blob/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fexamples%2Fmany_to_many.txt",
            "raw_url": "https://github.com/django/django/raw/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fexamples%2Fmany_to_many.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fdb%2Fexamples%2Fmany_to_many.txt?ref=dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2",
            "patch": "@@ -0,0 +1,289 @@\n+##########################\n+Many-to-many relationships\n+##########################\n+\n+.. highlight:: pycon\n+\n+To define a many-to-many relationship, use :ref:`ref-manytomany`.\n+\n+In this example, an ``Article`` can be published in multiple ``Publication``\n+objects, and a ``Publication`` has multiple ``Article`` objects:\n+\n+.. code-block:: python\n+\n+    from django.db import models\n+\n+    class Publication(models.Model):\n+        title = models.CharField(max_length=30)\n+\n+        def __unicode__(self):\n+            return self.title\n+\n+        class Meta:\n+            ordering = ('title',)\n+\n+    class Article(models.Model):\n+        headline = models.CharField(max_length=100)\n+        publications = models.ManyToManyField(Publication)\n+\n+        def __unicode__(self):\n+            return self.headline\n+\n+        class Meta:\n+            ordering = ('headline',)\n+\n+What follows are examples of operations that can be performed using the Python\n+API facilities.\n+\n+Create a couple of Publications::\n+\n+    >>> p1 = Publication(title='The Python Journal')\n+    >>> p1.save()\n+    >>> p2 = Publication(title='Science News')\n+    >>> p2.save()\n+    >>> p3 = Publication(title='Science Weekly')\n+    >>> p3.save()\n+\n+Create an Article::\n+\n+    >>> a1 = Article(headline='Django lets you build Web apps easily')\n+\n+You can't associate it with a Publication until it's been saved::\n+\n+    >>> a1.publications.add(p1)\n+    Traceback (most recent call last):\n+    ...\n+    ValueError: 'Article' instance needs to have a primary key value before a many-to-many relationship can be used.\n+\n+Save it!\n+::\n+\n+    >>> a1.save()\n+\n+Associate the Article with a Publication::\n+\n+    >>> a1.publications.add(p1)\n+\n+Create another Article, and set it to appear in both Publications::\n+\n+    >>> a2 = Article(headline='NASA uses Python')\n+    >>> a2.save()\n+    >>> a2.publications.add(p1, p2)\n+    >>> a2.publications.add(p3)\n+\n+Adding a second time is OK::\n+\n+    >>> a2.publications.add(p3)\n+\n+Adding an object of the wrong type raises TypeError::\n+\n+    >>> a2.publications.add(a1)\n+    Traceback (most recent call last):\n+    ...\n+    TypeError: 'Publication' instance expected\n+\n+Add a Publication directly via publications.add by using keyword arguments::\n+\n+    >>> new_publication = a2.publications.create(title='Highlights for Children')\n+\n+Article objects have access to their related Publication objects::\n+\n+    >>> a1.publications.all()\n+    [<Publication: The Python Journal>]\n+    >>> a2.publications.all()\n+    [<Publication: Highlights for Children>, <Publication: Science News>, <Publication: Science Weekly>, <Publication: The Python Journal>]\n+\n+Publication objects have access to their related Article objects::\n+\n+    >>> p2.article_set.all()\n+    [<Article: NASA uses Python>]\n+    >>> p1.article_set.all()\n+    [<Article: Django lets you build Web apps easily>, <Article: NASA uses Python>]\n+    >>> Publication.objects.get(id=4).article_set.all()\n+    [<Article: NASA uses Python>]\n+\n+Many-to-many relationships can be queried using :ref:`lookups across relationships <lookups-that-span-relationships>`::\n+\n+    >>> Article.objects.filter(publications__id__exact=1)\n+    [<Article: Django lets you build Web apps easily>, <Article: NASA uses Python>]\n+    >>> Article.objects.filter(publications__pk=1)\n+    [<Article: Django lets you build Web apps easily>, <Article: NASA uses Python>]\n+    >>> Article.objects.filter(publications=1)\n+    [<Article: Django lets you build Web apps easily>, <Article: NASA uses Python>]\n+    >>> Article.objects.filter(publications=p1)\n+    [<Article: Django lets you build Web apps easily>, <Article: NASA uses Python>]\n+\n+    >>> Article.objects.filter(publications__title__startswith=\"Science\")\n+    [<Article: NASA uses Python>, <Article: NASA uses Python>]\n+\n+    >>> Article.objects.filter(publications__title__startswith=\"Science\").distinct()\n+    [<Article: NASA uses Python>]\n+\n+The count() function respects distinct() as well::\n+\n+    >>> Article.objects.filter(publications__title__startswith=\"Science\").count()\n+    2\n+\n+    >>> Article.objects.filter(publications__title__startswith=\"Science\").distinct().count()\n+    1\n+\n+    >>> Article.objects.filter(publications__in=[1,2]).distinct()\n+    [<Article: Django lets you build Web apps easily>, <Article: NASA uses Python>]\n+    >>> Article.objects.filter(publications__in=[p1,p2]).distinct()\n+    [<Article: Django lets you build Web apps easily>, <Article: NASA uses Python>]\n+\n+Reverse m2m queries are supported (i.e., starting at the table that doesn't have\n+a ManyToManyField)::\n+\n+    >>> Publication.objects.filter(id__exact=1)\n+    [<Publication: The Python Journal>]\n+    >>> Publication.objects.filter(pk=1)\n+    [<Publication: The Python Journal>]\n+\n+    >>> Publication.objects.filter(article__headline__startswith=\"NASA\")\n+    [<Publication: Highlights for Children>, <Publication: Science News>, <Publication: Science Weekly>, <Publication: The Python Journal>]\n+\n+    >>> Publication.objects.filter(article__id__exact=1)\n+    [<Publication: The Python Journal>]\n+    >>> Publication.objects.filter(article__pk=1)\n+    [<Publication: The Python Journal>]\n+    >>> Publication.objects.filter(article=1)\n+    [<Publication: The Python Journal>]\n+    >>> Publication.objects.filter(article=a1)\n+    [<Publication: The Python Journal>]\n+\n+    >>> Publication.objects.filter(article__in=[1,2]).distinct()\n+    [<Publication: Highlights for Children>, <Publication: Science News>, <Publication: Science Weekly>, <Publication: The Python Journal>]\n+    >>> Publication.objects.filter(article__in=[a1,a2]).distinct()\n+    [<Publication: Highlights for Children>, <Publication: Science News>, <Publication: Science Weekly>, <Publication: The Python Journal>]\n+\n+Excluding a related item works as you would expect, too (although the SQL\n+involved is a little complex)::\n+\n+    >>> Article.objects.exclude(publications=p2)\n+    [<Article: Django lets you build Web apps easily>]\n+\n+If we delete a Publication, its Articles won't be able to access it::\n+\n+    >>> p1.delete()\n+    >>> Publication.objects.all()\n+    [<Publication: Highlights for Children>, <Publication: Science News>, <Publication: Science Weekly>]\n+    >>> a1 = Article.objects.get(pk=1)\n+    >>> a1.publications.all()\n+    []\n+\n+If we delete an Article, its Publications won't be able to access it::\n+\n+    >>> a2.delete()\n+    >>> Article.objects.all()\n+    [<Article: Django lets you build Web apps easily>]\n+    >>> p2.article_set.all()\n+    []\n+\n+Adding via the 'other' end of an m2m::\n+\n+    >>> a4 = Article(headline='NASA finds intelligent life on Earth')\n+    >>> a4.save()\n+    >>> p2.article_set.add(a4)\n+    >>> p2.article_set.all()\n+    [<Article: NASA finds intelligent life on Earth>]\n+    >>> a4.publications.all()\n+    [<Publication: Science News>]\n+\n+Adding via the other end using keywords::\n+\n+    >>> new_article = p2.article_set.create(headline='Oxygen-free diet works wonders')\n+    >>> p2.article_set.all()\n+    [<Article: NASA finds intelligent life on Earth>, <Article: Oxygen-free diet works wonders>]\n+    >>> a5 = p2.article_set.all()[1]\n+    >>> a5.publications.all()\n+    [<Publication: Science News>]\n+\n+Removing publication from an article::\n+\n+    >>> a4.publications.remove(p2)\n+    >>> p2.article_set.all()\n+    [<Article: Oxygen-free diet works wonders>]\n+    >>> a4.publications.all()\n+    []\n+\n+And from the other end::\n+\n+    >>> p2.article_set.remove(a5)\n+    >>> p2.article_set.all()\n+    []\n+    >>> a5.publications.all()\n+    []\n+\n+Relation sets can be assigned. Assignment clears any existing set members::\n+\n+    >>> a4.publications.all()\n+    [<Publication: Science News>]\n+    >>> a4.publications = [p3]\n+    >>> a4.publications.all()\n+    [<Publication: Science Weekly>]\n+\n+Relation sets can be cleared::\n+\n+    >>> p2.article_set.clear()\n+    >>> p2.article_set.all()\n+    []\n+\n+And you can clear from the other end::\n+\n+    >>> p2.article_set.add(a4, a5)\n+    >>> p2.article_set.all()\n+    [<Article: NASA finds intelligent life on Earth>, <Article: Oxygen-free diet works wonders>]\n+    >>> a4.publications.all()\n+    [<Publication: Science News>, <Publication: Science Weekly>]\n+    >>> a4.publications.clear()\n+    >>> a4.publications.all()\n+    []\n+    >>> p2.article_set.all()\n+    [<Article: Oxygen-free diet works wonders>]\n+\n+Recreate the article and Publication we have deleted::\n+\n+    >>> p1 = Publication(title='The Python Journal')\n+    >>> p1.save()\n+    >>> a2 = Article(headline='NASA uses Python')\n+    >>> a2.save()\n+    >>> a2.publications.add(p1, p2, p3)\n+\n+Bulk delete some Publications - references to deleted publications should go::\n+\n+    >>> Publication.objects.filter(title__startswith='Science').delete()\n+    >>> Publication.objects.all()\n+    [<Publication: Highlights for Children>, <Publication: The Python Journal>]\n+    >>> Article.objects.all()\n+    [<Article: Django lets you build Web apps easily>, <Article: NASA finds intelligent life on Earth>, <Article: NASA uses Python>, <Article: Oxygen-free diet works wonders>]\n+    >>> a2.publications.all()\n+    [<Publication: The Python Journal>]\n+\n+Bulk delete some articles - references to deleted objects should go::\n+\n+    >>> q = Article.objects.filter(headline__startswith='Django')\n+    >>> print q\n+    [<Article: Django lets you build Web apps easily>]\n+    >>> q.delete()\n+\n+After the delete, the QuerySet cache needs to be cleared, and the referenced\n+objects should be gone::\n+\n+    >>> print q\n+    []\n+    >>> p1.article_set.all()\n+    [<Article: NASA uses Python>]\n+\n+An alternate to calling clear() is to assign the empty set::\n+\n+    >>> p1.article_set = []\n+    >>> p1.article_set.all()\n+    []\n+\n+    >>> a2.publications = [p1, new_publication]\n+    >>> a2.publications.all()\n+    [<Publication: Highlights for Children>, <Publication: The Python Journal>]\n+    >>> a2.publications = []\n+    >>> a2.publications.all()\n+    []"
        },
        {
            "sha": "0a9978b8d1f8bd0625b32b4ece5708e9d137b562",
            "filename": "docs/topics/db/examples/many_to_one.txt",
            "status": "added",
            "additions": 208,
            "deletions": 0,
            "changes": 208,
            "blob_url": "https://github.com/django/django/blob/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fexamples%2Fmany_to_one.txt",
            "raw_url": "https://github.com/django/django/raw/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fexamples%2Fmany_to_one.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fdb%2Fexamples%2Fmany_to_one.txt?ref=dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2",
            "patch": "@@ -0,0 +1,208 @@\n+#########################\n+Many-to-one relationships\n+#########################\n+\n+.. highlight:: pycon\n+\n+To define a many-to-one relationship, use :class:`~django.db.models.ForeignKey`.\n+\n+.. code-block:: python\n+\n+    from django.db import models\n+\n+    class Reporter(models.Model):\n+        first_name = models.CharField(max_length=30)\n+        last_name = models.CharField(max_length=30)\n+        email = models.EmailField()\n+\n+        def __unicode__(self):\n+            return u\"%s %s\" % (self.first_name, self.last_name)\n+\n+    class Article(models.Model):\n+        headline = models.CharField(max_length=100)\n+        pub_date = models.DateField()\n+        reporter = models.ForeignKey(Reporter)\n+\n+        def __unicode__(self):\n+            return self.headline\n+\n+        class Meta:\n+            ordering = ('headline',)\n+\n+What follows are examples of operations that can be performed using the Python\n+API facilities.\n+\n+Create a few Reporters::\n+\n+    >>> r = Reporter(first_name='John', last_name='Smith', email='john@example.com')\n+    >>> r.save()\n+\n+    >>> r2 = Reporter(first_name='Paul', last_name='Jones', email='paul@example.com')\n+    >>> r2.save()\n+\n+Create an Article::\n+\n+    >>> from datetime import datetime\n+    >>> a = Article(id=None, headline=\"This is a test\", pub_date=datetime(2005, 7, 27), reporter=r)\n+    >>> a.save()\n+\n+    >>> a.reporter.id\n+    1\n+\n+    >>> a.reporter\n+    <Reporter: John Smith>\n+\n+Article objects have access to their related Reporter objects::\n+\n+    >>> r = a.reporter\n+\n+These are strings instead of unicode strings because that's what was used in\n+the creation of this reporter (and we haven't refreshed the data from the\n+database, which always returns unicode strings)::\n+\n+    >>> r.first_name, r.last_name\n+    ('John', 'Smith')\n+\n+Create an Article via the Reporter object::\n+\n+    >>> new_article = r.article_set.create(headline=\"John's second story\", pub_date=datetime(2005, 7, 29))\n+    >>> new_article\n+    <Article: John's second story>\n+    >>> new_article.reporter\n+    <Reporter: John Smith>\n+    >>> new_article.reporter.id\n+    1\n+\n+Create a new article, and add it to the article set::\n+\n+    >>> new_article2 = Article(headline=\"Paul's story\", pub_date=datetime(2006, 1, 17))\n+    >>> r.article_set.add(new_article2)\n+    >>> new_article2.reporter\n+    <Reporter: John Smith>\n+    >>> new_article2.reporter.id\n+    1\n+    >>> r.article_set.all()\n+    [<Article: John's second story>, <Article: Paul's story>, <Article: This is a test>]\n+\n+Add the same article to a different article set - check that it moves::\n+\n+    >>> r2.article_set.add(new_article2)\n+    >>> new_article2.reporter.id\n+    2\n+    >>> new_article2.reporter\n+    <Reporter: Paul Jones>\n+\n+Adding an object of the wrong type raises TypeError::\n+\n+    >>> r.article_set.add(r2)\n+    Traceback (most recent call last):\n+    ...\n+    TypeError: 'Article' instance expected\n+\n+    >>> r.article_set.all()\n+    [<Article: John's second story>, <Article: This is a test>]\n+    >>> r2.article_set.all()\n+    [<Article: Paul's story>]\n+\n+    >>> r.article_set.count()\n+    2\n+\n+    >>> r2.article_set.count()\n+    1\n+\n+Note that in the last example the article has moved from John to Paul.\n+\n+Related managers support field lookups as well.\n+The API automatically follows relationships as far as you need.\n+Use double underscores to separate relationships.\n+This works as many levels deep as you want. There's no limit. For example::\n+\n+    >>> r.article_set.filter(headline__startswith='This')\n+    [<Article: This is a test>]\n+\n+    # Find all Articles for any Reporter whose first name is \"John\".\n+    >>> Article.objects.filter(reporter__first_name__exact='John')\n+    [<Article: John's second story>, <Article: This is a test>]\n+\n+Exact match is implied here::\n+\n+    >>> Article.objects.filter(reporter__first_name='John')\n+    [<Article: John's second story>, <Article: This is a test>]\n+\n+Query twice over the related field. This translates to an AND condition in the\n+WHERE clause::\n+\n+    >>> Article.objects.filter(reporter__first_name__exact='John', reporter__last_name__exact='Smith')\n+    [<Article: John's second story>, <Article: This is a test>]\n+\n+For the related lookup you can supply a primary key value or pass the related\n+object explicitly::\n+\n+    >>> Article.objects.filter(reporter__pk=1)\n+    [<Article: John's second story>, <Article: This is a test>]\n+    >>> Article.objects.filter(reporter=1)\n+    [<Article: John's second story>, <Article: This is a test>]\n+    >>> Article.objects.filter(reporter=r)\n+    [<Article: John's second story>, <Article: This is a test>]\n+\n+    >>> Article.objects.filter(reporter__in=[1,2]).distinct()\n+    [<Article: John's second story>, <Article: Paul's story>, <Article: This is a test>]\n+    >>> Article.objects.filter(reporter__in=[r,r2]).distinct()\n+    [<Article: John's second story>, <Article: Paul's story>, <Article: This is a test>]\n+\n+You can also use a queryset instead of a literal list of instances::\n+\n+    >>> Article.objects.filter(reporter__in=Reporter.objects.filter(first_name='John')).distinct()\n+    [<Article: John's second story>, <Article: This is a test>]\n+\n+Querying in the opposite direction::\n+\n+    >>> Reporter.objects.filter(article__pk=1)\n+    [<Reporter: John Smith>]\n+    >>> Reporter.objects.filter(article=1)\n+    [<Reporter: John Smith>]\n+    >>> Reporter.objects.filter(article=a)\n+    [<Reporter: John Smith>]\n+\n+    >>> Reporter.objects.filter(article__headline__startswith='This')\n+    [<Reporter: John Smith>, <Reporter: John Smith>, <Reporter: John Smith>]\n+    >>> Reporter.objects.filter(article__headline__startswith='This').distinct()\n+    [<Reporter: John Smith>]\n+\n+Counting in the opposite direction works in conjunction with distinct()::\n+\n+    >>> Reporter.objects.filter(article__headline__startswith='This').count()\n+    3\n+    >>> Reporter.objects.filter(article__headline__startswith='This').distinct().count()\n+    1\n+\n+Queries can go round in circles::\n+\n+    >>> Reporter.objects.filter(article__reporter__first_name__startswith='John')\n+    [<Reporter: John Smith>, <Reporter: John Smith>, <Reporter: John Smith>, <Reporter: John Smith>]\n+    >>> Reporter.objects.filter(article__reporter__first_name__startswith='John').distinct()\n+    [<Reporter: John Smith>]\n+    >>> Reporter.objects.filter(article__reporter__exact=r).distinct()\n+    [<Reporter: John Smith>]\n+\n+If you delete a reporter, his articles will be deleted (assuming that the\n+ForeignKey was defined with :attr:`django.db.models.ForeignKey.on_delete` set to\n+``CASCADE``, which is the default)::\n+\n+    >>> Article.objects.all()\n+    [<Article: John's second story>, <Article: Paul's story>, <Article: This is a test>]\n+    >>> Reporter.objects.order_by('first_name')\n+    [<Reporter: John Smith>, <Reporter: Paul Jones>]\n+    >>> r2.delete()\n+    >>> Article.objects.all()\n+    [<Article: John's second story>, <Article: This is a test>]\n+    >>> Reporter.objects.order_by('first_name')\n+    [<Reporter: John Smith>]\n+\n+You can delete using a JOIN in the query::\n+\n+    >>> Reporter.objects.filter(article__headline__startswith='This').delete()\n+    >>> Reporter.objects.all()\n+    []\n+    >>> Article.objects.all()\n+    []"
        },
        {
            "sha": "4c8e0ecfcc467b0a371dd0152d69f6d6aa82cc03",
            "filename": "docs/topics/db/examples/one_to_one.txt",
            "status": "added",
            "additions": 132,
            "deletions": 0,
            "changes": 132,
            "blob_url": "https://github.com/django/django/blob/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fexamples%2Fone_to_one.txt",
            "raw_url": "https://github.com/django/django/raw/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fexamples%2Fone_to_one.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fdb%2Fexamples%2Fone_to_one.txt?ref=dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2",
            "patch": "@@ -0,0 +1,132 @@\n+########################\n+One-to-one relationships\n+########################\n+\n+.. highlight:: pycon\n+\n+To define a one-to-one relationship, use :ref:`ref-onetoone`.\n+\n+In this example, a ``Place`` optionally can be a ``Restaurant``:\n+\n+.. code-block:: python\n+\n+    from django.db import models, transaction, IntegrityError\n+\n+    class Place(models.Model):\n+        name = models.CharField(max_length=50)\n+        address = models.CharField(max_length=80)\n+\n+        def __unicode__(self):\n+            return u\"%s the place\" % self.name\n+\n+    class Restaurant(models.Model):\n+        place = models.OneToOneField(Place, primary_key=True)\n+        serves_hot_dogs = models.BooleanField()\n+        serves_pizza = models.BooleanField()\n+\n+        def __unicode__(self):\n+            return u\"%s the restaurant\" % self.place.name\n+\n+    class Waiter(models.Model):\n+        restaurant = models.ForeignKey(Restaurant)\n+        name = models.CharField(max_length=50)\n+\n+        def __unicode__(self):\n+            return u\"%s the waiter at %s\" % (self.name, self.restaurant)\n+\n+What follows are examples of operations that can be performed using the Python\n+API facilities.\n+\n+Create a couple of Places::\n+\n+    >>> p1 = Place(name='Demon Dogs', address='944 W. Fullerton')\n+    >>> p1.save()\n+    >>> p2 = Place(name='Ace Hardware', address='1013 N. Ashland')\n+    >>> p2.save()\n+\n+Create a Restaurant. Pass the ID of the \"parent\" object as this object's ID::\n+\n+    >>> r = Restaurant(place=p1, serves_hot_dogs=True, serves_pizza=False)\n+    >>> r.save()\n+\n+A Restaurant can access its place::\n+\n+    >>> r.place\n+    <Place: Demon Dogs the place>\n+\n+A Place can access its restaurant, if available::\n+\n+    >>> p1.restaurant\n+    <Restaurant: Demon Dogs the restaurant>\n+\n+p2 doesn't have an associated restaurant::\n+\n+    >>> p2.restaurant\n+    Traceback (most recent call last):\n+        ...\n+    DoesNotExist: Restaurant matching query does not exist.\n+\n+Set the place using assignment notation. Because place is the primary key on\n+Restaurant, the save will create a new restaurant::\n+\n+    >>> r.place = p2\n+    >>> r.save()\n+    >>> p2.restaurant\n+    <Restaurant: Ace Hardware the restaurant>\n+    >>> r.place\n+    <Place: Ace Hardware the place>\n+\n+Set the place back again, using assignment in the reverse direction::\n+\n+    >>> p1.restaurant = r\n+    >>> p1.restaurant\n+    <Restaurant: Demon Dogs the restaurant>\n+\n+Restaurant.objects.all() just returns the Restaurants, not the Places.  Note\n+that there are two restaurants - Ace Hardware the Restaurant was created in the\n+call to r.place = p2::\n+\n+    >>> Restaurant.objects.all()\n+    [<Restaurant: Demon Dogs the restaurant>, <Restaurant: Ace Hardware the restaurant>]\n+\n+Place.objects.all() returns all Places, regardless of whether they have\n+Restaurants::\n+\n+    >>> Place.objects.order_by('name')\n+    [<Place: Ace Hardware the place>, <Place: Demon Dogs the place>]\n+\n+You can query the models using :ref:`lookups across relationships <lookups-that-span-relationships>`::\n+\n+    >>> Restaurant.objects.get(place=p1)\n+    <Restaurant: Demon Dogs the restaurant>\n+    >>> Restaurant.objects.get(place__pk=1)\n+    <Restaurant: Demon Dogs the restaurant>\n+    >>> Restaurant.objects.filter(place__name__startswith=\"Demon\")\n+    [<Restaurant: Demon Dogs the restaurant>]\n+    >>> Restaurant.objects.exclude(place__address__contains=\"Ashland\")\n+    [<Restaurant: Demon Dogs the restaurant>]\n+\n+This of course works in reverse::\n+\n+    >>> Place.objects.get(pk=1)\n+    <Place: Demon Dogs the place>\n+    >>> Place.objects.get(restaurant__place__exact=p1)\n+    <Place: Demon Dogs the place>\n+    >>> Place.objects.get(restaurant=r)\n+    <Place: Demon Dogs the place>\n+    >>> Place.objects.get(restaurant__place__name__startswith=\"Demon\")\n+    <Place: Demon Dogs the place>\n+\n+Add a Waiter to the Restaurant::\n+\n+    >>> w = r.waiter_set.create(name='Joe')\n+    >>> w.save()\n+    >>> w\n+    <Waiter: Joe the waiter at Demon Dogs the restaurant>\n+\n+Query the waiters::\n+\n+    >>> Waiter.objects.filter(restaurant__place=p1)\n+    [<Waiter: Joe the waiter at Demon Dogs the restaurant>]\n+    >>> Waiter.objects.filter(restaurant__place__name__startswith=\"Demon\")\n+    [<Waiter: Joe the waiter at Demon Dogs the restaurant>]"
        },
        {
            "sha": "5b45e36e7c74e498985637ed3f66d0706c061ffe",
            "filename": "docs/topics/db/index.txt",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Findex.txt",
            "raw_url": "https://github.com/django/django/raw/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Findex.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fdb%2Findex.txt?ref=dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2",
            "patch": "@@ -19,3 +19,4 @@ model maps to a single database table.\n    multi-db\n    tablespaces\n    optimization\n+   examples/index"
        },
        {
            "sha": "9b29e1ef3af8eeb63ae1bc8d72290de47487377e",
            "filename": "docs/topics/db/models.txt",
            "status": "modified",
            "additions": 0,
            "deletions": 18,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fmodels.txt",
            "raw_url": "https://github.com/django/django/raw/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fmodels.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fdb%2Fmodels.txt?ref=dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2",
            "patch": "@@ -18,13 +18,6 @@ The basics:\n * With all of this, Django gives you an automatically-generated\n   database-access API; see :doc:`/topics/db/queries`.\n \n-.. seealso::\n-\n-    A companion to this document is the `official repository of model\n-    examples`_. (In the Django source distribution, these examples are in the\n-    ``tests/modeltests`` directory.)\n-\n-    .. _official repository of model examples: https://code.djangoproject.com/browser/django/trunk/tests/modeltests\n \n Quick example\n =============\n@@ -326,9 +319,6 @@ whatever you want. For example::\n     For details on accessing backwards-related objects, see the\n     :ref:`Following relationships backward example <backwards-related-objects>`.\n \n-    For sample code, see the `Many-to-one relationship model tests`_.\n-\n-    .. _Many-to-one relationship model tests: https://code.djangoproject.com/browser/django/trunk/tests/modeltests/many_to_one\n \n Many-to-many relationships\n ~~~~~~~~~~~~~~~~~~~~~~~~~~\n@@ -376,10 +366,6 @@ form would let users select the toppings.\n \n .. seealso::\n \n-    See the `Many-to-many relationship model example`_ for a full example.\n-\n-.. _Many-to-many relationship model example: https://code.djangoproject.com/browser/django/trunk/tests/modeltests/many_to_many/models.py\n-\n :class:`~django.db.models.ManyToManyField` fields also accept a number of extra\n arguments which are explained in :ref:`the model field reference\n <manytomany-arguments>`. These options help define how the relationship should\n@@ -569,10 +555,6 @@ can be made; see :ref:`the model field reference <ref-onetoone>` for details.\n \n .. seealso::\n \n-    See the `One-to-one relationship model example`_ for a full example.\n-\n-.. _One-to-one relationship model example: https://code.djangoproject.com/browser/django/trunk/tests/modeltests/one_to_one/models.py\n-\n :class:`~django.db.models.OneToOneField` fields also accept one optional argument\n described in the :ref:`model field reference <ref-onetoone>`.\n "
        },
        {
            "sha": "0a67b9b486b7bab1f4a1bb0b10696860a6a17b5d",
            "filename": "docs/topics/db/queries.txt",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fqueries.txt",
            "raw_url": "https://github.com/django/django/raw/dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2/docs%2Ftopics%2Fdb%2Fqueries.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fdb%2Fqueries.txt?ref=dad1f5c21e14ab226cf4e7b28cf27fe7195be0e2",
            "patch": "@@ -483,6 +483,8 @@ probably use:\n Again, this only scratches the surface. A complete reference can be found in the\n :ref:`field lookup reference <field-lookups>`.\n \n+.. _lookups-that-span-relationships:\n+\n Lookups that span relationships\n -------------------------------\n "
        }
    ],
    "stats": {
        "total": 660,
        "additions": 642,
        "deletions": 18
    }
}