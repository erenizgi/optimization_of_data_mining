{
    "author": "claudep",
    "message": "Reformatted slightly openlayers.js",
    "sha": "f3d1aebed1f72fc150e03aba18cc5bc56de6f5c4",
    "files": [
        {
            "sha": "19b9192950dbf612d9f755098dd8b14afd67954e",
            "filename": "django/contrib/gis/templates/gis/admin/openlayers.js",
            "status": "modified",
            "additions": 25,
            "deletions": 19,
            "changes": 44,
            "blob_url": "https://github.com/django/django/blob/f3d1aebed1f72fc150e03aba18cc5bc56de6f5c4/django%2Fcontrib%2Fgis%2Ftemplates%2Fgis%2Fadmin%2Fopenlayers.js",
            "raw_url": "https://github.com/django/django/raw/f3d1aebed1f72fc150e03aba18cc5bc56de6f5c4/django%2Fcontrib%2Fgis%2Ftemplates%2Fgis%2Fadmin%2Fopenlayers.js",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftemplates%2Fgis%2Fadmin%2Fopenlayers.js?ref=f3d1aebed1f72fc150e03aba18cc5bc56de6f5c4",
            "patch": "@@ -10,19 +10,21 @@ OpenLayers.Projection.addTransform(\"EPSG:4326\", \"EPSG:3857\", OpenLayers.Layer.Sp\n {{ module }}.is_polygon = {{ is_polygon|yesno:\"true,false\" }};\n {{ module }}.is_point = {{ is_point|yesno:\"true,false\" }};\n {% endblock %}\n-{{ module }}.get_ewkt = function(feat){return 'SRID={{ srid }};' + {{ module }}.wkt_f.write(feat);}\n+{{ module }}.get_ewkt = function(feat){\n+  return 'SRID={{ srid }};' + {{ module }}.wkt_f.write(feat);\n+};\n {{ module }}.read_wkt = function(wkt){\n   // OpenLayers cannot handle EWKT -- we make sure to strip it out.\n   // EWKT is only exposed to OL if there's a validation error in the admin.\n   var match = {{ module }}.re.exec(wkt);\n   if (match){wkt = match[1];}\n   return {{ module }}.wkt_f.read(wkt);\n-}\n+};\n {{ module }}.write_wkt = function(feat){\n   if ({{ module }}.is_collection){ {{ module }}.num_geom = feat.geometry.components.length;}\n   else { {{ module }}.num_geom = 1;}\n   document.getElementById('{{ id }}').value = {{ module }}.get_ewkt(feat);\n-}\n+};\n {{ module }}.add_wkt = function(event){\n   // This function will sync the contents of the `vector` layer with the\n   // WKT in the text field.\n@@ -41,7 +43,7 @@ OpenLayers.Projection.addTransform(\"EPSG:4326\", \"EPSG:3857\", OpenLayers.Layer.Sp\n     }\n     {{ module }}.write_wkt(event.feature);\n   }\n-}\n+};\n {{ module }}.modify_wkt = function(event){\n   if ({{ module }}.is_collection){\n     if ({{ module }}.is_point){\n@@ -52,34 +54,38 @@ OpenLayers.Projection.addTransform(\"EPSG:4326\", \"EPSG:3857\", OpenLayers.Layer.Sp\n       // vector layer so we only increment to the `num_geom` value.\n       var feat = new OpenLayers.Feature.Vector(new OpenLayers.Geometry.{{ geom_type }}());\n       for (var i = 0; i < {{ module }}.num_geom; i++){\n-\tfeat.geometry.addComponents([{{ module }}.layers.vector.features[i].geometry]);\n+        feat.geometry.addComponents([{{ module }}.layers.vector.features[i].geometry]);\n       }\n       {{ module }}.write_wkt(feat);\n     }\n   } else {\n     {{ module }}.write_wkt(event.feature);\n   }\n-}\n+};\n // Function to clear vector features and purge wkt from div\n {{ module }}.deleteFeatures = function(){\n   {{ module }}.layers.vector.removeFeatures({{ module }}.layers.vector.features);\n   {{ module }}.layers.vector.destroyFeatures();\n-}\n+};\n {{ module }}.clearFeatures = function (){\n   {{ module }}.deleteFeatures();\n   document.getElementById('{{ id }}').value = '';\n   {% localize off %}\n   {{ module }}.map.setCenter(new OpenLayers.LonLat({{ default_lon }}, {{ default_lat }}), {{ default_zoom }});\n   {% endlocalize %}\n-}\n+};\n // Add Select control\n {{ module }}.addSelectControl = function(){\n   var select = new OpenLayers.Control.SelectFeature({{ module }}.layers.vector, {'toggle' : true, 'clickout' : true});\n   {{ module }}.map.addControl(select);\n   select.activate();\n-}\n-{{ module }}.enableDrawing = function(){ {{ module }}.map.getControlsByClass('OpenLayers.Control.DrawFeature')[0].activate();}\n-{{ module }}.enableEditing = function(){ {{ module }}.map.getControlsByClass('OpenLayers.Control.ModifyFeature')[0].activate();}\n+};\n+{{ module }}.enableDrawing = function(){\n+  {{ module }}.map.getControlsByClass('OpenLayers.Control.DrawFeature')[0].activate();\n+};\n+{{ module }}.enableEditing = function(){\n+  {{ module }}.map.getControlsByClass('OpenLayers.Control.ModifyFeature')[0].activate();\n+};\n // Create an array of controls based on geometry type\n {{ module }}.getControls = function(lyr){\n   {{ module }}.panel = new OpenLayers.Control.Panel({'displayClass': 'olControlEditingToolbar'});\n@@ -102,7 +108,7 @@ OpenLayers.Projection.addTransform(\"EPSG:4326\", \"EPSG:3857\", OpenLayers.Layer.Sp\n       {{ module }}.controls = [nav];\n     }\n   }\n-}\n+};\n {{ module }}.init = function(){\n     {% block map_options %}// The options hash, w/ zoom, resolution, and projection settings.\n     var options = {\n@@ -127,13 +133,13 @@ OpenLayers.Projection.addTransform(\"EPSG:4326\", \"EPSG:3857\", OpenLayers.Layer.Sp\n       var admin_geom = {{ module }}.read_wkt(wkt);\n       {{ module }}.write_wkt(admin_geom);\n       if ({{ module }}.is_collection){\n-\t// If geometry collection, add each component individually so they may be\n-\t// edited individually.\n-\tfor (var i = 0; i < {{ module }}.num_geom; i++){\n-\t  {{ module }}.layers.vector.addFeatures([new OpenLayers.Feature.Vector(admin_geom.geometry.components[i].clone())]);\n-\t}\n+        // If geometry collection, add each component individually so they may be\n+        // edited individually.\n+        for (var i = 0; i < {{ module }}.num_geom; i++){\n+          {{ module }}.layers.vector.addFeatures([new OpenLayers.Feature.Vector(admin_geom.geometry.components[i].clone())]);\n+        }\n       } else {\n-\t{{ module }}.layers.vector.addFeatures([admin_geom]);\n+        {{ module }}.layers.vector.addFeatures([admin_geom]);\n       }\n       // Zooming to the bounds.\n       {{ module }}.map.zoomToExtent(admin_geom.geometry.getBounds());\n@@ -171,4 +177,4 @@ OpenLayers.Projection.addTransform(\"EPSG:4326\", \"EPSG:3857\", OpenLayers.Layer.Sp\n     } else {\n       {{ module }}.enableDrawing();\n     }\n-}\n+};"
        }
    ],
    "stats": {
        "total": 44,
        "additions": 25,
        "deletions": 19
    }
}