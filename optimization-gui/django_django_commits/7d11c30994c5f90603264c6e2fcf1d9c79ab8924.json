{
    "author": "jezdez",
    "message": "Fixed #6953 -- Correctly sort ManyToMany fields in ModelForms. Thanks, dgouldin, mk and Alex.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16063 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "7d11c30994c5f90603264c6e2fcf1d9c79ab8924",
    "files": [
        {
            "sha": "9c1287f065c5070b063d0018b052ea8389258296",
            "filename": "django/forms/models.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/7d11c30994c5f90603264c6e2fcf1d9c79ab8924/django%2Fforms%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/7d11c30994c5f90603264c6e2fcf1d9c79ab8924/django%2Fforms%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fmodels.py?ref=7d11c30994c5f90603264c6e2fcf1d9c79ab8924",
            "patch": "@@ -143,7 +143,7 @@ def fields_for_model(model, fields=None, exclude=None, widgets=None, formfield_c\n     field_list = []\n     ignored = []\n     opts = model._meta\n-    for f in opts.fields + opts.many_to_many:\n+    for f in sorted(opts.fields + opts.many_to_many):\n         if not f.editable:\n             continue\n         if fields is not None and not f.name in fields:"
        },
        {
            "sha": "6cd1a72c8a22e7e25fb00a989948d6e1af178522",
            "filename": "tests/modeltests/model_forms/models.py",
            "status": "modified",
            "additions": 33,
            "deletions": 33,
            "changes": 66,
            "blob_url": "https://github.com/django/django/blob/7d11c30994c5f90603264c6e2fcf1d9c79ab8924/tests%2Fmodeltests%2Fmodel_forms%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/7d11c30994c5f90603264c6e2fcf1d9c79ab8924/tests%2Fmodeltests%2Fmodel_forms%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fmodel_forms%2Fmodels.py?ref=7d11c30994c5f90603264c6e2fcf1d9c79ab8924",
            "patch": "@@ -371,7 +371,7 @@ class FlexibleDatePost(models.Model):\n OddForm is now an Article-related thing, because BadForm.Meta overrides\n CategoryForm.Meta.\n >>> OddForm.base_fields.keys()\n-['headline', 'slug', 'pub_date', 'writer', 'article', 'status', 'categories']\n+['headline', 'slug', 'pub_date', 'writer', 'article', 'categories', 'status']\n \n >>> class ArticleForm(ModelForm):\n ...     class Meta:\n@@ -382,7 +382,7 @@ class FlexibleDatePost(models.Model):\n >>> class BadForm(ArticleForm, CategoryForm):\n ...     pass\n >>> OddForm.base_fields.keys()\n-['headline', 'slug', 'pub_date', 'writer', 'article', 'status', 'categories']\n+['headline', 'slug', 'pub_date', 'writer', 'article', 'categories', 'status']\n \n Subclassing without specifying a Meta on the class will use the parent's Meta\n (or the first parent in the MRO if there are multiple parent classes).\n@@ -556,17 +556,17 @@ class FlexibleDatePost(models.Model):\n <option value=\"...\">Mike Royko</option>\n </select></td></tr>\n <tr><th>Article:</th><td><textarea rows=\"10\" cols=\"40\" name=\"article\"></textarea></td></tr>\n+<tr><th>Categories:</th><td><select multiple=\"multiple\" name=\"categories\">\n+<option value=\"...\">Entertainment</option>\n+<option value=\"...\">It&#39;s a test</option>\n+<option value=\"...\">Third test</option>\n+</select><br /><span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></td></tr>\n <tr><th>Status:</th><td><select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n </select></td></tr>\n-<tr><th>Categories:</th><td><select multiple=\"multiple\" name=\"categories\">\n-<option value=\"...\">Entertainment</option>\n-<option value=\"...\">It&#39;s a test</option>\n-<option value=\"...\">Third test</option>\n-</select><br /><span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></td></tr>\n \n You can restrict a form to a subset of the complete list of fields\n by providing a 'fields' argument. If you try to save a\n@@ -612,17 +612,17 @@ class FlexibleDatePost(models.Model):\n <option value=\"...\" selected=\"selected\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\">Hello.</textarea></li>\n+<li>Categories: <select multiple=\"multiple\" name=\"categories\">\n+<option value=\"...\">Entertainment</option>\n+<option value=\"...\">It&#39;s a test</option>\n+<option value=\"...\">Third test</option>\n+</select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n <li>Status: <select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n </select></li>\n-<li>Categories: <select multiple=\"multiple\" name=\"categories\">\n-<option value=\"...\">Entertainment</option>\n-<option value=\"...\">It&#39;s a test</option>\n-<option value=\"...\">Third test</option>\n-</select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n >>> f = TestArticleForm({'headline': u'Test headline', 'slug': 'test-headline', 'pub_date': u'1984-02-06', 'writer': unicode(w_royko.pk), 'article': 'Hello.'}, instance=art)\n >>> f.errors\n {}\n@@ -675,17 +675,17 @@ class FlexibleDatePost(models.Model):\n <option value=\"...\" selected=\"selected\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\">Hello.</textarea></li>\n+<li>Categories: <select multiple=\"multiple\" name=\"categories\">\n+<option value=\"...\" selected=\"selected\">Entertainment</option>\n+<option value=\"...\">It&#39;s a test</option>\n+<option value=\"...\">Third test</option>\n+</select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n <li>Status: <select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n </select></li>\n-<li>Categories: <select multiple=\"multiple\" name=\"categories\">\n-<option value=\"...\" selected=\"selected\">Entertainment</option>\n-<option value=\"...\">It&#39;s a test</option>\n-<option value=\"...\">Third test</option>\n-</select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n \n Initial values can be provided for model forms\n >>> f = TestArticleForm(auto_id=False, initial={'headline': 'Your headline here', 'categories': [str(c1.id), str(c2.id)]})\n@@ -699,17 +699,17 @@ class FlexibleDatePost(models.Model):\n <option value=\"...\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\"></textarea></li>\n+<li>Categories: <select multiple=\"multiple\" name=\"categories\">\n+<option value=\"...\" selected=\"selected\">Entertainment</option>\n+<option value=\"...\" selected=\"selected\">It&#39;s a test</option>\n+<option value=\"...\">Third test</option>\n+</select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n <li>Status: <select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n </select></li>\n-<li>Categories: <select multiple=\"multiple\" name=\"categories\">\n-<option value=\"...\" selected=\"selected\">Entertainment</option>\n-<option value=\"...\" selected=\"selected\">It&#39;s a test</option>\n-<option value=\"...\">Third test</option>\n-</select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n \n >>> f = TestArticleForm({'headline': u'New headline', 'slug': u'new-headline', 'pub_date': u'1988-01-04',\n ...     'writer': unicode(w_royko.pk), 'article': u'Hello.', 'categories': [unicode(c1.id), unicode(c2.id)]}, instance=new_art)\n@@ -818,17 +818,17 @@ class FlexibleDatePost(models.Model):\n <option value=\"...\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\"></textarea></li>\n+<li>Categories: <select multiple=\"multiple\" name=\"categories\">\n+<option value=\"...\">Entertainment</option>\n+<option value=\"...\">It&#39;s a test</option>\n+<option value=\"...\">Third</option>\n+</select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n <li>Status: <select name=\"status\">\n <option value=\"\" selected=\"selected\">---------</option>\n <option value=\"1\">Draft</option>\n <option value=\"2\">Pending</option>\n <option value=\"3\">Live</option>\n </select></li>\n-<li>Categories: <select multiple=\"multiple\" name=\"categories\">\n-<option value=\"...\">Entertainment</option>\n-<option value=\"...\">It&#39;s a test</option>\n-<option value=\"...\">Third</option>\n-</select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n >>> c4 = Category.objects.create(name='Fourth', url='4th')\n >>> c4\n <Category: Fourth>\n@@ -845,18 +845,18 @@ class FlexibleDatePost(models.Model):\n <option value=\"...\">Mike Royko</option>\n </select></li>\n <li>Article: <textarea rows=\"10\" cols=\"40\" name=\"article\"></textarea></li>\n-<li>Status: <select name=\"status\">\n-<option value=\"\" selected=\"selected\">---------</option>\n-<option value=\"1\">Draft</option>\n-<option value=\"2\">Pending</option>\n-<option value=\"3\">Live</option>\n-</select></li>\n <li>Categories: <select multiple=\"multiple\" name=\"categories\">\n <option value=\"...\">Entertainment</option>\n <option value=\"...\">It&#39;s a test</option>\n <option value=\"...\">Third</option>\n <option value=\"...\">Fourth</option>\n </select> <span class=\"helptext\"> Hold down \"Control\", or \"Command\" on a Mac, to select more than one.</span></li>\n+<li>Status: <select name=\"status\">\n+<option value=\"\" selected=\"selected\">---------</option>\n+<option value=\"1\">Draft</option>\n+<option value=\"2\">Pending</option>\n+<option value=\"3\">Live</option>\n+</select></li>\n \n # ModelChoiceField ############################################################\n "
        }
    ],
    "stats": {
        "total": 68,
        "additions": 34,
        "deletions": 34
    }
}