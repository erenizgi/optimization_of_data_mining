{
    "author": "jezdez",
    "message": "Fixed #17580 -- Made sure datetime.date instances are correctly handled when being passed to a DateTimeField fields and the timezone support is enabled by making it aware using the default timezone.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17392 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "8f168976d68282a6180d2af4e12c4f3b6dd09c85",
    "files": [
        {
            "sha": "70a7024c26b1dfca3260568f830805c0242a3ce2",
            "filename": "django/db/models/fields/__init__.py",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/8f168976d68282a6180d2af4e12c4f3b6dd09c85/django%2Fdb%2Fmodels%2Ffields%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/8f168976d68282a6180d2af4e12c4f3b6dd09c85/django%2Fdb%2Fmodels%2Ffields%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Ffields%2F__init__.py?ref=8f168976d68282a6180d2af4e12c4f3b6dd09c85",
            "patch": "@@ -748,7 +748,11 @@ def to_python(self, value):\n         if isinstance(value, datetime.datetime):\n             return value\n         if isinstance(value, datetime.date):\n-            return datetime.datetime(value.year, value.month, value.day)\n+            value = datetime.datetime(value.year, value.month, value.day)\n+            if settings.USE_TZ:\n+                default_timezone = timezone.get_default_timezone()\n+                value = timezone.make_aware(value, default_timezone)\n+            return value\n \n         value = smart_str(value)\n "
        },
        {
            "sha": "41c0016240949aa963a305a6a75592900fad6f46",
            "filename": "tests/modeltests/timezones/tests.py",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/8f168976d68282a6180d2af4e12c4f3b6dd09c85/tests%2Fmodeltests%2Ftimezones%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/8f168976d68282a6180d2af4e12c4f3b6dd09c85/tests%2Fmodeltests%2Ftimezones%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ftimezones%2Ftests.py?ref=8f168976d68282a6180d2af4e12c4f3b6dd09c85",
            "patch": "@@ -261,6 +261,13 @@ def test_naive_datetime(self):\n         # naive datetimes are interpreted in local time\n         self.assertEqual(event.dt, dt.replace(tzinfo=EAT))\n \n+    @requires_tz_support\n+    def test_datetime_from_date(self):\n+        dt = datetime.date(2011, 9, 1)\n+        Event.objects.create(dt=dt)\n+        event = Event.objects.get()\n+        self.assertEqual(event.dt, datetime.datetime(2011, 9, 1, tzinfo=EAT))\n+\n     @requires_tz_support\n     @skipIf(sys.version_info < (2, 6), \"this test requires Python >= 2.6\")\n     @skipUnlessDBFeature('supports_microsecond_precision')"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 12,
        "deletions": 1
    }
}