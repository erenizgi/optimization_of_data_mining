{
    "author": "apollo13",
    "message": "Fixed discovery of the Django installation during tests.\n\nIf Django was symlinked into site-packages the previous approach to discover\nthe tests subdirectory would fail. The revised version now always points to\nthe location of the source and not the import path.",
    "sha": "33234aa8f718a4fd7a1535416cf4593414b60a13",
    "files": [
        {
            "sha": "64c01055395edb3a2e8214e8eda7ca06f66e78fb",
            "filename": "tests/admin_scripts/tests.py",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/33234aa8f718a4fd7a1535416cf4593414b60a13/tests%2Fadmin_scripts%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/33234aa8f718a4fd7a1535416cf4593414b60a13/tests%2Fadmin_scripts%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fadmin_scripts%2Ftests.py?ref=33234aa8f718a4fd7a1535416cf4593414b60a13",
            "patch": "@@ -106,9 +106,12 @@ def _ext_backend_paths(self):\n     def run_test(self, script, args, settings_file=None, apps=None):\n         project_dir = test_dir\n         base_dir = os.path.dirname(test_dir)\n-        import django\n-        django_dir = os.path.dirname(os.path.dirname(django.__file__))\n-        tests_dir = os.path.join(django_dir, 'tests')\n+        # The base dir for Django's tests is one level up.\n+        tests_dir = os.path.dirname(os.path.dirname(__file__))\n+        # The base dir for Django is one level above the test dir. We don't use\n+        # `import django` to figure that out, so we don't pick up a Django\n+        # from site-packages or similar.\n+        django_dir = os.path.dirname(tests_dir)\n         ext_backend_base_dirs = self._ext_backend_paths()\n \n         # Remember the old environment"
        }
    ],
    "stats": {
        "total": 9,
        "additions": 6,
        "deletions": 3
    }
}