{
    "author": "jezdez",
    "message": "Fixed #18487 -- Made sure that protocol-relative URLs aren't processed by the cached staticfiles storage. Thanks to LukaszBalcerzak for the patch.",
    "sha": "1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55",
    "files": [
        {
            "sha": "47132831ebb1479838dd3b6fbe88460b671abb92",
            "filename": "django/contrib/staticfiles/storage.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55/django%2Fcontrib%2Fstaticfiles%2Fstorage.py",
            "raw_url": "https://github.com/django/django/raw/1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55/django%2Fcontrib%2Fstaticfiles%2Fstorage.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fstaticfiles%2Fstorage.py?ref=1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55",
            "patch": "@@ -161,7 +161,7 @@ def converter(matchobj):\n             matched, url = matchobj.groups()\n             # Completely ignore http(s) prefixed URLs,\n             # fragments and data-uri URLs\n-            if url.startswith(('#', 'http:', 'https:', 'data:')):\n+            if url.startswith(('#', 'http:', 'https:', 'data:', '//')):\n                 return matched\n             name_parts = name.split(os.sep)\n             # Using posix normpath here to remove duplicates"
        },
        {
            "sha": "fe7b022215ae5751c59d3be15d8423a89c271a6a",
            "filename": "tests/regressiontests/staticfiles_tests/project/documents/cached/css/ignored.css",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55/tests%2Fregressiontests%2Fstaticfiles_tests%2Fproject%2Fdocuments%2Fcached%2Fcss%2Fignored.css",
            "raw_url": "https://github.com/django/django/raw/1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55/tests%2Fregressiontests%2Fstaticfiles_tests%2Fproject%2Fdocuments%2Fcached%2Fcss%2Fignored.css",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fstaticfiles_tests%2Fproject%2Fdocuments%2Fcached%2Fcss%2Fignored.css?ref=1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55",
            "patch": "@@ -0,0 +1,8 @@\n+body {\n+    background: url(\"#foobar\");\n+    background: url(\"http:foobar\");\n+    background: url(\"https:foobar\");\n+    background: url(\"data:foobar\");\n+    background: url(\"//foobar\");\n+}\n+"
        },
        {
            "sha": "812a80a58365fc969e302118a3990fd0677073a0",
            "filename": "tests/regressiontests/staticfiles_tests/tests.py",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py?ref=1aa0d8ac4d3149fad6ebe80834d9e6f83021cf55",
            "patch": "@@ -387,6 +387,17 @@ def test_template_tag_simple_content(self):\n             self.assertNotIn(b\"cached/other.css\", content)\n             self.assertIn(b\"other.d41d8cd98f00.css\", content)\n \n+    def test_path_ignored_completely(self):\n+        relpath = self.cached_file_path(\"cached/css/ignored.css\")\n+        self.assertEqual(relpath, \"cached/css/ignored.6c77f2643390.css\")\n+        with storage.staticfiles_storage.open(relpath) as relfile:\n+            content = relfile.read()\n+            self.assertIn(b'#foobar', content)\n+            self.assertIn(b'http:foobar', content)\n+            self.assertIn(b'https:foobar', content)\n+            self.assertIn(b'data:foobar', content)\n+            self.assertIn(b'//foobar', content)\n+\n     def test_path_with_querystring(self):\n         relpath = self.cached_file_path(\"cached/styles.css?spam=eggs\")\n         self.assertEqual(relpath,"
        }
    ],
    "stats": {
        "total": 21,
        "additions": 20,
        "deletions": 1
    }
}