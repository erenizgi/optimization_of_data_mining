{
    "author": "unknown",
    "message": "Ensured that the archive module consistantly explicitly closed all files.",
    "sha": "ea1e8b38b3bbf8f21f22028ac256ce62c40d1fc1",
    "files": [
        {
            "sha": "0faf1fa7811974f2cb332ad09894f28da026f608",
            "filename": "django/utils/archive.py",
            "status": "modified",
            "additions": 17,
            "deletions": 1,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/ea1e8b38b3bbf8f21f22028ac256ce62c40d1fc1/django%2Futils%2Farchive.py",
            "raw_url": "https://github.com/django/django/raw/ea1e8b38b3bbf8f21f22028ac256ce62c40d1fc1/django%2Futils%2Farchive.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Farchive.py?ref=ea1e8b38b3bbf8f21f22028ac256ce62c40d1fc1",
            "patch": "@@ -46,7 +46,8 @@ def extract(path, to_path=''):\n     Unpack the tar or zip file at the specified path to the directory\n     specified by to_path.\n     \"\"\"\n-    Archive(path).extract(to_path)\n+    with Archive(path) as archive:\n+        archive.extract(to_path)\n \n \n class Archive(object):\n@@ -77,12 +78,21 @@ def _archive_cls(file):\n                 \"Path not a recognized archive format: %s\" % filename)\n         return cls\n \n+    def __enter__(self):\n+        return self\n+\n+    def __exit__(self, exc_type, exc_value, traceback):\n+        self.close()\n+\n     def extract(self, to_path=''):\n         self._archive.extract(to_path)\n \n     def list(self):\n         self._archive.list()\n \n+    def close(self):\n+        self._archive.close()\n+\n \n class BaseArchive(object):\n     \"\"\"\n@@ -161,6 +171,9 @@ def extract(self, to_path):\n                     if extracted:\n                         extracted.close()\n \n+    def close(self):\n+        self._archive.close()\n+\n \n class ZipArchive(BaseArchive):\n \n@@ -189,6 +202,9 @@ def extract(self, to_path):\n                 with open(filename, 'wb') as outfile:\n                     outfile.write(data)\n \n+    def close(self):\n+        self._archive.close()\n+\n extension_map = {\n     '.tar': TarArchive,\n     '.tar.bz2': TarArchive,"
        },
        {
            "sha": "5575f340f610fc0523f8210b63fd3b141863feb3",
            "filename": "tests/regressiontests/utils/archive.py",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/ea1e8b38b3bbf8f21f22028ac256ce62c40d1fc1/tests%2Fregressiontests%2Futils%2Farchive.py",
            "raw_url": "https://github.com/django/django/raw/ea1e8b38b3bbf8f21f22028ac256ce62c40d1fc1/tests%2Fregressiontests%2Futils%2Farchive.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Futils%2Farchive.py?ref=ea1e8b38b3bbf8f21f22028ac256ce62c40d1fc1",
            "patch": "@@ -27,12 +27,14 @@ def tearDown(self):\n         os.chdir(self.old_cwd)\n \n     def test_extract_method(self):\n-        Archive(self.archive).extract(self.tmpdir)\n+        with Archive(self.archive) as archive:\n+            archive.extract(self.tmpdir)\n         self.check_files(self.tmpdir)\n \n     def test_extract_method_no_to_path(self):\n         os.chdir(self.tmpdir)\n-        Archive(self.archive_path).extract()\n+        with Archive(self.archive_path) as archive:\n+            archive.extract()\n         self.check_files(self.tmpdir)\n \n     def test_extract_function(self):"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 21,
        "deletions": 3
    }
}