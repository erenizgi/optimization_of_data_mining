{
    "author": "vanschelven",
    "message": "Fixed #18829 -- Fixed ModelChoiceIterator length\n\nThanks facundo.olano at gmail.com for the report and thikonom for\nthe initial patch.",
    "sha": "1c11ee63459c4362affbd6a20f2ddf9c2ecd8dce",
    "files": [
        {
            "sha": "3905e9e902d38a6905951f63a9afd0c8b5302346",
            "filename": "django/forms/models.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/1c11ee63459c4362affbd6a20f2ddf9c2ecd8dce/django%2Fforms%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/1c11ee63459c4362affbd6a20f2ddf9c2ecd8dce/django%2Fforms%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fmodels.py?ref=1c11ee63459c4362affbd6a20f2ddf9c2ecd8dce",
            "patch": "@@ -917,7 +917,8 @@ def __iter__(self):\n                 yield self.choice(obj)\n \n     def __len__(self):\n-        return len(self.queryset)\n+        return len(self.queryset) +\\\n+                    (1 if self.field.empty_label is not None else 0)\n \n     def choice(self, obj):\n         return (self.field.prepare_value(obj), self.field.label_from_instance(obj))"
        },
        {
            "sha": "f9ef61536ccf9cd81029e66d3e6c1cc6b2bda3a7",
            "filename": "tests/modeltests/model_forms/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/1c11ee63459c4362affbd6a20f2ddf9c2ecd8dce/tests%2Fmodeltests%2Fmodel_forms%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/1c11ee63459c4362affbd6a20f2ddf9c2ecd8dce/tests%2Fmodeltests%2Fmodel_forms%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fmodel_forms%2Ftests.py?ref=1c11ee63459c4362affbd6a20f2ddf9c2ecd8dce",
            "patch": "@@ -989,6 +989,7 @@ def test_with_data(self):\n             (c2.pk, \"It's a test\"),\n             (c3.pk, 'Third'),\n             (c4.pk, 'Fourth')])\n+        self.assertEqual(5, len(f.choices))\n         with self.assertRaises(ValidationError):\n             f.clean('')\n         with self.assertRaises(ValidationError):"
        }
    ],
    "stats": {
        "total": 4,
        "additions": 3,
        "deletions": 1
    }
}