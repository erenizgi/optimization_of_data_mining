{
    "author": "spookylukey",
    "message": "Removed Django 1.2 compatibility fallback for session data integrity check hash.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15954 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "c0caac87f990b585bb7a9f20fe7be91f2a2366ce",
    "files": [
        {
            "sha": "1c7c188ed57e960966900a76ce4b786a2ac5fad0",
            "filename": "django/contrib/sessions/backends/base.py",
            "status": "modified",
            "additions": 3,
            "deletions": 18,
            "changes": 21,
            "blob_url": "https://github.com/django/django/blob/c0caac87f990b585bb7a9f20fe7be91f2a2366ce/django%2Fcontrib%2Fsessions%2Fbackends%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/c0caac87f990b585bb7a9f20fe7be91f2a2366ce/django%2Fcontrib%2Fsessions%2Fbackends%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Fbackends%2Fbase.py?ref=c0caac87f990b585bb7a9f20fe7be91f2a2366ce",
            "patch": "@@ -105,24 +105,9 @@ def decode(self, session_data):\n             else:\n                 return pickle.loads(pickled)\n         except Exception:\n-            # ValueError, SuspiciousOperation, unpickling exceptions\n-            # Fall back to Django 1.2 method\n-            # PendingDeprecationWarning <- here to remind us to\n-            # remove this fallback in Django 1.5\n-            try:\n-                return self._decode_old(session_data)\n-            except Exception:\n-                # Unpickling can cause a variety of exceptions. If something happens,\n-                # just return an empty dictionary (an empty session).\n-                return {}\n-\n-    def _decode_old(self, session_data):\n-        encoded_data = base64.decodestring(session_data)\n-        pickled, tamper_check = encoded_data[:-32], encoded_data[-32:]\n-        if not constant_time_compare(hashlib.md5(pickled + settings.SECRET_KEY).hexdigest(),\n-                                     tamper_check):\n-            raise SuspiciousOperation(\"User tampered with session cookie.\")\n-        return pickle.loads(pickled)\n+            # ValueError, SuspiciousOperation, unpickling exceptions. If any of\n+            # these happen, just return an empty dictionary (an empty session).\n+            return {}\n \n     def update(self, dict_):\n         self._session.update(dict_)"
        },
        {
            "sha": "2eb43f3e36536a84a7190bd9adc7091c1b2769c2",
            "filename": "django/contrib/sessions/tests.py",
            "status": "modified",
            "additions": 0,
            "deletions": 15,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/c0caac87f990b585bb7a9f20fe7be91f2a2366ce/django%2Fcontrib%2Fsessions%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/c0caac87f990b585bb7a9f20fe7be91f2a2366ce/django%2Fcontrib%2Fsessions%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Ftests.py?ref=c0caac87f990b585bb7a9f20fe7be91f2a2366ce",
            "patch": "@@ -1,7 +1,4 @@\n-import base64\n from datetime import datetime, timedelta\n-import hashlib\n-import pickle\n import shutil\n import tempfile\n \n@@ -252,18 +249,6 @@ def test_decode(self):\n         encoded = self.session.encode(data)\n         self.assertEqual(self.session.decode(encoded), data)\n \n-    def test_decode_django12(self):\n-        # Ensure we can decode values encoded using Django 1.2\n-        # Hard code the Django 1.2 method here:\n-        def encode(session_dict):\n-            pickled = pickle.dumps(session_dict, pickle.HIGHEST_PROTOCOL)\n-            pickled_md5 = hashlib.md5(pickled + settings.SECRET_KEY).hexdigest()\n-            return base64.encodestring(pickled + pickled_md5)\n-\n-        data = {'a test key': 'a test value'}\n-        encoded = encode(data)\n-        self.assertEqual(self.session.decode(encoded), data)\n-\n \n class DatabaseSessionTests(SessionTestsMixin, TestCase):\n "
        }
    ],
    "stats": {
        "total": 36,
        "additions": 3,
        "deletions": 33
    }
}