{
    "author": "unknown",
    "message": "Fixed #15335 -- Improved Sphinx crossref targets and metadata for the sites and flatpages reference docs.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15562 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "fe1110018ae98dec8d62d83f4672313e246f4170",
    "files": [
        {
            "sha": "0411e8f93f60e56f712625743f11131976175957",
            "filename": "docs/ref/contrib/flatpages.txt",
            "status": "modified",
            "additions": 28,
            "deletions": 18,
            "changes": 46,
            "blob_url": "https://github.com/django/django/blob/fe1110018ae98dec8d62d83f4672313e246f4170/docs%2Fref%2Fcontrib%2Fflatpages.txt",
            "raw_url": "https://github.com/django/django/raw/fe1110018ae98dec8d62d83f4672313e246f4170/docs%2Fref%2Fcontrib%2Fflatpages.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fflatpages.txt?ref=fe1110018ae98dec8d62d83f4672313e246f4170",
            "patch": "@@ -47,6 +47,8 @@ To install the flatpages app, follow these steps:\n \n     4. Run the command :djadmin:`manage.py syncdb <syncdb>`.\n \n+.. currentmodule:: django.contrib.flatpages.middleware\n+\n How it works\n ============\n \n@@ -56,25 +58,29 @@ that simply maps a URL to a title and bunch of text content.\n ``django_flatpage_sites`` associates a flatpage with a site.\n \n The :class:`~django.contrib.flatpages.middleware.FlatpageFallbackMiddleware`\n-does all of the work. Each time any Django application raises a 404 error, this\n-middleware checks the flatpages database for the requested URL as a last resort.\n-Specifically, it checks for a flatpage with the given URL with a site ID that\n-corresponds to the :setting:`SITE_ID` setting.\n+does all of the work.\n+\n+.. class:: FlatpageFallbackMiddleware\n+\n+    Each time any Django application raises a 404 error, this middleware\n+    checks the flatpages database for the requested URL as a last resort.\n+    Specifically, it checks for a flatpage with the given URL with a site ID\n+    that corresponds to the :setting:`SITE_ID` setting.\n \n-If it finds a match, it follows this algorithm:\n+    If it finds a match, it follows this algorithm:\n \n-    * If the flatpage has a custom template, it loads that template. Otherwise,\n-      it loads the template :file:`flatpages/default.html`.\n+        * If the flatpage has a custom template, it loads that template.\n+          Otherwise, it loads the template :file:`flatpages/default.html`.\n \n-    * It passes that template a single context variable, :data:`flatpage`, which\n-      is the flatpage object. It uses\n-      :class:`~django.template.context.RequestContext` in rendering the\n-      template.\n+        * It passes that template a single context variable, ``flatpage``,\n+          which is the flatpage object. It uses\n+          :class:`~django.template.RequestContext` in rendering the\n+          template.\n \n-If it doesn't find a match, the request continues to be processed as usual.\n+    If it doesn't find a match, the request continues to be processed as usual.\n \n-The middleware only gets activated for 404s -- not for 500s or responses of any\n-other status code.\n+    The middleware only gets activated for 404s -- not for 500s or responses\n+    of any other status code.\n \n .. admonition:: Flatpages will not apply view middleware\n \n@@ -104,6 +110,8 @@ For more on middleware, read the :doc:`middleware docs\n     :class:`~django.contrib.flatpages.middleware.FlatpageFallbackMiddleware`\n     will not attempt to serve a flat page.\n \n+.. currentmodule:: django.contrib.flatpages.models\n+\n How to add, change and delete flatpages\n =======================================\n \n@@ -117,7 +125,7 @@ other object in the system.\n Via the Python API\n ------------------\n \n-.. class:: models.FlatPage\n+.. class:: FlatPage\n \n     Flatpages are represented by a standard\n     :doc:`Django model </topics/db/models>`,\n@@ -126,6 +134,8 @@ Via the Python API\n \n .. _django/contrib/flatpages/models.py: http://code.djangoproject.com/browser/django/trunk/django/contrib/flatpages/models.py\n \n+.. currentmodule:: django.contrib.flatpages\n+\n Flatpage templates\n ==================\n \n@@ -141,7 +151,7 @@ Creating the :file:`flatpages/default.html` template is your responsibility;\n in your template directory, just create a :file:`flatpages` directory\n containing a file :file:`default.html`.\n \n-Flatpage templates are passed a single context variable, :data:`flatpage`,\n+Flatpage templates are passed a single context variable, ``flatpage``,\n which is the flatpage object.\n \n Here's a sample :file:`flatpages/default.html` template:\n@@ -164,7 +174,7 @@ both ``flatpage.title`` and ``flatpage.content`` are marked as **not**\n requiring :ref:`automatic HTML escaping <automatic-html-escaping>` in the\n template.\n \n-Getting a list of :class:`~django.contrib.flatpages.models.Flatpage` objects in your templates\n+Getting a list of :class:`~django.contrib.flatpages.models.FlatPage` objects in your templates\n ==============================================================================================\n \n .. versionadded:: 1.3\n@@ -194,7 +204,7 @@ Displaying ``registration_required`` flatpages\n ----------------------------------------------\n \n By default, the :ttag:`get_flatpages` templatetag will only show\n-flatpages that are marked :attr:`registration_required`\\=False. If you\n+flatpages that are marked ``registration_required = False``. If you\n want to display registration-protected flatpages, you need to specify\n an authenticated user using a``for`` clause.\n "
        },
        {
            "sha": "4730cb2e63ae884994d612428bdfe81a167729fd",
            "filename": "docs/ref/contrib/sites.txt",
            "status": "modified",
            "additions": 55,
            "deletions": 19,
            "changes": 74,
            "blob_url": "https://github.com/django/django/blob/fe1110018ae98dec8d62d83f4672313e246f4170/docs%2Fref%2Fcontrib%2Fsites.txt",
            "raw_url": "https://github.com/django/django/raw/fe1110018ae98dec8d62d83f4672313e246f4170/docs%2Fref%2Fcontrib%2Fsites.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fsites.txt?ref=fe1110018ae98dec8d62d83f4672313e246f4170",
            "patch": "@@ -6,6 +6,8 @@ The \"sites\" framework\n    :synopsis: Lets you operate multiple Web sites from the same database and\n               Django project\n \n+.. currentmodule:: django.contrib.sites.models\n+\n Django comes with an optional \"sites\" framework. It's a hook for associating\n objects and functionality to particular Web sites, and it's a holding place for\n the domain names and \"verbose\" names of your Django-powered sites.\n@@ -15,13 +17,21 @@ need to differentiate between those sites in some way.\n \n The whole sites framework is based on a simple model:\n \n-.. class:: django.contrib.sites.models.Site\n+.. class:: Site\n+\n+    A model for storing the ``domain`` and ``name`` attributes of a Web site.\n+    The :setting:`SITE_ID` setting specifies the database ID of the\n+    :class:`~django.contrib.sites.models.Site` object associated with that\n+    particular settings file.\n+\n+    .. attribute:: domain\n+\n+        The domain name associated with the Web site.\n+\n+    .. attribute:: name\n+\n+        A human-readable \"verbose\" name for the Web site.\n \n-This model has :attr:`~django.contrib.sites.models.Site.domain` and\n-:attr:`~django.contrib.sites.models.Site.name` fields. The :setting:`SITE_ID`\n-setting specifies the database ID of the\n-:class:`~django.contrib.sites.models.Site` object associated with that\n-particular settings file.\n \n How you use this is up to you, but Django uses it in a couple of ways\n automatically via simple conventions.\n@@ -85,9 +95,10 @@ This accomplishes several things quite nicely:\n Associating content with a single site\n --------------------------------------\n \n-Similarly, you can associate a model to the :class:`~django.contrib.sites.models.Site`\n+Similarly, you can associate a model to the\n+:class:`~django.contrib.sites.models.Site`\n model in a many-to-one relationship, using\n-:class:`~django.db.models.fields.related.ForeignKey`.\n+:class:`~django.db.models.ForeignKey`.\n \n For example, if an article is only allowed on a single site, you'd use a model\n like this::\n@@ -158,6 +169,15 @@ the sites framework is installed) or a RequestSite instance (if it is not).\n This allows loose coupling with the sites framework and provides a usable\n fallback for cases where it is not installed.\n \n+.. versionadded:: 1.3\n+\n+.. function:: get_current_site(request)\n+\n+    Checks if contrib.sites is installed and returns either the current\n+    :class:`~django.contrib.sites.models.Site` object or a \n+    :class:`~django.contrib.sites.models.RequestSite` object based on\n+    the request.\n+\n Getting the current domain for display\n --------------------------------------\n \n@@ -260,10 +280,12 @@ clear the cache using ``Site.objects.clear_cache()``::\n     Site.objects.clear_cache()\n     current_site = Site.objects.get_current()\n \n+.. currentmodule:: django.contrib.sites.managers\n+\n The ``CurrentSiteManager``\n ==========================\n \n-.. class:: django.contrib.sites.managers.CurrentSiteManager\n+.. class:: CurrentSiteManager\n \n If :class:`~django.contrib.sites.models.Site` plays a key role in your\n application, consider using the helpful\n@@ -300,9 +322,9 @@ How did :class:`~django.contrib.sites.managers.CurrentSiteManager`\n know which field of ``Photo`` was the\n :class:`~django.contrib.sites.models.Site`? By default,\n :class:`~django.contrib.sites.managers.CurrentSiteManager` looks for a\n-either a :class:`~django.db.models.fields.related.ForeignKey` called\n+either a :class:`~django.db.models.ForeignKey` called\n ``site`` or a\n-:class:`~django.db.models.fields.related.ManyToManyField` called\n+:class:`~django.db.models.ManyToManyField` called\n ``sites`` to filter on. If you use a field named something other than\n ``site`` or ``sites`` to identify which\n :class:`~django.contrib.sites.models.Site` objects your object is\n@@ -325,7 +347,7 @@ demonstrates this::\n         on_site = CurrentSiteManager('publish_on')\n \n If you attempt to use :class:`~django.contrib.sites.managers.CurrentSiteManager`\n-and pass a field name that doesn't exist, Django will raise a :exc:`ValueError`.\n+and pass a field name that doesn't exist, Django will raise a ``ValueError``.\n \n Finally, note that you'll probably want to keep a normal\n (non-site-specific) ``Manager`` on your model, even if you use\n@@ -379,14 +401,15 @@ Here's how Django uses the sites framework:\n   :class:`~django.contrib.sites.models.Site` name to the template as\n   ``{{ site_name }}``.\n \n-* The shortcut view (:func:`django.views.defaults.shortcut`) uses the domain\n+* The shortcut view (``django.views.defaults.shortcut``) uses the domain\n   of the current :class:`~django.contrib.sites.models.Site` object when\n   calculating an object's URL.\n \n * In the admin framework, the \"view on site\" link uses the current\n   :class:`~django.contrib.sites.models.Site` to work out the domain for the\n   site that it will redirect to.\n \n+.. currentmodule:: django.contrib.sites.models\n \n ``RequestSite`` objects\n =======================\n@@ -401,13 +424,26 @@ requires.) For those cases, the framework provides a\n :class:`~django.contrib.sites.models.RequestSite` class, which can be used as a\n fallback when the database-backed sites framework is not available.\n \n+.. class:: RequestSite\n+\n+    A class that shares the primary interface of\n+    :class:`~django.contrib.sites.models.Site` (i.e., it has\n+    ``domain`` and ``name`` attributes) but gets its data from a Django\n+    :class:`~django.http.HttpRequest` object rather than from a database.\n+\n+    The ``save()`` and ``delete()`` methods raise ``NotImplementedError``.\n+\n+    .. method:: __init__(request)\n+\n+        Sets the ``name`` and ``domain`` attributes to the value of\n+        :meth:`~django.http.HttpRequest.get_host`.\n+        \n+\n A :class:`~django.contrib.sites.models.RequestSite` object has a similar\n interface to a normal :class:`~django.contrib.sites.models.Site` object, except\n its :meth:`~django.contrib.sites.models.RequestSite.__init__()` method takes an\n :class:`~django.http.HttpRequest` object. It's able to deduce the\n-:attr:`~django.contrib.sites.models.RequestSite.domain` and\n-:attr:`~django.contrib.sites.models.RequestSite.name` by looking at the\n-request's domain. It has :meth:`~django.contrib.sites.models.RequestSite.save()`\n-and :meth:`~django.contrib.sites.models.RequestSite.delete()` methods to match\n-the interface of :class:`~django.contrib.sites.models.Site`, but the methods\n-raise :exc:`NotImplementedError`.\n+``domain`` and ``name`` by looking at the request's domain. It has ``save()``\n+and ``delete()`` methods to match the interface of\n+:class:`~django.contrib.sites.models.Site`, but the methods raise\n+``NotImplementedError``."
        }
    ],
    "stats": {
        "total": 120,
        "additions": 83,
        "deletions": 37
    }
}