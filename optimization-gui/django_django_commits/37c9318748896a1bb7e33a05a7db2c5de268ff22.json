{
    "author": "aaugustin",
    "message": "[py3] Fixed sitemaps tests.",
    "sha": "37c9318748896a1bb7e33a05a7db2c5de268ff22",
    "files": [
        {
            "sha": "e0b0a827a6143b4789dbdf4e8f0bade74f45b6af",
            "filename": "django/contrib/sitemaps/tests/generic.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/37c9318748896a1bb7e33a05a7db2c5de268ff22/django%2Fcontrib%2Fsitemaps%2Ftests%2Fgeneric.py",
            "raw_url": "https://github.com/django/django/raw/37c9318748896a1bb7e33a05a7db2c5de268ff22/django%2Fcontrib%2Fsitemaps%2Ftests%2Fgeneric.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsitemaps%2Ftests%2Fgeneric.py?ref=37c9318748896a1bb7e33a05a7db2c5de268ff22",
            "patch": "@@ -14,8 +14,9 @@ def test_generic_sitemap(self):\n         expected = ''\n         for username in User.objects.values_list(\"username\", flat=True):\n             expected += \"<url><loc>%s/users/%s/</loc></url>\" % (self.base_url, username)\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n %s\n </urlset>\n-\"\"\" % expected)\n+\"\"\" % expected\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))"
        },
        {
            "sha": "8da971876f36639c864566a580c4397bd330eaf9",
            "filename": "django/contrib/sitemaps/tests/http.py",
            "status": "modified",
            "additions": 22,
            "deletions": 14,
            "changes": 36,
            "blob_url": "https://github.com/django/django/blob/37c9318748896a1bb7e33a05a7db2c5de268ff22/django%2Fcontrib%2Fsitemaps%2Ftests%2Fhttp.py",
            "raw_url": "https://github.com/django/django/raw/37c9318748896a1bb7e33a05a7db2c5de268ff22/django%2Fcontrib%2Fsitemaps%2Ftests%2Fhttp.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsitemaps%2Ftests%2Fhttp.py?ref=37c9318748896a1bb7e33a05a7db2c5de268ff22",
            "patch": "@@ -21,55 +21,61 @@ class HTTPSitemapTests(SitemapTestsBase):\n     def test_simple_sitemap_index(self):\n         \"A simple sitemap index can be rendered\"\n         response = self.client.get('/simple/index.xml')\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <sitemapindex xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <sitemap><loc>%s/simple/sitemap-simple.xml</loc></sitemap>\n </sitemapindex>\n-\"\"\" % self.base_url)\n+\"\"\" % self.base_url\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))\n \n     @override_settings(\n         TEMPLATE_DIRS=(os.path.join(os.path.dirname(__file__), 'templates'),)\n     )\n     def test_simple_sitemap_custom_index(self):\n         \"A simple sitemap index can be rendered with a custom template\"\n         response = self.client.get('/simple/custom-index.xml')\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <!-- This is a customised template -->\n <sitemapindex xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <sitemap><loc>%s/simple/sitemap-simple.xml</loc></sitemap>\n </sitemapindex>\n-\"\"\" % self.base_url)\n+\"\"\" % self.base_url\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))\n+\n \n     def test_simple_sitemap_section(self):\n         \"A simple sitemap section can be rendered\"\n         response = self.client.get('/simple/sitemap-simple.xml')\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <url><loc>%s/location/</loc><lastmod>%s</lastmod><changefreq>never</changefreq><priority>0.5</priority></url>\n </urlset>\n-\"\"\" % (self.base_url, date.today()))\n+\"\"\" % (self.base_url, date.today())\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))\n \n     def test_simple_sitemap(self):\n         \"A simple sitemap can be rendered\"\n         response = self.client.get('/simple/sitemap.xml')\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <url><loc>%s/location/</loc><lastmod>%s</lastmod><changefreq>never</changefreq><priority>0.5</priority></url>\n </urlset>\n-\"\"\" % (self.base_url, date.today()))\n+\"\"\" % (self.base_url, date.today())\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))\n \n     @override_settings(\n         TEMPLATE_DIRS=(os.path.join(os.path.dirname(__file__), 'templates'),)\n     )\n     def test_simple_custom_sitemap(self):\n         \"A simple sitemap can be rendered with a custom template\"\n         response = self.client.get('/simple/custom-sitemap.xml')\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <!-- This is a customised template -->\n <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <url><loc>%s/location/</loc><lastmod>%s</lastmod><changefreq>never</changefreq><priority>0.5</priority></url>\n </urlset>\n-\"\"\" % (self.base_url, date.today()))\n+\"\"\" % (self.base_url, date.today())\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))\n \n     @skipUnless(settings.USE_I18N, \"Internationalization is not enabled\")\n     @override_settings(USE_L10N=True)\n@@ -90,11 +96,12 @@ def test_requestsite_sitemap(self):\n         # installed doesn't raise an exception\n         Site._meta.installed = False\n         response = self.client.get('/simple/sitemap.xml')\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <url><loc>http://testserver/location/</loc><lastmod>%s</lastmod><changefreq>never</changefreq><priority>0.5</priority></url>\n </urlset>\n-\"\"\" % date.today())\n+\"\"\" % date.today()\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))\n \n     @skipUnless(\"django.contrib.sites\" in settings.INSTALLED_APPS,\n                 \"django.contrib.sites app not installed.\")\n@@ -131,8 +138,9 @@ def test_cached_sitemap_index(self):\n         Check that a cached sitemap index can be rendered (#2713).\n         \"\"\"\n         response = self.client.get('/cached/index.xml')\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <sitemapindex xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <sitemap><loc>%s/cached/sitemap-simple.xml</loc></sitemap>\n </sitemapindex>\n-\"\"\" % self.base_url)\n+\"\"\" % self.base_url\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))"
        },
        {
            "sha": "26241eb30b3ba67c181f97f5fe18f987793b5bb6",
            "filename": "django/contrib/sitemaps/tests/https.py",
            "status": "modified",
            "additions": 12,
            "deletions": 8,
            "changes": 20,
            "blob_url": "https://github.com/django/django/blob/37c9318748896a1bb7e33a05a7db2c5de268ff22/django%2Fcontrib%2Fsitemaps%2Ftests%2Fhttps.py",
            "raw_url": "https://github.com/django/django/raw/37c9318748896a1bb7e33a05a7db2c5de268ff22/django%2Fcontrib%2Fsitemaps%2Ftests%2Fhttps.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsitemaps%2Ftests%2Fhttps.py?ref=37c9318748896a1bb7e33a05a7db2c5de268ff22",
            "patch": "@@ -13,20 +13,22 @@ class HTTPSSitemapTests(SitemapTestsBase):\n     def test_secure_sitemap_index(self):\n         \"A secure sitemap index can be rendered\"\n         response = self.client.get('/secure/index.xml')\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <sitemapindex xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <sitemap><loc>%s/secure/sitemap-simple.xml</loc></sitemap>\n </sitemapindex>\n-\"\"\" % self.base_url)\n+\"\"\" % self.base_url\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))\n \n     def test_secure_sitemap_section(self):\n         \"A secure sitemap section can be rendered\"\n         response = self.client.get('/secure/sitemap-simple.xml')\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <url><loc>%s/location/</loc><lastmod>%s</lastmod><changefreq>never</changefreq><priority>0.5</priority></url>\n </urlset>\n-\"\"\" % (self.base_url, date.today()))\n+\"\"\" % (self.base_url, date.today())\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))\n \n \n @override_settings(SECURE_PROXY_SSL_HEADER=False)\n@@ -36,17 +38,19 @@ class HTTPSDetectionSitemapTests(SitemapTestsBase):\n     def test_sitemap_index_with_https_request(self):\n         \"A sitemap index requested in HTTPS is rendered with HTTPS links\"\n         response = self.client.get('/simple/index.xml', **self.extra)\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <sitemapindex xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <sitemap><loc>%s/simple/sitemap-simple.xml</loc></sitemap>\n </sitemapindex>\n-\"\"\" % self.base_url.replace('http://', 'https://'))\n+\"\"\" % self.base_url.replace('http://', 'https://')\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))\n \n     def test_sitemap_section_with_https_request(self):\n         \"A sitemap section requested in HTTPS is rendered with HTTPS links\"\n         response = self.client.get('/simple/sitemap-simple.xml', **self.extra)\n-        self.assertEqual(response.content, b\"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+        expected_content = \"\"\"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\n <url><loc>%s/location/</loc><lastmod>%s</lastmod><changefreq>never</changefreq><priority>0.5</priority></url>\n </urlset>\n-\"\"\" % (self.base_url.replace('http://', 'https://'), date.today()))\n+\"\"\" % (self.base_url.replace('http://', 'https://'), date.today())\n+        self.assertEqual(response.content, expected_content.encode('utf-8'))"
        }
    ],
    "stats": {
        "total": 61,
        "additions": 37,
        "deletions": 24
    }
}