{
    "author": "honzakral",
    "message": "Fixed #15926 -- Added option --no-initial-data to syncdb and flush.\n\nThanks msiedlarek, jpaugh64 and vlinhart!",
    "sha": "fedac99c859c626544d38fc0ea07207ef3fd101a",
    "files": [
        {
            "sha": "7eb71fd1bb633b2df22e791c3f46366de3c6a501",
            "filename": "django/core/management/commands/flush.py",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/fedac99c859c626544d38fc0ea07207ef3fd101a/django%2Fcore%2Fmanagement%2Fcommands%2Fflush.py",
            "raw_url": "https://github.com/django/django/raw/fedac99c859c626544d38fc0ea07207ef3fd101a/django%2Fcore%2Fmanagement%2Fcommands%2Fflush.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fflush.py?ref=fedac99c859c626544d38fc0ea07207ef3fd101a",
            "patch": "@@ -16,6 +16,8 @@ class Command(NoArgsCommand):\n         make_option('--database', action='store', dest='database',\n             default=DEFAULT_DB_ALIAS, help='Nominates a database to flush. '\n                 'Defaults to the \"default\" database.'),\n+        make_option('--no-initial-data', action='store_false', dest='load_initial_data', default=True,\n+ \t\t            help='Tells Django not to load any initial data after database synchronization.'),\n     )\n     help = ('Returns the database to the state it was in immediately after '\n            'syncdb was executed. This means that all data will be removed '\n@@ -79,7 +81,10 @@ def handle_noargs(self, **options):\n             # Reinstall the initial_data fixture.\n             kwargs = options.copy()\n             kwargs['database'] = db\n-            call_command('loaddata', 'initial_data', **kwargs)\n+            if options.get('load_initial_data', True):\n+            # Reinstall the initial_data fixture.\n+                from django.core.management import call_command\n+                call_command('loaddata', 'initial_data', **options)\n \n         else:\n             self.stdout.write(\"Flush cancelled.\\n\")"
        },
        {
            "sha": "f751a3768b21619a4d3616a2e1ade8c9d9d59217",
            "filename": "django/core/management/commands/syncdb.py",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/fedac99c859c626544d38fc0ea07207ef3fd101a/django%2Fcore%2Fmanagement%2Fcommands%2Fsyncdb.py",
            "raw_url": "https://github.com/django/django/raw/fedac99c859c626544d38fc0ea07207ef3fd101a/django%2Fcore%2Fmanagement%2Fcommands%2Fsyncdb.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fsyncdb.py?ref=fedac99c859c626544d38fc0ea07207ef3fd101a",
            "patch": "@@ -14,6 +14,8 @@ class Command(NoArgsCommand):\n     option_list = NoArgsCommand.option_list + (\n         make_option('--noinput', action='store_false', dest='interactive', default=True,\n             help='Tells Django to NOT prompt the user for input of any kind.'),\n+        make_option('--no-initial-data', action='store_false', dest='load_initial_data', default=True,\n+            help='Tells Django not to load any initial data after database synchronization.'),\n         make_option('--database', action='store', dest='database',\n             default=DEFAULT_DB_ALIAS, help='Nominates a database to synchronize. '\n                 'Defaults to the \"default\" database.'),\n@@ -25,9 +27,6 @@ def handle_noargs(self, **options):\n         verbosity = int(options.get('verbosity'))\n         interactive = options.get('interactive')\n         show_traceback = options.get('traceback')\n-\n-        # Stealth option -- 'load_initial_data' is used by the testing setup\n-        # process to disable initial fixture loading.\n         load_initial_data = options.get('load_initial_data', True)\n \n         self.style = no_style()"
        },
        {
            "sha": "f04f9ee058b4a7978a4fc0beedc5004ee3105cb3",
            "filename": "docs/ref/django-admin.txt",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/fedac99c859c626544d38fc0ea07207ef3fd101a/docs%2Fref%2Fdjango-admin.txt",
            "raw_url": "https://github.com/django/django/raw/fedac99c859c626544d38fc0ea07207ef3fd101a/docs%2Fref%2Fdjango-admin.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fdjango-admin.txt?ref=fedac99c859c626544d38fc0ea07207ef3fd101a",
            "patch": "@@ -245,6 +245,14 @@ prompts.\n The :djadminopt:`--database` option may be used to specify the database\n to flush.\n \n+--no-initial-data\n+~~~~~~~~~~~~~~~~~\n+\n+.. versionadded:: 1.5\n+\n+Use ``--no-initial-data`` to avoid loading the initial_data fixture.\n+\n+\n inspectdb\n ---------\n \n@@ -1024,6 +1032,13 @@ prompts.\n The :djadminopt:`--database` option can be used to specify the database to\n synchronize.\n \n+--no-initial-data\n+~~~~~~~~~~~~~~~~~\n+\n+.. versionadded:: 1.5\n+\n+Use ``--no-initial-data`` to avoid loading the initial_data fixture.\n+\n test <app or test identifier>\n -----------------------------\n "
        },
        {
            "sha": "0cc90381b898bfefed12250c98fc95c94afc4d35",
            "filename": "tests/modeltests/fixtures_model_package/tests.py",
            "status": "modified",
            "additions": 54,
            "deletions": 0,
            "changes": 54,
            "blob_url": "https://github.com/django/django/blob/fedac99c859c626544d38fc0ea07207ef3fd101a/tests%2Fmodeltests%2Ffixtures_model_package%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/fedac99c859c626544d38fc0ea07207ef3fd101a/tests%2Fmodeltests%2Ffixtures_model_package%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ffixtures_model_package%2Ftests.py?ref=fedac99c859c626544d38fc0ea07207ef3fd101a",
            "patch": "@@ -20,6 +20,60 @@ def testClassFixtures(self):\n         )\n \n \n+class TestNoInitialDataLoading(TestCase):\n+    def test_syncdb(self):\n+        Book.objects.all().delete()\n+\n+        management.call_command(\n+            'syncdb',\n+            verbosity=0,\n+            commit=False\n+        )\n+        self.assertQuerysetEqual(\n+            Book.objects.all(), [\n+                u'Achieving self-awareness of Python programs'\n+            ],\n+            lambda a: a.name\n+        )\n+\n+        Book.objects.all().delete()\n+\n+        management.call_command(\n+            'syncdb',\n+            verbosity=0,\n+            commit=False,\n+            load_initial_data=False\n+        )\n+        self.assertQuerysetEqual(Book.objects.all(), [])\n+\n+    def test_flush(self):\n+        Book.objects.all().delete()\n+\n+        management.call_command(\n+            'flush',\n+            verbosity=0,\n+            interactive=False,\n+            commit=False\n+        )\n+        self.assertQuerysetEqual(\n+            Book.objects.all(), [\n+                u'Achieving self-awareness of Python programs'\n+            ],\n+            lambda a: a.name\n+        )\n+\n+        Book.objects.all().delete()\n+\n+        management.call_command(\n+            'flush',\n+            verbosity=0,\n+            commit=False,\n+            interactive=False,\n+            load_initial_data=False\n+        )\n+        self.assertQuerysetEqual(Book.objects.all(), [])\n+\n+\n class FixtureTestCase(TestCase):\n     def test_initial_data(self):\n         \"Fixtures can load initial data into models defined in packages\""
        }
    ],
    "stats": {
        "total": 81,
        "additions": 77,
        "deletions": 4
    }
}