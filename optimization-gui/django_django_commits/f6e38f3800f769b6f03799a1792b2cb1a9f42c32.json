{
    "author": "ramiro",
    "message": "Fixed #5494, #10765, #14924 -- Modified the order in which translations are read when composing the final translation to offer at runtime.\n\nThis is slightly backward-incompatible (could result in changed final translations for literals appearing multiple times in different .po files but with different translations).\n\nTranslations are now read in the following order (from lower to higher priority):\n\nFor the 'django' gettext domain:\n\n * Django translations\n * INSTALLED_APPS apps translations (with the ones listed first having higher priority)\n * settings/project path translations (deprecated, see below)\n * LOCALE_PATHS translations (with the ones listed first having higher priority)\n\nFor the 'djangojs' gettext domain:\n\n * Python modules whose names are passed to the javascript_catalog view\n * LOCALE_PATHS translations (with the ones listed first having higher priority, previously they weren't included)\n\nAlso, automatic loading of translations from the 'locale' subdir of the settings/project path is now deprecated.\n\nThanks to vanschelven, vbmendes and an anonymous user for reporting issues, to vanschelven, Claude Paroz and an anonymous contributor for their initial work on fixes and to Jannis  Leidel and Claude for review and discussion.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15441 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
    "files": [
        {
            "sha": "e44b556c16686f4857475b9c5cdbd979f133533e",
            "filename": "django/utils/translation/__init__.py",
            "status": "modified",
            "additions": 16,
            "deletions": 1,
            "changes": 17,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/django%2Futils%2Ftranslation%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/django%2Futils%2Ftranslation%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2F__init__.py?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -1,8 +1,11 @@\n \"\"\"\n Internationalization support.\n \"\"\"\n+from os import path\n+\n from django.utils.encoding import force_unicode\n-from django.utils.functional import lazy, curry\n+from django.utils.functional import lazy\n+from django.utils.importlib import import_module\n \n \n __all__ = ['gettext', 'gettext_noop', 'gettext_lazy', 'ngettext',\n@@ -33,10 +36,22 @@ class Trans(object):\n     performance effect, as access to the function goes the normal path,\n     instead of using __getattr__.\n     \"\"\"\n+\n     def __getattr__(self, real_name):\n         from django.conf import settings\n         if settings.USE_I18N:\n             from django.utils.translation import trans_real as trans\n+\n+            if settings.SETTINGS_MODULE is not None:\n+                import warnings\n+                parts = settings.SETTINGS_MODULE.split('.')\n+                project = import_module(parts[0])\n+                if path.isdir(path.join(path.dirname(project.__file__), 'locale')):\n+                    warnings.warn(\n+                        \"Translations in the project directory aren't supported anymore. Use the LOCALE_PATHS setting instead.\",\n+                        PendingDeprecationWarning\n+                    )\n+\n         else:\n             from django.utils.translation import trans_null as trans\n         setattr(self, real_name, getattr(trans, real_name))"
        },
        {
            "sha": "3b8604f86d7792c04617f9094693048f9b3254c0",
            "filename": "django/utils/translation/trans_real.py",
            "status": "modified",
            "additions": 7,
            "deletions": 7,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2Ftrans_real.py?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -125,12 +125,12 @@ def _fetch(lang, fallback=None):\n \n         global _translations\n \n-        loc = to_locale(lang)\n-\n         res = _translations.get(lang, None)\n         if res is not None:\n             return res\n \n+        loc = to_locale(lang)\n+\n         def _translation(path):\n             try:\n                 t = gettext_module.translation('django', path, [loc], DjangoTranslation)\n@@ -159,11 +159,7 @@ def _merge(path):\n                     res.merge(t)\n             return res\n \n-        for localepath in settings.LOCALE_PATHS:\n-            if os.path.isdir(localepath):\n-                res = _merge(localepath)\n-\n-        for appname in settings.INSTALLED_APPS:\n+        for appname in reversed(settings.INSTALLED_APPS):\n             app = import_module(appname)\n             apppath = os.path.join(os.path.dirname(app.__file__), 'locale')\n \n@@ -173,6 +169,10 @@ def _merge(path):\n         if projectpath and os.path.isdir(projectpath):\n             res = _merge(projectpath)\n \n+        for localepath in reversed(settings.LOCALE_PATHS):\n+            if os.path.isdir(localepath):\n+                res = _merge(localepath)\n+\n         if res is None:\n             if fallback is not None:\n                 res = fallback"
        },
        {
            "sha": "140dc543e3d5220c8ef7bce5d4f0367f7b8b1990",
            "filename": "django/views/i18n.py",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/django%2Fviews%2Fi18n.py",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/django%2Fviews%2Fi18n.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fviews%2Fi18n.py?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -193,11 +193,15 @@ def javascript_catalog(request, domain='djangojs', packages=None):\n     paths = []\n     en_selected = locale.startswith('en')\n     en_catalog_missing = True\n-    # first load all english languages files for defaults\n+    # paths of requested packages\n     for package in packages:\n         p = importlib.import_module(package)\n         path = os.path.join(os.path.dirname(p.__file__), 'locale')\n         paths.append(path)\n+    # add the filesystem paths listed in the LOCALE_PATHS setting\n+    paths.extend(list(reversed(settings.LOCALE_PATHS)))\n+    # first load all english languages files for defaults\n+    for path in paths:\n         try:\n             catalog = gettext_module.translation(domain, path, ['en'])\n             t.update(catalog._catalog)\n@@ -275,4 +279,3 @@ def javascript_catalog(request, domain='djangojs', packages=None):\n     src.append(LibFormatFoot)\n     src = ''.join(src)\n     return http.HttpResponse(src, 'text/javascript')\n-"
        },
        {
            "sha": "37439ae5a209ceebaae9405fef58021198590a29",
            "filename": "docs/howto/i18n.txt",
            "status": "modified",
            "additions": 42,
            "deletions": 24,
            "changes": 66,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Fhowto%2Fi18n.txt",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Fhowto%2Fi18n.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fhowto%2Fi18n.txt?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -4,24 +4,45 @@\n Using internationalization in your own projects\n ===============================================\n \n-At runtime, Django looks for translations by following this algorithm:\n-\n-    * First, it looks for a ``locale`` directory in the directory containing\n-      your settings file.\n-    * Second, it looks for a ``locale`` directory in the project directory.\n-    * Third, it looks for a ``locale`` directory in each of the installed apps.\n-      It does this in the reverse order of INSTALLED_APPS\n-    * Finally, it checks the Django-provided base translation in\n-      ``django/conf/locale``.\n+At runtime, Django builds an in-memory unified catalog of literals-translations.\n+To achieve this it looks for translations by following this algorithm regarding\n+the order in which it examines the different file paths to load the compiled\n+:term:`message files <message file>` (``.mo``) and the precedence of multiple\n+translations for the same literal:\n+\n+    1. The directories listed in :setting:`LOCALE_PATHS` have the highest\n+       precedence, with the ones appearing first having higher precedence than\n+       the ones appearing later.\n+    2. Then, it looks for and uses if it exists a ``locale`` directory in each\n+       of the installed apps listed in :setting:`INSTALLED_APPS`.  The ones\n+       appearing first have higher precedence than the ones appearing later.\n+    3. Then, it looks for a ``locale`` directory in the project directory, or\n+       more accurately, in the directory containing your settings file.\n+    4. Finally, the Django-provided base translation in ``django/conf/locale``\n+       is used as a fallback.\n+\n+.. deprecated:: 1.3\n+    Lookup in the ``locale`` subdirectory of the directory containing your\n+    settings file (item 3 above) is deprecated since the 1.3 release and will be\n+    removed in Django 1.5. You can use the :setting:`LOCALE_PATHS` setting\n+    instead, by listing the absolute filesystem path of such ``locale``\n+    directory in the setting value.\n+\n+.. seealso::\n+\n+    The translations for literals included in JavaScript assets are looked up\n+    following a similar but not identical algorithm. See the\n+    :ref:`javascript_catalog view documentation <javascript_catalog-view>` for\n+    more details.\n \n In all cases the name of the directory containing the translation is expected to\n be named using :term:`locale name` notation. E.g. ``de``, ``pt_BR``, ``es_AR``,\n etc.\n \n This way, you can write applications that include their own translations, and\n you can override base translations in your project path. Or, you can just build\n-a big project out of several apps and put all translations into one big project\n-message file. The choice is yours.\n+a big project out of several apps and put all translations into one big common\n+message file specific to the project you are composing. The choice is yours.\n \n .. note::\n \n@@ -34,10 +55,11 @@ message file. The choice is yours.\n \n All message file repositories are structured the same way. They are:\n \n-    * ``$APPPATH/locale/<language>/LC_MESSAGES/django.(po|mo)``\n-    * ``$PROJECTPATH/locale/<language>/LC_MESSAGES/django.(po|mo)``\n     * All paths listed in ``LOCALE_PATHS`` in your settings file are\n-      searched in that order for ``<language>/LC_MESSAGES/django.(po|mo)``\n+      searched for ``<language>/LC_MESSAGES/django.(po|mo)``\n+    * ``$PROJECTPATH/locale/<language>/LC_MESSAGES/django.(po|mo)`` --\n+      deprecated, see above.\n+    * ``$APPPATH/locale/<language>/LC_MESSAGES/django.(po|mo)``\n     * ``$PYTHONPATH/django/conf/locale/<language>/LC_MESSAGES/django.(po|mo)``\n \n To create message files, you use the :djadmin:`django-admin.py makemessages <makemessages>`\n@@ -50,22 +72,18 @@ You can also run ``django-admin.py compilemessages --settings=path.to.settings``\n to make the compiler process all the directories in your :setting:`LOCALE_PATHS`\n setting.\n \n-Application message files are a bit complicated to discover -- they need the\n-:class:`~django.middleware.locale.LocaleMiddleware`. If you don't use the\n-middleware, only the Django message files and project message files will be\n-installed and available at runtime.\n-\n Finally, you should give some thought to the structure of your translation\n files. If your applications need to be delivered to other users and will\n be used in other projects, you might want to use app-specific translations.\n-But using app-specific translations and project translations could produce\n-weird problems with ``makemessages``: It will traverse all directories below\n-the current path and so might put message IDs into the project message file\n-that are already in application message files.\n+But using app-specific translations and project-specific translations could\n+produce weird problems with ``makemessages``: It will traverse all directories\n+below the current path and so might put message IDs into a unified, common\n+message file for the current project that are already in application message\n+files.\n \n The easiest way out is to store applications that are not part of the project\n (and so carry their own translations) outside the project tree. That way,\n-``django-admin.py makemessages`` on the project level will only translate\n+``django-admin.py makemessages``, when ran on a project level will only extract\n strings that are connected to your explicit project and not strings that are\n distributed independently.\n "
        },
        {
            "sha": "8bf0a4e8d008987fa25dbe2284aa99640ccdc14d",
            "filename": "docs/ref/settings.txt",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Fref%2Fsettings.txt",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Fref%2Fsettings.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fsettings.txt?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -1149,6 +1149,17 @@ Default: ``()`` (Empty tuple)\n A tuple of directories where Django looks for translation files.\n See :ref:`using-translations-in-your-own-projects`.\n \n+Example::\n+\n+    LOCALE_PATHS = (\n+        '/home/www/project/common_files/locale',\n+        '/var/local/translations/locale'\n+    )\n+\n+Note that in the paths you add to the value of this setting, if you have the\n+typical ``/path/to/locale/xx/LC_MESSAGES`` hierarchy, you should use the path to\n+the ``locale`` directory (i.e. ``'/path/to/locale'``).\n+\n .. setting:: LOGGING\n \n LOGGING"
        },
        {
            "sha": "4792eb83fae62c60ee530d79c8d7f1d537a2f194",
            "filename": "docs/releases/1.3.txt",
            "status": "modified",
            "additions": 81,
            "deletions": 0,
            "changes": 81,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Freleases%2F1.3.txt",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Freleases%2F1.3.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.3.txt?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -454,6 +454,52 @@ should either insert it using :ref:`test fixtures\n <topics-testing-fixtures>`, or using the ``setUp()`` method of your\n test case.\n \n+Changed priority of translation loading\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Work has been done to homogeneize, simplify, rationalize and properly document\n+the algorithm used by Django at runtime to build translations from the\n+differents translations found on disk, namely:\n+\n+For translatable literals found in Python code and templates (``'django'``\n+gettext domain):\n+\n+ * Priorities of translations included with applications listed in the\n+   :setting:`INSTALLED_APPS` setting were changed. To provide a behavior\n+   consistent with other parts of Django that also use such setting (templates,\n+   etc.) now, when building the translation that will be made available, the\n+   apps listed first have higher precedence than the ones listed later.\n+\n+ * Now it is possible to override the translations shipped with applications by\n+   using the :setting:`LOCALE_PATHS` setting whose translations have now higher\n+   precedence than the translations of ``INSTALLED_APPS`` applications.\n+   The relative priority among the values listed in this setting has also been\n+   modified so the paths listed first have higher precedence than the\n+   ones listed later.\n+\n+ * The ``locale`` subdirectory of the directory containing the settings, that\n+   usually coincides with and is know as the *project directory* is being\n+   deprecated in this release as a source of translations. (the precedence of\n+   these translations is intermediate between applications and ``LOCALE_PATHS``\n+   translations). See the `corresponding deprecated features section`_\n+   of this document.\n+\n+For translatable literals found in Javascript code (``'djangojs'`` gettext\n+domain):\n+\n+ * Similarly to the ``'django'`` domain translations: Overriding of\n+   translations shipped with applications by using the :setting:`LOCALE_PATHS`\n+   setting is now possible for this domain too. These translations have higher\n+   precedence than the translations of Python packages passed to the\n+   :ref:`javascript_catalog view <javascript_catalog-view>`.  Paths listed first\n+   have higher precedence than the ones listed later.\n+\n+ * Translations under the ``locale`` sbdirectory of the *project directory* have\n+   never been taken in account for JavaScript translations and remain in the\n+   same situation considering the deprecation of such location.\n+\n+.. _corresponding deprecated features section: loading_of_translations_from_the_project_directory_\n+\n .. _deprecated-features-1.3:\n \n Features deprecated in 1.3\n@@ -631,3 +677,38 @@ Previously, ``django.http`` exposed an undocumented ``CompatCookie`` class,\n which was a bug-fix wrapper around the standard library ``SimpleCookie``. As the\n fixes are moving upstream, this is now deprecated - you should use ``from\n django.http import SimpleCookie`` instead.\n+\n+.. _loading_of_translations_from_the_project_directory:\n+\n+Loading of translations from the project directory\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+This release of Django starts the deprecation process for inclusion of\n+translations located under the *project path* in the translation building\n+process performed at runtime. The :setting:`LOCALE_PATHS` setting can be used\n+for the same task by including in it the filesystem path to the ``locale``\n+directory containing project-level translations.\n+\n+Rationale for this decision:\n+\n+ * The *project path* has always been a loosely defined concept (actually, the\n+   directory used for locating project-level translations is the directory\n+   containing the settings module) and there has been a shift in other parts\n+   of the framework to stop using it as a reference for location of assets at\n+   runtime.\n+\n+ * Detection of the ``locale`` subdirectory tends to fail when the deployment\n+   scenario is more complex than the basic one. e.g. it fails when the settings\n+   module is a directory (ticket #10765).\n+\n+ * Potential for strange development- and deployment-time problems like the\n+   fact that the ``project_dir/locale/`` subdir can generate spurious error\n+   messages when the project directory is included in the Python path (default\n+   behavior of ``manage.py runserver``) and then it clashes with the equally\n+   named standard library module, this is a typical warming message::\n+\n+     /usr/lib/python2.6/gettext.py:49: ImportWarning: Not importing directory '/path/to/project/dir/locale': missing __init__.py.\n+     import locale, copy, os, re, struct, sys\n+\n+ * This location wasn't included in the translation building process for\n+   JavaScript literals."
        },
        {
            "sha": "75dfd879abebce7dbe08b7f5e4b5c4029c11d3d1",
            "filename": "docs/topics/i18n/deployment.txt",
            "status": "modified",
            "additions": 30,
            "deletions": 10,
            "changes": 40,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Ftopics%2Fi18n%2Fdeployment.txt",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Ftopics%2Fi18n%2Fdeployment.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fi18n%2Fdeployment.txt?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -171,16 +171,36 @@ in ``request.LANGUAGE_CODE``.\n How Django discovers translations\n ---------------------------------\n \n-As described in :ref:`using-translations-in-your-own-projects`,\n-at runtime, Django looks for translations by following this algorithm:\n-\n-    * First, it looks for a ``locale`` directory in the directory containing\n-      your settings file.\n-    * Second, it looks for a ``locale`` directory in the project directory.\n-    * Third, it looks for a ``locale`` directory in each of the installed apps.\n-      It does this in the reverse order of INSTALLED_APPS\n-    * Finally, it checks the Django-provided base translation in\n-      ``django/conf/locale``.\n+As described in :ref:`using-translations-in-your-own-projects`, Django looks for\n+translations by following this algorithm regarding the order in which it\n+examines the different file paths to load the compiled :term:`message files\n+<message file>` (``.mo``) and the precedence of multiple translations for the\n+same literal:\n+\n+    1. The directories listed in :setting:`LOCALE_PATHS` have the highest\n+       precedence, with the ones appearing first having higher precedence than\n+       the ones appearing later.\n+    2. Then, it looks for and uses if it exists a ``locale`` directory in each\n+       of the installed apps listed in :setting:`INSTALLED_APPS`.  The ones\n+       appearing first have higher precedence than the ones appearing later.\n+    3. Then, it looks for a ``locale`` directory in the project directory, or\n+       more accurately, in the directory containing your settings file.\n+    4. Finally, the Django-provided base translation in ``django/conf/locale``\n+       is used as a fallback.\n+\n+.. deprecated:: 1.3\n+    Lookup in the ``locale`` subdirectory of the directory containing your\n+    settings file (item 3 above) is deprecated since the 1.3 release and will be\n+    removed in Django 1.5. You can use the :setting:`LOCALE_PATHS` setting\n+    instead, by listing the absolute filesystem path of such ``locale``\n+    directory in the setting value.\n+\n+.. seealso::\n+\n+    The translations for literals included in JavaScript assets are looked up\n+    following a similar but not identical algorithm. See the\n+    :ref:`javascript_catalog view documentation <javascript_catalog-view>` for\n+    more details.\n \n In all cases the name of the directory containing the translation is expected to\n be named using :term:`locale name` notation. E.g. ``de``, ``pt_BR``, ``es_AR``,"
        },
        {
            "sha": "edb8236fc27fdc0ce49c96297b7e107d717865e7",
            "filename": "docs/topics/i18n/internationalization.txt",
            "status": "modified",
            "additions": 30,
            "deletions": 5,
            "changes": 35,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Ftopics%2Fi18n%2Finternationalization.txt",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/docs%2Ftopics%2Fi18n%2Finternationalization.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fi18n%2Finternationalization.txt?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -348,8 +348,6 @@ translation method!\n Working with lazy translation objects\n -------------------------------------\n \n-.. highlightlang:: python\n-\n Using ``ugettext_lazy()`` and ``ungettext_lazy()`` to mark strings in models\n and utility functions is a common operation. When you're working with these\n objects elsewhere in your code, you should ensure that you don't accidentally\n@@ -633,6 +631,8 @@ There are also simple filters available for convenience:\n Specifying translation strings: In JavaScript code\n ==================================================\n \n+.. highlightlang:: python\n+\n Adding translations to JavaScript poses some problems:\n \n     * JavaScript code doesn't have access to a ``gettext`` implementation.\n@@ -647,6 +647,8 @@ Django provides an integrated solution for these problems: It passes the\n translations into JavaScript, so you can call ``gettext``, etc., from within\n JavaScript.\n \n+.. _javascript_catalog-view:\n+\n The ``javascript_catalog`` view\n -------------------------------\n \n@@ -657,8 +659,9 @@ The ``javascript_catalog`` view\n The main solution to these problems is the :meth:`django.views.i18n.javascript_catalog`\n view, which sends out a JavaScript code library with functions that mimic the\n ``gettext`` interface, plus an array of translation strings. Those translation\n-strings are taken from the application, project or Django core, according to what\n-you specify in either the info_dict or the URL.\n+strings are taken from applications or Django core, according to what you\n+specify in either the info_dict or the URL. Paths listed in\n+:setting:`LOCALE_PATHS` are also included.\n \n You hook it up like this::\n \n@@ -676,6 +679,11 @@ that contains a ``locale`` directory. If you specify multiple packages, all\n those catalogs are merged into one catalog. This is useful if you have\n JavaScript that uses strings from different applications.\n \n+The precedence of translations is such that the packages appearing later in the\n+``packages`` argument have higher precedence than the ones appearing at the\n+beginning, this is important in the case of clashing translations for the same\n+literal.\n+\n By default, the view uses the ``djangojs`` gettext domain. This can be\n changed by altering the ``domain`` argument.\n \n@@ -691,10 +699,25 @@ different apps and this changes often and you don't want to pull in one big\n catalog file. As a security measure, these values can only be either\n ``django.conf`` or any package from the :setting:`INSTALLED_APPS` setting.\n \n+The JavaScript translations found in the paths listed in the\n+:setting:`LOCALE_PATHS` setting are also always included. To keep consistency\n+with the translations lookup order algorithm used for Python and templates, the\n+directories listed in :setting:`LOCALE_PATHS` have the highest precedence with\n+the ones appearing first having higher precedence than the ones appearing\n+later.\n+\n+.. versionchanged:: 1.3\n+    Directories listed in ``LOCALE_PATHS`` weren't included in the lookup\n+    algorithm until version 1.3.\n+\n Using the JavaScript translation catalog\n ----------------------------------------\n \n-To use the catalog, just pull in the dynamically generated script like this::\n+.. highlightlang:: javascript\n+\n+To use the catalog, just pull in the dynamically generated script like this:\n+\n+.. code-block:: html+django\n \n     <script type=\"text/javascript\" src=\"{% url django.views.i18n.javascript_catalog %}\"></script>\n \n@@ -751,6 +774,8 @@ to produce proper pluralizations).\n The ``set_language`` redirect view\n ==================================\n \n+.. highlightlang:: python\n+\n .. function:: set_language(request)\n \n As a convenience, Django comes with a view, :meth:`django.views.i18n.set_language`,"
        },
        {
            "sha": "241de05ddb04199df4a515d720dc9ea263a06ca7",
            "filename": "tests/regressiontests/i18n/other/locale/de/LC_MESSAGES/django.mo",
            "status": "modified",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Fother%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Fother%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fother%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32"
        },
        {
            "sha": "2d9b89e23cb677885d3a80413aecafc694af77e0",
            "filename": "tests/regressiontests/i18n/other/locale/de/LC_MESSAGES/django.po",
            "status": "modified",
            "additions": 8,
            "deletions": 5,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Fother%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Fother%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fother%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -8,7 +8,7 @@ msgstr \"\"\n \"Project-Id-Version: django tests\\n\"\n \"Report-Msgid-Bugs-To: \\n\"\n \"POT-Creation-Date: 2010-02-14 17:33+0100\\n\"\n-\"PO-Revision-Date: 2011-01-16 17:14+0100\\n\"\n+\"PO-Revision-Date: 2011-01-21 21:37-0300\\n\"\n \"Last-Translator: Jannis Leidel <jannis@leidel.info>\\n\"\n \"Language-Team: de <de@li.org>\\n\"\n \"MIME-Version: 1.0\\n\"\n@@ -18,22 +18,25 @@ msgstr \"\"\n \n #: models.py:3\n msgid \"Time\"\n-msgstr \"Time (LOCALE_PATHS)\"\n+msgstr \"Zeit (LOCALE_PATHS)\"\n \n #: models.py:5\n+msgid \"Date/time\"\n+msgstr \"Datum/Zeit (LOCALE_PATHS)\"\n+\n+#: models.py:7\n msgctxt \"month name\"\n msgid \"May\"\n msgstr \"Mai\"\n \n-#: models.py:7\n+#: models.py:9\n msgctxt \"verb\"\n msgid \"May\"\n msgstr \"Kann\"\n \n-#: models.py:9\n+#: models.py:11\n msgctxt \"search\"\n msgid \"%d result\"\n msgid_plural \"%d results\"\n msgstr[0] \"%d Resultat\"\n msgstr[1] \"%d Resultate\"\n-"
        },
        {
            "sha": "91c7bc59786aed62d6346101b4b35d559421c488",
            "filename": "tests/regressiontests/i18n/resolution/locale/de/LC_MESSAGES/django.mo",
            "status": "modified",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Fresolution%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Fresolution%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fresolution%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32"
        },
        {
            "sha": "bbc511f0ad1cdfed2d311490349cda43040b56ec",
            "filename": "tests/regressiontests/i18n/resolution/locale/de/LC_MESSAGES/django.po",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Fresolution%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Fresolution%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Fresolution%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -3,13 +3,12 @@\n # This file is distributed under the same license as the PACKAGE package.\n # FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.\n #\n-#, fuzzy\n msgid \"\"\n msgstr \"\"\n-\"Project-Id-Version: PACKAGE VERSION\\n\"\n+\"Project-Id-Version: django tests\\n\"\n \"Report-Msgid-Bugs-To: \\n\"\n \"POT-Creation-Date: 2010-02-14 17:33+0100\\n\"\n-\"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\\n\"\n+\"PO-Revision-Date: 2011-02-07 13:12-0300\\n\"\n \"Last-Translator: FULL NAME <EMAIL@ADDRESS>\\n\"\n \"Language-Team: LANGUAGE <LL@li.org>\\n\"\n \"MIME-Version: 1.0\\n\"\n@@ -18,5 +17,9 @@ msgstr \"\"\n \"Plural-Forms: nplurals=2; plural=(n != 1)\\n\"\n \n #: models.py:3\n+msgid \"Time\"\n+msgstr \"Zeit (APP)\"\n+\n+#: models.py:5\n msgid \"Date/time\"\n msgstr \"Datum/Zeit (APP)\""
        },
        {
            "sha": "c9dc1fb45f8614b824c500b8d1fe29863081f30a",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 23,
            "deletions": 11,
            "changes": 34,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -668,14 +668,14 @@ def tearDown(self):\n \n     def assertUgettext(self, msgid, msgstr):\n         result = ugettext(msgid)\n-        self.assert_(msgstr in result, (\"The string '%s' isn't in the \"\n+        self.assertTrue(msgstr in result, (\"The string '%s' isn't in the \"\n             \"translation of '%s'; the actual result is '%s'.\" % (msgstr, msgid, result)))\n \n class AppResolutionOrderI18NTests(ResolutionOrderI18NTests):\n \n     def setUp(self):\n         self.old_installed_apps = settings.INSTALLED_APPS\n-        settings.INSTALLED_APPS = list(settings.INSTALLED_APPS) + ['regressiontests.i18n.resolution']\n+        settings.INSTALLED_APPS = ['regressiontests.i18n.resolution'] + list(settings.INSTALLED_APPS)\n         super(AppResolutionOrderI18NTests, self).setUp()\n \n     def tearDown(self):\n@@ -699,6 +699,22 @@ def tearDown(self):\n     def test_locale_paths_translation(self):\n         self.assertUgettext('Time', 'LOCALE_PATHS')\n \n+    def test_locale_paths_override_app_translation(self):\n+        old_installed_apps = settings.INSTALLED_APPS\n+        settings.INSTALLED_APPS = list(settings.INSTALLED_APPS) + ['regressiontests.i18n.resolution']\n+        try:\n+            self.assertUgettext('Time', 'LOCALE_PATHS')\n+        finally:\n+            settings.INSTALLED_APPS = old_installed_apps\n+\n+    def test_locale_paths_override_project_translation(self):\n+        old_settings_module = settings.SETTINGS_MODULE\n+        settings.SETTINGS_MODULE = 'regressiontests'\n+        try:\n+            self.assertUgettext('Date/time', 'LOCALE_PATHS')\n+        finally:\n+            settings.SETTINGS_MODULE = old_settings_module\n+\n class ProjectResolutionOrderI18NTests(ResolutionOrderI18NTests):\n \n     def setUp(self):\n@@ -716,19 +732,15 @@ def test_project_translation(self):\n     def test_project_override_app_translation(self):\n         old_installed_apps = settings.INSTALLED_APPS\n         settings.INSTALLED_APPS = list(settings.INSTALLED_APPS) + ['regressiontests.i18n.resolution']\n-        self.assertUgettext('Date/time', 'PROJECT')\n-        settings.INSTALLED_APPS = old_installed_apps\n-\n-    def test_project_override_locale_paths_translation(self):\n-        old_locale_paths = settings.LOCALE_PATHS\n-        settings.LOCALE_PATHS += (os.path.join(os.path.dirname(os.path.abspath(__file__)), 'other', 'locale'),)\n-        self.assertUgettext('Date/time', 'PROJECT')\n-        settings.LOCALE_PATHS = old_locale_paths\n+        try:\n+            self.assertUgettext('Date/time', 'PROJECT')\n+        finally:\n+            settings.INSTALLED_APPS = old_installed_apps\n \n class DjangoFallbackResolutionOrderI18NTests(ResolutionOrderI18NTests):\n \n     def test_django_fallback(self):\n-        self.assertUgettext('Date/time', 'Datum/Zeit')\n+        self.assertEqual(ugettext('Date/time'), 'Datum/Zeit')\n \n \n class TestModels(TestCase):"
        },
        {
            "sha": "c53908bf3d1a892f619b64a000892a5026bf1778",
            "filename": "tests/regressiontests/locale/de/LC_MESSAGES/django.mo",
            "status": "modified",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.mo?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32"
        },
        {
            "sha": "001b595d4d6e89a23494d6059ee7290a7da44834",
            "filename": "tests/regressiontests/locale/de/LC_MESSAGES/django.po",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocale%2Fde%2FLC_MESSAGES%2Fdjango.po?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -3,13 +3,12 @@\n # This file is distributed under the same license as the PACKAGE package.\n # FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.\n #\n-#, fuzzy\n msgid \"\"\n msgstr \"\"\n-\"Project-Id-Version: PACKAGE VERSION\\n\"\n+\"Project-Id-Version: django tests\\n\"\n \"Report-Msgid-Bugs-To: \\n\"\n \"POT-Creation-Date: 2010-02-14 17:33+0100\\n\"\n-\"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\\n\"\n+\"PO-Revision-Date: 2011-02-07 13:13-0300\\n\"\n \"Last-Translator: FULL NAME <EMAIL@ADDRESS>\\n\"\n \"Language-Team: LANGUAGE <LL@li.org>\\n\"\n \"MIME-Version: 1.0\\n\"\n@@ -18,5 +17,9 @@ msgstr \"\"\n \"Plural-Forms: nplurals=2; plural=(n != 1)\\n\"\n \n #: models.py:3\n+msgid \"Time\"\n+msgstr \"Zeit (PROJECT)\"\n+\n+#: models.py:5\n msgid \"Date/time\"\n msgstr \"Datum/Zeit (PROJECT)\""
        },
        {
            "sha": "8765fe2c06f39d2229fcf83bdbddd09bed50cb9d",
            "filename": "tests/regressiontests/views/tests/i18n.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fviews%2Ftests%2Fi18n.py",
            "raw_url": "https://github.com/django/django/raw/f6e38f3800f769b6f03799a1792b2cb1a9f42c32/tests%2Fregressiontests%2Fviews%2Ftests%2Fi18n.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fviews%2Ftests%2Fi18n.py?ref=f6e38f3800f769b6f03799a1792b2cb1a9f42c32",
            "patch": "@@ -1,5 +1,6 @@\n # -*- coding:utf-8 -*-\n import gettext\n+from os import path\n \n from django.conf import settings\n from django.test import TestCase\n@@ -150,3 +151,11 @@ def testI18NDifferentNonEnLangs(self):\n         response = self.client.get('/views/jsi18n_multi_packages2/')\n         self.assertContains(response, javascript_quote('este texto de app3 debe ser traducido'))\n         deactivate()\n+\n+    def testI18NWithLocalePaths(self):\n+        settings.LANGUAGE_CODE = 'es-ar'\n+        self.old_locale_paths = settings.LOCALE_PATHS\n+        settings.LOCALE_PATHS += (path.join(path.dirname(path.dirname(path.abspath(__file__))), 'app3', 'locale'),)\n+        response = self.client.get('/views/jsi18n/')\n+        self.assertContains(response, javascript_quote('este texto de app3 debe ser traducido'))\n+        settings.LOCALE_PATHS = self.old_locale_paths"
        }
    ],
    "stats": {
        "total": 345,
        "additions": 274,
        "deletions": 71
    }
}