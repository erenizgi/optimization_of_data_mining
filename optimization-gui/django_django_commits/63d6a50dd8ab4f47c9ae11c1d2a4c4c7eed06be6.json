{
    "author": "claudep",
    "message": "Fixed #18144 -- Added backwards compatibility with old unsalted MD5 passwords\n\nThanks apreobrazhensky at gmail.com for the report.",
    "sha": "63d6a50dd8ab4f47c9ae11c1d2a4c4c7eed06be6",
    "files": [
        {
            "sha": "188886858bff3c9062d08dd5b11ca1c009e62a4a",
            "filename": "django/contrib/auth/hashers.py",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/63d6a50dd8ab4f47c9ae11c1d2a4c4c7eed06be6/django%2Fcontrib%2Fauth%2Fhashers.py",
            "raw_url": "https://github.com/django/django/raw/63d6a50dd8ab4f47c9ae11c1d2a4c4c7eed06be6/django%2Fcontrib%2Fauth%2Fhashers.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fhashers.py?ref=63d6a50dd8ab4f47c9ae11c1d2a4c4c7eed06be6",
            "patch": "@@ -132,7 +132,8 @@ def identify_hasher(encoded):\n     get_hasher() to return hasher. Raises ValueError if\n     algorithm cannot be identified, or if hasher is not loaded.\n     \"\"\"\n-    if len(encoded) == 32 and '$' not in encoded:\n+    if ((len(encoded) == 32 and '$' not in encoded) or\n+            len(encoded) == 37 and encoded.startswith('md5$$')):\n         algorithm = 'unsalted_md5'\n     else:\n         algorithm = encoded.split('$', 1)[0]\n@@ -372,6 +373,8 @@ def encode(self, password, salt):\n         return hashlib.md5(force_bytes(password)).hexdigest()\n \n     def verify(self, password, encoded):\n+        if len(encoded) == 37 and encoded.startswith('md5$$'):\n+            encoded = encoded[5:]\n         encoded_2 = self.encode(password, '')\n         return constant_time_compare(encoded, encoded_2)\n "
        },
        {
            "sha": "d53ec1c1730581c10b655cde6602c44cec421bf7",
            "filename": "django/contrib/auth/tests/hashers.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/63d6a50dd8ab4f47c9ae11c1d2a4c4c7eed06be6/django%2Fcontrib%2Fauth%2Ftests%2Fhashers.py",
            "raw_url": "https://github.com/django/django/raw/63d6a50dd8ab4f47c9ae11c1d2a4c4c7eed06be6/django%2Fcontrib%2Fauth%2Ftests%2Fhashers.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Fhashers.py?ref=63d6a50dd8ab4f47c9ae11c1d2a4c4c7eed06be6",
            "patch": "@@ -66,6 +66,11 @@ def test_unsalted_md5(self):\n         self.assertTrue(check_password('lètmein', encoded))\n         self.assertFalse(check_password('lètmeinz', encoded))\n         self.assertEqual(identify_hasher(encoded).algorithm, \"unsalted_md5\")\n+        # Alternate unsalted syntax\n+        alt_encoded = \"md5$$%s\" % encoded\n+        self.assertTrue(is_password_usable(alt_encoded))\n+        self.assertTrue(check_password('lètmein', alt_encoded))\n+        self.assertFalse(check_password('lètmeinz', alt_encoded))\n \n     @skipUnless(crypt, \"no crypt module to generate password.\")\n     def test_crypt(self):"
        }
    ],
    "stats": {
        "total": 10,
        "additions": 9,
        "deletions": 1
    }
}