{
    "author": "ramiro",
    "message": "Improved test isolation of the admin tests and assigned custom admin sites to\nprevent test order dependant failures.\n\nThis involves introducing usage of `TestCase.urls` and implementing proper\nadmin.py modules for some of the test apps.\n\nThanks Florian Apolloner for finding the issue and contributing the patch.\n\nRefs #15294 (it solves these problems so the fix for that ticket we are going\nto commit doesn't introduce obscure and hard to reproduce test failures when\nrunning the Django test suite.)\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16856 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "7b21bfc0745f92f83a6826a3d3e58797fb74e326",
    "files": [
        {
            "sha": "9490cd54e26b9dcbfb7a9b5406534f0547e64701",
            "filename": "tests/regressiontests/admin_changelist/admin.py",
            "status": "added",
            "additions": 67,
            "deletions": 0,
            "changes": 67,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_changelist%2Fadmin.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_changelist%2Fadmin.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_changelist%2Fadmin.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -0,0 +1,67 @@\n+from django.core.paginator import Paginator\n+from django.contrib import admin\n+\n+from models import (Child, Parent, Genre, Band, Musician, Group, Quartet,\n+    Membership, ChordsMusician, ChordsBand, Invitation)\n+\n+site = admin.AdminSite(name=\"admin\")\n+\n+class CustomPaginator(Paginator):\n+    def __init__(self, queryset, page_size, orphans=0, allow_empty_first_page=True):\n+        super(CustomPaginator, self).__init__(queryset, 5, orphans=2,\n+            allow_empty_first_page=allow_empty_first_page)\n+\n+\n+class ParentAdmin(admin.ModelAdmin):\n+    list_filter = ['child__name']\n+    search_fields = ['child__name']\n+\n+\n+class ChildAdmin(admin.ModelAdmin):\n+    list_display = ['name', 'parent']\n+    list_per_page = 10\n+\n+    def queryset(self, request):\n+        return super(ChildAdmin, self).queryset(request).select_related(\"parent__name\")\n+\n+\n+class CustomPaginationAdmin(ChildAdmin):\n+    paginator = CustomPaginator\n+\n+\n+class FilteredChildAdmin(admin.ModelAdmin):\n+    list_display = ['name', 'parent']\n+    list_per_page = 10\n+\n+    def queryset(self, request):\n+        return super(FilteredChildAdmin, self).queryset(request).filter(\n+            name__contains='filtered')\n+\n+\n+class BandAdmin(admin.ModelAdmin):\n+    list_filter = ['genres']\n+\n+\n+class GroupAdmin(admin.ModelAdmin):\n+    list_filter = ['members']\n+\n+\n+class QuartetAdmin(admin.ModelAdmin):\n+    list_filter = ['members']\n+\n+\n+class ChordsBandAdmin(admin.ModelAdmin):\n+    list_filter = ['members']\n+\n+\n+class DynamicListDisplayChildAdmin(admin.ModelAdmin):\n+    list_display = ('name', 'parent')\n+\n+    def get_list_display(self, request):\n+        my_list_display = list(self.list_display)\n+        if request.user.username == 'noparents':\n+            my_list_display.remove('parent')\n+\n+        return my_list_display\n+\n+site.register(Child, DynamicListDisplayChildAdmin)"
        },
        {
            "sha": "9347dbf382b122fdc0a8e698527323464595b577",
            "filename": "tests/regressiontests/admin_changelist/tests.py",
            "status": "modified",
            "additions": 12,
            "deletions": 62,
            "changes": 74,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_changelist%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_changelist%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_changelist%2Ftests.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -3,7 +3,6 @@\n from django.contrib import admin\n from django.contrib.admin.options import IncorrectLookupParameters\n from django.contrib.admin.views.main import ChangeList, SEARCH_VAR, ALL_VAR\n-from django.core.paginator import Paginator\n from django.template import Context, Template\n from django.test import TestCase\n from django.test.client import RequestFactory\n@@ -12,8 +11,14 @@\n from models import (Child, Parent, Genre, Band, Musician, Group, Quartet,\n     Membership, ChordsMusician, ChordsBand, Invitation)\n \n+from admin import (ChildAdmin, QuartetAdmin, BandAdmin, ChordsBandAdmin,\n+    GroupAdmin, ParentAdmin, DynamicListDisplayChildAdmin, CustomPaginationAdmin,\n+    FilteredChildAdmin, CustomPaginator, site as custom_site)\n+\n \n class ChangeListTests(TestCase):\n+    urls = \"regressiontests.admin_changelist.urls\"\n+\n     def setUp(self):\n         self.factory = RequestFactory()\n \n@@ -129,11 +134,7 @@ def test_custom_paginator(self):\n             new_child = Child.objects.create(name='name %s' % i, parent=new_parent)\n \n         request = self.factory.get('/child/')\n-        m = ChildAdmin(Child, admin.site)\n-        m.list_display = ['id', 'name', 'parent']\n-        m.list_display_links = ['id']\n-        m.list_editable = ['name']\n-        m.paginator = CustomPaginator\n+        m = CustomPaginationAdmin(Child, admin.site)\n \n         cl = ChangeList(request, Child, m.list_display, m.list_display_links,\n                 m.list_filter, m.date_hierarchy, m.search_fields,\n@@ -331,7 +332,7 @@ def _mocked_authenticated_request(user):\n             return request\n \n         # Test with user 'noparents'\n-        m = DynamicListDisplayChildAdmin(Child, admin.site)\n+        m = custom_site._registry[Child]\n         request = _mocked_authenticated_request(user_noparents)\n         response = m.changelist_view(request)\n         # XXX - Calling render here to avoid ContentNotRenderedError to be\n@@ -347,8 +348,11 @@ def _mocked_authenticated_request(user):\n         response.render()\n         self.assertContains(response, 'Parent object')\n \n+        custom_site.unregister(Child)\n+\n         # Test default implementation\n-        m = ChildAdmin(Child, admin.site)\n+        custom_site.register(Child, ChildAdmin)\n+        m = custom_site._registry[Child]\n         request = _mocked_authenticated_request(user_noparents)\n         response = m.changelist_view(request)\n         # XXX - #15826\n@@ -383,57 +387,3 @@ def test_show_all(self):\n         cl.get_results(request)\n         self.assertEqual(len(cl.result_list), 10)\n \n-\n-class ParentAdmin(admin.ModelAdmin):\n-    list_filter = ['child__name']\n-    search_fields = ['child__name']\n-\n-\n-class ChildAdmin(admin.ModelAdmin):\n-    list_display = ['name', 'parent']\n-    list_per_page = 10\n-\n-    def queryset(self, request):\n-        return super(ChildAdmin, self).queryset(request).select_related(\"parent__name\")\n-\n-\n-class FilteredChildAdmin(admin.ModelAdmin):\n-    list_display = ['name', 'parent']\n-    list_per_page = 10\n-\n-    def queryset(self, request):\n-        return super(FilteredChildAdmin, self).queryset(request).filter(\n-            name__contains='filtered')\n-\n-\n-class CustomPaginator(Paginator):\n-    def __init__(self, queryset, page_size, orphans=0, allow_empty_first_page=True):\n-        super(CustomPaginator, self).__init__(queryset, 5, orphans=2,\n-            allow_empty_first_page=allow_empty_first_page)\n-\n-\n-class BandAdmin(admin.ModelAdmin):\n-    list_filter = ['genres']\n-\n-\n-class GroupAdmin(admin.ModelAdmin):\n-    list_filter = ['members']\n-\n-\n-class QuartetAdmin(admin.ModelAdmin):\n-    list_filter = ['members']\n-\n-\n-class ChordsBandAdmin(admin.ModelAdmin):\n-    list_filter = ['members']\n-\n-\n-class DynamicListDisplayChildAdmin(admin.ModelAdmin):\n-    list_display = ('name', 'parent')\n-\n-    def get_list_display(self, request):\n-        my_list_display = list(self.list_display)\n-        if request.user.username == 'noparents':\n-            my_list_display.remove('parent')\n-\n-        return my_list_display"
        },
        {
            "sha": "017a0010ae13ee3561cc21419d6c007c4db3d575",
            "filename": "tests/regressiontests/admin_changelist/urls.py",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_changelist%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_changelist%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_changelist%2Furls.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -0,0 +1,7 @@\n+from django.conf.urls import patterns, include\n+\n+import admin\n+\n+urlpatterns = patterns('',\n+    (r'^admin/', include(admin.site.urls)),\n+)"
        },
        {
            "sha": "6f8076abfa218350834f3f46f7b18c318afb223e",
            "filename": "tests/regressiontests/admin_inlines/admin.py",
            "status": "added",
            "additions": 117,
            "deletions": 0,
            "changes": 117,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_inlines%2Fadmin.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_inlines%2Fadmin.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_inlines%2Fadmin.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -0,0 +1,117 @@\n+from django.contrib import admin\n+from django import forms\n+\n+from models import *\n+\n+site = admin.AdminSite(name=\"admin\")\n+\n+\n+class BookInline(admin.TabularInline):\n+    model = Author.books.through\n+\n+\n+class AuthorAdmin(admin.ModelAdmin):\n+    inlines = [BookInline]\n+\n+\n+class InnerInline(admin.StackedInline):\n+    model = Inner\n+    can_delete = False\n+    readonly_fields = ('readonly',) # For bug #13174 tests.\n+\n+\n+class HolderAdmin(admin.ModelAdmin):\n+\n+    class Media:\n+        js = ('my_awesome_admin_scripts.js',)\n+\n+\n+class InnerInline2(admin.StackedInline):\n+    model = Inner2\n+\n+    class Media:\n+        js = ('my_awesome_inline_scripts.js',)\n+\n+\n+class InnerInline3(admin.StackedInline):\n+    model = Inner3\n+\n+    class Media:\n+        js = ('my_awesome_inline_scripts.js',)\n+\n+\n+class TitleForm(forms.ModelForm):\n+\n+    def clean(self):\n+        cleaned_data = self.cleaned_data\n+        title1 = cleaned_data.get(\"title1\")\n+        title2 = cleaned_data.get(\"title2\")\n+        if title1 != title2:\n+            raise forms.ValidationError(\"The two titles must be the same\")\n+        return cleaned_data\n+\n+\n+class TitleInline(admin.TabularInline):\n+    model = Title\n+    form = TitleForm\n+    extra = 1\n+\n+\n+class Inner4StackedInline(admin.StackedInline):\n+    model = Inner4Stacked\n+\n+\n+class Inner4TabularInline(admin.TabularInline):\n+    model = Inner4Tabular\n+\n+\n+class Holder4Admin(admin.ModelAdmin):\n+    inlines = [Inner4StackedInline, Inner4TabularInline]\n+\n+\n+class InlineWeakness(admin.TabularInline):\n+    model = ShoppingWeakness\n+    extra = 1\n+\n+\n+class QuestionInline(admin.TabularInline):\n+    model = Question\n+    readonly_fields=['call_me']\n+\n+    def call_me(self, obj):\n+        return 'Callable in QuestionInline'\n+\n+\n+class PollAdmin(admin.ModelAdmin):\n+    inlines = [QuestionInline]\n+\n+    def call_me(self, obj):\n+        return 'Callable in PollAdmin'\n+\n+\n+class ChapterInline(admin.TabularInline):\n+    model = Chapter\n+    readonly_fields=['call_me']\n+\n+    def call_me(self, obj):\n+        return 'Callable in ChapterInline'\n+\n+\n+class NovelAdmin(admin.ModelAdmin):\n+    inlines = [ChapterInline]\n+\n+\n+site.register(TitleCollection, inlines=[TitleInline])\n+# Test bug #12561 and #12778\n+# only ModelAdmin media\n+site.register(Holder, HolderAdmin, inlines=[InnerInline])\n+# ModelAdmin and Inline media\n+site.register(Holder2, HolderAdmin, inlines=[InnerInline2])\n+# only Inline media\n+site.register(Holder3, inlines=[InnerInline3])\n+\n+site.register(Poll, PollAdmin)\n+site.register(Novel, NovelAdmin)\n+site.register(Fashionista, inlines=[InlineWeakness])\n+site.register(Holder4, Holder4Admin)\n+site.register(Author, AuthorAdmin)"
        },
        {
            "sha": "f4e58f2f28048e7e0864f2a2ed7cfa5e5009ed4e",
            "filename": "tests/regressiontests/admin_inlines/models.py",
            "status": "modified",
            "additions": 5,
            "deletions": 100,
            "changes": 105,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_inlines%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_inlines%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_inlines%2Fmodels.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -3,23 +3,24 @@\n \n \"\"\"\n from django.db import models\n-from django.contrib import admin\n from django.contrib.contenttypes.models import ContentType\n from django.contrib.contenttypes import generic\n-from django import forms\n+\n \n class Parent(models.Model):\n     name = models.CharField(max_length=50)\n \n     def __unicode__(self):\n         return self.name\n \n+\n class Teacher(models.Model):\n     name = models.CharField(max_length=50)\n \n     def __unicode__(self):\n         return self.name\n \n+\n class Child(models.Model):\n     name = models.CharField(max_length=50)\n     teacher = models.ForeignKey(Teacher)\n@@ -31,20 +32,15 @@ class Child(models.Model):\n     def __unicode__(self):\n         return u'I am %s, a child of %s' % (self.name, self.parent)\n \n+\n class Book(models.Model):\n     name = models.CharField(max_length=50)\n \n+\n class Author(models.Model):\n     name = models.CharField(max_length=50)\n     books = models.ManyToManyField(Book)\n \n-class BookInline(admin.TabularInline):\n-    model = Author.books.through\n-\n-class AuthorAdmin(admin.ModelAdmin):\n-    inlines = [BookInline]\n-\n-admin.site.register(Author, AuthorAdmin)\n \n class Holder(models.Model):\n     dummy = models.IntegerField()\n@@ -56,12 +52,6 @@ class Inner(models.Model):\n     readonly = models.CharField(\"Inner readonly label\", max_length=1)\n \n \n-class InnerInline(admin.StackedInline):\n-    model = Inner\n-    can_delete = False\n-    readonly_fields = ('readonly',) # For bug #13174 tests.\n-\n-\n class Holder2(models.Model):\n     dummy = models.IntegerField()\n \n@@ -70,17 +60,6 @@ class Inner2(models.Model):\n     dummy = models.IntegerField()\n     holder = models.ForeignKey(Holder2)\n \n-class HolderAdmin(admin.ModelAdmin):\n-\n-    class Media:\n-        js = ('my_awesome_admin_scripts.js',)\n-\n-class InnerInline2(admin.StackedInline):\n-    model = Inner2\n-\n-    class Media:\n-        js = ('my_awesome_inline_scripts.js',)\n-\n class Holder3(models.Model):\n     dummy = models.IntegerField()\n \n@@ -89,21 +68,6 @@ class Inner3(models.Model):\n     dummy = models.IntegerField()\n     holder = models.ForeignKey(Holder3)\n \n-class InnerInline3(admin.StackedInline):\n-    model = Inner3\n-\n-    class Media:\n-        js = ('my_awesome_inline_scripts.js',)\n-\n-# Test bug #12561 and #12778\n-# only ModelAdmin media\n-admin.site.register(Holder, HolderAdmin, inlines=[InnerInline])\n-# ModelAdmin and Inline media\n-admin.site.register(Holder2, HolderAdmin, inlines=[InnerInline2])\n-# only Inline media\n-admin.site.register(Holder3, inlines=[InnerInline3])\n-\n-\n # Models for ticket #8190\n \n class Holder4(models.Model):\n@@ -117,17 +81,6 @@ class Inner4Tabular(models.Model):\n     dummy = models.IntegerField(help_text=\"Awesome tabular help text is awesome.\")\n     holder = models.ForeignKey(Holder4)\n \n-class Inner4StackedInline(admin.StackedInline):\n-    model = Inner4Stacked\n-\n-class Inner4TabularInline(admin.TabularInline):\n-    model = Inner4Tabular\n-\n-class Holder4Admin(admin.ModelAdmin):\n-    inlines = [Inner4StackedInline, Inner4TabularInline]\n-\n-admin.site.register(Holder4, Holder4Admin)\n-\n \n # Models for #12749\n \n@@ -145,12 +98,6 @@ class ShoppingWeakness(models.Model):\n     fashionista = models.ForeignKey(Fashionista)\n     item = models.ForeignKey(OutfitItem)\n \n-class InlineWeakness(admin.TabularInline):\n-    model = ShoppingWeakness\n-    extra = 1\n-\n-admin.site.register(Fashionista, inlines=[InlineWeakness])\n-\n # Models for #13510\n \n class TitleCollection(models.Model):\n@@ -161,23 +108,6 @@ class Title(models.Model):\n     title1 = models.CharField(max_length=100)\n     title2 = models.CharField(max_length=100)\n \n-class TitleForm(forms.ModelForm):\n-\n-    def clean(self):\n-        cleaned_data = self.cleaned_data\n-        title1 = cleaned_data.get(\"title1\")\n-        title2 = cleaned_data.get(\"title2\")\n-        if title1 != title2:\n-            raise forms.ValidationError(\"The two titles must be the same\")\n-        return cleaned_data\n-\n-class TitleInline(admin.TabularInline):\n-    model = Title\n-    form = TitleForm\n-    extra = 1\n-\n-admin.site.register(TitleCollection, inlines=[TitleInline])\n-\n # Models for #15424\n \n class Poll(models.Model):\n@@ -186,34 +116,9 @@ class Poll(models.Model):\n class Question(models.Model):\n     poll = models.ForeignKey(Poll)\n \n-class QuestionInline(admin.TabularInline):\n-    model = Question\n-    readonly_fields=['call_me']\n-\n-    def call_me(self, obj):\n-        return 'Callable in QuestionInline'\n-\n-class PollAdmin(admin.ModelAdmin):\n-    inlines = [QuestionInline]\n-\n-    def call_me(self, obj):\n-        return 'Callable in PollAdmin'\n-\n class Novel(models.Model):\n     name = models.CharField(max_length=40)\n \n class Chapter(models.Model):\n     novel = models.ForeignKey(Novel)\n \n-class ChapterInline(admin.TabularInline):\n-    model = Chapter\n-    readonly_fields=['call_me']\n-\n-    def call_me(self, obj):\n-        return 'Callable in ChapterInline'\n-\n-class NovelAdmin(admin.ModelAdmin):\n-    inlines = [ChapterInline]\n-\n-admin.site.register(Poll, PollAdmin)\n-admin.site.register(Novel, NovelAdmin)"
        },
        {
            "sha": "efa6cf6934f87a573fac5d99c910ba8e51a68f94",
            "filename": "tests/regressiontests/admin_inlines/tests.py",
            "status": "modified",
            "additions": 16,
            "deletions": 12,
            "changes": 28,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_inlines%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_inlines%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_inlines%2Ftests.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -3,18 +3,20 @@\n from django.test import TestCase\n \n # local test models\n-from models import (Holder, Inner, InnerInline, Holder2, Inner2, Holder3,\n+from models import (Holder, Inner, Holder2, Inner2, Holder3,\n     Inner3, Person, OutfitItem, Fashionista, Teacher, Parent, Child)\n+from admin import InnerInline\n \n \n class TestInline(TestCase):\n+    urls = \"regressiontests.admin_inlines.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n         holder = Holder(dummy=13)\n         holder.save()\n         Inner(dummy=42, holder=holder).save()\n-        self.change_url = '/test_admin/admin/admin_inlines/holder/%i/' % holder.id\n+        self.change_url = '/admin/admin_inlines/holder/%i/' % holder.id\n \n         result = self.client.login(username='super', password='secret')\n         self.assertEqual(result, True)\n@@ -36,13 +38,13 @@ def test_readonly_stacked_inline_label(self):\n         \"\"\"Bug #13174.\"\"\"\n         holder = Holder.objects.create(dummy=42)\n         inner = Inner.objects.create(holder=holder, dummy=42, readonly='')\n-        response = self.client.get('/test_admin/admin/admin_inlines/holder/%i/'\n+        response = self.client.get('/admin/admin_inlines/holder/%i/'\n                                    % holder.id)\n         self.assertContains(response, '<label>Inner readonly label:</label>')\n \n     def test_many_to_many_inlines(self):\n         \"Autogenerated many-to-many inlines are displayed correctly (#13407)\"\n-        response = self.client.get('/test_admin/admin/admin_inlines/author/add/')\n+        response = self.client.get('/admin/admin_inlines/author/add/')\n         # The heading for the m2m inline block uses the right text\n         self.assertContains(response, '<h2>Author-book relationships</h2>')\n         # The \"add another\" label is correct\n@@ -63,7 +65,7 @@ def test_inline_primary(self):\n             'max_weight': 0,\n             'shoppingweakness_set-0-item': item.id,\n         }\n-        response = self.client.post('/test_admin/admin/admin_inlines/fashionista/add/', data)\n+        response = self.client.post('/admin/admin_inlines/fashionista/add/', data)\n         self.assertEqual(response.status_code, 302)\n         self.assertEqual(len(Fashionista.objects.filter(person__firstname='Imelda')), 1)\n \n@@ -80,22 +82,22 @@ def test_tabular_non_field_errors(self):\n             'title_set-0-title1': 'a title',\n             'title_set-0-title2': 'a different title',\n         }\n-        response = self.client.post('/test_admin/admin/admin_inlines/titlecollection/add/', data)\n+        response = self.client.post('/admin/admin_inlines/titlecollection/add/', data)\n         # Here colspan is \"4\": two fields (title1 and title2), one hidden field and the delete checkbock.\n         self.assertContains(response, '<tr><td colspan=\"4\"><ul class=\"errorlist\"><li>The two titles must be the same</li></ul></td></tr>')\n \n     def test_no_parent_callable_lookup(self):\n         \"\"\"Admin inline `readonly_field` shouldn't invoke parent ModelAdmin callable\"\"\"\n         # Identically named callable isn't present in the parent ModelAdmin,\n         # rendering of the add view shouldn't explode\n-        response = self.client.get('/test_admin/admin/admin_inlines/novel/add/')\n+        response = self.client.get('/admin/admin_inlines/novel/add/')\n         self.assertEqual(response.status_code, 200)\n         # View should have the child inlines section\n         self.assertContains(response, '<div class=\"inline-group\" id=\"chapter_set-group\">')\n \n     def test_callable_lookup(self):\n         \"\"\"Admin inline should invoke local callable when its name is listed in readonly_fields\"\"\"\n-        response = self.client.get('/test_admin/admin/admin_inlines/poll/add/')\n+        response = self.client.get('/admin/admin_inlines/poll/add/')\n         self.assertEqual(response.status_code, 200)\n         # Add parent object view should have the child inlines section\n         self.assertContains(response, '<div class=\"inline-group\" id=\"question_set-group\">')\n@@ -109,11 +111,12 @@ def test_help_text(self):\n         using both the stacked and tabular layouts.\n         Ref #8190.\n         \"\"\"\n-        response = self.client.get('/test_admin/admin/admin_inlines/holder4/add/')\n+        response = self.client.get('/admin/admin_inlines/holder4/add/')\n         self.assertContains(response, '<p class=\"help\">Awesome stacked help text is awesome.</p>', 4)\n         self.assertContains(response, '<img src=\"/static/admin/img/icon-unknown.gif\" class=\"help help-tooltip\" width=\"10\" height=\"10\" alt=\"(Awesome tabular help text is awesome.)\" title=\"Awesome tabular help text is awesome.\" />', 1)\n \n class TestInlineMedia(TestCase):\n+    urls = \"regressiontests.admin_inlines.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -128,28 +131,29 @@ def test_inline_media_only_base(self):\n         holder = Holder(dummy=13)\n         holder.save()\n         Inner(dummy=42, holder=holder).save()\n-        change_url = '/test_admin/admin/admin_inlines/holder/%i/' % holder.id\n+        change_url = '/admin/admin_inlines/holder/%i/' % holder.id\n         response = self.client.get(change_url)\n         self.assertContains(response, 'my_awesome_admin_scripts.js')\n \n     def test_inline_media_only_inline(self):\n         holder = Holder3(dummy=13)\n         holder.save()\n         Inner3(dummy=42, holder=holder).save()\n-        change_url = '/test_admin/admin/admin_inlines/holder3/%i/' % holder.id\n+        change_url = '/admin/admin_inlines/holder3/%i/' % holder.id\n         response = self.client.get(change_url)\n         self.assertContains(response, 'my_awesome_inline_scripts.js')\n \n     def test_all_inline_media(self):\n         holder = Holder2(dummy=13)\n         holder.save()\n         Inner2(dummy=42, holder=holder).save()\n-        change_url = '/test_admin/admin/admin_inlines/holder2/%i/' % holder.id\n+        change_url = '/admin/admin_inlines/holder2/%i/' % holder.id\n         response = self.client.get(change_url)\n         self.assertContains(response, 'my_awesome_admin_scripts.js')\n         self.assertContains(response, 'my_awesome_inline_scripts.js')\n \n class TestInlineAdminForm(TestCase):\n+    urls = \"regressiontests.admin_inlines.urls\"\n \n     def test_immutable_content_type(self):\n         \"\"\"Regression for #9362"
        },
        {
            "sha": "017a0010ae13ee3561cc21419d6c007c4db3d575",
            "filename": "tests/regressiontests/admin_inlines/urls.py",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_inlines%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_inlines%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_inlines%2Furls.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -0,0 +1,7 @@\n+from django.conf.urls import patterns, include\n+\n+import admin\n+\n+urlpatterns = patterns('',\n+    (r'^admin/', include(admin.site.urls)),\n+)"
        },
        {
            "sha": "e4aae4fed9d255db77fcd6d4f02373f333dcd43b",
            "filename": "tests/regressiontests/admin_views/admin.py",
            "status": "added",
            "additions": 526,
            "deletions": 0,
            "changes": 526,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Fadmin.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Fadmin.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Fadmin.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -0,0 +1,526 @@\n+# -*- coding: utf-8 -*-\n+import datetime\n+import tempfile\n+import os\n+\n+from django.contrib import admin\n+from django.contrib.admin.views.main import ChangeList\n+from django.forms.models import BaseModelFormSet\n+from django.core.mail import EmailMessage\n+\n+from models import *\n+\n+\n+def callable_year(dt_value):\n+    return dt_value.year\n+callable_year.admin_order_field = 'date'\n+\n+\n+class ArticleInline(admin.TabularInline):\n+    model = Article\n+\n+\n+class ChapterInline(admin.TabularInline):\n+    model = Chapter\n+\n+\n+class ChapterXtra1Admin(admin.ModelAdmin):\n+    list_filter = ('chap',\n+                   'chap__title',\n+                   'chap__book',\n+                   'chap__book__name',\n+                   'chap__book__promo',\n+                   'chap__book__promo__name',)\n+\n+\n+class ArticleAdmin(admin.ModelAdmin):\n+    list_display = ('content', 'date', callable_year, 'model_year', 'modeladmin_year')\n+    list_filter = ('date', 'section')\n+\n+    def changelist_view(self, request):\n+        \"Test that extra_context works\"\n+        return super(ArticleAdmin, self).changelist_view(\n+            request, extra_context={\n+                'extra_var': 'Hello!'\n+            }\n+        )\n+\n+    def modeladmin_year(self, obj):\n+        return obj.date.year\n+    modeladmin_year.admin_order_field = 'date'\n+    modeladmin_year.short_description = None\n+\n+    def delete_model(self, request, obj):\n+        EmailMessage(\n+            'Greetings from a deleted object',\n+            'I hereby inform you that some user deleted me',\n+            'from@example.com',\n+            ['to@example.com']\n+        ).send()\n+        return super(ArticleAdmin, self).delete_model(request, obj)\n+\n+    def save_model(self, request, obj, form, change=True):\n+        EmailMessage(\n+            'Greetings from a created object',\n+            'I hereby inform you that some user created me',\n+            'from@example.com',\n+            ['to@example.com']\n+        ).send()\n+        return super(ArticleAdmin, self).save_model(request, obj, form, change)\n+\n+\n+class RowLevelChangePermissionModelAdmin(admin.ModelAdmin):\n+    def has_change_permission(self, request, obj=None):\n+        \"\"\" Only allow changing objects with even id number \"\"\"\n+        return request.user.is_staff and (obj is not None) and (obj.id % 2 == 0)\n+\n+\n+class CustomArticleAdmin(admin.ModelAdmin):\n+    \"\"\"\n+    Tests various hooks for using custom templates and contexts.\n+    \"\"\"\n+    change_list_template = 'custom_admin/change_list.html'\n+    change_form_template = 'custom_admin/change_form.html'\n+    add_form_template = 'custom_admin/add_form.html'\n+    object_history_template = 'custom_admin/object_history.html'\n+    delete_confirmation_template = 'custom_admin/delete_confirmation.html'\n+    delete_selected_confirmation_template = 'custom_admin/delete_selected_confirmation.html'\n+\n+    def changelist_view(self, request):\n+        \"Test that extra_context works\"\n+        return super(CustomArticleAdmin, self).changelist_view(\n+            request, extra_context={\n+                'extra_var': 'Hello!'\n+            }\n+        )\n+\n+\n+class ThingAdmin(admin.ModelAdmin):\n+    list_filter = ('color__warm', 'color__value')\n+\n+\n+class InquisitionAdmin(admin.ModelAdmin):\n+    list_display = ('leader', 'country', 'expected')\n+\n+\n+class SketchAdmin(admin.ModelAdmin):\n+    raw_id_fields = ('inquisition',)\n+\n+\n+class FabricAdmin(admin.ModelAdmin):\n+    list_display = ('surface',)\n+    list_filter = ('surface',)\n+\n+\n+class BasePersonModelFormSet(BaseModelFormSet):\n+    def clean(self):\n+        for person_dict in self.cleaned_data:\n+            person = person_dict.get('id')\n+            alive = person_dict.get('alive')\n+            if person and alive and person.name == \"Grace Hopper\":\n+                raise forms.ValidationError(\"Grace is not a Zombie\")\n+\n+\n+class PersonAdmin(admin.ModelAdmin):\n+    list_display = ('name', 'gender', 'alive')\n+    list_editable = ('gender', 'alive')\n+    list_filter = ('gender',)\n+    search_fields = ('^name',)\n+    save_as = True\n+\n+    def get_changelist_formset(self, request, **kwargs):\n+        return super(PersonAdmin, self).get_changelist_formset(request,\n+            formset=BasePersonModelFormSet, **kwargs)\n+\n+    def queryset(self, request):\n+        # Order by a field that isn't in list display, to be able to test\n+        # whether ordering is preserved.\n+        return super(PersonAdmin, self).queryset(request).order_by('age')\n+\n+\n+class FooAccount(Account):\n+    \"\"\"A service-specific account of type Foo.\"\"\"\n+    servicename = u'foo'\n+\n+\n+class BarAccount(Account):\n+    \"\"\"A service-specific account of type Bar.\"\"\"\n+    servicename = u'bar'\n+\n+\n+class FooAccountAdmin(admin.StackedInline):\n+    model = FooAccount\n+    extra = 1\n+\n+\n+class BarAccountAdmin(admin.StackedInline):\n+    model = BarAccount\n+    extra = 1\n+\n+\n+class PersonaAdmin(admin.ModelAdmin):\n+    inlines = (\n+        FooAccountAdmin,\n+        BarAccountAdmin\n+    )\n+\n+\n+class SubscriberAdmin(admin.ModelAdmin):\n+    actions = ['mail_admin']\n+\n+    def mail_admin(self, request, selected):\n+        EmailMessage(\n+            'Greetings from a ModelAdmin action',\n+            'This is the test email from a admin action',\n+            'from@example.com',\n+            ['to@example.com']\n+        ).send()\n+\n+\n+def external_mail(modeladmin, request, selected):\n+    EmailMessage(\n+        'Greetings from a function action',\n+        'This is the test email from a function action',\n+        'from@example.com',\n+        ['to@example.com']\n+    ).send()\n+external_mail.short_description = 'External mail (Another awesome action)'\n+\n+\n+def redirect_to(modeladmin, request, selected):\n+    from django.http import HttpResponseRedirect\n+    return HttpResponseRedirect('/some-where-else/')\n+redirect_to.short_description = 'Redirect to (Awesome action)'\n+\n+\n+class ExternalSubscriberAdmin(admin.ModelAdmin):\n+    actions = [redirect_to, external_mail]\n+\n+\n+class Podcast(Media):\n+    release_date = models.DateField()\n+\n+    class Meta:\n+        ordering = ('release_date',) # overridden in PodcastAdmin\n+\n+\n+class PodcastAdmin(admin.ModelAdmin):\n+    list_display = ('name', 'release_date')\n+    list_editable = ('release_date',)\n+    date_hierarchy = 'release_date'\n+    ordering = ('name',)\n+\n+\n+class VodcastAdmin(admin.ModelAdmin):\n+    list_display = ('name', 'released')\n+    list_editable = ('released',)\n+\n+    ordering = ('name',)\n+\n+\n+class ChildInline(admin.StackedInline):\n+    model = Child\n+\n+\n+class ParentAdmin(admin.ModelAdmin):\n+    model = Parent\n+    inlines = [ChildInline]\n+\n+    list_editable = ('name',)\n+\n+    def save_related(self, request, form, formsets, change):\n+        super(ParentAdmin, self).save_related(request, form, formsets, change)\n+        first_name, last_name = form.instance.name.split()\n+        for child in form.instance.child_set.all():\n+            if len(child.name.split()) < 2:\n+                child.name = child.name + ' ' + last_name\n+                child.save()\n+\n+\n+class EmptyModelAdmin(admin.ModelAdmin):\n+    def queryset(self, request):\n+        return super(EmptyModelAdmin, self).queryset(request).filter(pk__gt=1)\n+\n+\n+class OldSubscriberAdmin(admin.ModelAdmin):\n+    actions = None\n+\n+\n+temp_storage = FileSystemStorage(tempfile.mkdtemp())\n+UPLOAD_TO = os.path.join(temp_storage.location, 'test_upload')\n+\n+\n+class PictureInline(admin.TabularInline):\n+    model = Picture\n+    extra = 1\n+\n+\n+class GalleryAdmin(admin.ModelAdmin):\n+    inlines = [PictureInline]\n+\n+\n+class PictureAdmin(admin.ModelAdmin):\n+    pass\n+\n+\n+class LanguageAdmin(admin.ModelAdmin):\n+    list_display = ['iso', 'shortlist', 'english_name', 'name']\n+    list_editable = ['shortlist']\n+\n+\n+class RecommendationAdmin(admin.ModelAdmin):\n+    search_fields = ('=titletranslation__text', '=recommender__titletranslation__text',)\n+\n+\n+class WidgetInline(admin.StackedInline):\n+    model = Widget\n+\n+\n+class DooHickeyInline(admin.StackedInline):\n+    model = DooHickey\n+\n+\n+class GrommetInline(admin.StackedInline):\n+    model = Grommet\n+\n+\n+class WhatsitInline(admin.StackedInline):\n+    model = Whatsit\n+\n+\n+class FancyDoodadInline(admin.StackedInline):\n+    model = FancyDoodad\n+\n+\n+class CategoryAdmin(admin.ModelAdmin):\n+    list_display = ('id', 'collector', 'order')\n+    list_editable = ('order',)\n+\n+\n+class CategoryInline(admin.StackedInline):\n+    model = Category\n+\n+\n+class CollectorAdmin(admin.ModelAdmin):\n+    inlines = [\n+        WidgetInline, DooHickeyInline, GrommetInline, WhatsitInline,\n+        FancyDoodadInline, CategoryInline\n+    ]\n+\n+\n+class LinkInline(admin.TabularInline):\n+    model = Link\n+    extra = 1\n+\n+    readonly_fields = (\"posted\",)\n+\n+\n+class SubPostInline(admin.TabularInline):\n+    model = PrePopulatedSubPost\n+\n+    prepopulated_fields = {\n+        'subslug' : ('subtitle',)\n+    }\n+\n+    def get_readonly_fields(self, request, obj=None):\n+        if obj and obj.published:\n+            return ('subslug',)\n+        return self.readonly_fields\n+\n+    def get_prepopulated_fields(self, request, obj=None):\n+        if obj and obj.published:\n+            return {}\n+        return self.prepopulated_fields\n+\n+\n+class PrePopulatedPostAdmin(admin.ModelAdmin):\n+    list_display = ['title', 'slug']\n+    prepopulated_fields = {\n+        'slug' : ('title',)\n+    }\n+\n+    inlines = [SubPostInline]\n+\n+    def get_readonly_fields(self, request, obj=None):\n+        if obj and obj.published:\n+            return ('slug',)\n+        return self.readonly_fields\n+\n+    def get_prepopulated_fields(self, request, obj=None):\n+        if obj and obj.published:\n+            return {}\n+        return self.prepopulated_fields\n+\n+\n+class PostAdmin(admin.ModelAdmin):\n+    list_display = ['title', 'public']\n+    readonly_fields = ('posted', 'awesomeness_level', 'coolness', 'value', lambda obj: \"foo\")\n+\n+    inlines = [\n+        LinkInline\n+    ]\n+\n+    def coolness(self, instance):\n+        if instance.pk:\n+            return \"%d amount of cool.\" % instance.pk\n+        else:\n+            return \"Unkown coolness.\"\n+\n+    def value(self, instance):\n+        return 1000\n+    value.short_description = 'Value in $US'\n+\n+\n+class CustomChangeList(ChangeList):\n+    def get_query_set(self, request):\n+        return self.root_query_set.filter(pk=9999) # Does not exist\n+\n+\n+class GadgetAdmin(admin.ModelAdmin):\n+    def get_changelist(self, request, **kwargs):\n+        return CustomChangeList\n+\n+\n+class PizzaAdmin(admin.ModelAdmin):\n+    readonly_fields = ('toppings',)\n+\n+\n+class WorkHourAdmin(admin.ModelAdmin):\n+    list_display = ('datum', 'employee')\n+    list_filter = ('employee',)\n+\n+\n+class FoodDeliveryAdmin(admin.ModelAdmin):\n+    list_display=('reference', 'driver', 'restaurant')\n+    list_editable = ('driver', 'restaurant')\n+\n+\n+class PaperAdmin(admin.ModelAdmin):\n+    \"\"\"\n+    A ModelAdmin with a custom queryset() method that uses only(), to test\n+    verbose_name display in messages shown after adding Paper instances.\n+    \"\"\"\n+\n+    def queryset(self, request):\n+        return super(PaperAdmin, self).queryset(request).only('title')\n+\n+\n+class CoverLetterAdmin(admin.ModelAdmin):\n+    \"\"\"\n+    A ModelAdmin with a custom queryset() method that uses only(), to test\n+    verbose_name display in messages shown after adding CoverLetter instances.\n+    Note that the CoverLetter model defines a __unicode__ method.\n+    \"\"\"\n+\n+    def queryset(self, request):\n+        return super(CoverLetterAdmin, self).queryset(request).defer('date_written')\n+\n+\n+class StoryForm(forms.ModelForm):\n+    class Meta:\n+        widgets = {'title': forms.HiddenInput}\n+\n+\n+class StoryAdmin(admin.ModelAdmin):\n+    list_display = ('id', 'title', 'content')\n+    list_display_links = ('title',) # 'id' not in list_display_links\n+    list_editable = ('content', )\n+    form = StoryForm\n+    ordering = [\"-pk\"]\n+\n+\n+class OtherStoryAdmin(admin.ModelAdmin):\n+    list_display = ('id', 'title', 'content')\n+    list_display_links = ('title', 'id') # 'id' in list_display_links\n+    list_editable = ('content', )\n+    ordering = [\"-pk\"]\n+\n+\n+class ComplexSortedPersonAdmin(admin.ModelAdmin):\n+    list_display = ('name', 'age', 'is_employee', 'colored_name')\n+    ordering = ('name',)\n+\n+    def colored_name(self, obj):\n+        return '<span style=\"color: #%s;\">%s</span>' % ('ff00ff', obj.name)\n+    colored_name.allow_tags = True\n+    colored_name.admin_order_field = 'name'\n+\n+\n+class AlbumAdmin(admin.ModelAdmin):\n+    list_filter = ['title']\n+\n+\n+class WorkHourAdmin(admin.ModelAdmin):\n+    list_display = ('datum', 'employee')\n+    list_filter = ('employee',)\n+\n+\n+site = admin.AdminSite(name=\"admin\")\n+site.register(Article, ArticleAdmin)\n+site.register(CustomArticle, CustomArticleAdmin)\n+site.register(Section, save_as=True, inlines=[ArticleInline])\n+site.register(ModelWithStringPrimaryKey)\n+site.register(Color)\n+site.register(Thing, ThingAdmin)\n+site.register(Actor)\n+site.register(Inquisition, InquisitionAdmin)\n+site.register(Sketch, SketchAdmin)\n+site.register(Person, PersonAdmin)\n+site.register(Persona, PersonaAdmin)\n+site.register(Subscriber, SubscriberAdmin)\n+site.register(ExternalSubscriber, ExternalSubscriberAdmin)\n+site.register(OldSubscriber, OldSubscriberAdmin)\n+site.register(Podcast, PodcastAdmin)\n+site.register(Vodcast, VodcastAdmin)\n+site.register(Parent, ParentAdmin)\n+site.register(EmptyModel, EmptyModelAdmin)\n+site.register(Fabric, FabricAdmin)\n+site.register(Gallery, GalleryAdmin)\n+site.register(Picture, PictureAdmin)\n+site.register(Language, LanguageAdmin)\n+site.register(Recommendation, RecommendationAdmin)\n+site.register(Recommender)\n+site.register(Collector, CollectorAdmin)\n+site.register(Category, CategoryAdmin)\n+site.register(Post, PostAdmin)\n+site.register(Gadget, GadgetAdmin)\n+site.register(Villain)\n+site.register(SuperVillain)\n+site.register(Plot)\n+site.register(PlotDetails)\n+site.register(CyclicOne)\n+site.register(CyclicTwo)\n+site.register(WorkHour, WorkHourAdmin)\n+site.register(Reservation)\n+site.register(FoodDelivery, FoodDeliveryAdmin)\n+site.register(RowLevelChangePermissionModel, RowLevelChangePermissionModelAdmin)\n+site.register(Paper, PaperAdmin)\n+site.register(CoverLetter, CoverLetterAdmin)\n+site.register(Story, StoryAdmin)\n+site.register(OtherStory, OtherStoryAdmin)\n+\n+# We intentionally register Promo and ChapterXtra1 but not Chapter nor ChapterXtra2.\n+# That way we cover all four cases:\n+#     related ForeignKey object registered in admin\n+#     related ForeignKey object not registered in admin\n+#     related OneToOne object registered in admin\n+#     related OneToOne object not registered in admin\n+# when deleting Book so as exercise all four troublesome (w.r.t escaping\n+# and calling force_unicode to avoid problems on Python 2.3) paths through\n+# contrib.admin.util's get_deleted_objects function.\n+site.register(Book, inlines=[ChapterInline])\n+site.register(Promo)\n+site.register(ChapterXtra1, ChapterXtra1Admin)\n+site.register(Pizza, PizzaAdmin)\n+site.register(Topping)\n+site.register(Album, AlbumAdmin)\n+site.register(Question)\n+site.register(Answer)\n+site.register(PrePopulatedPost, PrePopulatedPostAdmin)\n+site.register(ComplexSortedPerson, ComplexSortedPersonAdmin)\n+\n+# Register core models we need in our tests\n+from django.contrib.auth.models import User, Group\n+from django.contrib.auth.admin import UserAdmin, GroupAdmin\n+site.register(User, UserAdmin)\n+site.register(Group, GroupAdmin)"
        },
        {
            "sha": "a696e9f565cb4d7e3b9a5463cee272f6ffeb444a",
            "filename": "tests/regressiontests/admin_views/customadmin.py",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Fcustomadmin.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Fcustomadmin.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Fcustomadmin.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -5,7 +5,7 @@\n from django.contrib import admin\n from django.http import HttpResponse\n \n-import models, forms\n+import models, forms, admin as base_admin\n \n class Admin2(admin.AdminSite):\n     login_form = forms.CustomAdminAuthenticationForm\n@@ -29,8 +29,8 @@ def my_view(self, request):\n \n site = Admin2(name=\"admin2\")\n \n-site.register(models.Article, models.ArticleAdmin)\n-site.register(models.Section, inlines=[models.ArticleInline])\n-site.register(models.Thing, models.ThingAdmin)\n-site.register(models.Fabric, models.FabricAdmin)\n-site.register(models.ChapterXtra1, models.ChapterXtra1Admin)\n+site.register(models.Article, base_admin.ArticleAdmin)\n+site.register(models.Section, inlines=[base_admin.ArticleInline])\n+site.register(models.Thing, base_admin.ThingAdmin)\n+site.register(models.Fabric, base_admin.FabricAdmin)\n+site.register(models.ChapterXtra1, base_admin.ChapterXtra1Admin)"
        },
        {
            "sha": "bb8d026e2613fe67a6ad8620a22151e99a132830",
            "filename": "tests/regressiontests/admin_views/models.py",
            "status": "modified",
            "additions": 43,
            "deletions": 401,
            "changes": 444,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Fmodels.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -3,24 +3,22 @@\n import tempfile\n import os\n \n-from django.contrib import admin\n from django.core.files.storage import FileSystemStorage\n-from django.contrib.admin.views.main import ChangeList\n-from django.core.mail import EmailMessage\n from django.db import models\n from django import forms\n-from django.forms.models import BaseModelFormSet\n from django.contrib.auth.models import User\n from django.contrib.contenttypes import generic\n from django.contrib.contenttypes.models import ContentType\n \n+\n class Section(models.Model):\n     \"\"\"\n     A simple section that links to articles, to test linking to related items\n     in admin views.\n     \"\"\"\n     name = models.CharField(max_length=100)\n \n+\n class Article(models.Model):\n     \"\"\"\n     A simple article to test admin views. Test backwards compatibility.\n@@ -38,6 +36,7 @@ def model_year(self):\n     model_year.admin_order_field = 'date'\n     model_year.short_description = ''\n \n+\n class Book(models.Model):\n     \"\"\"\n     A simple book that has chapters.\n@@ -47,13 +46,15 @@ class Book(models.Model):\n     def __unicode__(self):\n         return self.name\n \n+\n class Promo(models.Model):\n     name = models.CharField(max_length=100, verbose_name=u'¿Name?')\n     book = models.ForeignKey(Book)\n \n     def __unicode__(self):\n         return self.name\n \n+\n class Chapter(models.Model):\n     title = models.CharField(max_length=100, verbose_name=u'¿Title?')\n     content = models.TextField()\n@@ -66,131 +67,60 @@ class Meta:\n         # Use a utf-8 bytestring to ensure it works (see #11710)\n         verbose_name = '¿Chapter?'\n \n+\n class ChapterXtra1(models.Model):\n     chap = models.OneToOneField(Chapter, verbose_name=u'¿Chap?')\n     xtra = models.CharField(max_length=100, verbose_name=u'¿Xtra?')\n \n     def __unicode__(self):\n         return u'¿Xtra1: %s' % self.xtra\n \n+\n class ChapterXtra2(models.Model):\n     chap = models.OneToOneField(Chapter, verbose_name=u'¿Chap?')\n     xtra = models.CharField(max_length=100, verbose_name=u'¿Xtra?')\n \n     def __unicode__(self):\n         return u'¿Xtra2: %s' % self.xtra\n \n-def callable_year(dt_value):\n-    return dt_value.year\n-callable_year.admin_order_field = 'date'\n-\n-class ArticleInline(admin.TabularInline):\n-    model = Article\n-\n-class ChapterInline(admin.TabularInline):\n-    model = Chapter\n-\n-class ChapterXtra1Admin(admin.ModelAdmin):\n-    list_filter = ('chap',\n-                   'chap__title',\n-                   'chap__book',\n-                   'chap__book__name',\n-                   'chap__book__promo',\n-                   'chap__book__promo__name',)\n-\n-class ArticleAdmin(admin.ModelAdmin):\n-    list_display = ('content', 'date', callable_year, 'model_year', 'modeladmin_year')\n-    list_filter = ('date', 'section')\n-\n-    def changelist_view(self, request):\n-        \"Test that extra_context works\"\n-        return super(ArticleAdmin, self).changelist_view(\n-            request, extra_context={\n-                'extra_var': 'Hello!'\n-            }\n-        )\n-\n-    def modeladmin_year(self, obj):\n-        return obj.date.year\n-    modeladmin_year.admin_order_field = 'date'\n-    modeladmin_year.short_description = None\n-\n-    def delete_model(self, request, obj):\n-        EmailMessage(\n-            'Greetings from a deleted object',\n-            'I hereby inform you that some user deleted me',\n-            'from@example.com',\n-            ['to@example.com']\n-        ).send()\n-        return super(ArticleAdmin, self).delete_model(request, obj)\n-\n-    def save_model(self, request, obj, form, change=True):\n-        EmailMessage(\n-            'Greetings from a created object',\n-            'I hereby inform you that some user created me',\n-            'from@example.com',\n-            ['to@example.com']\n-        ).send()\n-        return super(ArticleAdmin, self).save_model(request, obj, form, change)\n \n class RowLevelChangePermissionModel(models.Model):\n     name = models.CharField(max_length=100, blank=True)\n \n-class RowLevelChangePermissionModelAdmin(admin.ModelAdmin):\n-    def has_change_permission(self, request, obj=None):\n-        \"\"\" Only allow changing objects with even id number \"\"\"\n-        return request.user.is_staff and (obj is not None) and (obj.id % 2 == 0)\n \n class CustomArticle(models.Model):\n     content = models.TextField()\n     date = models.DateTimeField()\n \n-class CustomArticleAdmin(admin.ModelAdmin):\n-    \"\"\"\n-    Tests various hooks for using custom templates and contexts.\n-    \"\"\"\n-    change_list_template = 'custom_admin/change_list.html'\n-    change_form_template = 'custom_admin/change_form.html'\n-    add_form_template = 'custom_admin/add_form.html'\n-    object_history_template = 'custom_admin/object_history.html'\n-    delete_confirmation_template = 'custom_admin/delete_confirmation.html'\n-    delete_selected_confirmation_template = 'custom_admin/delete_selected_confirmation.html'\n-\n-    def changelist_view(self, request):\n-        \"Test that extra_context works\"\n-        return super(CustomArticleAdmin, self).changelist_view(\n-            request, extra_context={\n-                'extra_var': 'Hello!'\n-            }\n-        )\n \n class ModelWithStringPrimaryKey(models.Model):\n     id = models.CharField(max_length=255, primary_key=True)\n \n     def __unicode__(self):\n         return self.id\n \n+\n class Color(models.Model):\n     value = models.CharField(max_length=10)\n     warm = models.BooleanField()\n     def __unicode__(self):\n         return self.value\n \n+\n class Thing(models.Model):\n     title = models.CharField(max_length=20)\n     color = models.ForeignKey(Color, limit_choices_to={'warm': True})\n     def __unicode__(self):\n         return self.title\n \n-class ThingAdmin(admin.ModelAdmin):\n-    list_filter = ('color__warm', 'color__value')\n \n class Actor(models.Model):\n     name = models.CharField(max_length=50)\n     age = models.IntegerField()\n     def __unicode__(self):\n         return self.name\n \n+\n class Inquisition(models.Model):\n     expected = models.BooleanField()\n     leader = models.ForeignKey(Actor)\n@@ -199,8 +129,6 @@ class Inquisition(models.Model):\n     def __unicode__(self):\n         return u\"by %s from %s\" % (self.leader, self.country)\n \n-class InquisitionAdmin(admin.ModelAdmin):\n-    list_display = ('leader', 'country', 'expected')\n \n class Sketch(models.Model):\n     title = models.CharField(max_length=100)\n@@ -212,8 +140,6 @@ class Sketch(models.Model):\n     def __unicode__(self):\n         return self.title\n \n-class SketchAdmin(admin.ModelAdmin):\n-    raw_id_fields = ('inquisition',)\n \n class Fabric(models.Model):\n     NG_CHOICES = (\n@@ -226,9 +152,6 @@ class Fabric(models.Model):\n     )\n     surface = models.CharField(max_length=20, choices=NG_CHOICES)\n \n-class FabricAdmin(admin.ModelAdmin):\n-    list_display = ('surface',)\n-    list_filter = ('surface',)\n \n class Person(models.Model):\n     GENDER_CHOICES = (\n@@ -243,30 +166,6 @@ class Person(models.Model):\n     def __unicode__(self):\n         return self.name\n \n-class BasePersonModelFormSet(BaseModelFormSet):\n-    def clean(self):\n-        for person_dict in self.cleaned_data:\n-            person = person_dict.get('id')\n-            alive = person_dict.get('alive')\n-            if person and alive and person.name == \"Grace Hopper\":\n-                raise forms.ValidationError(\"Grace is not a Zombie\")\n-\n-class PersonAdmin(admin.ModelAdmin):\n-    list_display = ('name', 'gender', 'alive')\n-    list_editable = ('gender', 'alive')\n-    list_filter = ('gender',)\n-    search_fields = ('^name',)\n-    save_as = True\n-\n-    def get_changelist_formset(self, request, **kwargs):\n-        return super(PersonAdmin, self).get_changelist_formset(request,\n-            formset=BasePersonModelFormSet, **kwargs)\n-\n-    def queryset(self, request):\n-        # Order by a field that isn't in list display, to be able to test\n-        # whether ordering is preserved.\n-        return super(PersonAdmin, self).queryset(request).order_by('age')\n-\n \n class Persona(models.Model):\n     \"\"\"\n@@ -277,6 +176,7 @@ class Persona(models.Model):\n     def __unicode__(self):\n         return self.name\n \n+\n class Account(models.Model):\n     \"\"\"\n     A simple, generic account encapsulating the information shared by all\n@@ -289,27 +189,16 @@ class Account(models.Model):\n     def __unicode__(self):\n         return \"%s: %s\" % (self.servicename, self.username)\n \n+\n class FooAccount(Account):\n     \"\"\"A service-specific account of type Foo.\"\"\"\n     servicename = u'foo'\n \n+\n class BarAccount(Account):\n     \"\"\"A service-specific account of type Bar.\"\"\"\n     servicename = u'bar'\n \n-class FooAccountAdmin(admin.StackedInline):\n-    model = FooAccount\n-    extra = 1\n-\n-class BarAccountAdmin(admin.StackedInline):\n-    model = BarAccount\n-    extra = 1\n-\n-class PersonaAdmin(admin.ModelAdmin):\n-    inlines = (\n-        FooAccountAdmin,\n-        BarAccountAdmin\n-    )\n \n class Subscriber(models.Model):\n     name = models.CharField(blank=False, max_length=80)\n@@ -318,120 +207,58 @@ class Subscriber(models.Model):\n     def __unicode__(self):\n         return \"%s (%s)\" % (self.name, self.email)\n \n-class SubscriberAdmin(admin.ModelAdmin):\n-    actions = ['mail_admin']\n-\n-    def mail_admin(self, request, selected):\n-        EmailMessage(\n-            'Greetings from a ModelAdmin action',\n-            'This is the test email from a admin action',\n-            'from@example.com',\n-            ['to@example.com']\n-        ).send()\n \n class ExternalSubscriber(Subscriber):\n     pass\n \n+\n class OldSubscriber(Subscriber):\n     pass\n \n-def external_mail(modeladmin, request, selected):\n-    EmailMessage(\n-        'Greetings from a function action',\n-        'This is the test email from a function action',\n-        'from@example.com',\n-        ['to@example.com']\n-    ).send()\n-external_mail.short_description = 'External mail (Another awesome action)'\n-\n-def redirect_to(modeladmin, request, selected):\n-    from django.http import HttpResponseRedirect\n-    return HttpResponseRedirect('/some-where-else/')\n-redirect_to.short_description = 'Redirect to (Awesome action)'\n-\n-class ExternalSubscriberAdmin(admin.ModelAdmin):\n-    actions = [redirect_to, external_mail]\n \n class Media(models.Model):\n     name = models.CharField(max_length=60)\n \n+\n class Podcast(Media):\n     release_date = models.DateField()\n \n     class Meta:\n         ordering = ('release_date',) # overridden in PodcastAdmin\n \n-class PodcastAdmin(admin.ModelAdmin):\n-    list_display = ('name', 'release_date')\n-    list_editable = ('release_date',)\n-    date_hierarchy = 'release_date'\n-    ordering = ('name',)\n \n class Vodcast(Media):\n     media = models.OneToOneField(Media, primary_key=True, parent_link=True)\n     released = models.BooleanField(default=False)\n \n-class VodcastAdmin(admin.ModelAdmin):\n-    list_display = ('name', 'released')\n-    list_editable = ('released',)\n-\n-    ordering = ('name',)\n \n class Parent(models.Model):\n     name = models.CharField(max_length=128)\n \n+\n class Child(models.Model):\n     parent = models.ForeignKey(Parent, editable=False)\n     name = models.CharField(max_length=30, blank=True)\n \n-class ChildInline(admin.StackedInline):\n-    model = Child\n-\n-class ParentAdmin(admin.ModelAdmin):\n-    model = Parent\n-    inlines = [ChildInline]\n-\n-    list_editable = ('name',)\n-\n-    def save_related(self, request, form, formsets, change):\n-        super(ParentAdmin, self).save_related(request, form, formsets, change)\n-        first_name, last_name = form.instance.name.split()\n-        for child in form.instance.child_set.all():\n-            if len(child.name.split()) < 2:\n-                child.name = child.name + ' ' + last_name\n-                child.save()\n \n class EmptyModel(models.Model):\n     def __unicode__(self):\n         return \"Primary key = %s\" % self.id\n \n-class EmptyModelAdmin(admin.ModelAdmin):\n-    def queryset(self, request):\n-        return super(EmptyModelAdmin, self).queryset(request).filter(pk__gt=1)\n-\n-class OldSubscriberAdmin(admin.ModelAdmin):\n-    actions = None\n \n temp_storage = FileSystemStorage(tempfile.mkdtemp())\n UPLOAD_TO = os.path.join(temp_storage.location, 'test_upload')\n \n+\n class Gallery(models.Model):\n     name = models.CharField(max_length=100)\n \n+\n class Picture(models.Model):\n     name = models.CharField(max_length=100)\n     image = models.FileField(storage=temp_storage, upload_to='test_upload')\n     gallery = models.ForeignKey(Gallery, related_name=\"pictures\")\n \n-class PictureInline(admin.TabularInline):\n-    model = Picture\n-    extra = 1\n-\n-class GalleryAdmin(admin.ModelAdmin):\n-    inlines = [PictureInline]\n-\n-class PictureAdmin(admin.ModelAdmin):\n-    pass\n \n class Language(models.Model):\n     iso = models.CharField(max_length=5, primary_key=True)\n@@ -442,70 +269,60 @@ class Language(models.Model):\n     class Meta:\n         ordering = ('iso',)\n \n-class LanguageAdmin(admin.ModelAdmin):\n-    list_display = ['iso', 'shortlist', 'english_name', 'name']\n-    list_editable = ['shortlist']\n \n # a base class for Recommender and Recommendation\n class Title(models.Model):\n     pass\n \n+\n class TitleTranslation(models.Model):\n     title = models.ForeignKey(Title)\n     text = models.CharField(max_length=100)\n \n+\n class Recommender(Title):\n     pass\n \n+\n class Recommendation(Title):\n     recommender = models.ForeignKey(Recommender)\n \n-class RecommendationAdmin(admin.ModelAdmin):\n-    search_fields = ('=titletranslation__text', '=recommender__titletranslation__text',)\n \n class Collector(models.Model):\n     name = models.CharField(max_length=100)\n \n+\n class Widget(models.Model):\n     owner = models.ForeignKey(Collector)\n     name = models.CharField(max_length=100)\n \n+\n class DooHickey(models.Model):\n     code = models.CharField(max_length=10, primary_key=True)\n     owner = models.ForeignKey(Collector)\n     name = models.CharField(max_length=100)\n \n+\n class Grommet(models.Model):\n     code = models.AutoField(primary_key=True)\n     owner = models.ForeignKey(Collector)\n     name = models.CharField(max_length=100)\n \n+\n class Whatsit(models.Model):\n     index = models.IntegerField(primary_key=True)\n     owner = models.ForeignKey(Collector)\n     name = models.CharField(max_length=100)\n \n+\n class Doodad(models.Model):\n     name = models.CharField(max_length=100)\n \n+\n class FancyDoodad(Doodad):\n     owner = models.ForeignKey(Collector)\n     expensive = models.BooleanField(default=True)\n \n-class WidgetInline(admin.StackedInline):\n-    model = Widget\n-\n-class DooHickeyInline(admin.StackedInline):\n-    model = DooHickey\n-\n-class GrommetInline(admin.StackedInline):\n-    model = Grommet\n-\n-class WhatsitInline(admin.StackedInline):\n-    model = Whatsit\n-\n-class FancyDoodadInline(admin.StackedInline):\n-    model = FancyDoodad\n \n class Category(models.Model):\n     collector = models.ForeignKey(Collector)\n@@ -517,18 +334,6 @@ class Meta:\n     def __unicode__(self):\n         return u'%s:o%s' % (self.id, self.order)\n \n-class CategoryAdmin(admin.ModelAdmin):\n-    list_display = ('id', 'collector', 'order')\n-    list_editable = ('order',)\n-\n-class CategoryInline(admin.StackedInline):\n-    model = Category\n-\n-class CollectorAdmin(admin.ModelAdmin):\n-    inlines = [\n-        WidgetInline, DooHickeyInline, GrommetInline, WhatsitInline,\n-        FancyDoodadInline, CategoryInline\n-    ]\n \n class Link(models.Model):\n     posted = models.DateField(\n@@ -538,57 +343,17 @@ class Link(models.Model):\n     post = models.ForeignKey(\"Post\")\n \n \n-class LinkInline(admin.TabularInline):\n-    model = Link\n-    extra = 1\n-\n-    readonly_fields = (\"posted\",)\n-\n-\n class PrePopulatedPost(models.Model):\n     title = models.CharField(max_length=100)\n     published = models.BooleanField()\n     slug = models.SlugField()\n \n+\n class PrePopulatedSubPost(models.Model):\n     post = models.ForeignKey(PrePopulatedPost)\n     subtitle = models.CharField(max_length=100)\n     subslug = models.SlugField()\n \n-class SubPostInline(admin.TabularInline):\n-    model = PrePopulatedSubPost\n-\n-    prepopulated_fields = {\n-        'subslug' : ('subtitle',)\n-    }\n-\n-    def get_readonly_fields(self, request, obj=None):\n-        if obj and obj.published:\n-            return ('subslug',)\n-        return self.readonly_fields\n-\n-    def get_prepopulated_fields(self, request, obj=None):\n-        if obj and obj.published:\n-            return {}\n-        return self.prepopulated_fields\n-\n-class PrePopulatedPostAdmin(admin.ModelAdmin):\n-    list_display = ['title', 'slug']\n-    prepopulated_fields = {\n-        'slug' : ('title',)\n-    }\n-\n-    inlines = [SubPostInline]\n-\n-    def get_readonly_fields(self, request, obj=None):\n-        if obj and obj.published:\n-            return ('slug',)\n-        return self.readonly_fields\n-\n-    def get_prepopulated_fields(self, request, obj=None):\n-        if obj and obj.published:\n-            return {}\n-        return self.prepopulated_fields\n \n class Post(models.Model):\n     title = models.CharField(max_length=100, help_text=\"Some help text for the title (with unicode ŠĐĆŽćžšđ)\")\n@@ -602,47 +367,25 @@ class Post(models.Model):\n     def awesomeness_level(self):\n         return \"Very awesome.\"\n \n-class PostAdmin(admin.ModelAdmin):\n-    list_display = ['title', 'public']\n-    readonly_fields = ('posted', 'awesomeness_level', 'coolness', 'value', lambda obj: \"foo\")\n-\n-    inlines = [\n-        LinkInline\n-    ]\n-\n-    def coolness(self, instance):\n-        if instance.pk:\n-            return \"%d amount of cool.\" % instance.pk\n-        else:\n-            return \"Unkown coolness.\"\n-\n-    def value(self, instance):\n-        return 1000\n-    value.short_description = 'Value in $US'\n \n class Gadget(models.Model):\n     name = models.CharField(max_length=100)\n \n     def __unicode__(self):\n         return self.name\n \n-class CustomChangeList(ChangeList):\n-    def get_query_set(self, request):\n-        return self.root_query_set.filter(pk=9999) # Does not exist\n-\n-class GadgetAdmin(admin.ModelAdmin):\n-    def get_changelist(self, request, **kwargs):\n-        return CustomChangeList\n \n class Villain(models.Model):\n     name = models.CharField(max_length=100)\n \n     def __unicode__(self):\n         return self.name\n \n+\n class SuperVillain(Villain):\n     pass\n \n+\n class FunkyTag(models.Model):\n     \"Because we all know there's only one real use case for GFKs.\"\n     name = models.CharField(max_length=25)\n@@ -653,6 +396,7 @@ class FunkyTag(models.Model):\n     def __unicode__(self):\n         return self.name\n \n+\n class Plot(models.Model):\n     name = models.CharField(max_length=100)\n     team_leader = models.ForeignKey(Villain, related_name='lead_plots')\n@@ -662,13 +406,15 @@ class Plot(models.Model):\n     def __unicode__(self):\n         return self.name\n \n+\n class PlotDetails(models.Model):\n     details = models.CharField(max_length=100)\n     plot = models.OneToOneField(Plot)\n \n     def __unicode__(self):\n         return self.details\n \n+\n class SecretHideout(models.Model):\n     \"\"\" Secret! Not registered with the admin! \"\"\"\n     location = models.CharField(max_length=100)\n@@ -677,6 +423,7 @@ class SecretHideout(models.Model):\n     def __unicode__(self):\n         return self.location\n \n+\n class SuperSecretHideout(models.Model):\n     \"\"\" Secret! Not registered with the admin! \"\"\"\n     location = models.CharField(max_length=100)\n@@ -685,58 +432,58 @@ class SuperSecretHideout(models.Model):\n     def __unicode__(self):\n         return self.location\n \n+\n class CyclicOne(models.Model):\n     name = models.CharField(max_length=25)\n     two = models.ForeignKey('CyclicTwo')\n \n     def __unicode__(self):\n         return self.name\n \n+\n class CyclicTwo(models.Model):\n     name = models.CharField(max_length=25)\n     one = models.ForeignKey(CyclicOne)\n \n     def __unicode__(self):\n         return self.name\n \n+\n class Topping(models.Model):\n     name = models.CharField(max_length=20)\n \n+\n class Pizza(models.Model):\n     name = models.CharField(max_length=20)\n     toppings = models.ManyToManyField('Topping')\n \n-class PizzaAdmin(admin.ModelAdmin):\n-    readonly_fields = ('toppings',)\n \n class Album(models.Model):\n     owner = models.ForeignKey(User)\n     title = models.CharField(max_length=30)\n \n-class AlbumAdmin(admin.ModelAdmin):\n-    list_filter = ['title']\n \n class Employee(Person):\n     code = models.CharField(max_length=20)\n \n+\n class WorkHour(models.Model):\n     datum = models.DateField()\n     employee = models.ForeignKey(Employee)\n \n-class WorkHourAdmin(admin.ModelAdmin):\n-    list_display = ('datum', 'employee')\n-    list_filter = ('employee',)\n \n class Question(models.Model):\n     question = models.CharField(max_length=20)\n \n+\n class Answer(models.Model):\n     question = models.ForeignKey(Question, on_delete=models.PROTECT)\n     answer = models.CharField(max_length=20)\n \n     def __unicode__(self):\n         return self.answer\n \n+\n class Reservation(models.Model):\n     start_date = models.DateTimeField()\n     price = models.IntegerField()\n@@ -753,6 +500,7 @@ class Reservation(models.Model):\n     (u'pizza', u'Pizza Mama'),\n )\n \n+\n class FoodDelivery(models.Model):\n     reference = models.CharField(max_length=100)\n     driver = models.CharField(max_length=100, choices=DRIVER_CHOICES, blank=True)\n@@ -761,138 +509,32 @@ class FoodDelivery(models.Model):\n     class Meta:\n         unique_together = ((\"driver\", \"restaurant\"),)\n \n-class FoodDeliveryAdmin(admin.ModelAdmin):\n-    list_display=('reference', 'driver', 'restaurant')\n-    list_editable = ('driver', 'restaurant')\n \n class Paper(models.Model):\n     title = models.CharField(max_length=30)\n     author = models.CharField(max_length=30, blank=True, null=True)\n \n+\n class CoverLetter(models.Model):\n     author = models.CharField(max_length=30)\n     date_written = models.DateField(null=True, blank=True)\n \n     def __unicode__(self):\n         return self.author\n \n-class PaperAdmin(admin.ModelAdmin):\n-    \"\"\"\n-    A ModelAdin with a custom queryset() method that uses only(), to test\n-    verbose_name display in messages shown after adding Paper instances.\n-    \"\"\"\n-\n-    def queryset(self, request):\n-        return super(PaperAdmin, self).queryset(request).only('title')\n-\n-class CoverLetterAdmin(admin.ModelAdmin):\n-    \"\"\"\n-    A ModelAdin with a custom queryset() method that uses only(), to test\n-    verbose_name display in messages shown after adding CoverLetter instances.\n-    Note that the CoverLetter model defines a __unicode__ method.\n-    \"\"\"\n-\n-    def queryset(self, request):\n-        return super(CoverLetterAdmin, self).queryset(request).defer('date_written')\n \n class Story(models.Model):\n     title = models.CharField(max_length=100)\n     content = models.TextField()\n \n-class StoryForm(forms.ModelForm):\n-    class Meta:\n-        widgets = {'title': forms.HiddenInput}\n-\n-class StoryAdmin(admin.ModelAdmin):\n-    list_display = ('id', 'title', 'content')\n-    list_display_links = ('title',) # 'id' not in list_display_links\n-    list_editable = ('content', )\n-    form = StoryForm\n-    ordering = [\"-pk\"]\n \n class OtherStory(models.Model):\n     title = models.CharField(max_length=100)\n     content = models.TextField()\n \n-class OtherStoryAdmin(admin.ModelAdmin):\n-    list_display = ('id', 'title', 'content')\n-    list_display_links = ('title', 'id') # 'id' in list_display_links\n-    list_editable = ('content', )\n-    ordering = [\"-pk\"]\n \n class ComplexSortedPerson(models.Model):\n     name = models.CharField(max_length=100)\n     age = models.PositiveIntegerField()\n     is_employee = models.NullBooleanField()\n \n-class ComplexSortedPersonAdmin(admin.ModelAdmin):\n-    list_display = ('name', 'age', 'is_employee', 'colored_name')\n-    ordering = ('name',)\n-\n-    def colored_name(self, obj):\n-        return '<span style=\"color: #%s;\">%s</span>' % ('ff00ff', obj.name)\n-    colored_name.allow_tags = True\n-    colored_name.admin_order_field = 'name'\n-\n-admin.site.register(Article, ArticleAdmin)\n-admin.site.register(CustomArticle, CustomArticleAdmin)\n-admin.site.register(Section, save_as=True, inlines=[ArticleInline])\n-admin.site.register(ModelWithStringPrimaryKey)\n-admin.site.register(Color)\n-admin.site.register(Thing, ThingAdmin)\n-admin.site.register(Actor)\n-admin.site.register(Inquisition, InquisitionAdmin)\n-admin.site.register(Sketch, SketchAdmin)\n-admin.site.register(Person, PersonAdmin)\n-admin.site.register(Persona, PersonaAdmin)\n-admin.site.register(Subscriber, SubscriberAdmin)\n-admin.site.register(ExternalSubscriber, ExternalSubscriberAdmin)\n-admin.site.register(OldSubscriber, OldSubscriberAdmin)\n-admin.site.register(Podcast, PodcastAdmin)\n-admin.site.register(Vodcast, VodcastAdmin)\n-admin.site.register(Parent, ParentAdmin)\n-admin.site.register(EmptyModel, EmptyModelAdmin)\n-admin.site.register(Fabric, FabricAdmin)\n-admin.site.register(Gallery, GalleryAdmin)\n-admin.site.register(Picture, PictureAdmin)\n-admin.site.register(Language, LanguageAdmin)\n-admin.site.register(Recommendation, RecommendationAdmin)\n-admin.site.register(Recommender)\n-admin.site.register(Collector, CollectorAdmin)\n-admin.site.register(Category, CategoryAdmin)\n-admin.site.register(Post, PostAdmin)\n-admin.site.register(Gadget, GadgetAdmin)\n-admin.site.register(Villain)\n-admin.site.register(SuperVillain)\n-admin.site.register(Plot)\n-admin.site.register(PlotDetails)\n-admin.site.register(CyclicOne)\n-admin.site.register(CyclicTwo)\n-admin.site.register(WorkHour, WorkHourAdmin)\n-admin.site.register(Reservation)\n-admin.site.register(FoodDelivery, FoodDeliveryAdmin)\n-admin.site.register(RowLevelChangePermissionModel, RowLevelChangePermissionModelAdmin)\n-admin.site.register(Paper, PaperAdmin)\n-admin.site.register(CoverLetter, CoverLetterAdmin)\n-admin.site.register(Story, StoryAdmin)\n-admin.site.register(OtherStory, OtherStoryAdmin)\n-\n-# We intentionally register Promo and ChapterXtra1 but not Chapter nor ChapterXtra2.\n-# That way we cover all four cases:\n-#     related ForeignKey object registered in admin\n-#     related ForeignKey object not registered in admin\n-#     related OneToOne object registered in admin\n-#     related OneToOne object not registered in admin\n-# when deleting Book so as exercise all four troublesome (w.r.t escaping\n-# and calling force_unicode to avoid problems on Python 2.3) paths through\n-# contrib.admin.util's get_deleted_objects function.\n-admin.site.register(Book, inlines=[ChapterInline])\n-admin.site.register(Promo)\n-admin.site.register(ChapterXtra1, ChapterXtra1Admin)\n-admin.site.register(Pizza, PizzaAdmin)\n-admin.site.register(Topping)\n-admin.site.register(Album, AlbumAdmin)\n-admin.site.register(Question)\n-admin.site.register(Answer)\n-admin.site.register(PrePopulatedPost, PrePopulatedPostAdmin)\n-admin.site.register(ComplexSortedPerson, ComplexSortedPersonAdmin)"
        },
        {
            "sha": "668c71076e09da12522ff41dca78c0b1f260a4a4",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 32,
            "deletions": 2,
            "changes": 34,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -32,7 +32,7 @@\n \n # local test models\n from models import (Article, BarAccount, CustomArticle, EmptyModel,\n-    FooAccount, Gallery, PersonAdmin, ModelWithStringPrimaryKey,\n+    FooAccount, Gallery, ModelWithStringPrimaryKey,\n     Person, Persona, Picture, Podcast, Section, Subscriber, Vodcast,\n     Language, Collector, Widget, Grommet, DooHickey, FancyDoodad, Whatsit,\n     Category, Post, Plot, FunkyTag, Chapter, Book, Promo, WorkHour, Employee,\n@@ -50,6 +50,8 @@ class AdminViewBasicTest(TestCase):\n     # this test case and changing urlbit.\n     urlbit = 'admin'\n \n+    urls = \"regressiontests.admin_views.urls\"\n+\n     def setUp(self):\n         self.old_USE_I18N = settings.USE_I18N\n         self.old_USE_L10N = settings.USE_L10N\n@@ -301,7 +303,7 @@ def testChangeListSortingModelMeta(self):\n             response.content.index(link % l1.pk) < response.content.index(link % l2.pk)\n         )\n \n-    def testChangeListSortingModelAdmin(self):\n+    def testChangeListSortingOverrideModelAdmin(self):\n         # Test ordering on Model Admin is respected, and overrides Model Meta\n         dt = datetime.datetime.now()\n         p1 = Podcast.objects.create(name=\"A\", release_date=dt)\n@@ -542,6 +544,8 @@ def test_allowed_filtering_15103(self):\n             self.fail(\"Filters should be allowed if they are defined on a ForeignKey pointing to this model\")\n \n class AdminJavaScriptTest(AdminViewBasicTest):\n+    urls = \"regressiontests.admin_views.urls\"\n+\n     def testSingleWidgetFirsFieldFocus(self):\n         \"\"\"\n         JavaScript-assisted auto-focus on first field.\n@@ -565,6 +569,7 @@ def testMultiWidgetFirsFieldFocus(self):\n \n \n class SaveAsTests(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml','admin-views-person.xml']\n \n     def setUp(self):\n@@ -593,6 +598,7 @@ def test_save_as_display(self):\n         self.assertEqual(response.context['form_url'], '../add/')\n \n class CustomModelAdminTest(AdminViewBasicTest):\n+    urls = \"regressiontests.admin_views.urls\"\n     urlbit = \"admin2\"\n \n     def testCustomAdminSiteLoginForm(self):\n@@ -654,6 +660,7 @@ def get_perm(Model, perm):\n class AdminViewPermissionsTest(TestCase):\n     \"\"\"Tests for Admin Views Permissions.\"\"\"\n \n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -1055,6 +1062,7 @@ def testDisabledPermissionsWhenLoggedIn(self):\n \n \n class AdminViewDeletedObjectsTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml', 'deleted-objects.xml']\n \n     def setUp(self):\n@@ -1170,6 +1178,7 @@ def test_generic_relations(self):\n         self.assertContains(response, should_contain)\n \n class AdminViewStringPrimaryKeyTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml', 'string-primary-key.xml']\n \n     def __init__(self, *args):\n@@ -1261,6 +1270,7 @@ def test_url_conflicts_with_history(self):\n \n \n class SecureViewTests(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -1418,6 +1428,7 @@ def test_shortcut_view_only_available_to_staff(self):\n         self.assertEqual(response['Location'], 'http://example.com/users/super/')\n \n class AdminViewUnicodeTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-unicode.xml']\n \n     def setUp(self):\n@@ -1471,6 +1482,7 @@ def testUnicodeDelete(self):\n \n \n class AdminViewListEditable(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml', 'admin-views-person.xml']\n \n     def setUp(self):\n@@ -1827,6 +1839,7 @@ def test_pk_hidden_fields_with_list_display_links(self):\n \n \n class AdminSearchTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users', 'multiple-child-classes',\n                 'admin-views-person']\n \n@@ -1873,6 +1886,7 @@ def test_beginning_matches(self):\n \n \n class AdminInheritedInlinesTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml',]\n \n     def setUp(self):\n@@ -1958,6 +1972,7 @@ def testInline(self):\n         self.assertEqual(Persona.objects.all()[0].accounts.count(), 2)\n \n class AdminActionsTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml', 'admin-views-actions.xml']\n \n     def setUp(self):\n@@ -2179,6 +2194,7 @@ def test_popup_actions(self):\n \n \n class TestCustomChangeList(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n     urlbit = 'admin'\n \n@@ -2206,6 +2222,7 @@ def test_custom_changelist(self):\n \n \n class TestInlineNotEditable(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -2223,6 +2240,7 @@ def test(self):\n         self.assertEqual(response.status_code, 200)\n \n class AdminCustomQuerysetTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -2277,6 +2295,7 @@ def test_add_model_modeladmin_only_qs(self):\n         self.assertContains(response, '<li class=\"info\">The cover letter &quot;John Doe II&quot; was changed successfully.</li>')\n \n class AdminInlineFileUploadTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml', 'admin-views-actions.xml']\n     urlbit = 'admin'\n \n@@ -2322,6 +2341,7 @@ def test_inline_file_upload_edit_validation_error_post(self):\n \n \n class AdminInlineTests(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -2639,6 +2659,7 @@ def test_ordered_inline(self):\n \n \n class NeverCacheTests(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml', 'admin-views-colors.xml', 'admin-views-fabrics.xml']\n \n     def setUp(self):\n@@ -2711,6 +2732,7 @@ def testJsi18n(self):\n \n \n class PrePopulatedTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -2735,6 +2757,7 @@ def test_prepopulated_off(self):\n         self.assertNotContains(response, \"id: '#id_prepopulatedsubpost_set-0-subslug',\")\n \n class ReadonlyTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -2802,6 +2825,7 @@ def test_readonly_manytomany(self):\n \n \n class RawIdFieldsTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -2837,6 +2861,7 @@ class UserAdminTest(TestCase):\n     \"\"\"\n     Tests user CRUD functionality.\n     \"\"\"\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -2928,6 +2953,7 @@ class GroupAdminTest(TestCase):\n     \"\"\"\n     Tests group CRUD functionality.\n     \"\"\"\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -2961,6 +2987,7 @@ def test_group_permission_performance(self):\n \n #@unittest.skipUnless(docutils, \"no docutils installed.\")\n class AdminDocsTest(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -3003,6 +3030,7 @@ def test_filters(self):\n AdminDocsTest = unittest.skipUnless(docutils, \"no docutils installed.\")(AdminDocsTest)\n \n class ValidXHTMLTests(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n     urlbit = 'admin'\n \n@@ -3033,6 +3061,7 @@ def testLangNamePresent(self):\n \n \n class DateHierarchyTests(TestCase):\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):\n@@ -3162,6 +3191,7 @@ class AdminCustomSaveRelatedTests(TestCase):\n     Ensure that one can easily customize the way related objects are saved.\n     Refs #16115.\n     \"\"\"\n+    urls = \"regressiontests.admin_views.urls\"\n     fixtures = ['admin-views-users.xml']\n \n     def setUp(self):"
        },
        {
            "sha": "e436665d6d7b799705da2f3f17db2f62e657543c",
            "filename": "tests/regressiontests/admin_views/urls.py",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fadmin_views%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Furls.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -1,11 +1,11 @@\n from django.conf.urls import patterns, include\n-from django.contrib import admin\n import views\n import customadmin\n+import admin\n \n urlpatterns = patterns('',\n-    (r'^admin/doc/', include('django.contrib.admindocs.urls')),\n-    (r'^admin/secure-view/$', views.secure_view),\n-    (r'^admin/', include(admin.site.urls)),\n-    (r'^admin2/', include(customadmin.site.urls)),\n+    (r'^test_admin/admin/doc/', include('django.contrib.admindocs.urls')),\n+    (r'^test_admin/admin/secure-view/$', views.secure_view),\n+    (r'^test_admin/admin/', include(admin.site.urls)),\n+    (r'^test_admin/admin2/', include(customadmin.site.urls)),\n )"
        },
        {
            "sha": "07bcab7fbc56d161bc46aadb24daf18df716050b",
            "filename": "tests/regressiontests/cache/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fcache%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fcache%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fcache%2Ftests.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -1591,6 +1591,8 @@ def test_with_etag(self):\n \n class TestEtagWithAdmin(TestCase):\n     # See https://code.djangoproject.com/ticket/16003\n+    urls = \"regressiontests.admin_views.urls\"\n+\n     def test_admin(self):\n         with self.settings(USE_ETAGS=False):\n             response = self.client.get('/test_admin/admin/')"
        },
        {
            "sha": "87224edab7beec03ce35c226b878d9ca2f46daf9",
            "filename": "tests/regressiontests/generic_inline_admin/admin.py",
            "status": "added",
            "additions": 44,
            "deletions": 0,
            "changes": 44,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fgeneric_inline_admin%2Fadmin.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fgeneric_inline_admin%2Fadmin.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_inline_admin%2Fadmin.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -0,0 +1,44 @@\n+from django.contrib import admin\n+from django.contrib.contenttypes import generic\n+\n+from models import (Media, PhoneNumber, Episode, EpisodeExtra, Contact,\n+    Category, EpisodePermanent, EpisodeMaxNum)\n+\n+site = admin.AdminSite(name=\"admin\")\n+\n+class MediaInline(generic.GenericTabularInline):\n+    model = Media\n+\n+\n+class EpisodeAdmin(admin.ModelAdmin):\n+    inlines = [\n+        MediaInline,\n+    ]\n+\n+\n+class MediaExtraInline(generic.GenericTabularInline):\n+    model = Media\n+    extra = 0\n+\n+\n+class MediaMaxNumInline(generic.GenericTabularInline):\n+    model = Media\n+    extra = 5\n+    max_num = 2\n+\n+\n+class PhoneNumberInline(generic.GenericTabularInline):\n+    model = PhoneNumber\n+\n+\n+class MediaPermanentInline(generic.GenericTabularInline):\n+    model = Media\n+    can_delete = False\n+\n+\n+site.register(Episode, EpisodeAdmin)\n+site.register(EpisodeExtra, inlines=[MediaExtraInline])\n+site.register(EpisodeMaxNum, inlines=[MediaMaxNumInline])\n+site.register(Contact, inlines=[PhoneNumberInline])\n+site.register(Category)\n+site.register(EpisodePermanent, inlines=[MediaPermanentInline])"
        },
        {
            "sha": "e78f110416fabc54538205d0685897e7510cd4c9",
            "filename": "tests/regressiontests/generic_inline_admin/models.py",
            "status": "modified",
            "additions": 4,
            "deletions": 35,
            "changes": 39,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fgeneric_inline_admin%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fgeneric_inline_admin%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_inline_admin%2Fmodels.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -1,13 +1,14 @@\n from django.db import models\n-from django.contrib import admin\n from django.contrib.contenttypes import generic\n from django.contrib.contenttypes.models import ContentType\n \n+\n class Episode(models.Model):\n     name = models.CharField(max_length=100)\n     length = models.CharField(max_length=100, blank=True)\n     author = models.CharField(max_length=100, blank=True)\n \n+\n class Media(models.Model):\n     \"\"\"\n     Media that can associated to any object.\n@@ -22,15 +23,6 @@ class Media(models.Model):\n     def __unicode__(self):\n         return self.url\n \n-class MediaInline(generic.GenericTabularInline):\n-    model = Media\n-\n-class EpisodeAdmin(admin.ModelAdmin):\n-    inlines = [\n-        MediaInline,\n-    ]\n-admin.site.register(Episode, EpisodeAdmin)\n-\n #\n # These models let us test the different GenericInline settings at\n # different urls in the admin site.\n@@ -43,34 +35,21 @@ class EpisodeAdmin(admin.ModelAdmin):\n class EpisodeExtra(Episode):\n     pass\n \n-class MediaExtraInline(generic.GenericTabularInline):\n-    model = Media\n-    extra = 0\n-\n-admin.site.register(EpisodeExtra, inlines=[MediaExtraInline])\n \n #\n # Generic inline with extra and max_num\n #\n-\n class EpisodeMaxNum(Episode):\n     pass\n \n-class MediaMaxNumInline(generic.GenericTabularInline):\n-    model = Media\n-    extra = 5\n-    max_num = 2\n-\n-admin.site.register(EpisodeMaxNum, inlines=[MediaMaxNumInline])\n-\n \n #\n # Generic inline with unique_together\n #\n-\n class Category(models.Model):\n     name = models.CharField(max_length=50)\n \n+\n class PhoneNumber(models.Model):\n     content_type = models.ForeignKey(ContentType)\n     object_id = models.PositiveIntegerField()\n@@ -81,25 +60,15 @@ class PhoneNumber(models.Model):\n     class Meta:\n         unique_together = (('content_type', 'object_id', 'phone_number',),)\n \n+\n class Contact(models.Model):\n     name = models.CharField(max_length=50)\n     phone_numbers = generic.GenericRelation(PhoneNumber)\n \n-class PhoneNumberInline(generic.GenericTabularInline):\n-    model = PhoneNumber\n-\n-admin.site.register(Contact, inlines=[PhoneNumberInline])\n-admin.site.register(Category)\n-\n #\n # Generic inline with can_delete=False\n #\n-\n class EpisodePermanent(Episode):\n     pass\n \n-class MediaPermanentInline(generic.GenericTabularInline):\n-    model = Media\n-    can_delete = False\n \n-admin.site.register(EpisodePermanent, inlines=[MediaPermanentInline])"
        },
        {
            "sha": "858d6a5f3bb1f9f446e9bec607a74bb89b430d7a",
            "filename": "tests/regressiontests/generic_inline_admin/tests.py",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fgeneric_inline_admin%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fgeneric_inline_admin%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_inline_admin%2Ftests.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -10,10 +10,12 @@\n \n # local test models\n from models import (Episode, EpisodeExtra, EpisodeMaxNum, Media,\n-    MediaInline, EpisodePermanent, MediaPermanentInline, Category)\n+    EpisodePermanent, Category)\n+from admin import MediaInline, MediaPermanentInline\n \n \n class GenericAdminViewTest(TestCase):\n+    urls = \"regressiontests.generic_inline_admin.urls\"\n     fixtures = ['users.xml']\n \n     def setUp(self):\n@@ -125,6 +127,7 @@ def testGenericInlineFormsetFactory(self):\n         self.assertTrue(formset.get_queryset().ordered)\n \n class GenericInlineAdminParametersTest(TestCase):\n+    urls = \"regressiontests.generic_inline_admin.urls\"\n     fixtures = ['users.xml']\n \n     def setUp(self):\n@@ -177,6 +180,7 @@ def testMaxNumParam(self):\n \n \n class GenericInlineAdminWithUniqueTogetherTest(TestCase):\n+    urls = \"regressiontests.generic_inline_admin.urls\"\n     fixtures = ['users.xml']\n \n     def setUp(self):\n@@ -203,6 +207,8 @@ def testAdd(self):\n         self.assertEqual(response.status_code, 302) # redirect somewhere\n \n class NoInlineDeletionTest(TestCase):\n+    urls = \"regressiontests.generic_inline_admin.urls\"\n+\n     def test_no_deletion(self):\n         fake_site = object()\n         inline = MediaPermanentInline(EpisodePermanent, fake_site)\n@@ -211,6 +217,7 @@ def test_no_deletion(self):\n         self.assertFalse(formset.can_delete)\n \n class GenericInlineModelAdminTest(TestCase):\n+    urls = \"regressiontests.generic_inline_admin.urls\"\n \n     def setUp(self):\n         self.site = AdminSite()"
        },
        {
            "sha": "03431d32264cb051ffca1af4373655708bab4233",
            "filename": "tests/regressiontests/generic_inline_admin/urls.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fgeneric_inline_admin%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Fregressiontests%2Fgeneric_inline_admin%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_inline_admin%2Furls.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -1,6 +1,7 @@\n from django.conf.urls import patterns, include\n-from django.contrib import admin\n+\n+import admin\n \n urlpatterns = patterns('',\n-    (r'^admin/', include(admin.site.urls)),\n+    (r'^generic_inline_admin/admin/', include(admin.site.urls)),\n )"
        },
        {
            "sha": "044395039d9e9f4fed4cebd6aeeded565c5251c6",
            "filename": "tests/urls.py",
            "status": "modified",
            "additions": 0,
            "deletions": 4,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/7b21bfc0745f92f83a6826a3d3e58797fb74e326/tests%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Furls.py?ref=7b21bfc0745f92f83a6826a3d3e58797fb74e326",
            "patch": "@@ -22,10 +22,6 @@\n     # test urlconf for middleware tests\n     (r'^middleware/', include('regressiontests.middleware.urls')),\n \n-    # admin view tests\n-    (r'^test_admin/', include('regressiontests.admin_views.urls')),\n-    (r'^generic_inline_admin/', include('regressiontests.generic_inline_admin.urls')),\n-\n     # admin widget tests\n     (r'widget_admin/', include('regressiontests.admin_widgets.urls')),\n "
        }
    ],
    "stats": {
        "total": 1534,
        "additions": 904,
        "deletions": 630
    }
}