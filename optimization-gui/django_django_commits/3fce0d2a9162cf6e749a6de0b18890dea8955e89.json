{
    "author": "DrMeers",
    "message": "Fixed #18063 -- Avoid unicode in Model.__repr__ in python 2\n\nThanks guettli and mrmachine.",
    "sha": "3fce0d2a9162cf6e749a6de0b18890dea8955e89",
    "files": [
        {
            "sha": "d7a993238816faeb97a4426d31dbe6759e29506d",
            "filename": "django/db/models/base.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/3fce0d2a9162cf6e749a6de0b18890dea8955e89/django%2Fdb%2Fmodels%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/3fce0d2a9162cf6e749a6de0b18890dea8955e89/django%2Fdb%2Fmodels%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fbase.py?ref=3fce0d2a9162cf6e749a6de0b18890dea8955e89",
            "patch": "@@ -404,6 +404,8 @@ def __repr__(self):\n             u = six.text_type(self)\n         except (UnicodeEncodeError, UnicodeDecodeError):\n             u = '[Bad Unicode data]'\n+        if not six.PY3:\n+            u = u.encode('ascii', 'replace')\n         return smart_str('<%s: %s>' % (self.__class__.__name__, u))\n \n     def __str__(self):"
        },
        {
            "sha": "6a03b861e43cbe69bf0bf9fd5dbaad1b05491b81",
            "filename": "tests/regressiontests/model_regress/tests.py",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/3fce0d2a9162cf6e749a6de0b18890dea8955e89/tests%2Fregressiontests%2Fmodel_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/3fce0d2a9162cf6e749a6de0b18890dea8955e89/tests%2Fregressiontests%2Fmodel_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmodel_regress%2Ftests.py?ref=3fce0d2a9162cf6e749a6de0b18890dea8955e89",
            "patch": "@@ -1,3 +1,5 @@\n+# coding: utf-8\n+\n from __future__ import absolute_import, unicode_literals\n \n import datetime\n@@ -146,6 +148,14 @@ def test_broken_unicode(self):\n         b = BrokenUnicodeMethod.objects.create(name=\"Jerry\")\n         self.assertEqual(repr(b), \"<BrokenUnicodeMethod: [Bad Unicode data]>\")\n \n+    def test_no_unicode_in_repr(self):\n+        a = Article.objects.create(\n+            headline=\"Watch for umlauts: üöä\", pub_date=datetime.datetime.now())\n+        if six.PY3:\n+            self.assertEqual(repr(a), '<Article: Watch for umlauts: üöä>')\n+        else:\n+            self.assertEqual(repr(a), '<Article: Watch for umlauts: ???>')\n+\n     @skipUnlessDBFeature(\"supports_timezones\")\n     def test_timezones(self):\n         # Saving an updating with timezone-aware datetime Python objects."
        }
    ],
    "stats": {
        "total": 12,
        "additions": 12,
        "deletions": 0
    }
}