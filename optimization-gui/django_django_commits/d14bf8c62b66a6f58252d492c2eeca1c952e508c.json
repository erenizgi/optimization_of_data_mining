{
    "author": "alex",
    "message": "Fixed #11404.  Added ``FormSet.has_changed``, for consistancy with ``Form.has_changed``. Thanks to michelts for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16773 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "d14bf8c62b66a6f58252d492c2eeca1c952e508c",
    "files": [
        {
            "sha": "04057a18bcc50ab35933a92eb04009889f28215d",
            "filename": "django/forms/formsets.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/d14bf8c62b66a6f58252d492c2eeca1c952e508c/django%2Fforms%2Fformsets.py",
            "raw_url": "https://github.com/django/django/raw/d14bf8c62b66a6f58252d492c2eeca1c952e508c/django%2Fforms%2Fformsets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fformsets.py?ref=d14bf8c62b66a6f58252d492c2eeca1c952e508c",
            "patch": "@@ -300,6 +300,12 @@ def clean(self):\n         \"\"\"\n         pass\n \n+    def has_changed(self):\n+        \"\"\"\n+        Returns true if data in any form differs from initial.\n+        \"\"\"\n+        return any(form.has_changed() for form in self)\n+\n     def add_fields(self, form, index):\n         \"\"\"A hook for adding extra fields on to each form instance.\"\"\"\n         if self.can_order:"
        },
        {
            "sha": "7912294dbb952f90d5811a906521d729e6b6a3cb",
            "filename": "docs/topics/forms/formsets.txt",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/d14bf8c62b66a6f58252d492c2eeca1c952e508c/docs%2Ftopics%2Fforms%2Fformsets.txt",
            "raw_url": "https://github.com/django/django/raw/d14bf8c62b66a6f58252d492c2eeca1c952e508c/docs%2Ftopics%2Fforms%2Fformsets.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fforms%2Fformsets.txt?ref=d14bf8c62b66a6f58252d492c2eeca1c952e508c",
            "patch": "@@ -150,6 +150,20 @@ As we can see, ``formset.errors`` is a list whose entries correspond to the\n forms in the formset. Validation was performed for each of the two forms, and\n the expected error message appears for the second item.\n \n+We can also check if form data differs from the initial data (i.e. the form was\n+sent without any data)::\n+\n+    >>> data = {\n+    ...     'form-TOTAL_FORMS': u'1',\n+    ...     'form-INITIAL_FORMS': u'0',\n+    ...     'form-MAX_NUM_FORMS': u'',\n+    ...     'form-0-title': u'',\n+    ...     'form-0-pub_date': u'',\n+    ... }\n+    >>> formset = ArticleFormSet(data)\n+    >>> formset.has_changed()\n+    False\n+\n .. _understanding-the-managementform:\n \n Understanding the ManagementForm"
        },
        {
            "sha": "f21805334e04a8353ee0714ca1bac64380fb04ad",
            "filename": "tests/regressiontests/forms/tests/formsets.py",
            "status": "modified",
            "additions": 28,
            "deletions": 1,
            "changes": 29,
            "blob_url": "https://github.com/django/django/blob/d14bf8c62b66a6f58252d492c2eeca1c952e508c/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py",
            "raw_url": "https://github.com/django/django/raw/d14bf8c62b66a6f58252d492c2eeca1c952e508c/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fformsets.py?ref=d14bf8c62b66a6f58252d492c2eeca1c952e508c",
            "patch": "@@ -73,9 +73,11 @@ def test_basic_formset(self):\n         self.assertTrue(formset.is_valid())\n         self.assertEqual([form.cleaned_data for form in formset.forms], [{'votes': 100, 'choice': u'Calexico'}])\n \n-        # If a FormSet was not passed any data, its is_valid method should return False.\n+        # If a FormSet was not passed any data, its is_valid and has_changed\n+        # methods should return False.\n         formset = ChoiceFormSet()\n         self.assertFalse(formset.is_valid())\n+        self.assertFalse(formset.has_changed())\n \n     def test_formset_validation(self):\n         # FormSet instances can also have an error attribute if validation failed for\n@@ -93,6 +95,31 @@ def test_formset_validation(self):\n         self.assertFalse(formset.is_valid())\n         self.assertEqual(formset.errors, [{'votes': [u'This field is required.']}])\n \n+    def test_formset_has_changed(self):\n+        # FormSet instances has_changed method will be True if any data is\n+        # passed to his forms, even if the formset didn't validate\n+        data = {\n+            'choices-TOTAL_FORMS': '1', # the number of forms rendered\n+            'choices-INITIAL_FORMS': '0', # the number of forms with initial data\n+            'choices-MAX_NUM_FORMS': '0', # max number of forms\n+            'choices-0-choice': '',\n+            'choices-0-votes': '',\n+        }\n+        blank_formset = ChoiceFormSet(data, auto_id=False, prefix='choices')\n+        self.assertFalse(blank_formset.has_changed())\n+\n+        # invalid formset test\n+        data['choices-0-choice'] = 'Calexico'\n+        invalid_formset = ChoiceFormSet(data, auto_id=False, prefix='choices')\n+        self.assertFalse(invalid_formset.is_valid())\n+        self.assertTrue(invalid_formset.has_changed())\n+\n+        # valid formset test\n+        data['choices-0-votes'] = '100'\n+        valid_formset = ChoiceFormSet(data, auto_id=False, prefix='choices')\n+        self.assertTrue(valid_formset.is_valid())\n+        self.assertTrue(valid_formset.has_changed())\n+\n     def test_formset_initial_data(self):\n         # We can also prefill a FormSet with existing data by providing an ``initial``\n         # argument to the constructor. ``initial`` should be a list of dicts. By default,"
        }
    ],
    "stats": {
        "total": 49,
        "additions": 48,
        "deletions": 1
    }
}