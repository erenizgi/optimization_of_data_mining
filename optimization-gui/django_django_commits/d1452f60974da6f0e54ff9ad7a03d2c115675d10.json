{
    "author": "claudep",
    "message": "[py3] Favoured unicode strings in assert(Not)Contains\n\nIn Python 3, HTMLParser does not support bytestrings.",
    "sha": "d1452f60974da6f0e54ff9ad7a03d2c115675d10",
    "files": [
        {
            "sha": "af807e075f669df7c8fa4005f74759f39edb009e",
            "filename": "django/test/testcases.py",
            "status": "modified",
            "additions": 6,
            "deletions": 8,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/d1452f60974da6f0e54ff9ad7a03d2c115675d10/django%2Ftest%2Ftestcases.py",
            "raw_url": "https://github.com/django/django/raw/d1452f60974da6f0e54ff9ad7a03d2c115675d10/django%2Ftest%2Ftestcases.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftest%2Ftestcases.py?ref=d1452f60974da6f0e54ff9ad7a03d2c115675d10",
            "patch": "@@ -647,14 +647,13 @@ def assertContains(self, response, text, count=None, status_code=200,\n         self.assertEqual(response.status_code, status_code,\n             msg_prefix + \"Couldn't retrieve content: Response code was %d\"\n             \" (expected %d)\" % (response.status_code, status_code))\n-        enc_text = smart_bytes(text, response._charset)\n-        content = response.content\n+        content = response.content.decode(response._charset)\n         if html:\n             content = assert_and_parse_html(self, content, None,\n                 \"Response's content is not valid HTML:\")\n-            enc_text = assert_and_parse_html(self, enc_text, None,\n+            text = assert_and_parse_html(self, text, None,\n                 \"Second argument is not valid HTML:\")\n-        real_count = content.count(enc_text)\n+        real_count = content.count(text)\n         if count is not None:\n             self.assertEqual(real_count, count,\n                 msg_prefix + \"Found %d instances of '%s' in response\"\n@@ -683,14 +682,13 @@ def assertNotContains(self, response, text, status_code=200,\n         self.assertEqual(response.status_code, status_code,\n             msg_prefix + \"Couldn't retrieve content: Response code was %d\"\n             \" (expected %d)\" % (response.status_code, status_code))\n-        enc_text = smart_bytes(text, response._charset)\n-        content = response.content\n+        content = response.content.decode(response._charset)\n         if html:\n             content = assert_and_parse_html(self, content, None,\n                 'Response\\'s content is not valid HTML:')\n-            enc_text = assert_and_parse_html(self, enc_text, None,\n+            text = assert_and_parse_html(self, text, None,\n                 'Second argument is not valid HTML:')\n-        self.assertEqual(content.count(enc_text), 0,\n+        self.assertEqual(content.count(text), 0,\n             msg_prefix + \"Response should not contain '%s'\" % text)\n \n     def assertFormError(self, response, form, field, errors, msg_prefix=''):"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 6,
        "deletions": 8
    }
}