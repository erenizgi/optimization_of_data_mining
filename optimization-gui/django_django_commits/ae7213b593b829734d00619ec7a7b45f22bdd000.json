{
    "author": "freakboy3742",
    "message": "Fixed #14563 -- Added Turkish localflavor. Thanks to serkank for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@14794 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ae7213b593b829734d00619ec7a7b45f22bdd000",
    "files": [
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "django/contrib/localflavor/tr/__init__.py",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/ae7213b593b829734d00619ec7a7b45f22bdd000/django%2Fcontrib%2Flocalflavor%2Ftr%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/ae7213b593b829734d00619ec7a7b45f22bdd000/django%2Fcontrib%2Flocalflavor%2Ftr%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Flocalflavor%2Ftr%2F__init__.py?ref=ae7213b593b829734d00619ec7a7b45f22bdd000"
        },
        {
            "sha": "d3bccf1667476b42c71cab61dc10237e70468f84",
            "filename": "django/contrib/localflavor/tr/forms.py",
            "status": "added",
            "additions": 91,
            "deletions": 0,
            "changes": 91,
            "blob_url": "https://github.com/django/django/blob/ae7213b593b829734d00619ec7a7b45f22bdd000/django%2Fcontrib%2Flocalflavor%2Ftr%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/ae7213b593b829734d00619ec7a7b45f22bdd000/django%2Fcontrib%2Flocalflavor%2Ftr%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Flocalflavor%2Ftr%2Fforms.py?ref=ae7213b593b829734d00619ec7a7b45f22bdd000",
            "patch": "@@ -0,0 +1,91 @@\n+\"\"\"\n+TR-specific Form helpers\n+\"\"\"\n+\n+from django.core.validators import EMPTY_VALUES\n+from django.forms import ValidationError\n+from django.forms.fields import Field, RegexField, Select, CharField\n+from django.utils.encoding import smart_unicode\n+from django.utils.translation import ugettext_lazy as _\n+import re\n+\n+phone_digits_re = re.compile(r'^(\\+90|0)? ?(([1-9]\\d{2})|\\([1-9]\\d{2}\\)) ?([2-9]\\d{2} ?\\d{2} ?\\d{2})$')\n+\n+class TRPostalCodeField(RegexField):\n+    default_error_messages = {\n+        'invalid': _(u'Enter a postal code in the format XXXXX.'),\n+    }\n+\n+    def __init__(self, *args, **kwargs):\n+        super(TRPostalCodeField, self).__init__(r'^\\d{5}$',\n+            max_length=5, min_length=5, *args, **kwargs)\n+\n+    def clean(self, value):\n+        value = super(TRPostalCodeField, self).clean(value)\n+        if value in EMPTY_VALUES:\n+            return u''\n+        if len(value) != 5:\n+            raise ValidationError(self.error_messages['invalid'])\n+        province_code = int(value[:2])\n+        if province_code == 0 or province_code > 81:\n+            raise ValidationError(self.error_messages['invalid'])\n+        return value\n+\n+\n+class TRPhoneNumberField(CharField):\n+    default_error_messages = {\n+        'invalid': _(u'Phone numbers must be in 0XXX XXX XXXX format.'),\n+    }\n+\n+    def clean(self, value):\n+        super(TRPhoneNumberField, self).clean(value)\n+        if value in EMPTY_VALUES:\n+            return u''\n+        value = re.sub('(\\(|\\)|\\s+)', '', smart_unicode(value))\n+        m = phone_digits_re.search(value)\n+        if m:\n+            return u'%s%s' % (m.group(2), m.group(4))\n+        raise ValidationError(self.error_messages['invalid'])\n+\n+class TRIdentificationNumberField(Field):\n+    \"\"\"\n+    A Turkey Identification Number number.\n+\tSee: http://tr.wikipedia.org/wiki/T%C3%BCrkiye_Cumhuriyeti_Kimlik_Numaras%C4%B1\n+\n+    Checks the following rules to determine whether the number is valid:\n+\n+        * The number is 11-digits.\n+        * First digit is not 0.\n+        * Conforms to the following two formula:\n+          (sum(1st, 3rd, 5th, 7th, 9th)*7 - sum(2nd,4th,6th,8th)) % 10 = 10th digit\n+          sum(1st to 10th) % 10 = 11th digit\n+    \"\"\"\n+    default_error_messages = {\n+        'invalid': _(u'Enter a valid Turkish Identification number.'),\n+        'not_11': _(u'Turkish Identification number must be 11 digits.'),\n+    }\n+\n+    def clean(self, value):\n+        super(TRIdentificationNumberField, self).clean(value)\n+        if value in EMPTY_VALUES:\n+            return u''\n+        if len(value) != 11:\n+            raise ValidationError(self.error_messages['not_11'])\n+        if not re.match(r'^\\d{11}$', value):\n+            raise ValidationError(self.error_messages['invalid'])\n+        if int(value[0]) == 0:\n+            raise ValidationError(self.error_messages['invalid'])\n+        chksum = (sum([int(value[i]) for i in xrange(0,9,2)])*7-\n+\t\t\t\t          sum([int(value[i]) for i in xrange(1,9,2)])) % 10\n+        if chksum != int(value[9]) or \\\n+           (sum([int(value[i]) for i in xrange(10)]) % 10) != int(value[10]):\n+            raise ValidationError(self.error_messages['invalid'])\n+        return value\n+\n+class TRProvinceSelect(Select):\n+    \"\"\"\n+    A Select widget that uses a list of provinces in Turkey as its choices.\n+    \"\"\"\n+    def __init__(self, attrs=None):\n+        from tr_provinces import PROVINCE_CHOICES\n+        super(TRProvinceSelect, self).__init__(attrs, choices=PROVINCE_CHOICES)"
        },
        {
            "sha": "060a6cdaf6002b277af55c718d8b596bf98aeab6",
            "filename": "django/contrib/localflavor/tr/tr_provinces.py",
            "status": "added",
            "additions": 89,
            "deletions": 0,
            "changes": 89,
            "blob_url": "https://github.com/django/django/blob/ae7213b593b829734d00619ec7a7b45f22bdd000/django%2Fcontrib%2Flocalflavor%2Ftr%2Ftr_provinces.py",
            "raw_url": "https://github.com/django/django/raw/ae7213b593b829734d00619ec7a7b45f22bdd000/django%2Fcontrib%2Flocalflavor%2Ftr%2Ftr_provinces.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Flocalflavor%2Ftr%2Ftr_provinces.py?ref=ae7213b593b829734d00619ec7a7b45f22bdd000",
            "patch": "@@ -0,0 +1,89 @@\n+# -*- coding: utf-8 -*-\n+\"\"\"\n+This exists in this standalone file so that it's only imported into memory\n+when explicitly needed.\n+\"\"\"\n+\n+PROVINCE_CHOICES = (\n+    ('01', ('Adana')),\n+    ('02', ('Adıyaman')),\n+    ('03', ('Afyonkarahisar')),\n+    ('04', ('Ağrı')),\n+    ('68', ('Aksaray')),\n+    ('05', ('Amasya')),\n+    ('06', ('Ankara')),\n+    ('07', ('Antalya')),\n+    ('75', ('Ardahan')),\n+    ('08', ('Artvin')),\n+    ('09', ('Aydın')),\n+    ('10', ('Balıkesir')),\n+    ('74', ('Bartın')),\n+    ('72', ('Batman')),\n+    ('69', ('Bayburt')),\n+    ('11', ('Bilecik')),\n+    ('12', ('Bingöl')),\n+    ('13', ('Bitlis')),\n+    ('14', ('Bolu')),\n+    ('15', ('Burdur')),\n+    ('16', ('Bursa')),\n+    ('17', ('Çanakkale')),\n+    ('18', ('Çankırı')),\n+    ('19', ('Çorum')),\n+    ('20', ('Denizli')),\n+    ('21', ('Diyarbakır')),\n+    ('81', ('Düzce')),\n+    ('22', ('Edirne')),\n+    ('23', ('Elazığ')),\n+    ('24', ('Erzincan')),\n+    ('25', ('Erzurum')),\n+    ('26', ('Eskişehir')),\n+    ('27', ('Gaziantep')),\n+    ('28', ('Giresun')),\n+    ('29', ('Gümüşhane')),\n+    ('30', ('Hakkari')),\n+    ('31', ('Hatay')),\n+    ('76', ('Iğdır')),\n+    ('32', ('Isparta')),\n+    ('33', ('Mersin')),\n+    ('34', ('İstanbul')),\n+    ('35', ('İzmir')),\n+    ('78', ('Karabük')),\n+    ('36', ('Kars')),\n+    ('37', ('Kastamonu')),\n+    ('38', ('Kayseri')),\n+    ('39', ('Kırklareli')),\n+    ('40', ('Kırşehir')),\n+    ('41', ('Kocaeli')),\n+    ('42', ('Konya')),\n+    ('43', ('Kütahya')),\n+    ('44', ('Malatya')),\n+    ('45', ('Manisa')),\n+    ('46', ('Kahramanmaraş')),\n+    ('70', ('Karaman')),\n+    ('71', ('Kırıkkale')),\n+    ('79', ('Kilis')),\n+    ('47', ('Mardin')),\n+    ('48', ('Muğla')),\n+    ('49', ('Muş')),\n+    ('50', ('Nevşehir')),\n+    ('51', ('Niğde')),\n+    ('52', ('Ordu')),\n+    ('80', ('Osmaniye')),\n+    ('53', ('Rize')),\n+    ('54', ('Sakarya')),\n+    ('55', ('Samsun')),\n+    ('56', ('Siirt')),\n+    ('57', ('Sinop')),\n+    ('58', ('Sivas')),\n+    ('73', ('Şırnak')),\n+    ('59', ('Tekirdağ')),\n+    ('60', ('Tokat')),\n+    ('61', ('Trabzon')),\n+    ('62', ('Tunceli')),\n+    ('63', ('Şanlıurfa')),\n+    ('64', ('Uşak')),\n+    ('65', ('Van')),\n+    ('77', ('Yalova')),\n+    ('66', ('Yozgat')),\n+    ('67', ('Zonguldak')),\n+)"
        },
        {
            "sha": "bc5878f93584e67353c631d7490253c2771f9100",
            "filename": "docs/ref/contrib/localflavor.txt",
            "status": "modified",
            "additions": 31,
            "deletions": 0,
            "changes": 31,
            "blob_url": "https://github.com/django/django/blob/ae7213b593b829734d00619ec7a7b45f22bdd000/docs%2Fref%2Fcontrib%2Flocalflavor.txt",
            "raw_url": "https://github.com/django/django/raw/ae7213b593b829734d00619ec7a7b45f22bdd000/docs%2Fref%2Fcontrib%2Flocalflavor.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Flocalflavor.txt?ref=ae7213b593b829734d00619ec7a7b45f22bdd000",
            "patch": "@@ -67,6 +67,7 @@ Countries currently supported by :mod:`~django.contrib.localflavor` are:\n     * Spain_\n     * Sweden_\n     * Switzerland_\n+    * Turkey_\n     * `United Kingdom`_\n     * `United States of America`_\n     * Uruguay_\n@@ -115,6 +116,7 @@ Here's an example of how to use them::\n .. _Spain: `Spain (es)`_\n .. _Sweden: `Sweden (se)`_\n .. _Switzerland: `Switzerland (ch)`_\n+.. _Turkey: `Turkey (tr)`_\n .. _United Kingdom: `United Kingdom (uk)`_\n .. _United States of America: `United States of America (us)`_\n .. _Uruguay: `Uruguay (uy)`_\n@@ -853,6 +855,35 @@ Switzerland (``ch``)\n \n     A ``Select`` widget that uses a list of Swiss states as its choices.\n \n+Turkey (``tr``)\n+===============\n+\n+.. class:: tr.forms.TRZipCodeField\n+\n+    A form field that validates input as a Turkish zip code. Valid codes\n+    consist of five digits.\n+\n+.. class:: tr.forms.TRPhoneNumberField\n+\n+    A form field that validates input as a Turkish phone number. The correct\n+    format is 0xxx xxx xxxx. +90xxx xxx xxxx and inputs without spaces also\n+    validates. The result is normalized to xxx xxx xxxx format.\n+\n+.. class:: tr.forms.TRIdentificationNumberField\n+\n+    A form field that validates input as a TR identification number. A valid\n+    number must satisfy the following:\n+\n+    * The number consist of 11 digits.\n+    * The first digit cannot be 0.\n+    * (sum(1st, 3rd, 5th, 7th, 9th)*7 - sum(2nd,4th,6th,8th)) % 10) must be\n+    equal to the 10th digit.\n+    * (sum(1st to 10th) % 10) must be equal to the 11th digit.\n+\n+.. class:: tr.forms.TRProvinceSelect\n+\n+    A ``select`` widget that uses a list of Turkish provinces as its choices.\n+\n United Kingdom (``uk``)\n =======================\n "
        },
        {
            "sha": "71b18003c6f651ff7d43c61b30723339d0e1335e",
            "filename": "tests/regressiontests/forms/localflavor/be.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fbe.py",
            "raw_url": "https://github.com/django/django/raw/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fbe.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fbe.py?ref=ae7213b593b829734d00619ec7a7b45f22bdd000",
            "patch": "@@ -4,7 +4,7 @@\n from django.contrib.localflavor.be.forms import (BEPostalCodeField,\n     BEPhoneNumberField, BERegionSelect, BEProvinceSelect)\n \n-class BETests(TestCase):\n+class BELocalFlavorTests(TestCase):\n     \"\"\"\n     Test case to validate BE localflavor\n     \"\"\""
        },
        {
            "sha": "8a327079acdc0a7a3d2245b85ccdd6cd5a37c6f6",
            "filename": "tests/regressiontests/forms/localflavor/il.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fil.py",
            "raw_url": "https://github.com/django/django/raw/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fil.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fil.py?ref=ae7213b593b829734d00619ec7a7b45f22bdd000",
            "patch": "@@ -4,7 +4,7 @@\n from django.utils.unittest import TestCase\n \n \n-class IsraelLocalFlavorTests(TestCase):\n+class ILLocalFlavorTests(TestCase):\n     def test_postal_code_field(self):\n         f = ILPostalCodeField()\n         self.assertRaisesRegexp(ValidationError,"
        },
        {
            "sha": "3ec1f5b7c4559b642f07cae7352060da1d710513",
            "filename": "tests/regressiontests/forms/localflavor/tr.py",
            "status": "added",
            "additions": 73,
            "deletions": 0,
            "changes": 73,
            "blob_url": "https://github.com/django/django/blob/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Ftr.py",
            "raw_url": "https://github.com/django/django/raw/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Ftr.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Ftr.py?ref=ae7213b593b829734d00619ec7a7b45f22bdd000",
            "patch": "@@ -0,0 +1,73 @@\n+# Tests for the contrib/localflavor/ TR form fields.\n+\n+from django.contrib.localflavor.tr import forms as trforms\n+from django.core.exceptions import ValidationError\n+from django.utils.unittest import TestCase\n+\n+class TRLocalFlavorTests(TestCase):\n+    def test_TRPostalCodeField(self):\n+        f = trforms.TRPostalCodeField()\n+        self.assertEqual(f.clean(\"06531\"), \"06531\")\n+        self.assertEqual(f.clean(\"12345\"), \"12345\")\n+        self.assertRaisesRegexp(ValidationError,\n+            \"Enter a postal code in the format XXXXX.\",\n+            f.clean, \"a1234\")\n+        self.assertRaisesRegexp(ValidationError,\n+            \"Enter a postal code in the format XXXXX.\",\n+            f.clean, \"1234\")\n+        self.assertRaisesRegexp(ValidationError,\n+            \"Enter a postal code in the format XXXXX.\",\n+            f.clean, \"82123\")\n+        self.assertRaisesRegexp(ValidationError,\n+            \"Enter a postal code in the format XXXXX.\",\n+            f.clean, \"00123\")\n+        self.assertRaisesRegexp(ValidationError,\n+            \"Enter a postal code in the format XXXXX.\",\n+            f.clean, \"123456\")\n+        self.assertRaisesRegexp(ValidationError,\n+            \"Enter a postal code in the format XXXXX.\",\n+            f.clean, \"12 34\")\n+        self.assertRaises(ValidationError, f.clean, None)\n+\n+    def test_TRPhoneNumberField(self):\n+        f = trforms.TRPhoneNumberField()\n+        self.assertEqual(f.clean(\"312 455 56 78\"), \"3124555678\")\n+        self.assertEqual(f.clean(\"312 4555678\"), \"3124555678\")\n+        self.assertEqual(f.clean(\"3124555678\"), \"3124555678\")\n+        self.assertEqual(f.clean(\"0312 455 5678\"), \"3124555678\")\n+        self.assertEqual(f.clean(\"0 312 455 5678\"), \"3124555678\")\n+        self.assertEqual(f.clean(\"0 (312) 455 5678\"), \"3124555678\")\n+        self.assertEqual(f.clean(\"+90 312 455 4567\"), \"3124554567\")\n+        self.assertEqual(f.clean(\"+90 312 455 45 67\"), \"3124554567\")\n+        self.assertEqual(f.clean(\"+90 (312) 4554567\"), \"3124554567\")\n+        self.assertRaisesRegexp(ValidationError,\n+            'Phone numbers must be in 0XXX XXX XXXX format.',\n+            f.clean, \"1234 233 1234\")\n+        self.assertRaisesRegexp(ValidationError,\n+            'Phone numbers must be in 0XXX XXX XXXX format.',\n+            f.clean, \"0312 233 12345\")\n+        self.assertRaisesRegexp(ValidationError,\n+            'Phone numbers must be in 0XXX XXX XXXX format.',\n+            f.clean, \"0312 233 123\")\n+        self.assertRaisesRegexp(ValidationError,\n+            'Phone numbers must be in 0XXX XXX XXXX format.',\n+            f.clean, \"0312 233 xxxx\")\n+\n+    def test_TRIdentificationNumberField(self):\n+        f = trforms.TRIdentificationNumberField()\n+        self.assertEqual(f.clean(\"10000000146\"), \"10000000146\")\n+        self.assertRaisesRegexp(ValidationError,\n+            'Enter a valid Turkish Identification number.',\n+            f.clean, \"10000000136\")\n+        self.assertRaisesRegexp(ValidationError,\n+            'Enter a valid Turkish Identification number.',\n+            f.clean, \"10000000147\")\n+        self.assertRaisesRegexp(ValidationError,\n+            'Turkish Identification number must be 11 digits.',\n+            f.clean, \"123456789\")\n+        self.assertRaisesRegexp(ValidationError,\n+            'Enter a valid Turkish Identification number.',\n+            f.clean, \"1000000014x\")\n+        self.assertRaisesRegexp(ValidationError,\n+            'Enter a valid Turkish Identification number.',\n+            f.clean, \"x0000000146\")"
        },
        {
            "sha": "0d6ff2658cf036d1d7242a2955b6cbeb3b7ae2e2",
            "filename": "tests/regressiontests/forms/localflavortests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "raw_url": "https://github.com/django/django/raw/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py?ref=ae7213b593b829734d00619ec7a7b45f22bdd000",
            "patch": "@@ -14,7 +14,7 @@\n from localflavor.generic import tests as localflavor_generic_tests\n from localflavor.id import tests as localflavor_id_tests\n from localflavor.ie import tests as localflavor_ie_tests\n-from localflavor.il import IsraelLocalFlavorTests\n+from localflavor.il import ILLocalFlavorTests\n from localflavor.is_ import tests as localflavor_is_tests\n from localflavor.it import tests as localflavor_it_tests\n from localflavor.jp import tests as localflavor_jp_tests\n@@ -25,12 +25,13 @@\n from localflavor.ro import tests as localflavor_ro_tests\n from localflavor.se import tests as localflavor_se_tests\n from localflavor.sk import tests as localflavor_sk_tests\n+from localflavor.tr import TRLocalFlavorTests\n from localflavor.uk import tests as localflavor_uk_tests\n from localflavor.us import tests as localflavor_us_tests\n from localflavor.uy import tests as localflavor_uy_tests\n from localflavor.za import tests as localflavor_za_tests\n \n-from localflavor.be import BETests\n+from localflavor.be import BELocalFlavorTests\n \n __test__ = {\n     'localflavor_ar_tests': localflavor_ar_tests,"
        },
        {
            "sha": "caec967dd3c89ff258262142b532ef435c1277a4",
            "filename": "tests/regressiontests/forms/tests/__init__.py",
            "status": "modified",
            "additions": 7,
            "deletions": 2,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/ae7213b593b829734d00619ec7a7b45f22bdd000/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py?ref=ae7213b593b829734d00619ec7a7b45f22bdd000",
            "patch": "@@ -11,5 +11,10 @@\n from validators import TestFieldWithValidators\n from widgets import *\n \n-from regressiontests.forms.localflavortests import (__test__, BETests,\n-    DELocalFlavorTests, IsraelLocalFlavorTests)\n+from regressiontests.forms.localflavortests import (\n+    __test__,\n+    BELocalFlavorTests,\n+    DELocalFlavorTests,\n+    ILLocalFlavorTests,\n+    TRLocalFlavorTests\n+)"
        }
    ],
    "stats": {
        "total": 302,
        "additions": 296,
        "deletions": 6
    }
}