{
    "author": "aaugustin",
    "message": "Simplified date-based generic views.\n\nRemoved a confusing helper function that was confusing -- it used\nlast_day to store the first day of the next month.",
    "sha": "e4d4cb6130b046d145ab1069df0c04d78786eedd",
    "files": [
        {
            "sha": "24680a376b3722ef724cf72bdc5d05bd2336a503",
            "filename": "django/views/generic/dates.py",
            "status": "modified",
            "additions": 12,
            "deletions": 18,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/e4d4cb6130b046d145ab1069df0c04d78786eedd/django%2Fviews%2Fgeneric%2Fdates.py",
            "raw_url": "https://github.com/django/django/raw/e4d4cb6130b046d145ab1069df0c04d78786eedd/django%2Fviews%2Fgeneric%2Fdates.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fviews%2Fgeneric%2Fdates.py?ref=e4d4cb6130b046d145ab1069df0c04d78786eedd",
            "patch": "@@ -62,16 +62,19 @@ def get_next_month(self, date):\n         \"\"\"\n         Get the next valid month.\n         \"\"\"\n-        first_day, last_day = _month_bounds(date)\n-        next = (last_day + datetime.timedelta(days=1)).replace(day=1)\n+        # next must be the first day of the next month.\n+        if date.month == 12:\n+            next = date.replace(year=date.year + 1, month=1, day=1)\n+        else:\n+            next = date.replace(month=date.month + 1, day=1)\n         return _get_next_prev_month(self, next, is_previous=False, use_first_day=True)\n \n     def get_previous_month(self, date):\n         \"\"\"\n         Get the previous valid month.\n         \"\"\"\n-        first_day, last_day = _month_bounds(date)\n-        prev = (first_day - datetime.timedelta(days=1))\n+        # prev must be the last day of the previous month.\n+        prev = date.replace(day=1) - datetime.timedelta(days=1)\n         return _get_next_prev_month(self, prev, is_previous=True, use_first_day=True)\n \n \n@@ -309,7 +312,11 @@ def get_dated_items(self):\n                                  month, self.get_month_format())\n \n         # Construct a date-range lookup.\n-        first_day, last_day = _month_bounds(date)\n+        first_day = date.replace(day=1)\n+        if first_day.month == 12:\n+            last_day = first_day.replace(year=first_day.year + 1, month=1)\n+        else:\n+            last_day = first_day.replace(month=first_day.month + 1)\n         lookup_kwargs = {\n             '%s__gte' % date_field: first_day,\n             '%s__lt' % date_field: last_day,\n@@ -499,19 +506,6 @@ def _date_from_string(year, year_format, month, month_format, day='', day_format\n         })\n \n \n-def _month_bounds(date):\n-    \"\"\"\n-    Helper: return the first and last days of the month for the given date.\n-    \"\"\"\n-    first_day = date.replace(day=1)\n-    if first_day.month == 12:\n-        last_day = first_day.replace(year=first_day.year + 1, month=1)\n-    else:\n-        last_day = first_day.replace(month=first_day.month + 1)\n-\n-    return first_day, last_day\n-\n-\n def _get_next_prev_month(generic_view, naive_result, is_previous, use_first_day):\n     \"\"\"\n     Helper: Get the next or the previous valid date. The idea is to allow"
        }
    ],
    "stats": {
        "total": 30,
        "additions": 12,
        "deletions": 18
    }
}