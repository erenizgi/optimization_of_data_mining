{
    "author": "alex",
    "message": "Converted generic localflavor doctests to unittests.  We have always been at war with doctests.  Thanks to Idan Gazit.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@14940 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "1eee7757b79a13e386500aefbee8ab4939b9d88c",
    "files": [
        {
            "sha": "f47fc91460727e18fe8e9a86225cc2ea979e7d91",
            "filename": "tests/regressiontests/forms/localflavor/generic.py",
            "status": "modified",
            "additions": 81,
            "deletions": 156,
            "changes": 237,
            "blob_url": "https://github.com/django/django/blob/1eee7757b79a13e386500aefbee8ab4939b9d88c/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fgeneric.py",
            "raw_url": "https://github.com/django/django/raw/1eee7757b79a13e386500aefbee8ab4939b9d88c/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fgeneric.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fgeneric.py?ref=1eee7757b79a13e386500aefbee8ab4939b9d88c",
            "patch": "@@ -1,163 +1,88 @@\n-# -*- coding: utf-8 -*-\n-# Tests for the contrib/localflavor/ generic form fields.\n+import datetime\n \n-tests = r\"\"\"\n-## Generic DateField ##########################################################\n+from django.contrib.localflavor.generic.forms import DateField, DateTimeField\n \n->>> from django.contrib.localflavor.generic.forms import *\n+from utils import LocalFlavorTestCase\n \n-A DateField that uses generic dd/mm/yy dates instead of mm/dd/yy where\n-appropriate.\n \n->>> import datetime\n->>> f = DateField()\n->>> f.clean(datetime.date(2006, 10, 25))\n-datetime.date(2006, 10, 25)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30))\n-datetime.date(2006, 10, 25)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30, 59))\n-datetime.date(2006, 10, 25)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30, 59, 200))\n-datetime.date(2006, 10, 25)\n->>> f.clean('2006-10-25')\n-datetime.date(2006, 10, 25)\n->>> f.clean('25/10/2006')\n-datetime.date(2006, 10, 25)\n->>> f.clean('25/10/06')\n-datetime.date(2006, 10, 25)\n->>> f.clean('Oct 25 2006')\n-datetime.date(2006, 10, 25)\n->>> f.clean('October 25 2006')\n-datetime.date(2006, 10, 25)\n->>> f.clean('October 25, 2006')\n-datetime.date(2006, 10, 25)\n->>> f.clean('25 October 2006')\n-datetime.date(2006, 10, 25)\n->>> f.clean('25 October, 2006')\n-datetime.date(2006, 10, 25)\n->>> f.clean('2006-4-31')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid date.']\n->>> f.clean('200a-10-25')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid date.']\n->>> f.clean('10/25/06')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid date.']\n->>> f.clean(None)\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n+class GenericLocalFlavorTests(LocalFlavorTestCase):\n+    def test_GenericDateField(self):\n+        error_invalid = [u'Enter a valid date.']\n+        valid = {\n+            datetime.date(2006, 10, 25): datetime.date(2006, 10, 25),\n+            datetime.datetime(2006, 10, 25, 14, 30): datetime.date(2006, 10, 25),\n+            datetime.datetime(2006, 10, 25, 14, 30, 59): datetime.date(2006, 10, 25),\n+            datetime.datetime(2006, 10, 25, 14, 30, 59, 200): datetime.date(2006, 10, 25),\n+            '2006-10-25': datetime.date(2006, 10, 25),\n+            '25/10/2006': datetime.date(2006, 10, 25),\n+            '25/10/06': datetime.date(2006, 10, 25),\n+            'Oct 25 2006': datetime.date(2006, 10, 25),\n+            'October 25 2006': datetime.date(2006, 10, 25),\n+            'October 25, 2006': datetime.date(2006, 10, 25),\n+            '25 October 2006': datetime.date(2006, 10, 25),\n+            '25 October, 2006': datetime.date(2006, 10, 25),\n+        }\n+        invalid = {\n+            '2006-4-31': error_invalid,\n+            '200a-10-25': error_invalid,\n+            '10/25/06': error_invalid,\n+        }\n+        self.assertFieldOutput(DateField, valid, invalid, empty_value=None)\n \n->>> f = DateField(required=False)\n->>> f.clean(None)\n->>> repr(f.clean(None))\n-'None'\n->>> f.clean('')\n->>> repr(f.clean(''))\n-'None'\n+        # DateField with optional input_formats parameter\n+        valid = {\n+            datetime.date(2006, 10, 25): datetime.date(2006, 10, 25),\n+            datetime.datetime(2006, 10, 25, 14, 30): datetime.date(2006, 10, 25),\n+            '2006 10 25': datetime.date(2006, 10, 25),\n+        }\n+        invalid = {\n+            '2006-10-25': error_invalid,\n+            '25/10/2006': error_invalid,\n+            '25/10/06': error_invalid,\n+        }\n+        kwargs = {'input_formats':['%Y %m %d'],}\n+        self.assertFieldOutput(DateField,\n+            valid, invalid, field_kwargs=kwargs, empty_value=None\n+        )\n \n-DateField accepts an optional input_formats parameter:\n->>> f = DateField(input_formats=['%Y %m %d'])\n->>> f.clean(datetime.date(2006, 10, 25))\n-datetime.date(2006, 10, 25)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30))\n-datetime.date(2006, 10, 25)\n->>> f.clean('2006 10 25')\n-datetime.date(2006, 10, 25)\n+    def test_GenericDateTimeField(self):\n+        error_invalid = [u'Enter a valid date/time.']\n+        valid = {\n+            datetime.date(2006, 10, 25): datetime.datetime(2006, 10, 25, 0, 0),\n+            datetime.datetime(2006, 10, 25, 14, 30): datetime.datetime(2006, 10, 25, 14, 30),\n+            datetime.datetime(2006, 10, 25, 14, 30, 59): datetime.datetime(2006, 10, 25, 14, 30, 59),\n+            datetime.datetime(2006, 10, 25, 14, 30, 59, 200): datetime.datetime(2006, 10, 25, 14, 30, 59, 200),\n+            '2006-10-25 14:30:45': datetime.datetime(2006, 10, 25, 14, 30, 45),\n+            '2006-10-25 14:30:00': datetime.datetime(2006, 10, 25, 14, 30),\n+            '2006-10-25 14:30': datetime.datetime(2006, 10, 25, 14, 30),\n+            '2006-10-25': datetime.datetime(2006, 10, 25, 0, 0),\n+            '25/10/2006 14:30:45': datetime.datetime(2006, 10, 25, 14, 30, 45),\n+            '25/10/2006 14:30:00': datetime.datetime(2006, 10, 25, 14, 30),\n+            '25/10/2006 14:30': datetime.datetime(2006, 10, 25, 14, 30),\n+            '25/10/2006': datetime.datetime(2006, 10, 25, 0, 0),\n+            '25/10/06 14:30:45': datetime.datetime(2006, 10, 25, 14, 30, 45),\n+            '25/10/06 14:30:00': datetime.datetime(2006, 10, 25, 14, 30),\n+            '25/10/06 14:30': datetime.datetime(2006, 10, 25, 14, 30),\n+            '25/10/06': datetime.datetime(2006, 10, 25, 0, 0),\n+        }\n+        invalid = {\n+            'hello': error_invalid,\n+            '2006-10-25 4:30 p.m.': error_invalid,\n+        }\n+        self.assertFieldOutput(DateTimeField, valid, invalid, empty_value=None)\n \n-The input_formats parameter overrides all default input formats,\n-so the default formats won't work unless you specify them:\n->>> f.clean('2006-10-25')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid date.']\n->>> f.clean('25/10/2006')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid date.']\n->>> f.clean('25/10/06')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid date.']\n-\n-## Generic DateTimeField ######################################################\n-\n-A DateField that uses generic dd/mm/yy dates instead of mm/dd/yy where\n-appropriate.\n-\n->>> import datetime\n->>> f = DateTimeField()\n->>> f.clean(datetime.date(2006, 10, 25))\n-datetime.datetime(2006, 10, 25, 0, 0)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30))\n-datetime.datetime(2006, 10, 25, 14, 30)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30, 59))\n-datetime.datetime(2006, 10, 25, 14, 30, 59)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30, 59, 200))\n-datetime.datetime(2006, 10, 25, 14, 30, 59, 200)\n->>> f.clean('2006-10-25 14:30:45')\n-datetime.datetime(2006, 10, 25, 14, 30, 45)\n->>> f.clean('2006-10-25 14:30:00')\n-datetime.datetime(2006, 10, 25, 14, 30)\n->>> f.clean('2006-10-25 14:30')\n-datetime.datetime(2006, 10, 25, 14, 30)\n->>> f.clean('2006-10-25')\n-datetime.datetime(2006, 10, 25, 0, 0)\n->>> f.clean('25/10/2006 14:30:45')\n-datetime.datetime(2006, 10, 25, 14, 30, 45)\n->>> f.clean('25/10/2006 14:30:00')\n-datetime.datetime(2006, 10, 25, 14, 30)\n->>> f.clean('25/10/2006 14:30')\n-datetime.datetime(2006, 10, 25, 14, 30)\n->>> f.clean('25/10/2006')\n-datetime.datetime(2006, 10, 25, 0, 0)\n->>> f.clean('25/10/06 14:30:45')\n-datetime.datetime(2006, 10, 25, 14, 30, 45)\n->>> f.clean('25/10/06 14:30:00')\n-datetime.datetime(2006, 10, 25, 14, 30)\n->>> f.clean('25/10/06 14:30')\n-datetime.datetime(2006, 10, 25, 14, 30)\n->>> f.clean('25/10/06')\n-datetime.datetime(2006, 10, 25, 0, 0)\n->>> f.clean('hello')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid date/time.']\n->>> f.clean('2006-10-25 4:30 p.m.')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid date/time.']\n-\n-DateField accepts an optional input_formats parameter:\n->>> f = DateTimeField(input_formats=['%Y %m %d %I:%M %p'])\n->>> f.clean(datetime.date(2006, 10, 25))\n-datetime.datetime(2006, 10, 25, 0, 0)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30))\n-datetime.datetime(2006, 10, 25, 14, 30)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30, 59))\n-datetime.datetime(2006, 10, 25, 14, 30, 59)\n->>> f.clean(datetime.datetime(2006, 10, 25, 14, 30, 59, 200))\n-datetime.datetime(2006, 10, 25, 14, 30, 59, 200)\n->>> f.clean('2006 10 25 2:30 PM')\n-datetime.datetime(2006, 10, 25, 14, 30)\n-\n-The input_formats parameter overrides all default input formats,\n-so the default formats won't work unless you specify them:\n->>> f.clean('2006-10-25 14:30:45')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a valid date/time.']\n-\n->>> f = DateTimeField(required=False)\n->>> f.clean(None)\n->>> repr(f.clean(None))\n-'None'\n->>> f.clean('')\n->>> repr(f.clean(''))\n-'None'\n-\n-\"\"\"\n+        # DateTimeField with optional input_formats paramter\n+        valid = {\n+            datetime.date(2006, 10, 25): datetime.datetime(2006, 10, 25, 0, 0),\n+            datetime.datetime(2006, 10, 25, 14, 30): datetime.datetime(2006, 10, 25, 14, 30),\n+            datetime.datetime(2006, 10, 25, 14, 30, 59): datetime.datetime(2006, 10, 25, 14, 30, 59),\n+            datetime.datetime(2006, 10, 25, 14, 30, 59, 200): datetime.datetime(2006, 10, 25, 14, 30, 59, 200),\n+            '2006 10 25 2:30 PM': datetime.datetime(2006, 10, 25, 14, 30),\n+        }\n+        invalid = {\n+            '2006-10-25 14:30:45': error_invalid,\n+        }\n+        kwargs = {'input_formats':['%Y %m %d %I:%M %p'],}\n+        self.assertFieldOutput(DateTimeField,\n+            valid, invalid, field_kwargs=kwargs, empty_value=None\n+        )"
        },
        {
            "sha": "8e4f65ce32d433a547dfb575a7912680a0695c5b",
            "filename": "tests/regressiontests/forms/localflavortests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/1eee7757b79a13e386500aefbee8ab4939b9d88c/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "raw_url": "https://github.com/django/django/raw/1eee7757b79a13e386500aefbee8ab4939b9d88c/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py?ref=1eee7757b79a13e386500aefbee8ab4939b9d88c",
            "patch": "@@ -1,6 +1,5 @@\n # -*- coding: utf-8 -*-\n from localflavor.cz import tests as localflavor_cz_tests\n-from localflavor.generic import tests as localflavor_generic_tests\n from localflavor.id import tests as localflavor_id_tests\n from localflavor.ie import tests as localflavor_ie_tests\n from localflavor.is_ import tests as localflavor_is_tests\n@@ -30,13 +29,13 @@\n from localflavor.es import ESLocalFlavorTests\n from localflavor.fi import FILocalFlavorTests\n from localflavor.fr import FRLocalFlavorTests\n+from localflavor.generic import GenericLocalFlavorTests\n from localflavor.il import ILLocalFlavorTests\n from localflavor.tr import TRLocalFlavorTests\n \n \n __test__ = {\n     'localflavor_cz_tests': localflavor_cz_tests,\n-    'localflavor_generic_tests': localflavor_generic_tests,\n     'localflavor_id_tests': localflavor_id_tests,\n     'localflavor_ie_tests': localflavor_ie_tests,\n     'localflavor_is_tests': localflavor_is_tests,"
        },
        {
            "sha": "a23290ee2a4642835e358320f3421eeb68918d54",
            "filename": "tests/regressiontests/forms/tests/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/1eee7757b79a13e386500aefbee8ab4939b9d88c/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/1eee7757b79a13e386500aefbee8ab4939b9d88c/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py?ref=1eee7757b79a13e386500aefbee8ab4939b9d88c",
            "patch": "@@ -25,6 +25,7 @@\n     ESLocalFlavorTests,\n     FILocalFlavorTests,\n     FRLocalFlavorTests,\n+    GenericLocalFlavorTests,\n     ILLocalFlavorTests,\n     TRLocalFlavorTests,\n )"
        }
    ],
    "stats": {
        "total": 241,
        "additions": 83,
        "deletions": 158
    }
}