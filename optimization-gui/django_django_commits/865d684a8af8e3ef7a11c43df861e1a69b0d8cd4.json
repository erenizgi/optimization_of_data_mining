{
    "author": "andrewgodwin",
    "message": "Fixed #8913 - Make \"must be unique\" error messages customisable. Thanks to Leah Culver.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16345 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "865d684a8af8e3ef7a11c43df861e1a69b0d8cd4",
    "files": [
        {
            "sha": "b8c773b6024f8f34ce2198c9cf658699944f4d7d",
            "filename": "AUTHORS",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/AUTHORS",
            "raw_url": "https://github.com/django/django/raw/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/AUTHORS",
            "contents_url": "https://api.github.com/repos/django/django/contents/AUTHORS?ref=865d684a8af8e3ef7a11c43df861e1a69b0d8cd4",
            "patch": "@@ -128,7 +128,7 @@ answer newbie questions, and generally made Django that much better:\n     Robert Coup\n     Pete Crosier <pete.crosier@gmail.com>\n     Matt Croydon <http://www.postneo.com/>\n-    Leah Culver <leah@pownce.com>\n+    Leah Culver <leah.culver@gmail.com>\n     flavio.curella@gmail.com\n     Jure Cuhalev <gandalf@owca.info>\n     John D'Agostino <john.dagostino@gmail.com>"
        },
        {
            "sha": "e75eb4969560e5916a3e0584bc30b9ef5426846e",
            "filename": "django/db/models/base.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/django%2Fdb%2Fmodels%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/django%2Fdb%2Fmodels%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fbase.py?ref=865d684a8af8e3ef7a11c43df861e1a69b0d8cd4",
            "patch": "@@ -782,9 +782,10 @@ def unique_error_message(self, model_class, unique_check):\n         # A unique field\n         if len(unique_check) == 1:\n             field_name = unique_check[0]\n-            field_label = capfirst(opts.get_field(field_name).verbose_name)\n+            field = opts.get_field(field_name)\n+            field_label = capfirst(field.verbose_name)\n             # Insert the error into the error dict, very sneaky\n-            return _(u\"%(model_name)s with this %(field_label)s already exists.\") %  {\n+            return field.error_messages['unique'] %  {\n                 'model_name': unicode(model_name),\n                 'field_label': unicode(field_label)\n             }"
        },
        {
            "sha": "63d0c21bc13514dc6114fab21a5ba7abf3bb3450",
            "filename": "django/db/models/fields/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/django%2Fdb%2Fmodels%2Ffields%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/django%2Fdb%2Fmodels%2Ffields%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Ffields%2F__init__.py?ref=865d684a8af8e3ef7a11c43df861e1a69b0d8cd4",
            "patch": "@@ -60,6 +60,7 @@ class Field(object):\n         'invalid_choice': _(u'Value %r is not a valid choice.'),\n         'null': _(u'This field cannot be null.'),\n         'blank': _(u'This field cannot be blank.'),\n+        'unique': _(u'%(model_name)s with this %(field_label)s already exists.'),\n     }\n \n     # Generic field type description, usually overriden by subclasses"
        },
        {
            "sha": "5c4bbd06bc719ed5dd914daa4fb074e35c6a1c95",
            "filename": "docs/ref/models/fields.txt",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/docs%2Fref%2Fmodels%2Ffields.txt",
            "raw_url": "https://github.com/django/django/raw/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/docs%2Fref%2Fmodels%2Ffields.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fmodels%2Ffields.txt?ref=865d684a8af8e3ef7a11c43df861e1a69b0d8cd4",
            "patch": "@@ -210,6 +210,10 @@ The ``error_messages`` argument lets you override the default messages that the\n field will raise. Pass in a dictionary with keys matching the error messages you\n want to override.\n \n+Error message keys include ``null``, ``blank``, ``invalid``, ``invalid_choice``,\n+and ``unique``. Additional error message keys are specified for each field in\n+the `Field types`_ section below.\n+\n ``help_text``\n -------------\n \n@@ -416,7 +420,8 @@ optional arguments:\n     it's not just a default value that you can override.\n \n The admin represents this as an ``<input type=\"text\">`` with a JavaScript\n-calendar, and a shortcut for \"Today\".\n+calendar, and a shortcut for \"Today\". Includes an additional ``invalid_date``\n+error message key.\n \n .. note::\n     As currently implemented, setting ``auto_now`` or ``auto_now_add`` to"
        },
        {
            "sha": "923e5a88c5ff226801535c3e6885cd1bc6789a75",
            "filename": "tests/modeltests/validation/models.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/tests%2Fmodeltests%2Fvalidation%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/tests%2Fmodeltests%2Fvalidation%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fvalidation%2Fmodels.py?ref=865d684a8af8e3ef7a11c43df861e1a69b0d8cd4",
            "patch": "@@ -78,3 +78,7 @@ class FlexibleDatePost(models.Model):\n     slug = models.CharField(max_length=50, unique_for_year='posted', blank=True)\n     subtitle = models.CharField(max_length=50, unique_for_month='posted', blank=True)\n     posted = models.DateField(blank=True, null=True)\n+\n+class UniqueErrorsModel(models.Model):\n+    name = models.CharField(max_length=100, unique=True, error_messages={'unique': u'Custom unique name message.'})\n+    number = models.IntegerField(unique=True, error_messages={'unique': u'Custom unique number message.'})\n\\ No newline at end of file"
        },
        {
            "sha": "90616126a555a501007f16c889b5fe3c8935dd31",
            "filename": "tests/modeltests/validation/test_unique.py",
            "status": "modified",
            "additions": 20,
            "deletions": 1,
            "changes": 21,
            "blob_url": "https://github.com/django/django/blob/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/tests%2Fmodeltests%2Fvalidation%2Ftest_unique.py",
            "raw_url": "https://github.com/django/django/raw/865d684a8af8e3ef7a11c43df861e1a69b0d8cd4/tests%2Fmodeltests%2Fvalidation%2Ftest_unique.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fvalidation%2Ftest_unique.py?ref=865d684a8af8e3ef7a11c43df861e1a69b0d8cd4",
            "patch": "@@ -7,7 +7,7 @@\n from django.utils import unittest\n \n from models import (CustomPKModel, UniqueTogetherModel, UniqueFieldsModel,\n-    UniqueForDateModel, ModelToValidate, Post, FlexibleDatePost)\n+    UniqueForDateModel, ModelToValidate, Post, FlexibleDatePost, UniqueErrorsModel)\n \n \n class GetUniqueCheckTests(unittest.TestCase):\n@@ -149,3 +149,22 @@ def test_unique_for_date_with_nullable_date(self):\n             self.fail(\"unique_for_month checks shouldn't trigger when the associated DateField is None.\")\n         except:\n             self.fail(\"unique_for_month checks shouldn't explode when the associated DateField is None.\")\n+\n+    def test_unique_errors(self):\n+        m1 = UniqueErrorsModel.objects.create(name='Some Name', number=10)\n+        m = UniqueErrorsModel(name='Some Name', number=11)\n+        try:\n+            m.full_clean()\n+        except ValidationError, e:\n+            self.assertEqual(e.message_dict, {'name': [u'Custom unique name message.']})\n+        except:\n+            self.fail('unique checks should catch this.')\n+\n+        m = UniqueErrorsModel(name='Some Other Name', number=10)\n+        try:\n+            m.full_clean()\n+        except ValidationError, e:\n+            self.assertEqual(e.message_dict, {'number': [u'Custom unique number message.']})\n+        except:\n+            self.fail('unique checks should catch this.')\n+            \n\\ No newline at end of file"
        }
    ],
    "stats": {
        "total": 40,
        "additions": 35,
        "deletions": 5
    }
}