{
    "author": "freakboy3742",
    "message": "Fixed #14895 -- Ensure that USE_THOUSAND_SEPARATOR doesn't break the delete confirmation page. Thanks to Tuttle for the report, and Julien Phalip for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15435 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "5582ad149c6f4fcdd0a8dfaf1f22ed0f2bf295b2",
    "files": [
        {
            "sha": "127519bea7a7f9eba8b25e6d3e9038e47f5fff88",
            "filename": "django/contrib/admin/templates/admin/delete_selected_confirmation.html",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/5582ad149c6f4fcdd0a8dfaf1f22ed0f2bf295b2/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fdelete_selected_confirmation.html",
            "raw_url": "https://github.com/django/django/raw/5582ad149c6f4fcdd0a8dfaf1f22ed0f2bf295b2/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fdelete_selected_confirmation.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fdelete_selected_confirmation.html?ref=5582ad149c6f4fcdd0a8dfaf1f22ed0f2bf295b2",
            "patch": "@@ -1,5 +1,5 @@\n {% extends \"admin/base_site.html\" %}\n-{% load i18n %}\n+{% load i18n l10n %}\n \n {% block breadcrumbs %}\n <div class=\"breadcrumbs\">\n@@ -36,7 +36,7 @@\n     <form action=\"\" method=\"post\">{% csrf_token %}\n     <div>\n     {% for obj in queryset %}\n-    <input type=\"hidden\" name=\"{{ action_checkbox_name }}\" value=\"{{ obj.pk }}\" />\n+    <input type=\"hidden\" name=\"{{ action_checkbox_name }}\" value=\"{{ obj.pk|unlocalize }}\" />\n     {% endfor %}\n     <input type=\"hidden\" name=\"action\" value=\"delete_selected\" />\n     <input type=\"hidden\" name=\"post\" value=\"yes\" />"
        },
        {
            "sha": "f3923931a506a88f0ea765c752192cdfe10d99e8",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/django/django/blob/5582ad149c6f4fcdd0a8dfaf1f22ed0f2bf295b2/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/5582ad149c6f4fcdd0a8dfaf1f22ed0f2bf295b2/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=5582ad149c6f4fcdd0a8dfaf1f22ed0f2bf295b2",
            "patch": "@@ -1675,6 +1675,29 @@ def test_model_admin_default_delete_action(self):\n         response = self.client.post('/test_admin/admin/admin_views/subscriber/', delete_confirmation_data)\n         self.assertEqual(Subscriber.objects.count(), 0)\n \n+    def test_non_localized_pk(self):\n+        \"\"\"If USE_THOUSAND_SEPARATOR is set, make sure that the ids for\n+        the objects selected for deletion are rendered without separators.\n+        Refs #14895.\n+        \"\"\"\n+        self.old_USE_THOUSAND_SEPARATOR = settings.USE_THOUSAND_SEPARATOR\n+        self.old_USE_L10N = settings.USE_L10N\n+        settings.USE_THOUSAND_SEPARATOR = True\n+        settings.USE_L10N = True\n+        subscriber = Subscriber.objects.get(id=1)\n+        subscriber.id = 9999\n+        subscriber.save()\n+        action_data = {\n+            ACTION_CHECKBOX_NAME: [9999, 2],\n+            'action' : 'delete_selected',\n+            'index': 0,\n+        }\n+        response = self.client.post('/test_admin/admin/admin_views/subscriber/', action_data)\n+        self.assertTemplateUsed(response, 'admin/delete_selected_confirmation.html')\n+        self.assertTrue('value=\"9999\"' in response.content and 'value=\"2\"' in response.content) # Instead of 9,999\n+        settings.USE_THOUSAND_SEPARATOR = self.old_USE_THOUSAND_SEPARATOR\n+        settings.USE_L10N = self.old_USE_L10N\n+\n     def test_model_admin_default_delete_action_protected(self):\n         \"\"\"\n         Tests the default delete action defined as a ModelAdmin method in the"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 25,
        "deletions": 2
    }
}