{
    "author": "jphalip",
    "message": "Fixed #19829 -- Fixed index lookups for NumPy arrays in templates.",
    "sha": "7d5e35cdb46124e2471833b9570add1a00a1d9e0",
    "files": [
        {
            "sha": "f43194de4a0a65f527a6648f739b97d6ec589309",
            "filename": "django/template/base.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/7d5e35cdb46124e2471833b9570add1a00a1d9e0/django%2Ftemplate%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/7d5e35cdb46124e2471833b9570add1a00a1d9e0/django%2Ftemplate%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fbase.py?ref=7d5e35cdb46124e2471833b9570add1a00a1d9e0",
            "patch": "@@ -763,7 +763,7 @@ def _resolve_lookup(self, context):\n             for bit in self.lookups:\n                 try:  # dictionary lookup\n                     current = current[bit]\n-                except (TypeError, AttributeError, KeyError):\n+                except (TypeError, AttributeError, KeyError, ValueError):\n                     try:  # attribute lookup\n                         current = getattr(current, bit)\n                     except (TypeError, AttributeError):"
        },
        {
            "sha": "255671435a2b698e1bb868ffba565275aa9637ac",
            "filename": "tests/regressiontests/templates/tests.py",
            "status": "modified",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/django/django/blob/7d5e35cdb46124e2471833b9570add1a00a1d9e0/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/7d5e35cdb46124e2471833b9570add1a00a1d9e0/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftemplates%2Ftests.py?ref=7d5e35cdb46124e2471833b9570add1a00a1d9e0",
            "patch": "@@ -54,6 +54,12 @@\n     else:\n         raise\n \n+# NumPy installed?\n+try:\n+    import numpy\n+except ImportError:\n+    numpy = False\n+\n from . import filters\n \n #################################\n@@ -1649,6 +1655,17 @@ def get_template_tests(self):\n             'verbatim-tag05': ('{% verbatim %}{% endverbatim %}{% verbatim %}{% endverbatim %}', {}, ''),\n             'verbatim-tag06': (\"{% verbatim special %}Don't {% endverbatim %} just yet{% endverbatim special %}\", {}, \"Don't {% endverbatim %} just yet\"),\n         }\n+\n+        if numpy:\n+            tests.update({\n+                # Numpy's array-index syntax allows a template to access a certain item of a subscriptable object.\n+                'numpy-array-index01': (\"{{ var.1 }}\", {\"var\": numpy.array([\"first item\", \"second item\"])}, \"second item\"),\n+\n+                # Fail silently when the array index is out of range.\n+                'numpy-array-index02': (\"{{ var.5 }}\", {\"var\": numpy.array([\"first item\", \"second item\"])}, (\"\", \"INVALID\")),\n+            })\n+\n+\n         return tests\n \n class TemplateTagLoading(unittest.TestCase):"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 18,
        "deletions": 1
    }
}