{
    "author": "PaulMcMillan",
    "message": "Fixed #16837 -- Improved error message for admin login.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16872 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "0781ed8ec8dab4f4658787c9dc1ca8499ccc1a18",
    "files": [
        {
            "sha": "e790e2e3b6816337a15afe56aa005ca19239d153",
            "filename": "django/contrib/admin/forms.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/0781ed8ec8dab4f4658787c9dc1ca8499ccc1a18/django%2Fcontrib%2Fadmin%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/0781ed8ec8dab4f4658787c9dc1ca8499ccc1a18/django%2Fcontrib%2Fadmin%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fforms.py?ref=0781ed8ec8dab4f4658787c9dc1ca8499ccc1a18",
            "patch": "@@ -6,8 +6,8 @@\n \n from django.utils.translation import ugettext_lazy, ugettext as _\n \n-ERROR_MESSAGE = ugettext_lazy(\"Please enter a correct username and password. \"\n-                              \"Note that both fields are case-sensitive.\")\n+ERROR_MESSAGE = ugettext_lazy(\"Please enter the correct username and password \"\n+        \"for a staff account. Note that both fields are case-sensitive.\")\n \n class AdminAuthenticationForm(AuthenticationForm):\n     \"\"\""
        },
        {
            "sha": "b6e7b9ebbb2ec75a3c2d1f0462a70f64d2b1046c",
            "filename": "tests/regressiontests/admin_views/tests.py",
            "status": "modified",
            "additions": 9,
            "deletions": 6,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/0781ed8ec8dab4f4658787c9dc1ca8499ccc1a18/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0781ed8ec8dab4f4658787c9dc1ca8499ccc1a18/tests%2Fregressiontests%2Fadmin_views%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Ftests.py?ref=0781ed8ec8dab4f4658787c9dc1ca8499ccc1a18",
            "patch": "@@ -40,6 +40,9 @@\n     RowLevelChangePermissionModel, Paper, CoverLetter, Story, OtherStory,\n     ComplexSortedPerson, Parent, Child)\n \n+ERROR_MESSAGE = \"Please enter the correct username and password \\\n+for a staff account. Note that both fields are case-sensitive.\"\n+\n \n class AdminViewBasicTest(TestCase):\n     fixtures = ['admin-views-users.xml', 'admin-views-colors.xml',\n@@ -761,12 +764,12 @@ def testLogin(self):\n         self.assertContains(login, \"Your e-mail address is not your username\")\n         # only correct passwords get a username hint\n         login = self.client.post('/test_admin/admin/', self.super_email_bad_login)\n-        self.assertContains(login, \"Please enter a correct username and password.\")\n+        self.assertContains(login, ERROR_MESSAGE)\n         new_user = User(username='jondoe', password='secret', email='super@example.com')\n         new_user.save()\n         # check to ensure if there are multiple e-mail addresses a user doesn't get a 500\n         login = self.client.post('/test_admin/admin/', self.super_email_login)\n-        self.assertContains(login, \"Please enter a correct username and password.\")\n+        self.assertContains(login, ERROR_MESSAGE)\n \n         # Add User\n         request = self.client.get('/test_admin/admin/')\n@@ -797,7 +800,7 @@ def testLogin(self):\n         self.assertEqual(request.status_code, 200)\n         login = self.client.post('/test_admin/admin/', self.joepublic_login)\n         self.assertEqual(login.status_code, 200)\n-        self.assertContains(login, \"Please enter a correct username and password.\")\n+        self.assertContains(login, ERROR_MESSAGE)\n \n         # Requests without username should not return 500 errors.\n         request = self.client.get('/test_admin/admin/')\n@@ -1360,12 +1363,12 @@ def test_staff_member_required_decorator_works_as_per_admin_login(self):\n         self.assertContains(login, \"Your e-mail address is not your username\")\n         # only correct passwords get a username hint\n         login = self.client.post('/test_admin/admin/secure-view/', self.super_email_bad_login)\n-        self.assertContains(login, \"Please enter a correct username and password.\")\n+        self.assertContains(login, ERROR_MESSAGE)\n         new_user = User(username='jondoe', password='secret', email='super@example.com')\n         new_user.save()\n         # check to ensure if there are multiple e-mail addresses a user doesn't get a 500\n         login = self.client.post('/test_admin/admin/secure-view/', self.super_email_login)\n-        self.assertContains(login, \"Please enter a correct username and password.\")\n+        self.assertContains(login, ERROR_MESSAGE)\n \n         # Add User\n         request = self.client.get('/test_admin/admin/secure-view/')\n@@ -1397,7 +1400,7 @@ def test_staff_member_required_decorator_works_as_per_admin_login(self):\n         login = self.client.post('/test_admin/admin/secure-view/', self.joepublic_login)\n         self.assertEqual(login.status_code, 200)\n         # Login.context is a list of context dicts we just need to check the first one.\n-        self.assertContains(login, \"Please enter a correct username and password.\")\n+        self.assertContains(login, ERROR_MESSAGE)\n \n         # 8509 - if a normal user is already logged in, it is possible\n         # to change user into the superuser without error"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 11,
        "deletions": 8
    }
}