{
    "author": "SmileyChris",
    "message": "Fix and test for cleaning a non-string value in a URLField\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16747 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "fe88584589922c1a0e068f18c82fe1b17e437fcd",
    "files": [
        {
            "sha": "6fe25a90439e00a02daa145e31e7c74aca81041c",
            "filename": "django/forms/fields.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/fe88584589922c1a0e068f18c82fe1b17e437fcd/django%2Fforms%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/fe88584589922c1a0e068f18c82fe1b17e437fcd/django%2Fforms%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Ffields.py?ref=fe88584589922c1a0e068f18c82fe1b17e437fcd",
            "patch": "@@ -583,6 +583,7 @@ def __init__(self, max_length=None, min_length=None, verify_exists=False,\n         self.validators.append(validators.URLValidator(verify_exists=verify_exists, validator_user_agent=validator_user_agent))\n \n     def to_python(self, value):\n+        value = super(URLField, self).to_python(value)\n         if value:\n             url_fields = list(urlparse.urlsplit(value))\n             if not url_fields[0]:\n@@ -601,7 +602,7 @@ def to_python(self, value):\n                 # the path portion may need to be added before query params\n                 url_fields[2] = '/'\n             value = urlparse.urlunsplit(url_fields)\n-        return super(URLField, self).to_python(value)\n+        return value\n \n class BooleanField(Field):\n     widget = CheckboxInput"
        },
        {
            "sha": "7cbe2eaccf43357b69de4ae564a84514ac713f42",
            "filename": "tests/regressiontests/forms/tests/fields.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fe88584589922c1a0e068f18c82fe1b17e437fcd/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "raw_url": "https://github.com/django/django/raw/fe88584589922c1a0e068f18c82fe1b17e437fcd/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Ffields.py?ref=fe88584589922c1a0e068f18c82fe1b17e437fcd",
            "patch": "@@ -686,6 +686,10 @@ def test_urlfield_10(self):\n         url = u'http://t\\xfcr.djangoproject.com/'\n         self.assertEqual(url, f.clean(url))\n \n+    def test_urlfield_not_string(self):\n+        f = URLField(required=False)\n+        self.assertRaisesMessage(ValidationError, \"[u'Enter a valid URL.']\", f.clean, 23)\n+\n     # BooleanField ################################################################\n \n     def test_booleanfield_1(self):"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
    }
}