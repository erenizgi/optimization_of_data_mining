{
    "author": "ramiro",
    "message": "Fixed #11369 -- Corrected verbose_name_plural model Meta option to be consistent with verbose_name when using abstract model inheritance. Thanks Beetle_B for the report.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@14588 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "5666bca67872a628631642743375d31956f24a2f",
    "files": [
        {
            "sha": "a3697c2a13579dd1388e4177210f00ab4dfc41c4",
            "filename": "django/db/models/options.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/5666bca67872a628631642743375d31956f24a2f/django%2Fdb%2Fmodels%2Foptions.py",
            "raw_url": "https://github.com/django/django/raw/5666bca67872a628631642743375d31956f24a2f/django%2Fdb%2Fmodels%2Foptions.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Foptions.py?ref=5666bca67872a628631642743375d31956f24a2f",
            "patch": "@@ -19,7 +19,7 @@\n # Calculate the verbose_name by converting from InitialCaps to \"lowercase with spaces\".\n get_verbose_name = lambda class_name: re.sub('(((?<=[a-z])[A-Z])|([A-Z](?![A-Z]|$)))', ' \\\\1', class_name).lower().strip()\n \n-DEFAULT_NAMES = ('verbose_name', 'db_table', 'ordering',\n+DEFAULT_NAMES = ('verbose_name', 'verbose_name_plural', 'db_table', 'ordering',\n                  'unique_together', 'permissions', 'get_latest_by',\n                  'order_with_respect_to', 'app_label', 'db_tablespace',\n                  'abstract', 'managed', 'proxy', 'auto_created')\n@@ -91,7 +91,8 @@ def contribute_to_class(self, cls, name):\n \n             # verbose_name_plural is a special case because it uses a 's'\n             # by default.\n-            self.verbose_name_plural = meta_attrs.pop('verbose_name_plural', string_concat(self.verbose_name, 's'))\n+            if self.verbose_name_plural is None:\n+                self.verbose_name_plural = string_concat(self.verbose_name, 's')\n \n             # Any leftover attributes must be invalid.\n             if meta_attrs != {}:"
        },
        {
            "sha": "787f16334995138faeb12c01970cd54d385ab231",
            "filename": "tests/regressiontests/model_inheritance_regress/models.py",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/5666bca67872a628631642743375d31956f24a2f/tests%2Fregressiontests%2Fmodel_inheritance_regress%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/5666bca67872a628631642743375d31956f24a2f/tests%2Fregressiontests%2Fmodel_inheritance_regress%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmodel_inheritance_regress%2Fmodels.py?ref=5666bca67872a628631642743375d31956f24a2f",
            "patch": "@@ -103,6 +103,20 @@ def __unicode__(self):\n         return \"PK = %d, base_name = %s, derived_name = %s\" \\\n                 % (self.customPK, self.base_name, self.derived_name)\n \n+class AuditBase(models.Model):\n+    planned_date = models.DateField()\n+\n+    class Meta:\n+        abstract = True\n+        verbose_name_plural = u'Audits'\n+\n+class CertificationAudit(AuditBase):\n+    class Meta(AuditBase.Meta):\n+        abstract = True\n+\n+class InternalCertificationAudit(CertificationAudit):\n+    auditing_dept = models.CharField(max_length=20)\n+\n # Check that abstract classes don't get m2m tables autocreated.\n class Person(models.Model):\n     name = models.CharField(max_length=100)"
        },
        {
            "sha": "569cef5845b2e5146389925e9313ff6ef7a3300a",
            "filename": "tests/regressiontests/model_inheritance_regress/tests.py",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/5666bca67872a628631642743375d31956f24a2f/tests%2Fregressiontests%2Fmodel_inheritance_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/5666bca67872a628631642743375d31956f24a2f/tests%2Fregressiontests%2Fmodel_inheritance_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fmodel_inheritance_regress%2Ftests.py?ref=5666bca67872a628631642743375d31956f24a2f",
            "patch": "@@ -8,7 +8,7 @@\n     Place, Restaurant, ItalianRestaurant, ParkingLot, ParkingLot2,\n     ParkingLot3, Supplier, Wholesaler, Child, SelfRefChild, ArticleWithAuthor,\n     M2MChild, QualityControl, DerivedM, Person, BirthdayParty, BachelorParty,\n-    MessyBachelorParty)\n+    MessyBachelorParty, InternalCertificationAudit)\n \n class ModelInheritanceTest(TestCase):\n     def test_model_inheritance(self):\n@@ -353,3 +353,14 @@ def test_abstract_base_class_m2m_relation_inheritance(self):\n \n         parties = list(p4.bachelorparty_set.all())\n         self.assertEqual(parties, [bachelor, messy_parent])\n+\n+    def test_11369(self):\n+        \"\"\"verbose_name_plural correctly inherited from ABC if inheritance chain includes an abstract model.\"\"\"\n+        # Regression test for #11369: verbose_name_plural should be inherited\n+        # from an ABC even when there are one or more intermediate\n+        # abstract models in the inheritance chain, for consistency with\n+        # verbose_name.\n+        self.assertEquals(\n+                InternalCertificationAudit._meta.verbose_name_plural,\n+                u'Audits'\n+        )"
        }
    ],
    "stats": {
        "total": 32,
        "additions": 29,
        "deletions": 3
    }
}