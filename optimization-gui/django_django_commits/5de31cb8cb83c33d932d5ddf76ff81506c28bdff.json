{
    "author": "kmtracey",
    "message": "Refs #17215: Avoid generating 47 leftover tmp dirs during a clean test run.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17094 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "5de31cb8cb83c33d932d5ddf76ff81506c28bdff",
    "files": [
        {
            "sha": "9013e89aef308ec73d87cf15a9f0b53424f58edb",
            "filename": "django/contrib/formtools/tests/wizard/wizardtests/forms.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fwizardtests%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fwizardtests%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Ftests%2Fwizard%2Fwizardtests%2Fforms.py?ref=5de31cb8cb83c33d932d5ddf76ff81506c28bdff",
            "patch": "@@ -1,3 +1,4 @@\n+import os\n import tempfile\n \n from django import forms\n@@ -10,7 +11,7 @@\n \n from django.contrib.formtools.wizard.views import WizardView\n \n-temp_storage_location = tempfile.mkdtemp()\n+temp_storage_location = tempfile.mkdtemp(dir=os.environ.get('DJANGO_TEST_TEMP_DIR'))\n temp_storage = FileSystemStorage(location=temp_storage_location)\n \n class Page1(forms.Form):"
        },
        {
            "sha": "35fc9a7bc1a01d65da9f25383848401597d75e65",
            "filename": "tests/modeltests/model_forms/models.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fmodeltests%2Fmodel_forms%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fmodeltests%2Fmodel_forms%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fmodel_forms%2Fmodels.py?ref=5de31cb8cb83c33d932d5ddf76ff81506c28bdff",
            "patch": "@@ -7,13 +7,14 @@\n words, most of these tests should be rewritten.\n \"\"\"\n \n+import os\n import tempfile\n \n from django.core.files.storage import FileSystemStorage\n from django.db import models\n \n \n-temp_storage_dir = tempfile.mkdtemp()\n+temp_storage_dir = tempfile.mkdtemp(dir=os.environ['DJANGO_TEST_TEMP_DIR'])\n temp_storage = FileSystemStorage(temp_storage_dir)\n \n ARTICLE_STATUS = ("
        },
        {
            "sha": "66e76dd369e37e8cab2ce66ac978ade4330761a4",
            "filename": "tests/regressiontests/admin_views/admin.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fregressiontests%2Fadmin_views%2Fadmin.py",
            "raw_url": "https://github.com/django/django/raw/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fregressiontests%2Fadmin_views%2Fadmin.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Fadmin.py?ref=5de31cb8cb83c33d932d5ddf76ff81506c28bdff",
            "patch": "@@ -260,7 +260,7 @@ class OldSubscriberAdmin(admin.ModelAdmin):\n     actions = None\n \n \n-temp_storage = FileSystemStorage(tempfile.mkdtemp())\n+temp_storage = FileSystemStorage(tempfile.mkdtemp(dir=os.environ['DJANGO_TEST_TEMP_DIR']))\n UPLOAD_TO = os.path.join(temp_storage.location, 'test_upload')\n \n "
        },
        {
            "sha": "d1a5d19dd0ca96a02b6a6114c5e3f44b460899ef",
            "filename": "tests/regressiontests/admin_views/models.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fregressiontests%2Fadmin_views%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fregressiontests%2Fadmin_views%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_views%2Fmodels.py?ref=5de31cb8cb83c33d932d5ddf76ff81506c28bdff",
            "patch": "@@ -246,7 +246,7 @@ def __unicode__(self):\n         return \"Primary key = %s\" % self.id\n \n \n-temp_storage = FileSystemStorage(tempfile.mkdtemp())\n+temp_storage = FileSystemStorage(tempfile.mkdtemp(dir=os.environ['DJANGO_TEST_TEMP_DIR']))\n UPLOAD_TO = os.path.join(temp_storage.location, 'test_upload')\n \n \n@@ -547,4 +547,4 @@ class PrePopulatedPostLargeSlug(models.Model):\n     title = models.CharField(max_length=100) \n     published = models.BooleanField() \n     slug = models.SlugField(max_length=1000)\n-    \n\\ No newline at end of file\n+    "
        },
        {
            "sha": "939055785aa3a1135f143fd3daba03be7f62b460",
            "filename": "tests/regressiontests/forms/models.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fregressiontests%2Fforms%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fregressiontests%2Fforms%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Fmodels.py?ref=5de31cb8cb83c33d932d5ddf76ff81506c28bdff",
            "patch": "@@ -1,12 +1,13 @@\n # -*- coding: utf-8 -*-\n+import os\n import datetime\n import tempfile\n \n from django.core.files.storage import FileSystemStorage\n from django.db import models\n \n \n-temp_storage_location = tempfile.mkdtemp()\n+temp_storage_location = tempfile.mkdtemp(dir=os.environ['DJANGO_TEST_TEMP_DIR'])\n temp_storage = FileSystemStorage(location=temp_storage_location)\n \n "
        },
        {
            "sha": "7f0e431275ef5b1286814ccb539932199fbe98da",
            "filename": "tests/regressiontests/staticfiles_tests/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py?ref=5de31cb8cb83c33d932d5ddf76ff81506c28bdff",
            "patch": "@@ -100,7 +100,7 @@ class BaseCollectionTestCase(BaseStaticFilesTestCase):\n     def setUp(self):\n         super(BaseCollectionTestCase, self).setUp()\n         self.old_root = settings.STATIC_ROOT\n-        settings.STATIC_ROOT = tempfile.mkdtemp()\n+        settings.STATIC_ROOT = tempfile.mkdtemp(dir=os.environ['DJANGO_TEST_TEMP_DIR'])\n         self.run_collectstatic()\n         # Use our own error handler that can handle .svn dirs on Windows\n         #self.addCleanup(shutil.rmtree, settings.STATIC_ROOT,"
        },
        {
            "sha": "c38c4c2202f995813f795a6dc417b8cb7597b350",
            "filename": "tests/runtests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fruntests.py",
            "raw_url": "https://github.com/django/django/raw/5de31cb8cb83c33d932d5ddf76ff81506c28bdff/tests%2Fruntests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fruntests.py?ref=5de31cb8cb83c33d932d5ddf76ff81506c28bdff",
            "patch": "@@ -19,6 +19,7 @@\n MODEL_TEST_DIR = os.path.join(RUNTESTS_DIR, MODEL_TESTS_DIR_NAME)\n REGRESSION_TEST_DIR = os.path.join(RUNTESTS_DIR, REGRESSION_TESTS_DIR_NAME)\n TEMP_DIR = tempfile.mkdtemp(prefix='django_')\n+os.environ['DJANGO_TEST_TEMP_DIR'] = TEMP_DIR\n \n REGRESSION_SUBDIRS_TO_SKIP = ['locale']\n "
        }
    ],
    "stats": {
        "total": 18,
        "additions": 11,
        "deletions": 7
    }
}