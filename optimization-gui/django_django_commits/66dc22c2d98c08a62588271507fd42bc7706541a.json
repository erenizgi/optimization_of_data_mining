{
    "author": "jezdez",
    "message": "Fixed #16909 -- Pass language to get_format_modules when calling it from get_format to make sure the correct module is returned.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16884 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "66dc22c2d98c08a62588271507fd42bc7706541a",
    "files": [
        {
            "sha": "3babccb0a0c2de69a83bd68a92db90b69a6492c2",
            "filename": "django/utils/formats.py",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/66dc22c2d98c08a62588271507fd42bc7706541a/django%2Futils%2Fformats.py",
            "raw_url": "https://github.com/django/django/raw/66dc22c2d98c08a62588271507fd42bc7706541a/django%2Futils%2Fformats.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fformats.py?ref=66dc22c2d98c08a62588271507fd42bc7706541a",
            "patch": "@@ -45,11 +45,12 @@ def iter_format_modules(lang):\n                 except ImportError:\n                     pass\n \n-def get_format_modules(reverse=False):\n+def get_format_modules(lang=None, reverse=False):\n     \"\"\"\n     Returns a list of the format modules found\n     \"\"\"\n-    lang = get_language()\n+    if lang is None:\n+        lang = get_language()\n     modules = _format_modules_cache.setdefault(lang, list(iter_format_modules(lang)))\n     if reverse:\n         return list(reversed(modules))\n@@ -72,7 +73,7 @@ def get_format(format_type, lang=None, use_l10n=None):\n         try:\n             return _format_cache[cache_key] or getattr(settings, format_type)\n         except KeyError:\n-            for module in get_format_modules():\n+            for module in get_format_modules(lang):\n                 try:\n                     val = getattr(module, format_type)\n                     _format_cache[cache_key] = val"
        },
        {
            "sha": "68eafbf276960388387af79349567c9c9ad42c52",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/66dc22c2d98c08a62588271507fd42bc7706541a/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/66dc22c2d98c08a62588271507fd42bc7706541a/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=66dc22c2d98c08a62588271507fd42bc7706541a",
            "patch": "@@ -480,6 +480,11 @@ def test_iter_format_modules_stability(self):\n         en_gb_format_mod = import_module('django.conf.locale.en_GB.formats')\n         self.assertEqual(list(iter_format_modules('en-gb')), [en_gb_format_mod, en_format_mod])\n \n+    def test_get_format_modules_lang(self):\n+        with self.settings(USE_L10N=True):\n+            with translation.override('de', deactivate=True):\n+                self.assertEqual('.', get_format('DECIMAL_SEPARATOR', lang='en'))\n+\n     def test_get_format_modules_stability(self):\n         with self.settings(USE_L10N=True,\n                 FORMAT_MODULE_PATH='regressiontests.i18n.other.locale'):"
        }
    ],
    "stats": {
        "total": 12,
        "additions": 9,
        "deletions": 3
    }
}