{
    "author": "freakboy3742",
    "message": "Fixed #19150 -- Added validation for USERNAME_FIELD being included in REQUIRED_FIELDS.\n\nThanks to Chris Pagnutti for the suggestion.",
    "sha": "7a908747a52f7cc12d7006058daad6a6c973c462",
    "files": [
        {
            "sha": "957a712b72e7d24b5ebcceb75aba00e65b926be5",
            "filename": "django/core/management/validation.py",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/7a908747a52f7cc12d7006058daad6a6c973c462/django%2Fcore%2Fmanagement%2Fvalidation.py",
            "raw_url": "https://github.com/django/django/raw/7a908747a52f7cc12d7006058daad6a6c973c462/django%2Fcore%2Fmanagement%2Fvalidation.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fvalidation.py?ref=7a908747a52f7cc12d7006058daad6a6c973c462",
            "patch": "@@ -1,5 +1,6 @@\n import sys\n \n+from django.conf import settings\n from django.core.management.color import color_style\n from django.utils.encoding import force_str\n from django.utils.itercompat import is_iterable\n@@ -48,6 +49,12 @@ def get_validation_errors(outfile, app=None):\n             # No need to perform any other validation checks on a swapped model.\n             continue\n \n+        # This is the current User model. Check known validation problems with User models\n+        if settings.AUTH_USER_MODEL == '%s.%s' % (opts.app_label, opts.object_name):\n+            # Check that the USERNAME FIELD isn't included in REQUIRED_FIELDS.\n+            if cls.USERNAME_FIELD in cls.REQUIRED_FIELDS:\n+                e.add(opts, 'The field named as the USERNAME_FIELD should not be included in REQUIRED_FIELDS on a swappable User model.')\n+\n         # Model isn't swapped; do field-specific validation.\n         for f in opts.local_fields:\n             if f.name == 'id' and not f.primary_key and opts.pk.name == 'id':"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
    }
}