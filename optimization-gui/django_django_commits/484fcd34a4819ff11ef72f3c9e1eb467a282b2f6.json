{
    "author": "akaariai",
    "message": "Fixed #16418 -- Made generic views work with ModelForms\n\nGeneric views assumed any object's _meta will be model Options. This\nis not true for ModelForms for example. Took isinstance(obj, Model)\nin use instead.",
    "sha": "484fcd34a4819ff11ef72f3c9e1eb467a282b2f6",
    "files": [
        {
            "sha": "a5ddb5fe3e4f5cfe57282c202b19d1bc86450417",
            "filename": "django/views/generic/detail.py",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/484fcd34a4819ff11ef72f3c9e1eb467a282b2f6/django%2Fviews%2Fgeneric%2Fdetail.py",
            "raw_url": "https://github.com/django/django/raw/484fcd34a4819ff11ef72f3c9e1eb467a282b2f6/django%2Fviews%2Fgeneric%2Fdetail.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fviews%2Fgeneric%2Fdetail.py?ref=484fcd34a4819ff11ef72f3c9e1eb467a282b2f6",
            "patch": "@@ -1,6 +1,7 @@\n from __future__ import unicode_literals\n \n from django.core.exceptions import ImproperlyConfigured, ObjectDoesNotExist\n+from django.db import models\n from django.http import Http404\n from django.utils.translation import ugettext as _\n from django.views.generic.base import TemplateResponseMixin, ContextMixin, View\n@@ -81,7 +82,7 @@ def get_context_object_name(self, obj):\n         \"\"\"\n         if self.context_object_name:\n             return self.context_object_name\n-        elif hasattr(obj, '_meta'):\n+        elif isinstance(obj, models.Model):\n             return obj._meta.object_name.lower()\n         else:\n             return None\n@@ -128,13 +129,13 @@ def get_template_names(self):\n \n         # The least-specific option is the default <app>/<model>_detail.html;\n         # only use this if the object in question is a model.\n-        if hasattr(self.object, '_meta'):\n+        if isinstance(self.object, models.Model):\n             names.append(\"%s/%s%s.html\" % (\n                 self.object._meta.app_label,\n                 self.object._meta.object_name.lower(),\n                 self.template_name_suffix\n             ))\n-        elif hasattr(self, 'model') and hasattr(self.model, '_meta'):\n+        elif hasattr(self, 'model') and self.model is not None and issubclass(self.model, models.Model):\n             names.append(\"%s/%s%s.html\" % (\n                 self.model._meta.app_label,\n                 self.model._meta.object_name.lower(),"
        },
        {
            "sha": "60c5f7afe9589abd4eac52e83444ae1a047fdb7a",
            "filename": "tests/regressiontests/generic_views/detail.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/484fcd34a4819ff11ef72f3c9e1eb467a282b2f6/tests%2Fregressiontests%2Fgeneric_views%2Fdetail.py",
            "raw_url": "https://github.com/django/django/raw/484fcd34a4819ff11ef72f3c9e1eb467a282b2f6/tests%2Fregressiontests%2Fgeneric_views%2Fdetail.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Fdetail.py?ref=484fcd34a4819ff11ef72f3c9e1eb467a282b2f6",
            "patch": "@@ -92,3 +92,8 @@ def test_invalid_url(self):\n \n     def test_invalid_queryset(self):\n         self.assertRaises(ImproperlyConfigured, self.client.get, '/detail/author/invalid/qs/')\n+\n+    def test_non_model_object_with_meta(self):\n+        res = self.client.get('/detail/nonmodel/1/')\n+        self.assertEqual(res.status_code, 200)\n+        self.assertEqual(res.context['object'].id, \"non_model_1\")"
        },
        {
            "sha": "5e15c6c9c1fe57e5eff6036909f3f701dcb056b8",
            "filename": "tests/regressiontests/generic_views/urls.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/484fcd34a4819ff11ef72f3c9e1eb467a282b2f6/tests%2Fregressiontests%2Fgeneric_views%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/484fcd34a4819ff11ef72f3c9e1eb467a282b2f6/tests%2Fregressiontests%2Fgeneric_views%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Furls.py?ref=484fcd34a4819ff11ef72f3c9e1eb467a282b2f6",
            "patch": "@@ -53,6 +53,8 @@\n         views.AuthorDetail.as_view()),\n     (r'^detail/author/invalid/qs/$',\n         views.AuthorDetail.as_view(queryset=None)),\n+    (r'^detail/nonmodel/1/$',\n+        views.NonModelDetail.as_view()),\n \n     # Create/UpdateView\n     (r'^edit/artists/create/$',"
        },
        {
            "sha": "f7fcf6f5099c3dc6ff35609546fe2c90c186de2a",
            "filename": "tests/regressiontests/generic_views/views.py",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/484fcd34a4819ff11ef72f3c9e1eb467a282b2f6/tests%2Fregressiontests%2Fgeneric_views%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/484fcd34a4819ff11ef72f3c9e1eb467a282b2f6/tests%2Fregressiontests%2Fgeneric_views%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Fviews.py?ref=484fcd34a4819ff11ef72f3c9e1eb467a282b2f6",
            "patch": "@@ -226,3 +226,18 @@ class BookSigningTodayArchive(BookSigningConfig, generic.TodayArchiveView):\n \n class BookSigningDetail(BookSigningConfig, generic.DateDetailView):\n     context_object_name = 'book'\n+\n+\n+class NonModel(object):\n+    id = \"non_model_1\"\n+\n+    _meta = None\n+\n+\n+class NonModelDetail(generic.DetailView):\n+\n+    template_name = 'generic_views/detail.html'\n+    model = NonModel\n+\n+    def get_object(self, queryset=None):\n+        return NonModel()"
        }
    ],
    "stats": {
        "total": 29,
        "additions": 26,
        "deletions": 3
    }
}