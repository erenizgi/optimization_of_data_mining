{
    "author": "jezdez",
    "message": "Fixed #11989 -- Allow passing a Template instance to inclusion_tag. Thanks to Jeremy Dunck and tcoenen.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16374 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "0ebaf10258bf9fad4d540025a6eb3a8c471b284c",
    "files": [
        {
            "sha": "b96e446404a3728560b7c6a66ed153952b1df1e6",
            "filename": "django/template/base.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/0ebaf10258bf9fad4d540025a6eb3a8c471b284c/django%2Ftemplate%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/0ebaf10258bf9fad4d540025a6eb3a8c471b284c/django%2Ftemplate%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fbase.py?ref=0ebaf10258bf9fad4d540025a6eb3a8c471b284c",
            "patch": "@@ -987,7 +987,9 @@ def render(self, context):\n \n                     if not getattr(self, 'nodelist', False):\n                         from django.template.loader import get_template, select_template\n-                        if not isinstance(file_name, basestring) and is_iterable(file_name):\n+                        if isinstance(file_name, Template):\n+                            t = file_name\n+                        elif not isinstance(file_name, basestring) and is_iterable(file_name):\n                             t = select_template(file_name)\n                         else:\n                             t = get_template(file_name)"
        },
        {
            "sha": "1e226840d63fd3115ebfe7381c2c3325bd032b83",
            "filename": "docs/howto/custom-template-tags.txt",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/0ebaf10258bf9fad4d540025a6eb3a8c471b284c/docs%2Fhowto%2Fcustom-template-tags.txt",
            "raw_url": "https://github.com/django/django/raw/0ebaf10258bf9fad4d540025a6eb3a8c471b284c/docs%2Fhowto%2Fcustom-template-tags.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fhowto%2Fcustom-template-tags.txt?ref=0ebaf10258bf9fad4d540025a6eb3a8c471b284c",
            "patch": "@@ -822,6 +822,15 @@ loader, we'd register the tag like this::\n     # Here, register is a django.template.Library instance, as before\n     register.inclusion_tag('results.html')(show_results)\n \n+.. versionchanged:: 1.4\n+\n+    Alternatively it is possible to register the inclusion tag using a\n+    :class:`django.template.Template` instance::\n+\n+        from django.template.loader import get_template\n+        t = get_template('results.html')\n+        register.inclusion_tag(t)(show_results)\n+\n As always, decorator syntax works as well, so we could have written::\n \n     @register.inclusion_tag('results.html')"
        },
        {
            "sha": "74c39ab7e00b8d669180838b727f44b07b34182a",
            "filename": "tests/regressiontests/templates/custom.py",
            "status": "modified",
            "additions": 18,
            "deletions": 0,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/0ebaf10258bf9fad4d540025a6eb3a8c471b284c/tests%2Fregressiontests%2Ftemplates%2Fcustom.py",
            "raw_url": "https://github.com/django/django/raw/0ebaf10258bf9fad4d540025a6eb3a8c471b284c/tests%2Fregressiontests%2Ftemplates%2Fcustom.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftemplates%2Fcustom.py?ref=0ebaf10258bf9fad4d540025a6eb3a8c471b284c",
            "patch": "@@ -73,6 +73,24 @@ def test_inclusion_tags(self):\n         t = template.Template('{% load custom %}{% inclusion_params_and_context 37 %}')\n         self.assertEqual(t.render(c), u'inclusion_params_and_context - Expected result (context value: 42): 37\\n')\n \n+    def test_inclusion_tags_from_template(self):\n+        c = template.Context({'value': 42})\n+\n+        t = template.Template('{% load custom %}{% inclusion_no_params_from_template %}')\n+        self.assertEqual(t.render(c), u'inclusion_no_params_from_template - Expected result\\n')\n+\n+        t = template.Template('{% load custom %}{% inclusion_one_param_from_template 37 %}')\n+        self.assertEqual(t.render(c), u'inclusion_one_param_from_template - Expected result: 37\\n')\n+\n+        t = template.Template('{% load custom %}{% inclusion_explicit_no_context_from_template 37 %}')\n+        self.assertEqual(t.render(c), u'inclusion_explicit_no_context_from_template - Expected result: 37\\n')\n+\n+        t = template.Template('{% load custom %}{% inclusion_no_params_with_context_from_template %}')\n+        self.assertEqual(t.render(c), u'inclusion_no_params_with_context_from_template - Expected result (context value: 42)\\n')\n+\n+        t = template.Template('{% load custom %}{% inclusion_params_and_context_from_template 37 %}')\n+        self.assertEqual(t.render(c), u'inclusion_params_and_context_from_template - Expected result (context value: 42): 37\\n')\n+\n     def test_inclusion_tag_registration(self):\n         # Test that the decorators preserve the decorated function's docstring, name and attributes.\n         self.verify_tag(custom.inclusion_no_params, 'inclusion_no_params')"
        },
        {
            "sha": "dfa4171eb09a74714c9fab6cf1178c1ab73c5be6",
            "filename": "tests/regressiontests/templates/templatetags/custom.py",
            "status": "modified",
            "additions": 31,
            "deletions": 0,
            "changes": 31,
            "blob_url": "https://github.com/django/django/blob/0ebaf10258bf9fad4d540025a6eb3a8c471b284c/tests%2Fregressiontests%2Ftemplates%2Ftemplatetags%2Fcustom.py",
            "raw_url": "https://github.com/django/django/raw/0ebaf10258bf9fad4d540025a6eb3a8c471b284c/tests%2Fregressiontests%2Ftemplates%2Ftemplatetags%2Fcustom.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftemplates%2Ftemplatetags%2Fcustom.py?ref=0ebaf10258bf9fad4d540025a6eb3a8c471b284c",
            "patch": "@@ -1,5 +1,6 @@\n from django import template\n from django.template.defaultfilters import stringfilter\n+from django.template.loader import get_template\n \n register = template.Library()\n \n@@ -45,30 +46,60 @@ def inclusion_no_params():\n     return {\"result\" : \"inclusion_no_params - Expected result\"}\n inclusion_no_params.anything = \"Expected inclusion_no_params __dict__\"\n \n+@register.inclusion_tag(get_template('inclusion.html'))\n+def inclusion_no_params_from_template():\n+    \"\"\"Expected inclusion_no_params_from_template __doc__\"\"\"\n+    return {\"result\" : \"inclusion_no_params_from_template - Expected result\"}\n+inclusion_no_params_from_template.anything = \"Expected inclusion_no_params_from_template __dict__\"\n+\n @register.inclusion_tag('inclusion.html')\n def inclusion_one_param(arg):\n     \"\"\"Expected inclusion_one_param __doc__\"\"\"\n     return {\"result\" : \"inclusion_one_param - Expected result: %s\" % arg}\n inclusion_one_param.anything = \"Expected inclusion_one_param __dict__\"\n \n+@register.inclusion_tag(get_template('inclusion.html'))\n+def inclusion_one_param_from_template(arg):\n+    \"\"\"Expected inclusion_one_param_from_template __doc__\"\"\"\n+    return {\"result\" : \"inclusion_one_param_from_template - Expected result: %s\" % arg}\n+inclusion_one_param_from_template.anything = \"Expected inclusion_one_param_from_template __dict__\"\n+\n @register.inclusion_tag('inclusion.html', takes_context=False)\n def inclusion_explicit_no_context(arg):\n     \"\"\"Expected inclusion_explicit_no_context __doc__\"\"\"\n     return {\"result\" : \"inclusion_explicit_no_context - Expected result: %s\" % arg}\n inclusion_explicit_no_context.anything = \"Expected inclusion_explicit_no_context __dict__\"\n \n+@register.inclusion_tag(get_template('inclusion.html'), takes_context=False)\n+def inclusion_explicit_no_context_from_template(arg):\n+    \"\"\"Expected inclusion_explicit_no_context_from_template __doc__\"\"\"\n+    return {\"result\" : \"inclusion_explicit_no_context_from_template - Expected result: %s\" % arg}\n+inclusion_explicit_no_context_from_template.anything = \"Expected inclusion_explicit_no_context_from_template __dict__\"\n+\n @register.inclusion_tag('inclusion.html', takes_context=True)\n def inclusion_no_params_with_context(context):\n     \"\"\"Expected inclusion_no_params_with_context __doc__\"\"\"\n     return {\"result\" : \"inclusion_no_params_with_context - Expected result (context value: %s)\" % context['value']}\n inclusion_no_params_with_context.anything = \"Expected inclusion_no_params_with_context __dict__\"\n \n+@register.inclusion_tag(get_template('inclusion.html'), takes_context=True)\n+def inclusion_no_params_with_context_from_template(context):\n+    \"\"\"Expected inclusion_no_params_with_context_from_template __doc__\"\"\"\n+    return {\"result\" : \"inclusion_no_params_with_context_from_template - Expected result (context value: %s)\" % context['value']}\n+inclusion_no_params_with_context_from_template.anything = \"Expected inclusion_no_params_with_context_from_template __dict__\"\n+\n @register.inclusion_tag('inclusion.html', takes_context=True)\n def inclusion_params_and_context(context, arg):\n     \"\"\"Expected inclusion_params_and_context __doc__\"\"\"\n     return {\"result\" : \"inclusion_params_and_context - Expected result (context value: %s): %s\" % (context['value'], arg)}\n inclusion_params_and_context.anything = \"Expected inclusion_params_and_context __dict__\"\n \n+@register.inclusion_tag(get_template('inclusion.html'), takes_context=True)\n+def inclusion_params_and_context_from_template(context, arg):\n+    \"\"\"Expected inclusion_params_and_context_from_template __doc__\"\"\"\n+    return {\"result\" : \"inclusion_params_and_context_from_template - Expected result (context value: %s): %s\" % (context['value'], arg)}\n+inclusion_params_and_context_from_template.anything = \"Expected inclusion_params_and_context_from_template __dict__\"\n+\n @register.simple_tag(takes_context=True)\n def current_app(context):\n     return \"%s\" % context.current_app"
        }
    ],
    "stats": {
        "total": 62,
        "additions": 61,
        "deletions": 1
    }
}