{
    "author": "jezdez",
    "message": "Added a few cross references to the i18n docs and documented pgettext and colleagues.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16403 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "62bb4b8c37ada04c10d2a37990326636ea7791d6",
    "files": [
        {
            "sha": "3d70c2989b82520f9cea6327ccaa5a9825424d73",
            "filename": "docs/ref/utils.txt",
            "status": "modified",
            "additions": 57,
            "deletions": 0,
            "changes": 57,
            "blob_url": "https://github.com/django/django/blob/62bb4b8c37ada04c10d2a37990326636ea7791d6/docs%2Fref%2Futils.txt",
            "raw_url": "https://github.com/django/django/raw/62bb4b8c37ada04c10d2a37990326636ea7791d6/docs%2Fref%2Futils.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Futils.txt?ref=62bb4b8c37ada04c10d2a37990326636ea7791d6",
            "patch": "@@ -315,6 +315,48 @@ Atom1Feed\n \n     Spec: http://atompub.org/2005/07/11/draft-ietf-atompub-format-10.html\n \n+``django.utils.functional``\n+===========================\n+\n+.. module:: django.utils.functional\n+    :synopsis: Functional programming tools.\n+\n+.. function:: allow_lazy(func, *resultclasses)\n+\n+    Django offers many utility functions (particularly in ``django.utils``) that\n+    take a string as their first argument and do something to that string. These\n+    functions are used by template filters as well as directly in other code.\n+\n+    If you write your own similar functions and deal with translations, you'll\n+    face the problem of what to do when the first argument is a lazy translation\n+    object. You don't want to convert it to a string immediately, because you might\n+    be using this function outside of a view (and hence the current thread's locale\n+    setting will not be correct).\n+\n+    For cases like this, use the ``django.utils.functional.allow_lazy()``\n+    decorator. It modifies the function so that *if* it's called with a lazy\n+    translation as the first argument, the function evaluation is delayed until it\n+    needs to be converted to a string.\n+\n+    For example::\n+\n+        from django.utils.functional import allow_lazy\n+\n+        def fancy_utility_function(s, ...):\n+            # Do some conversion on string 's'\n+            ...\n+        fancy_utility_function = allow_lazy(fancy_utility_function, unicode)\n+\n+    The ``allow_lazy()`` decorator takes, in addition to the function to decorate,\n+    a number of extra arguments (``*args``) specifying the type(s) that the\n+    original function can return. Usually, it's enough to include ``unicode`` here\n+    and ensure that your function returns only Unicode strings.\n+\n+    Using this decorator means you can write your function and assume that the\n+    input is a proper string, then add support for lazy translation objects at the\n+    end.\n+\n+\n ``django.utils.http``\n =====================\n \n@@ -428,14 +470,23 @@ For a complete discussion on the usage of the following see the\n \n     Translates ``message`` and returns it in a unicode string\n \n+.. function:: pgettext(context, message)\n+\n+    Translates ``message`` given the ``context`` and returns\n+    it in a unicode string.\n+\n+    For more information, see :ref:`contextual-markers`.\n+\n .. function:: gettext_lazy(message)\n .. function:: ugettext_lazy(message)\n+.. function:: pgettext_lazy(context, message)\n \n     Same as the non-lazy versions above, but using lazy execution.\n \n     See :ref:`lazy translations documentation <lazy-translations>`.\n \n .. function:: gettext_noop(message)\n+.. function:: ugettext_noop(message)\n \n     Marks strings for translation but doesn't translate them now. This can be\n     used to store strings in global variables that should stay in the base\n@@ -452,8 +503,14 @@ For a complete discussion on the usage of the following see the\n     Translates ``singular`` and ``plural`` and returns the appropriate string\n     based on ``number`` in a unicode string.\n \n+.. function:: npgettext(context, singular, plural, number)\n+\n+    Translates ``singular`` and ``plural`` and returns the appropriate string\n+    based on ``number`` and the ``context`` in a unicode string.\n+\n .. function:: ngettext_lazy(singular, plural, number)\n .. function:: ungettext_lazy(singular, plural, number)\n+.. function:: npgettext_lazy(singular, plural, number)\n \n     Same as the non-lazy versions above, but using lazy execution.\n "
        },
        {
            "sha": "ccc47cb2607c09f02b449a10ddc5d24061a6913b",
            "filename": "docs/topics/i18n/internationalization.txt",
            "status": "modified",
            "additions": 47,
            "deletions": 63,
            "changes": 110,
            "blob_url": "https://github.com/django/django/blob/62bb4b8c37ada04c10d2a37990326636ea7791d6/docs%2Ftopics%2Fi18n%2Finternationalization.txt",
            "raw_url": "https://github.com/django/django/raw/62bb4b8c37ada04c10d2a37990326636ea7791d6/docs%2Ftopics%2Fi18n%2Finternationalization.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fi18n%2Finternationalization.txt?ref=62bb4b8c37ada04c10d2a37990326636ea7791d6",
            "patch": "@@ -2,6 +2,8 @@\n Internationalization\n ====================\n \n+.. module:: django.utils.translation\n+\n Overview\n ========\n \n@@ -24,19 +26,22 @@ Specifying translation strings: In Python code\n Standard translation\n --------------------\n \n-Specify a translation string by using the function ``ugettext()``. It's\n-convention to import this as a shorter alias, ``_``, to save typing.\n+Specify a translation string by using the function\n+:func:`~django.utils.translation.ugettext`. It's convention to import this\n+as a shorter alias, ``_``, to save typing.\n \n .. note::\n     Python's standard library ``gettext`` module installs ``_()`` into the\n     global namespace, as an alias for ``gettext()``. In Django, we have chosen\n     not to follow this practice, for a couple of reasons:\n \n-      1. For international character set (Unicode) support, ``ugettext()`` is\n-         more useful than ``gettext()``. Sometimes, you should be using\n-         ``ugettext_lazy()`` as the default translation method for a particular\n-         file. Without ``_()`` in the global namespace, the developer has to\n-         think about which is the most appropriate translation function.\n+      1. For international character set (Unicode) support,\n+         :func:`~django.utils.translation.ugettext` is more useful than\n+         ``gettext()``. Sometimes, you should be using\n+         :func:`~django.utils.translation.ugettext_lazy` as the default\n+         translation method for a particular file. Without ``_()`` in the\n+         global namespace, the developer has to think about which is the\n+         most appropriate translation function.\n \n       2. The underscore character (``_``) is used to represent \"the previous\n          result\" in Python's interactive shell and doctest tests. Installing a\n@@ -127,20 +132,20 @@ displayed by most translation tools.\n Marking strings as no-op\n ------------------------\n \n-Use the function ``django.utils.translation.ugettext_noop()`` to mark a string\n-as a translation string without translating it. The string is later translated\n-from a variable.\n+Use the function :func:`django.utils.translation.ugettext_noop()` to mark a\n+string as a translation string without translating it. The string is later\n+translated from a variable.\n \n Use this if you have constant strings that should be stored in the source\n-language because they are exchanged over systems or users -- such as strings in\n-a database -- but should be translated at the last possible point in time, such\n-as when the string is presented to the user.\n+language because they are exchanged over systems or users -- such as strings\n+in a database -- but should be translated at the last possible point in time,\n+such as when the string is presented to the user.\n \n Pluralization\n -------------\n \n-Use the function ``django.utils.translation.ungettext()`` to specify pluralized\n-messages.\n+Use the function :func:`django.utils.translation.ungettext()` to specify\n+pluralized messages.\n \n ``ungettext`` takes three arguments: the singular translation string, the plural\n translation string and the number of objects.\n@@ -155,14 +160,18 @@ of its value.)\n For example::\n \n     from django.utils.translation import ungettext\n+\n     def hello_world(request, count):\n-        page = ungettext('there is %(count)d object', 'there are %(count)d objects', count) % {\n+        page = ungettext(\n+            'there is %(count)d object',\n+            'there are %(count)d objects',\n+        count) % {\n             'count': count,\n         }\n         return HttpResponse(page)\n \n-In this example the number of objects is passed to the translation languages as\n-the ``count`` variable.\n+In this example the number of objects is passed to the translation\n+languages as the ``count`` variable.\n \n Lets see a slightly more complex usage example::\n \n@@ -226,8 +235,8 @@ Contextual markers\n Sometimes words have several meanings, such as ``\"May\"`` in English, which\n refers to a month name and to a verb. To enable translators to translate\n these words correctly in different contexts, you can use the\n-``django.utils.translation.pgettext()`` function, or the\n-``django.utils.translation.npgettext()`` function if the string needs\n+:func:`django.utils.translation.pgettext()` function, or the\n+:func:`django.utils.translation.npgettext()` function if the string needs\n pluralization. Both take a context string as the first variable.\n \n In the resulting .po file, the string will then appear as often as there are\n@@ -241,6 +250,14 @@ For example::\n \n     month = pgettext(\"month name\", \"May\")\n \n+or::\n+\n+    from django.utils.translation import pgettext_lazy\n+\n+    class MyThing(models.Model):\n+        name = models.CharField(help_text=pgettext_lazy(\n+            'help text for MyThing model', 'This is the help text'))\n+\n will appear in the .po file as:\n \n .. code-block:: po\n@@ -254,7 +271,7 @@ will appear in the .po file as:\n Lazy translation\n ----------------\n \n-Use the function ``django.utils.translation.ugettext_lazy()`` to translate\n+Use the function :func:`django.utils.translation.ugettext_lazy()` to translate\n strings lazily -- when the value is accessed rather than when the\n ``ugettext_lazy()`` function is called.\n \n@@ -308,6 +325,7 @@ name::\n \n     class MyThing(models.Model):\n         name = models.CharField(_('name'), help_text=_('This is the help text'))\n+\n         class Meta:\n             verbose_name = _('my thing')\n             verbose_name_plural = _('mythings')\n@@ -360,9 +378,9 @@ Joining strings: string_concat()\n \n Standard Python string joins (``''.join([...])``) will not work on lists\n containing lazy translation objects. Instead, you can use\n-``django.utils.translation.string_concat()``, which creates a lazy object that\n-concatenates its contents *and* converts them to strings only when the result\n-is included in a string. For example::\n+:func:`django.utils.translation.string_concat()`, which creates a lazy object\n+that concatenates its contents *and* converts them to strings only when the\n+result is included in a string. For example::\n \n     from django.utils.translation import string_concat\n     ...\n@@ -374,46 +392,11 @@ In this case, the lazy translations in ``result`` will only be converted to\n strings when ``result`` itself is used in a string (usually at template\n rendering time).\n \n-The allow_lazy() decorator\n-~~~~~~~~~~~~~~~~~~~~~~~~~~\n-\n-Django offers many utility functions (particularly in ``django.utils``) that\n-take a string as their first argument and do something to that string. These\n-functions are used by template filters as well as directly in other code.\n-\n-If you write your own similar functions and deal with translations, you'll\n-face the problem of what to do when the first argument is a lazy translation\n-object. You don't want to convert it to a string immediately, because you might\n-be using this function outside of a view (and hence the current thread's locale\n-setting will not be correct).\n-\n-For cases like this, use the ``django.utils.functional.allow_lazy()``\n-decorator. It modifies the function so that *if* it's called with a lazy\n-translation as the first argument, the function evaluation is delayed until it\n-needs to be converted to a string.\n-\n-For example::\n-\n-    from django.utils.functional import allow_lazy\n-\n-    def fancy_utility_function(s, ...):\n-        # Do some conversion on string 's'\n-        ...\n-    fancy_utility_function = allow_lazy(fancy_utility_function, unicode)\n-\n-The ``allow_lazy()`` decorator takes, in addition to the function to decorate,\n-a number of extra arguments (``*args``) specifying the type(s) that the\n-original function can return. Usually, it's enough to include ``unicode`` here\n-and ensure that your function returns only Unicode strings.\n-\n-Using this decorator means you can write your function and assume that the\n-input is a proper string, then add support for lazy translation objects at the\n-end.\n-\n-\n Localized names of languages\n ============================\n \n+.. function:: get_language_info\n+\n .. versionadded:: 1.3\n \n The ``get_language_info()`` function provides detailed information about\n@@ -457,7 +440,8 @@ require translation in the future::\n \n     <title>{% trans \"myvar\" noop %}</title>\n \n-Internally, inline translations use an ``ugettext`` call.\n+Internally, inline translations use an\n+:func:`~django.utils.translation.ugettext` call.\n \n In case a template var (``myvar`` above) is passed to the tag, the tag will\n first resolve such variable to a string at run-time and then look up that\n@@ -778,7 +762,7 @@ The ``set_language`` redirect view\n \n .. function:: set_language(request)\n \n-As a convenience, Django comes with a view, :meth:`django.views.i18n.set_language`,\n+As a convenience, Django comes with a view, :func:`django.views.i18n.set_language`,\n that sets a user's language preference and redirects back to the previous page.\n \n Activate this view by adding the following line to your URLconf::"
        }
    ],
    "stats": {
        "total": 167,
        "additions": 104,
        "deletions": 63
    }
}