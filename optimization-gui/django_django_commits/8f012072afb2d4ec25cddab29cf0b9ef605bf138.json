{
    "author": "alex",
    "message": "Converted Portuguese localflavor doctests into unittests.  We have always been at war with doctests.  Thanks to Idan Gazit.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@14950 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "8f012072afb2d4ec25cddab29cf0b9ef605bf138",
    "files": [
        {
            "sha": "ce520182776476ef5d75a062f2f6bee146931384",
            "filename": "tests/regressiontests/forms/localflavor/pt.py",
            "status": "modified",
            "additions": 28,
            "deletions": 102,
            "changes": 130,
            "blob_url": "https://github.com/django/django/blob/8f012072afb2d4ec25cddab29cf0b9ef605bf138/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fpt.py",
            "raw_url": "https://github.com/django/django/raw/8f012072afb2d4ec25cddab29cf0b9ef605bf138/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fpt.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fpt.py?ref=8f012072afb2d4ec25cddab29cf0b9ef605bf138",
            "patch": "@@ -1,106 +1,32 @@\n-# -*- coding: utf-8 -*-\n-# Tests for the contrib/localflavor/ PT form fields.\n+from django.contrib.localflavor.pt.forms import PTZipCodeField, PTPhoneNumberField\n \n-tests = r\"\"\"\n-# PTZipCodeField #############################################################\n+from utils import LocalFlavorTestCase\n \n-PTZipCodeField validates that the data is a valid PT zipcode.\n->>> from django.contrib.localflavor.pt.forms import PTZipCodeField\n->>> f = PTZipCodeField()\n->>> f.clean('3030-034')\n-u'3030-034'\n->>> f.clean('1003456')\n-u'1003-456'\n->>> f.clean('2A200')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a zip code in the format XXXX-XXX.']\n->>> f.clean('980001')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a zip code in the format XXXX-XXX.']\n->>> f.clean(None)\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n->>> f.clean('')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n \n->>> f = PTZipCodeField(required=False)\n->>> f.clean('3030-034')\n-u'3030-034'\n->>> f.clean('1003456')\n-u'1003-456'\n->>> f.clean('2A200')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a zip code in the format XXXX-XXX.']\n->>> f.clean('980001')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Enter a zip code in the format XXXX-XXX.']\n->>> f.clean(None)\n-u''\n->>> f.clean('')\n-u''\n+class PTLocalFlavorTests(LocalFlavorTestCase):\n+    def test_PTZipCodeField(self):\n+        error_format = [u'Enter a zip code in the format XXXX-XXX.']\n+        valid = {\n+            '3030-034': '3030-034',\n+            '1003456': '1003-456',\n+        }\n+        invalid = {\n+            '2A200': error_format,\n+            '980001': error_format,\n+        }\n+        self.assertFieldOutput(PTZipCodeField, valid, invalid)\n \n-# PTPhoneNumberField ##########################################################\n-\n-PTPhoneNumberField validates that the data is a valid Portuguese phone number.\n-It's normalized to XXXXXXXXX format  or +X(X) for international numbers. Dots are valid too.\n->>> from django.contrib.localflavor.pt.forms import PTPhoneNumberField\n->>> f = PTPhoneNumberField()\n->>> f.clean('917845189')\n-u'917845189'\n->>> f.clean('91 784 5189')\n-u'917845189'\n->>> f.clean('91 784 5189')\n-u'917845189'\n->>> f.clean('+351 91 111')\n-u'+35191111'\n->>> f.clean('00351873')\n-u'00351873'\n->>> f.clean('91 784 51 8')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Phone numbers must have 9 digits, or start by + or 00.']\n->>> f.clean('091 456 987 1')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Phone numbers must have 9 digits, or start by + or 00.']\n->>> f.clean(None)\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n->>> f.clean('')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'This field is required.']\n-\n->>> f = PTPhoneNumberField(required=False)\n->>> f.clean('917845189')\n-u'917845189'\n->>> f.clean('91 784 5189')\n-u'917845189'\n->>> f.clean('91 784 5189')\n-u'917845189'\n->>> f.clean('+351 91 111')\n-u'+35191111'\n->>> f.clean('00351873')\n-u'00351873'\n->>> f.clean('91 784 51 8')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Phone numbers must have 9 digits, or start by + or 00.']\n->>> f.clean('091 456 987 1')\n-Traceback (most recent call last):\n-...\n-ValidationError: [u'Phone numbers must have 9 digits, or start by + or 00.']\n->>> f.clean(None)\n-u''\n->>> f.clean('')\n-u''\n-\n-\"\"\"\n+    def test_PTPhoneNumberField(self):\n+        error_format = [u'Phone numbers must have 9 digits, or start by + or 00']\n+        valid = {\n+            '917845189': '917845189',\n+            '91 784 5189': '917845189',\n+            '91 784 5189': '917845189',\n+            '+351 91 111': '+35191111',\n+            '00351873': '00351873',\n+        }\n+        invalid = {\n+            '91 784 51 8': error_format,\n+            '091 456 987 1': error_format,\n+        }\n+        self.assertFieldOutput(PTPhoneNumberField, valid, invalid)"
        },
        {
            "sha": "c6a050edc847477717549ce410d3d543dd85d2bc",
            "filename": "tests/regressiontests/forms/localflavortests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 2,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/8f012072afb2d4ec25cddab29cf0b9ef605bf138/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "raw_url": "https://github.com/django/django/raw/8f012072afb2d4ec25cddab29cf0b9ef605bf138/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py?ref=8f012072afb2d4ec25cddab29cf0b9ef605bf138",
            "patch": "@@ -1,6 +1,5 @@\n # -*- coding: utf-8 -*-\n from localflavor.cz import tests as localflavor_cz_tests\n-from localflavor.pt import tests as localflavor_pt_tests\n from localflavor.ro import tests as localflavor_ro_tests\n from localflavor.se import tests as localflavor_se_tests\n from localflavor.sk import tests as localflavor_sk_tests\n@@ -31,12 +30,12 @@\n from localflavor.kw import KWLocalFlavorTests\n from localflavor.nl import NLLocalFlavorTests\n from localflavor.pl import PLLocalFlavorTests\n+from localflavor.pt import PTLocalFlavorTests\n from localflavor.tr import TRLocalFlavorTests\n \n \n __test__ = {\n     'localflavor_cz_tests': localflavor_cz_tests,\n-    'localflavor_pt_tests': localflavor_pt_tests,\n     'localflavor_ro_tests': localflavor_ro_tests,\n     'localflavor_se_tests': localflavor_se_tests,\n     'localflavor_sk_tests': localflavor_sk_tests,"
        },
        {
            "sha": "124646cbb1ebc54980cd3ffb7368b899698caabe",
            "filename": "tests/regressiontests/forms/tests/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/8f012072afb2d4ec25cddab29cf0b9ef605bf138/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/8f012072afb2d4ec25cddab29cf0b9ef605bf138/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py?ref=8f012072afb2d4ec25cddab29cf0b9ef605bf138",
            "patch": "@@ -35,5 +35,6 @@\n     KWLocalFlavorTests,\n     NLLocalFlavorTests,\n     PLLocalFlavorTests,\n+    PTLocalFlavorTests,\n     TRLocalFlavorTests,\n )"
        }
    ],
    "stats": {
        "total": 134,
        "additions": 30,
        "deletions": 104
    }
}