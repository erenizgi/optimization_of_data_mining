{
    "author": "jezdez",
    "message": "Added django.utils.translation.override context manager to easily activate and deactivate a language for a code block.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16166 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "71ec87fed83c0fb23f131d11f30031eeaa79ed77",
    "files": [
        {
            "sha": "e8601efc2f3d3b792e56f07e1169e34480a6c7e4",
            "filename": "django/utils/translation/__init__.py",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/71ec87fed83c0fb23f131d11f30031eeaa79ed77/django%2Futils%2Ftranslation%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/71ec87fed83c0fb23f131d11f30031eeaa79ed77/django%2Futils%2Ftranslation%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2F__init__.py?ref=71ec87fed83c0fb23f131d11f30031eeaa79ed77",
            "patch": "@@ -102,6 +102,21 @@ def activate(language):\n def deactivate():\n     return _trans.deactivate()\n \n+class override(object):\n+    def __init__(self, language, deactivate=False):\n+        self.language = language\n+        self.deactivate = deactivate\n+        self.old_language = get_language()\n+\n+    def __enter__(self):\n+        activate(self.language)\n+\n+    def __exit__(self, exc_type, exc_value, traceback):\n+        if self.deactivate:\n+            deactivate()\n+        else:\n+            activate(self.old_language)\n+\n def get_language():\n     return _trans.get_language()\n "
        },
        {
            "sha": "8a8e4dc4302ec4cd6dabc7447c61a1a7e8a3e818",
            "filename": "tests/regressiontests/i18n/tests.py",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/71ec87fed83c0fb23f131d11f30031eeaa79ed77/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/71ec87fed83c0fb23f131d11f30031eeaa79ed77/tests%2Fregressiontests%2Fi18n%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fi18n%2Ftests.py?ref=71ec87fed83c0fb23f131d11f30031eeaa79ed77",
            "patch": "@@ -8,6 +8,7 @@\n \n from django.conf import settings\n from django.template import Template, Context\n+from django.test import TestCase\n from django.utils.formats import (get_format, date_format, time_format,\n     localize, localize_input, iter_format_modules, get_format_modules)\n from django.utils.importlib import import_module\n@@ -28,6 +29,13 @@\n \n class TranslationTests(TestCase):\n \n+    def test_override(self):\n+        activate('de')\n+        with translation.override('pl'):\n+            self.assertEqual(get_language(), 'pl')\n+        self.assertEqual(get_language(), 'de')\n+        deactivate()\n+\n     def test_lazy_objects(self):\n         \"\"\"\n         Format string interpolation should work with *_lazy objects."
        }
    ],
    "stats": {
        "total": 23,
        "additions": 23,
        "deletions": 0
    }
}