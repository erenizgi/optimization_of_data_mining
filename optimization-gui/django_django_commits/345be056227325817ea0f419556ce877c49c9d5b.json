{
    "author": "ramiro",
    "message": "Enhanced loaddata error message printed when no DB fixture is provided.\n\nFixes #7043 by fixing the last code path where a misleading 'No fixtures found.' error message was being shown.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17051 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "345be056227325817ea0f419556ce877c49c9d5b",
    "files": [
        {
            "sha": "4492e5c6cb2098c193723754fff44d6519c19af9",
            "filename": "django/core/management/commands/loaddata.py",
            "status": "modified",
            "additions": 13,
            "deletions": 11,
            "changes": 24,
            "blob_url": "https://github.com/django/django/blob/345be056227325817ea0f419556ce877c49c9d5b/django%2Fcore%2Fmanagement%2Fcommands%2Floaddata.py",
            "raw_url": "https://github.com/django/django/raw/345be056227325817ea0f419556ce877c49c9d5b/django%2Fcore%2Fmanagement%2Fcommands%2Floaddata.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Floaddata.py?ref=345be056227325817ea0f419556ce877c49c9d5b",
            "patch": "@@ -39,6 +39,12 @@ def handle(self, *fixture_labels, **options):\n         connection = connections[using]\n         self.style = no_style()\n \n+        if not len(fixture_labels):\n+            self.stderr.write(\n+                self.style.ERROR(\"No database fixture specified. Please provide the path of at least one fixture in the command line.\\n\")\n+            )\n+            return\n+\n         verbosity = int(options.get('verbosity'))\n         show_traceback = options.get('traceback')\n \n@@ -245,17 +251,13 @@ def read(self):\n             transaction.commit(using=using)\n             transaction.leave_transaction_management(using=using)\n \n-        if fixture_object_count == 0:\n-            if verbosity >= 1:\n-                self.stdout.write(\"No fixtures found.\\n\")\n-        else:\n-            if verbosity >= 1:\n-                if fixture_object_count == loaded_object_count:\n-                    self.stdout.write(\"Installed %d object(s) from %d fixture(s)\\n\" % (\n-                        loaded_object_count, fixture_count))\n-                else:\n-                    self.stdout.write(\"Installed %d object(s) (of %d) from %d fixture(s)\\n\" % (\n-                        loaded_object_count, fixture_object_count, fixture_count))\n+        if verbosity >= 1:\n+            if fixture_object_count == loaded_object_count:\n+                self.stdout.write(\"Installed %d object(s) from %d fixture(s)\\n\" % (\n+                    loaded_object_count, fixture_count))\n+            else:\n+                self.stdout.write(\"Installed %d object(s) (of %d) from %d fixture(s)\\n\" % (\n+                    loaded_object_count, fixture_object_count, fixture_count))\n \n         # Close the DB connection. This is required as a workaround for an\n         # edge case in MySQL: if the same connection is used to"
        },
        {
            "sha": "26e436b3c5b4e3781523dfb96980d91675e4af47",
            "filename": "tests/regressiontests/fixtures_regress/tests.py",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/345be056227325817ea0f419556ce877c49c9d5b/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/345be056227325817ea0f419556ce877c49c9d5b/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py?ref=345be056227325817ea0f419556ce877c49c9d5b",
            "patch": "@@ -390,6 +390,21 @@ def test_loaddata_raises_error_when_fixture_has_invalid_foreign_key(self):\n             stderr.getvalue().startswith('Problem installing fixture')\n         )\n \n+    def test_loaddata_no_fixture_specified(self):\n+        \"\"\"\n+        Regression for #7043 - Error is quickly reported when no fixtures is provided in the command line.\n+        \"\"\"\n+        stderr = StringIO()\n+        management.call_command(\n+            'loaddata',\n+            verbosity=0,\n+            commit=False,\n+            stderr=stderr,\n+        )\n+        self.assertEqual(\n+            stderr.getvalue(), 'No database fixture specified. Please provide the path of at least one fixture in the command line.\\n'\n+        )\n+\n \n class NaturalKeyFixtureTests(TestCase):\n "
        }
    ],
    "stats": {
        "total": 39,
        "additions": 28,
        "deletions": 11
    }
}