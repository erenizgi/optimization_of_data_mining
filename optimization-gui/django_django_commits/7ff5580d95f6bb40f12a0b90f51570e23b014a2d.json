{
    "author": "freakboy3742",
    "message": "Fixed #14389, #9666 -- Started the migration path to make the first argument to url and ssi template tags syntactically consistent with other tags. Thanks to Sean Brant for the draft patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@14643 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
    "files": [
        {
            "sha": "5a2036d1dc6b9c7f5233e5e92fe4762c709cf504",
            "filename": "django/contrib/admin/templates/admin/auth/user/change_password.html",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fauth%2Fuser%2Fchange_password.html",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fauth%2Fuser%2Fchange_password.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fauth%2Fuser%2Fchange_password.html?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -1,7 +1,8 @@\n {% extends \"admin/base_site.html\" %}\n {% load i18n admin_modify adminmedia %}\n+{% load url from future %}\n {% block extrahead %}{{ block.super }}\n-{% url admin:jsi18n as jsi18nurl %}\n+{% url 'admin:jsi18n' as jsi18nurl %}\n <script type=\"text/javascript\" src=\"{{ jsi18nurl|default:\"../../../../jsi18n/\" }}\"></script>\n {% endblock %}\n {% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% admin_media_prefix %}css/forms.css\" />{% endblock %}"
        },
        {
            "sha": "87f6c8738d2b25780632fd6965141c582101a72f",
            "filename": "django/contrib/admin/templates/admin/base.html",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fbase.html",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fbase.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fbase.html?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -1,4 +1,4 @@\n-<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n+{% load url from future %}<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n <html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"{{ LANGUAGE_CODE|default:\"en-us\" }}\" xml:lang=\"{{ LANGUAGE_CODE|default:\"en-us\" }}\" {% if LANGUAGE_BIDI %}dir=\"rtl\"{% endif %}>\n <head>\n <title>{% block title %}{% endblock %}</title>\n@@ -28,18 +28,18 @@\n             {% trans 'Welcome,' %}\n             <strong>{% filter force_escape %}{% firstof user.first_name user.username %}{% endfilter %}</strong>.\n             {% block userlinks %}\n-                {% url django-admindocs-docroot as docsroot %}\n+                {% url 'django-admindocs-docroot' as docsroot %}\n                 {% if docsroot %}\n                     <a href=\"{{ docsroot }}\">{% trans 'Documentation' %}</a> /\n                 {% endif %}\n-                {% url admin:password_change as password_change_url %}\n+                {% url 'admin:password_change' as password_change_url %}\n                 {% if password_change_url %}\n                     <a href=\"{{ password_change_url }}\">\n                 {% else %}\n                     <a href=\"{{ root_path }}password_change/\">\n                 {% endif %}\n                 {% trans 'Change password' %}</a> /\n-                {% url admin:logout as logout_url %}\n+                {% url 'admin:logout' as logout_url %}\n                 {% if logout_url %}\n                     <a href=\"{{ logout_url }}\">\n                 {% else %}"
        },
        {
            "sha": "cb4bae3da8aed4e524f44adbaa6fe23679512b02",
            "filename": "django/contrib/admin/templates/admin/change_list.html",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fchange_list.html",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fchange_list.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplates%2Fadmin%2Fchange_list.html?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -1,14 +1,14 @@\n {% extends \"admin/base_site.html\" %}\n {% load adminmedia admin_list i18n %}\n-\n+{% load url from future %}\n {% block extrastyle %}\n   {{ block.super }}\n   <link rel=\"stylesheet\" type=\"text/css\" href=\"{% admin_media_prefix %}css/changelists.css\" />\n   {% if cl.formset %}\n     <link rel=\"stylesheet\" type=\"text/css\" href=\"{% admin_media_prefix %}css/forms.css\" />\n   {% endif %}\n   {% if cl.formset or action_form %}\n-    {% url admin:jsi18n as jsi18nurl %}\n+    {% url 'admin:jsi18n' as jsi18nurl %}\n     <script type=\"text/javascript\" src=\"{{ jsi18nurl|default:'../../jsi18n/' }}\"></script>\n   {% endif %}\n   {{ media.css }}\n@@ -41,11 +41,11 @@\n       <a href=\"../../\">\n         {% trans \"Home\" %}\n       </a>\n-       &rsaquo; \n+       &rsaquo;\n        <a href=\"../\">\n          {{ app_label|capfirst }}\n       </a>\n-      &rsaquo; \n+      &rsaquo;\n       {{ cl.opts.verbose_name_plural|capfirst }}\n     </div>\n   {% endblock %}\n@@ -84,7 +84,7 @@ <h2>{% trans 'Filter' %}</h2>\n           </div>\n         {% endif %}\n       {% endblock %}\n-      \n+\n       <form id=\"changelist-form\" action=\"\" method=\"post\"{% if cl.formset.is_multipart %} enctype=\"multipart/form-data\"{% endif %}>{% csrf_token %}\n       {% if cl.formset %}\n         {{ cl.formset.management_form }}"
        },
        {
            "sha": "0c0690d5e225030699913f40ceb1952c571260d6",
            "filename": "django/contrib/admin/templates/registration/password_change_done.html",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fregistration%2Fpassword_change_done.html",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fregistration%2Fpassword_change_done.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplates%2Fregistration%2Fpassword_change_done.html?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -1,6 +1,7 @@\n {% extends \"admin/base_site.html\" %}\n {% load i18n %}\n-{% block userlinks %}{% url django-admindocs-docroot as docsroot %}{% if docsroot %}<a href=\"{{ docsroot }}\">{% trans 'Documentation' %}</a> / {% endif %}{% trans 'Change password' %} / <a href=\"../../logout/\">{% trans 'Log out' %}</a>{% endblock %}\n+{% load url from future %}\n+{% block userlinks %}{% url 'django-admindocs-docroot' as docsroot %}{% if docsroot %}<a href=\"{{ docsroot }}\">{% trans 'Documentation' %}</a> / {% endif %}{% trans 'Change password' %} / <a href=\"../../logout/\">{% trans 'Log out' %}</a>{% endblock %}\n {% block breadcrumbs %}<div class=\"breadcrumbs\"><a href=\"../../\">{% trans 'Home' %}</a> &rsaquo; {% trans 'Password change' %}</div>{% endblock %}\n \n {% block title %}{% trans 'Password change successful' %}{% endblock %}"
        },
        {
            "sha": "23d6c1d8afe575c6624d659ff56bb68f3e228877",
            "filename": "django/contrib/admin/templates/registration/password_change_form.html",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fregistration%2Fpassword_change_form.html",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fregistration%2Fpassword_change_form.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplates%2Fregistration%2Fpassword_change_form.html?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -1,7 +1,8 @@\n {% extends \"admin/base_site.html\" %}\n {% load i18n adminmedia %}\n+{% load url from future %}\n {% block extrastyle %}{{ block.super }}<link rel=\"stylesheet\" type=\"text/css\" href=\"{% admin_media_prefix %}css/forms.css\" />{% endblock %}\n-{% block userlinks %}{% url django-admindocs-docroot as docsroot %}{% if docsroot %}<a href=\"{{ docsroot }}\">{% trans 'Documentation' %}</a> / {% endif %} {% trans 'Change password' %} / <a href=\"../logout/\">{% trans 'Log out' %}</a>{% endblock %}\n+{% block userlinks %}{% url 'django-admindocs-docroot' as docsroot %}{% if docsroot %}<a href=\"{{ docsroot }}\">{% trans 'Documentation' %}</a> / {% endif %} {% trans 'Change password' %} / <a href=\"../logout/\">{% trans 'Log out' %}</a>{% endblock %}\n {% block breadcrumbs %}<div class=\"breadcrumbs\"><a href=\"../\">{% trans 'Home' %}</a> &rsaquo; {% trans 'Password change' %}</div>{% endblock %}\n \n {% block title %}{% trans 'Password change' %}{% endblock %}"
        },
        {
            "sha": "506a1a83dcdc035fd8e7ddb2d9f81162b1185e04",
            "filename": "django/contrib/admin/templates/registration/password_reset_email.html",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fregistration%2Fpassword_reset_email.html",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Fcontrib%2Fadmin%2Ftemplates%2Fregistration%2Fpassword_reset_email.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Ftemplates%2Fregistration%2Fpassword_reset_email.html?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -1,10 +1,10 @@\n-{% load i18n %}{% autoescape off %}\n+{% load i18n %}{% load url from future %}{% autoescape off %}\n {% trans \"You're receiving this e-mail because you requested a password reset\" %}\n {% blocktrans %}for your user account at {{ site_name }}{% endblocktrans %}.\n \n {% trans \"Please go to the following page and choose a new password:\" %}\n {% block reset_link %}\n-{{ protocol }}://{{ domain }}{% url django.contrib.auth.views.password_reset_confirm uidb36=uid token=token %}\n+{{ protocol }}://{{ domain }}{% url 'django.contrib.auth.views.password_reset_confirm' uidb36=uid token=token %}\n {% endblock %}\n {% trans \"Your username, in case you've forgotten:\" %} {{ user.username }}\n "
        },
        {
            "sha": "2dc95f4b8c32f665600cdadf837db4f431f82400",
            "filename": "django/template/defaulttags.py",
            "status": "modified",
            "additions": 65,
            "deletions": 15,
            "changes": 80,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Ftemplate%2Fdefaulttags.py",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Ftemplate%2Fdefaulttags.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fdefaulttags.py?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -290,24 +290,30 @@ def include_is_allowed(filepath):\n     return False\n \n class SsiNode(Node):\n-    def __init__(self, filepath, parsed):\n-        self.filepath, self.parsed = filepath, parsed\n+    def __init__(self, filepath, parsed, legacy_filepath=True):\n+        self.filepath = filepath\n+        self.parsed = parsed\n+        self.legacy_filepath = legacy_filepath\n \n     def render(self, context):\n-        if not include_is_allowed(self.filepath):\n+        filepath = self.filepath\n+        if not self.legacy_filepath:\n+           filepath = filepath.resolve(context)\n+\n+        if not include_is_allowed(filepath):\n             if settings.DEBUG:\n                 return \"[Didn't have permission to include file]\"\n             else:\n                 return '' # Fail silently for invalid includes.\n         try:\n-            fp = open(self.filepath, 'r')\n+            fp = open(filepath, 'r')\n             output = fp.read()\n             fp.close()\n         except IOError:\n             output = ''\n         if self.parsed:\n             try:\n-                t = Template(output, name=self.filepath)\n+                t = Template(output, name=filepath)\n                 return t.render(context)\n             except TemplateSyntaxError, e:\n                 if settings.DEBUG:\n@@ -356,31 +362,37 @@ def render(self, context):\n         return self.mapping.get(self.tagtype, '')\n \n class URLNode(Node):\n-    def __init__(self, view_name, args, kwargs, asvar):\n+    def __init__(self, view_name, args, kwargs, asvar, legacy_view_name=True):\n         self.view_name = view_name\n+        self.legacy_view_name = legacy_view_name\n         self.args = args\n         self.kwargs = kwargs\n         self.asvar = asvar\n \n     def render(self, context):\n         from django.core.urlresolvers import reverse, NoReverseMatch\n         args = [arg.resolve(context) for arg in self.args]\n-        kwargs = dict([(smart_str(k,'ascii'), v.resolve(context))\n+        kwargs = dict([(smart_str(k, 'ascii'), v.resolve(context))\n                        for k, v in self.kwargs.items()])\n \n+        view_name = self.view_name\n+        if not self.legacy_view_name:\n+            view_name = view_name.resolve(context)\n+\n         # Try to look up the URL twice: once given the view name, and again\n         # relative to what we guess is the \"main\" app. If they both fail,\n         # re-raise the NoReverseMatch unless we're using the\n         # {% url ... as var %} construct in which cause return nothing.\n         url = ''\n         try:\n-            url = reverse(self.view_name, args=args, kwargs=kwargs, current_app=context.current_app)\n+            url = reverse(view_name, args=args, kwargs=kwargs, current_app=context.current_app)\n         except NoReverseMatch, e:\n             if settings.SETTINGS_MODULE:\n                 project_name = settings.SETTINGS_MODULE.split('.')[0]\n                 try:\n-                    url = reverse(project_name + '.' + self.view_name,\n-                              args=args, kwargs=kwargs, current_app=context.current_app)\n+                    url = reverse(project_name + '.' + view_name,\n+                              args=args, kwargs=kwargs,\n+                              current_app=context.current_app)\n                 except NoReverseMatch:\n                     if self.asvar is None:\n                         # Re-raise the original exception, not the one with\n@@ -922,6 +934,11 @@ def ssi(parser, token):\n \n         {% ssi /home/html/ljworld.com/includes/right_generic.html parsed %}\n     \"\"\"\n+\n+    import warnings\n+    warnings.warn('The syntax for the ssi template tag is changing. Load the `ssi` tag from the `future` tag library to start using the new behavior.',\n+                  category=PendingDeprecationWarning)\n+\n     bits = token.contents.split()\n     parsed = False\n     if len(bits) not in (2, 3):\n@@ -933,7 +950,7 @@ def ssi(parser, token):\n         else:\n             raise TemplateSyntaxError(\"Second (optional) argument to %s tag\"\n                                       \" must be 'parsed'\" % bits[0])\n-    return SsiNode(bits[1], parsed)\n+    return SsiNode(bits[1], parsed, legacy_filepath=True)\n ssi = register.tag(ssi)\n \n #@register.tag\n@@ -945,16 +962,44 @@ def load(parser, token):\n     ``django/templatetags/news/photos.py``::\n \n         {% load news.photos %}\n+\n+    Can also be used to load an individual tag/filter from\n+    a library::\n+\n+        {% load byline from news %}\n+\n     \"\"\"\n     bits = token.contents.split()\n-    for taglib in bits[1:]:\n-        # add the library to the parser\n+    if len(bits) >= 4 and bits[-2] == \"from\":\n         try:\n+            taglib = bits[-1]\n             lib = get_library(taglib)\n-            parser.add_library(lib)\n         except InvalidTemplateLibrary, e:\n             raise TemplateSyntaxError(\"'%s' is not a valid tag library: %s\" %\n                                       (taglib, e))\n+        else:\n+            temp_lib = Library()\n+            for name in bits[1:-2]:\n+                if name in lib.tags:\n+                    temp_lib.tags[name] = lib.tags[name]\n+                    # a name could be a tag *and* a filter, so check for both\n+                    if name in lib.filters:\n+                        temp_lib.filters[name] = lib.filters[name]\n+                elif name in lib.filters:\n+                    temp_lib.filters[name] = lib.filters[name]\n+                else:\n+                    raise TemplateSyntaxError(\"'%s' is not a valid tag or filter in tag library '%s'\" %\n+                                              (name, taglib))\n+            parser.add_library(temp_lib)\n+    else:\n+        for taglib in bits[1:]:\n+            # add the library to the parser\n+            try:\n+                lib = get_library(taglib)\n+                parser.add_library(lib)\n+            except InvalidTemplateLibrary, e:\n+                raise TemplateSyntaxError(\"'%s' is not a valid tag library: %s\" %\n+                                          (taglib, e))\n     return LoadNode()\n load = register.tag(load)\n \n@@ -1140,6 +1185,11 @@ def url(parser, token):\n \n     The URL will look like ``/clients/client/123/``.\n     \"\"\"\n+\n+    import warnings\n+    warnings.warn('The syntax for the url template tag is changing. Load the `url` tag from the `future` tag library to start using the new behavior.',\n+                  category=PendingDeprecationWarning)\n+\n     bits = token.split_contents()\n     if len(bits) < 2:\n         raise TemplateSyntaxError(\"'%s' takes at least one argument\"\n@@ -1196,7 +1246,7 @@ def url(parser, token):\n             else:\n                 args.append(parser.compile_filter(value))\n \n-    return URLNode(viewname, args, kwargs, asvar)\n+    return URLNode(viewname, args, kwargs, asvar, legacy_view_name=True)\n url = register.tag(url)\n \n #@register.tag"
        },
        {
            "sha": "cd29dc276acf03fc484599f9396ff6cd63ea7155",
            "filename": "django/templatetags/future.py",
            "status": "added",
            "additions": 99,
            "deletions": 0,
            "changes": 99,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Ftemplatetags%2Ffuture.py",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/django%2Ftemplatetags%2Ffuture.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplatetags%2Ffuture.py?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -0,0 +1,99 @@\n+from django.conf import settings\n+from django.template import Library, Node, Template, TemplateSyntaxError\n+from django.template.defaulttags import kwarg_re, include_is_allowed, SsiNode, URLNode\n+from django.utils.encoding import smart_str\n+\n+\n+register = Library()\n+\n+@register.tag\n+def ssi(parser, token):\n+    \"\"\"\n+    Outputs the contents of a given file into the page.\n+\n+    Like a simple \"include\" tag, the ``ssi`` tag includes the contents\n+    of another file -- which must be specified using an absolute path --\n+    in the current page::\n+\n+        {% ssi \"/home/html/ljworld.com/includes/right_generic.html\" %}\n+\n+    If the optional \"parsed\" parameter is given, the contents of the included\n+    file are evaluated as template code, with the current context::\n+\n+        {% ssi \"/home/html/ljworld.com/includes/right_generic.html\" parsed %}\n+    \"\"\"\n+    bits = token.contents.split()\n+    parsed = False\n+    if len(bits) not in (2, 3):\n+        raise TemplateSyntaxError(\"'ssi' tag takes one argument: the path to\"\n+                                  \" the file to be included\")\n+    if len(bits) == 3:\n+        if bits[2] == 'parsed':\n+            parsed = True\n+        else:\n+            raise TemplateSyntaxError(\"Second (optional) argument to %s tag\"\n+                                      \" must be 'parsed'\" % bits[0])\n+    filepath = parser.compile_filter(bits[1])\n+    return SsiNode(filepath, parsed, legacy_filepath=False)\n+\n+@register.tag\n+def url(parser, token):\n+    \"\"\"\n+    Returns an absolute URL matching given view with its parameters.\n+\n+    This is a way to define links that aren't tied to a particular URL\n+    configuration::\n+\n+        {% url \"path.to.some_view\" arg1 arg2 %}\n+\n+        or\n+\n+        {% url \"path.to.some_view\" name1=value1 name2=value2 %}\n+\n+    The first argument is a path to a view. It can be an absolute python path\n+    or just ``app_name.view_name`` without the project name if the view is\n+    located inside the project.  Other arguments are comma-separated values\n+    that will be filled in place of positional and keyword arguments in the\n+    URL. All arguments for the URL should be present.\n+\n+    For example if you have a view ``app_name.client`` taking client's id and\n+    the corresponding line in a URLconf looks like this::\n+\n+        ('^client/(\\d+)/$', 'app_name.client')\n+\n+    and this app's URLconf is included into the project's URLconf under some\n+    path::\n+\n+        ('^clients/', include('project_name.app_name.urls'))\n+\n+    then in a template you can create a link for a certain client like this::\n+\n+        {% url \"app_name.client\" client.id %}\n+\n+    The URL will look like ``/clients/client/123/``.\n+    \"\"\"\n+    bits = token.split_contents()\n+    if len(bits) < 2:\n+        raise TemplateSyntaxError(\"'%s' takes at least one argument\"\n+                                  \" (path to a view)\" % bits[0])\n+    viewname = parser.compile_filter(bits[1])\n+    args = []\n+    kwargs = {}\n+    asvar = None\n+    bits = bits[2:]\n+    if len(bits) >= 2 and bits[-2] == 'as':\n+        asvar = bits[-1]\n+        bits = bits[:-2]\n+\n+    if len(bits):\n+        for bit in bits:\n+            match = kwarg_re.match(bit)\n+            if not match:\n+                raise TemplateSyntaxError(\"Malformed arguments to url tag\")\n+            name, value = match.groups()\n+            if name:\n+                kwargs[name] = parser.compile_filter(value)\n+            else:\n+                args.append(parser.compile_filter(value))\n+\n+    return URLNode(viewname, args, kwargs, asvar, legacy_view_name=False)"
        },
        {
            "sha": "1f5758c87778cc480c85590d05352c283b9c0d1a",
            "filename": "docs/internals/deprecation.txt",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/docs%2Finternals%2Fdeprecation.txt",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/docs%2Finternals%2Fdeprecation.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Finternals%2Fdeprecation.txt?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -131,6 +131,11 @@ their deprecation, as per the :ref:`Django deprecation policy\n           been deprecated in favor of the\n           :class:`~django.contrib.staticfiles.handlers.StaticFilesHandler`.\n \n+        * The :ttag:`url` and :ttag:`ssi` template tags will be\n+          modified so that the first argument to each tag is a\n+          template variable, not an implied string. The new-style\n+          behavior is provided in the ``future`` template tag library.\n+\n     * 2.0\n         * ``django.views.defaults.shortcut()``. This function has been moved\n           to ``django.contrib.contenttypes.views.shortcut()`` as part of the"
        },
        {
            "sha": "85050cf5ee1a5ef9037979acbe26dd041c4c9f37",
            "filename": "docs/ref/templates/builtins.txt",
            "status": "modified",
            "additions": 63,
            "deletions": 1,
            "changes": 64,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/docs%2Fref%2Ftemplates%2Fbuiltins.txt",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/docs%2Fref%2Ftemplates%2Fbuiltins.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Ftemplates%2Fbuiltins.txt?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -657,6 +657,17 @@ load\n \n Load a custom template tag set.\n \n+For example, the following template would load all the tags and filters registered\n+in ``somelibrary`` and ``otherlibrary``::\n+\n+    {% load somelibrary otherlibrary %}\n+\n+You can also selectively load individual templates or tags from a library, using\n+the ``from`` argument. In this example, the template tags/filters named ``foo``\n+and ``bar`` will be loaded from ``somelibrary``::\n+\n+    {% load foo bar from somelibrary %}\n+\n See :doc:`Custom tag and filter libraries </howto/custom-template-tags>` for more information.\n \n .. templatetag:: now\n@@ -838,6 +849,30 @@ Note that if you use ``{% ssi %}``, you'll need to define\n \n See also: ``{% include %}``.\n \n+.. admonition:: Forwards compatibility\n+\n+    .. versionchanged:: 1.3\n+\n+    In Django 1.5, the behavior of the :ttag:`ssi` template tag will\n+    change, with the the first argument being made into a context\n+    variable, rather than being a special case unquoted constant. This\n+    will allow the :ttag:`ssi` tag to use a context variable as the\n+    value of the page to be included.\n+\n+    In order to provide a forwards compatibility path, Django 1.3\n+    provides a future compatibility library -- ``future`` -- that\n+    implements the new behavior. To use this library, add a\n+    :ttag:`load` call at the top of any template using the :ttag:`ssi`\n+    tag, and wrap the first argument to the :ttag:`ssi` tag in quotes.\n+    For example::\n+\n+        {% load ssi from future %}\n+        {% ssi '/home/html/ljworld.com/includes/right_generic.html' %}\n+\n+    In Django 1.5, the unquoted constant behavior will be replaced\n+    with the behavior provided by the ``future`` tag library.\n+    Existing templates be migrated to use the new syntax.\n+\n .. templatetag:: templatetag\n \n templatetag\n@@ -955,10 +990,37 @@ here's what it looks like::\n     {% url path.to.view arg,arg2 %}\n     {% url path.to.view arg, arg2 %}\n \n-This syntax doesn't support the use of literal commas, or or equals\n+This syntax doesn't support the use of literal commas, or equals\n signs. Did we mention you shouldn't use this syntax in any new\n projects?\n \n+.. admonition:: Forwards compatibility\n+\n+    .. versionchanged:: 1.3\n+\n+    In Django 1.5, the behavior of the :ttag:`url` template tag will\n+    change, with the the first argument being made into a context\n+    variable, rather than being a special case unquoted constant. This\n+    will allow the :ttag:`url` tag to use a context variable as the\n+    value of the URL name to be reversed.\n+\n+    In order to provide a forwards compatibility path, Django 1.3\n+    provides a future compatibility library -- ``future`` -- that\n+    implements the new behavior. To use this library, add a\n+    :ttag:`load` call at the top of any template using the :ttag:`url`\n+    tag, and wrap the first argument to the :ttag:`url` tag in quotes.\n+    For example::\n+\n+        {% load url from future %}\n+        {% url 'myapp:view-name' %}\n+\n+    The new library also drops support for the comma syntax for\n+    separating arguments to the :ttag:`url` template tag.\n+\n+    In Django 1.5, the old behavior will be replaced with the behavior\n+    provided by the ``future`` tag library. Existing templates be\n+    migrated to use the new syntax.\n+\n .. templatetag:: widthratio\n \n widthratio"
        },
        {
            "sha": "d1c42496ce3f017a2037b81efb409a6105dbfcaa",
            "filename": "docs/releases/1.3.txt",
            "status": "modified",
            "additions": 41,
            "deletions": 0,
            "changes": 41,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/docs%2Freleases%2F1.3.txt",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/docs%2Freleases%2F1.3.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.3.txt?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -344,3 +344,44 @@ and Ctrl-C test termination) have been made redundant. In view of this\n redundancy, :class:`~django.test.simple.DjangoTestRunner` has been\n turned into an empty placeholder class, and will be removed entirely\n in Django 1.5.\n+\n+Changes to :ttag:`url` and :ttag:`ssi`\n+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+\n+Most template tags will allow you to pass in either constants or\n+variables as arguments -- for example::\n+\n+    {% extends \"base.html\" %}\n+\n+allows you to specify a base template as a constant, but if you have a\n+context variable ``templ`` that contains the value ``base.html``::\n+\n+    {% extends templ %}\n+\n+is also legal.\n+\n+However, due to an accident of history, the :ttag:`url` and\n+:ttag:`ssi` are different. These tags use the second, quoteless\n+syntax, but interpret the argument as a constant. This means it isn't\n+possible to use a context variable as the target of a :ttag:`url` and\n+:ttag:`ssi` tag.\n+\n+Django 1.3 marks the start of the process to correct this historical\n+accident. Django 1.3 adds a new template library -- ``future`` -- that\n+provides alternate implementations of the :ttag:`url` and :ttag:`ssi`\n+template tags. This ``future`` library implement behavior that makes\n+the handling of the first argument consistent with the handling of all\n+other variables. So, an existing template that contains::\n+\n+    {% url sample %}\n+\n+should be replaced with::\n+\n+    {% load url from future %}\n+    {% url 'sample' %}\n+\n+The tags implementing the old behavior have been deprecated, and in\n+Django 1.5, the old behavior will be replaced with the new behavior.\n+To ensure compatibility with future versions of Django, existing\n+templates should be modified to use the new ``future`` libraries and\n+syntax."
        },
        {
            "sha": "5df2a344cc8ae0badf6fc0731aa67416b22abdd2",
            "filename": "tests/regressiontests/context_processors/templates/context_processors/auth_attrs_user.html",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/tests%2Fregressiontests%2Fcontext_processors%2Ftemplates%2Fcontext_processors%2Fauth_attrs_user.html",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/tests%2Fregressiontests%2Fcontext_processors%2Ftemplates%2Fcontext_processors%2Fauth_attrs_user.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fcontext_processors%2Ftemplates%2Fcontext_processors%2Fauth_attrs_user.html?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -1,4 +1,4 @@\n-unicode: {{ user }}\n+{% load url from future %}unicode: {{ user }}\n id: {{ user.id }}\n username: {{ user.username }}\n-url: {% url userpage user %}\n+url: {% url 'userpage' user %}"
        },
        {
            "sha": "58d5926fbbe5494720b28bceaf83ac172cc597d1",
            "filename": "tests/regressiontests/templates/templates/ssi_include.html",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/tests%2Fregressiontests%2Ftemplates%2Ftemplates%2Fssi_include.html",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/tests%2Fregressiontests%2Ftemplates%2Ftemplates%2Fssi_include.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftemplates%2Ftemplates%2Fssi_include.html?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -0,0 +1 @@\n+This is for testing an ssi include. {{ test }}"
        },
        {
            "sha": "4e1ae9bf84f29ed920b32d14f5ba2cec4ca43cfe",
            "filename": "tests/regressiontests/templates/tests.py",
            "status": "modified",
            "additions": 128,
            "deletions": 31,
            "changes": 159,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/tests%2Fregressiontests%2Ftemplates%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftemplates%2Ftests.py?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -51,7 +51,12 @@ def render(self, context):\n def do_echo(parser, token):\n     return EchoNode(token.contents.split()[1:])\n \n+def do_upper(value):\n+    return value.upper()\n+\n register.tag(\"echo\", do_echo)\n+register.tag(\"other_echo\", do_echo)\n+register.filter(\"upper\", do_upper)\n \n template.libraries['testtags'] = register\n \n@@ -354,6 +359,10 @@ def test_template_loader(template_name, template_dirs=None):\n         old_invalid = settings.TEMPLATE_STRING_IF_INVALID\n         expected_invalid_str = 'INVALID'\n \n+        #Set ALLOWED_INCLUDE_ROOTS so that ssi works.\n+        old_allowed_include_roots = settings.ALLOWED_INCLUDE_ROOTS\n+        settings.ALLOWED_INCLUDE_ROOTS = os.path.dirname(os.path.abspath(__file__))\n+\n         # Warm the URL reversing cache. This ensures we don't pay the cost\n         # warming the cache during one of the tests.\n         urlresolvers.reverse('regressiontests.templates.views.client_action',\n@@ -416,6 +425,7 @@ def test_template_loader(template_name, template_dirs=None):\n         deactivate()\n         settings.TEMPLATE_DEBUG = old_td\n         settings.TEMPLATE_STRING_IF_INVALID = old_invalid\n+        settings.ALLOWED_INCLUDE_ROOTS = old_allowed_include_roots\n \n         self.assertEqual(failures, [], \"Tests failed:\\n%s\\n%s\" %\n             ('-'*70, (\"\\n%s\\n\" % ('-'*70)).join(failures)))\n@@ -1056,6 +1066,19 @@ def get_template_tests(self):\n             'inheritance40': (\"{% extends 'inheritance33' %}{% block opt %}new{{ block.super }}{% endblock %}\", {'optional': 1}, '1new23'),\n             'inheritance41': (\"{% extends 'inheritance36' %}{% block opt %}new{{ block.super }}{% endblock %}\", {'numbers': '123'}, '_new1_new2_new3_'),\n \n+            ### LOADING TAG LIBRARIES #################################################\n+\n+            # {% load %} tag, importing individual tags\n+            'load1': (\"{% load echo from testtags %}{% echo this that theother %}\", {}, 'this that theother'),\n+            'load2': (\"{% load echo other_echo from testtags %}{% echo this that theother %} {% other_echo and another thing %}\", {}, 'this that theother and another thing'),\n+            'load3': (\"{% load echo upper from testtags %}{% echo this that theother %} {{ statement|upper }}\", {'statement': 'not shouting'}, 'this that theother NOT SHOUTING'),\n+\n+            # {% load %} tag errors\n+            'load4': (\"{% load echo other_echo bad_tag from testtags %}\", {}, template.TemplateSyntaxError),\n+            'load5': (\"{% load echo other_echo bad_tag from %}\", {}, template.TemplateSyntaxError),\n+            'load6': (\"{% load from testtags %}\", {}, template.TemplateSyntaxError),\n+            'load7': (\"{% load echo from bad_library %}\", {}, template.TemplateSyntaxError),\n+\n             ### I18N ##################################################################\n \n             # {% spaceless %} tag\n@@ -1179,6 +1202,30 @@ def get_template_tests(self):\n                           '{% endfor %},' + \\\n                           '{% endfor %}',\n                           {}, ''),\n+            ### SSI TAG ########################################################\n+\n+            # Test normal behavior\n+            'old-ssi01': ('{%% ssi %s %%}' % os.path.join(os.path.dirname(os.path.abspath(__file__)), 'templates', 'ssi_include.html'), {}, 'This is for testing an ssi include. {{ test }}\\n'),\n+            'old-ssi02': ('{%% ssi %s %%}' % os.path.join(os.path.dirname(os.path.abspath(__file__)), 'not_here'), {}, ''),\n+\n+            # Test parsed output\n+            'old-ssi06': ('{%% ssi %s parsed %%}' % os.path.join(os.path.dirname(os.path.abspath(__file__)), 'templates', 'ssi_include.html'), {'test': 'Look ma! It parsed!'}, 'This is for testing an ssi include. Look ma! It parsed!\\n'),\n+            'old-ssi07': ('{%% ssi %s parsed %%}' % os.path.join(os.path.dirname(os.path.abspath(__file__)), 'not_here'), {'test': 'Look ma! It parsed!'}, ''),\n+\n+            # Future compatibility\n+            # Test normal behavior\n+            'ssi01': ('{%% load ssi from future %%}{%% ssi \"%s\" %%}' % os.path.join(os.path.dirname(os.path.abspath(__file__)), 'templates', 'ssi_include.html'), {}, 'This is for testing an ssi include. {{ test }}\\n'),\n+            'ssi02': ('{%% load ssi from future %%}{%% ssi \"%s\" %%}' % os.path.join(os.path.dirname(os.path.abspath(__file__)), 'not_here'), {}, ''),\n+            'ssi03': (\"{%% load ssi from future %%}{%% ssi '%s' %%}\" % os.path.join(os.path.dirname(os.path.abspath(__file__)), 'not_here'), {}, ''),\n+\n+            # Test passing as a variable\n+            'ssi04': ('{% load ssi from future %}{% ssi ssi_file %}', {'ssi_file': os.path.join(os.path.dirname(os.path.abspath(__file__)), 'templates', 'ssi_include.html')}, 'This is for testing an ssi include. {{ test }}\\n'),\n+            'ssi05': ('{% load ssi from future %}{% ssi ssi_file %}', {'ssi_file': 'no_file'}, ''),\n+\n+            # Test parsed output\n+            'ssi06': ('{%% load ssi from future %%}{%% ssi \"%s\" parsed %%}' % os.path.join(os.path.dirname(os.path.abspath(__file__)), 'templates', 'ssi_include.html'), {'test': 'Look ma! It parsed!'}, 'This is for testing an ssi include. Look ma! It parsed!\\n'),\n+            'ssi07': ('{%% load ssi from future %%}{%% ssi \"%s\" parsed %%}' % os.path.join(os.path.dirname(os.path.abspath(__file__)), 'not_here'), {'test': 'Look ma! It parsed!'}, ''),\n+\n \n             ### TEMPLATETAG TAG #######################################################\n             'templatetag01': ('{% templatetag openblock %}', {}, '{%'),\n@@ -1244,41 +1291,91 @@ def get_template_tests(self):\n             'legacyurl16a': (\"{% url regressiontests.templates.views.client_action action='update',id='1' %}\", {}, '/url_tag/client/1/update/'),\n             'legacyurl17': ('{% url regressiontests.templates.views.client_action client_id=client.my_id,action=action %}', {'client': {'my_id': 1}, 'action': 'update'}, '/url_tag/client/1/update/'),\n \n-            'url01': ('{% url regressiontests.templates.views.client client.id %}', {'client': {'id': 1}}, '/url_tag/client/1/'),\n-            'url02': ('{% url regressiontests.templates.views.client_action id=client.id action=\"update\" %}', {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n-            'url02a': ('{% url regressiontests.templates.views.client_action client.id \"update\" %}', {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n-            'url02b': (\"{% url regressiontests.templates.views.client_action id=client.id action='update' %}\", {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n-            'url02c': (\"{% url regressiontests.templates.views.client_action client.id 'update' %}\", {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n-            'url03': ('{% url regressiontests.templates.views.index %}', {}, '/url_tag/'),\n-            'url04': ('{% url named.client client.id %}', {'client': {'id': 1}}, '/url_tag/named-client/1/'),\n-            'url05': (u'{% url метка_оператора v %}', {'v': u'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n-            'url06': (u'{% url метка_оператора_2 tag=v %}', {'v': u'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n-            'url07': (u'{% url regressiontests.templates.views.client2 tag=v %}', {'v': u'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n-            'url08': (u'{% url метка_оператора v %}', {'v': 'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n-            'url09': (u'{% url метка_оператора_2 tag=v %}', {'v': 'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n-            'url10': ('{% url regressiontests.templates.views.client_action id=client.id action=\"two words\" %}', {'client': {'id': 1}}, '/url_tag/client/1/two%20words/'),\n-            'url11': ('{% url regressiontests.templates.views.client_action id=client.id action=\"==\" %}', {'client': {'id': 1}}, '/url_tag/client/1/==/'),\n-            'url12': ('{% url regressiontests.templates.views.client_action id=client.id action=\",\" %}', {'client': {'id': 1}}, '/url_tag/client/1/,/'),\n-            'url13': ('{% url regressiontests.templates.views.client_action id=client.id action=arg|join:\"-\" %}', {'client': {'id': 1}, 'arg':['a','b']}, '/url_tag/client/1/a-b/'),\n-            'url14': ('{% url regressiontests.templates.views.client_action client.id arg|join:\"-\" %}', {'client': {'id': 1}, 'arg':['a','b']}, '/url_tag/client/1/a-b/'),\n-            'url15': ('{% url regressiontests.templates.views.client_action 12 \"test\" %}', {}, '/url_tag/client/12/test/'),\n-            'url18': ('{% url regressiontests.templates.views.client \"1,2\" %}', {}, '/url_tag/client/1,2/'),\n+            'old-url01': ('{% url regressiontests.templates.views.client client.id %}', {'client': {'id': 1}}, '/url_tag/client/1/'),\n+            'old-url02': ('{% url regressiontests.templates.views.client_action id=client.id action=\"update\" %}', {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n+            'old-url02a': ('{% url regressiontests.templates.views.client_action client.id \"update\" %}', {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n+            'old-url02b': (\"{% url regressiontests.templates.views.client_action id=client.id action='update' %}\", {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n+            'old-url02c': (\"{% url regressiontests.templates.views.client_action client.id 'update' %}\", {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n+            'old-url03': ('{% url regressiontests.templates.views.index %}', {}, '/url_tag/'),\n+            'old-url04': ('{% url named.client client.id %}', {'client': {'id': 1}}, '/url_tag/named-client/1/'),\n+            'old-url05': (u'{% url метка_оператора v %}', {'v': u'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'old-url06': (u'{% url метка_оператора_2 tag=v %}', {'v': u'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'old-url07': (u'{% url regressiontests.templates.views.client2 tag=v %}', {'v': u'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'old-url08': (u'{% url метка_оператора v %}', {'v': 'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'old-url09': (u'{% url метка_оператора_2 tag=v %}', {'v': 'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'old-url10': ('{% url regressiontests.templates.views.client_action id=client.id action=\"two words\" %}', {'client': {'id': 1}}, '/url_tag/client/1/two%20words/'),\n+            'old-url11': ('{% url regressiontests.templates.views.client_action id=client.id action=\"==\" %}', {'client': {'id': 1}}, '/url_tag/client/1/==/'),\n+            'old-url12': ('{% url regressiontests.templates.views.client_action id=client.id action=\",\" %}', {'client': {'id': 1}}, '/url_tag/client/1/,/'),\n+            'old-url13': ('{% url regressiontests.templates.views.client_action id=client.id action=arg|join:\"-\" %}', {'client': {'id': 1}, 'arg':['a','b']}, '/url_tag/client/1/a-b/'),\n+            'old-url14': ('{% url regressiontests.templates.views.client_action client.id arg|join:\"-\" %}', {'client': {'id': 1}, 'arg':['a','b']}, '/url_tag/client/1/a-b/'),\n+            'old-url15': ('{% url regressiontests.templates.views.client_action 12 \"test\" %}', {}, '/url_tag/client/12/test/'),\n+            'old-url18': ('{% url regressiontests.templates.views.client \"1,2\" %}', {}, '/url_tag/client/1,2/'),\n+\n+            # Failures\n+            'old-url-fail01': ('{% url %}', {}, template.TemplateSyntaxError),\n+            'old-url-fail02': ('{% url no_such_view %}', {}, urlresolvers.NoReverseMatch),\n+            'old-url-fail03': ('{% url regressiontests.templates.views.client %}', {}, urlresolvers.NoReverseMatch),\n+            'old-url-fail04': ('{% url view id, %}', {}, template.TemplateSyntaxError),\n+            'old-url-fail05': ('{% url view id= %}', {}, template.TemplateSyntaxError),\n+            'old-url-fail06': ('{% url view a.id=id %}', {}, template.TemplateSyntaxError),\n+            'old-url-fail07': ('{% url view a.id!id %}', {}, template.TemplateSyntaxError),\n+            'old-url-fail08': ('{% url view id=\"unterminatedstring %}', {}, template.TemplateSyntaxError),\n+            'old-url-fail09': ('{% url view id=\", %}', {}, template.TemplateSyntaxError),\n+\n+            # {% url ... as var %}\n+            'old-url-asvar01': ('{% url regressiontests.templates.views.index as url %}', {}, ''),\n+            'old-url-asvar02': ('{% url regressiontests.templates.views.index as url %}{{ url }}', {}, '/url_tag/'),\n+            'old-url-asvar03': ('{% url no_such_view as url %}{{ url }}', {}, ''),\n+\n+            # forward compatibility\n+            # Successes\n+            'url01': ('{% load url from future %}{% url \"regressiontests.templates.views.client\" client.id %}', {'client': {'id': 1}}, '/url_tag/client/1/'),\n+            'url02': ('{% load url from future %}{% url \"regressiontests.templates.views.client_action\" id=client.id action=\"update\" %}', {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n+            'url02a': ('{% load url from future %}{% url \"regressiontests.templates.views.client_action\" client.id \"update\" %}', {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n+            'url02b': (\"{% load url from future %}{% url 'regressiontests.templates.views.client_action' id=client.id action='update' %}\", {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n+            'url02c': (\"{% load url from future %}{% url 'regressiontests.templates.views.client_action' client.id 'update' %}\", {'client': {'id': 1}}, '/url_tag/client/1/update/'),\n+            'url03': ('{% load url from future %}{% url \"regressiontests.templates.views.index\" %}', {}, '/url_tag/'),\n+            'url04': ('{% load url from future %}{% url \"named.client\" client.id %}', {'client': {'id': 1}}, '/url_tag/named-client/1/'),\n+            'url05': (u'{% load url from future %}{% url \"метка_оператора\" v %}', {'v': u'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'url06': (u'{% load url from future %}{% url \"метка_оператора_2\" tag=v %}', {'v': u'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'url07': (u'{% load url from future %}{% url \"regressiontests.templates.views.client2\" tag=v %}', {'v': u'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'url08': (u'{% load url from future %}{% url \"метка_оператора\" v %}', {'v': 'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'url09': (u'{% load url from future %}{% url \"метка_оператора_2\" tag=v %}', {'v': 'Ω'}, '/url_tag/%D0%AE%D0%BD%D0%B8%D0%BA%D0%BE%D0%B4/%CE%A9/'),\n+            'url10': ('{% load url from future %}{% url \"regressiontests.templates.views.client_action\" id=client.id action=\"two words\" %}', {'client': {'id': 1}}, '/url_tag/client/1/two%20words/'),\n+            'url11': ('{% load url from future %}{% url \"regressiontests.templates.views.client_action\" id=client.id action=\"==\" %}', {'client': {'id': 1}}, '/url_tag/client/1/==/'),\n+            'url12': ('{% load url from future %}{% url \"regressiontests.templates.views.client_action\" id=client.id action=\",\" %}', {'client': {'id': 1}}, '/url_tag/client/1/,/'),\n+            'url13': ('{% load url from future %}{% url \"regressiontests.templates.views.client_action\" id=client.id action=arg|join:\"-\" %}', {'client': {'id': 1}, 'arg':['a','b']}, '/url_tag/client/1/a-b/'),\n+            'url14': ('{% load url from future %}{% url \"regressiontests.templates.views.client_action\" client.id arg|join:\"-\" %}', {'client': {'id': 1}, 'arg':['a','b']}, '/url_tag/client/1/a-b/'),\n+            'url15': ('{% load url from future %}{% url \"regressiontests.templates.views.client_action\" 12 \"test\" %}', {}, '/url_tag/client/12/test/'),\n+            'url18': ('{% load url from future %}{% url \"regressiontests.templates.views.client\" \"1,2\" %}', {}, '/url_tag/client/1,2/'),\n+\n+            'url19': ('{% load url from future %}{% url named_url client.id %}', {'named_url': 'regressiontests.templates.views.client', 'client': {'id': 1}}, '/url_tag/client/1/'),\n \n             # Failures\n-            'url-fail01': ('{% url %}', {}, template.TemplateSyntaxError),\n-            'url-fail02': ('{% url no_such_view %}', {}, urlresolvers.NoReverseMatch),\n-            'url-fail03': ('{% url regressiontests.templates.views.client %}', {}, urlresolvers.NoReverseMatch),\n-            'url-fail04': ('{% url view id, %}', {}, template.TemplateSyntaxError),\n-            'url-fail05': ('{% url view id= %}', {}, template.TemplateSyntaxError),\n-            'url-fail06': ('{% url view a.id=id %}', {}, template.TemplateSyntaxError),\n-            'url-fail07': ('{% url view a.id!id %}', {}, template.TemplateSyntaxError),\n-            'url-fail08': ('{% url view id=\"unterminatedstring %}', {}, template.TemplateSyntaxError),\n-            'url-fail09': ('{% url view id=\", %}', {}, template.TemplateSyntaxError),\n+            'url-fail01': ('{% load url from future %}{% url %}', {}, template.TemplateSyntaxError),\n+            'url-fail02': ('{% load url from future %}{% url \"no_such_view\" %}', {}, urlresolvers.NoReverseMatch),\n+            'url-fail03': ('{% load url from future %}{% url \"regressiontests.templates.views.client\" %}', {}, urlresolvers.NoReverseMatch),\n+            'url-fail04': ('{% load url from future %}{% url \"view\" id, %}', {}, template.TemplateSyntaxError),\n+            'url-fail05': ('{% load url from future %}{% url \"view\" id= %}', {}, template.TemplateSyntaxError),\n+            'url-fail06': ('{% load url from future %}{% url \"view\" a.id=id %}', {}, template.TemplateSyntaxError),\n+            'url-fail07': ('{% load url from future %}{% url \"view\" a.id!id %}', {}, template.TemplateSyntaxError),\n+            'url-fail08': ('{% load url from future %}{% url \"view\" id=\"unterminatedstring %}', {}, template.TemplateSyntaxError),\n+            'url-fail09': ('{% load url from future %}{% url \"view\" id=\", %}', {}, template.TemplateSyntaxError),\n+\n+            'url-fail11': ('{% load url from future %}{% url named_url %}', {}, urlresolvers.NoReverseMatch),\n+            'url-fail12': ('{% load url from future %}{% url named_url %}', {'named_url': 'no_such_view'}, urlresolvers.NoReverseMatch),\n+            'url-fail13': ('{% load url from future %}{% url named_url %}', {'named_url': 'regressiontests.templates.views.client'}, urlresolvers.NoReverseMatch),\n+            'url-fail14': ('{% load url from future %}{% url named_url id, %}', {'named_url': 'view'}, template.TemplateSyntaxError),\n+            'url-fail15': ('{% load url from future %}{% url named_url id= %}', {'named_url': 'view'}, template.TemplateSyntaxError),\n+            'url-fail16': ('{% load url from future %}{% url named_url a.id=id %}', {'named_url': 'view'}, template.TemplateSyntaxError),\n+            'url-fail17': ('{% load url from future %}{% url named_url a.id!id %}', {'named_url': 'view'}, template.TemplateSyntaxError),\n+            'url-fail18': ('{% load url from future %}{% url named_url id=\"unterminatedstring %}', {'named_url': 'view'}, template.TemplateSyntaxError),\n+            'url-fail19': ('{% load url from future %}{% url named_url id=\", %}', {'named_url': 'view'}, template.TemplateSyntaxError),\n \n             # {% url ... as var %}\n-            'url-asvar01': ('{% url regressiontests.templates.views.index as url %}', {}, ''),\n-            'url-asvar02': ('{% url regressiontests.templates.views.index as url %}{{ url }}', {}, '/url_tag/'),\n-            'url-asvar03': ('{% url no_such_view as url %}{{ url }}', {}, ''),\n+            'url-asvar01': ('{% load url from future %}{% url \"regressiontests.templates.views.index\" as url %}', {}, ''),\n+            'url-asvar02': ('{% load url from future %}{% url \"regressiontests.templates.views.index\" as url %}{{ url }}', {}, '/url_tag/'),\n+            'url-asvar03': ('{% load url from future %}{% url \"no_such_view\" as url %}{{ url }}', {}, ''),\n \n             ### CACHE TAG ######################################################\n             'cache01': ('{% load cache %}{% cache -1 test %}cache01{% endcache %}', {}, 'cache01'),"
        },
        {
            "sha": "e9819623a377a03af31b069334fef8208b9204a7",
            "filename": "tests/regressiontests/urlpatterns_reverse/urlconf_inner.py",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/tests%2Fregressiontests%2Furlpatterns_reverse%2Furlconf_inner.py",
            "raw_url": "https://github.com/django/django/raw/7ff5580d95f6bb40f12a0b90f51570e23b014a2d/tests%2Fregressiontests%2Furlpatterns_reverse%2Furlconf_inner.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Furlpatterns_reverse%2Furlconf_inner.py?ref=7ff5580d95f6bb40f12a0b90f51570e23b014a2d",
            "patch": "@@ -3,8 +3,9 @@\n from django.http import HttpResponse\n \n def inner_view(request):\n-    content = Template('{% url outer as outer_url %}outer:{{ outer_url }},'\n-                       '{% url inner as inner_url %}inner:{{ inner_url }}').render(Context())\n+    content = Template('{% load url from future %}'\n+                       '{% url \"outer\" as outer_url %}outer:{{ outer_url }},'\n+                       '{% url \"inner\" as inner_url %}inner:{{ inner_url }}').render(Context())\n     return HttpResponse(content)\n \n urlpatterns = patterns('',"
        }
    ],
    "stats": {
        "total": 489,
        "additions": 424,
        "deletions": 65
    }
}