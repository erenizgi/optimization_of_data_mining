{
    "author": "jezdez",
    "message": "Fixed #16629 -- Relaxed check for STATIC_ROOT and STATIC_URL settings slightly to only raise an exception if really needed.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16617 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "2980f2ab9aabdea3a3b7ec343252889408690630",
    "files": [
        {
            "sha": "a804c5626c856011c672f888ca8a9970bc9074d0",
            "filename": "django/contrib/staticfiles/storage.py",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/2980f2ab9aabdea3a3b7ec343252889408690630/django%2Fcontrib%2Fstaticfiles%2Fstorage.py",
            "raw_url": "https://github.com/django/django/raw/2980f2ab9aabdea3a3b7ec343252889408690630/django%2Fcontrib%2Fstaticfiles%2Fstorage.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fstaticfiles%2Fstorage.py?ref=2980f2ab9aabdea3a3b7ec343252889408690630",
            "patch": "@@ -30,17 +30,17 @@ def __init__(self, location=None, base_url=None, *args, **kwargs):\n             location = settings.STATIC_ROOT\n         if base_url is None:\n             base_url = settings.STATIC_URL\n-        if not location:\n-            raise ImproperlyConfigured(\"You're using the staticfiles app \"\n-                \"without having set the STATIC_ROOT setting.\")\n-        # check for None since we might use a root URL (``/``)\n-        if base_url is None:\n-            raise ImproperlyConfigured(\"You're using the staticfiles app \"\n-                \"without having set the STATIC_URL setting.\")\n-        check_settings()\n+        check_settings(base_url)\n         super(StaticFilesStorage, self).__init__(location, base_url,\n                                                  *args, **kwargs)\n \n+    def path(self, name):\n+        if not self.location:\n+            raise ImproperlyConfigured(\"You're using the staticfiles app \"\n+                                       \"without having set the STATIC_ROOT \"\n+                                       \"setting to a filesystem path.\")\n+        return super(StaticFilesStorage, self).path(name)\n+\n \n class CachedFilesMixin(object):\n     patterns = ("
        },
        {
            "sha": "55ea3cf06b85e72e44580346586364f743cb9f25",
            "filename": "django/contrib/staticfiles/utils.py",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/2980f2ab9aabdea3a3b7ec343252889408690630/django%2Fcontrib%2Fstaticfiles%2Futils.py",
            "raw_url": "https://github.com/django/django/raw/2980f2ab9aabdea3a3b7ec343252889408690630/django%2Fcontrib%2Fstaticfiles%2Futils.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fstaticfiles%2Futils.py?ref=2980f2ab9aabdea3a3b7ec343252889408690630",
            "patch": "@@ -37,16 +37,18 @@ def get_files(storage, ignore_patterns=None, location=''):\n         for fn in get_files(storage, ignore_patterns, dir):\n             yield fn\n \n-def check_settings():\n+def check_settings(base_url=None):\n     \"\"\"\n     Checks if the staticfiles settings have sane values.\n \n     \"\"\"\n-    if not settings.STATIC_URL:\n+    if base_url is not None:\n+        base_url = settings.STATIC_URL\n+    if not base_url:\n         raise ImproperlyConfigured(\n             \"You're using the staticfiles app \"\n             \"without having set the required STATIC_URL setting.\")\n-    if settings.MEDIA_URL == settings.STATIC_URL:\n+    if settings.MEDIA_URL == base_url:\n         raise ImproperlyConfigured(\"The MEDIA_URL and STATIC_URL \"\n                                    \"settings must have different values\")\n     if ((settings.MEDIA_ROOT and settings.STATIC_ROOT) and"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 13,
        "deletions": 11
    }
}