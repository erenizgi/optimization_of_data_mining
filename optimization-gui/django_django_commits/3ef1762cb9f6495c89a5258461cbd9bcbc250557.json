{
    "author": "ramiro",
    "message": "Fixed #16924 -- Corrected `date` template filter handling of negative (West of UTC) timezone offsets.\n\nThe 'O' format specifier output was incorrect. Thanks mrgriscom and Aymeric Augustin.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16903 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "3ef1762cb9f6495c89a5258461cbd9bcbc250557",
    "files": [
        {
            "sha": "0afda1850d42098b7a06647fae4c50e66be0e54a",
            "filename": "django/utils/dateformat.py",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/3ef1762cb9f6495c89a5258461cbd9bcbc250557/django%2Futils%2Fdateformat.py",
            "raw_url": "https://github.com/django/django/raw/3ef1762cb9f6495c89a5258461cbd9bcbc250557/django%2Futils%2Fdateformat.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fdateformat.py?ref=3ef1762cb9f6495c89a5258461cbd9bcbc250557",
            "patch": "@@ -182,9 +182,11 @@ def N(self):\n         return MONTHS_AP[self.data.month]\n \n     def O(self):\n-        \"Difference to Greenwich time in hours; e.g. '+0200'\"\n+        \"Difference to Greenwich time in hours; e.g. '+0200', '-0430'\"\n         seconds = self.Z()\n-        return u\"%+03d%02d\" % (seconds // 3600, (seconds // 60) % 60)\n+        sign = '-' if seconds < 0 else '+'\n+        seconds = abs(seconds)\n+        return u\"%s%02d%02d\" % (sign, seconds // 3600, (seconds // 60) % 60)\n \n     def r(self):\n         \"RFC 2822 formatted date; e.g. 'Thu, 21 Dec 2000 16:01:07 +0200'\"\n@@ -275,8 +277,10 @@ def Z(self):\n         if not self.timezone:\n             return 0\n         offset = self.timezone.utcoffset(self.data)\n-        # Only days can be negative, so negative offsets have days=-1 and\n-        # seconds positive. Positive offsets have days=0\n+        # `offset` is a datetime.timedelta. For negative values (to the west of\n+        # UTC) only days can be negative (days=-1) and seconds are always\n+        # positive. e.g. UTC-1 -> timedelta(days=-1, seconds=82800, microseconds=0)\n+        # Positive offsets have days=0\n         return offset.days * 86400 + offset.seconds\n \n def format(value, format_string):"
        },
        {
            "sha": "7ba3673df4a5cdb7f3188ec75e3c3f6b82a1643d",
            "filename": "django/utils/tzinfo.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/3ef1762cb9f6495c89a5258461cbd9bcbc250557/django%2Futils%2Ftzinfo.py",
            "raw_url": "https://github.com/django/django/raw/3ef1762cb9f6495c89a5258461cbd9bcbc250557/django%2Futils%2Ftzinfo.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftzinfo.py?ref=3ef1762cb9f6495c89a5258461cbd9bcbc250557",
            "patch": "@@ -13,7 +13,7 @@ def __init__(self, offset):\n         else:\n             self.__offset = timedelta(minutes=offset)\n \n-        sign = offset < 0 and '-' or '+'\n+        sign = '-' if offset < 0 else '+'\n         self.__name = u\"%s%02d%02d\" % (sign, abs(offset) / 60., abs(offset) % 60)\n \n     def __repr__(self):"
        },
        {
            "sha": "f1ef720b205cf421838d64222cc58f87c5e84086",
            "filename": "tests/regressiontests/utils/dateformat.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/3ef1762cb9f6495c89a5258461cbd9bcbc250557/tests%2Fregressiontests%2Futils%2Fdateformat.py",
            "raw_url": "https://github.com/django/django/raw/3ef1762cb9f6495c89a5258461cbd9bcbc250557/tests%2Fregressiontests%2Futils%2Fdateformat.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Futils%2Fdateformat.py?ref=3ef1762cb9f6495c89a5258461cbd9bcbc250557",
            "patch": "@@ -127,3 +127,9 @@ def test_timezones(self):\n             self.assertEqual(dateformat.format(summertime, 'O'), u'+0200')\n             self.assertEqual(dateformat.format(wintertime, 'I'), u'0')\n             self.assertEqual(dateformat.format(wintertime, 'O'), u'+0100')\n+\n+        # Ticket #16924 -- We don't need timezone support to test this\n+        # 3h30m to the west of UTC\n+        tz = FixedOffset(-3*60 - 30)\n+        dt = datetime(2009, 5, 16, 5, 30, 30, tzinfo=tz)\n+        self.assertEqual(dateformat.format(dt, 'O'), u'-0330')"
        }
    ],
    "stats": {
        "total": 20,
        "additions": 15,
        "deletions": 5
    }
}