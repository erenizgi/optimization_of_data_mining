{
    "author": "jbronn",
    "message": "Updated `GeoSQLCompiler.get_default_columns`.",
    "sha": "065b52f18e7016b385feb8ad3de5dafb72ad202d",
    "files": [
        {
            "sha": "cf6a8ad0476a966c97176e456e9aa537cd286782",
            "filename": "django/contrib/gis/db/models/sql/compiler.py",
            "status": "modified",
            "additions": 5,
            "deletions": 8,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/065b52f18e7016b385feb8ad3de5dafb72ad202d/django%2Fcontrib%2Fgis%2Fdb%2Fmodels%2Fsql%2Fcompiler.py",
            "raw_url": "https://github.com/django/django/raw/065b52f18e7016b385feb8ad3de5dafb72ad202d/django%2Fcontrib%2Fgis%2Fdb%2Fmodels%2Fsql%2Fcompiler.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fdb%2Fmodels%2Fsql%2Fcompiler.py?ref=065b52f18e7016b385feb8ad3de5dafb72ad202d",
            "patch": "@@ -119,10 +119,10 @@ def get_default_columns(self, with_aliases=False, col_aliases=None,\n         result = []\n         if opts is None:\n             opts = self.query.model._meta\n+        # Skip all proxy to the root proxied model\n+        opts = opts.concrete_model._meta\n         aliases = set()\n         only_load = self.deferred_to_columns()\n-        # Skip all proxy to the root proxied model\n-        proxied_model = opts.concrete_model\n \n         if start_alias:\n             seen = {None: start_alias}\n@@ -133,12 +133,9 @@ def get_default_columns(self, with_aliases=False, col_aliases=None,\n                 try:\n                     alias = seen[model]\n                 except KeyError:\n-                    if model is proxied_model:\n-                        alias = start_alias\n-                    else:\n-                        link_field = opts.get_ancestor_link(model)\n-                        alias = self.query.join((start_alias, model._meta.db_table,\n-                                link_field.column, model._meta.pk.column))\n+                    link_field = opts.get_ancestor_link(model)\n+                    alias = self.query.join((start_alias, model._meta.db_table,\n+                            link_field.column, model._meta.pk.column))\n                     seen[model] = alias\n             else:\n                 # If we're starting from the base model of the queryset, the"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 5,
        "deletions": 8
    }
}