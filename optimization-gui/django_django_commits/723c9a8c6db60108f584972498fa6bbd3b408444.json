{
    "author": "aaugustin",
    "message": "[py3] Ported the 'shell' management command.\n\nThe user module and the execfile function were removed in Python 3.\n\nThanks Linovia for the report.",
    "sha": "723c9a8c6db60108f584972498fa6bbd3b408444",
    "files": [
        {
            "sha": "52a8cab7e40567f7640dc9789c00e4c0095e9d85",
            "filename": "django/core/management/commands/shell.py",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/723c9a8c6db60108f584972498fa6bbd3b408444/django%2Fcore%2Fmanagement%2Fcommands%2Fshell.py",
            "raw_url": "https://github.com/django/django/raw/723c9a8c6db60108f584972498fa6bbd3b408444/django%2Fcore%2Fmanagement%2Fcommands%2Fshell.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Fshell.py?ref=723c9a8c6db60108f584972498fa6bbd3b408444",
            "patch": "@@ -80,14 +80,14 @@ def handle_noargs(self, **options):\n                 readline.parse_and_bind(\"tab:complete\")\n \n             # We want to honor both $PYTHONSTARTUP and .pythonrc.py, so follow system\n-            # conventions and get $PYTHONSTARTUP first then import user.\n+            # conventions and get $PYTHONSTARTUP first then .pythonrc.py.\n             if not use_plain:\n-                pythonrc = os.environ.get(\"PYTHONSTARTUP\")\n-                if pythonrc and os.path.isfile(pythonrc):\n-                    try:\n-                        execfile(pythonrc)\n-                    except NameError:\n-                        pass\n-                # This will import .pythonrc.py as a side-effect\n-                import user\n+                for pythonrc in (os.environ.get(\"PYTHONSTARTUP\"),\n+                                 os.path.expanduser('~/.pythonrc.py')):\n+                    if pythonrc and os.path.isfile(pythonrc):\n+                        try:\n+                            with open(pythonrc) as handle:\n+                                exec(compile(handle.read(), pythonrc, 'exec'))\n+                        except NameError:\n+                            pass\n             code.interact(local=imported_objects)"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 9,
        "deletions": 9
    }
}