{
    "author": "alex",
    "message": "Move the Python 2.5 specific tests out of their own special files now that 2.5 is the default.  Also add __futre__ import where necessary.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15935 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "e54c0a0c9488ab93c30f1f89c98e5a020a9ec326",
    "files": [
        {
            "sha": "a2977beabc6eb0a210132ef7594c0d3be9bca1be",
            "filename": "django/db/transaction.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/django%2Fdb%2Ftransaction.py",
            "raw_url": "https://github.com/django/django/raw/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/django%2Fdb%2Ftransaction.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Ftransaction.py?ref=e54c0a0c9488ab93c30f1f89c98e5a020a9ec326",
            "patch": "@@ -11,6 +11,7 @@\n Managed transactions don't do those commits, but will need some kind of manual\n or implicit commits or rollbacks.\n \"\"\"\n+from __future__ import with_statement\n \n import sys\n from functools import wraps"
        },
        {
            "sha": "8ce3a7af0fe27d2202b3d4e8c13b42d6579c3778",
            "filename": "django/test/testcases.py",
            "status": "modified",
            "additions": 3,
            "deletions": 8,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/django%2Ftest%2Ftestcases.py",
            "raw_url": "https://github.com/django/django/raw/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/django%2Ftest%2Ftestcases.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftest%2Ftestcases.py?ref=e54c0a0c9488ab93c30f1f89c98e5a020a9ec326",
            "patch": "@@ -1,3 +1,5 @@\n+from __future__ import with_statement\n+\n import re\n import sys\n from functools import wraps\n@@ -531,15 +533,8 @@ def assertNumQueries(self, num, func=None, *args, **kwargs):\n             return context\n \n         # Basically emulate the `with` statement here.\n-\n-        context.__enter__()\n-        try:\n+        with context:\n             func(*args, **kwargs)\n-        except:\n-            context.__exit__(*sys.exc_info())\n-            raise\n-        else:\n-            context.__exit__(*sys.exc_info())\n \n def connections_support_transactions():\n     \"\"\""
        },
        {
            "sha": "ca8965e15aa0c14041bbe5e66f348f1b4fe9c4e0",
            "filename": "tests/modeltests/files/models.py",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/tests%2Fmodeltests%2Ffiles%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/tests%2Fmodeltests%2Ffiles%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ffiles%2Fmodels.py?ref=e54c0a0c9488ab93c30f1f89c98e5a020a9ec326",
            "patch": "@@ -16,9 +16,6 @@\n temp_storage_location = tempfile.mkdtemp()\n temp_storage = FileSystemStorage(location=temp_storage_location)\n \n-# Write out a file to be used as default content\n-temp_storage.save('tests/default.txt', ContentFile('default content'))\n-\n class Storage(models.Model):\n     def custom_upload_to(self, filename):\n         return 'foo'"
        },
        {
            "sha": "885f78798481f765d1de0efcf9fc9ecca2f25ab3",
            "filename": "tests/modeltests/files/tests.py",
            "status": "modified",
            "additions": 14,
            "deletions": 2,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/tests%2Fmodeltests%2Ffiles%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/tests%2Fmodeltests%2Ffiles%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ffiles%2Ftests.py?ref=e54c0a0c9488ab93c30f1f89c98e5a020a9ec326",
            "patch": "@@ -1,21 +1,24 @@\n+from __future__ import with_statement\n+\n import shutil\n import sys\n+import tempfile\n \n from django.core.cache import cache\n+from django.core.files import File\n from django.core.files.base import ContentFile\n from django.core.files.uploadedfile import SimpleUploadedFile\n from django.test import TestCase\n \n from models import Storage, temp_storage, temp_storage_location\n-if sys.version_info >= (2, 5):\n-    from tests_25 import FileObjTests\n \n \n class FileTests(TestCase):\n     def tearDown(self):\n         shutil.rmtree(temp_storage_location)\n \n     def test_files(self):\n+        temp_storage.save('tests/default.txt', ContentFile('default content'))\n         # Attempting to access a FileField from the class raises a descriptive\n         # error\n         self.assertRaises(AttributeError, lambda: Storage.normal)\n@@ -103,3 +106,12 @@ def test_files(self):\n         obj2.normal.delete()\n         obj3.default.delete()\n         obj4.random.delete()\n+\n+    def test_context_manager(self):\n+        orig_file = tempfile.TemporaryFile()\n+        base_file = File(orig_file)\n+        with base_file as f:\n+            self.assertIs(base_file, f)\n+            self.assertFalse(f.closed)\n+        self.assertTrue(f.closed)\n+        self.assertTrue(orig_file.closed)"
        },
        {
            "sha": "48eb6e26f7bd9b071f1791d9df26916504838040",
            "filename": "tests/modeltests/files/tests_25.py",
            "status": "removed",
            "additions": 0,
            "deletions": 17,
            "changes": 17,
            "blob_url": "https://github.com/django/django/blob/b4f0c1a7759c8b96085411bea02cc9a539d6eaf5/tests%2Fmodeltests%2Ffiles%2Ftests_25.py",
            "raw_url": "https://github.com/django/django/raw/b4f0c1a7759c8b96085411bea02cc9a539d6eaf5/tests%2Fmodeltests%2Ffiles%2Ftests_25.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ffiles%2Ftests_25.py?ref=b4f0c1a7759c8b96085411bea02cc9a539d6eaf5",
            "patch": "@@ -1,17 +0,0 @@\n-from __future__ import with_statement\n-\n-import tempfile\n-\n-from django.core.files import File\n-from django.utils.unittest import TestCase\n-\n-\n-class FileObjTests(TestCase):\n-    def test_context_manager(self):\n-        orig_file = tempfile.TemporaryFile()\n-        base_file = File(orig_file)\n-        with base_file as f:\n-            self.assertIs(base_file, f)\n-            self.assertFalse(f.closed)\n-        self.assertTrue(f.closed)\n-        self.assertTrue(orig_file.closed)"
        },
        {
            "sha": "db58b80e2958cf98f1e26d5d11778386ddfe1599",
            "filename": "tests/modeltests/transactions/tests.py",
            "status": "modified",
            "additions": 132,
            "deletions": 4,
            "changes": 136,
            "blob_url": "https://github.com/django/django/blob/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/tests%2Fmodeltests%2Ftransactions%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/tests%2Fmodeltests%2Ftransactions%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ftransactions%2Ftests.py?ref=e54c0a0c9488ab93c30f1f89c98e5a020a9ec326",
            "patch": "@@ -1,3 +1,5 @@\n+from __future__ import with_statement\n+\n import sys\n \n from django.db import connection, transaction, IntegrityError, DEFAULT_DB_ALIAS\n@@ -7,10 +9,6 @@\n from models import Reporter\n \n \n-if sys.version_info >= (2, 5):\n-    from tests_25 import TransactionContextManagerTests\n-\n-\n class TransactionTests(TransactionTestCase):\n     def create_a_reporter_then_fail(self, first, last):\n         a = Reporter(first_name=first, last_name=last)\n@@ -183,3 +181,133 @@ def test_bad_sql(self):\n         execute_bad_sql = transaction.commit_on_success(self.execute_bad_sql)\n         self.assertRaises(IntegrityError, execute_bad_sql)\n         transaction.rollback()\n+\n+class TransactionContextManagerTests(TransactionTestCase):\n+    def create_reporter_and_fail(self):\n+        Reporter.objects.create(first_name=\"Bob\", last_name=\"Holtzman\")\n+        raise Exception\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_autocommit(self):\n+        \"\"\"\n+        The default behavior is to autocommit after each save() action.\n+        \"\"\"\n+        with self.assertRaises(Exception):\n+            self.create_reporter_and_fail()\n+        # The object created before the exception still exists\n+        self.assertEqual(Reporter.objects.count(), 1)\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_autocommit_context_manager(self):\n+        \"\"\"\n+        The autocommit context manager works exactly the same as the default\n+        behavior.\n+        \"\"\"\n+        with self.assertRaises(Exception):\n+            with transaction.autocommit():\n+                self.create_reporter_and_fail()\n+\n+        self.assertEqual(Reporter.objects.count(), 1)\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_autocommit_context_manager_with_using(self):\n+        \"\"\"\n+        The autocommit context manager also works with a using argument.\n+        \"\"\"\n+        with self.assertRaises(Exception):\n+            with transaction.autocommit(using=\"default\"):\n+                self.create_reporter_and_fail()\n+\n+        self.assertEqual(Reporter.objects.count(), 1)\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_commit_on_success(self):\n+        \"\"\"\n+        With the commit_on_success context manager, the transaction is only\n+        committed if the block doesn't throw an exception.\n+        \"\"\"\n+        with self.assertRaises(Exception):\n+            with transaction.commit_on_success():\n+                self.create_reporter_and_fail()\n+\n+        self.assertEqual(Reporter.objects.count(), 0)\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_commit_on_success_with_using(self):\n+        \"\"\"\n+        The commit_on_success context manager also works with a using argument.\n+        \"\"\"\n+        with self.assertRaises(Exception):\n+            with transaction.commit_on_success(using=\"default\"):\n+                self.create_reporter_and_fail()\n+\n+        self.assertEqual(Reporter.objects.count(), 0)\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_commit_on_success_succeed(self):\n+        \"\"\"\n+        If there aren't any exceptions, the data will get saved.\n+        \"\"\"\n+        Reporter.objects.create(first_name=\"Alice\", last_name=\"Smith\")\n+        with transaction.commit_on_success():\n+            Reporter.objects.filter(first_name=\"Alice\").delete()\n+\n+        self.assertQuerysetEqual(Reporter.objects.all(), [])\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_commit_on_success_exit(self):\n+        with transaction.autocommit():\n+            with transaction.commit_on_success():\n+                Reporter.objects.create(first_name=\"Bobby\", last_name=\"Tables\")\n+\n+            # Much more formal\n+            r = Reporter.objects.get()\n+            r.first_name = \"Robert\"\n+            r.save()\n+\n+        r = Reporter.objects.get()\n+        self.assertEqual(r.first_name, \"Robert\")\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_manually_managed(self):\n+        \"\"\"\n+        You can manually manage transactions if you really want to, but you\n+        have to remember to commit/rollback.\n+        \"\"\"\n+        with transaction.commit_manually():\n+            Reporter.objects.create(first_name=\"Libby\", last_name=\"Holtzman\")\n+            transaction.commit()\n+        self.assertEqual(Reporter.objects.count(), 1)\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_manually_managed_mistake(self):\n+        \"\"\"\n+        If you forget, you'll get bad errors.\n+        \"\"\"\n+        with self.assertRaises(transaction.TransactionManagementError):\n+            with transaction.commit_manually():\n+                Reporter.objects.create(first_name=\"Scott\", last_name=\"Browning\")\n+\n+    @skipUnlessDBFeature('supports_transactions')\n+    def test_manually_managed_with_using(self):\n+        \"\"\"\n+        The commit_manually function also works with a using argument.\n+        \"\"\"\n+        with self.assertRaises(transaction.TransactionManagementError):\n+            with transaction.commit_manually(using=\"default\"):\n+                Reporter.objects.create(first_name=\"Walter\", last_name=\"Cronkite\")\n+\n+    @skipUnlessDBFeature('requires_rollback_on_dirty_transaction')\n+    def test_bad_sql(self):\n+        \"\"\"\n+        Regression for #11900: If a block wrapped by commit_on_success\n+        writes a transaction that can't be committed, that transaction should\n+        be rolled back. The bug is only visible using the psycopg2 backend,\n+        though the fix is generally a good idea.\n+        \"\"\"\n+        with self.assertRaises(IntegrityError):\n+            with transaction.commit_on_success():\n+                cursor = connection.cursor()\n+                cursor.execute(\"INSERT INTO transactions_reporter (first_name, last_name) VALUES ('Douglas', 'Adams');\")\n+                transaction.set_dirty()\n+        transaction.rollback()"
        },
        {
            "sha": "cc2290edffcbe577037ec4e64814c9a735f051b4",
            "filename": "tests/modeltests/transactions/tests_25.py",
            "status": "removed",
            "additions": 0,
            "deletions": 137,
            "changes": 137,
            "blob_url": "https://github.com/django/django/blob/b4f0c1a7759c8b96085411bea02cc9a539d6eaf5/tests%2Fmodeltests%2Ftransactions%2Ftests_25.py",
            "raw_url": "https://github.com/django/django/raw/b4f0c1a7759c8b96085411bea02cc9a539d6eaf5/tests%2Fmodeltests%2Ftransactions%2Ftests_25.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ftransactions%2Ftests_25.py?ref=b4f0c1a7759c8b96085411bea02cc9a539d6eaf5",
            "patch": "@@ -1,137 +0,0 @@\n-from __future__ import with_statement\n-\n-from django.db import connection, transaction, IntegrityError\n-from django.test import TransactionTestCase, skipUnlessDBFeature\n-\n-from models import Reporter\n-\n-\n-class TransactionContextManagerTests(TransactionTestCase):\n-    def create_reporter_and_fail(self):\n-        Reporter.objects.create(first_name=\"Bob\", last_name=\"Holtzman\")\n-        raise Exception\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_autocommit(self):\n-        \"\"\"\n-        The default behavior is to autocommit after each save() action.\n-        \"\"\"\n-        with self.assertRaises(Exception):\n-            self.create_reporter_and_fail()\n-        # The object created before the exception still exists\n-        self.assertEqual(Reporter.objects.count(), 1)\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_autocommit_context_manager(self):\n-        \"\"\"\n-        The autocommit context manager works exactly the same as the default\n-        behavior.\n-        \"\"\"\n-        with self.assertRaises(Exception):\n-            with transaction.autocommit():\n-                self.create_reporter_and_fail()\n-\n-        self.assertEqual(Reporter.objects.count(), 1)\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_autocommit_context_manager_with_using(self):\n-        \"\"\"\n-        The autocommit context manager also works with a using argument.\n-        \"\"\"\n-        with self.assertRaises(Exception):\n-            with transaction.autocommit(using=\"default\"):\n-                self.create_reporter_and_fail()\n-\n-        self.assertEqual(Reporter.objects.count(), 1)\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_commit_on_success(self):\n-        \"\"\"\n-        With the commit_on_success context manager, the transaction is only\n-        committed if the block doesn't throw an exception.\n-        \"\"\"\n-        with self.assertRaises(Exception):\n-            with transaction.commit_on_success():\n-                self.create_reporter_and_fail()\n-\n-        self.assertEqual(Reporter.objects.count(), 0)\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_commit_on_success_with_using(self):\n-        \"\"\"\n-        The commit_on_success context manager also works with a using argument.\n-        \"\"\"\n-        with self.assertRaises(Exception):\n-            with transaction.commit_on_success(using=\"default\"):\n-                self.create_reporter_and_fail()\n-\n-        self.assertEqual(Reporter.objects.count(), 0)\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_commit_on_success_succeed(self):\n-        \"\"\"\n-        If there aren't any exceptions, the data will get saved.\n-        \"\"\"\n-        Reporter.objects.create(first_name=\"Alice\", last_name=\"Smith\")\n-        with transaction.commit_on_success():\n-            Reporter.objects.filter(first_name=\"Alice\").delete()\n-\n-        self.assertQuerysetEqual(Reporter.objects.all(), [])\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_commit_on_success_exit(self):\n-        with transaction.autocommit():\n-            with transaction.commit_on_success():\n-                Reporter.objects.create(first_name=\"Bobby\", last_name=\"Tables\")\n-\n-            # Much more formal\n-            r = Reporter.objects.get()\n-            r.first_name = \"Robert\"\n-            r.save()\n-\n-        r = Reporter.objects.get()\n-        self.assertEqual(r.first_name, \"Robert\")\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_manually_managed(self):\n-        \"\"\"\n-        You can manually manage transactions if you really want to, but you\n-        have to remember to commit/rollback.\n-        \"\"\"\n-        with transaction.commit_manually():\n-            Reporter.objects.create(first_name=\"Libby\", last_name=\"Holtzman\")\n-            transaction.commit()\n-        self.assertEqual(Reporter.objects.count(), 1)\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_manually_managed_mistake(self):\n-        \"\"\"\n-        If you forget, you'll get bad errors.\n-        \"\"\"\n-        with self.assertRaises(transaction.TransactionManagementError):\n-            with transaction.commit_manually():\n-                Reporter.objects.create(first_name=\"Scott\", last_name=\"Browning\")\n-\n-    @skipUnlessDBFeature('supports_transactions')\n-    def test_manually_managed_with_using(self):\n-        \"\"\"\n-        The commit_manually function also works with a using argument.\n-        \"\"\"\n-        with self.assertRaises(transaction.TransactionManagementError):\n-            with transaction.commit_manually(using=\"default\"):\n-                Reporter.objects.create(first_name=\"Walter\", last_name=\"Cronkite\")\n-\n-    @skipUnlessDBFeature('requires_rollback_on_dirty_transaction')\n-    def test_bad_sql(self):\n-        \"\"\"\n-        Regression for #11900: If a block wrapped by commit_on_success\n-        writes a transaction that can't be committed, that transaction should\n-        be rolled back. The bug is only visible using the psycopg2 backend,\n-        though the fix is generally a good idea.\n-        \"\"\"\n-        with self.assertRaises(IntegrityError):\n-            with transaction.commit_on_success():\n-                cursor = connection.cursor()\n-                cursor.execute(\"INSERT INTO transactions_reporter (first_name, last_name) VALUES ('Douglas', 'Adams');\")\n-                transaction.set_dirty()\n-        transaction.rollback()"
        },
        {
            "sha": "8d23cf55010e591d9c53993304d6d7926ef025bd",
            "filename": "tests/regressiontests/test_utils/tests.py",
            "status": "modified",
            "additions": 37,
            "deletions": 3,
            "changes": 40,
            "blob_url": "https://github.com/django/django/blob/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/tests%2Fregressiontests%2Ftest_utils%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/e54c0a0c9488ab93c30f1f89c98e5a020a9ec326/tests%2Fregressiontests%2Ftest_utils%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftest_utils%2Ftests.py?ref=e54c0a0c9488ab93c30f1f89c98e5a020a9ec326",
            "patch": "@@ -1,12 +1,11 @@\n+from __future__ import with_statement\n+\n import sys\n \n from django.test import TestCase, skipUnlessDBFeature, skipIfDBFeature\n \n from models import Person\n \n-if sys.version_info >= (2, 5):\n-    from tests_25 import AssertNumQueriesContextManagerTests\n-\n \n class SkippingTestCase(TestCase):\n     def test_skip_unless_db_feature(self):\n@@ -48,6 +47,41 @@ def test_func():\n             self.client.get(\"/test_utils/get_person/%s/\" % person.pk)\n         self.assertNumQueries(2, test_func)\n \n+class AssertNumQueriesContextManagerTests(TestCase):\n+    def test_simple(self):\n+        with self.assertNumQueries(0):\n+            pass\n+\n+        with self.assertNumQueries(1):\n+            Person.objects.count()\n+\n+        with self.assertNumQueries(2):\n+            Person.objects.count()\n+            Person.objects.count()\n+\n+    def test_failure(self):\n+        with self.assertRaises(AssertionError) as exc_info:\n+            with self.assertNumQueries(2):\n+                Person.objects.count()\n+        self.assertIn(\"1 queries executed, 2 expected\", str(exc_info.exception))\n+\n+        with self.assertRaises(TypeError):\n+            with self.assertNumQueries(4000):\n+                raise TypeError\n+\n+    def test_with_client(self):\n+        person = Person.objects.create(name=\"test\")\n+\n+        with self.assertNumQueries(1):\n+            self.client.get(\"/test_utils/get_person/%s/\" % person.pk)\n+\n+        with self.assertNumQueries(1):\n+            self.client.get(\"/test_utils/get_person/%s/\" % person.pk)\n+\n+        with self.assertNumQueries(2):\n+            self.client.get(\"/test_utils/get_person/%s/\" % person.pk)\n+            self.client.get(\"/test_utils/get_person/%s/\" % person.pk)\n+\n \n class SaveRestoreWarningState(TestCase):\n     def test_save_restore_warnings_state(self):"
        },
        {
            "sha": "9fe9c838e5e355821b09f307f5c4faff8cd38cfe",
            "filename": "tests/regressiontests/test_utils/tests_25.py",
            "status": "removed",
            "additions": 0,
            "deletions": 41,
            "changes": 41,
            "blob_url": "https://github.com/django/django/blob/b4f0c1a7759c8b96085411bea02cc9a539d6eaf5/tests%2Fregressiontests%2Ftest_utils%2Ftests_25.py",
            "raw_url": "https://github.com/django/django/raw/b4f0c1a7759c8b96085411bea02cc9a539d6eaf5/tests%2Fregressiontests%2Ftest_utils%2Ftests_25.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftest_utils%2Ftests_25.py?ref=b4f0c1a7759c8b96085411bea02cc9a539d6eaf5",
            "patch": "@@ -1,41 +0,0 @@\n-from __future__ import with_statement\n-\n-from django.test import TestCase\n-\n-from models import Person\n-\n-\n-class AssertNumQueriesContextManagerTests(TestCase):\n-    def test_simple(self):\n-        with self.assertNumQueries(0):\n-            pass\n-\n-        with self.assertNumQueries(1):\n-            Person.objects.count()\n-\n-        with self.assertNumQueries(2):\n-            Person.objects.count()\n-            Person.objects.count()\n-\n-    def test_failure(self):\n-        with self.assertRaises(AssertionError) as exc_info:\n-            with self.assertNumQueries(2):\n-                Person.objects.count()\n-        self.assertIn(\"1 queries executed, 2 expected\", str(exc_info.exception))\n-\n-        with self.assertRaises(TypeError):\n-            with self.assertNumQueries(4000):\n-                raise TypeError\n-\n-    def test_with_client(self):\n-        person = Person.objects.create(name=\"test\")\n-\n-        with self.assertNumQueries(1):\n-            self.client.get(\"/test_utils/get_person/%s/\" % person.pk)\n-\n-        with self.assertNumQueries(1):\n-            self.client.get(\"/test_utils/get_person/%s/\" % person.pk)\n-\n-        with self.assertNumQueries(2):\n-            self.client.get(\"/test_utils/get_person/%s/\" % person.pk)\n-            self.client.get(\"/test_utils/get_person/%s/\" % person.pk)"
        }
    ],
    "stats": {
        "total": 402,
        "additions": 187,
        "deletions": 215
    }
}