{
    "author": "aaugustin",
    "message": "Fixed #17414 -- Prevented numberformat from trying to group digits when the number of digits per group is zero.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17267 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ddb2a9eb9e3f3f14212eb85325fb2f30aba1fb1f",
    "files": [
        {
            "sha": "f921b127780a7f784d68560336e29b2298f3e856",
            "filename": "django/contrib/humanize/tests.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/ddb2a9eb9e3f3f14212eb85325fb2f30aba1fb1f/django%2Fcontrib%2Fhumanize%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/ddb2a9eb9e3f3f14212eb85325fb2f30aba1fb1f/django%2Fcontrib%2Fhumanize%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fhumanize%2Ftests.py?ref=ddb2a9eb9e3f3f14212eb85325fb2f30aba1fb1f",
            "patch": "@@ -53,6 +53,12 @@ def test_l10n_intcomma(self):\n         with self.settings(USE_L10N=True, USE_THOUSAND_SEPARATOR=False):\n             self.humanize_tester(test_list, result_list, 'intcomma')\n \n+    def test_intcomma_without_number_grouping(self):\n+        # Regression for #17414\n+        with translation.override('ja'):\n+            with self.settings(USE_L10N=True):\n+                self.humanize_tester([100], ['100'], 'intcomma')\n+\n     def test_intword(self):\n         test_list = ('100', '1000000', '1200000', '1290000',\n                      '1000000000', '2000000000', '6000000000000',"
        },
        {
            "sha": "924d06511b9bcf59d6b565fdcb259e6ae05bde5c",
            "filename": "django/utils/numberformat.py",
            "status": "modified",
            "additions": 9,
            "deletions": 7,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/ddb2a9eb9e3f3f14212eb85325fb2f30aba1fb1f/django%2Futils%2Fnumberformat.py",
            "raw_url": "https://github.com/django/django/raw/ddb2a9eb9e3f3f14212eb85325fb2f30aba1fb1f/django%2Futils%2Fnumberformat.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fnumberformat.py?ref=ddb2a9eb9e3f3f14212eb85325fb2f30aba1fb1f",
            "patch": "@@ -2,20 +2,21 @@\n from django.utils.safestring import mark_safe\n \n \n-def format(number, decimal_sep, decimal_pos=None, grouping=0, thousand_sep='', force_grouping=False):\n+def format(number, decimal_sep, decimal_pos=None, grouping=0, thousand_sep='',\n+           force_grouping=False):\n     \"\"\"\n     Gets a number (as a number or string), and returns it as a string,\n-    using formats definied as arguments:\n+    using formats defined as arguments:\n \n     * decimal_sep: Decimal separator symbol (for example \".\")\n     * decimal_pos: Number of decimal positions\n     * grouping: Number of digits in every group limited by thousand separator\n     * thousand_sep: Thousand separator symbol (for example \",\")\n-\n     \"\"\"\n-    use_grouping = force_grouping or settings.USE_L10N and \\\n-        settings.USE_THOUSAND_SEPARATOR and grouping\n-    # Make the common case fast:\n+    use_grouping = settings.USE_L10N and settings.USE_THOUSAND_SEPARATOR\n+    use_grouping = use_grouping or force_grouping\n+    use_grouping = use_grouping and grouping > 0\n+    # Make the common case fast\n     if isinstance(number, int) and not use_grouping and not decimal_pos:\n         return mark_safe(unicode(number))\n     # sign\n@@ -35,7 +36,8 @@ def format(number, decimal_sep, decimal_pos=None, grouping=0, thousand_sep='', f\n         int_part, dec_part = str_number, ''\n     if decimal_pos is not None:\n         dec_part = dec_part + ('0' * (decimal_pos - len(dec_part)))\n-    if dec_part: dec_part = decimal_sep + dec_part\n+    if dec_part:\n+        dec_part = decimal_sep + dec_part\n     # grouping\n     if use_grouping:\n         int_part_gd = ''"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 15,
        "deletions": 7
    }
}