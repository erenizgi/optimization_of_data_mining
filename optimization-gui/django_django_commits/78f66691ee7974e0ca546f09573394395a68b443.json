{
    "author": "claudep",
    "message": "Fixed #8627 -- Prevented textareas to swallow first newline content\n\nBrowsers consider the first newline in textareas as some display\nartifact, not real content. Hence they are not sending it back to\nthe server. If we want to keep initial newlines, we have to add one\nwhen we render the textarea.\nThanks bastih for the report and initial patch.",
    "sha": "78f66691ee7974e0ca546f09573394395a68b443",
    "files": [
        {
            "sha": "c761ea857da9f8b4fa9931f35a1a769fbfedc4f7",
            "filename": "django/forms/widgets.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/78f66691ee7974e0ca546f09573394395a68b443/django%2Fforms%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/78f66691ee7974e0ca546f09573394395a68b443/django%2Fforms%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fforms%2Fwidgets.py?ref=78f66691ee7974e0ca546f09573394395a68b443",
            "patch": "@@ -403,7 +403,7 @@ def __init__(self, attrs=None):\n     def render(self, name, value, attrs=None):\n         if value is None: value = ''\n         final_attrs = self.build_attrs(attrs, name=name)\n-        return format_html('<textarea{0}>{1}</textarea>',\n+        return format_html('<textarea{0}>\\r\\n{1}</textarea>',\n                            flatatt(final_attrs),\n                            force_text(value))\n "
        },
        {
            "sha": "bec31d12d7a7837fdffbd56f6778b725f154ee10",
            "filename": "tests/regressiontests/forms/models.py",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Fmodels.py?ref=78f66691ee7974e0ca546f09573394395a68b443",
            "patch": "@@ -83,4 +83,8 @@ def __str__(self):\n \n \n class Cheese(models.Model):\n-   name = models.CharField(max_length=100)\n+    name = models.CharField(max_length=100)\n+\n+\n+class Article(models.Model):\n+    content = models.TextField()"
        },
        {
            "sha": "cde85051f648ff7c82b7b0b2e6720eb52ee325e7",
            "filename": "tests/regressiontests/forms/templates/forms/article_form.html",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Ftemplates%2Fforms%2Farticle_form.html",
            "raw_url": "https://github.com/django/django/raw/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Ftemplates%2Fforms%2Farticle_form.html",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftemplates%2Fforms%2Farticle_form.html?ref=78f66691ee7974e0ca546f09573394395a68b443",
            "patch": "@@ -0,0 +1,8 @@\n+<html>\n+<body>\n+  <form method=\"post\" action=\".\">\n+    {{ form.as_p }}<br>\n+    <input id=\"submit\" type=\"submit\">\n+  </form>\n+</body>\n+</html>"
        },
        {
            "sha": "6708e54c793e51ff91c65f9ac030f0fe10e5ff2c",
            "filename": "tests/regressiontests/forms/tests/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py?ref=78f66691ee7974e0ca546f09573394395a68b443",
            "patch": "@@ -18,4 +18,4 @@\n from .util import FormsUtilTestCase\n from .validators import TestFieldWithValidators\n from .widgets import (FormsWidgetTestCase, FormsI18NWidgetsTestCase,\n-    WidgetTests, ClearableFileInputTests)\n+    WidgetTests, LiveWidgetTests, ClearableFileInputTests)"
        },
        {
            "sha": "31c0e65c7c1afad26fc67659392dfdff00c928b0",
            "filename": "tests/regressiontests/forms/tests/widgets.py",
            "status": "modified",
            "additions": 20,
            "deletions": 0,
            "changes": 20,
            "blob_url": "https://github.com/django/django/blob/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py",
            "raw_url": "https://github.com/django/django/raw/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2Fwidgets.py?ref=78f66691ee7974e0ca546f09573394395a68b443",
            "patch": "@@ -4,7 +4,9 @@\n import copy\n import datetime\n \n+from django.contrib.admin.tests import AdminSeleniumWebDriverTestCase\n from django.core.files.uploadedfile import SimpleUploadedFile\n+from django.core.urlresolvers import reverse\n from django.forms import *\n from django.forms.widgets import RadioFieldRenderer\n from django.utils import formats\n@@ -15,6 +17,8 @@\n from django.test.utils import override_settings\n from django.utils.encoding import python_2_unicode_compatible\n \n+from ..models import Article\n+\n \n class FormsWidgetTestCase(TestCase):\n     # Each Widget class corresponds to an HTML form widget. A Widget knows how to\n@@ -1095,6 +1099,22 @@ class SplitDateRequiredForm(Form):\n         self.assertFalse(form.is_valid())\n \n \n+class LiveWidgetTests(AdminSeleniumWebDriverTestCase):\n+    urls = 'regressiontests.forms.urls'\n+\n+    def test_textarea_trailing_newlines(self):\n+        \"\"\"\n+        Test that a roundtrip on a ModelForm doesn't alter the TextField value\n+        \"\"\"\n+        article = Article.objects.create(content=\"\\nTst\\n\")\n+        self.selenium.get('%s%s' % (self.live_server_url,\n+            reverse('article_form', args=[article.pk])))\n+        self.selenium.find_element_by_id('submit').submit()\n+        article = Article.objects.get(pk=article.pk)\n+        # Should be \"\\nTst\\n\" after #19251 is fixed\n+        self.assertEqual(article.content, \"\\r\\nTst\\r\\n\")\n+\n+\n @python_2_unicode_compatible\n class FakeFieldFile(object):\n     \"\"\""
        },
        {
            "sha": "b482b6c45c0836a22658dd7d17fccdb783f39a74",
            "filename": "tests/regressiontests/forms/urls.py",
            "status": "added",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Furls.py?ref=78f66691ee7974e0ca546f09573394395a68b443",
            "patch": "@@ -0,0 +1,9 @@\n+from django.conf.urls import patterns, url\n+from django.views.generic.edit import UpdateView\n+\n+from .views import ArticleFormView\n+\n+\n+urlpatterns = patterns('',\n+    url(r'^/model_form/(?P<pk>\\d+)/$', ArticleFormView.as_view(), name=\"article_form\"),\n+)"
        },
        {
            "sha": "4bf384363c305cc7613c52f08cc0a7677b10005b",
            "filename": "tests/regressiontests/forms/views.py",
            "status": "added",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/78f66691ee7974e0ca546f09573394395a68b443/tests%2Fregressiontests%2Fforms%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Fviews.py?ref=78f66691ee7974e0ca546f09573394395a68b443",
            "patch": "@@ -0,0 +1,8 @@\n+from django.views.generic.edit import UpdateView\n+\n+from .models import Article\n+\n+\n+class ArticleFormView(UpdateView):\n+    model = Article\n+    success_url = '/'"
        }
    ],
    "stats": {
        "total": 55,
        "additions": 52,
        "deletions": 3
    }
}