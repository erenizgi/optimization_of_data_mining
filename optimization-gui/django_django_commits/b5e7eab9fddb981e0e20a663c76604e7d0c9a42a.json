{
    "author": "jezdez",
    "message": "Fixed #16236 -- Added get_form_kwargs method to WizardView as a way to easily provide kwargs to each step form.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16398 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "b5e7eab9fddb981e0e20a663c76604e7d0c9a42a",
    "files": [
        {
            "sha": "6b3cc3da438e641fd047294003834fa659fcafc8",
            "filename": "django/contrib/formtools/wizard/tests/formtests.py",
            "status": "modified",
            "additions": 23,
            "deletions": 0,
            "changes": 23,
            "blob_url": "https://github.com/django/django/blob/b5e7eab9fddb981e0e20a663c76604e7d0c9a42a/django%2Fcontrib%2Fformtools%2Fwizard%2Ftests%2Fformtests.py",
            "raw_url": "https://github.com/django/django/raw/b5e7eab9fddb981e0e20a663c76604e7d0c9a42a/django%2Fcontrib%2Fformtools%2Fwizard%2Ftests%2Fformtests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Fwizard%2Ftests%2Fformtests.py?ref=b5e7eab9fddb981e0e20a663c76604e7d0c9a42a",
            "patch": "@@ -35,6 +35,12 @@ class Step2(forms.Form):\n class Step3(forms.Form):\n     data = forms.CharField()\n \n+class CustomKwargsStep1(Step1):\n+\n+    def __init__(self, test=None, *args, **kwargs):\n+        self.test = test\n+        return super(CustomKwargsStep1, self).__init__(*args, **kwargs)\n+\n class UserForm(forms.ModelForm):\n     class Meta:\n         model = User\n@@ -48,6 +54,12 @@ def dispatch(self, request, *args, **kwargs):\n         response = super(TestWizard, self).dispatch(request, *args, **kwargs)\n         return response, self\n \n+    def get_form_kwargs(self, step, *args, **kwargs):\n+        kwargs = super(TestWizard, self).get_form_kwargs(step, *args, **kwargs)\n+        if step == 'kwargs_test':\n+            kwargs['test'] = True\n+        return kwargs\n+\n class FormTests(TestCase):\n     def test_form_init(self):\n         testform = TestWizard.get_initkwargs([Step1, Step2])\n@@ -102,6 +114,17 @@ def test_form_condition(self):\n         response, instance = testform(request)\n         self.assertEquals(instance.get_next_step(), 'step3')\n \n+    def test_form_kwargs(self):\n+        request = get_request()\n+\n+        testform = TestWizard.as_view([('start', Step1),\n+            ('kwargs_test', CustomKwargsStep1)])\n+        response, instance = testform(request)\n+\n+        self.assertEqual(instance.get_form_kwargs('start'), {})\n+        self.assertEqual(instance.get_form_kwargs('kwargs_test'), {'test': True})\n+        self.assertEqual(instance.get_form('kwargs_test').test, True)\n+\n     def test_form_prefix(self):\n         request = get_request()\n "
        },
        {
            "sha": "2dab77d0febdb9034b76ea01973bae17be1fb9d3",
            "filename": "django/contrib/formtools/wizard/views.py",
            "status": "modified",
            "additions": 10,
            "deletions": 2,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/b5e7eab9fddb981e0e20a663c76604e7d0c9a42a/django%2Fcontrib%2Fformtools%2Fwizard%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/b5e7eab9fddb981e0e20a663c76604e7d0c9a42a/django%2Fcontrib%2Fformtools%2Fwizard%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fformtools%2Fwizard%2Fviews.py?ref=b5e7eab9fddb981e0e20a663c76604e7d0c9a42a",
            "patch": "@@ -354,6 +354,13 @@ def get_form_instance(self, step):\n         \"\"\"\n         return self.instance_dict.get(step, None)\n \n+    def get_form_kwargs(self, step=None):\n+        \"\"\"\n+        Returns the keyword arguments for instantiating the form\n+        (or formset) on given step.\n+        \"\"\"\n+        return {}\n+\n     def get_form(self, step=None, data=None, files=None):\n         \"\"\"\n         Constructs the form for a given `step`. If no `step` is defined, the\n@@ -366,12 +373,13 @@ def get_form(self, step=None, data=None, files=None):\n         if step is None:\n             step = self.steps.current\n         # prepare the kwargs for the form instance.\n-        kwargs = {\n+        kwargs = self.get_form_kwargs(step)\n+        kwargs.update({\n             'data': data,\n             'files': files,\n             'prefix': self.get_form_prefix(step, self.form_list[step]),\n             'initial': self.get_form_initial(step),\n-        }\n+        })\n         if issubclass(self.form_list[step], forms.ModelForm):\n             # If the form is based on ModelForm, add instance if available.\n             kwargs.update({'instance': self.get_form_instance(step)})"
        },
        {
            "sha": "b0e685e5a9ae52b8c43469cad3f24699975f0ca0",
            "filename": "docs/ref/contrib/formtools/form-wizard.txt",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/b5e7eab9fddb981e0e20a663c76604e7d0c9a42a/docs%2Fref%2Fcontrib%2Fformtools%2Fform-wizard.txt",
            "raw_url": "https://github.com/django/django/raw/b5e7eab9fddb981e0e20a663c76604e7d0c9a42a/docs%2Fref%2Fcontrib%2Fformtools%2Fform-wizard.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fformtools%2Fform-wizard.txt?ref=b5e7eab9fddb981e0e20a663c76604e7d0c9a42a",
            "patch": "@@ -271,6 +271,16 @@ Advanced ``WizardView`` methods\n         def get_form_initial(self, step):\n             return self.initial_dict.get(step, {})\n \n+.. method:: WizardView.get_form_kwargs(step)\n+\n+    Returns a dictionary which will be used as the keyword arguments when\n+    instantiating the form instance on given ``step``.\n+\n+    The default implementation::\n+\n+        def get_form_kwargs(self, step):\n+            return {}\n+\n .. method:: WizardView.get_form_instance(step)\n \n     Returns a object which will be passed to the form for ``step`` as"
        }
    ],
    "stats": {
        "total": 45,
        "additions": 43,
        "deletions": 2
    }
}