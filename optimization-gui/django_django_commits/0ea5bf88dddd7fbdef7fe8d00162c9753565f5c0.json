{
    "author": "ptone",
    "message": "Fixed #19543 -- implemented SimpleLazyObject.__repr__\n\nThanks to Florian Hahn for the patch",
    "sha": "0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0",
    "files": [
        {
            "sha": "3e5867450145fa09f4aa8872c6b44a8580f44513",
            "filename": "django/utils/functional.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0/django%2Futils%2Ffunctional.py",
            "raw_url": "https://github.com/django/django/raw/0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0/django%2Futils%2Ffunctional.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ffunctional.py?ref=0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0",
            "patch": "@@ -305,6 +305,15 @@ def __newobj__(cls, *args):\n     def __reduce__(self):\n         return (self.__newobj__, (self.__class__,), self.__getstate__())\n \n+    # Return a meaningful representation of the lazy object for debugging\n+    # without evaluating the wrapped object.\n+    def __repr__(self):\n+        if self._wrapped is empty:\n+            repr_attr = self._setupfunc\n+        else:\n+            repr_attr = self._wrapped\n+        return '<SimpleLazyObject: %r>' % repr_attr\n+\n     # Need to pretend to be the wrapped class, for the sake of objects that care\n     # about this (especially in equality tests)\n     __class__ = property(new_method_proxy(operator.attrgetter(\"__class__\")))"
        },
        {
            "sha": "599da6847c4dcbd91544d1063574e4468bdbce77",
            "filename": "docs/releases/1.6.txt",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0/docs%2Freleases%2F1.6.txt",
            "raw_url": "https://github.com/django/django/raw/0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0/docs%2Freleases%2F1.6.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.6.txt?ref=0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0",
            "patch": "@@ -131,6 +131,9 @@ Minor features\n   :setting:`TEMPLATE_STRING_IF_INVALID` for variables not present in the\n   context, just like other template constructs.\n \n+* SimpleLazyObjects will now present more helpful representations in shell\n+  debugging situations.\n+\n Backwards incompatible changes in 1.6\n =====================================\n "
        },
        {
            "sha": "dd52857c0379897cd2e7cab4e964ba8b541354b4",
            "filename": "tests/utils_tests/simplelazyobject.py",
            "status": "modified",
            "additions": 12,
            "deletions": 4,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0/tests%2Futils_tests%2Fsimplelazyobject.py",
            "raw_url": "https://github.com/django/django/raw/0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0/tests%2Futils_tests%2Fsimplelazyobject.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Futils_tests%2Fsimplelazyobject.py?ref=0ea5bf88dddd7fbdef7fe8d00162c9753565f5c0",
            "patch": "@@ -59,10 +59,18 @@ def test_hash(self):\n                          hash(SimpleLazyObject(complex_object)))\n \n     def test_repr(self):\n-        # For debugging, it will really confuse things if there is no clue that\n-        # SimpleLazyObject is actually a proxy object. So we don't\n-        # proxy __repr__\n-        self.assertTrue(\"SimpleLazyObject\" in repr(SimpleLazyObject(complex_object)))\n+        # First, for an unevaluated SimpleLazyObject\n+        x = SimpleLazyObject(complex_object)\n+        # __repr__ contains __repr__ of setup function and does not evaluate\n+        # the SimpleLazyObject\n+        self.assertEqual(\"<SimpleLazyObject: %r>\" % complex_object, repr(x))\n+        self.assertEqual(empty, x._wrapped)\n+\n+        # Second, for an evaluated SimpleLazyObject\n+        name = x.name # evaluate\n+        self.assertTrue(isinstance(x._wrapped, _ComplexObject))\n+        # __repr__ contains __repr__ of wrapped object\n+        self.assertEqual(\"<SimpleLazyObject: %r>\" % x._wrapped, repr(x))\n \n     def test_bytes(self):\n         self.assertEqual(b\"I am _ComplexObject('joe')\","
        }
    ],
    "stats": {
        "total": 28,
        "additions": 24,
        "deletions": 4
    }
}