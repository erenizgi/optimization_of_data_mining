{
    "author": "claudep",
    "message": "Fixed #19063 -- Fixed version parameter of gml GeoQuerySet method\n\nThanks lmisek@go2.pl for the report.",
    "sha": "d25a599dca9b7644b238f6c89a66545dfdabe393",
    "files": [
        {
            "sha": "2a8de4cde341afa29317bf28b897b7cc385f9cdd",
            "filename": "django/contrib/gis/db/models/query.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/d25a599dca9b7644b238f6c89a66545dfdabe393/django%2Fcontrib%2Fgis%2Fdb%2Fmodels%2Fquery.py",
            "raw_url": "https://github.com/django/django/raw/d25a599dca9b7644b238f6c89a66545dfdabe393/django%2Fcontrib%2Fgis%2Fdb%2Fmodels%2Fquery.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fdb%2Fmodels%2Fquery.py?ref=d25a599dca9b7644b238f6c89a66545dfdabe393",
            "patch": "@@ -194,9 +194,9 @@ def gml(self, precision=8, version=2, **kwargs):\n             # PostGIS AsGML() aggregate function parameter order depends on the\n             # version -- uggh.\n             if backend.spatial_version > (1, 3, 1):\n-                procedure_fmt = '%(version)s,%(geo_col)s,%(precision)s'\n+                s['procedure_fmt'] = '%(version)s,%(geo_col)s,%(precision)s'\n             else:\n-                procedure_fmt = '%(geo_col)s,%(precision)s,%(version)s'\n+                s['procedure_fmt'] = '%(geo_col)s,%(precision)s,%(version)s'\n             s['procedure_args'] = {'precision' : precision, 'version' : version}\n \n         return self._spatial_attribute('gml', s, **kwargs)"
        },
        {
            "sha": "7d8121425a8c724da3313a171516494810bf8cf5",
            "filename": "django/contrib/gis/tests/geoapp/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/d25a599dca9b7644b238f6c89a66545dfdabe393/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/d25a599dca9b7644b238f6c89a66545dfdabe393/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Fgeoapp%2Ftests.py?ref=d25a599dca9b7644b238f6c89a66545dfdabe393",
            "patch": "@@ -529,6 +529,9 @@ def test_gml(self):\n         for ptown in [ptown1, ptown2]:\n             self.assertTrue(gml_regex.match(ptown.gml))\n \n+        if postgis:\n+            self.assertIn('<gml:pos srsDimension=\"2\">', City.objects.gml(version=3).get(name='Pueblo').gml)\n+\n     def test_kml(self):\n         \"Testing KML output from the database using GeoQuerySet.kml().\"\n         # Only PostGIS and Spatialite (>=2.4.0-RC4) support KML serialization"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
    }
}