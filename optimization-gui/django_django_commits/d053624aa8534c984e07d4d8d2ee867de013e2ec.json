{
    "author": "freakboy3742",
    "message": "Fixed #15067 -- Modified the range checks on base36_to_int so you are guaranteed to always get an int, avoiding possible OverflowErrors. Thanks to Garthex for the report, jboutros for the patch, and kfrazier for the feedback.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15288 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "d053624aa8534c984e07d4d8d2ee867de013e2ec",
    "files": [
        {
            "sha": "b4f93cefc343235eff71be602636dbdf8b85b495",
            "filename": "django/contrib/auth/tests/views.py",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/d053624aa8534c984e07d4d8d2ee867de013e2ec/django%2Fcontrib%2Fauth%2Ftests%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/d053624aa8534c984e07d4d8d2ee867de013e2ec/django%2Fcontrib%2Fauth%2Ftests%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Fviews.py?ref=d053624aa8534c984e07d4d8d2ee867de013e2ec",
            "patch": "@@ -104,6 +104,12 @@ def test_confirm_invalid_user(self):\n         self.assertEquals(response.status_code, 200)\n         self.assert_(\"The password reset link was invalid\" in response.content)\n \n+    def test_confirm_overflow_user(self):\n+        # Ensure that we get a 200 response for a base36 user id that overflows int\n+        response = self.client.get('/reset/zzzzzzzzzzzzz-1-1/')\n+        self.assertEquals(response.status_code, 200)\n+        self.assert_(\"The password reset link was invalid\" in response.content)\n+\n     def test_confirm_invalid_post(self):\n         # Same as test_confirm_invalid, but trying\n         # to do a POST instead."
        },
        {
            "sha": "1384b4294c4d75d767adcecfccd36076037e3566",
            "filename": "django/utils/http.py",
            "status": "modified",
            "additions": 11,
            "deletions": 5,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/d053624aa8534c984e07d4d8d2ee867de013e2ec/django%2Futils%2Fhttp.py",
            "raw_url": "https://github.com/django/django/raw/d053624aa8534c984e07d4d8d2ee867de013e2ec/django%2Futils%2Fhttp.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fhttp.py?ref=d053624aa8534c984e07d4d8d2ee867de013e2ec",
            "patch": "@@ -1,4 +1,5 @@\n import re\n+import sys\n import urllib\n from email.Utils import formatdate\n \n@@ -73,14 +74,19 @@ def http_date(epoch_seconds=None):\n \n def base36_to_int(s):\n     \"\"\"\n-    Converts a base 36 string to an ``int``. To prevent\n-    overconsumption of server resources, raises ``ValueError` if the\n-    input is longer than 13 base36 digits (13 digits is sufficient to\n-    base36-encode any 64-bit integer).\n+    Converts a base 36 string to an ``int``. Raises ``ValueError` if the\n+    input won't fit into an int.\n     \"\"\"\n+    # To prevent overconsumption of server resources, reject any\n+    # base36 string that is long than 13 base36 digits (13 digits\n+    # is sufficient to base36-encode any 64-bit integer)\n     if len(s) > 13:\n         raise ValueError(\"Base36 input too large\")\n-    return int(s, 36)\n+    value = int(s, 36)\n+    # ... then do a final check that the value will fit into an int.\n+    if value > sys.maxint:\n+        raise ValueError(\"Base36 input too large\")\n+    return value\n \n def int_to_base36(i):\n     \"\"\""
        }
    ],
    "stats": {
        "total": 22,
        "additions": 17,
        "deletions": 5
    }
}