{
    "author": "jezdez",
    "message": "Fixed #17046 -- Added a check if the username passed to User.objects.create_user is empty or not. Thanks, kwadrat.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17628 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "fcaf8eae14d0a7f884328bdf0238dd1e2881c681",
    "files": [
        {
            "sha": "4e1584970cf4c8f5bc44eb9907dcb4db339b58d3",
            "filename": "django/contrib/auth/models.py",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/fcaf8eae14d0a7f884328bdf0238dd1e2881c681/django%2Fcontrib%2Fauth%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/fcaf8eae14d0a7f884328bdf0238dd1e2881c681/django%2Fcontrib%2Fauth%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fmodels.py?ref=fcaf8eae14d0a7f884328bdf0238dd1e2881c681",
            "patch": "@@ -149,6 +149,8 @@ def create_user(self, username, email=None, password=None):\n         Creates and saves a User with the given username, email and password.\n         \"\"\"\n         now = timezone.now()\n+        if not username:\n+            raise ValueError('The given username must be set')\n         email = UserManager.normalize_email(email)\n         user = self.model(username=username, email=email,\n                           is_staff=False, is_active=True, is_superuser=False,"
        },
        {
            "sha": "25121966a024a4179fb12cc94df8388a90c31ac4",
            "filename": "django/contrib/auth/tests/models.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/fcaf8eae14d0a7f884328bdf0238dd1e2881c681/django%2Fcontrib%2Fauth%2Ftests%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/fcaf8eae14d0a7f884328bdf0238dd1e2881c681/django%2Fcontrib%2Fauth%2Ftests%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Ftests%2Fmodels.py?ref=fcaf8eae14d0a7f884328bdf0238dd1e2881c681",
            "patch": "@@ -91,3 +91,8 @@ def test_create_user_email_domain_normalize(self):\n     def test_create_user_email_domain_normalize_with_whitespace(self):\n         returned = UserManager.normalize_email('email\\ with_whitespace@D.COM')\n         self.assertEquals(returned, 'email\\ with_whitespace@d.com')\n+\n+    def test_empty_username(self):\n+        self.assertRaisesMessage(ValueError,\n+                                 'The given username must be set',\n+                                  User.objects.create_user, username='')"
        },
        {
            "sha": "6b262be47faa32eb5b2f202a0ebae39bce7ddb00",
            "filename": "docs/topics/auth.txt",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/fcaf8eae14d0a7f884328bdf0238dd1e2881c681/docs%2Ftopics%2Fauth.txt",
            "raw_url": "https://github.com/django/django/raw/fcaf8eae14d0a7f884328bdf0238dd1e2881c681/docs%2Ftopics%2Fauth.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fauth.txt?ref=fcaf8eae14d0a7f884328bdf0238dd1e2881c681",
            "patch": "@@ -280,7 +280,9 @@ Manager functions\n     .. method:: models.UserManager.create_user(username, email=None, password=None)\n \n         .. versionchanged:: 1.4\n-           The ``email`` parameter was made optional.\n+           The ``email`` parameter was made optional. The username\n+           parameter is now checked for emptiness and raises a\n+           :exc:`ValueError` in case of a negative result.\n \n         Creates, saves and returns a :class:`~django.contrib.auth.models.User`.\n "
        }
    ],
    "stats": {
        "total": 11,
        "additions": 10,
        "deletions": 1
    }
}