{
    "author": "jacobian",
    "message": "Merge pull request #900 from bmispelon/ticket-20022\n\nFix #20022: Correctly handle prefixes with url-unsafe characters in reverse()",
    "sha": "1059da8de675442e84381d6366c0be254681753e",
    "files": [
        {
            "sha": "ffe74bc6505447bd0f74112c7d6815f394317745",
            "filename": "django/core/urlresolvers.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/1059da8de675442e84381d6366c0be254681753e/django%2Fcore%2Furlresolvers.py",
            "raw_url": "https://github.com/django/django/raw/1059da8de675442e84381d6366c0be254681753e/django%2Fcore%2Furlresolvers.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Furlresolvers.py?ref=1059da8de675442e84381d6366c0be254681753e",
            "patch": "@@ -388,7 +388,7 @@ def _reverse_with_prefix(self, lookup_view, _prefix, *args, **kwargs):\n                     if len(args) != len(params) + len(prefix_args):\n                         continue\n                     unicode_args = [force_text(val) for val in args]\n-                    candidate = (prefix_norm + result) % dict(zip(prefix_args + params, unicode_args))\n+                    candidate = (prefix_norm.replace('%', '%%') + result) % dict(zip(prefix_args + params, unicode_args))\n                 else:\n                     if set(kwargs.keys()) | set(defaults.keys()) != set(params) | set(defaults.keys()) | set(prefix_args):\n                         continue"
        },
        {
            "sha": "f60c4962fdcb65cabb113a46f5fd2291d7bd0b24",
            "filename": "tests/lookup/models.py",
            "status": "modified",
            "additions": 5,
            "deletions": 16,
            "changes": 21,
            "blob_url": "https://github.com/django/django/blob/1059da8de675442e84381d6366c0be254681753e/tests%2Flookup%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/1059da8de675442e84381d6366c0be254681753e/tests%2Flookup%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Flookup%2Fmodels.py?ref=1059da8de675442e84381d6366c0be254681753e",
            "patch": "@@ -10,29 +10,16 @@\n from django.utils import six\n from django.utils.encoding import python_2_unicode_compatible\n \n+from shared_models.models import Author, Book\n \n-class Author(models.Model):\n-    name = models.CharField(max_length=100)\n-    class Meta:\n-        ordering = ('name', )\n-\n-@python_2_unicode_compatible\n-class Article(models.Model):\n-    headline = models.CharField(max_length=100)\n-    pub_date = models.DateTimeField()\n-    author = models.ForeignKey(Author, blank=True, null=True)\n-    class Meta:\n-        ordering = ('-pub_date', 'headline')\n-\n-    def __str__(self):\n-        return self.headline\n \n class Tag(models.Model):\n-    articles = models.ManyToManyField(Article)\n+    articles = models.ManyToManyField(Book)\n     name = models.CharField(max_length=100)\n     class Meta:\n         ordering = ('name', )\n \n+\n @python_2_unicode_compatible\n class Season(models.Model):\n     year = models.PositiveSmallIntegerField()\n@@ -41,6 +28,7 @@ class Season(models.Model):\n     def __str__(self):\n         return six.text_type(self.year)\n \n+\n @python_2_unicode_compatible\n class Game(models.Model):\n     season = models.ForeignKey(Season, related_name='games')\n@@ -50,6 +38,7 @@ class Game(models.Model):\n     def __str__(self):\n         return \"%s at %s\" % (self.away, self.home)\n \n+\n @python_2_unicode_compatible\n class Player(models.Model):\n     name = models.CharField(max_length=100)"
        },
        {
            "sha": "d0ffc25852c60bafde164bdc9e8802847f388165",
            "filename": "tests/lookup/tests.py",
            "status": "modified",
            "additions": 394,
            "deletions": 391,
            "changes": 785,
            "blob_url": "https://github.com/django/django/blob/1059da8de675442e84381d6366c0be254681753e/tests%2Flookup%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/1059da8de675442e84381d6366c0be254681753e/tests%2Flookup%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Flookup%2Ftests.py?ref=1059da8de675442e84381d6366c0be254681753e",
            "patch": "@@ -6,7 +6,9 @@\n from django.core.exceptions import FieldError\n from django.test import TestCase, skipUnlessDBFeature\n \n-from .models import Author, Article, Tag, Game, Season, Player\n+from shared_models.models import Author, Book\n+\n+from .models import Tag, Game, Season, Player\n \n \n class LookupTests(TestCase):\n@@ -17,165 +19,165 @@ def setUp(self):\n         self.au1.save()\n         self.au2 = Author(name='Author 2')\n         self.au2.save()\n-        # Create a couple of Articles.\n-        self.a1 = Article(headline='Article 1', pub_date=datetime(2005, 7, 26), author=self.au1)\n-        self.a1.save()\n-        self.a2 = Article(headline='Article 2', pub_date=datetime(2005, 7, 27), author=self.au1)\n-        self.a2.save()\n-        self.a3 = Article(headline='Article 3', pub_date=datetime(2005, 7, 27), author=self.au1)\n-        self.a3.save()\n-        self.a4 = Article(headline='Article 4', pub_date=datetime(2005, 7, 28), author=self.au1)\n-        self.a4.save()\n-        self.a5 = Article(headline='Article 5', pub_date=datetime(2005, 8, 1, 9, 0), author=self.au2)\n-        self.a5.save()\n-        self.a6 = Article(headline='Article 6', pub_date=datetime(2005, 8, 1, 8, 0), author=self.au2)\n-        self.a6.save()\n-        self.a7 = Article(headline='Article 7', pub_date=datetime(2005, 7, 27), author=self.au2)\n-        self.a7.save()\n+        # Create a couple of Books.\n+        self.b1 = Book(name='Book 1', pubdate=datetime(2005, 7, 26), author=self.au1)\n+        self.b1.save()\n+        self.b2 = Book(name='Book 2', pubdate=datetime(2005, 7, 27), author=self.au1)\n+        self.b2.save()\n+        self.b3 = Book(name='Book 3', pubdate=datetime(2005, 7, 27), author=self.au1)\n+        self.b3.save()\n+        self.b4 = Book(name='Book 4', pubdate=datetime(2005, 7, 28), author=self.au1)\n+        self.b4.save()\n+        self.b5 = Book(name='Book 5', pubdate=datetime(2005, 8, 1, 9, 0), author=self.au2)\n+        self.b5.save()\n+        self.b6 = Book(name='Book 6', pubdate=datetime(2005, 8, 1, 8, 0), author=self.au2)\n+        self.b6.save()\n+        self.b7 = Book(name='Book 7', pubdate=datetime(2005, 7, 27), author=self.au2)\n+        self.b7.save()\n         # Create a few Tags.\n         self.t1 = Tag(name='Tag 1')\n         self.t1.save()\n-        self.t1.articles.add(self.a1, self.a2, self.a3)\n+        self.t1.articles.add(self.b1, self.b2, self.b3)\n         self.t2 = Tag(name='Tag 2')\n         self.t2.save()\n-        self.t2.articles.add(self.a3, self.a4, self.a5)\n+        self.t2.articles.add(self.b3, self.b4, self.b5)\n         self.t3 = Tag(name='Tag 3')\n         self.t3.save()\n-        self.t3.articles.add(self.a5, self.a6, self.a7)\n+        self.t3.articles.add(self.b5, self.b6, self.b7)\n \n     def test_exists(self):\n         # We can use .exists() to check that there are some\n-        self.assertTrue(Article.objects.exists())\n-        for a in Article.objects.all():\n+        self.assertTrue(Book.objects.exists())\n+        for a in Book.objects.all():\n             a.delete()\n         # There should be none now!\n-        self.assertFalse(Article.objects.exists())\n+        self.assertFalse(Book.objects.exists())\n \n     def test_lookup_int_as_str(self):\n         # Integer value can be queried using string\n-        self.assertQuerysetEqual(Article.objects.filter(id__iexact=str(self.a1.id)),\n-                                 ['<Article: Article 1>'])\n+        self.assertQuerysetEqual(Book.objects.filter(id__iexact=str(self.b1.id)),\n+                                 ['<Book: Book 1>'])\n \n     @skipUnlessDBFeature('supports_date_lookup_using_string')\n     def test_lookup_date_as_str(self):\n         # A date lookup can be performed using a string search\n-        self.assertQuerysetEqual(Article.objects.filter(pub_date__startswith='2005'),\n+        self.assertQuerysetEqual(Book.objects.filter(pubdate__startswith='2005'),\n             [\n-                '<Article: Article 5>',\n-                '<Article: Article 6>',\n-                '<Article: Article 4>',\n-                '<Article: Article 2>',\n-                '<Article: Article 3>',\n-                '<Article: Article 7>',\n-                '<Article: Article 1>',\n+                '<Book: Book 5>',\n+                '<Book: Book 6>',\n+                '<Book: Book 4>',\n+                '<Book: Book 2>',\n+                '<Book: Book 3>',\n+                '<Book: Book 7>',\n+                '<Book: Book 1>',\n             ])\n \n     def test_iterator(self):\n         # Each QuerySet gets iterator(), which is a generator that \"lazily\"\n         # returns results using database-level iteration.\n-        self.assertQuerysetEqual(Article.objects.iterator(),\n+        self.assertQuerysetEqual(Book.objects.iterator(),\n             [\n-                'Article 5',\n-                'Article 6',\n-                'Article 4',\n-                'Article 2',\n-                'Article 3',\n-                'Article 7',\n-                'Article 1',\n+                'Book 5',\n+                'Book 6',\n+                'Book 4',\n+                'Book 2',\n+                'Book 3',\n+                'Book 7',\n+                'Book 1',\n             ],\n-            transform=attrgetter('headline'))\n+            transform=attrgetter('name'))\n         # iterator() can be used on any QuerySet.\n         self.assertQuerysetEqual(\n-            Article.objects.filter(headline__endswith='4').iterator(),\n-            ['Article 4'],\n-            transform=attrgetter('headline'))\n+            Book.objects.filter(name__endswith='4').iterator(),\n+            ['Book 4'],\n+            transform=attrgetter('name'))\n \n     def test_count(self):\n         # count() returns the number of objects matching search criteria.\n-        self.assertEqual(Article.objects.count(), 7)\n-        self.assertEqual(Article.objects.filter(pub_date__exact=datetime(2005, 7, 27)).count(), 3)\n-        self.assertEqual(Article.objects.filter(headline__startswith='Blah blah').count(), 0)\n+        self.assertEqual(Book.objects.count(), 7)\n+        self.assertEqual(Book.objects.filter(pubdate__exact=datetime(2005, 7, 27)).count(), 3)\n+        self.assertEqual(Book.objects.filter(name__startswith='Blah blah').count(), 0)\n \n         # count() should respect sliced query sets.\n-        articles = Article.objects.all()\n+        articles = Book.objects.all()\n         self.assertEqual(articles.count(), 7)\n         self.assertEqual(articles[:4].count(), 4)\n         self.assertEqual(articles[1:100].count(), 6)\n         self.assertEqual(articles[10:100].count(), 0)\n \n         # Date and date/time lookups can also be done with strings.\n-        self.assertEqual(Article.objects.filter(pub_date__exact='2005-07-27 00:00:00').count(), 3)\n+        self.assertEqual(Book.objects.filter(pubdate__exact='2005-07-27').count(), 3)\n \n     def test_in_bulk(self):\n         # in_bulk() takes a list of IDs and returns a dictionary mapping IDs to objects.\n-        arts = Article.objects.in_bulk([self.a1.id, self.a2.id])\n-        self.assertEqual(arts[self.a1.id], self.a1)\n-        self.assertEqual(arts[self.a2.id], self.a2)\n-        self.assertEqual(Article.objects.in_bulk([self.a3.id]), {self.a3.id: self.a3})\n-        self.assertEqual(Article.objects.in_bulk(set([self.a3.id])), {self.a3.id: self.a3})\n-        self.assertEqual(Article.objects.in_bulk(frozenset([self.a3.id])), {self.a3.id: self.a3})\n-        self.assertEqual(Article.objects.in_bulk((self.a3.id,)), {self.a3.id: self.a3})\n-        self.assertEqual(Article.objects.in_bulk([1000]), {})\n-        self.assertEqual(Article.objects.in_bulk([]), {})\n-        self.assertEqual(Article.objects.in_bulk(iter([self.a1.id])), {self.a1.id: self.a1})\n-        self.assertEqual(Article.objects.in_bulk(iter([])), {})\n-        self.assertRaises(TypeError, Article.objects.in_bulk)\n-        self.assertRaises(TypeError, Article.objects.in_bulk, headline__startswith='Blah')\n+        arts = Book.objects.in_bulk([self.b1.id, self.b2.id])\n+        self.assertEqual(arts[self.b1.id], self.b1)\n+        self.assertEqual(arts[self.b2.id], self.b2)\n+        self.assertEqual(Book.objects.in_bulk([self.b3.id]), {self.b3.id: self.b3})\n+        self.assertEqual(Book.objects.in_bulk(set([self.b3.id])), {self.b3.id: self.b3})\n+        self.assertEqual(Book.objects.in_bulk(frozenset([self.b3.id])), {self.b3.id: self.b3})\n+        self.assertEqual(Book.objects.in_bulk((self.b3.id,)), {self.b3.id: self.b3})\n+        self.assertEqual(Book.objects.in_bulk([1000]), {})\n+        self.assertEqual(Book.objects.in_bulk([]), {})\n+        self.assertEqual(Book.objects.in_bulk(iter([self.b1.id])), {self.b1.id: self.b1})\n+        self.assertEqual(Book.objects.in_bulk(iter([])), {})\n+        self.assertRaises(TypeError, Book.objects.in_bulk)\n+        self.assertRaises(TypeError, Book.objects.in_bulk, name__startswith='Blah')\n \n     def test_values(self):\n         # values() returns a list of dictionaries instead of object instances --\n         # and you can specify which fields you want to retrieve.\n         identity = lambda x:x\n-        self.assertQuerysetEqual(Article.objects.values('headline'),\n+        self.assertQuerysetEqual(Book.objects.values('name'),\n             [\n-                {'headline': 'Article 5'},\n-                {'headline': 'Article 6'},\n-                {'headline': 'Article 4'},\n-                {'headline': 'Article 2'},\n-                {'headline': 'Article 3'},\n-                {'headline': 'Article 7'},\n-                {'headline': 'Article 1'},\n+                {'name': 'Book 5'},\n+                {'name': 'Book 6'},\n+                {'name': 'Book 4'},\n+                {'name': 'Book 2'},\n+                {'name': 'Book 3'},\n+                {'name': 'Book 7'},\n+                {'name': 'Book 1'},\n             ],\n             transform=identity)\n         self.assertQuerysetEqual(\n-            Article.objects.filter(pub_date__exact=datetime(2005, 7, 27)).values('id'),\n-            [{'id': self.a2.id}, {'id': self.a3.id}, {'id': self.a7.id}],\n+            Book.objects.filter(pubdate__exact=datetime(2005, 7, 27)).values('id'),\n+            [{'id': self.b2.id}, {'id': self.b3.id}, {'id': self.b7.id}],\n             transform=identity)\n-        self.assertQuerysetEqual(Article.objects.values('id', 'headline'),\n+        self.assertQuerysetEqual(Book.objects.values('id', 'name'),\n             [\n-                {'id': self.a5.id, 'headline': 'Article 5'},\n-                {'id': self.a6.id, 'headline': 'Article 6'},\n-                {'id': self.a4.id, 'headline': 'Article 4'},\n-                {'id': self.a2.id, 'headline': 'Article 2'},\n-                {'id': self.a3.id, 'headline': 'Article 3'},\n-                {'id': self.a7.id, 'headline': 'Article 7'},\n-                {'id': self.a1.id, 'headline': 'Article 1'},\n+                {'id': self.b5.id, 'name': 'Book 5'},\n+                {'id': self.b6.id, 'name': 'Book 6'},\n+                {'id': self.b4.id, 'name': 'Book 4'},\n+                {'id': self.b2.id, 'name': 'Book 2'},\n+                {'id': self.b3.id, 'name': 'Book 3'},\n+                {'id': self.b7.id, 'name': 'Book 7'},\n+                {'id': self.b1.id, 'name': 'Book 1'},\n             ],\n             transform=identity)\n         # You can use values() with iterator() for memory savings,\n         # because iterator() uses database-level iteration.\n-        self.assertQuerysetEqual(Article.objects.values('id', 'headline').iterator(),\n+        self.assertQuerysetEqual(Book.objects.values('id', 'name').iterator(),\n             [\n-                {'headline': 'Article 5', 'id': self.a5.id},\n-                {'headline': 'Article 6', 'id': self.a6.id},\n-                {'headline': 'Article 4', 'id': self.a4.id},\n-                {'headline': 'Article 2', 'id': self.a2.id},\n-                {'headline': 'Article 3', 'id': self.a3.id},\n-                {'headline': 'Article 7', 'id': self.a7.id},\n-                {'headline': 'Article 1', 'id': self.a1.id},\n+                {'name': 'Book 5', 'id': self.b5.id},\n+                {'name': 'Book 6', 'id': self.b6.id},\n+                {'name': 'Book 4', 'id': self.b4.id},\n+                {'name': 'Book 2', 'id': self.b2.id},\n+                {'name': 'Book 3', 'id': self.b3.id},\n+                {'name': 'Book 7', 'id': self.b7.id},\n+                {'name': 'Book 1', 'id': self.b1.id},\n             ],\n             transform=identity)\n         # The values() method works with \"extra\" fields specified in extra(select).\n         self.assertQuerysetEqual(\n-            Article.objects.extra(select={'id_plus_one': 'id + 1'}).values('id', 'id_plus_one'),\n+            Book.objects.extra(select={'id_plus_one': 'id + 1'}).values('id', 'id_plus_one'),\n             [\n-                {'id': self.a5.id, 'id_plus_one': self.a5.id + 1},\n-                {'id': self.a6.id, 'id_plus_one': self.a6.id + 1},\n-                {'id': self.a4.id, 'id_plus_one': self.a4.id + 1},\n-                {'id': self.a2.id, 'id_plus_one': self.a2.id + 1},\n-                {'id': self.a3.id, 'id_plus_one': self.a3.id + 1},\n-                {'id': self.a7.id, 'id_plus_one': self.a7.id + 1},\n-                {'id': self.a1.id, 'id_plus_one': self.a1.id + 1},\n+                {'id': self.b5.id, 'id_plus_one': self.b5.id + 1},\n+                {'id': self.b6.id, 'id_plus_one': self.b6.id + 1},\n+                {'id': self.b4.id, 'id_plus_one': self.b4.id + 1},\n+                {'id': self.b2.id, 'id_plus_one': self.b2.id + 1},\n+                {'id': self.b3.id, 'id_plus_one': self.b3.id + 1},\n+                {'id': self.b7.id, 'id_plus_one': self.b7.id + 1},\n+                {'id': self.b1.id, 'id_plus_one': self.b1.id + 1},\n             ],\n             transform=identity)\n         data = {\n@@ -189,66 +191,67 @@ def test_values(self):\n             'id_plus_eight': 'id+8',\n         }\n         self.assertQuerysetEqual(\n-            Article.objects.filter(id=self.a1.id).extra(select=data).values(*data.keys()),\n+            Book.objects.filter(id=self.b1.id).extra(select=data).values(*data.keys()),\n             [{\n-                'id_plus_one': self.a1.id + 1,\n-                'id_plus_two': self.a1.id + 2,\n-                'id_plus_three': self.a1.id + 3,\n-                'id_plus_four': self.a1.id + 4,\n-                'id_plus_five': self.a1.id + 5,\n-                'id_plus_six': self.a1.id + 6,\n-                'id_plus_seven': self.a1.id + 7,\n-                'id_plus_eight': self.a1.id + 8,\n+                'id_plus_one': self.b1.id + 1,\n+                'id_plus_two': self.b1.id + 2,\n+                'id_plus_three': self.b1.id + 3,\n+                'id_plus_four': self.b1.id + 4,\n+                'id_plus_five': self.b1.id + 5,\n+                'id_plus_six': self.b1.id + 6,\n+                'id_plus_seven': self.b1.id + 7,\n+                'id_plus_eight': self.b1.id + 8,\n             }], transform=identity)\n         # You can specify fields from forward and reverse relations, just like filter().\n         self.assertQuerysetEqual(\n-            Article.objects.values('headline', 'author__name'),\n+            Book.objects.values('name', 'author__name'),\n             [\n-                {'headline': self.a5.headline, 'author__name': self.au2.name},\n-                {'headline': self.a6.headline, 'author__name': self.au2.name},\n-                {'headline': self.a4.headline, 'author__name': self.au1.name},\n-                {'headline': self.a2.headline, 'author__name': self.au1.name},\n-                {'headline': self.a3.headline, 'author__name': self.au1.name},\n-                {'headline': self.a7.headline, 'author__name': self.au2.name},\n-                {'headline': self.a1.headline, 'author__name': self.au1.name},\n+                {'name': self.b5.name, 'author__name': self.au2.name},\n+                {'name': self.b6.name, 'author__name': self.au2.name},\n+                {'name': self.b4.name, 'author__name': self.au1.name},\n+                {'name': self.b2.name, 'author__name': self.au1.name},\n+                {'name': self.b3.name, 'author__name': self.au1.name},\n+                {'name': self.b7.name, 'author__name': self.au2.name},\n+                {'name': self.b1.name, 'author__name': self.au1.name},\n             ], transform=identity)\n         self.assertQuerysetEqual(\n-            Author.objects.values('name', 'article__headline').order_by('name', 'article__headline'),\n+            Author.objects.values('name', 'book__name').order_by('name', 'book__name'),\n             [\n-                {'name': self.au1.name, 'article__headline': self.a1.headline},\n-                {'name': self.au1.name, 'article__headline': self.a2.headline},\n-                {'name': self.au1.name, 'article__headline': self.a3.headline},\n-                {'name': self.au1.name, 'article__headline': self.a4.headline},\n-                {'name': self.au2.name, 'article__headline': self.a5.headline},\n-                {'name': self.au2.name, 'article__headline': self.a6.headline},\n-                {'name': self.au2.name, 'article__headline': self.a7.headline},\n+                {'name': self.au1.name, 'book__name': self.b1.name},\n+                {'name': self.au1.name, 'book__name': self.b2.name},\n+                {'name': self.au1.name, 'book__name': self.b3.name},\n+                {'name': self.au1.name, 'book__name': self.b4.name},\n+                {'name': self.au2.name, 'book__name': self.b5.name},\n+                {'name': self.au2.name, 'book__name': self.b6.name},\n+                {'name': self.au2.name, 'book__name': self.b7.name},\n             ], transform=identity)\n         self.assertQuerysetEqual(\n-            Author.objects.values('name', 'article__headline', 'article__tag__name').order_by('name', 'article__headline', 'article__tag__name'),\n+            Author.objects.values('name', 'book__name', 'book__tag__name').order_by('name', 'book__name', 'book__tag__name'),\n             [\n-                {'name': self.au1.name, 'article__headline': self.a1.headline, 'article__tag__name': self.t1.name},\n-                {'name': self.au1.name, 'article__headline': self.a2.headline, 'article__tag__name': self.t1.name},\n-                {'name': self.au1.name, 'article__headline': self.a3.headline, 'article__tag__name': self.t1.name},\n-                {'name': self.au1.name, 'article__headline': self.a3.headline, 'article__tag__name': self.t2.name},\n-                {'name': self.au1.name, 'article__headline': self.a4.headline, 'article__tag__name': self.t2.name},\n-                {'name': self.au2.name, 'article__headline': self.a5.headline, 'article__tag__name': self.t2.name},\n-                {'name': self.au2.name, 'article__headline': self.a5.headline, 'article__tag__name': self.t3.name},\n-                {'name': self.au2.name, 'article__headline': self.a6.headline, 'article__tag__name': self.t3.name},\n-                {'name': self.au2.name, 'article__headline': self.a7.headline, 'article__tag__name': self.t3.name},\n+                {'name': self.au1.name, 'book__name': self.b1.name, 'book__tag__name': self.t1.name},\n+                {'name': self.au1.name, 'book__name': self.b2.name, 'book__tag__name': self.t1.name},\n+                {'name': self.au1.name, 'book__name': self.b3.name, 'book__tag__name': self.t1.name},\n+                {'name': self.au1.name, 'book__name': self.b3.name, 'book__tag__name': self.t2.name},\n+                {'name': self.au1.name, 'book__name': self.b4.name, 'book__tag__name': self.t2.name},\n+                {'name': self.au2.name, 'book__name': self.b5.name, 'book__tag__name': self.t2.name},\n+                {'name': self.au2.name, 'book__name': self.b5.name, 'book__tag__name': self.t3.name},\n+                {'name': self.au2.name, 'book__name': self.b6.name, 'book__tag__name': self.t3.name},\n+                {'name': self.au2.name, 'book__name': self.b7.name, 'book__tag__name': self.t3.name},\n             ], transform=identity)\n         # However, an exception FieldDoesNotExist will be thrown if you specify\n         # a non-existent field name in values() (a field that is neither in the\n         # model nor in extra(select)).\n         self.assertRaises(FieldError,\n-            Article.objects.extra(select={'id_plus_one': 'id + 1'}).values,\n+            Book.objects.extra(select={'id_plus_one': 'id + 1'}).values,\n             'id', 'id_plus_two')\n         # If you don't specify field names to values(), all are returned.\n-        self.assertQuerysetEqual(Article.objects.filter(id=self.a5.id).values(),\n+        self.assertQuerysetEqual(Book.objects.filter(id=self.b5.id).values(),\n             [{\n-                'id': self.a5.id,\n+                'id': self.b5.id,\n                 'author_id': self.au2.id,\n-                'headline': 'Article 5',\n-                'pub_date': datetime(2005, 8, 1, 9, 0)\n+                'name': 'Book 5',\n+                'pages': 0,\n+                'pubdate': datetime(2005, 8, 1, 9, 0)\n             }], transform=identity)\n \n     def test_values_list(self):\n@@ -257,370 +260,370 @@ def test_values_list(self):\n         # Within each tuple, the order of the elements is the same as the order\n         # of fields in the values_list() call.\n         identity = lambda x:x\n-        self.assertQuerysetEqual(Article.objects.values_list('headline'),\n+        self.assertQuerysetEqual(Book.objects.values_list('name'),\n             [\n-                ('Article 5',),\n-                ('Article 6',),\n-                ('Article 4',),\n-                ('Article 2',),\n-                ('Article 3',),\n-                ('Article 7',),\n-                ('Article 1',),\n+                ('Book 5',),\n+                ('Book 6',),\n+                ('Book 4',),\n+                ('Book 2',),\n+                ('Book 3',),\n+                ('Book 7',),\n+                ('Book 1',),\n             ], transform=identity)\n-        self.assertQuerysetEqual(Article.objects.values_list('id').order_by('id'),\n-            [(self.a1.id,), (self.a2.id,), (self.a3.id,), (self.a4.id,), (self.a5.id,), (self.a6.id,), (self.a7.id,)],\n+        self.assertQuerysetEqual(Book.objects.values_list('id').order_by('id'),\n+            [(self.b1.id,), (self.b2.id,), (self.b3.id,), (self.b4.id,), (self.b5.id,), (self.b6.id,), (self.b7.id,)],\n             transform=identity)\n         self.assertQuerysetEqual(\n-            Article.objects.values_list('id', flat=True).order_by('id'),\n-            [self.a1.id, self.a2.id, self.a3.id, self.a4.id, self.a5.id, self.a6.id, self.a7.id],\n+            Book.objects.values_list('id', flat=True).order_by('id'),\n+            [self.b1.id, self.b2.id, self.b3.id, self.b4.id, self.b5.id, self.b6.id, self.b7.id],\n             transform=identity)\n         self.assertQuerysetEqual(\n-            Article.objects.extra(select={'id_plus_one': 'id+1'})\n+            Book.objects.extra(select={'id_plus_one': 'id+1'})\n                            .order_by('id').values_list('id'),\n-            [(self.a1.id,), (self.a2.id,), (self.a3.id,), (self.a4.id,), (self.a5.id,), (self.a6.id,), (self.a7.id,)],\n+            [(self.b1.id,), (self.b2.id,), (self.b3.id,), (self.b4.id,), (self.b5.id,), (self.b6.id,), (self.b7.id,)],\n             transform=identity)\n         self.assertQuerysetEqual(\n-            Article.objects.extra(select={'id_plus_one': 'id+1'})\n+            Book.objects.extra(select={'id_plus_one': 'id+1'})\n                            .order_by('id').values_list('id_plus_one', 'id'),\n             [\n-                (self.a1.id+1, self.a1.id),\n-                (self.a2.id+1, self.a2.id),\n-                (self.a3.id+1, self.a3.id),\n-                (self.a4.id+1, self.a4.id),\n-                (self.a5.id+1, self.a5.id),\n-                (self.a6.id+1, self.a6.id),\n-                (self.a7.id+1, self.a7.id)\n+                (self.b1.id+1, self.b1.id),\n+                (self.b2.id+1, self.b2.id),\n+                (self.b3.id+1, self.b3.id),\n+                (self.b4.id+1, self.b4.id),\n+                (self.b5.id+1, self.b5.id),\n+                (self.b6.id+1, self.b6.id),\n+                (self.b7.id+1, self.b7.id)\n             ],\n             transform=identity)\n         self.assertQuerysetEqual(\n-            Article.objects.extra(select={'id_plus_one': 'id+1'})\n+            Book.objects.extra(select={'id_plus_one': 'id+1'})\n                            .order_by('id').values_list('id', 'id_plus_one'),\n             [\n-                (self.a1.id, self.a1.id+1),\n-                (self.a2.id, self.a2.id+1),\n-                (self.a3.id, self.a3.id+1),\n-                (self.a4.id, self.a4.id+1),\n-                (self.a5.id, self.a5.id+1),\n-                (self.a6.id, self.a6.id+1),\n-                (self.a7.id, self.a7.id+1)\n+                (self.b1.id, self.b1.id+1),\n+                (self.b2.id, self.b2.id+1),\n+                (self.b3.id, self.b3.id+1),\n+                (self.b4.id, self.b4.id+1),\n+                (self.b5.id, self.b5.id+1),\n+                (self.b6.id, self.b6.id+1),\n+                (self.b7.id, self.b7.id+1)\n             ],\n             transform=identity)\n         self.assertQuerysetEqual(\n-            Author.objects.values_list('name', 'article__headline', 'article__tag__name').order_by('name', 'article__headline', 'article__tag__name'),\n+            Author.objects.values_list('name', 'book__name', 'book__tag__name').order_by('name', 'book__name', 'book__tag__name'),\n             [\n-                (self.au1.name, self.a1.headline, self.t1.name),\n-                (self.au1.name, self.a2.headline, self.t1.name),\n-                (self.au1.name, self.a3.headline, self.t1.name),\n-                (self.au1.name, self.a3.headline, self.t2.name),\n-                (self.au1.name, self.a4.headline, self.t2.name),\n-                (self.au2.name, self.a5.headline, self.t2.name),\n-                (self.au2.name, self.a5.headline, self.t3.name),\n-                (self.au2.name, self.a6.headline, self.t3.name),\n-                (self.au2.name, self.a7.headline, self.t3.name),\n+                (self.au1.name, self.b1.name, self.t1.name),\n+                (self.au1.name, self.b2.name, self.t1.name),\n+                (self.au1.name, self.b3.name, self.t1.name),\n+                (self.au1.name, self.b3.name, self.t2.name),\n+                (self.au1.name, self.b4.name, self.t2.name),\n+                (self.au2.name, self.b5.name, self.t2.name),\n+                (self.au2.name, self.b5.name, self.t3.name),\n+                (self.au2.name, self.b6.name, self.t3.name),\n+                (self.au2.name, self.b7.name, self.t3.name),\n             ], transform=identity)\n-        self.assertRaises(TypeError, Article.objects.values_list, 'id', 'headline', flat=True)\n+        self.assertRaises(TypeError, Book.objects.values_list, 'id', 'name', flat=True)\n \n     def test_get_next_previous_by(self):\n         # Every DateField and DateTimeField creates get_next_by_FOO() and\n         # get_previous_by_FOO() methods. In the case of identical date values,\n         # these methods will use the ID as a fallback check. This guarantees\n         # that no records are skipped or duplicated.\n-        self.assertEqual(repr(self.a1.get_next_by_pub_date()),\n-                         '<Article: Article 2>')\n-        self.assertEqual(repr(self.a2.get_next_by_pub_date()),\n-                         '<Article: Article 3>')\n-        self.assertEqual(repr(self.a2.get_next_by_pub_date(headline__endswith='6')),\n-                         '<Article: Article 6>')\n-        self.assertEqual(repr(self.a3.get_next_by_pub_date()),\n-                         '<Article: Article 7>')\n-        self.assertEqual(repr(self.a4.get_next_by_pub_date()),\n-                         '<Article: Article 6>')\n-        self.assertRaises(Article.DoesNotExist, self.a5.get_next_by_pub_date)\n-        self.assertEqual(repr(self.a6.get_next_by_pub_date()),\n-                         '<Article: Article 5>')\n-        self.assertEqual(repr(self.a7.get_next_by_pub_date()),\n-                         '<Article: Article 4>')\n-\n-        self.assertEqual(repr(self.a7.get_previous_by_pub_date()),\n-                         '<Article: Article 3>')\n-        self.assertEqual(repr(self.a6.get_previous_by_pub_date()),\n-                         '<Article: Article 4>')\n-        self.assertEqual(repr(self.a5.get_previous_by_pub_date()),\n-                         '<Article: Article 6>')\n-        self.assertEqual(repr(self.a4.get_previous_by_pub_date()),\n-                         '<Article: Article 7>')\n-        self.assertEqual(repr(self.a3.get_previous_by_pub_date()),\n-                         '<Article: Article 2>')\n-        self.assertEqual(repr(self.a2.get_previous_by_pub_date()),\n-                         '<Article: Article 1>')\n+        self.assertEqual(repr(self.b1.get_next_by_pubdate()),\n+                         '<Book: Book 2>')\n+        self.assertEqual(repr(self.b2.get_next_by_pubdate()),\n+                         '<Book: Book 3>')\n+        self.assertEqual(repr(self.b2.get_next_by_pubdate(name__endswith='6')),\n+                         '<Book: Book 6>')\n+        self.assertEqual(repr(self.b3.get_next_by_pubdate()),\n+                         '<Book: Book 7>')\n+        self.assertEqual(repr(self.b4.get_next_by_pubdate()),\n+                         '<Book: Book 6>')\n+        self.assertRaises(Book.DoesNotExist, self.b5.get_next_by_pubdate)\n+        self.assertEqual(repr(self.b6.get_next_by_pubdate()),\n+                         '<Book: Book 5>')\n+        self.assertEqual(repr(self.b7.get_next_by_pubdate()),\n+                         '<Book: Book 4>')\n+\n+        self.assertEqual(repr(self.b7.get_previous_by_pubdate()),\n+                         '<Book: Book 3>')\n+        self.assertEqual(repr(self.b6.get_previous_by_pubdate()),\n+                         '<Book: Book 4>')\n+        self.assertEqual(repr(self.b5.get_previous_by_pubdate()),\n+                         '<Book: Book 6>')\n+        self.assertEqual(repr(self.b4.get_previous_by_pubdate()),\n+                         '<Book: Book 7>')\n+        self.assertEqual(repr(self.b3.get_previous_by_pubdate()),\n+                         '<Book: Book 2>')\n+        self.assertEqual(repr(self.b2.get_previous_by_pubdate()),\n+                         '<Book: Book 1>')\n \n     def test_escaping(self):\n         # Underscores, percent signs and backslashes have special meaning in the\n         # underlying SQL code, but Django handles the quoting of them automatically.\n-        a8 = Article(headline='Article_ with underscore', pub_date=datetime(2005, 11, 20))\n-        a8.save()\n-        self.assertQuerysetEqual(Article.objects.filter(headline__startswith='Article'),\n+        b8 = Book(name='Book_ with underscore', pubdate=datetime(2005, 11, 20))\n+        b8.save()\n+        self.assertQuerysetEqual(Book.objects.filter(name__startswith='Book'),\n             [\n-                '<Article: Article_ with underscore>',\n-                '<Article: Article 5>',\n-                '<Article: Article 6>',\n-                '<Article: Article 4>',\n-                '<Article: Article 2>',\n-                '<Article: Article 3>',\n-                '<Article: Article 7>',\n-                '<Article: Article 1>',\n+                '<Book: Book_ with underscore>',\n+                '<Book: Book 5>',\n+                '<Book: Book 6>',\n+                '<Book: Book 4>',\n+                '<Book: Book 2>',\n+                '<Book: Book 3>',\n+                '<Book: Book 7>',\n+                '<Book: Book 1>',\n             ])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__startswith='Article_'),\n-                                 ['<Article: Article_ with underscore>'])\n-        a9 = Article(headline='Article% with percent sign', pub_date=datetime(2005, 11, 21))\n-        a9.save()\n-        self.assertQuerysetEqual(Article.objects.filter(headline__startswith='Article'),\n+        self.assertQuerysetEqual(Book.objects.filter(name__startswith='Book_'),\n+                                 ['<Book: Book_ with underscore>'])\n+        b9 = Book(name='Book% with percent sign', pubdate=datetime(2005, 11, 21))\n+        b9.save()\n+        self.assertQuerysetEqual(Book.objects.filter(name__startswith='Book'),\n             [\n-                '<Article: Article% with percent sign>',\n-                '<Article: Article_ with underscore>',\n-                '<Article: Article 5>',\n-                '<Article: Article 6>',\n-                '<Article: Article 4>',\n-                '<Article: Article 2>',\n-                '<Article: Article 3>',\n-                '<Article: Article 7>',\n-                '<Article: Article 1>',\n+                '<Book: Book% with percent sign>',\n+                '<Book: Book_ with underscore>',\n+                '<Book: Book 5>',\n+                '<Book: Book 6>',\n+                '<Book: Book 4>',\n+                '<Book: Book 2>',\n+                '<Book: Book 3>',\n+                '<Book: Book 7>',\n+                '<Book: Book 1>',\n             ])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__startswith='Article%'),\n-                                 ['<Article: Article% with percent sign>'])\n-        a10 = Article(headline='Article with \\\\ backslash', pub_date=datetime(2005, 11, 22))\n-        a10.save()\n-        self.assertQuerysetEqual(Article.objects.filter(headline__contains='\\\\'),\n-                                 ['<Article: Article with \\ backslash>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__startswith='Book%'),\n+                                 ['<Book: Book% with percent sign>'])\n+        b10 = Book(name='Book with \\\\ backslash', pubdate=datetime(2005, 11, 22))\n+        b10.save()\n+        self.assertQuerysetEqual(Book.objects.filter(name__contains='\\\\'),\n+                                 ['<Book: Book with \\ backslash>'])\n \n     def test_exclude(self):\n-        a8 = Article.objects.create(headline='Article_ with underscore', pub_date=datetime(2005, 11, 20))\n-        a9 = Article.objects.create(headline='Article% with percent sign', pub_date=datetime(2005, 11, 21))\n-        a10 = Article.objects.create(headline='Article with \\\\ backslash', pub_date=datetime(2005, 11, 22))\n+        b8 = Book.objects.create(name='Book_ with underscore', pubdate=datetime(2005, 11, 20))\n+        b9 = Book.objects.create(name='Book% with percent sign', pubdate=datetime(2005, 11, 21))\n+        b10 = Book.objects.create(name='Book with \\\\ backslash', pubdate=datetime(2005, 11, 22))\n \n         # exclude() is the opposite of filter() when doing lookups:\n         self.assertQuerysetEqual(\n-            Article.objects.filter(headline__contains='Article').exclude(headline__contains='with'),\n+            Book.objects.filter(name__contains='Book').exclude(name__contains='with'),\n             [\n-                '<Article: Article 5>',\n-                '<Article: Article 6>',\n-                '<Article: Article 4>',\n-                '<Article: Article 2>',\n-                '<Article: Article 3>',\n-                '<Article: Article 7>',\n-                '<Article: Article 1>',\n+                '<Book: Book 5>',\n+                '<Book: Book 6>',\n+                '<Book: Book 4>',\n+                '<Book: Book 2>',\n+                '<Book: Book 3>',\n+                '<Book: Book 7>',\n+                '<Book: Book 1>',\n             ])\n-        self.assertQuerysetEqual(Article.objects.exclude(headline__startswith=\"Article_\"),\n+        self.assertQuerysetEqual(Book.objects.exclude(name__startswith=\"Book_\"),\n             [\n-                '<Article: Article with \\\\ backslash>',\n-                '<Article: Article% with percent sign>',\n-                '<Article: Article 5>',\n-                '<Article: Article 6>',\n-                '<Article: Article 4>',\n-                '<Article: Article 2>',\n-                '<Article: Article 3>',\n-                '<Article: Article 7>',\n-                '<Article: Article 1>',\n+                '<Book: Book with \\\\ backslash>',\n+                '<Book: Book% with percent sign>',\n+                '<Book: Book 5>',\n+                '<Book: Book 6>',\n+                '<Book: Book 4>',\n+                '<Book: Book 2>',\n+                '<Book: Book 3>',\n+                '<Book: Book 7>',\n+                '<Book: Book 1>',\n             ])\n-        self.assertQuerysetEqual(Article.objects.exclude(headline=\"Article 7\"),\n+        self.assertQuerysetEqual(Book.objects.exclude(name=\"Book 7\"),\n             [\n-                '<Article: Article with \\\\ backslash>',\n-                '<Article: Article% with percent sign>',\n-                '<Article: Article_ with underscore>',\n-                '<Article: Article 5>',\n-                '<Article: Article 6>',\n-                '<Article: Article 4>',\n-                '<Article: Article 2>',\n-                '<Article: Article 3>',\n-                '<Article: Article 1>',\n+                '<Book: Book with \\\\ backslash>',\n+                '<Book: Book% with percent sign>',\n+                '<Book: Book_ with underscore>',\n+                '<Book: Book 5>',\n+                '<Book: Book 6>',\n+                '<Book: Book 4>',\n+                '<Book: Book 2>',\n+                '<Book: Book 3>',\n+                '<Book: Book 1>',\n             ])\n \n     def test_none(self):\n        # none() returns a QuerySet that behaves like any other QuerySet object\n-        self.assertQuerysetEqual(Article.objects.none(), [])\n+        self.assertQuerysetEqual(Book.objects.none(), [])\n         self.assertQuerysetEqual(\n-            Article.objects.none().filter(headline__startswith='Article'), [])\n+            Book.objects.none().filter(name__startswith='Book'), [])\n         self.assertQuerysetEqual(\n-            Article.objects.filter(headline__startswith='Article').none(), [])\n-        self.assertEqual(Article.objects.none().count(), 0)\n+            Book.objects.filter(name__startswith='Book').none(), [])\n+        self.assertEqual(Book.objects.none().count(), 0)\n         self.assertEqual(\n-            Article.objects.none().update(headline=\"This should not take effect\"), 0)\n+            Book.objects.none().update(name=\"This should not take effect\"), 0)\n         self.assertQuerysetEqual(\n-            [article for article in Article.objects.none().iterator()],\n+            [article for article in Book.objects.none().iterator()],\n             [])\n \n     def test_in(self):\n         # using __in with an empty list should return an empty query set\n-        self.assertQuerysetEqual(Article.objects.filter(id__in=[]), [])\n-        self.assertQuerysetEqual(Article.objects.exclude(id__in=[]),\n+        self.assertQuerysetEqual(Book.objects.filter(id__in=[]), [])\n+        self.assertQuerysetEqual(Book.objects.exclude(id__in=[]),\n             [\n-                '<Article: Article 5>',\n-                '<Article: Article 6>',\n-                '<Article: Article 4>',\n-                '<Article: Article 2>',\n-                '<Article: Article 3>',\n-                '<Article: Article 7>',\n-                '<Article: Article 1>',\n+                '<Book: Book 5>',\n+                '<Book: Book 6>',\n+                '<Book: Book 4>',\n+                '<Book: Book 2>',\n+                '<Book: Book 3>',\n+                '<Book: Book 7>',\n+                '<Book: Book 1>',\n             ])\n \n     def test_error_messages(self):\n         # Programming errors are pointed out with nice error messages\n         try:\n-            Article.objects.filter(pub_date_year='2005').count()\n+            Book.objects.filter(pubdate_year='2005').count()\n             self.fail('FieldError not raised')\n         except FieldError as ex:\n-            self.assertEqual(str(ex), \"Cannot resolve keyword 'pub_date_year' \"\n-                             \"into field. Choices are: author, headline, id, pub_date, tag\")\n+            self.assertEqual(str(ex), \"Cannot resolve keyword 'pubdate_year' \"\n+                             \"into field. Choices are: author, id, name, pages, pubdate, tag, tags\")\n         try:\n-            Article.objects.filter(headline__starts='Article')\n+            Book.objects.filter(name__starts='Book')\n             self.fail('FieldError not raised')\n         except FieldError as ex:\n-            self.assertEqual(str(ex), \"Join on field 'headline' not permitted. \"\n+            self.assertEqual(str(ex), \"Join on field 'name' not permitted. \"\n                              \"Did you misspell 'starts' for the lookup type?\")\n \n     def test_regex(self):\n-        # Create some articles with a bit more interesting headlines for testing field lookups:\n-        for a in Article.objects.all():\n+        # Create some articles with a bit more interesting names for testing field lookups:\n+        for a in Book.objects.all():\n             a.delete()\n         now = datetime.now()\n-        a1 = Article(pub_date=now, headline='f')\n-        a1.save()\n-        a2 = Article(pub_date=now, headline='fo')\n-        a2.save()\n-        a3 = Article(pub_date=now, headline='foo')\n-        a3.save()\n-        a4 = Article(pub_date=now, headline='fooo')\n-        a4.save()\n-        a5 = Article(pub_date=now, headline='hey-Foo')\n-        a5.save()\n-        a6 = Article(pub_date=now, headline='bar')\n-        a6.save()\n-        a7 = Article(pub_date=now, headline='AbBa')\n-        a7.save()\n-        a8 = Article(pub_date=now, headline='baz')\n-        a8.save()\n-        a9 = Article(pub_date=now, headline='baxZ')\n-        a9.save()\n+        b1 = Book(pubdate=now, name='f')\n+        b1.save()\n+        b2 = Book(pubdate=now, name='fo')\n+        b2.save()\n+        b3 = Book(pubdate=now, name='foo')\n+        b3.save()\n+        b4 = Book(pubdate=now, name='fooo')\n+        b4.save()\n+        b5 = Book(pubdate=now, name='hey-Foo')\n+        b5.save()\n+        b6 = Book(pubdate=now, name='bar')\n+        b6.save()\n+        b7 = Book(pubdate=now, name='AbBa')\n+        b7.save()\n+        b8 = Book(pubdate=now, name='baz')\n+        b8.save()\n+        b9 = Book(pubdate=now, name='baxZ')\n+        b9.save()\n         # zero-or-more\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'fo*'),\n-            ['<Article: f>', '<Article: fo>', '<Article: foo>', '<Article: fooo>'])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__iregex=r'fo*'),\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'fo*'),\n+            ['<Book: f>', '<Book: fo>', '<Book: foo>', '<Book: fooo>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__iregex=r'fo*'),\n             [\n-                '<Article: f>',\n-                '<Article: fo>',\n-                '<Article: foo>',\n-                '<Article: fooo>',\n-                '<Article: hey-Foo>',\n+                '<Book: f>',\n+                '<Book: fo>',\n+                '<Book: foo>',\n+                '<Book: fooo>',\n+                '<Book: hey-Foo>',\n             ])\n         # one-or-more\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'fo+'),\n-            ['<Article: fo>', '<Article: foo>', '<Article: fooo>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'fo+'),\n+            ['<Book: fo>', '<Book: foo>', '<Book: fooo>'])\n         # wildcard\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'fooo?'),\n-            ['<Article: foo>', '<Article: fooo>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'fooo?'),\n+            ['<Book: foo>', '<Book: fooo>'])\n         # leading anchor\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'^b'),\n-            ['<Article: bar>', '<Article: baxZ>', '<Article: baz>'])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__iregex=r'^a'),\n-            ['<Article: AbBa>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'^b'),\n+            ['<Book: bar>', '<Book: baxZ>', '<Book: baz>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__iregex=r'^a'),\n+            ['<Book: AbBa>'])\n         # trailing anchor\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'z$'),\n-            ['<Article: baz>'])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__iregex=r'z$'),\n-            ['<Article: baxZ>', '<Article: baz>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'z$'),\n+            ['<Book: baz>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__iregex=r'z$'),\n+            ['<Book: baxZ>', '<Book: baz>'])\n         # character sets\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'ba[rz]'),\n-            ['<Article: bar>', '<Article: baz>'])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'ba.[RxZ]'),\n-            ['<Article: baxZ>'])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__iregex=r'ba[RxZ]'),\n-            ['<Article: bar>', '<Article: baxZ>', '<Article: baz>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'ba[rz]'),\n+            ['<Book: bar>', '<Book: baz>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'ba.[RxZ]'),\n+            ['<Book: baxZ>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__iregex=r'ba[RxZ]'),\n+            ['<Book: bar>', '<Book: baxZ>', '<Book: baz>'])\n \n         # and more articles:\n-        a10 = Article(pub_date=now, headline='foobar')\n-        a10.save()\n-        a11 = Article(pub_date=now, headline='foobaz')\n-        a11.save()\n-        a12 = Article(pub_date=now, headline='ooF')\n-        a12.save()\n-        a13 = Article(pub_date=now, headline='foobarbaz')\n-        a13.save()\n-        a14 = Article(pub_date=now, headline='zoocarfaz')\n-        a14.save()\n-        a15 = Article(pub_date=now, headline='barfoobaz')\n-        a15.save()\n-        a16 = Article(pub_date=now, headline='bazbaRFOO')\n-        a16.save()\n+        b10 = Book(pubdate=now, name='foobar')\n+        b10.save()\n+        b11 = Book(pubdate=now, name='foobaz')\n+        b11.save()\n+        b12 = Book(pubdate=now, name='ooF')\n+        b12.save()\n+        b13 = Book(pubdate=now, name='foobarbaz')\n+        b13.save()\n+        b14 = Book(pubdate=now, name='zoocarfaz')\n+        b14.save()\n+        b15 = Book(pubdate=now, name='barfoobaz')\n+        b15.save()\n+        b16 = Book(pubdate=now, name='bazbaRFOO')\n+        b16.save()\n \n         # alternation\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'oo(f|b)'),\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'oo(f|b)'),\n             [\n-                '<Article: barfoobaz>',\n-                '<Article: foobar>',\n-                '<Article: foobarbaz>',\n-                '<Article: foobaz>',\n+                '<Book: barfoobaz>',\n+                '<Book: foobar>',\n+                '<Book: foobarbaz>',\n+                '<Book: foobaz>',\n             ])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__iregex=r'oo(f|b)'),\n+        self.assertQuerysetEqual(Book.objects.filter(name__iregex=r'oo(f|b)'),\n             [\n-                '<Article: barfoobaz>',\n-                '<Article: foobar>',\n-                '<Article: foobarbaz>',\n-                '<Article: foobaz>',\n-                '<Article: ooF>',\n+                '<Book: barfoobaz>',\n+                '<Book: foobar>',\n+                '<Book: foobarbaz>',\n+                '<Book: foobaz>',\n+                '<Book: ooF>',\n             ])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'^foo(f|b)'),\n-            ['<Article: foobar>', '<Article: foobarbaz>', '<Article: foobaz>'])\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'^foo(f|b)'),\n+            ['<Book: foobar>', '<Book: foobarbaz>', '<Book: foobaz>'])\n \n         # greedy matching\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'b.*az'),\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'b.*az'),\n             [\n-                '<Article: barfoobaz>',\n-                '<Article: baz>',\n-                '<Article: bazbaRFOO>',\n-                '<Article: foobarbaz>',\n-                '<Article: foobaz>',\n+                '<Book: barfoobaz>',\n+                '<Book: baz>',\n+                '<Book: bazbaRFOO>',\n+                '<Book: foobarbaz>',\n+                '<Book: foobaz>',\n             ])\n-        self.assertQuerysetEqual(Article.objects.filter(headline__iregex=r'b.*ar'),\n+        self.assertQuerysetEqual(Book.objects.filter(name__iregex=r'b.*ar'),\n             [\n-                '<Article: bar>',\n-                '<Article: barfoobaz>',\n-                '<Article: bazbaRFOO>',\n-                '<Article: foobar>',\n-                '<Article: foobarbaz>',\n+                '<Book: bar>',\n+                '<Book: barfoobaz>',\n+                '<Book: bazbaRFOO>',\n+                '<Book: foobar>',\n+                '<Book: foobarbaz>',\n             ])\n \n     @skipUnlessDBFeature('supports_regex_backreferencing')\n     def test_regex_backreferencing(self):\n         # grouping and backreferences\n         now = datetime.now()\n-        a10 = Article(pub_date=now, headline='foobar')\n-        a10.save()\n-        a11 = Article(pub_date=now, headline='foobaz')\n-        a11.save()\n-        a12 = Article(pub_date=now, headline='ooF')\n-        a12.save()\n-        a13 = Article(pub_date=now, headline='foobarbaz')\n-        a13.save()\n-        a14 = Article(pub_date=now, headline='zoocarfaz')\n-        a14.save()\n-        a15 = Article(pub_date=now, headline='barfoobaz')\n-        a15.save()\n-        a16 = Article(pub_date=now, headline='bazbaRFOO')\n-        a16.save()\n-        self.assertQuerysetEqual(Article.objects.filter(headline__regex=r'b(.).*b\\1'),\n-            ['<Article: barfoobaz>', '<Article: bazbaRFOO>', '<Article: foobarbaz>'])\n+        b10 = Book(pubdate=now, name='foobar')\n+        b10.save()\n+        b11 = Book(pubdate=now, name='foobaz')\n+        b11.save()\n+        b12 = Book(pubdate=now, name='ooF')\n+        b12.save()\n+        b13 = Book(pubdate=now, name='foobarbaz')\n+        b13.save()\n+        b14 = Book(pubdate=now, name='zoocarfaz')\n+        b14.save()\n+        b15 = Book(pubdate=now, name='barfoobaz')\n+        b15.save()\n+        b16 = Book(pubdate=now, name='bazbaRFOO')\n+        b16.save()\n+        self.assertQuerysetEqual(Book.objects.filter(name__regex=r'b(.).*b\\1'),\n+            ['<Book: barfoobaz>', '<Book: bazbaRFOO>', '<Book: foobarbaz>'])\n \n     def test_nonfield_lookups(self):\n         \"\"\"\n         Ensure that a lookup query containing non-fields raises the proper\n         exception.\n         \"\"\"\n         with self.assertRaises(FieldError):\n-            Article.objects.filter(headline__blahblah=99)\n+            Book.objects.filter(name__blahblah=99)\n         with self.assertRaises(FieldError):\n-            Article.objects.filter(headline__blahblah__exact=99)\n+            Book.objects.filter(name__blahblah__exact=99)\n         with self.assertRaises(FieldError):\n-            Article.objects.filter(blahblah=99)\n+            Book.objects.filter(blahblah=99)\n \n     def test_lookup_collision(self):\n         \"\"\""
        },
        {
            "sha": "af47224fb95b7bda68164fa2db93ab181dded630",
            "filename": "tests/runtests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/1059da8de675442e84381d6366c0be254681753e/tests%2Fruntests.py",
            "raw_url": "https://github.com/django/django/raw/1059da8de675442e84381d6366c0be254681753e/tests%2Fruntests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fruntests.py?ref=1059da8de675442e84381d6366c0be254681753e",
            "patch": "@@ -21,6 +21,7 @@\n SUBDIRS_TO_SKIP = ['templates']\n \n ALWAYS_INSTALLED_APPS = [\n+    'shared_models',\n     'django.contrib.contenttypes',\n     'django.contrib.auth',\n     'django.contrib.sites',"
        },
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "tests/shared_models/__init__.py",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/1059da8de675442e84381d6366c0be254681753e/tests%2Fshared_models%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/1059da8de675442e84381d6366c0be254681753e/tests%2Fshared_models%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fshared_models%2F__init__.py?ref=1059da8de675442e84381d6366c0be254681753e"
        },
        {
            "sha": "61b3669bc448839b08cf69c8777da613f8da4118",
            "filename": "tests/shared_models/models.py",
            "status": "added",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/1059da8de675442e84381d6366c0be254681753e/tests%2Fshared_models%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/1059da8de675442e84381d6366c0be254681753e/tests%2Fshared_models%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fshared_models%2Fmodels.py?ref=1059da8de675442e84381d6366c0be254681753e",
            "patch": "@@ -0,0 +1,30 @@\n+from django.db import models\n+from django.utils import timezone\n+from django.utils.encoding import python_2_unicode_compatible\n+\n+\n+class Tag(models.Model):\n+    name = models.CharField(max_length=255)\n+\n+\n+@python_2_unicode_compatible\n+class Author(models.Model):\n+    name = models.CharField(max_length=100)\n+\n+    def __str__(self):\n+        return self.name\n+\n+\n+@python_2_unicode_compatible\n+class Book(models.Model):\n+    name = models.CharField(max_length=200)\n+    pages = models.IntegerField(default=0)\n+    author = models.ForeignKey(Author, null=True)\n+    pubdate = models.DateTimeField()\n+    tags = models.ManyToManyField(Tag)\n+\n+    class Meta:\n+        ordering = ['-pubdate', 'name']\n+\n+    def __str__(self):\n+        return self.name"
        },
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "tests/signals_regress/models.py",
            "status": "modified",
            "additions": 0,
            "deletions": 18,
            "changes": 18,
            "blob_url": "https://github.com/django/django/blob/1059da8de675442e84381d6366c0be254681753e/tests%2Fsignals_regress%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/1059da8de675442e84381d6366c0be254681753e/tests%2Fsignals_regress%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fsignals_regress%2Fmodels.py?ref=1059da8de675442e84381d6366c0be254681753e",
            "patch": "@@ -1,18 +0,0 @@\n-from django.db import models\n-from django.utils.encoding import python_2_unicode_compatible\n-\n-\n-@python_2_unicode_compatible\n-class Author(models.Model):\n-    name = models.CharField(max_length=20)\n-\n-    def __str__(self):\n-        return self.name\n-\n-@python_2_unicode_compatible\n-class Book(models.Model):\n-    name = models.CharField(max_length=20)\n-    authors = models.ManyToManyField(Author)\n-\n-    def __str__(self):\n-        return self.name"
        },
        {
            "sha": "0c92b96c24f3ccde3aaf05feefc124f9752d8bbe",
            "filename": "tests/signals_regress/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/1059da8de675442e84381d6366c0be254681753e/tests%2Fsignals_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/1059da8de675442e84381d6366c0be254681753e/tests%2Fsignals_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fsignals_regress%2Ftests.py?ref=1059da8de675442e84381d6366c0be254681753e",
            "patch": "@@ -3,7 +3,7 @@\n from django.db import models\n from django.test import TestCase\n \n-from .models import Author, Book\n+from shared_models.models import Author, Book\n \n \n class SignalsRegressTests(TestCase):\n@@ -77,7 +77,7 @@ def test_model_signals(self):\n             \"Is created\"\n         ])\n \n-        b1 = Book(name='Snow Crash')\n+        b1 = Book(name='Snow Crash', pubdate='2012-02-02 12:00')\n         self.assertEqual(self.get_signal_output(b1.save), [\n             \"pre_save signal, Snow Crash\",\n             \"post_save signal, Snow Crash\",\n@@ -87,7 +87,7 @@ def test_model_signals(self):\n     def test_m2m_signals(self):\n         \"\"\" Assigning and removing to/from m2m shouldn't generate an m2m signal \"\"\"\n \n-        b1 = Book(name='Snow Crash')\n+        b1 = Book(name='Snow Crash', pubdate='2012-02-02 12:00')\n         self.get_signal_output(b1.save)\n         a1 = Author(name='Neal Stephenson')\n         self.get_signal_output(a1.save)"
        },
        {
            "sha": "1860c9dd2c977a4128ff012706790df87be62526",
            "filename": "tests/urlpatterns_reverse/tests.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/1059da8de675442e84381d6366c0be254681753e/tests%2Furlpatterns_reverse%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/1059da8de675442e84381d6366c0be254681753e/tests%2Furlpatterns_reverse%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Furlpatterns_reverse%2Ftests.py?ref=1059da8de675442e84381d6366c0be254681753e",
            "patch": "@@ -183,6 +183,11 @@ def test_prefix_format_char(self):\n         self.assertEqual('/bump%2520map/includes/non_path_include/',\n                reverse('non_path_include', prefix='/bump%20map/'))\n \n+    def test_non_urlsafe_prefix_with_args(self):\n+        # Regression for #20022\n+        self.assertEqual('/%7Eme/places/1/',\n+                reverse('places', args=[1], prefix='/~me/'))\n+\n class ResolverTests(unittest.TestCase):\n     def test_resolver_repr(self):\n         \"\"\""
        }
    ],
    "stats": {
        "total": 868,
        "additions": 439,
        "deletions": 429
    }
}