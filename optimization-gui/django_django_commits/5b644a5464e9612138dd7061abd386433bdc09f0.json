{
    "author": "adrianholovaty",
    "message": "Moved version code out of __init__.py.\nMoved everything except VERSION and a get_version() stub out of the top-level __init__.py, so that we're not importing all that stuff all the time. And because it's cleaner.",
    "sha": "5b644a5464e9612138dd7061abd386433bdc09f0",
    "files": [
        {
            "sha": "32e1374765a9445587c2285986d74e1f831560f9",
            "filename": "django/__init__.py",
            "status": "modified",
            "additions": 5,
            "deletions": 51,
            "changes": 56,
            "blob_url": "https://github.com/django/django/blob/5b644a5464e9612138dd7061abd386433bdc09f0/django%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/5b644a5464e9612138dd7061abd386433bdc09f0/django%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2F__init__.py?ref=5b644a5464e9612138dd7061abd386433bdc09f0",
            "patch": "@@ -1,53 +1,7 @@\n-import datetime\n-import os\n-import subprocess\n-\n-\n VERSION = (1, 5, 0, 'alpha', 0)\n \n-\n-def get_version(version=None):\n-    \"\"\"Derives a PEP386-compliant version number from VERSION.\"\"\"\n-    if version is None:\n-        version = VERSION\n-    assert len(version) == 5\n-    assert version[3] in ('alpha', 'beta', 'rc', 'final')\n-\n-    # Now build the two parts of the version number:\n-    # main = X.Y[.Z]\n-    # sub = .devN - for pre-alpha releases\n-    #     | {a|b|c}N - for alpha, beta and rc releases\n-\n-    parts = 2 if version[2] == 0 else 3\n-    main = '.'.join(str(x) for x in version[:parts])\n-\n-    sub = ''\n-    if version[3] == 'alpha' and version[4] == 0:\n-        git_changeset = get_git_changeset()\n-        if git_changeset:\n-            sub = '.dev%s' % git_changeset\n-\n-    elif version[3] != 'final':\n-        mapping = {'alpha': 'a', 'beta': 'b', 'rc': 'c'}\n-        sub = mapping[version[3]] + str(version[4])\n-\n-    return main + sub\n-\n-\n-def get_git_changeset():\n-    \"\"\"Returns a numeric identifier of the latest git changeset.\n-\n-    The result is the UTC timestamp of the changeset in YYYYMMDDHHMMSS format.\n-    This value isn't guaranteed to be unique but collisions are very unlikely,\n-    so it's sufficient for generating the development version numbers.\n-    \"\"\"\n-    repo_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n-    git_show = subprocess.Popen('git show --pretty=format:%ct --quiet HEAD',\n-            stdout=subprocess.PIPE, stderr=subprocess.PIPE,\n-            shell=True, cwd=repo_dir, universal_newlines=True)\n-    timestamp = git_show.communicate()[0].partition('\\n')[0]\n-    try:\n-        timestamp = datetime.datetime.utcfromtimestamp(int(timestamp))\n-    except ValueError:\n-        return None\n-    return timestamp.strftime('%Y%m%d%H%M%S')\n+def get_version(*args, **kwargs):\n+    # Don't litter django/__init__.py with all the get_version stuff.\n+    # Only import if it's actually called.\n+    from django.utils.version import get_version\n+    return get_version(*args, **kwargs)"
        },
        {
            "sha": "3f108b8af29255a8a0cce01741ba2520af71ffab",
            "filename": "django/utils/version.py",
            "status": "added",
            "additions": 49,
            "deletions": 0,
            "changes": 49,
            "blob_url": "https://github.com/django/django/blob/5b644a5464e9612138dd7061abd386433bdc09f0/django%2Futils%2Fversion.py",
            "raw_url": "https://github.com/django/django/raw/5b644a5464e9612138dd7061abd386433bdc09f0/django%2Futils%2Fversion.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Fversion.py?ref=5b644a5464e9612138dd7061abd386433bdc09f0",
            "patch": "@@ -0,0 +1,49 @@\n+import datetime\n+import os\n+import subprocess\n+\n+def get_version(version=None):\n+    \"Returns a PEP 386-compliant version number from VERSION.\"\n+    if version is None:\n+        from django import VERSION as version\n+    else:\n+        assert len(version) == 5\n+        assert version[3] in ('alpha', 'beta', 'rc', 'final')\n+\n+    # Now build the two parts of the version number:\n+    # main = X.Y[.Z]\n+    # sub = .devN - for pre-alpha releases\n+    #     | {a|b|c}N - for alpha, beta and rc releases\n+\n+    parts = 2 if version[2] == 0 else 3\n+    main = '.'.join(str(x) for x in version[:parts])\n+\n+    sub = ''\n+    if version[3] == 'alpha' and version[4] == 0:\n+        git_changeset = get_git_changeset()\n+        if git_changeset:\n+            sub = '.dev%s' % git_changeset\n+\n+    elif version[3] != 'final':\n+        mapping = {'alpha': 'a', 'beta': 'b', 'rc': 'c'}\n+        sub = mapping[version[3]] + str(version[4])\n+\n+    return main + sub\n+\n+def get_git_changeset():\n+    \"\"\"Returns a numeric identifier of the latest git changeset.\n+\n+    The result is the UTC timestamp of the changeset in YYYYMMDDHHMMSS format.\n+    This value isn't guaranteed to be unique, but collisions are very unlikely,\n+    so it's sufficient for generating the development version numbers.\n+    \"\"\"\n+    repo_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\n+    git_show = subprocess.Popen('git show --pretty=format:%ct --quiet HEAD',\n+            stdout=subprocess.PIPE, stderr=subprocess.PIPE,\n+            shell=True, cwd=repo_dir, universal_newlines=True)\n+    timestamp = git_show.communicate()[0].partition('\\n')[0]\n+    try:\n+        timestamp = datetime.datetime.utcfromtimestamp(int(timestamp))\n+    except ValueError:\n+        return None\n+    return timestamp.strftime('%Y%m%d%H%M%S')"
        }
    ],
    "stats": {
        "total": 105,
        "additions": 54,
        "deletions": 51
    }
}