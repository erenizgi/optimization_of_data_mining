{
    "author": "claudep",
    "message": "Fixed #18039 -- Changed geometry transform without a SRID raise a GEOSException.\n\nThis was planned in the official deprecation timeline for 1.5.\n\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17903 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "844e56e21aa45a4bf1c549129e46f7d7959c74d8",
    "files": [
        {
            "sha": "f411d5a3535458a178f48af04b872908cf468894",
            "filename": "django/contrib/gis/geos/geometry.py",
            "status": "modified",
            "additions": 1,
            "deletions": 6,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/844e56e21aa45a4bf1c549129e46f7d7959c74d8/django%2Fcontrib%2Fgis%2Fgeos%2Fgeometry.py",
            "raw_url": "https://github.com/django/django/raw/844e56e21aa45a4bf1c549129e46f7d7959c74d8/django%2Fcontrib%2Fgis%2Fgeos%2Fgeometry.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgeos%2Fgeometry.py?ref=844e56e21aa45a4bf1c549129e46f7d7959c74d8",
            "patch": "@@ -3,7 +3,6 @@\n  inherit from this object.\n \"\"\"\n # Python, ctypes and types dependencies.\n-import warnings\n from ctypes import addressof, byref, c_double\n \n # super-class for mutable list behavior\n@@ -507,11 +506,7 @@ def transform(self, ct, clone=False):\n                 return\n \n         if (srid is None) or (srid < 0):\n-            warnings.warn(\"Calling transform() with no SRID set does no transformation!\",\n-                          stacklevel=2)\n-            warnings.warn(\"Calling transform() with no SRID will raise GEOSException in v1.5\",\n-                          FutureWarning, stacklevel=2)\n-            return\n+            raise GEOSException(\"Calling transform() with no SRID set is not supported\")\n \n         if not gdal.HAS_GDAL:\n             raise GEOSException(\"GDAL library is not available to transform() geometry.\")"
        },
        {
            "sha": "a6b50df6354c39a95394bb5dbb2a439c3579c98d",
            "filename": "django/contrib/gis/geos/tests/test_geos.py",
            "status": "modified",
            "additions": 9,
            "deletions": 53,
            "changes": 62,
            "blob_url": "https://github.com/django/django/blob/844e56e21aa45a4bf1c549129e46f7d7959c74d8/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos.py",
            "raw_url": "https://github.com/django/django/raw/844e56e21aa45a4bf1c549129e46f7d7959c74d8/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Fgeos%2Ftests%2Ftest_geos.py?ref=844e56e21aa45a4bf1c549129e46f7d7959c74d8",
            "patch": "@@ -891,63 +891,19 @@ def test23_transform_noop(self):\n             gdal.HAS_GDAL = old_has_gdal\n \n     def test23_transform_nosrid(self):\n-        \"\"\" Testing `transform` method (no SRID) \"\"\"\n-        # Raise a warning if SRID <0/None.\n-        import warnings\n-        print \"\\nBEGIN - expecting Warnings; safe to ignore.\\n\"\n+        \"\"\" Testing `transform` method (no SRID or negative SRID) \"\"\"\n \n-        # Test for do-nothing behavior.\n-        try:\n-            # Keeping line-noise down by only printing the relevant\n-            # warnings once.\n-            warnings.simplefilter('once', UserWarning)\n-            warnings.simplefilter('once', FutureWarning)\n-\n-            g = GEOSGeometry('POINT (-104.609 38.255)', srid=None)\n-            g.transform(2774)\n-            self.assertEqual(g.tuple, (-104.609, 38.255))\n-            self.assertEqual(g.srid, None)\n-\n-            g = GEOSGeometry('POINT (-104.609 38.255)', srid=None)\n-            g1 = g.transform(2774, clone=True)\n-            self.assertTrue(g1 is None)\n-\n-            g = GEOSGeometry('POINT (-104.609 38.255)', srid=-1)\n-            g.transform(2774)\n-            self.assertEqual(g.tuple, (-104.609, 38.255))\n-            self.assertEqual(g.srid, -1)\n-\n-            g = GEOSGeometry('POINT (-104.609 38.255)', srid=-1)\n-            g1 = g.transform(2774, clone=True)\n-            self.assertTrue(g1 is None)\n-\n-        finally:\n-            warnings.simplefilter('default', UserWarning)\n-            warnings.simplefilter('default', FutureWarning)\n+        g = GEOSGeometry('POINT (-104.609 38.255)', srid=None)\n+        self.assertRaises(GEOSException, g.transform, 2774)\n \n-        print \"\\nEND - expecting Warnings; safe to ignore.\\n\"\n+        g = GEOSGeometry('POINT (-104.609 38.255)', srid=None)\n+        self.assertRaises(GEOSException, g.transform, 2774, clone=True)\n \n+        g = GEOSGeometry('POINT (-104.609 38.255)', srid=-1)\n+        self.assertRaises(GEOSException, g.transform, 2774)\n \n-        # test warning is raised\n-        try:\n-            warnings.simplefilter('error', FutureWarning)\n-            warnings.simplefilter('ignore', UserWarning)\n-\n-            g = GEOSGeometry('POINT (-104.609 38.255)', srid=None)\n-            self.assertRaises(FutureWarning, g.transform, 2774)\n-\n-            g = GEOSGeometry('POINT (-104.609 38.255)', srid=None)\n-            self.assertRaises(FutureWarning, g.transform, 2774, clone=True)\n-\n-            g = GEOSGeometry('POINT (-104.609 38.255)', srid=-1)\n-            self.assertRaises(FutureWarning, g.transform, 2774)\n-\n-            g = GEOSGeometry('POINT (-104.609 38.255)', srid=-1)\n-            self.assertRaises(FutureWarning, g.transform, 2774, clone=True)\n-        finally:\n-            warnings.simplefilter('default', FutureWarning)\n-            warnings.simplefilter('default', UserWarning)\n-\n+        g = GEOSGeometry('POINT (-104.609 38.255)', srid=-1)\n+        self.assertRaises(GEOSException, g.transform, 2774, clone=True)\n \n     def test23_transform_nogdal(self):\n         \"\"\" Testing `transform` method (GDAL not available) \"\"\""
        },
        {
            "sha": "9fceda32d0639f01cea262a8fbbd3bf147f74a62",
            "filename": "docs/ref/contrib/gis/geos.txt",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/844e56e21aa45a4bf1c549129e46f7d7959c74d8/docs%2Fref%2Fcontrib%2Fgis%2Fgeos.txt",
            "raw_url": "https://github.com/django/django/raw/844e56e21aa45a4bf1c549129e46f7d7959c74d8/docs%2Fref%2Fcontrib%2Fgis%2Fgeos.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fgis%2Fgeos.txt?ref=844e56e21aa45a4bf1c549129e46f7d7959c74d8",
            "patch": "@@ -542,9 +542,8 @@ is returned instead.\n    Prior to 1.3, this method would silently no-op if GDAL was not available.\n    Now, a :class:`~django.contrib.gis.geos.GEOSException` is raised as\n    application code relying on this behavior is in error. In addition,\n-   use of this method when the SRID is ``None`` or less than 0 now generates\n-   a warning because a :class:`~django.contrib.gis.geos.GEOSException` will\n-   be raised instead in version 1.5.\n+   use of this method when the SRID is ``None`` or less than 0 now also generates\n+   a :class:`~django.contrib.gis.geos.GEOSException`.\n \n \n ``Point``"
        }
    ],
    "stats": {
        "total": 74,
        "additions": 12,
        "deletions": 62
    }
}