{
    "author": "claudep",
    "message": "[py3] Used six.StringIO to simulate stdout buffer in tests",
    "sha": "3eb28d011927a657cad1bf4463611a72c6bb1325",
    "files": [
        {
            "sha": "e1fc68743e31634ab598702f93e610f71f38afb5",
            "filename": "tests/modeltests/invalid_models/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/3eb28d011927a657cad1bf4463611a72c6bb1325/tests%2Fmodeltests%2Finvalid_models%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/3eb28d011927a657cad1bf4463611a72c6bb1325/tests%2Fmodeltests%2Finvalid_models%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Finvalid_models%2Ftests.py?ref=3eb28d011927a657cad1bf4463611a72c6bb1325",
            "patch": "@@ -1,11 +1,11 @@\n import copy\n import sys\n-from io import BytesIO\n \n from django.core.management.validation import get_validation_errors\n from django.db.models.loading import cache, load_app\n \n from django.utils import unittest\n+from django.utils.six import StringIO\n \n \n class InvalidModelTestCase(unittest.TestCase):\n@@ -16,7 +16,7 @@ def setUp(self):\n         # coloring attached (makes matching the results easier). We restore\n         # sys.stderr afterwards.\n         self.old_stdout = sys.stdout\n-        self.stdout = BytesIO()\n+        self.stdout = StringIO()\n         sys.stdout = self.stdout\n \n         # This test adds dummy applications to the app cache. These"
        },
        {
            "sha": "41be31ccd7dc61ce16d56e33c7887038866cc138",
            "filename": "tests/regressiontests/fixtures_regress/tests.py",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/3eb28d011927a657cad1bf4463611a72c6bb1325/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/3eb28d011927a657cad1bf4463611a72c6bb1325/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py?ref=3eb28d011927a657cad1bf4463611a72c6bb1325",
            "patch": "@@ -4,7 +4,6 @@\n \n import os\n import re\n-from io import BytesIO\n \n from django.core import management\n from django.core.management.base import CommandError\n@@ -14,6 +13,7 @@\n from django.test import (TestCase, TransactionTestCase, skipIfDBFeature,\n     skipUnlessDBFeature)\n from django.test.utils import override_settings\n+from django.utils.six import StringIO\n \n from .models import (Animal, Stuff, Absolute, Parent, Child, Article, Widget,\n     Store, Person, Book, NKChild, RefToNKChild, Circle1, Circle2, Circle3,\n@@ -276,7 +276,7 @@ def test_dumpdata_uses_default_manager(self):\n         )\n         animal.save()\n \n-        stdout = BytesIO()\n+        stdout = StringIO()\n         management.call_command(\n             'dumpdata',\n             'fixtures_regress.animal',\n@@ -305,7 +305,7 @@ def test_proxy_model_included(self):\n         \"\"\"\n         Regression for #11428 - Proxy models aren't included when you dumpdata\n         \"\"\"\n-        stdout = BytesIO()\n+        stdout = StringIO()\n         # Create an instance of the concrete class\n         widget = Widget.objects.create(name='grommet')\n         management.call_command(\n@@ -380,7 +380,7 @@ def test_loaddata_no_fixture_specified(self):\n             )\n \n     def test_loaddata_not_existant_fixture_file(self):\n-        stdout_output = BytesIO()\n+        stdout_output = StringIO()\n         management.call_command(\n             'loaddata',\n             'this_fixture_doesnt_exist',\n@@ -465,7 +465,7 @@ def test_nk_on_serialize(self):\n             commit=False\n             )\n \n-        stdout = BytesIO()\n+        stdout = StringIO()\n         management.call_command(\n             'dumpdata',\n             'fixtures_regress.book',"
        },
        {
            "sha": "458c194f891c4c67a65873e27c6f2f9cd96d5471",
            "filename": "tests/regressiontests/m2m_through_regress/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 5,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/3eb28d011927a657cad1bf4463611a72c6bb1325/tests%2Fregressiontests%2Fm2m_through_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/3eb28d011927a657cad1bf4463611a72c6bb1325/tests%2Fregressiontests%2Fm2m_through_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fm2m_through_regress%2Ftests.py?ref=3eb28d011927a657cad1bf4463611a72c6bb1325",
            "patch": "@@ -1,10 +1,9 @@\n from __future__ import absolute_import\n \n-from io import BytesIO\n-\n from django.core import management\n from django.contrib.auth.models import User\n from django.test import TestCase\n+from django.utils.six import StringIO\n \n from .models import (Person, Group, Membership, UserMembership, Car, Driver,\n     CarDriver)\n@@ -70,11 +69,11 @@ def test_serialization(self):\n \n         pks = {\"p_pk\": p.pk, \"g_pk\": g.pk, \"m_pk\": m.pk}\n \n-        out = BytesIO()\n+        out = StringIO()\n         management.call_command(\"dumpdata\", \"m2m_through_regress\", format=\"json\", stdout=out)\n         self.assertEqual(out.getvalue().strip(), \"\"\"[{\"pk\": %(m_pk)s, \"model\": \"m2m_through_regress.membership\", \"fields\": {\"person\": %(p_pk)s, \"price\": 100, \"group\": %(g_pk)s}}, {\"pk\": %(p_pk)s, \"model\": \"m2m_through_regress.person\", \"fields\": {\"name\": \"Bob\"}}, {\"pk\": %(g_pk)s, \"model\": \"m2m_through_regress.group\", \"fields\": {\"name\": \"Roll\"}}]\"\"\" % pks)\n \n-        out = BytesIO()\n+        out = StringIO()\n         management.call_command(\"dumpdata\", \"m2m_through_regress\", format=\"xml\",\n             indent=2, stdout=out)\n         self.assertEqual(out.getvalue().strip(), \"\"\"\n@@ -142,6 +141,6 @@ class ThroughLoadDataTestCase(TestCase):\n \n     def test_sequence_creation(self):\n         \"Check that sequences on an m2m_through are created for the through model, not a phantom auto-generated m2m table. Refs #11107\"\n-        out = BytesIO()\n+        out = StringIO()\n         management.call_command(\"dumpdata\", \"m2m_through_regress\", format=\"json\", stdout=out)\n         self.assertEqual(out.getvalue().strip(), \"\"\"[{\"pk\": 1, \"model\": \"m2m_through_regress.usermembership\", \"fields\": {\"price\": 100, \"group\": 1, \"user\": 1}}, {\"pk\": 1, \"model\": \"m2m_through_regress.person\", \"fields\": {\"name\": \"Guido\"}}, {\"pk\": 1, \"model\": \"m2m_through_regress.group\", \"fields\": {\"name\": \"Python Core Group\"}}]\"\"\")"
        },
        {
            "sha": "d68f211535294cbac89e5537ca00aa29db156f47",
            "filename": "tests/regressiontests/staticfiles_tests/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 3,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/3eb28d011927a657cad1bf4463611a72c6bb1325/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/3eb28d011927a657cad1bf4463611a72c6bb1325/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py?ref=3eb28d011927a657cad1bf4463611a72c6bb1325",
            "patch": "@@ -7,7 +7,6 @@\n import shutil\n import sys\n import tempfile\n-from io import BytesIO\n \n from django.template import loader, Context\n from django.conf import settings\n@@ -194,7 +193,7 @@ class TestFindStatic(CollectionTestCase, TestDefaults):\n     Test ``findstatic`` management command.\n     \"\"\"\n     def _get_file(self, filepath):\n-        out = BytesIO()\n+        out = six.StringIO()\n         call_command('findstatic', filepath, all=False, verbosity=0, stdout=out)\n         out.seek(0)\n         lines = [l.strip() for l in out.readlines()]\n@@ -206,7 +205,7 @@ def test_all_files(self):\n         \"\"\"\n         Test that findstatic returns all candidate files if run without --first.\n         \"\"\"\n-        out = BytesIO()\n+        out = six.StringIO()\n         call_command('findstatic', 'test/file.txt', verbosity=0, stdout=out)\n         out.seek(0)\n         lines = [l.strip() for l in out.readlines()]"
        }
    ],
    "stats": {
        "total": 28,
        "additions": 13,
        "deletions": 15
    }
}