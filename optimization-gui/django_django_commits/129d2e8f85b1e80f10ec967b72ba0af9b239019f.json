{
    "author": "honzakral",
    "message": "Merge pull request #775 from HiddenData/ticket-18899\n\nFixed #18899 -- FileSystemStorage.save should support any file-like objects",
    "sha": "129d2e8f85b1e80f10ec967b72ba0af9b239019f",
    "files": [
        {
            "sha": "89caf3675de440706715e5ac0f187126fa04ee05",
            "filename": "django/core/files/storage.py",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/129d2e8f85b1e80f10ec967b72ba0af9b239019f/django%2Fcore%2Ffiles%2Fstorage.py",
            "raw_url": "https://github.com/django/django/raw/129d2e8f85b1e80f10ec967b72ba0af9b239019f/django%2Fcore%2Ffiles%2Fstorage.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Ffiles%2Fstorage.py?ref=129d2e8f85b1e80f10ec967b72ba0af9b239019f",
            "patch": "@@ -37,13 +37,17 @@ def open(self, name, mode='rb'):\n \n     def save(self, name, content):\n         \"\"\"\n-        Saves new content to the file specified by name. The content should be a\n-        proper File object, ready to be read from the beginning.\n+        Saves new content to the file specified by name. The content should be\n+        a proper File object or any python file-like object, ready to be read\n+        from the beginning.\n         \"\"\"\n         # Get the proper name for the file, as it will actually be saved.\n         if name is None:\n             name = content.name\n \n+        if not hasattr(content, 'chunks'):\n+            content = File(content)\n+\n         name = self.get_available_name(name)\n         name = self._save(name, content)\n "
        },
        {
            "sha": "8fbdbb8ff3c3601c48456d52e6d574739e52873e",
            "filename": "tests/modeltests/files/tests.py",
            "status": "modified",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/129d2e8f85b1e80f10ec967b72ba0af9b239019f/tests%2Fmodeltests%2Ffiles%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/129d2e8f85b1e80f10ec967b72ba0af9b239019f/tests%2Fmodeltests%2Ffiles%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Ffiles%2Ftests.py?ref=129d2e8f85b1e80f10ec967b72ba0af9b239019f",
            "patch": "@@ -2,6 +2,7 @@\n \n import gzip\n import shutil\n+import StringIO\n import tempfile\n \n from django.core.cache import cache\n@@ -102,6 +103,35 @@ def test_files(self):\n         obj4.random.save(\"random_file\", ContentFile(\"random content\"))\n         self.assertTrue(obj4.random.name.endswith(\"/random_file\"))\n \n+    def test_file_object(self):\n+        # Create sample file\n+        temp_storage.save('tests/example.txt', ContentFile('some content'))\n+\n+        # Load it as python file object\n+        file_obj = open(temp_storage.path('tests/example.txt'))\n+\n+        # Save it using storage and read its content\n+        temp_storage.save('tests/file_obj', file_obj)\n+        self.assertTrue(temp_storage.exists('tests/file_obj'))\n+        self.assertEqual(\n+            temp_storage.open('tests/file_obj').read(),\n+            'some content')\n+\n+\n+    def test_stringio(self):\n+        # Test passing StringIO instance as content argument to save\n+        output = StringIO.StringIO()\n+        output.write('content')\n+        output.seek(0)\n+\n+        # Save it and read written file\n+        temp_storage.save('tests/stringio', output)\n+        self.assertTrue(temp_storage.exists('tests/stringio'))\n+        self.assertEqual(\n+            temp_storage.open('tests/stringio').read(),\n+            'content')\n+\n+\n \n class FileTests(unittest.TestCase):\n     def test_context_manager(self):"
        }
    ],
    "stats": {
        "total": 38,
        "additions": 36,
        "deletions": 2
    }
}