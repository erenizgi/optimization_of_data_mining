{
    "author": "akaariai",
    "message": "Avoided having an indexed TextField installed unless using postgres\n\nAn index on TextField results in a warning message when running tests\non MySQL or SQLite, and the test using the TextField was PostgreSQL\nonly in any case.",
    "sha": "13a2b11425f87f674f0273af5fa70c1e4cf327ed",
    "files": [
        {
            "sha": "4ab74d25bd3d8091af6a91e9cae4096674031553",
            "filename": "tests/regressiontests/indexes/models.py",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/13a2b11425f87f674f0273af5fa70c1e4cf327ed/tests%2Fregressiontests%2Findexes%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/13a2b11425f87f674f0273af5fa70c1e4cf327ed/tests%2Fregressiontests%2Findexes%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Findexes%2Fmodels.py?ref=13a2b11425f87f674f0273af5fa70c1e4cf327ed",
            "patch": "@@ -1,3 +1,4 @@\n+from django.db import connection\n from django.db import models\n \n \n@@ -11,7 +12,9 @@ class Meta:\n         ]\n \n \n-class IndexedArticle(models.Model):\n-    headline = models.CharField(max_length=100, db_index=True)\n-    body = models.TextField(db_index=True)\n-    slug = models.CharField(max_length=40, unique=True, db_index=True)\n+# Indexing a TextField on Oracle or MySQL results in index creation error.\n+if connection.vendor == 'postgresql':\n+    class IndexedArticle(models.Model):\n+        headline = models.CharField(max_length=100, db_index=True)\n+        body = models.TextField(db_index=True)\n+        slug = models.CharField(max_length=40, unique=True, db_index=True)"
        },
        {
            "sha": "672e35d2862a1f3be39f09068aede25a010f04c9",
            "filename": "tests/regressiontests/indexes/tests.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/13a2b11425f87f674f0273af5fa70c1e4cf327ed/tests%2Fregressiontests%2Findexes%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/13a2b11425f87f674f0273af5fa70c1e4cf327ed/tests%2Fregressiontests%2Findexes%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Findexes%2Ftests.py?ref=13a2b11425f87f674f0273af5fa70c1e4cf327ed",
            "patch": "@@ -3,7 +3,7 @@\n from django.test import TestCase\n from django.utils.unittest import skipUnless\n \n-from .models import Article, IndexedArticle\n+from .models import Article\n \n \n class IndexesTests(TestCase):\n@@ -16,6 +16,7 @@ def test_index_together(self):\n         \"This is a postgresql-specific issue\")\n     def test_postgresql_text_indexes(self):\n         \"\"\"Test creation of PostgreSQL-specific text indexes (#12234)\"\"\"\n+        from .models import IndexedArticle\n         connection = connections[DEFAULT_DB_ALIAS]\n         index_sql = connection.creation.sql_indexes_for_model(IndexedArticle, no_style())\n         self.assertEqual(len(index_sql), 5)"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 9,
        "deletions": 5
    }
}