{
    "author": "claudep",
    "message": "Used call_command stdout parameter to capture output in staticfiles tests.",
    "sha": "a535040bfac30766cb475054dac5a6359073e48b",
    "files": [
        {
            "sha": "3711d92448c4ee4729db9e94da7db2fde6442658",
            "filename": "tests/regressiontests/staticfiles_tests/tests.py",
            "status": "modified",
            "additions": 11,
            "deletions": 19,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/a535040bfac30766cb475054dac5a6359073e48b/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a535040bfac30766cb475054dac5a6359073e48b/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fstaticfiles_tests%2Ftests.py?ref=a535040bfac30766cb475054dac5a6359073e48b",
            "patch": "@@ -6,7 +6,7 @@\n import shutil\n import sys\n import tempfile\n-from StringIO import StringIO\n+from io import BytesIO\n \n from django.template import loader, Context\n from django.conf import settings\n@@ -187,30 +187,22 @@ class TestFindStatic(CollectionTestCase, TestDefaults):\n     Test ``findstatic`` management command.\n     \"\"\"\n     def _get_file(self, filepath):\n-        _stdout = sys.stdout\n-        sys.stdout = StringIO()\n-        try:\n-            call_command('findstatic', filepath, all=False, verbosity='0')\n-            sys.stdout.seek(0)\n-            lines = [l.strip() for l in sys.stdout.readlines()]\n-            contents = codecs.open(\n-                smart_unicode(lines[1].strip()), \"r\", \"utf-8\").read()\n-        finally:\n-            sys.stdout = _stdout\n+        out = BytesIO()\n+        call_command('findstatic', filepath, all=False, verbosity=0, stdout=out)\n+        out.seek(0)\n+        lines = [l.strip() for l in out.readlines()]\n+        contents = codecs.open(\n+            smart_unicode(lines[1].strip()), \"r\", \"utf-8\").read()\n         return contents\n \n     def test_all_files(self):\n         \"\"\"\n         Test that findstatic returns all candidate files if run without --first.\n         \"\"\"\n-        _stdout = sys.stdout\n-        sys.stdout = StringIO()\n-        try:\n-            call_command('findstatic', 'test/file.txt', verbosity='0')\n-            sys.stdout.seek(0)\n-            lines = [l.strip() for l in sys.stdout.readlines()]\n-        finally:\n-            sys.stdout = _stdout\n+        out = BytesIO()\n+        call_command('findstatic', 'test/file.txt', verbosity=0, stdout=out)\n+        out.seek(0)\n+        lines = [l.strip() for l in out.readlines()]\n         self.assertEqual(len(lines), 3)  # three because there is also the \"Found <file> here\" line\n         self.assertIn('project', lines[1])\n         self.assertIn('apps', lines[2])"
        }
    ],
    "stats": {
        "total": 30,
        "additions": 11,
        "deletions": 19
    }
}