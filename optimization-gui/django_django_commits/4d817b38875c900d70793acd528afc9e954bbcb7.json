{
    "author": "seanbrant",
    "message": "Fixed #19262 -- Support cookie pickling in SimpleTemplateResponse\n\nRefs #15863.",
    "sha": "4d817b38875c900d70793acd528afc9e954bbcb7",
    "files": [
        {
            "sha": "3b3b41331a9905adc82dba5ca31b665abef27336",
            "filename": "django/template/response.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/4d817b38875c900d70793acd528afc9e954bbcb7/django%2Ftemplate%2Fresponse.py",
            "raw_url": "https://github.com/django/django/raw/4d817b38875c900d70793acd528afc9e954bbcb7/django%2Ftemplate%2Fresponse.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftemplate%2Fresponse.py?ref=4d817b38875c900d70793acd528afc9e954bbcb7",
            "patch": "@@ -40,7 +40,7 @@ def __getstate__(self):\n         rendered, and that the pickled state only includes rendered\n         data, not the data used to construct the response.\n         \"\"\"\n-        obj_dict = self.__dict__.copy()\n+        obj_dict = super(SimpleTemplateResponse, self).__getstate__()\n         if not self._is_rendered:\n             raise ContentNotRenderedError('The response content must be '\n                                           'rendered before it can be pickled.')"
        },
        {
            "sha": "a2a76a3310a04fe85d438cfe454deef758d381a3",
            "filename": "tests/regressiontests/templates/response.py",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/4d817b38875c900d70793acd528afc9e954bbcb7/tests%2Fregressiontests%2Ftemplates%2Fresponse.py",
            "raw_url": "https://github.com/django/django/raw/4d817b38875c900d70793acd528afc9e954bbcb7/tests%2Fregressiontests%2Ftemplates%2Fresponse.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftemplates%2Fresponse.py?ref=4d817b38875c900d70793acd528afc9e954bbcb7",
            "patch": "@@ -189,6 +189,21 @@ def test_repickling(self):\n         unpickled_response = pickle.loads(pickled_response)\n         repickled_response = pickle.dumps(unpickled_response)\n \n+    def test_pickling_cookie(self):\n+        response = SimpleTemplateResponse('first/test.html', {\n+                'value': 123,\n+                'fn': datetime.now,\n+            })\n+\n+        response.cookies['key'] = 'value'\n+\n+        response.render()\n+        pickled_response = pickle.dumps(response, pickle.HIGHEST_PROTOCOL)\n+        unpickled_response = pickle.loads(pickled_response)\n+\n+        self.assertEqual(unpickled_response.cookies['key'].value, 'value')\n+\n+\n @override_settings(\n     TEMPLATE_CONTEXT_PROCESSORS=[test_processor_name],\n     TEMPLATE_DIRS=(os.path.join(os.path.dirname(__file__),'templates')),"
        }
    ],
    "stats": {
        "total": 17,
        "additions": 16,
        "deletions": 1
    }
}