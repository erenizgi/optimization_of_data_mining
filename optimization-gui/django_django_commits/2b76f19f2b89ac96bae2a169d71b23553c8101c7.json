{
    "author": "biern",
    "message": "fixes #19263",
    "sha": "2b76f19f2b89ac96bae2a169d71b23553c8101c7",
    "files": [
        {
            "sha": "603ae3dfbe0b5897e5c36c70070f3bc331e00f9d",
            "filename": "django/db/models/sql/where.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/2b76f19f2b89ac96bae2a169d71b23553c8101c7/django%2Fdb%2Fmodels%2Fsql%2Fwhere.py",
            "raw_url": "https://github.com/django/django/raw/2b76f19f2b89ac96bae2a169d71b23553c8101c7/django%2Fdb%2Fmodels%2Fsql%2Fwhere.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fsql%2Fwhere.py?ref=2b76f19f2b89ac96bae2a169d71b23553c8101c7",
            "patch": "@@ -204,6 +204,10 @@ def make_atom(self, child, qn, connection):\n                 raise EmptyResultSet\n             if extra:\n                 return ('%s IN %s' % (field_sql, extra), params)\n+            if not params:\n+                # Empty params would generate invalid sql in subquery\n+                raise EmptyResultSet\n+\n             max_in_list_size = connection.ops.max_in_list_size()\n             if max_in_list_size and len(params) > max_in_list_size:\n                 # Break up the params list into an OR of manageable chunks."
        },
        {
            "sha": "c241c81fab6023b269651302c3642ac478fc9d3c",
            "filename": "tests/regressiontests/queries/tests.py",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/2b76f19f2b89ac96bae2a169d71b23553c8101c7/tests%2Fregressiontests%2Fqueries%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/2b76f19f2b89ac96bae2a169d71b23553c8101c7/tests%2Fregressiontests%2Fqueries%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fqueries%2Ftests.py?ref=2b76f19f2b89ac96bae2a169d71b23553c8101c7",
            "patch": "@@ -2021,6 +2021,9 @@ def setUp(self):\n         Article.objects.create(name='three', created=datetime.datetime.now())\n         Article.objects.create(name='four', created=datetime.datetime.now())\n \n+        food = Food.objects.create(name='spam')\n+        Eaten.objects.create(meal='spam with eggs', food=food)\n+\n     def test_tickets_7698_10202(self):\n         # People like to slice with '0' as the high-water mark.\n         self.assertQuerysetEqual(Article.objects.all()[0:0], [])\n@@ -2036,6 +2039,18 @@ def test_empty_resultset_sql(self):\n         # ticket #12192\n         self.assertNumQueries(0, lambda: list(Number.objects.all()[1:1]))\n \n+    def test_empty_sliced_subquery(self):\n+        # ticket #19263 - testing subqueries\n+        self.assertEqual(\n+            Eaten.objects.filter(food__in=Food.objects.all()[0:0]).count(),\n+            0)\n+\n+    def test_empty_sliced_subquery_exclude(self):\n+        # ticket #19263 - testing subqueries\n+        self.assertEqual(\n+            Eaten.objects.exclude(food__in=Food.objects.all()[0:0]).count(),\n+            1)\n+\n \n class EscapingTests(TestCase):\n     def test_ticket_7302(self):"
        }
    ],
    "stats": {
        "total": 19,
        "additions": 19,
        "deletions": 0
    }
}