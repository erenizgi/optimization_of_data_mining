{
    "author": "aaugustin",
    "message": "Merge pull request #218 from mgrouchy/ticket_18582\n\nFixed #18582 -- Added a no-op close to BaseCache",
    "sha": "4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78",
    "files": [
        {
            "sha": "7a04f1f243fd87ae806f8a19d1482d0fcd8340b3",
            "filename": "AUTHORS",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/AUTHORS",
            "raw_url": "https://github.com/django/django/raw/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/AUTHORS",
            "contents_url": "https://api.github.com/repos/django/django/contents/AUTHORS?ref=4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78",
            "patch": "@@ -231,6 +231,7 @@ answer newbie questions, and generally made Django that much better:\n     Simon Greenhill <dev@simon.net.nz>\n     Owen Griffiths\n     Espen Grindhaug <http://grindhaug.org/>\n+    Mike Grouchy <http://mikegrouchy.com/>\n     Janos Guljas\n     Thomas GÃ¼ttler <hv@tbz-pariv.de>\n     Horst Gutmann <zerok@zerokspot.com>"
        },
        {
            "sha": "562bcc21bb1e09527b8e465c91e7b827aa6f07f7",
            "filename": "django/core/cache/__init__.py",
            "status": "modified",
            "additions": 3,
            "deletions": 5,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/django%2Fcore%2Fcache%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/django%2Fcore%2Fcache%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fcache%2F__init__.py?ref=4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78",
            "patch": "@@ -134,11 +134,9 @@ def get_cache(backend, **kwargs):\n             \"Could not find backend '%s': %s\" % (backend, e))\n     cache = backend_cls(location, params)\n     # Some caches -- python-memcached in particular -- need to do a cleanup at the\n-    # end of a request cycle. If the cache provides a close() method, wire it up\n-    # here.\n-    if hasattr(cache, 'close'):\n-        signals.request_finished.connect(cache.close)\n+    # end of a request cycle. If not implemented in a particular backend\n+    # cache.close is a no-op\n+    signals.request_finished.connect(cache.close)\n     return cache\n \n cache = get_cache(DEFAULT_CACHE_ALIAS)\n-"
        },
        {
            "sha": "25fbbcbbdd68f08e00edda1d76d254168b4fc934",
            "filename": "django/core/cache/backends/base.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/django%2Fcore%2Fcache%2Fbackends%2Fbase.py",
            "raw_url": "https://github.com/django/django/raw/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/django%2Fcore%2Fcache%2Fbackends%2Fbase.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fcache%2Fbackends%2Fbase.py?ref=4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78",
            "patch": "@@ -6,15 +6,18 @@\n from django.core.exceptions import ImproperlyConfigured, DjangoRuntimeWarning\n from django.utils.importlib import import_module\n \n+\n class InvalidCacheBackendError(ImproperlyConfigured):\n     pass\n \n+\n class CacheKeyWarning(DjangoRuntimeWarning):\n     pass\n \n # Memcached does not accept keys longer than this.\n MEMCACHE_MAX_KEY_LENGTH = 250\n \n+\n def default_key_func(key, key_prefix, version):\n     \"\"\"\n     Default function to generate keys.\n@@ -25,6 +28,7 @@ def default_key_func(key, key_prefix, version):\n     \"\"\"\n     return ':'.join([key_prefix, str(version), key])\n \n+\n def get_key_func(key_func):\n     \"\"\"\n     Function to decide which key function to use.\n@@ -40,6 +44,7 @@ def get_key_func(key_func):\n             return getattr(key_func_module, key_func_name)\n     return default_key_func\n \n+\n class BaseCache(object):\n     def __init__(self, params):\n         timeout = params.get('timeout', params.get('TIMEOUT', 300))\n@@ -221,3 +226,7 @@ def decr_version(self, key, delta=1, version=None):\n         the new version.\n         \"\"\"\n         return self.incr_version(key, -delta, version)\n+\n+    def close(self, **kwargs):\n+        \"\"\"Close the cache connection\"\"\"\n+        pass"
        },
        {
            "sha": "a15cf583703e2412aedb703e7bbe19e0d89a1a82",
            "filename": "docs/topics/cache.txt",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/docs%2Ftopics%2Fcache.txt",
            "raw_url": "https://github.com/django/django/raw/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/docs%2Ftopics%2Fcache.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fcache.txt?ref=4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78",
            "patch": "@@ -785,6 +785,16 @@ nonexistent cache key.::\n     However, if the backend doesn't natively provide an increment/decrement\n     operation, it will be implemented using a two-step retrieve/update.\n \n+\n+You can close the connection to your cache with ``close()`` if implemented by\n+the cache backend.\n+\n+    >>> cache.close()\n+\n+.. note::\n+\n+    For caches that don't implement ``close`` methods it is a no-op.\n+\n .. _cache_key_prefixing:\n \n Cache key prefixing"
        },
        {
            "sha": "fc92ecf870a3782739e5e8c922a3a35dddbff9c8",
            "filename": "tests/regressiontests/cache/tests.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/tests%2Fregressiontests%2Fcache%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78/tests%2Fregressiontests%2Fcache%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fcache%2Ftests.py?ref=4c5cea70734fe8f4082c6a9bd8b26cf0a157ca78",
            "patch": "@@ -270,6 +270,10 @@ def test_decr(self):\n         self.assertEqual(self.cache.decr('answer', -10), 42)\n         self.assertRaises(ValueError, self.cache.decr, 'does_not_exist')\n \n+    def test_close(self):\n+        self.assertTrue(hasattr(self.cache, 'close'))\n+        self.cache.close()\n+\n     def test_data_types(self):\n         # Many different data types can be cached\n         stuff = {"
        }
    ],
    "stats": {
        "total": 32,
        "additions": 27,
        "deletions": 5
    }
}