{
    "author": "freakboy3742",
    "message": "Fixed #19368 -- Ensured that login error messages adapt to changes in the User model.\n\nThanks to un33k for the report.",
    "sha": "27f8129d64292868f6a328f7bf9a1bed67967ff3",
    "files": [
        {
            "sha": "1fabdce245cb5ee813dbdc3691c50edfd088516d",
            "filename": "django/contrib/admin/forms.py",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/27f8129d64292868f6a328f7bf9a1bed67967ff3/django%2Fcontrib%2Fadmin%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/27f8129d64292868f6a328f7bf9a1bed67967ff3/django%2Fcontrib%2Fadmin%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fforms.py?ref=27f8129d64292868f6a328f7bf9a1bed67967ff3",
            "patch": "@@ -6,8 +6,8 @@\n from django.contrib.auth.forms import AuthenticationForm\n from django.utils.translation import ugettext_lazy\n \n-ERROR_MESSAGE = ugettext_lazy(\"Please enter the correct username and password \"\n-        \"for a staff account. Note that both fields are case-sensitive.\")\n+ERROR_MESSAGE = ugettext_lazy(\"Please enter the correct %(username)s and password \"\n+        \"for a staff account. Note that both fields may be case-sensitive.\")\n \n \n class AdminAuthenticationForm(AuthenticationForm):\n@@ -26,8 +26,12 @@ def clean(self):\n         if username and password:\n             self.user_cache = authenticate(username=username, password=password)\n             if self.user_cache is None:\n-                raise forms.ValidationError(message)\n+                raise forms.ValidationError(message % {\n+                    'username': self.username_field.verbose_name\n+                })\n             elif not self.user_cache.is_active or not self.user_cache.is_staff:\n-                raise forms.ValidationError(message)\n+                raise forms.ValidationError(message % {\n+                    'username': self.username_field.verbose_name\n+                })\n         self.check_for_test_cookie()\n         return self.cleaned_data"
        },
        {
            "sha": "4e2f476cec8680feb400131ca4987e2d834b720f",
            "filename": "django/contrib/auth/forms.py",
            "status": "modified",
            "additions": 7,
            "deletions": 5,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/27f8129d64292868f6a328f7bf9a1bed67967ff3/django%2Fcontrib%2Fauth%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/27f8129d64292868f6a328f7bf9a1bed67967ff3/django%2Fcontrib%2Fauth%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fauth%2Fforms.py?ref=27f8129d64292868f6a328f7bf9a1bed67967ff3",
            "patch": "@@ -148,8 +148,8 @@ class AuthenticationForm(forms.Form):\n     password = forms.CharField(label=_(\"Password\"), widget=forms.PasswordInput)\n \n     error_messages = {\n-        'invalid_login': _(\"Please enter a correct username and password. \"\n-                           \"Note that both fields are case-sensitive.\"),\n+        'invalid_login': _(\"Please enter a correct %(username)s and password. \"\n+                           \"Note that both fields may be case-sensitive.\"),\n         'no_cookies': _(\"Your Web browser doesn't appear to have cookies \"\n                         \"enabled. Cookies are required for logging in.\"),\n         'inactive': _(\"This account is inactive.\"),\n@@ -168,8 +168,8 @@ def __init__(self, request=None, *args, **kwargs):\n \n         # Set the label for the \"username\" field.\n         UserModel = get_user_model()\n-        username_field = UserModel._meta.get_field(UserModel.USERNAME_FIELD)\n-        self.fields['username'].label = capfirst(username_field.verbose_name)\n+        self.username_field = UserModel._meta.get_field(UserModel.USERNAME_FIELD)\n+        self.fields['username'].label = capfirst(self.username_field.verbose_name)\n \n     def clean(self):\n         username = self.cleaned_data.get('username')\n@@ -180,7 +180,9 @@ def clean(self):\n                                            password=password)\n             if self.user_cache is None:\n                 raise forms.ValidationError(\n-                    self.error_messages['invalid_login'])\n+                    self.error_messages['invalid_login'] % {\n+                        'username': self.username_field.verbose_name\n+                    })\n             elif not self.user_cache.is_active:\n                 raise forms.ValidationError(self.error_messages['inactive'])\n         self.check_for_test_cookie()"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 15,
        "deletions": 9
    }
}