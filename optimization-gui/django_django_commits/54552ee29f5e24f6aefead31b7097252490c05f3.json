{
    "author": "jezdez",
    "message": "Fixed #16175 -- Modified the sitemaps views to return TemplateResponse instances for easier customization. Thanks, mat.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16476 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "54552ee29f5e24f6aefead31b7097252490c05f3",
    "files": [
        {
            "sha": "b117b33aabad6468b45fcf9f188a447100db271c",
            "filename": "django/contrib/sitemaps/views.py",
            "status": "modified",
            "additions": 7,
            "deletions": 8,
            "changes": 15,
            "blob_url": "https://github.com/django/django/blob/54552ee29f5e24f6aefead31b7097252490c05f3/django%2Fcontrib%2Fsitemaps%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/54552ee29f5e24f6aefead31b7097252490c05f3/django%2Fcontrib%2Fsitemaps%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsitemaps%2Fviews.py?ref=54552ee29f5e24f6aefead31b7097252490c05f3",
            "patch": "@@ -1,9 +1,10 @@\n-from django.http import HttpResponse, Http404\n-from django.template import loader\n-from django.contrib.sites.models import get_current_site\n from django.core import urlresolvers\n-from django.utils.encoding import smart_str\n from django.core.paginator import EmptyPage, PageNotAnInteger\n+from django.http import HttpResponse, Http404\n+from django.template.response import TemplateResponse\n+from django.utils.encoding import smart_str\n+\n+from django.contrib.sites.models import get_current_site\n \n def index(request, sitemaps,\n         template_name='sitemap_index.xml', mimetype='application/xml'):\n@@ -21,8 +22,7 @@ def index(request, sitemaps,\n         if pages > 1:\n             for page in range(2, pages+1):\n                 sites.append('%s://%s%s?p=%s' % (protocol, current_site.domain, sitemap_url, page))\n-    xml = loader.render_to_string(template_name, {'sitemaps': sites})\n-    return HttpResponse(xml, mimetype=mimetype)\n+    return TemplateResponse(request, template_name, {'sitemaps': sites}, mimetype=mimetype)\n \n def sitemap(request, sitemaps, section=None,\n         template_name='sitemap.xml', mimetype='application/xml'):\n@@ -44,5 +44,4 @@ def sitemap(request, sitemaps, section=None,\n             raise Http404(\"Page %s empty\" % page)\n         except PageNotAnInteger:\n             raise Http404(\"No page '%s'\" % page)\n-    xml = smart_str(loader.render_to_string(template_name, {'urlset': urls}))\n-    return HttpResponse(xml, mimetype=mimetype)\n+    return TemplateResponse(request, template_name, {'urlset': urls}, mimetype=mimetype)\n\\ No newline at end of file"
        },
        {
            "sha": "300c142f0b3efb4c3bc69bc65e6c491b62591ff2",
            "filename": "docs/ref/contrib/sitemaps.txt",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/54552ee29f5e24f6aefead31b7097252490c05f3/docs%2Fref%2Fcontrib%2Fsitemaps.txt",
            "raw_url": "https://github.com/django/django/raw/54552ee29f5e24f6aefead31b7097252490c05f3/docs%2Fref%2Fcontrib%2Fsitemaps.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fsitemaps.txt?ref=54552ee29f5e24f6aefead31b7097252490c05f3",
            "patch": "@@ -313,6 +313,15 @@ parameter to the ``sitemap`` and ``index`` views via the URLconf::\n         }),\n     )\n \n+\n+.. versionchanged:: 1.4\n+\n+    In addition, these views also return\n+    :class:`~django.template.response.TemplateResponse`\n+    instances which allow you to easily customize the response data before\n+    rendering. For more details, see the\n+    :doc:`TemplateResponse documentation </ref/template-response>`.\n+\n Context variables\n ------------------\n "
        }
    ],
    "stats": {
        "total": 24,
        "additions": 16,
        "deletions": 8
    }
}