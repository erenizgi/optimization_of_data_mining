{
    "author": "jezdez",
    "message": "Fixed #16497 -- Added new form and model fields to the Mexican local flavor. Many thanks to Andrés Torres Marroquín and Gerardo Orozco.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16572 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
    "files": [
        {
            "sha": "d751e48dbb6994323e6cf6f4f2182987006b67c1",
            "filename": "AUTHORS",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/AUTHORS",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/AUTHORS",
            "contents_url": "https://api.github.com/repos/django/django/contents/AUTHORS?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -340,6 +340,7 @@ answer newbie questions, and generally made Django that much better:\n     Nuno Mariz <nmariz@gmail.com>\n     mark@junklight.com\n     Orestis Markou <orestis@orestis.gr>\n+    Andrés Torres Marroquín <andres.torres.marroquin@gmail.com>\n     Takashi Matsuo <matsuo.takashi@gmail.com>\n     Zlatko Mašek <zlatko.masek@gmail.com>\n     Yasushi Masuda <whosaysni@gmail.com>\n@@ -380,6 +381,7 @@ answer newbie questions, and generally made Django that much better:\n     Neal Norwitz <nnorwitz@google.com>\n     Todd O'Bryan <toddobryan@mac.com>\n     Selwin Ong <selwin@ui.co.id>\n+    Gerardo Orozco <gerardo.orozco.mosqueda@gmail.com>\n     Christian Oudard <christian.oudard@gmail.com>\n     oggie rob <oz.robharvey@gmail.com>\n     oggy <ognjen.maric@gmail.com>"
        },
        {
            "sha": "95ca73d9016fc9c4a4d6f39aaedc57b3e4891fc1",
            "filename": "django/contrib/localflavor/mx/forms.py",
            "status": "modified",
            "additions": 213,
            "deletions": 2,
            "changes": 215,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/django%2Fcontrib%2Flocalflavor%2Fmx%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/django%2Fcontrib%2Flocalflavor%2Fmx%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Flocalflavor%2Fmx%2Fforms.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -1,14 +1,225 @@\n+# -*- coding: utf-8 -*-\n \"\"\"\n Mexican-specific form helpers.\n \"\"\"\n+import re\n \n-from django.forms.fields import Select\n+from django.forms import ValidationError\n+from django.forms.fields import Select, RegexField\n+from django.utils.translation import ugettext_lazy as _\n+from django.core.validators import EMPTY_VALUES\n+from django.contrib.localflavor.mx.mx_states import STATE_CHOICES\n+\n+DATE_RE = r'\\d{2}((01|03|05|07|08|10|12)(0[1-9]|[12]\\d|3[01])|02(0[1-9]|[12]\\d)|(04|06|09|11)(0[1-9]|[12]\\d|30))'\n+\n+\"\"\"\n+This is the list of inconvenient words according to the `Anexo IV` of the\n+document described in the next link:\n+    http://www.sisi.org.mx/jspsi/documentos/2005/seguimiento/06101/0610100162005_065.doc\n+\"\"\"\n+\n+RFC_INCONVENIENT_WORDS = [\n+    u'BUEI', u'BUEY', u'CACA', u'CACO', u'CAGA', u'CAGO', u'CAKA', u'CAKO',\n+    u'COGE', u'COJA', u'COJE', u'COJI', u'COJO', u'CULO', u'FETO', u'GUEY',\n+    u'JOTO', u'KACA', u'KACO', u'KAGA', u'KAGO', u'KOGE', u'KOJO', u'KAKA',\n+    u'KULO', u'MAME', u'MAMO', u'MEAR', u'MEAS', u'MEON', u'MION', u'MOCO',\n+    u'MULA', u'PEDA', u'PEDO', u'PENE', u'PUTA', u'PUTO', u'QULO', u'RATA',\n+    u'RUIN',\n+]\n+\n+\"\"\"\n+This is the list of inconvenient words according to the `Anexo 2` of the\n+document described in the next link:\n+    http://portal.veracruz.gob.mx/pls/portal/url/ITEM/444112558A57C6E0E040A8C02E00695C\n+\"\"\"\n+CURP_INCONVENIENT_WORDS = [\n+   u'BACA', u'BAKA', u'BUEI', u'BUEY', u'CACA', u'CACO', u'CAGA', u'CAGO',\n+   u'CAKA', u'CAKO', u'COGE', u'COGI', u'COJA', u'COJE', u'COJI', u'COJO',\n+   u'COLA', u'CULO', u'FALO', u'FETO', u'GETA', u'GUEI', u'GUEY', u'JETA',\n+   u'JOTO', u'KACA', u'KACO', u'KAGA', u'KAGO', u'KAKA', u'KAKO', u'KOGE',\n+   u'KOGI', u'KOJA', u'KOJE', u'KOJI', u'KOJO', u'KOLA', u'KULO', u'LILO',\n+   u'LOCA', u'LOCO', u'LOKA', u'LOKO', u'MAME', u'MAMO', u'MEAR', u'MEAS',\n+   u'MEON', u'MIAR', u'MION', u'MOCO', u'MOKO', u'MULA', u'MULO', u'NACA',\n+   u'NACO', u'PEDA', u'PEDO', u'PENE', u'PIPI', u'PITO', u'POPO', u'PUTA',\n+   u'PUTO', u'QULO', u'RATA', u'ROBA', u'ROBE', u'ROBO', u'RUIN', u'SENO',\n+   u'TETA', u'VACA', u'VAGA', u'VAGO', u'VAKA', u'VUEI', u'VUEY', u'WUEI',\n+   u'WUEY',\n+]\n \n class MXStateSelect(Select):\n     \"\"\"\n     A Select widget that uses a list of Mexican states as its choices.\n     \"\"\"\n     def __init__(self, attrs=None):\n-        from mx_states import STATE_CHOICES\n         super(MXStateSelect, self).__init__(attrs, choices=STATE_CHOICES)\n \n+\n+class MXZipCodeField(RegexField):\n+    \"\"\"\n+    A form field that accepts a Mexican Zip Code.\n+\n+    More info about this:\n+        http://en.wikipedia.org/wiki/List_of_postal_codes_in_Mexico\n+    \"\"\"\n+    default_error_messages = {\n+        'invalid': _(u'Enter a valid zip code in the format XXXXX.'),\n+    }\n+\n+    def __init__(self, *args, **kwargs):\n+        zip_code_re = ur'^(0[1-9]|[1][0-6]|[2-9]\\d)(\\d{3})$'\n+        super(MXZipCodeField, self).__init__(zip_code_re, *args, **kwargs)\n+\n+\n+class MXRFCField(RegexField):\n+    \"\"\"\n+    A form field that validates a Mexican *Registro Federal de Contribuyentes*\n+    for either `Persona física` or `Persona moral`.\n+\n+    The Persona física RFC string is integrated by a juxtaposition of\n+    characters following the next pattern:\n+\n+        =====  ======  ===========================================\n+        Index  Format  Accepted Characters\n+        =====  ======  ===========================================\n+        1      X       Any letter\n+        2      X       Any vowel\n+        3-4    XX      Any letter\n+        5-10   YYMMDD  Any valid date\n+        11-12  XX      Any letter or number between 0 and 9\n+        13     X       Any digit between 0 and 9 or the letter *A*\n+        =====  ======  ===========================================\n+\n+    The Persona moral RFC string is integrated by a juxtaposition of\n+    characters following the next pattern:\n+\n+        =====  ======  ============================================\n+        Index  Format  Accepted Characters\n+        =====  ======  ============================================\n+        1-3    XXX     Any letter including *&* and *Ñ* chars\n+        4-9    YYMMDD  Any valid date\n+        10-11  XX      Any letter or number between 0 and 9\n+        12     X       Any number between 0 and 9 or the letter *A*\n+        =====  ======  ============================================\n+\n+    More info about this:\n+        http://es.wikipedia.org/wiki/Registro_Federal_de_Contribuyentes_(M%C3%A9xico)\n+    \"\"\"\n+    default_error_messages = {\n+        'invalid': _('Enter a valid RFC.'),\n+        'invalid_checksum': _('Invalid checksum for RFC.'),\n+    }\n+\n+    def __init__(self, min_length=9, max_length=13, *args, **kwargs):\n+        rfc_re = re.compile(ur'^([A-Z&Ññ]{3}|[A-Z][AEIOU][A-Z]{2})%s([A-Z0-9]{2}[0-9A])?$' % DATE_RE,\n+                            re.IGNORECASE)\n+        super(MXRFCField, self).__init__(rfc_re, min_length=min_length,\n+                                         max_length=max_length, *args, **kwargs)\n+\n+    def clean(self, value):\n+        value = super(MXRFCField, self).clean(value)\n+        if value in EMPTY_VALUES:\n+            return u''\n+        value = value.upper()\n+        if self._has_homoclave(value):\n+            if not value[-1] == self._checksum(value[:-1]):\n+                raise ValidationError(self.default_error_messages['invalid_checksum'])\n+        if self._has_inconvenient_word(value):\n+            raise ValidationError(self.default_error_messages['invalid'])\n+        return value\n+\n+    def _has_homoclave(self, rfc):\n+        \"\"\"\n+        This check is done due to the existance of RFCs without a *homoclave*\n+        since the current algorithm to calculate it had not been created for\n+        the first RFCs ever in Mexico.\n+        \"\"\"\n+        rfc_without_homoclave_re = re.compile(ur'^[A-Z&Ññ]{3,4}%s$' % DATE_RE,\n+                                              re.IGNORECASE)\n+        return not rfc_without_homoclave_re.match(rfc)\n+\n+    def _checksum(self, rfc):\n+        \"\"\"\n+        More info about this procedure:\n+            www.sisi.org.mx/jspsi/documentos/2005/seguimiento/06101/0610100162005_065.doc\n+        \"\"\"\n+        chars = u'0123456789ABCDEFGHIJKLMN&OPQRSTUVWXYZ-Ñ'\n+        if len(rfc) is 11:\n+            rfc = '-' + rfc\n+\n+        sum_ = sum(i * chars.index(c) for i, c in zip(reversed(xrange(14)), rfc))\n+        checksum = 11 - sum_ % 11\n+\n+        if checksum == 10:\n+            return u'A'\n+        elif checksum == 11:\n+            return u'0'\n+\n+        return unicode(checksum)\n+\n+    def _has_inconvenient_word(self, rfc):\n+        first_four = rfc[:4]\n+        return first_four in RFC_INCONVENIENT_WORDS\n+\n+\n+class MXCURPField(RegexField):\n+    \"\"\"\n+    A field that validates a Mexican Clave Única de Registro de Población.\n+\n+    The CURP is integrated by a juxtaposition of characters following the next\n+    pattern:\n+\n+        =====  ======  ===================================================\n+        Index  Format  Accepted Characters\n+        =====  ======  ===================================================\n+        1      X       Any letter\n+        2      X       Any vowel\n+        3-4    XX      Any letter\n+        5-10   YYMMDD  Any valid date\n+        11     X       Either `H` or `M`, depending on the person's gender\n+        12-13  XX      Any valid acronym for a state in Mexico\n+        14-16  XXX     Any consonant\n+        17     X       Any number between 0 and 9 or any letter\n+        18     X       Any number between 0 and 9\n+        =====  ======  ===================================================\n+\n+    More info about this:\n+        http://www.condusef.gob.mx/index.php/clave-unica-de-registro-de-poblacion-curp\n+    \"\"\"\n+    default_error_messages = {\n+        'invalid': _('Enter a valid CURP.'),\n+        'invalid_checksum': _(u'Invalid checksum for CURP.'),\n+    }\n+\n+    def __init__(self, min_length=18, max_length=18, *args, **kwargs):\n+        states_re = r'(AS|BC|BS|CC|CL|CM|CS|CH|DF|DG|GT|GR|HG|JC|MC|MN|MS|NT|NL|OC|PL|QT|QR|SP|SL|SR|TC|TS|TL|VZ|YN|ZS|NE)'\n+        consonants_re = r'[B-DF-HJ-NP-TV-Z]'\n+        curp_re = (ur'^[A-Z][AEIOU][A-Z]{2}%s[HM]%s%s{3}[0-9A-Z]\\d$' %\n+                   (DATE_RE, states_re, consonants_re))\n+        curp_re = re.compile(curp_re, re.IGNORECASE)\n+        super(MXCURPField, self).__init__(curp_re, min_length=min_length,\n+                                          max_length=max_length, *args, **kwargs)\n+\n+    def clean(self, value):\n+        value = super(MXCURPField, self).clean(value)\n+        if value in EMPTY_VALUES:\n+            return u''\n+        value = value.upper()\n+        if value[-1] != self._checksum(value[:-1]):\n+            raise ValidationError(self.default_error_messages['invalid_checksum'])\n+        if self._has_inconvenient_word(value):\n+            raise ValidationError(self.default_error_messages['invalid'])\n+        return value\n+\n+    def _checksum(self, value):\n+        chars = u'0123456789ABCDEFGHIJKLMN&OPQRSTUVWXYZ'\n+\n+        s = sum(i * chars.index(c) for i, c in zip(reversed(xrange(19)), value))\n+        checksum = 10 - s % 10\n+\n+        if checksum == 10:\n+            return u'0'\n+        return unicode(checksum)\n+\n+    def _has_inconvenient_word(self, curp):\n+        first_four = curp[:4]\n+        return first_four in CURP_INCONVENIENT_WORDS"
        },
        {
            "sha": "3ef8d5fb03a268970d59061613b9f9e2bacd9391",
            "filename": "django/contrib/localflavor/mx/models.py",
            "status": "added",
            "additions": 70,
            "deletions": 0,
            "changes": 70,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/django%2Fcontrib%2Flocalflavor%2Fmx%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/django%2Fcontrib%2Flocalflavor%2Fmx%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Flocalflavor%2Fmx%2Fmodels.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -0,0 +1,70 @@\n+from django.utils.translation import ugettext_lazy as _\n+from django.db.models.fields import CharField\n+\n+from django.contrib.localflavor.mx.mx_states import STATE_CHOICES\n+from django.contrib.localflavor.mx.forms import (MXRFCField as MXRFCFormField,\n+    MXZipCodeField as MXZipCodeFormField, MXCURPField as MXCURPFormField)\n+\n+\n+class MXStateField(CharField):\n+    \"\"\"\n+    A model field that stores the three-letter Mexican state abbreviation in the\n+    database.\n+    \"\"\"\n+    description = _(\"Mexico state (three uppercase letters)\")\n+\n+    def __init__(self, *args, **kwargs):\n+        kwargs['choices'] = STATE_CHOICES\n+        kwargs['max_length'] = 3\n+        super(MXStateField, self).__init__(*args, **kwargs)\n+\n+\n+class MXZipCodeField(CharField):\n+    \"\"\"\n+    A model field that forms represent as a forms.MXZipCodeField field and\n+    stores the five-digit Mexican zip code.\n+    \"\"\"\n+    description = _(\"Mexico zip code\")\n+\n+    def __init__(self, *args, **kwargs):\n+        kwargs['max_length'] = 5\n+        super(MXZipCodeField, self).__init__(*args, **kwargs)\n+\n+    def formfield(self, **kwargs):\n+        defaults = {'form_class': MXZipCodeFormField}\n+        defaults.update(kwargs)\n+        return super(MXZipCodeField, self).formfield(**defaults)\n+\n+\n+class MXRFCField(CharField):\n+    \"\"\"\n+    A model field that forms represent as a forms.MXRFCField field and\n+    stores the value of a valid Mexican RFC.\n+    \"\"\"\n+    description = _(\"Mexican RFC\")\n+\n+    def __init__(self, *args, **kwargs):\n+        kwargs['max_length'] = 13\n+        super(MXRFCField, self).__init__(*args, **kwargs)\n+\n+    def formfield(self, **kwargs):\n+        defaults = {'form_class': MXRFCFormField}\n+        defaults.update(kwargs)\n+        return super(MXRFCField, self).formfield(**defaults)\n+\n+\n+class MXCURPField(CharField):\n+    \"\"\"\n+    A model field that forms represent as a forms.MXCURPField field and\n+    stores the value of a valid Mexican CURP.\n+    \"\"\"\n+    description = _(\"Mexican CURP\")\n+\n+    def __init__(self, *args, **kwargs):\n+        kwargs['max_length'] = 18\n+        super(MXCURPField, self).__init__(*args, **kwargs)\n+\n+    def formfield(self, **kwargs):\n+        defaults = {'form_class': MXCURPFormField}\n+        defaults.update(kwargs)\n+        return super(MXCURPField, self).formfield(**defaults)\n\\ No newline at end of file"
        },
        {
            "sha": "2aba63ef2611a5b39b1b4be1c35bfb6d7d0cb8cb",
            "filename": "django/contrib/localflavor/mx/mx_states.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/django%2Fcontrib%2Flocalflavor%2Fmx%2Fmx_states.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/django%2Fcontrib%2Flocalflavor%2Fmx%2Fmx_states.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Flocalflavor%2Fmx%2Fmx_states.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -8,6 +8,7 @@\n \n from django.utils.translation import ugettext_lazy as _\n \n+# All 31 states, plus the `Distrito Federal`.\n STATE_CHOICES = (\n     ('AGU', _(u'Aguascalientes')),\n     ('BCN', _(u'Baja California')),\n@@ -42,4 +43,3 @@\n     ('YUC', _(u'Yucatán')),\n     ('ZAC', _(u'Zacatecas')),\n )\n-"
        },
        {
            "sha": "bd38adc6934eb3e80a59e6b653f99b0ba219b1a0",
            "filename": "docs/ref/contrib/localflavor.txt",
            "status": "modified",
            "additions": 69,
            "deletions": 0,
            "changes": 69,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/docs%2Fref%2Fcontrib%2Flocalflavor.txt",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/docs%2Fref%2Fcontrib%2Flocalflavor.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Flocalflavor.txt?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -798,10 +798,79 @@ Macedonia (``mk``)\n Mexico (``mx``)\n ===============\n \n+.. class:: mx.forms.MXZipCodeField\n+\n+    .. versionadded:: 1.4\n+\n+    A form field that accepts a Mexican Zip Code.\n+\n+    More info about this: List of postal codes in Mexico (zipcodes_)\n+\n+.. _zipcodes: http://en.wikipedia.org/wiki/List_of_postal_codes_in_Mexico\n+\n+.. class:: mx.forms.MXRFCField\n+\n+    .. versionadded:: 1.4\n+\n+    A form field that validates a Mexican *Registro Federal de Contribuyentes* for\n+    either **Persona física** or **Persona moral**. This field accepts RFC strings\n+    whether or not it contains a *homoclave*.\n+\n+    More info about this: Registro Federal de Contribuyentes (rfc_)\n+\n+.. _rfc: http://es.wikipedia.org/wiki/Registro_Federal_de_Contribuyentes_(M%C3%A9xico)\n+\n+.. class:: mx.forms.MXCURPField\n+\n+    .. versionadded:: 1.4\n+\n+   A field that validates a Mexican *Clave Única de Registro de Población*.\n+\n+   More info about this: Clave Unica de Registro de Poblacion (curp_)\n+\n+.. _curp: http://www.condusef.gob.mx/index.php/clave-unica-de-registro-de-poblacion-curp\n+\n .. class:: mx.forms.MXStateSelect\n \n     A ``Select`` widget that uses a list of Mexican states as its choices.\n \n+.. class:: mx.models.MXStateField\n+\n+    .. versionadded:: 1.4\n+\n+    A model field that stores the three-letter Mexican state abbreviation in the\n+    database.\n+\n+.. class:: mx.models.MXZipCodeField\n+\n+    .. versionadded:: 1.4\n+\n+    A model field that forms represent as a ``forms.MXZipCodeField`` field and\n+    stores the five-digit Mexican zip code.\n+\n+.. class:: mx.models.MXRFCField\n+\n+    .. versionadded:: 1.4\n+\n+    A model field that forms represent as a ``forms.MXRFCField`` field and\n+    stores the value of a valid Mexican RFC.\n+\n+.. class:: mx.models.MXCURPField\n+\n+    .. versionadded:: 1.4\n+\n+    A model field that forms represent as a ``forms.MXCURPField`` field and\n+    stores the value of a valid Mexican CURP.\n+\n+Additionally, a choice tuple is provided in ``django.contrib.localflavor.mx.mx_states``,\n+allowing customized model and form fields, and form presentations, for subsets of\n+Mexican states abbreviations:\n+\n+.. data:: mx.mx_states.STATE_CHOICES\n+\n+    A tuple of choices of the states abbreviations for all 31 Mexican states,\n+    plus the `Distrito Federal`.\n+\n Norway (``no``)\n ===============\n "
        },
        {
            "sha": "1ffc11c834333306fe9d65ce153849ba2cd19460",
            "filename": "tests/regressiontests/forms/localflavor/mx.py",
            "status": "added",
            "additions": 127,
            "deletions": 0,
            "changes": 127,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fmx.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fmx.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavor%2Fmx.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -0,0 +1,127 @@\n+# -*- coding: utf-8 -*-\n+from django.contrib.localflavor.mx.forms import (MXZipCodeField, MXRFCField,\n+    MXStateSelect, MXCURPField)\n+\n+from utils import LocalFlavorTestCase\n+\n+\n+class MXLocalFlavorTests(LocalFlavorTestCase):\n+    def test_MXStateSelect(self):\n+        f = MXStateSelect()\n+        out = u'''<select name=\"state\">\n+<option value=\"AGU\">Aguascalientes</option>\n+<option value=\"BCN\">Baja California</option>\n+<option value=\"BCS\">Baja California Sur</option>\n+<option value=\"CAM\">Campeche</option>\n+<option value=\"CHH\">Chihuahua</option>\n+<option value=\"CHP\">Chiapas</option>\n+<option value=\"COA\">Coahuila</option>\n+<option value=\"COL\">Colima</option>\n+<option value=\"DIF\">Distrito Federal</option>\n+<option value=\"DUR\">Durango</option>\n+<option value=\"GRO\">Guerrero</option>\n+<option value=\"GUA\">Guanajuato</option>\n+<option value=\"HID\">Hidalgo</option>\n+<option value=\"JAL\">Jalisco</option>\n+<option value=\"MEX\">Estado de México</option>\n+<option value=\"MIC\" selected=\"selected\">Michoacán</option>\n+<option value=\"MOR\">Morelos</option>\n+<option value=\"NAY\">Nayarit</option>\n+<option value=\"NLE\">Nuevo León</option>\n+<option value=\"OAX\">Oaxaca</option>\n+<option value=\"PUE\">Puebla</option>\n+<option value=\"QUE\">Querétaro</option>\n+<option value=\"ROO\">Quintana Roo</option>\n+<option value=\"SIN\">Sinaloa</option>\n+<option value=\"SLP\">San Luis Potosí</option>\n+<option value=\"SON\">Sonora</option>\n+<option value=\"TAB\">Tabasco</option>\n+<option value=\"TAM\">Tamaulipas</option>\n+<option value=\"TLA\">Tlaxcala</option>\n+<option value=\"VER\">Veracruz</option>\n+<option value=\"YUC\">Yucatán</option>\n+<option value=\"ZAC\">Zacatecas</option>\n+</select>'''\n+        self.assertEqual(f.render('state', 'MIC'), out)\n+\n+    def test_MXZipCodeField(self):\n+        error_format = [u'Enter a valid zip code in the format XXXXX.']\n+        valid = {\n+            '58120': u'58120',\n+            '58502': u'58502',\n+            '59310': u'59310',\n+            '99999': u'99999',\n+        }\n+        invalid = {\n+            '17000': error_format,\n+            '18000': error_format,\n+            '19000': error_format,\n+            '00000': error_format,\n+        }\n+        self.assertFieldOutput(MXZipCodeField, valid, invalid)\n+\n+    def test_MXRFCField(self):\n+        error_format = [u'Enter a valid RFC.']\n+        error_checksum = [u'Invalid checksum for RFC.']\n+        valid = {\n+            'MoFN641205eX5': u'MOFN641205EX5',\n+            'ICa060120873': u'ICA060120873',\n+            'eUcG751104rT0': u'EUCG751104RT0',\n+            'GME08100195A': u'GME08100195A',\n+            'AA&060524KX5': u'AA&060524KX5',\n+            'CAÑ0708045P7': u'CAÑ0708045P7',\n+            'aaa000101aa9': u'AAA000101AA9',\n+        }\n+        invalid = {\n+            'MED0000000XA': error_format,\n+            '0000000000XA': error_format,\n+            'AAA000000AA6': error_format,\n+            # Dates\n+            'XXX880002XXX': error_format,\n+            'XXX880200XXX': error_format,\n+            'XXX880132XXX': error_format,\n+            'XXX880230XXX': error_format,\n+            'XXX880431XXX': error_format,\n+            # Incorrect checksum\n+            'MOGR650524E73': error_checksum,\n+            'HVA7810058F1': error_checksum,\n+            'MoFN641205eX2': error_checksum,\n+            'ICa060120871': error_checksum,\n+            'eUcG751104rT7': error_checksum,\n+            'GME081001955': error_checksum,\n+            'AA&060524KX9': error_checksum,\n+            'CAÑ0708045P2': error_checksum,\n+        }\n+        self.assertFieldOutput(MXRFCField, valid, invalid)\n+\n+    def test_MXCURPField(self):\n+        error_format = [u'Enter a valid CURP.']\n+        error_checksum = [u'Invalid checksum for CURP.']\n+        valid = {\n+            'AaMG890608HDFLJL00': u'AAMG890608HDFLJL00',\n+            'BAAd890419HMNRRV07': u'BAAD890419HMNRRV07',\n+            'VIAA900930MMNClL08': u'VIAA900930MMNCLL08',\n+            'HEGR891009HMNRRD09': u'HEGR891009HMNRRD09',\n+            'MARR890512HMNRMN09': u'MARR890512HMNRMN09',\n+            'MESJ890928HMNZNS00': u'MESJ890928HMNZNS00',\n+            'BAAA890317HDFRLL03': u'BAAA890317HDFRLL03',\n+            'TOMA880125HMNRRNO2': u'TOMA880125HMNRRNO2',\n+            'OOMG890727HMNRSR06': u'OOMG890727HMNRSR06',\n+            'AAAA000101HDFCCC09': u'AAAA000101HDFCCC09',\n+        }\n+        invalid = {\n+            'AAAA000000HDFCCC09': error_format,\n+            'AAAA000000HDFAAA03': error_format,\n+            'AAAA000000HXXCCC08': error_format,\n+            'AAAA000000XMNCCC02': error_format,\n+            'HEGR891009HMNRRD0A': error_format,\n+            'MARR890512HMNRMN0A': error_format,\n+            'AaMG890608HDFLJL01': error_checksum,\n+            'BAAd890419HMNRRV08': error_checksum,\n+            'VIAA900930MMNClL09': error_checksum,\n+            'MESJ890928HMNZNS01': error_checksum,\n+            'BAAA890317HDFRLL04': error_checksum,\n+            'TOMA880125HMNRRNO3': error_checksum,\n+            'OOMG890727HMNRSR07': error_checksum,\n+        }\n+        self.assertFieldOutput(MXCURPField, valid, invalid)"
        },
        {
            "sha": "a4db3dba9822f77e082853014ee467bce222a891",
            "filename": "tests/regressiontests/forms/localflavortests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Flocalflavortests.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -27,6 +27,7 @@\n from localflavor.jp import JPLocalFlavorTests\n from localflavor.kw import KWLocalFlavorTests\n from localflavor.mk import MKLocalFlavorTests\n+from localflavor.mx import MXLocalFlavorTests\n from localflavor.nl import NLLocalFlavorTests\n from localflavor.pl import PLLocalFlavorTests\n from localflavor.pt import PTLocalFlavorTests"
        },
        {
            "sha": "f63818d5783138c8e7ddf4b9e4b67c07bc18ef39",
            "filename": "tests/regressiontests/forms/tests/__init__.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fforms%2Ftests%2F__init__.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -40,6 +40,7 @@\n     JPLocalFlavorTests,\n     KWLocalFlavorTests,\n     MKLocalFlavorTests,\n+    MXLocalFlavorTests,\n     NLLocalFlavorTests,\n     PLLocalFlavorTests,\n     PTLocalFlavorTests,"
        },
        {
            "sha": "244f396b52a362f47f2125355a4f7268f4b9d926",
            "filename": "tests/regressiontests/localflavor/mk/models.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmk%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmk%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fmk%2Fmodels.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -8,7 +8,7 @@ class MKPerson(models.Model):\n     umcn = UMCNField()\n     id_number = MKIdentityCardNumberField()\n     municipality  = MKMunicipalityField(blank = True)\n-    municipality_req = MKMunicipalityField(blank = False) \n+    municipality_req = MKMunicipalityField(blank = False)\n \n     class Meta:\n         app_label = 'localflavor'"
        },
        {
            "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
            "filename": "tests/regressiontests/localflavor/mx/__init__.py",
            "status": "added",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmx%2F__init__.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmx%2F__init__.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fmx%2F__init__.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d"
        },
        {
            "sha": "2669cd9ace1ef94b1729dcf46c682c9cb41323a2",
            "filename": "tests/regressiontests/localflavor/mx/forms.py",
            "status": "added",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Fforms.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -0,0 +1,7 @@\n+from django.forms import ModelForm\n+from models import MXPersonProfile\n+\n+class MXPersonProfileForm(ModelForm):\n+\n+    class Meta:\n+        model = MXPersonProfile"
        },
        {
            "sha": "9c32cf5cabe0233ba9598b33fc8127daddb9cbd5",
            "filename": "tests/regressiontests/localflavor/mx/models.py",
            "status": "added",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Fmodels.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -0,0 +1,12 @@\n+from django.db import models\n+from django.contrib.localflavor.mx.models import (\n+    MXStateField, MXRFCField, MXCURPField, MXZipCodeField)\n+\n+class MXPersonProfile(models.Model):\n+    state = MXStateField()\n+    rfc = MXRFCField()\n+    curp = MXCURPField()\n+    zip_code = MXZipCodeField()\n+\n+    class Meta:\n+        app_label = 'localflavor'"
        },
        {
            "sha": "40da38a97cb8c373de954c53634cc4042fd5c792",
            "filename": "tests/regressiontests/localflavor/mx/tests.py",
            "status": "added",
            "additions": 71,
            "deletions": 0,
            "changes": 71,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fmx%2Ftests.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -0,0 +1,71 @@\n+# -*- coding: utf-8 -*-\n+from django.test import TestCase\n+from forms import MXPersonProfileForm\n+\n+class MXLocalFlavorTests(TestCase):\n+    def setUp(self):\n+        self.form = MXPersonProfileForm({\n+            'state': 'MIC',\n+            'rfc': 'toma880125kv3',\n+            'curp': 'toma880125hmnrrn02',\n+            'zip_code': '58120',\n+        })\n+\n+    def test_get_display_methods(self):\n+        \"\"\"Test that the get_*_display() methods are added to the model instances.\"\"\"\n+        place = self.form.save()\n+        self.assertEqual(place.get_state_display(), u'Michoacán')\n+\n+    def test_errors(self):\n+        \"\"\"Test that required MXFields throw appropriate errors.\"\"\"\n+        form = MXPersonProfileForm({\n+            'state': 'Invalid state',\n+            'rfc': 'invalid rfc',\n+            'curp': 'invalid curp',\n+            'zip_code': 'xxx',\n+        })\n+        self.assertFalse(form.is_valid())\n+        self.assertEqual(form.errors['state'], [u'Select a valid choice. Invalid state is not one of the available choices.'])\n+        self.assertEqual(form.errors['rfc'], [u'Enter a valid RFC.'])\n+        self.assertEqual(form.errors['curp'], [u'Ensure this value has at least 18 characters (it has 12).', u'Enter a valid CURP.'])\n+        self.assertEqual(form.errors['zip_code'], [u'Enter a valid zip code in the format XXXXX.'])\n+\n+    def test_field_blank_option(self):\n+        \"\"\"Test that the empty option is there.\"\"\"\n+        state_select_html = \"\"\"\\\n+<select name=\"state\" id=\"id_state\">\n+<option value=\"\">---------</option>\n+<option value=\"AGU\">Aguascalientes</option>\n+<option value=\"BCN\">Baja California</option>\n+<option value=\"BCS\">Baja California Sur</option>\n+<option value=\"CAM\">Campeche</option>\n+<option value=\"CHH\">Chihuahua</option>\n+<option value=\"CHP\">Chiapas</option>\n+<option value=\"COA\">Coahuila</option>\n+<option value=\"COL\">Colima</option>\n+<option value=\"DIF\">Distrito Federal</option>\n+<option value=\"DUR\">Durango</option>\n+<option value=\"GRO\">Guerrero</option>\n+<option value=\"GUA\">Guanajuato</option>\n+<option value=\"HID\">Hidalgo</option>\n+<option value=\"JAL\">Jalisco</option>\n+<option value=\"MEX\">Estado de México</option>\n+<option value=\"MIC\" selected=\"selected\">Michoacán</option>\n+<option value=\"MOR\">Morelos</option>\n+<option value=\"NAY\">Nayarit</option>\n+<option value=\"NLE\">Nuevo León</option>\n+<option value=\"OAX\">Oaxaca</option>\n+<option value=\"PUE\">Puebla</option>\n+<option value=\"QUE\">Querétaro</option>\n+<option value=\"ROO\">Quintana Roo</option>\n+<option value=\"SIN\">Sinaloa</option>\n+<option value=\"SLP\">San Luis Potosí</option>\n+<option value=\"SON\">Sonora</option>\n+<option value=\"TAB\">Tabasco</option>\n+<option value=\"TAM\">Tamaulipas</option>\n+<option value=\"TLA\">Tlaxcala</option>\n+<option value=\"VER\">Veracruz</option>\n+<option value=\"YUC\">Yucatán</option>\n+<option value=\"ZAC\">Zacatecas</option>\n+</select>\"\"\"\n+        self.assertEqual(str(self.form['state']), state_select_html)"
        },
        {
            "sha": "95a5f9912893237f786cbfb14f4ce6d747793a87",
            "filename": "tests/regressiontests/localflavor/tests.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Ftests.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -1,4 +1,5 @@\n from au.tests import *\n from mk.tests import *\n+from mx.tests import *\n from us.tests import *\n "
        },
        {
            "sha": "7730662f8ce59704f07b983dff8538140da42318",
            "filename": "tests/regressiontests/localflavor/us/forms.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fus%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fus%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fus%2Fforms.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -2,6 +2,6 @@\n from models import USPlace\n \n class USPlaceForm(ModelForm):\n-    \"\"\"docstring for PlaceForm\"\"\"\n+\n     class Meta:\n         model = USPlace"
        },
        {
            "sha": "4095f73532936bb7d9a280c58b9f5f1e504348ab",
            "filename": "tests/regressiontests/localflavor/us/models.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fus%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d/tests%2Fregressiontests%2Flocalflavor%2Fus%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Flocalflavor%2Fus%2Fmodels.py?ref=0fbadfd1c8ce30fd4c9f2857d467047d5bfac63d",
            "patch": "@@ -11,5 +11,6 @@ class USPlace(models.Model):\n     state_default = USStateField(default=\"CA\", blank=True)\n     postal_code = USPostalCodeField(blank=True)\n     name = models.CharField(max_length=20)\n+\n     class Meta:\n         app_label = 'localflavor'"
        }
    ],
    "stats": {
        "total": 583,
        "additions": 578,
        "deletions": 5
    }
}