{
    "author": "akaariai",
    "message": "Stylistic cleanup of Postgres autocommit tests\n\nCleaned up tests introduced in f572ee0c65ec5eac9edb0cb3e35c96ec86d89ffb.\n\nThanks to Claude Paroz for suggesting the changes.",
    "sha": "925a6936b94c74b2e67d90da1fcf2e19efc335cf",
    "files": [
        {
            "sha": "90b3df03d42b8359520c311c8b7e08499c3efdc2",
            "filename": "tests/regressiontests/transactions_regress/tests.py",
            "status": "modified",
            "additions": 5,
            "deletions": 8,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/925a6936b94c74b2e67d90da1fcf2e19efc335cf/tests%2Fregressiontests%2Ftransactions_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/925a6936b94c74b2e67d90da1fcf2e19efc335cf/tests%2Fregressiontests%2Ftransactions_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ftransactions_regress%2Ftests.py?ref=925a6936b94c74b2e67d90da1fcf2e19efc335cf",
            "patch": "@@ -175,6 +175,8 @@ def test_failing_query_transaction_closed_debug(self):\n         self.test_failing_query_transaction_closed()\n \n \n+@skipUnless(connection.vendor == 'postgresql',\n+            \"This test only valid for PostgreSQL\")\n class TestPostgresAutocommit(TransactionTestCase):\n     \"\"\"\n     Tests to make sure psycopg2's autocommit mode is restored after entering\n@@ -196,6 +198,9 @@ def setUp(self):\n         new_backend = self._old_backend.__class__(settings, DEFAULT_DB_ALIAS)\n         connections[DEFAULT_DB_ALIAS] = new_backend\n \n+    def tearDown(self):\n+        connections[DEFAULT_DB_ALIAS] = self._old_backend\n+\n     def test_initial_autocommit_state(self):\n         self.assertTrue(connection.features.uses_autocommit)\n         self.assertEqual(connection.isolation_level, self._autocommit)\n@@ -222,14 +227,6 @@ def test_transaction_stacking(self):\n         transaction.leave_transaction_management()\n         self.assertEqual(connection.isolation_level, self._autocommit)\n \n-    def tearDown(self):\n-        connections[DEFAULT_DB_ALIAS] = self._old_backend\n-\n-TestPostgresAutocommit = skipUnless(connection.vendor == 'postgresql',\n-    \"This test only valid for PostgreSQL\")(TestPostgresAutocommit)\n-TestPostgresAutoCommit = skipUnlessDBFeature('supports_transactions')(\n-    TestPostgresAutocommit)\n-\n \n class TestManyToManyAddTransaction(TransactionTestCase):\n     def test_manyrelated_add_commit(self):"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 5,
        "deletions": 8
    }
}