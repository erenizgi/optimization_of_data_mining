{
    "author": "aaugustin",
    "message": "Fixed #19456 -- Avoid infinite recursion when tracing LazyObject.__init__.\n\nThanks blaze33 for the patch.",
    "sha": "9dc5702932a0031bc4fb5473f2cdccffc61dbe30",
    "files": [
        {
            "sha": "13aec9cb82263ccfb6e5f076f4cf2e9cf894fe3d",
            "filename": "django/utils/functional.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/9dc5702932a0031bc4fb5473f2cdccffc61dbe30/django%2Futils%2Ffunctional.py",
            "raw_url": "https://github.com/django/django/raw/9dc5702932a0031bc4fb5473f2cdccffc61dbe30/django%2Futils%2Ffunctional.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ffunctional.py?ref=9dc5702932a0031bc4fb5473f2cdccffc61dbe30",
            "patch": "@@ -222,6 +222,10 @@ class LazyObject(object):\n     By subclassing, you have the opportunity to intercept and alter the\n     instantiation. If you don't need to do that, use SimpleLazyObject.\n     \"\"\"\n+\n+    # Avoid infinite recursion when tracing __init__ (#19456).\n+    _wrapped = None\n+\n     def __init__(self):\n         self._wrapped = empty\n "
        },
        {
            "sha": "883e60aa8182afa02aa5e638c1075beac9b09388",
            "filename": "tests/utils_tests/simplelazyobject.py",
            "status": "modified",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/9dc5702932a0031bc4fb5473f2cdccffc61dbe30/tests%2Futils_tests%2Fsimplelazyobject.py",
            "raw_url": "https://github.com/django/django/raw/9dc5702932a0031bc4fb5473f2cdccffc61dbe30/tests%2Futils_tests%2Fsimplelazyobject.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Futils_tests%2Fsimplelazyobject.py?ref=9dc5702932a0031bc4fb5473f2cdccffc61dbe30",
            "patch": "@@ -2,6 +2,7 @@\n \n import copy\n import pickle\n+import sys\n \n from django.utils import six\n from django.utils.unittest import TestCase\n@@ -138,3 +139,16 @@ def test_dict(self):\n         del lazydict['one']\n         with self.assertRaises(KeyError):\n             lazydict['one']\n+\n+    def test_trace(self):\n+        # See ticket #19456\n+        old_trace_func = sys.gettrace()\n+        try:\n+            def trace_func(frame, event, arg):\n+                frame.f_locals['self'].__class__\n+                if old_trace_func is not None:\n+                    old_trace_func(frame, event, arg)\n+            sys.settrace(trace_func)\n+            SimpleLazyObject(None)\n+        finally:\n+            sys.settrace(old_trace_func)"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 18,
        "deletions": 0
    }
}