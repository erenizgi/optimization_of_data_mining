{
    "author": "aaugustin",
    "message": "Fixed #15808 -- Added optional HttpOnly flag to the CSRF Cookie.\n\nThanks Samuel Lavitt for the report and Sascha Peilicke for the patch.",
    "sha": "720888a14699a80a6cd07d32514b9dcd5b1005fb",
    "files": [
        {
            "sha": "6a01493a72efb41f93b9665be0a48bde47f72162",
            "filename": "django/conf/global_settings.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/720888a14699a80a6cd07d32514b9dcd5b1005fb/django%2Fconf%2Fglobal_settings.py",
            "raw_url": "https://github.com/django/django/raw/720888a14699a80a6cd07d32514b9dcd5b1005fb/django%2Fconf%2Fglobal_settings.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fconf%2Fglobal_settings.py?ref=720888a14699a80a6cd07d32514b9dcd5b1005fb",
            "patch": "@@ -529,6 +529,7 @@\n CSRF_COOKIE_DOMAIN = None\n CSRF_COOKIE_PATH = '/'\n CSRF_COOKIE_SECURE = False\n+CSRF_COOKIE_HTTPONLY = False\n \n ############\n # MESSAGES #"
        },
        {
            "sha": "423034478b4cb00bd4a882395e6fc486b38d6d17",
            "filename": "django/middleware/csrf.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/720888a14699a80a6cd07d32514b9dcd5b1005fb/django%2Fmiddleware%2Fcsrf.py",
            "raw_url": "https://github.com/django/django/raw/720888a14699a80a6cd07d32514b9dcd5b1005fb/django%2Fmiddleware%2Fcsrf.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fmiddleware%2Fcsrf.py?ref=720888a14699a80a6cd07d32514b9dcd5b1005fb",
            "patch": "@@ -210,7 +210,8 @@ def process_response(self, request, response):\n                             max_age = 60 * 60 * 24 * 7 * 52,\n                             domain=settings.CSRF_COOKIE_DOMAIN,\n                             path=settings.CSRF_COOKIE_PATH,\n-                            secure=settings.CSRF_COOKIE_SECURE\n+                            secure=settings.CSRF_COOKIE_SECURE,\n+                            httponly=settings.CSRF_COOKIE_HTTPONLY\n                             )\n         # Content varies with the CSRF cookie, so set the Vary header.\n         patch_vary_headers(response, ('Cookie',))"
        },
        {
            "sha": "14522d8dbcb0679ec60ef72042fda1aff2975e74",
            "filename": "docs/ref/contrib/csrf.txt",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/720888a14699a80a6cd07d32514b9dcd5b1005fb/docs%2Fref%2Fcontrib%2Fcsrf.txt",
            "raw_url": "https://github.com/django/django/raw/720888a14699a80a6cd07d32514b9dcd5b1005fb/docs%2Fref%2Fcontrib%2Fcsrf.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fcontrib%2Fcsrf.txt?ref=720888a14699a80a6cd07d32514b9dcd5b1005fb",
            "patch": "@@ -491,6 +491,7 @@ Settings\n A number of settings can be used to control Django's CSRF behavior:\n \n * :setting:`CSRF_COOKIE_DOMAIN`\n+* :setting:`CSRF_COOKIE_HTTPONLY`\n * :setting:`CSRF_COOKIE_NAME`\n * :setting:`CSRF_COOKIE_PATH`\n * :setting:`CSRF_COOKIE_SECURE`"
        },
        {
            "sha": "9a615b2d999eeb626cf94d594e097b822bf88d16",
            "filename": "docs/ref/settings.txt",
            "status": "modified",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/django/django/blob/720888a14699a80a6cd07d32514b9dcd5b1005fb/docs%2Fref%2Fsettings.txt",
            "raw_url": "https://github.com/django/django/raw/720888a14699a80a6cd07d32514b9dcd5b1005fb/docs%2Fref%2Fsettings.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fsettings.txt?ref=720888a14699a80a6cd07d32514b9dcd5b1005fb",
            "patch": "@@ -281,6 +281,19 @@ Please note that the presence of this setting does not imply that Django's CSRF\n protection is safe from cross-subdomain attacks by default - please see the\n :ref:`CSRF limitations <csrf-limitations>` section.\n \n+.. setting:: CSRF_COOKIE_HTTPONLY\n+\n+CSRF_COOKIE_HTTPONLY\n+--------------------\n+\n+.. versionadded:: 1.6\n+\n+Default: ``False``\n+\n+Whether to use HttpOnly flag on the CSRF cookie. If this is set to ``True``,\n+client-side JavaScript will not to be able to access the CSRF cookie. See\n+:setting:`SESSION_COOKIE_HTTPONLY` for details on HttpOnly.\n+\n .. setting:: CSRF_COOKIE_NAME\n \n CSRF_COOKIE_NAME"
        },
        {
            "sha": "f53fa8ac4c13fb9fef3ddaa223e56ee7b5af5c75",
            "filename": "docs/releases/1.6.txt",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/720888a14699a80a6cd07d32514b9dcd5b1005fb/docs%2Freleases%2F1.6.txt",
            "raw_url": "https://github.com/django/django/raw/720888a14699a80a6cd07d32514b9dcd5b1005fb/docs%2Freleases%2F1.6.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Freleases%2F1.6.txt?ref=720888a14699a80a6cd07d32514b9dcd5b1005fb",
            "patch": "@@ -36,6 +36,9 @@ Minor features\n * Authentication backends can raise ``PermissionDenied`` to immediately fail\n   the authentication chain.\n \n+* The HttpOnly flag can be set on the CSRF cookie with\n+  :setting:`CSRF_COOKIE_HTTPONLY`.\n+\n * The ``assertQuerysetEqual()`` now checks for undefined order and raises\n   ``ValueError`` if undefined order is spotted. The order is seen as\n   undefined if the given ``QuerySet`` isn't ordered and there are more than"
        },
        {
            "sha": "37191089629909b7688d3f87fb071aac7d5a4f6f",
            "filename": "tests/regressiontests/csrf_tests/tests.py",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/720888a14699a80a6cd07d32514b9dcd5b1005fb/tests%2Fregressiontests%2Fcsrf_tests%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/720888a14699a80a6cd07d32514b9dcd5b1005fb/tests%2Fregressiontests%2Fcsrf_tests%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fcsrf_tests%2Ftests.py?ref=720888a14699a80a6cd07d32514b9dcd5b1005fb",
            "patch": "@@ -101,7 +101,8 @@ def test_process_response_get_token_used(self):\n         with self.settings(CSRF_COOKIE_NAME='myname',\n                            CSRF_COOKIE_DOMAIN='.example.com',\n                            CSRF_COOKIE_PATH='/test/',\n-                           CSRF_COOKIE_SECURE=True):\n+                           CSRF_COOKIE_SECURE=True,\n+                           CSRF_COOKIE_HTTPONLY=True):\n             # token_view calls get_token() indirectly\n             CsrfViewMiddleware().process_view(req, token_view, (), {})\n             resp = token_view(req)\n@@ -110,6 +111,7 @@ def test_process_response_get_token_used(self):\n         self.assertNotEqual(csrf_cookie, False)\n         self.assertEqual(csrf_cookie['domain'], '.example.com')\n         self.assertEqual(csrf_cookie['secure'], True)\n+        self.assertEqual(csrf_cookie['httponly'], True)\n         self.assertEqual(csrf_cookie['path'], '/test/')\n         self.assertTrue('Cookie' in resp2.get('Vary',''))\n "
        }
    ],
    "stats": {
        "total": 25,
        "additions": 23,
        "deletions": 2
    }
}