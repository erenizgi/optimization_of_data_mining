{
    "author": "freakboy3742",
    "message": "Corrected an issue which could allow attackers to manipulate session data using the cache. A security announcement will be made shortly.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16759 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "33076af6f2aa5285b3a70246e14163b901b512f7",
    "files": [
        {
            "sha": "41d203e9181e251310a56e7b2d57e227e1aac788",
            "filename": "django/contrib/sessions/backends/cache.py",
            "status": "modified",
            "additions": 6,
            "deletions": 4,
            "changes": 10,
            "blob_url": "https://github.com/django/django/blob/33076af6f2aa5285b3a70246e14163b901b512f7/django%2Fcontrib%2Fsessions%2Fbackends%2Fcache.py",
            "raw_url": "https://github.com/django/django/raw/33076af6f2aa5285b3a70246e14163b901b512f7/django%2Fcontrib%2Fsessions%2Fbackends%2Fcache.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Fbackends%2Fcache.py?ref=33076af6f2aa5285b3a70246e14163b901b512f7",
            "patch": "@@ -1,6 +1,8 @@\n from django.contrib.sessions.backends.base import SessionBase, CreateError\n from django.core.cache import cache\n \n+KEY_PREFIX = \"django.contrib.sessions.cache\"\n+\n class SessionStore(SessionBase):\n     \"\"\"\n     A cache-based session store.\n@@ -10,7 +12,7 @@ def __init__(self, session_key=None):\n         super(SessionStore, self).__init__(session_key)\n \n     def load(self):\n-        session_data = self._cache.get(self.session_key)\n+        session_data = self._cache.get(KEY_PREFIX + self.session_key)\n         if session_data is not None:\n             return session_data\n         self.create()\n@@ -37,18 +39,18 @@ def save(self, must_create=False):\n             func = self._cache.add\n         else:\n             func = self._cache.set\n-        result = func(self.session_key, self._get_session(no_load=must_create),\n+        result = func(KEY_PREFIX + self.session_key, self._get_session(no_load=must_create),\n                 self.get_expiry_age())\n         if must_create and not result:\n             raise CreateError\n \n     def exists(self, session_key):\n-        return session_key in self._cache\n+        return (KEY_PREFIX + session_key) in self._cache\n \n     def delete(self, session_key=None):\n         if session_key is None:\n             if self._session_key is None:\n                 return\n             session_key = self._session_key\n-        self._cache.delete(session_key)\n+        self._cache.delete(KEY_PREFIX + session_key)\n "
        },
        {
            "sha": "465472d29c48a258b047bec06d6426b44f719c13",
            "filename": "django/contrib/sessions/backends/cached_db.py",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/django/django/blob/33076af6f2aa5285b3a70246e14163b901b512f7/django%2Fcontrib%2Fsessions%2Fbackends%2Fcached_db.py",
            "raw_url": "https://github.com/django/django/raw/33076af6f2aa5285b3a70246e14163b901b512f7/django%2Fcontrib%2Fsessions%2Fbackends%2Fcached_db.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fsessions%2Fbackends%2Fcached_db.py?ref=33076af6f2aa5285b3a70246e14163b901b512f7",
            "patch": "@@ -6,6 +6,8 @@\n from django.contrib.sessions.backends.db import SessionStore as DBStore\n from django.core.cache import cache\n \n+KEY_PREFIX = \"django.contrib.sessions.cached_db\"\n+\n class SessionStore(DBStore):\n     \"\"\"\n     Implements cached, database backed sessions.\n@@ -15,22 +17,24 @@ def __init__(self, session_key=None):\n         super(SessionStore, self).__init__(session_key)\n \n     def load(self):\n-        data = cache.get(self.session_key, None)\n+        data = cache.get(KEY_PREFIX + self.session_key, None)\n         if data is None:\n             data = super(SessionStore, self).load()\n-            cache.set(self.session_key, data, settings.SESSION_COOKIE_AGE)\n+            cache.set(KEY_PREFIX + self.session_key, data, \n+                      settings.SESSION_COOKIE_AGE)\n         return data\n \n     def exists(self, session_key):\n         return super(SessionStore, self).exists(session_key)\n \n     def save(self, must_create=False):\n         super(SessionStore, self).save(must_create)\n-        cache.set(self.session_key, self._session, settings.SESSION_COOKIE_AGE)\n+        cache.set(KEY_PREFIX + self.session_key, self._session, \n+                  settings.SESSION_COOKIE_AGE)\n \n     def delete(self, session_key=None):\n         super(SessionStore, self).delete(session_key)\n-        cache.delete(session_key or self.session_key)\n+        cache.delete(KEY_PREFIX + (session_key or self.session_key))\n \n     def flush(self):\n         \"\"\"\n@@ -39,4 +43,4 @@ def flush(self):\n         \"\"\"\n         self.clear()\n         self.delete(self.session_key)\n-        self.create()\n\\ No newline at end of file\n+        self.create()"
        }
    ],
    "stats": {
        "total": 24,
        "additions": 15,
        "deletions": 9
    }
}