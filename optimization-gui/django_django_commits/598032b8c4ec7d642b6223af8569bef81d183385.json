{
    "author": "jezdez",
    "message": "Fixed #15698 -- Fixed inconsistant handling of context_object_name in paginated MultipleObjectMixin views. Thanks, Dave Hall.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16079 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "598032b8c4ec7d642b6223af8569bef81d183385",
    "files": [
        {
            "sha": "5135763d5336d11a1a308c0eb7f87d652d7e32ce",
            "filename": "django/views/generic/list.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/598032b8c4ec7d642b6223af8569bef81d183385/django%2Fviews%2Fgeneric%2Flist.py",
            "raw_url": "https://github.com/django/django/raw/598032b8c4ec7d642b6223af8569bef81d183385/django%2Fviews%2Fgeneric%2Flist.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fviews%2Fgeneric%2Flist.py?ref=598032b8c4ec7d642b6223af8569bef81d183385",
            "patch": "@@ -89,6 +89,7 @@ def get_context_data(self, **kwargs):\n         \"\"\"\n         queryset = kwargs.pop('object_list')\n         page_size = self.get_paginate_by(queryset)\n+        context_object_name = self.get_context_object_name(queryset)\n         if page_size:\n             paginator, page, queryset, is_paginated = self.paginate_queryset(queryset, page_size)\n             context = {\n@@ -105,7 +106,6 @@ def get_context_data(self, **kwargs):\n                 'object_list': queryset\n             }\n         context.update(kwargs)\n-        context_object_name = self.get_context_object_name(queryset)\n         if context_object_name is not None:\n             context[context_object_name] = queryset\n         return context"
        },
        {
            "sha": "5b784f68102c6136c024970a8cdca09c2b48c64e",
            "filename": "tests/regressiontests/generic_views/dates.py",
            "status": "modified",
            "additions": 30,
            "deletions": 0,
            "changes": 30,
            "blob_url": "https://github.com/django/django/blob/598032b8c4ec7d642b6223af8569bef81d183385/tests%2Fregressiontests%2Fgeneric_views%2Fdates.py",
            "raw_url": "https://github.com/django/django/raw/598032b8c4ec7d642b6223af8569bef81d183385/tests%2Fregressiontests%2Fgeneric_views%2Fdates.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Fdates.py?ref=598032b8c4ec7d642b6223af8569bef81d183385",
            "patch": "@@ -119,6 +119,13 @@ def test_year_view_allow_future(self):\n         self.assertEqual(res.status_code, 200)\n         self.assertEqual(list(res.context['date_list']), [datetime.datetime(year, 1, 1)])\n \n+    def test_year_view_paginated(self):\n+        res = self.client.get('/dates/books/2006/paginated/')\n+        self.assertEqual(res.status_code, 200)\n+        self.assertEqual(list(res.context['book_list']), list(Book.objects.filter(pubdate__year=2006)))\n+        self.assertEqual(list(res.context['object_list']), list(Book.objects.filter(pubdate__year=2006)))\n+        self.assertTemplateUsed(res, 'generic_views/book_archive_year.html')\n+\n     def test_year_view_invalid_pattern(self):\n         res = self.client.get('/dates/books/no_year/')\n         self.assertEqual(res.status_code, 404)\n@@ -190,6 +197,13 @@ def test_month_view_allow_future(self):\n         self.assertEqual(res.context['next_month'], future)\n         self.assertEqual(res.context['previous_month'], datetime.date(2006, 5, 1))\n \n+    def test_month_view_paginated(self):\n+        res = self.client.get('/dates/books/2008/oct/paginated/')\n+        self.assertEqual(res.status_code, 200)\n+        self.assertEqual(list(res.context['book_list']), list(Book.objects.filter(pubdate__year=2008, pubdate__month=10)))\n+        self.assertEqual(list(res.context['object_list']), list(Book.objects.filter(pubdate__year=2008, pubdate__month=10)))\n+        self.assertTemplateUsed(res, 'generic_views/book_archive_month.html')\n+\n     def test_custom_month_format(self):\n         res = self.client.get('/dates/books/2008/10/')\n         self.assertEqual(res.status_code, 200)\n@@ -251,6 +265,15 @@ def test_week_view_allow_future(self):\n         self.assertEqual(res.status_code, 200)\n         self.assertEqual(list(res.context['book_list']), [b])\n \n+    def test_week_view_paginated(self):\n+        week_start = datetime.date(2008, 9, 28)\n+        week_end = week_start + datetime.timedelta(days=7)\n+        res = self.client.get('/dates/books/2008/week/39/')\n+        self.assertEqual(res.status_code, 200)\n+        self.assertEqual(list(res.context['book_list']), list(Book.objects.filter(pubdate__gte=week_start, pubdate__lt=week_end)))\n+        self.assertEqual(list(res.context['object_list']), list(Book.objects.filter(pubdate__gte=week_start, pubdate__lt=week_end)))\n+        self.assertTemplateUsed(res, 'generic_views/book_archive_week.html')\n+\n     def test_week_view_invalid_pattern(self):\n         res = self.client.get('/dates/books/2007/week/no_week/')\n         self.assertEqual(res.status_code, 404)\n@@ -327,6 +350,13 @@ def test_day_view_allow_future(self):\n         self.assertEqual(res.context['next_day'], future)\n         self.assertEqual(res.context['previous_day'], datetime.date(2006, 5, 1))\n \n+    def test_day_view_paginated(self):\n+        res = self.client.get('/dates/books/2008/oct/1/')\n+        self.assertEqual(res.status_code, 200)\n+        self.assertEqual(list(res.context['book_list']), list(Book.objects.filter(pubdate__year=2008, pubdate__month=10, pubdate__day=1)))\n+        self.assertEqual(list(res.context['object_list']), list(Book.objects.filter(pubdate__year=2008, pubdate__month=10, pubdate__day=1)))\n+        self.assertTemplateUsed(res, 'generic_views/book_archive_day.html')\n+\n     def test_next_prev_context(self):\n         res = self.client.get('/dates/books/2008/oct/01/')\n         self.assertEqual(res.content, \"Archive for Oct. 1, 2008. Previous day is May 1, 2006\")"
        },
        {
            "sha": "067c1f687ad318b785e5bce9f7277b0b703a2337",
            "filename": "tests/regressiontests/generic_views/urls.py",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/598032b8c4ec7d642b6223af8569bef81d183385/tests%2Fregressiontests%2Fgeneric_views%2Furls.py",
            "raw_url": "https://github.com/django/django/raw/598032b8c4ec7d642b6223af8569bef81d183385/tests%2Fregressiontests%2Fgeneric_views%2Furls.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fgeneric_views%2Furls.py?ref=598032b8c4ec7d642b6223af8569bef81d183385",
            "patch": "@@ -146,6 +146,8 @@\n         views.BookYearArchive.as_view(allow_empty=True)),\n     (r'^dates/books/(?P<year>\\d{4})/allow_future/$',\n         views.BookYearArchive.as_view(allow_future=True)),\n+    (r'^dates/books/(?P<year>\\d{4})/paginated/$',\n+        views.BookYearArchive.as_view(make_object_list=True, paginate_by=30)),\n     (r'^dates/books/no_year/$',\n         views.BookYearArchive.as_view()),\n \n@@ -158,6 +160,8 @@\n         views.BookMonthArchive.as_view(allow_empty=True)),\n     (r'^dates/books/(?P<year>\\d{4})/(?P<month>[a-z]{3})/allow_future/$',\n         views.BookMonthArchive.as_view(allow_future=True)),\n+    (r'^dates/books/(?P<year>\\d{4})/(?P<month>[a-z]{3})/paginated/$',\n+        views.BookMonthArchive.as_view(paginate_by=30)),\n     (r'^dates/books/(?P<year>\\d{4})/no_month/$',\n         views.BookMonthArchive.as_view()),\n \n@@ -168,6 +172,8 @@\n         views.BookWeekArchive.as_view(allow_empty=True)),\n     (r'^dates/books/(?P<year>\\d{4})/week/(?P<week>\\d{1,2})/allow_future/$',\n         views.BookWeekArchive.as_view(allow_future=True)),\n+    (r'^dates/books/(?P<year>\\d{4})/week/(?P<week>\\d{1,2})/paginated/$',\n+        views.BookWeekArchive.as_view(paginate_by=30)),\n     (r'^dates/books/(?P<year>\\d{4})/week/no_week/$',\n         views.BookWeekArchive.as_view()),\n     (r'^dates/books/(?P<year>\\d{4})/week/(?P<week>\\d{1,2})/monday/$',\n@@ -182,6 +188,8 @@\n         views.BookDayArchive.as_view(allow_empty=True)),\n     (r'^dates/books/(?P<year>\\d{4})/(?P<month>[a-z]{3})/(?P<day>\\d{1,2})/allow_future/$',\n         views.BookDayArchive.as_view(allow_future=True)),\n+    (r'^dates/books/(?P<year>\\d{4})/(?P<month>[a-z]{3})/(?P<day>\\d{1,2})/paginated/$',\n+        views.BookDayArchive.as_view(paginate_by=True)),\n     (r'^dates/books/(?P<year>\\d{4})/(?P<month>[a-z]{3})/no_day/$',\n         views.BookDayArchive.as_view()),\n "
        }
    ],
    "stats": {
        "total": 40,
        "additions": 39,
        "deletions": 1
    }
}