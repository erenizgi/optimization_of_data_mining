{
    "author": "freakboy3742",
    "message": "Refs #16490 - Add a commit to ensure that a fresh read is provided; this is only a problem for databases in REPEATABLE READ mode, which is MySQL InnoDB's default. Thanks to Jim Dalton for the report and patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16781 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "eb297583b1b78403cda501133a52e71dd0381576",
    "files": [
        {
            "sha": "643b0852d6b5b32b32d0b43262f9a2e6363e886a",
            "filename": "tests/modeltests/select_for_update/tests.py",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/eb297583b1b78403cda501133a52e71dd0381576/tests%2Fmodeltests%2Fselect_for_update%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/eb297583b1b78403cda501133a52e71dd0381576/tests%2Fmodeltests%2Fselect_for_update%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Fselect_for_update%2Ftests.py?ref=eb297583b1b78403cda501133a52e71dd0381576",
            "patch": "@@ -205,6 +205,11 @@ def test_block(self):\n         # Check the thread has finished. Assuming it has, we should\n         # find that it has updated the person's name.\n         self.failIf(thread.isAlive())\n+\n+        # We must commit the transaction to ensure that MySQL gets a fresh read,\n+        # since by default it runs in REPEATABLE READ mode\n+        transaction.commit()\n+\n         p = Person.objects.get(pk=self.person.pk)\n         self.assertEqual('Fred', p.name)\n "
        }
    ],
    "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
    }
}