{
    "author": "unknown",
    "message": "Fixed #18408 -- Isolated flatpages tests from existing sites.\n\nResolves Flatpages test issues by:\n - Creating an example_site fixture\n - Overriding project SITE_ID setting to 1\n - Normalizing the use of the hardcoded (1) site_id to settings.SITE_ID",
    "sha": "ba10be70322027074e5f9defc1423eb0cc77473c",
    "files": [
        {
            "sha": "45a0544e6573b69e86229a4d0edf46032ee28f4b",
            "filename": "AUTHORS",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/ba10be70322027074e5f9defc1423eb0cc77473c/AUTHORS",
            "raw_url": "https://github.com/django/django/raw/ba10be70322027074e5f9defc1423eb0cc77473c/AUTHORS",
            "contents_url": "https://api.github.com/repos/django/django/contents/AUTHORS?ref=ba10be70322027074e5f9defc1423eb0cc77473c",
            "patch": "@@ -401,6 +401,7 @@ answer newbie questions, and generally made Django that much better:\n     Christian Oudard <christian.oudard@gmail.com>\n     oggie rob <oz.robharvey@gmail.com>\n     oggy <ognjen.maric@gmail.com>\n+    Jens Page\n     Jay Parlar <parlar@gmail.com>\n     Carlos Eduardo de Paula <carlosedp@gmail.com>\n     John Paulett <john@paulett.org>"
        },
        {
            "sha": "71aa84de1277990c1191bf2901ae93cf8d042b43",
            "filename": "django/contrib/flatpages/fixtures/example_site.json",
            "status": "added",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/django/django/blob/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ffixtures%2Fexample_site.json",
            "raw_url": "https://github.com/django/django/raw/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ffixtures%2Fexample_site.json",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ffixtures%2Fexample_site.json?ref=ba10be70322027074e5f9defc1423eb0cc77473c",
            "patch": "@@ -0,0 +1,11 @@\n+[\n+  {\n+    \"pk\": 1,\n+    \"model\": \"sites.site\",\n+    \"fields\": {\n+      \"domain\": \"example.com\",\n+      \"name\": \"example.com\"\n+    }\n+  }\n+]\n+"
        },
        {
            "sha": "e64c4bb1025248bfefc08f2798f7496149690180",
            "filename": "django/contrib/flatpages/tests/csrf.py",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/django/django/blob/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Fcsrf.py",
            "raw_url": "https://github.com/django/django/raw/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Fcsrf.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ftests%2Fcsrf.py?ref=ba10be70322027074e5f9defc1423eb0cc77473c",
            "patch": "@@ -18,9 +18,10 @@\n     TEMPLATE_DIRS=(\n         os.path.join(os.path.dirname(__file__), 'templates'),\n     ),\n+    SITE_ID=1,\n )\n class FlatpageCSRFTests(TestCase):\n-    fixtures = ['sample_flatpages']\n+    fixtures = ['sample_flatpages', 'example_site']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n     def setUp(self):"
        },
        {
            "sha": "0e54176aa25d78c114d5b07331fd33672a2ebb4e",
            "filename": "django/contrib/flatpages/tests/forms.py",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Fforms.py",
            "raw_url": "https://github.com/django/django/raw/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Fforms.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ftests%2Fforms.py?ref=ba10be70322027074e5f9defc1423eb0cc77473c",
            "patch": "@@ -5,7 +5,10 @@\n from django.test.utils import override_settings\n from django.utils import translation\n \n+@override_settings(SITE_ID=1)\n class FlatpageAdminFormTests(TestCase):\n+    fixtures = ['example_site']\n+\n     def setUp(self):\n         self.form_data = {\n             'title': \"A test page\",\n@@ -89,5 +92,5 @@ def test_flatpage_nosites(self):\n \n         self.assertEqual(\n             f.errors,\n-            {'sites': [u'This field is required.']})\n+            {'sites': [translation.ugettext(u'This field is required.')]})\n "
        },
        {
            "sha": "4afa4ff982239c06b1f3782f71b81edd2e5bb890",
            "filename": "django/contrib/flatpages/tests/middleware.py",
            "status": "modified",
            "additions": 7,
            "deletions": 5,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Fmiddleware.py",
            "raw_url": "https://github.com/django/django/raw/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Fmiddleware.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ftests%2Fmiddleware.py?ref=ba10be70322027074e5f9defc1423eb0cc77473c",
            "patch": "@@ -19,9 +19,10 @@\n     TEMPLATE_DIRS=(\n         os.path.join(os.path.dirname(__file__), 'templates'),\n     ),\n+    SITE_ID=1,\n )\n class FlatpageMiddlewareTests(TestCase):\n-    fixtures = ['sample_flatpages']\n+    fixtures = ['sample_flatpages', 'example_site']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n     def test_view_flatpage(self):\n@@ -75,7 +76,7 @@ def test_fallback_flatpage_special_chars(self):\n             enable_comments=False,\n             registration_required=False,\n         )\n-        fp.sites.add(1)\n+        fp.sites.add(settings.SITE_ID)\n \n         response = self.client.get('/some.very_special~chars-here/')\n         self.assertEqual(response.status_code, 200)\n@@ -96,9 +97,10 @@ def test_fallback_flatpage_special_chars(self):\n     TEMPLATE_DIRS=(\n         os.path.join(os.path.dirname(__file__), 'templates'),\n     ),\n+    SITE_ID=1,\n )\n class FlatpageMiddlewareAppendSlashTests(TestCase):\n-    fixtures = ['sample_flatpages']\n+    fixtures = ['sample_flatpages', 'example_site']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n     def test_redirect_view_flatpage(self):\n@@ -130,7 +132,7 @@ def test_redirect_fallback_flatpage_special_chars(self):\n             enable_comments=False,\n             registration_required=False,\n         )\n-        fp.sites.add(1)\n+        fp.sites.add(settings.SITE_ID)\n \n         response = self.client.get('/some.very_special~chars-here')\n         self.assertRedirects(response, '/some.very_special~chars-here/', status_code=301)\n@@ -144,7 +146,7 @@ def test_redirect_fallback_flatpage_root(self):\n             enable_comments=False,\n             registration_required=False,\n         )\n-        fp.sites.add(1)\n+        fp.sites.add(settings.SITE_ID)\n \n         response = self.client.get('/')\n         self.assertEqual(response.status_code, 200)"
        },
        {
            "sha": "aebc62277e6ebd626f445deffda20595f5a8a77f",
            "filename": "django/contrib/flatpages/tests/templatetags.py",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/django/django/blob/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Ftemplatetags.py",
            "raw_url": "https://github.com/django/django/raw/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Ftemplatetags.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ftests%2Ftemplatetags.py?ref=ba10be70322027074e5f9defc1423eb0cc77473c",
            "patch": "@@ -18,6 +18,7 @@\n     TEMPLATE_DIRS=(\n         os.path.join(os.path.dirname(__file__), 'templates'),\n     ),\n+    SITE_ID=1,\n )\n class FlatpageTemplateTagTests(TestCase):\n     fixtures = ['sample_flatpages']"
        },
        {
            "sha": "b69bd6abb426c6ca87507819ccab4f2da7824403",
            "filename": "django/contrib/flatpages/tests/views.py",
            "status": "modified",
            "additions": 5,
            "deletions": 3,
            "changes": 8,
            "blob_url": "https://github.com/django/django/blob/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Fviews.py",
            "raw_url": "https://github.com/django/django/raw/ba10be70322027074e5f9defc1423eb0cc77473c/django%2Fcontrib%2Fflatpages%2Ftests%2Fviews.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fflatpages%2Ftests%2Fviews.py?ref=ba10be70322027074e5f9defc1423eb0cc77473c",
            "patch": "@@ -19,9 +19,10 @@\n     TEMPLATE_DIRS=(\n         os.path.join(os.path.dirname(__file__), 'templates'),\n     ),\n+    SITE_ID=1,\n )\n class FlatpageViewTests(TestCase):\n-    fixtures = ['sample_flatpages']\n+    fixtures = ['sample_flatpages', 'example_site']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n     def test_view_flatpage(self):\n@@ -85,9 +86,10 @@ def test_view_flatpage_special_chars(self):\n     TEMPLATE_DIRS=(\n         os.path.join(os.path.dirname(__file__), 'templates'),\n     ),\n+    SITE_ID=1,\n )\n class FlatpageViewAppendSlashTests(TestCase):\n-    fixtures = ['sample_flatpages']\n+    fixtures = ['sample_flatpages', 'example_site']\n     urls = 'django.contrib.flatpages.tests.urls'\n \n     def test_redirect_view_flatpage(self):\n@@ -119,7 +121,7 @@ def test_redirect_view_flatpage_special_chars(self):\n             enable_comments=False,\n             registration_required=False,\n         )\n-        fp.sites.add(1)\n+        fp.sites.add(settings.SITE_ID)\n \n         response = self.client.get('/flatpage_root/some.very_special~chars-here')\n         self.assertRedirects(response, '/flatpage_root/some.very_special~chars-here/', status_code=301)"
        }
    ],
    "stats": {
        "total": 41,
        "additions": 31,
        "deletions": 10
    }
}