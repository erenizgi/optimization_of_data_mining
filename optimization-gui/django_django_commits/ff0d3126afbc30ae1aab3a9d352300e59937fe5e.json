{
    "author": "claudep",
    "message": "Fixed #19296 -- Applied test connection sharing for spatialite\n\nThanks pegler at gmail.com for the report and the initial patch.",
    "sha": "ff0d3126afbc30ae1aab3a9d352300e59937fe5e",
    "files": [
        {
            "sha": "96178b4c86d821492d89cf4f71e2198256b540de",
            "filename": "django/test/testcases.py",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/ff0d3126afbc30ae1aab3a9d352300e59937fe5e/django%2Ftest%2Ftestcases.py",
            "raw_url": "https://github.com/django/django/raw/ff0d3126afbc30ae1aab3a9d352300e59937fe5e/django%2Ftest%2Ftestcases.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Ftest%2Ftestcases.py?ref=ff0d3126afbc30ae1aab3a9d352300e59937fe5e",
            "patch": "@@ -1077,7 +1077,7 @@ def setUpClass(cls):\n         for conn in connections.all():\n             # If using in-memory sqlite databases, pass the connections to\n             # the server thread.\n-            if (conn.settings_dict['ENGINE'] == 'django.db.backends.sqlite3'\n+            if (conn.settings_dict['ENGINE'].rsplit('.', 1)[-1] in ('sqlite3', 'spatialite')\n                 and conn.settings_dict['NAME'] == ':memory:'):\n                 # Explicitly enable thread-shareability for this connection\n                 conn.allow_thread_sharing = True\n@@ -1129,7 +1129,7 @@ def tearDownClass(cls):\n \n         # Restore sqlite connections' non-sharability\n         for conn in connections.all():\n-            if (conn.settings_dict['ENGINE'] == 'django.db.backends.sqlite3'\n+            if (conn.settings_dict['ENGINE'].rsplit('.', 1)[-1] in ('sqlite3', 'spatialite')\n                 and conn.settings_dict['NAME'] == ':memory:'):\n                 conn.allow_thread_sharing = False\n "
        }
    ],
    "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    }
}