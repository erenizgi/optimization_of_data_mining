{
    "author": "ramiro",
    "message": "Don't merge in translations twice from deprecated project level tree when it is also listed in LOCALE_PATHS. Thanks Claude Paroz. Refs #14924.\nAlso, removed some old unused variables as reported by pyflakes.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15514 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "ee060202409c5700fc2237ce5dab1c0a0486b1d3",
    "files": [
        {
            "sha": "2495cdd0c88bf39ab634062bfaeafcd92d464fc7",
            "filename": "django/utils/translation/trans_real.py",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/django/django/blob/ee060202409c5700fc2237ce5dab1c0a0486b1d3/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "raw_url": "https://github.com/django/django/raw/ee060202409c5700fc2237ce5dab1c0a0486b1d3/django%2Futils%2Ftranslation%2Ftrans_real.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Futils%2Ftranslation%2Ftrans_real.py?ref=ee060202409c5700fc2237ce5dab1c0a0486b1d3",
            "patch": "@@ -67,7 +67,6 @@ class DjangoTranslation(gettext_module.GNUTranslations):\n     Python 2.4.\n     \"\"\"\n     def __init__(self, *args, **kw):\n-        from django.conf import settings\n         gettext_module.GNUTranslations.__init__(self, *args, **kw)\n         # Starting with Python 2.4, there's a function to define\n         # the output charset. Before 2.4, the output charset is\n@@ -136,7 +135,7 @@ def _translation(path):\n                 t = gettext_module.translation('django', path, [loc], DjangoTranslation)\n                 t.set_language(lang)\n                 return t\n-            except IOError, e:\n+            except IOError:\n                 return None\n \n         res = _translation(globalpath)\n@@ -166,7 +165,7 @@ def _merge(path):\n             if os.path.isdir(apppath):\n                 res = _merge(apppath)\n \n-        if projectpath and os.path.isdir(projectpath):\n+        if projectpath and os.path.isdir(projectpath) and projectpath not in settings.LOCALE_PATHS:\n             res = _merge(projectpath)\n \n         for localepath in reversed(settings.LOCALE_PATHS):\n@@ -365,8 +364,6 @@ def get_language_from_request(request):\n     \"\"\"\n     global _accepted\n     from django.conf import settings\n-    globalpath = os.path.join(\n-        os.path.dirname(sys.modules[settings.__module__].__file__), 'locale')\n     supported = dict(settings.LANGUAGES)\n \n     if hasattr(request, 'session'):"
        }
    ],
    "stats": {
        "total": 7,
        "additions": 2,
        "deletions": 5
    }
}