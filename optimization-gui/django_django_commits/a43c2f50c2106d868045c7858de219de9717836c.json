{
    "author": "ramiro",
    "message": "Fixed #7726 -- Added validation of max_digits and decimal_places options to DecimalField model field. Thanks theevilgeek for the report and elbarto for the patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@15094 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "a43c2f50c2106d868045c7858de219de9717836c",
    "files": [
        {
            "sha": "2eb6340de94c60fbee0b82db3fbb121c6de9337b",
            "filename": "django/core/management/validation.py",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/django/django/blob/a43c2f50c2106d868045c7858de219de9717836c/django%2Fcore%2Fmanagement%2Fvalidation.py",
            "raw_url": "https://github.com/django/django/raw/a43c2f50c2106d868045c7858de219de9717836c/django%2Fcore%2Fmanagement%2Fvalidation.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fvalidation.py?ref=a43c2f50c2106d868045c7858de219de9717836c",
            "patch": "@@ -53,20 +53,29 @@ def get_validation_errors(outfile, app=None):\n                 except (ValueError, TypeError):\n                     e.add(opts, '\"%s\": CharFields require a \"max_length\" attribute that is a positive integer.' % f.name)\n             if isinstance(f, models.DecimalField):\n+                decimalp_ok, mdigits_ok = False, False\n                 decimalp_msg ='\"%s\": DecimalFields require a \"decimal_places\" attribute that is a non-negative integer.'\n                 try:\n                     decimal_places = int(f.decimal_places)\n                     if decimal_places < 0:\n                         e.add(opts, decimalp_msg % f.name)\n+                    else:\n+                        decimalp_ok = True\n                 except (ValueError, TypeError):\n                     e.add(opts, decimalp_msg % f.name)\n                 mdigits_msg = '\"%s\": DecimalFields require a \"max_digits\" attribute that is a positive integer.'\n                 try:\n                     max_digits = int(f.max_digits)\n                     if max_digits <= 0:\n                         e.add(opts,  mdigits_msg % f.name)\n+                    else:\n+                        mdigits_ok = True\n                 except (ValueError, TypeError):\n                     e.add(opts, mdigits_msg % f.name)\n+                invalid_values_msg = '\"%s\": DecimalFields require a \"max_digits\" attribute value that is greater than the value of the \"decimal_places\" attribute.'\n+                if decimalp_ok and mdigits_ok:\n+                    if decimal_places >= max_digits:\n+                        e.add(opts, invalid_values_msg % f.name)\n             if isinstance(f, models.FileField) and not f.upload_to:\n                 e.add(opts, '\"%s\": FileFields require an \"upload_to\" attribute.' % f.name)\n             if isinstance(f, models.ImageField):"
        },
        {
            "sha": "583dfb499c21574ba00608da9751c27a7670ecc5",
            "filename": "docs/ref/models/fields.txt",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/django/django/blob/a43c2f50c2106d868045c7858de219de9717836c/docs%2Fref%2Fmodels%2Ffields.txt",
            "raw_url": "https://github.com/django/django/raw/a43c2f50c2106d868045c7858de219de9717836c/docs%2Fref%2Fmodels%2Ffields.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Fref%2Fmodels%2Ffields.txt?ref=a43c2f50c2106d868045c7858de219de9717836c",
            "patch": "@@ -437,11 +437,12 @@ A fixed-precision decimal number, represented in Python by a\n \n .. attribute:: DecimalField.max_digits\n \n-    The maximum number of digits allowed in the number\n+    The maximum number of digits allowed in the number. Note that this number\n+    must be greater than ``decimal_places``, if it exists.\n \n .. attribute:: DecimalField.decimal_places\n \n-    The number of decimal places to store with the number\n+    The number of decimal places to store with the number.\n \n For example, to store numbers up to 999 with a resolution of 2 decimal places,\n you'd use::"
        },
        {
            "sha": "ab9edd64614c4ec0652cbfe0e9dcace023bb39d5",
            "filename": "tests/modeltests/invalid_models/models.py",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/django/django/blob/a43c2f50c2106d868045c7858de219de9717836c/tests%2Fmodeltests%2Finvalid_models%2Fmodels.py",
            "raw_url": "https://github.com/django/django/raw/a43c2f50c2106d868045c7858de219de9717836c/tests%2Fmodeltests%2Finvalid_models%2Fmodels.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fmodeltests%2Finvalid_models%2Fmodels.py?ref=a43c2f50c2106d868045c7858de219de9717836c",
            "patch": "@@ -14,6 +14,8 @@ class FieldErrors(models.Model):\n     decimalfield = models.DecimalField()\n     decimalfield2 = models.DecimalField(max_digits=-1, decimal_places=-1)\n     decimalfield3 = models.DecimalField(max_digits=\"bad\", decimal_places=\"bad\")\n+    decimalfield4 = models.DecimalField(max_digits=9, decimal_places=10)\n+    decimalfield5 = models.DecimalField(max_digits=10, decimal_places=10)\n     filefield = models.FileField()\n     choices = models.CharField(max_length=10, choices='bad')\n     choices2 = models.CharField(max_length=10, choices=[(1,2,3),(1,2,3)])\n@@ -241,6 +243,8 @@ class ArticleAttachment(models.Model):\n invalid_models.fielderrors: \"decimalfield2\": DecimalFields require a \"max_digits\" attribute that is a positive integer.\n invalid_models.fielderrors: \"decimalfield3\": DecimalFields require a \"decimal_places\" attribute that is a non-negative integer.\n invalid_models.fielderrors: \"decimalfield3\": DecimalFields require a \"max_digits\" attribute that is a positive integer.\n+invalid_models.fielderrors: \"decimalfield4\": DecimalFields require a \"max_digits\" attribute value that is greater than the value of the \"decimal_places\" attribute.\n+invalid_models.fielderrors: \"decimalfield5\": DecimalFields require a \"max_digits\" attribute value that is greater than the value of the \"decimal_places\" attribute.\n invalid_models.fielderrors: \"filefield\": FileFields require an \"upload_to\" attribute.\n invalid_models.fielderrors: \"choices\": \"choices\" should be iterable (e.g., a tuple or list).\n invalid_models.fielderrors: \"choices2\": \"choices\" should be a sequence of two-tuples."
        }
    ],
    "stats": {
        "total": 18,
        "additions": 16,
        "deletions": 2
    }
}