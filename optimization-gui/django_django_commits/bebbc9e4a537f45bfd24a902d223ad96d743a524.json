{
    "author": "ramiro",
    "message": "Made a couple of changes for readability and correctness in loaddata.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17055 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "bebbc9e4a537f45bfd24a902d223ad96d743a524",
    "files": [
        {
            "sha": "bd867796c217b7b2f4796c0ad89fa8eefbee947e",
            "filename": "django/core/management/commands/loaddata.py",
            "status": "modified",
            "additions": 6,
            "deletions": 6,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/bebbc9e4a537f45bfd24a902d223ad96d743a524/django%2Fcore%2Fmanagement%2Fcommands%2Floaddata.py",
            "raw_url": "https://github.com/django/django/raw/bebbc9e4a537f45bfd24a902d223ad96d743a524/django%2Fcore%2Fmanagement%2Fcommands%2Floaddata.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcore%2Fmanagement%2Fcommands%2Floaddata.py?ref=bebbc9e4a537f45bfd24a902d223ad96d743a524",
            "patch": "@@ -62,7 +62,7 @@ def handle(self, *fixture_labels, **options):\n         fixture_object_count = 0\n         models = set()\n \n-        humanize = lambda dirname: dirname and \"'%s'\" % dirname or 'absolute path'\n+        humanize = lambda dirname: \"'%s'\" % dirname if dirname else 'absolute path'\n \n         # Get a cursor (even though we don't need one yet). This has\n         # the side effect of initializing the test database (if\n@@ -160,6 +160,11 @@ def read(self):\n                     open_method = compression_types[compression_format]\n                     try:\n                         fixture = open_method(full_path, 'r')\n+                    except IOError:\n+                        if verbosity >= 2:\n+                            self.stdout.write(\"No %s fixture '%s' in %s.\\n\" % \\\n+                                (format, fixture_name, humanize(fixture_dir)))\n+                    else:\n                         if label_found:\n                             fixture.close()\n                             self.stderr.write(self.style.ERROR(\"Multiple fixtures named '%s' in %s. Aborting.\\n\" %\n@@ -232,11 +237,6 @@ def read(self):\n                                     transaction.leave_transaction_management(using=using)\n                                 return\n \n-                    except Exception, e:\n-                        if verbosity >= 2:\n-                            self.stdout.write(\"No %s fixture '%s' in %s.\\n\" % \\\n-                                (format, fixture_name, humanize(fixture_dir)))\n-\n         # If we found even one object in a fixture, we need to reset the\n         # database sequences.\n         if loaded_object_count > 0:"
        },
        {
            "sha": "5b8dc6659f62b5fdcfd5a9b6f219146ab8e81445",
            "filename": "tests/regressiontests/fixtures_regress/tests.py",
            "status": "modified",
            "additions": 12,
            "deletions": 0,
            "changes": 12,
            "blob_url": "https://github.com/django/django/blob/bebbc9e4a537f45bfd24a902d223ad96d743a524/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/bebbc9e4a537f45bfd24a902d223ad96d743a524/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Ffixtures_regress%2Ftests.py?ref=bebbc9e4a537f45bfd24a902d223ad96d743a524",
            "patch": "@@ -405,6 +405,18 @@ def test_loaddata_no_fixture_specified(self):\n             stderr.getvalue(), 'No database fixture specified. Please provide the path of at least one fixture in the command line.\\n'\n         )\n \n+    def test_loaddata_not_existant_fixture_file(self):\n+        stdout_output = StringIO()\n+        management.call_command(\n+            'loaddata',\n+            'this_fixture_doesnt_exist',\n+            verbosity=2,\n+            commit=False,\n+            stdout=stdout_output,\n+        )\n+        self.assertTrue(\"No xml fixture 'this_fixture_doesnt_exist' in\" in\n+            stdout_output.getvalue())\n+\n \n class NaturalKeyFixtureTests(TestCase):\n "
        }
    ],
    "stats": {
        "total": 24,
        "additions": 18,
        "deletions": 6
    }
}