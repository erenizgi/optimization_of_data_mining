{
    "author": "adrianholovaty",
    "message": "Started a 'Cheat sheet' section in aggregation docs because I desperately need this\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@17371 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "64229eb3882be7080f73bc4559f44dc34507b140",
    "files": [
        {
            "sha": "3a4d2878643e85d8715a8673e4b14726a69e225e",
            "filename": "docs/topics/db/aggregation.txt",
            "status": "modified",
            "additions": 36,
            "deletions": 0,
            "changes": 36,
            "blob_url": "https://github.com/django/django/blob/64229eb3882be7080f73bc4559f44dc34507b140/docs%2Ftopics%2Fdb%2Faggregation.txt",
            "raw_url": "https://github.com/django/django/raw/64229eb3882be7080f73bc4559f44dc34507b140/docs%2Ftopics%2Fdb%2Faggregation.txt",
            "contents_url": "https://api.github.com/repos/django/django/contents/docs%2Ftopics%2Fdb%2Faggregation.txt?ref=64229eb3882be7080f73bc4559f44dc34507b140",
            "patch": "@@ -41,6 +41,42 @@ used to track the inventory for a series of online bookstores:\n        name = models.CharField(max_length=300)\n        books = models.ManyToManyField(Book)\n \n+Cheat sheet\n+===========\n+\n+In a hurry? Here's how to do common aggregate queries, assuming the models above::\n+\n+    # Total number of books.\n+    >>> Book.objects.count()\n+    2452\n+\n+    # Total number of books with publisher=BaloneyPress\n+    >>> Book.objects.filter(publisher__name='BaloneyPress').count()\n+    73\n+\n+    # Average price across all books.\n+    >>> from django.db.models import Avg\n+    >>> Book.objects.all().aggregate(Avg('price'))\n+    {'price__avg': 34.35}\n+\n+    # Max price across all books.\n+    >>> from django.db.models import Max\n+    >>> Book.objects.all().aggregate(Max('price'))\n+    {'price__max': Decimal('81.20')}\n+\n+    # Each publisher, each with a count of books as a \"num_books\" attribute.\n+    >>> from django.db.models import Count\n+    >>> pubs = Publisher.objects.annotate(num_books=Count('book'))\n+    >>> pubs\n+    [<Publisher BaloneyPress>, <Publisher SalamiPress>, ...]\n+    >>> pubs[0].num_books\n+    73\n+\n+    # The top 5 publishers, in order by number of books.\n+    >>> from django.db.models import Count\n+    >>> pubs = Publisher.objects.annotate(num_books=Count('book')).order_by('-num_books')[:5]\n+    >>> pubs[0].num_books\n+    1323\n \n Generating aggregates over a QuerySet\n ====================================="
        }
    ],
    "stats": {
        "total": 36,
        "additions": 36,
        "deletions": 0
    }
}