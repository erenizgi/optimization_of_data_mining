{
    "author": "jezdez",
    "message": "Fixed #14729 -- RawQuerySet.__repr__ fails when params passed as list. Thanks, intgr for ticket and accuser for patch.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16088 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "c77372cad034b06c1b7239ff6e1284c832f4a541",
    "files": [
        {
            "sha": "9c3aeaa8d3a78276016e04c7a838a22d0dae7ed0",
            "filename": "django/db/models/query.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/c77372cad034b06c1b7239ff6e1284c832f4a541/django%2Fdb%2Fmodels%2Fquery.py",
            "raw_url": "https://github.com/django/django/raw/c77372cad034b06c1b7239ff6e1284c832f4a541/django%2Fdb%2Fmodels%2Fquery.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fquery.py?ref=c77372cad034b06c1b7239ff6e1284c832f4a541",
            "patch": "@@ -1385,7 +1385,7 @@ def __iter__(self):\n             yield instance\n \n     def __repr__(self):\n-        return \"<RawQuerySet: %r>\" % (self.raw_query % self.params)\n+        return \"<RawQuerySet: %r>\" % (self.raw_query % tuple(self.params))\n \n     def __getitem__(self, k):\n         return list(self)[k]"
        },
        {
            "sha": "c29673ecddd1f33a141c789b526b48afc479252c",
            "filename": "django/db/models/sql/query.py",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/django/django/blob/c77372cad034b06c1b7239ff6e1284c832f4a541/django%2Fdb%2Fmodels%2Fsql%2Fquery.py",
            "raw_url": "https://github.com/django/django/raw/c77372cad034b06c1b7239ff6e1284c832f4a541/django%2Fdb%2Fmodels%2Fsql%2Fquery.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fdb%2Fmodels%2Fsql%2Fquery.py?ref=c77372cad034b06c1b7239ff6e1284c832f4a541",
            "patch": "@@ -74,7 +74,7 @@ def __iter__(self):\n         return iter(result)\n \n     def __repr__(self):\n-        return \"<RawQuery: %r>\" % (self.sql % self.params)\n+        return \"<RawQuery: %r>\" % (self.sql % tuple(self.params))\n \n     def _execute_query(self):\n         self.cursor = connections[self.using].cursor()"
        },
        {
            "sha": "31856ba3a60493c1801a637b15a26afc3f02ebb5",
            "filename": "tests/regressiontests/queries/tests.py",
            "status": "modified",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/django/django/blob/c77372cad034b06c1b7239ff6e1284c832f4a541/tests%2Fregressiontests%2Fqueries%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/c77372cad034b06c1b7239ff6e1284c832f4a541/tests%2Fregressiontests%2Fqueries%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fqueries%2Ftests.py?ref=c77372cad034b06c1b7239ff6e1284c832f4a541",
            "patch": "@@ -1317,6 +1317,23 @@ def test_ticket3739(self):\n         self.assertIsNot(q1, q1.all())\n \n \n+class RawQueriesTests(TestCase):\n+    def setUp(self):\n+        n1 = Note.objects.create(note='n1', misc='foo', id=1)\n+\n+    def test_ticket14729(self):\n+        # Test representation of raw query with one or few parameters passed as list\n+        query = \"SELECT * FROM queries_note WHERE note = %s\"\n+        params = ['n1']\n+        qs = Note.objects.raw(query, params=params)\n+        self.assertEqual(repr(qs), \"<RawQuerySet: 'SELECT * FROM queries_note WHERE note = n1'>\")\n+\n+        query = \"SELECT * FROM queries_note WHERE note = %s and misc = %s\"\n+        params = ['n1', 'foo']\n+        qs = Note.objects.raw(query, params=params)\n+        self.assertEqual(repr(qs), \"<RawQuerySet: 'SELECT * FROM queries_note WHERE note = n1 and misc = foo'>\")\n+\n+\n class GeneratorExpressionTests(TestCase):\n     def test_ticket10432(self):\n         # Using an empty generator expression as the rvalue for an \"__in\""
        }
    ],
    "stats": {
        "total": 21,
        "additions": 19,
        "deletions": 2
    }
}