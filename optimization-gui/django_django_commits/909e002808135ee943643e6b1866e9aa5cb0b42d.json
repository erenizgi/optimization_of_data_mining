{
    "author": "kmtracey",
    "message": "Fix UnboundLocalError than could occur during ModelAdmin validation.\n\ngit-svn-id: http://code.djangoproject.com/svn/django/trunk@16262 bcc190cf-cafb-0310-a4f2-bffc1f526a37",
    "sha": "909e002808135ee943643e6b1866e9aa5cb0b42d",
    "files": [
        {
            "sha": "33acebf0b61ee9590f2bcb614b1403e940131931",
            "filename": "django/contrib/admin/validation.py",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/django/django/blob/909e002808135ee943643e6b1866e9aa5cb0b42d/django%2Fcontrib%2Fadmin%2Fvalidation.py",
            "raw_url": "https://github.com/django/django/raw/909e002808135ee943643e6b1866e9aa5cb0b42d/django%2Fcontrib%2Fadmin%2Fvalidation.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fadmin%2Fvalidation.py?ref=909e002808135ee943643e6b1866e9aa5cb0b42d",
            "patch": "@@ -247,9 +247,9 @@ def validate_fields_spec(cls, model, opts, flds, label):\n             try:\n                 f = opts.get_field(field)\n             except models.FieldDoesNotExist:\n-                # If we can't find a field on the model that matches,\n-                # it could be an extra field on the form.\n-                pass\n+                # If we can't find a field on the model that matches, it could be an\n+                # extra field on the form; nothing to check so move on to the next field.\n+                continue\n             if isinstance(f, models.ManyToManyField) and not f.rel.through._meta.auto_created:\n                 raise ImproperlyConfigured(\"'%s.%s' \"\n                     \"can't include the ManyToManyField field '%s' because \""
        },
        {
            "sha": "2cf3c60062a3da08bcd2e5c0749a8de97981872a",
            "filename": "tests/regressiontests/admin_validation/tests.py",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/django/django/blob/909e002808135ee943643e6b1866e9aa5cb0b42d/tests%2Fregressiontests%2Fadmin_validation%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/909e002808135ee943643e6b1866e9aa5cb0b42d/tests%2Fregressiontests%2Fadmin_validation%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/tests%2Fregressiontests%2Fadmin_validation%2Ftests.py?ref=909e002808135ee943643e6b1866e9aa5cb0b42d",
            "patch": "@@ -256,3 +256,19 @@ class FieldsOnFormOnlyAdmin(admin.ModelAdmin):\n             fields = ['title', 'extra_data']\n \n         validate(FieldsOnFormOnlyAdmin, Song)\n+\n+    def test_non_model_first_field(self):\n+        \"\"\"\n+        Regression for ensuring ModelAdmin.field can handle first elem being a\n+        non-model field (test fix for UnboundLocalError introduced with r16225).\n+        \"\"\"\n+        class SongForm(forms.ModelForm):\n+            extra_data = forms.CharField()\n+            class Meta:\n+                model = Song\n+\n+        class FieldsOnFormOnlyAdmin(admin.ModelAdmin):\n+            form = SongForm\n+            fields = ['extra_data', 'title']\n+\n+        validate(FieldsOnFormOnlyAdmin, Song)"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 19,
        "deletions": 3
    }
}