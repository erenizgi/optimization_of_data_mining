{
    "author": "claudep",
    "message": "Lowered field ordering requirement in ogrinspect test\n\nThis test was randomly failing depending on the library environment.",
    "sha": "a1c470a6f6084ee3d803d884b62df61ab6f5c5df",
    "files": [
        {
            "sha": "549587d5a772a1d51683211cd4e0b410c93ba0f5",
            "filename": "django/contrib/gis/tests/inspectapp/tests.py",
            "status": "modified",
            "additions": 21,
            "deletions": 35,
            "changes": 56,
            "blob_url": "https://github.com/django/django/blob/a1c470a6f6084ee3d803d884b62df61ab6f5c5df/django%2Fcontrib%2Fgis%2Ftests%2Finspectapp%2Ftests.py",
            "raw_url": "https://github.com/django/django/raw/a1c470a6f6084ee3d803d884b62df61ab6f5c5df/django%2Fcontrib%2Fgis%2Ftests%2Finspectapp%2Ftests.py",
            "contents_url": "https://api.github.com/repos/django/django/contents/django%2Fcontrib%2Fgis%2Ftests%2Finspectapp%2Ftests.py?ref=a1c470a6f6084ee3d803d884b62df61ab6f5c5df",
            "patch": "@@ -4,7 +4,7 @@\n \n from django.db import connections\n from django.test import TestCase\n-from django.contrib.gis.gdal import Driver, GDAL_VERSION\n+from django.contrib.gis.gdal import Driver\n from django.contrib.gis.geometry.test_data import TEST_DATA\n from django.contrib.gis.utils.ogrinspect import ogrinspect\n \n@@ -70,41 +70,27 @@ def test_time_field(self):\n                                layer_key=AllOGRFields._meta.db_table,\n                                decimal=['f_decimal'])\n \n-        expected = [\n-            '# This is an auto-generated Django model module created by ogrinspect.',\n-            'from django.contrib.gis.db import models',\n-            '',\n-            'class Measurement(models.Model):',\n-            '    f_decimal = models.DecimalField(max_digits=0, decimal_places=0)',\n-        ]\n-\n-        if GDAL_VERSION < (1, 9, 0):\n-            # Prior to GDAL 1.9, the order of the model fields was not\n-            # the same as the columns in the database.\n-            expected.extend([\n-            '    f_int = models.IntegerField()',\n-            '    f_datetime = models.DateTimeField()',\n-            '    f_time = models.TimeField()',\n-            '    f_float = models.FloatField()',\n-            '    f_char = models.CharField(max_length=10)',\n-            '    f_date = models.DateField()',\n-            ])\n-        else:\n-            expected.extend([\n-            '    f_float = models.FloatField()',\n-            '    f_int = models.IntegerField()',\n-            '    f_char = models.CharField(max_length=10)',\n-            '    f_date = models.DateField()',\n-            '    f_datetime = models.DateTimeField()',\n-            '    f_time = models.TimeField()',\n-            ])\n-\n-        expected.extend([\n-            '    geom = models.PolygonField()',\n-            '    objects = models.GeoManager()',\n-        ])\n+        self.assertTrue(model_def.startswith(\n+            '# This is an auto-generated Django model module created by ogrinspect.\\n'\n+            'from django.contrib.gis.db import models\\n'\n+            '\\n'\n+            'class Measurement(models.Model):\\n'\n+        ))\n+\n+        # The ordering of model fields might vary depending on several factors (version of GDAL, etc.)\n+        self.assertIn('    f_decimal = models.DecimalField(max_digits=0, decimal_places=0)', model_def)\n+        self.assertIn('    f_int = models.IntegerField()', model_def)\n+        self.assertIn('    f_datetime = models.DateTimeField()', model_def)\n+        self.assertIn('    f_time = models.TimeField()', model_def)\n+        self.assertIn('    f_float = models.FloatField()', model_def)\n+        self.assertIn('    f_char = models.CharField(max_length=10)', model_def)\n+        self.assertIn('    f_date = models.DateField()', model_def)\n+\n+        self.assertTrue(model_def.endswith(\n+            '    geom = models.PolygonField()\\n'\n+            '    objects = models.GeoManager()'\n+        ))\n \n-        self.assertEqual(model_def, '\\n'.join(expected))\n \n def get_ogr_db_string():\n     # Construct the DB string that GDAL will use to inspect the database."
        }
    ],
    "stats": {
        "total": 56,
        "additions": 21,
        "deletions": 35
    }
}