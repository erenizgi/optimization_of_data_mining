{
    "author": "ojeytonwilliams",
    "message": "fix(client): suppress babel transform warning (#57484)",
    "sha": "2f6f28ed14fd04696ff60c9a25adca536b674405",
    "files": [
        {
            "sha": "85a45f5d0cbe8f65a28cd8599f44c2d1ca5e9df9",
            "filename": "client/src/templates/Challenges/rechallenge/transformers.js",
            "status": "modified",
            "additions": 12,
            "deletions": 1,
            "changes": 13,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2f6f28ed14fd04696ff60c9a25adca536b674405/client%2Fsrc%2Ftemplates%2FChallenges%2Frechallenge%2Ftransformers.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2f6f28ed14fd04696ff60c9a25adca536b674405/client%2Fsrc%2Ftemplates%2FChallenges%2Frechallenge%2Ftransformers.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Frechallenge%2Ftransformers.js?ref=2f6f28ed14fd04696ff60c9a25adca536b674405",
            "patch": "@@ -214,6 +214,7 @@ async function transformScript(documentElement, { useModules }) {\n   const scriptTags = documentElement.querySelectorAll('script');\n   scriptTags.forEach(script => {\n     const isBabel = script.type === 'text/babel';\n+    const hasSource = !!script.src;\n     // TODO: make the use of JSX conditional on more than just the script type.\n     // It should only be used for React challenges since it would be confusing\n     // for learners to see the results of a transformation they didn't ask for.\n@@ -228,8 +229,18 @@ async function transformScript(documentElement, { useModules }) {\n     // However, if we're importing modules, the type will be removed when the\n     // scripts are embedded in the HTML.\n     if (isBabel && !useModules) script.removeAttribute('type');\n+    // We could use babel standalone to transform inline code in the preview,\n+    // but that generates a warning that's shown to learner. By removing the\n+    // type attribute and transforming the code we can avoid that warning.\n+    if (isBabel && !hasSource) {\n+      script.removeAttribute('type');\n+      script.setAttribute('data-type', 'text/babel');\n+    }\n \n-    script.innerHTML = babelTransformCode(options)(script.innerHTML);\n+    // Skip unnecessary transformations\n+    script.innerHTML = script.innerHTML\n+      ? babelTransformCode(options)(script.innerHTML)\n+      : '';\n   });\n }\n "
        }
    ],
    "stats": {
        "total": 13,
        "additions": 12,
        "deletions": 1
    }
}