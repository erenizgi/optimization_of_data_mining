{
    "author": "ojeytonwilliams",
    "message": "fix: separate saving logic from render logic (#57516)",
    "sha": "25ebff3ca843399ee924416d3429c1e8bf967949",
    "files": [
        {
            "sha": "d62ed8085243738d84c5d729fe1d8b9d7f0e1f04",
            "filename": "client/src/redux/save-challenge-saga.js",
            "status": "modified",
            "additions": 2,
            "deletions": 6,
            "changes": 8,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/25ebff3ca843399ee924416d3429c1e8bf967949/client%2Fsrc%2Fredux%2Fsave-challenge-saga.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/25ebff3ca843399ee924416d3429c1e8bf967949/client%2Fsrc%2Fredux%2Fsave-challenge-saga.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fredux%2Fsave-challenge-saga.js?ref=25ebff3ca843399ee924416d3429c1e8bf967949",
            "patch": "@@ -1,6 +1,6 @@\n import { call, put, select, takeEvery } from 'redux-saga/effects';\n \n-import { challengeTypes } from '../../../shared/config/challenge-types';\n+import { canSaveToDB } from '../../../shared/config/challenge-types';\n import { createFlashMessage } from '../components/Flash/redux';\n import { FlashMessages } from '../components/Flash/redux/flash-messages';\n import {\n@@ -34,11 +34,7 @@ function* saveChallengeSaga() {\n     );\n   }\n \n-  // only allow saving of multifileCertProject's\n-  if (\n-    challengeType === challengeTypes.multifileCertProject ||\n-    challengeType === challengeTypes.multifilePythonCertProject\n-  ) {\n+  if (canSaveToDB(challengeType)) {\n     const body = standardizeRequestBody({ id, challengeFiles, challengeType });\n     const bodySizeInBytes = getStringSizeInBytes(body);\n "
        },
        {
            "sha": "6832dbd38d02e73f55cef55b2757480791273883",
            "filename": "client/src/templates/Challenges/classic/editor.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 4,
            "changes": 9,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/25ebff3ca843399ee924416d3429c1e8bf967949/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Feditor.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/25ebff3ca843399ee924416d3429c1e8bf967949/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Feditor.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Feditor.tsx?ref=25ebff3ca843399ee924416d3429c1e8bf967949",
            "patch": "@@ -34,7 +34,10 @@ import {\n } from '../../../redux/prop-types';\n import { editorToneOptions } from '../../../utils/tone/editor-config';\n import { editorNotes } from '../../../utils/tone/editor-notes';\n-import { challengeTypes } from '../../../../../shared/config/challenge-types';\n+import {\n+  canSaveToDB,\n+  challengeTypes\n+} from '../../../../../shared/config/challenge-types';\n import {\n   executeChallenge,\n   saveEditorContent,\n@@ -543,9 +546,7 @@ const Editor = (props: EditorProps): JSX.Element => {\n         monaco.KeyMod.WinCtrl | monaco.KeyCode.KEY_S\n       ],\n       run:\n-        (props.challengeType === challengeTypes.multifileCertProject ||\n-          props.challengeType === challengeTypes.multifilePythonCertProject) &&\n-        props.isSignedIn\n+        canSaveToDB(props.challengeType) && props.isSignedIn\n           ? // save to database\n             props.saveChallenge\n           : // save to local storage"
        },
        {
            "sha": "6aa1e72a46f3d5898257b1aa5e6b1581013aa93b",
            "filename": "client/src/templates/Challenges/components/reset-modal.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/25ebff3ca843399ee924416d3429c1e8bf967949/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Freset-modal.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/25ebff3ca843399ee924416d3429c1e8bf967949/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Freset-modal.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Freset-modal.tsx?ref=25ebff3ca843399ee924416d3429c1e8bf967949",
            "patch": "@@ -8,7 +8,7 @@ import { Button, Modal } from '@freecodecamp/ui';\n import { closeModal, resetChallenge } from '../redux/actions';\n import { isResetModalOpenSelector } from '../redux/selectors';\n import callGA from '../../../analytics/call-ga';\n-import { isProjectBased } from '../../../utils/curriculum-layout';\n+import { canSaveToDB } from '../../../../../shared/config/challenge-types';\n \n interface ResetModalProps {\n   close: () => void;\n@@ -54,7 +54,7 @@ function ResetModal({\n       </Modal.Header>\n       <Modal.Body alignment='center'>\n         <p>\n-          {isProjectBased(challengeType)\n+          {canSaveToDB(challengeType)\n             ? t('learn.revert-warn')\n             : t('learn.reset-warn')}\n         </p>\n@@ -69,7 +69,7 @@ function ResetModal({\n           variant='danger'\n           onClick={withActions(reset, close)}\n         >\n-          {isProjectBased(challengeType)\n+          {canSaveToDB(challengeType)\n             ? t('buttons.revert-to-saved-code')\n             : t('buttons.reset-lesson')}\n         </Button>"
        },
        {
            "sha": "47a2151853cbd93abab2cc3b632ff930e8e05f64",
            "filename": "client/src/templates/Challenges/components/tool-panel.tsx",
            "status": "modified",
            "additions": 13,
            "deletions": 20,
            "changes": 33,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/25ebff3ca843399ee924416d3429c1e8bf967949/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Ftool-panel.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/25ebff3ca843399ee924416d3429c1e8bf967949/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Ftool-panel.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Ftool-panel.tsx?ref=25ebff3ca843399ee924416d3429c1e8bf967949",
            "patch": "@@ -6,15 +6,14 @@ import { useTranslation } from 'react-i18next';\n import { connect } from 'react-redux';\n import { bindActionCreators, Dispatch } from 'redux';\n import { createSelector } from 'reselect';\n-import { challengeTypes } from '../../../../../shared/config/challenge-types';\n \n-import './tool-panel.css';\n+import { canSaveToDB } from '../../../../../shared/config/challenge-types';\n import { openModal, executeChallenge } from '../redux/actions';\n import { challengeMetaSelector } from '../redux/selectors';\n-\n import { saveChallenge } from '../../../redux/actions';\n import { isSignedInSelector } from '../../../redux/selectors';\n-import { isProjectBased } from '../../../utils/curriculum-layout';\n+\n+import './tool-panel.css';\n \n const mapStateToProps = createSelector(\n   challengeMetaSelector,\n@@ -77,27 +76,21 @@ function ToolPanel({\n       <Button block={true} variant='primary' onClick={handleRunTests}>\n         {isMobile ? t('buttons.run') : t('buttons.run-test')}\n       </Button>\n-      {isSignedIn &&\n-        (challengeType === challengeTypes.multifileCertProject ||\n-          challengeType === challengeTypes.multifilePythonCertProject) && (\n-          <>\n-            <Spacer size='xxs' />\n-            <Button block={true} variant='primary' onClick={saveChallenge}>\n-              {isMobile ? t('buttons.save') : t('buttons.save-code')}\n-            </Button>\n-          </>\n-        )}\n+      {isSignedIn && canSaveToDB(challengeType) && (\n+        <>\n+          <Spacer size='xxs' />\n+          <Button block={true} variant='primary' onClick={saveChallenge}>\n+            {isMobile ? t('buttons.save') : t('buttons.save-code')}\n+          </Button>\n+        </>\n+      )}\n       <>\n         <Spacer size='xxs' />\n         <Button block={true} variant='primary' onClick={openResetModal}>\n           {isMobile\n-            ? t(\n-                isProjectBased(challengeType)\n-                  ? 'buttons.revert'\n-                  : 'buttons.reset'\n-              )\n+            ? t(canSaveToDB(challengeType) ? 'buttons.revert' : 'buttons.reset')\n             : t(\n-                isProjectBased(challengeType)\n+                canSaveToDB(challengeType)\n                   ? 'buttons.revert-to-saved-code'\n                   : 'buttons.reset-lesson'\n               )}"
        },
        {
            "sha": "2968acb9bc23f9666654c49308dcd5a81a035103",
            "filename": "shared/config/challenge-types.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/25ebff3ca843399ee924416d3429c1e8bf967949/shared%2Fconfig%2Fchallenge-types.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/25ebff3ca843399ee924416d3429c1e8bf967949/shared%2Fconfig%2Fchallenge-types.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/shared%2Fconfig%2Fchallenge-types.ts?ref=25ebff3ca843399ee924416d3429c1e8bf967949",
            "patch": "@@ -143,3 +143,7 @@ export const submitTypes = {\n   [generic]: 'tests',\n   [lab]: 'tests'\n };\n+\n+export const canSaveToDB = (challengeType: number): boolean =>\n+  challengeType === challengeTypes.multifileCertProject ||\n+  challengeType === challengeTypes.multifilePythonCertProject;"
        }
    ],
    "stats": {
        "total": 60,
        "additions": 27,
        "deletions": 33
    }
}