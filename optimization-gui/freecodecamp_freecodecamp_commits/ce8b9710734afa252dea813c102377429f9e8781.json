{
    "author": "ojeytonwilliams",
    "message": "refactor: simplify is-audited logic (#57346)",
    "sha": "ce8b9710734afa252dea813c102377429f9e8781",
    "files": [
        {
            "sha": "a86f40d704b55495b03f4b10f97dc039b54b878e",
            "filename": "client/src/templates/Introduction/components/block.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 5,
            "changes": 7,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ce8b9710734afa252dea813c102377429f9e8781/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ce8b9710734afa252dea813c102377429f9e8781/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock.tsx?ref=ce8b9710734afa252dea813c102377429f9e8781",
            "patch": "@@ -27,7 +27,7 @@ import BlockHeader from './block-header';\n \n import '../intro.css';\n \n-const { curriculumLocale, showUpcomingChanges, showNewCurriculum } = envData;\n+const { curriculumLocale } = envData;\n \n type Challenge = ChallengeNode['challenge'];\n \n@@ -111,10 +111,7 @@ class Block extends Component<BlockProps> {\n       return isGridBased(superBlock, challenge.challengeType);\n     });\n \n-    const isAudited = isAuditedSuperBlock(curriculumLocale, superBlock, {\n-      showNewCurriculum,\n-      showUpcomingChanges\n-    });\n+    const isAudited = isAuditedSuperBlock(curriculumLocale, superBlock);\n \n     const blockTitle = t(`intro:${superBlock}.blocks.${block}.title`);\n     // the real type of TFunction is the type below, because intro can be an array of strings"
        },
        {
            "sha": "a39fdfa2a28551f329282ec0efe316395feba425",
            "filename": "client/src/templates/Introduction/components/help-translate.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 7,
            "changes": 9,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ce8b9710734afa252dea813c102377429f9e8781/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fhelp-translate.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ce8b9710734afa252dea813c102377429f9e8781/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fhelp-translate.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fhelp-translate.tsx?ref=ce8b9710734afa252dea813c102377429f9e8781",
            "patch": "@@ -7,7 +7,7 @@ import { Link } from '../../../components/helpers';\n \n import envData from '../../../../config/env.json';\n \n-const { clientLocale, showUpcomingChanges, showNewCurriculum } = envData;\n+const { clientLocale } = envData;\n \n interface HelpTranslateProps {\n   superBlock: SuperBlocks;\n@@ -16,12 +16,7 @@ interface HelpTranslateProps {\n function HelpTranslate({ superBlock }: HelpTranslateProps): JSX.Element | null {\n   const { t } = useTranslation();\n \n-  if (\n-    isAuditedSuperBlock(clientLocale, superBlock, {\n-      showNewCurriculum,\n-      showUpcomingChanges\n-    })\n-  ) {\n+  if (isAuditedSuperBlock(clientLocale, superBlock)) {\n     return null;\n   }\n "
        },
        {
            "sha": "263356690f037ddf027804eab3ff8a6a14e9f3b9",
            "filename": "curriculum/get-challenges.js",
            "status": "modified",
            "additions": 1,
            "deletions": 4,
            "changes": 5,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ce8b9710734afa252dea813c102377429f9e8781/curriculum%2Fget-challenges.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ce8b9710734afa252dea813c102377429f9e8781/curriculum%2Fget-challenges.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fget-challenges.js?ref=ce8b9710734afa252dea813c102377429f9e8781",
            "patch": "@@ -384,10 +384,7 @@ function generateChallengeCreator(lang, englishPath, i18nPath) {\n           path.resolve(META_DIR, `${getBlockNameFromPath(filePath)}/meta.json`)\n         );\n \n-    const isAudited = isAuditedSuperBlock(lang, meta.superBlock, {\n-      showNewCurriculum: process.env.SHOW_NEW_CURRICULUM,\n-      showUpcomingChanges: process.env.SHOW_UPCOMING_CHANGES\n-    });\n+    const isAudited = isAuditedSuperBlock(lang, meta.superBlock);\n \n     // If we can use the language, do so. Otherwise, default to english.\n     const langUsed = isAudited && fs.existsSync(i18nPath) ? lang : 'english';"
        },
        {
            "sha": "cd80b423e23af0bde6eee480cf2d98d895f6146e",
            "filename": "curriculum/utils.js",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ce8b9710734afa252dea813c102377429f9e8781/curriculum%2Futils.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ce8b9710734afa252dea813c102377429f9e8781/curriculum%2Futils.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Futils.js?ref=ce8b9710734afa252dea813c102377429f9e8781",
            "patch": "@@ -1,6 +1,6 @@\n const path = require('path');\n const {\n-  createFlatSuperBlockMap,\n+  generateSuperBlockList,\n   SuperBlocks\n } = require('../shared/config/curriculum');\n \n@@ -42,7 +42,7 @@ function createSuperOrder(superBlocks) {\n   return superOrder;\n }\n \n-const flatSuperBlockMap = createFlatSuperBlockMap({\n+const flatSuperBlockMap = generateSuperBlockList({\n   showNewCurriculum: process.env.SHOW_NEW_CURRICULUM === 'true',\n   showUpcomingChanges: process.env.SHOW_UPCOMING_CHANGES === 'true'\n });"
        },
        {
            "sha": "d79940d63d887f94996a48a950873573b6383b10",
            "filename": "shared/config/curriculum.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 6,
            "changes": 10,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ce8b9710734afa252dea813c102377429f9e8781/shared%2Fconfig%2Fcurriculum.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ce8b9710734afa252dea813c102377429f9e8781/shared%2Fconfig%2Fcurriculum.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/shared%2Fconfig%2Fcurriculum.test.ts?ref=ce8b9710734afa252dea813c102377429f9e8781",
            "patch": "@@ -4,7 +4,7 @@ import {\n   SuperBlockStage,\n   superBlockStages,\n   notAuditedSuperBlocks,\n-  createFlatSuperBlockMap,\n+  generateSuperBlockList,\n   getAuditedSuperBlocks\n } from './curriculum';\n \n@@ -19,17 +19,17 @@ describe('superBlockOrder', () => {\n   });\n });\n \n-describe('createFlatSuperBlockMap', () => {\n+describe('generateSuperBlockList', () => {\n   it('should return an array of SuperBlocks object with New and Upcoming when { showNewCurriculum: true, showUpcomingChanges: true }', () => {\n-    const result = createFlatSuperBlockMap({\n+    const result = generateSuperBlockList({\n       showNewCurriculum: true,\n       showUpcomingChanges: true\n     });\n     expect(result).toHaveLength(Object.values(superBlockStages).flat().length);\n   });\n \n   it('should return an array of SuperBlocks without New and Upcoming when { showNewCurriculum: false, showUpcomingChanges: false }', () => {\n-    const result = createFlatSuperBlockMap({\n+    const result = generateSuperBlockList({\n       showNewCurriculum: false,\n       showUpcomingChanges: false\n     });\n@@ -64,8 +64,6 @@ describe('getAuditedSuperBlocks', () => {\n   Object.keys(notAuditedSuperBlocks).forEach(language => {\n     it(`should return only audited SuperBlocks for ${language}`, () => {\n       const auditedSuperBlocks = getAuditedSuperBlocks({\n-        showNewCurriculum: true,\n-        showUpcomingChanges: true,\n         language\n       });\n "
        },
        {
            "sha": "681f4ca53091c34a1323b2a2aa78813de30de7d0",
            "filename": "shared/config/curriculum.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 12,
            "changes": 21,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ce8b9710734afa252dea813c102377429f9e8781/shared%2Fconfig%2Fcurriculum.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ce8b9710734afa252dea813c102377429f9e8781/shared%2Fconfig%2Fcurriculum.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/shared%2Fconfig%2Fcurriculum.ts?ref=ce8b9710734afa252dea813c102377429f9e8781",
            "patch": "@@ -248,28 +248,25 @@ type Config = {\n   showUpcomingChanges: boolean;\n };\n \n-type LanguagesConfig = Config & {\n-  language: string;\n-};\n-\n-export function createFlatSuperBlockMap(config: Config): SuperBlocks[] {\n+export function generateSuperBlockList(config: Config): SuperBlocks[] {\n   return getStageOrder(config)\n     .map(stage => superBlockStages[stage])\n     .flat();\n }\n \n export function getAuditedSuperBlocks({\n-  language = 'english',\n-  showNewCurriculum,\n-  showUpcomingChanges\n-}: LanguagesConfig): SuperBlocks[] {\n+  language = 'english'\n+}: {\n+  language: string;\n+}): SuperBlocks[] {\n   if (!Object.prototype.hasOwnProperty.call(notAuditedSuperBlocks, language)) {\n     throw Error(`'${language}' key not found in 'notAuditedSuperBlocks'`);\n   }\n \n-  const flatSuperBlockMap = createFlatSuperBlockMap({\n-    showNewCurriculum,\n-    showUpcomingChanges\n+  // To find the audited superblocks, we need to start with all superblocks.\n+  const flatSuperBlockMap = generateSuperBlockList({\n+    showNewCurriculum: true,\n+    showUpcomingChanges: true\n   });\n   const auditedSuperBlocks = flatSuperBlockMap.filter(\n     superBlock =>"
        },
        {
            "sha": "0c420a1afd5db941df5c47ab4998b2c96bd19f25",
            "filename": "shared/utils/is-audited.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 10,
            "changes": 11,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ce8b9710734afa252dea813c102377429f9e8781/shared%2Futils%2Fis-audited.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ce8b9710734afa252dea813c102377429f9e8781/shared%2Futils%2Fis-audited.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/shared%2Futils%2Fis-audited.ts?ref=ce8b9710734afa252dea813c102377429f9e8781",
            "patch": "@@ -3,22 +3,13 @@ import {\n   getAuditedSuperBlocks\n } from '../../shared/config/curriculum';\n \n-export function isAuditedSuperBlock(\n-  language: string,\n-  superblock: SuperBlocks,\n-  {\n-    showNewCurriculum,\n-    showUpcomingChanges\n-  }: { showNewCurriculum: boolean; showUpcomingChanges: boolean }\n-) {\n+export function isAuditedSuperBlock(language: string, superblock: SuperBlocks) {\n   // TODO: when all the consumers of this function use TypeScript we can remove\n   // this check\n   if (!language || !superblock)\n     throw Error('Both arguments must be provided for auditing');\n \n   const auditedSuperBlocks = getAuditedSuperBlocks({\n-    showNewCurriculum,\n-    showUpcomingChanges,\n     language\n   });\n   return auditedSuperBlocks.includes(superblock);"
        },
        {
            "sha": "f0776aa064fef293f167685e29dac86ac2a37c14",
            "filename": "tools/challenge-auditor/index.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 9,
            "changes": 14,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ce8b9710734afa252dea813c102377429f9e8781/tools%2Fchallenge-auditor%2Findex.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ce8b9710734afa252dea813c102377429f9e8781/tools%2Fchallenge-auditor%2Findex.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-auditor%2Findex.ts?ref=ce8b9710734afa252dea813c102377429f9e8781",
            "patch": "@@ -112,20 +112,16 @@ void (async () => {\n   const langsToCheck = availableLangs.curriculum.filter(\n     lang => String(lang) !== 'english'\n   );\n-  for (const lang of langsToCheck) {\n-    console.log(`\\n=== ${lang} ===`);\n-    const certs = getAuditedSuperBlocks({\n-      language: lang,\n-      showNewCurriculum: process.env.SHOW_NEW_CURRICULUM === 'true',\n-      showUpcomingChanges: process.env.SHOW_UPCOMING_CHANGES === 'true'\n-    });\n+  for (const language of langsToCheck) {\n+    console.log(`\\n=== ${language} ===`);\n+    const certs = getAuditedSuperBlocks({ language });\n     const langCurriculumDirectory = join(\n       process.cwd(),\n       'curriculum',\n       'i18n-curriculum',\n       'curriculum',\n       'challenges',\n-      lang\n+      language\n     );\n     const auditedFiles = englishFilePaths.filter(file =>\n       certs.some(\n@@ -139,7 +135,7 @@ void (async () => {\n     const noMissingFiles = await auditChallengeFiles(auditedFiles, {\n       langCurriculumDirectory\n     });\n-    const noDuplicateSlugs = await auditSlugs(lang, certs);\n+    const noDuplicateSlugs = await auditSlugs(language, certs);\n     if (noMissingFiles && noDuplicateSlugs) {\n       console.log(`All challenges pass.`);\n     } else {"
        }
    ],
    "stats": {
        "total": 81,
        "additions": 26,
        "deletions": 55
    }
}