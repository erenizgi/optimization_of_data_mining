{
    "author": "ojeytonwilliams",
    "message": "fix(tools): sync up unit tests with client tests (#57512)",
    "sha": "5d5dafbd1eff2f0efbf0c9e93b0d6464c665b536",
    "files": [
        {
            "sha": "d8210abfe333cd137aadc9fe7f1ac242b6fc8580",
            "filename": "client/src/templates/Challenges/utils/build.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/5d5dafbd1eff2f0efbf0c9e93b0d6464c665b536/client%2Fsrc%2Ftemplates%2FChallenges%2Futils%2Fbuild.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/5d5dafbd1eff2f0efbf0c9e93b0d6464c665b536/client%2Fsrc%2Ftemplates%2FChallenges%2Futils%2Fbuild.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Futils%2Fbuild.ts?ref=5d5dafbd1eff2f0efbf0c9e93b0d6464c665b536",
            "patch": "@@ -93,7 +93,7 @@ function buildSourceMap(challengeFiles: ChallengeFile[]): Source | undefined {\n   return source;\n }\n \n-const buildFunctions = {\n+export const buildFunctions = {\n   [challengeTypes.js]: buildJSChallenge,\n   [challengeTypes.jsProject]: buildJSChallenge,\n   [challengeTypes.html]: buildDOMChallenge,"
        },
        {
            "sha": "ac6a9e5d00e92302c38375b11b62d476f6894862",
            "filename": "curriculum/test/test-challenges.js",
            "status": "modified",
            "additions": 9,
            "deletions": 21,
            "changes": 30,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/5d5dafbd1eff2f0efbf0c9e93b0d6464c665b536/curriculum%2Ftest%2Ftest-challenges.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/5d5dafbd1eff2f0efbf0c9e93b0d6464c665b536/curriculum%2Ftest%2Ftest-challenges.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Ftest%2Ftest-challenges.js?ref=5d5dafbd1eff2f0efbf0c9e93b0d6464c665b536",
            "patch": "@@ -25,8 +25,9 @@ require('@babel/register')({\n });\n const {\n   buildDOMChallenge,\n-  buildJSChallenge,\n-  buildPythonChallenge\n+  buildPythonChallenge,\n+  buildChallenge,\n+  buildFunctions\n } = require('../../client/src/templates/Challenges/utils/build');\n const {\n   WorkerExecutor\n@@ -407,18 +408,6 @@ function populateTestsForLang({ lang, challenges, meta, superBlocks }) {\n                   return;\n                 }\n \n-                // TODO(after python PR): simplify pipeline and sync with client.\n-                // buildChallengeData should be called and any errors handled.\n-                // canBuildChallenge does not need to exist independently.\n-                const buildChallenge =\n-                  {\n-                    [challengeTypes.js]: buildJSChallenge,\n-                    [challengeTypes.jsProject]: buildJSChallenge,\n-                    [challengeTypes.python]: buildPythonChallenge,\n-                    [challengeTypes.multifilePythonCertProject]:\n-                      buildPythonChallenge\n-                  }[challengeType] ?? buildDOMChallenge;\n-\n                 // The python tests are (currently) slow, so we give them more time.\n                 const timePerTest =\n                   challengeType === challengeTypes.python ? 10000 : 5000;\n@@ -563,18 +552,15 @@ async function createTestRunner(\n   buildChallenge,\n   solutionFromNext\n ) {\n-  const { required = [], template } = challenge;\n-\n   const challengeFiles = replaceChallengeFilesContentsWithSolutions(\n     challenge.challengeFiles,\n     solutionFiles\n   );\n \n   const { build, sources, loadEnzyme } = await buildChallenge(\n     {\n-      challengeFiles,\n-      required,\n-      template\n+      ...challenge,\n+      challengeFiles\n     },\n     { usesTestRunner: true }\n   );\n@@ -585,8 +571,10 @@ async function createTestRunner(\n     original: sources.original\n   };\n \n-  const runsInBrowser = buildChallenge === buildDOMChallenge;\n-  const runsInPythonWorker = buildChallenge === buildPythonChallenge;\n+  const buildFunction = buildFunctions[challenge.challengeType];\n+\n+  const runsInBrowser = buildFunction === buildDOMChallenge;\n+  const runsInPythonWorker = buildFunction === buildPythonChallenge;\n \n   const evaluator = await (runsInBrowser\n     ? getContextEvaluator(build, sources, code, loadEnzyme)"
        }
    ],
    "stats": {
        "total": 32,
        "additions": 10,
        "deletions": 22
    }
}