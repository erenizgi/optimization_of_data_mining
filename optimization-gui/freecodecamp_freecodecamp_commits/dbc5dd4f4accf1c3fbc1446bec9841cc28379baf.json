{
    "author": "ShaunSHamilton",
    "message": "fix(client): .app.tar.gz exam bin is macos (#64095)",
    "sha": "dbc5dd4f4accf1c3fbc1446bec9841cc28379baf",
    "files": [
        {
            "sha": "34675e33066638df3e64b3599b953509f87b7120",
            "filename": "client/src/templates/Challenges/exam-download/show.tsx",
            "status": "modified",
            "additions": 73,
            "deletions": 61,
            "changes": 134,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/dbc5dd4f4accf1c3fbc1446bec9841cc28379baf/client%2Fsrc%2Ftemplates%2FChallenges%2Fexam-download%2Fshow.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/dbc5dd4f4accf1c3fbc1446bec9841cc28379baf/client%2Fsrc%2Ftemplates%2FChallenges%2Fexam-download%2Fshow.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fexam-download%2Fshow.tsx?ref=dbc5dd4f4accf1c3fbc1446bec9841cc28379baf",
            "patch": "@@ -11,7 +11,6 @@ import {\n   Row,\n   Col\n } from '@freecodecamp/ui';\n-import { isEmpty } from 'lodash';\n import { useTranslation, withTranslation } from 'react-i18next';\n import { createSelector } from 'reselect';\n import { connect } from 'react-redux';\n@@ -108,50 +107,72 @@ function ShowExamDownload({\n   const { t } = useTranslation();\n \n   function handleDownloadLink(downloadLinks: string[]) {\n-    const win = downloadLinks.find(link => link.match(/\\.exe/));\n-    const macARM = downloadLinks.find(\n-      link => link.match(/aarch64/) && link.match(/\\.dmg/)\n-    );\n-    const macX64 = downloadLinks.find(\n-      link => link.match(/x64/) && link.match(/\\.dmg/)\n-    );\n-\n-    const linuxARM = downloadLinks.find(\n-      link => link.match(/aarch64/) && link.match(/tar\\.gz/)\n-    );\n-\n-    const linuxX64 = downloadLinks.find(\n-      link => link.match(/amd64/) && link.match(/AppImage/)\n-    );\n+    // Filter out signature and metadata files first\n+    const filtered = downloadLinks.filter(link => !/\\.(sig|json)$/i.test(link));\n+\n+    function normalizeArch(token: string): string {\n+      if (!token) return '';\n+      const t = token.toLowerCase();\n+      if (/aarch64|arm64|arm/i.test(t)) return 'arm';\n+      if (/x86_64|x64|amd64/i.test(t)) return 'x64';\n+      if (/x86|i386|i686/i.test(t)) return 'x86';\n+      return t;\n+    }\n \n-    if (os.os === 'WIN') {\n-      if (isEmpty(win)) return '';\n+    const items = filtered.map(link => {\n+      const urlEnd = link.split('/').pop() ?? '';\n+      const name = urlEnd;\n+      let ext = '';\n+      if (name.endsWith('.app.tar.gz')) ext = '.app.tar.gz';\n+      else if (name.endsWith('.tar.gz')) ext = '.tar.gz';\n+      else if (name.endsWith('.AppImage')) ext = '.AppImage';\n+      else if (name.endsWith('.dmg')) ext = '.dmg';\n+      else if (name.endsWith('.exe')) ext = '.exe';\n+      else {\n+        const m = name.match(/(\\.[^./]+)$/);\n+        ext = m ? m[0] : '';\n+      }\n \n-      return win;\n-    }\n+      const archMatch = name.match(\n+        /(aarch64|arm64|amd64|x86_64|x64|x86|i386)/i\n+      );\n+      const archToken = archMatch ? normalizeArch(archMatch[0]) : '';\n \n-    if (os.os === 'MAC') {\n-      if (os.architecture.toLowerCase() === 'arm') {\n-        if (isEmpty(macARM)) return '';\n+      return { link, name, ext, arch: archToken };\n+    });\n \n-        return macARM;\n-      } else {\n-        if (isEmpty(macX64)) return '';\n+    const detectedArch = normalizeArch(os.architecture || '');\n \n-        return macX64;\n-      }\n+    function pickByExts(exts: string[], preferArch?: string) {\n+      // prefer both ext + arch\n+      let found = items.find(\n+        it => exts.includes(it.ext) && it.arch === preferArch\n+      );\n+      if (found) return found.link;\n+      // then any with ext and unspecified arch\n+      found = items.find(\n+        it => exts.includes(it.ext) && (!preferArch || it.arch === '')\n+      );\n+      if (found) return found.link;\n+      // then any with ext\n+      found = items.find(it => exts.includes(it.ext));\n+      return found ? found.link : '';\n     }\n \n-    if (os.os === 'LINUX') {\n-      if (os.architecture.toLowerCase() === 'arm') {\n-        if (isEmpty(linuxARM)) return '';\n+    if (os.os === 'WIN') {\n+      return pickByExts(['.exe'], detectedArch) || '';\n+    }\n \n-        return linuxARM;\n-      } else {\n-        if (isEmpty(linuxX64)) return '';\n+    if (os.os === 'MAC') {\n+      // prefer .dmg files\n+      return pickByExts(['.dmg'], detectedArch) || '';\n+    }\n \n-        return linuxX64;\n-      }\n+    if (os.os === 'LINUX') {\n+      // prefer AppImage, then .app.tar.gz, then .tar.gz\n+      return (\n+        pickByExts(['.AppImage', '.app.tar.gz', '.tar.gz'], detectedArch) || ''\n+      );\n     }\n \n     return '';\n@@ -337,31 +358,22 @@ function getRecommendedOs({\n   arch: string;\n   ext: string;\n }): string {\n-  switch (arch) {\n-    case 'x64':\n-      switch (ext) {\n-        case '.dmg':\n-          return 'x64 MacOS';\n-        case '.AppImage':\n-        case '.app.tar.gz':\n-          return 'x64 Linux';\n-        default:\n-          return 'x64 Windows';\n-      }\n-    case 'aarch64':\n-      switch (ext) {\n-        case '.dmg':\n-          return 'ARM MacOS';\n-        case '.app.tar.gz':\n-          return 'ARM Linux';\n-        default:\n-          return 'ARM Windows';\n-      }\n-    case 'amd64':\n-      return 'x64 Linux';\n-    default:\n-      return '';\n-  }\n+  const osToExt = {\n+    MacOS: ['.dmg', '.app', '.app.tar.gz'],\n+    Linux: ['.deb', '.rpm', '.AppImage', '.tar.gz', '.AppImage.tar.gz'],\n+    Windows: ['.exe', '.msi']\n+  } as const;\n+  const archToHuman: Record<string, string> = {\n+    x64: '64-bit',\n+    aarch64: 'ARM',\n+    amd64: '64-bit',\n+    i386: '32-bit',\n+    x86: '32-bit'\n+  };\n+\n+  const os = Object.entries(osToExt).find(([_, exts]) => exts.includes(ext));\n+\n+  return `${archToHuman[arch] ?? arch} ${os ? os[0] : ''}`;\n }\n \n function getLatest(releases: GitProps[]): GitProps {"
        }
    ],
    "stats": {
        "total": 134,
        "additions": 73,
        "deletions": 61
    }
}