{
    "author": "gikf",
    "message": "feat(tools): add language block specific properties in helper scripts (#63711)\n\nCo-authored-by: Huyen Nguyen <25715018+huyenltnguyen@users.noreply.github.com>",
    "sha": "8ab7c106dafb3bc1494310e29b251e73573be452",
    "files": [
        {
            "sha": "d340b472741b43aa66b87437f5ed630fa27243d4",
            "filename": "shared/config/curriculum.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 3,
            "changes": 18,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/shared%2Fconfig%2Fcurriculum.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/shared%2Fconfig%2Fcurriculum.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/shared%2Fconfig%2Fcurriculum.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -53,10 +53,22 @@ export const languageSuperBlocks = [\n   SuperBlocks.A2Chinese\n ];\n \n+export enum ChallengeLang {\n+  English = 'en-US',\n+  Spanish = 'es',\n+  Chinese = 'zh-CN'\n+}\n+\n // Mapping from superblock to a speech recognition language (BCP-47)\n-export const superBlockToSpeechLang: Partial<Record<SuperBlocks, string>> = {\n-  [SuperBlocks.A2English]: 'en-US',\n-  [SuperBlocks.B1English]: 'en-US'\n+export const superBlockToSpeechLang: Partial<\n+  Record<SuperBlocks, ChallengeLang>\n+> = {\n+  [SuperBlocks.A1Chinese]: ChallengeLang.Chinese,\n+  [SuperBlocks.A2Chinese]: ChallengeLang.Chinese,\n+  [SuperBlocks.A2English]: ChallengeLang.English,\n+  [SuperBlocks.B1English]: ChallengeLang.English,\n+  [SuperBlocks.A1Spanish]: ChallengeLang.Spanish,\n+  [SuperBlocks.A2Spanish]: ChallengeLang.Spanish\n };\n \n /*"
        },
        {
            "sha": "21ea335824822fdc7d7da4a1cb0659ed78d65985",
            "filename": "tools/challenge-helper-scripts/create-language-block.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 6,
            "changes": 27,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fcreate-language-block.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fcreate-language-block.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fcreate-language-block.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -30,6 +30,7 @@ import {\n   updateSimpleSuperblockStructure,\n   updateChapterModuleSuperblockStructure\n } from './helpers/create-project';\n+import { getLangFromSuperBlock } from './helpers/get-lang-from-superblock';\n \n const helpCategories = [\n   'English',\n@@ -78,13 +79,23 @@ async function createLanguageBlock(\n   }\n   await updateIntroJson(superBlock, block, title);\n \n+  const challengeLang = getLangFromSuperBlock(superBlock);\n   let challengeId: ObjectID;\n \n   if (blockLabel === BlockLabel.quiz) {\n-    challengeId = await createQuizChallenge(block, title, questionCount!);\n+    challengeId = await createQuizChallenge(\n+      block,\n+      title,\n+      questionCount!,\n+      challengeLang\n+    );\n     blockLayout = BlockLayouts.Link;\n   } else {\n-    challengeId = await createDialogueChallenge(superBlock, block);\n+    challengeId = await createDialogueChallenge(\n+      superBlock,\n+      block,\n+      challengeLang\n+    );\n   }\n \n   await createMetaJson(\n@@ -178,7 +189,8 @@ async function createMetaJson(\n \n async function createDialogueChallenge(\n   superBlock: SuperBlocks,\n-  block: string\n+  block: string,\n+  challengeLang: string\n ): Promise<ObjectID> {\n   const { blockContentDir } = getContentConfig('english') as {\n     blockContentDir: string;\n@@ -188,14 +200,16 @@ async function createDialogueChallenge(\n   await fs.mkdir(newChallengeDir, { recursive: true });\n \n   return createDialogueFile({\n-    projectPath: newChallengeDir + '/'\n+    projectPath: newChallengeDir + '/',\n+    challengeLang: challengeLang\n   });\n }\n \n async function createQuizChallenge(\n   block: string,\n   title: string,\n-  questionCount: number\n+  questionCount: number,\n+  challengeLang: string\n ): Promise<ObjectID> {\n   const newChallengeDir = path.resolve(\n     __dirname,\n@@ -208,7 +222,8 @@ async function createQuizChallenge(\n     projectPath: newChallengeDir + '/',\n     title: title,\n     dashedName: block,\n-    questionCount: questionCount\n+    questionCount: questionCount,\n+    challengeLang\n   });\n }\n "
        },
        {
            "sha": "40db674b0e13d9beb3fa329ed57bc1b467e5a5bd",
            "filename": "tools/challenge-helper-scripts/create-next-task.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 2,
            "changes": 14,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fcreate-next-task.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fcreate-next-task.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fcreate-next-task.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -5,18 +5,29 @@ import { getProjectPath } from './helpers/get-project-info';\n import { getMetaData, updateMetaData } from './helpers/project-metadata';\n import {\n   createChallengeFile,\n+  getChallenge,\n   updateTaskMeta,\n   updateTaskMarkdownFiles\n } from './utils';\n+import { getInputType } from './helpers/get-input-type';\n \n const createNextTask = async () => {\n   const { challengeType } = await newTaskPrompts();\n+  const meta = getMetaData();\n+\n+  const prevChallengeId =\n+    meta.challengeOrder[meta.challengeOrder.length - 1]?.id;\n+  const challengeLang = prevChallengeId && getChallenge(prevChallengeId)?.lang;\n+\n+  const inputType = await getInputType(challengeType, challengeLang);\n \n   // Placeholder title, to be replaced by updateTaskMarkdownFiles\n   const options = {\n     title: `Task 0`,\n     dashedName: 'task-0',\n-    challengeType\n+    challengeType,\n+    ...{ ...(challengeLang && { challengeLang }) },\n+    ...{ ...(inputType && { inputType }) }\n   };\n \n   const path = getProjectPath();\n@@ -29,7 +40,6 @@ const createNextTask = async () => {\n   createChallengeFile(challengeIdString, challengeText, path);\n   console.log('Finished creating new task markdown file.');\n \n-  const meta = getMetaData();\n   meta.challengeOrder.push({\n     id: challengeIdString,\n     title: options.title"
        },
        {
            "sha": "ca4936e443b27088fac15282fcac9391c184f868",
            "filename": "tools/challenge-helper-scripts/helpers/get-challenge-template.ts",
            "status": "modified",
            "additions": 18,
            "deletions": 3,
            "changes": 21,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-challenge-template.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-challenge-template.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-challenge-template.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -11,19 +11,34 @@ interface ChallengeOptions {\n   dashedName: string;\n   challengeType: string;\n   questionCount?: number;\n+  challengeLang?: string;\n+  inputType?: string;\n }\n \n const buildFrontMatter = ({\n   challengeId,\n   title,\n   dashedName,\n-  challengeType\n-}: ChallengeOptions) => `---\n+  challengeType,\n+  challengeLang,\n+  inputType\n+}: ChallengeOptions) => {\n+  const langString = challengeLang\n+    ? `\n+lang: ${challengeLang}`\n+    : '';\n+  const inputTypeString = inputType\n+    ? `\n+inputType: ${inputType}`\n+    : '';\n+\n+  return `---\n id: ${challengeId.toString()}\n title: ${sanitizeTitle(title)}\n challengeType: ${challengeType}\n-dashedName: ${dashedName}\n+dashedName: ${dashedName}${langString}${inputTypeString}\n ---`;\n+};\n \n const buildFrontMatterWithVideo = ({\n   challengeId,"
        },
        {
            "sha": "310aaebab05e384c4d5a7d9c8d2f2d174192883d",
            "filename": "tools/challenge-helper-scripts/helpers/get-input-type.ts",
            "status": "added",
            "additions": 25,
            "deletions": 0,
            "changes": 25,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-input-type.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-input-type.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-input-type.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -0,0 +1,25 @@\n+import { prompt } from 'inquirer';\n+import { ChallengeLang } from '../../../shared/config/curriculum';\n+import { challengeTypes } from '../../../shared/config/challenge-types';\n+\n+export const getInputType = async (\n+  challengeType: string,\n+  challengeLang?: string\n+): Promise<string | undefined> => {\n+  const isRequired =\n+    parseInt(challengeType) === challengeTypes.fillInTheBlank &&\n+    challengeLang === ChallengeLang.Chinese;\n+\n+  if (!isRequired) {\n+    return;\n+  }\n+\n+  const inputType = await prompt<{ value: string }>({\n+    name: 'value',\n+    message: 'What input type is challenge using?',\n+    type: 'list',\n+    choices: ['pinyin-tone', 'pinyin-to-hanzi']\n+  });\n+\n+  return inputType.value;\n+};"
        },
        {
            "sha": "a9e17d2d46a151e71fc572ec28cc0390418b7e79",
            "filename": "tools/challenge-helper-scripts/helpers/get-lang-from-superblock.ts",
            "status": "added",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-lang-from-superblock.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-lang-from-superblock.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-lang-from-superblock.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -0,0 +1,15 @@\n+import {\n+  ChallengeLang,\n+  SuperBlocks,\n+  superBlockToSpeechLang\n+} from '../../../shared/config/curriculum';\n+\n+export const getLangFromSuperBlock = (\n+  superBlock: SuperBlocks\n+): ChallengeLang => {\n+  const lang = superBlockToSpeechLang[superBlock];\n+  if (!lang) {\n+    throw new Error(`Missing lang mapping for superBlock: ${superBlock}`);\n+  }\n+  return lang;\n+};"
        },
        {
            "sha": "e3e89bc83ae408d071b2ff9dcbadfec3f4b83ec8",
            "filename": "tools/challenge-helper-scripts/helpers/get-step-template.test.ts",
            "status": "modified",
            "additions": 32,
            "deletions": 18,
            "changes": 50,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.test.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -2,6 +2,24 @@ import { describe, it, expect } from 'vitest';\n import ObjectID from 'bson-objectid';\n import { getStepTemplate } from './get-step-template';\n \n+const props = {\n+  challengeId: new ObjectID('60d4ebe4801158d1abe1b18f'),\n+  challengeSeeds: [\n+    {\n+      contents: '',\n+      editableRegionBoundaries: [0, 2],\n+      ext: 'html',\n+      head: '',\n+      id: '',\n+      key: 'indexhtml',\n+      name: 'index',\n+      tail: ''\n+    }\n+  ],\n+  stepNum: 5,\n+  challengeType: 0\n+};\n+\n // Note: evaluates at highlevel the process, but seedHeads and seedTails could\n // be tested if more specifics are needed.\n describe('getStepTemplate util', () => {\n@@ -35,24 +53,20 @@ Test 1\n --fcc-editable-region--\n \\`\\`\\`\\n`;\n \n-    const props = {\n-      challengeId: new ObjectID('60d4ebe4801158d1abe1b18f'),\n-      challengeSeeds: [\n-        {\n-          contents: '',\n-          editableRegionBoundaries: [0, 2],\n-          ext: 'html',\n-          head: '',\n-          id: '',\n-          key: 'indexhtml',\n-          name: 'index',\n-          tail: ''\n-        }\n-      ],\n-      stepNum: 5,\n-      challengeType: 0\n-    };\n-\n     expect(getStepTemplate(props)).toEqual(baseOutput);\n   });\n+\n+  it('should add lang property when challengeLang is passed', () => {\n+    const frontMatter = `---\n+id: 60d4ebe4801158d1abe1b18f\n+title: Step 5\n+challengeType: 0\n+dashedName: step-5\n+lang: es\n+---`;\n+\n+    expect(getStepTemplate({ ...props, challengeLang: 'es' })).match(\n+      new RegExp(`^${frontMatter}`)\n+    );\n+  });\n });"
        },
        {
            "sha": "08a78db3c7786297fb22c05d31c210dbc63f011c",
            "filename": "tools/challenge-helper-scripts/helpers/get-step-template.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 2,
            "changes": 11,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -26,6 +26,7 @@ type StepOptions = {\n   stepNum: number;\n   challengeType?: number;\n   isFirstChallenge?: boolean;\n+  challengeLang?: string;\n };\n \n export interface ChallengeSeed {\n@@ -42,7 +43,8 @@ function getStepTemplate({\n   challengeSeeds,\n   stepNum,\n   challengeType,\n-  isFirstChallenge = false\n+  isFirstChallenge = false,\n+  challengeLang\n }: StepOptions): string {\n   const seedTexts = challengeSeeds\n     .map(({ contents, ext, editableRegionBoundaries }) => {\n@@ -75,12 +77,17 @@ function getStepTemplate({\n demoType: onClick`\n     : '';\n \n+  const langString = challengeLang\n+    ? `\n+lang: ${challengeLang}`\n+    : '';\n+\n   return (\n     `---\n id: ${challengeId.toString()}\n title: Step ${stepNum}\n challengeType: ${challengeType ?? 'placeholder'}\n-dashedName: step-${stepNum}${demoString}\n+dashedName: step-${stepNum}${langString}${demoString}\n ---\n \n # --description--"
        },
        {
            "sha": "c54ad27e279369c6122cf3c9d68ac4cc792756ff",
            "filename": "tools/challenge-helper-scripts/insert-task.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 1,
            "changes": 8,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Finsert-task.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Finsert-task.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Finsert-task.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -5,11 +5,13 @@ import { newTaskPrompts } from './helpers/new-task-prompts';\n import { getProjectPath } from './helpers/get-project-info';\n import {\n   createChallengeFile,\n+  getChallenge,\n   insertChallengeIntoMeta,\n   updateTaskMeta,\n   updateTaskMarkdownFiles\n } from './utils';\n import { getMetaData } from './helpers/project-metadata';\n+import { getInputType } from './helpers/get-input-type';\n \n const insertChallenge = async () => {\n   const challenges = getMetaData().challengeOrder;\n@@ -22,6 +24,7 @@ const insertChallenge = async () => {\n       value: id\n     }))\n   });\n+  const challengeLang = getChallenge(challengeAfter.id)?.lang;\n \n   const indexToInsert = challenges.findIndex(\n     ({ id }) => id === challengeAfter.id\n@@ -31,10 +34,13 @@ const insertChallenge = async () => {\n \n   const { challengeType } = await newTaskPrompts();\n \n+  const inputType = await getInputType(challengeType, challengeLang);\n   const options = {\n     title: newTaskTitle,\n     dashedName: 'task-0',\n-    challengeType\n+    challengeType,\n+    ...{ ...(challengeLang && { challengeLang }) },\n+    ...{ ...(inputType && { inputType }) }\n   };\n \n   const path = getProjectPath();"
        },
        {
            "sha": "eb47dde57f3027940884d1344f25fe5212e64216",
            "filename": "tools/challenge-helper-scripts/utils.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 6,
            "changes": 22,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Futils.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8ab7c106dafb3bc1494310e29b251e73573be452/tools%2Fchallenge-helper-scripts%2Futils.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Futils.ts?ref=8ab7c106dafb3bc1494310e29b251e73573be452",
            "patch": "@@ -22,13 +22,15 @@ interface Options {\n   projectPath?: string;\n   challengeSeeds?: ChallengeSeed[];\n   isFirstChallenge?: boolean;\n+  challengeLang?: string;\n }\n \n interface QuizOptions {\n   projectPath?: string;\n   title: string;\n   dashedName: string;\n   questionCount: number;\n+  challengeLang?: string;\n }\n \n export async function getAllBlocks() {\n@@ -49,7 +51,8 @@ const createStepFile = ({\n   challengeType,\n   projectPath = getProjectPath(),\n   challengeSeeds = [],\n-  isFirstChallenge = false\n+  isFirstChallenge = false,\n+  challengeLang\n }: Options): ObjectID => {\n   const challengeId = new ObjectID();\n \n@@ -58,7 +61,8 @@ const createStepFile = ({\n     challengeSeeds,\n     stepNum,\n     challengeType,\n-    isFirstChallenge\n+    isFirstChallenge,\n+    challengeLang\n   });\n \n   // eslint-disable-next-line @typescript-eslint/no-base-to-string\n@@ -79,7 +83,8 @@ const createQuizFile = ({\n   projectPath = getProjectPath(),\n   title,\n   dashedName,\n-  questionCount\n+  questionCount,\n+  challengeLang\n }: QuizOptions): ObjectID => {\n   const challengeId = new ObjectID();\n   const challengeType = challengeTypes.quiz.toString();\n@@ -90,17 +95,20 @@ const createQuizFile = ({\n     challengeType,\n     title,\n     dashedName,\n-    questionCount\n+    questionCount,\n+    challengeLang\n   });\n   // eslint-disable-next-line @typescript-eslint/no-base-to-string\n   fs.writeFileSync(`${projectPath}${challengeId.toString()}.md`, quizText);\n   return challengeId;\n };\n \n const createDialogueFile = ({\n-  projectPath\n+  projectPath,\n+  challengeLang\n }: {\n   projectPath: string;\n+  challengeLang: string;\n }): ObjectID => {\n   const challengeId = new ObjectID();\n   const challengeType = challengeTypes.dialogue.toString();\n@@ -110,7 +118,8 @@ const createDialogueFile = ({\n     challengeId,\n     challengeType,\n     title: \"Dialogue 1: I'm Tom\",\n-    dashedName: 'dialogue-1-im-tom'\n+    dashedName: 'dialogue-1-im-tom',\n+    challengeLang\n   });\n   // eslint-disable-next-line @typescript-eslint/no-base-to-string\n   fs.writeFileSync(`${projectPath}${challengeId.toString()}.md`, dialogueText);\n@@ -267,6 +276,7 @@ const updateTaskMarkdownFiles = (): void => {\n type Challenge = {\n   challengeType: number;\n   challengeFiles: ChallengeSeed[];\n+  lang?: string;\n };\n \n const getChallenge = (challengeId: string): Challenge => {"
        }
    ],
    "stats": {
        "total": 211,
        "additions": 170,
        "deletions": 41
    }
}