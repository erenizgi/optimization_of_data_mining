{
    "author": "raisedadead",
    "message": "feat(GHA): configurable SHOW_UPCOMING_CHANGES (#63395)\n\nCo-authored-by: Claude <noreply@anthropic.com>",
    "sha": "982d0fb29055a01b464baece7119df13273d61b3",
    "files": [
        {
            "sha": "b0fc58130faa4a258e3003e4583bf11ffc293580",
            "filename": ".github/workflows/deploy-api.yml",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/982d0fb29055a01b464baece7119df13273d61b3/.github%2Fworkflows%2Fdeploy-api.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/982d0fb29055a01b464baece7119df13273d61b3/.github%2Fworkflows%2Fdeploy-api.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/.github%2Fworkflows%2Fdeploy-api.yml?ref=982d0fb29055a01b464baece7119df13273d61b3",
            "patch": "@@ -11,6 +11,10 @@ on:\n           - info\n           - warn\n         default: info\n+      show_upcoming_changes:\n+        description: 'Show upcoming changes (enables upcoming certifications and challenges)'\n+        type: boolean\n+        default: false\n \n jobs:\n   setup-jobs:\n@@ -21,12 +25,21 @@ jobs:\n       tgt_env_short: ${{ steps.setup.outputs.tgt_env_short }}\n       tgt_env_long: ${{ steps.setup.outputs.tgt_env_long }}\n       api_log_lvl: ${{ steps.setup.outputs.api_log_lvl }}\n+      show_upcoming_changes: ${{ steps.setup.outputs.show_upcoming_changes }}\n     steps:\n       - name: Setup\n         id: setup\n         run: |\n           BRANCH=\"${{ github.ref_name }}\"\n           echo \"Current branch: $BRANCH\"\n+\n+          # Convert boolean input to string 'true' or 'false'\n+          if [[ \"${{ inputs.show_upcoming_changes }}\" == \"true\" ]]; then\n+            echo \"show_upcoming_changes=true\" >> $GITHUB_OUTPUT\n+          else\n+            echo \"show_upcoming_changes=false\" >> $GITHUB_OUTPUT\n+          fi\n+\n           case \"$BRANCH\" in\n             \"prod-current\")\n               echo \"site_tld=org\" >> $GITHUB_OUTPUT\n@@ -49,6 +62,7 @@ jobs:\n     with:\n       site_tld: ${{ needs.setup-jobs.outputs.site_tld }}\n       app: api\n+      show_upcoming_changes: ${{ needs.setup-jobs.outputs.show_upcoming_changes }}\n     secrets: inherit\n \n   deploy:\n@@ -168,6 +182,7 @@ jobs:\n           DEPLOYMENT_ENV: ${{ needs.setup-jobs.outputs.tgt_env_long }}\n           DEPLOYMENT_TLD: ${{ needs.setup-jobs.outputs.site_tld }}\n           FCC_API_LOG_LEVEL: ${{ needs.setup-jobs.outputs.api_log_lvl }}\n+          SHOW_UPCOMING_CHANGES: ${{ needs.setup-jobs.outputs.show_upcoming_changes }}\n           # Stack name\n           STACK_NAME: ${{ needs.setup-jobs.outputs.tgt_env_short }}-api\n         run: |\n@@ -205,6 +220,7 @@ jobs:\n               echo \\\"DEPLOYMENT_TLD=$DEPLOYMENT_TLD\\\"\n               echo \\\"DEPLOYMENT_ENV=$DEPLOYMENT_ENV\\\"\n               echo \\\"FCC_API_LOG_LEVEL=$FCC_API_LOG_LEVEL\\\"\n+              echo \\\"SHOW_UPCOMING_CHANGES=$SHOW_UPCOMING_CHANGES\\\"\n             } >> .env\n \n             echo -e '\\nLOG:Sourcing environment...'"
        },
        {
            "sha": "292ba53d520a3d32a50d631cf89cfc6ebb7717e9",
            "filename": ".github/workflows/deploy-client.yml",
            "status": "modified",
            "additions": 14,
            "deletions": 1,
            "changes": 15,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/982d0fb29055a01b464baece7119df13273d61b3/.github%2Fworkflows%2Fdeploy-client.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/982d0fb29055a01b464baece7119df13273d61b3/.github%2Fworkflows%2Fdeploy-client.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/.github%2Fworkflows%2Fdeploy-client.yml?ref=982d0fb29055a01b464baece7119df13273d61b3",
            "patch": "@@ -19,6 +19,10 @@ on:\n           - german\n           - swahili\n         default: all\n+      show_upcoming_changes:\n+        description: 'Show upcoming changes (enables upcoming certifications and challenges)'\n+        type: boolean\n+        default: false\n \n jobs:\n   setup-jobs:\n@@ -29,12 +33,21 @@ jobs:\n       tgt_env_short: ${{ steps.setup.outputs.tgt_env_short }} # prd, stg\n       tgt_env_long: ${{ steps.setup.outputs.tgt_env_long }} # production, staging\n       tgt_env_branch: ${{ steps.setup.outputs.tgt_env_branch }} # prod-current, prod-staging\n+      show_upcoming_changes: ${{ steps.setup.outputs.show_upcoming_changes }}\n     steps:\n       - name: Setup\n         id: setup\n         run: |\n           BRANCH=\"${{ github.ref_name }}\"\n           echo \"Current branch: $BRANCH\"\n+\n+          # Convert boolean input to string 'true' or 'false'\n+          if [[ \"${{ inputs.show_upcoming_changes }}\" == \"true\" ]]; then\n+            echo \"show_upcoming_changes=true\" >> $GITHUB_OUTPUT\n+          else\n+            echo \"show_upcoming_changes=false\" >> $GITHUB_OUTPUT\n+          fi\n+\n           case \"$BRANCH\" in\n             \"prod-current\")\n               echo \"site_tld=org\" >> $GITHUB_OUTPUT\n@@ -195,7 +208,7 @@ jobs:\n           PATREON_CLIENT_ID: ${{ secrets.PATREON_CLIENT_ID }}\n           PAYPAL_CLIENT_ID: ${{ secrets.PAYPAL_CLIENT_ID }}\n           STRIPE_PUBLIC_KEY: ${{ secrets.STRIPE_PUBLIC_KEY }}\n-          SHOW_UPCOMING_CHANGES: ${{ vars.SHOW_UPCOMING_CHANGES || 'false' }}\n+          SHOW_UPCOMING_CHANGES: ${{ needs.setup-jobs.outputs.show_upcoming_changes }}\n           FREECODECAMP_NODE_ENV: production\n           # The below is used in ecosystem.config.js file for the API -- to be removed later\n           DEPLOYMENT_ENV: ${{ needs.setup-jobs.outputs.tgt_env_long }}"
        },
        {
            "sha": "f408247a2fe63257b1a05a451d9b00497eb35067",
            "filename": ".github/workflows/docker-docr.yml",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/982d0fb29055a01b464baece7119df13273d61b3/.github%2Fworkflows%2Fdocker-docr.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/982d0fb29055a01b464baece7119df13273d61b3/.github%2Fworkflows%2Fdocker-docr.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/.github%2Fworkflows%2Fdocker-docr.yml?ref=982d0fb29055a01b464baece7119df13273d61b3",
            "patch": "@@ -16,6 +16,11 @@ on:\n         type: string\n         description: 'Input: The app (component) to build'\n         default: 'api'\n+      show_upcoming_changes:\n+        required: false\n+        type: string\n+        description: 'Input: Show upcoming changes flag (true/false)'\n+        default: 'false'\n   workflow_call:\n     inputs:\n       site_tld:\n@@ -26,6 +31,11 @@ on:\n         required: true\n         type: string\n         description: 'Input: The app (component) to build'\n+      show_upcoming_changes:\n+        required: false\n+        type: string\n+        description: 'Input: Show upcoming changes flag (true/false)'\n+        default: 'false'\n     outputs:\n       tagname:\n         description: 'Output: The tagname for the image built'\n@@ -54,6 +64,7 @@ jobs:\n       - name: Build & Tag Image\n         run: |\n           docker build \\\n+            --build-arg SHOW_UPCOMING_CHANGES=${{ inputs.show_upcoming_changes }} \\\n             --tag registry.digitalocean.com/${{ secrets.DOCR_NAME }}/${{ inputs.site_tld }}/learn-${{ inputs.app }}:$tagname \\\n             --tag registry.digitalocean.com/${{ secrets.DOCR_NAME }}/${{ inputs.site_tld }}/learn-${{ inputs.app }}:latest \\\n             --file docker/${{ inputs.app }}/Dockerfile ."
        },
        {
            "sha": "89fbae181dc5b11b186c50f0ca963d42f9e5f707",
            "filename": "docker/web/Dockerfile",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/982d0fb29055a01b464baece7119df13273d61b3/docker%2Fweb%2FDockerfile",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/982d0fb29055a01b464baece7119df13273d61b3/docker%2Fweb%2FDockerfile",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/docker%2Fweb%2FDockerfile?ref=982d0fb29055a01b464baece7119df13273d61b3",
            "patch": "@@ -25,10 +25,12 @@ ARG STRIPE_PUBLIC_KEY\n ARG PAYPAL_CLIENT_ID\n ARG PATREON_CLIENT_ID\n ARG DEPLOYMENT_ENV\n-ARG SHOW_UPCOMING_CHANGES\n+ARG SHOW_UPCOMING_CHANGES=false\n ARG GROWTHBOOK_URI\n ARG FREECODECAMP_NODE_ENV\n \n+ENV SHOW_UPCOMING_CHANGES=$SHOW_UPCOMING_CHANGES\n+\n # For simplicity and because node_modules do not make it into the final image,\n # we can just install all dependencies here.\n RUN pnpm install --frozen-lockfile"
        }
    ],
    "stats": {
        "total": 46,
        "additions": 44,
        "deletions": 2
    }
}