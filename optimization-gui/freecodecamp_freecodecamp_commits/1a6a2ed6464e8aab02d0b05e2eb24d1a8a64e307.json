{
    "author": "ojeytonwilliams",
    "message": "fix: superblock intro expansion + test for superblock order (#58928)",
    "sha": "1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307",
    "files": [
        {
            "sha": "3c5ad91b07530101a0f584db3230d0238b611408",
            "filename": "client/src/templates/Introduction/super-block-intro.tsx",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307/client%2Fsrc%2Ftemplates%2FIntroduction%2Fsuper-block-intro.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307/client%2Fsrc%2Ftemplates%2FIntroduction%2Fsuper-block-intro.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FIntroduction%2Fsuper-block-intro.tsx?ref=1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307",
            "patch": "@@ -174,7 +174,7 @@ const SuperBlockIntroductionPage = (props: SuperBlockProps) => {\n \n   const superBlockWithAccordionView = [SuperBlocks.FullStackDeveloper];\n \n-  const getChosenBlock = (): string => {\n+  const getInitiallyExpandedBlock = (): string => {\n     // if coming from breadcrumb click\n     if (\n       location.state &&\n@@ -207,7 +207,7 @@ const SuperBlockIntroductionPage = (props: SuperBlockProps) => {\n       if (!isEmpty(completedChallenges)) {\n         const lastCompletedChallengeId = last(completedChallenges)?.id;\n \n-        const lastCompletedChallenge = allChallenges.find(\n+        const lastCompletedChallenge = superBlockChallenges.find(\n           ({ id }) => id === lastCompletedChallengeId\n         );\n \n@@ -222,10 +222,10 @@ const SuperBlockIntroductionPage = (props: SuperBlockProps) => {\n     const { resetExpansion, toggleBlock } = props;\n \n     resetExpansion();\n-    return toggleBlock(getChosenBlock());\n+    return toggleBlock(getInitiallyExpandedBlock());\n   };\n \n-  const chosenBlock = getChosenBlock();\n+  const initialExpandedBlock = getInitiallyExpandedBlock();\n \n   const onCertificationDonationAlertClick = () => {\n     callGA({\n@@ -262,7 +262,7 @@ const SuperBlockIntroductionPage = (props: SuperBlockProps) => {\n                 <SuperBlockAccordion\n                   challenges={superBlockChallenges}\n                   superBlock={superBlock}\n-                  chosenBlock={chosenBlock}\n+                  chosenBlock={initialExpandedBlock}\n                   completedChallengeIds={completedChallenges.map(c => c.id)}\n                 />\n               ) : ("
        },
        {
            "sha": "d3b617aba72c3398005414bbb1d37b92bacca6be",
            "filename": "e2e/intro-page-rwd.spec.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 32,
            "changes": 53,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307/e2e%2Fintro-page-rwd.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307/e2e%2Fintro-page-rwd.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fintro-page-rwd.spec.ts?ref=1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307",
            "patch": "@@ -2,46 +2,35 @@ import { test, expect } from '@playwright/test';\n \n test.describe('Certification intro page', () => {\n   test('Should render and toggle correctly', async ({ page }) => {\n-    const title = page.getByRole('button', {\n+    const firstBlockToggle = page.getByRole('button', {\n       name: 'Learn HTML by Building a Cat Photo App'\n     });\n \n+    const firstBlockText = page.getByText(\n+      'HTML tags give a webpage its structure. You can use HTML tags to add photos, buttons, and other elements to your webpage.'\n+    );\n+\n+    const secondBlockText = page.getByText(\n+      'CSS tells the browser how to display your webpage. You can use CSS to set the color, font, size, and other aspects of HTML elements.'\n+    );\n+\n+    const superBlockText = page.getByText(\n+      \"this Responsive Web Design Certification, you'll learn the languages that developers use to build webpages\"\n+    );\n+\n     await page.goto('/learn/2022/responsive-web-design');\n \n     await expect(page).toHaveTitle(\n       'Responsive Web Design Certification | freeCodeCamp.org'\n     );\n+    await expect(superBlockText).toBeVisible();\n+    await expect(firstBlockText).toBeVisible();\n+    await expect(secondBlockText).not.toBeVisible();\n+\n+    await firstBlockToggle.click();\n+    await expect(firstBlockText).not.toBeVisible();\n \n-    await expect(\n-      page.getByText(\n-        \"this Responsive Web Design Certification, you'll learn the languages that developers use to build webpages\"\n-      )\n-    ).toBeVisible();\n-\n-    await expect(\n-      page.getByText(\n-        'HTML tags give a webpage its structure. You can use HTML tags to add photos, buttons, and other elements to your webpage.'\n-      )\n-    ).toBeVisible();\n-\n-    await expect(\n-      page.getByText(\n-        'CSS tells the browser how to display your webpage. You can use CSS to set the color, font, size, and other aspects of HTML elements.'\n-      )\n-    ).not.toBeVisible();\n-\n-    await title.click();\n-    await expect(\n-      page.getByText(\n-        'HTML tags give a webpage its structure. You can use HTML tags to add photos, buttons, and other elements to your webpage.'\n-      )\n-    ).not.toBeVisible();\n-\n-    await title.click();\n-    await expect(\n-      page.getByText(\n-        'HTML tags give a webpage its structure. You can use HTML tags to add photos, buttons, and other elements to your webpage.'\n-      )\n-    ).toBeVisible();\n+    await firstBlockToggle.click();\n+    await expect(firstBlockText).toBeVisible();\n   });\n });"
        },
        {
            "sha": "fb144d4afbf765a3091dccdbaf188d88335d7140",
            "filename": "e2e/landing.spec.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307/e2e%2Flanding.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307/e2e%2Flanding.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Flanding.spec.ts?ref=1a6a2ed6464e8aab02d0b05e2eb24d1a8a64e307",
            "patch": "@@ -16,6 +16,7 @@ const landingPageElements = {\n } as const;\n \n const superBlocks = [\n+  intro[SuperBlocks.FullStackDeveloper].title,\n   intro[SuperBlocks.RespWebDesignNew].title,\n   intro[SuperBlocks.JsAlgoDataStructNew].title,\n   intro[SuperBlocks.FrontEndDevLibs].title,\n@@ -28,7 +29,6 @@ const superBlocks = [\n   intro[SuperBlocks.InfoSec].title,\n   intro[SuperBlocks.MachineLearningPy].title,\n   intro[SuperBlocks.CollegeAlgebraPy].title,\n-  intro[SuperBlocks.FullStackDeveloper].title,\n   intro[SuperBlocks.A2English].title,\n   intro[SuperBlocks.B1English].title,\n   intro[SuperBlocks.FoundationalCSharp].title,\n@@ -201,12 +201,13 @@ test.describe('Landing Page', () => {\n     }\n   });\n \n-  test('Has links to all curriculum', async ({ page }) => {\n+  test('Links to all superblocks in order', async ({ page }) => {\n     const curriculumBtns = page.getByTestId(landingPageElements.curriculumBtns);\n     await expect(curriculumBtns).toHaveCount(superBlocks.length);\n     for (let index = 0; index < superBlocks.length; index++) {\n       const btn = curriculumBtns.nth(index);\n-      await expect(btn).toContainText(superBlocks[index]);\n+      const link = btn.getByRole('link', { name: superBlocks[index] });\n+      await expect(link).toBeVisible();\n     }\n   });\n "
        }
    ],
    "stats": {
        "total": 70,
        "additions": 30,
        "deletions": 40
    }
}