{
    "author": "Sembauke",
    "message": "feat: convert output test to Playwright (#54788)\n\nCo-authored-by: Oliver Eyton-Williams <ojeytonwilliams@gmail.com>",
    "sha": "cfc5e7470789a3ff980c5f01a187abdcab63d0c4",
    "files": [
        {
            "sha": "24439884deee71a4e3b46305922a4b8904ed58b4",
            "filename": "cypress/e2e/default/learn/challenges/output.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 108,
            "changes": 108,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/7894b60b7ba11105ae3473f10f87bfbd9a5c7b62/cypress%2Fe2e%2Fdefault%2Flearn%2Fchallenges%2Foutput.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/7894b60b7ba11105ae3473f10f87bfbd9a5c7b62/cypress%2Fe2e%2Fdefault%2Flearn%2Fchallenges%2Foutput.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/cypress%2Fe2e%2Fdefault%2Flearn%2Fchallenges%2Foutput.ts?ref=7894b60b7ba11105ae3473f10f87bfbd9a5c7b62",
            "patch": "@@ -1,108 +0,0 @@\n-import { selectors } from '../../../../support/selectors';\n-\n-const outputSelectors = {\n-  editor: 'div.monaco-editor',\n-  hotkeys: '.default-layout > div',\n-  runTestsButton: 'button:contains(\"Run the Tests\")'\n-};\n-\n-const outputLocations = {\n-  index:\n-    '/learn/responsive-web-design/basic-html-and-html5/' +\n-    'say-hello-to-html-elements',\n-  jQuery:\n-    '/learn/front-end-development-libraries/jquery/' +\n-    'target-html-elements-with-selectors-using-jquery',\n-  js:\n-    '/learn/javascript-algorithms-and-data-structures/basic-javascript/' +\n-    'comment-your-javascript-code'\n-};\n-\n-const defaultOutput = `\n-/**\n-* Your test output will go here\n-*/`;\n-\n-const runningOutput = '// running tests';\n-const finishedOutput = '// tests completed';\n-\n-describe('Classic challenge', function () {\n-  beforeEach(() => {\n-    cy.visit(outputLocations.index);\n-  });\n-\n-  it('renders the default output text', () => {\n-    cy.title().should(\n-      'eq',\n-      'Basic HTML and HTML5: Say Hello to HTML Elements |' + ' freeCodeCamp.org'\n-    );\n-    cy.get(selectors.dataCy.outputText).contains(defaultOutput);\n-  });\n-\n-  it('shows test output when the tests are run', () => {\n-    // first wait for the editor to load\n-    cy.get(outputSelectors.editor, { timeout: 15000 });\n-    cy.get(outputSelectors.runTestsButton).click();\n-\n-    cy.get(selectors.dataCy.outputText).contains(runningOutput);\n-    cy.get(selectors.dataCy.outputText).contains(finishedOutput);\n-  });\n-\n-  it('shows test output when the tests are triggered by the keyboard', () => {\n-    focusEditor().type('{ctrl}{enter}');\n-\n-    cy.get(selectors.dataCy.outputText).contains(runningOutput);\n-    cy.get(selectors.dataCy.outputText).contains(finishedOutput);\n-  });\n-});\n-\n-describe('jQuery challenge', function () {\n-  it('renders the default output text', () => {\n-    cy.visit(outputLocations.jQuery);\n-    cy.title().should(\n-      'eq',\n-      'jQuery: Target HTML Elements with Selectors Using jQuery | freeCodeCamp.org'\n-    );\n-    cy.get(selectors.dataCy.outputText).contains(defaultOutput);\n-\n-    cy.wait(5000);\n-    cy.get(selectors.dataCy.outputText).should(\n-      'not.contain',\n-      'ReferenceError: $ is not defined'\n-    );\n-  });\n-});\n-\n-describe('Custom output for JavaScript objects', function () {\n-  it('Set and map objects', () => {\n-    cy.visit(outputLocations.js);\n-\n-    focusEditor().type('{ctrl}a').clear();\n-    focusEditor().type(\n-      'const set = new Set();{enter}set.add(1);{enter}set.add(\"set\");{enter}set.add(10);{enter}console.log(set);'\n-    );\n-    cy.get(selectors.dataCy.outputText).should(\n-      'contain',\n-      'Set(3) {1, set, 10}'\n-    );\n-\n-    focusEditor().type('{ctrl}a').clear();\n-    focusEditor().type(\n-      'const map = new Map();{enter}map.set(\"first\", 1);{enter}map.set(\"second\", 2);{enter}map.set(\"other\", \"map\");{enter}console.log(map);'\n-    );\n-    cy.get(selectors.dataCy.outputText).should(\n-      'contain',\n-      'Map(3) {first => 1, second => 2, other => map})'\n-    );\n-  });\n-});\n-\n-function focusEditor() {\n-  return cy\n-    .get(outputSelectors.editor, {\n-      timeout: 15000 // first wait for the editor to load\n-    })\n-    .first()\n-    .click()\n-    .focused();\n-}"
        },
        {
            "sha": "ca475307f7f893684b9b7dc7737f25246655fe33",
            "filename": "e2e/output.spec.ts",
            "status": "modified",
            "additions": 124,
            "deletions": 5,
            "changes": 129,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/cfc5e7470789a3ff980c5f01a187abdcab63d0c4/e2e%2Foutput.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/cfc5e7470789a3ff980c5f01a187abdcab63d0c4/e2e%2Foutput.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Foutput.spec.ts?ref=cfc5e7470789a3ff980c5f01a187abdcab63d0c4",
            "patch": "@@ -1,7 +1,7 @@\n import { test, expect, type Page } from '@playwright/test';\n \n import translations from '../client/i18n/locales/english/translations.json';\n-import { getEditors } from './utils/editor';\n+import { clearEditor, getEditors } from './utils/editor';\n \n const outputTexts = {\n   default: `\n@@ -53,13 +53,75 @@ const runChallengeTest = async (page: Page, isMobile: boolean) => {\n   }\n };\n \n-test.beforeEach(async ({ page }) => {\n-  await page.goto(\n-    '/learn/javascript-algorithms-and-data-structures/basic-javascript/declare-javascript-variables'\n-  );\n+test.describe('For classic challenges', () => {\n+  test.beforeEach(async ({ page }) => {\n+    await page.goto(\n+      '/learn/responsive-web-design/basic-html-and-html5/say-hello-to-html-elements'\n+    );\n+  });\n+\n+  test('it renders the default output', async ({ page }) => {\n+    await expect(\n+      page.getByRole('region', {\n+        name: translations.learn['editor-tabs'].console\n+      })\n+    ).toHaveText(outputTexts.default);\n+  });\n+\n+  test('shows test output when the tests are run', async ({\n+    page,\n+    isMobile,\n+    browserName\n+  }) => {\n+    const closeButton = page.getByRole('button', { name: 'Close' });\n+    await expect(page).toHaveTitle(\n+      'Basic HTML and HTML5: Say Hello to HTML Elements |' + ' freeCodeCamp.org'\n+    );\n+\n+    await clearEditor({ browserName, page });\n+    await insertTextInCodeEditor({\n+      page,\n+      isMobile,\n+      text: '<h1>Hello World</h1>'\n+    });\n+    await runChallengeTest(page, isMobile);\n+    await closeButton.click();\n+    await expect(\n+      page.getByRole('region', {\n+        name: translations.learn['editor-tabs'].console\n+      })\n+    ).toHaveText(outputTexts.passed);\n+  });\n+\n+  test('shows test output when the tests are triggered by the keyboard', async ({\n+    page,\n+    isMobile,\n+    browserName\n+  }) => {\n+    const closeButton = page.getByRole('button', { name: 'Close' });\n+    await clearEditor({ browserName, page });\n+    await insertTextInCodeEditor({\n+      page,\n+      isMobile,\n+      text: '<h1>Hello World</h1>'\n+    });\n+    await page.keyboard.press('Control+Enter');\n+    await closeButton.click();\n+    await expect(\n+      page.getByRole('region', {\n+        name: translations.learn['editor-tabs'].console\n+      })\n+    ).toHaveText(outputTexts.passed);\n+  });\n });\n \n test.describe('Challenge Output Component Tests', () => {\n+  test.beforeEach(async ({ page }) => {\n+    await page.goto(\n+      '/learn/javascript-algorithms-and-data-structures/basic-javascript/declare-javascript-variables'\n+    );\n+  });\n+\n   test('should render with default output', async ({ page, isMobile }) => {\n     if (isMobile) {\n       await page.getByRole('tab', { name: 'Console' }).click();\n@@ -125,3 +187,60 @@ test.describe('Challenge Output Component Tests', () => {\n     ).toHaveText(outputTexts.passed);\n   });\n });\n+\n+test.describe('Jquery challenges', () => {\n+  test('Jquery challenge should render with default output', async ({\n+    page\n+  }) => {\n+    await page.goto(\n+      '/learn/front-end-development-libraries/jquery/target-html-elements-with-selectors-using-jquery'\n+    );\n+    await expect(\n+      page.getByRole('region', {\n+        name: translations.learn['editor-tabs'].console\n+      })\n+    ).toHaveText(outputTexts.default);\n+\n+    await expect(\n+      page.getByRole('region', {\n+        name: translations.learn['editor-tabs'].console\n+      })\n+    ).not.toHaveText('ReferenceError: $ is not defined');\n+  });\n+});\n+\n+test.describe('Custom output for Set and Map', () => {\n+  test('Custom output for JavaScript Objects Set and Map', async ({\n+    page,\n+    isMobile,\n+    browserName\n+  }) => {\n+    await page.goto(\n+      '/learn/javascript-algorithms-and-data-structures/basic-javascript/comment-your-javascript-code'\n+    );\n+    await insertTextInCodeEditor({\n+      page,\n+      isMobile,\n+      text: 'const set = new Set(); set.add(1); set.add(\"set\"); set.add(10); console.log(set);'\n+    });\n+    await expect(\n+      page.getByRole('region', {\n+        name: translations.learn['editor-tabs'].console\n+      })\n+    ).toContainText('Set(3) {1, set, 10}');\n+\n+    await clearEditor({ browserName, page });\n+\n+    await insertTextInCodeEditor({\n+      page,\n+      isMobile,\n+      text: 'const map = new Map(); map.set(1, \"one\"); map.set(\"two\", 2); console.log(map);'\n+    });\n+\n+    await expect(\n+      page.getByRole('region', {\n+        name: translations.learn['editor-tabs'].console\n+      })\n+    ).toContainText('Map(2) {1 => one, two => 2}');\n+  });\n+});"
        }
    ],
    "stats": {
        "total": 237,
        "additions": 124,
        "deletions": 113
    }
}