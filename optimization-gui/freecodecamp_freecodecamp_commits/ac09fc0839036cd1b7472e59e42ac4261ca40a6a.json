{
    "author": "huyenltnguyen",
    "message": "fix(tools): ensure module name is available in external curricula data (#60610)",
    "sha": "ac09fc0839036cd1b7472e59e42ac4261ca40a6a",
    "files": [
        {
            "sha": "7d0e95f47a543b438f66e2fed0f4177ec5bdd658",
            "filename": "client/i18n/locales/english/intro.json",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ac09fc0839036cd1b7472e59e42ac4261ca40a6a/client%2Fi18n%2Flocales%2Fenglish%2Fintro.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ac09fc0839036cd1b7472e59e42ac4261ca40a6a/client%2Fi18n%2Flocales%2Fenglish%2Fintro.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fi18n%2Flocales%2Fenglish%2Fintro.json?ref=ac09fc0839036cd1b7472e59e42ac4261ca40a6a",
            "patch": "@@ -1787,6 +1787,7 @@\n       \"css-variables\": \"Variables\",\n       \"css-grid\": \"Grid\",\n       \"css-animations\": \"Animations\",\n+      \"review-css\": \"CSS Review\",\n       \"exam-css\": \"CSS Exam\",\n       \"code-editors\": \"Code Editors\",\n       \"javascript-variables-and-strings\": \"Variables and Strings\",\n@@ -1809,6 +1810,7 @@\n       \"recursion\": \"Recursion\",\n       \"functional-programming\": \"Functional Programming\",\n       \"asynchronous-javascript\": \"Asynchronous JavaScript\",\n+      \"review-javascript\": \"JavaScript Review\",\n       \"exam-javascript\": \"JavaScript Exam\",\n       \"react-fundamentals\": \"React Fundamentals\",\n       \"react-state-hooks-and-routing\": \"React State, Hooks, and Routing\","
        },
        {
            "sha": "02f07b1e5becaca7fcb186dc6c1948b776c2aa1e",
            "filename": "tools/scripts/build/build-external-curricula-data-v2.test.ts",
            "status": "modified",
            "additions": 53,
            "deletions": 18,
            "changes": 71,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ac09fc0839036cd1b7472e59e42ac4261ca40a6a/tools%2Fscripts%2Fbuild%2Fbuild-external-curricula-data-v2.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ac09fc0839036cd1b7472e59e42ac4261ca40a6a/tools%2Fscripts%2Fbuild%2Fbuild-external-curricula-data-v2.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fscripts%2Fbuild%2Fbuild-external-curricula-data-v2.test.ts?ref=ac09fc0839036cd1b7472e59e42ac4261ca40a6a",
            "patch": "@@ -74,18 +74,25 @@ ${result.error.message}`\n   });\n \n   test('the super block files generated should have the correct schema', async () => {\n+    const superBlocks = Object.values(SuperBlocks);\n+\n     const fileArray = (\n       await readdirp.promise(`${clientStaticPath}/curriculum-data/${VERSION}`, {\n         directoryFilter: ['!challenges'],\n         fileFilter: entry => {\n           // The directory contains super block files and other curriculum-related files.\n           // We're only interested in super block ones.\n-          const superBlocks = Object.values(SuperBlocks);\n-          return superBlocks.includes(entry.basename);\n+          const isSuperBlock = superBlocks.some(superBlock =>\n+            entry.basename.includes(superBlock)\n+          );\n+\n+          return isSuperBlock;\n         }\n       })\n     ).map(file => file.path);\n \n+    expect(fileArray.length).toBeGreaterThan(0);\n+\n     fileArray.forEach(fileInArray => {\n       const fileContent = fs.readFileSync(\n         `${clientStaticPath}/curriculum-data/${VERSION}/${fileInArray}`,\n@@ -102,21 +109,30 @@ ${result.error.message}`);\n   });\n \n   test('block-based super blocks and blocks should have the correct data', async () => {\n+    const superBlocks = Object.values(SuperBlocks);\n+\n     const superBlockFiles = (\n       await readdirp.promise(`${clientStaticPath}/curriculum-data/${VERSION}`, {\n         directoryFilter: ['!challenges'],\n         fileFilter: entry => {\n           // The directory contains super block files and other curriculum-related files.\n           // We're only interested in super block ones.\n-          const superBlocks = Object.values(SuperBlocks);\n-          return (\n-            superBlocks.includes(entry.basename) &&\n-            !chapterBasedSuperBlocks.includes(entry.basename)\n+          const isSuperBlock = superBlocks.some(superBlock =>\n+            entry.basename.includes(superBlock)\n           );\n+\n+          const isChapterBasedSuperBlock = chapterBasedSuperBlocks.some(\n+            chapterBasedSuperBlock =>\n+              entry.basename.includes(chapterBasedSuperBlock)\n+          );\n+\n+          return isSuperBlock && !isChapterBasedSuperBlock;\n         }\n       })\n     ).map(file => file.path);\n \n+    expect(superBlockFiles.length).toBeGreaterThan(0);\n+\n     superBlockFiles.forEach(file => {\n       const fileContentJson = fs.readFileSync(\n         `${clientStaticPath}/curriculum-data/${VERSION}/${file}`,\n@@ -135,33 +151,43 @@ ${result.error.message}`);\n       // Randomly pick a block to check its data.\n       const blocks = superBlockData.blocks;\n       const randomBlockIndex = Math.floor(Math.random() * blocks.length);\n+      const randomBlock = blocks[randomBlockIndex];\n \n       expect(superBlockData.intro).toEqual(intros[superBlock].intro);\n       expect(superBlockData.blocks[randomBlockIndex].intro).toEqual(\n-        intros[superBlock].blocks[randomBlockIndex].intro\n+        intros[superBlock].blocks[randomBlock.meta.dashedName as string].intro\n       );\n       expect(superBlockData.blocks[randomBlockIndex].meta.name).toEqual(\n-        intros[superBlock].blocks[randomBlockIndex].title\n+        intros[superBlock].blocks[randomBlock.meta.dashedName as string].title\n       );\n     });\n   });\n \n   test('chapter-based super blocks and blocks should have the correct data', async () => {\n+    const superBlocks = Object.values(SuperBlocks);\n+\n     const superBlockFiles = (\n       await readdirp.promise(`${clientStaticPath}/curriculum-data/${VERSION}`, {\n         directoryFilter: ['!challenges'],\n         fileFilter: entry => {\n           // The directory contains super block files and other curriculum-related files.\n           // We're only interested in super block ones.\n-          const superBlocks = Object.values(SuperBlocks);\n-          return (\n-            superBlocks.includes(entry.basename) &&\n-            chapterBasedSuperBlocks.includes(entry.basename)\n+          const isSuperBlock = superBlocks.some(superBlock =>\n+            entry.basename.includes(superBlock)\n+          );\n+\n+          const isChapterBasedSuperBlock = chapterBasedSuperBlocks.some(\n+            chapterBasedSuperBlock =>\n+              entry.basename.includes(chapterBasedSuperBlock)\n           );\n+\n+          return isSuperBlock && isChapterBasedSuperBlock;\n         }\n       })\n     ).map(file => file.path);\n \n+    expect(superBlockFiles.length).toBeGreaterThan(0);\n+\n     superBlockFiles.forEach(file => {\n       const fileContentJson = fs.readFileSync(\n         `${clientStaticPath}/curriculum-data/${VERSION}/${file}`,\n@@ -182,42 +208,51 @@ ${result.error.message}`);\n       ] as ChapterBasedCurriculumIntros[SuperBlocks];\n \n       // Randomly pick a chapter.\n-      const chapters = superBlockData.chapters;\n+      const chapters = superBlockData.chapters.filter(\n+        ({ comingSoon }) => !comingSoon\n+      );\n       const randomChapterIndex = Math.floor(Math.random() * chapters.length);\n       const randomChapter = chapters[randomChapterIndex];\n \n       // Randomly pick a module.\n-      const modules = randomChapter.modules;\n+      const modules = randomChapter.modules.filter(\n+        ({ comingSoon }) => !comingSoon\n+      );\n       const randomModuleIndex = Math.floor(Math.random() * modules.length);\n       const randomModule = modules[randomModuleIndex];\n \n       // Randomly pick a block.\n       const blocks = randomModule.blocks;\n       const randomBlockIndex = Math.floor(Math.random() * blocks.length);\n+      const randomBlock = blocks[randomBlockIndex];\n \n       // Check super block data\n       expect(superBlockData.intro).toEqual(superBlockIntros.intro);\n \n       // Check chapter data\n       expect(superBlockData.chapters[randomChapterIndex].name).toEqual(\n-        superBlockIntros.chapters[randomChapterIndex]\n+        superBlockIntros.chapters[randomChapter.dashedName]\n       );\n \n       // Check module data\n       expect(\n         superBlockData.chapters[randomChapterIndex].modules[randomModuleIndex]\n           .name\n-      ).toEqual(superBlockIntros.modules[randomModuleIndex]);\n+      ).toEqual(superBlockIntros.modules[randomModule.dashedName]);\n \n       // Check block data\n       expect(\n         superBlockData.chapters[randomChapterIndex].modules[randomModuleIndex]\n           .blocks[randomBlockIndex].intro\n-      ).toEqual(superBlockIntros.blocks[randomBlockIndex].intro);\n+      ).toEqual(\n+        superBlockIntros.blocks[randomBlock.meta.dashedName as string].intro\n+      );\n       expect(\n         superBlockData.chapters[randomChapterIndex].modules[randomModuleIndex]\n           .blocks[randomBlockIndex].meta.name\n-      ).toEqual(superBlockIntros.blocks[randomBlockIndex].title);\n+      ).toEqual(\n+        superBlockIntros.blocks[randomBlock.meta.dashedName as string].title\n+      );\n     });\n   });\n "
        }
    ],
    "stats": {
        "total": 73,
        "additions": 55,
        "deletions": 18
    }
}