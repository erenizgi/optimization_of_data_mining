{
    "author": "Sembauke",
    "message": "feat(api): log disallowed origins  (#59059)",
    "sha": "9cb6677e9f5734c9af00a334ee2bf74840dffcec",
    "files": [
        {
            "sha": "b26c171825997e214e9a2e50a0140930c649faa7",
            "filename": "api/src/plugins/cors.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/9cb6677e9f5734c9af00a334ee2bf74840dffcec/api%2Fsrc%2Fplugins%2Fcors.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/9cb6677e9f5734c9af00a334ee2bf74840dffcec/api%2Fsrc%2Fplugins%2Fcors.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fplugins%2Fcors.ts?ref=9cb6677e9f5734c9af00a334ee2bf74840dffcec",
            "patch": "@@ -10,15 +10,18 @@ const cors: FastifyPluginCallback = (fastify, _options, done) => {\n   });\n \n   fastify.addHook('onRequest', async (req, reply) => {\n+    const logger = fastify.log.child({ req });\n     const origin = req.headers.origin;\n     if (origin && allowedOrigins.includes(origin)) {\n+      // Do we want to log allowed origins?\n       void reply.header('Access-Control-Allow-Origin', origin);\n     } else {\n       // TODO: Discuss if this is the correct approach. Standard practice is to\n       // reflect one of a list of allowed origins and handle development\n       // separately. If we switch to that approach we can replace use\n       // @fastify/cors instead.\n       void reply.header('Access-Control-Allow-Origin', HOME_LOCATION);\n+      logger.debug(`Received request from disallowed origin: ${origin}`);\n     }\n \n     void reply"
        }
    ],
    "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
    }
}