{
    "author": "huyenltnguyen",
    "message": "test(e2e): add tests for the progress reset flow (#54614)",
    "sha": "6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9",
    "files": [
        {
            "sha": "c88efcf73fe979e6d76e1d5f474c6b261ed534d9",
            "filename": "cypress/e2e/default/settings/settings.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 14,
            "changes": 14,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/f3dafb36a49c0d19e018432da1497b8bd138a8b4/cypress%2Fe2e%2Fdefault%2Fsettings%2Fsettings.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/f3dafb36a49c0d19e018432da1497b8bd138a8b4/cypress%2Fe2e%2Fdefault%2Fsettings%2Fsettings.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/cypress%2Fe2e%2Fdefault%2Fsettings%2Fsettings.ts?ref=f3dafb36a49c0d19e018432da1497b8bd138a8b4",
            "patch": "@@ -1,14 +0,0 @@\n-describe('Settings', () => {\n-  before(() => {\n-    cy.login();\n-  });\n-  it('should be possible to reset your progress', () => {\n-    cy.visit('/settings');\n-    cy.contains('Reset all of my progress').click();\n-    cy.contains('Reset everything. I want to start from the beginning').click();\n-    cy.location().should(loc => {\n-      expect(loc.pathname).to.eq('/');\n-    });\n-    cy.contains('Your progress has been reset');\n-  });\n-});"
        },
        {
            "sha": "7e37f0eca487c2e8ef6598477012304552692dac",
            "filename": "e2e/challenge-reset-modal.spec.ts",
            "status": "renamed",
            "additions": 0,
            "deletions": 0,
            "changes": 0,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9/e2e%2Fchallenge-reset-modal.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9/e2e%2Fchallenge-reset-modal.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fchallenge-reset-modal.spec.ts?ref=6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9",
            "previous_filename": "e2e/reset-modal.spec.ts"
        },
        {
            "sha": "a0603ed8265f8c1cec874d47f78af86629c2040a",
            "filename": "e2e/progress-reset-modal.spec.ts",
            "status": "added",
            "additions": 122,
            "deletions": 0,
            "changes": 122,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9/e2e%2Fprogress-reset-modal.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9/e2e%2Fprogress-reset-modal.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fprogress-reset-modal.spec.ts?ref=6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9",
            "patch": "@@ -0,0 +1,122 @@\n+import { exec } from 'child_process';\n+import { promisify } from 'util';\n+import { test, expect } from '@playwright/test';\n+\n+const execP = promisify(exec);\n+\n+test.use({ storageState: 'playwright/.auth/certified-user.json' });\n+\n+test.beforeEach(async ({ page }) => {\n+  await page.goto('/settings');\n+});\n+\n+test.afterEach(async () => {\n+  await execP('node ./tools/scripts/seed/seed-demo-user certified-user');\n+});\n+\n+test.describe('Progress reset modal', () => {\n+  test('should display the content properly', async ({ page }) => {\n+    await page\n+      .getByRole('button', { name: 'Reset all of my progress' })\n+      .click();\n+\n+    await expect(\n+      page.getByRole('dialog', { name: 'Reset My Progress' })\n+    ).toBeVisible();\n+\n+    await expect(\n+      page.getByText(\n+        'This will permanently delete and reset all of the following:'\n+      )\n+    ).toBeVisible();\n+\n+    await expect(\n+      page.getByText(\n+        'Your progress through each step/challenge (all completed challenges will be lost)'\n+      )\n+    ).toBeVisible();\n+\n+    await expect(\n+      page.getByText(\n+        'Any saved code, including partially completed challenges, and certification project code'\n+      )\n+    ).toBeVisible();\n+\n+    await expect(\n+      page.getByText('All completed and claimed certifications')\n+    ).toBeVisible();\n+\n+    await expect(\n+      page.getByText(\n+        'You will effectively be set back to the very first day you signed up.'\n+      )\n+    ).toBeVisible();\n+\n+    await expect(\n+      page.getByText(\n+        \"We won't be able to recover any of it for you later, even if you change your mind.\"\n+      )\n+    ).toBeVisible();\n+\n+    await expect(\n+      page.getByRole('button', {\n+        name: \"Nevermind, I don't want to delete all of my progress\"\n+      })\n+    ).toBeVisible();\n+\n+    await expect(\n+      page.getByRole('button', {\n+        name: 'Reset everything. I want to start from the beginning'\n+      })\n+    ).toBeVisible();\n+  });\n+\n+  test('should close the dialog if the user clicks the cancel button', async ({\n+    page\n+  }) => {\n+    await page\n+      .getByRole('button', { name: 'Reset all of my progress' })\n+      .click();\n+\n+    await expect(\n+      page.getByRole('dialog', { name: 'Reset My Progress' })\n+    ).toBeVisible();\n+\n+    await page\n+      .getByRole('button', {\n+        name: \"Nevermind, I don't want to delete all of my progress\"\n+      })\n+      .click();\n+\n+    await expect(\n+      page.getByRole('dialog', { name: 'Reset My Progress' })\n+    ).toBeHidden();\n+  });\n+\n+  test('should reset the progress if the user clicks the reset button', async ({\n+    page\n+  }) => {\n+    await page\n+      .getByRole('button', { name: 'Reset all of my progress' })\n+      .click();\n+\n+    await expect(\n+      page.getByRole('dialog', { name: 'Reset My Progress' })\n+    ).toBeVisible();\n+\n+    await page\n+      .getByRole('button', {\n+        name: 'Reset everything. I want to start from the beginning'\n+      })\n+      .click();\n+\n+    await page.waitForURL('/');\n+    await expect(page.getByText('Your progress has been reset')).toBeVisible();\n+\n+    // Go to /settings and confirm that all certifications are reset\n+    await page.goto('/settings');\n+    await expect(\n+      page.getByRole('link', { name: 'Show Certification' })\n+    ).toBeHidden();\n+  });\n+});"
        },
        {
            "sha": "601e36ed31df3e76950aaea222d3e655a4f87c8e",
            "filename": "e2e/settings.spec.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 37,
            "changes": 44,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9/e2e%2Fsettings.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9/e2e%2Fsettings.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fsettings.spec.ts?ref=6c3e1cefc1c108fbdf4ebc4861da6cd625cd02d9",
            "patch": "@@ -418,51 +418,21 @@ test.describe('Settings', () => {\n     }\n   });\n \n-  test('Should validate Danger Section Settings', async ({ page }) => {\n+  test('Should display the Danger section properly', async ({ page }) => {\n+    await expect(page.getByText('Danger Zone')).toBeVisible();\n     await expect(\n-      page.getByText(translations.settings.danger.heading, {\n-        exact: true\n-      })\n-    ).toBeVisible();\n-    await expect(\n-      page.getByText(translations.settings.danger['be-careful'], {\n-        exact: true\n-      })\n+      page.getByText(\n+        'Please be careful. Changes in this section are permanent.'\n+      )\n     ).toBeVisible();\n-    await page\n-      .getByRole('button', {\n-        name: translations.settings.danger.reset,\n-        exact: true\n-      })\n-      .click();\n-    await page\n-      .getByRole('button', {\n-        name: translations.settings.danger['nevermind-2'],\n-        exact: true\n-      })\n-      .click();\n     await expect(\n       page.getByRole('button', {\n-        name: translations.settings.danger['reset-confirm'],\n-        exact: true\n+        name: 'Reset all of my progress'\n       })\n     ).toBeVisible();\n-    await page\n-      .getByRole('button', {\n-        name: translations.settings.danger.delete,\n-        exact: true\n-      })\n-      .click();\n-    await page\n-      .getByRole('button', {\n-        name: translations.settings.danger.nevermind,\n-        exact: true\n-      })\n-      .click();\n     await expect(\n       page.getByRole('button', {\n-        name: translations.settings.danger.certain,\n-        exact: true\n+        name: 'Delete my account'\n       })\n     ).toBeVisible();\n   });"
        }
    ],
    "stats": {
        "total": 180,
        "additions": 129,
        "deletions": 51
    }
}