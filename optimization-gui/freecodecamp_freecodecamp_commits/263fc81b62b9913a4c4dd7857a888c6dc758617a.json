{
    "author": "Sembauke",
    "message": "feat: convert \"user token\" tests to Playwright (#54939)",
    "sha": "263fc81b62b9913a4c4dd7857a888c6dc758617a",
    "files": [
        {
            "sha": "d56ee887fdccb32717f73dd776ebf08b3048fdf6",
            "filename": "client/src/components/settings/user-token.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/263fc81b62b9913a4c4dd7857a888c6dc758617a/client%2Fsrc%2Fcomponents%2Fsettings%2Fuser-token.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/263fc81b62b9913a4c4dd7857a888c6dc758617a/client%2Fsrc%2Fcomponents%2Fsettings%2Fuser-token.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2Fsettings%2Fuser-token.tsx?ref=263fc81b62b9913a4c4dd7857a888c6dc758617a",
            "patch": "@@ -27,7 +27,10 @@ class UserToken extends Component<UserTokenProps> {\n     const { t } = this.props;\n \n     return (\n-      <div data-cy='user-token' className='user-token text-center'>\n+      <div\n+        data-playwright-test-label='user-token'\n+        className='user-token text-center'\n+      >\n         <FullWidthRow>\n           <Panel variant='info'>\n             <Panel.Heading>{t('user-token.title')}</Panel.Heading>\n@@ -39,7 +42,6 @@ class UserToken extends Component<UserTokenProps> {\n                 block={true}\n                 size='large'\n                 variant='info'\n-                data-cy='delete-user-token'\n                 onClick={this.deleteToken}\n                 type='button'\n               >"
        },
        {
            "sha": "5c049272b3966af056d3d2ca6a63a7d72c84c96b",
            "filename": "cypress/e2e/default/settings/user-token.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 37,
            "changes": 37,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/1f9da71b5e14b99b0ef72b5de485191ebe356883/cypress%2Fe2e%2Fdefault%2Fsettings%2Fuser-token.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/1f9da71b5e14b99b0ef72b5de485191ebe356883/cypress%2Fe2e%2Fdefault%2Fsettings%2Fuser-token.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/cypress%2Fe2e%2Fdefault%2Fsettings%2Fuser-token.ts?ref=1f9da71b5e14b99b0ef72b5de485191ebe356883",
            "patch": "@@ -1,37 +0,0 @@\n-describe('User token widget on settings page,', function () {\n-  describe('initially', function () {\n-    beforeEach(() => {\n-      cy.task('seed');\n-      cy.login();\n-    });\n-\n-    it('should not render', function () {\n-      cy.visit('/settings');\n-      // make sure 'Danger Zone' is there so we know the page has rendered\n-      cy.contains('Danger Zone');\n-      cy.get('[data-cy=user-token]').should('not.exist');\n-    });\n-  });\n-\n-  describe('after creating token', function () {\n-    beforeEach(() => {\n-      cy.task('seed');\n-      cy.login();\n-      cy.visit(\n-        '/learn/relational-database/learn-bash-by-building-a-boilerplate/build-a-boilerplate'\n-      );\n-      cy.contains('Start the course').click();\n-    });\n-\n-    it('should allow you to delete your token', () => {\n-      cy.visit('/settings');\n-      // make sure 'Danger Zone' is there so we know the page has rendered\n-      cy.contains('Danger Zone');\n-      cy.get('[data-cy=user-token]').should('have.length', 1);\n-\n-      cy.get('[data-cy=delete-user-token]').click();\n-      cy.contains('Your user token has been deleted.');\n-      cy.get('[data-cy=user-token]').should('not.exist');\n-    });\n-  });\n-});"
        },
        {
            "sha": "e97e87ce9446dc367c69921b6a9131fb1547faec",
            "filename": "e2e/user-token.spec.ts",
            "status": "added",
            "additions": 35,
            "deletions": 0,
            "changes": 35,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/263fc81b62b9913a4c4dd7857a888c6dc758617a/e2e%2Fuser-token.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/263fc81b62b9913a4c4dd7857a888c6dc758617a/e2e%2Fuser-token.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fuser-token.spec.ts?ref=263fc81b62b9913a4c4dd7857a888c6dc758617a",
            "patch": "@@ -0,0 +1,35 @@\n+import { execSync } from 'child_process';\n+import { test, expect } from '@playwright/test';\n+test.use({ storageState: 'playwright/.auth/development-user.json' });\n+\n+test.beforeEach(() => {\n+  execSync('node ./tools/scripts/seed/seed-demo-user');\n+});\n+\n+test.afterAll(() => {\n+  execSync('node ./tools/scripts/seed/seed-demo-user certified-user');\n+});\n+\n+test.describe('Initially', () => {\n+  test('should not render', async ({ page }) => {\n+    await page.goto('/settings');\n+    await expect(page.getByTestId('user-token')).not.toBeVisible();\n+  });\n+});\n+\n+test.describe('After creating token', () => {\n+  test('should allow you to delete your token', async ({ page }) => {\n+    await page.goto(\n+      '/learn/relational-database/learn-bash-by-building-a-boilerplate/build-a-boilerplate'\n+    );\n+    await page.getByRole('button', { name: 'Start the course' }).click();\n+\n+    await page.goto('/settings');\n+    await expect(page.getByTestId('user-token')).toBeVisible();\n+    await page.getByRole('button', { name: 'Delete my user token' }).click();\n+    await expect(page.getByTestId('flash-message')).toContainText(\n+      /Your user token has been deleted./\n+    );\n+    await expect(page.getByTestId('user-token')).not.toBeVisible();\n+  });\n+});"
        }
    ],
    "stats": {
        "total": 78,
        "additions": 39,
        "deletions": 39
    }
}