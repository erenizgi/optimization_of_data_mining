{
    "author": "raisedadead",
    "message": "chore(api): improve log statements (#59992)",
    "sha": "a905083bf88887b14de64e0843e3d3e03912b7a8",
    "files": [
        {
            "sha": "d437b94dbef5bd616afe42f22594938444a015e3",
            "filename": "api/src/plugins/error-handling.test.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 2,
            "changes": 10,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/a905083bf88887b14de64e0843e3d3e03912b7a8/api%2Fsrc%2Fplugins%2Ferror-handling.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/a905083bf88887b14de64e0843e3d3e03912b7a8/api%2Fsrc%2Fplugins%2Ferror-handling.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fplugins%2Ferror-handling.test.ts?ref=a905083bf88887b14de64e0843e3d3e03912b7a8",
            "patch": "@@ -170,7 +170,10 @@ describe('errorHandling', () => {\n       url: '/test'\n     });\n \n-    expect(logSpy).toHaveBeenCalledWith(Error('a very bad thing happened'));\n+    expect(logSpy).toHaveBeenCalledWith(\n+      Error('a very bad thing happened'),\n+      'Error in request'\n+    );\n   });\n \n   it('should call fastify.log.warn when a bad request error occurs', async () => {\n@@ -181,7 +184,10 @@ describe('errorHandling', () => {\n       url: '/test-bad-request'\n     });\n \n-    expect(logSpy).toHaveBeenCalledWith(Error('a very bad thing happened'));\n+    expect(logSpy).toHaveBeenCalledWith(\n+      Error('a very bad thing happened'),\n+      'CSRF error in request'\n+    );\n   });\n \n   it('should NOT log when a CSRF error is thrown', async () => {"
        },
        {
            "sha": "eaf812d8bfb9d260ae8bc967d1c0db21b269bc65",
            "filename": "api/src/plugins/error-handling.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/a905083bf88887b14de64e0843e3d3e03912b7a8/api%2Fsrc%2Fplugins%2Ferror-handling.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/a905083bf88887b14de64e0843e3d3e03912b7a8/api%2Fsrc%2Fplugins%2Ferror-handling.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fplugins%2Ferror-handling.ts?ref=a905083bf88887b14de64e0843e3d3e03912b7a8",
            "patch": "@@ -39,9 +39,9 @@ const errorHandling: FastifyPluginCallback = (fastify, _options, done) => {\n \n     if (!isCSRFError) {\n       if (reply.statusCode >= 500) {\n-        logger.error(error);\n+        logger.error(error, 'Error in request');\n       } else {\n-        logger.warn(error);\n+        logger.warn(error, 'CSRF error in request');\n       }\n     }\n "
        },
        {
            "sha": "2bec33749a85edf7dec87616029acc7c61fc76ed",
            "filename": "api/src/routes/protected/challenge.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/a905083bf88887b14de64e0843e3d3e03912b7a8/api%2Fsrc%2Froutes%2Fprotected%2Fchallenge.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/a905083bf88887b14de64e0843e3d3e03912b7a8/api%2Fsrc%2Froutes%2Fprotected%2Fchallenge.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Froutes%2Fprotected%2Fchallenge.ts?ref=a905083bf88887b14de64e0843e3d3e03912b7a8",
            "patch": "@@ -187,7 +187,7 @@ export const challengeRoutes: FastifyPluginCallbackTypebox = (\n         }\n       } catch (error) {\n         // TODO(Post-MVP): don't catch, just let Sentry handle this.\n-        logger.error(error);\n+        logger.error(error, 'Error submitting coderoad challenge');\n         fastify.Sentry.captureException(error);\n         void reply.code(400);\n         return {\n@@ -669,7 +669,7 @@ export const challengeRoutes: FastifyPluginCallbackTypebox = (\n           completedDate\n         };\n       } catch (error) {\n-        logger.error(error);\n+        logger.error(error, 'Error submitting Microsoft trophy challenge');\n         fastify.Sentry.captureException(error);\n         void reply.code(500);\n         return {\n@@ -884,7 +884,7 @@ export const challengeRoutes: FastifyPluginCallbackTypebox = (\n           examResults\n         };\n       } catch (error) {\n-        logger.error(error);\n+        logger.error(error, 'Error submitting exam challenge');\n         fastify.Sentry.captureException(error);\n         void reply.code(500);\n         return {"
        },
        {
            "sha": "887b454784d9df050cfb5d070f768d1d26977247",
            "filename": "api/src/routes/protected/donate.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 4,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/a905083bf88887b14de64e0843e3d3e03912b7a8/api%2Fsrc%2Froutes%2Fprotected%2Fdonate.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/a905083bf88887b14de64e0843e3d3e03912b7a8/api%2Fsrc%2Froutes%2Fprotected%2Fdonate.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Froutes%2Fprotected%2Fdonate.ts?ref=a905083bf88887b14de64e0843e3d3e03912b7a8",
            "patch": "@@ -90,8 +90,7 @@ export const donateRoutes: FastifyPluginCallbackTypebox = (\n           isDonating: true\n         } as const;\n       } catch (error) {\n-        logger.error(`User ${req.user?.id} failed to donate`);\n-        logger.error(error);\n+        logger.error(error, `User ${req.user?.id} failed to donate`);\n         fastify.Sentry.captureException(error);\n         void reply.code(500);\n         return {\n@@ -227,8 +226,7 @@ export const donateRoutes: FastifyPluginCallbackTypebox = (\n           isDonating: true\n         });\n       } catch (error) {\n-        logger.error(`User ${req.user?.id} failed to donate`);\n-        logger.error(error);\n+        logger.error(error, `User ${req.user?.id} failed to donate`);\n         fastify.Sentry.captureException(error);\n         void reply.code(500);\n         return reply.send({"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 15,
        "deletions": 11
    }
}