{
    "author": "ShaunSHamilton",
    "message": "feat(api): add moderation id to attempt (#64286)",
    "sha": "0fd9f06c6cfa3ae1539f312c6452dd8226682795",
    "files": [
        {
            "sha": "6ff3b7c20b346dd57feb4cf4c06afcfa44b349c6",
            "filename": "api/__mocks__/exam-environment-exam.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2F__mocks__%2Fexam-environment-exam.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2F__mocks__%2Fexam-environment-exam.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2F__mocks__%2Fexam-environment-exam.ts?ref=0fd9f06c6cfa3ae1539f312c6452dd8226682795",
            "patch": "@@ -255,6 +255,7 @@ export const generatedExam: ExamEnvironmentGeneratedExam = {\n export const examAttempt: ExamEnvironmentExamAttempt = {\n   examId,\n   generatedExamId: generatedExam.id,\n+  examModerationId: null,\n   id: oid(),\n   questionSets: [\n     {"
        },
        {
            "sha": "48e3a0ca41bcbd8e01bc6f78e745746a88b62846",
            "filename": "api/prisma/exam-environment.prisma",
            "status": "modified",
            "additions": 14,
            "deletions": 9,
            "changes": 23,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2Fprisma%2Fexam-environment.prisma",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2Fprisma%2Fexam-environment.prisma",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fprisma%2Fexam-environment.prisma?ref=0fd9f06c6cfa3ae1539f312c6452dd8226682795",
            "patch": "@@ -118,26 +118,31 @@ type ExamEnvironmentTagConfig {\n \n /// An attempt at an exam in the Exam Environment App\n model ExamEnvironmentExamAttempt {\n-  id              String @id @default(auto()) @map(\"_id\") @db.ObjectId\n+  id               String  @id @default(auto()) @map(\"_id\") @db.ObjectId\n   /// Foriegn key to user\n-  userId          String @db.ObjectId\n+  userId           String  @db.ObjectId\n   /// Foreign key to exam\n-  examId          String @db.ObjectId\n+  examId           String  @db.ObjectId\n   /// Foreign key to generated exam id\n-  generatedExamId String @db.ObjectId\n+  generatedExamId  String  @db.ObjectId\n+  /// Un-enforced foreign key to moderation\n+  examModerationId String? @db.ObjectId\n \n   questionSets ExamEnvironmentQuestionSetAttempt[]\n   /// Time exam was started\n   startTime    DateTime\n   /// Version of the record\n   /// The default must be incremented by 1, if anything in the schema changes\n-  version      Int                                 @default(3)\n+  version      Int                                 @default(4)\n \n   // Relations\n-  user                          user                            @relation(fields: [userId], references: [id], onDelete: Cascade)\n-  exam                          ExamEnvironmentExam             @relation(fields: [examId], references: [id], onDelete: Cascade)\n-  generatedExam                 ExamEnvironmentGeneratedExam    @relation(fields: [generatedExamId], references: [id])\n-  ExamEnvironmentExamModeration ExamEnvironmentExamModeration[]\n+  user                          user                           @relation(fields: [userId], references: [id], onDelete: Cascade)\n+  exam                          ExamEnvironmentExam            @relation(fields: [examId], references: [id], onDelete: Cascade)\n+  generatedExam                 ExamEnvironmentGeneratedExam   @relation(fields: [generatedExamId], references: [id])\n+  // Ideally, there could be a way to add a one-way optional relation here, but Prisma does not allow that:\n+  // Error parsing attribute \"@relation\": The relation fields `examAttempt` on Model `ExamEnvironmentExamModeration` and `examModeration` on Model `ExamEnvironmentExamAttempt` both provide the `references` argument in the @relation attribute. You have to provide it only on one of the two fields.\n+  // examModeration ExamEnvironmentExamModeration? @relation(fields: [examModerationId], references: [id])\n+  examEnvironmentExamModeration ExamEnvironmentExamModeration?\n }\n \n type ExamEnvironmentQuestionSetAttempt {"
        },
        {
            "sha": "1b473135e607f79406401e8f9035e9b8c9b32720",
            "filename": "api/src/exam-environment/routes/exam-environment.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.test.ts?ref=0fd9f06c6cfa3ae1539f312c6452dd8226682795",
            "patch": "@@ -590,6 +590,7 @@ describe('/exam-environment/', () => {\n           userId: defaultUserId,\n           examId: mock.examId,\n           generatedExamId: generatedExam!.id,\n+          examModerationId: null,\n           questionSets: [],\n           // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n           startTime: expect.any(Date),"
        },
        {
            "sha": "323098eb4b50a5fc1b7ac90f1db87d2bd7bdf011",
            "filename": "api/src/exam-environment/routes/exam-environment.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.ts?ref=0fd9f06c6cfa3ae1539f312c6452dd8226682795",
            "patch": "@@ -458,6 +458,7 @@ async function postExamGeneratedExamHandler(\n         userId: user.id,\n         examId: exam.id,\n         generatedExamId: generatedExam.id,\n+        examModerationId: null,\n         startTime: new Date(),\n         questionSets: []\n       }"
        },
        {
            "sha": "c2fe078014d3c6d051054956a13c545b6bc7bf30",
            "filename": "api/src/exam-environment/utils/exam-environment.test.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2Fsrc%2Fexam-environment%2Futils%2Fexam-environment.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0fd9f06c6cfa3ae1539f312c6452dd8226682795/api%2Fsrc%2Fexam-environment%2Futils%2Fexam-environment.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fexam-environment%2Futils%2Fexam-environment.test.ts?ref=0fd9f06c6cfa3ae1539f312c6452dd8226682795",
            "patch": "@@ -518,6 +518,7 @@ describe('Exam Environment Schema', () => {\n         data: {\n           examId: oid(),\n           generatedExamId: oid(),\n+          examModerationId: null,\n           questionSets: [\n             {\n               id: oid(),"
        }
    ],
    "stats": {
        "total": 27,
        "additions": 18,
        "deletions": 9
    }
}