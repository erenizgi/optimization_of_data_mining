{
    "author": "raisedadead",
    "message": "fix(sentry): use environments",
    "sha": "4d4e617b7d7573af84854076229204a4ea55f6cd",
    "files": [
        {
            "sha": "05fefba76528fa6bdb7ba388370c0b612dbfec38",
            "filename": "api/src/plugins/error-handling.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/4d4e617b7d7573af84854076229204a4ea55f6cd/api%2Fsrc%2Fplugins%2Ferror-handling.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/4d4e617b7d7573af84854076229204a4ea55f6cd/api%2Fsrc%2Fplugins%2Ferror-handling.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fplugins%2Ferror-handling.ts?ref=4d4e617b7d7573af84854076229204a4ea55f6cd",
            "patch": "@@ -2,7 +2,7 @@ import type { FastifyPluginCallback } from 'fastify';\n import fastifySentry from '@immobiliarelabs/fastify-sentry';\n import fp from 'fastify-plugin';\n \n-import { SENTRY_DSN } from '../utils/env';\n+import { SENTRY_DSN, SENTRY_ENVIRONMENT } from '../utils/env';\n import { getRedirectParams } from '../utils/redirection';\n \n /**\n@@ -15,6 +15,7 @@ import { getRedirectParams } from '../utils/redirection';\n const errorHandling: FastifyPluginCallback = (fastify, _options, done) => {\n   void fastify.register(fastifySentry, {\n     dsn: SENTRY_DSN,\n+    environment: SENTRY_ENVIRONMENT,\n     maxValueLength: 8192, // the default is 250, which is too small.\n     // No need to initialize if DSN is not provided (e.g. in development and\n     // test environments)"
        },
        {
            "sha": "52d2316ad99b5593ad770de7228e447809673945",
            "filename": "api/src/utils/env.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/4d4e617b7d7573af84854076229204a4ea55f6cd/api%2Fsrc%2Futils%2Fenv.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/4d4e617b7d7573af84854076229204a4ea55f6cd/api%2Fsrc%2Futils%2Fenv.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Futils%2Fenv.ts?ref=4d4e617b7d7573af84854076229204a4ea55f6cd",
            "patch": "@@ -71,13 +71,19 @@ if (process.env.FREECODECAMP_NODE_ENV !== 'development') {\n   assert.ok(process.env.PORT);\n   assert.ok(process.env.HOST);\n   assert.ok(process.env.SENTRY_DSN);\n+  assert.ok(process.env.SENTRY_ENVIRONMENT);\n   // The following values can exist in development, but production-like\n   // environments need to override the defaults.\n   assert.notEqual(\n     process.env.SENTRY_DSN,\n     'dsn_from_sentry_dashboard',\n     `The DSN from Sentry's dashboard should be used.`\n   );\n+  assert.notEqual(\n+    process.env.SENTRY_ENVIRONMENT,\n+    'development',\n+    `The Sentry environment should be changed from the default.`\n+  );\n   assert.notEqual(\n     process.env.JWT_SECRET,\n     'a_jwt_secret',\n@@ -133,6 +139,10 @@ export const SENTRY_DSN =\n   process.env.SENTRY_DSN === 'dsn_from_sentry_dashboard'\n     ? ''\n     : process.env.SENTRY_DSN;\n+export const SENTRY_ENVIRONMENT =\n+  process.env.SENTRY_ENVIRONMENT === 'development'\n+    ? ''\n+    : process.env.SENTRY_ENVIRONMENT;\n export const COOKIE_DOMAIN = process.env.COOKIE_DOMAIN;\n export const COOKIE_SECRET = process.env.COOKIE_SECRET;\n export const JWT_SECRET = process.env.JWT_SECRET;"
        },
        {
            "sha": "1150fff9a5ae97beb949edd9a80a2f7cdaf2da37",
            "filename": "sample.env",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/4d4e617b7d7573af84854076229204a4ea55f6cd/sample.env",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/4d4e617b7d7573af84854076229204a4ea55f6cd/sample.env",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/sample.env?ref=4d4e617b7d7573af84854076229204a4ea55f6cd",
            "patch": "@@ -4,7 +4,7 @@ MONGOHQ_URL=mongodb://127.0.0.1:27017/freecodecamp?directConnection=true\n # Logging\n SENTRY_DSN=dsn_from_sentry_dashboard\n SENTRY_CLIENT_DSN=dsn_from_sentry_dashboard\n-SENTRY_ENVIRONMENT=staging\n+SENTRY_ENVIRONMENT=development\n \n # Auth0 - OAuth 2.0 Credentials\n AUTH0_CLIENT_ID=client_id_from_auth0_dashboard"
        }
    ],
    "stats": {
        "total": 15,
        "additions": 13,
        "deletions": 2
    }
}