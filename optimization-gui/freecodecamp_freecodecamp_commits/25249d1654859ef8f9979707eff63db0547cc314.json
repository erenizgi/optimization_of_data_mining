{
    "author": "Arif-Khalid",
    "message": "feat(client): Persist editor open tabs (#59103)\n\nCo-authored-by: sembauke <semboot699@gmail.com>",
    "sha": "25249d1654859ef8f9979707eff63db0547cc314",
    "files": [
        {
            "sha": "7a468a7259db4da8bb95697c6b347295c5a67e26",
            "filename": "client/src/templates/Challenges/redux/index.js",
            "status": "modified",
            "additions": 24,
            "deletions": 4,
            "changes": 28,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/25249d1654859ef8f9979707eff63db0547cc314/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Findex.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/25249d1654859ef8f9979707eff63db0547cc314/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Findex.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Findex.js?ref=25249d1654859ef8f9979707eff63db0547cc314",
            "patch": "@@ -150,10 +150,30 @@ export const reducer = handleActions(\n         ? state.consoleOut\n         : state.consoleOut.concat(payload, state.logsOut)\n     }),\n-    [actionTypes.initVisibleEditors]: state => ({\n-      ...state,\n-      visibleEditors: { [getTargetEditor(state.challengeFiles)]: true }\n-    }),\n+    [actionTypes.initVisibleEditors]: state => {\n+      let persistingVisibleEditors = {};\n+      const prevVisibleEditorKeys = Object.keys(state.visibleEditors);\n+      if (prevVisibleEditorKeys.length > 1) {\n+        // Restore states of relevant visible editors for the current challengeFiles\n+        persistingVisibleEditors = prevVisibleEditorKeys\n+          .filter(editorKey => {\n+            return state.challengeFiles.find(\n+              challengeFile => challengeFile.fileKey === editorKey\n+            );\n+          })\n+          .reduce((visibleEditors, key) => {\n+            visibleEditors[key] = state.visibleEditors[key];\n+            return visibleEditors;\n+          }, {});\n+      }\n+      return {\n+        ...state,\n+        visibleEditors: {\n+          ...persistingVisibleEditors,\n+          [getTargetEditor(state.challengeFiles)]: true\n+        }\n+      };\n+    },\n     [actionTypes.updateChallengeMeta]: (state, { payload }) => ({\n       ...state,\n       challengeMeta: { ...payload }"
        },
        {
            "sha": "f9df1cb6fce812f0cc1815f429e1691b5d56b521",
            "filename": "e2e/fixtures/learn-basic-css-by-building-a-cafe-menu-15.json",
            "status": "added",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/25249d1654859ef8f9979707eff63db0547cc314/e2e%2Ffixtures%2Flearn-basic-css-by-building-a-cafe-menu-15.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/25249d1654859ef8f9979707eff63db0547cc314/e2e%2Ffixtures%2Flearn-basic-css-by-building-a-cafe-menu-15.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Ffixtures%2Flearn-basic-css-by-building-a-cafe-menu-15.json?ref=25249d1654859ef8f9979707eff63db0547cc314",
            "patch": "@@ -0,0 +1,3 @@\n+{\n+  \"content\": \"<!DOCTYPE html><html lang=\\\"en\\\"><head><meta charset=\\\"utf-8\\\" /><title>Cafe Menu</title></head><body><main><h1>CAMPER CAFE</h1><p>Est. 2020</p><section><h2>Coffee</h2></section></main></body></html>\"\n+}"
        },
        {
            "sha": "15588a810647c8ec1a6b5ef80827410ca7a3b740",
            "filename": "e2e/multifile-editor.spec.ts",
            "status": "modified",
            "additions": 53,
            "deletions": 1,
            "changes": 54,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/25249d1654859ef8f9979707eff63db0547cc314/e2e%2Fmultifile-editor.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/25249d1654859ef8f9979707eff63db0547cc314/e2e%2Fmultifile-editor.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fmultifile-editor.spec.ts?ref=25249d1654859ef8f9979707eff63db0547cc314",
            "patch": "@@ -1,6 +1,8 @@\n import { test, expect } from '@playwright/test';\n \n-import { getEditors } from './utils/editor';\n+import { clearEditor, focusEditor, getEditors } from './utils/editor';\n+import solution from './fixtures/learn-basic-css-by-building-a-cafe-menu-15.json';\n+import { isMacOS } from './utils/user-agent';\n \n test.beforeEach(async ({ page }) => {\n   await page.goto(\n@@ -72,4 +74,54 @@ test.describe('MultifileEditor Component', () => {\n \n     expect(await editorPane.getAttribute('style')).toBe(newStyle);\n   });\n+\n+  test('Multiple open editors should remain open on moving to next challenge', async ({\n+    page,\n+    isMobile,\n+    browserName,\n+    context\n+  }) => {\n+    test.skip(\n+      browserName !== 'chromium',\n+      'Only chromium allows us to use the clipboard API.'\n+    );\n+    await context.grantPermissions(['clipboard-read', 'clipboard-write']);\n+\n+    await focusEditor({ page, isMobile });\n+    await clearEditor({ page, browserName });\n+\n+    await page.evaluate(\n+      async solution => await navigator.clipboard.writeText(solution.content),\n+      solution\n+    );\n+\n+    if (isMacOS) {\n+      await page.keyboard.press('Meta+v');\n+    } else {\n+      await page.keyboard.press('Control+v');\n+    }\n+\n+    const stylesEditor = page.getByRole('button', {\n+      name: 'styles.css Editor'\n+    });\n+    await stylesEditor.click();\n+    const editorsCurrentPage = getEditors(page);\n+    await expect(editorsCurrentPage).toHaveCount(2);\n+\n+    await page.keyboard.press('Control+Enter');\n+\n+    const submitButton = page.getByRole('button', {\n+      name: 'Submit and go to next challenge'\n+    });\n+\n+    // Mobile screen shifts submit button out of view and Playwright fails at scrolling with multiple editors open\n+    if (isMobile) {\n+      await submitButton.dispatchEvent('click');\n+    } else {\n+      await submitButton.click();\n+    }\n+\n+    const editorsNextPage = getEditors(page);\n+    await expect(editorsNextPage).toHaveCount(2);\n+  });\n });"
        }
    ],
    "stats": {
        "total": 85,
        "additions": 80,
        "deletions": 5
    }
}