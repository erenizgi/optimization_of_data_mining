{
    "author": "moT01",
    "message": "feat(api): daily challenge by month endpoint (#61400)",
    "sha": "e6066a1d50a1835b7f12cabb107ec8c57ee12d0c",
    "files": [
        {
            "sha": "2fe0baec688bb85905f9ab71f3c216b88a56b60a",
            "filename": "api/src/daily-coding-challenge/routes/daily-coding-challenge.test.ts",
            "status": "modified",
            "additions": 98,
            "deletions": 11,
            "changes": 109,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/e6066a1d50a1835b7f12cabb107ec8c57ee12d0c/api%2Fsrc%2Fdaily-coding-challenge%2Froutes%2Fdaily-coding-challenge.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/e6066a1d50a1835b7f12cabb107ec8c57ee12d0c/api%2Fsrc%2Fdaily-coding-challenge%2Froutes%2Fdaily-coding-challenge.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fdaily-coding-challenge%2Froutes%2Fdaily-coding-challenge.test.ts?ref=e6066a1d50a1835b7f12cabb107ec8c57ee12d0c",
            "patch": "@@ -92,18 +92,29 @@ describe('/daily-coding-challenge', () => {\n     });\n \n     it('should return 400 for an invalid date format', async () => {\n-      const res = await superRequest(\n-        '/daily-coding-challenge/date/invalid-format',\n-        {\n-          method: 'GET'\n-        }\n-      ).send({});\n+      const invalidFormats = [\n+        'invalid-format',\n+        '2025-07',\n+        '07-18-2025',\n+        '25-07-18',\n+        '2025-7-18',\n+        '2025-07-8'\n+      ];\n \n-      expect(res.status).toBe(400);\n-      expect(res.body).toEqual({\n-        type: 'error',\n-        message: 'Invalid date format. Please use YYYY-MM-DD.'\n-      });\n+      for (const invalidFormat of invalidFormats) {\n+        const res = await superRequest(\n+          `/daily-coding-challenge/date/${invalidFormat}`,\n+          {\n+            method: 'GET'\n+          }\n+        ).send({});\n+\n+        expect(res.status).toBe(400);\n+        expect(res.body).toEqual({\n+          type: 'error',\n+          message: 'Invalid date format. Please use YYYY-MM-DD.'\n+        });\n+      }\n     });\n \n     it('should return 404 for a date without a challenge', async () => {\n@@ -188,6 +199,82 @@ describe('/daily-coding-challenge', () => {\n     });\n   });\n \n+  describe('GET /daily-coding-challenge/month/:month', () => {\n+    beforeEach(async () => {\n+      await fastifyTestInstance.prisma.dailyCodingChallenges.createMany({\n+        data: mockChallenges\n+      });\n+    });\n+\n+    afterEach(async () => {\n+      await fastifyTestInstance.prisma.dailyCodingChallenges.deleteMany();\n+    });\n+\n+    it('should return 400 for invalid month format', async () => {\n+      const invalidFormats = ['invalid-month', '2025-13', '2025-1', '25-07'];\n+\n+      for (const invalidFormat of invalidFormats) {\n+        const res = await superRequest(\n+          `/daily-coding-challenge/month/${invalidFormat}`,\n+          {\n+            method: 'GET'\n+          }\n+        ).send({});\n+\n+        expect(res.status).toBe(400);\n+        expect(res.body).toEqual({\n+          type: 'error',\n+          message: 'Invalid date format. Please use YYYY-MM.'\n+        });\n+      }\n+    });\n+\n+    it('should return { id, date, challengeNumber, title } for all available challenges of the given month up to today US Central', async () => {\n+      const currentMonth = todayUsCentral.toISOString().slice(0, 7);\n+\n+      const res = await superRequest(\n+        `/daily-coding-challenge/month/${currentMonth}`,\n+        {\n+          method: 'GET'\n+        }\n+      ).send({});\n+\n+      expect(res.status).toBe(200);\n+      expect(Array.isArray(res.body)).toBe(true);\n+\n+      // Should include yesterday's and today's challenges, but not tomorrow's\n+      const expectedResponse = [\n+        {\n+          id: todaysChallenge.id,\n+          challengeNumber: todaysChallenge.challengeNumber,\n+          date: todaysChallenge.date.toISOString(),\n+          title: todaysChallenge.title\n+        },\n+        {\n+          id: yesterdaysChallenge.id,\n+          challengeNumber: yesterdaysChallenge.challengeNumber,\n+          date: yesterdaysChallenge.date.toISOString(),\n+          title: yesterdaysChallenge.title\n+        }\n+      ];\n+\n+      expect(res.body).toHaveLength(2);\n+      expect(res.body).toEqual(expectedResponse);\n+    });\n+\n+    it('should return 404 when no challenges exist for the given month', async () => {\n+      const res = await superRequest('/daily-coding-challenge/month/2024-01', {\n+        method: 'GET'\n+      }).send({});\n+\n+      expect(res.status).toBe(404);\n+      expect(res.body).toEqual({\n+        type: 'error',\n+        message: 'No challenges found.'\n+      });\n+    });\n+  });\n+\n   describe('GET /daily-coding-challenge/all', () => {\n     beforeEach(async () => {\n       await fastifyTestInstance.prisma.dailyCodingChallenges.createMany({"
        },
        {
            "sha": "ba35f16f1f9d9cd04d786409e04af7ebf1d21c2e",
            "filename": "api/src/daily-coding-challenge/routes/daily-coding-challenge.ts",
            "status": "modified",
            "additions": 73,
            "deletions": 0,
            "changes": 73,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/e6066a1d50a1835b7f12cabb107ec8c57ee12d0c/api%2Fsrc%2Fdaily-coding-challenge%2Froutes%2Fdaily-coding-challenge.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/e6066a1d50a1835b7f12cabb107ec8c57ee12d0c/api%2Fsrc%2Fdaily-coding-challenge%2Froutes%2Fdaily-coding-challenge.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fdaily-coding-challenge%2Froutes%2Fdaily-coding-challenge.ts?ref=e6066a1d50a1835b7f12cabb107ec8c57ee12d0c",
            "patch": "@@ -111,6 +111,79 @@ export const dailyCodingChallengeRoutes: FastifyPluginCallbackTypebox = (\n     }\n   );\n \n+  fastify.get(\n+    '/daily-coding-challenge/month/:month',\n+    {\n+      schema: schemas.dailyCodingChallenge.month\n+    },\n+    async (req, reply) => {\n+      const logger = fastify.log.child({ req, res: reply });\n+      logger.info('Received request for month of daily coding challenges', {\n+        month: req.params.month\n+      });\n+\n+      const { month } = req.params;\n+\n+      try {\n+        // Month is guaranteed YYYY-MM format from schema validation\n+        const parts = month.split('-');\n+        const parsedYear = parseInt(parts[0]!, 10);\n+        const parsedMonth = parseInt(parts[1]!, 10);\n+\n+        // Validate month range\n+        if (parsedMonth < 1 || parsedMonth > 12) {\n+          logger.warn('Invalid month value requested', { month });\n+          return reply.status(400).send({\n+            type: 'error',\n+            message: 'Invalid date format. Please use YYYY-MM.'\n+          });\n+        }\n+\n+        const monthStart = new Date(Date.UTC(parsedYear, parsedMonth - 1, 1));\n+        const monthEnd = new Date(Date.UTC(parsedYear, parsedMonth, 1));\n+        const todayUsCentral = getUtcMidnight(getNowUsCentral());\n+\n+        const challenges = await fastify.prisma.dailyCodingChallenges.findMany({\n+          where: {\n+            date: {\n+              gte: monthStart,\n+              lt: monthEnd,\n+              lte: todayUsCentral\n+            }\n+          },\n+          orderBy: {\n+            date: 'desc'\n+          },\n+          select: {\n+            id: true,\n+            challengeNumber: true,\n+            date: true,\n+            title: true\n+          }\n+        });\n+\n+        if (!challenges || challenges.length === 0) {\n+          logger.warn('No challenges found for month', { month });\n+          return reply\n+            .status(404)\n+            .send({ type: 'error', message: 'No challenges found.' });\n+        }\n+\n+        const response = challenges.map(challenge => ({\n+          ...challenge,\n+          date: challenge.date.toISOString()\n+        }));\n+\n+        return reply.send(response);\n+      } catch (error) {\n+        logger.error(error, 'Failed to get monthly daily coding challenges.');\n+        await reply\n+          .status(500)\n+          .send({ type: 'error', message: 'Internal server error.' });\n+      }\n+    }\n+  );\n+\n   fastify.get(\n     '/daily-coding-challenge/all',\n     {"
        },
        {
            "sha": "0a23082fb4e225d7316b0bebff0374fcce82c06a",
            "filename": "api/src/daily-coding-challenge/schemas/daily-coding-challenge.ts",
            "status": "modified",
            "additions": 37,
            "deletions": 13,
            "changes": 50,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/e6066a1d50a1835b7f12cabb107ec8c57ee12d0c/api%2Fsrc%2Fdaily-coding-challenge%2Fschemas%2Fdaily-coding-challenge.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/e6066a1d50a1835b7f12cabb107ec8c57ee12d0c/api%2Fsrc%2Fdaily-coding-challenge%2Fschemas%2Fdaily-coding-challenge.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fdaily-coding-challenge%2Fschemas%2Fdaily-coding-challenge.ts?ref=e6066a1d50a1835b7f12cabb107ec8c57ee12d0c",
            "patch": "@@ -15,7 +15,7 @@ const challengeLanguage = Type.Object({\n   )\n });\n \n-const singleChallenge = Type.Object({\n+const singleChallengeResponse = Type.Object({\n   id: Type.String({ format: 'objectid', maxLength: 24, minLength: 24 }),\n   date: Type.String({ format: 'date-time' }),\n   challengeNumber: Type.Number(),\n@@ -30,7 +30,7 @@ const date = {\n     date: Type.String({ format: 'date' })\n   }),\n   response: {\n-    200: singleChallenge,\n+    200: singleChallengeResponse,\n     400: Type.Object({\n       type: Type.Literal('error'),\n       message: Type.Literal('Invalid date format. Please use YYYY-MM-DD.')\n@@ -48,7 +48,7 @@ const date = {\n \n const today = {\n   response: {\n-    200: singleChallenge,\n+    200: singleChallengeResponse,\n     404: Type.Object({\n       type: Type.Literal('error'),\n       message: Type.Literal('Challenge not found.')\n@@ -60,16 +60,39 @@ const today = {\n   }\n };\n \n+const manyChallengesResponse = Type.Array(\n+  Type.Object({\n+    id: Type.String(),\n+    date: Type.String({ format: 'date-time' }),\n+    challengeNumber: Type.Number(),\n+    title: Type.String()\n+  })\n+);\n+\n+const month = {\n+  params: Type.Object({\n+    month: Type.String({ pattern: '^\\\\d{4}-\\\\d{2}$' })\n+  }),\n+  response: {\n+    200: manyChallengesResponse,\n+    400: Type.Object({\n+      type: Type.Literal('error'),\n+      message: Type.Literal('Invalid date format. Please use YYYY-MM.')\n+    }),\n+    404: Type.Object({\n+      type: Type.Literal('error'),\n+      message: Type.Literal('No challenges found.')\n+    }),\n+    500: Type.Object({\n+      type: Type.Literal('error'),\n+      message: Type.Literal('Internal server error.')\n+    })\n+  }\n+};\n+\n const all = {\n   response: {\n-    200: Type.Array(\n-      Type.Object({\n-        id: Type.String(),\n-        date: Type.String({ format: 'date-time' }),\n-        challengeNumber: Type.Number(),\n-        title: Type.String()\n-      })\n-    ),\n+    200: manyChallengesResponse,\n     404: Type.Object({\n       type: Type.Literal('error'),\n       message: Type.Literal('No challenges found.')\n@@ -100,6 +123,7 @@ const newest = {\n export const dailyCodingChallenge = {\n   date,\n   today,\n-  newest,\n-  all\n+  month,\n+  all,\n+  newest\n };"
        }
    ],
    "stats": {
        "total": 232,
        "additions": 208,
        "deletions": 24
    }
}