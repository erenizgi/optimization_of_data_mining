{
    "author": "moT01",
    "message": "fix(client): persist transcript expanded state (#58437)",
    "sha": "2eb11a770815a71ab795f09743adb200a3d7826a",
    "files": [
        {
            "sha": "83fc44bde03430026366162fe241889dc825b2f9",
            "filename": "client/i18n/locales/english/translations.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2eb11a770815a71ab795f09743adb200a3d7826a/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2eb11a770815a71ab795f09743adb200a3d7826a/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json?ref=2eb11a770815a71ab795f09743adb200a3d7826a",
            "patch": "@@ -430,7 +430,7 @@\n     \"questions\": \"Questions\",\n     \"answered-mcq\": \"You have unanswered questions and/or incorrect answers.\",\n     \"explanation\": \"Explanation\",\n-    \"transcript\": \"Read a transcript of this video\",\n+    \"transcript\": \"Transcript\",\n     \"solution-link\": \"Solution Link\",\n     \"source-code-link\": \"Source Code Link\",\n     \"ms-link\": \"Microsoft Link\","
        },
        {
            "sha": "cd8271ca593ccd77285f8c368bdbda731d1cc7e0",
            "filename": "client/src/templates/Challenges/components/challenge-transcript.css",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2eb11a770815a71ab795f09743adb200a3d7826a/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Fchallenge-transcript.css",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2eb11a770815a71ab795f09743adb200a3d7826a/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Fchallenge-transcript.css",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Fchallenge-transcript.css?ref=2eb11a770815a71ab795f09743adb200a3d7826a",
            "patch": "@@ -1,3 +1,4 @@\n .challenge-transcript-heading {\n   cursor: pointer;\n+  font-weight: bold;\n }"
        },
        {
            "sha": "25399e2c028d6b5300598a6fa5266b9e054a7197",
            "filename": "client/src/templates/Challenges/components/challenge-transcript.test.tsx",
            "status": "added",
            "additions": 43,
            "deletions": 0,
            "changes": 43,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2eb11a770815a71ab795f09743adb200a3d7826a/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Fchallenge-transcript.test.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2eb11a770815a71ab795f09743adb200a3d7826a/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Fchallenge-transcript.test.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Fchallenge-transcript.test.tsx?ref=2eb11a770815a71ab795f09743adb200a3d7826a",
            "patch": "@@ -0,0 +1,43 @@\n+import React from 'react';\n+import { render, screen } from '@testing-library/react';\n+import store from 'store';\n+import ChallengeTranscript from './challenge-transcript';\n+\n+const baseProps = {\n+  transcript: 'Sample transcript text'\n+};\n+\n+describe('<ChallengeTranscript />', () => {\n+  beforeEach(() => {\n+    store.clearAll();\n+  });\n+\n+  it('renders the transcript heading', () => {\n+    render(<ChallengeTranscript {...baseProps} />);\n+    expect(screen.getByText('learn.transcript')).toBeVisible();\n+  });\n+\n+  it('renders collapsed by default', () => {\n+    render(<ChallengeTranscript {...baseProps} />);\n+    expect(screen.getByTestId('challenge-transcript')).not.toHaveAttribute(\n+      'open'\n+    );\n+    expect(screen.getByText('Sample transcript text')).not.toBeVisible();\n+  });\n+\n+  it(\"renders collapsed when localstorage 'fcc-transcript-expanded = false'\", () => {\n+    store.set('fcc-transcript-expanded', false);\n+    render(<ChallengeTranscript {...baseProps} />);\n+    expect(screen.getByTestId('challenge-transcript')).not.toHaveAttribute(\n+      'open'\n+    );\n+    expect(screen.getByText('Sample transcript text')).not.toBeVisible();\n+  });\n+\n+  it(\"renders expanded when 'fcc-transcript-expanded = true'\", () => {\n+    store.set('fcc-transcript-expanded', true);\n+    render(<ChallengeTranscript {...baseProps} />);\n+    expect(screen.getByTestId('challenge-transcript')).toHaveAttribute('open');\n+    expect(screen.getByText('Sample transcript text')).toBeVisible();\n+  });\n+});"
        },
        {
            "sha": "782f013dd80abe7469e3f5df8c13bc6567ca6ccd",
            "filename": "client/src/templates/Challenges/components/challenge-transcript.tsx",
            "status": "modified",
            "additions": 19,
            "deletions": 3,
            "changes": 22,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2eb11a770815a71ab795f09743adb200a3d7826a/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Fchallenge-transcript.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2eb11a770815a71ab795f09743adb200a3d7826a/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Fchallenge-transcript.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fcomponents%2Fchallenge-transcript.tsx?ref=2eb11a770815a71ab795f09743adb200a3d7826a",
            "patch": "@@ -1,6 +1,7 @@\n-import React from 'react';\n+import React, { useState } from 'react';\n import { useTranslation } from 'react-i18next';\n import { Spacer } from '@freecodecamp/ui';\n+import store from 'store';\n import PrismFormatted from './prism-formatted';\n \n import './challenge-transcript.css';\n@@ -14,10 +15,25 @@ function ChallengeTranscript({\n }: ChallengeTranscriptProps): JSX.Element {\n   const { t } = useTranslation();\n \n+  // default to collapsed\n+  const [isOpen, setIsOpen] = useState(\n+    () => (store.get('fcc-transcript-expanded') as boolean | null) ?? false\n+  );\n+\n+  function toggleExpandedState(e: React.MouseEvent<HTMLDetailsElement>) {\n+    e.preventDefault();\n+    store.set('fcc-transcript-expanded', !isOpen);\n+    setIsOpen(!isOpen);\n+  }\n+\n   return (\n     <>\n-      <details>\n-        <summary className='challenge-transcript-heading'>\n+      <details data-testid='challenge-transcript' open={isOpen}>\n+        <summary\n+          onClick={toggleExpandedState}\n+          aria-expanded={isOpen}\n+          className='challenge-transcript-heading'\n+        >\n           {t('learn.transcript')}\n         </summary>\n         <Spacer size='m' />"
        }
    ],
    "stats": {
        "total": 68,
        "additions": 64,
        "deletions": 4
    }
}