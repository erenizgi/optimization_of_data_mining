{
    "author": "ojeytonwilliams",
    "message": "fix(api): handle termination signals (#61171)",
    "sha": "91e4c05b9fba3ec1322eb9836a567376822a3eb6",
    "files": [
        {
            "sha": "02d21b66e3075f378b7e5a5c709aec9f183a5d20",
            "filename": "api/src/server.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 0,
            "changes": 11,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/91e4c05b9fba3ec1322eb9836a567376822a3eb6/api%2Fsrc%2Fserver.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/91e4c05b9fba3ec1322eb9836a567376822a3eb6/api%2Fsrc%2Fserver.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fserver.ts?ref=91e4c05b9fba3ec1322eb9836a567376822a3eb6",
            "patch": "@@ -5,6 +5,17 @@ import { HOST, PORT } from './utils/env';\n \n const start = async () => {\n   const fastify = await build(buildOptions);\n+\n+  const stop = async (signal: NodeJS.Signals) => {\n+    fastify.log.info(`Received ${signal}, shutting down.`);\n+    await fastify.close();\n+    fastify.log.info('Shutdown complete');\n+    process.exit(0);\n+  };\n+\n+  process.on('SIGINT', signal => void stop(signal));\n+  process.on('SIGTERM', signal => void stop(signal));\n+\n   try {\n     const port = Number(PORT);\n     fastify.log.info(`Starting server on port ${port}`);"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 11,
        "deletions": 0
    }
}