{
    "author": "huyenltnguyen",
    "message": "test(playwright): add tests for editor theme selection logic (#54481)\n\nCo-authored-by: Ahmad Abdolsaheb <ahmad.abdolsaheb@gmail.com>",
    "sha": "34d6baef7237b0441af5ca1cf1204086c426ae58",
    "files": [
        {
            "sha": "d39fe9519254f0b9264f499b57adf21af3fd7b61",
            "filename": "e2e/editor.spec.ts",
            "status": "modified",
            "additions": 152,
            "deletions": 0,
            "changes": 152,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/34d6baef7237b0441af5ca1cf1204086c426ae58/e2e%2Feditor.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/34d6baef7237b0441af5ca1cf1204086c426ae58/e2e%2Feditor.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Feditor.spec.ts?ref=34d6baef7237b0441af5ca1cf1204086c426ae58",
            "patch": "@@ -41,3 +41,155 @@ test.describe('Python Terminal', () => {\n     await expect(preview).toContainText(error, { timeout: 15000 });\n   });\n });\n+\n+test.describe('Editor theme if the system theme is dark', () => {\n+  test.use({ colorScheme: 'dark' });\n+\n+  test.beforeEach(async ({ page }) => {\n+    await page.goto(\n+      '/learn/2022/responsive-web-design/learn-html-by-building-a-cat-photo-app/step-3'\n+    );\n+  });\n+\n+  test.describe('If the user is signed in', () => {\n+    test.use({ storageState: 'playwright/.auth/certified-user.json' });\n+\n+    test('should be in dark mode if the user selected theme is dark', async ({\n+      page\n+    }) => {\n+      // Open the nav menu and toggle the theme\n+      await page.getByRole('button', { name: 'Menu' }).click();\n+\n+      const toggle = page.getByRole('button', { name: 'Night Mode' });\n+      await expect(toggle).toBeVisible();\n+      const isDarkMode = await toggle.getAttribute('aria-pressed');\n+\n+      if (isDarkMode === 'false') {\n+        const listItem = page.getByRole('listitem').filter({ has: toggle });\n+\n+        // The button's click event is intercepted by the `li`,\n+        // so we need to click on the `li` to trigger the theme change action.\n+        await listItem.click();\n+\n+        // Ensure that the action is completed before checking the editor.\n+        await expect(\n+          page.getByText('We have updated your theme')\n+        ).toBeVisible();\n+      }\n+\n+      const editor = page.locator(\"div[role='code'].monaco-editor\");\n+      await expect(editor).toHaveClass(/vs-dark/);\n+    });\n+\n+    test('should be in light mode if the user selected theme is light', async ({\n+      page\n+    }) => {\n+      // Open the nav menu and toggle the theme\n+      await page.getByRole('button', { name: 'Menu' }).click();\n+\n+      const toggle = page.getByRole('button', { name: 'Night Mode' });\n+      await expect(toggle).toBeVisible();\n+      const isDarkMode = await toggle.getAttribute('aria-pressed');\n+\n+      if (isDarkMode === 'true') {\n+        const listItem = page.getByRole('listitem').filter({ has: toggle });\n+\n+        // The button's click event is intercepted by the `li`,\n+        // so we need to click on the `li` to trigger the theme change action.\n+        await listItem.click();\n+\n+        // Ensure that the action is completed before checking the editor.\n+        await expect(\n+          page.getByText('We have updated your theme')\n+        ).toBeVisible();\n+      }\n+\n+      const editor = page.locator(\"div[role='code'].monaco-editor\");\n+      await expect(editor).toHaveClass(/vs(?!\\w)/);\n+    });\n+  });\n+\n+  test.describe('If the user is signed out', () => {\n+    test.use({ storageState: { cookies: [], origins: [] } });\n+\n+    test('should be in dark mode', async ({ page }) => {\n+      const editor = page.locator(\"div[role='code'].monaco-editor\");\n+      await expect(editor).toHaveClass(/vs-dark/);\n+    });\n+  });\n+});\n+\n+test.describe('Editor theme if the system theme is light', () => {\n+  test.use({ colorScheme: 'light' });\n+\n+  test.beforeEach(async ({ page }) => {\n+    await page.goto(\n+      '/learn/2022/responsive-web-design/learn-html-by-building-a-cat-photo-app/step-3'\n+    );\n+  });\n+\n+  test.describe('If the user is signed in', () => {\n+    test.use({ storageState: 'playwright/.auth/certified-user.json' });\n+\n+    test('should be in dark mode if the user selected theme is dark', async ({\n+      page\n+    }) => {\n+      await page.getByRole('button', { name: 'Menu' }).click();\n+\n+      const toggle = page.getByRole('button', { name: 'Night Mode' });\n+      await expect(toggle).toBeVisible();\n+      const isDarkMode = await toggle.getAttribute('aria-pressed');\n+\n+      if (isDarkMode === 'false') {\n+        const listItem = page.getByRole('listitem').filter({ has: toggle });\n+\n+        // The button's click event is intercepted by the `li`,\n+        // so we need to click on the `li` to trigger the theme change action.\n+        await listItem.click();\n+\n+        // Ensure that the action is completed before checking the editor.\n+        await expect(\n+          page.getByText('We have updated your theme')\n+        ).toBeVisible();\n+      }\n+\n+      const editor = page.locator(\"div[role='code'].monaco-editor\");\n+      await expect(editor).toHaveClass(/vs-dark/);\n+    });\n+\n+    test('should be in light mode if the user selected theme is light', async ({\n+      page\n+    }) => {\n+      await page.getByRole('button', { name: 'Menu' }).click();\n+\n+      const toggle = page.getByRole('button', { name: 'Night Mode' });\n+      await expect(toggle).toBeVisible();\n+      const isDarkMode = await toggle.getAttribute('aria-pressed');\n+\n+      if (isDarkMode === 'true') {\n+        const listItem = page.getByRole('listitem').filter({ has: toggle });\n+\n+        // The button's click event is intercepted by the `li`,\n+        // so we need to click on the `li` to trigger the theme change action.\n+        await listItem.click();\n+\n+        // Ensure that the action is completed before checking the editor.\n+        await expect(\n+          page.getByText('We have updated your theme')\n+        ).toBeVisible();\n+      }\n+\n+      const editor = page.locator(\"div[role='code'].monaco-editor\");\n+      await expect(editor).toHaveClass(/vs(?!\\w)/);\n+    });\n+  });\n+\n+  test.describe('If the user is signed out', () => {\n+    test.use({ storageState: { cookies: [], origins: [] } });\n+\n+    test('should be in light mode', async ({ page }) => {\n+      const editor = page.locator(\"div[role='code'].monaco-editor\");\n+      await expect(editor).toHaveClass(/vs(?!\\w)/);\n+    });\n+  });\n+});"
        }
    ],
    "stats": {
        "total": 152,
        "additions": 152,
        "deletions": 0
    }
}