{
    "author": "ojeytonwilliams",
    "message": "refactor(tools): ignore returned functions from tests (#59475)",
    "sha": "ee6afec4b57e7a9aaca9563ad29f382bc3346824",
    "files": [
        {
            "sha": "cb16b361de98a3fe28e72e9192ac3e3e79890e00",
            "filename": "tools/client-plugins/browser-scripts/test-evaluator.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 13,
            "changes": 16,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/ee6afec4b57e7a9aaca9563ad29f382bc3346824/tools%2Fclient-plugins%2Fbrowser-scripts%2Ftest-evaluator.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/ee6afec4b57e7a9aaca9563ad29f382bc3346824/tools%2Fclient-plugins%2Fbrowser-scripts%2Ftest-evaluator.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fclient-plugins%2Fbrowser-scripts%2Ftest-evaluator.ts?ref=ee6afec4b57e7a9aaca9563ad29f382bc3346824",
            "patch": "@@ -107,9 +107,6 @@ interface TestEvaluatorEvent extends MessageEvent {\n     firstTest: unknown;\n     testString: string;\n     build: string;\n-    sources: {\n-      [fileName: string]: unknown;\n-    };\n   };\n }\n \n@@ -123,18 +120,17 @@ ctx.onmessage = async (e: TestEvaluatorEvent) => {\n   __utils.toggleProxyLogger(e.data.firstTest);\n   /* eslint-enable @typescript-eslint/no-unused-vars */\n   try {\n-    let testResult;\n     // This can be reassigned by the eval inside the try block, so it should be declared as a let\n     // eslint-disable-next-line prefer-const\n     let __userCodeWasExecuted = false;\n     try {\n       // Logging is proxyed after the build to catch console.log messages\n       // generated during testing.\n-      testResult = (await eval(`${e.data.build}\n+      await eval(`${e.data.build}\n __utils.flushLogs();\n __userCodeWasExecuted = true;\n __utils.toggleProxyLogger(true);\n-(async () => {${e.data.testString}})()`)) as unknown;\n+(async () => {${e.data.testString}})()`);\n     } catch (err) {\n       if (__userCodeWasExecuted) {\n         // rethrow error, since test failed.\n@@ -151,13 +147,7 @@ __utils.toggleProxyLogger(true);\n       }\n       // the tests may not require working code, so they are evaluated even if\n       // the user code does not get executed.\n-      testResult = eval(e.data.testString) as unknown;\n-    }\n-    if (typeof testResult === 'function') {\n-      // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n-      await testResult((fileName: string) =>\n-        __toString(e.data.sources[fileName])\n-      );\n+      eval(e.data.testString);\n     }\n     __utils.flushLogs();\n     ctx.postMessage({ pass: true });"
        }
    ],
    "stats": {
        "total": 16,
        "additions": 3,
        "deletions": 13
    }
}