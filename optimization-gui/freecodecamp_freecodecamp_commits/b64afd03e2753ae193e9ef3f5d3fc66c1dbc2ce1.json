{
    "author": "raisedadead",
    "message": "fix(GHA): allow selective build and deploy (#62020)",
    "sha": "b64afd03e2753ae193e9ef3f5d3fc66c1dbc2ce1",
    "files": [
        {
            "sha": "ca3495255360eec898ee585dde0793f0a68deb03",
            "filename": ".github/workflows/deploy-client.yml",
            "status": "modified",
            "additions": 70,
            "deletions": 35,
            "changes": 105,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/b64afd03e2753ae193e9ef3f5d3fc66c1dbc2ce1/.github%2Fworkflows%2Fdeploy-client.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/b64afd03e2753ae193e9ef3f5d3fc66c1dbc2ce1/.github%2Fworkflows%2Fdeploy-client.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/.github%2Fworkflows%2Fdeploy-client.yml?ref=b64afd03e2753ae193e9ef3f5d3fc66c1dbc2ce1",
            "patch": "@@ -2,6 +2,23 @@ name: CD - Deploy - Clients\n \n on:\n   workflow_dispatch:\n+    inputs:\n+      target_language:\n+        description: 'Target language (or \"all\" for all languages)'\n+        type: choice\n+        options:\n+          - all\n+          - english\n+          - chinese\n+          - espanol\n+          - chinese-traditional\n+          - italian\n+          - portuguese\n+          - ukrainian\n+          - japanese\n+          - german\n+          - swahili\n+        default: all\n \n jobs:\n   setup-jobs:\n@@ -33,46 +50,64 @@ jobs:\n               ;;\n           esac\n \n+  setup-matrix:\n+    name: Setup Matrix\n+    runs-on: ubuntu-22.04\n+    needs: setup-jobs\n+    outputs:\n+      matrix: ${{ steps.matrix.outputs.matrix }}\n+    steps:\n+      - name: Setup Matrix\n+        id: matrix\n+        run: |\n+          TARGET_LANG=\"${{ inputs.target_language || 'all' }}\"\n+          echo \"Target language: $TARGET_LANG\"\n+\n+          if [[ \"$TARGET_LANG\" == \"all\" ]]; then\n+            # Build all languages\n+            MATRIX='{\n+              \"node-version\": [22],\n+              \"include\": [\n+                {\"lang-name-full\": \"english\", \"lang-name-short\": \"eng\"},\n+                {\"lang-name-full\": \"chinese\", \"lang-name-short\": \"chn\"},\n+                {\"lang-name-full\": \"espanol\", \"lang-name-short\": \"esp\"},\n+                {\"lang-name-full\": \"chinese-traditional\", \"lang-name-short\": \"cnt\"},\n+                {\"lang-name-full\": \"italian\", \"lang-name-short\": \"ita\"},\n+                {\"lang-name-full\": \"portuguese\", \"lang-name-short\": \"por\"},\n+                {\"lang-name-full\": \"ukrainian\", \"lang-name-short\": \"ukr\"},\n+                {\"lang-name-full\": \"japanese\", \"lang-name-short\": \"jpn\"},\n+                {\"lang-name-full\": \"german\", \"lang-name-short\": \"ger\"},\n+                {\"lang-name-full\": \"swahili\", \"lang-name-short\": \"swa\"}\n+              ]\n+            }'\n+          else\n+            # Build single language\n+            case \"$TARGET_LANG\" in\n+              \"english\") SHORT=\"eng\" ;;\n+              \"chinese\") SHORT=\"chn\" ;;\n+              \"espanol\") SHORT=\"esp\" ;;\n+              \"chinese-traditional\") SHORT=\"cnt\" ;;\n+              \"italian\") SHORT=\"ita\" ;;\n+              \"portuguese\") SHORT=\"por\" ;;\n+              \"ukrainian\") SHORT=\"ukr\" ;;\n+              \"japanese\") SHORT=\"jpn\" ;;\n+              \"german\") SHORT=\"ger\" ;;\n+              \"swahili\") SHORT=\"swa\" ;;\n+              *) echo \"Error: Unknown language $TARGET_LANG\"; exit 1 ;;\n+            esac\n+            \n+            MATRIX=\"{\\\"node-version\\\": [22], \\\"include\\\": [{\\\"lang-name-full\\\": \\\"$TARGET_LANG\\\", \\\"lang-name-short\\\": \\\"$SHORT\\\"}]}\"\n+          fi\n+\n+          echo \"matrix=$MATRIX\" >> $GITHUB_OUTPUT\n+\n   client:\n     name: Clients - [${{ needs.setup-jobs.outputs.tgt_env_short }}] [${{ matrix.lang-name-short }}]\n-    needs: [setup-jobs]\n+    needs: [setup-jobs, setup-matrix]\n     runs-on: ubuntu-22.04\n     strategy:\n       fail-fast: false\n-      matrix:\n-        node-version: [22]\n-        lang-name-full:\n-          - english\n-          - chinese\n-          - espanol\n-          - chinese-traditional\n-          - italian\n-          - portuguese\n-          - ukrainian\n-          - japanese\n-          - german\n-          - swahili\n-        include:\n-          - lang-name-full: english\n-            lang-name-short: eng\n-          - lang-name-full: chinese\n-            lang-name-short: chn\n-          - lang-name-full: espanol\n-            lang-name-short: esp\n-          - lang-name-full: chinese-traditional\n-            lang-name-short: cnt\n-          - lang-name-full: italian\n-            lang-name-short: ita\n-          - lang-name-full: portuguese\n-            lang-name-short: por\n-          - lang-name-full: ukrainian\n-            lang-name-short: ukr\n-          - lang-name-full: japanese\n-            lang-name-short: jpn\n-          - lang-name-full: german\n-            lang-name-short: ger\n-          - lang-name-full: swahili\n-            lang-name-short: swa\n+      matrix: ${{ fromJSON(needs.setup-matrix.outputs.matrix) }}\n     permissions:\n       deployments: write\n       contents: read"
        }
    ],
    "stats": {
        "total": 105,
        "additions": 70,
        "deletions": 35
    }
}