{
    "author": "a2937",
    "message": "feat(tools): create challenge helper script for quiz files (#59523)",
    "sha": "b8d4099796dce7b0d25f250ddfae8ea52b84ebeb",
    "files": [
        {
            "sha": "6b44c06e93f0673801c65f082a5be87f5e2a1f61",
            "filename": "package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/package.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/package.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/package.json?ref=b8d4099796dce7b0d25f250ddfae8ea52b84ebeb",
            "patch": "@@ -40,6 +40,7 @@\n     \"clean:server\": \"rm -rf ./api-server/lib\",\n     \"create:shared\": \"tsc -p shared\",\n     \"create-new-project\": \"cd ./tools/challenge-helper-scripts/ && pnpm run create-project\",\n+    \"create-new-quiz\": \"cd ./tools/challenge-helper-scripts/ && pnpm run create-quiz\",\n     \"predevelop\": \"npm-run-all -p create:shared -s build:curriculum\",\n     \"develop\": \"npm-run-all -p develop:*\",\n     \"develop:client\": \"cd ./client && pnpm run develop\","
        },
        {
            "sha": "4e47e70cda7aa30d663fb1871c7664f1e14dd5b2",
            "filename": "tools/challenge-helper-scripts/create-quiz.ts",
            "status": "added",
            "additions": 224,
            "deletions": 0,
            "changes": 224,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fcreate-quiz.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fcreate-quiz.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fcreate-quiz.ts?ref=b8d4099796dce7b0d25f250ddfae8ea52b84ebeb",
            "patch": "@@ -0,0 +1,224 @@\n+import { existsSync } from 'fs';\n+import fs from 'fs/promises';\n+import path from 'path';\n+import { prompt } from 'inquirer';\n+import { format } from 'prettier';\n+import ObjectID from 'bson-objectid';\n+\n+import { SuperBlocks } from '../../shared/config/curriculum';\n+import { createQuizFile, validateBlockName } from './utils';\n+import { getSuperBlockSubPath } from './fs-utils';\n+import { Meta } from './helpers/project-metadata';\n+\n+const helpCategories = [\n+  'HTML-CSS',\n+  'JavaScript',\n+  'Backend Development',\n+  'Python'\n+] as const;\n+\n+type BlockInfo = {\n+  title: string;\n+  intro: string[];\n+};\n+\n+type SuperBlockInfo = {\n+  blocks: Record<string, BlockInfo>;\n+};\n+\n+type IntroJson = Record<SuperBlocks, SuperBlockInfo>;\n+\n+interface CreateQuizArgs {\n+  superBlock: SuperBlocks;\n+  block: string;\n+  helpCategory: string;\n+  title?: string;\n+  questionCount: number;\n+}\n+\n+async function createQuiz(\n+  superBlock: SuperBlocks,\n+  block: string,\n+  helpCategory: string,\n+  questionCount: number,\n+  title?: string\n+) {\n+  if (!title) {\n+    title = block;\n+  }\n+  void updateIntroJson(superBlock, block, title);\n+\n+  const challengeId = await createQuizChallenge(\n+    superBlock,\n+    block,\n+    title,\n+    questionCount\n+  );\n+  void createMetaJson(superBlock, block, title, helpCategory, challengeId);\n+  // TODO: remove once we stop relying on markdown in the client.\n+  void createIntroMD(superBlock, block, title);\n+}\n+\n+async function updateIntroJson(\n+  superBlock: SuperBlocks,\n+  block: string,\n+  title: string\n+) {\n+  const introJsonPath = path.resolve(\n+    __dirname,\n+    '../../client/i18n/locales/english/intro.json'\n+  );\n+  const newIntro = await parseJson<IntroJson>(introJsonPath);\n+  newIntro[superBlock].blocks[block] = {\n+    title,\n+    intro: ['', '']\n+  };\n+  void withTrace(\n+    fs.writeFile,\n+    introJsonPath,\n+    await format(JSON.stringify(newIntro), { parser: 'json' })\n+  );\n+}\n+\n+async function createMetaJson(\n+  superBlock: SuperBlocks,\n+  block: string,\n+  title: string,\n+  helpCategory: string,\n+  challengeId: ObjectID\n+) {\n+  const metaDir = path.resolve(__dirname, '../../curriculum/challenges/_meta');\n+  const newMeta = await parseJson<Meta>('./quiz-meta.json');\n+  newMeta.name = title;\n+  newMeta.dashedName = block;\n+  newMeta.helpCategory = helpCategory;\n+  newMeta.superBlock = superBlock;\n+  // eslint-disable-next-line @typescript-eslint/no-base-to-string\n+  newMeta.challengeOrder = [{ id: challengeId.toString(), title: title }];\n+  const newMetaDir = path.resolve(metaDir, block);\n+  if (!existsSync(newMetaDir)) {\n+    await withTrace(fs.mkdir, newMetaDir);\n+  }\n+\n+  void withTrace(\n+    fs.writeFile,\n+    path.resolve(metaDir, `${block}/meta.json`),\n+    await format(JSON.stringify(newMeta), { parser: 'json' })\n+  );\n+}\n+\n+async function createIntroMD(superBlock: string, block: string, title: string) {\n+  const introMD = `---\n+title: Introduction to the ${title}\n+block: ${block}\n+superBlock: ${superBlock}\n+---\n+\n+## Introduction to the ${title}\n+\n+This page is for the ${title}\n+`;\n+  const dirPath = path.resolve(\n+    __dirname,\n+    `../../client/src/pages/learn/${superBlock}/${block}/`\n+  );\n+  const filePath = path.resolve(dirPath, 'index.md');\n+  if (!existsSync(dirPath)) {\n+    await withTrace(fs.mkdir, dirPath);\n+  }\n+  void withTrace(fs.writeFile, filePath, introMD, { encoding: 'utf8' });\n+}\n+\n+async function createQuizChallenge(\n+  superBlock: SuperBlocks,\n+  block: string,\n+  title: string,\n+  questionCount: number\n+): Promise<ObjectID> {\n+  const superBlockSubPath = getSuperBlockSubPath(superBlock);\n+  const newChallengeDir = path.resolve(\n+    __dirname,\n+    `../../curriculum/challenges/english/${superBlockSubPath}/${block}`\n+  );\n+  if (!existsSync(newChallengeDir)) {\n+    await withTrace(fs.mkdir, newChallengeDir);\n+  }\n+  return createQuizFile({\n+    challengeType: '8',\n+    projectPath: newChallengeDir + '/',\n+    title: title,\n+    dashedName: block,\n+    questionCount: questionCount\n+  });\n+}\n+\n+function parseJson<JsonSchema>(filePath: string) {\n+  return withTrace(fs.readFile, filePath, 'utf8').then(\n+    // unfortunately, withTrace does not correctly infer that the third argument\n+    // is a string, so it uses the (path, options?) overload and we have to cast\n+    // result to string.\n+    result => JSON.parse(result as string) as JsonSchema\n+  );\n+}\n+\n+// fs Promise functions return errors, but no stack trace.  This adds back in\n+// the stack trace.\n+function withTrace<Args extends unknown[], Result>(\n+  fn: (...x: Args) => Promise<Result>,\n+  ...args: Args\n+): Promise<Result> {\n+  return fn(...args).catch((reason: Error) => {\n+    throw Error(reason.message);\n+  });\n+}\n+\n+void prompt([\n+  {\n+    name: 'superBlock',\n+    message: 'Which certification does this belong to?',\n+    default: SuperBlocks.FullStackDeveloper,\n+    type: 'list',\n+    choices: Object.values(SuperBlocks)\n+  },\n+  {\n+    name: 'block',\n+    message: 'What is the dashed name (in kebab-case) for this quiz?',\n+    validate: validateBlockName,\n+    filter: (block: string) => {\n+      return block.toLowerCase().trim();\n+    }\n+  },\n+  {\n+    name: 'title',\n+    default: ({ block }: { block: string }) => block\n+  },\n+  {\n+    name: 'helpCategory',\n+    message: 'Choose a help category',\n+    default: 'HTML-CSS',\n+    type: 'list',\n+    choices: helpCategories\n+  },\n+  {\n+    name: 'questionCount',\n+    message: 'Should this quiz have either ten or twenty questions?',\n+    default: 20,\n+    type: 'list',\n+    choices: [20, 10]\n+  }\n+])\n+  .then(\n+    async ({\n+      superBlock,\n+      block,\n+      title,\n+      helpCategory,\n+      questionCount\n+    }: CreateQuizArgs) =>\n+      await createQuiz(superBlock, block, helpCategory, questionCount, title)\n+  )\n+  .then(() =>\n+    console.log(\n+      'All set.  Now use pnpm run clean:client in the root and it should be good to go.'\n+    )\n+  );"
        },
        {
            "sha": "7f40f18375e1b6dac3cefa05f8de88d2b12680f2",
            "filename": "tools/challenge-helper-scripts/helpers/get-challenge-template.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 399,
            "changes": 403,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-challenge-template.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-challenge-template.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-challenge-template.ts?ref=b8d4099796dce7b0d25f250ddfae8ea52b84ebeb",
            "patch": "@@ -10,6 +10,7 @@ interface ChallengeOptions {\n   title: string;\n   dashedName: string;\n   challengeType: string;\n+  questionCount?: number;\n }\n \n const buildFrontMatter = ({\n@@ -76,211 +77,13 @@ const getQuizChallengeTemplate = (\n \n # --description--\n \n-To pass the quiz, you must correctly answer at least 18 of the 20 questions below.\n+To pass the quiz, you must correctly answer at least ${options.questionCount! == 20 ? '18' : '9'} of the ${options.questionCount!.toString()} questions below.\n \n # --quizzes--\n \n ## --quiz--\n \n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n+${`### --question--\n \n #### --text--\n \n@@ -302,6 +105,7 @@ Placeholder distractor 3\n \n Placeholder answer\n \n+`.repeat(options.questionCount! - 1)}\n ### --question--\n \n #### --text--\n@@ -323,205 +127,6 @@ Placeholder distractor 3\n #### --answer--\n \n Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n-### --question--\n-\n-#### --text--\n-\n-Placeholder question\n-\n-#### --distractors--\n-\n-Placeholder distractor 1\n-\n----\n-\n-Placeholder distractor 2\n-\n----\n-\n-Placeholder distractor 3\n-\n-#### --answer--\n-\n-Placeholder answer\n-\n `;\n \n const getVideoChallengeTemplate = ("
        },
        {
            "sha": "7db46d69c00e643c01efcbafa37216dd7b7fc787",
            "filename": "tools/challenge-helper-scripts/helpers/project-metadata.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fproject-metadata.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fproject-metadata.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fproject-metadata.ts?ref=b8d4099796dce7b0d25f250ddfae8ea52b84ebeb",
            "patch": "@@ -5,6 +5,8 @@ import { getProjectName, getProjectPath } from './get-project-info';\n \n export type Meta = {\n   name: string;\n+  blockLayout: string;\n+  blockType: string;\n   isUpcomingChange: boolean;\n   dashedName: string;\n   helpCategory: string;"
        },
        {
            "sha": "c4ee521bffe157add0f466bdfb16a7f321947efb",
            "filename": "tools/challenge-helper-scripts/package.json",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fpackage.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fpackage.json?ref=b8d4099796dce7b0d25f250ddfae8ea52b84ebeb",
            "patch": "@@ -20,7 +20,8 @@\n   \"main\": \"utils.js\",\n   \"scripts\": {\n     \"test\": \"mocha --delay --reporter progress --bail\",\n-    \"create-project\": \"tsx create-project\"\n+    \"create-project\": \"tsx create-project\",\n+    \"create-quiz\": \"tsx create-quiz\"\n   },\n   \"devDependencies\": {\n     \"@types/glob\": \"^8.0.1\","
        },
        {
            "sha": "a37c8fb05a11272e5897f4a906aa9a37d9733614",
            "filename": "tools/challenge-helper-scripts/quiz-meta.json",
            "status": "added",
            "additions": 14,
            "deletions": 0,
            "changes": 14,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fquiz-meta.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Fquiz-meta.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fquiz-meta.json?ref=b8d4099796dce7b0d25f250ddfae8ea52b84ebeb",
            "patch": "@@ -0,0 +1,14 @@\n+{\n+  \"name\": \"\",\n+  \"blockType\": \"quiz\",\n+  \"blockLayout\": \"link\",\n+  \"isUpcomingChange\": true,\n+  \"dashedName\": \"\",\n+  \"superBlock\": \"\",\n+  \"challengeOrder\": [\n+    {\n+      \"id\": \"\",\n+      \"title\": \"\"\n+    }\n+  ]\n+}"
        },
        {
            "sha": "254a60b6dc5f53394ebd9e4cd5465cfd97b1b7fe",
            "filename": "tools/challenge-helper-scripts/utils.ts",
            "status": "modified",
            "additions": 33,
            "deletions": 1,
            "changes": 34,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Futils.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/b8d4099796dce7b0d25f250ddfae8ea52b84ebeb/tools%2Fchallenge-helper-scripts%2Futils.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Futils.ts?ref=b8d4099796dce7b0d25f250ddfae8ea52b84ebeb",
            "patch": "@@ -10,6 +10,7 @@ import {\n   isTaskChallenge,\n   getTaskNumberFromTitle\n } from './helpers/task-helpers';\n+import { getTemplate } from './helpers/get-challenge-template';\n \n interface Options {\n   stepNum: number;\n@@ -19,6 +20,14 @@ interface Options {\n   isFirstChallenge?: boolean;\n }\n \n+interface QuizOptions {\n+  challengeType: string;\n+  projectPath?: string;\n+  title: string;\n+  dashedName: string;\n+  questionCount: number;\n+}\n+\n const createStepFile = ({\n   stepNum,\n   challengeType,\n@@ -50,6 +59,28 @@ const createChallengeFile = (\n   fs.writeFileSync(`${path}${filename}.md`, template);\n };\n \n+const createQuizFile = ({\n+  challengeType,\n+  projectPath = getProjectPath(),\n+  title,\n+  dashedName,\n+  questionCount\n+}: QuizOptions): ObjectID => {\n+  const challengeId = new ObjectID();\n+  const template = getTemplate(challengeType);\n+\n+  const quizText = template({\n+    challengeId,\n+    challengeType,\n+    title,\n+    dashedName,\n+    questionCount\n+  });\n+  // eslint-disable-next-line @typescript-eslint/no-base-to-string\n+  fs.writeFileSync(`${projectPath}${challengeId.toString()}.md`, quizText);\n+  return challengeId;\n+};\n+\n interface InsertOptions {\n   stepNum: number;\n   stepId: ObjectID;\n@@ -225,5 +256,6 @@ export {\n   insertStepIntoMeta,\n   deleteChallengeFromMeta,\n   deleteStepFromMeta,\n-  validateBlockName\n+  validateBlockName,\n+  createQuizFile\n };"
        }
    ],
    "stats": {
        "total": 681,
        "additions": 280,
        "deletions": 401
    }
}