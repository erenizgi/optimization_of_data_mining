{
    "author": "raisedadead",
    "message": "fix(gha): cleanup logs and validation",
    "sha": "e2996eb3e6951e9284a2b58ff1abc10ec1a012f7",
    "files": [
        {
            "sha": "d2feb943c0f18ca4473409d184bd2364bd5535ed",
            "filename": ".github/workflows/deploy.yml",
            "status": "modified",
            "additions": 10,
            "deletions": 8,
            "changes": 18,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/e2996eb3e6951e9284a2b58ff1abc10ec1a012f7/.github%2Fworkflows%2Fdeploy.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/e2996eb3e6951e9284a2b58ff1abc10ec1a012f7/.github%2Fworkflows%2Fdeploy.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/.github%2Fworkflows%2Fdeploy.yml?ref=e2996eb3e6951e9284a2b58ff1abc10ec1a012f7",
            "patch": "@@ -135,8 +135,10 @@ jobs:\n           REMOTE_SCRIPT=\"\n             set -e\n             echo -e '\\nLOG:Deploying API to $TS_MACHINE_NAME...'\n-            cd /home/$TS_USERNAME/docker-swarm-config/stacks/api || { echo \\\"Error: Failed to change directory\\\"; exit 1; }\n-            which age > /dev/null || { echo \\\"Error: age not installed\\\"; exit 1; }\n+            cd /home/$TS_USERNAME/docker-swarm-config/stacks/api\n+\n+            echo -e '\\nLOG:Checking if age is installed...'\n+            which age > /dev/null\n \n             echo -e '\\nLOG:Decrypting secrets...'\n             echo \\\"$AGE_ENCRYPTED_ASC_SECRETS\\\" > secrets.age.asc\n@@ -182,16 +184,16 @@ jobs:\n               echo \\\"Error: Version mismatch. Expected: $DEPLOYMENT_VERSION, Got: \\$DEPLOYMENT_VERSION\\\"\n               exit 1\n             fi\n-            env | grep -E 'DOMAIN|DEPLOYMENT' || { echo \\\"Error: Required environment variables not found\\\"; exit 1; }\n+            env | grep -E 'DOMAIN|DEPLOYMENT'\n \n             echo -e '\\nLOG:Checking stack configuration...'\n-            CONFIG_OUTPUT=\"/dev/null\"\n+            CONFIG_OUTPUT=\\\"/dev/null\\\"\n             if [[ \\\"\\$FCC_API_LOG_LEVEL\\\" == \\\"debug\\\" ]]; then\n-              CONFIG_FILENAME=\"debug-docker-stack-config-\\${DEPLOYMENT_VERSION}.yml\"\n-              echo -e '\\nLOG:Saving stack configuration to $CONFIG_FILENAME for debugging...'\n-              CONFIG_OUTPUT=\"\\$CONFIG_FILENAME\"\n+              CONFIG_FILENAME=\\\"debug-docker-stack-config-\\${DEPLOYMENT_VERSION}.yml\\\"\n+              echo -e '\\nLOG:Saving stack configuration to \\$CONFIG_FILENAME for debugging...'\n+              CONFIG_OUTPUT=\\\"\\$CONFIG_FILENAME\\\"\n             fi\n-            docker stack config -c stack-api.yml > \"$CONFIG_OUTPUT\" || { echo \\\"Error: Invalid stack configuration\\\"; exit 1; }\n+            docker stack config -c stack-api.yml > \\$CONFIG_OUTPUT\n \n             echo -e '\\nLOG:Deploying stack...'\n             docker stack deploy -c stack-api.yml --prune --with-registry-auth --detach=false $STACK_NAME"
        }
    ],
    "stats": {
        "total": 18,
        "additions": 10,
        "deletions": 8
    }
}