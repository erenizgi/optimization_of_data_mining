{
    "author": "huyenltnguyen",
    "message": "feat(client): handle quiz finish and exit (#56644)\n\nCo-authored-by: Oliver Eyton-Williams <ojeytonwilliams@gmail.com>",
    "sha": "2e76ea10da86deeed2baa9d44c96e7e16160472f",
    "files": [
        {
            "sha": "538c89d10679101091b753fc56d054b98802ff40",
            "filename": "client/i18n/locales/english/translations.json",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -96,6 +96,8 @@\n     \"exit\": \"Exit\",\n     \"finish-exam\": \"Finish the exam\",\n     \"finish\": \"Finish\",\n+    \"exit-quiz\": \"Exit the quiz\",\n+    \"finish-quiz\": \"Finish the quiz\",\n     \"submit-exam-results\": \"Submit my results\",\n     \"verify-trophy\": \"Verify Trophy\",\n     \"link-account\": \"Link Account\",\n@@ -519,7 +521,15 @@\n       \"correct-answer\": \"Correct!\",\n       \"incorrect-answer\": \"Incorrect.\",\n       \"unanswered-questions\": \"The following questions are unanswered: {{ unansweredQuestions }}. You must answer all questions.\",\n-      \"have-n-correct-questions\": \"You have {{ correctAnswerCount }} out of {{ total }} questions correct.\"\n+      \"have-n-correct-questions\": \"You have {{ correctAnswerCount }} out of {{ total }} questions correct.\",\n+      \"finish-modal-header\": \"Finish Quiz\",\n+      \"finish-modal-body\": \"Are you sure you want to finish the quiz? You will not be able to change any answers.\",\n+      \"finish-modal-yes\": \"Yes, I am finished\",\n+      \"finish-modal-no\": \"No, I would like to continue the quiz\",\n+      \"exit-modal-header\": \"Exit Quiz\",\n+      \"exit-modal-body\": \"Are you sure you want to leave the quiz? You will lose any progress you have made.\",\n+      \"exit-modal-yes\": \"Yes, I want to leave the quiz\",\n+      \"exit-modal-no\": \"No, I would like to continue the quiz\"\n     },\n     \"exam\": {\n       \"qualified\": \"Congratulations, you have completed all the requirements to qualify for the exam.\","
        },
        {
            "sha": "226eb94738fdf2cce80885a60ca295b9d19d69b6",
            "filename": "client/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fpackage.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fpackage.json?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -50,7 +50,7 @@\n     \"@fortawesome/react-fontawesome\": \"0.2.0\",\n     \"@freecodecamp/loop-protect\": \"3.0.0\",\n     \"@freecodecamp/react-calendar-heatmap\": \"1.1.0\",\n-    \"@freecodecamp/ui\": \"2.1.0\",\n+    \"@freecodecamp/ui\": \"3.0.0\",\n     \"@growthbook/growthbook-react\": \"0.20.0\",\n     \"@loadable/component\": \"5.16.3\",\n     \"@reach/router\": \"1.3.4\","
        },
        {
            "sha": "c2fd2e19ad16da5db1c8f4084bf5c5843edbf55c",
            "filename": "client/src/templates/Challenges/hooks/index.ts",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fhooks%2Findex.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fhooks%2Findex.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fhooks%2Findex.ts?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -0,0 +1 @@\n+export { usePageLeave } from './use-page-leave';"
        },
        {
            "sha": "4a0ddec8e8e63996265735c17578a7b5630afc69",
            "filename": "client/src/templates/Challenges/hooks/use-page-leave.ts",
            "status": "added",
            "additions": 32,
            "deletions": 0,
            "changes": 32,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fhooks%2Fuse-page-leave.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fhooks%2Fuse-page-leave.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fhooks%2Fuse-page-leave.ts?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -0,0 +1,32 @@\n+import { useEffect } from 'react';\n+import { useLocation, globalHistory } from '@reach/router';\n+\n+interface Props {\n+  onWindowClose: (event: BeforeUnloadEvent) => void;\n+  onHistoryChange: () => void;\n+}\n+\n+export const usePageLeave = ({ onWindowClose, onHistoryChange }: Props) => {\n+  const curLocation = useLocation();\n+\n+  useEffect(() => {\n+    window.addEventListener('beforeunload', onWindowClose);\n+\n+    // This is a workaround as @reach/router doesn't support blocking history change.\n+    // https://github.com/reach/router/issues/464\n+    const unlistenHistory = globalHistory.listen(({ action, location }) => {\n+      const isBack = action === 'POP';\n+      const isRouteChanged =\n+        action === 'PUSH' && location.pathname !== curLocation.pathname;\n+\n+      if (isBack || isRouteChanged) {\n+        onHistoryChange();\n+      }\n+    });\n+\n+    return () => {\n+      window.removeEventListener('beforeunload', onWindowClose);\n+      unlistenHistory();\n+    };\n+  }, [onWindowClose, onHistoryChange, curLocation]);\n+};"
        },
        {
            "sha": "c2bf4877811db2a86bb6cebca199711c3f8e953a",
            "filename": "client/src/templates/Challenges/quiz/exit-quiz-modal.tsx",
            "status": "added",
            "additions": 58,
            "deletions": 0,
            "changes": 58,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fquiz%2Fexit-quiz-modal.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fquiz%2Fexit-quiz-modal.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fquiz%2Fexit-quiz-modal.tsx?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -0,0 +1,58 @@\n+import React from 'react';\n+import { connect } from 'react-redux';\n+import { useTranslation } from 'react-i18next';\n+import { Button, Modal, Spacer } from '@freecodecamp/ui';\n+\n+import { closeModal } from '../redux/actions';\n+import { isExitQuizModalOpenSelector } from '../redux/selectors';\n+\n+interface ExitQuizModalProps {\n+  closeExitQuizModal: () => void;\n+  isExitQuizModalOpen: boolean;\n+  onExit: () => void;\n+}\n+\n+const mapStateToProps = (state: unknown) => ({\n+  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-call\n+  isExitQuizModalOpen: isExitQuizModalOpenSelector(state)\n+});\n+\n+const mapDispatchToProps = {\n+  closeExitQuizModal: () => closeModal('exitQuiz')\n+};\n+\n+const ExitQuizModal = ({\n+  closeExitQuizModal,\n+  isExitQuizModalOpen,\n+  onExit\n+}: ExitQuizModalProps) => {\n+  const { t } = useTranslation();\n+\n+  return (\n+    <Modal\n+      onClose={closeExitQuizModal}\n+      open={isExitQuizModalOpen}\n+      variant='danger'\n+    >\n+      <Modal.Header closeButtonClassNames='close'>\n+        {t('learn.quiz.exit-modal-header')}\n+      </Modal.Header>\n+      <Modal.Body alignment='center'>\n+        {t('learn.quiz.exit-modal-body')}\n+      </Modal.Body>\n+      <Modal.Footer>\n+        <Button block variant='primary' onClick={closeExitQuizModal}>\n+          {t('learn.quiz.exit-modal-no')}\n+        </Button>\n+        <Spacer size='xxs' />\n+        <Button block variant='danger' onClick={onExit}>\n+          {t('learn.quiz.exit-modal-yes')}\n+        </Button>\n+      </Modal.Footer>\n+    </Modal>\n+  );\n+};\n+\n+ExitQuizModal.displayName = 'ExitQuizModal';\n+\n+export default connect(mapStateToProps, mapDispatchToProps)(ExitQuizModal);"
        },
        {
            "sha": "b0afb1cd043a9b90949413919ed0fbaee4e85d30",
            "filename": "client/src/templates/Challenges/quiz/finish-quiz-modal.tsx",
            "status": "added",
            "additions": 59,
            "deletions": 0,
            "changes": 59,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fquiz%2Ffinish-quiz-modal.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fquiz%2Ffinish-quiz-modal.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fquiz%2Ffinish-quiz-modal.tsx?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -0,0 +1,59 @@\n+import React from 'react';\n+import { connect } from 'react-redux';\n+import { useTranslation } from 'react-i18next';\n+import { Button, Modal, Spacer } from '@freecodecamp/ui';\n+\n+import { closeModal } from '../redux/actions';\n+import { isFinishQuizModalOpenSelector } from '../redux/selectors';\n+\n+interface FinishQuizModalProps {\n+  closeFinishQuizModal: () => void;\n+  isFinishQuizModalOpen: boolean;\n+  onFinish: () => void;\n+}\n+\n+const mapStateToProps = (state: unknown) => ({\n+  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-call\n+  isFinishQuizModalOpen: isFinishQuizModalOpenSelector(state)\n+});\n+\n+const mapDispatchToProps = {\n+  closeFinishQuizModal: () => closeModal('finishQuiz')\n+};\n+\n+const FinishQuizModal = ({\n+  closeFinishQuizModal,\n+  isFinishQuizModalOpen,\n+  onFinish\n+}: FinishQuizModalProps) => {\n+  const { t } = useTranslation();\n+\n+  return (\n+    <Modal onClose={closeFinishQuizModal} open={isFinishQuizModalOpen}>\n+      <Modal.Header closeButtonClassNames='close'>\n+        {t('learn.quiz.finish-modal-header')}\n+      </Modal.Header>\n+      <Modal.Body alignment='center'>\n+        {t('learn.quiz.finish-modal-body')}\n+      </Modal.Body>\n+      <Modal.Footer>\n+        <Button block size='medium' variant='primary' onClick={onFinish}>\n+          {t('learn.quiz.finish-modal-yes')}\n+        </Button>\n+        <Spacer size='xxs' />\n+        <Button\n+          block\n+          size='medium'\n+          variant='primary'\n+          onClick={closeFinishQuizModal}\n+        >\n+          {t('learn.quiz.finish-modal-no')}\n+        </Button>\n+      </Modal.Footer>\n+    </Modal>\n+  );\n+};\n+\n+FinishQuizModal.displayName = 'FinishQuizModal';\n+\n+export default connect(mapStateToProps, mapDispatchToProps)(FinishQuizModal);"
        },
        {
            "sha": "29d61963c53e7c846f79752c9c11d290e0f0a5d3",
            "filename": "client/src/templates/Challenges/quiz/show.tsx",
            "status": "modified",
            "additions": 114,
            "deletions": 41,
            "changes": 155,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fquiz%2Fshow.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fquiz%2Fshow.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fquiz%2Fshow.tsx?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -1,12 +1,13 @@\n-import { graphql } from 'gatsby';\n-import React, { useEffect, useRef, useState } from 'react';\n+import { graphql, navigate } from 'gatsby';\n+import React, { useCallback, useEffect, useRef, useState } from 'react';\n import Helmet from 'react-helmet';\n import { ObserveKeys } from 'react-hotkeys';\n import { useTranslation } from 'react-i18next';\n import { connect } from 'react-redux';\n import { bindActionCreators } from 'redux';\n import type { Dispatch } from 'redux';\n import { createSelector } from 'reselect';\n+import { useLocation } from '@reach/router';\n import {\n   Container,\n   Col,\n@@ -21,7 +22,6 @@ import {\n import { shuffleArray } from '../../../../../shared/utils/shuffle-array';\n import LearnLayout from '../../../components/layouts/learn';\n import { ChallengeNode, ChallengeMeta, Test } from '../../../redux/prop-types';\n-// import { challengeTypes } from '../../../../../shared/config/challenge-types';\n import ChallengeDescription from '../components/challenge-description';\n import Hotkeys from '../components/hotkeys';\n import ChallengeTitle from '../components/challenge-title';\n@@ -30,11 +30,15 @@ import {\n   challengeMounted,\n   updateChallengeMeta,\n   openModal,\n+  closeModal,\n   updateSolutionFormValues,\n   initTests\n } from '../redux/actions';\n import { isChallengeCompletedSelector } from '../redux/selectors';\n import PrismFormatted from '../components/prism-formatted';\n+import { usePageLeave } from '../hooks';\n+import ExitQuizModal from './exit-quiz-modal';\n+import FinishQuizModal from './finish-quiz-modal';\n \n import './show.css';\n \n@@ -52,7 +56,11 @@ const mapDispatchToProps = (dispatch: Dispatch) =>\n       updateChallengeMeta,\n       challengeMounted,\n       updateSolutionFormValues,\n-      openCompletionModal: () => openModal('completion')\n+      openCompletionModal: () => openModal('completion'),\n+      openExitQuizModal: () => openModal('exitQuiz'),\n+      closeExitQuizModal: () => closeModal('exitQuiz'),\n+      openFinishQuizModal: () => openModal('finishQuiz'),\n+      closeFinishQuizModal: () => closeModal('finishQuiz')\n     },\n     dispatch\n   );\n@@ -64,20 +72,24 @@ interface ShowQuizProps {\n   description: string;\n   initTests: (xs: Test[]) => void;\n   isChallengeCompleted: boolean;\n-  openCompletionModal: () => void;\n   pageContext: {\n     challengeMeta: ChallengeMeta;\n   };\n   updateChallengeMeta: (arg0: ChallengeMeta) => void;\n   updateSolutionFormValues: () => void;\n+  openCompletionModal: () => void;\n+  openExitQuizModal: () => void;\n+  closeExitQuizModal: () => void;\n+  openFinishQuizModal: () => void;\n+  closeFinishQuizModal: () => void;\n }\n \n const ShowQuiz = ({\n   challengeMounted,\n   data: {\n     challengeNode: {\n       challenge: {\n-        fields: { tests },\n+        fields: { tests, blockHashSlug },\n         title,\n         description,\n         challengeType,\n@@ -92,10 +104,16 @@ const ShowQuiz = ({\n   pageContext: { challengeMeta },\n   initTests,\n   updateChallengeMeta,\n+  isChallengeCompleted,\n   openCompletionModal,\n-  isChallengeCompleted\n+  openExitQuizModal,\n+  closeExitQuizModal,\n+  openFinishQuizModal,\n+  closeFinishQuizModal\n }: ShowQuizProps) => {\n   const { t } = useTranslation();\n+  const curLocation = useLocation();\n+\n   const { nextChallengePath, prevChallengePath } = challengeMeta;\n   const container = useRef<HTMLElement | null>(null);\n \n@@ -106,6 +124,10 @@ const ShowQuiz = ({\n   // `isPassed` is used as a flag to conditionally render the test or submit button.\n   const [isPassed, setIsPassed] = useState(false);\n \n+  const [showUnanswered, setShowUnanswered] = useState(false);\n+\n+  const [exitConfirmed, setExitConfirmed] = useState(false);\n+\n   const blockNameTitle = `${t(\n     `intro:${superBlock}.blocks.${block}.title`\n   )} - ${title}`;\n@@ -146,20 +168,26 @@ const ShowQuiz = ({\n   const {\n     questions: quizData,\n     validateAnswers,\n+    validated,\n     correctAnswerCount\n   } = useQuiz({\n     initialQuestions: initialQuizData,\n     validationMessages: {\n       correct: t('learn.quiz.correct-answer'),\n       incorrect: t('learn.quiz.incorrect-answer')\n     },\n+    passingGrade: 85,\n     onSuccess: () => {\n-      openCompletionModal();\n-      setIsPassed(true);\n+      openCompletionModal(), setIsPassed(true);\n     },\n     onFailure: () => setIsPassed(false)\n   });\n \n+  const unanswered = quizData.reduce<number[]>(\n+    (acc, curr, id) => (curr.selectedAnswer == null ? [...acc, id + 1] : acc),\n+    []\n+  );\n+\n   useEffect(() => {\n     initTests(tests);\n     updateChallengeMeta({\n@@ -191,40 +219,85 @@ const ShowQuiz = ({\n     updateChallengeMeta\n   ]);\n \n-  const handleAnswersCheck = () => {\n+  const handleFinishQuiz = () => {\n+    setShowUnanswered(true);\n+\n+    if (unanswered.length === 0) {\n+      openFinishQuizModal();\n+    }\n+  };\n+\n+  const handleFinishQuizModalBtnClick = () => {\n     validateAnswers();\n     setHasSubmitted(true);\n+    closeFinishQuizModal();\n   };\n \n   const handleSubmitAndGo = () => {\n     openCompletionModal();\n   };\n \n-  function getErrorMessage() {\n-    if (!hasSubmitted) return '';\n+  const handleExitQuiz = () => {\n+    openExitQuizModal();\n+  };\n+\n+  const handleExitQuizModalBtnClick = () => {\n+    setExitConfirmed(true);\n+    void navigate(blockHashSlug);\n+    closeExitQuizModal();\n+  };\n+\n+  const onWindowClose = useCallback(\n+    (event: BeforeUnloadEvent) => {\n+      event.preventDefault();\n+      window.confirm(t('misc.navigation-warning'));\n+    },\n+    [t]\n+  );\n+\n+  const onHistoryChange = useCallback(() => {\n+    // We don't block navigation in the following cases.\n+    // - When campers have submitted the quiz:\n+    //   - If they don't pass, the Finish Quiz button is disabled, there isn't anything for them to do other than leaving the page\n+    //   - If they pass, the Submit-and-go button shows up, and campers should be allowed to leave the page\n+    // - When they have clicked the exit button on the exit modal\n+    if (hasSubmitted || exitConfirmed) {\n+      return;\n+    }\n \n-    const unansweredList = quizData.reduce<number[]>(\n-      (acc, curr, id) => (curr.selectedAnswer == null ? [...acc, id + 1] : acc),\n-      []\n-    );\n+    void navigate(`${curLocation.pathname}`);\n+    openExitQuizModal();\n+  }, [curLocation.pathname, hasSubmitted, exitConfirmed, openExitQuizModal]);\n \n-    if (unansweredList.length > 0) {\n+  usePageLeave({\n+    onWindowClose,\n+    onHistoryChange\n+  });\n+\n+  function getErrorMessage() {\n+    if (showUnanswered && unanswered.length > 0) {\n       return t('learn.quiz.unanswered-questions', {\n-        unansweredQuestions: unansweredList.join(', ')\n+        unansweredQuestions: unanswered.join(', ')\n       });\n     }\n \n-    return t('learn.quiz.have-n-correct-questions', {\n-      correctAnswerCount,\n-      total: quiz.length\n-    });\n+    if (validated) {\n+      // TODO: Update the message to include link(s) to the review materials\n+      // if campers didn't pass the quiz.\n+      return t('learn.quiz.have-n-correct-questions', {\n+        correctAnswerCount,\n+        total: quiz.length\n+      });\n+    }\n+\n+    return '';\n   }\n \n   const errorMessage = getErrorMessage();\n \n   return (\n     <Hotkeys\n-      executeChallenge={!isPassed ? handleAnswersCheck : handleSubmitAndGo}\n+      executeChallenge={!isPassed ? handleFinishQuiz : handleSubmitAndGo}\n       containerRef={container}\n       nextChallengePath={nextChallengePath}\n       prevChallengePath={prevChallengePath}\n@@ -255,24 +328,17 @@ const ShowQuiz = ({\n                 {errorMessage}\n               </div>\n               <Spacer size='m' />\n-              {/*\n-                 There are three cases for the button display:\n-                 1. Campers submit the answers but don't pass\n-                 2. Campers submit the answers and pass, click the submit button on the completion modal\n-                 3. Campers submit the answers and pass, but they close the completion modal\n-\n-                 This rendering logic is only handling (2) and (3).\n-                 TODO: Update the logic to handle (1).\n-                 The code should render a link that points campers to the module's review block.\n-               */}\n               {!isPassed ? (\n-                <Button\n-                  block={true}\n-                  variant='primary'\n-                  onClick={handleAnswersCheck}\n-                >\n-                  {t('buttons.check-answer')}\n-                </Button>\n+                <>\n+                  <Button\n+                    block={true}\n+                    variant='primary'\n+                    onClick={handleFinishQuiz}\n+                    disabled={hasSubmitted}\n+                  >\n+                    {t('buttons.finish-quiz')}\n+                  </Button>\n+                </>\n               ) : (\n                 <Button\n                   block={true}\n@@ -282,11 +348,17 @@ const ShowQuiz = ({\n                   {t('buttons.submit-and-go')}\n                 </Button>\n               )}\n+              <Spacer size='xxs' />\n+              <Button block={true} variant='primary' onClick={handleExitQuiz}>\n+                {t('buttons.exit-quiz')}\n+              </Button>\n               <Spacer size='l' />\n             </Col>\n-            <CompletionModal />\n           </Row>\n         </Container>\n+        <CompletionModal />\n+        <ExitQuizModal onExit={handleExitQuizModalBtnClick} />\n+        <FinishQuizModal onFinish={handleFinishQuizModalBtnClick} />\n       </LearnLayout>\n     </Hotkeys>\n   );\n@@ -307,6 +379,7 @@ export const query = graphql`\n         superBlock\n         block\n         fields {\n+          blockHashSlug\n           blockName\n           slug\n           tests {"
        },
        {
            "sha": "0e331c874915f61610178a2f47160a1084caed32",
            "filename": "client/src/templates/Challenges/redux/index.js",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Findex.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Findex.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Findex.js?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -43,6 +43,8 @@ const initialState = {\n     reset: false,\n     exitExam: false,\n     finishExam: false,\n+    exitQuiz: false,\n+    finishQuiz: false,\n     examResults: false,\n     survey: false,\n     projectPreview: false,"
        },
        {
            "sha": "ea893c2ad9e3beb7b32c4d8469b5eee2ae2fdd70",
            "filename": "client/src/templates/Challenges/redux/selectors.js",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Fselectors.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Fselectors.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Fselectors.js?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -37,6 +37,9 @@ export const isFinishExamModalOpenSelector = state =>\n export const isSurveyModalOpenSelector = state => state[ns].modal.survey;\n export const isExamResultsModalOpenSelector = state =>\n   state[ns].modal.examResults;\n+export const isExitQuizModalOpenSelector = state => state[ns].modal.exitQuiz;\n+export const isFinishQuizModalOpenSelector = state =>\n+  state[ns].modal.finishQuiz;\n export const isProjectPreviewModalOpenSelector = state =>\n   state[ns].modal.projectPreview;\n export const isShortcutsModalOpenSelector = state => state[ns].modal.shortcuts;"
        },
        {
            "sha": "fb6509da0102bdb932a31397d140649efaafaf15",
            "filename": "e2e/quiz-challenge.spec.ts",
            "status": "added",
            "additions": 137,
            "deletions": 0,
            "changes": 137,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/e2e%2Fquiz-challenge.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/e2e%2Fquiz-challenge.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fquiz-challenge.spec.ts?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -0,0 +1,137 @@\n+import { test, expect } from '@playwright/test';\n+\n+test.describe('Quiz challenge', () => {\n+  test.skip(\n+    () => process.env.SHOW_UPCOMING_CHANGES !== 'true',\n+    'The FSD superblock is not available if SHOW_UPCOMING_CHANGES is false'\n+  );\n+\n+  test.use({ storageState: 'playwright/.auth/certified-user.json' });\n+\n+  test.beforeEach(async ({ page }) => {\n+    await page.goto(\n+      '/learn/full-stack-developer/quiz-basic-html/quiz-basic-html'\n+    );\n+  });\n+\n+  test('should display a list of unanswered questions if user has not answered all questions', async ({\n+    page\n+  }) => {\n+    // Wait for the page content to render\n+    await expect(page.getByRole('radiogroup')).toHaveCount(20);\n+\n+    for (let i = 0; i < 15; i++) {\n+      const radioGroups = await page.getByRole('radiogroup').all();\n+      await radioGroups[i].getByRole('radio').first().click();\n+    }\n+\n+    await page.getByRole('button', { name: 'Finish the quiz' }).click();\n+\n+    await expect(\n+      page.getByText(\n+        'The following questions are unanswered: 16, 17, 18, 19, 20. You must answer all questions.'\n+      )\n+    ).toBeVisible();\n+  });\n+\n+  test('should show a confirm finish modal when user clicks the finish button, and disable the quiz once they have confirmed', async ({\n+    page\n+  }) => {\n+    // Wait for the page content to render\n+    await expect(page.getByRole('radiogroup')).toHaveCount(20);\n+\n+    const radioGroups = await page.getByRole('radiogroup').all();\n+\n+    for (const radioGroup of radioGroups) {\n+      await radioGroup.getByRole('radio').first().click();\n+    }\n+\n+    await page.getByRole('button', { name: 'Finish the quiz' }).click();\n+    await expect(\n+      page.getByRole('dialog', { name: 'Finish Quiz' })\n+    ).toBeVisible();\n+\n+    await page.getByRole('button', { name: 'Yes, I am finished' }).click();\n+    await expect(\n+      page.getByRole('dialog', { name: 'Finish Quiz' })\n+    ).toBeHidden();\n+\n+    const radios = await page.getByRole('radio').all();\n+\n+    for (const radio of radios) {\n+      await expect(radio).toBeDisabled();\n+    }\n+  });\n+\n+  test('should show a confirm exit modal when user clicks on the exit button', async ({\n+    page\n+  }) => {\n+    // Wait for the page content to render\n+    await expect(page.getByRole('radiogroup')).toHaveCount(20);\n+\n+    await page.getByRole('button', { name: 'Exit the quiz' }).click();\n+\n+    // The navigation should be blocked, the user should stay on the same page\n+    await expect(page).toHaveURL(\n+      '/learn/front-end-development/quiz-basic-html/quiz-basic-html'\n+    );\n+\n+    await expect(page.getByRole('dialog')).toBeVisible();\n+    await expect(page.getByRole('dialog', { name: 'Exit Quiz' })).toBeVisible();\n+\n+    await page\n+      .getByRole('button', { name: 'No, I would like to continue the quiz' })\n+      .click();\n+    await expect(page.getByRole('dialog', { name: 'Exit Quiz' })).toBeHidden();\n+\n+    await page.getByRole('button', { name: 'Exit the quiz' }).click();\n+    await expect(page.getByRole('dialog', { name: 'Exit Quiz' })).toBeVisible();\n+    await page\n+      .getByRole('button', { name: 'Yes, I want to leave the quiz' })\n+      .click();\n+\n+    await page.waitForURL('/learn/front-end-development/#quiz-basic-html');\n+    await expect(\n+      page.getByRole('heading', { level: 3, name: 'Basic HTML Quiz' })\n+    ).toBeVisible();\n+  });\n+\n+  test('should show a confirm exit modal when user clicks on a link', async ({\n+    page\n+  }) => {\n+    // Wait for the page content to render\n+    await expect(page.getByRole('radiogroup')).toHaveCount(20);\n+\n+    await page.getByRole('link', { name: 'Basic HTML Quiz' }).click();\n+\n+    await expect(page.getByRole('dialog', { name: 'Exit Quiz' })).toBeVisible();\n+    await page\n+      .getByRole('button', { name: 'Yes, I want to leave the quiz' })\n+      .click();\n+\n+    await page.waitForURL('/learn/front-end-development/#quiz-basic-html');\n+    await expect(\n+      page.getByRole('heading', { level: 3, name: 'Basic HTML Quiz' })\n+    ).toBeVisible();\n+  });\n+\n+  test('should show a confirm exit modal when user closes the page', async ({\n+    page,\n+    browserName\n+  }) => {\n+    test.skip(\n+      browserName === 'webkit' || browserName === 'chromium',\n+      'This test is flaky on Chromium and WebKit'\n+    );\n+\n+    // Wait for the page content to render\n+    await expect(page.getByRole('radiogroup')).toHaveCount(20);\n+\n+    page.on('dialog', async dialog => {\n+      expect(dialog.type()).toBe('beforeunload');\n+      await dialog.dismiss();\n+    });\n+\n+    await page.close({ runBeforeUnload: true });\n+  });\n+});"
        },
        {
            "sha": "e6bd9a5e67ed961529ae399e52cdbd1c61746bca",
            "filename": "pnpm-lock.yaml",
            "status": "modified",
            "additions": 29,
            "deletions": 14,
            "changes": 43,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/2e76ea10da86deeed2baa9d44c96e7e16160472f/pnpm-lock.yaml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/2e76ea10da86deeed2baa9d44c96e7e16160472f/pnpm-lock.yaml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/pnpm-lock.yaml?ref=2e76ea10da86deeed2baa9d44c96e7e16160472f",
            "patch": "@@ -471,8 +471,8 @@ importers:\n         specifier: 1.1.0\n         version: 1.1.0(react@16.14.0)\n       '@freecodecamp/ui':\n-        specifier: 2.1.0\n-        version: 2.1.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)\n+        specifier: 3.0.0\n+        version: 3.0.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)\n       '@growthbook/growthbook-react':\n         specifier: 0.20.0\n         version: 0.20.0(react@16.14.0)\n@@ -3090,8 +3090,8 @@ packages:\n     peerDependencies:\n       react: ^0.14.0 || ^15.0.0 || ^16.0.0 || ^17.0.0 || ^18.0.0\n \n-  '@freecodecamp/ui@2.1.0':\n-    resolution: {integrity: sha512-KL9QVvBlVjkls9BWTpsxNQdp88OmR+x9qE/jNvKcGRByFVsLXbAblb1cRcz8YXPPdB4vpImMT8Q3baxZTHn28Q==}\n+  '@freecodecamp/ui@3.0.0':\n+    resolution: {integrity: sha512-/Gqw8YLYgpugIJctyGuqTjN+Tp9zT4o126rbct9bISdgiCH0+qFkbksGoH/B2lVyFzHg8/Pl1i5t2jvuxMT19Q==}\n     engines: {node: '>=20', pnpm: '9'}\n     peerDependencies:\n       react: ^16.14.0 || ^17.0.0 || ^18.0.0\n@@ -3571,6 +3571,15 @@ packages:\n       '@types/react':\n         optional: true\n \n+  '@radix-ui/react-context@1.1.1':\n+    resolution: {integrity: sha512-UASk9zi+crv9WteK/NU4PLvOoL3OuE6BWVKNF6hPRBtYBDXQ2u5iu3O59zUlJiTVvkyuycnqrztsHVJwcK9K+Q==}\n+    peerDependencies:\n+      '@types/react': '*'\n+      react: ^16.8 || ^17.0 || ^18.0 || ^19.0 || ^19.0.0-rc\n+    peerDependenciesMeta:\n+      '@types/react':\n+        optional: true\n+\n   '@radix-ui/react-direction@1.1.0':\n     resolution: {integrity: sha512-BUuBvgThEiAXh2DWu93XsT+a3aWrGqolGlqqw5VU1kG7p/ZH2cuDlM1sRLNnY3QcBS69UIz2mcKhMxDsdewhjg==}\n     peerDependencies:\n@@ -3589,8 +3598,8 @@ packages:\n       '@types/react':\n         optional: true\n \n-  '@radix-ui/react-presence@1.1.0':\n-    resolution: {integrity: sha512-Gq6wuRN/asf9H/E/VzdKoUtT8GC9PQc9z40/vEr0VCJ4u5XvvhWIrSsCB6vD2/cH7ugTdSfYq9fLJCcM00acrQ==}\n+  '@radix-ui/react-presence@1.1.1':\n+    resolution: {integrity: sha512-IeFXVi4YS1K0wVZzXNrbaaUvIJ3qdY+/Ih4eHFhWA9SwGR9UDX7Ck8abvL57C4cv3wwMvUE0OG69Qc3NCcTe/A==}\n     peerDependencies:\n       '@types/react': '*'\n       '@types/react-dom': '*'\n@@ -3637,8 +3646,8 @@ packages:\n       '@types/react':\n         optional: true\n \n-  '@radix-ui/react-tabs@1.1.0':\n-    resolution: {integrity: sha512-bZgOKB/LtZIij75FSuPzyEti/XBhJH52ExgtdVqjCIh+Nx/FW+LhnbXtbCzIi34ccyMsyOja8T0thCzoHFXNKA==}\n+  '@radix-ui/react-tabs@1.1.1':\n+    resolution: {integrity: sha512-3GBUDmP2DvzmtYLMsHmpA1GtR46ZDZ+OreXM/N+kkQJOPIgytFWWTfDQmBQKBvaFS0Vno0FktdbVzN28KGrMdw==}\n     peerDependencies:\n       '@types/react': '*'\n       '@types/react-dom': '*'\n@@ -16976,13 +16985,13 @@ snapshots:\n       prop-types: 15.8.1\n       react: 16.14.0\n \n-  '@freecodecamp/ui@2.1.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)':\n+  '@freecodecamp/ui@3.0.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)':\n     dependencies:\n       '@fortawesome/fontawesome-svg-core': 6.6.0\n       '@fortawesome/free-solid-svg-icons': 6.6.0\n       '@fortawesome/react-fontawesome': 0.2.2(@fortawesome/fontawesome-svg-core@6.6.0)(react@16.14.0)\n       '@headlessui/react': 1.7.19(react-dom@16.14.0(react@16.14.0))(react@16.14.0)\n-      '@radix-ui/react-tabs': 1.1.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)\n+      '@radix-ui/react-tabs': 1.1.1(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)\n       babel-plugin-prismjs: 2.1.0(prismjs@1.29.0)\n       prismjs: 1.29.0\n       react: 16.14.0\n@@ -17595,6 +17604,12 @@ snapshots:\n     optionalDependencies:\n       '@types/react': 16.14.56\n \n+  '@radix-ui/react-context@1.1.1(@types/react@16.14.56)(react@16.14.0)':\n+    dependencies:\n+      react: 16.14.0\n+    optionalDependencies:\n+      '@types/react': 16.14.56\n+\n   '@radix-ui/react-direction@1.1.0(@types/react@16.14.56)(react@16.14.0)':\n     dependencies:\n       react: 16.14.0\n@@ -17608,7 +17623,7 @@ snapshots:\n     optionalDependencies:\n       '@types/react': 16.14.56\n \n-  '@radix-ui/react-presence@1.1.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)':\n+  '@radix-ui/react-presence@1.1.1(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)':\n     dependencies:\n       '@radix-ui/react-compose-refs': 1.1.0(@types/react@16.14.56)(react@16.14.0)\n       '@radix-ui/react-use-layout-effect': 1.1.0(@types/react@16.14.56)(react@16.14.0)\n@@ -17651,13 +17666,13 @@ snapshots:\n     optionalDependencies:\n       '@types/react': 16.14.56\n \n-  '@radix-ui/react-tabs@1.1.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)':\n+  '@radix-ui/react-tabs@1.1.1(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)':\n     dependencies:\n       '@radix-ui/primitive': 1.1.0\n-      '@radix-ui/react-context': 1.1.0(@types/react@16.14.56)(react@16.14.0)\n+      '@radix-ui/react-context': 1.1.1(@types/react@16.14.56)(react@16.14.0)\n       '@radix-ui/react-direction': 1.1.0(@types/react@16.14.56)(react@16.14.0)\n       '@radix-ui/react-id': 1.1.0(@types/react@16.14.56)(react@16.14.0)\n-      '@radix-ui/react-presence': 1.1.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)\n+      '@radix-ui/react-presence': 1.1.1(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)\n       '@radix-ui/react-primitive': 2.0.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)\n       '@radix-ui/react-roving-focus': 1.1.0(@types/react-dom@16.9.24)(@types/react@16.14.56)(react-dom@16.14.0(react@16.14.0))(react@16.14.0)\n       '@radix-ui/react-use-controllable-state': 1.1.0(@types/react@16.14.56)(react@16.14.0)"
        }
    ],
    "stats": {
        "total": 504,
        "additions": 447,
        "deletions": 57
    }
}