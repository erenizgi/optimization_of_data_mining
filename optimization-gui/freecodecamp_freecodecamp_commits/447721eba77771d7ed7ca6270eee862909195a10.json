{
    "author": "ojeytonwilliams",
    "message": "fix: memoize completedPercentageSelector (#54925)",
    "sha": "447721eba77771d7ed7ca6270eee862909195a10",
    "files": [
        {
            "sha": "c1f6215923042e2e3284a367f4393cadfcb6e34f",
            "filename": "client/src/templates/Challenges/redux/completion-epic.test.js",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/447721eba77771d7ed7ca6270eee862909195a10/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Fcompletion-epic.test.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/447721eba77771d7ed7ca6270eee862909195a10/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Fcompletion-epic.test.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Fcompletion-epic.test.js?ref=447721eba77771d7ed7ca6270eee862909195a10",
            "patch": "@@ -17,7 +17,10 @@ describe('completionEpic', () => {\n       const state$ = {\n         value: {\n           challenge: { challengeMeta: { challengeType: 0 } },\n-          app: { user: { username: 'test' } }\n+          app: {\n+            user: { username: 'test' },\n+            allChallengesInfo: { challengeEdges: [], certificateNodes: [] }\n+          }\n         }\n       };\n "
        },
        {
            "sha": "1f7d66c8b6c19e5f91ffe5b6499a010810b35d93",
            "filename": "client/src/templates/Challenges/redux/selectors.js",
            "status": "modified",
            "additions": 30,
            "deletions": 24,
            "changes": 54,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/447721eba77771d7ed7ca6270eee862909195a10/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Fselectors.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/447721eba77771d7ed7ca6270eee862909195a10/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Fselectors.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fredux%2Fselectors.js?ref=447721eba77771d7ed7ca6270eee862909195a10",
            "patch": "@@ -1,3 +1,4 @@\n+import { createSelector } from 'reselect';\n import { challengeTypes } from '../../../../../shared/config/challenge-types';\n import {\n   completedChallengesSelector,\n@@ -103,17 +104,20 @@ export const challengeDataSelector = state => {\n   return challengeData;\n };\n \n-export const currentBlockIdsSelector = state => {\n-  const { block, certification, challengeType } = challengeMetaSelector(state);\n-  const allChallengesInfo = allChallengesInfoSelector(state);\n+export const currentBlockIdsSelector = createSelector(\n+  challengeMetaSelector,\n+  allChallengesInfoSelector,\n+  (challengeMeta, allChallengesInfo) => {\n+    const { block, certification, challengeType } = challengeMeta;\n \n-  return getCurrentBlockIds(\n-    allChallengesInfo,\n-    block,\n-    certification,\n-    challengeType\n-  );\n-};\n+    return getCurrentBlockIds(\n+      allChallengesInfo,\n+      block,\n+      certification,\n+      challengeType\n+    );\n+  }\n+);\n \n export const completedChallengesInBlockSelector = state => {\n   const completedChallengesIds = completedChallengesIdsSelector(state);\n@@ -127,20 +131,22 @@ export const completedChallengesInBlockSelector = state => {\n   );\n };\n \n-export const completedPercentageSelector = state => {\n-  const isSignedIn = isSignedInSelector(state);\n-  if (isSignedIn) {\n-    const completedChallengesIds = completedChallengesIdsSelector(state);\n-    const { id } = challengeMetaSelector(state);\n-    const currentBlockIds = currentBlockIdsSelector(state);\n-    const completedPercentage = getCompletedPercentage(\n-      completedChallengesIds,\n-      currentBlockIds,\n-      id\n-    );\n-    return completedPercentage;\n-  } else return 0;\n-};\n+export const completedPercentageSelector = createSelector(\n+  isSignedInSelector,\n+  completedChallengesSelector,\n+  challengeMetaSelector,\n+  currentBlockIdsSelector,\n+  (isSignedIn, completedChallenges, { id }, currentBlockIds) => {\n+    if (isSignedIn) {\n+      const completedPercentage = getCompletedPercentage(\n+        completedChallenges.map(node => node.id),\n+        currentBlockIds,\n+        id\n+      );\n+      return completedPercentage;\n+    } else return 0;\n+  }\n+);\n \n export const isBlockNewlyCompletedSelector = state => {\n   const completedPercentage = completedPercentageSelector(state);"
        }
    ],
    "stats": {
        "total": 59,
        "additions": 34,
        "deletions": 25
    }
}