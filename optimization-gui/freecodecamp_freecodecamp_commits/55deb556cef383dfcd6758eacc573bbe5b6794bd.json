{
    "author": "ShaunSHamilton",
    "message": "feat(api): add sentry event route",
    "sha": "55deb556cef383dfcd6758eacc573bbe5b6794bd",
    "files": [
        {
            "sha": "1596468b2ca2d67333298baf8734781f490c5715",
            "filename": "api/src/app.ts",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Fapp.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Fapp.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fapp.ts?ref=55deb556cef383dfcd6758eacc573bbe5b6794bd",
            "patch": "@@ -38,7 +38,8 @@ import {\n   FCC_ENABLE_DEV_LOGIN_MODE,\n   FCC_ENABLE_SWAGGER_UI,\n   FCC_ENABLE_SHADOW_CAPTURE,\n-  FCC_ENABLE_EXAM_ENVIRONMENT\n+  FCC_ENABLE_EXAM_ENVIRONMENT,\n+  FCC_ENABLE_SENTRY_ROUTES\n } from './utils/env';\n import { isObjectID } from './utils/validation';\n import {\n@@ -198,6 +199,10 @@ export const build = async (\n     void fastify.register(examEnvironmentOpenRoutes);\n   }\n \n+  if (FCC_ENABLE_SENTRY_ROUTES) {\n+    void fastify.register(publicRoutes.sentryRoutes);\n+  }\n+\n   void fastify.register(publicRoutes.chargeStripeRoute);\n   void fastify.register(publicRoutes.signoutRoute);\n   void fastify.register(publicRoutes.emailSubscribtionRoutes);"
        },
        {
            "sha": "7bbb12f5fd19f9a7428eedfb9b920a916b8908e4",
            "filename": "api/src/routes/public/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Froutes%2Fpublic%2Findex.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Froutes%2Fpublic%2Findex.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Froutes%2Fpublic%2Findex.ts?ref=55deb556cef383dfcd6758eacc573bbe5b6794bd",
            "patch": "@@ -8,3 +8,4 @@ export * from './email-subscription';\n export * from './signout';\n export * from './status';\n export * from './user';\n+export * from './sentry';"
        },
        {
            "sha": "60e7070545094a667adf900f0ae25d9f2ac20fd6",
            "filename": "api/src/routes/public/sentry.ts",
            "status": "added",
            "additions": 41,
            "deletions": 0,
            "changes": 41,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Froutes%2Fpublic%2Fsentry.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Froutes%2Fpublic%2Fsentry.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Froutes%2Fpublic%2Fsentry.ts?ref=55deb556cef383dfcd6758eacc573bbe5b6794bd",
            "patch": "@@ -0,0 +1,41 @@\n+/* eslint-disable jsdoc/require-returns, jsdoc/require-param */\n+import { type FastifyPluginCallbackTypebox } from '@fastify/type-provider-typebox';\n+import { type FastifyInstance, type FastifyReply } from 'fastify';\n+\n+import { UpdateReqType } from '../../utils';\n+import * as schemas from '../../schemas';\n+\n+/**\n+ * Plugin for Sentry-related endpoints.\n+ *\n+ * @param fastify The Fastify instance.\n+ * @param _options Options passed to the plugin via `fastify.register(plugin,\n+ * options)`.\n+ * @param done The callback to signal that the plugin is ready.\n+ */\n+export const sentryRoutes: FastifyPluginCallbackTypebox = (\n+  fastify,\n+  _options,\n+  done\n+) => {\n+  fastify.post(\n+    '/sentry/event',\n+    {\n+      schema: schemas.sentryPostEvent\n+    },\n+    postSentryEventHandler\n+  );\n+\n+  done();\n+};\n+\n+/**\n+ * Creates a new event in Sentry.\n+ */\n+function postSentryEventHandler(\n+  this: FastifyInstance,\n+  req: UpdateReqType<typeof schemas.sentryPostEvent>,\n+  _reply: FastifyReply\n+) {\n+  throw new Error(`Sentry Test: ${req.body.text}`);\n+}"
        },
        {
            "sha": "8afb7f295ed752e90caebbcf794b615df25fd4de",
            "filename": "api/src/schemas.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Fschemas.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Fschemas.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fschemas.ts?ref=55deb556cef383dfcd6758eacc573bbe5b6794bd",
            "patch": "@@ -41,3 +41,4 @@ export { reportUser } from './schemas/user/report-user';\n export { resetMyProgress } from './schemas/user/reset-my-progress';\n export { submitSurvey } from './schemas/user/submit-survey';\n export { userExamEnvironmentToken } from './schemas/user/exam-environment-token';\n+export { sentryPostEvent } from './schemas/sentry/event';"
        },
        {
            "sha": "fc5150ccd2560484b1a93b308dd4094e80c1b3e8",
            "filename": "api/src/schemas/sentry/event.ts",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Fschemas%2Fsentry%2Fevent.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Fschemas%2Fsentry%2Fevent.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fschemas%2Fsentry%2Fevent.ts?ref=55deb556cef383dfcd6758eacc573bbe5b6794bd",
            "patch": "@@ -0,0 +1,13 @@\n+import { Type } from '@fastify/type-provider-typebox';\n+\n+export const sentryPostEvent = {\n+  body: Type.Object({\n+    text: Type.String()\n+  }),\n+  response: {\n+    500: Type.Object({\n+      message: Type.Literal('flash.generic-error'),\n+      type: Type.Literal('danger')\n+    })\n+  }\n+};"
        },
        {
            "sha": "813df7a561c5c67a986701555b8f4669247c4f76",
            "filename": "api/src/utils/env.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Futils%2Fenv.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/55deb556cef383dfcd6758eacc573bbe5b6794bd/api%2Fsrc%2Futils%2Fenv.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Futils%2Fenv.ts?ref=55deb556cef383dfcd6758eacc573bbe5b6794bd",
            "patch": "@@ -135,6 +135,8 @@ export const FCC_ENABLE_SHADOW_CAPTURE =\n   process.env.FCC_ENABLE_SHADOW_CAPTURE === 'true';\n export const FCC_ENABLE_EXAM_ENVIRONMENT =\n   process.env.FCC_ENABLE_EXAM_ENVIRONMENT === 'true';\n+export const FCC_ENABLE_SENTRY_ROUTES =\n+  process.env.FCC_ENABLE_SENTRY_ROUTES === 'true';\n export const SENTRY_DSN =\n   process.env.SENTRY_DSN === 'dsn_from_sentry_dashboard'\n     ? ''"
        },
        {
            "sha": "9eaca7eb8c66080b3c273c70c338f9e10a16d70e",
            "filename": "sample.env",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/55deb556cef383dfcd6758eacc573bbe5b6794bd/sample.env",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/55deb556cef383dfcd6758eacc573bbe5b6794bd/sample.env",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/sample.env?ref=55deb556cef383dfcd6758eacc573bbe5b6794bd",
            "patch": "@@ -70,6 +70,7 @@ FCC_ENABLE_SWAGGER_UI=true\n FCC_ENABLE_DEV_LOGIN_MODE=true\n FCC_ENABLE_SHADOW_CAPTURE=false\n FCC_ENABLE_EXAM_ENVIRONMENT=false\n+FCC_ENABLE_SENTRY_ROUTES=false\n \n # Email\n # use ses in production"
        }
    ],
    "stats": {
        "total": 66,
        "additions": 65,
        "deletions": 1
    }
}