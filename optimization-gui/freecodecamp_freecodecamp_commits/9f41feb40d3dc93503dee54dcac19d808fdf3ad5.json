{
    "author": "Sembauke",
    "message": "feat: convert hotkeys tests to Playwright (#54938)\n\nCo-authored-by: Huyen Nguyen <25715018+huyenltnguyen@users.noreply.github.com>",
    "sha": "9f41feb40d3dc93503dee54dcac19d808fdf3ad5",
    "files": [
        {
            "sha": "ea1bc032012563177320e529b9b6f4aa3252252f",
            "filename": "cypress/e2e/default/learn/challenge-hot-keys.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 107,
            "changes": 107,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/6ffbbed52638c29211f25ba1f037142fe9b69880/cypress%2Fe2e%2Fdefault%2Flearn%2Fchallenge-hot-keys.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/6ffbbed52638c29211f25ba1f037142fe9b69880/cypress%2Fe2e%2Fdefault%2Flearn%2Fchallenge-hot-keys.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/cypress%2Fe2e%2Fdefault%2Flearn%2Fchallenge-hot-keys.ts?ref=6ffbbed52638c29211f25ba1f037142fe9b69880",
            "patch": "@@ -1,107 +0,0 @@\n-import { selectors } from '../../../support/selectors';\n-\n-const hotKeySelectors = {\n-  instructions: '.challenge-instructions',\n-  instructionsPanel: '.instructions-panel',\n-  editorContainer: '.monaco-editor'\n-};\n-\n-const links = {\n-  classic1:\n-    '/learn/responsive-web-design/basic-html-and-html5/say-hello-to-html-elements',\n-  classic2:\n-    '/learn/responsive-web-design/basic-html-and-html5/headline-with-the-h2-element',\n-  frontEnd1:\n-    '/learn/front-end-development-libraries/front-end-development-libraries-projects/build-a-random-quote-machine',\n-  frontEnd2:\n-    '/learn/front-end-development-libraries/front-end-development-libraries-projects/build-a-markdown-previewer',\n-  backEnd1:\n-    '/learn/back-end-development-and-apis/back-end-development-and-apis-projects/timestamp-microservice',\n-  backEnd2:\n-    'learn/back-end-development-and-apis/back-end-development-and-apis-projects/request-header-parser-microservice',\n-  video1:\n-    '/learn/scientific-computing-with-python/python-for-everybody/introduction-why-program',\n-  video2:\n-    'learn/scientific-computing-with-python/python-for-everybody/introduction-hardware-architecture'\n-};\n-\n-// It's possible for the location to change before the new page has loaded, so\n-// we wait for these titles to be present:\n-const titles = {\n-  classic2: 'Headline with the h2 Element',\n-  frontEnd2: 'Build a Markdown Previewer',\n-  backEnd2: 'Request Header Parser Microservice',\n-  video2: 'Introduction: Hardware Architecture'\n-};\n-\n-describe('The hotkeys should work correctly', () => {\n-  beforeEach(() => {\n-    cy.login();\n-    cy.visit('/settings');\n-    // enable shortcuts\n-    cy.get('form[data-testid=\"fcc-enable-shortcuts-setting\"]').within(() => {\n-      cy.contains('On').click();\n-    });\n-  });\n-  it('should be possible to navigate to the next challenge/projects and previous', () => {\n-    cy.visit(links.classic1);\n-    cy.focused().type('{esc}');\n-    cy.focused().type('n');\n-    cy.url().should('include', links.classic2);\n-    cy.contains(titles.classic2);\n-    cy.focused().type('p');\n-    cy.url().should('include', links.classic1);\n-    cy.visit(links.frontEnd1);\n-    cy.focused().type('{esc}').type('n');\n-    cy.url().should('include', links.frontEnd2);\n-    cy.contains(titles.frontEnd2);\n-    cy.focused().type('p');\n-    cy.url().should('include', links.frontEnd1);\n-  });\n-\n-  it('should be possible to navigate to the next (and previous) video', () => {\n-    cy.visit(links.video1);\n-    cy.focused().type('{esc}').type('n');\n-    cy.url().should('include', links.video2);\n-    cy.contains(titles.video2);\n-    cy.focused().type('p');\n-    cy.url().should('include', links.video1);\n-  });\n-\n-  it('should be possible to navigate to the next (and previous) backend project', () => {\n-    cy.visit(links.backEnd1);\n-    cy.focused().type('{esc}').type('n');\n-    cy.url().should('include', links.backEnd2);\n-    cy.contains(titles.backEnd2);\n-    cy.focused().type('p');\n-    cy.url().should('include', links.backEnd1);\n-  });\n-\n-  it('should be possible to focus on the editor with pressing \"e\"', () => {\n-    cy.visit(links.classic1);\n-    cy.get(hotKeySelectors.editorContainer).click();\n-    cy.focused().as('editor').type('{esc}');\n-    cy.get(hotKeySelectors.instructions).click().type('e');\n-    cy.get('@editor').should('have.focus');\n-  });\n-\n-  it('should be possible to press ctrl enter to run the test', () => {\n-    cy.visit(links.classic1);\n-    cy.get(hotKeySelectors.instructions).click().type('{ctrl}{enter}');\n-    cy.get(selectors.dataCy.outputText).contains('// running tests');\n-  });\n-\n-  it('should be possible to go to navigation view by pressing escape', () => {\n-    cy.visit(links.classic1);\n-    cy.get(hotKeySelectors.editorContainer).click();\n-    cy.focused().as('editor').type('{esc}');\n-    cy.get('@editor').should('not.have.focus');\n-  });\n-\n-  it('it should be possible to focus on the instructions by pressing r', () => {\n-    cy.visit(links.classic1);\n-    cy.get(hotKeySelectors.editorContainer).type('{esc}');\n-    cy.get(selectors.dataCy.outputText).click().type('r');\n-    cy.get(hotKeySelectors.instructionsPanel).should('have.focus');\n-  });\n-});"
        },
        {
            "sha": "d3db5845fd157549059c5ce6ddfb1f911996e16f",
            "filename": "e2e/hotkeys.spec.ts",
            "status": "modified",
            "additions": 73,
            "deletions": 12,
            "changes": 85,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/9f41feb40d3dc93503dee54dcac19d808fdf3ad5/e2e%2Fhotkeys.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/9f41feb40d3dc93503dee54dcac19d808fdf3ad5/e2e%2Fhotkeys.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fhotkeys.spec.ts?ref=9f41feb40d3dc93503dee54dcac19d808fdf3ad5",
            "patch": "@@ -7,6 +7,21 @@ import { getEditors } from './utils/editor';\n const course =\n   '/learn/javascript-algorithms-and-data-structures/basic-javascript/comment-your-javascript-code';\n \n+const links = {\n+  frontEnd1:\n+    '/learn/front-end-development-libraries/front-end-development-libraries-projects/build-a-random-quote-machine',\n+  frontEnd2:\n+    '/learn/front-end-development-libraries/front-end-development-libraries-projects/build-a-markdown-previewer',\n+  backEnd1:\n+    '/learn/back-end-development-and-apis/back-end-development-and-apis-projects/timestamp-microservice',\n+  backEnd2:\n+    'learn/back-end-development-and-apis/back-end-development-and-apis-projects/request-header-parser-microservice',\n+  video1:\n+    '/learn/python-for-everybody/python-for-everybody/introduction-why-program',\n+  video2:\n+    '/learn/python-for-everybody/python-for-everybody/introduction-hardware-architecture'\n+};\n+\n test.use({ storageState: 'playwright/.auth/certified-user.json' });\n \n test.beforeAll(async ({ request }) => {\n@@ -20,6 +35,16 @@ test.beforeAll(async ({ request }) => {\n   });\n });\n \n+test.beforeEach(async ({ page }) => {\n+  await page.goto('/settings');\n+  const keyboardShortcutGroup = page.getByRole('group', {\n+    name: translations.settings.labels['keyboard-shortcuts']\n+  });\n+  await keyboardShortcutGroup\n+    .getByRole('button', { name: translations.buttons.on, exact: true })\n+    .click();\n+});\n+\n test.afterEach(\n   async ({ request }) =>\n     await authedRequest({\n@@ -32,15 +57,7 @@ test.afterEach(\n     })\n );\n \n-test('User can interact with the app using the keyboard', async ({ page }) => {\n-  // Enable keyboard shortcuts\n-  await page.goto('/settings');\n-  const keyboardShortcutGroup = page.getByRole('group', {\n-    name: translations.settings.labels['keyboard-shortcuts']\n-  });\n-  await keyboardShortcutGroup\n-    .getByRole('button', { name: translations.buttons.on, exact: true })\n-    .click();\n+test('User can use shortcuts in and around the editor', async ({ page }) => {\n   // TODO: getByRole('alert', name:\n   // translations.flash['keyboard-shortcut-updated']) did not find the alert.\n   // Should it a) be an alert and b) have a name?\n@@ -73,8 +90,52 @@ test('User can interact with the app using the keyboard', async ({ page }) => {\n   await page.keyboard.press('e');\n   await expect(getEditors(page)).toBeFocused();\n \n-  await page.keyboard.press('Control+Enter');\n-  await expect(page.getByText('running test')).toBeVisible();\n+  await getEditors(page).press('Escape');\n+  await page.keyboard.press('r');\n+  await expect(page.locator('.instructions-panel')).toBeFocused();\n+});\n+\n+test('User can use shortcuts to navigate between frontend projects', async ({\n+  page\n+}) => {\n+  await page.goto(links.frontEnd1);\n+  await expect(page.locator('#editor-layout')).toBeFocused();\n+  await page.keyboard.press('Escape');\n+  await page.keyboard.press('n');\n+\n+  await page.waitForURL(links.frontEnd2);\n+  await expect(page.locator('#editor-layout')).toBeFocused();\n+  await page.keyboard.press('p');\n+  await page.keyboard.press('Escape');\n+  await page.waitForURL(links.frontEnd1);\n+});\n+\n+test('User can use shortcuts to navigate between backend projects', async ({\n+  page\n+}) => {\n+  await page.goto(links.backEnd1);\n+  await expect(page.locator('#editor-layout')).toBeFocused();\n+  await page.keyboard.press('Escape');\n+  await page.keyboard.press('n');\n+\n+  await page.waitForURL(links.backEnd2);\n+  await expect(page.locator('#editor-layout')).toBeFocused();\n+  await page.keyboard.press('p');\n+  await page.keyboard.press('Escape');\n+  await page.waitForURL(links.backEnd1);\n+});\n+\n+test('User can use shortcuts to navigate between video-based challenges', async ({\n+  page\n+}) => {\n+  await page.goto(links.video1);\n+  await expect(page.locator('#editor-layout')).toBeFocused();\n+  await page.keyboard.press('Escape');\n+  await page.keyboard.press('n');\n \n-  // Show shortcuts (shift+/) is covered by the shortcuts-modal tests\n+  await page.waitForURL(links.video2);\n+  await expect(page.locator('#editor-layout')).toBeFocused();\n+  await page.keyboard.press('p');\n+  await page.keyboard.press('Escape');\n+  await page.waitForURL(links.video1);\n });"
        }
    ],
    "stats": {
        "total": 192,
        "additions": 73,
        "deletions": 119
    }
}