{
    "author": "ojeytonwilliams",
    "message": "refactor: remove invariant (#62275)",
    "sha": "c6498cf0b428dea8df4da1f6a69a42a544a1d38d",
    "files": [
        {
            "sha": "7d03a30e68e82be864ff5dc446744c5c78e0e60b",
            "filename": "curriculum/package.json",
            "status": "modified",
            "additions": 0,
            "deletions": 1,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/curriculum%2Fpackage.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/curriculum%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fpackage.json?ref=c6498cf0b428dea8df4da1f6a69a42a544a1d38d",
            "patch": "@@ -47,7 +47,6 @@\n     \"@vitest/ui\": \"^3.2.4\",\n     \"chai\": \"4.4.1\",\n     \"glob\": \"8.1.0\",\n-    \"invariant\": \"2.2.4\",\n     \"joi\": \"17.12.2\",\n     \"joi-objectid\": \"3.0.1\",\n     \"js-yaml\": \"4.0.0\","
        },
        {
            "sha": "f1095ff6f3995f0721edb3bdf9874738420d5695",
            "filename": "docker/api/Dockerfile",
            "status": "modified",
            "additions": 1,
            "deletions": 3,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/docker%2Fapi%2FDockerfile",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/docker%2Fapi%2FDockerfile",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/docker%2Fapi%2FDockerfile?ref=c6498cf0b428dea8df4da1f6a69a42a544a1d38d",
            "patch": "@@ -38,14 +38,13 @@ WORKDIR /home/node/build\n COPY --chown=node:node pnpm*.yaml .\n COPY --chown=node:node package.json .\n COPY --chown=node:node api/ api/\n-COPY --chown=node:node shared/ shared/\n RUN npm i -g pnpm@10\n \n # Weirdly this config does not seem necessary for the new api (the same number\n # of deps are installed in both cases), but I'm including it just for\n # consistency.\n RUN pnpm config set dedupe-peer-dependents false\n-RUN pnpm install --prod --ignore-scripts -F=shared -F=api --frozen-lockfile\n+RUN pnpm install --prod --ignore-scripts -F=api --frozen-lockfile\n RUN cd api && npx prisma@$(jq -r '.devDependencies.prisma' < package.json) generate\n \n FROM node:22-bookworm\n@@ -56,7 +55,6 @@ COPY --from=builder --chown=node:node /home/node/build/api/package.json api/\n COPY --from=builder --chown=node:node /home/node/build/shared/config/curriculum.json shared/config/\n \n COPY --from=deps --chown=node:node /home/node/build/node_modules/ node_modules/\n-COPY --from=deps --chown=node:node /home/node/build/shared/node_modules/ shared/node_modules/\n COPY --from=deps --chown=node:node /home/node/build/api/node_modules/ api/node_modules/\n \n CMD [\"node\", \"api/src/server.js\"]"
        },
        {
            "sha": "23973d70dbc16542969e59ac1ffaf86a6cf6f37c",
            "filename": "knip.jsonc",
            "status": "modified",
            "additions": 0,
            "deletions": 3,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/knip.jsonc",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/knip.jsonc",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/knip.jsonc?ref=c6498cf0b428dea8df4da1f6a69a42a544a1d38d",
            "patch": "@@ -26,9 +26,6 @@\n         \"@redux-saga/core\" // Not referenced, something seems off related to peer dep and types\n       ]\n     },\n-    \"curriculum\": {\n-      \"ignoreDependencies\": [\"invariant\"] // Used from another workspace: shared/utils/polyvinyl.js\n-    },\n     \"shared\": {\n       \"ignore\": [\"{config,utils}/*.ts\"] // Using the same dir for src + outDir files with tsc confuses Knip\n     },"
        },
        {
            "sha": "1fd5275bc3d3e3fc202e38f7915db3ee4f0bbf1a",
            "filename": "pnpm-lock.yaml",
            "status": "modified",
            "additions": 1,
            "deletions": 16,
            "changes": 17,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/pnpm-lock.yaml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/pnpm-lock.yaml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/pnpm-lock.yaml?ref=c6498cf0b428dea8df4da1f6a69a42a544a1d38d",
            "patch": "@@ -736,9 +736,6 @@ importers:\n       glob:\n         specifier: 8.1.0\n         version: 8.1.0\n-      invariant:\n-        specifier: 2.2.4\n-        version: 2.2.4\n       joi:\n         specifier: 17.12.2\n         version: 17.12.2\n@@ -782,14 +779,7 @@ importers:\n         specifier: ^3.2.4\n         version: 3.2.4(@types/node@20.12.8)(@vitest/ui@3.2.4)(jsdom@16.7.0)(msw@2.8.7(@types/node@20.12.8)(typescript@5.8.2))(terser@5.28.1)(tsx@4.19.1)(yaml@2.8.0)\n \n-  shared:\n-    dependencies:\n-      '@types/invariant':\n-        specifier: ^2.2.37\n-        version: 2.2.37\n-      invariant:\n-        specifier: 2.2.4\n-        version: 2.2.4\n+  shared: {}\n \n   tools/challenge-editor/api:\n     dependencies:\n@@ -4610,9 +4600,6 @@ packages:\n   '@types/inquirer@8.2.11':\n     resolution: {integrity: sha512-15UboTvxb9SOaPG7CcXZ9dkv8lNqfiAwuh/5WxJDLjmElBt9tbx1/FDsEnJddUBKvN4mlPKvr8FyO1rAmBanzg==}\n \n-  '@types/invariant@2.2.37':\n-    resolution: {integrity: sha512-IwpIMieE55oGWiXkQPSBY1nw1nFs6bsKXTFskNY8sdS17K24vyEBRQZEwlRS7ZmXCWnJcQtbxWzly+cODWGs2A==}\n-\n   '@types/istanbul-lib-coverage@2.0.4':\n     resolution: {integrity: sha512-z/QT1XN4K4KYuslS23k62yDIDLwLFkzxOuMplDtObz0+y7VqJCaO2o+SPwHCvLFZh7xazvvoor2tA/hPz9ee7g==}\n \n@@ -19615,8 +19602,6 @@ snapshots:\n       '@types/through': 0.0.33\n       rxjs: 7.8.1\n \n-  '@types/invariant@2.2.37': {}\n-\n   '@types/istanbul-lib-coverage@2.0.4': {}\n \n   '@types/istanbul-lib-report@3.0.1':"
        },
        {
            "sha": "b896772fa54824089fe02030b3f1b872ee636b01",
            "filename": "shared/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 5,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/shared%2Fpackage.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/shared%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/shared%2Fpackage.json?ref=c6498cf0b428dea8df4da1f6a69a42a544a1d38d",
            "patch": "@@ -17,9 +17,5 @@\n   \"bugs\": {\n     \"url\": \"https://github.com/freeCodeCamp/freeCodeCamp/issues\"\n   },\n-  \"homepage\": \"https://github.com/freeCodeCamp/freeCodeCamp#readme\",\n-  \"dependencies\": {\n-    \"@types/invariant\": \"^2.2.37\",\n-    \"invariant\": \"2.2.4\"\n-  }\n+  \"homepage\": \"https://github.com/freeCodeCamp/freeCodeCamp#readme\"\n }"
        },
        {
            "sha": "f1f76c4a02f5b24788d995e2a9ff0757d3c39690",
            "filename": "shared/utils/polyvinyl.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 17,
            "changes": 22,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/shared%2Futils%2Fpolyvinyl.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c6498cf0b428dea8df4da1f6a69a42a544a1d38d/shared%2Futils%2Fpolyvinyl.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/shared%2Futils%2Fpolyvinyl.ts?ref=c6498cf0b428dea8df4da1f6a69a42a544a1d38d",
            "patch": "@@ -1,6 +1,3 @@\n-// originally based off of https://github.com/gulpjs/vinyl\n-import invariant from 'invariant';\n-\n const exts = ['js', 'html', 'css', 'jsx', 'ts', 'tsx', 'py'] as const;\n export type Ext = (typeof exts)[number];\n \n@@ -48,15 +45,10 @@ export function createPoly<Rest>({\n   history,\n   ...rest\n }: PolyProps & Rest): PolyProps & AddedProperties & Rest {\n-  invariant(typeof name === 'string', 'name must be a string but got %s', name);\n-\n-  invariant(typeof ext === 'string', 'ext must be a string, but was %s', ext);\n-\n-  invariant(\n-    typeof contents === 'string',\n-    'contents must be a string but got %s',\n-    contents\n-  );\n+  if (typeof name !== 'string') throw new TypeError('name must be a string');\n+  if (typeof ext !== 'string') throw new TypeError('ext must be a string');\n+  if (typeof contents !== 'string')\n+    throw new TypeError('contents must be a string');\n \n   return {\n     ...rest,\n@@ -98,11 +90,7 @@ export function isPoly(poly: unknown): poly is ChallengeFile {\n }\n \n function checkPoly(poly: ChallengeFile) {\n-  invariant(\n-    isPoly(poly),\n-    'function should receive a PolyVinyl, but got %s',\n-    JSON.stringify(poly)\n-  );\n+  if (!isPoly(poly)) throw Error('Not a PolyVinyl: ' + JSON.stringify(poly));\n }\n \n // setContent will lose source if not supplied"
        }
    ],
    "stats": {
        "total": 53,
        "additions": 8,
        "deletions": 45
    }
}