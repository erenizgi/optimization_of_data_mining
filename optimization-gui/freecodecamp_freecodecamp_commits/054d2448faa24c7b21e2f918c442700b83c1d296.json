{
    "author": "ojeytonwilliams",
    "message": "fix(tools): insert step with appropriate challenge type (#62179)",
    "sha": "054d2448faa24c7b21e2f918c442700b83c1d296",
    "files": [
        {
            "sha": "ab0be795ea4ed381adba4a2095835f6e38891fd8",
            "filename": "tools/challenge-helper-scripts/commands.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 7,
            "changes": 19,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Fcommands.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Fcommands.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fcommands.ts?ref=054d2448faa24c7b21e2f918c442700b83c1d296",
            "patch": "@@ -4,7 +4,7 @@ import { getMetaData } from './helpers/project-metadata';\n import {\n   createStepFile,\n   deleteStepFromMeta,\n-  getChallengeSeeds,\n+  getChallenge,\n   insertStepIntoMeta,\n   updateStepTitles\n } from './utils';\n@@ -43,15 +43,20 @@ async function insertStep(stepNum: number): Promise<void> {\n       }.`\n     );\n \n-  const challengeSeeds =\n-    stepNum > 1\n-      ? getChallengeSeeds(\n-          `${getProjectPath()}${challengeOrder[stepNum - 2].id}.md`\n-        )\n-      : {};\n+  const previousChallenge =\n+    stepNum > 1 ? getChallenge(challengeOrder[stepNum - 2].id) : null;\n+  const nextChallenge =\n+    stepNum <= challengeOrder.length\n+      ? getChallenge(challengeOrder[stepNum - 1].id)\n+      : null;\n+\n+  const challengeSeeds = previousChallenge?.challengeFiles ?? [];\n+  const challengeType =\n+    previousChallenge?.challengeType ?? nextChallenge?.challengeType;\n \n   const stepId = createStepFile({\n     stepNum,\n+    challengeType,\n     challengeSeeds\n   });\n "
        },
        {
            "sha": "3380fb83380d1de31509b6e9a4eedca1da582c2d",
            "filename": "tools/challenge-helper-scripts/create-project.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Fcreate-project.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Fcreate-project.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fcreate-project.ts?ref=054d2448faa24c7b21e2f918c442700b83c1d296",
            "patch": "@@ -205,13 +205,13 @@ async function createFirstChallenge(block: string): Promise<ObjectID> {\n \n   // TODO: would be nice if the extension made sense for the challenge, but, at\n   // least until react I think they're all going to be html anyway.\n-  const challengeSeeds = {\n-    indexhtml: {\n+  const challengeSeeds = [\n+    {\n       contents: '',\n       ext: 'html',\n       editableRegionBoundaries: [0, 2]\n     }\n-  };\n+  ];\n   // including trailing slash for compatibility with createStepFile\n   return createStepFile({\n     projectPath: newChallengeDir + '/',"
        },
        {
            "sha": "686faadb0a409488d8bcc6927b3eced27ac62653",
            "filename": "tools/challenge-helper-scripts/helpers/get-step-template.test.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.test.ts?ref=054d2448faa24c7b21e2f918c442700b83c1d296",
            "patch": "@@ -37,8 +37,8 @@ Test 1\n \n     const props = {\n       challengeId: new ObjectID('60d4ebe4801158d1abe1b18f'),\n-      challengeSeeds: {\n-        indexhtml: {\n+      challengeSeeds: [\n+        {\n           contents: '',\n           editableRegionBoundaries: [0, 2],\n           ext: 'html',\n@@ -48,7 +48,7 @@ Test 1\n           name: 'index',\n           tail: ''\n         }\n-      },\n+      ],\n       stepNum: 5,\n       challengeType: 0\n     };"
        },
        {
            "sha": "4c5bf94d65c65d9432d6abca42b5cb791c9063e2",
            "filename": "tools/challenge-helper-scripts/helpers/get-step-template.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fget-step-template.ts?ref=054d2448faa24c7b21e2f918c442700b83c1d296",
            "patch": "@@ -22,7 +22,7 @@ ${content}`\n \n type StepOptions = {\n   challengeId: ObjectID;\n-  challengeSeeds: Record<string, ChallengeSeed>;\n+  challengeSeeds: ChallengeSeed[];\n   stepNum: number;\n   challengeType?: number;\n   isFirstChallenge?: boolean;\n@@ -44,8 +44,8 @@ function getStepTemplate({\n   challengeType,\n   isFirstChallenge = false\n }: StepOptions): string {\n-  const seedTexts = Object.values(challengeSeeds)\n-    .map(({ contents, ext, editableRegionBoundaries }: ChallengeSeed) => {\n+  const seedTexts = challengeSeeds\n+    .map(({ contents, ext, editableRegionBoundaries }) => {\n       let fullContents = contents;\n       if (editableRegionBoundaries.length >= 2) {\n         fullContents = insertErms(contents, editableRegionBoundaries);\n@@ -54,14 +54,14 @@ function getStepTemplate({\n     })\n     .join('\\n');\n \n-  const seedHeads = Object.values(challengeSeeds)\n-    .filter(({ head }: ChallengeSeed) => head)\n-    .map(({ ext, head }: ChallengeSeed) => getCodeBlock(ext, head))\n+  const seedHeads = challengeSeeds\n+    .filter(({ head }) => head)\n+    .map(({ ext, head }) => getCodeBlock(ext, head))\n     .join('\\n');\n \n-  const seedTails = Object.values(challengeSeeds)\n-    .filter(({ tail }: ChallengeSeed) => tail)\n-    .map(({ ext, tail }: ChallengeSeed) => getCodeBlock(ext, tail))\n+  const seedTails = challengeSeeds\n+    .filter(({ tail }) => tail)\n+    .map(({ ext, tail }) => getCodeBlock(ext, tail))\n     .join('\\n');\n \n   const stepDescription = `step ${stepNum} instructions`;"
        },
        {
            "sha": "f761ae9e07283b4833a4ea1ed2d8566faee54ff7",
            "filename": "tools/challenge-helper-scripts/utils.ts",
            "status": "modified",
            "additions": 12,
            "deletions": 8,
            "changes": 20,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Futils.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/054d2448faa24c7b21e2f918c442700b83c1d296/tools%2Fchallenge-helper-scripts%2Futils.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Futils.ts?ref=054d2448faa24c7b21e2f918c442700b83c1d296",
            "patch": "@@ -17,7 +17,7 @@ interface Options {\n   stepNum: number;\n   challengeType?: number;\n   projectPath?: string;\n-  challengeSeeds?: Record<string, ChallengeSeed>;\n+  challengeSeeds?: ChallengeSeed[];\n   isFirstChallenge?: boolean;\n }\n \n@@ -32,7 +32,7 @@ const createStepFile = ({\n   stepNum,\n   challengeType,\n   projectPath = getProjectPath(),\n-  challengeSeeds = {},\n+  challengeSeeds = [],\n   isFirstChallenge = false\n }: Options): ObjectID => {\n   const challengeId = new ObjectID();\n@@ -248,11 +248,15 @@ const updateTaskMarkdownFiles = (): void => {\n   });\n };\n \n-const getChallengeSeeds = (\n-  challengeFilePath: string\n-): Record<string, ChallengeSeed> => {\n-  // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-member-access\n-  return parseMDSync(challengeFilePath).challengeFiles;\n+type Challenge = {\n+  challengeType: number;\n+  challengeFiles: ChallengeSeed[];\n+};\n+\n+const getChallenge = (challengeId: string): Challenge => {\n+  const challengePath = path.join(getProjectPath(), `${challengeId}.md`);\n+  const challenge = parseMDSync(challengePath) as Challenge;\n+  return challenge;\n };\n \n const validateBlockName = (block: string): boolean | string => {\n@@ -272,7 +276,7 @@ export {\n   updateStepTitles,\n   updateTaskMeta,\n   updateTaskMarkdownFiles,\n-  getChallengeSeeds,\n+  getChallenge,\n   insertChallengeIntoMeta,\n   insertStepIntoMeta,\n   deleteChallengeFromMeta,"
        }
    ],
    "stats": {
        "total": 69,
        "additions": 39,
        "deletions": 30
    }
}