{
    "author": "ojeytonwilliams",
    "message": "fix: resize xterm with container (#58731)\n\nCo-authored-by: Mrugesh Mohapatra <1884376+raisedadead@users.noreply.github.com>\nCo-authored-by: Huyen Nguyen <25715018+huyenltnguyen@users.noreply.github.com>",
    "sha": "0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f",
    "files": [
        {
            "sha": "306ee4be4f7ed7c885b8c12d43dc2a2f0f8fb86c",
            "filename": "client/src/templates/Challenges/classic/desktop-layout.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Fdesktop-layout.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Fdesktop-layout.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Fdesktop-layout.tsx?ref=0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f",
            "patch": "@@ -355,7 +355,9 @@ const DesktopLayout = (props: DesktopLayoutProps): JSX.Element => {\n             data-playwright-test-label='preview-pane'\n           >\n             <ReflexContainer orientation='horizontal'>\n-              {displayPreviewPane && <ReflexElement>{preview}</ReflexElement>}\n+              {displayPreviewPane && (\n+                <ReflexElement {...reflexProps}>{preview}</ReflexElement>\n+              )}\n               {displayPreviewPane && displayPreviewConsole && (\n                 <ReflexSplitter propagate={true} {...resizeProps} />\n               )}"
        },
        {
            "sha": "5c71f40b7aa2fe2e2bd2fe9b0643ce69925c7395",
            "filename": "client/src/templates/Challenges/classic/show.tsx",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Fshow.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Fshow.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Fshow.tsx?ref=0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f",
            "patch": "@@ -158,17 +158,19 @@ const handleContentWidgetEvents = (e: MouseEvent | TouchEvent): void => {\n };\n \n const StepPreview = ({\n+  dimensions,\n   disableIframe,\n   previewMounted,\n   challengeType,\n   xtermFitRef\n }: Pick<PreviewProps, 'disableIframe' | 'previewMounted'> & {\n   challengeType: number;\n   xtermFitRef: React.MutableRefObject<FitAddon | null>;\n+  dimensions?: { width: number; height: number };\n }) => {\n   return challengeType === challengeTypes.python ||\n     challengeType === challengeTypes.multifilePythonCertProject ? (\n-    <XtermTerminal xtermFitRef={xtermFitRef} />\n+    <XtermTerminal dimensions={dimensions} xtermFitRef={xtermFitRef} />\n   ) : (\n     <Preview disableIframe={disableIframe} previewMounted={previewMounted} />\n   );"
        },
        {
            "sha": "da988c72a65b1368e884b443e9ac84a191dd6fc2",
            "filename": "client/src/templates/Challenges/classic/xterm.tsx",
            "status": "modified",
            "additions": 12,
            "deletions": 2,
            "changes": 14,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Fxterm.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Fxterm.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fclassic%2Fxterm.tsx?ref=0d1d9ee47995e72b19e8f0aa2f16aa992e1df00f",
            "patch": "@@ -16,9 +16,11 @@ const registerServiceWorker = async () => {\n };\n \n export const XtermTerminal = ({\n-  xtermFitRef\n+  xtermFitRef,\n+  dimensions\n }: {\n   xtermFitRef: MutableRefObject<FitAddon | null>;\n+  dimensions?: { height: number; width: number };\n }) => {\n   const termContainerRef = useRef<HTMLDivElement | null>(null);\n \n@@ -103,8 +105,16 @@ export const XtermTerminal = ({\n     };\n   }, [xtermFitRef]);\n \n+  useEffect(() => {\n+    if (xtermFitRef.current) xtermFitRef.current.fit();\n+\n+    // dimensions is an implicit dependency, since it's not directly used by the\n+    // effect, but fitAddon.fit() needs to be called whenever the container size\n+    // changes.\n+  }, [xtermFitRef, dimensions]);\n+\n   return (\n-    <div ref={termContainerRef}>\n+    <div style={{ height: dimensions?.height }} ref={termContainerRef}>\n       <link rel='stylesheet' href='/js/xterm.css' />\n     </div>\n   );"
        }
    ],
    "stats": {
        "total": 22,
        "additions": 18,
        "deletions": 4
    }
}