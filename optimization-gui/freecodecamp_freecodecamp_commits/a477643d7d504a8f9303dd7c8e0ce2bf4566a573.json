{
    "author": "ShaunSHamilton",
    "message": "chore(api): add log level configuration",
    "sha": "a477643d7d504a8f9303dd7c8e0ce2bf4566a573",
    "files": [
        {
            "sha": "30ef89dd842c8ecbee862e7a4486db6416aa59a7",
            "filename": "api/src/server.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 4,
            "changes": 12,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/a477643d7d504a8f9303dd7c8e0ce2bf4566a573/api%2Fsrc%2Fserver.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/a477643d7d504a8f9303dd7c8e0ce2bf4566a573/api%2Fsrc%2Fserver.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fserver.ts?ref=a477643d7d504a8f9303dd7c8e0ce2bf4566a573",
            "patch": "@@ -4,7 +4,12 @@\n // eslint-disable-next-line @typescript-eslint/triple-slash-reference\n /// <reference path=\"./reset.d.ts\" />\n import { build } from './app';\n-import { FREECODECAMP_NODE_ENV, HOST, PORT } from './utils/env';\n+import {\n+  FREECODECAMP_NODE_ENV,\n+  FCC_API_LOG_LEVEL,\n+  HOST,\n+  PORT\n+} from './utils/env';\n \n const envToLogger = {\n   development: {\n@@ -15,10 +20,9 @@ const envToLogger = {\n         ignore: 'pid,hostname'\n       }\n     },\n-    level: 'debug'\n+    level: FCC_API_LOG_LEVEL\n   },\n-  // TODO: is this the right level for production or should we use 'error'?\n-  production: { level: 'fatal' },\n+  production: { level: FCC_API_LOG_LEVEL },\n   test: undefined\n };\n "
        },
        {
            "sha": "99ed813f053317207ca7677cf6c075b3f8f2d303",
            "filename": "api/src/utils/env.ts",
            "status": "modified",
            "additions": 21,
            "deletions": 0,
            "changes": 21,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/a477643d7d504a8f9303dd7c8e0ce2bf4566a573/api%2Fsrc%2Futils%2Fenv.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/a477643d7d504a8f9303dd7c8e0ce2bf4566a573/api%2Fsrc%2Futils%2Fenv.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Futils%2Fenv.ts?ref=a477643d7d504a8f9303dd7c8e0ce2bf4566a573",
            "patch": "@@ -1,6 +1,7 @@\n import assert from 'node:assert';\n import path from 'node:path';\n import { config } from 'dotenv';\n+import { LogLevel } from 'fastify';\n \n const envPath = path.resolve(__dirname, '../../../.env');\n const { error } = config({ path: envPath });\n@@ -57,6 +58,25 @@ assert.ok(process.env.SHOW_UPCOMING_CHANGES);\n assert.ok(process.env.MONGOHQ_URL);\n assert.ok(process.env.COOKIE_SECRET);\n \n+const LOG_LEVELS: LogLevel[] = [\n+  'fatal',\n+  'error',\n+  'warn',\n+  'info',\n+  'debug',\n+  'trace',\n+  'silent'\n+] as const;\n+\n+function assertLogLevel(level: unknown): level is LogLevel {\n+  return typeof level === 'string' && LOG_LEVELS.includes(level);\n+}\n+\n+assert.ok(\n+  assertLogLevel(process.env.FCC_API_LOG_LEVEL),\n+  `FCC_API_LOG_LEVEL must be one of ${LOG_LEVELS.join(',')}. Found ${process.env.FCC_API_LOG_LEVEL}`\n+);\n+\n if (process.env.FREECODECAMP_NODE_ENV !== 'development') {\n   assert.ok(process.env.SES_ID);\n   assert.ok(process.env.SES_SECRET);\n@@ -137,6 +157,7 @@ export const FCC_ENABLE_EXAM_ENVIRONMENT =\n   process.env.FCC_ENABLE_EXAM_ENVIRONMENT === 'true';\n export const FCC_ENABLE_SENTRY_ROUTES =\n   process.env.FCC_ENABLE_SENTRY_ROUTES === 'true';\n+export const FCC_API_LOG_LEVEL = process.env.FCC_API_LOG_LEVEL;\n export const SENTRY_DSN =\n   process.env.SENTRY_DSN === 'dsn_from_sentry_dashboard'\n     ? ''"
        },
        {
            "sha": "0a80a69f83c5dfe04dfc9ac2221ae20e337d013d",
            "filename": "sample.env",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/a477643d7d504a8f9303dd7c8e0ce2bf4566a573/sample.env",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/a477643d7d504a8f9303dd7c8e0ce2bf4566a573/sample.env",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/sample.env?ref=a477643d7d504a8f9303dd7c8e0ce2bf4566a573",
            "patch": "@@ -71,6 +71,7 @@ FCC_ENABLE_DEV_LOGIN_MODE=true\n FCC_ENABLE_SHADOW_CAPTURE=false\n FCC_ENABLE_EXAM_ENVIRONMENT=false\n FCC_ENABLE_SENTRY_ROUTES=false\n+FCC_API_LOG_LEVEL=debug\n \n # Email\n # use ses in production"
        }
    ],
    "stats": {
        "total": 34,
        "additions": 30,
        "deletions": 4
    }
}