{
    "author": "ojeytonwilliams",
    "message": "fix: allow api to find tests for all certifications (#64295)",
    "sha": "c5f47956416c7bf62c30b0c63f4d06258b92f2a6",
    "files": [
        {
            "sha": "14610599b5349c490c39111d71868ea9bdc531f1",
            "filename": "api/src/routes/protected/certificate.ts",
            "status": "modified",
            "additions": 92,
            "deletions": 56,
            "changes": 148,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/api%2Fsrc%2Froutes%2Fprotected%2Fcertificate.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/api%2Fsrc%2Froutes%2Fprotected%2Fcertificate.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Froutes%2Fprotected%2Fcertificate.ts?ref=c5f47956416c7bf62c30b0c63f4d06258b92f2a6",
            "patch": "@@ -5,9 +5,9 @@ import type { FastifyPluginCallbackTypebox } from '@fastify/type-provider-typebo\n import { getChallenges } from '../../utils/get-challenges.js';\n import {\n   certIds,\n+  Certification,\n   certSlugTypeMap,\n   certToTitleMap,\n-  certTypes,\n   currentCertifications,\n   legacyCertifications,\n   legacyFullStackCertification,\n@@ -20,31 +20,6 @@ import { normalizeChallenges, removeNulls } from '../../utils/normalize.js';\n import { SHOW_UPCOMING_CHANGES } from '../../utils/env.js';\n import { isKnownCertSlug } from '../helpers/certificate-utils.js';\n \n-const {\n-  a2EnglishId,\n-  legacyFrontEndChallengeId,\n-  legacyBackEndChallengeId,\n-  legacyDataVisId,\n-  legacyInfosecQaId,\n-  legacyFullStackId,\n-  respWebDesignId,\n-  frontEndDevLibsId,\n-  javascriptV9Id,\n-  jsAlgoDataStructId,\n-  jsAlgoDataStructV8Id,\n-  dataVis2018Id,\n-  apisMicroservicesId,\n-  qaV7Id,\n-  infosecV7Id,\n-  sciCompPyV7Id,\n-  dataAnalysisPyV7Id,\n-  machineLearningPyV7Id,\n-  relationalDatabaseV8Id,\n-  respWebDesignV9Id,\n-  collegeAlgebraPyV8Id,\n-  foundationalCSharpV8Id\n-} = certIds;\n-\n function isCertAllowed(certSlug: string): boolean {\n   if (\n     currentCertifications.includes(certSlug) ||\n@@ -121,50 +96,111 @@ function getCertById(\n   return { id, tests, challengeType };\n }\n \n-function createCertTypeIds(challenges: ReturnType<typeof getChallenges>) {\n+function createCertLookup(\n+  challenges: ReturnType<typeof getChallenges>\n+): Record<\n+  Certification,\n+  { id: string; tests: { id: string }[]; challengeType: number }\n+> {\n   return {\n     // legacy\n-    [certTypes.frontEnd]: getCertById(legacyFrontEndChallengeId, challenges),\n-    [certTypes.jsAlgoDataStruct]: getCertById(jsAlgoDataStructId, challenges),\n-    [certTypes.backEnd]: getCertById(legacyBackEndChallengeId, challenges),\n-    [certTypes.dataVis]: getCertById(legacyDataVisId, challenges),\n-    [certTypes.infosecQa]: getCertById(legacyInfosecQaId, challenges),\n-    [certTypes.fullStack]: getCertById(legacyFullStackId, challenges),\n+    [Certification.LegacyFrontEnd]: getCertById(\n+      certIds.legacyFrontEndChallengeId,\n+      challenges\n+    ),\n+    [Certification.JsAlgoDataStruct]: getCertById(\n+      certIds.jsAlgoDataStructId,\n+      challenges\n+    ),\n+\n+    [Certification.LegacyBackEnd]: getCertById(\n+      certIds.legacyBackEndChallengeId,\n+      challenges\n+    ),\n+    [Certification.LegacyDataVis]: getCertById(\n+      certIds.legacyDataVisId,\n+      challenges\n+    ),\n+    [Certification.LegacyInfoSecQa]: getCertById(\n+      certIds.legacyInfosecQaId,\n+      challenges\n+    ),\n+    [Certification.LegacyFullStack]: getCertById(\n+      certIds.legacyFullStackId,\n+      challenges\n+    ),\n \n     // modern\n-    [certTypes.respWebDesign]: getCertById(respWebDesignId, challenges),\n-    [certTypes.frontEndDevLibs]: getCertById(frontEndDevLibsId, challenges),\n-    [certTypes.dataVis2018]: getCertById(dataVis2018Id, challenges),\n-    [certTypes.jsAlgoDataStructV8]: getCertById(\n-      jsAlgoDataStructV8Id,\n+    [Certification.RespWebDesign]: getCertById(\n+      certIds.respWebDesignId,\n+      challenges\n+    ),\n+    [Certification.FrontEndDevLibs]: getCertById(\n+      certIds.frontEndDevLibsId,\n       challenges\n     ),\n-    [certTypes.apisMicroservices]: getCertById(apisMicroservicesId, challenges),\n-    [certTypes.qaV7]: getCertById(qaV7Id, challenges),\n-    [certTypes.infosecV7]: getCertById(infosecV7Id, challenges),\n-    [certTypes.sciCompPyV7]: getCertById(sciCompPyV7Id, challenges),\n-    [certTypes.dataAnalysisPyV7]: getCertById(dataAnalysisPyV7Id, challenges),\n-    [certTypes.machineLearningPyV7]: getCertById(\n-      machineLearningPyV7Id,\n+    [Certification.DataVis]: getCertById(certIds.dataVis2018Id, challenges),\n+    [Certification.JsAlgoDataStructNew]: getCertById(\n+      certIds.jsAlgoDataStructV8Id,\n       challenges\n     ),\n-    [certTypes.relationalDatabaseV8]: getCertById(\n-      relationalDatabaseV8Id,\n+    [Certification.BackEndDevApis]: getCertById(\n+      certIds.apisMicroservicesId,\n       challenges\n     ),\n-    [certTypes.collegeAlgebraPyV8]: getCertById(\n-      collegeAlgebraPyV8Id,\n+    [Certification.QualityAssurance]: getCertById(certIds.qaV7Id, challenges),\n+    [Certification.InfoSec]: getCertById(certIds.infosecV7Id, challenges),\n+    [Certification.SciCompPy]: getCertById(certIds.sciCompPyV7Id, challenges),\n+    [Certification.DataAnalysisPy]: getCertById(\n+      certIds.dataAnalysisPyV7Id,\n       challenges\n     ),\n-    [certTypes.foundationalCSharpV8]: getCertById(\n-      foundationalCSharpV8Id,\n+    [Certification.MachineLearningPy]: getCertById(\n+      certIds.machineLearningPyV7Id,\n       challenges\n     ),\n-    [certTypes.javascriptV9]: getCertById(javascriptV9Id, challenges),\n-    [certTypes.respWebDesignV9]: getCertById(respWebDesignV9Id, challenges),\n+    [Certification.RelationalDb]: getCertById(\n+      certIds.relationalDatabaseV8Id,\n+      challenges\n+    ),\n+    [Certification.CollegeAlgebraPy]: getCertById(\n+      certIds.collegeAlgebraPyV8Id,\n+      challenges\n+    ),\n+    [Certification.FoundationalCSharp]: getCertById(\n+      certIds.foundationalCSharpV8Id,\n+      challenges\n+    ),\n+\n+    [Certification.JsV9]: getCertById(certIds.javascriptV9Id, challenges),\n+    [Certification.RespWebDesignV9]: getCertById(\n+      certIds.respWebDesignV9Id,\n+      challenges\n+    ),\n+    [Certification.A2English]: getCertById(certIds.a2EnglishId, challenges),\n \n     // upcoming\n-    [certTypes.a2English]: getCertById(a2EnglishId, challenges)\n+    [Certification.FrontEndDevLibsV9]: getCertById(\n+      certIds.frontEndLibsV9Id,\n+      challenges\n+    ),\n+    [Certification.PythonV9]: getCertById(certIds.pythonV9Id, challenges),\n+    [Certification.RelationalDbV9]: getCertById(\n+      certIds.relationalDbV9Id,\n+      challenges\n+    ),\n+    [Certification.BackEndDevApisV9]: getCertById(\n+      certIds.backEndDevApisV9Id,\n+      challenges\n+    ),\n+    [Certification.FullStackDeveloperV9]: getCertById(\n+      certIds.fullStackDeveloperV9Id,\n+      challenges\n+    ),\n+    [Certification.B1English]: getCertById(certIds.b1EnglishId, challenges),\n+    [Certification.A2Spanish]: getCertById(certIds.a2SpanishId, challenges),\n+    [Certification.A1Chinese]: getCertById(certIds.a1ChineseId, challenges),\n+    [Certification.A2Chinese]: getCertById(certIds.a2ChineseId, challenges)\n   };\n }\n \n@@ -258,7 +294,7 @@ export const protectedCertificateRoutes: FastifyPluginCallbackTypebox = (\n   done\n ) => {\n   const challenges = getChallenges();\n-  const certTypeIds = createCertTypeIds(challenges);\n+  const certLookup = createCertLookup(challenges);\n \n   // TODO(POST_MVP): Response should not include updated user. If a client wants the updated user, it should make a separate request\n   // OR: Always respond with current user - full user object - not random pieces.\n@@ -347,7 +383,7 @@ export const protectedCertificateRoutes: FastifyPluginCallbackTypebox = (\n         } as const;\n       }\n \n-      const { id, tests, challengeType } = certTypeIds[certType];\n+      const { id, tests, challengeType } = certLookup[certSlug];\n       const hasCompletedTestRequirements = hasCompletedTests(\n         tests,\n         user.completedChallenges"
        },
        {
            "sha": "18e2cfcb69d6b816f5b636016518ea594e0e6a73",
            "filename": "curriculum/challenges/english/certifications/a1-professional-chinese.yml",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fa1-professional-chinese.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fa1-professional-chinese.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fa1-professional-chinese.yml?ref=c5f47956416c7bf62c30b0c63f4d06258b92f2a6",
            "patch": "@@ -1,8 +1,8 @@\n ---\n id: 68f1268149f045a650d4229e\n title: A1 Professional Chinese Certification\n-certification: a1-professional-chinese-certification\n+certification: a1-professional-chinese-v8\n challengeType: 7\n tests:\n   - id: 688f1daf0133dbe2a36b140b\n-    title: \"Dialogue 1: PLACEHOLDER\"\n+    title: 'Dialogue 1: PLACEHOLDER'"
        },
        {
            "sha": "6c99a86a9711a11b3a9e813f3854acfbc593902c",
            "filename": "curriculum/challenges/english/certifications/a2-professional-chinese.yml",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fa2-professional-chinese.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fa2-professional-chinese.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fa2-professional-chinese.yml?ref=c5f47956416c7bf62c30b0c63f4d06258b92f2a6",
            "patch": "@@ -1,8 +1,8 @@\n ---\n id: 682c3153086dd7cabe7f48bc\n title: A2 Professional Chinese Certification\n-certification: a2-professional-chinese-certification\n+certification: a2-professional-chinese-v8\n challengeType: 7\n tests:\n   - id: 682c2753317b88f1ecdad894\n-    title: \"Dialogue 1: PLACEHOLDER\"\n+    title: 'Dialogue 1: PLACEHOLDER'"
        },
        {
            "sha": "60d88b7baaf55991d69e20af5b547dd46264f041",
            "filename": "curriculum/challenges/english/certifications/a2-professional-spanish.yml",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fa2-professional-spanish.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fa2-professional-spanish.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fa2-professional-spanish.yml?ref=c5f47956416c7bf62c30b0c63f4d06258b92f2a6",
            "patch": "@@ -1,8 +1,8 @@\n ---\n id: 681a6b22e5a782fe3459984a\n title: A2 Professional Spanish Certification\n-certification: a2-professional-spanish-certification\n+certification: a2-professional-spanish-v8\n challengeType: 7\n tests:\n   - id: 681a8796e5a782fe3459984b\n-    title: \"Dialogue 1: PLACEHOLDER\"\n+    title: 'Dialogue 1: PLACEHOLDER'"
        },
        {
            "sha": "ac8ae334788bfc0f7136d2b203333c39c288d8ff",
            "filename": "curriculum/challenges/english/certifications/b1-english-for-developers.yml",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fb1-english-for-developers.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fb1-english-for-developers.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fchallenges%2Fenglish%2Fcertifications%2Fb1-english-for-developers.yml?ref=c5f47956416c7bf62c30b0c63f4d06258b92f2a6",
            "patch": "@@ -1,7 +1,7 @@\n ---\n id: 66607e53317411dd5e8aae21\n title: B1 English for Developers Certification\n-certification: b1-english-for-developers\n+certification: b1-english-for-developers-v8\n challengeType: 7\n tests:\n   - id: 66607e5b317411dd5e8aae22"
        },
        {
            "sha": "f1dd690d79c1eaa1d875baf8e14b071abf30718a",
            "filename": "shared/config/certification-settings.test.ts",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/shared%2Fconfig%2Fcertification-settings.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/shared%2Fconfig%2Fcertification-settings.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/shared%2Fconfig%2Fcertification-settings.test.ts?ref=c5f47956416c7bf62c30b0c63f4d06258b92f2a6",
            "patch": "@@ -2,7 +2,8 @@ import { describe, it, expect } from 'vitest';\n import {\n   Certification,\n   linkedInCredentialIds,\n-  certToTitleMap\n+  certToTitleMap,\n+  certIds\n } from './certification-settings';\n \n describe('linkedInCredentialIds', () => {\n@@ -22,3 +23,12 @@ describe('certToTitleMap', () => {\n     expect(titles.length).toBe(uniqueTitles.length);\n   });\n });\n+\n+describe('certIds', () => {\n+  it('should have no duplicate values', () => {\n+    const ids = Object.values(certIds).sort();\n+    const uniqueIds = Array.from(new Set(ids)).sort();\n+\n+    expect(uniqueIds).toEqual(ids);\n+  });\n+});"
        },
        {
            "sha": "5c611f2c7a7dde883e13d654601927698bb14e67",
            "filename": "shared/config/certification-settings.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/shared%2Fconfig%2Fcertification-settings.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c5f47956416c7bf62c30b0c63f4d06258b92f2a6/shared%2Fconfig%2Fcertification-settings.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/shared%2Fconfig%2Fcertification-settings.ts?ref=c5f47956416c7bf62c30b0c63f4d06258b92f2a6",
            "patch": "@@ -154,7 +154,11 @@ export const certIds = {\n   relationalDbV9Id: '68e6bd5120effa1586e79856',\n   backEndDevApisV9Id: '68e6bd5120effa1586e79857',\n   fullStackDeveloperV9Id: '64514fda6c245de4d11eb7bb',\n-  a2EnglishId: '651dd7e01d697d0aab7833b7'\n+  a2EnglishId: '651dd7e01d697d0aab7833b7',\n+  b1EnglishId: '66607e53317411dd5e8aae21',\n+  a2SpanishId: '681a6b22e5a782fe3459984a',\n+  a1ChineseId: '68f1268149f045a650d4229e',\n+  a2ChineseId: '682c3153086dd7cabe7f48bc'\n };\n \n export const completionHours = {"
        }
    ],
    "stats": {
        "total": 180,
        "additions": 115,
        "deletions": 65
    }
}