{
    "author": "Sembauke",
    "message": "refactor(client): internet presence to functional component (#58604)",
    "sha": "0972a69bd0fc1bf09f1a910542f5cb901425491b",
    "files": [
        {
            "sha": "322b8776f55fbb92331db6c98d7f3073574a7c56",
            "filename": "client/src/components/profile/components/internet.tsx",
            "status": "modified",
            "additions": 174,
            "deletions": 214,
            "changes": 388,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0972a69bd0fc1bf09f1a910542f5cb901425491b/client%2Fsrc%2Fcomponents%2Fprofile%2Fcomponents%2Finternet.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0972a69bd0fc1bf09f1a910542f5cb901425491b/client%2Fsrc%2Fcomponents%2Fprofile%2Fcomponents%2Finternet.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2Fprofile%2Fcomponents%2Finternet.tsx?ref=0972a69bd0fc1bf09f1a910542f5cb901425491b",
            "patch": "@@ -1,6 +1,6 @@\n import { faCheck } from '@fortawesome/free-solid-svg-icons';\n import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n-import React, { Component } from 'react';\n+import React, { useState } from 'react';\n import type { TFunction } from 'i18next';\n import { withTranslation } from 'react-i18next';\n import isURL from 'validator/lib/isURL';\n@@ -31,11 +31,6 @@ interface InternetProps extends Socials {\n   setIsEditing: (isEditing: boolean) => void;\n }\n \n-type InternetState = {\n-  formValues: Socials;\n-  originalValues: Socials;\n-};\n-\n interface URLValidation {\n   state: FormGroupProps['validationState'];\n   message: string;\n@@ -45,52 +40,23 @@ function Info({ message }: { message: string }) {\n   return message ? <HelpBlock>{message}</HelpBlock> : null;\n }\n \n-class InternetSettings extends Component<InternetProps, InternetState> {\n-  static displayName: string;\n-  constructor(props: InternetProps) {\n-    super(props);\n-    const {\n-      githubProfile = '',\n-      linkedin = '',\n-      twitter = '',\n-      website = ''\n-    } = props;\n-\n-    this.state = {\n-      formValues: { githubProfile, linkedin, twitter, website },\n-      originalValues: { githubProfile, linkedin, twitter, website }\n-    };\n-  }\n-\n-  toggleEditing = () => {\n-    this.props.setIsEditing(false);\n-  };\n-\n-  componentDidUpdate() {\n-    const {\n-      githubProfile = '',\n-      linkedin = '',\n-      twitter = '',\n-      website = ''\n-    } = this.props;\n+const InternetSettings = ({\n+  githubProfile = '',\n+  linkedin = '',\n+  twitter = '',\n+  website = '',\n+  t,\n+  updateSocials,\n+  setIsEditing\n+}: InternetProps) => {\n+  const [formValues, setFormValues] = useState<Socials>({\n+    githubProfile,\n+    linkedin,\n+    twitter,\n+    website\n+  });\n \n-    const { originalValues } = this.state;\n-\n-    if (\n-      githubProfile !== originalValues.githubProfile ||\n-      linkedin !== originalValues.linkedin ||\n-      twitter !== originalValues.twitter ||\n-      website !== originalValues.website\n-    ) {\n-      return this.setState({\n-        originalValues: { githubProfile, linkedin, twitter, website }\n-      });\n-    }\n-    return null;\n-  }\n-\n-  getValidationStateFor(maybeURl = ''): URLValidation {\n-    const { t } = this.props;\n+  const getValidationStateFor = (maybeURl = ''): URLValidation => {\n     if (!maybeURl || !maybeUrlRE.test(maybeURl)) {\n       return {\n         state: null,\n@@ -107,192 +73,186 @@ class InternetSettings extends Component<InternetProps, InternetState> {\n       state: 'error',\n       message: t('validation.invalid-url')\n     };\n-  }\n+  };\n \n-  createHandleChange =\n+  const createHandleChange =\n     (key: keyof Socials) => (e: React.FormEvent<HTMLInputElement>) => {\n       const value = (e.target as HTMLInputElement).value.slice(0);\n-      return this.setState(state => ({\n-        formValues: {\n-          ...state.formValues,\n-          [key]: value\n-        }\n-      }));\n+      setFormValues({\n+        ...formValues,\n+        [key]: value\n+      });\n     };\n \n-  isFormPristine = () => {\n-    const { formValues, originalValues } = this.state;\n+  const isFormPristine = () => {\n+    const originalValues = { githubProfile, linkedin, twitter, website };\n+\n     return (Object.keys(originalValues) as Array<keyof Socials>).every(\n       key => originalValues[key] === formValues[key]\n     );\n   };\n \n-  isFormValid = (): boolean =>\n-    Object.values(this.state.formValues).every(\n+  const isFormValid = (): boolean =>\n+    Object.values(formValues).every(\n       (value: string) => value === '' || isURL(value)\n     );\n \n-  handleSubmit = (e: React.FormEvent) => {\n+  const handleSubmit = (e: React.FormEvent) => {\n     e.preventDefault();\n-    if (!this.isFormPristine() && this.isFormValid()) {\n-      // // Only submit the form if is has changed, and if it is valid\n-      const { formValues } = this.state;\n-\n-      const { updateSocials } = this.props;\n-      this.toggleEditing();\n-      return updateSocials({ ...formValues });\n+    if (!isFormPristine() && isFormValid()) {\n+      // Only submit the form if is has changed, and if it is valid\n+      updateSocials({ ...formValues });\n     }\n-    this.toggleEditing();\n-    return null;\n+    setIsEditing(false);\n   };\n \n-  renderCheck = (\n-    url: string,\n-    validation: FormGroupProps['validationState'],\n-    dataPlaywrightTestLabel: string\n-  ) =>\n-    url && validation === 'success' ? (\n-      <FormControl.Feedback>\n-        <span>\n-          <FontAwesomeIcon\n-            data-playwright-test-label={dataPlaywrightTestLabel}\n-            icon={faCheck}\n-            size='1x'\n-          />\n-        </span>\n-      </FormControl.Feedback>\n-    ) : null;\n+  const {\n+    state: githubProfileValidation,\n+    message: githubProfileValidationMessage\n+  } = getValidationStateFor(formValues.githubProfile);\n+\n+  const { state: linkedinValidation, message: linkedinValidationMessage } =\n+    getValidationStateFor(formValues.linkedin);\n \n-  render() {\n-    const { t } = this.props;\n-    const {\n-      formValues: { githubProfile, linkedin, twitter, website }\n-    } = this.state;\n+  const { state: twitterValidation, message: twitterValidationMessage } =\n+    getValidationStateFor(formValues.twitter);\n \n-    const {\n-      state: githubProfileValidation,\n-      message: githubProfileValidationMessage\n-    } = this.getValidationStateFor(githubProfile);\n+  const { state: websiteValidation, message: websiteValidationMessage } =\n+    getValidationStateFor(formValues.website);\n+  const isDisabled = isFormPristine() || !isFormValid();\n \n-    const { state: linkedinValidation, message: linkedinValidationMessage } =\n-      this.getValidationStateFor(linkedin);\n+  return (\n+    <>\n+      <SectionHeader>{t('settings.headings.internet')}</SectionHeader>\n+      <FullWidthRow>\n+        <form\n+          id='internet-presence'\n+          onSubmit={handleSubmit}\n+          data-playwright-test-label='internet-presence'\n+        >\n+          <div role='group' aria-label={t('settings.headings.internet')}>\n+            <FormGroup\n+              controlId='internet-github'\n+              validationState={githubProfileValidation}\n+            >\n+              <ControlLabel htmlFor='internet-github-input'>\n+                GitHub\n+              </ControlLabel>\n+              <FormControl\n+                data-playwright-test-label='internet-github-input'\n+                onChange={createHandleChange('githubProfile')}\n+                placeholder='https://github.com/user-name'\n+                type='url'\n+                value={formValues.githubProfile}\n+                id='internet-github-input'\n+              />\n+              <Check\n+                url={formValues.githubProfile}\n+                validation={githubProfileValidation}\n+                dataPlaywrightTestLabel='internet-github-check'\n+              />\n+              <Info message={githubProfileValidationMessage} />\n+            </FormGroup>\n+            <FormGroup\n+              controlId='internet-linkedin'\n+              validationState={linkedinValidation}\n+            >\n+              <ControlLabel htmlFor='internet-linkedin-input'>\n+                LinkedIn\n+              </ControlLabel>\n+              <FormControl\n+                onChange={createHandleChange('linkedin')}\n+                placeholder='https://www.linkedin.com/in/user-name'\n+                type='url'\n+                value={formValues.linkedin}\n+                id='internet-linkedin-input'\n+              />\n+              <Check\n+                url={formValues.linkedin}\n+                validation={linkedinValidation}\n+                dataPlaywrightTestLabel='internet-linkedin-check'\n+              />\n+              <Info message={linkedinValidationMessage} />\n+            </FormGroup>\n+            <FormGroup\n+              controlId='internet-twitter'\n+              validationState={twitterValidation}\n+            >\n+              <ControlLabel htmlFor='internet-twitter-input'>\n+                Twitter\n+              </ControlLabel>\n+              <FormControl\n+                onChange={createHandleChange('twitter')}\n+                placeholder='https://twitter.com/user-name'\n+                type='url'\n+                value={formValues.twitter}\n+                id='internet-twitter-input'\n+              />\n+              <Check\n+                url={formValues.twitter}\n+                validation={twitterValidation}\n+                dataPlaywrightTestLabel='internet-twitter-check'\n+              />\n+              <Info message={twitterValidationMessage} />\n+            </FormGroup>\n+            <FormGroup\n+              controlId='internet-website'\n+              validationState={websiteValidation}\n+            >\n+              <ControlLabel htmlFor='internet-website-input'>\n+                {t('settings.labels.personal')}\n+              </ControlLabel>\n+              <FormControl\n+                onChange={createHandleChange('website')}\n+                placeholder='https://example.com'\n+                type='url'\n+                value={formValues.website}\n+                id='internet-website-input'\n+              />\n \n-    const { state: twitterValidation, message: twitterValidationMessage } =\n-      this.getValidationStateFor(twitter);\n+              <Check\n+                url={formValues.website}\n+                validation={websiteValidation}\n+                dataPlaywrightTestLabel='internet-website-check'\n+              />\n \n-    const { state: websiteValidation, message: websiteValidationMessage } =\n-      this.getValidationStateFor(website);\n-    const isDisabled = this.isFormPristine() || !this.isFormValid();\n-    return (\n-      <>\n-        <SectionHeader>{t('settings.headings.internet')}</SectionHeader>\n-        <FullWidthRow>\n-          <form\n-            id='internet-presence'\n-            onSubmit={this.handleSubmit}\n-            data-playwright-test-label='internet-presence'\n+              <Info message={websiteValidationMessage} />\n+            </FormGroup>\n+          </div>\n+          <BlockSaveButton\n+            disabled={isDisabled}\n+            bgSize='large'\n+            {...(isDisabled && { tabIndex: -1 })}\n           >\n-            <div role='group' aria-label={t('settings.headings.internet')}>\n-              <FormGroup\n-                controlId='internet-github'\n-                validationState={githubProfileValidation}\n-              >\n-                <ControlLabel htmlFor='internet-github-input'>\n-                  GitHub\n-                </ControlLabel>\n-                <FormControl\n-                  data-playwright-test-label='internet-github-input'\n-                  onChange={this.createHandleChange('githubProfile')}\n-                  placeholder='https://github.com/user-name'\n-                  type='url'\n-                  value={githubProfile}\n-                  id='internet-github-input'\n-                />\n-                {this.renderCheck(\n-                  githubProfile,\n-                  githubProfileValidation,\n-                  'internet-github-check'\n-                )}\n-                <Info message={githubProfileValidationMessage} />\n-              </FormGroup>\n-              <FormGroup\n-                controlId='internet-linkedin'\n-                validationState={linkedinValidation}\n-              >\n-                <ControlLabel htmlFor='internet-linkedin-input'>\n-                  LinkedIn\n-                </ControlLabel>\n-                <FormControl\n-                  onChange={this.createHandleChange('linkedin')}\n-                  placeholder='https://www.linkedin.com/in/user-name'\n-                  type='url'\n-                  value={linkedin}\n-                  id='internet-linkedin-input'\n-                />\n-                {this.renderCheck(\n-                  linkedin,\n-                  linkedinValidation,\n-                  'internet-linkedin-check'\n-                )}\n-                <Info message={linkedinValidationMessage} />\n-              </FormGroup>\n-              <FormGroup\n-                controlId='internet-twitter'\n-                validationState={twitterValidation}\n-              >\n-                <ControlLabel htmlFor='internet-twitter-input'>\n-                  Twitter\n-                </ControlLabel>\n-                <FormControl\n-                  onChange={this.createHandleChange('twitter')}\n-                  placeholder='https://twitter.com/user-name'\n-                  type='url'\n-                  value={twitter}\n-                  id='internet-twitter-input'\n-                />\n-                {this.renderCheck(\n-                  twitter,\n-                  twitterValidation,\n-                  'internet-twitter-check'\n-                )}\n-                <Info message={twitterValidationMessage} />\n-              </FormGroup>\n-              <FormGroup\n-                controlId='internet-website'\n-                validationState={websiteValidation}\n-              >\n-                <ControlLabel htmlFor='internet-website-input'>\n-                  {t('settings.labels.personal')}\n-                </ControlLabel>\n-                <FormControl\n-                  onChange={this.createHandleChange('website')}\n-                  placeholder='https://example.com'\n-                  type='url'\n-                  value={website}\n-                  id='internet-website-input'\n-                />\n-                {this.renderCheck(\n-                  website,\n-                  websiteValidation,\n-                  'internet-website-check'\n-                )}\n-                <Info message={websiteValidationMessage} />\n-              </FormGroup>\n-            </div>\n-            <BlockSaveButton\n-              disabled={isDisabled}\n-              bgSize='large'\n-              {...(isDisabled && { tabIndex: -1 })}\n-            >\n-              {t('buttons.save')}{' '}\n-              <span className='sr-only'>{t('settings.headings.internet')}</span>\n-            </BlockSaveButton>\n-          </form>\n-        </FullWidthRow>\n-      </>\n-    );\n-  }\n-}\n+            {t('buttons.save')}{' '}\n+            <span className='sr-only'>{t('settings.headings.internet')}</span>\n+          </BlockSaveButton>\n+        </form>\n+      </FullWidthRow>\n+    </>\n+  );\n+};\n+\n+const Check = ({\n+  url,\n+  validation,\n+  dataPlaywrightTestLabel\n+}: {\n+  url: string;\n+  validation: URLValidation['state'];\n+  dataPlaywrightTestLabel: string;\n+}) =>\n+  url && validation === 'success' ? (\n+    <FormControl.Feedback>\n+      <span>\n+        <FontAwesomeIcon\n+          data-playwright-test-label={dataPlaywrightTestLabel}\n+          icon={faCheck}\n+          size='1x'\n+        />\n+      </span>\n+    </FormControl.Feedback>\n+  ) : null;\n \n InternetSettings.displayName = 'InternetSettings';\n "
        }
    ],
    "stats": {
        "total": 388,
        "additions": 174,
        "deletions": 214
    }
}