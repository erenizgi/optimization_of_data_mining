{
    "author": "huyenltnguyen",
    "message": "feat(client,challenge-parser): render Chinese as ruby markup (#63424)\n\nCo-authored-by: Oliver Eyton-Williams <ojeytonwilliams@gmail.com>",
    "sha": "0c844ab007ea91843b449b0219ea9703d1ba7b10",
    "files": [
        {
            "sha": "0fcd84f8166c31eb249d8b0fff92a07d8e219132",
            "filename": "client/src/components/layouts/global.css",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/client%2Fsrc%2Fcomponents%2Flayouts%2Fglobal.css",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/client%2Fsrc%2Fcomponents%2Flayouts%2Fglobal.css",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2Flayouts%2Fglobal.css?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -89,6 +89,10 @@ hr {\n   border-top: 1px solid var(--quaternary-background);\n }\n \n+rt {\n+  font-size: 0.8rem;\n+}\n+\n #___gatsby {\n   height: 100%;\n }"
        },
        {
            "sha": "beb0c4df2f129814618ae740aba735f8a601874f",
            "filename": "tools/challenge-parser/parser/__fixtures__/with-chinese-mcq.md",
            "status": "added",
            "additions": 52,
            "deletions": 0,
            "changes": 52,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2F__fixtures__%2Fwith-chinese-mcq.md",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2F__fixtures__%2Fwith-chinese-mcq.md",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2F__fixtures__%2Fwith-chinese-mcq.md?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -0,0 +1,52 @@\n+---\n+id: test-with-chinese-mcq\n+title: Ruby Test\n+challengeType: 19\n+lang: zh-CN\n+---\n+\n+# --instructions--\n+\n+Instructions containing `汉字 (hàn zì)`.\n+\n+# --questions--\n+\n+## --text--\n+\n+Question text containing `汉字 (hàn zì)`.\n+\n+## --answers--\n+\n+`你好 (nǐ hǎo)`\n+\n+### --feedback--\n+\n+Feedback text.\n+\n+---\n+\n+`请 (qǐng)`\n+\n+### --feedback--\n+\n+`请 (qǐng)` is not correct.\n+\n+---\n+\n+`请问 (qǐng wèn)`\n+\n+---\n+\n+`问 (wèn)`\n+\n+### --feedback--\n+\n+Feedback text.\n+\n+## --video-solution--\n+\n+3\n+\n+# --explanation--\n+\n+Wang Hua uses `请问 (qǐng wèn)` to politely start her question.\n\\ No newline at end of file"
        },
        {
            "sha": "3254c05ec3dcf98eabbb4d97871a6e145ddfbc7a",
            "filename": "tools/challenge-parser/parser/__fixtures__/with-chinese-quizzes.md",
            "status": "added",
            "additions": 69,
            "deletions": 0,
            "changes": 69,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2F__fixtures__%2Fwith-chinese-quizzes.md",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2F__fixtures__%2Fwith-chinese-quizzes.md",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2F__fixtures__%2Fwith-chinese-quizzes.md?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -0,0 +1,69 @@\n+# --quizzes--\n+\n+## --quiz--\n+\n+### --question--\n+\n+#### --text--\n+\n+Quiz 1, question 1 with `中文 (zhōng wén)`\n+\n+#### --distractors--\n+\n+Quiz 1, question 1, distractor 1 with `中文 (zhōng wén)`\n+\n+---\n+\n+Quiz 1, question 1, distractor 2 with `中文 (zhōng wén)`\n+\n+---\n+\n+Quiz 1, question 1, distractor 3 with `中文 (zhōng wén)`\n+\n+#### --answer--\n+\n+Quiz 1, question 1, answer with `中文 (zhōng wén)`\n+\n+### --question--\n+\n+#### --text--\n+\n+Quiz 1, question 2 with `中文`\n+\n+#### --distractors--\n+\n+Quiz 1, question 2, distractor 1 with `中文`\n+\n+---\n+\n+Quiz 1, question 2, distractor 2 with `中文`\n+\n+---\n+\n+Quiz 1, question 2, distractor 3 with `中文` \n+\n+#### --answer--\n+\n+Quiz 1, question 2, answer with `中文`\n+\n+### --question--\n+\n+#### --text--\n+\n+Quiz 1, question 3 with `zhōng wén`\n+\n+#### --distractors--\n+\n+Quiz 1, question 3, distractor 1 with `zhōng wén`\n+\n+---\n+\n+Quiz 1, question 3, distractor 2 with `zhōng wén`\n+\n+---\n+\n+Quiz 1, question 3, distractor 3 with `zhōng wén`\n+\n+#### --answer--\n+\n+Quiz 1, question 3, answer with `zhōng wén`"
        },
        {
            "sha": "90cce3174264f4d9ece0dbac4bc5b06afe2d3ffa",
            "filename": "tools/challenge-parser/parser/plugins/add-assignment.js",
            "status": "modified",
            "additions": 9,
            "deletions": 9,
            "changes": 18,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-assignment.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-assignment.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-assignment.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -1,23 +1,23 @@\n const { getSection } = require('./utils/get-section');\n \n-const mdastToHtml = require('./utils/mdast-to-html');\n+const { createMdastToHtml } = require('./utils/i18n-stringify');\n const { splitOnThematicBreak } = require('./utils/split-on-thematic-break');\n \n function plugin() {\n   return transformer;\n \n   function transformer(tree, file) {\n+    const toHtml = createMdastToHtml(file.data.lang);\n     const assignmentNodes = getSection(tree, '--assignment--');\n \n-    const assignment = getAssignments(assignmentNodes).filter(a => a != '');\n+    function getAssignments(assignmentNodes) {\n+      const assignmentGroups = splitOnThematicBreak(assignmentNodes);\n+      return assignmentGroups.map(assignment => toHtml(assignment));\n+    }\n \n-    file.data.assignments = assignment;\n-  }\n-\n-  function getAssignments(assignmentNodes) {\n-    const assignmentGroups = splitOnThematicBreak(assignmentNodes);\n-\n-    return assignmentGroups.map(assignment => mdastToHtml(assignment));\n+    file.data.assignments = getAssignments(assignmentNodes).filter(\n+      a => a != ''\n+    );\n   }\n }\n "
        },
        {
            "sha": "defca36581e41c2bd4ecf91590b7461e93efe4b0",
            "filename": "tools/challenge-parser/parser/plugins/add-quizzes.js",
            "status": "modified",
            "additions": 26,
            "deletions": 25,
            "changes": 51,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-quizzes.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-quizzes.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-quizzes.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -1,14 +1,39 @@\n const { root } = require('mdast-builder');\n const { getSection, getAllSections } = require('./utils/get-section');\n-const mdastToHtml = require('./utils/mdast-to-html');\n+const { createMdastToHtml } = require('./utils/i18n-stringify');\n \n const { splitOnThematicBreak } = require('./utils/split-on-thematic-break');\n \n function plugin() {\n   return transformer;\n   function transformer(tree, file) {\n+    const toHtml = createMdastToHtml(file.data.lang);\n     const quizzesNodes = getSection(tree, `--quizzes--`);\n \n+    function getDistractors(distractorsNodes) {\n+      const distractorsGroups = splitOnThematicBreak(distractorsNodes);\n+\n+      if (distractorsGroups.length !== 3)\n+        throw Error('Three distractors are required per quiz-question');\n+\n+      return distractorsGroups.map(distractorsGroup => {\n+        return toHtml(distractorsGroup);\n+      });\n+    }\n+\n+    function getQuestion(textNodes, distractorNodes, answerNodes) {\n+      const text = toHtml(textNodes);\n+      const distractors = getDistractors(distractorNodes);\n+      const answer = toHtml(answerNodes);\n+\n+      if (!text) throw Error('--text-- is missing from the quiz question');\n+      if (!distractors)\n+        throw Error('--distractors-- are missing from quiz question');\n+      if (!answer) throw Error('--answer-- is missing from quiz question');\n+\n+      return { text, distractors, answer };\n+    }\n+\n     if (quizzesNodes.length > 0) {\n       const compiledQuizzes = [];\n       const quizSections = getAllSections(root(quizzesNodes), `--quiz--`);\n@@ -51,28 +76,4 @@ function plugin() {\n   }\n }\n \n-function getQuestion(textNodes, distractorNodes, answerNodes) {\n-  const text = mdastToHtml(textNodes);\n-  const distractors = getDistractors(distractorNodes);\n-  const answer = mdastToHtml(answerNodes);\n-\n-  if (!text) throw Error('--text-- is missing from the quiz question');\n-  if (!distractors)\n-    throw Error('--distractors-- are missing from quiz question');\n-  if (!answer) throw Error('--answer-- is missing from quiz question');\n-\n-  return { text, distractors, answer };\n-}\n-\n-function getDistractors(distractorsNodes) {\n-  const distractorsGroups = splitOnThematicBreak(distractorsNodes);\n-\n-  if (distractorsGroups.length !== 3)\n-    throw Error('Three distractors are required per quiz-question');\n-\n-  return distractorsGroups.map(distractorsGroup => {\n-    return mdastToHtml(distractorsGroup);\n-  });\n-}\n-\n module.exports = plugin;"
        },
        {
            "sha": "a3564099a46095bc8b9a8a64f427d3749da93693",
            "filename": "tools/challenge-parser/parser/plugins/add-quizzes.test.js",
            "status": "modified",
            "additions": 74,
            "deletions": 0,
            "changes": 74,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-quizzes.test.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-quizzes.test.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-quizzes.test.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -4,11 +4,13 @@ import addQuizzes from './add-quizzes';\n \n describe('add-quizzes plugin', () => {\n   let mockQuizzesAST;\n+  let chineseQuizzesAST;\n   const plugin = addQuizzes();\n   let file = { data: {} };\n \n   beforeAll(async () => {\n     mockQuizzesAST = await parseFixture('with-quizzes.md');\n+    chineseQuizzesAST = await parseFixture('with-chinese-quizzes.md');\n   });\n \n   beforeEach(() => {\n@@ -61,4 +63,76 @@ describe('add-quizzes plugin', () => {\n     plugin(mockQuizzesAST, file);\n     expect(file.data).toMatchSnapshot();\n   });\n+\n+  it('should render Chinese hanzi (pinyin) in quizzes when lang is zh-CN and the text contains hanzi (pinyin) format', () => {\n+    const zhFile = { data: { lang: 'zh-CN' } };\n+    plugin(chineseQuizzesAST, zhFile);\n+    const quizzes = zhFile.data.quizzes;\n+    expect(Array.isArray(quizzes)).toBe(true);\n+    expect(quizzes.length).toBe(1);\n+\n+    const firstQuiz = quizzes[0];\n+    const firstQuestion = firstQuiz.questions[0];\n+\n+    // Quiz 1, Question 1\n+    expect(firstQuestion.text).toBe(\n+      '<p>Quiz 1, question 1 with <ruby>中文<rp>(</rp><rt>zhōng wén</rt><rp>)</rp></ruby></p>'\n+    );\n+    expect(firstQuestion.distractors[0]).toBe(\n+      '<p>Quiz 1, question 1, distractor 1 with <ruby>中文<rp>(</rp><rt>zhōng wén</rt><rp>)</rp></ruby></p>'\n+    );\n+    expect(firstQuestion.distractors[1]).toBe(\n+      '<p>Quiz 1, question 1, distractor 2 with <ruby>中文<rp>(</rp><rt>zhōng wén</rt><rp>)</rp></ruby></p>'\n+    );\n+    expect(firstQuestion.distractors[2]).toBe(\n+      '<p>Quiz 1, question 1, distractor 3 with <ruby>中文<rp>(</rp><rt>zhōng wén</rt><rp>)</rp></ruby></p>'\n+    );\n+    expect(firstQuestion.answer).toBe(\n+      '<p>Quiz 1, question 1, answer with <ruby>中文<rp>(</rp><rt>zhōng wén</rt><rp>)</rp></ruby></p>'\n+    );\n+  });\n+\n+  it('should render Chinese in quizzes when lang is zh-CN and the text does not contain hanzi (pinyin) format', () => {\n+    const zhFile = { data: { lang: 'zh-CN' } };\n+    plugin(chineseQuizzesAST, zhFile);\n+    const quizzes = zhFile.data.quizzes;\n+\n+    const firstQuiz = quizzes[0];\n+    const secondQuestion = firstQuiz.questions[1];\n+    const thirdQuestion = firstQuiz.questions[2];\n+\n+    // Quiz 1, Question 2\n+    expect(secondQuestion.text).toBe(\n+      '<p>Quiz 1, question 2 with <code>中文</code></p>'\n+    );\n+    expect(secondQuestion.distractors[0]).toBe(\n+      '<p>Quiz 1, question 2, distractor 1 with <code>中文</code></p>'\n+    );\n+    expect(secondQuestion.distractors[1]).toBe(\n+      '<p>Quiz 1, question 2, distractor 2 with <code>中文</code></p>'\n+    );\n+    expect(secondQuestion.distractors[2]).toBe(\n+      '<p>Quiz 1, question 2, distractor 3 with <code>中文</code></p>'\n+    );\n+    expect(secondQuestion.answer).toBe(\n+      '<p>Quiz 1, question 2, answer with <code>中文</code></p>'\n+    );\n+\n+    // Quiz 1, Question 3\n+    expect(thirdQuestion.text).toBe(\n+      '<p>Quiz 1, question 3 with <code>zhōng wén</code></p>'\n+    );\n+    expect(thirdQuestion.distractors[0]).toBe(\n+      '<p>Quiz 1, question 3, distractor 1 with <code>zhōng wén</code></p>'\n+    );\n+    expect(thirdQuestion.distractors[1]).toBe(\n+      '<p>Quiz 1, question 3, distractor 2 with <code>zhōng wén</code></p>'\n+    );\n+    expect(thirdQuestion.distractors[2]).toBe(\n+      '<p>Quiz 1, question 3, distractor 3 with <code>zhōng wén</code></p>'\n+    );\n+    expect(thirdQuestion.answer).toBe(\n+      '<p>Quiz 1, question 3, answer with <code>zhōng wén</code></p>'\n+    );\n+  });\n });"
        },
        {
            "sha": "be4415169e84213c7aa7f98b7773df1d45793d8a",
            "filename": "tools/challenge-parser/parser/plugins/add-text.js",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-text.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-text.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-text.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -2,7 +2,7 @@ const { isEmpty } = require('lodash');\n const find = require('unist-util-find');\n const { root } = require('mdast-builder');\n const { getSection, isMarker } = require('./utils/get-section');\n-const mdastToHTML = require('./utils/mdast-to-html');\n+const { createMdastToHtml } = require('./utils/i18n-stringify');\n \n function addText(sectionIds) {\n   if (!sectionIds || !Array.isArray(sectionIds) || sectionIds.length <= 0) {\n@@ -17,7 +17,9 @@ function addText(sectionIds) {\n           `The --${sectionId}-- section should not have any subsections. Found subsection ${subSection.children[0].value}`\n         );\n       }\n-      const sectionText = mdastToHTML(textNodes);\n+\n+      const toHtml = createMdastToHtml(file.data.lang);\n+      const sectionText = toHtml(textNodes);\n       if (!isEmpty(sectionText)) {\n         file.data = {\n           ...file.data,"
        },
        {
            "sha": "2a76a53c9cdc13b3cf040c7ce03ffd129e3bb116",
            "filename": "tools/challenge-parser/parser/plugins/add-text.test.js",
            "status": "modified",
            "additions": 20,
            "deletions": 1,
            "changes": 21,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-text.test.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-text.test.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-text.test.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -3,7 +3,11 @@ import parseFixture from '../__fixtures__/parse-fixture';\n import addText from './add-text';\n \n describe('add-text', () => {\n-  let realisticAST, mockAST, withSubSectionAST, withNestedInstructionsAST;\n+  let realisticAST,\n+    mockAST,\n+    withSubSectionAST,\n+    withNestedInstructionsAST,\n+    withChineseAST;\n   const descriptionId = 'description';\n   const instructionsId = 'instructions';\n   const missingId = 'missing';\n@@ -16,6 +20,7 @@ describe('add-text', () => {\n     withNestedInstructionsAST = await parseFixture(\n       'with-nested-instructions.md'\n     );\n+    withChineseAST = await parseFixture('with-chinese-mcq.md');\n   });\n \n   beforeEach(() => {\n@@ -156,4 +161,18 @@ describe('add-text', () => {\n     plugin(mockAST, file);\n     expect(file.data).toMatchSnapshot();\n   });\n+\n+  it('should render Chinese inline code as ruby when lang is zh-CN', () => {\n+    const plugin = addText(['instructions', 'explanation']);\n+\n+    const zhFile = { data: { lang: 'zh-CN' } };\n+    plugin(withChineseAST, zhFile);\n+\n+    expect(zhFile.data.instructions).toBe(\n+      '<section id=\"instructions\">\\n<p>Instructions containing <ruby>汉字<rp>(</rp><rt>hàn zì</rt><rp>)</rp></ruby>.</p>\\n</section>'\n+    );\n+    expect(zhFile.data.explanation).toBe(\n+      '<section id=\"explanation\">\\n<p>Wang Hua uses <ruby>请问<rp>(</rp><rt>qǐng wèn</rt><rp>)</rp></ruby> to politely start her question.</p>\\n</section>'\n+    );\n+  });\n });"
        },
        {
            "sha": "6e7706543be39a95de5bdaddb1f94fc1a2e7cc0c",
            "filename": "tools/challenge-parser/parser/plugins/add-video-question.js",
            "status": "modified",
            "additions": 90,
            "deletions": 85,
            "changes": 175,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-video-question.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-video-question.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-video-question.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -2,14 +2,103 @@ const { root } = require('mdast-builder');\n const find = require('unist-util-find');\n const { getSection } = require('./utils/get-section');\n const getAllBefore = require('./utils/before-heading');\n-const mdastToHtml = require('./utils/mdast-to-html');\n const { getParagraphContent } = require('./utils/get-paragraph-content');\n \n const { splitOnThematicBreak } = require('./utils/split-on-thematic-break');\n+const { createMdastToHtml } = require('./utils/i18n-stringify');\n \n function plugin() {\n   return transformer;\n   function transformer(tree, file) {\n+    const toHtml = createMdastToHtml(file.data.lang);\n+\n+    function getQuestion(textNodes, answersNodes, solutionNodes) {\n+      const text = toHtml(textNodes);\n+      const answers = getAnswers(answersNodes);\n+      const solution = getSolution(solutionNodes);\n+\n+      if (!text) throw Error('text is missing from question');\n+      if (!answers) throw Error('answers are missing from question');\n+      if (!solution) throw Error('solution is missing from question');\n+\n+      return { text, answers, solution };\n+    }\n+\n+    function getAnswers(answersNodes) {\n+      const answerGroups = splitOnThematicBreak(answersNodes);\n+\n+      return answerGroups.map(answerGroup => {\n+        const answerTree = root(answerGroup);\n+        const feedbackNodes = getSection(answerTree, '--feedback--');\n+        const audioIdNodes = getSection(answerTree, '--audio-id--');\n+        const hasFeedback = feedbackNodes.length > 0;\n+        const hasAudioId = audioIdNodes.length > 0;\n+\n+        if (hasFeedback || hasAudioId) {\n+          let answerNodes;\n+\n+          if (hasFeedback && hasAudioId) {\n+            const feedbackHeading = find(answerTree, {\n+              type: 'heading',\n+              children: [{ type: 'text', value: '--feedback--' }]\n+            });\n+            const audioIdHeading = find(answerTree, {\n+              type: 'heading',\n+              children: [{ type: 'text', value: '--audio-id--' }]\n+            });\n+\n+            const feedbackIndex = answerTree.children.indexOf(feedbackHeading);\n+            const audioIdIndex = answerTree.children.indexOf(audioIdHeading);\n+            const firstMarker =\n+              feedbackIndex < audioIdIndex ? '--feedback--' : '--audio-id--';\n+            answerNodes = getAllBefore(answerTree, firstMarker);\n+          } else if (hasFeedback) {\n+            answerNodes = getAllBefore(answerTree, '--feedback--');\n+          } else {\n+            answerNodes = getAllBefore(answerTree, '--audio-id--');\n+          }\n+\n+          if (answerNodes.length < 1) {\n+            throw Error('Answer missing');\n+          }\n+\n+          let extractedAudioId = null;\n+          if (hasAudioId) {\n+            const audioIdContent = getParagraphContent(audioIdNodes[0]);\n+            if (audioIdContent && audioIdContent.trim()) {\n+              extractedAudioId = audioIdContent.trim();\n+            }\n+          }\n+\n+          return {\n+            answer: toHtml(answerNodes),\n+            feedback: hasFeedback ? toHtml(feedbackNodes) : null,\n+            audioId: extractedAudioId\n+          };\n+        }\n+\n+        return {\n+          answer: toHtml(answerGroup),\n+          feedback: null,\n+          audioId: null\n+        };\n+      });\n+    }\n+\n+    function getSolution(solutionNodes) {\n+      let solution;\n+      try {\n+        solution = Number(getParagraphContent(solutionNodes[0]));\n+        if (Number.isNaN(solution)) throw Error('Not a number');\n+        if (solution < 1) throw Error('Not positive number');\n+      } catch (e) {\n+        console.log(e);\n+        throw Error('A video solution should be a positive integer');\n+      }\n+\n+      return solution;\n+    }\n+\n     const allQuestionNodes = getSection(tree, '--questions--');\n \n     if (allQuestionNodes.length > 0) {\n@@ -41,88 +130,4 @@ function plugin() {\n   }\n }\n \n-function getQuestion(textNodes, answersNodes, solutionNodes) {\n-  const text = mdastToHtml(textNodes);\n-  const answers = getAnswers(answersNodes);\n-  const solution = getSolution(solutionNodes);\n-\n-  if (!text) throw Error('text is missing from question');\n-  if (!answers) throw Error('answers are missing from question');\n-  if (!solution) throw Error('solution is missing from question');\n-\n-  return { text, answers, solution };\n-}\n-\n-function getAnswers(answersNodes) {\n-  const answerGroups = splitOnThematicBreak(answersNodes);\n-\n-  return answerGroups.map(answerGroup => {\n-    const answerTree = root(answerGroup);\n-\n-    const feedbackNodes = getSection(answerTree, '--feedback--');\n-    const audioIdNodes = getSection(answerTree, '--audio-id--');\n-    const hasFeedback = feedbackNodes.length > 0;\n-    const hasAudioId = audioIdNodes.length > 0;\n-\n-    if (hasFeedback || hasAudioId) {\n-      let answerNodes;\n-\n-      if (hasFeedback && hasAudioId) {\n-        const feedbackHeading = find(answerTree, {\n-          type: 'heading',\n-          children: [{ type: 'text', value: '--feedback--' }]\n-        });\n-        const audioIdHeading = find(answerTree, {\n-          type: 'heading',\n-          children: [{ type: 'text', value: '--audio-id--' }]\n-        });\n-\n-        const feedbackIndex = answerTree.children.indexOf(feedbackHeading);\n-        const audioIdIndex = answerTree.children.indexOf(audioIdHeading);\n-        const firstMarker =\n-          feedbackIndex < audioIdIndex ? '--feedback--' : '--audio-id--';\n-        answerNodes = getAllBefore(answerTree, firstMarker);\n-      } else if (hasFeedback) {\n-        answerNodes = getAllBefore(answerTree, '--feedback--');\n-      } else {\n-        answerNodes = getAllBefore(answerTree, '--audio-id--');\n-      }\n-\n-      if (answerNodes.length < 1) {\n-        throw Error('Answer missing');\n-      }\n-\n-      let extractedAudioId = null;\n-      if (hasAudioId) {\n-        const audioIdContent = getParagraphContent(audioIdNodes[0]);\n-        if (audioIdContent && audioIdContent.trim()) {\n-          extractedAudioId = audioIdContent.trim();\n-        }\n-      }\n-\n-      return {\n-        answer: mdastToHtml(answerNodes),\n-        feedback: hasFeedback ? mdastToHtml(feedbackNodes) : null,\n-        audioId: extractedAudioId\n-      };\n-    }\n-\n-    return { answer: mdastToHtml(answerGroup), feedback: null, audioId: null };\n-  });\n-}\n-\n-function getSolution(solutionNodes) {\n-  let solution;\n-  try {\n-    solution = Number(getParagraphContent(solutionNodes[0]));\n-    if (Number.isNaN(solution)) throw Error('Not a number');\n-    if (solution < 1) throw Error('Not positive number');\n-  } catch (e) {\n-    console.log(e);\n-    throw Error('A video solution should be a positive integer');\n-  }\n-\n-  return solution;\n-}\n-\n module.exports = plugin;"
        },
        {
            "sha": "a9d1f5651d79fd54141e67cc64b33159e24bc6ce",
            "filename": "tools/challenge-parser/parser/plugins/add-video-question.test.js",
            "status": "modified",
            "additions": 39,
            "deletions": 2,
            "changes": 41,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-video-question.test.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-video-question.test.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Fadd-video-question.test.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -7,7 +7,8 @@ describe('add-video-question plugin', () => {\n     videoAST,\n     multipleQuestionAST,\n     videoOutOfOrderAST,\n-    videoWithAudioAST;\n+    videoWithAudioAST,\n+    chineseVideoAST;\n   const plugin = addVideoQuestion();\n   let file = { data: {} };\n \n@@ -21,6 +22,7 @@ describe('add-video-question plugin', () => {\n       'with-video-question-out-of-order.md'\n     );\n     videoWithAudioAST = await parseFixture('with-video-question-audio.md');\n+    chineseVideoAST = await parseFixture('with-chinese-mcq.md');\n   });\n \n   beforeEach(() => {\n@@ -107,7 +109,7 @@ describe('add-video-question plugin', () => {\n \n   it('should NOT throw if there is no question', () => {\n     expect.assertions(1);\n-    expect(() => plugin(simpleAST)).not.toThrow();\n+    expect(() => plugin(simpleAST, file)).not.toThrow();\n   });\n \n   it('should extract audioId from answers when present', () => {\n@@ -139,4 +141,39 @@ describe('add-video-question plugin', () => {\n     plugin(videoAST, file);\n     expect(file.data).toMatchSnapshot();\n   });\n+\n+  it('should render Chinese inline code as ruby in question text, answers, and feedback', async () => {\n+    const zhFile = { data: { lang: 'zh-CN' } };\n+\n+    plugin(chineseVideoAST, zhFile);\n+\n+    const question = zhFile.data.questions[0];\n+\n+    expect(question.text).toBe(\n+      '<p>Question text containing <ruby>汉字<rp>(</rp><rt>hàn zì</rt><rp>)</rp></ruby>.</p>'\n+    );\n+\n+    const answer1 = question.answers[0];\n+    expect(answer1.answer).toContain(\n+      '<ruby>你好<rp>(</rp><rt>nǐ hǎo</rt><rp>)</rp></ruby>'\n+    );\n+\n+    const answer2 = question.answers[1];\n+    expect(answer2.answer).toContain(\n+      '<ruby>请<rp>(</rp><rt>qǐng</rt><rp>)</rp></ruby>'\n+    );\n+    expect(answer2.feedback).toBe(\n+      '<p><ruby>请<rp>(</rp><rt>qǐng</rt><rp>)</rp></ruby> is not correct.</p>'\n+    );\n+\n+    const answer3 = question.answers[2];\n+    expect(answer3.answer).toContain(\n+      '<ruby>请问<rp>(</rp><rt>qǐng wèn</rt><rp>)</rp></ruby>'\n+    );\n+\n+    const answer4 = question.answers[3];\n+    expect(answer4.answer).toContain(\n+      '<ruby>问<rp>(</rp><rt>wèn</rt><rp>)</rp></ruby>'\n+    );\n+  });\n });"
        },
        {
            "sha": "0e10a036ff4251a4755cb4e63d71d7af29f1ebc2",
            "filename": "tools/challenge-parser/parser/plugins/utils/i18n-stringify.js",
            "status": "added",
            "additions": 78,
            "deletions": 0,
            "changes": 78,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Futils%2Fi18n-stringify.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Futils%2Fi18n-stringify.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Futils%2Fi18n-stringify.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -0,0 +1,78 @@\n+const mdastToHTML = require('./mdast-to-html');\n+\n+/**\n+ * Parses Chinese text in format: hanzi (pinyin)\n+ * @param {string} text - Text in format: hanzi (pinyin)\n+ * @returns {{ hanzi: string, pinyin: string } | null} Parsed hanzi and pinyin, or null if not matching\n+ */\n+function parseChinesePattern(text) {\n+  const match = text.match(/^(.+?)\\s*\\((.+?)\\)$/);\n+\n+  if (!match) {\n+    return null;\n+  }\n+\n+  return {\n+    hanzi: match[1].trim(),\n+    pinyin: match[2].trim()\n+  };\n+}\n+\n+/**\n+ * Custom handler for Chinese inline code to render as ruby elements\n+ * @param {object} state - The state object from mdast-util-to-hast\n+ * @param {object} node - The inlineCode node\n+ * @returns {object} Hast element node\n+ */\n+function chineseInlineCodeHandler(state, node) {\n+  const parsed = parseChinesePattern(node.value);\n+\n+  if (parsed) {\n+    return {\n+      type: 'element',\n+      tagName: 'ruby',\n+      properties: {},\n+      children: [\n+        { type: 'text', value: parsed.hanzi },\n+        {\n+          type: 'element',\n+          tagName: 'rp',\n+          properties: {},\n+          children: [{ type: 'text', value: '(' }]\n+        },\n+        {\n+          type: 'element',\n+          tagName: 'rt',\n+          properties: {},\n+          children: [{ type: 'text', value: parsed.pinyin }]\n+        },\n+        {\n+          type: 'element',\n+          tagName: 'rp',\n+          properties: {},\n+          children: [{ type: 'text', value: ')' }]\n+        }\n+      ]\n+    };\n+  }\n+\n+  return {\n+    type: 'element',\n+    // TODO: change this to span\n+    // https://github.com/freeCodeCamp/language-curricula/issues/22\n+    tagName: 'code',\n+    properties: {},\n+    children: [{ type: 'text', value: node.value }]\n+  };\n+}\n+\n+const rubyOptions = {\n+  handlers: {\n+    inlineCode: chineseInlineCodeHandler\n+  }\n+};\n+\n+const createMdastToHtml = lang =>\n+  lang == 'zh-CN' ? x => mdastToHTML(x, rubyOptions) : mdastToHTML;\n+\n+module.exports = { parseChinesePattern, createMdastToHtml };"
        },
        {
            "sha": "64631528c58c160e258189cc01f6bec5f7534388",
            "filename": "tools/challenge-parser/parser/plugins/utils/i18n-stringify.test.js",
            "status": "added",
            "additions": 129,
            "deletions": 0,
            "changes": 129,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Futils%2Fi18n-stringify.test.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Futils%2Fi18n-stringify.test.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Futils%2Fi18n-stringify.test.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -0,0 +1,129 @@\n+import { describe, it, expect } from 'vitest';\n+import { createMdastToHtml, parseChinesePattern } from './i18n-stringify';\n+\n+describe('parseChinesePattern', () => {\n+  it('should parse Chinese text with hanzi and pinyin', () => {\n+    const result = parseChinesePattern('你好 (nǐ hǎo)');\n+    expect(result).toEqual({\n+      hanzi: '你好',\n+      pinyin: 'nǐ hǎo'\n+    });\n+  });\n+\n+  it('should handle text without spaces before parentheses', () => {\n+    const result = parseChinesePattern('你好(nǐ hǎo)');\n+    expect(result).toEqual({\n+      hanzi: '你好',\n+      pinyin: 'nǐ hǎo'\n+    });\n+  });\n+\n+  it('should handle text with multiple spaces', () => {\n+    const result = parseChinesePattern('你好   (nǐ hǎo)');\n+    expect(result).toEqual({\n+      hanzi: '你好',\n+      pinyin: 'nǐ hǎo'\n+    });\n+  });\n+\n+  it('should return null for text without parentheses', () => {\n+    const result = parseChinesePattern('你好');\n+    expect(result).toBeNull();\n+  });\n+\n+  it('should return null for text with only opening parenthesis', () => {\n+    const result = parseChinesePattern('你好 (nǐ hǎo');\n+    expect(result).toBeNull();\n+  });\n+\n+  it('should return null for empty string', () => {\n+    const result = parseChinesePattern('');\n+    expect(result).toBeNull();\n+  });\n+});\n+\n+describe('createMdastToHtml', () => {\n+  it('should render Chinese inline code as ruby when lang is zh-CN', () => {\n+    const toHtml = createMdastToHtml('zh-CN');\n+    const nodes = [\n+      {\n+        type: 'paragraph',\n+        children: [\n+          { type: 'text', value: 'This is ' },\n+          { type: 'inlineCode', value: '请问 (qǐng wèn)' },\n+          { type: 'text', value: '.' }\n+        ]\n+      }\n+    ];\n+    const actual = toHtml(nodes);\n+    expect(actual).toBe(\n+      '<p>This is <ruby>请问<rp>(</rp><rt>qǐng wèn</rt><rp>)</rp></ruby>.</p>'\n+    );\n+  });\n+\n+  it('should render Chinese inline code as ruby with or without space before parenthesis', () => {\n+    const toHtml = createMdastToHtml('zh-CN');\n+    const nodesWithSpace = [\n+      {\n+        type: 'paragraph',\n+        children: [{ type: 'inlineCode', value: '你好 (nǐ hǎo)' }]\n+      }\n+    ];\n+    const nodesWithoutSpace = [\n+      {\n+        type: 'paragraph',\n+        children: [{ type: 'inlineCode', value: '你好(nǐ hǎo)' }]\n+      }\n+    ];\n+    const expected =\n+      '<p><ruby>你好<rp>(</rp><rt>nǐ hǎo</rt><rp>)</rp></ruby></p>';\n+    expect(toHtml(nodesWithSpace)).toBe(expected);\n+    expect(toHtml(nodesWithoutSpace)).toBe(expected);\n+  });\n+\n+  it('should handle multiple Chinese inline codes in one paragraph', () => {\n+    const toHtml = createMdastToHtml('zh-CN');\n+    const nodes = [\n+      {\n+        type: 'paragraph',\n+        children: [\n+          { type: 'inlineCode', value: '你好 (nǐ hǎo)' },\n+          { type: 'text', value: ' and ' },\n+          { type: 'inlineCode', value: '再见 (zài jiàn)' }\n+        ]\n+      }\n+    ];\n+    const actual = toHtml(nodes);\n+    expect(actual).toBe(\n+      '<p><ruby>你好<rp>(</rp><rt>nǐ hǎo</rt><rp>)</rp></ruby> and <ruby>再见<rp>(</rp><rt>zài jiàn</rt><rp>)</rp></ruby></p>'\n+    );\n+  });\n+\n+  it('should fallback to code element if pattern does not match', () => {\n+    const toHtml = createMdastToHtml('zh-CN');\n+    const nodes = [\n+      {\n+        type: 'paragraph',\n+        children: [\n+          { type: 'inlineCode', value: '你好' },\n+          { type: 'text', value: ' and ' },\n+          { type: 'inlineCode', value: 'nǐ hǎo' }\n+        ]\n+      }\n+    ];\n+    const actual = toHtml(nodes, { lang: 'zh-CN' });\n+    expect(actual).toBe('<p><code>你好</code> and <code>nǐ hǎo</code></p>');\n+  });\n+\n+  it('should render as regular code when lang is not zh-CN', () => {\n+    const toHtml = createMdastToHtml('zh');\n+    const nodes = [\n+      {\n+        type: 'paragraph',\n+        children: [{ type: 'inlineCode', value: '请问 (qǐng wèn)' }]\n+      }\n+    ];\n+    const actual = toHtml(nodes);\n+    expect(actual).toBe('<p><code>请问 (qǐng wèn)</code></p>');\n+  });\n+});"
        },
        {
            "sha": "96c3ae18b78b7074133aa39eae99944dd07c8896",
            "filename": "tools/challenge-parser/parser/plugins/utils/mdast-to-html.js",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Futils%2Fmdast-to-html.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/0c844ab007ea91843b449b0219ea9703d1ba7b10/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Futils%2Fmdast-to-html.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-parser%2Fparser%2Fplugins%2Futils%2Fmdast-to-html.js?ref=0c844ab007ea91843b449b0219ea9703d1ba7b10",
            "patch": "@@ -2,14 +2,17 @@ const hastToHTML = require('hast-util-to-html');\n const { root } = require('mdast-builder');\n const mdastToHast = require('mdast-util-to-hast');\n \n-function mdastToHTML(nodes) {\n+function mdastToHTML(nodes, hastOptions = {}) {\n   if (!Array.isArray(nodes))\n     throw Error('mdastToHTML expects an array argument');\n   // - the 'nodes' are children, so first need embedding in a parent\n \n-  return hastToHTML(mdastToHast(root(nodes), { allowDangerousHtml: true }), {\n-    allowDangerousHtml: true\n-  });\n+  return hastToHTML(\n+    mdastToHast(root(nodes), { allowDangerousHtml: true, ...hastOptions }),\n+    {\n+      allowDangerousHtml: true\n+    }\n+  );\n }\n \n module.exports = mdastToHTML;"
        }
    ],
    "stats": {
        "total": 729,
        "additions": 601,
        "deletions": 128
    }
}