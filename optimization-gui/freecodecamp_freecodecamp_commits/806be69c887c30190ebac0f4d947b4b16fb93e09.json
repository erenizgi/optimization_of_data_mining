{
    "author": "ShaunSHamilton",
    "message": "chore: initiate replica with defined host (#62477)",
    "sha": "806be69c887c30190ebac0f4d947b4b16fb93e09",
    "files": [
        {
            "sha": "817e2671663e4761d54b2a288cebc7210a2a65ee",
            "filename": ".devcontainer/docker-compose.yml",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/806be69c887c30190ebac0f4d947b4b16fb93e09/.devcontainer%2Fdocker-compose.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/806be69c887c30190ebac0f4d947b4b16fb93e09/.devcontainer%2Fdocker-compose.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/.devcontainer%2Fdocker-compose.yml?ref=806be69c887c30190ebac0f4d947b4b16fb93e09",
            "patch": "@@ -13,6 +13,7 @@ services:\n     image: mongo\n     command: mongod --replSet rs0\n     restart: unless-stopped\n+    hostname: mongodb\n     volumes:\n       - mongodb-data:/data/db\n   mongo-setup:\n@@ -24,8 +25,9 @@ services:\n         'bash',\n         '-c',\n         # This will try to initiate the replica set, until it succeeds twice (i.e. until the replica set is already initialized)\n-        'mongosh --host mongo-db:27017 --eval ''try {rs.initiate();} catch (err) { if(err.codeName !== \"AlreadyInitialized\") throw err };'''\n+        'mongosh --host mongo-db:27017 --eval ''try {var cfg = { _id: \"rs0\", members: [{ _id: 0, host: \"mongodb:27017\" }] }; rs.initiate(cfg); } catch (err) { if(err.codeName !== \"AlreadyInitialized\") throw err };'''\n       ]\n \n volumes:\n   mongodb-data:\n+    driver: local"
        },
        {
            "sha": "521bdc73318a9450bb37f2181ca9e668765603b8",
            "filename": "docker/docker-compose.yml",
            "status": "modified",
            "additions": 8,
            "deletions": 1,
            "changes": 9,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/806be69c887c30190ebac0f4d947b4b16fb93e09/docker%2Fdocker-compose.yml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/806be69c887c30190ebac0f4d947b4b16fb93e09/docker%2Fdocker-compose.yml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/docker%2Fdocker-compose.yml?ref=806be69c887c30190ebac0f4d947b4b16fb93e09",
            "patch": "@@ -4,6 +4,7 @@ services:\n     container_name: mongodb\n     command: mongod --replSet rs0\n     restart: unless-stopped\n+    hostname: mongodb\n     ports:\n       - 27017:27017\n     volumes:\n@@ -22,8 +23,14 @@ services:\n     # This will try to initiate the replica set, until it succeeds twice (i.e. until the replica set is already initialized)\n     command: >\n       mongosh --host db:27017 --eval '\n+        var cfg = {\n+          _id: \"rs0\",\n+          members: [\n+            { _id: 0, host: \"mongodb:27017\" }\n+          ]\n+        };\n         try {\n-          rs.initiate();\n+          rs.initiate(cfg);\n         } catch (err) {\n           if(err.codeName !== \"AlreadyInitialized\") throw err;\n         }"
        }
    ],
    "stats": {
        "total": 13,
        "additions": 11,
        "deletions": 2
    }
}