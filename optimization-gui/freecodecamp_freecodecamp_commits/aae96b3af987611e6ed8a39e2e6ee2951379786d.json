{
    "author": "ojeytonwilliams",
    "message": "fix(api): update-my-username response body (#54901)",
    "sha": "aae96b3af987611e6ed8a39e2e6ee2951379786d",
    "files": [
        {
            "sha": "4234aac421c7c46616c2b60cc66ac41cdd3dd89e",
            "filename": "api/src/routes/settings.test.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/aae96b3af987611e6ed8a39e2e6ee2951379786d/api%2Fsrc%2Froutes%2Fsettings.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/aae96b3af987611e6ed8a39e2e6ee2951379786d/api%2Fsrc%2Froutes%2Fsettings.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Froutes%2Fsettings.test.ts?ref=aae96b3af987611e6ed8a39e2e6ee2951379786d",
            "patch": "@@ -409,10 +409,10 @@ Please wait 5 minutes to resend an authentication link.`\n           username: 'TwaHa1'\n         });\n \n-        expect(response.body).toEqual({\n+        expect(response.body).toStrictEqual({\n           message: 'flash.username-updated',\n           type: 'success',\n-          username: 'TwaHa1'\n+          variables: { username: 'TwaHa1' }\n         });\n \n         const user = await fastifyTestInstance.prisma.user.findFirst({\n@@ -470,10 +470,10 @@ Please wait 5 minutes to resend an authentication link.`\n           username: 'TWaha3'\n         });\n \n-        expect(response.body).toEqual({\n+        expect(response.body).toStrictEqual({\n           message: 'flash.username-updated',\n           type: 'success',\n-          username: 'TWaha3'\n+          variables: { username: 'TWaha3' }\n         });\n         expect(response.statusCode).toEqual(200);\n       });"
        },
        {
            "sha": "c80f7f4eddbe83853987813dada08fbafbc69091",
            "filename": "api/src/routes/settings.ts",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/aae96b3af987611e6ed8a39e2e6ee2951379786d/api%2Fsrc%2Froutes%2Fsettings.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/aae96b3af987611e6ed8a39e2e6ee2951379786d/api%2Fsrc%2Froutes%2Fsettings.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Froutes%2Fsettings.ts?ref=aae96b3af987611e6ed8a39e2e6ee2951379786d",
            "patch": "@@ -358,11 +358,11 @@ ${isLinkSentWithinLimitTTL}`\n \n         if (!validation.valid) {\n           void reply.code(400);\n-          return {\n+          return reply.send({\n             // TODO(Post-MVP): custom validation errors.\n             message: `Username ${newUsername} ${validation.error}`,\n             type: 'info'\n-          } as const;\n+          });\n         }\n \n         const isUserNameProfane = isProfane(newUsername);\n@@ -377,10 +377,10 @@ ${isLinkSentWithinLimitTTL}`\n \n         if (usernameTaken || isUserNameProfane || onBlocklist) {\n           void reply.code(400);\n-          return {\n+          return reply.send({\n             message: 'flash.username-taken',\n             type: 'info'\n-          } as const;\n+          });\n         }\n \n         await fastify.prisma.user.update({\n@@ -391,15 +391,15 @@ ${isLinkSentWithinLimitTTL}`\n           }\n         });\n \n-        return {\n+        return reply.send({\n           message: 'flash.username-updated',\n           type: 'success',\n-          username: newUsernameDisplay\n-        } as const;\n+          variables: { username: newUsernameDisplay }\n+        });\n       } catch (err) {\n         fastify.log.error(err);\n         void reply.code(500);\n-        return { message: 'flash.wrong-updating', type: 'danger' } as const;\n+        await reply.send({ message: 'flash.wrong-updating', type: 'danger' });\n       }\n     }\n   );"
        },
        {
            "sha": "46df9b368ae20033b59591913e9f6affc7091b0b",
            "filename": "api/src/schemas/settings/update-my-username.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/aae96b3af987611e6ed8a39e2e6ee2951379786d/api%2Fsrc%2Fschemas%2Fsettings%2Fupdate-my-username.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/aae96b3af987611e6ed8a39e2e6ee2951379786d/api%2Fsrc%2Fschemas%2Fsettings%2Fupdate-my-username.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fschemas%2Fsettings%2Fupdate-my-username.ts?ref=aae96b3af987611e6ed8a39e2e6ee2951379786d",
            "patch": "@@ -8,7 +8,7 @@ export const updateMyUsername = {\n     200: Type.Object({\n       message: Type.String(),\n       type: Type.Literal('success'),\n-      username: Type.String()\n+      variables: Type.Object({ username: Type.String() })\n     }),\n     400: Type.Object({\n       message: Type.Optional(Type.String()),"
        }
    ],
    "stats": {
        "total": 26,
        "additions": 13,
        "deletions": 13
    }
}