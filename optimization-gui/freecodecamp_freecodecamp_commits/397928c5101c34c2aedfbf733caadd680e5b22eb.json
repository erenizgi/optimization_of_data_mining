{
    "author": "ojeytonwilliams",
    "message": "fix(client): render report user page for signed out users (#64399)",
    "sha": "397928c5101c34c2aedfbf733caadd680e5b22eb",
    "files": [
        {
            "sha": "17705c4b3c7d516caa80391ac28a726eef7fd5a1",
            "filename": "client/src/client-only-routes/show-user.test.tsx",
            "status": "added",
            "additions": 58,
            "deletions": 0,
            "changes": 58,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/397928c5101c34c2aedfbf733caadd680e5b22eb/client%2Fsrc%2Fclient-only-routes%2Fshow-user.test.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/397928c5101c34c2aedfbf733caadd680e5b22eb/client%2Fsrc%2Fclient-only-routes%2Fshow-user.test.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fclient-only-routes%2Fshow-user.test.tsx?ref=397928c5101c34c2aedfbf733caadd680e5b22eb",
            "patch": "@@ -0,0 +1,58 @@\n+/* eslint-disable */\n+import React from 'react';\n+import { render, screen } from '@testing-library/react';\n+import { describe, it, expect, vi } from 'vitest';\n+import { Provider } from 'react-redux';\n+import type * as I18next from 'i18next';\n+\n+import { createStore } from '../redux/create-store';\n+import { ShowUser } from './show-user';\n+\n+const store = createStore();\n+\n+vi.mock('../utils/get-words');\n+\n+describe('<ShowUser />', () => {\n+  it('renders login button when user is signed out', () => {\n+    render(\n+      <Provider store={store}>\n+        <ShowUser {...loggedOutProps} />\n+      </Provider>\n+    );\n+    expect(screen.getByText('report.sign-in')).toBeInTheDocument();\n+  });\n+\n+  it('renders report form when user is signed in', () => {\n+    render(\n+      <Provider store={store}>\n+        <ShowUser {...loggedInProps} />\n+      </Provider>\n+    );\n+    expect(screen.getByText('report.submit')).toBeInTheDocument();\n+  });\n+});\n+\n+// Mock props for different states\n+const mockT = vi.fn(key => key) as unknown as I18next.TFunction;\n+\n+const baseProps = {\n+  reportUser: vi.fn(),\n+  t: mockT,\n+  username: 'testuser',\n+  userFetchState: {\n+    pending: false,\n+    complete: true,\n+    errored: false,\n+    error: null\n+  }\n+};\n+\n+const loggedInProps = {\n+  ...baseProps,\n+  user: { email: 'test@example.com' }\n+};\n+\n+const loggedOutProps = {\n+  ...baseProps,\n+  user: null\n+};"
        },
        {
            "sha": "0ff966aef768399114a4ad213050af710739149d",
            "filename": "client/src/client-only-routes/show-user.tsx",
            "status": "modified",
            "additions": 10,
            "deletions": 20,
            "changes": 30,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/397928c5101c34c2aedfbf733caadd680e5b22eb/client%2Fsrc%2Fclient-only-routes%2Fshow-user.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/397928c5101c34c2aedfbf733caadd680e5b22eb/client%2Fsrc%2Fclient-only-routes%2Fshow-user.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fclient-only-routes%2Fshow-user.tsx?ref=397928c5101c34c2aedfbf733caadd680e5b22eb",
            "patch": "@@ -18,16 +18,13 @@ import {\n import Login from '../components/Header/components/login';\n import { Loader, FullWidthRow } from '../components/helpers';\n import { reportUser } from '../redux/actions';\n-import {\n-  userFetchStateSelector,\n-  isSignedInSelector,\n-  userSelector\n-} from '../redux/selectors';\n+import { userFetchStateSelector, userSelector } from '../redux/selectors';\n import { UserFetchState } from '../redux/prop-types';\n \n+type User = { email: string } | null;\n+\n interface ShowUserProps {\n-  email: string;\n-  isSignedIn: boolean;\n+  user: User;\n   reportUser: (payload: {\n     username: string;\n     reportDescription: string;\n@@ -38,27 +35,20 @@ interface ShowUserProps {\n }\n \n const mapStateToProps = createSelector(\n-  isSignedInSelector,\n   userFetchStateSelector,\n   userSelector,\n-  (\n-    isSignedIn,\n-    userFetchState: UserFetchState,\n-    { email }: { email: string }\n-  ) => ({\n-    isSignedIn,\n+  (userFetchState: UserFetchState, user: User) => ({\n     userFetchState,\n-    email\n+    user\n   })\n );\n \n const mapDispatchToProps = {\n   reportUser\n };\n \n-function ShowUser({\n-  email,\n-  isSignedIn,\n+export function ShowUser({\n+  user,\n   reportUser,\n   t,\n   userFetchState,\n@@ -80,7 +70,7 @@ function ShowUser({\n     return <Loader fullScreen={true} />;\n   }\n \n-  if ((complete || errored) && !isSignedIn) {\n+  if (errored || !user) {\n     return (\n       <main>\n         <FullWidthRow>\n@@ -117,7 +107,7 @@ function ShowUser({\n         <Col sm={6} smOffset={3} xs={12}>\n           <p>\n             <Trans i18nKey='report.notify-1'>\n-              <strong>{{ email }}</strong>\n+              <strong>{{ email: user.email }}</strong>\n             </Trans>\n           </p>\n           <p>{t('report.notify-2')}</p>"
        }
    ],
    "stats": {
        "total": 88,
        "additions": 68,
        "deletions": 20
    }
}