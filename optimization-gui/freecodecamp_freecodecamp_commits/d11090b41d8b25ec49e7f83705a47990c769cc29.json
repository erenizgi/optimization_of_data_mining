{
    "author": "Sembauke",
    "message": "feat: convert portfolio test to Playwright (#54908)",
    "sha": "d11090b41d8b25ec49e7f83705a47990c769cc29",
    "files": [
        {
            "sha": "71711195f964e91475df4fcbd709df9cdcfb41ea",
            "filename": "client/src/components/settings/portfolio.tsx",
            "status": "modified",
            "additions": 15,
            "deletions": 8,
            "changes": 23,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/d11090b41d8b25ec49e7f83705a47990c769cc29/client%2Fsrc%2Fcomponents%2Fsettings%2Fportfolio.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/d11090b41d8b25ec49e7f83705a47990c769cc29/client%2Fsrc%2Fcomponents%2Fsettings%2Fportfolio.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2Fsettings%2Fportfolio.tsx?ref=d11090b41d8b25ec49e7f83705a47990c769cc29",
            "patch": "@@ -275,11 +275,13 @@ class PortfolioSettings extends Component<PortfolioProps, PortfolioState> {\n               required={true}\n               type='text'\n               value={title}\n-              data-cy='portfolio-title'\n+              name='portfolio-title'\n               id={`${id}-title-input`}\n             />\n             {titleMessage ? (\n-              <HelpBlock data-cy='validation-message'>{titleMessage}</HelpBlock>\n+              <HelpBlock data-playwright-test-label='title-validation'>\n+                {titleMessage}\n+              </HelpBlock>\n             ) : null}\n           </FormGroup>\n           <FormGroup\n@@ -294,11 +296,13 @@ class PortfolioSettings extends Component<PortfolioProps, PortfolioState> {\n               required={true}\n               type='url'\n               value={url}\n-              data-cy='portfolio-url'\n+              name='portfolio-url'\n               id={`${id}-url-input`}\n             />\n             {urlMessage ? (\n-              <HelpBlock data-cy='validation-message'>{urlMessage}</HelpBlock>\n+              <HelpBlock data-playwright-test-label='url-validation'>\n+                {urlMessage}\n+              </HelpBlock>\n             ) : null}\n           </FormGroup>\n           <FormGroup\n@@ -312,11 +316,13 @@ class PortfolioSettings extends Component<PortfolioProps, PortfolioState> {\n               onChange={this.createOnChangeHandler(id, 'image')}\n               type='url'\n               value={image}\n-              data-cy='portfolio-image'\n+              name='portfolio-image'\n               id={`${id}-image-input`}\n             />\n             {imageMessage ? (\n-              <HelpBlock data-cy='validation-message'>{imageMessage}</HelpBlock>\n+              <HelpBlock data-playwright-test-label='image-validation'>\n+                {imageMessage}\n+              </HelpBlock>\n             ) : null}\n           </FormGroup>\n           <FormGroup\n@@ -330,18 +336,19 @@ class PortfolioSettings extends Component<PortfolioProps, PortfolioState> {\n               componentClass='textarea'\n               onChange={this.createOnChangeHandler(id, 'description')}\n               value={description}\n-              data-cy='portfolio-description'\n+              name='portfolio-description'\n               id={`${id}-description-input`}\n             />\n             {descriptionMessage ? (\n-              <HelpBlock data-cy='validation-message'>\n+              <HelpBlock data-playwright-test-label='description-validation'>\n                 {descriptionMessage}\n               </HelpBlock>\n             ) : null}\n           </FormGroup>\n           <BlockSaveButton\n             disabled={isButtonDisabled}\n             bgSize='large'\n+            data-playwright-test-label='save-portfolio'\n             {...(isButtonDisabled && { tabIndex: -1 })}\n           >\n             {t('buttons.save-portfolio')}"
        },
        {
            "sha": "f9ae76e524c9b092a8938d990d02f0468c62a7eb",
            "filename": "cypress/e2e/default/settings/portfolio.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 56,
            "changes": 56,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/eeb7cb090ecfda65416c01b21741e4529d7f9a64/cypress%2Fe2e%2Fdefault%2Fsettings%2Fportfolio.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/eeb7cb090ecfda65416c01b21741e4529d7f9a64/cypress%2Fe2e%2Fdefault%2Fsettings%2Fportfolio.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/cypress%2Fe2e%2Fdefault%2Fsettings%2Fportfolio.ts?ref=eeb7cb090ecfda65416c01b21741e4529d7f9a64",
            "patch": "@@ -1,56 +0,0 @@\n-describe('Add Portfolio Item', () => {\n-  beforeEach(() => {\n-    cy.task('seed');\n-    cy.login();\n-  });\n-\n-  it('should be possible to add a portfolio item', () => {\n-    cy.visit('/settings');\n-    cy.get('[data-cy=\"add-portfolio\"]')\n-      .contains('Add a new portfolio Item')\n-      .click();\n-\n-    cy.get('[data-cy=\"validation-message\"]').contains('A title is required');\n-    cy.get('[data-cy=\"portfolio-title\"]').type('This is a portfolio item');\n-    cy.get('button')\n-      .contains('Save this portfolio item')\n-      .should('not.be.disabled');\n-\n-    cy.get('[data-cy=\"portfolio-url\"]').type('This is a portfolio item');\n-    cy.get('[data-cy=\"validation-message\"]').contains(\n-      'URL must start with http or https'\n-    );\n-    cy.get('[data-cy=\"portfolio-url\"]').clear().type('http://google.com');\n-\n-    cy.get('[data-cy=\"portfolio-image\"]').type('hello');\n-    cy.get('[data-cy=\"validation-message\"]').contains(\n-      'URL must start with http or https'\n-    );\n-    cy.get('[data-cy=\"portfolio-image\"]')\n-      .clear()\n-      .type(\n-        'https://cdn.freecodecamp.org/curriculum/cat-photo-app/lasagna.jpg'\n-      );\n-\n-    cy.get('[data-cy=\"portfolio-description\"]').type(\n-      'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod metus velit, vel accumsan lorem facilisis ac. Maecenas vitae ultrices dolor. Fusce in lobortis arcu, vel congue risus. Sed id neque nec nibh hendrerit bibendum. Integer venenatie.'\n-    );\n-    cy.get('[data-cy=\"validation-message\"]').contains(\n-      'There is a maximum limit of 288 characters, you have 40 left'\n-    );\n-\n-    cy.get('[data-cy=\"portfolio-description\"]').type(\n-      'Lorem ipsum dolor sit amet, consecteturs.'\n-    );\n-    cy.get('[data-cy=\"validation-message\"]').contains(\n-      'There is a maximum limit of 288 characters, you have 0 left'\n-    );\n-\n-    cy.get('button')\n-      .contains('Save this portfolio item')\n-      .should('not.be.disabled');\n-\n-    cy.get('[data-cy=\"portfolio-description\"]').type('{backspace}');\n-    cy.get('button[type=submit]').contains('Save this portfolio item').click();\n-  });\n-});"
        },
        {
            "sha": "f0c102f100fa3ba47ddb36e956c183e2c172d1b4",
            "filename": "e2e/portfolio.spec.ts",
            "status": "added",
            "additions": 143,
            "deletions": 0,
            "changes": 143,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/d11090b41d8b25ec49e7f83705a47990c769cc29/e2e%2Fportfolio.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/d11090b41d8b25ec49e7f83705a47990c769cc29/e2e%2Fportfolio.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fportfolio.spec.ts?ref=d11090b41d8b25ec49e7f83705a47990c769cc29",
            "patch": "@@ -0,0 +1,143 @@\n+import { execSync } from 'child_process';\n+import { test, expect } from '@playwright/test';\n+import translations from '../client/i18n/locales/english/translations.json';\n+\n+test.use({ storageState: 'playwright/.auth/development-user.json' });\n+\n+test.beforeAll(() => {\n+  execSync('node ./tools/scripts/seed/seed-demo-user');\n+});\n+\n+test.afterAll(() => {\n+  execSync('node ./tools/scripts/seed/seed-demo-user certified-user');\n+});\n+\n+test.describe('Add Portfolio Item', () => {\n+  test.beforeEach(async ({ page }) => {\n+    await page.goto('/settings');\n+  });\n+\n+  test('The title has validation', async ({ page }) => {\n+    await page\n+      .getByRole('button', { name: 'Add a new portfolio Item' })\n+      .click();\n+    await page.getByLabel(translations.settings.labels.title).fill('T');\n+    await expect(page.getByTestId('title-validation')).toContainText(\n+      'Title is too short'\n+    );\n+\n+    await page\n+      .getByLabel(translations.settings.labels.title)\n+      .fill(\n+        'This is the longest title you will ever see in your entire life, you will never see such a long title again. This is the longest title in existen'\n+      );\n+    await expect(page.getByTestId('title-validation')).toContainText(\n+      'Title is too long'\n+    );\n+    await page\n+      .getByLabel(translations.settings.labels.title)\n+      .fill('My portfolio');\n+    await expect(page.getByTestId('title-validation')).toBeHidden();\n+  });\n+\n+  test('The url has validation', async ({ page }) => {\n+    await page\n+      .getByRole('button', { name: 'Add a new portfolio Item' })\n+      .click();\n+    await page.getByLabel(translations.settings.labels.url).fill('T');\n+    await expect(page.getByTestId('url-validation')).toContainText(\n+      'Please use a valid URL'\n+    );\n+    await page\n+      .getByLabel(translations.settings.labels.url)\n+      .fill('http://helloworld.com');\n+    await expect(page.getByTestId('url-validation')).toBeHidden();\n+  });\n+\n+  test('The image has validation', async ({ page }) => {\n+    await page\n+      .getByRole('button', { name: 'Add a new portfolio Item' })\n+      .click();\n+    await page.getByLabel(translations.settings.labels.image).fill('T');\n+    await expect(page.getByTestId('image-validation')).toContainText(\n+      'URL must link directly to an image file'\n+    );\n+    await page\n+      .getByLabel(translations.settings.labels.image)\n+      .fill('http://helloworld.com/image.png');\n+    await expect(page.getByTestId('image-validation')).toBeHidden();\n+  });\n+\n+  test('The description has validation', async ({ page }) => {\n+    await page\n+      .getByRole('button', { name: 'Add a new portfolio Item' })\n+      .click();\n+    await page\n+      .getByLabel(translations.settings.labels.description)\n+      .fill(\n+        'This is the longest description you will ever see in your entire life, you will never see such a long description again. This is the longest description in existence. Nothing will ever come close to be being so long again in the entire history of the world. I only have 30 characters left.'\n+      );\n+    await expect(page.getByTestId('description-validation')).toContainText(\n+      'There is a maximum limit of 288 characters, you have 0 left'\n+    );\n+    await page\n+      .getByLabel(translations.settings.labels.description)\n+      .fill('My description');\n+    await expect(page.getByTestId('description-validation')).toBeHidden();\n+  });\n+\n+  test('It should be possible to delete a portfolio item', async ({ page }) => {\n+    await page\n+      .getByRole('button', { name: 'Add a new portfolio Item' })\n+      .click();\n+    await page\n+      .getByLabel(translations.settings.labels.title)\n+      .fill('My portfolio');\n+    await page\n+      .getByLabel(translations.settings.labels.url)\n+      .fill('https://my-portfolio.com');\n+    await page\n+      .getByLabel(translations.settings.labels.image)\n+      .fill('https://my-portfolio.com/image.png');\n+    await page\n+      .getByLabel(translations.settings.labels.description)\n+      .fill('My description');\n+\n+    await page\n+      .getByRole('button', { name: 'Remove this portfolio item' })\n+      .click();\n+\n+    await expect(page.getByTestId('portfolio-items')).toBeHidden();\n+  });\n+\n+  test('It should be possible to add a portfolio item', async ({ page }) => {\n+    await page\n+      .getByRole('button', { name: 'Add a new portfolio Item' })\n+      .click();\n+    await expect(\n+      page.getByRole('button', { name: 'Add a new portfolio Item' })\n+    ).toBeDisabled();\n+\n+    await page\n+      .getByLabel(translations.settings.labels.title)\n+      .fill('My portfolio');\n+    await page\n+      .getByLabel(translations.settings.labels.url)\n+      .fill('https://my-portfolio.com');\n+    await page\n+      .getByLabel(translations.settings.labels.image)\n+      .fill('https://my-portfolio.com/image.png');\n+    await page\n+      .getByLabel(translations.settings.labels.description)\n+      .fill('My description');\n+\n+    await page\n+      .getByRole('button', { name: 'Save this portfolio item' })\n+      .click();\n+    await expect(page.getByTestId('flash-message')).toContainText(\n+      /We have updated your portfolio/\n+    );\n+  });\n+\n+  // TODO: Add test for viewing portfolio item\n+});"
        },
        {
            "sha": "38feac89c806e16d413576023fc03253e589e8fc",
            "filename": "e2e/settings.spec.ts",
            "status": "modified",
            "additions": 0,
            "deletions": 49,
            "changes": 49,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/d11090b41d8b25ec49e7f83705a47990c769cc29/e2e%2Fsettings.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/d11090b41d8b25ec49e7f83705a47990c769cc29/e2e%2Fsettings.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fsettings.spec.ts?ref=d11090b41d8b25ec49e7f83705a47990c769cc29",
            "patch": "@@ -186,55 +186,6 @@ test.describe('Settings', () => {\n     await expect(saveButton).toBeVisible();\n   });\n \n-  test('Should validate Portfolio Settings', async ({ page }) => {\n-    await expect(\n-      page.getByRole('heading', {\n-        name: translations.settings.headings.portfolio\n-      })\n-    ).toBeVisible();\n-    await expect(\n-      page.getByText(translations.settings['share-projects'])\n-    ).toBeVisible();\n-    const addPortfolioButton = page.getByText(\n-      translations.buttons['add-portfolio']\n-    );\n-    await expect(addPortfolioButton).toBeVisible();\n-    await addPortfolioButton.click();\n-    await expect(addPortfolioButton).toBeDisabled(); // Add button should be disabled after clicking\n-    const portfolioItems = page.getByTestId(settingsTestIds.portfolioItems);\n-    await expect(portfolioItems).toBeVisible();\n-    const saveButton = page.getByRole('button', {\n-      name: translations.buttons['save-portfolio']\n-    });\n-    await expect(saveButton).toBeVisible();\n-    await expect(saveButton).toBeDisabled();\n-    const removeButton = page.getByRole('button', {\n-      name: translations.buttons['remove-portfolio']\n-    });\n-    await expect(removeButton).toBeVisible();\n-    await page\n-      .getByLabel(translations.settings.labels.title)\n-      .fill('My portfolio');\n-    await page\n-      .getByLabel(translations.settings.labels.url)\n-      .fill('https://my-portfolio.com');\n-    await page\n-      .getByLabel(translations.settings.labels.image)\n-      .fill('https://my-portfolio.com/image.png');\n-    await page\n-      .getByLabel(translations.settings.labels.description)\n-      .fill('My description');\n-    await saveButton.click();\n-    await expect(\n-      page.getByText(translations.flash['portfolio-item-updated'])\n-    ).toBeVisible();\n-    await removeButton.click();\n-    await expect(addPortfolioButton).toBeEnabled();\n-    await expect(portfolioItems).toBeHidden();\n-    await expect(saveButton).toBeHidden();\n-    await expect(removeButton).toBeHidden();\n-  });\n-\n   test('Should validate Personal Information Settings', async ({ page }) => {\n     await expect(\n       page.getByRole('heading', {"
        }
    ],
    "stats": {
        "total": 271,
        "additions": 158,
        "deletions": 113
    }
}