{
    "author": "moT01",
    "message": "fix(client): use Link component for block links (#63559)",
    "sha": "1bacf09dd559ca59db28e8e08a1fee0856f7f321",
    "files": [
        {
            "sha": "bafa7cf8f058085607c86ecab998c64c5570bc7a",
            "filename": "client/src/templates/Introduction/components/block-header.test.tsx",
            "status": "added",
            "additions": 173,
            "deletions": 0,
            "changes": 173,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/1bacf09dd559ca59db28e8e08a1fee0856f7f321/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock-header.test.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/1bacf09dd559ca59db28e8e08a1fee0856f7f321/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock-header.test.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock-header.test.tsx?ref=1bacf09dd559ca59db28e8e08a1fee0856f7f321",
            "patch": "@@ -0,0 +1,173 @@\n+import React from 'react';\n+import { render, screen } from '@testing-library/react';\n+import { describe, it, expect, vi } from 'vitest';\n+\n+import BlockHeader from './block-header';\n+\n+const defaultProps = {\n+  blockDashed: 'test-block',\n+  blockTitle: 'Test Block Title',\n+  blockLabel: null,\n+  courseCompletionStatus: '50% completed',\n+  completedCount: 5,\n+  handleClick: vi.fn(),\n+  isCompleted: false,\n+  isExpanded: false,\n+  percentageCompleted: 50,\n+  blockIntroArr: ['Introduction paragraph 1', 'Introduction paragraph 2'],\n+  accordion: false\n+};\n+\n+describe('<BlockHeader />', () => {\n+  it('should render as a button with aria-expanded and aria-controls when not a link', () => {\n+    render(<BlockHeader {...defaultProps} />);\n+\n+    const button = screen.getByRole('button');\n+    expect(button).toBeInTheDocument();\n+    expect(button).toHaveAttribute('aria-expanded', 'false');\n+    expect(button).toHaveAttribute('aria-controls', 'test-block-panel');\n+  });\n+\n+  it('should render as a link without aria-expanded and aria-controls when blockUrl is provided in accordion mode', () => {\n+    render(\n+      <BlockHeader\n+        {...defaultProps}\n+        accordion={true}\n+        blockUrl='/learn/test-block'\n+      />\n+    );\n+\n+    const link = screen.getByRole('link');\n+    expect(link).toBeInTheDocument();\n+    expect(link).toHaveAttribute('href', '/learn/test-block');\n+    expect(link).not.toHaveAttribute('aria-expanded');\n+    expect(link).not.toHaveAttribute('aria-controls');\n+  });\n+\n+  it('should set aria-expanded to true when isExpanded is true', () => {\n+    render(<BlockHeader {...defaultProps} isExpanded={true} />);\n+\n+    const button = screen.getByRole('button');\n+    expect(button).toHaveAttribute('aria-expanded', 'true');\n+  });\n+\n+  it('should display the block title', () => {\n+    render(<BlockHeader {...defaultProps} />);\n+\n+    expect(screen.getByText('Test Block Title')).toBeInTheDocument();\n+  });\n+\n+  it('should display the course completion status in sr-only text', () => {\n+    render(<BlockHeader {...defaultProps} />);\n+\n+    expect(screen.getByText(', 50% completed')).toBeInTheDocument();\n+  });\n+\n+  it('should show progress percentage when not expanded, not completed, and has completed challenges', () => {\n+    render(\n+      <BlockHeader\n+        {...defaultProps}\n+        isExpanded={false}\n+        isCompleted={false}\n+        completedCount={5}\n+      />\n+    );\n+\n+    expect(screen.getByText('50%')).toBeInTheDocument();\n+  });\n+\n+  it('should not show progress percentage when in accordion mode', () => {\n+    render(\n+      <BlockHeader\n+        {...defaultProps}\n+        accordion={true}\n+        isExpanded={false}\n+        isCompleted={false}\n+        completedCount={5}\n+      />\n+    );\n+\n+    expect(screen.queryByText('50%')).not.toBeInTheDocument();\n+  });\n+\n+  it('should not show progress percentage when expanded', () => {\n+    render(\n+      <BlockHeader\n+        {...defaultProps}\n+        isExpanded={true}\n+        isCompleted={false}\n+        completedCount={5}\n+      />\n+    );\n+\n+    expect(screen.queryByText('50%')).not.toBeInTheDocument();\n+  });\n+\n+  it('should not show progress percentage when completed', () => {\n+    render(\n+      <BlockHeader\n+        {...defaultProps}\n+        isExpanded={false}\n+        isCompleted={true}\n+        completedCount={10}\n+      />\n+    );\n+\n+    expect(screen.queryByText('50%')).not.toBeInTheDocument();\n+  });\n+\n+  it('should not show progress percentage when no challenges completed', () => {\n+    render(\n+      <BlockHeader\n+        {...defaultProps}\n+        isExpanded={false}\n+        isCompleted={false}\n+        completedCount={0}\n+      />\n+    );\n+\n+    expect(screen.queryByText('50%')).not.toBeInTheDocument();\n+  });\n+\n+  it('should render BlockIntros when expanded and blockIntroArr is provided', () => {\n+    render(<BlockHeader {...defaultProps} isExpanded={true} />);\n+\n+    expect(screen.getByText('Introduction paragraph 1')).toBeInTheDocument();\n+    expect(screen.getByText('Introduction paragraph 2')).toBeInTheDocument();\n+  });\n+\n+  it('should not render BlockIntros when not expanded', () => {\n+    render(<BlockHeader {...defaultProps} isExpanded={false} />);\n+\n+    expect(\n+      screen.queryByText('Introduction paragraph 1')\n+    ).not.toBeInTheDocument();\n+    expect(\n+      screen.queryByText('Introduction paragraph 2')\n+    ).not.toBeInTheDocument();\n+  });\n+\n+  it('should not render BlockIntros when blockIntroArr is empty', () => {\n+    render(\n+      <BlockHeader {...defaultProps} isExpanded={true} blockIntroArr={[]} />\n+    );\n+\n+    expect(\n+      screen.queryByText('Introduction paragraph 1')\n+    ).not.toBeInTheDocument();\n+  });\n+\n+  it('should not render BlockIntros when blockIntroArr is undefined', () => {\n+    render(\n+      <BlockHeader\n+        {...defaultProps}\n+        isExpanded={true}\n+        blockIntroArr={undefined}\n+      />\n+    );\n+\n+    expect(\n+      screen.queryByText('Introduction paragraph 1')\n+    ).not.toBeInTheDocument();\n+  });\n+});"
        },
        {
            "sha": "517fa33f217bf72a91c04283f670f42d495971bf",
            "filename": "client/src/templates/Introduction/components/block-header.tsx",
            "status": "modified",
            "additions": 40,
            "deletions": 32,
            "changes": 72,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/1bacf09dd559ca59db28e8e08a1fee0856f7f321/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock-header.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/1bacf09dd559ca59db28e8e08a1fee0856f7f321/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock-header.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock-header.tsx?ref=1bacf09dd559ca59db28e8e08a1fee0856f7f321",
            "patch": "@@ -1,6 +1,7 @@\n import React from 'react';\n import { isEmpty } from 'lodash';\n import { Button } from '@freecodecamp/ui';\n+import { Link } from '../../../components/helpers';\n \n import type { BlockLabel as BlockLabelType } from '../../../../../shared-dist/config/blocks';\n import { ProgressBar } from '../../../components/Progress/progress-bar';\n@@ -38,41 +39,48 @@ function BlockHeader({\n   accordion,\n   blockUrl\n }: BlockHeaderProps): JSX.Element {\n+  const InnerBlockHeader = () => (\n+    <>\n+      <span className='block-header-button-text map-title'>\n+        {accordion &&\n+          (blockUrl ? <span className='aligner-dash'></span> : <DropDown />)}\n+        <CheckMark isCompleted={isCompleted} />\n+        {!accordion && blockLabel && <BlockLabel blockLabel={blockLabel} />}\n+        <span>\n+          {blockTitle}\n+          <span className='sr-only'>, {courseCompletionStatus}</span>\n+        </span>\n+        {accordion && blockLabel && <BlockLabel blockLabel={blockLabel} />}\n+        {!accordion && <DropDown />}\n+      </span>\n+      {!accordion && !isExpanded && !isCompleted && completedCount > 0 && (\n+        <div aria-hidden='true' className='progress-wrapper'>\n+          <div>\n+            <ProgressBar now={percentageCompleted} />\n+          </div>\n+          <span>{`${percentageCompleted}%`}</span>\n+        </div>\n+      )}\n+    </>\n+  );\n+\n   return (\n     <>\n       <h3 className='block-grid-title'>\n-        <Button\n-          aria-expanded={isExpanded ? 'true' : 'false'}\n-          aria-controls={`${blockDashed}-panel`}\n-          className='block-header'\n-          onClick={handleClick}\n-          {...(accordion && blockUrl ? { href: blockUrl } : {})}\n-        >\n-          <span className='block-header-button-text map-title'>\n-            {accordion &&\n-              (blockUrl ? (\n-                <span className='aligner-dash'></span>\n-              ) : (\n-                <DropDown />\n-              ))}\n-            <CheckMark isCompleted={isCompleted} />\n-            {!accordion && blockLabel && <BlockLabel blockLabel={blockLabel} />}\n-            <span>\n-              {blockTitle}\n-              <span className='sr-only'>, {courseCompletionStatus}</span>\n-            </span>\n-            {accordion && blockLabel && <BlockLabel blockLabel={blockLabel} />}\n-            {!accordion && <DropDown />}\n-          </span>\n-          {!accordion && !isExpanded && !isCompleted && completedCount > 0 && (\n-            <div aria-hidden='true' className='progress-wrapper'>\n-              <div>\n-                <ProgressBar now={percentageCompleted} />\n-              </div>\n-              <span>{`${percentageCompleted}%`}</span>\n-            </div>\n-          )}\n-        </Button>\n+        {accordion && blockUrl ? (\n+          <Link className='block-header' to={blockUrl}>\n+            <InnerBlockHeader />\n+          </Link>\n+        ) : (\n+          <Button\n+            aria-expanded={isExpanded ? 'true' : 'false'}\n+            aria-controls={`${blockDashed}-panel`}\n+            className='block-header'\n+            onClick={handleClick}\n+          >\n+            <InnerBlockHeader />\n+          </Button>\n+        )}\n       </h3>\n       {isExpanded && !isEmpty(blockIntroArr) && (\n         <BlockIntros intros={blockIntroArr as string[]} />"
        }
    ],
    "stats": {
        "total": 245,
        "additions": 213,
        "deletions": 32
    }
}