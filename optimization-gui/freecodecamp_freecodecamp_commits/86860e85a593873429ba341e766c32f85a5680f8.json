{
    "author": "ojeytonwilliams",
    "message": "test(e2e): allow testing of multiple users (#54752)",
    "sha": "86860e85a593873429ba341e766c32f85a5680f8",
    "files": [
        {
            "sha": "92143d7cf7fef9674eb7eae0fcdce237b4408a46",
            "filename": "e2e/global-setup.ts",
            "status": "modified",
            "additions": 28,
            "deletions": 6,
            "changes": 34,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/86860e85a593873429ba341e766c32f85a5680f8/e2e%2Fglobal-setup.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/86860e85a593873429ba341e766c32f85a5680f8/e2e%2Fglobal-setup.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fglobal-setup.ts?ref=86860e85a593873429ba341e766c32f85a5680f8",
            "patch": "@@ -1,9 +1,31 @@\n+import { execSync } from 'child_process';\n+\n import { test as setup } from '@playwright/test';\n \n-setup('Login', async ({ page }) => {\n-  await page.goto('/');\n-  await page.getByRole('link', { name: 'Sign in' }).click();\n-  await page\n-    .context()\n-    .storageState({ path: 'playwright/.auth/certified-user.json' });\n+setup.describe('certifieduser', () => {\n+  setup('can sign in', async ({ request }) => {\n+    await request.get(process.env.API_LOCATION + '/signin');\n+    await request.storageState({\n+      path: 'playwright/.auth/certified-user.json'\n+    });\n+  });\n+});\n+\n+setup.describe('developmentuser', () => {\n+  // We can only sign in as a single user (one with email: 'foo@bar.com'), so\n+  // changing users means changing the record with that email in the database.\n+  setup.beforeAll(() => {\n+    execSync('node ./tools/scripts/seed/seed-demo-user');\n+  });\n+\n+  setup.afterAll(() => {\n+    execSync('node ./tools/scripts/seed/seed-demo-user certified-user');\n+  });\n+\n+  setup('can sign in', async ({ request }) => {\n+    await request.get(process.env.API_LOCATION + '/signin');\n+    await request.storageState({\n+      path: 'playwright/.auth/development-user.json'\n+    });\n+  });\n });"
        },
        {
            "sha": "753fe011925ee6e8fe3e62456274eb659b28c6e3",
            "filename": "e2e/signin.spec.ts",
            "status": "added",
            "additions": 13,
            "deletions": 0,
            "changes": 13,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/86860e85a593873429ba341e766c32f85a5680f8/e2e%2Fsignin.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/86860e85a593873429ba341e766c32f85a5680f8/e2e%2Fsignin.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fsignin.spec.ts?ref=86860e85a593873429ba341e766c32f85a5680f8",
            "patch": "@@ -0,0 +1,13 @@\n+import { test, expect } from '@playwright/test';\n+\n+test.describe('signing in', () => {\n+  test('welcomes the user', async ({ page }) => {\n+    const welcomeText = 'Welcome back, Full Stack User.';\n+    await page.goto('/');\n+    await expect(page.getByText(welcomeText)).not.toBeVisible();\n+\n+    await page.getByRole('link', { name: 'Sign in' }).click();\n+\n+    await expect(page.getByText(welcomeText)).toBeVisible();\n+  });\n+});"
        }
    ],
    "stats": {
        "total": 47,
        "additions": 41,
        "deletions": 6
    }
}