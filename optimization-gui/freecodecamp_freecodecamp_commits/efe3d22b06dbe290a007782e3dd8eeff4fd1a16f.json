{
    "author": "ojeytonwilliams",
    "message": "fix: make sure ext curriculum tests fail if missing meta (#61904)",
    "sha": "efe3d22b06dbe290a007782e3dd8eeff4fd1a16f",
    "files": [
        {
            "sha": "9988bdbc5ca935411c54066a63a21ace61db308a",
            "filename": "tools/scripts/build/build-external-curricula-data-v1.test.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 2,
            "changes": 12,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/efe3d22b06dbe290a007782e3dd8eeff4fd1a16f/tools%2Fscripts%2Fbuild%2Fbuild-external-curricula-data-v1.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/efe3d22b06dbe290a007782e3dd8eeff4fd1a16f/tools%2Fscripts%2Fbuild%2Fbuild-external-curricula-data-v1.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fscripts%2Fbuild%2Fbuild-external-curricula-data-v1.test.ts?ref=efe3d22b06dbe290a007782e3dd8eeff4fd1a16f",
            "patch": "@@ -72,14 +72,18 @@ ${result.error.message}`\n       await readdirp.promise(`${clientStaticPath}/curriculum-data/${VERSION}`, {\n         directoryFilter: ['!challenges'],\n         fileFilter: entry => {\n+          // path without extension:\n+          const filePath = entry.path.replace(/\\.json$/, '');\n           // The directory contains super block files and other curriculum-related files.\n           // We're only interested in super block ones.\n           const superBlocks = Object.values(SuperBlocks);\n-          return superBlocks.includes(entry.basename);\n+          return superBlocks.includes(filePath);\n         }\n       })\n     ).map(file => file.path);\n \n+    expect(fileArray.length).toBeGreaterThan(0);\n+\n     fileArray.forEach(fileInArray => {\n       const fileContent = fs.readFileSync(\n         `${clientStaticPath}/curriculum-data/${VERSION}/${fileInArray}`,\n@@ -100,14 +104,18 @@ ${result.error.message}`);\n       await readdirp.promise(`${clientStaticPath}/curriculum-data/${VERSION}`, {\n         directoryFilter: ['!challenges'],\n         fileFilter: entry => {\n+          // path without extension:\n+          const filePath = entry.path.replace(/\\.json$/, '');\n           // The directory contains super block files and other curriculum-related files.\n           // We're only interested in super block ones.\n           const superBlocks = Object.values(SuperBlocks);\n-          return superBlocks.includes(entry.basename);\n+          return superBlocks.includes(filePath);\n         }\n       })\n     ).map(file => file.path);\n \n+    expect(superBlockFiles.length).toBeGreaterThan(0);\n+\n     superBlockFiles.forEach(file => {\n       const fileContentJson = fs.readFileSync(\n         `${clientStaticPath}/curriculum-data/${VERSION}/${file}`,"
        },
        {
            "sha": "e09c7727ff72cd8824a8652a0075494d381159d1",
            "filename": "tools/scripts/build/external-data-schema-v1.js",
            "status": "modified",
            "additions": 62,
            "deletions": 57,
            "changes": 119,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/efe3d22b06dbe290a007782e3dd8eeff4fd1a16f/tools%2Fscripts%2Fbuild%2Fexternal-data-schema-v1.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/efe3d22b06dbe290a007782e3dd8eeff4fd1a16f/tools%2Fscripts%2Fbuild%2Fexternal-data-schema-v1.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fscripts%2Fbuild%2Fexternal-data-schema-v1.js?ref=efe3d22b06dbe290a007782e3dd8eeff4fd1a16f",
            "patch": "@@ -2,63 +2,68 @@ const Joi = require('joi');\n \n const blockSchema = Joi.object({}).keys({\n   desc: Joi.array().min(1),\n-  challenges: Joi.object({}).keys({\n-    name: Joi.string().required(),\n-    isUpcomingChange: Joi.bool().required(),\n-    usesMultifileEditor: Joi.bool().optional(),\n-    hasEditableBoundaries: Joi.bool().optional(),\n-    dashedName: Joi.string().required(),\n-    helpCategory: Joi.valid(\n-      'JavaScript',\n-      'HTML-CSS',\n-      'Python',\n-      'Backend Development',\n-      'C-Sharp',\n-      'English',\n-      'Odin',\n-      'Euler',\n-      'Rosetta'\n-    ).required(),\n-    order: Joi.number().when('superBlock', {\n-      is: 'full-stack-developer',\n-      then: Joi.forbidden(),\n-      otherwise: Joi.required()\n-    }),\n-    template: Joi.string().allow(''),\n-    required: Joi.array(),\n-    superBlock: Joi.string().required(),\n-    blockLayout: Joi.valid(\n-      'challenge-list',\n-      'challenge-grid',\n-      'dialogue-grid',\n-      'link',\n-      'project-list',\n-      'legacy-challenge-list',\n-      'legacy-link',\n-      'legacy-challenge-grid'\n-    ).required(),\n-    blockType: Joi.valid(\n-      'lecture',\n-      'workshop',\n-      'lab',\n-      'review',\n-      'quiz',\n-      'exam'\n-    ).when('superBlock', {\n-      is: 'full-stack-developer',\n-      then: Joi.required(),\n-      otherwise: Joi.optional()\n-    }),\n-    challengeOrder: Joi.array().items(\n-      Joi.object({}).keys({\n-        id: Joi.string(),\n-        title: Joi.string()\n-      })\n-    ),\n-    disableLoopProtectTests: Joi.boolean(),\n-    disableLoopProtectPreview: Joi.boolean(),\n-    superOrder: Joi.number()\n-  })\n+  challenges: Joi.object({})\n+    .keys({\n+      name: Joi.string().required(),\n+      isUpcomingChange: Joi.bool().required(),\n+      usesMultifileEditor: Joi.bool().optional(),\n+      hasEditableBoundaries: Joi.bool().optional(),\n+      dashedName: Joi.string().required(),\n+      helpCategory: Joi.valid(\n+        'JavaScript',\n+        'HTML-CSS',\n+        'Python',\n+        'Backend Development',\n+        'C-Sharp',\n+        'English',\n+        'Odin',\n+        'Euler',\n+        'Rosetta'\n+      ).required(),\n+      order: Joi.number().when('superBlock', {\n+        is: 'full-stack-developer',\n+        then: Joi.forbidden(),\n+        otherwise: Joi.required()\n+      }),\n+      template: Joi.string().allow(''),\n+      required: Joi.array(),\n+      superBlock: Joi.string().required(),\n+      blockLayout: Joi.valid(\n+        'challenge-list',\n+        'challenge-grid',\n+        'dialogue-grid',\n+        'link',\n+        'project-list',\n+        'legacy-challenge-list',\n+        'legacy-link',\n+        'legacy-challenge-grid'\n+      ).required(),\n+      blockType: Joi.valid(\n+        'lecture',\n+        'workshop',\n+        'lab',\n+        'review',\n+        'quiz',\n+        'exam'\n+      ).when('superBlock', {\n+        is: 'full-stack-developer',\n+        then: Joi.required(),\n+        otherwise: Joi.optional()\n+      }),\n+      challengeOrder: Joi.array()\n+        .items(\n+          Joi.object({}).keys({\n+            id: Joi.string(),\n+            title: Joi.string()\n+          })\n+        )\n+        .min(1)\n+        .required(),\n+      disableLoopProtectTests: Joi.boolean(),\n+      disableLoopProtectPreview: Joi.boolean(),\n+      superOrder: Joi.number()\n+    })\n+    .required()\n });\n \n const subSchema = Joi.object({}).keys({"
        },
        {
            "sha": "68e5447999b0ffae603a67f4deee891411768cd6",
            "filename": "tools/scripts/build/external-data-schema-v2.js",
            "status": "modified",
            "additions": 62,
            "deletions": 57,
            "changes": 119,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/efe3d22b06dbe290a007782e3dd8eeff4fd1a16f/tools%2Fscripts%2Fbuild%2Fexternal-data-schema-v2.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/efe3d22b06dbe290a007782e3dd8eeff4fd1a16f/tools%2Fscripts%2Fbuild%2Fexternal-data-schema-v2.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fscripts%2Fbuild%2Fexternal-data-schema-v2.js?ref=efe3d22b06dbe290a007782e3dd8eeff4fd1a16f",
            "patch": "@@ -7,63 +7,68 @@ const slugRE = new RegExp('^[a-z0-9-]+$');\n \n const blockSchema = Joi.object().keys({\n   intro: Joi.array().min(1),\n-  meta: Joi.object({}).keys({\n-    name: Joi.string().required(),\n-    isUpcomingChange: Joi.bool().required(),\n-    usesMultifileEditor: Joi.bool().optional(),\n-    hasEditableBoundaries: Joi.bool().optional(),\n-    dashedName: Joi.string().required(),\n-    helpCategory: Joi.valid(\n-      'JavaScript',\n-      'HTML-CSS',\n-      'Python',\n-      'Backend Development',\n-      'C-Sharp',\n-      'English',\n-      'Odin',\n-      'Euler',\n-      'Rosetta'\n-    ).required(),\n-    order: Joi.number().when('superBlock', {\n-      is: chapterBasedSuperBlocks,\n-      then: Joi.forbidden(),\n-      otherwise: Joi.required()\n-    }),\n-    template: Joi.string().allow(''),\n-    required: Joi.array(),\n-    superBlock: Joi.string().required(),\n-    blockLayout: Joi.valid(\n-      'challenge-list',\n-      'challenge-grid',\n-      'dialogue-grid',\n-      'link',\n-      'project-list',\n-      'legacy-challenge-list',\n-      'legacy-link',\n-      'legacy-challenge-grid'\n-    ).required(),\n-    blockType: Joi.valid(\n-      'lecture',\n-      'workshop',\n-      'lab',\n-      'review',\n-      'quiz',\n-      'exam'\n-    ).when('superBlock', {\n-      is: chapterBasedSuperBlocks,\n-      then: Joi.required(),\n-      otherwise: Joi.optional()\n-    }),\n-    challengeOrder: Joi.array().items(\n-      Joi.object({}).keys({\n-        id: Joi.string(),\n-        title: Joi.string()\n-      })\n-    ),\n-    disableLoopProtectTests: Joi.boolean(),\n-    disableLoopProtectPreview: Joi.boolean(),\n-    superOrder: Joi.number()\n-  })\n+  meta: Joi.object({})\n+    .keys({\n+      name: Joi.string().required(),\n+      isUpcomingChange: Joi.bool().required(),\n+      usesMultifileEditor: Joi.bool().optional(),\n+      hasEditableBoundaries: Joi.bool().optional(),\n+      dashedName: Joi.string().required(),\n+      helpCategory: Joi.valid(\n+        'JavaScript',\n+        'HTML-CSS',\n+        'Python',\n+        'Backend Development',\n+        'C-Sharp',\n+        'English',\n+        'Odin',\n+        'Euler',\n+        'Rosetta'\n+      ).required(),\n+      order: Joi.number().when('superBlock', {\n+        is: chapterBasedSuperBlocks,\n+        then: Joi.forbidden(),\n+        otherwise: Joi.required()\n+      }),\n+      template: Joi.string().allow(''),\n+      required: Joi.array(),\n+      superBlock: Joi.string().required(),\n+      blockLayout: Joi.valid(\n+        'challenge-list',\n+        'challenge-grid',\n+        'dialogue-grid',\n+        'link',\n+        'project-list',\n+        'legacy-challenge-list',\n+        'legacy-link',\n+        'legacy-challenge-grid'\n+      ).required(),\n+      blockType: Joi.valid(\n+        'lecture',\n+        'workshop',\n+        'lab',\n+        'review',\n+        'quiz',\n+        'exam'\n+      ).when('superBlock', {\n+        is: chapterBasedSuperBlocks,\n+        then: Joi.required(),\n+        otherwise: Joi.optional()\n+      }),\n+      challengeOrder: Joi.array().items(\n+        Joi.object({})\n+          .keys({\n+            id: Joi.string(),\n+            title: Joi.string()\n+          })\n+          .min(1)\n+          .required()\n+      ),\n+      disableLoopProtectTests: Joi.boolean(),\n+      disableLoopProtectPreview: Joi.boolean(),\n+      superOrder: Joi.number()\n+    })\n+    .required()\n });\n \n const blockBasedCurriculumSchema = Joi.object().pattern("
        }
    ],
    "stats": {
        "total": 250,
        "additions": 134,
        "deletions": 116
    }
}