{
    "author": "ojeytonwilliams",
    "message": "refactor(e2e): test urls can have trailing slashes (#58283)",
    "sha": "8a852719f14d6be7117b29e2490cef5cef42e62d",
    "files": [
        {
            "sha": "063639d87d06cdc4ec71c9f5df233c9afc3f7d60",
            "filename": "e2e/completion-modal.spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fcompletion-modal.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fcompletion-modal.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fcompletion-modal.spec.ts?ref=8a852719f14d6be7117b29e2490cef5cef42e62d",
            "patch": "@@ -1,6 +1,7 @@\n import { test, expect } from '@playwright/test';\n import translations from '../client/i18n/locales/english/translations.json';\n import { authedRequest } from './utils/request';\n+import { allowTrailingSlash } from './utils/url';\n \n const nextChallengeURL =\n   '/learn/data-analysis-with-python/data-analysis-with-python-projects/demographic-data-analyzer';\n@@ -72,7 +73,7 @@ test.describe('Challenge Completion Modal Tests (Signed Out)', () => {\n     await page\n       .getByRole('link', { name: translations.learn['sign-in-save'] })\n       .click();\n-    await expect(page).toHaveURL(/.*\\/learn\\/?$/);\n+    await expect(page).toHaveURL(allowTrailingSlash('/learn'));\n   });\n \n   test('should redirect to next challenge', async ({ page }) => {"
        },
        {
            "sha": "7d060dc44be96c8866074aadbad8464b88fd6263",
            "filename": "e2e/delete-modal.spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fdelete-modal.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fdelete-modal.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fdelete-modal.spec.ts?ref=8a852719f14d6be7117b29e2490cef5cef42e62d",
            "patch": "@@ -5,6 +5,7 @@ import { test, expect } from '@playwright/test';\n \n import translations from '../client/i18n/locales/english/translations.json';\n import { alertToBeVisible } from './utils/alerts';\n+import { allowTrailingSlash } from './utils/url';\n \n const execP = promisify(exec);\n \n@@ -145,7 +146,7 @@ test.describe('Delete Modal component', () => {\n       })\n     ).not.toBeVisible();\n \n-    await expect(page).toHaveURL(/.*\\/learn\\/?/);\n+    await expect(page).toHaveURL(allowTrailingSlash('/learn'));\n     await alertToBeVisible(page, translations.flash['account-deleted']);\n     // The user is signed out after their account is deleted\n     await expect(page.getByRole('link', { name: 'Sign in' })).toHaveCount(2);"
        },
        {
            "sha": "a5c42d8751654f070ff8d58369056f216ea32a4a",
            "filename": "e2e/donation-modal.spec.ts",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fdonation-modal.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fdonation-modal.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fdonation-modal.spec.ts?ref=8a852719f14d6be7117b29e2490cef5cef42e62d",
            "patch": "@@ -3,6 +3,7 @@ import { test, expect, type Page } from '@playwright/test';\n import { addGrowthbookCookie } from './utils/add-growthbook-cookie';\n \n import { clearEditor, focusEditor } from './utils/editor';\n+import { allowTrailingSlash } from './utils/url';\n \n const slowExpect = expect.configure({ timeout: 25000 });\n \n@@ -22,7 +23,9 @@ const completeFrontEndCert = async (page: Page, number?: number) => {\n   const loopNumber = number || projects.length;\n   for (let i = 0; i < loopNumber; i++) {\n     await page.waitForURL(\n-      `/learn/front-end-development-libraries/front-end-development-libraries-projects/build-a-${projects[i]}`\n+      allowTrailingSlash(\n+        `/learn/front-end-development-libraries/front-end-development-libraries-projects/build-a-${projects[i]}`\n+      )\n     );\n     await page\n       .getByRole('textbox', { name: 'solution' })\n@@ -92,7 +95,7 @@ const completeChallenges = async ({\n }) => {\n   await page.goto(challenges[0].url);\n   for (const challenge of challenges.slice(0, number)) {\n-    await page.waitForURL(challenge.url);\n+    await page.waitForURL(allowTrailingSlash(challenge.url));\n     await focusEditor({ page, isMobile });\n     await clearEditor({ page, browserName });\n     await page.evaluate("
        },
        {
            "sha": "1ee51c19aedf2fdc0f48e057647a66cb84856b1c",
            "filename": "e2e/quincy-email-sign-up.spec.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fquincy-email-sign-up.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fquincy-email-sign-up.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fquincy-email-sign-up.spec.ts?ref=8a852719f14d6be7117b29e2490cef5cef42e62d",
            "patch": "@@ -3,6 +3,7 @@ import { execSync } from 'child_process';\n import { test, expect } from '@playwright/test';\n \n import translations from '../client/i18n/locales/english/translations.json';\n+import { allowTrailingSlash } from './utils/url';\n \n const apiLocation = process.env.API_LOCATION || 'http://localhost:3000';\n \n@@ -73,7 +74,7 @@ test.describe('Email sign-up page when user is not signed in', () => {\n \n     // The user is signed in and automatically redirected to /learn after clicking the button.\n     // We wait for this navigation to complete before moving onto the next.\n-    await page.waitForURL('**/learn');\n+    await page.waitForURL(allowTrailingSlash('/learn'));\n     await expect(\n       page.getByRole('heading', { name: 'Welcome back, Full Stack User' })\n     ).toBeVisible();\n@@ -144,7 +145,7 @@ test.describe('Email sign-up page when user is signed in', () => {\n \n     // The user is signed in and automatically redirected to /learn after clicking the button.\n     // We wait for the navigation to complete.\n-    await page.waitForURL('**/learn');\n+    await page.waitForURL('/learn');\n     await expect(\n       page.getByRole('heading', { name: 'Welcome back, Full Stack User' })\n     ).toBeVisible();\n@@ -180,7 +181,7 @@ test.describe('Email sign-up page when user is signed in', () => {\n \n     // The user is signed in and automatically redirected to /learn after clicking the button.\n     // We wait for the navigation to complete.\n-    await page.waitForURL('**/learn');\n+    await page.waitForURL('/learn');\n     await expect(\n       page.getByRole('heading', { name: 'Welcome back, Full Stack User' })\n     ).toBeVisible();"
        },
        {
            "sha": "b0d333990ff204c5c42358c2705b821e8dbd0598",
            "filename": "e2e/quiz-challenge.spec.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fquiz-challenge.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fquiz-challenge.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fquiz-challenge.spec.ts?ref=8a852719f14d6be7117b29e2490cef5cef42e62d",
            "patch": "@@ -1,4 +1,5 @@\n import { test, expect } from '@playwright/test';\n+import { allowTrailingSlash } from './utils/url';\n \n test.describe('Quiz challenge', () => {\n   test.beforeEach(async ({ page }) => {\n@@ -66,7 +67,9 @@ test.describe('Quiz challenge', () => {\n \n     // The navigation should be blocked, the user should stay on the same page\n     await expect(page).toHaveURL(\n-      '/learn/full-stack-developer/quiz-basic-html/quiz-basic-html'\n+      allowTrailingSlash(\n+        '/learn/full-stack-developer/quiz-basic-html/quiz-basic-html'\n+      )\n     );\n \n     await expect(page.getByRole('dialog')).toBeVisible();"
        },
        {
            "sha": "4b349504a718c3a0a16b806070ed82c793a60ebc",
            "filename": "e2e/redirect.spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fredirect.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fredirect.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fredirect.spec.ts?ref=8a852719f14d6be7117b29e2490cef5cef42e62d",
            "patch": "@@ -1,4 +1,5 @@\n import { test, expect } from '@playwright/test';\n+import { allowTrailingSlash } from './utils/url';\n \n // To run this test locally you will need to run: pnpm run start-ci;\n // Also, make sure that you have pm2 installed globally via: pnpm install -g pm2\n@@ -74,7 +75,7 @@ test.describe('Legacy Challenge Path Redirection Tests', () => {\n   for (const [input, expected] of pathsToTest) {\n     test(`should redirect from ${input} to ${expected}`, async ({ page }) => {\n       await page.goto(input);\n-      await expect(page).toHaveURL(new RegExp(`${expected}/?`));\n+      await expect(page).toHaveURL(allowTrailingSlash(expected));\n     });\n   }\n });"
        },
        {
            "sha": "4c90cc8542c43c8800cb7b409d23da1f2621ec76",
            "filename": "e2e/signout-modal.spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fsignout-modal.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fsignout-modal.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fsignout-modal.spec.ts?ref=8a852719f14d6be7117b29e2490cef5cef42e62d",
            "patch": "@@ -1,5 +1,6 @@\n import { test, expect } from '@playwright/test';\n import translations from '../client/i18n/locales/english/translations.json';\n+import { allowTrailingSlash } from './utils/url';\n \n test.beforeEach(async ({ page }) => {\n   await page.goto('/');\n@@ -49,7 +50,7 @@ test.describe('Signout Modal component', () => {\n     await expect(\n       page.getByRole('dialog', { name: translations.signout.heading })\n     ).not.toBeVisible();\n-    await expect(page).toHaveURL(/.*\\/learn\\/?$/);\n+    await expect(page).toHaveURL(allowTrailingSlash('/learn'));\n   });\n \n   test('closes modal after user cancels signing out', async ({ page }) => {"
        },
        {
            "sha": "5c87322bbb705338faefee5d8d2a02dca7f60397",
            "filename": "e2e/update-email.spec.ts",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fupdate-email.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Fupdate-email.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fupdate-email.spec.ts?ref=8a852719f14d6be7117b29e2490cef5cef42e62d",
            "patch": "@@ -1,5 +1,6 @@\n import { test, expect } from '@playwright/test';\n import translations from '../client/i18n/locales/english/translations.json';\n+import { allowTrailingSlash } from './utils/url';\n \n test.describe('The update-email page when the user is signed in', () => {\n   test.beforeEach(async ({ page }) => {\n@@ -64,7 +65,7 @@ test.describe('The update-email page when the user is not signed in', () => {\n     // Ref: https://github.com/microsoft/playwright/issues/20749\n     test.skip(browserName === 'firefox');\n \n-    await page.waitForURL(/\\/learn\\/?/);\n+    await page.waitForURL(allowTrailingSlash('/learn'));\n \n     await expect(\n       page.getByRole('heading', { name: 'Welcome back, Full Stack User' })"
        },
        {
            "sha": "053061055e1d807dfbd556e513a9cf3be3017ea1",
            "filename": "e2e/utils/url.ts",
            "status": "added",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Futils%2Furl.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8a852719f14d6be7117b29e2490cef5cef42e62d/e2e%2Futils%2Furl.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Futils%2Furl.ts?ref=8a852719f14d6be7117b29e2490cef5cef42e62d",
            "patch": "@@ -0,0 +1 @@\n+export const allowTrailingSlash = (url: string) => RegExp(url + '[/]?$');"
        }
    ],
    "stats": {
        "total": 35,
        "additions": 24,
        "deletions": 11
    }
}