{
    "author": "huyenltnguyen",
    "message": "fix(client): change claim cert link to render as a button (#55781)",
    "sha": "7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92",
    "files": [
        {
            "sha": "914c1aaa0547dfa062a3e48df9e2eb9671b98e6d",
            "filename": "client/src/components/settings/certification.tsx",
            "status": "modified",
            "additions": 25,
            "deletions": 41,
            "changes": 66,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92/client%2Fsrc%2Fcomponents%2Fsettings%2Fcertification.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92/client%2Fsrc%2Fcomponents%2Fsettings%2Fcertification.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2Fsettings%2Fcertification.tsx?ref=7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92",
            "patch": "@@ -1,4 +1,3 @@\n-import { navigate } from 'gatsby';\n import { find } from 'lodash-es';\n import React, { MouseEvent, useState } from 'react';\n import { withTranslation } from 'react-i18next';\n@@ -179,17 +178,16 @@ const LegacyFullStack = (props: CertificationSettingsProps) => {\n   const certSlug = Certification.LegacyFullStack;\n   const certLocation = `/certification/${username}/${certSlug}`;\n \n-  const createClickHandler =\n+  const handleClaim =\n     (certSlug: keyof typeof certSlugTypeMap) =>\n     (e: MouseEvent<HTMLButtonElement>) => {\n       e.preventDefault();\n-      if (isFullStackCert) {\n-        return navigate(certLocation);\n-      }\n+\n       return isHonest\n         ? verifyCert(certSlug)\n         : createFlashMessage(honestyInfoMessage);\n     };\n+\n   return (\n     <FullWidthRow key={certSlug}>\n       <Spacer size='medium' />\n@@ -219,41 +217,28 @@ const LegacyFullStack = (props: CertificationSettingsProps) => {\n       </div>\n \n       <div>\n-        {fullStackClaimable ? (\n+        {isFullStackCert ? (\n           <Button\n             size='small'\n             variant='primary'\n             block={true}\n             href={certLocation}\n             id={'button-' + certSlug}\n-            // This floating promise is acceptable\n-            // eslint-disable-next-line @typescript-eslint/no-misused-promises\n-            onClick={createClickHandler(certSlug)}\n             target='_blank'\n           >\n-            {isFullStackCert ? (\n-              <>\n-                {t('buttons.show-cert')}{' '}\n-                <span className='sr-only'>\n-                  {t('certification.title.Legacy Full Stack')}\n-                </span>\n-              </>\n-            ) : (\n-              <>\n-                {t('buttons.claim-cert')}{' '}\n-                <span className='sr-only'>\n-                  {t('certification.title.Legacy Full Stack')}\n-                </span>\n-              </>\n-            )}\n+            {t('buttons.show-cert')}{' '}\n+            <span className='sr-only'>\n+              {t('certification.title.Legacy Full Stack')}\n+            </span>\n           </Button>\n         ) : (\n           <Button\n             size='small'\n             variant='primary'\n             block={true}\n-            disabled={true}\n+            disabled={!fullStackClaimable}\n             id={'button-' + certSlug}\n+            onClick={handleClaim(certSlug)}\n           >\n             {t('buttons.claim-cert')}{' '}\n             <span className='sr-only'>\n@@ -387,15 +372,15 @@ function CertificationSettings(props: CertificationSettingsProps) {\n     const { username, isHonest, createFlashMessage, t, verifyCert } = props;\n     const { certSlug } = certsToProjects[certName][0];\n     const certLocation = `/certification/${username}/${certSlug}`;\n-    const clickHandler = (e: MouseEvent<HTMLButtonElement>) => {\n+\n+    const handleClaim = (e: MouseEvent<HTMLButtonElement>) => {\n       e.preventDefault();\n-      if (isCert) {\n-        return navigate(certLocation);\n-      }\n+\n       return isHonest\n         ? verifyCert(certSlug)\n         : createFlashMessage(honestyInfoMessage);\n     };\n+\n     return (\n       <>\n         {certsToProjects[certName].map(({ link, title, id }) => (\n@@ -412,18 +397,17 @@ function CertificationSettings(props: CertificationSettingsProps) {\n         ))}\n         <tr key={`cert-${certSlug}-button`}>\n           <td colSpan={2}>\n-            <Button\n-              block={true}\n-              variant='primary'\n-              href={certLocation}\n-              data-playwright-test-label={`btn-for-${certSlug}`}\n-              // This floating promise is acceptable\n-              // eslint-disable-next-line @typescript-eslint/no-misused-promises\n-              onClick={clickHandler}\n-            >\n-              {isCert ? t('buttons.show-cert') : t('buttons.claim-cert')}{' '}\n-              <span className='sr-only'>{certName}</span>\n-            </Button>\n+            {isCert ? (\n+              <Button block={true} variant='primary' href={certLocation}>\n+                {t('buttons.show-cert')}{' '}\n+                <span className='sr-only'>{certName}</span>\n+              </Button>\n+            ) : (\n+              <Button block={true} variant='primary' onClick={handleClaim}>\n+                {t('buttons.claim-cert')}{' '}\n+                <span className='sr-only'>{certName}</span>\n+              </Button>\n+            )}\n           </td>\n         </tr>\n       </>"
        },
        {
            "sha": "d5e0cdc2907146b70701057c2b403e908559cac5",
            "filename": "e2e/academic-honesty.spec.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 11,
            "changes": 26,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92/e2e%2Facademic-honesty.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92/e2e%2Facademic-honesty.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Facademic-honesty.spec.ts?ref=7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92",
            "patch": "@@ -1,6 +1,7 @@\n import { execSync } from 'child_process';\n import { test, expect } from '@playwright/test';\n import translations from '../client/i18n/locales/english/translations.json';\n+import { alertToBeVisible } from './utils/alerts';\n \n test.describe('When the user has not accepted the Academic Honesty Policy', () => {\n   test.use({ storageState: 'playwright/.auth/development-user.json' });\n@@ -9,6 +10,10 @@ test.describe('When the user has not accepted the Academic Honesty Policy', () =\n     execSync('node ./tools/scripts/seed/seed-demo-user');\n   });\n \n+  test.afterAll(() => {\n+    execSync('node ./tools/scripts/seed/seed-demo-user --certified-user');\n+  });\n+\n   test('they should be able to accept it', async ({ page }) => {\n     await page.goto('/settings');\n     await expect(\n@@ -48,11 +53,13 @@ test.describe('When the user has not accepted the Academic Honesty Policy', () =\n \n   test('Should show an error message', async ({ page }) => {\n     await page.goto('/settings#cert-responsive-web-design');\n-    await page.getByTestId('btn-for-responsive-web-design').click();\n \n-    await expect(page.getByTestId('flash-message')).toContainText(\n-      translations.flash['honest-first']\n-    );\n+    const claimCertButton = page.getByRole('button', {\n+      name: 'Claim Certification Responsive Web Design'\n+    });\n+    await claimCertButton.click();\n+\n+    await alertToBeVisible(page, translations.flash['honest-first']);\n \n     const agreeButton = page.getByRole('button', {\n       name: translations.buttons['agree-honesty']\n@@ -61,14 +68,11 @@ test.describe('When the user has not accepted the Academic Honesty Policy', () =\n \n     await page.reload();\n \n-    await page.getByTestId('btn-for-responsive-web-design').click();\n+    await claimCertButton.click();\n \n-    await expect(page.getByTestId('flash-message')).toContainText(\n-      /It looks like you have not completed the necessary steps. Please complete the required projects to claim the Responsive Web Design Certification./\n+    await alertToBeVisible(\n+      page,\n+      'It looks like you have not completed the necessary steps. Please complete the required projects to claim the Responsive Web Design Certification.'\n     );\n   });\n-\n-  test.afterAll(() => {\n-    execSync('node ./tools/scripts/seed/seed-demo-user --certified-user');\n-  });\n });"
        },
        {
            "sha": "f61b937b418cc83bd4e71633a453e7bdac3bbc31",
            "filename": "e2e/projects.spec.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92/e2e%2Fprojects.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92/e2e%2Fprojects.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fprojects.spec.ts?ref=7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92",
            "patch": "@@ -215,7 +215,7 @@ test.describe('JavaScript projects can be submitted and then viewed in /settings\n       .click();\n \n     await page\n-      .getByRole('link', {\n+      .getByRole('button', {\n         name: 'Claim Certification Legacy JavaScript Algorithms and Data Structures'\n       })\n       .click();"
        },
        {
            "sha": "e7c78f8d8ed9f50cafe41510893291d50c8042c4",
            "filename": "e2e/settings.spec.ts",
            "status": "modified",
            "additions": 14,
            "deletions": 4,
            "changes": 18,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92/e2e%2Fsettings.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92/e2e%2Fsettings.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fsettings.spec.ts?ref=7e0d6d8e7a1f6028b5e3b3e7f0293d11945e6f92",
            "patch": "@@ -368,7 +368,7 @@ test.describe('Settings - Certified User without Full Stack Certification', () =\n   test('should allow claiming Full Stack cert if the user has completed all requirements', async ({\n     page\n   }) => {\n-    const claimButton = page.getByRole('link', {\n+    const claimButton = page.getByRole('button', {\n       name: 'Claim Certification Legacy Full Stack'\n     });\n     const showButton = page.getByRole('link', {\n@@ -407,10 +407,20 @@ test.describe('Settings - New User', () => {\n   test('should not allow claiming Full Stack cert if the user has not completed all the required certs', async ({\n     page\n   }) => {\n-    const claimButton = page.getByRole('button', {\n+    const claimFullStackCertButton = page.getByRole('button', {\n       name: 'Claim Certification Legacy Full Stack'\n     });\n-    await expect(claimButton).toBeVisible();\n-    await expect(claimButton).toBeDisabled();\n+\n+    const claimRwdCertButton = page.getByRole('button', {\n+      name: 'Claim Certification Responsive Web Design'\n+    });\n+\n+    // Buttons for normal certs are enabled\n+    await expect(claimRwdCertButton).toBeVisible();\n+    await expect(claimRwdCertButton).toBeEnabled();\n+\n+    // Button for full stack cert is disabled if the user hasn't claimed the required certs\n+    await expect(claimFullStackCertButton).toBeVisible();\n+    await expect(claimFullStackCertButton).toBeDisabled();\n   });\n });"
        }
    ],
    "stats": {
        "total": 112,
        "additions": 55,
        "deletions": 57
    }
}