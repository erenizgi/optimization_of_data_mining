{
    "author": "Sembauke",
    "message": "feat(curriculum): implement selective build mode for curriculum processing (#63081)\n\nCo-authored-by: Oliver Eyton-Williams <ojeytonwilliams@gmail.com>",
    "sha": "52aa25b99100dcef439d4324e20f40f64facc550",
    "files": [
        {
            "sha": "200cd956288aef369166a9cbc532b9cf054e3179",
            "filename": "curriculum/src/build-curriculum.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/52aa25b99100dcef439d4324e20f40f64facc550/curriculum%2Fsrc%2Fbuild-curriculum.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/52aa25b99100dcef439d4324e20f40f64facc550/curriculum%2Fsrc%2Fbuild-curriculum.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fsrc%2Fbuild-curriculum.ts?ref=52aa25b99100dcef439d4324e20f40f64facc550",
            "patch": "@@ -338,13 +338,18 @@ export async function parseCurriculumStructure(filter?: Filter) {\n \n export async function buildCurriculum(lang: string, filters?: Filter) {\n   const contentDir = getContentDir(lang);\n+  const fccSuperblock = process.env.FCC_SUPERBLOCK;\n+\n+  const combinedFilters: Filter | undefined = fccSuperblock\n+    ? { ...filters, superBlock: fccSuperblock }\n+    : filters;\n \n   const builder = new SuperblockCreator(\n-    getBlockCreator(lang, !isEmpty(filters))\n+    getBlockCreator(lang, !isEmpty(combinedFilters))\n   );\n \n   const { fullSuperblockList, certifications } =\n-    await parseCurriculumStructure(filters);\n+    await parseCurriculumStructure(combinedFilters);\n \n   const fullCurriculum: {\n     [key: string]: unknown;\n@@ -357,16 +362,15 @@ export async function buildCurriculum(lang: string, filters?: Filter) {\n     const superOrder = getSuperOrder(name);\n     const upcomingSuperOrder = getSuperOrder(name, true);\n \n-    // If a superblock is not in either order list it should not exist.\n     if (isUndefined(superOrder) && isUndefined(upcomingSuperOrder)) {\n       throw Error(`Invalid superBlock: ${name}`);\n     }\n     return !isUndefined(superOrder);\n   });\n \n   for (const superblock of liveSuperblocks) {\n-    fullCurriculum[superblock.name] =\n-      await builder.processSuperblock(superblock);\n+    const processedSuperblock = await builder.processSuperblock(superblock);\n+    fullCurriculum[superblock.name] = processedSuperblock;\n   }\n \n   for (const cert of certifications) {"
        },
        {
            "sha": "4fc355f1f162834175d0dce18eaa1489de354c4e",
            "filename": "curriculum/src/utils.ts",
            "status": "modified",
            "additions": 17,
            "deletions": 4,
            "changes": 21,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/52aa25b99100dcef439d4324e20f40f64facc550/curriculum%2Fsrc%2Futils.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/52aa25b99100dcef439d4324e20f40f64facc550/curriculum%2Fsrc%2Futils.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fsrc%2Futils.ts?ref=52aa25b99100dcef439d4324e20f40f64facc550",
            "patch": "@@ -73,20 +73,27 @@ export function filterByBlock<T extends { blocks: { dashedName: string }[] }>(\n }\n \n /**\n- * Filters the superblocks array to only include the superblock with the specified name.\n+ * Filters the superblocks array to only include superblocks with the specified name(s).\n  * If no superBlock is provided, returns the original superblocks array.\n+ * Supports comma-separated superblock names for filtering multiple superblocks.\n  *\n  * @param {Array<Object>} superblocks - Array of superblock objects.\n  * @param {Object} [options] - Options object\n- * @param {string} [options.superBlock] - The name of the superblock to filter for.\n- * @returns {Array<Object>} Filtered array of superblocks containing only the specified superblock, or the original array if superBlock is not provided.\n+ * @param {string} [options.superBlock] - The name(s) of the superblock(s) to filter for (comma-separated for multiple).\n+ * @returns {Array<Object>} Filtered array of superblocks containing only the specified superblock(s), or the original array if superBlock is not provided.\n  */\n export function filterBySuperblock<T extends { name: string }>(\n   superblocks: T[],\n   { superBlock }: { superBlock?: string } = {}\n ): T[] {\n   if (!superBlock) return superblocks;\n-  return superblocks.filter(({ name }) => name === superBlock);\n+\n+  const superBlockList = superBlock\n+    .split(',')\n+    .map(s => s.trim())\n+    .filter(s => s.length > 0);\n+\n+  return superblocks.filter(({ name }) => superBlockList.includes(name));\n }\n \n /**\n@@ -175,6 +182,12 @@ export function closestFilters(\n ): Filter | undefined {\n   if (target?.superBlock) {\n     const superblockNames = superblocks.map(({ name }) => name);\n+\n+    // If there are multiple superblocks, do not attempt to find a closest match.\n+    if (target.superBlock.includes(',')) {\n+      return target;\n+    }\n+\n     return {\n       ...target,\n       superBlock: closestMatch(target.superBlock, superblockNames)"
        },
        {
            "sha": "34c1f1a1beac26a40f50f9a889c38904e886cae2",
            "filename": "tools/scripts/build/build-curriculum.ts",
            "status": "modified",
            "additions": 15,
            "deletions": 8,
            "changes": 23,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/52aa25b99100dcef439d4324e20f40f64facc550/tools%2Fscripts%2Fbuild%2Fbuild-curriculum.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/52aa25b99100dcef439d4324e20f40f64facc550/tools%2Fscripts%2Fbuild%2Fbuild-curriculum.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fscripts%2Fbuild%2Fbuild-curriculum.ts?ref=52aa25b99100dcef439d4324e20f40f64facc550",
            "patch": "@@ -15,16 +15,23 @@ import {\n \n const globalConfigPath = path.resolve(__dirname, '../../../shared-dist/config');\n \n-// We are defaulting to English because the ids for the challenges are same\n-// across all languages.\n+const isSelectiveBuild = !!process.env.FCC_SUPERBLOCK;\n+\n void getChallengesForLang('english')\n   .then(result => {\n-    buildExtCurriculumDataV1(\n-      result as unknown as CurriculumV1<CurriculumPropsV1>\n-    );\n-    buildExtCurriculumDataV2(\n-      result as unknown as CurriculumV2<CurriculumPropsV2>\n-    );\n+    if (!isSelectiveBuild) {\n+      console.log('Building external curriculum data...');\n+      buildExtCurriculumDataV1(\n+        result as unknown as CurriculumV1<CurriculumPropsV1>\n+      );\n+      buildExtCurriculumDataV2(\n+        result as unknown as CurriculumV2<CurriculumPropsV2>\n+      );\n+    } else {\n+      console.log(\n+        'Skipping external curriculum build (selective build mode active)'\n+      );\n+    }\n     return result;\n   })\n   .then(JSON.stringify)"
        }
    ],
    "stats": {
        "total": 58,
        "additions": 41,
        "deletions": 17
    }
}