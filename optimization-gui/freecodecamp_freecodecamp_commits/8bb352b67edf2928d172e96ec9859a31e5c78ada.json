{
    "author": "Sembauke",
    "message": "chore(api): add logging for 404 not found requests (#59068)\n\nCo-authored-by: Shaun Hamilton <shauhami020@gmail.com>",
    "sha": "8bb352b67edf2928d172e96ec9859a31e5c78ada",
    "files": [
        {
            "sha": "ca66e4a13055d5fc9110ea4a01ad39e3f6c4149e",
            "filename": "api/src/plugins/not-found.ts",
            "status": "modified",
            "additions": 7,
            "deletions": 4,
            "changes": 11,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/8bb352b67edf2928d172e96ec9859a31e5c78ada/api%2Fsrc%2Fplugins%2Fnot-found.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/8bb352b67edf2928d172e96ec9859a31e5c78ada/api%2Fsrc%2Fplugins%2Fnot-found.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fplugins%2Fnot-found.ts?ref=8bb352b67edf2928d172e96ec9859a31e5c78ada",
            "patch": "@@ -14,17 +14,20 @@ import { getRedirectParams } from '../utils/redirection';\n const fourOhFour: FastifyPluginCallback = (fastify, _options, done) => {\n   // If the request accepts JSON and does not specifically prefer text/html,\n   // this will return a 404 JSON response. Everything else will be redirected.\n-  fastify.setNotFoundHandler((request, reply) => {\n-    const accepted = request.accepts().type(['json', 'html']);\n+  fastify.setNotFoundHandler((req, reply) => {\n+    const logger = fastify.log.child({ req });\n+    const accepted = req.accepts().type(['json', 'html']);\n+\n+    logger.debug('User requested path that does not exist');\n \n     if (accepted == 'json') {\n       void reply.code(404).send({ error: 'path not found' });\n     } else {\n-      const { origin } = getRedirectParams(request);\n+      const { origin } = getRedirectParams(req);\n       void reply.status(302);\n       void reply.redirectWithMessage(`${origin}/404`, {\n         type: 'danger',\n-        content: `We couldn't find path ${request.url}`\n+        content: `We couldn't find path ${req.url}`\n       });\n     }\n   });"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 7,
        "deletions": 4
    }
}