{
    "author": "ShaunSHamilton",
    "message": "feat(client): add exam attempts to exam-download page (#61361)\n\nCo-authored-by: Tom <20648924+moT01@users.noreply.github.com>\nCo-authored-by: Oliver Eyton-Williams <ojeytonwilliams@gmail.com>\nCo-authored-by: Mrugesh Mohapatra <1884376+raisedadead@users.noreply.github.com>",
    "sha": "35d05d2c0560c1f19ec98e0e189dbb13533b156b",
    "files": [
        {
            "sha": "ca4e3f00374a9737aa025ba06c077d479631c5f5",
            "filename": "api/src/exam-environment/routes/exam-environment.test.ts",
            "status": "modified",
            "additions": 55,
            "deletions": 12,
            "changes": 67,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.test.ts?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -1232,34 +1232,77 @@ describe('/exam-environment/', () => {\n       });\n     });\n \n-    describe('GET /exam-environment/challenges/:challengeId/exam-mappings', () => {\n+    describe('GET /exam-environment/exam-challenge', () => {\n       afterAll(async () => {\n         await fastifyTestInstance.prisma.examEnvironmentChallenge.deleteMany(\n           {}\n         );\n       });\n-      it('should return 200 and an empty array if no exams are mapped to the challenge', async () => {\n+      it('should return 200 and an empty array if no mapping exists', async () => {\n         const challengeId = mock.oid();\n-        const res = await superGet(\n-          `/exam-environment/challenges/${challengeId}/exam-mappings`\n+        const examId = mock.oid();\n+\n+        const res1 = await superGet(\n+          `/exam-environment/exam-challenge?challengeId=${challengeId}`\n         );\n-        expect(res.body).toStrictEqual([]);\n-        expect(res.status).toBe(200);\n+        expect(res1.body).toStrictEqual([]);\n+        expect(res1.status).toBe(200);\n+\n+        const res2 = await superGet(\n+          `/exam-environment/exam-challenge?examId=${examId}`\n+        );\n+        expect(res2.body).toStrictEqual([]);\n+        expect(res2.status).toBe(200);\n+\n+        const res3 = await superGet(\n+          `/exam-environment/exam-challenge?challengeId=${challengeId}&examId=${examId}`\n+        );\n+        expect(res3.body).toStrictEqual([]);\n+        expect(res3.status).toBe(200);\n       });\n \n-      it('should return 200 and a list of exams mapped to the challenge', async () => {\n+      it('should return 200 and a list of challenge-exam mappings if one exists', async () => {\n         await fastifyTestInstance.prisma.examEnvironmentChallenge.create({\n           data: mock.examEnvironmentChallenge\n         });\n-        const res = await superGet(\n-          `/exam-environment/challenges/${mock.examEnvironmentChallenge.challengeId}/exam-mappings`\n+        const res1 = await superGet(\n+          `/exam-environment/exam-challenge?challengeId=${mock.examEnvironmentChallenge.challengeId}`\n         );\n-        expect(res.body).toEqual(\n+        expect(res1.body).toEqual(\n           expect.arrayContaining([\n-            expect.objectContaining({ examId: mock.examId })\n+            expect.objectContaining({\n+              examId: mock.examId,\n+              challengeId: mock.examEnvironmentChallenge.challengeId\n+            })\n           ])\n         );\n-        expect(res.status).toBe(200);\n+        expect(res1.status).toBe(200);\n+\n+        const res2 = await superGet(\n+          `/exam-environment/exam-challenge?examId=${mock.examId}`\n+        );\n+        expect(res2.body).toEqual(\n+          expect.arrayContaining([\n+            expect.objectContaining({\n+              examId: mock.examId,\n+              challengeId: mock.examEnvironmentChallenge.challengeId\n+            })\n+          ])\n+        );\n+        expect(res2.status).toBe(200);\n+\n+        const res3 = await superGet(\n+          `/exam-environment/exam-challenge?challengeId=${mock.examEnvironmentChallenge.challengeId}&examId=${mock.examId}`\n+        );\n+        expect(res3.body).toEqual(\n+          expect.arrayContaining([\n+            expect.objectContaining({\n+              examId: mock.examId,\n+              challengeId: mock.examEnvironmentChallenge.challengeId\n+            })\n+          ])\n+        );\n+        expect(res3.status).toBe(200);\n       });\n     });\n   });"
        },
        {
            "sha": "4346ca412ee93b2d04eb46c08e347917a174cb79",
            "filename": "api/src/exam-environment/routes/exam-environment.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 10,
            "changes": 19,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fexam-environment%2Froutes%2Fexam-environment.ts?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -89,11 +89,11 @@ export const examEnvironmentOpenRoutes: FastifyPluginCallbackTypebox = (\n     tokenMetaHandler\n   );\n   fastify.get(\n-    '/exam-environment/challenges/:challengeId/exam-mappings',\n+    '/exam-environment/exam-challenge',\n     {\n-      schema: schemas.examEnvironmentGetExamMappingsByChallengeId\n+      schema: schemas.examEnvironmentGetExamChallenge\n     },\n-    getExamMappingsByChallengeId\n+    getExamChallenge\n   );\n   done();\n };\n@@ -1000,22 +1000,21 @@ export async function getExamAttemptsByExamIdHandler(\n /**\n  * Gets all the relations for a given challenge and exam(s).\n  */\n-export async function getExamMappingsByChallengeId(\n+export async function getExamChallenge(\n   this: FastifyInstance,\n-  req: UpdateReqType<\n-    typeof schemas.examEnvironmentGetExamMappingsByChallengeId\n-  >,\n+  req: UpdateReqType<typeof schemas.examEnvironmentGetExamChallenge>,\n   reply: FastifyReply\n ) {\n   const logger = this.log.child({ req });\n-  const { challengeId } = req.params;\n+  const { challengeId, examId } = req.query;\n \n-  logger.info({ challengeId });\n+  logger.info({ challengeId, examId });\n \n   const maybeData = await mapErr(\n     this.prisma.examEnvironmentChallenge.findMany({\n       where: {\n-        challengeId\n+        challengeId: challengeId ?? undefined,\n+        examId: examId ?? undefined\n       }\n     })\n   );"
        },
        {
            "sha": "db2a756dd68f21338a46098d5413617bb75492ae",
            "filename": "api/src/exam-environment/schemas/challenges.ts",
            "status": "modified",
            "additions": 4,
            "deletions": 3,
            "changes": 7,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/api%2Fsrc%2Fexam-environment%2Fschemas%2Fchallenges.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/api%2Fsrc%2Fexam-environment%2Fschemas%2Fchallenges.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fexam-environment%2Fschemas%2Fchallenges.ts?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -1,9 +1,10 @@\n import { Type } from '@fastify/type-provider-typebox';\n // import { STANDARD_ERROR } from '../utils/errors';\n \n-export const examEnvironmentGetExamMappingsByChallengeId = {\n-  params: Type.Object({\n-    challengeId: Type.String({ format: 'objectid' })\n+export const examEnvironmentGetExamChallenge = {\n+  querystring: Type.Object({\n+    challengeId: Type.Optional(Type.String({ format: 'objectid' })),\n+    examId: Type.Optional(Type.String({ format: 'objectid' }))\n   })\n   // response: {\n   //   200: examEnvAttempt,"
        },
        {
            "sha": "9f62893a28a9cdc84dec59f40eabf9e52075a093",
            "filename": "api/src/exam-environment/schemas/index.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/api%2Fsrc%2Fexam-environment%2Fschemas%2Findex.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/api%2Fsrc%2Fexam-environment%2Fschemas%2Findex.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Fexam-environment%2Fschemas%2Findex.ts?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -7,4 +7,4 @@ export {\n export { examEnvironmentPostExamGeneratedExam } from './exam-environment-exam-generated-exam.js';\n export { examEnvironmentTokenMeta } from './token-meta.js';\n export { examEnvironmentExams } from './exam-environment-exams.js';\n-export { examEnvironmentGetExamMappingsByChallengeId } from './challenges.js';\n+export { examEnvironmentGetExamChallenge } from './challenges.js';"
        },
        {
            "sha": "77e38c1ac5028248c04950fd234e294c1ef5ad8e",
            "filename": "client/i18n/locales/english/translations.json",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -380,6 +380,14 @@\n     }\n   },\n   \"exam\": {\n+    \"attempts\": \"Attempts\",\n+    \"no-attempts-yet\": \"No attempts yet\",\n+    \"date-taken\": \"Date Taken\",\n+    \"score\": \"Score\",\n+    \"status\": \"Status\",\n+    \"pending\": \"Pending\",\n+    \"passed\": \"Passed\",\n+    \"failed\": \"Failed\",\n     \"download-header\": \"Download the freeCodeCamp Exam Environment App\",\n     \"explanation\": \"To earn a certification, you must take an exam to test your understanding of the material you have learned. Taking the exam is absolutely free of charge.\",\n     \"version\": \"The latest version of our app is: {{version}}.\","
        },
        {
            "sha": "72ec63cf450b6cdeadec1ba975c00f9fbb710fc6",
            "filename": "client/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fpackage.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fpackage.json?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -57,6 +57,7 @@\n     \"@loadable/component\": \"5.16.3\",\n     \"@redux-devtools/extension\": \"3.3.0\",\n     \"@redux-saga/core\": \"^1.2.2\",\n+    \"@reduxjs/toolkit\": \"2.8.2\",\n     \"@stripe/react-stripe-js\": \"1.16.5\",\n     \"@stripe/stripe-js\": \"1.54.2\",\n     \"algoliasearch\": \"4.22.1\","
        },
        {
            "sha": "40deb667bd0b8f9c97639bb95e82580678e853f9",
            "filename": "client/src/redux/create-store.ts",
            "status": "modified",
            "additions": 28,
            "deletions": 10,
            "changes": 38,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Fredux%2Fcreate-store.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Fredux%2Fcreate-store.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fredux%2Fcreate-store.ts?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -1,10 +1,12 @@\n import { createStore as reduxCreateStore, applyMiddleware } from 'redux';\n-import { composeWithDevTools } from '@redux-devtools/extension';\n+// import { composeWithDevTools } from '@redux-devtools/extension';\n import { createEpicMiddleware } from 'redux-observable';\n import createSagaMiddleware from 'redux-saga';\n+import { configureStore } from '@reduxjs/toolkit';\n \n import envData from '../../config/env.json';\n import { isBrowser } from '../../utils';\n+import { examAttempts } from '../utils/ajax';\n import rootEpic from './root-epic';\n import rootReducer from './root-reducer';\n import rootSaga from './root-saga';\n@@ -32,24 +34,40 @@ const epicMiddleware = createEpicMiddleware({\n   }\n });\n \n-const composeEnhancers = composeWithDevTools({\n-  // options like actionSanitizer, stateSanitizer\n-});\n+// const composeEnhancers = composeWithDevTools({\n+//   // options like actionSanitizer, stateSanitizer\n+// });\n \n export const createStore = (preloadedState = {}) => {\n   let store;\n   if (environment === 'production') {\n     store = reduxCreateStore(\n       rootReducer,\n       preloadedState,\n-      applyMiddleware(sagaMiddleware, epicMiddleware)\n+      // @ts-expect-error RTK uses unknown, Redux uses any\n+      applyMiddleware(sagaMiddleware, epicMiddleware, examAttempts.middleware)\n     );\n   } else {\n-    store = reduxCreateStore(\n-      rootReducer,\n-      preloadedState,\n-      composeEnhancers(applyMiddleware(sagaMiddleware, epicMiddleware))\n-    );\n+    // store = reduxCreateStore(\n+    //   rootReducer,\n+    //   preloadedState,\n+    //   composeEnhancers(\n+    //     // @ts-expect-error RTK uses unknown, Redux uses any\n+    //     applyMiddleware(sagaMiddleware, epicMiddleware, examAttempts.middleware)\n+    //   )\n+    // );\n+    store = configureStore({\n+      // @ts-expect-error RTK uses unknown, Redux uses any\n+      reducer: rootReducer,\n+      // @ts-expect-error RTK uses unknown, Redux uses any\n+      middleware: getDefaultMiddleware => {\n+        return getDefaultMiddleware()\n+          .concat(examAttempts.middleware)\n+          .concat(sagaMiddleware)\n+          .concat(epicMiddleware);\n+      },\n+      preloadedState\n+    });\n   }\n   sagaMiddleware.run(rootSaga);\n   // eslint-disable-next-line @typescript-eslint/no-unsafe-argument"
        },
        {
            "sha": "56ae50b3856907e8bfcd9efea0e4288bc8066d6a",
            "filename": "client/src/redux/root-reducer.ts",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Fredux%2Froot-reducer.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Fredux%2Froot-reducer.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fredux%2Froot-reducer.ts?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -13,6 +13,7 @@ import {\n   ns as curriculumMapNameSpace,\n   reducer as curriculumMap\n } from '../templates/Introduction/redux';\n+import { examAttempts } from '../utils/ajax';\n import { ns as appNameSpace } from './action-types';\n import { ns as settingsNameSpace, reducer as settings } from './settings';\n import { FlashApp as flashNameSpace } from './types';\n@@ -24,5 +25,6 @@ export default combineReducers({\n   [curriculumMapNameSpace]: curriculumMap,\n   [flashNameSpace]: flash,\n   [searchNameSpace]: search,\n-  [settingsNameSpace]: settings\n+  [settingsNameSpace]: settings,\n+  [examAttempts.reducerPath]: examAttempts.reducer\n });"
        },
        {
            "sha": "557af7dcd9c46004e6278422430d53b2d2cfd9b5",
            "filename": "client/src/templates/Challenges/exam-download/attempts.tsx",
            "status": "added",
            "additions": 81,
            "deletions": 0,
            "changes": 81,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Ftemplates%2FChallenges%2Fexam-download%2Fattempts.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Ftemplates%2FChallenges%2Fexam-download%2Fattempts.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fexam-download%2Fattempts.tsx?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -0,0 +1,81 @@\n+import React, { useEffect } from 'react';\n+import { Table } from '@freecodecamp/ui';\n+import { useTranslation } from 'react-i18next';\n+\n+import { Loader } from '../../../components/helpers';\n+import { examAttempts } from '../../../utils/ajax';\n+\n+interface AttemptsProps {\n+  id: string;\n+}\n+\n+export function Attempts({ id }: AttemptsProps) {\n+  const { t } = useTranslation();\n+\n+  const examIdsQuery = examAttempts.useGetExamIdsByChallengeIdQuery(id);\n+  const [getAttempts, attemptsMutation] =\n+    examAttempts.useGetExamAttemptsByExamIdMutation();\n+\n+  useEffect(() => {\n+    if (!examIdsQuery.data) {\n+      return;\n+    }\n+\n+    const examId = examIdsQuery.data.at(0)!.examId;\n+    void getAttempts(examId);\n+  }, [examIdsQuery.data, getAttempts]);\n+\n+  if (examIdsQuery.isLoading || attemptsMutation.isLoading) {\n+    return <Loader />;\n+  }\n+  if (examIdsQuery.error || !examIdsQuery.data) {\n+    console.error(examIdsQuery.error);\n+    return <p>{t('flash.generic-error')}</p>;\n+  }\n+\n+  if (attemptsMutation.error) {\n+    console.error(attemptsMutation.error);\n+    return <p>{t('flash.generic-error')}</p>;\n+  }\n+\n+  const attempts = attemptsMutation.data;\n+\n+  if (attempts === undefined) {\n+    return <Loader />;\n+  }\n+\n+  if (attempts.length === 0) {\n+    return <p>{t('exam.no-attempts-yet')}</p>;\n+  }\n+\n+  return (\n+    <Table striped>\n+      <thead>\n+        <tr>\n+          <th>{t('exam.date-taken')}</th>\n+          <th>{t('exam.score')} [%]</th>\n+          <th>{t('exam.status')}</th>\n+        </tr>\n+      </thead>\n+      <tbody>\n+        {attempts.map(attempt => (\n+          <tr key={attempt.startTimeInMS}>\n+            <td>{new Date(attempt.startTimeInMS).toTimeString()}</td>\n+            <td>\n+              {attempt.result\n+                ? `${attempt.result.percent}%`\n+                : t('exam.pending')}\n+            </td>\n+            <td>\n+              {attempt.result\n+                ? attempt.result.passed\n+                  ? t('exam.passed')\n+                  : t('exam.failed')\n+                : t('exam.pending')}\n+            </td>\n+          </tr>\n+        ))}\n+      </tbody>\n+    </Table>\n+  );\n+}"
        },
        {
            "sha": "45836b221ee2f0410172d8c2379fecaac17772c1",
            "filename": "client/src/templates/Challenges/exam-download/show.tsx",
            "status": "modified",
            "additions": 91,
            "deletions": 43,
            "changes": 134,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Ftemplates%2FChallenges%2Fexam-download%2Fshow.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Ftemplates%2FChallenges%2Fexam-download%2Fshow.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FChallenges%2Fexam-download%2Fshow.tsx?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -1,9 +1,16 @@\n import React, { useEffect, useState } from 'react';\n-import { Button, Spacer } from '@freecodecamp/ui';\n+import { graphql } from 'gatsby';\n+import { Button, Dropdown, MenuItem, Spacer } from '@freecodecamp/ui';\n import { isEmpty } from 'lodash';\n-import { useTranslation } from 'react-i18next';\n+import { useTranslation, withTranslation } from 'react-i18next';\n+import { createSelector } from 'reselect';\n+import { connect } from 'react-redux';\n+\n import { FullWidthRow } from '../../../components/helpers';\n import useDetectOS from '../utils/use-detect-os';\n+import { ChallengeNode } from '../../../redux/prop-types';\n+import { isSignedInSelector } from '../../../redux/selectors';\n+import { Attempts } from './attempts';\n \n interface GitProps {\n   tag_name: string;\n@@ -12,7 +19,26 @@ interface GitProps {\n   }[];\n }\n \n-function ShowExamDownload(): JSX.Element {\n+const mapStateToProps = createSelector(\n+  isSignedInSelector,\n+  (isSignedIn: boolean) => ({\n+    isSignedIn\n+  })\n+);\n+\n+interface ShowExamDownloadProps {\n+  data: { challengeNode: ChallengeNode };\n+  isSignedIn: boolean;\n+}\n+\n+function ShowExamDownload({\n+  data: {\n+    challengeNode: {\n+      challenge: { id }\n+    }\n+  },\n+  isSignedIn\n+}: ShowExamDownloadProps): JSX.Element {\n   const [latestVersion, setLatestVersion] = useState<string | null>(null);\n \n   const [downloadLink, setDownloadLink] = useState<string | undefined>('');\n@@ -22,8 +48,8 @@ function ShowExamDownload(): JSX.Element {\n \n   const { t } = useTranslation();\n \n-  const handleDownloadLink = (downloadLinks: string[]) => {\n-    const win = downloadLinks.find(link => link.match(/\\.msi/));\n+  function handleDownloadLink(downloadLinks: string[]) {\n+    const win = downloadLinks.find(link => link.match(/\\.exe/));\n     const macARM = downloadLinks.find(\n       link => link.match(/aarch64/) && link.match(/\\.dmg/)\n     );\n@@ -70,41 +96,44 @@ function ShowExamDownload(): JSX.Element {\n     }\n \n     return '';\n-  };\n+  }\n \n   useEffect(() => {\n-    const checkLatestVersion = async () => {\n-      return await fetch(\n-        'https://api.github.com/repos/freeCodeCamp/exam-env/releases/latest'\n-      );\n-    };\n-    checkLatestVersion()\n-      .then(response => {\n+    async function checkLatestVersion() {\n+      try {\n+        const response = await fetch(\n+          'https://api.github.com/repos/freeCodeCamp/exam-env/releases/latest'\n+        );\n         if (response.ok) {\n-          void response.json().then(data => {\n-            const { tag_name, assets } = data as GitProps;\n-            setLatestVersion(tag_name);\n-\n-            setDownloadLink(\n-              handleDownloadLink(\n-                assets.map(links => links.browser_download_url)\n-              )\n-            );\n-\n-            setDownloadLinks(assets.map(links => links.browser_download_url));\n-          });\n+          const data = (await response.json()) as GitProps;\n+          const { tag_name, assets } = data;\n+          setLatestVersion(tag_name);\n+          const urls = assets.map(link => link.browser_download_url);\n+          setDownloadLink(handleDownloadLink(urls));\n+          setDownloadLinks(urls);\n         }\n-      })\n-      .catch(() => {\n+      } catch {\n         setLatestVersion('...');\n-      });\n-  });\n+      }\n+    }\n+\n+    void checkLatestVersion();\n+    // eslint-disable-next-line react-hooks/exhaustive-deps\n+  }, [os]);\n \n   return (\n     <FullWidthRow>\n       <Spacer size='l' />\n       <h2>{t('exam.download-header')}</h2>\n       <p>{t('exam.explanation')}</p>\n+      <Spacer size='l' />\n+      {isSignedIn && (\n+        <>\n+          <h2>{t('exam.attempts')}</h2>\n+          <Attempts id={id} />\n+          <Spacer size='l' />\n+        </>\n+      )}\n       <p>\n         {t('exam.version', {\n           version: latestVersion || '...'\n@@ -118,29 +147,48 @@ function ShowExamDownload(): JSX.Element {\n       >\n         {t('buttons.download-latest-version')}\n       </Button>\n-      {!downloadLink && <strong>{t('exam.unable-to-detect-os')}</strong>}\n-      <Spacer size='l' />\n-      <details>\n-        <summary>{t('exam.download-details')}</summary>\n-        <ul>\n+      {!downloadLink && (\n+        <>\n+          <Spacer size='m' />\n+          <strong>{t('exam.unable-to-detect-os')}</strong>\n+        </>\n+      )}\n+      <Spacer size='m' />\n+      <Dropdown>\n+        <Dropdown.Toggle>{t('exam.download-details')}</Dropdown.Toggle>\n+        <Dropdown.Menu>\n           {downloadLinks\n             .filter(link => !link.match(/\\.sig|\\.json/))\n             .map((link, index) => {\n               return (\n-                <li key={index} style={{ listStyle: 'none' }}>\n-                  <a href={link} download={link}>\n-                    {link}\n-                  </a>\n-                </li>\n+                <MenuItem\n+                  href={link}\n+                  download={link}\n+                  key={index}\n+                  variant='primary'\n+                >\n+                  {link}\n+                </MenuItem>\n               );\n             })}\n-        </ul>\n-      </details>\n+        </Dropdown.Menu>\n+      </Dropdown>\n       <Spacer size='l' />\n-      <strong>{t('exam.download-trouble')}</strong>\n+      <strong>{t('exam.download-trouble')}</strong>{' '}\n       <a href='mailto: support@freecodecamp.org'>support@freecodecamp.org</a>\n     </FullWidthRow>\n   );\n }\n \n-export default ShowExamDownload;\n+export default connect(mapStateToProps)(withTranslation()(ShowExamDownload));\n+\n+// GraphQL\n+export const query = graphql`\n+  query ExamEnvironmentExam($id: String!) {\n+    challengeNode(id: { eq: $id }) {\n+      challenge {\n+        id\n+      }\n+    }\n+  }\n+`;"
        },
        {
            "sha": "231f16b84e88aa02a550c95766d52dd66f5b87a2",
            "filename": "client/src/utils/ajax.ts",
            "status": "modified",
            "additions": 56,
            "deletions": 1,
            "changes": 57,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Futils%2Fajax.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/client%2Fsrc%2Futils%2Fajax.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Futils%2Fajax.ts?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -1,6 +1,7 @@\n import cookies from 'browser-cookies';\n-import envData from '../../config/env.json';\n+import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';\n \n+import envData from '../../config/env.json';\n import type {\n   ChallengeFile,\n   ChallengeFiles,\n@@ -212,6 +213,32 @@ export function getGenerateExam(\n   return get(`/exam/${challengeId}`);\n }\n \n+export interface Exam {\n+  id: string;\n+  config: {\n+    name: string;\n+  };\n+}\n+\n+export interface Attempt {\n+  id: string;\n+  examId: string;\n+  startTimeInMS: number;\n+  questionSets: unknown[];\n+  result?: {\n+    passed: boolean;\n+    percent: number;\n+  };\n+}\n+\n+export function getExams(): Promise<ResponseWithData<{ exams: Exam[] }>> {\n+  return get('/user/exam-environment/exams');\n+}\n+\n+export function getExamAttempts(): Promise<ResponseWithData<Attempt[]>> {\n+  return get('/user/exam-environment/exam/attempts');\n+}\n+\n /** POST **/\n \n interface Donation {\n@@ -393,3 +420,31 @@ export function deleteUserToken(): Promise<ResponseWithData<void>> {\n export function deleteMsUsername(): Promise<ResponseWithData<void>> {\n   return deleteRequest('/user/ms-username', {});\n }\n+\n+/** RTK */\n+\n+export interface ExamEnvironmentChallenge {\n+  id: string;\n+  examId: string;\n+  challengeId: string;\n+}\n+\n+export const examAttempts = createApi({\n+  reducerPath: 'exam-attempts',\n+  baseQuery: fetchBaseQuery({\n+    baseUrl: apiLocation,\n+    headers: {\n+      'CSRF-Token': getCSRFToken()\n+    },\n+    credentials: 'include'\n+  }),\n+  endpoints: build => ({\n+    getExamAttemptsByExamId: build.mutation<Attempt[], string>({\n+      query: examId => `/user/exam-environment/exams/${examId}/attempts`\n+    }),\n+    getExamIdsByChallengeId: build.query<ExamEnvironmentChallenge[], string>({\n+      query: challengeId =>\n+        `/exam-environment/exam-challenge?challengeId=${challengeId}`\n+    })\n+  })\n+});"
        },
        {
            "sha": "d16225418b3daaa05ddf441690a03ee2bb6d4a60",
            "filename": "pnpm-lock.yaml",
            "status": "modified",
            "additions": 60,
            "deletions": 0,
            "changes": 60,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/35d05d2c0560c1f19ec98e0e189dbb13533b156b/pnpm-lock.yaml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/35d05d2c0560c1f19ec98e0e189dbb13533b156b/pnpm-lock.yaml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/pnpm-lock.yaml?ref=35d05d2c0560c1f19ec98e0e189dbb13533b156b",
            "patch": "@@ -348,6 +348,9 @@ importers:\n       '@redux-saga/core':\n         specifier: ^1.2.2\n         version: 1.3.0\n+      '@reduxjs/toolkit':\n+        specifier: 2.8.2\n+        version: 2.8.2(react-redux@7.2.9(react-dom@17.0.2(react@17.0.2))(react@17.0.2))(react@17.0.2)\n       '@stripe/react-stripe-js':\n         specifier: 1.16.5\n         version: 1.16.5(@stripe/stripe-js@1.54.2)(react-dom@17.0.2(react@17.0.2))(react@17.0.2)\n@@ -3764,6 +3767,17 @@ packages:\n   '@redux-saga/types@1.2.1':\n     resolution: {integrity: sha512-1dgmkh+3so0+LlBWRhGA33ua4MYr7tUOj+a9Si28vUi0IUFNbff1T3sgpeDJI/LaC75bBYnQ0A3wXjn0OrRNBA==}\n \n+  '@reduxjs/toolkit@2.8.2':\n+    resolution: {integrity: sha512-MYlOhQ0sLdw4ud48FoC5w0dH9VfWQjtCjreKwYTT3l+r427qYC5Y8PihNutepr8XrNaBUDQo9khWUwQxZaqt5A==}\n+    peerDependencies:\n+      react: ^16.9.0 || ^17.0.0 || ^18 || ^19\n+      react-redux: ^7.2.1 || ^8.1.3 || ^9.0.0\n+    peerDependenciesMeta:\n+      react:\n+        optional: true\n+      react-redux:\n+        optional: true\n+\n   '@remix-run/router@1.11.0':\n     resolution: {integrity: sha512-BHdhcWgeiudl91HvVa2wxqZjSHbheSgIiDvxrF1VjFzBzpTtuDPkOdOi3Iqvc08kXtFkLjhbS+ML9aM8mJS+wQ==}\n     engines: {node: '>=14.0.0'}\n@@ -4234,6 +4248,12 @@ packages:\n     resolution: {integrity: sha512-yxLC57GBDmbDmrnH+vJxsrbV4/aYUucBONkSRLZyJIVFAl/QJH+O/h+phITHDaxVZCYZAcudYJw4ERE32BJM7g==}\n     engines: {node: '>=14.0.0'}\n \n+  '@standard-schema/spec@1.0.0':\n+    resolution: {integrity: sha512-m2bOd0f2RT9k8QJx1JN85cZYyH1RqFBdlwtkSlf4tBDYLCiiZnv1fIIwacK6cqwXavOydf0NPToMQgpKq+dVlA==}\n+\n+  '@standard-schema/utils@0.3.0':\n+    resolution: {integrity: sha512-e7Mew686owMaPJVNNLs55PUvgz371nKgwsc4vxE49zsODpJEnxgxRo2y/OKrqueavXgZNMDVj3DdHFlaSAeU8g==}\n+\n   '@stripe/react-stripe-js@1.16.5':\n     resolution: {integrity: sha512-lVPW3IfwdacyS22pP+nBB6/GNFRRhT/4jfgAK6T2guQmtzPwJV1DogiGGaBNhiKtSY18+yS8KlHSu+PvZNclvQ==}\n     peerDependencies:\n@@ -8589,6 +8609,9 @@ packages:\n     resolution: {integrity: sha512-Hs59xBNfUIunMFgWAbGX5cq6893IbWg4KnrjbYwX3tx0ztorVgTDA6B2sxf8ejHJ4wz8BqGUMYlnzNBer5NvGg==}\n     engines: {node: '>= 4'}\n \n+  immer@10.1.1:\n+    resolution: {integrity: sha512-s2MPrmjovJcoMaHtx6K11Ra7oD05NT97w1IC5zpMkT6Atjr7H8LjaDd81iIxUYpMKSRRNMJE703M1Fhr/TctHw==}\n+\n   immer@8.0.1:\n     resolution: {integrity: sha512-aqXhGP7//Gui2+UrEtvxZxSquQVXTpZ7KDxfCcKAF3Vysvw0CViVaW9RZ1j1xlIYqaaaipBoqdqeibkc18PNvA==}\n \n@@ -11681,9 +11704,17 @@ packages:\n     peerDependencies:\n       redux: ^4\n \n+  redux-thunk@3.1.0:\n+    resolution: {integrity: sha512-NW2r5T6ksUKXCabzhL9z+h206HQw/NJkcLm1GPImRQ8IzfXwRGqjVhKJGauHirT0DAuyy6hjdnMZaRoAcy0Klw==}\n+    peerDependencies:\n+      redux: ^5.0.0\n+\n   redux@4.2.1:\n     resolution: {integrity: sha512-LAUYz4lc+Do8/g7aeRa8JkyDErK6ekstQaqWQrNRW//MY1TvCEpMtpTWvlQ+FPbWCx+Xixu/6SHt5N0HR+SB4w==}\n \n+  redux@5.0.1:\n+    resolution: {integrity: sha512-M9/ELqF6fy8FwmkpnF0S3YKOqMyoWJ4+CS5Efg2ct3oY9daQvd/Pc71FpGZsVsbl3Cpb+IIcjBDUnnyBdQbq4w==}\n+\n   reflect.getprototypeof@1.0.10:\n     resolution: {integrity: sha512-00o4I+DVrefhv+nX0ulyi3biSHCPDe+yLv5o/p6d/UVlirijB8E16FtfwSAi4g3tcqrQ4lRAqQSoFEZJehYEcw==}\n     engines: {node: '>= 0.4'}\n@@ -11825,6 +11856,9 @@ packages:\n   reselect@4.1.8:\n     resolution: {integrity: sha512-ab9EmR80F/zQTMNeneUr4cv+jSwPJgIlvEmVwLerwrWVbpLlBuls9XHzIeTFy4cegU2NHBp3va0LKOzU5qFEYQ==}\n \n+  reselect@5.1.1:\n+    resolution: {integrity: sha512-K/BG6eIky/SBpzfHZv/dd+9JBFiS4SWV7FIujVyJRux6e45+73RaUHXLmIR1f7WOMaQ0U1km6qwklRQxpJJY0w==}\n+\n   resize-observer-polyfill@1.5.1:\n     resolution: {integrity: sha512-LwZrotdHOo12nQuZlHEmtuXdqGoOD0OhaxopaNFxWzInpEgaLWoVuAMbTzixuosCx2nEG58ngzW3vxdWoxIgdg==}\n \n@@ -17891,6 +17925,18 @@ snapshots:\n \n   '@redux-saga/types@1.2.1': {}\n \n+  '@reduxjs/toolkit@2.8.2(react-redux@7.2.9(react-dom@17.0.2(react@17.0.2))(react@17.0.2))(react@17.0.2)':\n+    dependencies:\n+      '@standard-schema/spec': 1.0.0\n+      '@standard-schema/utils': 0.3.0\n+      immer: 10.1.1\n+      redux: 5.0.1\n+      redux-thunk: 3.1.0(redux@5.0.1)\n+      reselect: 5.1.1\n+    optionalDependencies:\n+      react: 17.0.2\n+      react-redux: 7.2.9(react-dom@17.0.2(react@17.0.2))(react@17.0.2)\n+\n   '@remix-run/router@1.11.0': {}\n \n   '@rollup/rollup-android-arm-eabi@4.46.2':\n@@ -18581,6 +18627,10 @@ snapshots:\n       '@smithy/types': 2.10.0\n       tslib: 2.6.2\n \n+  '@standard-schema/spec@1.0.0': {}\n+\n+  '@standard-schema/utils@0.3.0': {}\n+\n   '@stripe/react-stripe-js@1.16.5(@stripe/stripe-js@1.54.2)(react-dom@17.0.2(react@17.0.2))(react@17.0.2)':\n     dependencies:\n       '@stripe/stripe-js': 1.54.2\n@@ -24568,6 +24618,8 @@ snapshots:\n \n   ignore@7.0.5: {}\n \n+  immer@10.1.1: {}\n+\n   immer@8.0.1: {}\n \n   immutable@4.3.5: {}\n@@ -28257,10 +28309,16 @@ snapshots:\n     dependencies:\n       redux: 4.2.1\n \n+  redux-thunk@3.1.0(redux@5.0.1):\n+    dependencies:\n+      redux: 5.0.1\n+\n   redux@4.2.1:\n     dependencies:\n       '@babel/runtime': 7.23.9\n \n+  redux@5.0.1: {}\n+\n   reflect.getprototypeof@1.0.10:\n     dependencies:\n       call-bind: 1.0.8\n@@ -28487,6 +28545,8 @@ snapshots:\n \n   reselect@4.1.8: {}\n \n+  reselect@5.1.1: {}\n+\n   resize-observer-polyfill@1.5.1: {}\n \n   resolve-alpn@1.2.1: {}"
        }
    ],
    "stats": {
        "total": 478,
        "additions": 397,
        "deletions": 81
    }
}