{
    "author": "ojeytonwilliams",
    "message": "feat: find closest matching block and superblock for testing (#62089)",
    "sha": "3a41a6137a31a99141d24196a48cf4f93ed46f82",
    "files": [
        {
            "sha": "cd1282b0f5a83c9a21d7ac5c1105cdd437bc706b",
            "filename": "curriculum/build-curriculum.js",
            "status": "modified",
            "additions": 4,
            "deletions": 2,
            "changes": 6,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/3a41a6137a31a99141d24196a48cf4f93ed46f82/curriculum%2Fbuild-curriculum.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/3a41a6137a31a99141d24196a48cf4f93ed46f82/curriculum%2Fbuild-curriculum.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fbuild-curriculum.js?ref=3a41a6137a31a99141d24196a48cf4f93ed46f82",
            "patch": "@@ -11,7 +11,7 @@ const {\n } = require('./build-superblock');\n \n const { buildCertification } = require('./build-certification');\n-const { applyFilters } = require('./utils');\n+const { applyFilters, closestFilters } = require('./utils');\n const {\n   getContentDir,\n   getLanguageConfig,\n@@ -310,8 +310,10 @@ async function parseCurriculumStructure(filters) {\n   const superblockList = addBlockStructure(\n     addSuperblockStructure(curriculum.superblocks)\n   );\n+  const refinedFilters = closestFilters(filters, superblockList);\n+  const fullSuperblockList = applyFilters(superblockList, refinedFilters);\n   return {\n-    fullSuperblockList: applyFilters(superblockList, filters),\n+    fullSuperblockList,\n     certifications: curriculum.certifications\n   };\n }"
        },
        {
            "sha": "92157c2a6a15b50b04f09337c6b8236ba6b6ddb3",
            "filename": "curriculum/package.json",
            "status": "modified",
            "additions": 1,
            "deletions": 0,
            "changes": 1,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/3a41a6137a31a99141d24196a48cf4f93ed46f82/curriculum%2Fpackage.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/3a41a6137a31a99141d24196a48cf4f93ed46f82/curriculum%2Fpackage.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Fpackage.json?ref=3a41a6137a31a99141d24196a48cf4f93ed46f82",
            "patch": "@@ -43,6 +43,7 @@\n     \"@babel/core\": \"7.23.7\",\n     \"@babel/register\": \"7.23.7\",\n     \"@types/polka\": \"^0.5.7\",\n+    \"@types/string-similarity\": \"^4.0.2\",\n     \"@vitest/ui\": \"^3.2.4\",\n     \"chai\": \"4.4.1\",\n     \"glob\": \"8.1.0\","
        },
        {
            "sha": "ccf12b9ab869bf63c4a9eb226119b7b10c0161bc",
            "filename": "curriculum/utils.js",
            "status": "modified",
            "additions": 32,
            "deletions": 1,
            "changes": 33,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/3a41a6137a31a99141d24196a48cf4f93ed46f82/curriculum%2Futils.js",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/3a41a6137a31a99141d24196a48cf4f93ed46f82/curriculum%2Futils.js",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Futils.js?ref=3a41a6137a31a99141d24196a48cf4f93ed46f82",
            "patch": "@@ -1,4 +1,7 @@\n const path = require('path');\n+\n+const comparison = require('string-similarity');\n+\n const {\n   SuperBlocks,\n   generateSuperBlockList\n@@ -142,9 +145,37 @@ const applyFilters = createFilterPipeline([\n   filterByChallengeId\n ]);\n \n+function closestMatch(target, xs) {\n+  return comparison.findBestMatch(target.toLowerCase(), xs).bestMatch.target;\n+}\n+\n+function closestFilters(target, superblocks) {\n+  if (target?.superBlock) {\n+    const superblockNames = superblocks.map(({ name }) => name);\n+    return {\n+      ...target,\n+      superBlock: closestMatch(target.superBlock, superblockNames)\n+    };\n+  }\n+\n+  if (target?.block) {\n+    const blocks = superblocks.flatMap(({ blocks }) =>\n+      blocks.map(({ dashedName }) => dashedName)\n+    );\n+    return {\n+      ...target,\n+      block: closestMatch(target.block, blocks)\n+    };\n+  }\n+\n+  return target;\n+}\n+\n+exports.closestFilters = closestFilters;\n+exports.closestMatch = closestMatch;\n+exports.createSuperOrder = createSuperOrder;\n exports.filterByBlock = filterByBlock;\n exports.filterBySuperblock = filterBySuperblock;\n exports.filterByChallengeId = filterByChallengeId;\n-exports.createSuperOrder = createSuperOrder;\n exports.getSuperOrder = getSuperOrder;\n exports.applyFilters = applyFilters;"
        },
        {
            "sha": "27c0167f23cf0e615e25481fdc33c2aa88208050",
            "filename": "curriculum/utils.test.ts",
            "status": "modified",
            "additions": 217,
            "deletions": 139,
            "changes": 356,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/3a41a6137a31a99141d24196a48cf4f93ed46f82/curriculum%2Futils.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/3a41a6137a31a99141d24196a48cf4f93ed46f82/curriculum%2Futils.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/curriculum%2Futils.test.ts?ref=3a41a6137a31a99141d24196a48cf4f93ed46f82",
            "patch": "@@ -4,6 +4,8 @@ import { describe, it, expect } from 'vitest';\n \n import { SuperBlocks } from '../shared-dist/config/curriculum';\n import {\n+  closestFilters,\n+  closestMatch,\n   createSuperOrder,\n   filterByBlock,\n   filterByChallengeId,\n@@ -124,157 +126,233 @@ describe('getSuperOrder', () => {\n   });\n });\n \n-describe('filterByChallengeId', () => {\n-  it('returns the same superblocks if no challengeId is provided', () => {\n-    const superblocks = [\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-1', challengeOrder: [{ id: '1' }] }]\n-      },\n-      {\n-        name: 'superblock-2',\n-        blocks: [{ dashedName: 'block-2', challengeOrder: [{ id: '2' }] }]\n-      }\n-    ];\n-    expect(filterByChallengeId(superblocks)).toEqual(superblocks);\n-  });\n+describe('filter utils', () => {\n+  describe('filterByChallengeId', () => {\n+    it('returns the same superblocks if no challengeId is provided', () => {\n+      const superblocks = [\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-1', challengeOrder: [{ id: '1' }] }]\n+        },\n+        {\n+          name: 'superblock-2',\n+          blocks: [{ dashedName: 'block-2', challengeOrder: [{ id: '2' }] }]\n+        }\n+      ];\n+      expect(filterByChallengeId(superblocks)).toEqual(superblocks);\n+    });\n \n-  it('ignores blocks without the specified challengeId', () => {\n-    const superblocks = [\n-      {\n-        name: 'superblock-1',\n-        blocks: [\n-          { dashedName: 'block-1', challengeOrder: [{ id: '1' }] },\n-          { dashedName: 'block-2', challengeOrder: [{ id: '2' }] }\n-        ]\n-      }\n-    ];\n-    const filtered = filterByChallengeId(superblocks, { challengeId: '2' });\n-    expect(filtered).toEqual([\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-2', challengeOrder: [{ id: '2' }] }]\n-      }\n-    ]);\n-  });\n+    it('ignores blocks without the specified challengeId', () => {\n+      const superblocks = [\n+        {\n+          name: 'superblock-1',\n+          blocks: [\n+            { dashedName: 'block-1', challengeOrder: [{ id: '1' }] },\n+            { dashedName: 'block-2', challengeOrder: [{ id: '2' }] }\n+          ]\n+        }\n+      ];\n+      const filtered = filterByChallengeId(superblocks, { challengeId: '2' });\n+      expect(filtered).toEqual([\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-2', challengeOrder: [{ id: '2' }] }]\n+        }\n+      ]);\n+    });\n \n-  it('returns only the specified challenge and its solution challenge', () => {\n-    const superblocks = [\n-      {\n-        name: 'superblock-1',\n-        blocks: [\n-          {\n-            dashedName: 'block-1',\n-            challengeOrder: [{ id: '1' }, { id: '2' }, { id: '3' }]\n-          },\n-          { dashedName: 'block-2', challengeOrder: [{ id: '4' }] }\n-        ]\n-      }\n-    ];\n-    const filtered = filterByChallengeId(superblocks, { challengeId: '1' });\n-    expect(filtered).toEqual([\n-      {\n-        name: 'superblock-1',\n-        blocks: [\n-          { dashedName: 'block-1', challengeOrder: [{ id: '1' }, { id: '2' }] }\n-        ]\n-      }\n-    ]);\n-  });\n+    it('returns only the specified challenge and its solution challenge', () => {\n+      const superblocks = [\n+        {\n+          name: 'superblock-1',\n+          blocks: [\n+            {\n+              dashedName: 'block-1',\n+              challengeOrder: [{ id: '1' }, { id: '2' }, { id: '3' }]\n+            },\n+            { dashedName: 'block-2', challengeOrder: [{ id: '4' }] }\n+          ]\n+        }\n+      ];\n+      const filtered = filterByChallengeId(superblocks, { challengeId: '1' });\n+      expect(filtered).toEqual([\n+        {\n+          name: 'superblock-1',\n+          blocks: [\n+            {\n+              dashedName: 'block-1',\n+              challengeOrder: [{ id: '1' }, { id: '2' }]\n+            }\n+          ]\n+        }\n+      ]);\n+    });\n \n-  it('returns only superblocks containing the specified challenge', () => {\n-    const superblocks = [\n-      {\n-        name: 'superblock-1',\n-        blocks: [\n-          { dashedName: 'block-1', challengeOrder: [{ id: '1' }] },\n-          { dashedName: 'block-2', challengeOrder: [{ id: '2' }] }\n-        ]\n-      },\n-      {\n-        name: 'superblock-2',\n-        blocks: [{ dashedName: 'block-3', challengeOrder: [{ id: '3' }] }]\n-      }\n-    ];\n-    const filtered = filterByChallengeId(superblocks, { challengeId: '2' });\n-    expect(filtered).toEqual([\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-2', challengeOrder: [{ id: '2' }] }]\n-      }\n-    ]);\n+    it('returns only superblocks containing the specified challenge', () => {\n+      const superblocks = [\n+        {\n+          name: 'superblock-1',\n+          blocks: [\n+            { dashedName: 'block-1', challengeOrder: [{ id: '1' }] },\n+            { dashedName: 'block-2', challengeOrder: [{ id: '2' }] }\n+          ]\n+        },\n+        {\n+          name: 'superblock-2',\n+          blocks: [{ dashedName: 'block-3', challengeOrder: [{ id: '3' }] }]\n+        }\n+      ];\n+      const filtered = filterByChallengeId(superblocks, { challengeId: '2' });\n+      expect(filtered).toEqual([\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-2', challengeOrder: [{ id: '2' }] }]\n+        }\n+      ]);\n+    });\n   });\n-});\n \n-describe('filterByBlock', () => {\n-  it('returns the same superblocks if no block is provided', () => {\n-    const superblocks = [\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n-      }\n-    ];\n-    expect(filterByBlock(superblocks)).toEqual(superblocks);\n-  });\n+  describe('filterByBlock', () => {\n+    it('returns the same superblocks if no block is provided', () => {\n+      const superblocks = [\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n+        }\n+      ];\n+      expect(filterByBlock(superblocks)).toEqual(superblocks);\n+    });\n+\n+    it('returns only the specified block', () => {\n+      const superblocks = [\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n+        }\n+      ];\n+      const filtered = filterByBlock(superblocks, { block: 'block-1' });\n+      expect(filtered).toEqual([\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-1' }]\n+        }\n+      ]);\n+    });\n \n-  it('returns only the specified block', () => {\n-    const superblocks = [\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n-      }\n-    ];\n-    const filtered = filterByBlock(superblocks, { block: 'block-1' });\n-    expect(filtered).toEqual([\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-1' }]\n-      }\n-    ]);\n+    it('returns an empty array if no blocks match the specified block', () => {\n+      const superblocks = [\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n+        }\n+      ];\n+      const filtered = filterByBlock(superblocks, {\n+        block: 'nonexistent-block'\n+      });\n+      expect(filtered).toEqual([]);\n+    });\n   });\n \n-  it('returns an empty array if no blocks match the specified block', () => {\n-    const superblocks = [\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n-      }\n-    ];\n-    const filtered = filterByBlock(superblocks, { block: 'nonexistent-block' });\n-    expect(filtered).toEqual([]);\n+  describe('filterBySuperblock', () => {\n+    it('returns the same superblocks if no superBlock is provided', () => {\n+      const superblocks = [\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n+        }\n+      ];\n+      expect(filterBySuperblock(superblocks)).toEqual(superblocks);\n+    });\n+\n+    it('returns only the specified superblock', () => {\n+      const superblocks = [\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n+        },\n+        {\n+          name: 'superblock-2',\n+          blocks: [{ dashedName: 'block-3' }]\n+        }\n+      ];\n+      const filtered = filterBySuperblock(superblocks, {\n+        superBlock: 'superblock-1'\n+      });\n+      expect(filtered).toEqual([\n+        {\n+          name: 'superblock-1',\n+          blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n+        }\n+      ]);\n+    });\n   });\n-});\n \n-describe('filterBySuperblock', () => {\n-  it('returns the same superblocks if no superBlock is provided', () => {\n-    const superblocks = [\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n-      }\n-    ];\n-    expect(filterBySuperblock(superblocks)).toEqual(superblocks);\n+  describe('closestMatch', () => {\n+    it('returns the closest matching element', () => {\n+      const items = [\n+        'responsive-web-design',\n+        'javascript-algorithms-and-data-structures',\n+        'front-end-development-libraries',\n+        'data-visualization'\n+      ];\n+      const input = 'responsiv web design';\n+      const closest = 'responsive-web-design';\n+      expect(closestMatch(input, items)).toBe(closest);\n+    });\n+\n+    it('ignores case when finding the closest match', () => {\n+      const items = [\n+        'responsive-web-design',\n+        'ReSPonSivE-WeB-DeSiGne',\n+        'javascript-algorithms-and-data-structures',\n+        'front-end-development-libraries',\n+        'data-visualization'\n+      ];\n+      const input = 'ReSPonSiv WeB DeSiGn';\n+      const closest = 'responsive-web-design';\n+      expect(closestMatch(input, items)).toBe(closest);\n+    });\n   });\n \n-  it('returns only the specified superblock', () => {\n-    const superblocks = [\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n-      },\n-      {\n-        name: 'superblock-2',\n-        blocks: [{ dashedName: 'block-3' }]\n-      }\n-    ];\n-    const filtered = filterBySuperblock(superblocks, {\n-      superBlock: 'superblock-1'\n+  describe('closestFilters', () => {\n+    it('returns the closest matching superblock filter', () => {\n+      const superblocks = [\n+        {\n+          name: 'responsive-web-design',\n+          blocks: [\n+            { dashedName: 'basic-html-and-html5' },\n+            { dashedName: 'css-flexbox' }\n+          ]\n+        },\n+        {\n+          name: 'javascript-algorithms-and-data-structures',\n+          blocks: [{ dashedName: 'basic-javascript' }, { dashedName: 'es6' }]\n+        }\n+      ];\n+\n+      expect(\n+        closestFilters({ superBlock: 'responsiv web design' }, superblocks)\n+      ).toEqual({ superBlock: 'responsive-web-design' });\n+    });\n+\n+    it('returns the closest matching block filter', () => {\n+      const superblocks = [\n+        {\n+          name: 'responsive-web-design',\n+          blocks: [\n+            { dashedName: 'basic-html-and-html5' },\n+            { dashedName: 'css-flexbox' }\n+          ]\n+        },\n+        {\n+          name: 'javascript-algorithms-and-data-structures',\n+          blocks: [{ dashedName: 'basic-javascript' }, { dashedName: 'es6' }]\n+        }\n+      ];\n+\n+      expect(closestFilters({ block: 'basic-javascr' }, superblocks)).toEqual({\n+        block: 'basic-javascript'\n+      });\n     });\n-    expect(filtered).toEqual([\n-      {\n-        name: 'superblock-1',\n-        blocks: [{ dashedName: 'block-1' }, { dashedName: 'block-2' }]\n-      }\n-    ]);\n   });\n });"
        },
        {
            "sha": "2167fceb06157afd56b04b920745ceef68c6be21",
            "filename": "pnpm-lock.yaml",
            "status": "modified",
            "additions": 8,
            "deletions": 0,
            "changes": 8,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/3a41a6137a31a99141d24196a48cf4f93ed46f82/pnpm-lock.yaml",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/3a41a6137a31a99141d24196a48cf4f93ed46f82/pnpm-lock.yaml",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/pnpm-lock.yaml?ref=3a41a6137a31a99141d24196a48cf4f93ed46f82",
            "patch": "@@ -724,6 +724,9 @@ importers:\n       '@types/polka':\n         specifier: ^0.5.7\n         version: 0.5.7\n+      '@types/string-similarity':\n+        specifier: ^4.0.2\n+        version: 4.0.2\n       '@vitest/ui':\n         specifier: ^3.2.4\n         version: 3.2.4(vitest@3.2.4)\n@@ -4823,6 +4826,9 @@ packages:\n   '@types/store@2.0.5':\n     resolution: {integrity: sha512-5NmTKe3GWdOaykzq7no+Ahf6mafJu0oLc9JNhJ3E26+0oFvd6GnksnZQpMXcH526mfG4xDYjFiKzyDL51PzeWQ==}\n \n+  '@types/string-similarity@4.0.2':\n+    resolution: {integrity: sha512-LkJQ/jsXtCVMK+sKYAmX/8zEq+/46f1PTQw7YtmQwb74jemS1SlNLmARM2Zml9DgdDTWKAtc5L13WorpHPDjDA==}\n+\n   '@types/superagent@4.1.19':\n     resolution: {integrity: sha512-McM1mlc7PBZpCaw0fw/36uFqo0YeA6m8JqoyE4OfqXsZCIg0hPP2xdE6FM7r6fdprDZHlJwDpydUj1R++93hCA==}\n \n@@ -19850,6 +19856,8 @@ snapshots:\n \n   '@types/store@2.0.5': {}\n \n+  '@types/string-similarity@4.0.2': {}\n+\n   '@types/superagent@4.1.19':\n     dependencies:\n       '@types/cookiejar': 2.1.2"
        }
    ],
    "stats": {
        "total": 404,
        "additions": 262,
        "deletions": 142
    }
}