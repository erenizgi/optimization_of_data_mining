{
    "author": "ShaunSHamilton",
    "message": "feat(api): add public user route logs (#59124)",
    "sha": "6af8c1005e5fa21603dab2651776f20b16b3fc64",
    "files": [
        {
            "sha": "62f4da7b4f560efe2bb8f5f8cc801d0c50a1a1ba",
            "filename": "api/src/routes/public/user.ts",
            "status": "modified",
            "additions": 10,
            "deletions": 1,
            "changes": 11,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/6af8c1005e5fa21603dab2651776f20b16b3fc64/api%2Fsrc%2Froutes%2Fpublic%2Fuser.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/6af8c1005e5fa21603dab2651776f20b16b3fc64/api%2Fsrc%2Froutes%2Fpublic%2Fuser.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Froutes%2Fpublic%2Fuser.ts?ref=6af8c1005e5fa21603dab2651776f20b16b3fc64",
            "patch": "@@ -120,6 +120,8 @@ export const userPublicGetRoutes: FastifyPluginCallbackTypebox = (\n       }\n     },\n     async (req, reply) => {\n+      const logger = fastify.log.child({ req });\n+      logger.info({ username: req.query.username });\n       // TODO(Post-MVP): look for duplicates unless we can make username unique in the db.\n       const user = await fastify.prisma.user.findFirst({\n         where: { username: req.query.username }\n@@ -128,6 +130,7 @@ export const userPublicGetRoutes: FastifyPluginCallbackTypebox = (\n       });\n \n       if (!user) {\n+        logger.warn('User not found');\n         void reply.code(404);\n         return reply.send({});\n       }\n@@ -216,7 +219,10 @@ export const userPublicGetRoutes: FastifyPluginCallbackTypebox = (\n       attachValidation: true\n     },\n     async (req, reply) => {\n+      const logger = fastify.log.child({ req });\n+\n       if (req.validationError) {\n+        logger.warn({ validationError: req.validationError });\n         void reply.code(400);\n         // TODO(Post-MVP): return a message telling the requester that their\n         // request was malformed.\n@@ -225,7 +231,10 @@ export const userPublicGetRoutes: FastifyPluginCallbackTypebox = (\n \n       const username = req.query.username.toLowerCase();\n \n-      if (isRestricted(username)) return await reply.send({ exists: true });\n+      if (isRestricted(username)) {\n+        logger.info({ username }, 'Restricted username');\n+        return await reply.send({ exists: true });\n+      }\n \n       const exists =\n         (await fastify.prisma.user.count({"
        }
    ],
    "stats": {
        "total": 11,
        "additions": 10,
        "deletions": 1
    }
}