{
    "author": "Sembauke",
    "message": "fix: search conditional rendering (#57200)",
    "sha": "cb36adbade81e49f1e5bcfe92a8163305b5dd529",
    "files": [
        {
            "sha": "8ffcdaf487ea269e9efd12fb7f148591a0e22022",
            "filename": "client/src/components/Header/components/universal-nav.tsx",
            "status": "modified",
            "additions": 8,
            "deletions": 8,
            "changes": 16,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/cb36adbade81e49f1e5bcfe92a8163305b5dd529/client%2Fsrc%2Fcomponents%2FHeader%2Fcomponents%2Funiversal-nav.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/cb36adbade81e49f1e5bcfe92a8163305b5dd529/client%2Fsrc%2Fcomponents%2FHeader%2Fcomponents%2Funiversal-nav.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2FHeader%2Fcomponents%2Funiversal-nav.tsx?ref=cb36adbade81e49f1e5bcfe92a8163305b5dd529",
            "patch": "@@ -23,6 +23,7 @@ type UniversalNavProps = Omit<\n > & {\n   fetchState: { pending: boolean };\n   searchBarRef?: React.RefObject<HTMLDivElement>;\n+  pathname: string;\n };\n const UniversalNav = ({\n   displayMenu,\n@@ -31,21 +32,20 @@ const UniversalNav = ({\n   menuButtonRef,\n   searchBarRef,\n   user,\n-  fetchState\n+  fetchState,\n+  pathname\n }: UniversalNavProps): JSX.Element => {\n   const { pending } = fetchState;\n   const { t } = useTranslation();\n   const isSearchExposedWidth = useMediaQuery({\n     query: `(min-width: ${SEARCH_EXPOSED_WIDTH}px)`\n   });\n \n-  const search =\n-    typeof window !== `undefined` && isLanding(window.location.pathname) ? (\n-      <SearchBarOptimized innerRef={searchBarRef} />\n-    ) : (\n-      <SearchBar innerRef={searchBarRef} />\n-    );\n-\n+  const search = isLanding(pathname) ? (\n+    <SearchBarOptimized innerRef={searchBarRef} />\n+  ) : (\n+    <SearchBar innerRef={searchBarRef} />\n+  );\n   return (\n     <nav\n       aria-label={t('aria.primary-nav')}"
        },
        {
            "sha": "6b3da853264e5f25c9555448d1c71c4e9673479e",
            "filename": "client/src/components/Header/index.tsx",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/cb36adbade81e49f1e5bcfe92a8163305b5dd529/client%2Fsrc%2Fcomponents%2FHeader%2Findex.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/cb36adbade81e49f1e5bcfe92a8163305b5dd529/client%2Fsrc%2Fcomponents%2FHeader%2Findex.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2FHeader%2Findex.tsx?ref=cb36adbade81e49f1e5bcfe92a8163305b5dd529",
            "patch": "@@ -28,6 +28,7 @@ type Props = PropsFromRedux & {\n   fetchState: { pending: boolean };\n   user: User;\n   skipButtonText: string;\n+  pathname: string;\n };\n \n class Header extends React.Component<Props, { displayMenu: boolean }> {\n@@ -79,7 +80,8 @@ class Header extends React.Component<Props, { displayMenu: boolean }> {\n \n   render(): JSX.Element {\n     const { displayMenu } = this.state;\n-    const { examInProgress, fetchState, user, skipButtonText } = this.props;\n+    const { examInProgress, fetchState, user, skipButtonText, pathname } =\n+      this.props;\n     return (\n       <header className='site-header'>\n         <a\n@@ -96,6 +98,7 @@ class Header extends React.Component<Props, { displayMenu: boolean }> {\n             displayMenu={displayMenu}\n             fetchState={fetchState}\n             hideMenu={this.hideMenu}\n+            pathname={pathname}\n             menuButtonRef={this.menuButtonRef}\n             searchBarRef={this.searchBarRef}\n             showMenu={this.showMenu}"
        },
        {
            "sha": "e2e6a6fc1cea932e691cab25ba5ad81ca422e41d",
            "filename": "client/src/components/layouts/default.tsx",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/cb36adbade81e49f1e5bcfe92a8163305b5dd529/client%2Fsrc%2Fcomponents%2Flayouts%2Fdefault.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/cb36adbade81e49f1e5bcfe92a8163305b5dd529/client%2Fsrc%2Fcomponents%2Flayouts%2Fdefault.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2Flayouts%2Fdefault.tsx?ref=cb36adbade81e49f1e5bcfe92a8163305b5dd529",
            "patch": "@@ -136,6 +136,7 @@ function DefaultLayout({\n   superBlock,\n   theme,\n   user,\n+  pathname,\n   fetchUser\n }: DefaultLayoutProps): JSX.Element {\n   const { t } = useTranslation();\n@@ -269,6 +270,7 @@ function DefaultLayout({\n           <Header\n             fetchState={fetchState}\n             user={user}\n+            pathname={pathname}\n             skipButtonText={t('learn.skip-to-content')}\n           />\n           <OfflineWarning"
        },
        {
            "sha": "1cf70799462566d36b604f38c4d71eaef2528ccc",
            "filename": "e2e/search-bar-optimized.spec.ts",
            "status": "modified",
            "additions": 16,
            "deletions": 0,
            "changes": 16,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/cb36adbade81e49f1e5bcfe92a8163305b5dd529/e2e%2Fsearch-bar-optimized.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/cb36adbade81e49f1e5bcfe92a8163305b5dd529/e2e%2Fsearch-bar-optimized.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fsearch-bar-optimized.spec.ts?ref=cb36adbade81e49f1e5bcfe92a8163305b5dd529",
            "patch": "@@ -92,4 +92,20 @@ test.describe('Search bar optimized', () => {\n \n     await expect(searchInput).toHaveValue('');\n   });\n+\n+  test('The optimized searchbar component should not render when not on the landing page', async ({\n+    page,\n+    isMobile\n+  }) => {\n+    // This means that the default search bar should be rendered ^.\n+    await page.getByTestId('curriculum-map-button').nth(0).click();\n+\n+    if (isMobile) {\n+      const menuButton = page.getByTestId('header-menu-button');\n+      await expect(menuButton).toBeVisible();\n+      await menuButton.click();\n+    }\n+\n+    await expect(page.getByTestId('header-search')).toBeVisible();\n+  });\n });"
        }
    ],
    "stats": {
        "total": 39,
        "additions": 30,
        "deletions": 9
    }
}