{
    "author": "Sembauke",
    "message": "feat: convert multifile tests to Playwright (#54833)",
    "sha": "4811993716394a263de6a344abf744ed3cb199ad",
    "files": [
        {
            "sha": "272ca029333c6618bf11e595d682ceefe7e4a4e7",
            "filename": "cypress/e2e/default/learn/challenges/multifile.ts",
            "status": "removed",
            "additions": 0,
            "deletions": 92,
            "changes": 92,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/9b095072097815d199582114c99182b117b61160/cypress%2Fe2e%2Fdefault%2Flearn%2Fchallenges%2Fmultifile.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/9b095072097815d199582114c99182b117b61160/cypress%2Fe2e%2Fdefault%2Flearn%2Fchallenges%2Fmultifile.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/cypress%2Fe2e%2Fdefault%2Flearn%2Fchallenges%2Fmultifile.ts?ref=9b095072097815d199582114c99182b117b61160",
            "patch": "@@ -1,92 +0,0 @@\n-import translations from '../../../../../client/i18n/locales/english/translations.json';\n-const location =\n-  '/learn/2022/responsive-web-design/learn-accessibility-by-building-a-quiz/step-2';\n-const selectors = {\n-  monacoTabs: '.monaco-editor-tabs',\n-  signInButton: '[data-cy=sign-in-button]',\n-  submitLowerJawButton: '[data-cy=submit-lowerJaw-button]',\n-  checkLowerJawButton: '[data-cy=check-lowerJaw-button]',\n-  resetCodeButton: '[data-cy=reset-code-button]',\n-  instructionContainer: '.action-row-container'\n-};\n-\n-describe('Challenge with multifile editor', () => {\n-  beforeEach(() => {\n-    cy.visit(location);\n-  });\n-  it('renders correctly', () => {\n-    // it renders the file tab buttons\n-    cy.get(selectors.monacoTabs).contains('index.html');\n-    cy.get(selectors.monacoTabs).contains('styles.css');\n-\n-    // it checks for correct text at different widths\n-    cy.viewport(768, 660);\n-    cy.get(selectors.checkLowerJawButton).contains(\n-      'Check Your Code (Ctrl + Enter)'\n-    );\n-\n-    cy.viewport(767, 660);\n-    cy.get(selectors.checkLowerJawButton)\n-      .should('not.contain.text', '(Ctrl + Enter)')\n-      .contains('Check Your Code');\n-  });\n-\n-  it('resets the lower jaw when prompted', () => {\n-    cy.get('[data-cy=failing-test-feedback]').should('not.exist');\n-\n-    cy.contains('Check Your Code').click();\n-    cy.get('[data-cy=failing-test-feedback]').should('be.visible');\n-    cy.get(selectors.resetCodeButton).click();\n-    cy.get('[data-cy=reset-modal-confirm').click();\n-\n-    cy.get('[data-cy=failing-test-feedback]').should('not.exist');\n-  });\n-\n-  it('prompts unauthenticated user to sign in to save progress', () => {\n-    cy.focused()\n-      .click()\n-      .type('{end}{enter}<meta charset=\"UTF-8\" />')\n-      .type('{ctrl}{enter}', { release: false, delay: 100 });\n-    cy.get(selectors.signInButton).contains(translations.learn['sign-in-save']);\n-    cy.contains(translations.learn['congratulations']);\n-    cy.get(selectors.signInButton).click();\n-    cy.go('back');\n-    cy.get(selectors.signInButton).should('not.exist');\n-  });\n-\n-  it('focuses on the submit button after tests passed', () => {\n-    cy.focused().click().type('{end}{enter}<meta charset=\"UTF-8\" />');\n-    cy.get(selectors.checkLowerJawButton).should('not.be.focused');\n-    cy.get(selectors.checkLowerJawButton).click();\n-    cy.get(selectors.submitLowerJawButton).should('be.focused');\n-  });\n-\n-  it(\n-    'brings back the check button after reset',\n-    { browser: '!chrome' }, // TODO: seems to be a bug in Chrome, try again when a new version is released\n-    () => {\n-      cy.focused().click().type('{end}{enter}<meta charset=\"UTF-8\" />');\n-      cy.get(selectors.checkLowerJawButton).should('not.be.focused');\n-      cy.get(selectors.checkLowerJawButton).click();\n-      // Ready to submit (submit button replaces check button)\n-      cy.get(selectors.submitLowerJawButton).should('be.visible');\n-      cy.get(selectors.checkLowerJawButton).should('not.be.visible');\n-      // Reset\n-      cy.get(selectors.resetCodeButton).click();\n-      cy.get('[data-cy=reset-modal-confirm').click();\n-      // First we need to click on the description or Cypress will not be able\n-      // to scroll to the button\n-      cy.get('.editor-upper-jaw').click();\n-      cy.get(selectors.checkLowerJawButton).should('be.visible');\n-      cy.get(selectors.submitLowerJawButton).should('not.be.visible');\n-    }\n-  );\n-\n-  it('checks hotkeys when instruction is focused', () => {\n-    cy.focused().type('{end}{enter}<meta charset=\"UTF-8\" />');\n-    cy.get(selectors.instructionContainer)\n-      .click('topRight')\n-      .trigger('keydown', { ctrlKey: true, keyCode: 13 }); // keyCode : 13 enter key\n-    cy.get(selectors.submitLowerJawButton).should('not.be.focused');\n-  });\n-});"
        },
        {
            "sha": "8b79cbfe6720572a76ab0fc65c5193ab84861086",
            "filename": "e2e/lower-jaw.spec.ts",
            "status": "modified",
            "additions": 93,
            "deletions": 3,
            "changes": 96,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/4811993716394a263de6a344abf744ed3cb199ad/e2e%2Flower-jaw.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/4811993716394a263de6a344abf744ed3cb199ad/e2e%2Flower-jaw.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Flower-jaw.spec.ts?ref=4811993716394a263de6a344abf744ed3cb199ad",
            "patch": "@@ -1,4 +1,6 @@\n import { test, expect } from '@playwright/test';\n+import { clearEditor, focusEditor, getEditors } from './utils/editor';\n+import { signout } from './utils/logout';\n \n test.beforeEach(async ({ page }) => {\n   await page.goto(\n@@ -29,13 +31,101 @@ test('Click on the \"check your code\" button', async ({ page }) => {\n   await expect(hint).toBeVisible();\n });\n \n-test('Click on the \"Reset\" button', async ({ page }) => {\n-  const resetButton = page.getByTestId('lowerJaw-reset-button');\n-  await resetButton.click();\n+test('Resets the lower jaw when prompted', async ({ page }) => {\n+  const checkButton = page.getByRole('button', { name: 'Check Your Code' });\n+\n+  await checkButton.click();\n+\n+  const failing = page.getByTestId('lowerJaw-failing-test-feedback');\n+  const hint = page.getByTestId('lowerJaw-failing-hint');\n+  await expect(failing).toBeVisible();\n+  await expect(hint).toBeVisible();\n+\n+  await page.getByRole('button', { name: 'Reset' }).click();\n \n   await expect(\n     page.getByRole('dialog', { name: 'Reset this lesson?' })\n   ).toBeVisible();\n+\n+  await page.getByRole('button', { name: 'Reset this lesson' }).click();\n+  await expect(failing).not.toBeVisible();\n+  await expect(hint).not.toBeVisible();\n+\n+  await expect(checkButton).toBeVisible();\n+});\n+\n+test('Checks hotkeys when instruction is focused', async ({\n+  page,\n+  browserName\n+}) => {\n+  const editor = getEditors(page);\n+  const checkButton = page.getByRole('button', { name: 'Check Your Code' });\n+  const description = page.locator('#description');\n+\n+  await editor.fill(\n+    '<h2>Cat Photos</h2>\\n<p>See more cat photos in our gallery.</p>'\n+  );\n+\n+  await description.click();\n+\n+  if (browserName === 'webkit') {\n+    await page.keyboard.press('Meta+Enter');\n+  } else {\n+    await page.keyboard.press('Control+Enter');\n+  }\n+\n+  await expect(checkButton).not.toBeFocused();\n+});\n+\n+test('Focuses on the submit button after tests passed', async ({\n+  page,\n+  browserName,\n+  isMobile\n+}) => {\n+  const editor = getEditors(page);\n+  const checkButton = page.getByRole('button', { name: 'Check Your Code' });\n+  const submitButton = page.getByRole('button', {\n+    name: 'Submit and go to next challenge'\n+  });\n+  await focusEditor({ page, browserName, isMobile });\n+  await clearEditor({ page, browserName });\n+\n+  await editor.fill(\n+    '<h2>Cat Photos</h2>\\n<p>See more cat photos in our gallery.</p>'\n+  );\n+  await checkButton.click();\n+\n+  await expect(submitButton).toBeFocused();\n+});\n+\n+test('Prompts unauthenticated user to sign in to save progress', async ({\n+  page,\n+  browserName,\n+  isMobile\n+}) => {\n+  await signout(page);\n+  await page.reload();\n+  const editor = getEditors(page);\n+  const checkButton = page.getByRole('button', { name: 'Check Your Code' });\n+  const loginButton = page.getByRole('link', {\n+    name: 'Sign in to save your progress'\n+  });\n+  await focusEditor({ page, browserName, isMobile });\n+  await clearEditor({ page, browserName });\n+\n+  await editor.fill(\n+    '<h2>Cat Photos</h2>\\n<p>See more cat photos in our gallery.</p>'\n+  );\n+\n+  await checkButton.click();\n+\n+  await expect(loginButton).toBeVisible();\n+\n+  await loginButton.click();\n+\n+  await page.goBack();\n+\n+  await expect(loginButton).not.toBeVisible();\n });\n \n test('Should render UI correctly', async ({ page }) => {"
        }
    ],
    "stats": {
        "total": 188,
        "additions": 93,
        "deletions": 95
    }
}