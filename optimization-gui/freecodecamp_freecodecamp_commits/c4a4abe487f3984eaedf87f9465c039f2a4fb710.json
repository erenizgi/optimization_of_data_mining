{
    "author": "a2937",
    "message": "fix(tools): allow more chapter based superblocks (#62203)",
    "sha": "c4a4abe487f3984eaedf87f9465c039f2a4fb710",
    "files": [
        {
            "sha": "56c14f941266a1550754c553e96087318a29308a",
            "filename": "tools/challenge-helper-scripts/create-project.ts",
            "status": "modified",
            "additions": 49,
            "deletions": 20,
            "changes": 69,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c4a4abe487f3984eaedf87f9465c039f2a4fb710/tools%2Fchallenge-helper-scripts%2Fcreate-project.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c4a4abe487f3984eaedf87f9465c039f2a4fb710/tools%2Fchallenge-helper-scripts%2Fcreate-project.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fcreate-project.ts?ref=c4a4abe487f3984eaedf87f9465c039f2a4fb710",
            "patch": "@@ -5,8 +5,10 @@ import { prompt } from 'inquirer';\n import { format } from 'prettier';\n import ObjectID from 'bson-objectid';\n \n-import fullStackData from '../../curriculum/structure/superblocks/full-stack-developer.json';\n-import { SuperBlocks } from '../../shared/config/curriculum';\n+import {\n+  SuperBlocks,\n+  chapterBasedSuperBlocks\n+} from '../../shared/config/curriculum';\n import { BlockLayouts, BlockTypes } from '../../shared/config/blocks';\n import {\n   getContentConfig,\n@@ -17,6 +19,7 @@ import { createQuizFile, createStepFile, validateBlockName } from './utils';\n import { getBaseMeta } from './helpers/get-base-meta';\n import { createIntroMD } from './helpers/create-intro';\n import {\n+  ChapterModuleSuperblockStructure,\n   updateChapterModuleSuperblockStructure,\n   updateSimpleSuperblockStructure\n } from './helpers/create-project';\n@@ -71,7 +74,7 @@ async function createProject(projectArgs: CreateProjectArgs) {\n     superBlockToFilename as Record<SuperBlocks, string>\n   )[projectArgs.superBlock];\n \n-  if (projectArgs.superBlock === SuperBlocks.FullStackDeveloper) {\n+  if (chapterBasedSuperBlocks.includes(projectArgs.superBlock)) {\n     if (!chapter || !module || typeof position == 'undefined') {\n       throw Error(\n         'Missing one of the following arguments: chapter, module, position'\n@@ -133,7 +136,7 @@ async function createProject(projectArgs: CreateProjectArgs) {\n   }\n \n   if (\n-    (projectArgs.superBlock === SuperBlocks.FullStackDeveloper &&\n+    (chapterBasedSuperBlocks.includes(projectArgs.superBlock) &&\n       projectArgs.blockType) == null\n   ) {\n     throw new Error('Missing argument: blockType when updating intro markdown');\n@@ -178,7 +181,7 @@ async function createMetaJson(\n   blockLayout?: string\n ) {\n   let newMeta;\n-  if (superBlock === SuperBlocks.FullStackDeveloper) {\n+  if (chapterBasedSuperBlocks.includes(superBlock)) {\n     newMeta = getBaseMeta('FullStack');\n     newMeta.blockType = blockType;\n     newMeta.blockLayout = blockLayout;\n@@ -262,6 +265,31 @@ function withTrace<Args extends unknown[], Result>(\n   });\n }\n \n+async function getChapters(superBlock: string) {\n+  const blockMetaFile = await fs.readFile(\n+    '../../curriculum/structure/superblocks/' + superBlock + '.json',\n+    { encoding: 'utf8' }\n+  );\n+  const blockMetaData = JSON.parse(\n+    blockMetaFile\n+  ) as ChapterModuleSuperblockStructure;\n+  return blockMetaData.chapters;\n+}\n+\n+async function getModules(superBlock: string, chapterName: string) {\n+  const blockMetaFile = await fs.readFile(\n+    '../../curriculum/structure/superblocks/' + superBlock + '.json',\n+    { encoding: 'utf8' }\n+  );\n+  const blockMetaData = JSON.parse(\n+    blockMetaFile\n+  ) as ChapterModuleSuperblockStructure;\n+  const modifiedChapter = blockMetaData.chapters.find(\n+    x => x.dashedName === chapterName\n+  );\n+  return modifiedChapter?.modules;\n+}\n+\n void prompt([\n   {\n     name: 'superBlock',\n@@ -296,7 +324,7 @@ void prompt([\n     type: 'list',\n     choices: Object.values(BlockTypes),\n     when: (answers: CreateProjectArgs) =>\n-      answers.superBlock === SuperBlocks.FullStackDeveloper\n+      chapterBasedSuperBlocks.includes(answers.superBlock)\n   },\n   {\n     name: 'blockLayout',\n@@ -309,7 +337,7 @@ void prompt([\n     type: 'list',\n     choices: Object.values(BlockLayouts),\n     when: (answers: CreateProjectArgs) =>\n-      answers.superBlock === SuperBlocks.FullStackDeveloper\n+      chapterBasedSuperBlocks.includes(answers.superBlock)\n   },\n   {\n     name: 'questionCount',\n@@ -321,26 +349,27 @@ void prompt([\n   },\n   {\n     name: 'chapter',\n-    message:\n-      'What chapter in full-stack.json should this full stack project go in?',\n+    message: 'What chapter should this project go in?',\n     default: 'html',\n     type: 'list',\n-    choices: fullStackData.chapters.map(x => x.dashedName),\n+    choices: async (answers: CreateProjectArgs) => {\n+      const chapters = await getChapters(answers.superBlock);\n+      return chapters.map(x => x.dashedName);\n+    },\n     when: (answers: CreateProjectArgs) =>\n-      answers.superBlock === SuperBlocks.FullStackDeveloper\n+      chapterBasedSuperBlocks.includes(answers.superBlock)\n   },\n   {\n     name: 'module',\n-    message:\n-      'What module in full-stack.json should this full stack project go in?',\n+    message: 'What module should this project go in?',\n     default: 'html',\n     type: 'list',\n-    choices: (answers: CreateProjectArgs) =>\n-      fullStackData.chapters\n-        .find(x => x.dashedName === answers.chapter)\n-        ?.modules.map(x => x.dashedName),\n+    choices: async (answers: CreateProjectArgs) => {\n+      const modules = await getModules(answers.superBlock, answers.chapter!);\n+      return modules!.map(x => x.dashedName);\n+    },\n     when: (answers: CreateProjectArgs) =>\n-      answers.superBlock === SuperBlocks.FullStackDeveloper\n+      chapterBasedSuperBlocks.includes(answers.superBlock)\n   },\n   {\n     name: 'position',\n@@ -352,7 +381,7 @@ void prompt([\n         : 'Position must be an number greater than zero.';\n     },\n     when: (answers: CreateProjectArgs) =>\n-      answers.superBlock === SuperBlocks.FullStackDeveloper,\n+      chapterBasedSuperBlocks.includes(answers.superBlock),\n     filter: (position: string) => {\n       return parseInt(position, 10);\n     }\n@@ -367,7 +396,7 @@ void prompt([\n         : 'Order must be an number greater than zero.';\n     },\n     when: (answers: CreateProjectArgs) =>\n-      answers.superBlock !== SuperBlocks.FullStackDeveloper,\n+      !chapterBasedSuperBlocks.includes(answers.superBlock),\n     filter: (order: string) => {\n       return parseInt(order, 10);\n     }"
        },
        {
            "sha": "05f36624077ddac608649ada428af7bba797942c",
            "filename": "tools/challenge-helper-scripts/helpers/create-project.ts",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/c4a4abe487f3984eaedf87f9465c039f2a4fb710/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fcreate-project.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/c4a4abe487f3984eaedf87f9465c039f2a4fb710/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fcreate-project.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/tools%2Fchallenge-helper-scripts%2Fhelpers%2Fcreate-project.ts?ref=c4a4abe487f3984eaedf87f9465c039f2a4fb710",
            "patch": "@@ -45,7 +45,7 @@ function createNewModule(module: string, block: string) {\n   };\n }\n \n-type ChapterModuleSuperblockStructure = {\n+export type ChapterModuleSuperblockStructure = {\n   chapters: {\n     dashedName: string;\n     modules: {"
        }
    ],
    "stats": {
        "total": 71,
        "additions": 50,
        "deletions": 21
    }
}