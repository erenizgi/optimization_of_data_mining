{
    "author": "ojeytonwilliams",
    "message": "test(api): flaky rate-limit test (#56120)",
    "sha": "5c4fd56e6074fa257766d5f16dd7ed2e191fede9",
    "files": [
        {
            "sha": "c053f05b73b251ae431737d268c0fb47005aff08",
            "filename": "api/src/routes/auth.test.ts",
            "status": "modified",
            "additions": 9,
            "deletions": 5,
            "changes": 14,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/5c4fd56e6074fa257766d5f16dd7ed2e191fede9/api%2Fsrc%2Froutes%2Fauth.test.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/5c4fd56e6074fa257766d5f16dd7ed2e191fede9/api%2Fsrc%2Froutes%2Fauth.test.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/api%2Fsrc%2Froutes%2Fauth.test.ts?ref=5c4fd56e6074fa257766d5f16dd7ed2e191fede9",
            "patch": "@@ -61,12 +61,16 @@ describe('auth0 routes', () => {\n     });\n \n     it('should be rate-limited', async () => {\n-      await Promise.all(\n-        [...Array(10).keys()].map(() => superGet('/mobile-login'))\n-      );\n-\n+      // Rather than spamming the endpoint, we can check the headers.\n       const res = await superGet('/mobile-login');\n-      expect(res.status).toBe(429);\n+      // These headers are semi-official\n+      // https://www.ietf.org/archive/id/draft-polli-ratelimit-headers-02.html\n+      // so should not depend on the details of the rate-limiting library\n+      expect(res.headers['ratelimit-limit']).toBe('10');\n+      expect(res.headers['ratelimit-remaining']).toBe('9');\n+\n+      const res2 = await superGet('/mobile-login');\n+      expect(res2.headers['ratelimit-remaining']).toBe('8');\n     });\n \n     it('should return 401 if the authorization header is invalid', async () => {"
        }
    ],
    "stats": {
        "total": 14,
        "additions": 9,
        "deletions": 5
    }
}