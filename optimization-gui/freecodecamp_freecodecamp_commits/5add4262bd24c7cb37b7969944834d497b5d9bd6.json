{
    "author": "ojeytonwilliams",
    "message": "refactor(client): use different challenges component in different blocks (#59479)",
    "sha": "5add4262bd24c7cb37b7969944834d497b5d9bd6",
    "files": [
        {
            "sha": "1492ba8f53a0737887af94e9f480a65fb6371c70",
            "filename": "client/src/templates/Introduction/components/block.tsx",
            "status": "modified",
            "additions": 64,
            "deletions": 20,
            "changes": 84,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/5add4262bd24c7cb37b7969944834d497b5d9bd6/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/5add4262bd24c7cb37b7969944834d497b5d9bd6/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fblock.tsx?ref=5add4262bd24c7cb37b7969944834d497b5d9bd6",
            "patch": "@@ -25,7 +25,11 @@ import {\n   BlockTypes\n } from '../../../../../shared-dist/config/blocks';\n import CheckMark from './check-mark';\n-import Challenges from './challenges';\n+import {\n+  GridMapChallenges,\n+  ChallengesList,\n+  ChallengesWithDialogues\n+} from './challenges';\n import BlockLabel from './block-label';\n import BlockIntros from './block-intros';\n import BlockHeader from './block-header';\n@@ -220,12 +224,7 @@ export class Block extends Component<BlockProps> {\n               </span>\n             </div>\n           </button>\n-          {isExpanded && (\n-            <Challenges\n-              challenges={extendedChallenges}\n-              isProjectBlock={isProjectBlock}\n-            />\n-          )}\n+          {isExpanded && <ChallengesList challenges={extendedChallenges} />}\n         </div>\n       </ScrollableAnchor>\n     );\n@@ -257,10 +256,7 @@ export class Block extends Component<BlockProps> {\n             )}\n           </div>\n           <BlockIntros intros={blockIntroArr} />\n-          <Challenges\n-            challenges={extendedChallenges}\n-            isProjectBlock={isProjectBlock}\n-          />\n+          <ChallengesList challenges={extendedChallenges} />\n         </div>\n       </ScrollableAnchor>\n     );\n@@ -304,10 +300,55 @@ export class Block extends Component<BlockProps> {\n \n               <div id={`${block}-panel`}>\n                 <BlockIntros intros={blockIntroArr} />\n-                <Challenges\n+                <GridMapChallenges\n                   challenges={extendedChallenges}\n                   isProjectBlock={isProjectBlock}\n-                  isGridMap={true}\n+                  blockTitle={blockTitle}\n+                />\n+              </div>\n+            </>\n+          )}\n+        </div>\n+      </ScrollableAnchor>\n+    );\n+\n+    /**\n+     * TaskGridBlock displays tasks in a grid and dialogues separately.\n+     * This layout is used for task-based blocks.\n+     * Example: https://www.freecodecamp.org/learn/a2-english-for-developers/#learn-greetings-in-your-first-day-at-the-office\n+     */\n+    const TaskGridBlock = (\n+      <ScrollableAnchor id={block}>\n+        <div className={`block block-grid ${isExpanded ? 'open' : ''}`}>\n+          <BlockHeader\n+            blockDashed={block}\n+            blockTitle={blockTitle}\n+            blockType={blockType}\n+            completedCount={completedCount}\n+            courseCompletionStatus={courseCompletionStatus()}\n+            handleClick={this.handleBlockClick}\n+            isCompleted={isBlockCompleted}\n+            isExpanded={isExpanded}\n+            percentageCompleted={percentageCompleted}\n+          />\n+\n+          {isExpanded && (\n+            <>\n+              {!isAudited && (\n+                <div className='tags-wrapper'>\n+                  <Link\n+                    className='cert-tag'\n+                    to={t('links:help-translate-link-url')}\n+                  >\n+                    {t('misc.translation-pending')}\n+                  </Link>\n+                </div>\n+              )}\n+\n+              <div id={`${block}-panel`}>\n+                <BlockIntros intros={blockIntroArr} />\n+                <ChallengesWithDialogues\n+                  challenges={extendedChallenges}\n                   blockTitle={blockTitle}\n                 />\n               </div>\n@@ -412,12 +453,15 @@ export class Block extends Component<BlockProps> {\n                 id={`${block}-panel`}\n                 className={isGridBlock ? 'challenge-grid-block-panel' : ''}\n               >\n-                <Challenges\n-                  challenges={extendedChallenges}\n-                  isProjectBlock={false}\n-                  isGridMap={isGridBlock}\n-                  blockTitle={blockTitle}\n-                />\n+                {isGridBlock ? (\n+                  <GridMapChallenges\n+                    challenges={extendedChallenges}\n+                    blockTitle={blockTitle}\n+                    isProjectBlock={isProjectBlock}\n+                  />\n+                ) : (\n+                  <ChallengesList challenges={extendedChallenges} />\n+                )}\n               </div>\n             </div>\n           )}\n@@ -433,7 +477,7 @@ export class Block extends Component<BlockProps> {\n       [BlockLayouts.LegacyLink]: LegacyLinkBlock,\n       [BlockLayouts.LegacyChallengeList]: LegacyChallengeListBlock,\n       [BlockLayouts.LegacyChallengeGrid]: LegacyChallengeGridBlock,\n-      [BlockLayouts.DialogueGrid]: LegacyChallengeGridBlock\n+      [BlockLayouts.DialogueGrid]: TaskGridBlock\n     };\n \n     return ("
        },
        {
            "sha": "d686c43d7fa1855461b501a6f7446340b42173d7",
            "filename": "client/src/templates/Introduction/components/challenges.tsx",
            "status": "modified",
            "additions": 96,
            "deletions": 58,
            "changes": 154,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/5add4262bd24c7cb37b7969944834d497b5d9bd6/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fchallenges.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/5add4262bd24c7cb37b7969944834d497b5d9bd6/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fchallenges.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Ftemplates%2FIntroduction%2Fcomponents%2Fchallenges.tsx?ref=5add4262bd24c7cb37b7969944834d497b5d9bd6",
            "patch": "@@ -1,5 +1,5 @@\n import React from 'react';\n-import { withTranslation, useTranslation } from 'react-i18next';\n+import { useTranslation } from 'react-i18next';\n \n import GreenNotCompleted from '../../../assets/icons/green-not-completed';\n import GreenPass from '../../../assets/icons/green-pass';\n@@ -18,11 +18,16 @@ interface ChallengeInfo {\n   challengeType: number;\n }\n \n-interface Challenges {\n+interface ChallengesProps {\n   challenges: ChallengeInfo[];\n+}\n+\n+interface BlockTitleProps {\n+  blockTitle: string;\n+}\n+\n+interface IsProjectBlockProps {\n   isProjectBlock: boolean;\n-  isGridMap?: boolean;\n-  blockTitle?: string | null;\n }\n \n const CheckMark = ({ isCompleted }: { isCompleted: boolean }) =>\n@@ -46,21 +51,40 @@ const CertChallenge = ({ challenge }: { challenge: ChallengeInfo }) => (\n   </Link>\n );\n \n+export function ChallengesList({ challenges }: ChallengesProps): JSX.Element {\n+  return (\n+    <ul className={`map-challenges-ul`}>\n+      {challenges.map(challenge => (\n+        <li\n+          className={'map-challenge-title map-challenge-wrap'}\n+          id={challenge.dashedName}\n+          key={'map-challenge' + challenge.fields.slug}\n+        >\n+          <ListChallenge challenge={challenge} />\n+        </li>\n+      ))}\n+    </ul>\n+  );\n+}\n // Step or Task challenge\n-const GridChallenge = ({ challenge }: { challenge: ChallengeInfo }) => {\n+const GridChallenge = ({\n+  challenge,\n+  isTask = false\n+}: {\n+  challenge: ChallengeInfo;\n+  isTask?: boolean;\n+}) => {\n   const { t } = useTranslation();\n \n   return (\n     <Link\n       to={challenge.fields.slug}\n       className={`map-grid-item ${\n-        +challenge.isCompleted ? 'challenge-completed' : ''\n+        challenge.isCompleted ? 'challenge-completed' : ''\n       }`}\n     >\n       <span className='sr-only'>\n-        {challenge.superBlock === SuperBlocks.A2English\n-          ? t('aria.task')\n-          : t('aria.step')}\n+        {isTask ? t('aria.task') : t('aria.step')}\n       </span>\n       <span>{challenge.stepNumber}</span>\n       <span className='sr-only'>\n@@ -70,12 +94,10 @@ const GridChallenge = ({ challenge }: { challenge: ChallengeInfo }) => {\n   );\n };\n \n-function Challenges({\n+const LinkToFirstIncompleteChallenge = ({\n   challenges,\n-  isProjectBlock,\n-  isGridMap = false,\n   blockTitle\n-}: Challenges): JSX.Element {\n+}: ChallengesProps & BlockTitleProps) => {\n   const { t } = useTranslation();\n \n   const firstIncompleteChallenge = challenges.find(\n@@ -85,28 +107,32 @@ function Challenges({\n   const isChallengeStarted = !!challenges.find(\n     challenge => challenge.isCompleted\n   );\n+  return firstIncompleteChallenge ? (\n+    <div className='challenge-jump-link'>\n+      <ButtonLink size='small' href={firstIncompleteChallenge.fields.slug}>\n+        {!isChallengeStarted\n+          ? t('buttons.start-project')\n+          : t('buttons.resume-project')}{' '}\n+        <span className='sr-only'>{blockTitle}</span>\n+      </ButtonLink>\n+    </div>\n+  ) : null;\n+};\n \n-  return isGridMap ? (\n+export const GridMapChallenges = ({\n+  challenges,\n+  blockTitle,\n+  isProjectBlock\n+}: ChallengesProps & BlockTitleProps & IsProjectBlockProps) => {\n+  const { t } = useTranslation();\n+\n+  return (\n     <>\n-      {firstIncompleteChallenge && (\n-        <div className='challenge-jump-link'>\n-          <ButtonLink size='small' href={firstIncompleteChallenge.fields.slug}>\n-            {!isChallengeStarted\n-              ? t('buttons.start-project')\n-              : t('buttons.resume-project')}{' '}\n-            {blockTitle && <span className='sr-only'>{blockTitle}</span>}\n-          </ButtonLink>\n-        </div>\n-      )}\n-      <nav\n-        aria-label={\n-          blockTitle\n-            ? challenges[0].superBlock === SuperBlocks.A2English\n-              ? t('aria.dialogues-and-tasks-for', { blockTitle })\n-              : t('aria.steps-for', { blockTitle })\n-            : t('aria.steps')\n-        }\n-      >\n+      <LinkToFirstIncompleteChallenge\n+        challenges={challenges}\n+        blockTitle={blockTitle}\n+      />\n+      <nav aria-label={t('aria.steps-for', { blockTitle })}>\n         <ul className={`map-challenges-ul map-challenges-grid`}>\n           {challenges.map(challenge => (\n             <li\n@@ -120,11 +146,8 @@ function Challenges({\n               id={challenge.dashedName}\n               key={`map-challenge ${challenge.fields.slug}`}\n             >\n-              {!isProjectBlock &&\n-              challenge.challengeType !== challengeTypes.dialogue ? (\n+              {!isProjectBlock ? (\n                 <GridChallenge challenge={challenge} />\n-              ) : challenge.challengeType === challengeTypes.dialogue ? (\n-                <ListChallenge challenge={challenge} />\n               ) : (\n                 <CertChallenge challenge={challenge} />\n               )}\n@@ -133,27 +156,42 @@ function Challenges({\n         </ul>\n       </nav>\n     </>\n-  ) : (\n-    <ul className={`map-challenges-ul`}>\n-      {challenges.map(challenge => (\n-        <li\n-          className={`map-challenge-title ${\n-            isProjectBlock ? 'map-project-wrap' : 'map-challenge-wrap'\n-          }`}\n-          id={challenge.dashedName}\n-          key={'map-challenge' + challenge.fields.slug}\n-        >\n-          {!isProjectBlock ? (\n-            <ListChallenge challenge={challenge} />\n-          ) : (\n-            <CertChallenge challenge={challenge} />\n-          )}\n-        </li>\n-      ))}\n-    </ul>\n   );\n-}\n+};\n \n-Challenges.displayName = 'Challenges';\n+export const ChallengesWithDialogues = ({\n+  challenges,\n+  blockTitle\n+}: ChallengesProps & BlockTitleProps) => {\n+  const { t } = useTranslation();\n \n-export default withTranslation()(Challenges);\n+  return (\n+    <>\n+      <LinkToFirstIncompleteChallenge\n+        challenges={challenges}\n+        blockTitle={blockTitle}\n+      />\n+      <nav aria-label={t('aria.dialogues-and-tasks-for', { blockTitle })}>\n+        <ul className={`map-challenges-ul map-challenges-grid`}>\n+          {challenges.map(challenge => (\n+            <li\n+              className={`map-challenge-title map-challenge-title-grid ${\n+                challenge.challengeType === challengeTypes.dialogue\n+                  ? 'map-dialogue-wrap'\n+                  : 'map-challenge-wrap'\n+              }`}\n+              id={challenge.dashedName}\n+              key={`map-challenge ${challenge.fields.slug}`}\n+            >\n+              {challenge.challengeType === challengeTypes.dialogue ? (\n+                <ListChallenge challenge={challenge} />\n+              ) : (\n+                <GridChallenge challenge={challenge} isTask />\n+              )}\n+            </li>\n+          ))}\n+        </ul>\n+      </nav>\n+    </>\n+  );\n+};"
        }
    ],
    "stats": {
        "total": 238,
        "additions": 160,
        "deletions": 78
    }
}