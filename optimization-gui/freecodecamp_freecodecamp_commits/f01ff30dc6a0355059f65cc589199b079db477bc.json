{
    "author": "gagan-bhullar-tech",
    "message": "fix(ui): confirmation safeguard danger zone (#55724)\n\nCo-authored-by: Tom <20648924+moT01@users.noreply.github.com>",
    "sha": "f01ff30dc6a0355059f65cc589199b079db477bc",
    "files": [
        {
            "sha": "e4568923ca92a396b3cd38d94e621da77babe6d3",
            "filename": "client/i18n/locales/english/translations.json",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/f01ff30dc6a0355059f65cc589199b079db477bc/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/f01ff30dc6a0355059f65cc589199b079db477bc/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fi18n%2Flocales%2Fenglish%2Ftranslations.json?ref=f01ff30dc6a0355059f65cc589199b079db477bc",
            "patch": "@@ -275,7 +275,10 @@\n       \"reset-p2\": \"You will effectively be set back to the very first day you signed up.\",\n       \"reset-p3\": \"We won't be able to recover any of it for you later, even if you change your mind.\",\n       \"nevermind-2\": \"Nevermind, I don't want to delete all of my progress\",\n-      \"reset-confirm\": \"Reset everything. I want to start from the beginning\"\n+      \"reset-confirm\": \"Reset everything. I want to start from the beginning\",\n+      \"verify-text\": \"To verify, type \\\"{{ verifyText }}\\\" below:\",\n+      \"verify-reset-text\": \"I agree that all progress will be lost\",\n+      \"verify-delete-text\": \"I agree to delete my account\"\n     },\n     \"email\": {\n       \"missing\": \"You do not have an email associated with this account.\","
        },
        {
            "sha": "b1d83abeb27a3a4568071d30cc0005346893cf56",
            "filename": "client/src/components/settings/delete-modal.tsx",
            "status": "modified",
            "additions": 31,
            "deletions": 2,
            "changes": 33,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/f01ff30dc6a0355059f65cc589199b079db477bc/client%2Fsrc%2Fcomponents%2Fsettings%2Fdelete-modal.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/f01ff30dc6a0355059f65cc589199b079db477bc/client%2Fsrc%2Fcomponents%2Fsettings%2Fdelete-modal.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2Fsettings%2Fdelete-modal.tsx?ref=f01ff30dc6a0355059f65cc589199b079db477bc",
            "patch": "@@ -1,6 +1,12 @@\n-import React from 'react';\n+import React, { useState } from 'react';\n import { Trans, useTranslation } from 'react-i18next';\n-import { Button, Modal } from '@freecodecamp/ui';\n+import {\n+  Button,\n+  ControlLabel,\n+  FormControl,\n+  FormGroup,\n+  Modal\n+} from '@freecodecamp/ui';\n \n import { Spacer } from '../helpers';\n \n@@ -14,6 +20,14 @@ function DeleteModal(props: DeleteModalProps): JSX.Element {\n   const { show, onHide } = props;\n   const email = 'support@freecodecamp.org';\n   const { t } = useTranslation();\n+  const [verifyText, setVerifyText] = useState('');\n+\n+  const handleVerifyTextChange = (\n+    event: React.ChangeEvent<HTMLInputElement>\n+  ) => {\n+    setVerifyText(event.target.value);\n+  };\n+\n   return (\n     <Modal onClose={onHide} open={show} variant='danger' size='large'>\n       <Modal.Header showCloseButton={true} closeButtonClassNames='close'>\n@@ -41,11 +55,26 @@ function DeleteModal(props: DeleteModalProps): JSX.Element {\n           {t('settings.danger.nevermind')}\n         </Button>\n         <Spacer size='small' />\n+        <FormGroup controlId='verify-delete'>\n+          <ControlLabel htmlFor='verify-delete-input'>\n+            {t('settings.danger.verify-text', {\n+              verifyText: t('settings.danger.verify-delete-text')\n+            })}\n+          </ControlLabel>\n+          <Spacer size='small' />\n+          <FormControl\n+            onChange={handleVerifyTextChange}\n+            value={verifyText}\n+            id='verify-delete-input'\n+          />\n+        </FormGroup>\n+        <Spacer size='small' />\n         <Button\n           block={true}\n           size='large'\n           variant='danger'\n           onClick={props.delete}\n+          disabled={verifyText !== t('settings.danger.verify-delete-text')}\n           type='button'\n         >\n           {t('settings.danger.certain')}"
        },
        {
            "sha": "f09ce6c7d6321f3eab4abc8795cf962400c87dcb",
            "filename": "client/src/components/settings/reset-modal.tsx",
            "status": "modified",
            "additions": 30,
            "deletions": 2,
            "changes": 32,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/f01ff30dc6a0355059f65cc589199b079db477bc/client%2Fsrc%2Fcomponents%2Fsettings%2Freset-modal.tsx",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/f01ff30dc6a0355059f65cc589199b079db477bc/client%2Fsrc%2Fcomponents%2Fsettings%2Freset-modal.tsx",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/client%2Fsrc%2Fcomponents%2Fsettings%2Freset-modal.tsx?ref=f01ff30dc6a0355059f65cc589199b079db477bc",
            "patch": "@@ -1,6 +1,12 @@\n-import React from 'react';\n+import React, { useState } from 'react';\n import { useTranslation } from 'react-i18next';\n-import { Button, Modal } from '@freecodecamp/ui';\n+import {\n+  Button,\n+  ControlLabel,\n+  FormControl,\n+  FormGroup,\n+  Modal\n+} from '@freecodecamp/ui';\n \n import { Spacer } from '../helpers';\n \n@@ -13,6 +19,13 @@ type ResetModalProps = {\n function ResetModal(props: ResetModalProps): JSX.Element {\n   const { t } = useTranslation();\n   const { show, onHide } = props;\n+  const [verifyText, setVerifyText] = useState('');\n+\n+  const handleVerifyTextChange = (\n+    event: React.ChangeEvent<HTMLInputElement>\n+  ) => {\n+    setVerifyText(event.target.value);\n+  };\n \n   return (\n     <Modal size='large' onClose={onHide} variant='danger' open={show}>\n@@ -40,10 +53,25 @@ function ResetModal(props: ResetModalProps): JSX.Element {\n           {t('settings.danger.nevermind-2')}\n         </Button>\n         <Spacer size='small' />\n+        <FormGroup controlId='verify-reset'>\n+          <ControlLabel htmlFor='verify-reset-input'>\n+            {t('settings.danger.verify-text', {\n+              verifyText: t('settings.danger.verify-reset-text')\n+            })}\n+          </ControlLabel>\n+          <Spacer size='small' />\n+          <FormControl\n+            onChange={handleVerifyTextChange}\n+            value={verifyText}\n+            id='verify-reset-input'\n+          />\n+        </FormGroup>\n+        <Spacer size='small' />\n         <Button\n           block={true}\n           size='large'\n           variant='danger'\n+          disabled={verifyText !== t('settings.danger.verify-reset-text')}\n           onClick={props.reset}\n           type='button'\n         >"
        },
        {
            "sha": "d6902a35253d7e17d9fccc329e4ddeac10c6ecb6",
            "filename": "e2e/delete-modal.spec.ts",
            "status": "modified",
            "additions": 37,
            "deletions": 1,
            "changes": 38,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/f01ff30dc6a0355059f65cc589199b079db477bc/e2e%2Fdelete-modal.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/f01ff30dc6a0355059f65cc589199b079db477bc/e2e%2Fdelete-modal.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fdelete-modal.spec.ts?ref=f01ff30dc6a0355059f65cc589199b079db477bc",
            "patch": "@@ -59,6 +59,10 @@ test.describe('Delete Modal component', () => {\n       page.getByRole('button', { name: translations.settings.danger.certain })\n     ).toBeVisible();\n \n+    await expect(\n+      page.getByRole('button', { name: translations.settings.danger.certain })\n+    ).toBeDisabled();\n+\n     await expect(\n       page.getByRole('button', { name: translations.buttons.close })\n     ).toBeVisible();\n@@ -88,7 +92,32 @@ test.describe('Delete Modal component', () => {\n     ).not.toBeVisible();\n   });\n \n-  test('should close the modal and redirect to /learn after the user clicks delete', async ({\n+  test('Delele button should be disabled if user incorrectly fills verify input text', async ({\n+    page\n+  }) => {\n+    await page\n+      .getByRole('button', { name: translations.settings.danger.delete })\n+      .click();\n+\n+    await expect(\n+      page.getByRole('dialog', {\n+        name: translations.settings.danger['delete-title']\n+      })\n+    ).toBeVisible();\n+\n+    const verifyDeleteInput = page.getByRole('textbox', {\n+      exact: true\n+    });\n+    await verifyDeleteInput.fill('incorrect text');\n+\n+    await expect(\n+      page.getByRole('button', {\n+        name: translations.settings.danger.certain\n+      })\n+    ).toBeDisabled();\n+  });\n+\n+  test('should close the modal and redirect to /learn after the user fills the verify input text and clicks delete', async ({\n     page\n   }) => {\n     await page\n@@ -101,6 +130,13 @@ test.describe('Delete Modal component', () => {\n       })\n     ).toBeVisible();\n \n+    const verifyDeleteText = translations.settings.danger['verify-delete-text'];\n+\n+    const verifyDeleteInput = page.getByRole('textbox', {\n+      exact: true\n+    });\n+    await verifyDeleteInput.fill(verifyDeleteText);\n+\n     await page\n       .getByRole('button', { name: translations.settings.danger.certain })\n       .click();"
        },
        {
            "sha": "2b01fe1a36529cc9991e5d87faf380f6a2602584",
            "filename": "e2e/progress-reset-modal.spec.ts",
            "status": "modified",
            "additions": 38,
            "deletions": 1,
            "changes": 39,
            "blob_url": "https://github.com/freeCodeCamp/freeCodeCamp/blob/f01ff30dc6a0355059f65cc589199b079db477bc/e2e%2Fprogress-reset-modal.spec.ts",
            "raw_url": "https://github.com/freeCodeCamp/freeCodeCamp/raw/f01ff30dc6a0355059f65cc589199b079db477bc/e2e%2Fprogress-reset-modal.spec.ts",
            "contents_url": "https://api.github.com/repos/freeCodeCamp/freeCodeCamp/contents/e2e%2Fprogress-reset-modal.spec.ts?ref=f01ff30dc6a0355059f65cc589199b079db477bc",
            "patch": "@@ -1,6 +1,7 @@\n import { exec } from 'child_process';\n import { promisify } from 'util';\n import { test, expect } from '@playwright/test';\n+import translations from '../client/i18n/locales/english/translations.json';\n \n const execP = promisify(exec);\n \n@@ -69,6 +70,12 @@ test.describe('Progress reset modal', () => {\n         name: 'Reset everything. I want to start from the beginning'\n       })\n     ).toBeVisible();\n+\n+    await expect(\n+      page.getByRole('button', {\n+        name: 'Reset everything. I want to start from the beginning'\n+      })\n+    ).toBeDisabled();\n   });\n \n   test('should close the dialog if the user clicks the cancel button', async ({\n@@ -93,7 +100,30 @@ test.describe('Progress reset modal', () => {\n     ).toBeHidden();\n   });\n \n-  test('should reset the progress if the user clicks the reset button', async ({\n+  test('Reset progress button should be disabled if user incorrectly fills verify input text', async ({\n+    page\n+  }) => {\n+    await page\n+      .getByRole('button', { name: 'Reset all of my progress' })\n+      .click();\n+\n+    await expect(\n+      page.getByRole('dialog', { name: 'Reset My Progress' })\n+    ).toBeVisible();\n+\n+    const verifyResetInput = page.getByRole('textbox', {\n+      exact: true\n+    });\n+    await verifyResetInput.fill('incorrect text');\n+\n+    await expect(\n+      page.getByRole('button', {\n+        name: 'Reset everything. I want to start from the beginning'\n+      })\n+    ).toBeDisabled();\n+  });\n+\n+  test('should reset the progress if the user fills the verify input text and clicks the reset button', async ({\n     page\n   }) => {\n     await page\n@@ -104,6 +134,13 @@ test.describe('Progress reset modal', () => {\n       page.getByRole('dialog', { name: 'Reset My Progress' })\n     ).toBeVisible();\n \n+    const verifyResetText = translations.settings.danger['verify-reset-text'];\n+\n+    const verifyResetInput = page.getByRole('textbox', {\n+      exact: true\n+    });\n+    await verifyResetInput.fill(verifyResetText);\n+\n     await page\n       .getByRole('button', {\n         name: 'Reset everything. I want to start from the beginning'"
        }
    ],
    "stats": {
        "total": 147,
        "additions": 140,
        "deletions": 7
    }
}